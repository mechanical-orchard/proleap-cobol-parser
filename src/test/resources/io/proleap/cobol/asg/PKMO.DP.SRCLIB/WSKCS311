000010******************************************************************00001002
000020 IDENTIFICATION DIVISION.                                         00002003
000030******************************************************************00003003
000040                                                                  00004003
000050 PROGRAM-ID.             WSKCS311.                                00005003
000060 AUTHOR.                 GERMAN BANDA.                            00006003
000070 INSTALLATION.           KOHLS.                                   00007003
000080 DATE-WRITTEN            MARCH 2007,                              00008003
000090 DATE-COMPILED.                                                   00009003
000100                                                                  00010003
000200******************************************************************00020003
000300* THIS PROGRAM WILL CREATE A NEW PACKSLIP AND DETACH THE CARTON   00030003
000400* FROM THE ORIGINAL PACKSLIP AND ATTACH IT TO A NEW PACKSLIP.     00040003
000500******************************************************************00050003
000600                                                                  00060003
000700******************************************************************00070003
000800 ENVIRONMENT DIVISION.                                            00080003
000900******************************************************************00090003
001000                                                                  00100003
001100******************************************************************00110003
001200 DATA DIVISION.                                                   00120003
001300******************************************************************00130003
001400                                                                  00140003
001500******************************************************************00150003
001600 WORKING-STORAGE SECTION.                                         00160003
001700******************************************************************00170003
001800                                                                  00180003
001900     COPY WSWS008.                                                00190003
002000                                                                  00200003
002100*----------------------------------------------------------------*00210003
002200*- COPYBOOK FOR TSHPSUM CARTON COMBINATION MODULE                *00220003
002300*----------------------------------------------------------------*00230003
002400     COPY SUWS044.                                                00240003
002500                                                                  00250003
002600*----------------------------------------------------------------*00260003
002700*    CURRENT DATE COPYBOOK.                                      *00270003
002800*----------------------------------------------------------------*00280003
002900                                                                  00290003
002901     COPY DPWS017.                                                00290103
002902*----------------------------------------------------------------*00290203
002903*    COPY BOOK FOR CALENDAR SUBROUTINE (DPKUT500)                 00290303
002904*----------------------------------------------------------------*00290403
002905                                                                  00290503
002906     COPY DPWS500.                                                00290603
002907                                                                  00290703
002908*---------------------------------------------------------------* 00290803
002909*  RECORD LAYOUTS FOR THE TROUBLE CREATION ROUTINE                00290903
002910*---------------------------------------------------------------* 00291003
002920     COPY TMWS500.                                                00292003
002930*                                                                 00293003
002940*---------------------------------------------------------------* 00294003
002950*  RECORD LAYOUTS FOR RECEIVER AUDIT CREATE                       00295003
002960*---------------------------------------------------------------* 00296003
002970     COPY RCWS031.                                                00297003
002980*                                                                 00298003
002990 01  DK-DB2-KEYS.                                                 00299003
003000     05  DK-STR-DEST-NBR                 PIC S9(4) COMP VALUE +0. 00300003
003100     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00310003
003200     05  DK-EXPTED-ITM-UPD-QTY           PIC S9(09) COMP.         00320003
003300     05  DK-VERIFY-ITM-UPD-QTY           PIC S9(09) COMP.         00330003
003400     05  DK-AP-VERIFY-ITM-UPD-QTY        PIC S9(09) COMP.         00340003
003500     05  DK-SHPTPO-EXPTED-UPD-CNT        PIC S9(09) COMP.         00350003
003600     05  DK-SHIPMT-EXPTED-UPD-QTY        PIC S9(09) COMP.         00360003
003700     05  DK-PKITM-UPD-ITM-QTY            PIC S9(09) COMP.         00370003
003800     05  DK-EXPTED-CART-UPD-CNT          PIC S9(09) COMP.         00380003
003900     05  DK-PKSL-ITM-UPD-QTY             PIC S9(09) COMP.         00390003
004000     05  DK-DTL-CK-ITM-QTY               PIC S9(09) COMP.         00400003
004100     05  DK-PO-LNE-NBR                   PIC S9(9) COMP.          00410003
004200     05  DK-SHIPT-UNT-ID                 PIC S9(18) COMP-3.       00420003
004300     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00430003
004400     05  DK-OUTER-QTY                    PIC S9(04) COMP.         00440003
004500     05  DK-FCLTY-ID                     PIC S9(04) COMP.         00450003
004600     05  DK-STR-NBR                      PIC S9(04) COMP SYNC.    00460003
004700     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP SYNC.    00470003
004800     05  DK-PKSL-LNE-NBR                 PIC S9(09) COMP SYNC.    00480003
004900     05  DK-TRN-TYP-CDE                  PIC  X(02).              00490003
005000     05  DK-UPC-NBR                      PIC S9(15)V COMP-3.      00500003
005100     05  DK-SHIPT-ID                     PIC S9(09) COMP VALUE +0.00510003
005200     05  DK-STR-NBR-N                    PIC 9(4).                00520003
005300     05  DK-STR-NBR-X   REDEFINES     DK-STR-NBR-N.               00530003
005400         10  DK-STR-NBR-X1               PIC X(01).               00540003
005500         10  DK-STR-NBR-X2               PIC X(03).               00550003
005600     05  DK-STR-NBR-USE                  PIC X(03).               00560003
005700     05  DK-NULL                         PIC S9(04)  VALUE +0     00570003
005800                                              COMP SYNC.          00580003
005900                                                                  00590003
006000 01  DN-DB2-NULL-INDICATORS.                                      00600003
006100     05  DN-SEQ-NBR-IND             PIC S9(04) COMP VALUE ZEROES. 00610003
006200     05  DN-AUDIT-IND               PIC S9(04) COMP VALUE ZEROES. 00620003
006300     05  DN-SHIPT-IND               PIC S9(04) COMP VALUE ZEROES. 00630003
006400     05  DN-PROB-IND                PIC S9(04) COMP VALUE ZEROES. 00640003
006500     05  DN-ADJ-IND                 PIC S9(04) COMP VALUE ZEROES. 00650003
006600     05  DN-TRIP-ID                   PIC S9(04) COMP VALUE +0.   00660003
006700     05  DN-SHIP-EST-AR-TMST          PIC S9(04) COMP VALUE +0.   00670003
006800     05  DN-VEH-NBR                   PIC S9(04) COMP VALUE +0.   00680003
006900                                                                  00690003
007000 01  PC-PROGRAM-CONSTANTS.                                        00700003
007100     05  PC-DEFAULT-TMST           PIC X(26)  VALUE               00710003
007200                                  '9999-09-09-09.09.09.999999'.   00720003
007300     05  PC-CALENDAR-ROUTINE       PIC X(08)  VALUE 'RCKCS290'.   00730003
007400     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'WSKCS311'.   00740003
007500     05  PC-FA-AUTOVE-TRBLE-372    PIC S9(04) COMP VALUE 372.     00750003
007600     05  PC-AUDIT-RTN              PIC X(08)  VALUE 'RCKCS290'.   00760003
007700     05  PC-TROUBLE-WTR            PIC  X(08) VALUE 'TMKCS521'.   00770003
007800     05  PC-SHPUM-UPD-PGM          PIC  X(08) VALUE 'SUKUT708'.   00780003
007900     05  PC-TROUBLE-LENGTH         PIC S9(04) COMP VALUE +600.    00790003
008000     05  PC-AUDIT-RTN-LENGTH       PIC S9(4)  VALUE  +300         00800003
008100                                                COMP SYNC.        00810003
008200     05  PC-DEFAULT-DATE           PIC X(10)  VALUE '0001-01-01'. 00820003
008300     05  PC-AC                     PIC X(02)  VALUE 'AC'.         00830003
008400     05  PC-FA                     PIC X(02)  VALUE 'FA'.         00840003
008500     05  PC-A                      PIC X(01)  VALUE 'A'.          00850003
008600     05  PC-M                      PIC X(01)  VALUE 'M'.          00860003
008700     05  PC-I                      PIC X(01)  VALUE 'I'.          00870003
008800     05  PC-FRASTY-CRE-USER-ID     PIC X(08)  VALUE 'F/A SYTM'.   00880003
008900                                                                  00890003
009000                                                                  00900003
009100 01  PS-PROGRAM-SWITCHES.                                         00910003
009200     05  PS-MORE-SHUUPC-SW            PIC X(01)  VALUE 'N'.       00920003
009300         88  PS-MORE-SHUUPC-YES                  VALUE 'Y'.       00930003
009400         88  PS-MORE-SHUUPC-NO                   VALUE 'N'.       00940003
009500     05  PS-LOG-MESSAGE-SW              PIC  X       VALUE 'N'.   00950003
009600         88  PS-LOG-MESSAGE                          VALUE 'Y'.   00960003
009700         88  PS-NO-LOG-MESSAGE                       VALUE 'N'.   00970003
009800     05  PS-PROCESS-ODD-UNITS-SW        PIC  X       VALUE 'N'.   00980003
009900         88  PS-PROCESS-ODD-UNITS                    VALUE 'Y'.   00990003
010000         88  PS-NOT-PROCESS-ODD-UNITS                VALUE 'N'.   01000003
010100     05  PS-BEFORE-ONLY-LOGGING-SW      PIC  X       VALUE 'N'.   01010003
010200         88  PS-BEFORE-ONLY-LOGGING                  VALUE 'Y'.   01020003
010300         88  PS-NOT-BEFORE-ONLY-LOGGING              VALUE 'N'.   01030003
010400     05  PS-FIRST-PKSLIP-LINE-SW        PIC  X       VALUE 'N'.   01040003
010500         88  PS-FIRST-PKSLIP-LINE                    VALUE 'Y'.   01050003
010600         88  PS-NOT-FIRST-PKSLIP-LINE                VALUE 'N'.   01060003
010700     05  PS-TROUBLE-CREATE-SW           PIC  X       VALUE 'N'.   01070003
010800         88  PS-TROUBLE-CREATE-YES                   VALUE 'Y'.   01080003
010900         88  PS-TROUBLE-CREATE-NO                    VALUE 'N'.   01090003
011000     05  PS-FIRST-ODD-UNTS-FETCH-SW      PIC  X(01)  VALUE 'Y'.   01100003
011100         88  PS-FIRST-ODD-UNTS-FETCH                 VALUE 'Y'.   01110003
011200         88  PS-NOT-FIRST-ODD-UNTS-FETCH             VALUE 'N'.   01120003
011300     05  PS-FOUND-ON-ODD-UNTS-CSR-SW     PIC  X(01)  VALUE 'Y'.   01130003
011400         88  PS-FOUND-ON-ODD-UNTS-CSR                VALUE 'Y'.   01140003
011500         88  PS-EO-ODD-UNTS-CSR                      VALUE 'N'.   01150003
011600     05  PS-ODD-UNT-CRTN-FOUND-SW        PIC  X(01)  VALUE 'N'.   01160003
011700         88  PS-ODD-UNT-CRTN-FOUND                   VALUE 'Y'.   01170003
011800         88  PS-NOT-ODD-UNT-CRTN-FOUND               VALUE 'N'.   01180003
011900     05  PS-FIRST-PREPK-SW               PIC  X(01)  VALUE 'Y'.   01190003
012000         88  PS-FIRST-PREPK                          VALUE 'Y'.   01200003
012100         88  PS-NOT-FIRST-PREPK                      VALUE 'N'.   01210003
012200     05  PS-EO-UNITS-CSR-SW              PIC  X(01)  VALUE 'N'.   01220003
012300         88  PS-EO-UNITS-CSR                         VALUE 'Y'.   01230003
012400         88  PS-NOT-EO-UNITS-CSR                     VALUE 'N'.   01240003
012500     05  PS-EO-PREPK-CSR-SW              PIC  X(01)  VALUE 'N'.   01250003
012600         88  PS-EO-PREPK-CSR                         VALUE 'Y'.   01260003
012700         88  PS-NOT-EO-PREPK-CSR                     VALUE 'N'.   01270003
012800     05  PS-END-OF-VRTL-LBL-CSR-SW       PIC  X(01)  VALUE 'N'.   01280003
012900         88  PS-END-OF-VRTL-LBL-CSR                  VALUE 'Y'.   01290003
013000         88  PS-NOT-END-OF-VRTL-LBL-CSR              VALUE 'N'.   01300003
013100     05  PS-ERROR-SW                    PIC  X(01)   VALUE 'N'.   01310003
013200         88  PS-NO-ERROR                             VALUE 'N'.   01320003
013300         88  PS-ERROR                                VALUE 'Y'.   01330003
013400     05  PS-PKSLIP-INSERT-SW            PIC  X(01)   VALUE 'N'.   01340003
013500         88  PS-PKSLIP-INSERTED                      VALUE 'N'.   01350003
013600         88  PS-PKSLIP-NOT-INSERTED                  VALUE 'Y'.   01360003
013700     05  PS-SUCCESSFUL-UPDATE-SW         PIC  X(01)  VALUE 'N'.   01370003
013800         88  PS-SUCCESSFUL-UPDATE                    VALUE 'Y'.   01380003
013900         88  PS-NOT-SUCCESSFUL-UPDATE                VALUE 'N'.   01390003
014000     05  PS-FIRST-PO-LINE-SW             PIC  X(01)  VALUE 'Y'.   01400003
014100         88  PS-FIRST-PO-LINE-FOR-CTN                VALUE 'Y'.   01410003
014200         88  PS-NOT-FIRST-PO-LINE-FOR-CTN            VALUE 'N'.   01420003
014300     05  PS-FOUND-ON-CURSOR-SW           PIC  X(01)  VALUE 'Y'.   01430003
014400         88  PS-FOUND-ON-CURSOR                      VALUE 'Y'.   01440003
014500         88  PS-NOT-FOUND-ON-CURSOR                  VALUE 'N'.   01450003
014600     05  PS-LABEL-DATA-FOUND-SW          PIC  X(01)  VALUE 'N'.   01460003
014700         88  PS-LABEL-DATA-FOUND                     VALUE 'Y'.   01470003
014800         88  PS-LABEL-DATA-NOT-FOUND                 VALUE 'N'.   01480003
014900     05  PS-UPDATE-TPKITEM-SW            PIC  X(01)  VALUE 'N'.   01490003
015000         88  PS-UPDATE-TPKITEM-YES                   VALUE 'Y'.   01500003
015100         88  PS-UPDATE-TPKITEM-NO                    VALUE 'N'.   01510003
015200     05  PS-FIRST-PREPK-LINE-SW          PIC  X(01)  VALUE 'Y'.   01520003
015300         88  PS-FIRST-PREPK-LINE-YES                 VALUE 'Y'.   01530003
015400         88  PS-FIRST-PREPK-LINE-NO                  VALUE 'N'.   01540003
015500     05  PS-UPDATE-PKSLIP-ONLY-SW        PIC  X(01)  VALUE 'N'.   01550003
015600         88  PS-UPDATE-PKSLIP-ONLY-YES               VALUE 'Y'.   01560003
015700         88  PS-UPDATE-PKSLIP-ONLY-NO                VALUE 'N'.   01570003
015800     05  PS-FIRST-INPK-CNVY-SW           PIC  X(01)  VALUE 'Y'.   01580003
015900         88  PS-FIRST-INPK-CNVY-YES                  VALUE 'Y'.   01590003
016000         88  PS-FIRST-INPK-CNVY-NO                   VALUE 'N'.   01600003
016100     05  PS-ORIG-RCVR-VRFD-SW            PIC  X(01)  VALUE 'Y'.   01610003
016200         88  PS-ORIG-RCVR-VRFD                       VALUE 'Y'.   01620003
016300         88  PS-ORIG-RCVR-VRFD-NO                    VALUE 'N'.   01630003
016400     05  PS-CRE-SKU-LVL-PKSL-SW          PIC  X(01)  VALUE 'N'.   01640003
016500         88  PS-CRE-SKU-LVL-PKSL-YES                 VALUE 'Y'.   01650003
016600         88  PS-CRE-SKU-LVL-PKSL-NO                  VALUE 'N'.   01660003
017000     05  PS-FOUND-PKITEM-SW              PIC X(01)   VALUE 'N'.   01700000
017100         88  PS-FOUND-PKITEM-YES                     VALUE 'Y'.   01710000
017200         88  PS-FOUND-PKITEM-NO                      VALUE 'N'.   01720000
017210                                                                  01721000
017220 01  PV-PROGRAM-VARIABLES.                                        01722000
017230     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      01723000
017240                                                    COMP SYNC.    01724000
017250     05  PV-TRBL-RSN-CDE                 PIC S9(4) VALUE ZERO     01725000
017260                                                COMP SYNC.        01726000
017270     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01727000
017280     05  PV-NOTIF-NBR                    PIC S9(9) VALUE ZERO     01728000
017290                                                COMP SYNC.        01729000
017300     05  PV-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.01730000
017400     05  PV-PO-LNE-NBR                   PIC  S9(9) COMP.         01740000
017500     05  PV-MAX-SEQ-NBR                  PIC S9(04) VALUE +0      01750000
017600                                                 COMP.            01760000
017700     05  PV-NEXT-SEQ-NBR                 PIC S9(04) VALUE +0      01770000
017800                                                 COMP.            01780000
017900     05  PV-FROM-PARAGRAPH               PIC X(35) VALUE SPACES.  01790000
018000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01800000
018100                                                COMP SYNC.        01810000
018200     05  PV-CICS-RESPONSE                PIC S9(04)  VALUE +0     01820000
018300                                                COMP SYNC.        01830000
018400     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 01840000
018500     05  PV-DISPLAY-UPC-NBR              PIC   9(15).             01850000
018600     05  PV-DISPLAY-INTR-UPC             PIC   9(9).              01860000
018700     05  PV-DISPLAY-PKSL-SEQ-NBR         PIC   9(04).             01870000
018710     05  PV-DISPLAY-PKSL-SEQ-NBR-2       PIC   9(04).             01871004
018800     05  PV-DISP-OPER-UNT-ID             PIC   9(04).             01880000
018900     05  PV-DISPLAY-ADJ-ERR-CDE          PIC   9(04).             01890000
019000     05  PV-DISP-PARAGRAPH-NAME          PIC X(30).               01900000
019100     05  PV-DISP-PO                      PIC 9(09).               01910000
019200     05  PV-DISP-SHIPMT-ID               PIC 9(09).               01920000
019300     05  PV-DISP-RCVR-SEQ-NBR            PIC 9(04).               01930000
019400     05  PV-DISP-SEQ-NBR                 PIC 9(04).               01940000
019500     05  PV-DISP-SHIPT-UNT-ID            PIC 9(18).               01950000
019600     05  PV-DISP-PACK-ID                 PIC 9(04).               01960000
019700     05  PV-DISP-PO-LNE-NBR              PIC 9(04).               01970000
019800     05  PV-DISP-PROB-RSN-CDE            PIC 9(04).               01980000
019900     05  PV-DISP-TRN-TYP-CDE             PIC X(02).               01990000
020000     05  PV-DISP-UPC-NBR                 PIC 9(15).               02000000
020100     05  PV-DISP-STR-NBR                 PIC 9(04).               02010000
020200     05  PV-DISPLAY-CICS-RESP            PIC 999999999-           02020000
020300                                                 VALUE ZEROS.     02030000
020800     05  PV-DB2-TMST                      PIC X(26).              02080000
020900     05  FILLER  REDEFINES  PV-DB2-TMST.                          02090000
021000         10  PV-DB2-TMST-CCYY         PIC X(04).                  02100000
021100         10  FILLER                   PIC X(01).                  02110000
021110         10  PV-DB2-TMST-MO           PIC X(02).                  02111000
021120         10  FILLER                   PIC X(01).                  02112000
021130         10  PV-DB2-TMST-DA           PIC X(02).                  02113000
021140         10  FILLER                   PIC X(01).                  02114000
021150         10  PV-DB2-TMST-HH           PIC X(02).                  02115000
021160         10  FILLER                   PIC X(01).                  02116000
021170         10  PV-DB2-TMST-MM           PIC X(02).                  02117000
021180         10  FILLER                   PIC X(01).                  02118000
021190         10  PV-DB2-TMST-SS           PIC X(02).                  02119000
021200             88  PV-DB2-TMST-SS-01               VALUE '01'.      02120000
021300         10  FILLER                   PIC X(01).                  02130000
021400         10  PV-DB2-TMST-MS           PIC X(06).                  02140000
021500             88  PV-DB2-TMST-MS-ZERO             VALUE '00000'.   02150000
021600     05  PV-SWITCH-IND                   PIC   X(01) VALUE SPACE. 02160000
021700     05  PV-TRN-LNE-NBR                  PIC  S9(9) COMP.         02170000
021800     05  PV-HOLD-TRN-LNE-NBR             PIC  S9(9) COMP.         02180000
021900     05  PV-PREV-FETCH                   PIC  X(01).              02190000
022000     05  PV-PREV-LINE                    PIC  S9(9) COMP.         02200000
022100     05  PV-PREPK-UNT-QTY                PIC  S9(4) COMP.         02210000
022200     05  PV-INPK-UNT-QTY                 PIC  S9(4) COMP.         02220000
022300     05  PV-SHUUPC-SHPD-QTY              PIC  S9(9)V COMP-3.      02230000
022400     05  PV-SHUUPC-UNIT-QTY              PIC  S9(9)V COMP-3.      02240000
022500     05  PV-SHUUPC-QTY-DR-LNE            PIC  S9(9)V COMP-3.      02250000
022600     05  PV-UNION-TYPE                   PIC  X(01).              02260000
022700     05  PV-SHIPPED-QTY                  PIC  S9(9) VALUE ZEROES  02270000
022800                                                    COMP.         02280000
022900     05  PV-SHPD-QTY-TOTAL               PIC  S9(9) VALUE ZEROES  02290000
023000                                                    COMP.         02300000
023100*                                                                 02310000
023200     05  PV-MISDIRECT-OPER-ID            PIC  9(04) VALUE ZEROES. 02320000
023300     05  PV-MISDIRECT-FA-CREATE-SRCE.                             02330000
023400         10  PV-MIS-FA-CRE-OPER          PIC  X(04)  VALUE SPACE. 02340000
023500         10  PV-MIS-FA-CRE-SYST          PIC  X(04)  VALUE 'PBSM'.02350000
023600*                                                                 02360000
023700     05  PV-DH-SSCC                      PIC  9(18)  VALUE ZEROS. 02370015
023701     05  PV-DH-PO                        PIC  9(09)  VALUE ZEROS. 02370115
023702     05  PV-DH-ORIG-REC                  PIC  9(09)  VALUE ZEROS. 02370215
023703     05  PV-DH-NEW-REC                   PIC  9(09)  VALUE ZEROS. 02370315
023704     05  PV-DH-TRIP                      PIC  9(09)  VALUE ZEROS. 02370415
023705     05  PV-DH-ORIG-PKSL                 PIC  9(04)  VALUE ZEROS. 02370515
023706     05  PV-DH-NEW-PKSL                  PIC  9(04)  VALUE ZEROS. 02370615
023707     05  PV-DH-OPER                      PIC  9(04)  VALUE ZEROS. 02370715
023708     05  PV-DH-DEST                      PIC  9(04)  VALUE ZEROS. 02370815
023709     05  PV-DH-LINE                      PIC  9(09)  VALUE ZEROS. 02370915
023710     05  PV-DH-QTY                       PIC  9(09)  VALUE ZEROS. 02371015
023711*                                                                 02371115
023720     05  PV-MULTIPLE                     PIC  9(04)  VALUE ZEROS. 02372015
023800     05  PV-HOLD-MULTIPLE                PIC  9(04)  VALUE ZEROS. 02380000
023900     05  PV-REMAINDER                    PIC  9(04)  VALUE ZEROS. 02390000
024000     05  PV-FCSE-CART-CNT                PIC  S9(4) COMP.         02400000
024100     05  PV-P2L-CART-CNT                 PIC  S9(4) COMP.         02410000
024200     05  PV-INPK-CART-CNT                PIC  S9(4) COMP.         02420000
024300     05  PV-QUANTITY                     PIC  S9(9) COMP          02430000
024400                                                    VALUE ZEROS.  02440000
024500*                                                                 02450000
024600                                                                  02460000
024700*----------------------------------------------------------------*02470000
024800*    DB2 SHIPPING UNIT TABLE                                      02480000
024900*----------------------------------------------------------------*02490000
025000     EXEC SQL                                                     02500000
025100          INCLUDE TSHUUPC                                         02510000
025200     END-EXEC.                                                    02520000
025300******************************************************************02530000
025400* DB2 AREA FOR THE RECEIVER ITEM TABLE                            02540000
025500******************************************************************02550000
025600     EXEC SQL                                                     02560000
025700          INCLUDE TRECITM                                         02570000
025800     END-EXEC.                                                    02580000
025900                                                                  02590000
026000******************************************************************02600000
026100* DB2 AREA FOR THE RECEIVER DISTRIBUTION TABLE                    02610000
026200******************************************************************02620000
026300     EXEC SQL                                                     02630000
026400          INCLUDE TRECDIS                                         02640000
026500     END-EXEC.                                                    02650000
026600                                                                  02660000
026700******************************************************************02670000
026800* DB2 AREA FOR THE RECEIVER TABLE                                 02680000
026900******************************************************************02690000
027000     EXEC SQL                                                     02700000
027100          INCLUDE TRECEIV                                         02710000
027200     END-EXEC.                                                    02720000
027300                                                                  02730000
027400******************************************************************02740000
027500* DB2 AREA FOR THE PACKSLIP TABLE                                 02750000
027600******************************************************************02760000
027700     EXEC SQL                                                     02770000
027800          INCLUDE TPKSLIP                                         02780000
027900     END-EXEC.                                                    02790000
028000                                                                  02800000
028100******************************************************************02810000
028200* DB2 AREA FOR THE PACKSLIP ITEM TABLE                            02820000
028300******************************************************************02830000
028400     EXEC SQL                                                     02840000
028500          INCLUDE TPKITEM                                         02850000
028600     END-EXEC.                                                    02860000
028700                                                                  02870000
028800******************************************************************02880000
028900*---------------------------------------------------------------* 02890000
029000*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 02900000
029100*---------------------------------------------------------------* 02910000
029200     EXEC SQL                                                     02920000
029300          INCLUDE TPURITM                                         02930000
029400     END-EXEC.                                                    02940000
029500*---------------------------------------------------------------* 02950000
029600*    DB2 AREA FOR VIRTUAL LABEL DATA TABLE                      * 02960000
029700*---------------------------------------------------------------* 02970000
029800     EXEC SQL                                                     02980000
029900          INCLUDE TLBVRDA                                         02990000
030000     END-EXEC.                                                    03000000
030100*---------------------------------------------------------------* 03010000
030200*    DB2 AREA FOR SHIPMENT TABLE                      *           03020000
030300*---------------------------------------------------------------* 03030000
030400     EXEC SQL                                                     03040000
030500          INCLUDE TSHIPMT                                         03050000
030600     END-EXEC.                                                    03060000
030700*---------------------------------------------------------------* 03070000
030800*    DB2 AREA                                                     03080000
030900*---------------------------------------------------------------* 03090000
031000     EXEC SQL                                                     03100000
031100          INCLUDE TINPKSU                                         03110000
031200     END-EXEC.                                                    03120000
031300*---------------------------------------------------------------* 03130000
031400*    DB2 AREA                                                     03140000
031500*---------------------------------------------------------------* 03150000
031600     EXEC SQL                                                     03160000
031700          INCLUDE TPURCHS                                         03170000
031800     END-EXEC.                                                    03180000
031900*---------------------------------------------------------------* 03190000
032000*    DB2 AREA                                                     03200000
032100*---------------------------------------------------------------* 03210000
032200     EXEC SQL                                                     03220000
032300          INCLUDE TSHPTPO                                         03230000
032400     END-EXEC.                                                    03240000
032500******************************************************************03250000
032600*---------------------------------------------------------------* 03260000
032700*    DB2 AREA FOR TRECDIS ORIGINAL DATA (RCT_RECDIS_ORIG)         03270000
032800*---------------------------------------------------------------* 03280000
032900     EXEC SQL                                                     03290000
033000          INCLUDE RCT00013                                        03300000
033100     END-EXEC.                                                    03310000
033200******************************************************************03320000
033300******************************************************************03330000
033400*  DB2 TABLE DECLARATION - WMS INTEGRATION TYPE                   03340000
033500*      (WST_INTGRTN_TYP)                                          03350000
033600******************************************************************03360000
033700     EXEC SQL                                                     03370000
033800          INCLUDE WST00008                                        03380000
033900     END-EXEC.                                                    03390000
034000                                                                  03400000
034100******************************************************************03410000
034200*  DB2 TABLE DECLARATION - WMS ATTRIBUTE DEFINITION               03420000
034300*      (WST_ATTR_DEFN)                                            03430000
034400******************************************************************03440000
034500     EXEC SQL                                                     03450000
034600          INCLUDE WST00009                                        03460000
034700     END-EXEC.                                                    03470000
034800                                                                  03480000
034900******************************************************************03490000
035000*  DB2 TABLE DECLARATION - WMS ATTRIBUTE ELEMENT                  03500000
035100*      (WST_ATTR_ELEM)                                            03510000
035200******************************************************************03520000
035300     EXEC SQL                                                     03530000
035400          INCLUDE WST00010                                        03540000
035500     END-EXEC.                                                    03550000
035600                                                                  03560000
035700******************************************************************03570000
035800*  COMMUNICATIONS AREA FOR DB2                                    03580000
035900******************************************************************03590000
036000     EXEC SQL                                                     03600000
036100         INCLUDE SQLCA                                            03610000
036200     END-EXEC.                                                    03620000
036300                                                                  03630000
036400*----------------------------------------------------------------*03640000
036500*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECITMS FOR A PACK-ID 03650000
036600*----------------------------------------------------------------*03660000
036700     EXEC SQL                                                     03670000
036800         DECLARE SHUUPC-CURSOR CURSOR FOR                         03680000
036900          SELECT TRN_LNE_NBR                                      03690000
037000               , SUM(SHPD_QTY)                                    03700000
037100            FROM TSHUUPC                                          03710000
037200           WHERE SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                03720000
037300           AND   SHPD_QTY       >  0                              03730000
037400        GROUP BY TRN_LNE_NBR                                      03740000
037500     END-EXEC.                                                    03750000
037600                                                                  03760000
037700                                                                  03770000
037800*---------------------------------------------------------------* 03780000
037900******************************************************************03790000
038000 LINKAGE SECTION.                                                 03800000
038100 01  DFHCOMMAREA.                                                 03810000
038200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03820000
038300                                      DEPENDING ON EIBCALEN.      03830000
038400         10  FILLER                   PIC X.                      03840000
038500******************************************************************03850000
038600                                                                  03860000
038700******************************************************************03870000
038800 PROCEDURE DIVISION.                                              03880000
038900******************************************************************03890000
039000                                                                  03900000
039100******************************************************************03910000
039200 0000-PROGRAM-MAINLINE.                                           03920000
039300     INITIALIZE PV-PROGRAM-VARIABLES                              03930000
039400                PS-PROGRAM-SWITCHES                               03940000
039500                WS008-COMM-AREA.                                  03950000
039600     MOVE  'N' TO  PS-MORE-SHUUPC-SW                              03960000
039700                   PS-LOG-MESSAGE-SW                              03970000
039800                   PS-PROCESS-ODD-UNITS-SW                        03980000
039900                   PS-BEFORE-ONLY-LOGGING-SW                      03990000
040000                   PS-TROUBLE-CREATE-SW                           04000000
040100                   PS-ODD-UNT-CRTN-FOUND-SW                       04010000
040200                   PS-EO-UNITS-CSR-SW                             04020000
040300                   PS-EO-PREPK-CSR-SW                             04030000
040400                   PS-END-OF-VRTL-LBL-CSR-SW                      04040000
040500                   PS-ERROR-SW                                    04050000
040600                   PS-PKSLIP-INSERT-SW                            04060000
040700                   PS-SUCCESSFUL-UPDATE-SW                        04070000
040800                   PS-LABEL-DATA-FOUND-SW                         04080000
040900                   PS-UPDATE-TPKITEM-SW                           04090000
041000                   PS-UPDATE-PKSLIP-ONLY-SW                       04100000
041100                   PS-CRE-SKU-LVL-PKSL-SW                         04110000
041200     MOVE  'Y' TO  PS-FIRST-ODD-UNTS-FETCH-SW                     04120000
041300                   PS-FIRST-PKSLIP-LINE-SW                        04130000
041400                   PS-FOUND-ON-ODD-UNTS-CSR-SW                    04140000
041500                   PS-FIRST-PO-LINE-SW                            04150000
041600                   PS-FOUND-ON-CURSOR-SW                          04160000
041700                   PS-FIRST-PREPK-SW                              04170000
041800                   PS-FIRST-PREPK-LINE-SW                         04180000
041900                   PS-FIRST-INPK-CNVY-SW.                         04190000
042000                                                                  04200000
042100     MOVE DFHCOMMAREA              TO  WS008-COMM-AREA.           04210000
042200     MOVE WS008-OPER-UNT-ID        TO DK-OPER-UNT-ID.             04220000
042300     SET PS-NO-ERROR TO TRUE.                                     04230000
042400                                                                  04240000
042500     PERFORM 8000-CHECK-FOR-LOGGING.                              04250000
042600     IF PS-LOG-MESSAGE                                            04260000
042700         MOVE WS008-PO-NUMBER        TO PV-DISP-PO                04270000
042800         MOVE WS008-ORIG-REC-SEQ-NBR TO  PV-DISP-RCVR-SEQ-NBR     04280000
042900         MOVE WS008-SHIPT-UNT-ID     TO  PV-DISP-SHIPT-UNT-ID     04290000
043000         STRING   ' WSKCS311 PROGRAM STARTED -'                   04300000
043100                  ' CALLED BY-'                                   04310000
043200                  WS008-PROGRAM-NAME                              04320000
043300                  ' PO='                                          04330000
043400                  PV-DISP-PO                                      04340000
043500                  ' RCVR='                                        04350000
043600                  PV-DISP-RCVR-SEQ-NBR                            04360000
043700                  ' CARTON='                                      04370000
043800                  PV-DISP-SHIPT-UNT-ID                            04380000
043900                  DELIMITED BY SIZE                               04390000
044000                                  INTO PV-CICS-MSG-AREA           04400000
044100         MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG          04410000
044200         PERFORM 9999-WRITE-TO-CSSL                               04420000
044300         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               04430000
044400         PERFORM 9999-WRITE-TO-CSSL                               04440000
044500     END-IF.                                                      04450000
045391                                                                  04539100
045392     PERFORM 1000-PROCESS-CARTON-PACKSLIP.                        04539200
045393                                                                  04539300
045394     MOVE WS008-COMM-AREA               TO DFHCOMMAREA.           04539400
045395                                                                  04539500
045396     GOBACK.                                                      04539600
045397                                                                  04539700
045398 1000-PROCESS-CARTON-PACKSLIP.                                    04539800
045399                                                                  04539900
045400                                                                  04540000
045500     INITIALIZE DCLTPKSLIP.                                       04550000
045600     MOVE WS008-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID                   04560000
045700     PERFORM 1200-CHECK-TRECEIV                                   04570000
045800     PERFORM 1300-SELECT-PKSLIP                                   04580000
045900                                                                  04590000
045910*                                                                 04591014
045920** DMH ADDED DISPLAY FOR TESTING ONLY                             04592015
045921*                                                                 04592115
045922*    MOVE  WS008-SHIPT-UNT-ID        TO PV-DH-SSCC                04592222
045923*    MOVE  WS008-PO-NUMBER           TO PV-DH-PO                  04592322
045924*    MOVE  WS008-ORIG-REC-SEQ-NBR    TO PV-DH-ORIG-REC            04592422
045925*    MOVE  WS008-NEW-REC-SEQ-NBR     TO PV-DH-NEW-REC             04592522
045926*    MOVE  WS008-TRIP-ID             TO PV-DH-TRIP                04592622
045927*    MOVE  WS008-ORIG-PKSL-SEQ-NBR   TO PV-DH-ORIG-PKSL           04592722
045928*    MOVE  WS008-NEW-PKSL-SEQ-NBR    TO PV-DH-NEW-PKSL            04592822
045929*    MOVE  WS008-OPER-UNT-ID         TO PV-DH-OPER                04592922
045930*    MOVE  WS008-DEST-STR-NBR        TO PV-DH-DEST                04593022
045935*    MOVE  WS008-PO-LINE-NBR         TO PV-DH-LINE                04593522
045936*    MOVE  WS008-ITEM-QTY            TO PV-DH-QTY                 04593622
045937*                                                                 04593722
045938*    MOVE  SPACES TO  PV-CICS-MSG-AREA                            04593822
045939*    STRING   ' WSKCS311-'                                        04593922
045940*             PV-DH-SSCC       ' - '                              04594022
045941*             PV-DH-PO         ' - '                              04594122
045942*             PV-DH-ORIG-REC   ' - '                              04594222
045943*             PV-DH-NEW-REC    ' - '                              04594322
045944*             PV-DH-TRIP       ' - '                              04594422
045945*             WS008-CRE-SKU-LVL-PKSL-SW ' - '                     04594522
045946*             WS008-SKU-LVL-RCVING-SW                             04594622
045947*                     DELIMITED BY SIZE                           04594722
045948*                                     INTO PV-CICS-MSG-AREA       04594822
045949*    PERFORM 9999-WRITE-TO-CSSL.                                  04594922
045950*                                                                 04595022
045951*    MOVE  SPACES TO  PV-CICS-MSG-AREA                            04595122
045952*    STRING   ' WSKCS311-'                                        04595222
045953*             PV-DH-ORIG-PKSL  ' - '                              04595322
045954*             PV-DH-NEW-PKSL   ' - '                              04595422
045955*             PV-DH-OPER       ' - '                              04595522
045956*             PV-DH-DEST       ' - '                              04595622
045957*             PV-DH-LINE       ' - '                              04595722
045958*             PV-DH-QTY                                           04595822
045959*                     DELIMITED BY SIZE                           04595922
045960*                                     INTO PV-CICS-MSG-AREA       04596022
045961*    PERFORM 9999-WRITE-TO-CSSL.                                  04596122
045962**                                                                04596215
045963*                                                                 04596315
045970                                                                  04597015
046000     IF WS008-CRE-SKU-LVL-PKSL                                    04600000
046100        PERFORM 1400-SEL-ADD-UPD-PKSLIP                           04610000
046200        IF PS-CRE-SKU-LVL-PKSL-YES                                04620000
046300           PERFORM 3000-ADD-PACK-SLIP-HEADER                      04630000
046400           PERFORM 5345-PKSLIP-CRE-DTL-SKU                        04640000
046500        ELSE                                                      04650000
046600           PERFORM 4600-CHECK-PKSLIP-ITEM                         04660000
046610           IF PS-FOUND-PKITEM-YES                                 04661000
046620              COMPUTE PV-QUANTITY = PKITEM-PKSL-ITM-QTY           04662000
046630                                  + WS008-ITEM-QTY                04663000
046631              PERFORM 4700-PKSLIP-UPDATE-QTY                      04663100
046632           ELSE                                                   04663200
046633              PERFORM 5345-PKSLIP-CRE-DTL-SKU                     04663300
046634           END-IF                                                 04663400
046635        END-IF                                                    04663500
046636     ELSE                                                         04663600
046637        IF WS008-CREATE-PKSLIP                                    04663700
046638            PERFORM 3000-ADD-PACK-SLIP-HEADER                     04663800
046639            PERFORM 4000-PROCESS-SHUUPC-CURSOR                    04663900
046640        ELSE                                                      04664000
046641            PERFORM 1500-PROCESS-DETACH-ONLY                      04664100
046642        END-IF                                                    04664200
046643     END-IF.                                                      04664300
046644                                                                  04664400
046645     IF WS008-CRE-SKU-LVL-PKSL                                    04664500
046646        CONTINUE                                                  04664600
046647     ELSE                                                         04664700
046648        PERFORM 7200-LINK-SUKUT708                                04664800
046649     END-IF.                                                      04664900
046650                                                                  04665000
046660                                                                  04666000
046670 1200-CHECK-TRECEIV.                                              04667000
046680                                                                  04668000
046690     EXEC SQL                                                     04669000
046700        SELECT STATUS_CDE                                         04670000
046800             , PKGNG_CDE                                          04680000
046900             , ML_POST_TMST                                       04690000
047000        INTO   :RECEIV-STATUS-CDE                                 04700000
047100            ,  :RECEIV-PKGNG-CDE                                  04710000
047200            ,  :RECEIV-ML-POST-TMST                               04720000
047300          FROM TRECEIV A                                          04730000
047400         WHERE A.ORD_NBR         =  :WS008-PO-NUMBER              04740000
047500           AND A.REC_SEQ_NBR     =  :WS008-ORIG-REC-SEQ-NBR       04750000
047600     END-EXEC.                                                    04760000
047700                                                                  04770000
047800     EVALUATE TRUE                                                04780000
047900         WHEN SQLCODE = ZERO                                      04790000
048000             IF RECEIV-STATUS-CDE = 'VE'                          04800000
048100                SET PS-ORIG-RCVR-VRFD TO TRUE                     04810000
048200             END-IF                                               04820000
048300         WHEN SQLCODE = +100                                      04830000
048400         WHEN SQLWARN0 NOT = SPACES                               04840000
048500         WHEN SQLCODE NOT EQUAL ZERO                              04850000
048510             INITIALIZE PV-CICS-MSG-AREA                          04851009
048600             SET PS-ERROR                                         04860000
048700                 WS008-INVALID-SQL    TO TRUE                     04870000
048800             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       04880000
048810             MOVE WS008-PO-NUMBER         TO PV-DISP-PO           04881003
048820             MOVE WS008-ORIG-REC-SEQ-NBR  TO PV-DISP-RCVR-SEQ-NBR 04882003
048900             STRING   ' WSKCS311-1200-'                           04890000
049000                      ' CALLED BY-'                               04900000
049100                      WS008-PROGRAM-NAME                          04910000
049200                      '  SQL='                                    04920003
049300                      PV-DISPLAY-SQLCODE                          04930000
049410                      ' PO:'  PV-DISP-PO                          04941003
049420                      '-'     PV-DISP-RCVR-SEQ-NBR                04942003
049500                      DELIMITED BY SIZE                           04950000
049600                                      INTO PV-CICS-MSG-AREA       04960000
049700             PERFORM 9999-WRITE-TO-CSSL                           04970000
049800             MOVE '1200-'                TO WS008-CRA-REQ-ID      04980000
049900             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      04990000
050000             SET WS008-INVALID-SQL TO TRUE                        05000000
050100             PERFORM 9998-RETURN                                  05010000
050200     END-EVALUATE.                                                05020000
050300                                                                  05030000
050400 1300-SELECT-PKSLIP.                                              05040000
050500                                                                  05050000
050600     EXEC SQL                                                     05060000
050700        SELECT A.SEQ_NBR                                          05070000
050800              ,A.BOL_NBR                                          05080000
050900              ,A.PRO_NBR                                          05090000
051000        INTO :PKSLIP-SEQ-NBR                                      05100000
051100          ,  :PKSLIP-BOL-NBR                                      05110000
051200          ,  :PKSLIP-PRO-NBR                                      05120000
051300        FROM TPKSLIP  A                                           05130000
051400           , TINPKSU  B                                           05140000
051500        WHERE A.PO_NBR        = :WS008-PO-NUMBER                  05150000
051600          AND A.PO_NBR        = B.PO_NBR                          05160000
051700          AND A.SEQ_NBR       = B.SEQ_NBR                         05170000
051800          AND B.SHIPT_UNT_ID  = :WS008-SHIPT-UNT-ID               05180000
051900          AND VER_STAT_CDE    = 'A'                               05190000
051910     END-EXEC.                                                    05191000
051920                                                                  05192000
051930     EVALUATE TRUE                                                05193000
051940         WHEN SQLCODE = ZERO                                      05194000
051950             MOVE PKSLIP-SEQ-NBR TO WS008-ORIG-PKSL-SEQ-NBR       05195000
051960             MOVE PKSLIP-BOL-NBR TO WS008-ORIG-BOL-NBR            05196000
051970             MOVE PKSLIP-PRO-NBR TO WS008-ORIG-PRO-NBR            05197000
051980         WHEN SQLCODE = +100                                      05198000
051990             CONTINUE                                             05199000
051991         WHEN SQLWARN0 NOT = SPACES                               05199100
051992         WHEN SQLCODE NOT EQUAL ZERO                              05199200
051994             SET PS-ERROR                                         05199400
051995                 WS008-INVALID-SQL    TO TRUE                     05199500
051996             INITIALIZE PV-CICS-MSG-AREA                          05199611
051997             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       05199700
051998             MOVE  WS008-PO-NUMBER    TO PV-DISP-PO               05199803
051999             MOVE  WS008-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID     05199903
052000             STRING   ' WSKCS311-1300-'                           05200000
052001                      ' CALLED BY-'                               05200100
052002                      WS008-PROGRAM-NAME                          05200200
052003                      '  SQL='                                    05200303
052004                      PV-DISPLAY-SQLCODE                          05200400
052010                      ' PO:'  PV-DISP-PO                          05201003
052011                      '  '    PV-DISP-SHIPT-UNT-ID                05201103
052012                      DELIMITED BY SIZE                           05201200
052013                                      INTO PV-CICS-MSG-AREA       05201300
052014             PERFORM 9999-WRITE-TO-CSSL                           05201400
052015             MOVE '1300-'                TO WS008-CRA-REQ-ID      05201509
052016             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      05201600
052017             SET WS008-INVALID-SQL TO TRUE                        05201700
052018             PERFORM 9998-RETURN                                  05201800
052019     END-EVALUATE.                                                05201900
052020                                                                  05202000
052021 1400-SEL-ADD-UPD-PKSLIP.                                         05202100
052022                                                                  05202200
052023     EXEC SQL                                                     05202300
052024        SELECT A.SEQ_NBR                                          05202400
052025        INTO :PKSLIP-SEQ-NBR                                      05202500
052026        FROM TPKSLIP  A                                           05202600
052027        WHERE A.PO_NBR        = :WS008-PO-NUMBER                  05202700
052028          AND A.REC_SEQ_NBR   = :WS008-ORIG-REC-SEQ-NBR           05202800
052029          AND VER_STAT_CDE    = 'A'                               05202900
052030        FETCH FIRST 1 ROW ONLY                                    05203019
052031     END-EXEC.                                                    05203100
052032                                                                  05203200
052033     EVALUATE TRUE                                                05203300
052034         WHEN SQLCODE = ZERO                                      05203400
052035         WHEN SQLCODE = -811                                      05203516
052036             SET PS-CRE-SKU-LVL-PKSL-NO TO TRUE                   05203616
052037*                                                                 05203721
052038** DMH 2/11/14 - BEGIN                                            05203821
052039*                                                                 05203921
052040            IF  WS008-ORIG-PKSL-SEQ-NBR   = ZEROES                05204021
052041                MOVE  PKSLIP-SEQ-NBR                              05204121
052042                  TO  WS008-ORIG-PKSL-SEQ-NBR                     05204221
052043            END-IF                                                05204321
052044*                                                                 05204421
052045** DMH 2/11/14 - END                                              05204521
052046*                                                                 05204621
052047*                                                                 05204717
052048** DMH TEST DISPLAY ONLY                                          05204817
052049*            MOVE SPACES TO PV-CICS-MSG-AREA                      05204922
052050*            MOVE PKSLIP-SEQ-NBR   TO  PV-DISPLAY-PKSL-SEQ-NBR    05205022
052051*            STRING   ' WSKCS311-1400-'                           05205122
052052*                     ' PACKSLIP SEQ:'                            05205222
052053*                      PV-DISPLAY-PKSL-SEQ-NBR                    05205322
052054*                     DELIMITED BY SIZE                           05205422
052055*                                     INTO PV-CICS-MSG-AREA       05205522
052056*            PERFORM 9999-WRITE-TO-CSSL                           05205622
052057*                                                                 05205717
052058** DMH TEST DISPLAY ONLY                                          05205817
052059*                                                                 05205917
052060         WHEN SQLCODE = +100                                      05206016
052061             SET PS-CRE-SKU-LVL-PKSL-YES TO TRUE                  05206116
052062         WHEN SQLWARN0 NOT = SPACES                               05206216
052063         WHEN SQLCODE NOT EQUAL ZERO                              05206316
052064             SET PS-ERROR                                         05206416
052065                 WS008-INVALID-SQL    TO TRUE                     05206516
052066             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       05206616
052067             MOVE WS008-PO-NUMBER         TO PV-DISP-PO           05206716
052068             MOVE WS008-ORIG-REC-SEQ-NBR  TO PV-DISP-RCVR-SEQ-NBR 05206816
052069             MOVE WS008-PO-LINE-NBR       TO PV-DISP-PO-LNE-NBR   05206916
052070             INITIALIZE PV-CICS-MSG-AREA                          05207016
052071             STRING   ' WSKCS311-1400-'                           05207100
052072                      ' CALLED BY-'                               05207200
052073                      WS008-PROGRAM-NAME                          05207300
052074                      '  SQL='                                    05207403
052075                      PV-DISPLAY-SQLCODE                          05207500
052076                      ' PO:'  PV-DISP-PO                          05207603
052077                      '-'     PV-DISP-RCVR-SEQ-NBR                05207703
052078                      '-'     PV-DISP-PO-LNE-NBR                  05207815
052079                      DELIMITED BY SIZE                           05207915
052080                                      INTO PV-CICS-MSG-AREA       05208015
052081             PERFORM 9999-WRITE-TO-CSSL                           05208115
052082             MOVE '1400-'                TO WS008-CRA-REQ-ID      05208215
052083             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      05208315
052084             SET WS008-INVALID-SQL TO TRUE                        05208415
052085             PERFORM 9998-RETURN                                  05208515
052086     END-EVALUATE.                                                05208615
052087                                                                  05208715
052088                                                                  05208815
052089 1500-PROCESS-DETACH-ONLY.                                        05208915
052090                                                                  05209015
052091     PERFORM 4100-PROCSS-SHUUPC-CSR-DETACH.                       05209115
052092                                                                  05209215
052093                                                                  05209315
052094 3000-ADD-PACK-SLIP-HEADER.                                       05209400
052095                                                                  05209500
052100     INITIALIZE DCLTPKSLIP.                                       05210000
052200                                                                  05220000
052300     MOVE WS008-OPER-UNT-ID        TO DK-OPER-UNT-ID.             05230000
052400     MOVE +1                       TO DK-FCLTY-ID.                05240000
052500     MOVE WS008-DEST-STR-NBR       TO DK-STR-NBR.                 05250000
052600     MOVE ZEROES                   TO PKSLIP-PKSL-PG-CNT.         05260000
052700                                                                  05270000
052800     MOVE +0                       TO PKSLIP-EXPTED-PKG-QTY.      05280000
052900                                                                  05290000
053000     MOVE WS008-SCAC-ID            TO PKSLIP-OWNER-SCAC-ID.       05300000
053100                                                                  05310000
053200                                                                  05320000
053300     MOVE WS008-NEW-REC-SEQ-NBR    TO PKSLIP-REC-SEQ-NBR.         05330000
053400     MOVE WS008-NEW-SHIP           TO PKSLIP-SHIPT-ID.            05340000
053500     MOVE WS008-ORIG-BOL-NBR       TO PKSLIP-BOL-NBR.             05350000
053600     MOVE WS008-ORIG-PRO-NBR       TO PKSLIP-PRO-NBR.             05360000
053700     MOVE PC-FA                    TO PKSLIP-CRE-SRC-CDE.         05370000
053800     MOVE PC-AC                    TO PKSLIP-PKSL-STAT-CDE.       05380000
053900     MOVE PC-A                     TO PKSLIP-VER-STAT-CDE.        05390000
054000                                                                  05400000
054100     MOVE PC-FRASTY-CRE-USER-ID    TO PKSLIP-CRE-UID              05410000
054200                                      PKSLIP-PKSL-NBR.            05420000
054300                                                                  05430000
054400                                                                  05440000
054500     MOVE WS008-ORIG-PKSL-SEQ-NBR                                 05450000
054600                         TO PKSLIP-ORIG-PKSL-SEQ-NBR.             05460000
054700     PERFORM 3100-GET-PO-VER-NBR.                                 05470000
054800     MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR.          05480000
054900                                                                  05490000
055000     PERFORM 3130-GET-NEXT-SEQ-NBR.                               05500000
055100     MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR              05510000
055200                                      WS008-NEW-PKSL-SEQ-NBR.     05520000
055300     PERFORM 3160-GET-VEND-SHIP-DTE.                              05530000
055400                                                                  05540000
055500     PERFORM 3200-CONTINUE-INSERT.                                05550000
055600                                                                  05560000
055700 3100-GET-PO-VER-NBR.                                             05570000
055800                                                                  05580000
055900     IF PS-LOG-MESSAGE                                            05590000
056000        MOVE ' WSKCS311-3100-GET-PO-VER-NBR '                     05600013
056100                                 TO PV-DISP-PARAGRAPH-NAME        05610000
056200        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           05620000
056300        PERFORM 9999-WRITE-TO-CSSL                                05630000
056400         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               05640000
056500         PERFORM 9999-WRITE-TO-CSSL                               05650000
056600     END-IF                                                       05660000
056700                                                                  05670000
056800     EXEC SQL                                                     05680000
056900          SELECT VER_NBR                                          05690000
057000            INTO :PURCHS-VER-NBR                                  05700000
057100            FROM TPURCHS                                          05710000
057200           WHERE PO_NBR         = :WS008-PO-NUMBER                05720000
057300             AND VER_STATUS_CDE = :PC-A                           05730000
057400     END-EXEC                                                     05740000
057500                                                                  05750000
057600     EVALUATE TRUE                                                05760000
057700         WHEN SQLCODE = ZERO                                      05770000
057800             CONTINUE                                             05780000
057900         WHEN SQLCODE = +100                                      05790000
058000         WHEN SQLWARN0 NOT = SPACES                               05800000
058100         WHEN SQLCODE  NOT = ZERO                                 05810000
058110             INITIALIZE PV-CICS-MSG-AREA                          05811008
058200             SET WS008-INVALID-SQL                                05820000
058300                 PS-ERROR              TO TRUE                    05830000
058400             MOVE WS008-PO-NUMBER TO  PV-DISP-PO                  05840000
058500             MOVE WS008-NEW-REC-SEQ-NBR                           05850000
058600                                      TO PV-DISP-RCVR-SEQ-NBR     05860000
058700             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       05870000
058800             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      05880000
058900             STRING   ' WSKCS311-3100-'                           05890000
059000                      ' CALLED BY-'                               05900000
059100                      WS008-PROGRAM-NAME                          05910000
059200                      ' PO:'                                      05920003
059210                      PV-DISP-OPER-UNT-ID                         05921003
059220                      '-'                                         05922003
059300                      PV-DISP-PO                                  05930000
059400                      '-'                                         05940003
059500                      PV-DISP-RCVR-SEQ-NBR                        05950000
059600                      '-'                                         05960003
059700                      PV-DISP-PO-LNE-NBR                          05970003
059800                      DELIMITED BY SIZE                           05980000
059900                                      INTO PV-CICS-MSG-AREA       05990000
060000             PERFORM 9999-WRITE-TO-CSSL                           06000000
060100             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      06010000
060200     END-EVALUATE.                                                06020000
060300                                                                  06030000
060400 3130-GET-NEXT-SEQ-NBR.                                           06040000
060500                                                                  06050000
060600     IF PS-LOG-MESSAGE                                            06060000
060700        MOVE ' WSKCS311 - 3130-GET-NEXT-SEQ-NBR'                  06070013
060800                                 TO PV-DISP-PARAGRAPH-NAME        06080000
060900        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           06090000
061000        PERFORM 9999-WRITE-TO-CSSL                                06100000
061100         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               06110000
061200         PERFORM 9999-WRITE-TO-CSSL                               06120000
061300     END-IF                                                       06130000
061400                                                                  06140000
061500     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             06150000
061600                                                                  06160000
061700     EXEC SQL                                                     06170000
061800          SELECT MAX(SEQ_NBR)                                     06180000
061900            INTO :PV-MAX-SEQ-NBR :DN-SEQ-NBR-IND                  06190000
062000            FROM TPKSLIP                                          06200000
062100           WHERE PO_NBR = :WS008-PO-NUMBER                        06210000
062200     END-EXEC                                                     06220000
062300                                                                  06230000
062400     EVALUATE TRUE                                                06240000
062500         WHEN SQLCODE = +0                                        06250000
062600            IF DN-SEQ-NBR-IND = -1                                06260000
062700               MOVE +1          TO PV-NEXT-SEQ-NBR                06270000
062800            ELSE                                                  06280000
062900               COMPUTE PV-NEXT-SEQ-NBR = PV-MAX-SEQ-NBR + 1       06290000
063000            END-IF                                                06300000
063100         WHEN SQLCODE = +100                                      06310000
063200            MOVE +1          TO PV-NEXT-SEQ-NBR                   06320000
063300         WHEN SQLWARN0 NOT = SPACES                               06330000
063400         WHEN SQLCODE  NOT = ZERO                                 06340000
063410             INITIALIZE PV-CICS-MSG-AREA                          06341008
063500             SET WS008-INVALID-SQL     TO TRUE                    06350000
063600             MOVE WS008-PO-NUMBER TO  PV-DISP-PO                  06360000
063700             MOVE WS008-NEW-REC-SEQ-NBR                           06370000
063800                                      TO PV-DISP-RCVR-SEQ-NBR     06380000
063900             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       06390000
064000             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      06400000
064100             STRING   ' WSKCS311-3100-'                           06410000
064200                      ' CALLED BY-'                               06420000
064300                      WS008-PROGRAM-NAME                          06430000
064400                      ' PO:'                                      06440003
064410                      PV-DISP-OPER-UNT-ID                         06441003
064420                      '-'                                         06442003
064500                      PV-DISP-PO                                  06450000
064600                      '-'                                         06460003
064700                      PV-DISP-RCVR-SEQ-NBR                        06470000
064800                      '-'                                         06480003
064900                      PV-DISP-PO-LNE-NBR                          06490003
065000                      DELIMITED BY SIZE                           06500000
065100                                      INTO PV-CICS-MSG-AREA       06510000
065200             PERFORM 9999-WRITE-TO-CSSL                           06520000
065300             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      06530000
065400     END-EVALUATE.                                                06540000
065500                                                                  06550000
065600 3160-GET-VEND-SHIP-DTE.                                          06560000
065700                                                                  06570000
065800     EXEC SQL                                                     06580000
065900         SELECT VEND_SHIP_DTE                                     06590000
066000             ,  ASN_NBR                                           06600000
066100         INTO :PKSLIP-VEND-SHIP-DTE                               06610000
066200             ,:PKSLIP-ASN-NBR                                     06620000
066300           FROM TPKSLIP A                                         06630000
066400          WHERE A.PO_NBR         =  :WS008-PO-NUMBER              06640000
066500            AND A.SEQ_NBR        =  :WS008-ORIG-PKSL-SEQ-NBR      06650000
066600            AND A.VER_STAT_CDE   =  'A'                           06660000
066700     END-EXEC.                                                    06670000
066800                                                                  06680000
066900     EVALUATE TRUE                                                06690000
067000         WHEN SQLCODE = +0                                        06700000
067100            CONTINUE                                              06710000
067200         WHEN SQLCODE = +100                                      06720000
067300            MOVE PC-DEFAULT-DATE          TO PKSLIP-VEND-SHIP-DTE 06730000
067400         WHEN SQLWARN0 NOT = SPACES                               06740000
067500         WHEN SQLCODE  NOT = ZERO                                 06750000
067600             SET WS008-INVALID-SQL     TO TRUE                    06760000
067700             MOVE WS008-PO-NUMBER TO  PV-DISP-PO                  06770000
067800             MOVE WS008-ORIG-PKSL-SEQ-NBR                         06780000
067900                                      TO PV-DISP-SEQ-NBR          06790000
068000             STRING   ' WSKCS311-3160-'                           06800000
068100                      ' CALLED BY-'                               06810000
068200                      WS008-PROGRAM-NAME                          06820000
068300                      ' PO:'                                      06830003
068400                      PV-DISP-PO                                  06840000
068500                      ' PKSLP:'                                   06850003
068600                      PV-DISP-SEQ-NBR                             06860000
068700                      DELIMITED BY SIZE                           06870000
068800                                      INTO PV-CICS-MSG-AREA       06880000
068900             PERFORM 9999-WRITE-TO-CSSL                           06890000
069000             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      06900000
069100     END-EVALUATE.                                                06910000
069200                                                                  06920000
069300 3200-CONTINUE-INSERT.                                            06930000
069400                                                                  06940000
069500     SET PS-PKSLIP-NOT-INSERTED    TO TRUE.                       06950000
069600     PERFORM 3210-GET-CURRENT-TMST.                               06960000
069700     PERFORM 3220-INSERT-LOOP                                     06970000
069800             UNTIL PS-PKSLIP-INSERTED.                            06980000
069900                                                                  06990000
070000 3210-GET-CURRENT-TMST.                                           07000000
070100                                                                  07010000
070200     IF PS-LOG-MESSAGE                                            07020000
070300        MOVE ' WSKCS311-3210-GET-CURRENT-TMST'                    07030013
070400                                 TO PV-DISP-PARAGRAPH-NAME        07040000
070500        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           07050000
070600        PERFORM 9999-WRITE-TO-CSSL                                07060000
070700         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               07070000
070800         PERFORM 9999-WRITE-TO-CSSL                               07080000
070900     END-IF                                                       07090000
071000                                                                  07100000
071100                                                                  07110000
071200     EXEC SQL                                                     07120000
071300          SET :PV-DB2-TMST         =  CURRENT TIMESTAMP           07130000
071400     END-EXEC.                                                    07140000
071500                                                                  07150000
071600     EVALUATE TRUE                                                07160000
071700         WHEN SQLCODE = ZERO                                      07170000
071800           SET PV-DB2-TMST-SS-01                                  07180000
071900               PV-DB2-TMST-MS-ZERO   TO  TRUE                     07190000
072000         WHEN SQLWARN0 NOT = SPACES                               07200000
072100         WHEN SQLCODE  NOT = ZERO                                 07210000
072200             SET WS008-INVALID-SQL     TO TRUE                    07220000
072300             MOVE WS008-PO-NUMBER TO  PV-DISP-PO                  07230000
072400             MOVE WS008-NEW-REC-SEQ-NBR                           07240000
072500                                      TO PV-DISP-RCVR-SEQ-NBR     07250000
072600             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       07260000
072700             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      07270000
072800             STRING   ' WSKCS311-3210-'                           07280000
072900                      ' CALLED BY-'                               07290000
073000                      WS008-PROGRAM-NAME                          07300000
073100                      ' PO:'                                      07310003
073110                      PV-DISP-OPER-UNT-ID                         07311003
073120                      '-'                                         07312003
073200                      PV-DISP-PO                                  07320000
073300                      '-'                                         07330003
073400                      PV-DISP-RCVR-SEQ-NBR                        07340000
073500                      '-'                                         07350003
073600                      PV-DISP-PO-LNE-NBR                          07360003
073700                      DELIMITED BY SIZE                           07370000
073800                                      INTO PV-CICS-MSG-AREA       07380000
073900             PERFORM 9999-WRITE-TO-CSSL                           07390000
074000             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      07400000
074100     END-EVALUATE.                                                07410000
074200/                                                                 07420000
074300*----------------------------------------------------------------*07430000
074400*    THIS ROUTINE ADDED TO PRECLUDE LOGICAL DUPLICATES FROM      *07440000
074500*    BEING INSERTED.  WHEN 2 USERS ARE ADDING PACK SLIPS TO      *07450000
074600*    THE SAME PO, IT IS POSSIBLE TO OBTAIN THE SAME SEQUENCE     *07460000
074700*    NUMBER (LOGICAL DUPLICATE).  BECAUSE THE TIMSTAMP IS PART   *07470000
074800*    OF THE PHYSICAL KEY, NO -803 OCCURS.  IN 5001, WE FORCE     *07480000
074900*    A 01 IN THE SECONDS FIELD AND ALL ZEROES IN THE MICRO-      *07490000
075000*    SECONDS FIELD.  THIS WILL CAUSE A -803 WHICH IS HANDLED     *07500000
075100*    HERE BY ADDING 1 TO THE SEQUENCE NUMBER.                    *07510000
075200*----------------------------------------------------------------*07520000
075300                                                                  07530000
075400 3220-INSERT-LOOP.                                                07540000
075500                                                                  07550000
075600     PERFORM 3240-INSERT-TPKSLIP.                                 07560000
075700                                                                  07570000
075800                                                                  07580000
075900 3240-INSERT-TPKSLIP.                                             07590000
076000                                                                  07600000
076100     IF PS-LOG-MESSAGE                                            07610000
076200        MOVE ' WSKCS311-3240-INSERT-TPKSLIP '                     07620013
076300                                 TO PV-DISP-PARAGRAPH-NAME        07630000
076400        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           07640000
076500        PERFORM 9999-WRITE-TO-CSSL                                07650000
076600         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               07660000
076700         PERFORM 9999-WRITE-TO-CSSL                               07670000
076800     END-IF                                                       07680000
076900                                                                  07690000
077000                                                                  07700000
077100     EXEC SQL                                                     07710000
077200        INSERT INTO TPKSLIP                                       07720000
077300            (PO_NBR,                                              07730000
077400             SEQ_NBR,                                             07740000
077500             CRE_TMST,                                            07750000
077600             VER_STAT_CDE,                                        07760000
077700             OPER_UNT_ID,                                         07770000
077800             FCLTY_ID,                                            07780000
077900             PKSL_NBR,                                            07790000
078000             STR_DEST_NBR,                                        07800000
078100             REC_SEQ_NBR,                                         07810000
078200             SHIPT_ID,                                            07820000
078300             BOL_NBR,                                             07830000
078400             PRO_NBR,                                             07840000
078500             PKSL_STAT_CDE,                                       07850000
078600             CRE_UID,                                             07860000
078700             PO_VER_NBR,                                          07870000
078800             CRE_SRC_CDE,                                         07880000
078900             EXPTED_PKG_QTY,                                      07890000
079000             OWNER_SCAC_ID,                                       07900000
079100             ASN_NBR,                                             07910000
079200             VEND_SHIP_DTE,                                       07920000
079300             PKSL_PG_CNT,                                         07930000
079400             CONTNR_ID,                                           07940000
079500             ORIG_PKSL_SEQ_NBR)                                   07950000
079600     VALUES (:WS008-PO-NUMBER,                                    07960000
079700             :PKSLIP-SEQ-NBR,                                     07970000
079800             :PV-DB2-TMST,                                        07980000
079900             :PC-A,                                               07990000
080000             :DK-OPER-UNT-ID,                                     08000000
080100             :DK-FCLTY-ID,                                        08010000
080200             :PKSLIP-PKSL-NBR,                                    08020000
080300             :DK-STR-NBR,                                         08030000
080400             :PKSLIP-REC-SEQ-NBR,                                 08040000
080500             :PKSLIP-SHIPT-ID,                                    08050000
080600             :PKSLIP-BOL-NBR,                                     08060000
080700             :PKSLIP-PRO-NBR,                                     08070000
080800             :PKSLIP-PKSL-STAT-CDE,                               08080000
080900             :PKSLIP-CRE-UID,                                     08090000
081000             :PKSLIP-PO-VER-NBR,                                  08100000
081100             :PKSLIP-CRE-SRC-CDE,                                 08110000
081200             :PKSLIP-EXPTED-PKG-QTY,                              08120000
081300             :PKSLIP-OWNER-SCAC-ID,                               08130000
081400             :PKSLIP-ASN-NBR,                                     08140000
081500             :PKSLIP-VEND-SHIP-DTE,                               08150000
081600             :PKSLIP-PKSL-PG-CNT,                                 08160000
081700             :PKSLIP-CONTNR-ID,                                   08170000
081800             :PKSLIP-ORIG-PKSL-SEQ-NBR)                           08180000
081900        END-EXEC                                                  08190000
082000                                                                  08200000
082100        EVALUATE TRUE                                             08210000
082200           WHEN SQLCODE = +0                                      08220000
082300              SET PS-PKSLIP-INSERTED TO TRUE                      08230000
082400           WHEN SQLCODE = -803                                    08240000
082500              ADD 1                TO PKSLIP-SEQ-NBR              08250000
082600         WHEN SQLWARN0 NOT = SPACES                               08260000
082700         WHEN SQLCODE  NOT = ZERO                                 08270000
082800             SET WS008-INVALID-SQL     TO TRUE                    08280000
082900             MOVE DK-SHIPT-UNT-ID     TO PV-DISP-SHIPT-UNT-ID     08290000
082910             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      08291003
082920             MOVE WS008-PO-NUMBER     TO PV-DISP-PO               08292003
082930             MOVE PKSLIP-REC-SEQ-NBR  TO PV-DISP-RCVR-SEQ-NBR     08293003
082940             MOVE DK-STR-NBR          TO PV-DISP-STR-NBR          08294003
082950             MOVE PKSLIP-SEQ-NBR      TO PV-DISPLAY-PKSL-SEQ-NBR  08295006
083000             STRING   ' WSKCS311-3240-'                           08300000
083100                      ' CALLED BY-'                               08310000
083200                      WS008-PROGRAM-NAME                          08320000
083300                      ' CRTN:'  PV-DISP-SHIPT-UNT-ID              08330006
083410                      ' PO:'    PV-DISP-OPER-UNT-ID               08341006
083420                      '-'       PV-DISP-PO                        08342006
083430                      '-'       PV-DISP-RCVR-SEQ-NBR              08343006
083440                      '-'       PV-DISP-STR-NBR                   08344006
083450                      ' PKSLP:' PV-DISPLAY-PKSL-SEQ-NBR           08345006
083500                      DELIMITED BY SIZE                           08350000
083600                                      INTO PV-CICS-MSG-AREA       08360000
083700             PERFORM 9999-WRITE-TO-CSSL                           08370000
083800             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      08380000
083900        END-EVALUATE.                                             08390000
084000                                                                  08400000
084100                                                                  08410000
084200 4000-PROCESS-SHUUPC-CURSOR.                                      08420000
084300                                                                  08430000
084400                                                                  08440000
084500     SET PS-MORE-SHUUPC-YES TO TRUE.                              08450000
084600     PERFORM 4310-OPEN-SHUUPC-CURSOR.                             08460000
084700                                                                  08470000
084800     PERFORM 4320-FETCH-SHUUPC-CURSOR                             08480000
084900       UNTIL PS-MORE-SHUUPC-NO                                    08490000
085000     PERFORM 4350-CLOSE-SHUUPC-CURSOR.                            08500000
085100                                                                  08510000
085200     PERFORM 4410-UPDATE-TINPKSU.                                 08520000
085300                                                                  08530000
085400 4100-PROCSS-SHUUPC-CSR-DETACH.                                   08540000
085500     SET  PS-FIRST-PKSLIP-LINE                                    08550000
085600          PS-MORE-SHUUPC-YES TO TRUE.                             08560000
085700     PERFORM 4310-OPEN-SHUUPC-CURSOR.                             08570000
085800     PERFORM 4320-FETCH-SHUUPC-CURSOR                             08580000
085900       UNTIL PS-MORE-SHUUPC-NO                                    08590000
086000     PERFORM 4350-CLOSE-SHUUPC-CURSOR.                            08600000
086100                                                                  08610000
086200     PERFORM 4410-UPDATE-TINPKSU.                                 08620000
086300                                                                  08630000
086400 4310-OPEN-SHUUPC-CURSOR.                                         08640000
086500                                                                  08650000
086600     EXEC SQL                                                     08660000
086700         OPEN SHUUPC-CURSOR                                       08670000
086800     END-EXEC.                                                    08680000
086900                                                                  08690000
087000     EVALUATE TRUE                                                08700000
087100       WHEN SQLCODE = ZERO                                        08710000
087200           SET PS-MORE-SHUUPC-YES TO TRUE                         08720000
087300                                                                  08730000
087400       WHEN SQLWARN0 NOT = SPACES                                 08740000
087500       WHEN SQLCODE  NOT = ZERO                                   08750000
087510           MOVE DK-SHIPT-UNT-ID  TO PV-DISP-SHIPT-UNT-ID          08751003
087600           MOVE WS008-PO-NUMBER  TO PV-DISP-PO                    08760003
087700           MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR          08770003
087800           MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID           08780003
087900           MOVE RECITM-PREPK-ID  TO PV-DISP-PACK-ID               08790003
088000           MOVE SQLCODE          TO PV-DISPLAY-SQLCODE            08800003
088010           INITIALIZE PV-CICS-MSG-AREA                            08801003
088100           STRING   ' WSKCS311-4310-'                             08810000
088200                      ' CALLED BY-'                               08820000
088300                      WS008-PROGRAM-NAME                          08830000
088400                      '  SQL='                                    08840003
088500                      PV-DISPLAY-SQLCODE                          08850000
088510                      ' '      PV-DISP-SHIPT-UNT-ID               08851003
088600                      ' PO:'   PV-DISP-OPER-UNT-ID                08860003
088700                      '-'      PV-DISP-PO                         08870003
088900                      '-'      PV-DISP-RCVR-SEQ-NBR               08890003
089200                      ' PACK:' PV-DISP-PACK-ID                    08920003
089400                      DELIMITED BY SIZE                           08940000
089500                                      INTO PV-CICS-MSG-AREA       08950000
089600           PERFORM 9999-WRITE-TO-CSSL                             08960000
089700           MOVE '4310-'                TO WS008-CRA-REQ-ID        08970000
089800           MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG        08980000
089900           PERFORM 9998-RETURN                                    08990000
090000     END-EVALUATE.                                                09000000
090100                                                                  09010000
090200 4320-FETCH-SHUUPC-CURSOR.                                        09020000
090300                                                                  09030000
090400                                                                  09040000
090500     EXEC SQL                                                     09050000
090600         FETCH  SHUUPC-CURSOR                                     09060000
090700          INTO :SHUUPC-TRN-LNE-NBR                                09070000
090800             , :SHUUPC-SHPD-QTY                                   09080000
090900     END-EXEC.                                                    09090000
091000                                                                  09100000
091100     EVALUATE TRUE                                                09110000
091200       WHEN SQLCODE = ZERO                                        09120000
091300           MOVE SHUUPC-SHPD-QTY    TO PV-SHUUPC-SHPD-QTY          09130000
091400           IF WS008-CREATE-PKSLIP                                 09140000
091500              PERFORM 4345-PRCESS-PKSLIP-CRE-DETAIL               09150000
091600           ELSE                                                   09160000
091700              PERFORM 4500-PRCESS-PKSLIP-DETACH                   09170000
091800           END-IF                                                 09180000
091900       WHEN SQLCODE = +100                                        09190000
092000           SET PS-MORE-SHUUPC-NO TO TRUE                          09200000
092100                                                                  09210000
092200       WHEN SQLWARN0 NOT = SPACES                                 09220000
092300       WHEN SQLCODE  NOT = ZERO                                   09230000
092310           MOVE DK-SHIPT-UNT-ID  TO PV-DISP-SHIPT-UNT-ID          09231003
092400           MOVE WS008-PO-NUMBER  TO PV-DISP-PO                    09240003
092500           MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR          09250003
092600           MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID           09260003
092700           MOVE RECITM-PREPK-ID  TO PV-DISP-PACK-ID               09270003
092800           MOVE SQLCODE          TO PV-DISPLAY-SQLCODE            09280003
092810           INITIALIZE PV-CICS-MSG-AREA                            09281008
092900           STRING   ' WSKCS311-4320-'                             09290000
093000                      ' CALLED BY-'                               09300000
093100                      WS008-PROGRAM-NAME                          09310000
093200                      '  SQL='                                    09320003
093300                      PV-DISPLAY-SQLCODE                          09330000
093310                      ' '      PV-DISP-SHIPT-UNT-ID               09331003
093320                      ' PO:'   PV-DISP-OPER-UNT-ID                09332003
093330                      '-'      PV-DISP-PO                         09333003
093340                      '-'      PV-DISP-RCVR-SEQ-NBR               09334003
093350                      ' PACK:' PV-DISP-PACK-ID                    09335003
094200                      DELIMITED BY SIZE                           09420000
094300                                      INTO PV-CICS-MSG-AREA       09430000
094400           PERFORM 9999-WRITE-TO-CSSL                             09440000
094500           MOVE '4320-'                TO WS008-CRA-REQ-ID        09450000
094600           MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG        09460000
094700           PERFORM 9998-RETURN                                    09470000
094800     END-EVALUATE.                                                09480000
094900                                                                  09490000
095000 4330-SELECT-PURITM-VER-NBR.                                      09500000
095100                                                                  09510000
095200     IF PS-LOG-MESSAGE                                            09520000
095300        MOVE ' WSKCS311-4330-SELECT-PURITM-VER-NBR'               09530013
095400                                 TO PV-DISP-PARAGRAPH-NAME        09540000
095500        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           09550000
095600        PERFORM 9999-WRITE-TO-CSSL                                09560000
095700         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               09570000
095800         PERFORM 9999-WRITE-TO-CSSL                               09580000
095900     END-IF                                                       09590000
096000                                                                  09600000
096100     EXEC SQL                                                     09610000
096200         SELECT  PURITM_VER_NBR                                   09620000
096300          INTO  :PURITM-VER-NBR                                   09630000
096400           FROM TPKITEM                                           09640000
096500          WHERE PO_NBR         = :WS008-PO-NUMBER                 09650000
096600            AND SEQ_NBR        = :WS008-ORIG-PKSL-SEQ-NBR         09660000
096700            AND PKSL_LNE_NBR   = :SHUUPC-TRN-LNE-NBR              09670000
096800            AND VER_STAT_CDE   = 'A'                              09680000
096900     END-EXEC.                                                    09690000
097000                                                                  09700000
097100     EVALUATE TRUE                                                09710000
097200       WHEN SQLCODE = ZERO                                        09720000
097300           CONTINUE                                               09730000
097400       WHEN SQLCODE = +100                                        09740000
097500           PERFORM 4340-SEL-PURITM-RECITM-VER                     09750000
097600       WHEN SQLWARN0 NOT = SPACES                                 09760000
097700       WHEN SQLCODE  NOT = ZERO                                   09770000
097800           MOVE WS008-PO-NUMBER TO PV-DISP-PO                     09780000
097810           MOVE WS008-ORIG-PKSL-SEQ-NBR                           09781003
097820                                TO PV-DISPLAY-PKSL-SEQ-NBR        09782003
097900           MOVE DK-REC-SEQ-NBR  TO PV-DISP-RCVR-SEQ-NBR           09790003
098000           MOVE DK-OPER-UNT-ID  TO PV-DISP-OPER-UNT-ID            09800003
098100           MOVE DK-PKSL-LNE-NBR TO PV-DISP-PO-LNE-NBR             09810003
098300           MOVE DK-STR-DEST-NBR TO PV-DISP-STR-NBR                09830003
098500           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              09850000
098600           STRING   ' WSKCS311-4330-'                             09860000
098700                      ' CALLED BY-'                               09870000
098800                      WS008-PROGRAM-NAME                          09880000
098900                      '  SQL='                                    09890003
099000                      PV-DISPLAY-SQLCODE                          09900000
099010                      ' PKSL:'  PV-DISPLAY-PKSL-SEQ-NBR           09901003
099100                      ' PO:'    PV-DISP-OPER-UNT-ID               09910003
099200                      '-'       PV-DISP-PO                        09920003
099400                      '-'       PV-DISP-RCVR-SEQ-NBR              09940003
099500                      '-'       PV-DISP-PO-LNE-NBR                09950003
099600                      '-'       PV-DISP-STR-NBR                   09960003
100100                      DELIMITED BY SIZE                           10010000
100200                                      INTO PV-CICS-MSG-AREA       10020000
100300           PERFORM 9999-WRITE-TO-CSSL                             10030000
100400           MOVE '4330-'                TO WS008-CRA-REQ-ID        10040012
100500           MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG        10050000
100600           PERFORM 9998-RETURN                                    10060000
100700     END-EVALUATE.                                                10070000
100800                                                                  10080000
100900 4340-SEL-PURITM-RECITM-VER.                                      10090000
101000                                                                  10100000
101100     IF PS-LOG-MESSAGE                                            10110000
101200        MOVE ' WSKCS311-4340-SEL-PURITM-RECITM-VER'               10120013
101300                                 TO PV-DISP-PARAGRAPH-NAME        10130000
101400        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           10140000
101500        PERFORM 9999-WRITE-TO-CSSL                                10150000
101600         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               10160000
101700         PERFORM 9999-WRITE-TO-CSSL                               10170000
101800     END-IF                                                       10180000
101900                                                                  10190000
102000     EXEC SQL                                                     10200000
102100         SELECT VER_NBR                                           10210000
102200         INTO  :PURITM-VER-NBR                                    10220000
102300         FROM TPURITM A                                           10230000
102400             ,TRECITM B                                           10240000
102500         WHERE A.PO_NBR         = :WS008-PO-NUMBER                10250000
102600           AND A.PO_NBR         = B.ORD_NBR                       10260000
102700           AND B.REC_SEQ_NBR    = :WS008-ORIG-REC-SEQ-NBR         10270000
102800           AND A.APP_PO_LNE_NBR = :SHUUPC-TRN-LNE-NBR             10280000
102900           AND A.APP_PO_LNE_NBR = B.ORD_LNE_NBR                   10290000
103000           AND A.VER_STATUS_CDE = 'A'                             10300000
103100           AND B.VER_STATUS_CDE = 'A'                             10310000
103200           AND A.VER_NBR        = B.PO_VER_NBR                    10320000
103300     END-EXEC.                                                    10330000
103400                                                                  10340000
103500     EVALUATE TRUE                                                10350000
103600       WHEN SQLCODE = ZERO                                        10360000
103700            CONTINUE                                              10370000
103800       WHEN SQLWARN0 NOT = SPACES                                 10380000
103900       WHEN SQLCODE  NOT = ZERO                                   10390000
104000           MOVE WS008-PO-NUMBER TO PV-DISP-PO                     10400000
104100           MOVE WS008-ORIG-REC-SEQ-NBR                            10410003
104110                               TO PV-DISP-RCVR-SEQ-NBR            10411003
104200           MOVE DK-OPER-UNT-ID TO PV-DISP-OPER-UNT-ID             10420000
104300           MOVE SHUUPC-TRN-LNE-NBR                                10430003
104400                               TO PV-DISP-PO-LNE-NBR              10440000
104500           MOVE DK-STR-DEST-NBR                                   10450000
104600                               TO PV-DISP-STR-NBR                 10460000
104700           MOVE SQLCODE        TO PV-DISPLAY-SQLCODE              10470000
104800           STRING   ' WSKCS311-4340-'                             10480000
104900                      ' CALLED BY-'                               10490000
105000                      WS008-PROGRAM-NAME                          10500000
105100                      '  SQL='                                    10510003
105200                      PV-DISPLAY-SQLCODE                          10520000
105300                      ' PO:' PV-DISP-OPER-UNT-ID                  10530003
105400                      '-'    PV-DISP-PO                           10540003
105600                      '-'    PV-DISP-RCVR-SEQ-NBR                 10560003
106000                      '-'    PV-DISP-PO-LNE-NBR                   10600003
106200                      '-'    PV-DISP-STR-NBR                      10620003
106300                      DELIMITED BY SIZE                           10630000
106400                                      INTO PV-CICS-MSG-AREA       10640000
106500           PERFORM 9999-WRITE-TO-CSSL                             10650000
106600           MOVE '4340-'                TO WS008-CRA-REQ-ID        10660000
106700           MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG        10670000
106800           PERFORM 9998-RETURN                                    10680000
106900     END-EVALUATE.                                                10690000
107000                                                                  10700000
107100                                                                  10710000
107200 4345-PRCESS-PKSLIP-CRE-DETAIL.                                   10720000
107300                                                                  10730000
107400      MOVE    WS008-NEW-PKSL-SEQ-NBR   TO PKITEM-SEQ-NBR          10740000
107500                                          INPKSU-SEQ-NBR          10750000
107600      MOVE    SHUUPC-TRN-LNE-NBR       TO PKITEM-PKSL-LNE-NBR     10760000
107700                                          DK-PO-LNE-NBR           10770000
107800      MOVE    SHUUPC-SHPD-QTY          TO PKITEM-PKSL-ITM-QTY     10780000
107900      MOVE    WS008-NEW-SHIP           TO SHIPMT-SHIPT-ID         10790000
108000      MOVE    WS008-NEW-REC-SEQ-NBR    TO RECEIV-REC-SEQ-NBR      10800000
108100                                          SHPTPO-REC-SEQ-NBR.     10810000
108200      MOVE    WS008-SHIPT-UNT-ID       TO INPKSU-SHIPT-UNT-ID.    10820000
108300                                                                  10830000
108400      PERFORM 4330-SELECT-PURITM-VER-NBR.                         10840000
108500      MOVE    PURITM-VER-NBR           TO PKITEM-PURITM-VER-NBR   10850000
108600      PERFORM 4370-INSERT-TPKITEM.                                10860000
108700                                                                  10870000
108800                                                                  10880000
108900 4350-CLOSE-SHUUPC-CURSOR.                                        10890000
109000                                                                  10900000
109100     EXEC SQL                                                     10910000
109200         CLOSE SHUUPC-CURSOR                                      10920000
109300     END-EXEC.                                                    10930000
109400                                                                  10940000
109500     EVALUATE TRUE                                                10950000
109600       WHEN SQLCODE = ZERO                                        10960000
109700           CONTINUE                                               10970000
109800                                                                  10980000
109900       WHEN SQLWARN0 NOT = SPACES                                 10990000
110000       WHEN SQLCODE  NOT = ZERO                                   11000000
110010           MOVE DK-SHIPT-UNT-ID  TO PV-DISP-SHIPT-UNT-ID          11001003
110020           MOVE WS008-PO-NUMBER  TO PV-DISP-PO                    11002003
110030           MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR-SEQ-NBR          11003003
110040           MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID           11004003
110050           MOVE RECITM-PREPK-ID  TO PV-DISP-PACK-ID               11005003
110060           MOVE SQLCODE          TO PV-DISPLAY-SQLCODE            11006003
110070           INITIALIZE PV-CICS-MSG-AREA                            11007008
110600           STRING   ' WSKCS311-4350-'                             11060012
110700                      ' CALLED BY-'                               11070000
110800                      WS008-PROGRAM-NAME                          11080000
110900                      '  SQL='                                    11090003
111000                      PV-DISPLAY-SQLCODE                          11100000
111010                      PV-DISPLAY-SQLCODE                          11101003
111020                      ' '      PV-DISP-SHIPT-UNT-ID               11102003
111030                      ' PO:'   PV-DISP-OPER-UNT-ID                11103003
111040                      '-'      PV-DISP-PO                         11104003
111050                      '-'      PV-DISP-RCVR-SEQ-NBR               11105003
111060                      ' PACK:' PV-DISP-PACK-ID                    11106003
111900                      DELIMITED BY SIZE                           11190000
112000                                      INTO PV-CICS-MSG-AREA       11200000
112100           PERFORM 9999-WRITE-TO-CSSL                             11210000
112200           MOVE '4350-'                TO WS008-CRA-REQ-ID        11220012
112300           MOVE PV-CICS-MSG-AREA       TO WS008-CRA-RET-MSG       11230000
112400           PERFORM 9998-RETURN                                    11240000
112500     END-EVALUATE.                                                11250000
112600                                                                  11260000
112700                                                                  11270000
112800                                                                  11280000
112900 4370-INSERT-TPKITEM.                                             11290000
113000                                                                  11300000
113100     IF PS-LOG-MESSAGE                                            11310000
113200        MOVE ' WSKCS311-4370-INSERT-TPKITEM '                     11320013
113300                                 TO PV-DISP-PARAGRAPH-NAME        11330000
113400        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           11340000
113500        PERFORM 9999-WRITE-TO-CSSL                                11350000
113600         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               11360000
113700         PERFORM 9999-WRITE-TO-CSSL                               11370000
113800     END-IF                                                       11380000
113900                                                                  11390000
114000     EXEC SQL                                                     11400000
114100         INSERT INTO TPKITEM                                      11410000
114200         (    PO_NBR                                              11420000
114300          ,   SEQ_NBR                                             11430000
114400          ,   PKSL_LNE_NBR                                        11440000
114500          ,   CRE_TMST                                            11450000
114600          ,   VER_STAT_CDE                                        11460000
114700          ,   PKSL_ITM_QTY                                        11470000
114800          ,   CRE_UID                                             11480000
114900          ,   PURITM_VER_NBR)                                     11490000
115000         VALUES                                                   11500000
115100         (   :WS008-PO-NUMBER                                     11510000
115200          ,  :PKITEM-SEQ-NBR                                      11520000
115300          ,  :SHUUPC-TRN-LNE-NBR                                  11530000
115400          ,   CURRENT TIMESTAMP                                   11540000
115500          ,  'A'                                                  11550000
115600          ,  :PKITEM-PKSL-ITM-QTY                                 11560000
115700          ,  :PC-CURRENT-PROGRAM-NAME                             11570000
115800          ,  :PKITEM-PURITM-VER-NBR )                             11580000
115900     END-EXEC.                                                    11590000
116000                                                                  11600000
116100     EVALUATE TRUE                                                11610000
116200         WHEN SQLCODE = +0                                        11620000
116300             CONTINUE                                             11630000
116400         WHEN SQLWARN0 NOT = SPACES                               11640000
116500         WHEN SQLCODE < +0                                        11650000
116600         WHEN SQLCODE > +0                                        11660000
116700             SET PS-ERROR                                         11670000
116800                 WS008-INVALID-SQL    TO TRUE                     11680003
116900             MOVE WS008-PO-NUMBER     TO PV-DISP-PO               11690000
117000             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       11700000
117100             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     11710000
117200             MOVE DK-OPER-UNT-ID      TO PV-DISP-OPER-UNT-ID      11720000
117300             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          11730000
117301                                                                  11730103
117320             MOVE PKITEM-SEQ-NBR      TO PV-DISPLAY-PKSL-SEQ-NBR  11732007
117400             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       11740000
117500             STRING   ' WSKCS311-4370-'                           11750000
117600                      ' CALLED BY-'                               11760000
117700                      WS008-PROGRAM-NAME                          11770000
117800                      '  SQL='                                    11780003
117900                      PV-DISPLAY-SQLCODE                          11790000
117910                      ' PKSLP:' PV-DISPLAY-PKSL-SEQ-NBR           11791007
118000                      ' PO:'    PV-DISP-OPER-UNT-ID               11800007
118100                      '-'       PV-DISP-PO                        11810007
118110                      '-'       PV-DISP-RCVR-SEQ-NBR              11811007
118300                      '-'       PV-DISP-PO-LNE-NBR                11830007
118700                      '-'       PV-DISP-STR-NBR                   11870007
119000                      DELIMITED BY SIZE                           11900000
119100                                      INTO PV-CICS-MSG-AREA       11910000
119200             PERFORM 9999-WRITE-TO-CSSL                           11920000
119300             MOVE '4370-'                TO WS008-CRA-REQ-ID      11930000
119400             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      11940000
119500             PERFORM 9998-RETURN                                  11950000
119600     END-EVALUATE.                                                11960000
119700                                                                  11970000
119800 4410-UPDATE-TINPKSU.                                             11980000
119900                                                                  11990000
120000     IF PS-LOG-MESSAGE                                            12000000
120100        MOVE ' WSKCS311-4410-UPDATE-TINPKSU '                     12010013
120200                                 TO PV-DISP-PARAGRAPH-NAME        12020000
120300        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           12030000
120400        PERFORM 9999-WRITE-TO-CSSL                                12040000
120500         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               12050000
120600         PERFORM 9999-WRITE-TO-CSSL                               12060000
120700     END-IF                                                       12070000
120800     EXEC SQL                                                     12080000
120900       UPDATE TINPKSU                                             12090000
121000          SET SEQ_NBR           = :WS008-NEW-PKSL-SEQ-NBR         12100000
121100             ,ORIG_PKSL_SEQ_NBR = :WS008-ORIG-PKSL-SEQ-NBR        12110000
121200        WHERE SHIPT_UNT_ID      = :WS008-SHIPT-UNT-ID             12120000
121300          AND PO_NBR            = :WS008-PO-NUMBER                12130000
121400     END-EXEC.                                                    12140000
121500                                                                  12150000
121600     EVALUATE TRUE                                                12160000
121700         WHEN SQLCODE = +0                                        12170000
121800             CONTINUE                                             12180000
121900         WHEN SQLWARN0 NOT = SPACES                               12190000
122000         WHEN SQLCODE < +0                                        12200000
122100         WHEN SQLCODE > +0                                        12210000
122200             SET PS-ERROR                                         12220000
122300                 WS008-INVALID-SQL    TO TRUE                     12230000
122400             MOVE WS008-PO-NUMBER     TO PV-DISP-PO               12240000
122500             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     12250000
122600             MOVE SHUUPC-TRN-LNE-NBR  TO PV-DISP-PO-LNE-NBR       12260000
122700             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          12270000
122800             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12280000
122810             INITIALIZE PV-CICS-MSG-AREA                          12281004
122900             STRING   ' WSKCS311-4410-'                           12290000
123000                      ' CALLED BY-'                               12300000
123100                      WS008-PROGRAM-NAME                          12310000
123200                      '  SQL='                                    12320003
123300                      PV-DISPLAY-SQLCODE                          12330000
123400                      ' PO:'  PV-DISP-PO                          12340004
123700                      '-'     PV-DISP-RCVR-SEQ-NBR                12370004
123900                      '-'     PV-DISP-PO-LNE-NBR                  12390004
124100                      ' STR:' PV-DISP-STR-NBR                     12410004
124200                      DELIMITED BY SIZE                           12420000
124300                                      INTO PV-CICS-MSG-AREA       12430000
124400             PERFORM 9999-WRITE-TO-CSSL                           12440000
124401                                                                  12440104
124402             MOVE WS008-NEW-PKSL-SEQ-NBR                          12440204
124403               TO PV-DISPLAY-PKSL-SEQ-NBR                         12440304
124404             MOVE WS008-ORIG-PKSL-SEQ-NBR                         12440404
124405               TO PV-DISPLAY-PKSL-SEQ-NBR-2                       12440504
124406             MOVE WS008-SHIPT-UNT-ID      TO PV-DISP-SHIPT-UNT-ID 12440604
124407             MOVE WS008-PO-NUMBER         TO PV-DISP-PO           12440704
124408             INITIALIZE PV-CICS-MSG-AREA                          12440804
124410             STRING   ' WSKCS311-4410-'                           12441004
124420                      ' CALLED BY-'                               12442004
124430                      WS008-PROGRAM-NAME                          12443004
124440                      '  CRTN:' PV-DISP-SHIPT-UNT-ID              12444005
124460                      ' PO:'    PV-DISP-PO                        12446005
124470                      ' ORIG:'  PV-DISPLAY-PKSL-SEQ-NBR-2         12447005
124480                      ' NEW:'   PV-DISPLAY-PKSL-SEQ-NBR           12448004
124491                      DELIMITED BY SIZE                           12449104
124492                                      INTO PV-CICS-MSG-AREA       12449204
124493             PERFORM 9999-WRITE-TO-CSSL                           12449304
124500             MOVE '4410-'                TO WS008-CRA-REQ-ID      12450004
124600             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      12460000
124700             PERFORM 9998-RETURN                                  12470000
124800     END-EVALUATE.                                                12480000
124900                                                                  12490000
125000                                                                  12500000
125100 4500-PRCESS-PKSLIP-DETACH.                                       12510000
125200                                                                  12520000
125300      MOVE WS008-NEW-PKSL-SEQ-NBR TO PKITEM-SEQ-NBR.              12530000
125400      MOVE SHUUPC-TRN-LNE-NBR     TO PKITEM-PKSL-LNE-NBR.         12540000
125500                                                                  12550000
125600      PERFORM 4345-PRCESS-PKSLIP-CRE-DETAIL.                      12560000
125700                                                                  12570000
125800 4600-CHECK-PKSLIP-ITEM.                                          12580000
125900                                                                  12590000
126000     IF PS-LOG-MESSAGE                                            12600000
126100        MOVE ' WSKCS311-4600-CHECK-PKSLIP-ITEM'                   12610013
126200                                 TO PV-DISP-PARAGRAPH-NAME        12620000
126300        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           12630000
126400        PERFORM 9999-WRITE-TO-CSSL                                12640000
126500         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               12650000
126600         PERFORM 9999-WRITE-TO-CSSL                               12660000
126700     END-IF                                                       12670000
126800                                                                  12680000
126900     EXEC SQL                                                     12690000
127000         SELECT  PKSL_ITM_QTY                                     12700000
127100          INTO  :PKITEM-PKSL-ITM-QTY                              12710000
127110           FROM TPKITEM                                           12711000
127120          WHERE PO_NBR         = :WS008-PO-NUMBER                 12712000
127130            AND SEQ_NBR        = :WS008-ORIG-PKSL-SEQ-NBR         12713000
127140            AND PKSL_LNE_NBR   = :WS008-PO-LINE-NBR               12714000
127150            AND VER_STAT_CDE   = 'A'                              12715000
127160     END-EXEC.                                                    12716000
127170                                                                  12717000
127180     EVALUATE TRUE                                                12718000
127190       WHEN SQLCODE = ZERO                                        12719000
127191           SET PS-FOUND-PKITEM-YES TO TRUE                        12719100
127192       WHEN SQLCODE = +100                                        12719200
127193           SET PS-FOUND-PKITEM-NO TO TRUE                         12719300
127194       WHEN SQLWARN0 NOT = SPACES                                 12719400
127195       WHEN SQLCODE  NOT = ZERO                                   12719500
127196           MOVE WS008-PO-NUMBER   TO PV-DISP-PO                   12719604
127197           MOVE DK-REC-SEQ-NBR    TO PV-DISP-RCVR-SEQ-NBR         12719704
127198           MOVE DK-OPER-UNT-ID    TO PV-DISP-OPER-UNT-ID          12719804
127199           MOVE WS008-PO-LINE-NBR TO PV-DISP-PO-LNE-NBR           12719904
127201           MOVE DK-STR-DEST-NBR   TO PV-DISP-STR-NBR              12720104
127203           MOVE SQLCODE           TO PV-DISPLAY-SQLCODE           12720304
127204                                                                  12720404
127206           MOVE WS008-ORIG-PKSL-SEQ-NBR                           12720604
127207             TO PV-DISPLAY-PKSL-SEQ-NBR                           12720704
127208           INITIALIZE PV-CICS-MSG-AREA                            12720804
127209           STRING   ' WSKCS311-4600-'                             12720904
127210                      ' CALLED BY-'                               12721004
127211                      WS008-PROGRAM-NAME                          12721104
127212                      '  SQL='                                    12721204
127213                      PV-DISPLAY-SQLCODE                          12721304
127214                      ' PO:'   PV-DISP-OPER-UNT-ID                12721404
127215                      '-'      PV-DISP-PO                         12721504
127217                      '-'      PV-DISP-RCVR-SEQ-NBR               12721704
127221                      '-'      PV-DISP-PO-LNE-NBR                 12722104
127223                      '-'      PV-DISP-STR-NBR                    12722304
127224                      ' PKSL:' PV-DISPLAY-PKSL-SEQ-NBR            12722404
127225                      DELIMITED BY SIZE                           12722504
127226                                      INTO PV-CICS-MSG-AREA       12722604
127227           PERFORM 9999-WRITE-TO-CSSL                             12722704
127228           MOVE '4600-'                TO WS008-CRA-REQ-ID        12722804
127229           MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG        12722904
127230           PERFORM 9998-RETURN                                    12723004
127231     END-EVALUATE.                                                12723104
127232                                                                  12723204
127233 4700-PKSLIP-UPDATE-QTY.                                          12723304
127234                                                                  12723404
127235     IF PS-LOG-MESSAGE                                            12723504
127236        MOVE ' WSKCS311-4700-PKSLIP-UPDATE-QTY'                   12723613
127237                                 TO PV-DISP-PARAGRAPH-NAME        12723704
127238        MOVE PV-DISP-PARAGRAPH-NAME TO PV-CICS-MSG-AREA           12723804
127239        PERFORM 9999-WRITE-TO-CSSL                                12723904
127240         MOVE WS008-SUCCESS-IND TO PV-CICS-MSG-AREA               12724004
127241         PERFORM 9999-WRITE-TO-CSSL                               12724104
127242     END-IF                                                       12724204
127243                                                                  12724304
127244     EXEC SQL                                                     12724404
127245         UPDATE TPKITEM                                           12724504
127246            SET PKSL_ITM_QTY   = :PV-QUANTITY                     12724604
127247          WHERE PO_NBR         = :WS008-PO-NUMBER                 12724704
127248            AND SEQ_NBR        = :WS008-ORIG-PKSL-SEQ-NBR         12724804
127249            AND PKSL_LNE_NBR   = :WS008-PO-LINE-NBR               12724904
127250            AND VER_STAT_CDE   = 'A'                              12725004
127251     END-EXEC.                                                    12725104
127252                                                                  12725204
127253     EVALUATE TRUE                                                12725304
127254       WHEN SQLCODE = ZERO                                        12725404
127255           CONTINUE                                               12725504
127256       WHEN SQLWARN0 NOT = SPACES                                 12725604
127260       WHEN SQLCODE  NOT = ZERO                                   12726000
127261             SET PS-ERROR                                         12726100
127262                 WS008-INVALID-SQL    TO TRUE                     12726200
127263             MOVE WS008-PO-NUMBER     TO PV-DISP-PO               12726300
127264             MOVE DK-REC-SEQ-NBR      TO PV-DISP-RCVR-SEQ-NBR     12726400
127265             MOVE WS008-PO-LINE-NBR   TO PV-DISP-PO-LNE-NBR       12726504
127266             MOVE DK-STR-DEST-NBR     TO PV-DISP-STR-NBR          12726600
127267             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12726700
127268                                                                  12726804
127270             MOVE WS008-ORIG-PKSL-SEQ-NBR                         12727004
127271               TO PV-DISPLAY-PKSL-SEQ-NBR                         12727104
127272             INITIALIZE PV-CICS-MSG-AREA                          12727208
127273             STRING   ' WSKCS311-4700-'                           12727300
127274                      ' CALLED BY-'                               12727400
127275                      WS008-PROGRAM-NAME                          12727500
127280                      '  SQL='                                    12728003
127290                      PV-DISPLAY-SQLCODE                          12729000
127300                      ' PO:'   PV-DISP-PO                         12730004
127312                      '-'      PV-DISP-RCVR-SEQ-NBR               12731204
127314                      '-'      PV-DISP-PO-LNE-NBR                 12731404
127316                      '-'      PV-DISP-STR-NBR                    12731604
127317                      ' PKSL:' PV-DISPLAY-PKSL-SEQ-NBR            12731704
127318                      DELIMITED BY SIZE                           12731800
127319                                      INTO PV-CICS-MSG-AREA       12731900
127320             PERFORM 9999-WRITE-TO-CSSL                           12732000
127321             MOVE '4700-'                TO WS008-CRA-REQ-ID      12732100
127322             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      12732200
127323             PERFORM 9998-RETURN                                  12732300
127324     END-EVALUATE.                                                12732400
127325                                                                  12732500
127326 5345-PKSLIP-CRE-DTL-SKU.                                         12732600
127327                                                                  12732700
127328      MOVE    WS008-NEW-PKSL-SEQ-NBR   TO PKITEM-SEQ-NBR          12732800
127329                                          INPKSU-SEQ-NBR          12732900
127330      MOVE    WS008-PO-LINE-NBR        TO PKITEM-PKSL-LNE-NBR     12733000
127331                                          DK-PO-LNE-NBR           12733100
127332                                          SHUUPC-TRN-LNE-NBR      12733200
127333      MOVE    WS008-ITEM-QTY           TO PKITEM-PKSL-ITM-QTY     12733300
127334      MOVE    WS008-NEW-SHIP           TO SHIPMT-SHIPT-ID         12733400
127335      MOVE    WS008-NEW-REC-SEQ-NBR    TO RECEIV-REC-SEQ-NBR      12733500
127336                                          SHPTPO-REC-SEQ-NBR.     12733600
127337                                                                  12733700
127338      PERFORM 4330-SELECT-PURITM-VER-NBR.                         12733800
127339      MOVE    PURITM-VER-NBR           TO PKITEM-PURITM-VER-NBR   12733900
127340      PERFORM 4370-INSERT-TPKITEM.                                12734000
127341                                                                  12734100
127350*----------------------------------------------------------------*12735000
127360*----------------------------------------------------------------*12736000
127370*  LINK TO SUKUT708 TO UPDATE TSHPSUM CARTON COMBINATIONS         12737000
127380*----------------------------------------------------------------*12738000
127390 7200-LINK-SUKUT708.                                              12739000
127400     MOVE WS008-SHIPT-UNT-ID      TO SU044-SHIPT-UNT-ID           12740000
127500     MOVE WS008-PO-NUMBER         TO SU044-PO                     12750000
127600     MOVE WS008-ORIG-REC-SEQ-NBR  TO SU044-ORIG-REC-SEQ-NBR       12760000
127700     MOVE WS008-ORIG-PKSL-SEQ-NBR TO SU044-ORIG-PKSL-SEQ-NBR      12770000
127800     MOVE WS008-NEW-PKSL-SEQ-NBR  TO SU044-NEW-PKSL-SEQ-NBR       12780000
127900                                                                  12790000
128000     MOVE LENGTH OF SU044-COMM-AREA                               12800000
128100                                         TO PV-COMMAREA-LENGTH.   12810000
128200                                                                  12820000
128300     EXEC CICS                                                    12830000
128400         LINK PROGRAM  (PC-SHPUM-UPD-PGM)                         12840000
128500              COMMAREA (SU044-COMM-AREA)                          12850000
128600              LENGTH   (PV-COMMAREA-LENGTH)                       12860000
128700              RESP     (PV-CICS-RESPONSE)                         12870000
128800     END-EXEC.                                                    12880000
128900                                                                  12890000
129000     EVALUATE TRUE                                                12900000
129100         WHEN WS008-SUCCESSFUL                                    12910000
129200             CONTINUE                                             12920000
129300         WHEN OTHER                                               12930000
129400             SET PS-ERROR                                         12940000
129500                 WS008-INVALID-SQL    TO TRUE                     12950000
129600             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       12960000
129700             STRING   ' WSKCS311-'                                12970000
129800                      WS008-CRA-RET-MSG  DELIMITED BY SIZE        12980000
129900                                    INTO PV-CICS-MSG-AREA         12990000
130000             PERFORM 9999-WRITE-TO-CSSL                           13000000
130100             INITIALIZE PV-CICS-MSG-AREA                          13010000
130200             STRING   ' WSKCS311-7200-'                           13020000
130300                      ' CALLED BY-'                               13030000
130400                      WS008-PROGRAM-NAME                          13040000
130500                      '  SQL='                                    13050003
130600                      PV-DISPLAY-SQLCODE                          13060000
130700                      '  SUCCESS-IND='                            13070000
130800                      WS008-SUCCESS-IND                           13080000
130900                      DELIMITED BY SIZE                           13090000
131000                                      INTO PV-CICS-MSG-AREA       13100000
131100             PERFORM 9999-WRITE-TO-CSSL                           13110000
131200             MOVE '7200-'                TO WS008-CRA-REQ-ID      13120000
131300             INITIALIZE  WS008-CRA-RET-MSG                        13130000
131400             MOVE PV-CICS-MSG-AREA       TO WS008-CRA-RET-MSG     13140000
131500             SET WS008-INVALID-SQL TO TRUE                        13150000
131600             PERFORM 9998-RETURN                                  13160000
131700     END-EVALUATE.                                                13170000
131800                                                                  13180000
131900                                                                  13190000
132000 8000-CHECK-FOR-LOGGING.                                          13200000
132100                                                                  13210000
132200     INITIALIZE WST00010-ATTR-ELEM-TXT-TEXT.                      13220000
132300                                                                  13230000
132400     EXEC SQL                                                     13240000
132500        SELECT  D.ATTR_ELEM_TXT    AS SWITCH_IND                  13250000
132600         INTO  :PV-SWITCH-IND                                     13260000
132700         FROM   WST_INTGRTN_TYP   A                               13270000
132800              , WST_ATTR_DEFN     B                               13280000
132900              , WST_ATTR_ELEM     C                               13290000
133000              , WST_ATTR_ELEM     D                               13300000
133100         WHERE A.INTGRTN_TYP_CDE    =  'CSSLLOG'                  13310000
133200           AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE          13320000
133300           AND B.ATTR_DEFN_SEQ_NBR  =  1                          13330000
133400           AND B.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE          13340000
133500           AND C.ATTR_DEFN_SEQ_NBR  =  1                          13350000
133600           AND B.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE          13360000
133700           AND D.ATTR_DEFN_SEQ_NBR  =  2                          13370000
133800           AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR        13380000
133900           AND C.ATTR_ELEM_TXT      = 'WSKCS311'                  13390000
134000     END-EXEC                                                     13400000
134100                                                                  13410000
134200     EVALUATE TRUE                                                13420000
134300         WHEN SQLCODE = ZERO                                      13430000
134400             IF PV-SWITCH-IND   = 'Y'                             13440000
134500                 SET PS-LOG-MESSAGE  TO TRUE                      13450000
134600             ELSE                                                 13460000
134700                 SET PS-NO-LOG-MESSAGE  TO TRUE                   13470000
134800             END-IF                                               13480000
134900         WHEN SQLCODE = +100                                      13490000
135000             SET PS-NO-LOG-MESSAGE  TO TRUE                       13500000
135100         WHEN SQLWARN0 NOT = SPACES                               13510000
135200         WHEN SQLCODE NOT EQUAL ZERO                              13520000
135300             SET PS-ERROR                                         13530000
135400                 WS008-INVALID-SQL    TO TRUE                     13540000
135500             MOVE  SQLCODE            TO PV-DISPLAY-SQLCODE       13550000
135600             STRING   ' WSKCS311-8000-'                           13560000
135700                      ' CALLED BY-'                               13570000
135800                      WS008-PROGRAM-NAME                          13580000
135900                      '  SQL='                                    13590003
136000                      PV-DISPLAY-SQLCODE                          13600000
136100                      ' '                                         13610000
136200                      DELIMITED BY SIZE                           13620000
136300                                      INTO PV-CICS-MSG-AREA       13630000
136400             PERFORM 9999-WRITE-TO-CSSL                           13640000
136500             MOVE '8000-'                TO WS008-CRA-REQ-ID      13650000
136600             MOVE PV-CICS-MSG-AREA      TO WS008-CRA-RET-MSG      13660000
136700             SET WS008-INVALID-SQL TO TRUE                        13670000
136800             PERFORM 9998-RETURN                                  13680000
136900     END-EVALUATE.                                                13690000
137000                                                                  13700000
137100                                                                  13710000
137200                                                                  13720000
137300*----------------------------------------------------------------*13730000
137400*    CURRENT SYSTEM DATE/TIME MODULE                              13740000
137500*----------------------------------------------------------------*13750000
137600                                                                  13760000
137700     COPY DPPD017.                                                13770000
137800                                                                  13780000
137900*-----------------------------------------------------------------13790000
138000*  RETURN TO CALLING PROGRAM                                      13800000
138100*-----------------------------------------------------------------13810000
138200 9998-RETURN.                                                     13820000
138300                                                                  13830000
138400     MOVE SQLCA                         TO WS008-SQLCA            13840000
138500                                           PV-CICS-MSG-AREA.      13850000
138600     PERFORM 9999-WRITE-TO-CSSL.                                  13860000
138700     MOVE WS008-COMM-AREA               TO DFHCOMMAREA.           13870000
138800                                                                  13880000
138900     EXEC CICS                                                    13890000
139000          RETURN                                                  13900000
139100     END-EXEC.                                                    13910000
139200                                                                  13920000
139300 9999-WRITE-TO-CSSL.                                              13930000
139400                                                                  13940000
139500     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      13950000
139600                                                                  13960000
139700     EXEC CICS                                                    13970000
139800          WRITEQ TD                                               13980000
139900           QUEUE   ('CSSL')                                       13990000
140000            FROM   (PV-CICS-MSG-AREA)                             14000000
140100          LENGTH   (PV-COMMAREA-LENGTH)                           14010000
140200            RESP   (PV-CICS-RESPONSE)                             14020000
140300     END-EXEC.                                                    14030000
140400                                                                  14040000
