000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             GVKRP001.                                00050000
000600 AUTHOR.                 JIM ARENDT.                              00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MARCH, 2018                              00080000
000900 DATE-COMPILED.                                                   00090000
001000******************************************************************00100000
001100*                                                                *00110000
001200*  THIS PROGRAM WILL CREATE TWO BOSS REPORTS:                    *00120000
001300*  - BOSS TRANSFER REPORT                                        *00130000
001400*  - BOSS TRANSFERS SUMMARY REPORT                               *00140000
001500*                                                                *00150000
001510* 07/10/21 GERMAN BANDA - REGIONAL BOSS CHANGE                   *00151032
001520*          CHANGE TO ALLOW PROGRAM TO PROCESS AND REPORT MORE    *00152031
001530*          THAN A SINGLE EFC.  NEW FIELD ADDED TO                *00153031
001540*          CORPORATE-SUMMARY-TABLE (SUMMARY-MULT-LOC)            *00154031
001550*          ON SUMMARY REPORT, IF STORE HAS TRANFERS FROM MORE    *00155031
001560*          THAN 1  EFC THE REPORT WILL DISPLAY 'MLT'             *00156031
001600******************************************************************00160000
001700*                                                                 00170000
001800******************************************************************00180000
001900 ENVIRONMENT DIVISION.                                            00190000
002000******************************************************************00200000
002100                                                                  00210000
002200 CONFIGURATION SECTION.                                           00220000
002300                                                                  00230000
002400 SOURCE-COMPUTER.        IBM-3090.                                00240000
002500 OBJECT-COMPUTER.        IBM-3090.                                00250000
002600                                                                  00260000
002700 INPUT-OUTPUT SECTION.                                            00270000
002800                                                                  00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003100     SELECT INPUT-FILE                                            00310000
003200         ASSIGN TO INP01.                                         00320000
003300                                                                  00330000
003400     SELECT DETAIL-REPORT-FILE                                    00340000
003500         ASSIGN TO RPT01.                                         00350000
003600                                                                  00360000
003700     SELECT SUMMARY-REPORT-FILE                                   00370000
003800         ASSIGN TO RPT02.                                         00380000
003900                                                                  00390000
004000******************************************************************00400000
004100 DATA DIVISION.                                                   00410000
004200******************************************************************00420000
004300 FILE SECTION.                                                    00430000
004400                                                                  00440000
004500 FD  INPUT-FILE                                                   00450000
004600     RECORDING MODE IS F                                          00460000
004700     BLOCK CONTAINS 0 RECORDS                                     00470000
004800     RECORD CONTAINS 130 CHARACTERS                               00480000
004900     LABEL RECORDS ARE STANDARD                                   00490000
005000     DATA RECORD IS INPUT-RECORD.                                 00500000
005100 01  INPUT-RECORD                    PIC X(130).                  00510000
005200                                                                  00520000
005300 FD  DETAIL-REPORT-FILE                                           00530000
005400     RECORDING MODE IS F                                          00540000
005500     BLOCK CONTAINS 0  RECORDS                                    00550000
005600     RECORD CONTAINS 132 CHARACTERS                               00560000
005700     LABEL RECORDS ARE OMITTED                                    00570000
005800     DATA RECORD IS DETAIL-REPORT-RECORD.                         00580000
005900 01  DETAIL-REPORT-RECORD            PIC X(132).                  00590000
006000                                                                  00600000
006100 FD  SUMMARY-REPORT-FILE                                          00610000
006200     RECORDING MODE IS F                                          00620000
006300     BLOCK CONTAINS 0  RECORDS                                    00630000
006400     RECORD CONTAINS 132 CHARACTERS                               00640000
006500     LABEL RECORDS ARE OMITTED                                    00650000
006600     DATA RECORD IS SUMMARY-REPORT-RECORD.                        00660000
006700 01  SUMMARY-REPORT-RECORD           PIC X(132).                  00670000
006800                                                                  00680000
006900                                                                  00690000
007000******************************************************************00700000
007100 WORKING-STORAGE SECTION.                                         00710000
007200******************************************************************00720000
007300 01  PC-CONSTANTS.                                                00730000
007400     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00740000
007500                                                   'GVKRP001'.    00750000
007600     05  PC-1                        PIC S9(03)    VALUE +1       00760000
007700                                                   COMP-3.        00770000
007800     05  PC-10                       PIC S9(03)    VALUE +10      00780000
007900                                                   COMP-3.        00790000
008000     05  PC-55                       PIC S9(03)    VALUE +55      00800000
008100                                                   COMP-3.        00810000
008110     05  PC-MULT                     PIC  X(05)    VALUE '  MLT'. 00811028
008200                                                                  00820000
008300 01 PV-PROGRAM-VARIABLES.                                         00830000
008400     05  PV-LINE-COUNT               PIC S9(03)    VALUE ZERO     00840000
008500                                                   COMP-3.        00850000
008600     05  PV-LINE-COUNT-RPT2          PIC S9(03)    VALUE ZERO     00860000
008700                                                   COMP-3.        00870000
008800     05  PV-DTL-PAGE-COUNT           PIC S9(04)    VALUE ZERO     00880000
008900                                                   COMP-3.        00890000
009000     05  PV-SUM-PAGE-COUNT           PIC S9(04)    VALUE ZERO     00900000
009100                                                   COMP-3.        00910000
009200     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00920000
009300                                                   COMP SYNC.     00930000
009400     05  PV-UNIT-RETAIL-QTY          PIC  9(05)V99 VALUE ZEROS.   00940000
009500     05  PV-EDIT-CHAR4               PIC  X(04).                  00950000
009600     05  PV-EDIT-NUM4  REDEFINES PV-EDIT-CHAR4                    00960000
009700                                     PIC  9(04).                  00970000
009800     05  PV-EDIT-CHAR5               PIC  X(05).                  00980000
009900     05  PV-EDIT-NUM5  REDEFINES PV-EDIT-CHAR5                    00990000
010000                                     PIC  9(05).                  01000000
010100     05  PV-ABEND-PARA-NAME          PIC  X(30)    VALUE SPACES.  01010000
010200     05  PV-DB2-OPERATION-MSG-1      PIC  X(60)    VALUE SPACES.  01020000
010300     05  PV-DB2-OPERATION-MSG-2      PIC  X(60)    VALUE SPACES.  01030000
010400     05  PV-DB2-TABLE-NAME           PIC  X(12)    VALUE SPACES.  01040000
010500     05  PV-SQLCODE                  PIC  Z(08)9-.                01050000
010600                                                                  01060000
010700     05  PV-SAVE-FIELDS.                                          01070000
010800         10  PV-SAVE-LOC             PIC  9(05)    VALUE ZEROS.   01080000
010810         10  PV-SAVE-EFC             PIC  9(05)    VALUE ZEROS.   01081007
010900         10  PV-PREV-SKU             PIC  9(08)    VALUE ZEROS.   01090000
011000                                                                  01100000
011100     05  PV-REPORT-FIELDS.                                        01110000
011200         10  PV-STORE-NMBR           PIC  9(04)    VALUE ZEROS.   01120000
011300         10  PV-RPT-STORE-NAME       PIC  X(25)    VALUE SPACES.  01130000
011400         10  PV-RPT-TOTAL-UNITS      PIC  9(09)    VALUE ZEROS.   01140000
011500         10  PV-RPT-TOTAL-RETAIL     PIC  9(07)V99 VALUE ZEROS.   01150000
011600                                                                  01160000
011700     05  PV-DETAIL-TOTALS.                                        01170000
011800         10  PV-DT-TOT-UNITS         PIC  9(09)    VALUE ZEROS.   01180000
011900         10  PV-DT-TOT-RETAIL        PIC  9(07)V99 VALUE ZEROS.   01190000
012000                                                                  01200000
012100     05  PV-SUMMARY-TOTALS.                                       01210000
012200         10  PV-ST-TRANSFER-TOT      PIC S9(09)    VALUE ZEROS.   01220000
012300         10  PV-ST-SKU-TOT           PIC S9(09)    VALUE ZEROS.   01230000
012400         10  PV-ST-UNITS-TOT         PIC S9(09)    VALUE ZEROS.   01240000
012500         10  PV-ST-RETAIL-TOT        PIC S9(09)V99 VALUE ZEROS.   01250000
012600                                                                  01260000
012700     05  PV-TODAYS-DATE.                                          01270000
012800         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZEROS.   01280000
012900         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   01290000
013000         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   01300000
013100     05  PV-TODAYS-TIME.                                          01310000
013200         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   01320000
013300         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   01330000
013400         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   01340000
013500         10  FILLER                  PIC  9(02)    VALUE ZEROS.   01350000
013600     05  PV-NULL-IND                 PIC S9(04)    VALUE ZEROS    01360000
013700                                                   COMP SYNC.     01370000
013800     05  PV-ORDER-NBR                PIC  9(10)    VALUE ZEROES.  01380000
013810     05  PV-SHIP-NODE                PIC  9(10)    VALUE ZEROES.  01381002
013900     05  PV-SCN-LOC-ORDER-COUNT      PIC  9(06)    VALUE ZEROES.  01390000
014000     05  PV-ST-ORDER-COUNT           PIC  9(09)    VALUE ZEROS.   01400000
014100                                                                  01410000
014200 01 WS-CALC-FIELDS.                                               01420000
014300    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         01430000
014400                                                   VALUE ZEROS.   01440000
014500    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         01450000
014600                                                   VALUE ZEROS.   01460000
014700    05  WS-EDIT-QTY                  PIC  ZZZZZZ9.                01470000
014800                                                                  01480000
014900 01  PROGRAM-SWITCHES.                                            01490000
015000     05  PS-END-OF-FILE-SW           PIC  X(01)    VALUE 'N'.     01500000
015100         88  PS-END-OF-FILE                        VALUE 'Y'.     01510000
015200     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'N'.     01520000
015300         88  PS-FIRST-TIME-YES                     VALUE 'Y'.     01530000
015400         88  PS-FIRST-TIME-NO                      VALUE 'N'.     01540000
015500     05  PS-END-OF-CURSOR-SW         PIC  X(01)    VALUE 'N'.     01550000
015600         88 PS-END-OF-CURSOR                       VALUE 'Y'.     01560000
015700         88 PS-NOT-END-OF-CURSOR                   VALUE 'N'.     01570000
015800     05  PS-END-OF-TABLE-SW          PIC  X(01)    VALUE 'N'.     01580000
015900         88 PS-END-OF-TABLE                        VALUE 'Y'.     01590000
016000         88 PS-NOT-END-OF-TABLE                    VALUE 'N'.     01600000
016010     05  PS-MULT-LOC-SW              PIC  X(01)    VALUE 'N'.     01601023
016020         88 PS-MULT-LOC-YES                        VALUE 'Y'.     01602023
016030         88 PS-MULT-LOC-NO                         VALUE 'N'.     01603023
016100                                                                  01610000
016200 01  CORPORATE-SUMMARY-TABLE.                                     01620000
016300     05  SUMMARY-TABLE  OCCURS 3000 TIMES INDEXED BY SC-IDX.      01630000
016400         10  SUMMARY-SCLOC-NBR       PIC  9(05).                  01640000
016500         10  SUMMARY-SCLOC-NAME      PIC  X(25).                  01650000
016600         10  SUMMARY-BTCH-NBR        PIC  X(04).                  01660000
016700         10  SUMMARY-DATE            PIC  X(10).                  01670000
016800         10  SUMMARY-SKU-CNT         PIC  9(09).                  01680000
016900         10  SUMMARY-TOTAL-UNITS     PIC  9(09).                  01690000
017000         10  SUMMARY-TOTAL-RETAIL    PIC  9(09)V99.               01700000
017100         10  SUMMARY-LOC-TYPE-CDE    PIC  X(02).                  01710000
017200         10  SUMMARY-DC-NBR          PIC  9(05).                  01720000
017300         10  SUMMARY-TRANSFER-CNT    PIC  9(07).                  01730000
017310         10  SUMMARY-MULT-LOC        PIC  X(01).                  01731022
017400                                                                  01740000
017500******************************************************************01750000
017600 01  HEADING-LINE1.                                               01760000
017700     05  FILLER                  PIC  X(48)    VALUE SPACES.      01770000
017800     05  FILLER                  PIC  X(24)    VALUE              01780000
017900         'BOSS TRANSFER REPORT FOR'.                              01790000
018000     05  FILLER                  PIC  X(01)    VALUE SPACES.      01800000
018100     05  HL1-BTCH-PRC-DTE.                                        01810000
018200         10  HL1-BATCH-PROC-MM   PIC  X(02)    VALUE SPACES.      01820000
018300         10  FILLER              PIC  X(01)    VALUE '/'.         01830000
018400         10  HL1-BATCH-PROC-DD   PIC  X(02)    VALUE SPACES.      01840000
018500         10  FILLER              PIC  X(01)    VALUE '/'.         01850000
018600         10  HL1-BATCH-PROC-CC   PIC  X(02)    VALUE SPACES.      01860000
018700         10  HL1-BATCH-PROC-YY   PIC  X(02)    VALUE SPACES.      01870000
018800     05  FILLER                  PIC  X(26)    VALUE SPACES.      01880000
018900                                                                  01890000
019000 01  HEADING-LINE2.                                               01900000
019100     05  FILLER                  PIC  X(57)    VALUE SPACES.      01910000
019200     05  FILLER                  PIC  X(13)    VALUE              01920000
019300         'BATCH NUMBER:'.                                         01930000
019400     05  FILLER                  PIC  X(02)    VALUE SPACES.      01940000
019500     05  HL2-BTCH-NBR            PIC  ZZZ9     VALUE ZEROS.       01950000
019600     05  FILLER                  PIC  X(50)    VALUE SPACES.      01960000
019700                                                                  01970000
019800 01  HEADING-LINE3.                                               01980000
019900     05  FILLER                  PIC  X(01)    VALUE SPACES.      01990000
020000     05  FILLER                  PIC  X(09)    VALUE              02000000
020100         'LOCATION:'.                                             02010000
020200     05  FILLER                  PIC  X(01)    VALUE SPACES.      02020000
020300     05  HL3-LOC                 PIC  ZZZZ9    VALUE ZEROS.       02030000
020400     05  FILLER                  PIC  X(01)    VALUE SPACES.      02040000
020500     05  HL3-STORE-NAME          PIC  X(25)    VALUE SPACES.      02050000
020600     05  FILLER                  PIC  X(92)    VALUE SPACES.      02060000
020700                                                                  02070000
020800 01  HEADING-LINE4.                                               02080000
020900     05  FILLER                  PIC  X(12)    VALUE SPACES.      02090000
021000     05  FILLER                  PIC  X(04)    VALUE              02100000
021100         'BTCH'.                                                  02110000
021200     05  FILLER                  PIC  X(22)    VALUE SPACES.      02120000
021300     05  FILLER                  PIC  X(08)    VALUE              02130000
021400         'TRANSFER'.                                              02140000
021500     05  FILLER                  PIC  X(04)    VALUE SPACES.      02150000
021600     05  FILLER                  PIC  X(27)    VALUE              02160000
021700         'DEPT   MAJOR    SUB     SKU'.                           02170000
021800     05  FILLER                  PIC  X(09)    VALUE SPACES.      02180000
021900     05  FILLER                  PIC  X(03)    VALUE              02190000
022000         'SKU'.                                                   02200000
022100     05  FILLER                  PIC  X(18)    VALUE SPACES.      02210000
022200     05  FILLER                  PIC  X(18)    VALUE              02220000
022300         'NBR OF      RETAIL'.                                    02230000
022400                                                                  02240000
022500 01  HEADING-LINE5.                                               02250000
022600     05  FILLER                  PIC  X(07)    VALUE SPACES.      02260000
022700     05  FILLER                  PIC  X(17)    VALUE              02270000
022800         'LOC  NBR     DATE'.                                     02280000
022900     05  FILLER                  PIC  X(06)    VALUE SPACES.      02290000
023000     05  FILLER                  PIC  X(14)    VALUE              02300000
023100         'EFC     NUMBER'.                                        02310000
023200     05  FILLER                  PIC  X(06)    VALUE SPACES.      02320000
023300     05  FILLER                  PIC  X(27)    VALUE              02330000
023400         'NBR    CLASS   CLASS    NBR'.                           02340000
023500     05  FILLER                  PIC  X(06)    VALUE SPACES.      02350000
023600     05  FILLER                  PIC  X(11)    VALUE              02360000
023700         'DESCRIPTION'.                                           02370000
023800     05  FILLER                  PIC  X(13)    VALUE SPACES.      02380000
023900     05  FILLER                  PIC  X(05)    VALUE              02390000
024000         'UNITS'.                                                 02400000
024100     05  FILLER                  PIC  X(07)    VALUE SPACES.      02410000
024200     05  FILLER                  PIC  X(05)    VALUE              02420000
024300         'VALUE'.                                                 02430000
024400                                                                  02440000
024500******************************************************************02450000
024600*    THESE LINES WILL BE USED FOR THE SUMMARY REPORT.            *02460000
024700******************************************************************02470000
024800 01  HEADING-LINE7.                                               02480000
024900     05  FILLER                  PIC  X(44)    VALUE SPACES.      02490000
025000     05  FILLER                  PIC  X(34)    VALUE              02500000
025100         'BOSS TRANSFERS SUMMARY REPORT FOR '.                    02510000
025200     05  HL7-BTCH-PRC-DTE.                                        02520000
025300         10  HL7-BATCH-PROC-MM   PIC  X(02)    VALUE SPACES.      02530000
025400         10  FILLER              PIC  X(01)    VALUE '/'.         02540000
025500         10  HL7-BATCH-PROC-DD   PIC  X(02)    VALUE SPACES.      02550000
025600         10  FILLER              PIC  X(01)    VALUE '/'.         02560000
025700         10  HL7-BATCH-PROC-CC   PIC  X(02)    VALUE SPACES.      02570000
025800         10  HL7-BATCH-PROC-YY   PIC  X(02)    VALUE SPACES.      02580000
025900     05  FILLER                  PIC  X(15)    VALUE SPACES.      02590000
026000                                                                  02600000
026100 01  HEADING-LINE8.                                               02610000
026200     05  FILLER                  PIC  X(40)    VALUE SPACES.      02620000
026300     05  FILLER                  PIC  X(03)    VALUE              02630000
026400         'EFC'.                                                   02640000
026500     05  FILLER                  PIC  X(03)    VALUE SPACES.      02650000
026600     05  FILLER                  PIC  X(04)    VALUE              02660000
026700         'BTCH'.                                                  02670000
026800     05  FILLER                  PIC  X(19)    VALUE SPACES.      02680000
026900     05  FILLER                  PIC  X(08)    VALUE              02690000
027000         'TRANSFER'.                                              02700000
027100     05  FILLER                  PIC  X(07)    VALUE SPACES.      02710000
027200     05  FILLER                  PIC  X(09)    VALUE              02720000
027300         'NUMBER OF'.                                             02730000
027400     05  FILLER                  PIC  X(06)    VALUE SPACES.      02740000
027500     05  FILLER                  PIC  X(09)    VALUE              02750000
027600         'NUMBER OF'.                                             02760000
027700     05  FILLER                  PIC  X(12)    VALUE SPACES.      02770000
027800     05  FILLER                  PIC  X(06)    VALUE              02780000
027900         'RETAIL'.                                                02790000
028000                                                                  02800000
028100 01  HEADING-LINE9.                                               02810000
028200     05  FILLER                  PIC  X(06)    VALUE SPACE.       02820000
028300     05  FILLER                  PIC  X(15)    VALUE              02830000
028400         'SCAN   LOCATION'.                                       02840000
028500     05  FILLER                  PIC  X(19)    VALUE SPACE.       02850000
028600     05  FILLER                  PIC  X(03)    VALUE              02860000
028700         'NBR'.                                                   02870000
028800     05  FILLER                  PIC  X(03)    VALUE SPACES.      02880000
028900     05  FILLER                  PIC  X(03)    VALUE              02890000
029000         'NBR'.                                                   02900000
029100     05  FILLER                  PIC  X(06)    VALUE SPACES.      02910000
029200     05  FILLER                  PIC  X(04)    VALUE              02920000
029300         'DATE'.                                                  02930000
029400     05  FILLER                  PIC  X(12)    VALUE SPACES.      02940000
029500     05  FILLER                  PIC  X(05)    VALUE              02950000
029600         'COUNT'.                                                 02960000
029700     05  FILLER                  PIC  X(10)    VALUE SPACES.      02970000
029800     05  FILLER                  PIC  X(03)    VALUE              02980000
029900         'SKU'.                                                   02990000
030000     05  FILLER                  PIC  X(01)    VALUE              03000000
030100         "'".                                                     03010000
030200     05  FILLER                  PIC  X(01)    VALUE              03020000
030300         'S'.                                                     03030000
030400     05  FILLER                  PIC  X(10)    VALUE SPACES.      03040000
030500     05  FILLER                  PIC  X(05)    VALUE              03050000
030600         'UNITS'.                                                 03060000
030700     05  FILLER                  PIC  X(14)    VALUE SPACES.      03070000
030800     05  FILLER                  PIC  X(05)    VALUE              03080000
030900         'VALUE'.                                                 03090000
031000     05  FILLER                  PIC  X(39)    VALUE SPACES.      03100000
031100                                                                  03110000
031200 01  REPORT-DETAIL-LINE.                                          03120000
031300     05  FILLER                  PIC  X(05)    VALUE SPACES.      03130000
031400     05  DL1-SCAN-LOC            PIC  ZZZZ9    VALUE ZEROES.      03140000
031500     05  FILLER                  PIC  X(02)    VALUE SPACES.      03150000
031600     05  DL1-BATCH-NBR           PIC  ZZZ9     VALUE ZEROES.      03160000
031700     05  FILLER                  PIC  X(02)    VALUE SPACES.      03170000
031800     05  DL1-DATE                PIC  X(10)    VALUE SPACES.      03180000
031900     05  FILLER                  PIC  X(01)    VALUE SPACES.      03190000
032000     05  DL1-EFC-NBR             PIC  ZZZZ9    VALUE ZEROES.      03200000
032100     05  FILLER                  PIC  X(03)    VALUE SPACES.      03210000
032200     05  DL1-TRANSFER-NBR        PIC  ZZZZZ99999 VALUE ZEROES.    03220000
032300     05  FILLER                  PIC  X(03)    VALUE SPACES.      03230000
032400     05  DL1-DEPT-NBR            PIC  ZZZ9     VALUE ZEROES.      03240000
032500     05  FILLER                  PIC  X(04)    VALUE SPACES.      03250000
032600     05  DL1-MAJOR-CLASS         PIC  ZZZ9     VALUE ZEROES.      03260000
032700     05  FILLER                  PIC  X(04)    VALUE SPACES.      03270000
032800     05  DL1-SUB-CLASS           PIC  ZZZ9     VALUE ZEROES.      03280000
032900     05  FILLER                  PIC  X(02)    VALUE SPACES.      03290000
033000     05  DL1-SKU-NBR             PIC  X(08)    VALUE SPACES.      03300000
033100     05  FILLER                  PIC  X(02)    VALUE SPACES.      03310000
033200     05  DL1-SKU-DESC            PIC  X(25)    VALUE SPACES.      03320000
033300     05  FILLER                  PIC  X(01)    VALUE SPACES.      03330000
033400     05  DL1-NBR-OF-UNITS        PIC  ZZZ9     VALUE ZEROES.      03340000
033500     05  FILLER                  PIC  X(03)    VALUE SPACES.      03350000
033600     05  DL1-RETAIL-VALUE        PIC  ZZZ,ZZZ.99 VALUE ZEROES.    03360000
033700                                                                  03370000
033800 01  REPORT-TOTALS-LINE.                                          03380000
033900     05  FILLER                  PIC  X(67)    VALUE SPACES.      03390000
034000     05  FILLER                  PIC  X(16)    VALUE              03400000
034100         'LOCATION TOTALS:'.                                      03410000
034200     05  FILLER                  PIC  X(18)    VALUE SPACES.      03420000
034300     05  TL1-TOTAL-UNITS         PIC  ZZZ,ZZZ,ZZ9                 03430000
034400                                               VALUE ZEROS.       03440000
034500     05  FILLER                  PIC  X(01)    VALUE SPACES.      03450000
034600     05  TL1-TOTAL-RETAIL        PIC  Z,ZZZ,ZZZ.99                03460000
034700                                               VALUE ZEROS.       03470000
034800     05  FILLER                  PIC  X(07)    VALUE SPACES.      03480000
034900                                                                  03490000
035000 01  SUMMARY-DETAIL-LINE.                                         03500000
035100     05  FILLER                  PIC  X(05)    VALUE SPACES.      03510000
035200     05  DL2-SCAN-STORE-NBR      PIC  ZZZZ9    VALUE ZEROS.       03520000
035300     05  FILLER                  PIC  X(03)    VALUE SPACES.      03530000
035400     05  DL2-STORE-NAME          PIC  X(25)    VALUE SPACES.      03540000
035500     05  DL2-EFC-NBR             PIC  ZZZZ9    VALUE ZEROES.      03550000
035510     05  DL2-EFC-NBR-X   REDEFINES DL2-EFC-NBR                    03551024
035520                                     PIC  X(05).                  03552024
035600     05  FILLER                  PIC  X(03)    VALUE SPACES.      03560000
035700     05  DL2-BATCH-NBR           PIC  ZZZ9     VALUE ZEROES.      03570000
035800     05  FILLER                  PIC  X(04)    VALUE SPACES.      03580000
035900     05  DL2-DATE                PIC  X(10)    VALUE SPACES.      03590000
036000     05  FILLER                  PIC  X(04)    VALUE SPACES.      03600000
036100     05  DL2-TRANSFER-COUNT      PIC  ZZZ,ZZ9  VALUE ZEROES.      03610000
036200     05  FILLER                  PIC  X(08)    VALUE SPACES.      03620000
036300     05  DL2-SKU-CNT             PIC  ZZZ,ZZ9  VALUE ZEROS.       03630000
036400     05  FILLER                  PIC  X(05)    VALUE SPACES.      03640000
036500     05  DL2-TOTAL-UNITS         PIC  ZZZ,ZZZ,ZZ9                 03650000
036600                                               VALUE ZEROS.       03660000
036700     05  FILLER                  PIC  X(09)    VALUE SPACES.      03670000
036800     05  DL2-TOTAL-RETAIL        PIC  Z,ZZZ,ZZZ.99                03680000
036900                                               VALUE ZEROS.       03690000
037000     05  FILLER                  PIC  X(05)    VALUE SPACES.      03700000
037100                                                                  03710000
037200 01  SUMMARY-TOTALS-LINE.                                         03720000
037300     05  FILLER                  PIC  X(47)    VALUE SPACES.      03730000
037400     05  FILLER                  PIC  X(17)    VALUE              03740000
037500         'CORPORATE TOTALS:'.                                     03750000
037600     05  FILLER                  PIC  X(02)    VALUE SPACES.      03760000
037700     05  TL2-TRANSFER-COUNT      PIC  Z,ZZZ,ZZ9 VALUE ZEROES.     03770000
037800     05  FILLER                  PIC  X(06)    VALUE SPACES.      03780000
037900     05  TL2-SKU-COUNT           PIC  Z,ZZZ,ZZ9 VALUE ZEROS.      03790000
038000     05  FILLER                  PIC  X(03)    VALUE SPACES.      03800000
038100     05  TL2-TOTAL-TOTAL-UNITS   PIC  Z,ZZZ,ZZZ,ZZ9               03810000
038200                                               VALUE ZEROS.       03820000
038300     05  FILLER                  PIC  X(07)    VALUE SPACES.      03830000
038400     05  TL2-TOTAL-TOTAL-RETAIL  PIC  ZZZ,ZZZ,ZZZ.99              03840000
038500                                               VALUE ZEROS.       03850000
038600                                                                  03860000
038700 01  BL-BLANK-LINE               PIC  X(132)   VALUE SPACES.      03870000
038800                                                                  03880000
038900 01  MISCELLANEOUS-LINES.                                         03890000
039000     05  NO-DATA-TO-REPORT-LINE.                                  03900000
039100         10  FILLER              PIC  X(40)    VALUE SPACES.      03910000
039200         10  FILLER              PIC  X(52)    VALUE              03920000
039300         '*******  N O   D A T A   T O   R E P O R T   *******'.  03930000
039400         10  FILLER              PIC  X(40)    VALUE SPACES.      03940000
039500                                                                  03950000
039600******************************************************************03960000
039700*   RECORD LAYOUT FOR INPUT FILE                                  03970000
039800******************************************************************03980000
039900     COPY GVRD002.                                                03990000
040000                                                                  04000000
040100******************************************************************04010000
040200*   RECORD LAYOUT FOR CALLING XLKUT071                            04020000
040300******************************************************************04030000
040400     COPY XLWS071.                                                04040000
040500                                                                  04050000
040600******************************************************************04060000
040700*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               04070000
040800******************************************************************04080000
040900     COPY DPWS132O.                                               04090000
041000                                                                  04100000
041100******************************************************************04110000
041200*  DB2 AREA FOR XLT_LOC (STORE TABLE - XLT00010)                  04120000
041300******************************************************************04130000
041400     EXEC SQL                                                     04140000
041500          INCLUDE XLT00010                                        04150000
041600     END-EXEC.                                                    04160000
041700                                                                  04170000
041800******************************************************************04180000
041900*  DB2 AREA FOR XLT_DC_LOC_ASGMT (STORE TABLE - XLT00014)         04190000
042000******************************************************************04200000
042100     EXEC SQL                                                     04210000
042200          INCLUDE XLT00014                                        04220000
042300     END-EXEC.                                                    04230000
042400                                                                  04240000
042500******************************************************************04250000
042600*   DB2 MESSAGE AREAS                                             04260000
042700******************************************************************04270000
042800     COPY DPWS004.                                                04280000
042900                                                                  04290000
043000******************************************************************04300000
043100*    DB2 AREA FOR COMMUNICATIONS                                  04310000
043200******************************************************************04320000
043300     EXEC SQL                                                     04330000
043400          INCLUDE SQLCA                                           04340000
043500     END-EXEC.                                                    04350000
043600                                                                  04360000
043700******************************************************************04370000
043800*    DB2 AREA FOR COMMUNICATIONS AREA2                            04380000
043900******************************************************************04390000
044000     COPY SQLCA2.                                                 04400000
044100                                                                  04410000
044200******************************************************************04420000
044300     EXEC SQL                                                     04430000
044400         DECLARE SC_CSR CURSOR FOR                                04440000
044500             SELECT T1.LOC_NBR                                    04450000
044600                  , T1.LOC_NM                                     04460000
044700                  , T1.LOC_TYP_CDE                                04470000
044800                  , T2.DC_NBR                                     04480000
044900               FROM                                               04490000
045000               (SELECT A.LOC_NBR                                  04500000
045100                     , A.LOC_NM                                   04510000
045200                     , A.LOC_TYP_CDE                              04520000
045300                  FROM XLT_LOC A                                  04530000
045400                 WHERE A.LOC_TYP_CDE IN ('DS', 'CS')              04540000
045500                 ORDER BY A.LOC_NBR                               04550000
045600               ) AS T1                                            04560000
045700                 LEFT OUTER JOIN                                  04570000
045800               (SELECT AA.LOC_NBR                                 04580000
045900                     , BB.DC_NBR                                  04590000
046000                  FROM XLT_LOC AA                                 04600000
046100                     , XLT_DC_LOC_ASGMT BB                        04610000
046200                 WHERE AA.LOC_TYP_CDE IN ('DS', 'CS')             04620000
046300                   AND AA.OPN_DTE  <= CURRENT DATE                04630000
046400                   AND AA.CLO_DTE  >= CURRENT DATE                04640000
046500                   AND AA.LOC_NBR   = BB.LOC_NBR                  04650000
046600                   AND BB.EFF_BEG_DTE IN                          04660000
046700                       (SELECT MAX(CC.EFF_BEG_DTE)                04670000
046800                          FROM XLT_DC_LOC_ASGMT CC                04680000
046900                         WHERE BB.LOC_NBR      =  CC.LOC_NBR      04690000
047000                           AND CC.EFF_BEG_DTE <= CURRENT DATE)    04700000
047100                 ORDER BY AA.LOC_NBR                              04710000
047200               ) AS T2                                            04720000
047300                 ON T1.LOC_NBR  =  T2.LOC_NBR                     04730000
047400               ORDER BY 1                                         04740000
047500     END-EXEC.                                                    04750000
047600                                                                  04760000
047700******************************************************************04770000
047800 PROCEDURE DIVISION.                                              04780000
047900******************************************************************04790000
048000*                                                                 04800000
048100******************************************************************04810000
048200**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      04820000
048300******************************************************************04830000
048400 0000-MAINLINE-PROCESSING.                                        04840000
048500                                                                  04850000
048600     PERFORM 1000-INITIALIZE.                                     04860000
048700                                                                  04870000
048800     IF PS-END-OF-FILE                                            04880000
048900        NEXT SENTENCE                                             04890000
049000                                                                  04900000
049100     ELSE                                                         04910000
049200        SET PS-FIRST-TIME-NO TO TRUE                              04920000
049300        PERFORM 2000-MAIN-PROCESS                                 04930000
049400          UNTIL PS-END-OF-FILE                                    04940000
049500        PERFORM 5010-UPDATE-SCAN-LOC-CRTN-CNT                     04950000
049600     END-IF.                                                      04960000
049700                                                                  04970000
049800     PERFORM 9000-END-PROCESS.                                    04980000
049900                                                                  04990000
050000     STOP RUN.                                                    05000000
050100                                                                  05010000
050200******************************************************************05020000
050300**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               05030000
050400******************************************************************05040000
050500 1000-INITIALIZE.                                                 05050000
050600                                                                  05060000
050700     DISPLAY ' '.                                                 05070000
050800     DISPLAY '**********************************'.                05080000
050900     DISPLAY '      START OF ' PC-PROGRAM-NAME                    05090000
051000     DISPLAY '**********************************'.                05100000
051100     DISPLAY ' '.                                                 05110000
051200                                                                  05120000
051300     OPEN INPUT  INPUT-FILE                                       05130000
051400          OUTPUT DETAIL-REPORT-FILE                               05140000
051500                 SUMMARY-REPORT-FILE.                             05150000
051600                                                                  05160000
051700     ACCEPT PV-TODAYS-DATE FROM DATE.                             05170000
051800     ACCEPT PV-TODAYS-TIME FROM TIME.                             05180000
051900                                                                  05190000
052000     PERFORM 1200-INITIALIZE-HEADINGS.                            05200000
052100                                                                  05210000
052200*READ FIRST INPUT RECORD.                                         05220000
052300     PERFORM 7000-READ-EXTRACT.                                   05230000
052400                                                                  05240000
052500     SET PS-FIRST-TIME-YES         TO TRUE.                       05250000
052600                                                                  05260000
052700     PERFORM 6999-PRINT-REPORT-HEADINGS.                          05270000
052800                                                                  05280000
052900     MOVE GV002-INV-RECEIVING-NODE TO PV-SAVE-LOC.                05290000
052910     MOVE GV002-INV-SHIP-NODE      TO PV-SAVE-EFC.                05291007
053000                                                                  05300000
053100     PERFORM 1010-INITIALIZE-SUMMARY-TABLE.                       05310000
053200                                                                  05320000
053300     PERFORM 1020-LOAD-SUMMARY-TABLE.                             05330000
053400                                                                  05340000
053500******************************************************************05350000
053600*   INITIALIZE SUMMARY TABLE.                                     05360000
053700******************************************************************05370000
053800 1010-INITIALIZE-SUMMARY-TABLE.                                   05380000
053900                                                                  05390000
054000     INITIALIZE CORPORATE-SUMMARY-TABLE.                          05400000
054100                                                                  05410000
054200******************************************************************05420000
054300*   LOAD SUMMARY TABLE.                                           05430000
054400******************************************************************05440000
054500 1020-LOAD-SUMMARY-TABLE.                                         05450000
054600                                                                  05460000
054700     EXEC SQL                                                     05470000
054800         OPEN SC_CSR                                              05480000
054900     END-EXEC.                                                    05490000
055000                                                                  05500000
055100     EVALUATE TRUE                                                05510000
055200         WHEN SQLCODE = ZERO                                      05520000
055300             CONTINUE                                             05530000
055400                                                                  05540000
055500         WHEN OTHER                                               05550000
055600             MOVE SQLCODE TO PV-SQLCODE                           05560000
055700             MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARA-NAME 05570000
055800             STRING 'SQL ERROR OPENING CURSOR - '                 05580000
055900                     PV-SQLCODE                                   05590000
056000                     DELIMITED BY SIZE                            05600000
056100                                 INTO PV-DB2-OPERATION-MSG-1      05610000
056200             PERFORM 9998-SQL-ABEND                               05620000
056300     END-EVALUATE.                                                05630000
056400                                                                  05640000
056500     PERFORM 1030-FETCH-CURSOR.                                   05650000
056600                                                                  05660000
056700     PERFORM VARYING SC-IDX FROM 1 BY 1                           05670000
056800        UNTIL SC-IDX > 3000 OR PS-END-OF-CURSOR                   05680000
056900         MOVE XLT00010-LOC-NBR     TO SUMMARY-SCLOC-NBR (SC-IDX)  05690000
057000         MOVE XLT00010-LOC-NM      TO SUMMARY-SCLOC-NAME (SC-IDX) 05700000
057100         MOVE XLT00010-LOC-TYP-CDE TO                             05710000
057200                                   SUMMARY-LOC-TYPE-CDE (SC-IDX)  05720000
057300         MOVE XLT00014-DC-NBR      TO SUMMARY-DC-NBR (SC-IDX)     05730000
057400         MOVE ZEROES               TO                             05740000
057500                                   SUMMARY-TRANSFER-CNT (SC-IDX)  05750000
057510         MOVE 'N'                  TO SUMMARY-MULT-LOC  (SC-IDX)  05751022
057600         PERFORM 1030-FETCH-CURSOR                                05760000
057700                                                                  05770000
057800     END-PERFORM.                                                 05780000
057900                                                                  05790000
058000     EXEC SQL                                                     05800000
058100         CLOSE SC_CSR                                             05810000
058200     END-EXEC.                                                    05820000
058300                                                                  05830000
058400     EVALUATE TRUE                                                05840000
058500         WHEN SQLCODE = ZERO                                      05850000
058600             CONTINUE                                             05860000
058700                                                                  05870000
058800         WHEN OTHER                                               05880000
058900             MOVE SQLCODE TO PV-SQLCODE                           05890000
059000             MOVE '1020-LOAD-SUMMARY-TABLE' TO PV-ABEND-PARA-NAME 05900000
059100             STRING 'SQL ERROR CLOSING CURSOR - '                 05910000
059200                     PV-SQLCODE                                   05920000
059300                     DELIMITED BY SIZE                            05930000
059400                               INTO PV-DB2-OPERATION-MSG-1        05940000
059500             PERFORM 9998-SQL-ABEND                               05950000
059600     END-EVALUATE.                                                05960000
059700                                                                  05970000
059800******************************************************************05980000
059900 1030-FETCH-CURSOR.                                               05990000
060000                                                                  06000000
060100     EXEC SQL                                                     06010000
060200         FETCH SC_CSR                                             06020000
060300          INTO :XLT00010-LOC-NBR                                  06030000
060400             , :XLT00010-LOC-NM                                   06040000
060500             , :XLT00010-LOC-TYP-CDE                              06050000
060600             , :XLT00014-DC-NBR  :PV-NULL-IND                     06060000
060700     END-EXEC.                                                    06070000
060800                                                                  06080000
060900     EVALUATE TRUE                                                06090000
061000         WHEN SQLCODE = ZERO                                      06100000
061100              IF PV-NULL-IND  =  -1                               06110000
061200                  MOVE ZEROES  TO XLT00014-DC-NBR                 06120000
061300              END-IF                                              06130000
061400                                                                  06140000
061500         WHEN SQLCODE = +100                                      06150000
061600             SET PS-END-OF-CURSOR TO TRUE                         06160000
061700                                                                  06170000
061800         WHEN OTHER                                               06180000
061900             MOVE SQLCODE TO PV-SQLCODE                           06190000
062000             MOVE '1030-FETCH-CURSOR' TO PV-ABEND-PARA-NAME       06200000
062100             STRING 'SQL ERROR FETCHING DATA - '                  06210000
062200                     PV-SQLCODE                                   06220000
062300                     DELIMITED BY SIZE                            06230000
062400                                    INTO PV-DB2-OPERATION-MSG-1   06240000
062500             PERFORM 9998-SQL-ABEND                               06250000
062600     END-EVALUATE.                                                06260000
062700                                                                  06270000
062800******************************************************************06280000
062900*   INITIALIZE REPORT HEADINGS.                                   06290000
063000******************************************************************06300000
063100 1200-INITIALIZE-HEADINGS.                                        06310000
063200                                                                  06320000
063300     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              06330000
063400     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             06340000
063500     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               06350000
063600     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              06360000
063700     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            06370000
063800     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          06380000
063900                                                                  06390000
064000******************************************************************06400000
064100*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE      06410000
064200*  BOSS TRANSFER CARTONS REPORT.                                  06420000
064300******************************************************************06430000
064400 2000-MAIN-PROCESS.                                               06440000
064500                                                                  06450000
064600     IF PV-SAVE-LOC = GV002-INV-RECEIVING-NODE                    06460000
064710        IF GV002-INV-SHIP-NODE  =  PV-SAVE-EFC                    06471022
064711           CONTINUE                                               06471126
064720        ELSE                                                      06472026
064740           SET PS-MULT-LOC-YES  TO TRUE                           06474023
064750        END-IF                                                    06475022
064800                                                                  06480000
064900     ELSE                                                         06490000
065000        PERFORM 5010-UPDATE-SCAN-LOC-CRTN-CNT                     06500000
065100        MOVE PV-SAVE-LOC              TO HL3-LOC                  06510000
065110        SET PS-MULT-LOC-NO            TO TRUE                     06511025
065200        PERFORM 6850-PRINT-DTL-REPORT-TOTALS                      06520000
065300        MOVE GV002-INV-RECEIVING-NODE TO PV-SAVE-LOC              06530000
065310        MOVE GV002-INV-SHIP-NODE TO PV-SAVE-EFC                   06531027
065400        PERFORM 6999-PRINT-REPORT-HEADINGS                        06540000
065500     END-IF.                                                      06550000
065600                                                                  06560000
065660                                                                  06566013
065700     PERFORM 3000-PROCESS-DETAIL-RECORD.                          06570000
065701                                                                  06570116
065800                                                                  06580000
065900*READ NEXT INPUT RECORD.                                          06590000
066000     ADD  +1                     TO WS-RECORDS-WRITE-QTY.         06600000
066100     PERFORM 7000-READ-EXTRACT.                                   06610000
066200     ADD  +1                     TO WS-RECORDS-READ-QTY.          06620000
066300                                                                  06630000
066310*    IF GV002-INV-SHIP-NODE  =  PV-SAVE-EFC                       06631027
066320*        CONTINUE                                                 06632027
066330*    ELSE                                                         06633027
066340*        MOVE GV002-INV-SHIP-NODE TO PV-SAVE-EFC                  06634027
066350*    END-IF.                                                      06635027
066400******************************************************************06640000
066500 3000-PROCESS-DETAIL-RECORD.                                      06650000
066600                                                                  06660000
066700     MOVE GV002-INV-RECEIVING-NODE                                06670000
066800                                 TO DL1-SCAN-LOC.                 06680000
066900     MOVE GV002-INV-BATCH-NBR    TO PV-EDIT-CHAR4.                06690000
067000     MOVE PV-EDIT-NUM4           TO DL1-BATCH-NBR.                06700000
067100     MOVE GV002-INV-SHIP-NODE    TO PV-EDIT-CHAR5.                06710000
067200     MOVE PV-EDIT-NUM5           TO DL1-EFC-NBR.                  06720000
067300     MOVE GV002-INV-DEPT-NBR     TO DL1-DEPT-NBR.                 06730000
067400     MOVE GV002-INV-MAJOR-CLASS  TO PV-EDIT-CHAR4.                06740000
067500     MOVE PV-EDIT-NUM4           TO DL1-MAJOR-CLASS.              06750000
067600     MOVE GV002-INV-SUB-CLASS    TO PV-EDIT-CHAR4.                06760000
067700     MOVE PV-EDIT-NUM4           TO DL1-SUB-CLASS.                06770000
067800     MOVE GV002-INV-ITEM-ID      TO DL1-SKU-NBR.                  06780000
067900     MOVE GV002-INV-SKU-DESC     TO DL1-SKU-DESC.                 06790000
068000     MOVE GV002-INV-BATCH-DATE   TO DL1-DATE.                     06800000
068100     MOVE GV002-INV-ORDER-NBR    TO DL1-TRANSFER-NBR.             06810000
068200                                                                  06820000
068300     MOVE GV002-INV-QUANTITY     TO DL1-NBR-OF-UNITS.             06830000
068400     ADD  GV002-INV-QUANTITY     TO PV-DT-TOT-UNITS.              06840000
068500     ADD  PV-RPT-TOTAL-UNITS     TO PV-RPT-TOTAL-UNITS.           06850000
068600     MOVE ZEROS                  TO PV-RPT-TOTAL-UNITS.           06860000
068700                                                                  06870000
068800     MOVE GV002-INV-RETAIL-VALUE TO DL1-RETAIL-VALUE              06880000
068900                                    PV-UNIT-RETAIL-QTY.           06890000
069000     MOVE GV002-INV-RETAIL-VALUE TO PV-RPT-TOTAL-RETAIL.          06900000
069100     ADD  PV-RPT-TOTAL-RETAIL    TO PV-DT-TOT-RETAIL.             06910000
069200     MOVE ZEROS                  TO PV-RPT-TOTAL-RETAIL.          06920000
069300                                                                  06930000
069400     IF GV002-INV-ORDER-NBR  =  PV-ORDER-NBR                      06940000
069500         CONTINUE                                                 06950000
069600     ELSE                                                         06960000
069700         ADD  1                   TO PV-SCN-LOC-ORDER-COUNT       06970000
069800         MOVE GV002-INV-ORDER-NBR TO PV-ORDER-NBR                 06980000
069900     END-IF.                                                      06990000
070000                                                                  07000000
070106                                                                  07010609
070110     PERFORM 5000-SEARCH-SUMMARY-TABLE.                           07011006
070200                                                                  07020000
070300     PERFORM 6000-PRINT-REPORT-DETAIL.                            07030000
070400                                                                  07040000
070500******************************************************************07050000
070620 5000-SEARCH-SUMMARY-TABLE.                                       07062005
070800     SET SC-IDX TO 1.                                             07080000
070900                                                                  07090000
071000     SEARCH SUMMARY-TABLE                                         07100000
071100       VARYING SC-IDX                                             07110000
071200          AT END SET PS-END-OF-TABLE TO TRUE                      07120000
071300                                                                  07130000
071400         WHEN SUMMARY-SCLOC-NBR (SC-IDX) =                        07140005
071500                                   GV002-INV-RECEIVING-NODE       07150026
071520                                                                  07152021
071600              ADD GV002-INV-QUANTITY                              07160000
071700                                TO SUMMARY-TOTAL-UNITS (SC-IDX)   07170000
071800              ADD PV-UNIT-RETAIL-QTY                              07180000
071900                                TO SUMMARY-TOTAL-RETAIL (SC-IDX)  07190000
072000              MOVE GV002-INV-BATCH-NBR                            07200000
072100                                TO SUMMARY-BTCH-NBR (SC-IDX)      07210000
072200              MOVE GV002-INV-BATCH-DATE                           07220000
072300                                TO SUMMARY-DATE (SC-IDX)          07230000
072400              MOVE GV002-INV-SHIP-NODE                            07240000
072500                                TO SUMMARY-DC-NBR (SC-IDX)        07250000
072600              ADD 1             TO SUMMARY-SKU-CNT (SC-IDX)       07260000
072610              IF PS-MULT-LOC-YES                                  07261023
072620                 MOVE 'Y' TO SUMMARY-MULT-LOC (SC-IDX)            07262022
072630              END-IF                                              07263022
072700     END-SEARCH.                                                  07270000
072800                                                                  07280000
072900******************************************************************07290000
073000* UPDATE THE SUMMARY TABLE WITH THE UNIQUE CARTON COUNT           07300000
073100******************************************************************07310000
073200 5010-UPDATE-SCAN-LOC-CRTN-CNT.                                   07320000
073300                                                                  07330000
073400     SET SC-IDX TO 1.                                             07340000
073500                                                                  07350000
073600     SEARCH SUMMARY-TABLE                                         07360000
073700         VARYING SC-IDX                                           07370000
073800              AT END SET PS-END-OF-TABLE TO TRUE                  07380000
073900         WHEN SUMMARY-SCLOC-NBR (SC-IDX) = PV-SAVE-LOC            07390000
074000              ADD PV-SCN-LOC-ORDER-COUNT                          07400000
074100                                TO SUMMARY-TRANSFER-CNT(SC-IDX)   07410000
074200              ADD PV-SCN-LOC-ORDER-COUNT                          07420000
074300                                TO PV-ST-ORDER-COUNT              07430000
074400              MOVE ZEROES       TO PV-SCN-LOC-ORDER-COUNT         07440000
074500     END-SEARCH.                                                  07450000
074600                                                                  07460000
074700******************************************************************07470000
074800*     WRITES THE DETAIL LINE INFO FOR THE "DETAIL" REPORT         07480000
074900******************************************************************07490000
075000 6000-PRINT-REPORT-DETAIL.                                        07500000
075100                                                                  07510000
075200     IF PV-LINE-COUNT > PC-55                                     07520000
075300         PERFORM 6999-PRINT-REPORT-HEADINGS                       07530000
075400     END-IF.                                                      07540000
075500                                                                  07550000
075600     WRITE DETAIL-REPORT-RECORD                                   07560000
075700       FROM REPORT-DETAIL-LINE                                    07570000
075800         AFTER ADVANCING 1 LINE.                                  07580000
075900                                                                  07590000
076000     ADD PC-1            TO PV-LINE-COUNT.                        07600000
076100                                                                  07610000
076200     INITIALIZE REPORT-DETAIL-LINE.                               07620000
076300                                                                  07630000
076400******************************************************************07640000
076500*   PRINTS THE TOTALS LINES FOR THE "DETAIL" REPORT               07650000
076600******************************************************************07660000
076700 6850-PRINT-DTL-REPORT-TOTALS.                                    07670000
076800                                                                  07680000
076900     MOVE PV-DT-TOT-UNITS        TO TL1-TOTAL-UNITS.              07690000
077000     MOVE PV-DT-TOT-RETAIL       TO TL1-TOTAL-RETAIL.             07700000
077100                                                                  07710000
077200     WRITE DETAIL-REPORT-RECORD                                   07720000
077300       FROM BL-BLANK-LINE                                         07730000
077400         AFTER ADVANCING 2 LINES.                                 07740000
077500                                                                  07750000
077600     WRITE DETAIL-REPORT-RECORD                                   07760000
077700       FROM REPORT-TOTALS-LINE                                    07770000
077800         AFTER ADVANCING 2 LINES.                                 07780000
077900                                                                  07790000
078000     WRITE DETAIL-REPORT-RECORD                                   07800000
078100       FROM BL-BLANK-LINE                                         07810000
078200         AFTER ADVANCING 2 LINES.                                 07820000
078300                                                                  07830000
078400     IF  PS-END-OF-FILE                                           07840000
078500     AND PS-FIRST-TIME-YES                                        07850000
078600         PERFORM 6900-NO-DETAIL                                   07860000
078700     END-IF.                                                      07870000
078800                                                                  07880000
078900     WRITE DETAIL-REPORT-RECORD                                   07890000
079000       FROM BL-BLANK-LINE                                         07900000
079100         AFTER ADVANCING 2 LINES.                                 07910000
079200                                                                  07920000
079300     MOVE ZEROS                   TO PV-DT-TOT-UNITS.             07930000
079400     MOVE ZEROS                   TO PV-DT-TOT-RETAIL.            07940000
079500                                                                  07950000
079600******************************************************************07960000
079700*  PRINTS REPORT HEADINGS FOR THE SUMMARY REPORT                  07970000
079800******************************************************************07980000
079900 6875-PRINT-SUMMARY.                                              07990000
080000                                                                  08000000
080100     MOVE 1                       TO PV-SUM-PAGE-COUNT.           08010000
080200     MOVE PV-SUM-PAGE-COUNT       TO DP132O-PAGE-NUMBER.          08020000
080300     MOVE 2                       TO DP132O-REPORT-NUMBER.        08030000
080400                                                                  08040000
080500     WRITE SUMMARY-REPORT-RECORD                                  08050000
080600       FROM DP132O-STANDRD-HEADER-132-COLS                        08060000
080700         AFTER ADVANCING PAGE.                                    08070000
080800                                                                  08080000
080900     WRITE SUMMARY-REPORT-RECORD                                  08090000
081000       FROM HEADING-LINE7                                         08100000
081100         AFTER ADVANCING 1 LINE.                                  08110000
081200                                                                  08120000
081300     WRITE SUMMARY-REPORT-RECORD                                  08130000
081400       FROM BL-BLANK-LINE                                         08140000
081500         AFTER ADVANCING 1 LINE.                                  08150000
081600                                                                  08160000
081700     WRITE SUMMARY-REPORT-RECORD                                  08170000
081800       FROM HEADING-LINE8                                         08180000
081900         AFTER ADVANCING 1 LINE.                                  08190000
082000                                                                  08200000
082100     WRITE SUMMARY-REPORT-RECORD                                  08210000
082200       FROM HEADING-LINE9.                                        08220000
082300                                                                  08230000
082400     WRITE SUMMARY-REPORT-RECORD                                  08240000
082500       FROM BL-BLANK-LINE                                         08250000
082600         AFTER ADVANCING 1 LINE.                                  08260000
082700                                                                  08270000
082800     MOVE PC-10           TO PV-LINE-COUNT-RPT2.                  08280000
082900                                                                  08290000
083000** GET INFO FROM TABLE                                            08300000
083100     PERFORM 6880-PRINT-SUMM-DETAIL                               08310000
083200       VARYING SC-IDX FROM 1 BY 1                                 08320000
083300         UNTIL SUMMARY-SCLOC-NBR (SC-IDX) = ZEROS.                08330000
083400                                                                  08340000
083500     MOVE PV-ST-SKU-TOT          TO TL2-SKU-COUNT.                08350000
083600     MOVE PV-ST-UNITS-TOT        TO TL2-TOTAL-TOTAL-UNITS.        08360000
083700     MOVE PV-ST-RETAIL-TOT       TO TL2-TOTAL-TOTAL-RETAIL.       08370000
083800     MOVE PV-ST-ORDER-COUNT      TO TL2-TRANSFER-COUNT.           08380000
083900                                                                  08390000
084000     WRITE SUMMARY-REPORT-RECORD                                  08400000
084100         FROM BL-BLANK-LINE                                       08410000
084200           AFTER ADVANCING 2 LINES.                               08420000
084300                                                                  08430000
084400     WRITE SUMMARY-REPORT-RECORD                                  08440000
084500         FROM SUMMARY-TOTALS-LINE                                 08450000
084600           AFTER ADVANCING 2 LINES.                               08460000
084700                                                                  08470000
084800******************************************************************08480000
084900*  PRINT THE "SUMMARY REPORT" DETAIL LINES.                       08490000
085000******************************************************************08500000
085100 6880-PRINT-SUMM-DETAIL.                                          08510000
085200                                                                  08520000
085300     IF (SUMMARY-LOC-TYPE-CDE (SC-IDX) = 'CS'                     08530000
085400     OR  SUMMARY-LOC-TYPE-CDE (SC-IDX) = 'DS')                    08540000
085500     AND SUMMARY-SKU-CNT (SC-IDX)      > 0                        08550000
085600         MOVE SUMMARY-SCLOC-NBR (SC-IDX)    TO DL2-SCAN-STORE-NBR 08560000
085700         MOVE SUMMARY-SCLOC-NAME (SC-IDX)   TO DL2-STORE-NAME     08570000
085800         MOVE SUMMARY-BTCH-NBR (SC-IDX)     TO PV-EDIT-CHAR4      08580000
085900         MOVE PV-EDIT-NUM4                  TO DL2-BATCH-NBR      08590000
086000         MOVE SUMMARY-DATE (SC-IDX)         TO DL2-DATE           08600000
086100         MOVE SUMMARY-SKU-CNT (SC-IDX)      TO DL2-SKU-CNT        08610000
086200         MOVE SUMMARY-TOTAL-UNITS  (SC-IDX) TO DL2-TOTAL-UNITS    08620000
086300         MOVE SUMMARY-TOTAL-RETAIL (SC-IDX) TO DL2-TOTAL-RETAIL   08630000
086301                                                                  08630123
086310         IF   SUMMARY-MULT-LOC  (SC-IDX) = 'Y'                    08631023
086320              MOVE  PC-MULT                 TO DL2-EFC-NBR-X      08632028
086330         ELSE                                                     08633023
086400              MOVE SUMMARY-DC-NBR       (SC-IDX) TO DL2-EFC-NBR   08640023
086410         END-IF                                                   08641023
086420                                                                  08642023
086500         MOVE SUMMARY-TRANSFER-CNT (SC-IDX) TO DL2-TRANSFER-COUNT 08650000
086600                                                                  08660000
086700         ADD SUMMARY-SKU-CNT      (SC-IDX)  TO PV-ST-SKU-TOT      08670000
086800         ADD SUMMARY-TOTAL-UNITS  (SC-IDX)  TO PV-ST-UNITS-TOT    08680000
086900         ADD SUMMARY-TOTAL-RETAIL (SC-IDX)  TO PV-ST-RETAIL-TOT   08690000
087000                                                                  08700000
087100         WRITE SUMMARY-REPORT-RECORD                              08710000
087200           FROM SUMMARY-DETAIL-LINE                               08720000
087300             AFTER ADVANCING 1 LINE                               08730000
087400                                                                  08740000
087500         ADD 1                              TO PV-LINE-COUNT-RPT2 08750000
087600                                                                  08760000
087700     END-IF.                                                      08770000
087800                                                                  08780000
087900     IF PV-LINE-COUNT-RPT2 > 50                                   08790000
088000         ADD  1                             TO PV-SUM-PAGE-COUNT  08800000
088100         MOVE PV-SUM-PAGE-COUNT             TO DP132O-PAGE-NUMBER 08810000
088200                                                                  08820000
088300         WRITE SUMMARY-REPORT-RECORD                              08830000
088400           FROM DP132O-STANDRD-HEADER-132-COLS                    08840000
088500             AFTER ADVANCING PAGE                                 08850000
088600                                                                  08860000
088700         WRITE SUMMARY-REPORT-RECORD                              08870000
088800           FROM HEADING-LINE7                                     08880000
088900             AFTER ADVANCING 1 LINE                               08890000
089000                                                                  08900000
089100         WRITE SUMMARY-REPORT-RECORD                              08910000
089200           FROM BL-BLANK-LINE                                     08920000
089300             AFTER ADVANCING 1 LINE                               08930000
089400                                                                  08940000
089500         WRITE SUMMARY-REPORT-RECORD                              08950000
089600           FROM HEADING-LINE8                                     08960000
089700             AFTER ADVANCING 1 LINE                               08970000
089800                                                                  08980000
089900         WRITE SUMMARY-REPORT-RECORD                              08990000
090000           FROM HEADING-LINE9                                     09000000
090100                                                                  09010000
090200         WRITE SUMMARY-REPORT-RECORD                              09020000
090300           FROM BL-BLANK-LINE                                     09030000
090400             AFTER ADVANCING 1 LINE                               09040000
090500                                                                  09050000
090600         MOVE PC-10                         TO PV-LINE-COUNT-RPT2 09060000
090700     END-IF.                                                      09070000
090800                                                                  09080000
090900******************************************************************09090000
091000*  PRINTS NO DETAIL LINE FOR THE DETAIL REPORT                    09100000
091100******************************************************************09110000
091200 6900-NO-DETAIL.                                                  09120000
091300                                                                  09130000
091400     WRITE DETAIL-REPORT-RECORD                                   09140000
091500       FROM NO-DATA-TO-REPORT-LINE                                09150000
091600         AFTER ADVANCING 3 LINES.                                 09160000
091700                                                                  09170000
091800******************************************************************09180000
091900*  PRINTS NO DETAIL LINE FOR THE SUMMARY REPORT                   09190000
092000******************************************************************09200000
092100 6910-NO-SUM-DETAIL.                                              09210000
092200                                                                  09220000
092300     WRITE SUMMARY-REPORT-RECORD                                  09230000
092400       FROM NO-DATA-TO-REPORT-LINE                                09240000
092500         AFTER ADVANCING 3 LINES.                                 09250000
092600                                                                  09260000
092700******************************************************************09270000
092800*  PRINTS REPORT HEADINGS FOR THE MAIN REPORT.                    09280000
092900******************************************************************09290000
093000 6999-PRINT-REPORT-HEADINGS.                                      09300000
093100                                                                  09310000
093200     PERFORM 7200-GET-STORE-INFORMATION.                          09320001
093300                                                                  09330000
093400     MOVE 1                       TO DP132O-REPORT-NUMBER.        09340000
093500     ADD  1                       TO PV-DTL-PAGE-COUNT.           09350000
093600     MOVE PV-DTL-PAGE-COUNT       TO DP132O-PAGE-NUMBER.          09360000
093700                                                                  09370000
093800     WRITE DETAIL-REPORT-RECORD                                   09380000
093900       FROM DP132O-STANDRD-HEADER-132-COLS                        09390000
094000         AFTER ADVANCING PAGE.                                    09400000
094100                                                                  09410000
094200     MOVE GV002-INV-BATCH-DATE    TO HL1-BTCH-PRC-DTE             09420000
094300                                     HL7-BTCH-PRC-DTE.            09430000
094400                                                                  09440000
094500     MOVE GV002-INV-BATCH-NBR     TO HL2-BTCH-NBR.                09450000
094600     MOVE PV-SAVE-LOC             TO HL3-LOC.                     09460000
094700     MOVE PV-RPT-STORE-NAME       TO HL3-STORE-NAME.              09470000
094800     MOVE GV002-INV-ITEM-ID       TO PV-PREV-SKU.                 09480000
094900                                                                  09490000
095000     MOVE GV002-INV-RECEIVING-NODE TO HL3-LOC.                    09500000
095100     MOVE PV-RPT-STORE-NAME       TO HL3-STORE-NAME.              09510000
095200                                                                  09520000
095300     WRITE DETAIL-REPORT-RECORD                                   09530000
095400       FROM HEADING-LINE1                                         09540000
095500         AFTER ADVANCING 2 LINES.                                 09550000
095600                                                                  09560000
095700     WRITE DETAIL-REPORT-RECORD                                   09570000
095800       FROM HEADING-LINE2                                         09580000
095900         AFTER ADVANCING 1 LINE.                                  09590000
096000                                                                  09600000
096100     WRITE DETAIL-REPORT-RECORD                                   09610000
096200       FROM BL-BLANK-LINE                                         09620000
096300         AFTER ADVANCING 1 LINE.                                  09630000
096400                                                                  09640000
096500     WRITE DETAIL-REPORT-RECORD                                   09650000
096600       FROM HEADING-LINE3                                         09660000
096700         AFTER ADVANCING 1 LINE.                                  09670000
096800                                                                  09680000
096900     WRITE DETAIL-REPORT-RECORD                                   09690000
097000       FROM BL-BLANK-LINE                                         09700000
097100         AFTER ADVANCING 1 LINE.                                  09710000
097200                                                                  09720000
097300     WRITE DETAIL-REPORT-RECORD                                   09730000
097400       FROM HEADING-LINE4                                         09740000
097500         AFTER ADVANCING 1 LINE.                                  09750000
097600                                                                  09760000
097700     WRITE DETAIL-REPORT-RECORD                                   09770000
097800       FROM HEADING-LINE5.                                        09780000
097900                                                                  09790000
098000     MOVE SPACES TO DETAIL-REPORT-RECORD.                         09800000
098100     WRITE DETAIL-REPORT-RECORD                                   09810000
098200       AFTER ADVANCING 1 LINE.                                    09820000
098300                                                                  09830000
098400     MOVE PC-10                   TO PV-LINE-COUNT.               09840000
098500                                                                  09850000
098600******************************************************************09860000
098700 7000-READ-EXTRACT.                                               09870000
098800                                                                  09880000
098900     READ INPUT-FILE INTO GV002-INVENTORY-RECORD                  09890000
099000        AT END                                                    09900000
099100           SET PS-END-OF-FILE TO TRUE                             09910000
099200     END-READ.                                                    09920000
099300                                                                  09930000
099400******************************************************************09940000
099500*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.              09950000
099600******************************************************************09960000
099700 7200-GET-STORE-INFORMATION.                                      09970000
099800                                                                  09980000
099900     INITIALIZE XL071-COMMAREA-REC.                               09990000
100000     MOVE GV002-INV-RECEIVING-NODE TO XL071-LOCATION-NUMBER.      10000000
100100                                                                  10010000
100200     CALL XL071-LOCATION-MODULE USING                             10020000
100300                                XL071-COMMAREA-REC.               10030000
100400                                                                  10040000
100500     EVALUATE TRUE                                                10050000
100600         WHEN XL071-NO-ERRORS                                     10060000
100700              MOVE XL071-LOC-NM TO PV-RPT-STORE-NAME              10070000
100800                                                                  10080000
100900         WHEN XL071-LOC-NOT-FOUND                                 10090000
101000              MOVE SPACES TO PV-RPT-STORE-NAME                    10100000
101100                                                                  10110000
101200         WHEN XL071-DC-ASGMT-NOT-FND                              10120000
101300              MOVE SPACES TO PV-RPT-STORE-NAME                    10130000
101400              IF PS-END-OF-FILE                                   10140000
101500                 CONTINUE                                         10150000
101600              ELSE                                                10160000
101700                 DISPLAY '7200 - DC ASGMT NOT FOUND '             10170000
101800                                 XL071-LOCATION-NUMBER            10180000
101900              END-IF                                              10190000
102000                                                                  10200000
102100         WHEN OTHER                                               10210000
102200              MOVE '7200-GET-STORE-INFO' TO PV-ABEND-PARA-NAME    10220000
102300              STRING 'SQL ERROR CALLING XLKUT071 - '              10230000
102400                      XL071-SQLCODE      ' -'                     10240000
102500                      XL071-RETURN-CODE  ' -'                     10250000
102600                      XL071-LOCATION-NUMBER                       10260000
102700                      DELIMITED BY SIZE                           10270000
102800                                       INTO PV-DB2-OPERATION-MSG-110280000
102900              MOVE XL071-SQLCODE TO PV-SQLCODE                    10290000
103000              PERFORM 9998-SQL-ABEND                              10300000
103100                                                                  10310000
103200     END-EVALUATE.                                                10320000
103300                                                                  10330000
103400******************************************************************10340000
103500*     PRINT REPORT TOTALS                                         10350000
103600*     CLOSE FILES                                                 10360000
103700*     DISPLAY COUNTS                                              10370000
103800******************************************************************10380000
103900 9000-END-PROCESS.                                                10390000
104000                                                                  10400000
104040                                                                  10404010
104100     PERFORM 6850-PRINT-DTL-REPORT-TOTALS.                        10410000
104200     PERFORM 6875-PRINT-SUMMARY.                                  10420000
104300                                                                  10430000
104400     WRITE SUMMARY-REPORT-RECORD                                  10440000
104500       FROM BL-BLANK-LINE                                         10450000
104600         AFTER ADVANCING 2 LINES.                                 10460000
104700                                                                  10470000
104800     IF  PS-END-OF-FILE                                           10480000
104900     AND PS-FIRST-TIME-YES                                        10490000
105000         PERFORM 6910-NO-SUM-DETAIL                               10500000
105100     END-IF.                                                      10510000
105200                                                                  10520000
105300     WRITE SUMMARY-REPORT-RECORD                                  10530000
105400       FROM BL-BLANK-LINE                                         10540000
105500         AFTER ADVANCING 2 LINES.                                 10550000
105600                                                                  10560000
105700     CLOSE INPUT-FILE                                             10570000
105800           DETAIL-REPORT-FILE                                     10580000
105900           SUMMARY-REPORT-FILE.                                   10590000
106000                                                                  10600000
106100     MOVE WS-RECORDS-READ-QTY            TO WS-EDIT-QTY.          10610000
106200     DISPLAY 'NUMBER OF RECORDS READ:    '  WS-EDIT-QTY.          10620000
106300                                                                  10630000
106400     MOVE WS-RECORDS-WRITE-QTY           TO WS-EDIT-QTY.          10640000
106500     DISPLAY 'NUMBER OF RECORDS WRITTEN: '  WS-EDIT-QTY.          10650000
106600                                                                  10660000
106700******************************************************************10670000
106800*     SQL ERROR PROCESSING                                        10680000
106900******************************************************************10690000
107000 9998-SQL-ABEND.                                                  10700000
107100                                                                  10710000
107200     MOVE SQLCODE     TO PV-SQLCODE.                              10720000
107300     DISPLAY '** ABEND           ** = SQLABEND'.                  10730000
107400     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          10740000
107500     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME        10750000
107600     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        10760000
107700     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   10770000
107800     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MSG-2.   10780000
107900     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               10790000
108000     COPY DPPD004.                                                10800000
108100                                                                  10810000
108200     MOVE +4013                  TO PV-ABEND-CODE.                10820000
108300     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       10830000
