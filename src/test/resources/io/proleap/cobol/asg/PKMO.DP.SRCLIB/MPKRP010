000100******************************************************************00010030
000200 IDENTIFICATION DIVISION.                                         00020030
000300******************************************************************00030030
000400                                                                  00040030
000500 PROGRAM-ID.             MPKRP010.                                00050030
000600 AUTHOR.                 GARY POWELSKI COMPUTOR PEOPLE UNLIMITED. 00060030
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070030
000800 DATE-WRITTEN            JANUARY, 1989.                           00080030
000900 DATE-COMPILED.                                                   00090030
001000                                                                  00100030
001100******************************************************************00110030
001200*   FIX 8100- PRIOR TO RETURN TO PRODUCTION                      *00120030
001300******************************************************************00130030
001400*  CREATE THE DAILY AND MONTH TO DATE RECEIPTS VS. BUYER'S       *00140030
001500*  PROJECTION REPORT.  THE REPORT WILL BE PRODUCED FOR THE       *00150030
001600*  FOLLOWING LOCATIONS:                                          *00160030
001700*      DS -- DIRECT SHIP                                         *00170030
001800*      D1 -- MENOMONEE FALLS                                     *00180030
001900*      D2 -- FINDLAY                                             *00190030
002000*      CO -- COMPANY TOTAL (THIS IS A SUMMARY OF THE OTHER       *00200030
002100*            LOCATIONS).                                         *00210030
002200******************************************************************00220030
002300*                                                                 00230030
002400*                                                                 00240030
002500******************************************************************00250030
002600 ENVIRONMENT DIVISION.                                            00260030
002700******************************************************************00270030
002800                                                                  00280030
002900 CONFIGURATION SECTION.                                           00290030
003000                                                                  00300030
003100 SOURCE-COMPUTER.        IBM-3090.                                00310030
003200 OBJECT-COMPUTER.        IBM-3090.                                00320030
003300                                                                  00330030
003400 INPUT-OUTPUT SECTION.                                            00340030
003500                                                                  00350030
003600 FILE-CONTROL.                                                    00360030
003700                                                                  00370030
003800     SELECT DAILY-KEYREC-DC-FILE                                  00380030
003900         ASSIGN TO INP01.                                         00390030
004000                                                                  00400030
004100     SELECT RUN-DATE-FILE                                         00410030
004200         ASSIGN TO INP02.                                         00420030
004300                                                                  00430030
004400     SELECT DAILY-KEYREC-CO-FILE                                  00440030
004500         ASSIGN TO INP03.                                         00450030
004600                                                                  00460030
004700     SELECT DAILY-VERIFY-REPORT                                   00470030
004800         ASSIGN TO RPT01.                                         00480030
004900*                                                                 00490030
005000*                                                                 00500030
005100******************************************************************00510030
005200 DATA DIVISION.                                                   00520030
005300******************************************************************00530030
005400                                                                  00540030
005500 FILE SECTION.                                                    00550030
005600                                                                  00560030
005700 FD  DAILY-KEYREC-DC-FILE                                         00570030
005800     RECORDING MODE IS F                                          00580030
005900     BLOCK CONTAINS 0 RECORDS.                                    00590030
006000                                                                  00600030
006100 01  DAILY-KEYREC-DC-RECORD          PIC  X(90).                  00610030
006200*                                                                 00620030
006300*                                                                 00630030
006400 FD  RUN-DATE-FILE                                                00640030
006500     RECORDING MODE IS F                                          00650030
006600     BLOCK CONTAINS 0 RECORDS.                                    00660030
006700                                                                  00670030
006800 01  RUN-DATE-RECORD.                                             00680030
006900     05  RD-RUN-DATE.                                             00690030
007000         10  RD-RUN-DATE-MM          PIC  X(02).                  00700030
007100         10  RD-RUN-DATE-DD          PIC  X(02).                  00710030
007200         10  RD-RUN-DATE-YY          PIC  X(02).                  00720030
007300     05  FILLER                      PIC  X(74).                  00730030
007400*                                                                 00740030
007500*                                                                 00750030
007600 FD  DAILY-KEYREC-CO-FILE                                         00760030
007700     RECORDING MODE IS F                                          00770030
007800     BLOCK CONTAINS 0 RECORDS.                                    00780030
007900                                                                  00790030
008000 01  DAILY-KEYREC-CO-RECORD          PIC  X(90).                  00800030
008100*                                                                 00810030
008200*                                                                 00820030
008300 FD  DAILY-VERIFY-REPORT                                          00830030
008400     RECORDING MODE IS F                                          00840030
008500     BLOCK CONTAINS 0 RECORDS.                                    00850030
008600                                                                  00860030
008700 01  DAILY-VERIFY-LINE               PIC  X(150).                 00870030
008800*                                                                 00880030
008900*                                                                 00890030
009000 WORKING-STORAGE SECTION.                                         00900030
009100*                                                                 00910030
009200 01  PS-PROGRAM-SWITCHES.                                         00920030
009300     05  PS-DC-EOF-SW                PIC  X(03)    VALUE 'BOF'.   00930030
009400         88  PS-DC-EOF                             VALUE 'EOF'.   00940030
009500     05  PS-CO-EOF-SW                PIC  X(03)    VALUE 'BOF'.   00950030
009600         88  PS-CO-EOF                             VALUE 'EOF'.   00960030
009700*                                                                 00970030
009800*                                                                 00980030
009900 01  PC-PROGRAM-CONSTANTS.                                        00990030
010000     05  PC-MBS-OP-CO-03           PIC  X(02)      VALUE '03'.    01000030
010100     05  PC-MBS-SYSTEM-CODE-ML     PIC  X(02)      VALUE 'ML'.    01010030
010200     05  PC-PGM-DPKUT039           PIC  X(08)      VALUE          01020030
010300         'DPKUT039'.                                              01030030
010400     05  PC-PGM-DPKUT500           PIC X(08)       VALUE          01040030
010500         'DPKUT500'.                                              01050030
010600*                                                                 01060030
010700*                                                                 01070030
010800 01  CC-CONTROL-CARD.                                             01080030
010900     05  CC-REPORT-CODE              PIC  X(01).                  01090030
011000         88  CC-VALID-REPORT-CODE    VALUE 'D', 'M'.              01100030
011100         88  CC-DC-REPORT            VALUE 'D'.                   01110030
011200         88  CC-MERCH-REPORT         VALUE 'M'.                   01120030
011300*                                                                 01130030
011400 01  PV-PROGRAM-VARIABLES.                                        01140030
011500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01150030
011600                                                   COMP SYNC.     01160030
011700     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01170030
011800     05  PV-CARR-RETRN               PIC  9(01)    VALUE 1.       01180030
011900     05  PV-SQLCODE                  PIC  ZZZZZZZZ9-.             01190030
012000     05  PV-DB2-DATE                 PIC  X(10)    VALUE SPACES.  01200030
012100     05  PV-ERR-MSG-1                PIC  X(80)    VALUE SPACES.  01210030
012200     05  PV-ERR-MSG-2                PIC  X(80)    VALUE SPACES.  01220030
012300     05  PV-SAV-DC                   PIC  X(02)    VALUE SPACES.  01230030
012400     05  PV-SAV-ID                   PIC S9(04)    COMP VALUE +0. 01240030
012500     05  PV-SAV-GMM                  PIC  9(02)    VALUE ZERO.    01250030
012600     05  PV-SAV-DMM                  PIC  9(02)    VALUE ZERO.    01260030
012700     05  PV-SAV-DEPT                 PIC  9(03)    VALUE ZERO.    01270030
012800     05  PV-SAV-DATE                 PIC  9(06)    VALUE ZERO.    01280030
012900*                                                                 01290030
013000*                                                                 01300030
013100 01  PV-PROGRAM-VARIABLES-COMP3                    COMP-3.        01310030
013200     05  PV-PAGE-CNT                 PIC S9(03)    VALUE ZERO.    01320030
013300     05  PV-LINE-CNT                 PIC S9(03)    VALUE +63.     01330030
013400***                                                               01340030
013500**** DETAIL LINE COUNTS                                           01350030
013600***                                                               01360030
013700     05  PV-RET-SUN-CNT              PIC S9(12)V99 VALUE ZERO.    01370030
013800     05  PV-RET-MON-CNT              PIC S9(12)V99 VALUE ZERO.    01380030
013900     05  PV-RET-TUE-CNT              PIC S9(12)V99 VALUE ZERO.    01390030
014000     05  PV-RET-WED-CNT              PIC S9(12)V99 VALUE ZERO.    01400030
014100     05  PV-RET-THR-CNT              PIC S9(12)V99 VALUE ZERO.    01410030
014200     05  PV-RET-FRI-CNT              PIC S9(12)V99 VALUE ZERO.    01420030
014300     05  PV-RET-SAT-CNT              PIC S9(12)V99 VALUE ZERO.    01430030
014400     05  PV-WEEK-TOT-CNT             PIC S9(12)V99 VALUE ZERO.    01440030
014500     05  PV-MTD-RCPT-CNT             PIC S9(12)V99 VALUE ZERO.    01450030
014600     05  PV-PROJ-RCPT-CNT            PIC S9(12)V99 VALUE ZERO.    01460030
014700     05  PV-VARIANCE-CNT             PIC S9(12)V99 VALUE ZERO.    01470030
014800***                                                               01480030
014900**** DIVISION COUNTS                                              01490030
015000***                                                               01500030
015100     05  PV-RET-SUN-CNT-DMM          PIC S9(12)V99 VALUE ZERO.    01510030
015200     05  PV-RET-MON-CNT-DMM          PIC S9(12)V99 VALUE ZERO.    01520030
015300     05  PV-RET-TUE-CNT-DMM          PIC S9(12)V99 VALUE ZERO.    01530030
015400     05  PV-RET-WED-CNT-DMM          PIC S9(12)V99 VALUE ZERO.    01540030
015500     05  PV-RET-THR-CNT-DMM          PIC S9(12)V99 VALUE ZERO.    01550030
015600     05  PV-RET-FRI-CNT-DMM          PIC S9(12)V99 VALUE ZERO.    01560030
015700     05  PV-RET-SAT-CNT-DMM          PIC S9(12)V99 VALUE ZERO.    01570030
015800     05  PV-WEEK-TOT-CNT-DMM         PIC S9(12)V99 VALUE ZERO.    01580030
015900     05  PV-MTD-RCPT-CNT-DMM         PIC S9(12)V99 VALUE ZERO.    01590030
016000     05  PV-PROJ-RCPT-CNT-DMM        PIC S9(12)V99 VALUE ZERO.    01600030
016100     05  PV-VARIANCE-CNT-DMM         PIC S9(12)V99 VALUE ZERO.    01610030
016200***                                                               01620030
016300**** GMM COUNTS                                                   01630030
016400***                                                               01640030
016500     05  PV-RET-SUN-CNT-GMM          PIC S9(12)V99 VALUE ZERO.    01650030
016600     05  PV-RET-MON-CNT-GMM          PIC S9(12)V99 VALUE ZERO.    01660030
016700     05  PV-RET-TUE-CNT-GMM          PIC S9(12)V99 VALUE ZERO.    01670030
016800     05  PV-RET-WED-CNT-GMM          PIC S9(12)V99 VALUE ZERO.    01680030
016900     05  PV-RET-THR-CNT-GMM          PIC S9(12)V99 VALUE ZERO.    01690030
017000     05  PV-RET-FRI-CNT-GMM          PIC S9(12)V99 VALUE ZERO.    01700030
017100     05  PV-RET-SAT-CNT-GMM          PIC S9(12)V99 VALUE ZERO.    01710030
017200     05  PV-WEEK-TOT-CNT-GMM         PIC S9(12)V99 VALUE ZERO.    01720030
017300     05  PV-MTD-RCPT-CNT-GMM         PIC S9(12)V99 VALUE ZERO.    01730030
017400     05  PV-PROJ-RCPT-CNT-GMM        PIC S9(12)V99 VALUE ZERO.    01740030
017500     05  PV-VARIANCE-CNT-GMM         PIC S9(12)V99 VALUE ZERO.    01750030
017600***                                                               01760030
017700**** DC COUNTS                                                    01770030
017800***                                                               01780030
017900     05  PV-RET-SUN-CNT-DC           PIC S9(12)V99 VALUE ZERO.    01790030
018000     05  PV-RET-MON-CNT-DC           PIC S9(12)V99 VALUE ZERO.    01800030
018100     05  PV-RET-TUE-CNT-DC           PIC S9(12)V99 VALUE ZERO.    01810030
018200     05  PV-RET-WED-CNT-DC           PIC S9(12)V99 VALUE ZERO.    01820030
018300     05  PV-RET-THR-CNT-DC           PIC S9(12)V99 VALUE ZERO.    01830030
018400     05  PV-RET-FRI-CNT-DC           PIC S9(12)V99 VALUE ZERO.    01840030
018500     05  PV-RET-SAT-CNT-DC           PIC S9(12)V99 VALUE ZERO.    01850030
018600     05  PV-WEEK-TOT-CNT-DC          PIC S9(12)V99 VALUE ZERO.    01860030
018700     05  PV-MTD-RCPT-CNT-DC          PIC S9(12)V99 VALUE ZERO.    01870030
018800     05  PV-PROJ-RCPT-CNT-DC         PIC S9(12)V99 VALUE ZERO.    01880030
018900     05  PV-VARIANCE-CNT-DC          PIC S9(12)V99 VALUE ZERO.    01890030
019000*                                                                 01900030
019100 01  PV-FIELD-DISPLAYS.                                           01910030
019200** TOTAL COUNT                                                    01920030
019300     05  PV-MTD-RECEIPTS             PIC S9(12)    VALUE ZERO.    01930030
019400     05  PV-DAILY-RECEIPTS           PIC S9(11)    VALUE ZERO.    01931031
019500     05  PV-WEEKLY-RECEIPTS          PIC S9(12)    VALUE ZERO.    01932031
019600     05  PV-PROJ-RECEIPTS            PIC S9(12)    VALUE ZERO.    01940030
019700     05  PV-VARIANCE                 PIC S9(12)    VALUE ZERO.    01950030
019800*                                                                 01960030
019900** MASKING PATTERNS                                               01970030
020000     05  PV-1-COMMA-12-X             PIC X(12).                   01980030
020100     05  PV-1-COMMA-12-RDF REDEFINES PV-1-COMMA-12-X.             01990030
020200         10  PV-1-COMMA-12           PIC ZZZZZZZ,ZZZ-.            02000030
020300     05  PV-2-COMMA-12-X             PIC X(12).                   02010030
020400     05  PV-2-COMMA-12-RDF REDEFINES PV-2-COMMA-12-X.             02020030
020500         10  PV-2-COMMA-12           PIC ZZZ,ZZZ,ZZZ-.            02030030
020600     05  PV-1-COMMA-11-X             PIC X(11).                   02030131
020700     05  PV-1-COMMA-11-RDF REDEFINES PV-1-COMMA-11-X.             02030231
020800         10  PV-1-COMMA-11           PIC ZZZZZZ,ZZZ-.             02030332
020900     05  PV-2-COMMA-11-X             PIC X(11).                   02030431
021000     05  PV-2-COMMA-11-RDF REDEFINES PV-2-COMMA-11-X.             02030531
021100         10  PV-2-COMMA-11           PIC  ZZ,ZZZ,ZZZ-.            02030631
021200*                                                                 02040030
021300 01  PV-SYSTEM-DATE.                                              02050030
021400     05  PV-SYSTEM-DATE-YY           PIC  9(02)    VALUE ZERO.    02060030
021500     05  PV-SYSTEM-DATE-MM           PIC  9(02)    VALUE ZERO.    02070030
021600     05  PV-SYSTEM-DATE-DD           PIC  9(02)    VALUE ZERO.    02080030
021700*                                                                 02090030
021800*                                                                 02100030
021900 01  PV-SYSTEM-TIME.                                              02110030
022000     05  PV-SYSTEM-TIME-HH           PIC  9(02)    VALUE ZERO.    02120030
022100     05  PV-SYSTEM-TIME-MM           PIC  9(02)    VALUE ZERO.    02130030
022200     05  FILLER                      PIC  9(04)    VALUE ZERO.    02140030
022300*                                                                 02150030
022400*                                                                 02160030
022500 01  HEADING-LINE-2.                                              02170030
022600     05  HL2-DC                      PIC  X(02).                  02180030
022700     05  HL2-DESCRIPTION             PIC  X(148).                 02190030
022800                                                                  02200030
022900 01  HEADING-LINE-2-DC-DESC.                                      02210030
023000     05  FILLER                      PIC  X(45)    VALUE SPACES.  02220030
023100     05  FILLER                      PIC  X(56)    VALUE          02230030
023200     'DAILY AND MONTH TO DATE RECEIPTS VS. BUYERS''S PROJECTION'. 02240030
023300     05  FILLER                      PIC  X(47)    VALUE SPACES.  02250030
023400                                                                  02260030
023500 01  HEADING-LINE-2-MERCH-DESC.                                   02270030
023600     05  FILLER                      PIC  X(23)    VALUE SPACES.  02280030
023700     05  FILLER                      PIC  X(56)    VALUE          02290030
023800     'DAILY AND MONTH TO DATE RECEIPTS VS. BUYERS''S PROJECTION'. 02300030
023900     05  FILLER                      PIC  X(44)    VALUE          02310030
024000     ' - MERCHANTS VERSION WITH DEFERRED RECEIPTS '.              02320030
024100     05  FILLER                      PIC  X(25)    VALUE SPACES.  02330030
024200*                                                                 02340030
024300*                                                                 02350030
024400 01  HEADING-LINE-3.                                              02360030
024500     05  HL3-DC-NAME                 PIC  X(40)    VALUE SPACES.  02370030
024600     05  FILLER                      PIC  X(17)    VALUE SPACES.  02380030
024700     05  HL3-DAY                     PIC  X(09)    VALUE SPACES.  02390030
024800         88  HL3-DAY-SUNDAY                        VALUE          02400030
024900             '   SUNDAY'.                                         02410030
025000         88  HL3-DAY-MONDAY                        VALUE          02420030
025100             '   MONDAY'.                                         02430030
025200         88  HL3-DAY-TUESDAY                       VALUE          02440030
025300             '  TUESDAY'.                                         02450030
025400         88  HL3-DAY-WEDNESDAY                     VALUE          02460030
025500             'WEDNESDAY'.                                         02470030
025600         88  HL3-DAY-THURSDAY                      VALUE          02480030
025700             ' THURSDAY'.                                         02490030
025800         88  HL3-DAY-FRIDAY                        VALUE          02500030
025900             '   FRIDAY'.                                         02510030
026000         88  HL3-DAY-SATURDAY                      VALUE          02520030
026100             ' SATURDAY'.                                         02530030
026200     05  FILLER                      PIC  X(18)    VALUE          02540030
026300         ' OF WEEK ENDING - '.                                    02550030
026400     05  HL3-SALES-DATE1             PIC  99/99/99 VALUE ZERO.    02560030
026500     05  FILLER                      PIC  X(58)    VALUE SPACES.  02570030
026600*                                                                 02580030
026700*                                                                 02590030
026800 01  HEADING-LINE-4.                                              02600030
026900     05  FILLER                      PIC  X(50)    VALUE          02610030
027000         'DEPT  DESCRIPTION     SUNDAY     MONDAY     TUESDA'.    02620030
027100     05  FILLER                      PIC  X(50)    VALUE          02630030
027200         'Y   WEDNESDAY  THURSDAY    FRIDAY    SATURDAY     '.    02640030
027300     05  FILLER                      PIC  X(22)    VALUE          02650030
027400         'WEEKLY       MTD      '.                                02660030
027500     05  FILLER                      PIC  X(28)    VALUE SPACES.  02670030
027600         88  HL4-CO-FIELDS                         VALUE          02680030
027700             'PROJECTED     VARIANCE   PCT'.                      02690030
027800*                                                                 02700030
027900*                                                                 02710030
028000 01  HEADING-LINE-5.                                              02720030
028100     05  FILLER                      PIC  X(100)   VALUE SPACES.  02730030
028200     05  FILLER                      PIC  X(23)    VALUE          02740030
028300         'TOTAL      RECEIPTS    '.                               02750030
028400     05  FILLER                      PIC  X(27)    VALUE SPACES.  02760030
028500         88  HL5-CO-FIELDS                         VALUE          02770030
028600             'RECEIPTS                   '.                       02780030
028700*                                                                 02790030
028800*                                                                 02800030
028900 01  DASH-LINE.                                                   02810030
029000     05  FILLER                      PIC  X(50)    VALUE          02820030
029100         '------------------- ---------- ---------- --------'.    02830030
029200     05  FILLER                      PIC  X(50)    VALUE          02840030
029300         '-- ---------- ---------- ---------- ---------- ---'.    02850030
029400     05  FILLER                      PIC  X(21)    VALUE          02860030
029500         '-------- ----------- '.                                 02870030
029600     05  FILLER                      PIC  X(29)    VALUE SPACES.  02880030
029700         88  DASH-LINE-CO-FIELDS                   VALUE          02890030
029800             '----------- ------------ ----'.                     02900030
029900*                                                                 02910030
030000*                                                                 02920030
030100 01  DETAIL-LINE.                                                 02930030
030200     05  DL-DEPT                     PIC  X(03).                  02940030
030300     05  FILLER                      PIC  X(02)    VALUE SPACES.  02950030
030400     05  DL-DPT-DESC                 PIC  X(14).                  02960030
030500     05  FILLER                      PIC  X(01)    VALUE SPACE.   02970030
030600     05  DL-RET-SUN                  PIC  ZZ,ZZZ,ZZ9-.            02980030
030700*    05  FILLER                      PIC  X(01)    VALUE SPACE.   02990030
030800     05  DL-RET-MON                  PIC  ZZ,ZZZ,ZZ9-.            03000030
030900*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03010030
031000     05  DL-RET-TUE                  PIC  ZZ,ZZZ,ZZ9-.            03020030
031100*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03030030
031200     05  DL-RET-WED                  PIC  ZZ,ZZZ,ZZ9-.            03040030
031300*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03050030
031400     05  DL-RET-THR                  PIC  ZZ,ZZZ,ZZ9-.            03060030
031500*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03070030
031600     05  DL-RET-FRI                  PIC  ZZ,ZZZ,ZZ9-.            03080030
031700*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03090030
031800     05  DL-RET-SAT                  PIC  ZZ,ZZZ,ZZ9-.            03100030
031900*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03110030
032000     05  DL-WEEK-TOT                 PIC  ZZZ,ZZZ,ZZ9-.           03120030
032100*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03130030
032200     05  DL-MTD-RECEIPTS             PIC  ZZZ,ZZZ,ZZ9-.           03140030
032300*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03150030
032400     05  DL-PROJ-RECEIPTS-X          PIC  X(11)    VALUE SPACES.  03160030
032500     05  DL-PROJ-RECEIPTS-X-RDF REDEFINES DL-PROJ-RECEIPTS-X.     03170030
032600         10  DL-PROJ-RECEIPTS        PIC  ZZZ,ZZZ,ZZ9.            03180030
032700     05  FILLER                      PIC  X(01)    VALUE SPACE.   03190030
032800     05  DL-VARIANCE-X               PIC  X(12)    VALUE SPACES.  03200030
032900     05  DL-VARIANCE-X-RDF REDEFINES DL-VARIANCE-X.               03210030
033000         10  DL-VARIANCE             PIC  ZZZ,ZZZ,ZZ9-.           03220030
033100     05  FILLER                      PIC  X(01)    VALUE SPACE.   03230030
033200     05  DL-PCT-X                    PIC  X(03)    VALUE SPACES.  03240030
033300     05  DL-PCT-X-RDF REDEFINES DL-PCT-X.                         03250030
033400         10  DL-PCT                  PIC  ZZ9.                    03260030
033500     05  DL-PCT-SIGN                 PIC  X(01)    VALUE SPACE.   03270030
033600         88  DL-PCT-SIGN-DISPLAY                   VALUE '%'.     03280030
033700*                                                                 03290030
033800*                                                                 03300030
033900 01  TOTAL-LINE.                                                  03310030
034000     05  TL-HEAD                     PIC  X(15).                  03320030
034100     05  FILLER                      PIC  X(05)    VALUE ' TOT '. 03330030
034200     05  TL-RET-SUN                  PIC  X(11).                  03340031
034300*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03350030
034400     05  TL-RET-MON                  PIC  X(11).                  03360031
034500*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03370030
034600     05  TL-RET-TUE                  PIC  X(11).                  03380031
034700*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03390030
034800     05  TL-RET-WED                  PIC  X(11).                  03400031
034900*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03410030
035000     05  TL-RET-THR                  PIC  X(11).                  03420031
035100*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03430030
035200     05  TL-RET-FRI                  PIC  X(11).                  03440031
035300*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03450030
035400     05  TL-RET-SAT                  PIC  X(11).                  03460031
035500*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03470030
035600     05  TL-WEEK-TOT                 PIC  X(12).                  03480031
035700*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03490030
035800*    05  TL-MTD-RECEIPTS             PIC  ZZZ,ZZZ,ZZ9-.           03500030
035900     05  TL-MTD-RECEIPTS-X           PIC  X(12).                  03510030
036000*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03520030
036100     05  TL-PROJ-RECEIPTS-X          PIC  X(12)    VALUE SPACES.  03530030
036200*    05  TL-PROJ-RECEIPTS-X-RDF REDEFINES TL-PROJ-RECEIPTS-X.     03540030
036300*        10  TL-PROJ-RECEIPTS        PIC  ZZZ,ZZZ,ZZ9.            03550030
036400*    05  FILLER                      PIC  X(01)    VALUE SPACE.   03560030
036500     05  TL-VARIANCE-X               PIC  X(12)    VALUE SPACES.  03570030
036600*    05  TL-VARIANCE-X-RDF REDEFINES TL-VARIANCE-X.               03580030
036700*        10  TL-VARIANCE             PIC  ZZZ,ZZZ,ZZ9-.           03590030
036800     05  FILLER                      PIC  X(01)    VALUE SPACE.   03600030
036900     05  TL-PCT-X                    PIC  X(03)    VALUE SPACES.  03610030
037000     05  TL-PCT-X-RDF REDEFINES TL-PCT-X.                         03620030
037100         10  TL-PCT                  PIC  ZZ9.                    03630030
037200     05  TL-PCT-SIGN                 PIC  X(01)    VALUE SPACE.   03640030
037300         88  TL-PCT-SIGN-DISPLAY                   VALUE '%'.     03650030
037400*                                                                 03660030
037500*                                                                 03670030
037600******************************************************************03680030
037700*  TABLE OF TOTAL LINES FOR DIRECT SHIPS, DISTRIBUTION CENTERS    03690030
037800*  AND COMPANY SUMMARY.                                           03700030
037900******************************************************************03710030
038000 01  TOTAL-TABLE                     PIC  X(7500)  VALUE SPACES.  03720030
038100 01  TOTAL-TABLE-RDF REDEFINES TOTAL-TABLE.                       03730030
038200     05  TOTAL-TABLE-OCC OCCURS 50 TIMES                          03740030
038300                         INDEXED BY TT-INDX.                      03750030
038400         10  TT-OCC                  PIC  X(150).                 03760030
038500             88  TT-OCC-BLANK                      VALUE SPACES.  03770030
038600*                                                                 03770130
038700 01  PR-PRINT-FINAL.                                              03770200
038800     05  FILLER                      PIC X(53)  VALUE SPACES.     03770300
038900     05  FILLER                      PIC X(21)  VALUE             03770400
039000         '*** END OF REPORT ***'.                                 03770500
039100                                                                  04460004
039200*                                                                 04470030
039300******************************************************************04480030
039400*  KEYREC RECORD LAYOUT USED BY BOTH INP01 AND INP03.             04490030
039500******************************************************************04500030
039600     COPY MPRD009I.                                               04510030
039700*                                                                 04520030
039800*                                                                 04530030
039900******************************************************************04540030
040000*  WORK FIELDS FOR THE MBS SUBROUTINE                             04550030
040100******************************************************************04560030
040200     COPY DPWS003.                                                04570030
040300*    ABEND ROUTINE                                                        
040400     COPY DPWS013.                                                04570030
040500/                                                                 04580030
040600*  LOGISTICS DOMAIN LOCATION MODULE                               04581033
040700*                                                                 04582033
040800     COPY XLWS071.                                                04583033
040900/                                                                 04590030
041000******************************************************************04600030
041100*  USED FOR DB2 ERROR MESSAGE BUILDING                            04610030
041200******************************************************************04620030
041300     COPY DPWS004.                                                04630030
041400*                                                                 04640030
041500*                                                                 04650030
041600******************************************************************04660030
041700*  STANDARD 150 KOHLS DEPARTMENT HEADER                         * 04670030
041800******************************************************************04680030
041900     COPY DPWS150O.                                               04690030
042000*                                                                 04700030
042100*                                                                 04710030
042200******************************************************************04720030
042300*  WORK FIELDS FOR THE DATE CONVERSION SUBROUTINE                 04730030
042400******************************************************************04740030
042500     COPY DPWS500.                                                04750030
042600*                                                                 04760030
042700*                                                                 04770030
042800******************************************************************04780030
042900*  DB2 COMMUNICATION AREA.                                        04790030
043000******************************************************************04800030
043100     EXEC SQL                                                     04810030
043200          INCLUDE SQLCA                                           04820030
043300     END-EXEC.                                                    04830030
043400*                                                                 04840030
043500/                                                                 04890030
043600*                                                                 04900030
043700******************************************************************04910030
043800 PROCEDURE DIVISION.                                              04920030
043900******************************************************************04930030
044000*                                                                 04940030
044100 0000-MAINLINE.                                                   04950030
044200******************************************************************04960030
044300*  THIS PARAGRAPH DRIVES THE WHOLE PROGRAM.  THERE ARE TWO MAIN   04970030
044400*  LOOPS IN THIS PROGRAM.  THE FIRST LOOP IS FOR THE 'DC' PORTION 04980030
044500*  PORTION OF THE REPORT (DIRECT SHIP, MENO FALLS, FINDLAY. . .). 04990030
044600*  THE SECOND LOOP IS USED TO PROCESS THE 'COMPANY TOTAL' PORTION 05000030
044700*  OF THE REPORT WHICH IS BUILT FROM A DIFFERENT INPUT FILE.      05010030
044800******************************************************************05020030
044900     PERFORM 1000-INITIALIZE-DC-AND-COMMON.                       05030030
045000     PERFORM 2000-PROCESS-DC-LOOP                                 05040030
045100       UNTIL PS-DC-EOF.                                           05050030
045200     PERFORM 4200-CREATE-DEPT-LINE.                               05060030
045300     PERFORM 4300-CREATE-DMM-LINE.                                05070030
045400     PERFORM 4400-CREATE-GMM-LINE.                                05080030
045500     PERFORM 4500-CREATE-BRK-LINE.                                05090030
045600                                                                  05100030
045700     CLOSE DAILY-KEYREC-DC-FILE.                                  05110030
045800                                                                  05120030
045900     PERFORM 1010-INITIALIZE-CO.                                  05130030
046000     PERFORM 3000-PROCESS-CO-LOOP                                 05140030
046100       UNTIL PS-CO-EOF.                                           05150030
046200     PERFORM 4200-CREATE-DEPT-LINE.                               05160030
046300     PERFORM 4300-CREATE-DMM-LINE.                                05170030
046400     PERFORM 4400-CREATE-GMM-LINE.                                05180030
046500     PERFORM 4500-CREATE-BRK-LINE.                                05190030
046600*                                                                 05200030
046700     PERFORM 7300-HEAD-RTN.                                       05210030
046800*                                                                 05220030
046900     PERFORM                                                      05230030
047000       VARYING TT-INDX FROM 1 BY 1                                05240030
047100         UNTIL TT-INDX > 50                                       05250030
047200            OR TT-OCC-BLANK (TT-INDX)                             05260030
047300                                                                  05270030
047400         MOVE TT-OCC (TT-INDX)       TO DAILY-VERIFY-LINE         05280030
047500         PERFORM 7200-WRITE-REPORT                                05290030
047600         MOVE 2                      TO PV-CARR-RETRN             05300030
047700     END-PERFORM.                                                 05310030
047800     PERFORM 7400-PRINT-FINAL.                                    05320030
047900                                                                  05330030
048000     CLOSE DAILY-KEYREC-CO-FILE                                   05340030
048100           DAILY-VERIFY-REPORT.                                   05350030
048200*                                                                 05360030
048300     STOP RUN.                                                    05370030
048400*                                                                 05380030
048500*                                                                 05390030
048600 1000-INITIALIZE-DC-AND-COMMON.                                   05400030
048700******************************************************************05410030
048800*   -- ACCEPT DATE AND TIME FROM SYSTEM.                          05420030
048900*   -- SET UP STANDARD REPORT HEADING.                            05430030
049000*   -- OPEN INP01, INP02, RPT01.                                  05440030
049100*   -- DO THE INITIAL READ OF INP01.                              05450030
049200******************************************************************05460030
049300     ACCEPT PV-SYSTEM-DATE FROM DATE.                             05470030
049400     ACCEPT PV-SYSTEM-TIME FROM TIME.                             05470130
049500     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05470200
049600                                                                  05470330
049700     IF NOT CC-VALID-REPORT-CODE                                  05470430
049800         DISPLAY '*** ABEND IN MPKRP010 ***'                      05470530
049900         DISPLAY 'PARAGRAPH 1000-INITIALIZE-DC-AND-COMMON'        05470630
050000         DISPLAY 'INVALID REPORT CODE: ' CC-REPORT-CODE           05470730
050100         MOVE +4003                  TO PV-ABEND-CODE             05470830
050200         CALL 'ILBOABN0' USING PV-ABEND-CODE                      05470930
050300     END-IF.                                                      05471030
050400*                                                                 05472030
050500     EXEC SQL                                                     05473030
050600          SET :PV-DB2-DATE = CURRENT DATE                         05474030
050700     END-EXEC.                                                    05475030
050800*                                                                 05476030
050900     MOVE PV-SYSTEM-DATE-YY          TO DP150O-RUN-YEAR.          05477030
051000     MOVE PV-SYSTEM-DATE-MM          TO DP150O-RUN-MONTH.         05478030
051100     MOVE PV-SYSTEM-DATE-DD          TO DP150O-RUN-DAY.           05479030
051200     MOVE PV-SYSTEM-TIME-HH          TO DP150O-RUN-HOUR.          05480030
051300     MOVE PV-SYSTEM-TIME-MM          TO DP150O-RUN-MINUTE.        05490030
051400     MOVE 'MPKRP010'                 TO DP150O-PROGRAM-NAME.      05500030
051500     IF CC-DC-REPORT                                              05510030
051600         MOVE 1                      TO DP150O-REPORT-NUMBER      05520030
051700         MOVE HEADING-LINE-2-DC-DESC TO HL2-DESCRIPTION           05530030
051800     ELSE                                                         05540030
051900         MOVE 2                      TO DP150O-REPORT-NUMBER      05550030
052000         MOVE HEADING-LINE-2-MERCH-DESC                           05560030
052100                                     TO HL2-DESCRIPTION           05570030
052200     END-IF.                                                      05580030
052300*                                                                 05590030
052400     SET TT-INDX                     TO 1.                        05600030
052500*                                                                 05610030
052600     MOVE ZERO                       TO PV-PAGE-CNT.              05620030
052700     MOVE 63                         TO PV-LINE-CNT.              05630030
052800*                                                                 05640030
052900     OPEN INPUT  DAILY-KEYREC-DC-FILE                             05650030
053000                 RUN-DATE-FILE                                    05660030
053100          OUTPUT DAILY-VERIFY-REPORT.                             05670030
053200                                                                  05680030
053300     PERFORM 7000-READ-DC-FILE.                                   05690030
053400                                                                  05700030
053500     MOVE MP009I-DIVISION            TO PV-SAV-DMM.               05710030
053600     MOVE MP009I-GMM                 TO PV-SAV-GMM.               05720030
053700     MOVE MP009I-DEPT                TO PV-SAV-DEPT.              05730030
053800     MOVE MP009I-RECEIVING-LOCATION  TO PV-SAV-DC.                05740030
053900     MOVE MP009I-OPER-UNT-ID         TO PV-SAV-ID.                05750030
054000     MOVE MP009I-WEEK-ENDING-DATE    TO PV-SAV-DATE.              05760030
054100     MOVE PV-SAV-DATE                TO HL3-SALES-DATE1.          05770030
054200                                                                  05780030
054300     PERFORM 2010-SET-HEADING-FOR-DC.                             05790030
054400                                                                  05800030
054500     READ RUN-DATE-FILE.                                          05810030
054600     SET DPG51-ACTUAL-CALENDAR-ONLY                               05820030
054700         DPG52-LK-DTE-GREG           TO TRUE.                     05830030
054800                                                                  05840030
054900     MOVE PV-SYSTEM-DATE             TO DPG51-SYSTEM-DATE.        05850030
055000     MOVE RD-RUN-DATE                TO DPG52-LK-DATE-INPUT.      05860030
055100                                                                  05870030
055200     CALL PC-PGM-DPKUT500 USING DPG51                             05880030
055300                                DPG52                             05890030
055400                                DPG53                             05900030
055500                                DPG54                             05910030
055600                                DPG55                             05920030
055700                                DPG56.                            05930030
055800                                                                  05940030
055900     IF  DPG54-SEVERE-ERROR                                       05950030
056000      OR DPG54-DATE-INVALID                                       05960030
056100         DISPLAY '*** ABEND IN MPKRP010 ***'                      05970030
056200         DISPLAY 'PARAGRAPH 1000-INITIALIZE-DC-AND-COMMON'        05980030
056300         DISPLAY 'DATE ROUTINE ERROR:  ' DPG54-ERROR-MESSAGE      05990030
056400         MOVE +4019                  TO PV-ABEND-CODE             06000030
056500         CALL 'ILBOABN0' USING PV-ABEND-CODE                      06010030
056600     END-IF.                                                      06020030
056700                                                                  06030030
056800     EVALUATE TRUE                                                06040030
056900         WHEN DPG55-NUMERIC-WEEK-DAY-SUN                          06050030
057000              SET HL3-DAY-SUNDAY     TO TRUE                      06060030
057100         WHEN DPG55-NUMERIC-WEEK-DAY-MON                          06070030
057200              SET HL3-DAY-MONDAY     TO TRUE                      06080030
057300         WHEN DPG55-NUMERIC-WEEK-DAY-TUE                          06090030
057400              SET HL3-DAY-TUESDAY    TO TRUE                      06100030
057500         WHEN DPG55-NUMERIC-WEEK-DAY-WED                          06110030
057600              SET HL3-DAY-WEDNESDAY  TO TRUE                      06120030
057700         WHEN DPG55-NUMERIC-WEEK-DAY-THU                          06130030
057800              SET HL3-DAY-THURSDAY   TO TRUE                      06140030
057900         WHEN DPG55-NUMERIC-WEEK-DAY-FRI                          06150030
058000              SET HL3-DAY-FRIDAY     TO TRUE                      06160030
058100         WHEN DPG55-NUMERIC-WEEK-DAY-SAT                          06170030
058200              SET HL3-DAY-SATURDAY   TO TRUE                      06180030
058300     END-EVALUATE.                                                06190030
058400*                                                                 06200030
058500     CLOSE RUN-DATE-FILE.                                         06210030
058600*                                                                 06220030
058700*                                                                 06230030
058800 1010-INITIALIZE-CO.                                              06240030
058900******************************************************************06250030
059000*   -- OPEN INP03.                                                06260030
059100*   -- DO THE INITIAL READ OF INP03.                              06270030
059200******************************************************************06280030
059300     OPEN INPUT DAILY-KEYREC-CO-FILE.                             06290030
059400*                                                                 06300030
059500     PERFORM 7100-READ-CO-FILE.                                   06310030
059600*                                                                 06320030
059700     SET HL4-CO-FIELDS                                            06330030
059800         HL5-CO-FIELDS                                            06340030
059900         DASH-LINE-CO-FIELDS         TO TRUE.                     06350030
060000*                                                                 06360030
060100     MOVE 63                         TO PV-LINE-CNT.              06370030
060200     MOVE MP009I-DIVISION            TO PV-SAV-DMM.               06380030
060300     MOVE MP009I-GMM                 TO PV-SAV-GMM.               06390030
060400     MOVE MP009I-DEPT                TO PV-SAV-DEPT.              06400030
060500     MOVE MP009I-WEEK-ENDING-DATE    TO PV-SAV-DATE.              06410030
060600     MOVE 'CO'                       TO HL2-DC.                   06420030
060700     MOVE 'COMPANY TOTAL'            TO HL3-DC-NAME.              06430030
060800*                                                                 06440030
060900*                                                                 06450030
061000 2000-PROCESS-DC-LOOP.                                            06460030
061100******************************************************************06470030
061200*  PROCESS THE KEYREC DATA FOR THE 'DC' PORTION OF THE REPORT.    06480030
061300*  A PAGE BREAK WILL OCCUR AFTER DIRECT SHIPMENTS AND ON CHANGE   06490030
061400*  IN DC.  PRODUCE TOTAL LINES ON CHANGE IN DIVISION AND GMM.     06500030
061500******************************************************************06510030
061600     IF  PV-SAV-DC NOT = MP009I-RECEIVING-LOCATION OR             06520030
061700       PV-SAV-ID NOT = MP009I-OPER-UNT-ID                         06530030
061800         MOVE MP009I-RECEIVING-LOCATION                           06540030
061900                                     TO PV-SAV-DC                 06550030
062000         MOVE MP009I-OPER-UNT-ID                                  06560030
062100                                     TO PV-SAV-ID                 06570030
062200         PERFORM 4200-CREATE-DEPT-LINE                            06580030
062300         PERFORM 4300-CREATE-DMM-LINE                             06590030
062400         PERFORM 4400-CREATE-GMM-LINE                             06600030
062500         PERFORM 4500-CREATE-BRK-LINE                             06610030
062600         PERFORM 2010-SET-HEADING-FOR-DC                          06620030
062700         PERFORM 7300-HEAD-RTN                                    06630030
062800         MOVE 1                      TO PV-CARR-RETRN             06640030
062900         MOVE MP009I-DIVISION        TO PV-SAV-DMM                06650030
063000         MOVE MP009I-GMM             TO PV-SAV-GMM                06660030
063100         MOVE MP009I-DEPT            TO PV-SAV-DEPT               06670030
063200         MOVE MP009I-RECEIVING-LOCATION                           06680030
063300                                     TO PV-SAV-DC                 06690030
063400         MOVE MP009I-OPER-UNT-ID                                  06700030
063500                                     TO PV-SAV-ID                 06710030
063600     END-IF.                                                      06720030
063700*                                                                 06730030
063800     PERFORM 4000-COMMON-EDIT-FOR-BREAK.                          06740030
063900*                                                                 06750030
064000     PERFORM 7000-READ-DC-FILE.                                   06760030
064100*                                                                 06770030
064200*                                                                 06780030
064300 2010-SET-HEADING-FOR-DC.                                         06790030
064400******************************************************************06800030
064500*  MOVE DC NAME TO HEADING LINE                                   06810030
064600******************************************************************06820030
064700     MOVE MP009I-RECEIVING-LOCATION  TO HL2-DC.                   06830030
064800*                                                                 06840030
064900     EVALUATE TRUE                                                06850030
065000         WHEN MP009I-RECEIVING-LOCATION = 'DS'                    06860030
065100              MOVE 'DIRECT SHIP'     TO HL3-DC-NAME               06870030
065200         WHEN OTHER                                               06880030
065300          PERFORM 3010-GET-OPER-UNIT                              06900030
065400          MOVE XL071-LOC-NM          TO HL3-DC-NAME               06910030
065500     END-EVALUATE.                                                06920030
065600*                                                                 06930030
065700*                                                                 06940030
065800 3000-PROCESS-CO-LOOP.                                            06950030
065900******************************************************************06960030
066000*  PROCESS THE KEYREC DATA FOR THE COMPANY PORTION OF THE REPORT. 06970030
066100*  PRODUCE TOTAL LINES ON CHANGE IN DIVISION AND GMM.             06980030
066200******************************************************************06990030
066300     PERFORM 4000-COMMON-EDIT-FOR-BREAK.                          07000030
066400*                                                                 07010030
066500     PERFORM 7100-READ-CO-FILE.                                   07020030
066600*                                                                 07030030
066700/                                                                 07030130
066800 3010-GET-OPER-UNIT.                                              07030204
066900******************************************************************07030330
067000*  GET THE DC DESCRIPTION.                                        07030430
067100******************************************************************07030530
067200                                                                  07030633
067300     INITIALIZE XL071-COMMAREA-REC.                               07030733
067400     MOVE PV-SAV-ID             TO XL071-LOCATION-NUMBER          06890030
067500                                                                  07030933
067600     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.                 
067700                                                                  07031533
067800     EVALUATE TRUE                                                        
067900     WHEN XL071-NO-ERRORS                                                 
068000     WHEN XL071-LOC-NOT-FOUND                                     07031933
068100     WHEN XL071-DC-ASGMT-NOT-FND                                  07031933
068200         CONTINUE                                                 07035004
068300     WHEN XL071-BAD-DB2-RETURN                                            
068400         MOVE '3010-GET-OPER-UNIT'    TO PV-ABEND-PARAGRAPH       07032433
068500         MOVE 'CALL LOCATION MOD '    TO PV-ERR-MSG-1             07032633
068600         MOVE 'XLT00010'              TO PV-ERR-MSG-2             07032933
068700         MOVE XL071-SQLCA             TO SQLCA                    07032733
068800         MOVE SQLCODE                 TO PV-SQLCODE               07032833
068900         PERFORM 9900-SQL-ABEND                                   11320030
069000     END-EVALUATE.                                                07033533
069100/                                                                 07036130
069200*                                                                 07036230
069300 4000-COMMON-EDIT-FOR-BREAK.                                      07036330
069400******************************************************************07036430
069500*  THIS IS THE BULK OF THE PROGRAM, BEING USED FOR THE 'DC' PART  07037030
069600*  OF THE REPORT AND THE COMPANY TOTAL PORTION, TOO.  TOTAL LINES 07038030
069700*    -- PRINT GMM TOTALS ON BREAK IN GMM.                         07039030
069800*    -- PRINT DMM TOTALS ON BREAK IN DIVISION.                    07040030
069900*    -- PRINT DEPARTMENT TOTALS ON BREAK IN DEPARTMENT.           07050030
070000*    -- ACCUMULATE THE AMOUNTS  ON BREAK IN DEPARTMENT.           07060030
070100******************************************************************07070030
070200     IF  PV-SAV-GMM NOT = MP009I-GMM                              07080030
070300         PERFORM 4200-CREATE-DEPT-LINE                            07090030
070400         PERFORM 4300-CREATE-DMM-LINE                             07100030
070500         PERFORM 4400-CREATE-GMM-LINE                             07110030
070600         MOVE 3                      TO PV-CARR-RETRN             07120030
070700         MOVE MP009I-DIVISION        TO PV-SAV-DMM                07130030
070800         MOVE MP009I-GMM             TO PV-SAV-GMM                07140030
070900         MOVE MP009I-DEPT            TO PV-SAV-DEPT               07150030
071000     END-IF.                                                      07160030
071100                                                                  07170030
071200     IF  PV-SAV-DMM NOT = MP009I-DIVISION                         07180030
071300         PERFORM 4200-CREATE-DEPT-LINE                            07190030
071400         PERFORM 4300-CREATE-DMM-LINE                             07200030
071500         MOVE 3                      TO PV-CARR-RETRN             07210030
071600         MOVE MP009I-DIVISION        TO PV-SAV-DMM                07220030
071700         MOVE MP009I-DEPT            TO PV-SAV-DEPT               07230030
071800     END-IF.                                                      07240030
071900                                                                  07250030
072000     IF  PV-SAV-DEPT NOT = MP009I-DEPT                            07260030
072100         PERFORM 4200-CREATE-DEPT-LINE                            07270030
072200         MOVE MP009I-DEPT            TO PV-SAV-DEPT               07280030
072300     END-IF.                                                      07290030
072400                                                                  07300030
072500     PERFORM 4100-ACCUM-DEPT-AMT.                                 07310030
072600*                                                                 07320030
072700*                                                                 07330030
072800 4100-ACCUM-DEPT-AMT.                                             07340030
072900******************************************************************07350030
073000*  ACCUMULATE DOLLAR AMOUNTS                                      07360030
073100******************************************************************07370030
073200     ADD MP009I-DAY-RECEIPTS (1)     TO PV-RET-SUN-CNT            07380030
073300                                        PV-RET-SUN-CNT-DMM        07390030
073400                                        PV-RET-SUN-CNT-GMM        07400030
073500                                        PV-RET-SUN-CNT-DC.        07410030
073600                                                                  07420030
073700     ADD MP009I-DAY-RECEIPTS (2)     TO PV-RET-MON-CNT            07430030
073800                                        PV-RET-MON-CNT-DMM        07440030
073900                                        PV-RET-MON-CNT-GMM        07450030
074000                                        PV-RET-MON-CNT-DC.        07460030
074100                                                                  07470030
074200     ADD MP009I-DAY-RECEIPTS (3)     TO PV-RET-TUE-CNT            07480030
074300                                        PV-RET-TUE-CNT-DMM        07490030
074400                                        PV-RET-TUE-CNT-GMM        07500030
074500                                        PV-RET-TUE-CNT-DC.        07510030
074600                                                                  07520030
074700     ADD MP009I-DAY-RECEIPTS (4)     TO PV-RET-WED-CNT            07530030
074800                                        PV-RET-WED-CNT-DMM        07540030
074900                                        PV-RET-WED-CNT-GMM        07550030
075000                                        PV-RET-WED-CNT-DC.        07560030
075100                                                                  07570030
075200     ADD MP009I-DAY-RECEIPTS (5)     TO PV-RET-THR-CNT            07580030
075300                                        PV-RET-THR-CNT-DMM        07590030
075400                                        PV-RET-THR-CNT-GMM        07600030
075500                                        PV-RET-THR-CNT-DC.        07610030
075600                                                                  07620030
075700     ADD MP009I-DAY-RECEIPTS (6)     TO PV-RET-FRI-CNT            07630030
075800                                        PV-RET-FRI-CNT-DMM        07640030
075900                                        PV-RET-FRI-CNT-GMM        07650030
076000                                        PV-RET-FRI-CNT-DC.        07660030
076100                                                                  07670030
076200     ADD MP009I-DAY-RECEIPTS (7)     TO PV-RET-SAT-CNT            07680030
076300                                        PV-RET-SAT-CNT-DMM        07690030
076400                                        PV-RET-SAT-CNT-GMM        07700030
076500                                        PV-RET-SAT-CNT-DC.        07710030
076600                                                                  07720030
076700     ADD MP009I-MTD-RECEIPTS         TO PV-MTD-RCPT-CNT           07730030
076800                                        PV-MTD-RCPT-CNT-DMM       07740030
076900                                        PV-MTD-RCPT-CNT-GMM       07750030
077000                                        PV-MTD-RCPT-CNT-DC.       07760030
077100                                                                  07770030
077200     ADD MP009I-PLAN-RECEIPTS        TO PV-PROJ-RCPT-CNT          07780030
077300                                        PV-PROJ-RCPT-CNT-DMM      07790030
077400                                        PV-PROJ-RCPT-CNT-GMM      07800030
077500                                        PV-PROJ-RCPT-CNT-DC.      07810030
077600                                                                  07820030
077700     MOVE MP009I-DEPT                TO DL-DEPT.                  07830030
077800     MOVE MP009I-DEPT-DESC           TO DL-DPT-DESC.              07840030
077900*                                                                 07850030
078000*                                                                 07860030
078100 4200-CREATE-DEPT-LINE.                                           07870030
078200******************************************************************07880030
078300*  MOVE ALL DEPARTMENT TOTALS AND WRITE DETAIL LINE.              07890030
078400*                                                                 07900030
078500* ***********************************                             07910030
078600* ***  IMPORTANT NOTE -- 6/27/94  ***                             07920030
078700* ***********************************                             07930030
078800* THE FOLLOWING EXPLAINS THE LOGIC BEHIND THE USE OF THE PLANNED  07940030
078900* RECEIPTS FIELD.  BECAUSE OF THE FOLLOWING LOGIC, NO PROGRAM     07950030
079000* CHANGES WERE NECESSARY IN MPKUT007, BUT THIS DESCRIPTION SHOULD 07960030
079100* HELP ANYONE WHO MAINTAINS EITHER MPKUT007 OR THIS PROGRAM.      07970030
079200*                                                                 07980030
079300* THE FILE MAINTAINED BY MIO HAS A 'RECEIPT LOCATION' FIELD IN IT.07990030
079400* THE LOCATION IS D1 (WHICH IS USED TO INDICATE MENOMONEE FALLS). 08000030
079500* PRESENTLY THE PROJECTED RECEIPTS ARE NOT SPLIT OUT BY RECEIVING 08010030
079600* LOCATION, SO THE D1 ON THE MIO FILE REALLY REPRESENTS THE       08020030
079700* PROJECTED RECEIPTS FOR THE ENTIRE COMPANY.  PROGRAM MPKUT007    08030030
079800* COMBINES THE DAILY RECEIPTS WITH THE PROJECTED RECEIPTS.  IT    08040030
079900* WORKS BY RECEIVING LOCATION.  THE OUTPUT FILE FROM MPKUT007 IS  08050030
080000* THEN SORTED IN DPT/LOC SEQUENCE, SUMMARIZING THE RECEIPTS VALUES08060030
080100* SO ONLY ONE RECORD WILL EXIST FOR EACH DEPARTMENT AND LOCATION. 08070030
080200* THAT FILE WOULD LOOK SOMETHING LIKE THIS:                       08080030
080300*                                                                 08090030
080400*                         PROJECTED                               08100030
080500*     DEPT    LOCATION     RECEIPTS    FOR THIS EXAMPLE, ASSUME   08110030
080600*     ----    --------    ---------    THE DEPARTMENTS ARE IN THE 08120030
080700*      011       DS            0       SAME GMM AND DMM.          08130030
080800*      011       D1          222                                  08140030
080900*      011       D2            0                                  08150030
081000*      015       DS            0                                  08160030
081100*      015       D1          333                                  08170030
081200*      015       D2            0                                  08180030
081300*      064       D1          111  ---  NO DIRECT SHIPS FOR DEPT   08190030
081400*      064       D2            0       064, SO NO 'DS' RECORD.    08200030
081500* THIS FILE IS THEN SORTED IN TWO DIFFERENT STEPS TO BUILD TWO    08210030
081600* INPUT FILES TO PROGRAM MPKRP010.  FOR THIS EXAMPLE, ASSUME THE  08220030
081700* DEPARTMENTS ARE IN THE SAME GMM AND DMM.  THE FILES ARE:        08230030
081800*     INP01  --  SORT LOC/GMM/DMM/DEPT                            08240030
081900*                THIS FILE IS USED TO BUILD THE REPORT FOR EACH   08250030
082000*                RECEIVING LOCATION:                              08260030
082100*                    DS -- DIRECT SHIP                            08270030
082200*                    D1 -- MENOMONEE FALLS                        08280030
082300*                    D2 -- FINDLAY                                08290030
082400*                PROJECTED RECEIPTS AREN'T REPORTED BY LOCATION,  08300030
082500*                SO THE FIELD IS IGNORED.                         08310030
082600*     INP03  --  SORT GMM/DMM/DEPT AND SUMMARIZE ALL AMOUNTS      08320030
082700*                THIS FILE IS USED TO REPORT THE COMPANY TOTAL,   08330030
082800*                SO LOCATION IS IGNORED.                          08340030
082900*                                                                 08350030
083000*               INP01             |             INP03             08360030
083100*     *************************   |   *************************   08370030
083200*                  MTD    PROJ    |                MTD    PROJ    08380030
083300*     DPT   LOC   RCPTS   RCPTS   |   DPT   LOC   RCPTS   RCPTS   08390030
083400*     ---   ---   -----   -----   |   ---   ---   -----   -----   08400030
083500*     011    DS     10       0    |   011    DS     180    222    08410030
083600*     015    DS     50       0    |   015    DS     250    333    08420030
083700*     011    D1    150     222    |   064    D1      60    111    08430030
083800*     015    D1    100     333    |                               08440030
083900*     064    D1     50     111    |                               08450030
084000*     011    D2     20       0    |                               08460030
084100*     015    D2    100       0    |                               08470030
084200*     064    D2     10       0    |                               08480030
084300******************************************************************08490030
084400     IF  PV-LINE-CNT > 55                                         08500030
084500         PERFORM 7300-HEAD-RTN                                    08510030
084600     END-IF.                                                      08520030
084700                                                                  08530030
084800     COMPUTE DL-RET-SUN ROUNDED       = PV-RET-SUN-CNT.           08540030
084900     COMPUTE DL-RET-MON ROUNDED       = PV-RET-MON-CNT.           08550030
085000     COMPUTE DL-RET-TUE ROUNDED       = PV-RET-TUE-CNT.           08560030
085100     COMPUTE DL-RET-WED ROUNDED       = PV-RET-WED-CNT.           08570030
085200     COMPUTE DL-RET-THR ROUNDED       = PV-RET-THR-CNT.           08580030
085300     COMPUTE DL-RET-FRI ROUNDED       = PV-RET-FRI-CNT.           08590030
085400     COMPUTE DL-RET-SAT ROUNDED       = PV-RET-SAT-CNT.           08600030
085500     COMPUTE PV-WEEK-TOT-CNT          = PV-RET-SUN-CNT            08610030
085600                                      + PV-RET-MON-CNT            08620030
085700                                      + PV-RET-TUE-CNT            08630030
085800                                      + PV-RET-WED-CNT            08640030
085900                                      + PV-RET-THR-CNT            08650030
086000                                      + PV-RET-FRI-CNT            08660030
086100                                      + PV-RET-SAT-CNT.           08670030
086200     COMPUTE DL-WEEK-TOT      ROUNDED = PV-WEEK-TOT-CNT.          08680030
086300     COMPUTE DL-MTD-RECEIPTS  ROUNDED = PV-MTD-RCPT-CNT.          08690030
086400*                                                                 08700030
086500     IF  HL4-CO-FIELDS                                            08710030
086600         COMPUTE DL-PROJ-RECEIPTS ROUNDED = PV-PROJ-RCPT-CNT      08720030
086700         COMPUTE PV-VARIANCE-CNT          = PV-PROJ-RCPT-CNT      08730030
086800                                          - PV-MTD-RCPT-CNT       08740030
086900         COMPUTE DL-VARIANCE      ROUNDED = PV-VARIANCE-CNT       08750030
087000         IF  PV-PROJ-RCPT-CNT = ZERO                              08760030
087100             MOVE SPACES             TO DL-PCT-X                  08770030
087200                                        DL-PCT-SIGN               08780030
087300         ELSE                                                     08790030
087400             COMPUTE DL-PCT ROUNDED =                             08800030
087500               (PV-MTD-RCPT-CNT / PV-PROJ-RCPT-CNT) * 100         08810030
087600             SET DL-PCT-SIGN-DISPLAY TO TRUE                      08820030
087700         END-IF                                                   08830030
087800     END-IF.                                                      08840030
087900*                                                                 08850030
088000     MOVE DETAIL-LINE                TO DAILY-VERIFY-LINE.        08860030
088100     PERFORM 7200-WRITE-REPORT.                                   08870030
088200     MOVE 1                          TO PV-CARR-RETRN.            08880030
088300*                                                                 08890030
088400     MOVE ZERO                       TO PV-RET-SUN-CNT            08900030
088500                                        PV-RET-MON-CNT            08910030
088600                                        PV-RET-TUE-CNT            08920030
088700                                        PV-RET-WED-CNT            08930030
088800                                        PV-RET-THR-CNT            08940030
088900                                        PV-RET-FRI-CNT            08950030
089000                                        PV-RET-SAT-CNT            08960030
089100                                        PV-WEEK-TOT-CNT           08970030
089200                                        PV-MTD-RCPT-CNT           08980030
089300                                        PV-PROJ-RCPT-CNT          08990030
089400                                        PV-VARIANCE-CNT.          09000030
089500*                                                                 09010030
089600*                                                                 09020030
089700 4300-CREATE-DMM-LINE.                                            09030030
089800******************************************************************09040030
089900*  MOVE ALL DIVISION TOTALS AND WRITE DETAIL LINE.                09050030
090000******************************************************************09060030
090100     MOVE DASH-LINE                  TO DAILY-VERIFY-LINE.        09070030
090200     PERFORM 7200-WRITE-REPORT.                                   09080030
090300*                                                                 09090030
090400     PERFORM 8000-GET-DMM-NAME.                                   09100030
090500*                                                                 09110030
090600*    COMPUTE TL-RET-SUN ROUNDED       = PV-RET-SUN-CNT-DMM.       09120031
090700     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-SUN-CNT-DMM.      09121031
090800     IF PV-DAILY-RECEIPTS > 99999999                              09122031
090900         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09123031
091000         MOVE PV-1-COMMA-11-X TO TL-RET-SUN                       09124031
091100     ELSE                                                         09126031
091200         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09126131
091300         MOVE PV-2-COMMA-11-X TO TL-RET-SUN                       09126231
091400     END-IF.                                                      09129031
091500*    COMPUTE TL-RET-MON ROUNDED       = PV-RET-MON-CNT-DMM.       09130031
091600     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-MON-CNT-DMM.      09131031
091700     IF PV-DAILY-RECEIPTS > 99999999                              09132031
091800         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09133031
091900         MOVE PV-1-COMMA-11-X TO TL-RET-MON                       09134031
092000     ELSE                                                         09135031
092100         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09136031
092200         MOVE PV-2-COMMA-11-X TO TL-RET-MON                       09137031
092300     END-IF.                                                      09138031
092400*    COMPUTE TL-RET-TUE ROUNDED       = PV-RET-TUE-CNT-DMM.       09140031
092500     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-TUE-CNT-DMM.      09141031
092600     IF PV-DAILY-RECEIPTS > 99999999                              09142031
092700         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09143031
092800         MOVE PV-1-COMMA-11-X TO TL-RET-TUE                       09144031
092900     ELSE                                                         09145031
093000         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09146031
093100         MOVE PV-2-COMMA-11-X TO TL-RET-TUE                       09147031
093200     END-IF.                                                      09148031
093300*    COMPUTE TL-RET-WED ROUNDED       = PV-RET-WED-CNT-DMM.       09150031
093400     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-WED-CNT-DMM.      09151031
093500     IF PV-DAILY-RECEIPTS > 99999999                              09152031
093600         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09153031
093700         MOVE PV-1-COMMA-11-X TO TL-RET-WED                       09154031
093800     ELSE                                                         09155031
093900         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09156031
094000         MOVE PV-2-COMMA-11-X TO TL-RET-WED                       09157031
094100     END-IF.                                                      09158031
094200*    COMPUTE TL-RET-THR ROUNDED       = PV-RET-THR-CNT-DMM.       09160031
094300     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-THR-CNT-DMM.      09161031
094400     IF PV-DAILY-RECEIPTS > 99999999                              09162031
094500         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09163031
094600         MOVE PV-1-COMMA-11-X TO TL-RET-THR                       09164031
094700     ELSE                                                         09165031
094800         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09166031
094900         MOVE PV-2-COMMA-11-X TO TL-RET-THR                       09167031
095000     END-IF.                                                      09168031
095100*    COMPUTE TL-RET-FRI ROUNDED       = PV-RET-FRI-CNT-DMM.       09170031
095200     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-FRI-CNT-DMM.      09171031
095300     IF PV-DAILY-RECEIPTS > 99999999                              09172031
095400         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09173031
095500         MOVE PV-1-COMMA-11-X TO TL-RET-FRI                       09174031
095600     ELSE                                                         09175031
095700         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09176031
095800         MOVE PV-2-COMMA-11-X TO TL-RET-FRI                       09177031
095900     END-IF.                                                      09178031
096000*    COMPUTE TL-RET-SAT ROUNDED       = PV-RET-SAT-CNT-DMM.       09180031
096100     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-SAT-CNT-DMM.      09181031
096200     IF PV-DAILY-RECEIPTS > 99999999                              09182031
096300         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09183031
096400         MOVE PV-1-COMMA-11-X TO TL-RET-SAT                       09184031
096500     ELSE                                                         09185031
096600         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09186031
096700         MOVE PV-2-COMMA-11-X TO TL-RET-SAT                       09187031
096800     END-IF.                                                      09188031
096900     COMPUTE PV-WEEK-TOT-CNT-DMM      = PV-RET-SUN-CNT-DMM        09190030
097000                                      + PV-RET-MON-CNT-DMM        09200030
097100                                      + PV-RET-TUE-CNT-DMM        09210030
097200                                      + PV-RET-WED-CNT-DMM        09220030
097300                                      + PV-RET-THR-CNT-DMM        09230030
097400                                      + PV-RET-FRI-CNT-DMM        09240030
097500                                      + PV-RET-SAT-CNT-DMM.       09250030
097600*    COMPUTE TL-WEEK-TOT      ROUNDED = PV-WEEK-TOT-CNT-DMM.      09261031
097700     COMPUTE PV-WEEKLY-RECEIPTS ROUNDED = PV-WEEK-TOT-CNT-DMM.    09262031
097800     IF PV-WEEKLY-RECEIPTS > 999999999                            09263031
097900         MOVE PV-WEEKLY-RECEIPTS TO PV-1-COMMA-12                 09264031
098000         MOVE PV-1-COMMA-12-X TO TL-WEEK-TOT                      09265031
098100     ELSE                                                         09266031
098200         MOVE PV-WEEKLY-RECEIPTS TO PV-2-COMMA-12                 09267031
098300         MOVE PV-2-COMMA-12-X TO TL-WEEK-TOT                      09268031
098400     END-IF.                                                      09269031
098500*    COMPUTE TL-MTD-RECEIPTS  ROUNDED = PV-MTD-RCPT-CNT-DMM.      09270030
098600     COMPUTE PV-MTD-RECEIPTS  ROUNDED = PV-MTD-RCPT-CNT-DMM.      09280030
098700     IF PV-MTD-RECEIPTS > 999999999                               09290030
098800         MOVE PV-MTD-RECEIPTS TO PV-1-COMMA-12                    09300030
098900         MOVE PV-1-COMMA-12-X TO TL-MTD-RECEIPTS-X                09310030
099000     ELSE                                                         09320030
099100         MOVE PV-MTD-RECEIPTS TO PV-2-COMMA-12                    09330030
099200         MOVE PV-2-COMMA-12-X TO TL-MTD-RECEIPTS-X                09340030
099300     END-IF.                                                      09350030
099400*                                                                 09360030
099500     IF  HL4-CO-FIELDS                                            09370030
099600*        COMPUTE TL-PROJ-RECEIPTS ROUNDED = PV-PROJ-RCPT-CNT-DMM  09380030
099700         COMPUTE PV-PROJ-RECEIPTS ROUNDED = PV-PROJ-RCPT-CNT-DMM  09390030
099800         IF PV-PROJ-RECEIPTS > 999999999                          09400030
099900             MOVE PV-PROJ-RECEIPTS TO PV-1-COMMA-12               09410030
100000             MOVE PV-1-COMMA-12-X  TO TL-PROJ-RECEIPTS-X          09420030
100100         ELSE                                                     09430030
100200             MOVE PV-PROJ-RECEIPTS TO PV-2-COMMA-12               09440030
100300             MOVE PV-2-COMMA-12-X  TO TL-PROJ-RECEIPTS-X          09450030
100400         END-IF                                                   09460030
100500         COMPUTE PV-VARIANCE-CNT-DMM      = PV-PROJ-RCPT-CNT-DMM  09470030
100600                                          - PV-MTD-RCPT-CNT-DMM   09480030
100700*        COMPUTE TL-VARIANCE      ROUNDED = PV-VARIANCE-CNT-DMM   09490030
100800         COMPUTE PV-VARIANCE      ROUNDED = PV-VARIANCE-CNT-DMM   09500030
100900         IF PV-VARIANCE > 999999999                               09510030
101000             MOVE PV-VARIANCE      TO PV-1-COMMA-12               09520030
101100             MOVE PV-1-COMMA-12-X  TO TL-VARIANCE-X               09530030
101200         ELSE                                                     09540030
101300             MOVE PV-VARIANCE      TO PV-2-COMMA-12               09550030
101400             MOVE PV-2-COMMA-12-X  TO TL-VARIANCE-X               09560030
101500         END-IF                                                   09570030
101600         IF  PV-PROJ-RCPT-CNT-DMM = ZERO                          09580030
101700             MOVE SPACES             TO TL-PCT-X                  09590030
101800                                        TL-PCT-SIGN               09600030
101900         ELSE                                                     09610030
102000             COMPUTE TL-PCT ROUNDED =                             09620030
102100               (PV-MTD-RCPT-CNT-DMM / PV-PROJ-RCPT-CNT-DMM) * 100 09630030
102200             SET TL-PCT-SIGN-DISPLAY TO TRUE                      09640030
102300         END-IF                                                   09650030
102400     END-IF.                                                      09660030
102500*                                                                 09670030
102600     MOVE TOTAL-LINE                 TO DAILY-VERIFY-LINE.        09680030
102700     MOVE 2                          TO PV-CARR-RETRN.            09690030
102800     PERFORM 7200-WRITE-REPORT.                                   09700030
102900*                                                                 09710030
103000     MOVE ZERO                       TO PV-RET-SUN-CNT-DMM        09720030
103100                                        PV-RET-MON-CNT-DMM        09730030
103200                                        PV-RET-TUE-CNT-DMM        09740030
103300                                        PV-RET-WED-CNT-DMM        09750030
103400                                        PV-RET-THR-CNT-DMM        09760030
103500                                        PV-RET-FRI-CNT-DMM        09770030
103600                                        PV-RET-SAT-CNT-DMM        09780030
103700                                        PV-WEEK-TOT-CNT-DMM       09790030
103800                                        PV-MTD-RCPT-CNT-DMM       09800030
103900                                        PV-PROJ-RCPT-CNT-DMM      09810030
104000                                        PV-VARIANCE-CNT-DMM.      09820030
104100*                                                                 09830030
104200*                                                                 09840030
104300 4400-CREATE-GMM-LINE.                                            09850030
104400******************************************************************09860030
104500*  MOVE ALL GMM TOTALS AND WRITE DETAIL LINE.                     09870030
104600******************************************************************09880030
104700*                                                                 09890030
104800     PERFORM 8100-GET-GMM-NAME.                                   09900030
104900                                                                  09910030
105000*    COMPUTE TL-RET-SUN ROUNDED       = PV-RET-SUN-CNT-GMM.       09920031
105100     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-SUN-CNT-GMM.      09921031
105200     IF PV-DAILY-RECEIPTS > 99999999                              09922031
105300         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09923031
105400         MOVE PV-1-COMMA-11-X TO TL-RET-SUN                       09924031
105500     ELSE                                                         09925031
105600         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09926031
105700         MOVE PV-2-COMMA-11-X TO TL-RET-SUN                       09927031
105800     END-IF.                                                      09928031
105900*    COMPUTE TL-RET-MON ROUNDED       = PV-RET-MON-CNT-GMM.       09930031
106000     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-MON-CNT-GMM.      09931031
106100     IF PV-DAILY-RECEIPTS > 99999999                              09932031
106200         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09933031
106300         MOVE PV-1-COMMA-11-X TO TL-RET-MON                       09934031
106400     ELSE                                                         09935031
106500         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09936031
106600         MOVE PV-2-COMMA-11-X TO TL-RET-MON                       09937031
106700     END-IF.                                                      09938031
106800*    COMPUTE TL-RET-TUE ROUNDED       = PV-RET-TUE-CNT-GMM.       09940031
106900     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-TUE-CNT-GMM.      09941031
107000     IF PV-DAILY-RECEIPTS > 99999999                              09942031
107100         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09943031
107200         MOVE PV-1-COMMA-11-X TO TL-RET-TUE                       09944031
107300     ELSE                                                         09945031
107400         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09946031
107500         MOVE PV-2-COMMA-11-X TO TL-RET-TUE                       09947031
107600     END-IF.                                                      09948031
107700*    COMPUTE TL-RET-WED ROUNDED       = PV-RET-WED-CNT-GMM.       09950031
107800     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-WED-CNT-GMM.      09951031
107900     IF PV-DAILY-RECEIPTS > 99999999                              09952031
108000         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09953031
108100         MOVE PV-1-COMMA-11-X TO TL-RET-WED                       09954031
108200     ELSE                                                         09955031
108300         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09956031
108400         MOVE PV-2-COMMA-11-X TO TL-RET-WED                       09957031
108500     END-IF.                                                      09958031
108600*    COMPUTE TL-RET-THR ROUNDED       = PV-RET-THR-CNT-GMM.       09960031
108700     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-THR-CNT-GMM.      09961031
108800     IF PV-DAILY-RECEIPTS > 99999999                              09962031
108900         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09963031
109000         MOVE PV-1-COMMA-11-X TO TL-RET-THR                       09964031
109100     ELSE                                                         09965031
109200         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09966031
109300         MOVE PV-2-COMMA-11-X TO TL-RET-THR                       09967031
109400     END-IF.                                                      09968031
109500*    COMPUTE TL-RET-FRI ROUNDED       = PV-RET-FRI-CNT-GMM.       09970031
109600     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-FRI-CNT-GMM.      09971031
109700     IF PV-DAILY-RECEIPTS > 99999999                              09972031
109800         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09973031
109900         MOVE PV-1-COMMA-11-X TO TL-RET-FRI                       09974031
110000     ELSE                                                         09975031
110100         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09976031
110200         MOVE PV-2-COMMA-11-X TO TL-RET-FRI                       09977031
110300     END-IF.                                                      09978031
110400*    COMPUTE TL-RET-SAT ROUNDED       = PV-RET-SAT-CNT-GMM.       09980031
110500     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-SAT-CNT-GMM.      09981031
110600     IF PV-DAILY-RECEIPTS > 99999999                              09982031
110700         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  09983031
110800         MOVE PV-1-COMMA-11-X TO TL-RET-SAT                       09984031
110900     ELSE                                                         09985031
111000         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  09986031
111100         MOVE PV-2-COMMA-11-X TO TL-RET-SAT                       09987031
111200     END-IF.                                                      09988031
111300     COMPUTE PV-WEEK-TOT-CNT-GMM      = PV-RET-SUN-CNT-GMM        09990030
111400                                      + PV-RET-MON-CNT-GMM        10000030
111500                                      + PV-RET-TUE-CNT-GMM        10010030
111600                                      + PV-RET-WED-CNT-GMM        10020030
111700                                      + PV-RET-THR-CNT-GMM        10030030
111800                                      + PV-RET-FRI-CNT-GMM        10040030
111900                                      + PV-RET-SAT-CNT-GMM.       10050030
112000*    COMPUTE TL-WEEK-TOT      ROUNDED = PV-WEEK-TOT-CNT-GMM.      10060031
112100     COMPUTE PV-WEEKLY-RECEIPTS ROUNDED = PV-WEEK-TOT-CNT-GMM.    10061031
112200     IF PV-WEEKLY-RECEIPTS > 999999999                            10062031
112300         MOVE PV-WEEKLY-RECEIPTS TO PV-1-COMMA-12                 10063031
112400         MOVE PV-1-COMMA-12-X TO TL-WEEK-TOT                      10064031
112500     ELSE                                                         10065031
112600         MOVE PV-WEEKLY-RECEIPTS TO PV-2-COMMA-12                 10066031
112700         MOVE PV-2-COMMA-12-X TO TL-WEEK-TOT                      10067031
112800     END-IF.                                                      10068031
112900*    COMPUTE TL-MTD-RECEIPTS  ROUNDED = PV-MTD-RCPT-CNT-GMM.      10070030
113000     COMPUTE PV-MTD-RECEIPTS  ROUNDED = PV-MTD-RCPT-CNT-GMM.      10080030
113100     IF PV-MTD-RECEIPTS > 999999999                               10090030
113200         MOVE PV-MTD-RECEIPTS TO PV-1-COMMA-12                    10100030
113300         MOVE PV-1-COMMA-12-X TO TL-MTD-RECEIPTS-X                10110030
113400     ELSE                                                         10120030
113500         MOVE PV-MTD-RECEIPTS TO PV-2-COMMA-12                    10130030
113600         MOVE PV-2-COMMA-12-X TO TL-MTD-RECEIPTS-X                10140030
113700     END-IF.                                                      10150030
113800*                                                                 10160030
113900     IF  HL4-CO-FIELDS                                            10170030
114000*        COMPUTE TL-PROJ-RECEIPTS ROUNDED = PV-PROJ-RCPT-CNT-GMM  10180030
114100         COMPUTE PV-PROJ-RECEIPTS ROUNDED = PV-PROJ-RCPT-CNT-GMM  10190030
114200         IF PV-PROJ-RECEIPTS > 999999999                          10200030
114300             MOVE PV-PROJ-RECEIPTS TO PV-1-COMMA-12               10210030
114400             MOVE PV-1-COMMA-12-X  TO TL-PROJ-RECEIPTS-X          10220030
114500         ELSE                                                     10230030
114600             MOVE PV-PROJ-RECEIPTS TO PV-2-COMMA-12               10240030
114700             MOVE PV-2-COMMA-12-X  TO TL-PROJ-RECEIPTS-X          10250030
114800         END-IF                                                   10260030
114900         COMPUTE PV-VARIANCE-CNT-GMM      = PV-PROJ-RCPT-CNT-GMM  10270030
115000                                          - PV-MTD-RCPT-CNT-GMM   10280030
115100*        COMPUTE TL-VARIANCE      ROUNDED = PV-VARIANCE-CNT-GMM   10290030
115200         COMPUTE PV-VARIANCE      ROUNDED = PV-VARIANCE-CNT-GMM   10300030
115300         IF PV-VARIANCE > 999999999                               10310030
115400             MOVE PV-VARIANCE      TO PV-1-COMMA-12               10320030
115500             MOVE PV-1-COMMA-12-X  TO TL-VARIANCE-X               10330030
115600         ELSE                                                     10340030
115700             MOVE PV-VARIANCE      TO PV-2-COMMA-12               10350030
115800             MOVE PV-2-COMMA-12-X  TO TL-VARIANCE-X               10360030
115900         END-IF                                                   10370030
116000         IF  PV-PROJ-RCPT-CNT-GMM = ZERO                          10380030
116100             MOVE SPACES             TO TL-PCT-X                  10390030
116200                                        TL-PCT-SIGN               10400030
116300         ELSE                                                     10410030
116400             COMPUTE TL-PCT ROUNDED =                             10420030
116500               (PV-MTD-RCPT-CNT-GMM / PV-PROJ-RCPT-CNT-GMM) * 100 10430030
116600             SET TL-PCT-SIGN-DISPLAY TO TRUE                      10440030
116700         END-IF                                                   10450030
116800     END-IF.                                                      10460030
116900*                                                                 10470030
117000     MOVE TOTAL-LINE                 TO DAILY-VERIFY-LINE.        10480030
117100     MOVE 2                          TO PV-CARR-RETRN.            10490030
117200     PERFORM 7200-WRITE-REPORT.                                   10500030
117300*                                                                 10510030
117400     MOVE ZERO                       TO PV-RET-SUN-CNT-GMM        10520030
117500                                        PV-RET-MON-CNT-GMM        10530030
117600                                        PV-RET-TUE-CNT-GMM        10540030
117700                                        PV-RET-WED-CNT-GMM        10550030
117800                                        PV-RET-THR-CNT-GMM        10560030
117900                                        PV-RET-FRI-CNT-GMM        10570030
118000                                        PV-RET-SAT-CNT-GMM        10580030
118100                                        PV-WEEK-TOT-CNT-GMM       10590030
118200                                        PV-MTD-RCPT-CNT-GMM       10600030
118300                                        PV-PROJ-RCPT-CNT-GMM      10610030
118400                                        PV-VARIANCE-CNT-GMM.      10620030
118500*                                                                 10630030
118600*                                                                 10640030
118700 4500-CREATE-BRK-LINE.                                            10650030
118800******************************************************************10660030
118900*  MOVE ALL DC TOTALS AND WRITE DETAIL LINES.                     10670030
119000******************************************************************10680030
119100     MOVE HL3-DC-NAME                TO TL-HEAD.                  10690030
119200                                                                  10700030
119300*    COMPUTE TL-RET-SUN ROUNDED       = PV-RET-SUN-CNT-DC.        10710031
119400     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-SUN-CNT-DC.       10711031
119500     IF PV-DAILY-RECEIPTS > 99999999                              10712031
119600         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  10713031
119700         MOVE PV-1-COMMA-11-X TO TL-RET-SUN                       10714031
119800     ELSE                                                         10715031
119900         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  10716031
120000         MOVE PV-2-COMMA-11-X TO TL-RET-SUN                       10717031
120100     END-IF.                                                      10718031
120200*    COMPUTE TL-RET-MON ROUNDED       = PV-RET-MON-CNT-DC.        10720031
120300     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-MON-CNT-DC.       10721031
120400     IF PV-DAILY-RECEIPTS > 99999999                              10722031
120500         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  10723031
120600         MOVE PV-1-COMMA-11-X TO TL-RET-MON                       10724031
120700     ELSE                                                         10725031
120800         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  10726031
120900         MOVE PV-2-COMMA-11-X TO TL-RET-MON                       10727031
121000     END-IF.                                                      10728031
121100*    COMPUTE TL-RET-TUE ROUNDED       = PV-RET-TUE-CNT-DC.        10730031
121200     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-TUE-CNT-DC.       10731031
121300     IF PV-DAILY-RECEIPTS > 99999999                              10732031
121400         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  10733031
121500         MOVE PV-1-COMMA-11-X TO TL-RET-TUE                       10734031
121600     ELSE                                                         10735031
121700         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  10736031
121800         MOVE PV-2-COMMA-11-X TO TL-RET-TUE                       10737031
121900     END-IF.                                                      10738031
122000*    COMPUTE TL-RET-WED ROUNDED       = PV-RET-WED-CNT-DC.        10740031
122100     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-WED-CNT-DC.       10741031
122200     IF PV-DAILY-RECEIPTS > 99999999                              10742031
122300         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  10743031
122400         MOVE PV-1-COMMA-11-X TO TL-RET-WED                       10744031
122500     ELSE                                                         10745031
122600         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  10746031
122700         MOVE PV-2-COMMA-11-X TO TL-RET-WED                       10747031
122800     END-IF.                                                      10748031
122900*    COMPUTE TL-RET-THR ROUNDED       = PV-RET-THR-CNT-DC.        10750031
123000     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-THR-CNT-DC.       10751031
123100     IF PV-DAILY-RECEIPTS > 99999999                              10752031
123200         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  10753031
123300         MOVE PV-1-COMMA-11-X TO TL-RET-THR                       10754031
123400     ELSE                                                         10755031
123500         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  10756031
123600         MOVE PV-2-COMMA-11-X TO TL-RET-THR                       10757031
123700     END-IF.                                                      10758031
123800*    COMPUTE TL-RET-FRI ROUNDED       = PV-RET-FRI-CNT-DC.        10760031
123900     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-FRI-CNT-DC.       10761031
124000     IF PV-DAILY-RECEIPTS > 99999999                              10762031
124100         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  10763031
124200         MOVE PV-1-COMMA-11-X TO TL-RET-FRI                       10764031
124300     ELSE                                                         10765031
124400         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  10766031
124500         MOVE PV-2-COMMA-11-X TO TL-RET-FRI                       10767031
124600     END-IF.                                                      10768031
124700*    COMPUTE TL-RET-SAT ROUNDED       = PV-RET-SAT-CNT-DC.        10770031
124800     COMPUTE PV-DAILY-RECEIPTS ROUNDED = PV-RET-SAT-CNT-DC.       10771031
124900     IF PV-DAILY-RECEIPTS > 99999999                              10772031
125000         MOVE PV-DAILY-RECEIPTS TO PV-1-COMMA-11                  10773031
125100         MOVE PV-1-COMMA-11-X TO TL-RET-SAT                       10774031
125200     ELSE                                                         10775031
125300         MOVE PV-DAILY-RECEIPTS TO PV-2-COMMA-11                  10776031
125400         MOVE PV-2-COMMA-11-X TO TL-RET-SAT                       10777031
125500     END-IF.                                                      10778031
125600     COMPUTE PV-WEEK-TOT-CNT-DC       = PV-RET-SUN-CNT-DC         10780030
125700                                      + PV-RET-MON-CNT-DC         10790030
125800                                      + PV-RET-TUE-CNT-DC         10800030
125900                                      + PV-RET-WED-CNT-DC         10810030
126000                                      + PV-RET-THR-CNT-DC         10820030
126100                                      + PV-RET-FRI-CNT-DC         10830030
126200                                      + PV-RET-SAT-CNT-DC.        10840030
126300*    COMPUTE TL-WEEK-TOT      ROUNDED = PV-WEEK-TOT-CNT-DC.       10850031
126400     COMPUTE PV-WEEKLY-RECEIPTS ROUNDED = PV-WEEK-TOT-CNT-DC.     10851031
126500     IF PV-WEEKLY-RECEIPTS > 999999999                            10852031
126600         MOVE PV-WEEKLY-RECEIPTS TO PV-1-COMMA-12                 10853031
126700         MOVE PV-1-COMMA-12-X TO TL-WEEK-TOT                      10854031
126800     ELSE                                                         10855031
126900         MOVE PV-WEEKLY-RECEIPTS TO PV-2-COMMA-12                 10856031
127000         MOVE PV-2-COMMA-12-X TO TL-WEEK-TOT                      10857031
127100     END-IF.                                                      10858031
127200*    COMPUTE TL-MTD-RECEIPTS  ROUNDED = PV-MTD-RCPT-CNT-DC.       10860030
127300     COMPUTE PV-MTD-RECEIPTS  ROUNDED = PV-MTD-RCPT-CNT-DC.       10870030
127400     IF PV-MTD-RECEIPTS > 999999999                               10880030
127500         MOVE PV-MTD-RECEIPTS TO PV-1-COMMA-12                    10890030
127600         MOVE PV-1-COMMA-12-X TO TL-MTD-RECEIPTS-X                10900030
127700     ELSE                                                         10910030
127800         MOVE PV-MTD-RECEIPTS TO PV-2-COMMA-12                    10920030
127900         MOVE PV-2-COMMA-12-X TO TL-MTD-RECEIPTS-X                10930030
128000     END-IF.                                                      10940030
128100*                                                                 10950030
128200     IF  HL4-CO-FIELDS                                            10960030
128300*        COMPUTE TL-PROJ-RECEIPTS ROUNDED = PV-PROJ-RCPT-CNT-DC   10970030
128400         COMPUTE PV-PROJ-RECEIPTS ROUNDED = PV-PROJ-RCPT-CNT-DC   10980030
128500         IF PV-PROJ-RECEIPTS > 999999999                          10990030
128600             MOVE PV-PROJ-RECEIPTS TO PV-1-COMMA-12               11000030
128700             MOVE PV-1-COMMA-12-X  TO TL-PROJ-RECEIPTS-X          11010030
128800         ELSE                                                     11020030
128900             MOVE PV-PROJ-RECEIPTS TO PV-2-COMMA-12               11030030
129000             MOVE PV-2-COMMA-12-X  TO TL-PROJ-RECEIPTS-X          11040030
129100         END-IF                                                   11050030
129200         COMPUTE PV-VARIANCE-CNT-DC       = PV-PROJ-RCPT-CNT-DC   11060030
129300                                          - PV-MTD-RCPT-CNT-DC    11070030
129400*        COMPUTE TL-VARIANCE      ROUNDED = PV-VARIANCE-CNT-DC    11080030
129500         COMPUTE PV-VARIANCE      ROUNDED = PV-VARIANCE-CNT-DC    11090030
129600         IF PV-VARIANCE > 999999999                               11100030
129700             MOVE PV-VARIANCE      TO PV-1-COMMA-12               11110030
129800             MOVE PV-1-COMMA-12-X  TO TL-VARIANCE-X               11120030
129900         ELSE                                                     11130030
130000             MOVE PV-VARIANCE      TO PV-2-COMMA-12               11140030
130100             MOVE PV-2-COMMA-12-X  TO TL-VARIANCE-X               11150030
130200         END-IF                                                   11160030
130300         IF  PV-PROJ-RCPT-CNT-DC = ZERO                           11170030
130400             MOVE SPACES             TO TL-PCT-X                  11180030
130500                                        TL-PCT-SIGN               11190030
130600         ELSE                                                     11200030
130700             COMPUTE TL-PCT ROUNDED =                             11210030
130800               (PV-MTD-RCPT-CNT-DC / PV-PROJ-RCPT-CNT-DC) * 100   11220030
130900             SET TL-PCT-SIGN-DISPLAY TO TRUE                      11230030
131000         END-IF                                                   11240030
131100     END-IF.                                                      11250030
131200*                                                                 11260030
131300     IF  TT-INDX > 50                                             11270030
131400         MOVE '4500-CREATE-BRK-LINE' TO PV-ABEND-PARAGRAPH        11280030
131500         MOVE 'THE TABLE OF TOTAL LINES IS ABOUT TO OVERFLOW'     11290030
131600                                     TO PV-ERR-MSG-1              11300030
131700         MOVE SPACES                 TO PV-ERR-MSG-2              11310030
131800         PERFORM 9900-SQL-ABEND                                   11320030
131900     END-IF.                                                      11330030
132000*                                                                 11340030
132100     MOVE TOTAL-LINE                 TO DAILY-VERIFY-LINE         11350030
132200                                        TT-OCC (TT-INDX).         11360030
132300     MOVE 2                          TO PV-CARR-RETRN.            11370030
132400     PERFORM 7200-WRITE-REPORT.                                   11380030
132500*                                                                 11390030
132600     SET TT-INDX UP BY 1.                                         11400030
132700*                                                                 11410030
132800     MOVE ZERO                       TO PV-RET-SUN-CNT-DC         11420030
132900                                        PV-RET-MON-CNT-DC         11430030
133000                                        PV-RET-TUE-CNT-DC         11440030
133100                                        PV-RET-WED-CNT-DC         11450030
133200                                        PV-RET-THR-CNT-DC         11460030
133300                                        PV-RET-FRI-CNT-DC         11470030
133400                                        PV-RET-SAT-CNT-DC         11480030
133500                                        PV-WEEK-TOT-CNT-DC        11490030
133600                                        PV-MTD-RCPT-CNT-DC        11500030
133700                                        PV-PROJ-RCPT-CNT-DC       11510030
133800                                        PV-VARIANCE-CNT-DC        11520030
133900                                        PV-PAGE-CNT.              11530030
134000*                                                                 11540030
134100*                                                                 11550030
134200 7000-READ-DC-FILE.                                               11560030
134300******************************************************************11570030
134400*  READ THE SORTED KEYREC DATA.                                   11580030
134500******************************************************************11590030
134600     READ DAILY-KEYREC-DC-FILE INTO MP009I-DAILY-RECEIPTS         11600030
134700         AT END SET PS-DC-EOF        TO TRUE.                     11610030
134800*                                                                 11620030
134900*                                                                 11630030
135000 7100-READ-CO-FILE.                                               11640030
135100******************************************************************11650030
135200*  READ THE SORTED KEYREC DATA.                                   11660030
135300******************************************************************11670030
135400     READ DAILY-KEYREC-CO-FILE INTO MP009I-DAILY-RECEIPTS         11680030
135500         AT END SET PS-CO-EOF        TO TRUE.                     11690030
135600*                                                                 11700030
135700*                                                                 11710030
135800 7200-WRITE-REPORT.                                               11720030
135900******************************************************************11730030
136000*  WRITE REPORT WITH PROPER PAGE BREAKING                         11740030
136100******************************************************************11750030
136200     WRITE DAILY-VERIFY-LINE                                      11760030
136300       AFTER ADVANCING PV-CARR-RETRN LINES.                       11770030
136400*                                                                 11780030
136500     ADD PV-CARR-RETRN               TO PV-LINE-CNT.              11790030
136600*                                                                 11800030
136700*                                                                 11810030
136800 7300-HEAD-RTN.                                                   11820030
136900******************************************************************11830030
137000*  HEADING ROUTINE                                                11840030
137100******************************************************************11850030
137200     ADD 1                           TO PV-PAGE-CNT.              11860030
137300     MOVE PV-PAGE-CNT                TO DP150O-PAGE-NUMBER.       11870030
137400     WRITE DAILY-VERIFY-LINE                                      11880030
137500       FROM DP150O-STANDRD-HEADER-150-COLS                        11890030
137600         AFTER ADVANCING PAGE.                                    11900030
137700                                                                  11910030
137800     MOVE SPACES TO DP150O-LASER-NEW-PAGE-INDICATR.               11920030
137900                                                                  11930030
138000     WRITE DAILY-VERIFY-LINE                                      11940030
138100       FROM HEADING-LINE-2                                        11950030
138200         AFTER ADVANCING 2 LINES.                                 11960030
138300                                                                  11970030
138400     WRITE DAILY-VERIFY-LINE                                      11980030
138500       FROM HEADING-LINE-3                                        11990030
138600         AFTER ADVANCING 1 LINE.                                  12000030
138700                                                                  12010030
138800     WRITE DAILY-VERIFY-LINE                                      12020030
138900       FROM HEADING-LINE-4                                        12030030
139000         AFTER ADVANCING 2 LINES.                                 12040030
139100                                                                  12050030
139200     WRITE DAILY-VERIFY-LINE                                      12060030
139300       FROM HEADING-LINE-5                                        12070030
139400         AFTER ADVANCING 1 LINE.                                  12080030
139500                                                                  12090030
139600     MOVE 1                          TO PV-CARR-RETRN.            12100030
139700     MOVE 7                          TO PV-LINE-CNT.              12110030
139800                                                                  12120030
139900*                                                                 12130030
140000 7400-PRINT-FINAL.                                                12140030
140100******************************************************************12150030
140200*  END OF REPORT ROUTINE                                          12160030
140300******************************************************************12160130
140400                                                                  12160204
140500     WRITE DAILY-VERIFY-LINE                                      12160304
140600       FROM PR-PRINT-FINAL                                        12160430
140700          AFTER ADVANCING 2 LINES                                 12160506
140800                                                                  12160604
140900     ADD 2                      TO PV-LINE-CNT.                   12160730
141000                                                                  12160804
141100*                                                                 12160930
141200 8000-GET-DMM-NAME.                                               12161030
141300******************************************************************12162030
141400*  CALL MBS SUBROUTINE TO GET DIVISION MANAGER NAME.              12163030
141500******************************************************************12164030
141600     INITIALIZE DP003-MBS-SUBROUTINE-FIELDS.                      12165030
141700     SET DP003-DMM-LOOKUP-NAME       TO TRUE.                     12166030
141800     SET DP003-DMM-NAME-LAST-ONLY    TO TRUE.                     12167030
141900     MOVE PC-MBS-SYSTEM-CODE-ML      TO DP003-SYSTEM-CODE.        12168030
142000     MOVE PC-MBS-OP-CO-03            TO DP003-OP-CO-NMBR.         12169030
142100     MOVE PV-SYSTEM-DATE             TO DP003-CURRENT-DATE        12170030
142200                                        DP003-EFF-DATE.           12180030
142300     MOVE PV-SAV-DEPT                TO DP003-DPT-INPUT.          12190030
142400*                                                                 12200030
142500     CALL PC-PGM-DPKUT039 USING DP003-MBS-SUBROUTINE-FIELDS.      12210030
142600*                                                                 12220030
142700     EVALUATE TRUE                                                12230030
142800         WHEN DP003-SUCCESSFUL                                    12240030
142900              MOVE DP003-DMM-NAME (1:15)                          12250030
143000                                     TO TL-HEAD                   12260030
143100         WHEN DP003-DMM-NAME-NOT-FOUND                            12270030
143200         WHEN DP003-DMM-NMBR-NOT-FOUND                            12280030
143300              MOVE 'MISC DMM       ' TO TL-HEAD                   12290030
143400         WHEN DP003-DMM-NAME-DB2-ERROR                            12300030
143500         WHEN DP003-DMM-NAME-MAX-RETRIES                          12310030
143600              MOVE DP003-INPUT-FIELDS                             12320030
143700                                     TO PV-ERR-MSG-1              12330030
143800              MOVE DP003-RETURN-DATA TO PV-ERR-MSG-2              12340030
143900              MOVE DP003-SQLCA       TO SQLCA                     12350030
144000              MOVE '8000-GET-DMM-NAME'                            12360030
144100                                     TO PV-ABEND-PARAGRAPH        12370030
144200              PERFORM 9900-SQL-ABEND                              12380030
144300         WHEN OTHER                                               12390030
144400              MOVE DP003-INPUT-FIELDS                             12400030
144500                                     TO PV-ERR-MSG-1              12410030
144600              MOVE DP003-RETURN-DATA TO PV-ERR-MSG-2              12420030
144700              MOVE '8000-GET-DMM-NAME'                            12430030
144800                                     TO PV-ABEND-PARAGRAPH        12440030
144900     END-EVALUATE.                                                12450030
145000*                                                                 12460030
145100*                                                                 12470030
145200 8100-GET-GMM-NAME.                                               12480030
145300******************************************************************12490030
145400*  CALL MBS SUBROUTINE TO GET DIVISION MANAGER NAME.              12500030
145500******************************************************************12510030
145600     INITIALIZE DP003-MBS-SUBROUTINE-FIELDS.                      12520030
145700     SET DP003-GMM-LOOKUP-NAME       TO TRUE.                     12530030
145800     SET DP003-GMM-NAME-LAST-ONLY    TO TRUE.                     12540030
145900     MOVE PC-MBS-SYSTEM-CODE-ML      TO DP003-SYSTEM-CODE.        12550030
146000     MOVE PC-MBS-OP-CO-03            TO DP003-OP-CO-NMBR.         12560030
146100     MOVE PV-SYSTEM-DATE             TO DP003-CURRENT-DATE        12570030
146200                                        DP003-EFF-DATE.           12580030
146300     MOVE PV-SAV-DEPT                TO DP003-DPT-INPUT.          12590030
146400*                                                                 12600030
146500     CALL PC-PGM-DPKUT039 USING DP003-MBS-SUBROUTINE-FIELDS.      12610030
146600*                                                                 12620030
146700     EVALUATE TRUE                                                12630030
146800         WHEN DP003-SUCCESSFUL                                    12640030
146900              MOVE DP003-GMM-NAME (1:15)                          12650030
147000                                     TO TL-HEAD                   12660030
147100         WHEN DP003-GMM-NAME-NOT-FOUND                            12670030
147200         WHEN DP003-GMM-NMBR-NOT-FOUND                            12680030
147300              MOVE 'MISC GMM       ' TO TL-HEAD                   12690030
147400         WHEN DP003-GMM-NAME-DB2-ERROR                            12700030
147500         WHEN DP003-GMM-NAME-MAX-RETRIES                          12710030
147600              MOVE DP003-INPUT-FIELDS                             12720030
147700                                     TO PV-ERR-MSG-1              12730030
147800              MOVE DP003-RETURN-DATA TO PV-ERR-MSG-2              12740030
147900              MOVE DP003-SQLCA       TO SQLCA                     12750030
148000              MOVE '8100-GET-GMM-NAME'                            12760030
148100                                     TO PV-ABEND-PARAGRAPH        12770030
148200              MOVE DP003-SQLCODE     TO PV-SQLCODE                12780030
148300              PERFORM 9900-SQL-ABEND                              12790030
148400         WHEN OTHER                                               12800030
148500              MOVE DP003-INPUT-FIELDS                             12810030
148600                                     TO PV-ERR-MSG-1              12820030
148700              MOVE DP003-RETURN-DATA TO PV-ERR-MSG-2              12830030
148800              MOVE '8100-GET-GMM-NAME'                            12840030
148900                                     TO PV-ABEND-PARAGRAPH        12850030
149000              MOVE DP003-SQLCODE     TO PV-SQLCODE                12860030
149100              PERFORM 9999-ABEND-PROGRAM                          12870030
149200     END-EVALUATE.                                                12880030
149300*                                                                 12890030
149400*                                                                 12900030
149500 9900-SQL-ABEND.                                                  12910030
149600******************************************************************12920030
149700*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    12930030
149800*  ERROR OR WARNING CODE OCCURS.                                  12940030
149900******************************************************************12950030
150000     DISPLAY '***************************'.                       12960030
150100     DISPLAY '**       ABEND           **'.                       12970030
150200     DISPLAY '**  IN PROGRAM MPKRP010  **'.                       12980030
150300     DISPLAY '***************************'.                       12990030
150400     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             13000030
150500     DISPLAY '** ERROR     ** = ' PV-ERR-MSG-1.                   13010030
150600     DISPLAY '** MORE      ** = ' PV-ERR-MSG-2.                   13020030
150700     DISPLAY '** SQLCODE   ** = ' PV-SQLCODE.                     13030030
150800*                                                                 13040030
150900******************************************************************13050030
151000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    13060030
151100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         13070030
151200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     13080030
151300* FORMAT.                                                         13090030
151400******************************************************************13100030
151500     COPY DPPD004.                                                13110030
151600*                                                                 13120030
151700     MOVE +4013                      TO PV-ABEND-CODE.            13130030
151800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         13140030
151900*                                                                 13150030
152000*                                                                 13160030
152100 9999-ABEND-PROGRAM.                                              13170030
152200******************************************************************13180030
152300*  PERFORMS THE ABEND FOR THE PROGRAM WHEN NO DB2 IS INVLOVED.    13190030
152400******************************************************************13200030
152500     DISPLAY '***************************'.                       13210030
152600     DISPLAY '**       ABEND           **'.                       13220030
152700     DISPLAY '**  IN PROGRAM MPKRP010  **'.                       13230030
152800     DISPLAY '***************************'.                       13240030
152900     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             13250030
153000     DISPLAY '** ERROR     ** = ' PV-ERR-MSG-1.                   13260030
153100     DISPLAY '** MORE      ** = ' PV-ERR-MSG-2.                   13270030
153200                                                                  13280030
153300     MOVE +4014                      TO PV-ABEND-CODE.            13290030
153400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         13300030
