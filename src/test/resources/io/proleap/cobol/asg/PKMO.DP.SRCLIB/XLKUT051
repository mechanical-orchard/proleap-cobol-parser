000500***************************************************************** 00010001
000600 IDENTIFICATION DIVISION.                                         00020001
000700***************************************************************** 00030001
000800 PROGRAM-ID.    XLKUT051.                                         00040001
000900 AUTHOR.        DAN HINTZ.                                        00050001
001000 INSTALLATION.  KOHLS.                                            00060001
001100 DATE-WRITTEN   APRIL 2003.                                       00070001
001200 DATE-COMPILED.                                                   00080001
001300***************************************************************** 00090001
001400*  THIS PROGRAM WILL REFORMAT THE RMS PACK ITEM HEADER EXTRACT  * 00100001
001500*  INTO LOGISTICS DOMAIN PACK ITEM LAYOUT (XLRD027).            *       01
001600***************************************************************** 00140001
001700 ENVIRONMENT DIVISION.                                            00150001
001800 INPUT-OUTPUT SECTION.                                            00160001
001900                                                                  00170001
002000 FILE-CONTROL.                                                    00180001
002100                                                                  00190001
002200     SELECT RMS-PACK-HEADER-FILE                                  00200001
002300         ASSIGN TO INP01.                                         00201001
002400                                                                  00210001
002500     SELECT PACK-DATA-FILE                                        00200001
002600         ASSIGN TO OUT01.                                               01
002700                                                                  00210001
002800***************************************************************** 00220001
002900 DATA DIVISION.                                                   00230001
003000***************************************************************** 00240001
003100 FILE SECTION.                                                    00250001
003200                                                                  00260001
003300 FD  RMS-PACK-HEADER-FILE                                         00270001
003400     RECORDING MODE IS F                                          00280001
003500     BLOCK CONTAINS 0 RECORDS                                     00281001
003600     LABEL RECORDS ARE STANDARD.                                  00290001
003700                                                                  00300001
003800 01  RMS-PACK-HEADER-RECORD       PIC X(119).                     00330001
003900                                                                  00370001
004000 FD  PACK-DATA-FILE                                                     01
004100     RECORDING MODE IS F                                          00280001
004200     BLOCK CONTAINS 0 RECORDS                                     00281001
004300     LABEL RECORDS ARE STANDARD.                                  00290001
004400                                                                  00300001
004500 01  PACK-DATA-RECORD             PIC X(144).                     00330001
004600                                                                  00370001
004700                                                                  00380001
004800***************************************************************** 00390001
004900 WORKING-STORAGE SECTION.                                         00400001
005000                                                                  00410001
005100 01  PS-PROGRAM-SWITCHES.                                         00420001
005200     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00430001
005300         88  PS-EOF-INPUT-YES                    VALUE 'Y'.       00440001
005400         88  PS-EOF-INPUT-NO                     VALUE 'N'.       00450001
005500                                                                  00460001
005600 01  PC-PROGRAM-CONSTANTS.                                        00470001
005700     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'XLKUT051'.00480001
005800                                                                  00500001
005900 01  PV-PROGRAM-VARIABLES.                                        00510001
006000     05  PV-RECORDS-READ              PIC  9(09) VALUE  0.        00590001
006100     05  PV-RECORDS-WRITTEN           PIC  9(09) VALUE  0.        00600001
006400                                                                  00690001
006500                                                                  00700001
006600 01  PV-ABEND-FIELDS.                                             00710001
006700     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         00720001
006800                                                 COMP SYNC.       00730001
006900     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'XLKUT051'.00740001
007000     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00750001
007100     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00760001
007200     05  PV-ABEND-TABLE               PIC  X(12) VALUE SPACES.    00770005
007300     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    00790001
007400     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    00800001
007500     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    00810001
007600                                                                  00820001
007700                                                                  00830001
007800***********************************************************       00840001
007900*  COPYBOOK USED FOR THE RMS PACK HEADER INPUT FILE       *       00850003
008000***********************************************************       00860001
008100     COPY IMRD076.                                                00870001
008200                                                                  00880001
008300***********************************************************       00840001
008400*  COPYBOOK USED FOR THE PACK DATA OUTPUT FILE            *       00850003
008500***********************************************************       00860001
008510 01  PV-PACK-DATA-OUTPUT.                                         00710001
008700     COPY XLRD027.                                                00870001
008800                                                                  00880001
008900***************************************************************** 01080001
009000 PROCEDURE DIVISION.                                              01090001
009100***************************************************************** 01100001
009200     DISPLAY '**** BEGINNING XLKUT051 ****'.                      01110001
009300     DISPLAY ' '.                                                 01120001
009400                                                                  01130001
009500     OPEN INPUT  RMS-PACK-HEADER-FILE                             01140001
009600          OUTPUT PACK-DATA-FILE.                                  01140001
009700                                                                  01150001
009800     PERFORM 1000-READ-INPUT-FILE.                                01160001
009900                                                                  01170001
010000     PERFORM 2000-PROCESS-INPUT-FILE                              01210001
010100       UNTIL PS-EOF-INPUT-YES.                                    01220001
010200                                                                  01230001
010300     CLOSE RMS-PACK-HEADER-FILE                                         01
010400           PACK-DATA-FILE.                                              01
010500                                                                  01250001
010600     DISPLAY '   INPUT RMS PACK RECS   = ' PV-RECORDS-READ.       01260001
010700     DISPLAY '   OUTPUT PACK DATA RECS = ' PV-RECORDS-WRITTEN.          01
010800     DISPLAY ' '.                                                 01280001
010900     DISPLAY '****  END OF  XLKUT051  ****'.                      01290001
011000                                                                  01300001
011100     GOBACK.                                                      01310001
011200                                                                  01320001
011300                                                                  01330001
011400***************************************************************** 01340001
011500*  READ AN RMS SKU RECORD                                         01350003
011600***************************************************************** 01360001
011700 1000-READ-INPUT-FILE.                                            01370001
012100     INITIALIZE IMRD076-PACK-DATA.                                      03
012200                                                                  01402003
012300     READ RMS-PACK-HEADER-FILE                                    01410004
012400          INTO IMRD076-PACK-DATA                                  01420001
012500            AT END                                                01430001
012600               SET PS-EOF-INPUT-YES TO TRUE                       01440001
012700     END-READ.                                                    01490001
012800                                                                  01500001
012900     IF PS-EOF-INPUT-YES                                                  
013000        CONTINUE                                                          
013100     ELSE                                                                 
013200        ADD +1 TO PV-RECORDS-READ                                         
013300     END-IF.                                                              
013400                                                                  01510001
013500***************************************************************** 01520001
013600*  REFORMAT THE RMS PACK HEADER FILE                            * 01530003
013700***************************************************************** 01540001
013800 2000-PROCESS-INPUT-FILE.                                         01550001
014800     MOVE IM076-PACK-PK-SKU-NBR     TO XL027-PACK-PK-SKU-NBR.             
014900     MOVE IM076-PACK-PK-DESC        TO XL027-PACK-PK-DESC.                
015000     MOVE IM076-PACK-DEPT-NBR       TO XL027-PACK-DEPT-NBR.               
015100     MOVE IM076-PACK-MAJ-CL-NBR     TO XL027-PACK-MAJ-CL-NBR.             
015200     MOVE IM076-PACK-SUB-CL-NBR     TO XL027-PACK-SUB-CL-NBR.             
015300     MOVE IM076-PACK-DC-ORD-MULT-QTY                                      
015400                                    TO XL027-PACK-DC-ORD-MULT-QTY.        
015200     MOVE SPACES                    TO XL027-PACK-ERROR-MESSAGE.          
015900                                                                  01637003
016000     PERFORM 2100-WRITE-OUTPUT.                                         03
016100                                                                  01770001
016200     PERFORM 1000-READ-INPUT-FILE.                                01780001
016300                                                                  01850001
016400                                                                  01860001
016500***************************************************************** 02160001
016600*  WRITE A RECORD TO THE PACK DATA OUTPUT FILE                  * 02170003
016700***************************************************************** 02180001
016800 2100-WRITE-OUTPUT.                                               02190003
017100     WRITE PACK-DATA-RECORD FROM                                        07
017200         XL027-PACK-RECORD                                              07
017300     END-WRITE.                                                   03940007
017400     ADD +1                 TO PV-RECORDS-WRITTEN.                        
017500                                                                  02720001
