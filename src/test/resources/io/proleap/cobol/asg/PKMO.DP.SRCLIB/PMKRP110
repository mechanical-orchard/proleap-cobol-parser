000100*----------------------------------------------------------       00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*----------------------------------------------------------       00030001
000400 PROGRAM-ID.             PMKRP110.                                00040002
000500 AUTHOR.                 ALEXIS KEIKER.                           00050001
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060001
000700 DATE-WRITTEN.           APRIL 2003.                              00070001
000800 DATE-COMPILED.                                                   00080001
000900*----------------------------------------------------------       00090001
001000*   PMKRP110 - PROMOTION SUMMARY - BUYER TOTALS BY PAGE           00100002
001010*----------------------------------------------------------       00101001
001020* THIS PROGRAM WILL PRODUCE AN ACTUAL/FORECAST REPORT WITH        00102029
001021* PROMOTION TOTALS.  THIS REPORT WILL BREAK BY GMM/DMM/AD         00102129
001022* EVENT/PROMOTION.  BASICALLY EACH BREAK WILL BE THE DMM'S        00102229
001023* TOTAL FOR THAT PROMOTION.  EACH SECTION WILL DISPLAY BY         00102329
001024* BUYER THE PROMOTION TOTALS BY PAGE NUMBER/UNADVERTISED.         00102429
001025* THE INPUT FILE THAT IS USED IN THIS PROGRAM WAS CREATED         00102530
001026* IN PROGRAM PMKUT100. THIS FILE IS THEN SORTED AND SUMMED        00102630
001027* SO IT HAS PROMOTION TOTALS INSTEAD OF THE PROMO ITEM            00102730
001028* TOTALS THAT WERE ORIGINALLY CREATED IN PMKUT100.                00102830
001029*----------------------------------------------------------       00102901
001030* HISTORY LOG:                                                    00103001
001031*----------------------------------------------------------       00103101
PGNBR * DATE: 07/25/2014                                                00103239
PGNBR * WR/IR#: PRB 47935                                               00103339
PGNBR * PROGRAMMER: COGNIZANT                                           00103439
PGNBR * DESCRIPTION:MODIFIED THE CODE TO HANDLE ADVERTISED PROMO ITEMS  00103539
PGNBR *             WITH NO PAGE NUMBER.                                00103639
001036*                                                                 00103701
001037*----------------------------------------------------------       00103801
001040 ENVIRONMENT DIVISION.                                            00104001
001050*----------------------------------------------------------       00105001
001060 CONFIGURATION SECTION.                                           00106001
001070 SOURCE-COMPUTER. IBM-3090.                                       00107001
001080 OBJECT-COMPUTER. IBM-3090.                                       00108001
001090                                                                  00109001
001100 INPUT-OUTPUT SECTION.                                            00110001
001200                                                                  00120001
001300 FILE-CONTROL.                                                    00130001
001400                                                                  00140001
001500     SELECT PROMO-SUMM-BUY-FILE                                   00150003
001600            ASSIGN TO INP01.                                      00160001
001700                                                                  00170001
001860     SELECT PROMO-SUMM-REPORT                                     00186001
001870            ASSIGN TO RPT01.                                      00187001
001880                                                                  00188001
001890*----------------------------------------------------------       00189001
001900 DATA DIVISION.                                                   00190001
002000*----------------------------------------------------------       00200001
002100 FILE SECTION.                                                    00210001
002200                                                                  00220001
002300 FD  PROMO-SUMM-BUY-FILE                                          00230003
002400     RECORDING MODE F                                             00240001
002500     BLOCK CONTAINS 0 RECORDS                                     00250001
002600     LABEL RECORDS ARE OMITTED.                                   00260001
002700 01  PROMO-SUMM-BUY-RECORD            PIC X(750).                 00270022
002800                                                                  00280001
003290 FD  PROMO-SUMM-REPORT                                            00329001
003300     RECORDING MODE F                                             00330001
003400     BLOCK CONTAINS 0 RECORDS                                     00340001
003500     LABEL RECORDS ARE OMITTED.                                   00350001
003600 01  PROMO-SUMM-RPT-LINE              PIC X(200).                 00360001
003700                                                                  00370001
003800 WORKING-STORAGE SECTION.                                         00380001
003900*----------------------------------------------------------       00390001
004000* CD- CONTROL DATES (DATES ACCEPTED INTO THE PROGRAM)             00400001
004100*----------------------------------------------------------       00410001
004200 01  CD-CONTROL-DATES.                                            00420001
004300     05  CD-CPU-DATE.                                             00430001
004400         10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    00440001
004500         10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    00450001
004510         10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    00451001
004520                                                                  00452001
004530     05  CD-CPU-DATE-GREG.                                        00453001
004540         10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    00454001
004550         10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    00455001
004560         10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    00456001
004570                                                                  00457001
004580     05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    00458001
004590                                                                  00459001
004591*----------------------------------------------------------       00459101
004592* CT- CONTROL TIMES (TIMES ACCEPTED INTO THE PROGRAM)             00459201
004593*----------------------------------------------------------       00459301
004594 01  CT-CONTROL-TIMES.                                            00459401
004595     05  CT-CPU-TIME.                                             00459501
004596         10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    00459601
004597         10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    00459701
004598         10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    00459801
004599         10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    00459901
004600                                                                  00460001
004601*----------------------------------------------------------       00460101
004602* PC- PROGRAM CONSTANTS                                           00460201
004603*----------------------------------------------------------       00460301
004604 01  PC-PROGRAM-CONSTANTS.                                        00460401
004605     05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  00460501
004606     05  PC-SUB-1                     PIC 9(01)  VALUE 1.         00460601
004607     05  PC-SUB-2                     PIC 9(01)  VALUE 2.         00460701
004608     05  PC-DEFAULT-BEG-HR            PIC 9(02)  VALUE 0.         00460801
004609     05  PC-DEFAULT-BEG-MIN           PIC 9(02)  VALUE 0.         00460901
004610     05  PC-DEFAULT-END-HR            PIC 9(02)  VALUE 23.        00461001
004620     05  PC-DEFAULT-END-MIN           PIC 9(02)  VALUE 59.        00462001
004630     05  PC-CHAR-BUY                  PIC X(03)  VALUE 'BUY'.     00463001
004640     05  PC-CHAR-GET                  PIC X(03)  VALUE 'GET'.     00464001
004650     05  PC-CHAR-OFF                  PIC X(03)  VALUE 'OFF'.     00465001
004660     05  PC-CHAR-EFFECTIVE            PIC X(09)  VALUE            00466001
004670                                          'EFFECTIVE'.            00467001
004680     05  PC-FORECAST-RSLT             PIC X(36)  VALUE            00468001
004690         'FORECAST ONLY RESULTS (IN THOUSANDS)'.                  00469001
004700     05  PC-ACTUAL-RSLT               PIC X(36)  VALUE            00470001
004800         'ACTUAL RESULTS (IN THOUSANDS)       '.                  00480001
004900     05  PC-PERCENT-SIGN              PIC X(01)  VALUE '%'.       00490001
004910     05  PC-DOLLAR-SIGN               PIC X(01)  VALUE '$'.       00491001
004920     05  PC-FRONT-PAR                 PIC X(01)  VALUE '('.       00492001
004930     05  PC-BACK-PAR                  PIC X(01)  VALUE ')'.       00493001
004940     05  PC-ONE-LINE                  PIC S9(04) VALUE +1 COMP.   00494001
004950     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            00495001
004960                                                 'PMKRP110'.      00496020
004970     05  PC-COLON                     PIC X(01)  VALUE ':'.       00497001
004980     05  PC-DASH                      PIC X(01)  VALUE '-'.       00498001
004990     05  PC-ALL-DAY                   PIC X(07)  VALUE            00499001
005000                                                 'ALL DAY'.       00500001
005100     05  PC-TOTAL                     PIC X(05)  VALUE            00510001
005200          'TOTAL'.                                                00520001
005300     05  PC-UNADVERTISED              PIC X(04)  VALUE            00530001
005400          'UNAD'.                                                 00540001
005410     05  PC-ADVERTISED                PIC X(03)  VALUE            00541004
005420          'ADV'.                                                  00542004
PGNBR      05  PC-ADVNOPAGE                 PIC X(04)  VALUE            00543039
PGNBR           'NOPG'.                                                 00544039
005500     05  PC-PROMO-TOTAL               PIC X(18)  VALUE            00550001
005600          'PROMOTION TOTAL   '.                                   00560001
005700     05  PC-DMM-TOTAL                 PIC X(18)  VALUE            00570004
005800          'DMM TOTAL         '.                                   00580004
006300                                                                  00630001
006400*----------------------------------------------------------       00640001
006500* PS- PROGRAM SWITCHES                                            00650001
006600*----------------------------------------------------------       00660001
006700 01  PS-PROGRAM-SWITCHES.                                         00670001
006800     05  PS-EOF-SLS-RSLTS-SW          PIC X(01)  VALUE 'Y'.       00680005
006900         88  PS-EOF-SLS-RSLTS                    VALUE 'N'.       00690005
007000         88  PS-NOT-EOF-SLS-RSLT                 VALUE 'Y'.       00700005
007400     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       00740001
007500         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       00750001
007600         88  PS-FIRST-TIME                       VALUE 'Y'.       00760001
007700     05  PS-FIRST-TIME-DMM-SW         PIC X(01)  VALUE 'Y'.       00770001
007800         88  PS-NOT-FIRST-TIME-DMM               VALUE 'N'.       00780001
007900         88  PS-FIRST-TIME-DMM                   VALUE 'Y'.       00790001
008000     05  PS-GMA-RESULTS-SW            PIC X(01)  VALUE 'Y'.       00800001
008100         88  PS-DMA-RESULTS                      VALUE 'N'.       00810001
008200         88  PS-GMA-RESULTS                      VALUE 'Y'.       00820001
008300     05  PS-GMA-NBR-FOUND-SW          PIC X(01)  VALUE 'Y'.       00830001
008400         88  PS-GMA-NBR-FOUND                    VALUE 'N'.       00840001
008500         88  PS-GMA-NBR-NOT-FOUND                VALUE 'Y'.       00850001
008600     05  PS-FIRST-LINE-SW             PIC X(01)  VALUE 'Y'.       00860004
008700         88  PS-FIRST-LINE                       VALUE 'N'.       00870005
008800         88  PS-NO-FIRST-LINE                    VALUE 'Y'.       00880004
008810     05  PS-WROTE-ADV-TTL-SW          PIC X(01)  VALUE 'Y'.       00881011
008820         88  PS-WROTE-ADV-TTL                    VALUE 'N'.       00882011
008830         88  PS-NO-WROTE-ADV-TTL                 VALUE 'Y'.       00883011
008900                                                                  00890001
009000*----------------------------------------------------------       00900001
009100* PV- PROGRAM VARIABLES                                           00910001
009200*----------------------------------------------------------       00920001
009300 01  PV-PROGRAM-VARIABLES.                                        00930001
009400     05  PV-ADVANCE-LINES             PIC S9(04) VALUE +1 COMP.   00940001
009500     05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   00950001
009600     05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         00960001
009700     05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACE.     00970001
009800     05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    00980001
009900     05  PV-OPERATION-MSG-2           PIC X(40)  VALUE SPACES.    00990001
010000     05  PV-SAVE-VAR                  PIC X(40)  VALUE SPACES.    01000001
010100     05  PV-SAVE-NUM                  PIC 9(02)  VALUE 0.         01010001
010200     05  PV-SAVE-LENGTH               PIC 9(02)  VALUE 0.         01020001
010300     05  PV-SUBSCRIPT                 PIC 9(02)  VALUE 0.         01030001
010400     05  PV-PROMO-NM-LENGTH           PIC 9(02)  VALUE 0.         01040001
010500     05  PV-AD-EVNT-NM-LENGTH         PIC 9(02)  VALUE 0.         01050001
010600     05  PV-AD-EVNT-NBR-LENGTH        PIC 9(02)  VALUE 0.         01060001
010700     05  PV-GMM-LAST-NM-LENGTH        PIC 9(02)  VALUE 0.         01070001
010800     05  PV-SAVE-GMA-NAME             PIC X(40)  VALUE SPACES.    01080001
010900     05  PV-LAST-DMA-LAST-NM          PIC X(40)  VALUE SPACES.    01090001
011000     05  PV-SAVE-AD-EVNT-ID           PIC 9(10)  VALUE 0.         01100001
011100     05  PV-SAVE-PROMO-ID             PIC 9(10)  VALUE 0.         01110001
011200     05  PV-LAST-GMA-NBR              PIC 9(04)  VALUE 0.         01120001
011300     05  PV-LAST-DMA-NBR              PIC 9(04)  VALUE 0.         01130001
011310     05  PV-LAST-BUYER-NBR            PIC 9(04)  VALUE 0.         01131005
011400     05  PV-DMM-TITLE.                                            01140001
011500         10  PV-DMM-TOTAL-TITLE       PIC X(14)  VALUE SPACES.    01150001
011600         10  PV-DMM-LAST-NAME         PIC X(40)  VALUE SPACES.    01160001
011700                                                                  01170001
011800     05  PV-TIER-ITM-DESC.                                        01180001
011900         10  FILLER                   PIC X(01)  VALUE SPACES.    01190001
012000         10  PV-TIER-ITM-DESC-1       PIC X(39)  VALUE SPACES.    01200001
012100     05  PV-THRS-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01210001
012200     05  PV-THRS-AMT-NUM-X REDEFINES                              01220001
012300         PV-THRS-AMT-NUM              PIC 9(10).                  01230001
012400     05  PV-DISC-PCT-NUM              PIC 9(03)V9(03) VALUE 0.    01240001
012500     05  PV-DISC-PCT-NUM-X REDEFINES                              01250001
012600         PV-DISC-PCT-NUM              PIC 9(06).                  01260001
012700     05  PV-DISC-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01270001
012800     05  PV-DISC-AMT-NUM-X REDEFINES                              01280001
012900         PV-DISC-AMT-NUM              PIC 9(10).                  01290001
013000     05  PV-SAVE-THRS-AMT.                                        01300001
013100         10  PV-SAVE-THRS-AMT-1       PIC 9(08)  VALUE 0.         01310001
013200         10  PV-SAVE-THRS-AMT-2       PIC 9(02)  VALUE 0.         01320001
013300     05  PV-SAVE-DISC-PCT.                                        01330001
013400         10  PV-SAVE-DISC-PCT-1       PIC 9(03)  VALUE 0.         01340001
013500         10  PV-SAVE-DISC-PCT-2       PIC 9(03)  VALUE 0.         01350001
013600     05  PV-SAVE-DISC-AMT.                                        01360001
013700         10  PV-SAVE-DISC-AMT-1       PIC 9(08)  VALUE 0.         01370001
013800         10  PV-SAVE-DISC-AMT-2       PIC 9(02)  VALUE 0.         01380001
013900     05  PV-THRS-AMT-CHAR             PIC X(08)  VALUE SPACES.    01390001
014000     05  PV-DISC-PCT-CHAR             PIC X(03)  VALUE SPACES.    01400001
014100     05  PV-DISC-AMT-CHAR             PIC X(08)  VALUE SPACES.    01410001
014200     05  PV-THRS-QTY-CHAR             PIC X(05)  VALUE SPACES.    01420001
014300     05  PV-POINTER-FIELD             PIC S9(03) VALUE +0.        01430001
014400     05  PV-LAST-ADEVNT-ID            PIC 9(10)  VALUE 0.         01440001
014500     05  PV-LAST-PROMO-ID             PIC 9(10)  VALUE 0.         01450001
014600     05  PV-TIER-PRICG-ID             PIC 9(10)  VALUE 0.         01460001
014700     05  PV-AD-PG-NBR                 PIC 9(03)  VALUE 0.         01470001
014800     05  PV-ROUND-TO-WHOLE-DOLLARS    PIC S9(09) VALUE +0.        01480001
014900     05  PV-ROUND-TO-TENTHS           PIC S9(09)V9 VALUE +0.      01490001
014910     05  PV-ROUND-TO-HDRTHS           PIC S9(09)V99 VALUE +0.     01491027
015000     05  PV-ROUND-VOL-PCT             PIC 9(09)V9 VALUE 0.        01500001
015100     05  PV-TRUNCAT-VOL-PCT           PIC 9(04)V9 VALUE 0.        01510024
015200     05  PV-TRUNCAT-VOL-PCT-X REDEFINES                           01520001
015300         PV-TRUNCAT-VOL-PCT           PIC 9(05).                  01530024
015400     05  PV-NUM-VOL-PCT.                                          01540001
015500         10  PV-NUM-VOL-PCT-1         PIC 9(04)  VALUE 0.         01550024
015600         10  PV-NUM-VOL-PCT-2         PIC 9(01)  VALUE 0.         01560001
015700     05  PV-CHAR-VOL-PCT REDEFINES                                01570001
015800         PV-NUM-VOL-PCT.                                          01580001
015900         10  PV-CHAR-VOL-PCT-1        PIC X(04).                  01590024
016000         10  PV-CHAR-VOL-PCT-2        PIC X(01).                  01600001
016100     05  PV-FINAL-VOL-PCT.                                        01610001
016110         10  PV-FINAL-VOL-PCT-1       PIC X(01)  VALUE SPACES.    01611024
016200         10  PV-FINAL-VOL-PCT-2       PIC X(01)  VALUE SPACES.    01620024
016300         10  PV-FINAL-VOL-PCT-3       PIC X(01)  VALUE SPACES.    01630024
016400         10  PV-FINAL-VOL-PCT-4       PIC X(01)  VALUE SPACES.    01640024
016500         10  PV-FINAL-VOL-PCT-5       PIC X(01)  VALUE SPACES.    01650024
016600         10  FILLER                   PIC X(01)  VALUE '.'.       01660001
016700         10  PV-FINAL-VOL-PCT-6       PIC X(01)  VALUE SPACES.    01670024
016800         10  PV-FINAL-VOL-PCT-7       PIC X(01)  VALUE SPACES.    01680024
016900     05  PV-SEP-VOL-PCT.                                          01690001
016910         10  PV-SEP-VOL-PCT-1         PIC 9(01)  VALUE 0.         01691024
017000         10  PV-SEP-VOL-PCT-2         PIC 9(01)  VALUE 0.         01700024
017100         10  PV-SEP-VOL-PCT-3         PIC 9(01)  VALUE 0.         01710024
017200         10  PV-SEP-VOL-PCT-4         PIC 9(01)  VALUE 0.         01720024
017300         10  PV-SEP-VOL-PCT-5         PIC 9(01)  VALUE 0.         01730024
017400     05  PV-VOL-PCT-CHG               PIC S9(09)V9999 VALUE +0    01740001
017500                                                     COMP-3.      01750001
017600     05  PV-MU-PCT                    PIC S9(09)V9999 VALUE +0    01760001
017700                                                     COMP-3.      01770001
017800     05  PV-SELL-THRU-PCT             PIC S9(09)V9999 VALUE +0    01780001
017900                                                     COMP-3.      01790001
018000     05  PV-RPT-LINE                  PIC X(200) VALUE SPACES.    01800001
018100     05  PV-SAVE-RECORD               PIC X(750) VALUE SPACES.    01810001
018110     05  PV-PROMO-STRT-TMST.                                      01811001
018120         10  PV-PROMO-STRT-DTE.                                   01812001
018130             15  PV-PM-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    01813001
018140             15  PV-PM-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    01814001
018150             15  FILLER               PIC X(01)  VALUE SPACES.    01815001
018160             15  PV-PM-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    01816001
018170             15  FILLER               PIC X(01)  VALUE SPACES.    01817001
018180             15  PV-PM-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    01818001
018190         10  FILLER                   PIC X(01)  VALUE SPACES.    01819001
018200         10  PV-PROMO-STRT-TM.                                    01820001
018210             15  PV-PM-STRT-TM-HH     PIC X(02)  VALUE SPACES.    01821001
018220             15  FILLER               PIC X(01)  VALUE SPACES.    01822001
018230             15  PV-PM-STRT-TM-MM     PIC X(02)  VALUE SPACES.    01823001
018240             15  FILLER               PIC X(01)  VALUE SPACES.    01824001
018250             15  PV-PM-STRT-TM-SS     PIC X(02)  VALUE SPACES.    01825001
018260                                                                  01826001
018270     05  PV-PROMO-END-TMST.                                       01827001
018280         10  PV-PROMO-END-DTE.                                    01828001
018290             15  PV-PM-END-DTE-CC     PIC X(02)  VALUE SPACES.    01829001
018300             15  PV-PM-END-DTE-YY     PIC X(02)  VALUE SPACES.    01830001
018400             15  FILLER               PIC X(01)  VALUE SPACES.    01840001
018500             15  PV-PM-END-DTE-MM     PIC X(02)  VALUE SPACES.    01850001
018600             15  FILLER               PIC X(01)  VALUE SPACES.    01860001
018700             15  PV-PM-END-DTE-DD     PIC X(02)  VALUE SPACES.    01870001
018800         10  FILLER                   PIC X(01)  VALUE SPACES.    01880001
018900         10  PV-PROMO-END-TM.                                     01890001
019000             15  PV-PM-END-TM-HH      PIC X(02)  VALUE SPACES.    01900001
019100             15  FILLER               PIC X(01)  VALUE SPACES.    01910001
019200             15  PV-PM-END-TM-MM      PIC X(02)  VALUE SPACES.    01920001
019300             15  FILLER               PIC X(01)  VALUE SPACES.    01930001
019400             15  PV-PM-END-TM-SS      PIC X(02)  VALUE SPACES.    01940001
019500                                                                  01950001
019600     05  PV-PROMO-ITM-STRT-TMST.                                  01960001
019700         10  PV-PROMO-ITM-STRT-DTE.                               01970001
019800             15  PV-PI-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    01980001
019900             15  PV-PI-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    01990001
020000             15  FILLER               PIC X(01)  VALUE SPACES.    02000001
020100             15  PV-PI-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02010001
020200             15  FILLER               PIC X(01)  VALUE SPACES.    02020001
020300             15  PV-PI-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02030001
020400         10  FILLER                   PIC X(01)  VALUE SPACES.    02040001
020500         10  PV-PROMO-ITM-STRT-TM.                                02050001
020600             15  PV-PI-STRT-TM-HH     PIC X(02)  VALUE SPACES.    02060001
020700             15  FILLER               PIC X(01)  VALUE SPACES.    02070001
020800             15  PV-PI-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02080001
020900             15  FILLER               PIC X(01)  VALUE SPACES.    02090001
021000             15  PV-PI-STRT-TM-SS     PIC X(02)  VALUE SPACES.    02100001
021100                                                                  02110001
021200     05  PV-PROMO-ITM-END-TMST.                                   02120001
021300         10  PV-PROMO-ITM-END-DTE.                                02130001
021400             15  PV-PI-END-DTE-CC     PIC X(02)  VALUE SPACES.    02140001
021500             15  PV-PI-END-DTE-YY     PIC X(02)  VALUE SPACES.    02150001
021600             15  FILLER               PIC X(01)  VALUE SPACES.    02160001
021700             15  PV-PI-END-DTE-MM     PIC X(02)  VALUE SPACES.    02170001
021800             15  FILLER               PIC X(01)  VALUE SPACES.    02180001
021900             15  PV-PI-END-DTE-DD     PIC X(02)  VALUE SPACES.    02190001
022000         10  FILLER                   PIC X(01)  VALUE SPACES.    02200001
022010         10  PV-PROMO-ITM-END-TM.                                 02201001
022020             15  PV-PI-END-TM-HH      PIC X(02)  VALUE SPACES.    02202001
022030             15  FILLER               PIC X(01)  VALUE SPACES.    02203001
022040             15  PV-PI-END-TM-MM      PIC X(02)  VALUE SPACES.    02204001
022050             15  FILLER               PIC X(01)  VALUE SPACES.    02205001
022060             15  PV-PI-END-TM-SS      PIC X(02)  VALUE SPACES.    02206001
022070                                                                  02207001
022080     05  PV-PM-ITM-EFF-STRT-DTE.                                  02208001
022090         10  PV-EFF-STRT-DTE-MM       PIC X(02)  VALUE SPACES.    02209001
022091         10  FILLER                   PIC X(01)  VALUE '/'.       02209101
022092         10  PV-EFF-STRT-DTE-DD       PIC X(02)  VALUE SPACES.    02209201
022093         10  FILLER                   PIC X(01)  VALUE '/'.       02209301
022094         10  PV-EFF-STRT-DTE-YY       PIC X(02)  VALUE SPACES.    02209401
022095                                                                  02209501
022096     05  PV-PM-ITM-EFF-END-DTE.                                   02209601
022097         10  PV-EFF-END-DTE-MM        PIC X(02)  VALUE SPACES.    02209701
022098         10  FILLER                   PIC X(01)  VALUE '/'.       02209801
022099         10  PV-EFF-END-DTE-DD        PIC X(02)  VALUE SPACES.    02209901
022100         10  FILLER                   PIC X(01)  VALUE '/'.       02210001
022101         10  PV-EFF-END-DTE-YY        PIC X(02)  VALUE SPACES.    02210101
022102                                                                  02210201
022103     05  PV-EFF-DTE-LAYOUT.                                       02210301
022104         10  FILLER                   PIC X(02)  VALUE SPACES.    02210401
022105         10  PV-OPEN-PARENTH          PIC X(01)  VALUE SPACES.    02210501
022106         10  PV-EFF-STRT-DTE          PIC X(08)  VALUE SPACES.    02210601
022107         10  PV-DTE-DASH              PIC X(01)  VALUE SPACES.    02210701
022108         10  PV-EFF-END-DTE           PIC X(08)  VALUE SPACES.    02210801
022109         10  PV-CLOSE-PARENTH         PIC X(01)  VALUE SPACES.    02210901
022110                                                                  02211001
022120     05  PV-VARIABLE-OUTPUT-FIELD.                                02212001
022121         10  PV-BIT-VARIABLE          PIC X(01)  VALUE SPACES     02212101
022122                                       OCCURS 41 TIMES            02212201
022123                                       INDEXED BY                 02212301
022124                                       PV-BIT-IDX.                02212401
022125                                                                  02212501
022126     05  PV-HEADER-DTE-TM.                                        02212601
022127         10  PV-BEG-DAY-ALPHA         PIC X(10).                  02212701
022128         10  PV-BEG-DATE              PIC X(08).                  02212801
022129         10  FILLER                   PIC X(02)  VALUE SPACES.    02212901
022130         10  PV-BEG-TIME.                                         02213001
022131             15  PV-BEG-HR-TIME       PIC 9(02).                  02213101
022132             15  PV-BEG-TIME-COLON    PIC X(01).                  02213201
022133             15  PV-BEG-MIN-TIME      PIC 9(02).                  02213301
022134             15  FILLER               PIC X(02)  VALUE SPACES.    02213401
022135         10  FILLER                   PIC X(11)  VALUE            02213501
022136                                      '   THROUGH '.              02213601
022137         10  PV-END-DAY-ALPHA         PIC X(10).                  02213701
022138         10  PV-END-DATE              PIC X(08).                  02213801
022139         10  FILLER                   PIC X(02)  VALUE SPACES.    02213901
022140         10  PV-END-TIME.                                         02214001
022141             15  PV-END-HR-TIME       PIC 9(02).                  02214101
022142             15  PV-END-TIME-COLON    PIC X(01).                  02214201
022143             15  PV-END-MIN-TIME      PIC 9(02).                  02214301
022144             15  FILLER               PIC X(02).                  02214401
022145         10  FILLER                   PIC X(22)  VALUE SPACES.    02214501
022146                                                                  02214601
022147*----------------------------------------------------------       02214701
022148* PA- PROGRAM ACCUMULATORS                                        02214801
022149*----------------------------------------------------------       02214901
022150 01  PA-PROGRAM-ACCUMULATORS.                                     02215001
022151     05  PA-CNT-ADV-TOT               PIC 9(09)  VALUE ZEROES.    02215101
022152     05  PA-CNT-UNADV-TOT             PIC 9(09)  VALUE ZEROES.    02215201
PGNBR      05  PA-CNT-ADVNP-TOT             PIC 9(09)  VALUE ZEROES.    02215339
022153     05  PA-CNT-SPACES-1              PIC 9(09)  VALUE ZEROES.    02215439
022154     05  PA-CNT-POS-1                 PIC 9(09)  VALUE ZEROES.    02215539
022155     05  PA-CNT-SPACES-2              PIC 9(09)  VALUE ZEROES.    02215639
022156     05  PA-CNT-SPACES                PIC 9(09)  VALUE ZEROES.    02215739
022157     05  PA-CNT-POS-2                 PIC 9(09)  VALUE ZEROES.    02215839
022158     05  PA-CNT-GMA                   PIC S9(04) VALUE +0.        02215939
022159     05  PA-HOLD-INDEX                PIC S9(04) VALUE +0.        02216039
022160     05  PA-CNT-NEW-INDX              PIC S9(04) VALUE +0.        02216139
022170                                                                  02217001
022180*----------------------------------------------------------       02218001
022190* TBL- TABLE VARIABLES                                            02219001
022200*----------------------------------------------------------       02220001
022300* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02230001
022400*    OCCURRENCE CONTAINS FORECAST FIGURES                         02240001
022500 01  TBL-SECT-TOTAL-TABLE.                                        02250001
022600     05  TBL-STOT-LINE-01 OCCURS 02 TIMES                         02260001
022700                           INDEXED BY TBL-STOT-INDX.              02270001
022800         10  TBL-STOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    02280001
022900         10  TBL-STOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    02290001
023000         10  TBL-STOT-TOT-SLS-UNT-QTY                             02300001
023100                                      PIC S9(09)V9(02) COMP-3.    02310001
023200         10  TBL-STOT-TOT-EOH-INV-QTY                             02320001
023300                                      PIC S9(09)V9(02) COMP-3.    02330001
023400         10  TBL-STOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    02340001
023500         10  TBL-STOT-TOT-SLS-COST-AMT                            02350001
023600                                      PIC S9(09)V9(02) COMP-3.    02360001
023700                                                                  02370001
023710* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02371004
023720*    OCCURRENCE CONTAINS FORECAST FIGURES                         02372004
023730 01  TBL-ADV-TOTAL-TABLE.                                         02373004
023740     05  TBL-ATOT-LINE-01 OCCURS 02 TIMES                         02374004
023750                           INDEXED BY TBL-STOT-INDX.              02375004
023760         10  TBL-ATOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    02376004
023770         10  TBL-ATOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    02377004
023780         10  TBL-ATOT-TOT-SLS-UNT-QTY                             02378004
023790                                      PIC S9(09)V9(02) COMP-3.    02379004
023791         10  TBL-ATOT-TOT-EOH-INV-QTY                             02379104
023792                                      PIC S9(09)V9(02) COMP-3.    02379204
023793         10  TBL-ATOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    02379304
023794         10  TBL-ATOT-TOT-SLS-COST-AMT                            02379404
023795                                      PIC S9(09)V9(02) COMP-3.    02379504
023796                                                                  02379604
023797* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02381239
023798*    OCCURRENCE CONTAINS FORECAST FIGURES                         02381339
023799 01  TBL-UNAD-TOTAL-TABLE.                                        02381439
023800     05  TBL-UATOT-LINE-01 OCCURS 02 TIMES                        02381539
023801                           INDEXED BY TBL-STOT-INDX.              02381639
023802         10  TBL-UATOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    02381739
023803         10  TBL-UATOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    02381839
023804         10  TBL-UATOT-TOT-SLS-UNT-QTY                            02381939
023805                                      PIC S9(09)V9(02) COMP-3.    02382039
023806         10  TBL-UATOT-TOT-EOH-INV-QTY                            02382139
023807                                      PIC S9(09)V9(02) COMP-3.    02382239
023808         10  TBL-UATOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    02382339
023809         10  TBL-UATOT-TOT-SLS-COST-AMT                           02382439
023810                                      PIC S9(09)V9(02) COMP-3.    02382539
023811                                                                  02382639
023820* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02383039
023900*    OCCURRENCE CONTAINS FORECAST FIGURES                         02390001
024000 01  TBL-PROMO-TOTAL-TABLE.                                       02400001
024100     05  TBL-PMTOT-LINE-01 OCCURS 02 TIMES                        02410001
024200                          INDEXED BY TBL-PMTOT-INDX.              02420001
024300         10  TBL-PMTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    02430001
024400         10  TBL-PMTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    02440001
024500         10  TBL-PMTOT-TOT-SLS-UNT-QTY                            02450001
024600                                      PIC S9(09)V9(02) COMP-3.    02460001
024700         10  TBL-PMTOT-TOT-EOH-INV-QTY                            02470001
024800                                      PIC S9(09)V9(02) COMP-3.    02480001
024900         10  TBL-PMTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    02490001
025000         10  TBL-PMTOT-TOT-SLS-COST-AMT                           02500001
025100                                      PIC S9(09)V9(02) COMP-3.    02510001
025294                                                                  02529401
025295*----------------------------------------------------------       02529501
025296* ABEND- ABEND VARIABLES                                          02529601
025297*----------------------------------------------------------       02529701
025298 01  ABEND-CODE                       PIC S9(04) VALUE +0 COMP.   02529801
025299     88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     02529901
025300     88  ABEND-4002-READ-ERROR                   VALUE +4002.     02530001
025400     88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     02540001
025500     88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     02550001
025600     88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     02560001
025700     88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     02570001
025800     88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     02580001
025900     88  ABEND-4008-DATA-ERROR                   VALUE +4008.     02590001
026000     88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     02600001
026300     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     02630001
026400     88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     02640001
026500     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     02650001
026600                                                                  02660001
026700 01  END-OF-REPORT-LINE.                                          02670001
026800     05  FILLER                       PIC X(25)  VALUE            02680001
026900         ' ** END OF REPORT **     '.                             02690001
027000                                                                  02700001
027100*----------------------------------------------------------       02710001
027200* HD- HEADER INFO                                                 02720001
027300*----------------------------------------------------------       02730001
027310 01  HEADER-01.                                                   02731003
027320     05  FILLER                       PIC X(01)  VALUE SPACES.    02732003
027330     05  FILLER                       PIC X(10)  VALUE            02733036
027340                                      'DMM      :'.               02734036
027341     05  FILLER                       PIC X(01)  VALUE SPACES.    02734103
027342     05  HDR-01-DMM-NBR               PIC 9(04)  VALUE 0.         02734203
027343     05  FILLER                       PIC X(01)  VALUE SPACES.    02734303
027344     05  HDR-01-DMM-LAST-NM           PIC X(40)  VALUE SPACES.    02734403
027345     05  FILLER                       PIC X(143) VALUE SPACES.    02734536
027346                                                                  02734603
027347 01  HEADER-02.                                                   02734703
027348     05  FILLER                       PIC X(01)  VALUE SPACES.    02734803
027349     05  FILLER                       PIC X(10)  VALUE            02734936
027350                                      'GMM      :'.               02735036
027360     05  FILLER                       PIC X(01)  VALUE SPACES.    02736003
027370     05  HDR-02-GMM-NBR               PIC 9(04)  VALUE 0.         02737003
027380     05  FILLER                       PIC X(01)  VALUE SPACES.    02738003
027390     05  HDR-02-GMM-LAST-NM           PIC X(40)  VALUE SPACES.    02739003
027391     05  FILLER                       PIC X(143) VALUE SPACES.    02739136
027392                                                                  02739203
027400 01  HEADER-03.                                                   02740003
027500     05  FILLER                       PIC X(63) VALUE SPACES.     02750001
027600     05  FILLER                       PIC X(43) VALUE             02760003
027700         'PROMOTION SUMMARY - BY BUYER, BY AD PAGE - '.           02770003
027800     05  HDR-03-TITLE                 PIC X(36)  VALUE SPACES.    02780025
027900     05  FILLER                       PIC X(58) VALUE SPACES.     02790025
028000                                                                  02800001
028100 01  HEADER-04.                                                   02810003
028200     05  FILLER                       PIC X(12)  VALUE            02820034
028300                                      ' AD EVENT : '.             02830034
028400     05  HDR-04-ADEVNT-STRING         PIC X(188) VALUE SPACES.    02840034
028500                                                                  02850001
028600 01  HEADER-05.                                                   02860003
028700     05  FILLER                       PIC X(12)  VALUE            02870001
028800                                      ' PROMOTION: '.             02880001
028900     05  HDR-05-PROMO-STRING          PIC X(188) VALUE SPACES.    02890003
029000                                                                  02900001
029100 01  HEADER-06.                                                   02910003
029200     05  FILLER                       PIC X(45)  VALUE            02920001
029300         '  AD                                         '.         02930001
029400     05  FILLER                       PIC X(45)  VALUE            02940001
029500         '                    SALES VOLUME         VOL '.         02950026
029600     05  FILLER                       PIC X(45)  VALUE            02960001
029700         '%             MARKDOWN $                UNITS'.         02970026
029800     05  FILLER                       PIC X(45)  VALUE            02980001
029900         ' SOLD        SELL              PREP UNITS    '.         02990026
030000     05  FILLER                       PIC X(20)  VALUE            03000026
030100         '        MARKUP %    '.                                  03010026
030200                                                                  03020001
030300 01  HEADER-07.                                                   03030003
030400     05  FILLER                       PIC X(45)  VALUE            03040001
030500         ' PAGE    BUYER LAST NAME                     '.         03050003
030600     05  FILLER                       PIC X(45)  VALUE            03060001
030700         '                  ACT         FCST       CHG '.         03070028
030800     05  FILLER                       PIC X(45)  VALUE            03080001
030900         '           ACT         FCST          ACT     '.         03090028
031000     05  FILLER                       PIC X(45)  VALUE            03100001
031100         '    FCST    THRU %          ACT         FCST '.         03110028
031200     05  FILLER                       PIC X(20)  VALUE            03120001
031210         '     ACT      FCST  '.                                  03121028
031220                                                                  03122001
031230                                                                  03123001
031240*----------------------------------------------------------       03124001
031250* DTL- DETAIL INFO                                                03125001
031260*----------------------------------------------------------       03126001
031270 01  DETAIL-HEADER-01.                                            03127001
031280     05  FILLER                       PIC X(01)  VALUE SPACES.    03128001
031290     05  FILLER                       PIC X(06)  VALUE 'GMM - '.  03129001
031300     05  DTL-HDR-01-GMM-NAME          PIC X(40)  VALUE SPACES.    03130001
031400     05  FILLER                       PIC X(153) VALUE SPACES.    03140001
031500                                                                  03150001
031600 01  DETAIL-HEADER-02.                                            03160001
031700     05  FILLER                       PIC  X(50)     VALUE        03170001
031800         '--------------------------------------------------'.    03180001
031900     05  FILLER                       PIC  X(50)     VALUE        03190001
032000         '--------------------------------------------------'.    03200001
032100     05  FILLER                       PIC  X(50)     VALUE        03210001
032200         '--------------------------------------------------'.    03220001
032300     05  FILLER                       PIC  X(50)     VALUE        03230001
032400         '--------------------------------------------------'.    03240001
032500                                                                  03250001
032600 01  DETAIL-VARIABLE.                                             03260001
032700     05  FILLER                       PIC X(01)  VALUE SPACES.    03270001
032800     05  DTL-VAR-VOL-PCT-CHG          PIC ZZZ9.9.                 03280034
032810     05  DTL-VAR-VOL-PCT-CHG1 REDEFINES                           03281034
032820         DTL-VAR-VOL-PCT-CHG          PIC ZZZZ.Z.                 03282034
032900     05  FILLER                       PIC X(01)  VALUE SPACES.    03290001
033000                                                                  03300001
033100 01  DETAIL-01.                                                   03310001
033200     05  FILLER                       PIC X(01)  VALUE SPACES.    03320001
033300     05  DTL-01-AD-PG-NBR.                                        03330001
033400         10  DTL-01-PM-AD-PG-NBR      PIC ZZZ.                    03340001
033500         10  FILLER                   PIC X(05).                  03350001
033600         10  DTL-01-GMA-LAST-NM       PIC X(43).                  03360001
PGNBR      05  DTL-01-ADV-NOPG  REDEFINES                               03370039
PGNBR          DTL-01-AD-PG-NBR.                                        03380039
PGNBR          10  DTL-01-NOPG-TITLE        PIC X(04).                  03390039
PGNBR          10  FILLER                   PIC X(04).                  03400039
PGNBR          10  DTL-01-ADV-GMA-LAST-NM   PIC X(43).                  03410039
033700     05  DTL-01-NEW-TITLE REDEFINES                               03411039
033800         DTL-01-AD-PG-NBR.                                        03412039
033900         10  DTL-01-UNAD-TITLE        PIC X(04).                  03413039
034000         10  FILLER                   PIC X(04).                  03414039
034100         10  DTL-01-TTL-GMA-LAST-NM   PIC X(43).                  03415039
034200     05  FILLER                       PIC X(04)  VALUE SPACES.    03420026
034300     05  DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZ9.99.             03430034
034310     05  DTL-01-ACTL-SLS-RTL-AMT1 REDEFINES                       03431034
034320         DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03432034
034400     05  FILLER                       PIC X(03)  VALUE SPACES.    03440026
034500     05  DTL-01-FCST-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03450026
034600     05  FILLER                       PIC X(03)  VALUE SPACES.    03460024
034700     05  DTL-01-VOL-PCT-CHG           PIC X(08)  VALUE SPACES.    03470024
034800     05  DTL-01-VOL-PCT-SIGN          PIC X(01)  VALUE SPACES.    03480001
034900     05  FILLER                       PIC X(03)  VALUE SPACES.    03490026
034910     05  DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZ9.99.             03491034
034911     05  DTL-01-ACTL-MD-AMT1 REDEFINES                            03491134
034912         DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZZ.ZZ.             03491234
034920     05  FILLER                       PIC X(03)  VALUE SPACES.    03492026
034930     05  DTL-01-FCST-MD-AMT           PIC ZZZ,ZZZ.ZZ.             03493026
034940     05  FILLER                       PIC X(03)  VALUE SPACES.    03494026
034950     05  DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZ9.99.             03495034
034951     05  DTL-01-ACTL-UNT-SLD-QTY1 REDEFINES                       03495134
034952         DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03495234
034960     05  FILLER                       PIC X(03)  VALUE SPACES.    03496026
034970     05  DTL-01-FCST-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03497026
034980     05  FILLER                       PIC X(04)  VALUE SPACES.    03498001
034990     05  DTL-01-SELL-THRU-PCT         PIC ZZ9.9.                  03499034
034991     05  DTL-01-SELL-THRU-PCT1 REDEFINES                          03499134
034992         DTL-01-SELL-THRU-PCT         PIC ZZZ.Z.                  03499234
035000     05  DTL-01-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03500035
035100     05  FILLER                       PIC X(03)  VALUE SPACES.    03510026
035200     05  DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZ9.99.             03520034
035210     05  DTL-01-ACTL-PREP-UNT-QTY1 REDEFINES                      03521034
035220         DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03522034
035300     05  FILLER                       PIC X(03)  VALUE SPACES.    03530026
035400     05  DTL-01-FCST-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03540026
035500     05  FILLER                       PIC X(04)  VALUE SPACES.    03550001
035600     05  DTL-01-ACTL-MU-PCT           PIC ZZ9.9.                  03560034
035610     05  DTL-01-ACTL-MU-PCT1 REDEFINES                            03561034
035620         DTL-01-ACTL-MU-PCT           PIC ZZZ.Z.                  03562034
035700     05  DTL-01-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03570001
035800     05  FILLER                       PIC X(04)  VALUE SPACES.    03580001
035900     05  DTL-01-FCST-MU-PCT           PIC ZZ9.9.                  03590034
035910     05  DTL-01-FCST-MU-PCT1 REDEFINES                            03591034
035920         DTL-01-FCST-MU-PCT           PIC ZZZ.Z.                  03592034
036000     05  DTL-01-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    03600001
036100     05  FILLER                       PIC X(01)  VALUE SPACES.    03610026
036200                                                                  03620001
036800*----------------------------------------------------------       03680001
036900* COPYBOOK FOR THE PROMO ITEM SUMMARY EXTRACT - INPUT             03690001
037000*----------------------------------------------------------       03700001
037100     COPY PMRD100.                                                03710001
037200                                                                  03720001
037300*----------------------------------------------------------       03730001
037400*  DATE VALIDATION CALLING PARAMETER LIST                         03740001
037500*----------------------------------------------------------       03750001
037600     COPY DPWS500.                                                03760001
037700                                                                  03770001
037800*----------------------------------------------------------       03780001
037900*  STANDARD HEADER LINE - KOHLS 200 COL                           03790001
038000*----------------------------------------------------------       03800001
038100     COPY DPWS200O.                                               03810001
038110     EJECT                                                        03811001
038120                                                                  03812001
038130*----------------------------------------------------------       03813001
038131 PROCEDURE DIVISION.                                              03813101
038132*----------------------------------------------------------       03813201
038133 0000-MAINLINE.                                                   03813301
038134                                                                  03813401
038135     PERFORM 1000-INITIALIZATION.                                 03813501
038136                                                                  03813601
038137     PERFORM 2000-PROCESS-SALES-RESULTS                           03813705
038138             UNTIL PS-EOF-SLS-RSLTS.                              03813805
038139                                                                  03813901
038140     PERFORM 3000-END-OF-JOB-ROUTINE.                             03814001
038141                                                                  03814101
038142     GOBACK.                                                      03814201
038143                                                                  03814301
038144*0000-EXIT.                                                       03814401
038145 EJECT.                                                           03814501
038146                                                                  03814601
038147*----------------------------------------------------------       03814701
038148* 1000-INITIALIZATION.                                            03814801
038149*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      03814901
038150*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      03815001
038160*     PARAMETERS IT MAY NEED TO USE TO READ AND PROCESS           03816001
038170*     ANY OF THE RECORDS FROM THE INPUT FILE.                     03817001
038180*----------------------------------------------------------       03818001
038190 1000-INITIALIZATION.                                             03819001
038200                                                                  03820001
038300     INITIALIZE PM100-PROMO-ITM-SUMM                              03830001
038500                TBL-SECT-TOTAL-TABLE                              03850001
038600                TBL-ADV-TOTAL-TABLE                               03860005
038700                TBL-UNAD-TOTAL-TABLE                              03870005
038800                TBL-PROMO-TOTAL-TABLE.                            03880005
038900                                                                  03890001
039000     SET PS-FIRST-TIME TO TRUE.                                   03900001
039100     SET PS-NO-WROTE-ADV-TTL TO TRUE.                             03910011
039200                                                                  03920001
039300     OPEN INPUT PROMO-SUMM-BUY-FILE                               03930005
039600         OUTPUT PROMO-SUMM-REPORT.                                03960001
039700                                                                  03970001
039800     ACCEPT CD-CPU-DATE FROM DATE.                                03980001
039900     MOVE CD-CPU-YR                  TO CD-CPU-YY.                03990001
040000     MOVE CD-CPU-MO                  TO CD-CPU-MM.                04000001
040100     MOVE CD-CPU-DY                  TO CD-CPU-DD.                04010001
040200                                                                  04020001
040300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04030001
040400     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     04040001
040500     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     04050001
040600     SET DPG52-LK-DTE-GREG           TO TRUE.                     04060001
040700     MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      04070001
040710     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              04071001
040720                                     TO PV-OPERATION-MSG-1.       04072001
040721                                                                  04072101
040722     PERFORM 9100-CALENDAR-ROUTINE.                               04072201
040723                                                                  04072301
040724     MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          04072401
040725                                                                  04072501
040726     ACCEPT CT-CPU-TIME FROM TIME.                                04072601
040727     MOVE CT-CPU-HR                  TO DP200O-RUN-HOUR.          04072701
040728     MOVE CT-CPU-MIN                 TO DP200O-RUN-MINUTE.        04072801
040729     MOVE CD-CPU-MO                  TO DP200O-RUN-MONTH.         04072901
040730     MOVE CD-CPU-DY                  TO DP200O-RUN-DAY.           04073001
040740     MOVE CD-CPU-YR                  TO DP200O-RUN-YEAR.          04074001
040750     MOVE PC-CURRENT-PROGRAM-NAME    TO DP200O-PROGRAM-NAME.      04075001
040760                                                                  04076001
040790     PERFORM 8000-READ-SLS-GMA-RESULTS.                           04079001
040800                                                                  04080001
040900     IF PS-EOF-SLS-RSLTS                                          04090005
041000        DISPLAY 'NO PROMOTIONS TO REPORT ON'                      04100001
041100     ELSE                                                         04110001
041200        EVALUATE TRUE                                             04120001
041300          WHEN PM100-ACTUAL                                       04130001
041400               MOVE PC-ACTUAL-RSLT    TO HDR-03-TITLE             04140005
041500          WHEN PM100-FORECAST                                     04150001
041600               MOVE PC-FORECAST-RSLT  TO HDR-03-TITLE             04160005
041700          WHEN OTHER                                              04170001
041800               DISPLAY 'PM100-FCST-ACTUAL-IND: '                  04180001
041900                              PM100-FCST-ACTUAL-IND               04190001
042000               SET ABEND-4444-FORCED-ABEND TO TRUE                04200001
042100               MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    04210001
042200               MOVE 'NOT A VALID FORECAST/ACTUAL IND'             04220001
042300                                       TO PV-OPERATION-MSG-1      04230001
042400               PERFORM 9800-ABEND                                 04240001
042500        END-EVALUATE                                              04250001
042600     END-IF.                                                      04260001
042700                                                                  04270001
042800*1000-EXIT.                                                       04280001
042900 EJECT.                                                           04290001
043000                                                                  04300001
043100*----------------------------------------------------------       04310001
043200* 2000-PROCESS-SALES-RESULTS.                                     04320003
043300*     PROCESSES THE SALES RESULTS FILE AND CREATES A              04330001
043400*     A REPORT. THIS REPORT BREAKS BY AD EVENT/PROMOTION/         04340029
043410*     GMM/DMM. EACH PROMOTION/DMM WILL DISPLAY THEIR BUYER        04341029
043420*     TOTALS BY PAGE NUMBER/UNADVERTISED.                         04342029
043500*----------------------------------------------------------       04350001
043600 2000-PROCESS-SALES-RESULTS.                                      04360003
043700                                                                  04370001
043800     EVALUATE TRUE                                                04380001
043900       WHEN (PM100-AD-EVNT-ID IS NOT = PV-LAST-ADEVNT-ID)         04390001
044000         OR (PM100-PROMO-ID IS NOT = PV-LAST-PROMO-ID)            04400001
044010         OR (PM100-GMA-NBR IS NOT = PV-LAST-GMA-NBR)              04401006
044020         OR (PM100-DMA-NBR IS NOT = PV-LAST-DMA-NBR)              04402006
044100            IF PS-NOT-FIRST-TIME                                  04410001
044101               IF PS-NO-WROTE-ADV-TTL                             04410115
044102                  PERFORM 3100-PROCESS-ADVPG-TOTAL                04410215
044103               END-IF                                             04410415
044110               PERFORM 3110-PROCESS-BUYER-TOTAL                   04411004
044200               PERFORM 3120-PROCESS-ADV-TOTAL                     04420004
044400               PERFORM 3130-PROCESS-UNAD-TOTAL                    04441040
044500               PERFORM 3140-PROCESS-PROMO-TOTAL                   04450004
044600               INITIALIZE TBL-SECT-TOTAL-TABLE                    04460003
045480                          TBL-ADV-TOTAL-TABLE                     04548003
045490                          TBL-UNAD-TOTAL-TABLE                    04549140
045500                          TBL-PROMO-TOTAL-TABLE                   04550003
046000            END-IF                                                04600001
046100            MOVE PM100-AD-EVNT-ID TO PV-LAST-ADEVNT-ID            04610003
046110            MOVE PM100-PROMO-ID   TO PV-LAST-PROMO-ID             04611003
046120            MOVE PM100-GMA-NBR    TO PV-LAST-GMA-NBR              04612003
046121                                     HDR-02-GMM-NBR               04612103
046130            MOVE PM100-DMA-NBR    TO PV-LAST-DMA-NBR              04613003
046131                                     HDR-01-DMM-NBR               04613103
046140            MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 04614003
046150            MOVE PM100-BYR-NBR    TO PV-LAST-BUYER-NBR            04615003
046160            MOVE PM100-GMA-LAST-NM TO HDR-02-GMM-LAST-NM          04616003
046170            MOVE PM100-DMA-LAST-NM TO HDR-01-DMM-LAST-NM          04617003
046200            PERFORM 2300-FORMAT-HEADING-FIELDS                    04620004
046300            PERFORM 2100-ADEVNT-PROMO-HDR-BREAK                   04630001
046400            PERFORM 2400-CREATE-HEADING-FIELDS                    04640004
046500            PERFORM 3300-PROCESS-PAGE-HEADER                      04650004
046730            SET PS-NOT-FIRST-TIME TO TRUE                         04673001
046731            SET PS-FIRST-LINE     TO TRUE                         04673104
PGNBR *      WHEN (PM100-AD-PG-NBR IS NOT = PV-AD-PG-NBR)               04673246
PGNBR        WHEN (PM100-BYR-NBR IS NOT = PV-LAST-BUYER-NBR)            04673747
PGNBR             IF PS-NO-WROTE-ADV-TTL                                04673847
PGNBR                PERFORM 3100-PROCESS-ADVPG-TOTAL                   04673947
PGNBR             END-IF                                                04674047
PGNBR             PERFORM 3110-PROCESS-BUYER-TOTAL                      04675047
PGNBR             MOVE PM100-BYR-NBR    TO PV-LAST-BUYER-NBR            04675147
PGNBR             MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 04675247
PGNBR             INITIALIZE TBL-SECT-TOTAL-TABLE                       04675347
PGNBR             SET PS-FIRST-LINE     TO TRUE                         04675447
PGNBR             SET PS-NO-WROTE-ADV-TTL TO TRUE                       04675547
PGNBR        WHEN (PM100-PROMO-ITM-ADV-IND = 'N')                       04675646
PGNBR             PERFORM 3100-PROCESS-ADVPG-TOTAL                      04675747
PGNBR             MOVE PM100-AD-PG-NBR  TO PV-AD-PG-NBR                 04675847
PGNBR             SET PS-WROTE-ADV-TTL  TO TRUE                         04675947
046740     END-EVALUATE.                                                04676047
046750     PERFORM 2200-PROCESS-DETAIL.                                 04676140
046760                                                                  04676201
046770     PERFORM 8000-READ-SLS-GMA-RESULTS.                           04677001
046780                                                                  04678001
046790*2000-EXIT.                                                       04679001
046800 EJECT.                                                           04680001
046900                                                                  04690001
047000*----------------------------------------------------------       04700001
047100* 2100-ADEVNT-PROMO-HDR-BREAK.                                    04710001
047200*     WHEN AN ADEVENT ID/PROMO ID CHANGE, GIVE THE NEW            04720001
047300*     START/END DATES.                                            04730001
047400*----------------------------------------------------------       04740001
047500 2100-ADEVNT-PROMO-HDR-BREAK.                                     04750001
047600                                                                  04760001
047700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04770001
047800     SET DPG51-ACTUAL-CALENDAR-ONLY      TO TRUE.                 04780001
047900     SET DPG51-DO-NOT-INCR-DECR-DATE     TO TRUE.                 04790001
048000     SET DPG52-LK-DTE-ISO-FMT            TO TRUE.                 04800001
048100     MOVE PM100-PROMO-STRT-TMST          TO PV-PROMO-STRT-TMST.   04810001
048200     MOVE PM100-PROMO-END-TMST           TO PV-PROMO-END-TMST.    04820001
048300     MOVE PV-PROMO-STRT-DTE              TO DPG52-LK-DATE-INPUT.  04830001
048400     MOVE 'INVALID PROMO BEGINNING DATE' TO PV-OPERATION-MSG-1.   04840001
048500                                                                  04850001
048600     PERFORM 9100-CALENDAR-ROUTINE.                               04860001
048700                                                                  04870001
048800     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-BEG-DAY-ALPHA.              04880001
048900     MOVE DPG55-GREG-DATE-FMT   TO PV-BEG-DATE.                   04890001
049000                                                                  04900001
049100     IF (PV-PM-STRT-TM-HH =                                       04910001
049200         PC-DEFAULT-BEG-HR AND                                    04920001
049300         PV-PM-STRT-TM-MM =                                       04930001
049400         PC-DEFAULT-BEG-MIN)                                      04940001
049500         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  04950001
049600* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 04960001
049700            MOVE SPACES         TO PV-BEG-TIME                    04970001
049800            MOVE PV-PM-STRT-TM-HH                                 04980001
049900                                TO PV-BEG-HR-TIME                 04990001
050000            MOVE PC-COLON       TO PV-BEG-TIME-COLON              05000001
050100            MOVE PV-PM-STRT-TM-MM                                 05010001
050200                                TO PV-BEG-MIN-TIME                05020001
050300         ELSE                                                     05030001
050400            MOVE PC-ALL-DAY     TO PV-BEG-TIME                    05040001
050500         END-IF                                                   05050001
050600     ELSE                                                         05060001
050700* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05070001
050800        MOVE SPACES             TO PV-BEG-TIME                    05080001
050900        MOVE PV-PM-STRT-TM-HH                                     05090001
051000                                TO PV-BEG-HR-TIME                 05100001
051100        MOVE PC-COLON           TO PV-BEG-TIME-COLON              05110001
051200        MOVE PV-PM-STRT-TM-MM                                     05120001
051300                                TO PV-BEG-MIN-TIME                05130001
051400     END-IF.                                                      05140001
051500                                                                  05150001
051600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05160001
051700     SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    05170001
051800     SET DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                    05180001
051900     SET DPG52-LK-DTE-ISO-FMT         TO TRUE.                    05190001
052000     MOVE PV-PROMO-END-DTE            TO DPG52-LK-DATE-INPUT.     05200001
052100     MOVE 'INVALID PROMO ENDING DATE' TO PV-OPERATION-MSG-1.      05210001
052200                                                                  05220001
052300     PERFORM 9100-CALENDAR-ROUTINE.                               05230001
052400                                                                  05240001
052500     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-END-DAY-ALPHA.              05250001
052600     MOVE DPG55-GREG-DATE-FMT   TO PV-END-DATE.                   05260001
052700                                                                  05270001
052800     IF (PV-PM-END-TM-HH =                                        05280001
052900         PC-DEFAULT-END-HR AND                                    05290001
053000         PV-PM-END-TM-MM =                                        05300001
053100         PC-DEFAULT-END-MIN)                                      05310001
053200         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  05320001
053300* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05330001
053400            MOVE SPACES         TO PV-END-TIME                    05340001
053500            MOVE PV-PM-END-TM-HH                                  05350001
053600                                TO PV-END-HR-TIME                 05360001
053700            MOVE PC-COLON       TO PV-END-TIME-COLON              05370001
053800            MOVE PV-PM-END-TM-MM                                  05380001
053900                                TO PV-END-MIN-TIME                05390001
054000         ELSE                                                     05400001
054100            MOVE PC-ALL-DAY     TO PV-END-TIME                    05410001
054200         END-IF                                                   05420001
054300      ELSE                                                        05430001
054400* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05440001
054500         MOVE SPACES            TO PV-END-TIME                    05450001
054600         MOVE PV-PM-END-TM-HH                                     05460001
054700                                TO PV-END-HR-TIME                 05470001
054800         MOVE PC-COLON          TO PV-END-TIME-COLON              05480001
054900         MOVE PV-PM-END-TM-MM                                     05490001
055000                                TO PV-END-MIN-TIME                05500001
055100     END-IF.                                                      05510001
055200                                                                  05520001
055300*2100-EXIT.                                                       05530001
055400 EJECT.                                                           05540001
055500                                                                  05550001
055510*----------------------------------------------------------       05551004
055520* 2200-PROCESS-DETAIL.                                            05552004
055530*     PROCESS REPORT DETAIL LINES.                                05553004
055540*----------------------------------------------------------       05554004
055550 2200-PROCESS-DETAIL.                                             05555004
055560                                                                  05556004
055570     MOVE SPACES                    TO DETAIL-01                  05557004
055580                                       DETAIL-VARIABLE.           05558004
055590                                                                  05559004
055591     IF PM100-PROMO-ITM-ADV-IND = 'N'                             05559142
055592        IF PS-FIRST-LINE                                          05559204
055593           MOVE 2                   TO PV-ADVANCE-LINES           05559320
055594           MOVE PM100-BYR-LAST-NM   TO DTL-01-TTL-GMA-LAST-NM     05559404
055595           SET PS-NO-FIRST-LINE     TO TRUE                       05559504
055596           SET PS-WROTE-ADV-TTL     TO TRUE                       05559618
055597        ELSE                                                      05559704
055598           MOVE 1                   TO PV-ADVANCE-LINES           05559804
055599           MOVE SPACES              TO DTL-01-TTL-GMA-LAST-NM     05559904
055600        END-IF                                                    05560004
055601        MOVE PC-UNADVERTISED     TO DTL-01-UNAD-TITLE             05560104
055602     ELSE                                                         05560204
PGNBR         IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                      05560342
PGNBR            PM100-AD-PG-NBR NOT = 0                                05560442
055605           MOVE PM100-AD-PG-NBR     TO DTL-01-PM-AD-PG-NBR        05560504
055606           MOVE PM100-BYR-LAST-NM   TO DTL-01-GMA-LAST-NM         05560606
055607           IF PS-FIRST-LINE                                       05560704
055608              MOVE 2                TO PV-ADVANCE-LINES           05560820
055609              SET PS-NO-FIRST-LINE  TO TRUE                       05560904
055610              MOVE PM100-BYR-LAST-NM                              05561006
055611                                    TO DTL-01-GMA-LAST-NM         05561104
055612           ELSE                                                   05561204
055613              MOVE 1                TO PV-ADVANCE-LINES           05561319
055614              MOVE SPACES                                         05561404
055615                                    TO DTL-01-GMA-LAST-NM         05561504
055616           END-IF                                                 05561604
PGNBR         ELSE                                                      05561742
PGNBR            IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                   05561842
PGNBR               PM100-AD-PG-NBR = 0                                 05561942
PGNBR               IF PS-FIRST-LINE                                    05562042
PGNBR                  MOVE 2                   TO PV-ADVANCE-LINES     05562142
PGNBR                  MOVE PM100-BYR-LAST-NM   TO                      05562242
PGNBR                                         DTL-01-ADV-GMA-LAST-NM    05562342
PGNBR                  SET PS-NO-FIRST-LINE     TO TRUE                 05562442
PGNBR                  SET PS-WROTE-ADV-TTL     TO TRUE                 05562542
PGNBR               ELSE                                                05562642
PGNBR                  MOVE 1                   TO PV-ADVANCE-LINES     05562742
PGNBR                  MOVE SPACES              TO                      05562842
PGNBR                                         DTL-01-ADV-GMA-LAST-NM    05562942
PGNBR               END-IF                                              05563042
PGNBR               MOVE PC-ADVNOPAGE        TO DTL-01-NOPG-TITLE       05563142
PGNBR            END-IF                                                 05563242
055617        END-IF                                                    05563304
055618     END-IF.                                                      05563404
055619                                                                  05563504
055620*** THIS IS PROCESSED FOR ACTUAL REPORTS ONLY.                    05563604
055621     IF PM100-ACTUAL                                              05563704
055623        MOVE PM100-ACTL-SLS-RTL-AMT  TO DTL-01-ACTL-SLS-RTL-AMT   05563834
055625                                                                  05563904
055627        MOVE PM100-ACTL-MKDN-RTL-AMT TO DTL-01-ACTL-MD-AMT        05564034
055629                                                                  05564104
055631        MOVE PM100-ACTL-SLS-UNT-QTY  TO DTL-01-ACTL-UNT-SLD-QTY   05564234
055633        ADD PM100-ACTL-SLS-RTL-AMT   TO                           05564334
055634                             TBL-STOT-TOT-SALE-AMT(PC-SUB-1)      05564404
055635                             TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)     05564504
055636        ADD PM100-ACTL-MKDN-RTL-AMT  TO                           05564634
055637                             TBL-STOT-TOT-MD-AMT(PC-SUB-1)        05564704
055638                             TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)       05564804
055639        ADD PM100-ACTL-SLS-UNT-QTY   TO                           05564934
055640                             TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)   05565004
055641                             TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)  05565104
055642        ADD PM100-ACTL-SLS-COST-AMT  TO                           05565234
055643                             TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)  05565304
055644                             TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1) 05565404
055645        ADD PM100-ACTL-EOH-INV-QTY   TO                           05565534
055646                             TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1)   05565604
055647                             TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1)  05565704
055648        IF PM100-PROMO-ITM-ADV-IND = 'N'                          05565804
055649           ADD PM100-ACTL-SLS-RTL-AMT  TO                         05565904
055650                           TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)       05566004
055651           ADD PM100-ACTL-MKDN-RTL-AMT TO                         05566104
055652                           TBL-UATOT-TOT-MD-AMT(PC-SUB-1)         05566204
055653           ADD PM100-ACTL-SLS-UNT-QTY  TO                         05566304
055654                           TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1)    05566404
055655           ADD PM100-ACTL-SLS-COST-AMT TO                         05566504
055656                           TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-1)   05566604
055657           ADD PM100-ACTL-EOH-INV-QTY  TO                         05566734
055658                           TBL-UATOT-TOT-EOH-INV-QTY(PC-SUB-1)    05566804
055659           ADD PM100-ACTL-PREP-UNT-QTY TO                         05566904
055660                           TBL-UATOT-PREP-UNT-QTY(PC-SUB-1)       05567004
055661        ELSE                                                      05567104
055662           IF PM100-PROMO-ITM-ADV-IND = 'Y'                       05567204
055663              ADD PM100-ACTL-SLS-RTL-AMT  TO                      05567304
055664                           TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)        05567404
055665              ADD PM100-ACTL-MKDN-RTL-AMT TO                      05567504
055666                           TBL-ATOT-TOT-MD-AMT(PC-SUB-1)          05567604
055667              ADD PM100-ACTL-SLS-UNT-QTY  TO                      05567704
055668                           TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1)     05567804
055669              ADD PM100-ACTL-SLS-COST-AMT TO                      05567904
055670                           TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-1)    05568004
055671              ADD PM100-ACTL-EOH-INV-QTY  TO                      05568134
055672                           TBL-ATOT-TOT-EOH-INV-QTY(PC-SUB-1)     05568204
055673              ADD PM100-ACTL-PREP-UNT-QTY TO                      05568304
055674                           TBL-ATOT-PREP-UNT-QTY(PC-SUB-1)        05568404
055675           END-IF                                                 05568504
055676        END-IF                                                    05568604
055678        MOVE PM100-ACTL-PREP-UNT-QTY TO DTL-01-ACTL-PREP-UNT-QTY  05568734
055680        ADD PM100-ACTL-PREP-UNT-QTY  TO                           05568834
055681                                TBL-STOT-PREP-UNT-QTY(PC-SUB-1)   05568921
055682                                TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)  05569004
055683        IF PM100-ACTL-SLS-RTL-AMT = ZEROES                        05569104
055685           MOVE ZEROES              TO PV-MU-PCT                  05569234
055686           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         05569334
055687           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       05569434
055688        ELSE                                                      05569504
055689           COMPUTE PV-MU-PCT ROUNDED =                            05569604
055690                   ((PM100-ACTL-SLS-RTL-AMT -                     05569704
055691                    PM100-ACTL-SLS-COST-AMT) /                    05569804
055692                    PM100-ACTL-SLS-RTL-AMT) * 100                 05569904
055693                    ON SIZE ERROR                                 05570004
055694                    MOVE 0 TO PV-MU-PCT                           05570104
055695           END-COMPUTE                                            05570204
055696           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          05570304
055697           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  05570404
055698           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          05570504
055702           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        05570634
055704        END-IF                                                    05570704
055705                                                                  05570804
055706        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        05570931
055707                (PM100-ACTL-SLS-UNT-QTY /                         05571031
055708                (PM100-ACTL-EOH-INV-QTY +                         05571131
055709                 PM100-ACTL-SLS-UNT-QTY)) * 100                   05571231
055710                 ON SIZE ERROR                                    05571331
055711                 MOVE 0 TO PV-SELL-THRU-PCT                       05571431
055712        END-COMPUTE                                               05571531
055714        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          05571604
055715        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  05571704
055716        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        05571804
055720        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        05572035
055722                                                                  05572204
055723        IF PM100-FCST-SLS-RTL-AMT = ZEROES                        05572304
055724           CONTINUE                                               05572404
055725        ELSE                                                      05572504
055726           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       05572633
055727                 ((PM100-FCST-SLS-RTL-AMT -                       05572733
055728                   PM100-ACTL-SLS-RTL-AMT) /                      05572833
055729                   PM100-FCST-SLS-RTL-AMT) * -100                 05572933
055730                   ON SIZE ERROR                                  05573004
055731                   MOVE 0 TO PV-VOL-PCT-CHG                       05573104
055732           END-COMPUTE                                            05573204
055733           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          05573304
055734           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  05573404
055735           IF PV-VOL-PCT-CHG < 0                                  05573504
055736              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 05573604
055737              MOVE PV-FINAL-VOL-PCT                               05573704
055738                                   TO DTL-01-VOL-PCT-CHG          05573804
055739           ELSE                                                   05573904
055740              MOVE PV-ROUND-TO-TENTHS                             05574004
055741                                   TO DTL-VAR-VOL-PCT-CHG         05574104
055742              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          05574204
055743           END-IF                                                 05574304
055747           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         05574734
055749        END-IF                                                    05574904
055750     END-IF.                                                      05575004
055751                                                                  05575104
055753     MOVE PM100-FCST-SLS-RTL-AMT    TO DTL-01-FCST-SLS-RTL-AMT.   05575334
055755     ADD PM100-FCST-SLS-RTL-AMT     TO                            05575504
055756                              TBL-STOT-TOT-SALE-AMT(PC-SUB-2)     05575604
055757                              TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2).   05575704
055759     MOVE PM100-FCST-MKDN-RTL-AMT   TO DTL-01-FCST-MD-AMT.        05575934
055761     ADD PM100-FCST-MKDN-RTL-AMT    TO                            05576104
055762                             TBL-STOT-TOT-MD-AMT(PC-SUB-2)        05576204
055763                             TBL-PMTOT-TOT-MD-AMT(PC-SUB-2).      05576304
055765     MOVE PM100-FCST-SLS-UNT-QTY    TO DTL-01-FCST-UNT-SLD-QTY.   05576534
055767     ADD PM100-FCST-SLS-UNT-QTY     TO                            05576704
055768                            TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)    05576804
055769                            TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2).  05576904
055771     MOVE PM100-FCST-PROJD-UNT-QTY   TO DTL-01-FCST-PREP-UNT-QTY. 05577135
055773     ADD PM100-FCST-PROJD-UNT-QTY   TO                            05577304
055774                             TBL-STOT-PREP-UNT-QTY(PC-SUB-2)      05577404
055775                             TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2).    05577504
055776     ADD PM100-FCST-SLS-COST-AMT    TO                            05577604
055777                             TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)  05577704
055778                             TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2).05577804
055779                                                                  05577904
055780     IF PM100-FCST-SLS-RTL-AMT = ZEROES                           05578004
055781         CONTINUE                                                 05578104
055782     ELSE                                                         05578204
055783         COMPUTE PV-MU-PCT ROUNDED =                              05578304
055784                 ((PM100-FCST-SLS-RTL-AMT -                       05578404
055785                 PM100-FCST-SLS-COST-AMT) /                       05578504
055786                 PM100-FCST-SLS-RTL-AMT) * 100                    05578604
055787                 ON SIZE ERROR                                    05578704
055788                 MOVE 0 TO PV-MU-PCT                              05578804
055789         END-COMPUTE                                              05578904
055790         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          05579004
055791         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  05579104
055792         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          05579204
055796         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        05579634
055798     END-IF.                                                      05579804
055799     IF PM100-PROMO-ITM-ADV-IND = 'N'                             05579904
055800        ADD PM100-FCST-SLS-RTL-AMT   TO                           05580004
055801                      TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)            05580104
055802        ADD PM100-FCST-MKDN-RTL-AMT  TO                           05580204
055803                      TBL-UATOT-TOT-MD-AMT(PC-SUB-2)              05580304
055804        ADD PM100-FCST-SLS-UNT-QTY   TO                           05580404
055805                      TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-2)         05580504
055806        ADD PM100-FCST-SLS-COST-AMT  TO                           05580604
055807                      TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-2)        05580704
055808        ADD PM100-FCST-PROJD-UNT-QTY TO                           05580804
055809                      TBL-UATOT-PREP-UNT-QTY(PC-SUB-2)            05580904
055810     ELSE                                                         05581004
055811        IF PM100-PROMO-ITM-ADV-IND = 'Y'                          05581104
055812           ADD PM100-FCST-SLS-RTL-AMT   TO                        05581204
055813                      TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)             05581304
055814           ADD PM100-FCST-MKDN-RTL-AMT  TO                        05581404
055815                      TBL-ATOT-TOT-MD-AMT(PC-SUB-2)               05581504
055816           ADD PM100-FCST-SLS-UNT-QTY   TO                        05581604
055817                      TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-2)          05581704
055818           ADD PM100-FCST-SLS-COST-AMT  TO                        05581804
055819                      TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-2)         05581904
055820           ADD PM100-FCST-PROJD-UNT-QTY TO                        05582004
055821                      TBL-ATOT-PREP-UNT-QTY(PC-SUB-2)             05582104
055822        END-IF                                                    05582204
055823     END-IF.                                                      05582304
055824                                                                  05582404
055825     ADD PV-ADVANCE-LINES           TO PV-LINE-CNT.               05582504
055826     PERFORM 3200-CHECK-MAX-LINE-CNT.                             05582604
055827     MOVE DETAIL-01                 TO PV-RPT-LINE.               05582704
055828     PERFORM 8200-WRITE-RPT-LINE.                                 05582837
055829                                                                  05582904
055830*2200-EXIT.                                                       05583004
055831 EJECT.                                                           05583104
055832                                                                  05583204
055833*----------------------------------------------------------       05583301
055834* 2300-FORMAT-HEADING-FIELDS.                                     05583404
055840*     FORMAT THE AD EVENT TITLES AND THE PROMOTION TITLES.        05584001
055900*----------------------------------------------------------       05590001
056000 2300-FORMAT-HEADING-FIELDS.                                      05600004
056100                                                                  05610001
056200     MOVE PM100-AD-EVNT-NBR-TXT TO PV-SAVE-VAR.                   05620001
056300     MOVE 16                    TO PV-SAVE-NUM.                   05630001
056400     PERFORM 7000-COUNT-FIELD-LENGTH.                             05640001
056500     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NBR-LENGTH.         05650001
056600                                                                  05660001
056700     MOVE PM100-AD-EVNT-NM      TO PV-SAVE-VAR.                   05670001
056800     MOVE 41                    TO PV-SAVE-NUM.                   05680001
056900     PERFORM 7000-COUNT-FIELD-LENGTH.                             05690001
057000     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NM-LENGTH.          05700001
057100                                                                  05710001
057200     MOVE PM100-PROMO-NM        TO PV-SAVE-VAR.                   05720001
057300     MOVE 41                    TO PV-SAVE-NUM.                   05730001
057400     PERFORM 7000-COUNT-FIELD-LENGTH.                             05740001
057500     MOVE PV-SAVE-LENGTH        TO PV-PROMO-NM-LENGTH.            05750001
057600                                                                  05760001
057700*2300-EXIT.                                                       05770004
057800 EJECT.                                                           05780001
057900                                                                  05790001
058000*----------------------------------------------------------       05800001
058100* 2400-CREATE-HEADING-FIELDS.                                     05810004
058200*     CREATE THE AD EVENT AND THE PROMO HEADINGS.                 05820001
058300*----------------------------------------------------------       05830001
058400 2400-CREATE-HEADING-FIELDS.                                      05840004
058500                                                                  05850001
058600     MOVE SPACES          TO HDR-04-ADEVNT-STRING                 05860005
058700                             HDR-05-PROMO-STRING.                 05870005
058800                                                                  05880001
058900     MOVE +1 TO PV-POINTER-FIELD.                                 05890001
059000     STRING PM100-AD-EVNT-NBR-TXT(1:PV-AD-EVNT-NBR-LENGTH)        05900001
059100            " " DELIMITED BY SIZE                                 05910001
059200            PM100-AD-EVNT-NM(1:PV-AD-EVNT-NM-LENGTH)              05920001
059300            " " DELIMITED BY SIZE                                 05930001
059400       INTO HDR-04-ADEVNT-STRING                                  05940005
059500       WITH POINTER PV-POINTER-FIELD.                             05950001
059600                                                                  05960001
059700     MOVE +1 TO PV-POINTER-FIELD.                                 05970001
059800     STRING PM100-PROMO-NM(1:PV-PROMO-NM-LENGTH)                  05980001
059900            " " DELIMITED BY SIZE                                 05990001
060000            " " DELIMITED BY SIZE                                 06000001
060100            " " DELIMITED BY SIZE                                 06010001
060200            PC-CHAR-EFFECTIVE DELIMITED BY " "                    06020001
060300            ":" DELIMITED BY SIZE                                 06030001
060400            " " DELIMITED BY SIZE                                 06040001
060500            PV-HEADER-DTE-TM(1:87)                                06050001
060600            " " DELIMITED BY SIZE                                 06060001
060700       INTO HDR-05-PROMO-STRING                                   06070005
060800       WITH POINTER PV-POINTER-FIELD.                             06080001
060900                                                                  06090001
061000*2400-EXIT.                                                       06100004
061100 EJECT.                                                           06110001
061200                                                                  06120001
061300*----------------------------------------------------------       06130001
061400* 3000-END-OF-JOB-ROUTINE.                                        06140001
061500*     PERFORMS THE FINAL PROCESSING OF THE PROGRAM.               06150001
061600*     WRITES OUT THE CLOSING LINES OF THE REPORT, CLOSES          06160001
061700*     ANY FILES, AND DISPLAYS ANY NECESSARY STATISTICS.           06170001
061800*----------------------------------------------------------       06180001
061900 3000-END-OF-JOB-ROUTINE.                                         06190001
062000                                                                  06200001
062010     IF PS-NOT-FIRST-TIME                                         06201003
062020        PERFORM 3110-PROCESS-BUYER-TOTAL                          06202004
062030        PERFORM 3120-PROCESS-ADV-TOTAL                            06203004
062040        PERFORM 3130-PROCESS-UNAD-TOTAL                           06204004
062050        PERFORM 3140-PROCESS-PROMO-TOTAL                          06205004
062060        INITIALIZE TBL-SECT-TOTAL-TABLE                           06206003
062070                   TBL-ADV-TOTAL-TABLE                            06207003
062080                   TBL-UNAD-TOTAL-TABLE                           06208140
062090                   TBL-PROMO-TOTAL-TABLE                          06209003
063400        MOVE 2                     TO PV-ADVANCE-LINES            06340001
063500        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 06350001
063600        PERFORM 3200-CHECK-MAX-LINE-CNT                           06360004
063700        MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                 06370001
063800        PERFORM 8200-WRITE-RPT-LINE                               06380037
063900     END-IF.                                                      06390001
064000                                                                  06400001
064100     CLOSE PROMO-SUMM-BUY-FILE                                    06410005
064400           PROMO-SUMM-REPORT.                                     06440001
064500                                                                  06450001
064600*3000-EXIT.                                                       06460001
064700 EJECT.                                                           06470001
064800                                                                  06480001
083826*----------------------------------------------------------       08382601
083827* 3100-PROCESS-ADVPG-TOTAL.                                       08382704
083828*     PROCESS THE ADVERTISED/BUYER TOTAL OF THE REPORT.           08382804
083829*----------------------------------------------------------       08382901
083830 3100-PROCESS-ADVPG-TOTAL.                                        08383004
083840                                                                  08384001
083850     MOVE SPACES               TO DETAIL-01                       08385001
083860                                  DETAIL-VARIABLE.                08386001
083870                                                                  08387001
083880     MOVE PC-ADVERTISED         TO DTL-01-UNAD-TITLE.             08388004
083900                                                                  08390001
084000*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                08400001
084100     IF PM100-ACTUAL                                              08410001
084300        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      08430035
084400                                   TO DTL-01-ACTL-SLS-RTL-AMT     08440035
084600                                                                  08460001
084700        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               08470001
084800           CONTINUE                                               08480001
084900        ELSE                                                      08490001
085000           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       08500033
085010                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              08501033
085100                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             08510033
085200                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        08520033
085300                   ON SIZE ERROR                                  08530001
085400                   MOVE 0 TO PV-VOL-PCT-CHG                       08540001
085500           END-COMPUTE                                            08550001
085600           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          08560001
085700           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  08570001
085800           IF PV-VOL-PCT-CHG < 0                                  08580001
085900              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 08590001
086000              MOVE PV-FINAL-VOL-PCT                               08600001
086100                                   TO DTL-01-VOL-PCT-CHG          08610001
086200           ELSE                                                   08620001
086300              MOVE PV-ROUND-TO-TENTHS                             08630001
086400                                   TO DTL-VAR-VOL-PCT-CHG         08640001
086500              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          08650001
086600           END-IF                                                 08660001
087000              MOVE PC-PERCENT-SIGN TO DTL-01-VOL-PCT-SIGN         08700001
087200        END-IF                                                    08720001
087300                                                                  08730001
087400        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        08740031
087500                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             08750031
087600                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             08760031
087700                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       08770031
087800                 ON SIZE ERROR                                    08780031
087900                 MOVE 0 TO PV-SELL-THRU-PCT                       08790031
088000        END-COMPUTE                                               08800031
088100        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          08810001
088200        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  08820001
088300        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        08830001
088700        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        08870035
088900                                                                  08890001
089100        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        08910035
089200                                   TO DTL-01-ACTL-MD-AMT          08920035
089500        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   08950035
089600                                   TO DTL-01-ACTL-UNT-SLD-QTY     08960035
089900        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      08990035
090000                                   TO DTL-01-ACTL-PREP-UNT-QTY    09000035
090300                                                                  09030001
090400        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               09040001
090510           MOVE ZEROES             TO PV-MU-PCT                   09051035
090520           MOVE PV-MU-PCT          TO DTL-01-ACTL-MU-PCT          09052035
090530           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        09053035
090600        ELSE                                                      09060001
090700           COMPUTE PV-MU-PCT ROUNDED =                            09070001
090800                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            09080001
090900                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         09090001
091000                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        09100001
091100                    ON SIZE ERROR                                 09110001
091200                    MOVE 0 TO PV-MU-PCT                           09120001
091300           END-COMPUTE                                            09130001
091400           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          09140001
091500           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  09150001
091600           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          09160001
092000           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        09200035
092200        END-IF                                                    09220001
092300     END-IF.                                                      09230001
092400                                                                  09240001
092500*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            09250001
092700     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         09270035
092800                                   TO DTL-01-FCST-SLS-RTL-AMT.    09280035
093100     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           09310035
093200                                   TO DTL-01-FCST-MD-AMT.         09320035
093500     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      09350035
093600                                   TO DTL-01-FCST-UNT-SLD-QTY.    09360035
093900     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         09390035
093910                                   TO DTL-01-FCST-PREP-UNT-QTY.   09391035
093940                                                                  09394001
093950     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  09395001
093960         CONTINUE                                                 09396001
093970     ELSE                                                         09397001
093980         COMPUTE PV-MU-PCT ROUNDED =                              09398001
093990                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              09399001
094000                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            09400001
094010                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           09401001
094011                 ON SIZE ERROR                                    09401101
094012                 MOVE 0 TO PV-MU-PCT                              09401201
094013         END-COMPUTE                                              09401301
094014         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          09401401
094015         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  09401501
094016         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          09401601
094020         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        09402035
094022     END-IF.                                                      09402201
094023                                                                  09402301
094024     MOVE 2                    TO PV-ADVANCE-LINES.               09402401
094025     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    09402501
094026     PERFORM 3200-CHECK-MAX-LINE-CNT.                             09402604
094027     MOVE DETAIL-01            TO PV-RPT-LINE.                    09402701
094028     PERFORM 8200-WRITE-RPT-LINE.                                 09402837
094029                                                                  09402901
094036*3100-EXIT.                                                       09403604
094040 EJECT.                                                           09404001
094050                                                                  09405001
094060*----------------------------------------------------------       09406004
094070* 3110-PROCESS-BUYER-TOTAL.                                       09407004
094080*     PROCESS THE BUYER TOTAL OF THE REPORT.                      09408004
094090*----------------------------------------------------------       09409004
094100 3110-PROCESS-BUYER-TOTAL.                                        09410004
094200                                                                  09420004
094300     MOVE SPACES               TO DETAIL-01                       09430004
094400                                  DETAIL-VARIABLE.                09440004
094500                                                                  09450004
094600     MOVE PC-TOTAL              TO DTL-01-NEW-TITLE.              09460004
094700                                                                  09470004
094800*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                09480004
094900     IF PM100-ACTUAL                                              09490004
095100        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      09510035
095200                                   TO DTL-01-ACTL-SLS-RTL-AMT     09520035
095400                                                                  09540004
095500        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               09550004
095600           CONTINUE                                               09560004
095700        ELSE                                                      09570004
095800           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       09580033
095810                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              09581033
095900                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             09590033
096000                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        09600033
096100                   ON SIZE ERROR                                  09610004
096200                   MOVE 0 TO PV-VOL-PCT-CHG                       09620004
096300           END-COMPUTE                                            09630004
096400           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          09640004
096500           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  09650004
096600           IF PV-VOL-PCT-CHG < 0                                  09660004
096700              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 09670004
096800              MOVE PV-FINAL-VOL-PCT                               09680004
096900                                   TO DTL-01-VOL-PCT-CHG          09690004
097000           ELSE                                                   09700004
097100              MOVE PV-ROUND-TO-TENTHS                             09710004
097200                                   TO DTL-VAR-VOL-PCT-CHG         09720004
097300              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          09730004
097400           END-IF                                                 09740004
097800           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         09780035
098000        END-IF                                                    09800004
098100                                                                  09810004
098140        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        09814031
098150                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             09815031
098160                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             09816031
098170                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       09817031
098180                 ON SIZE ERROR                                    09818031
098190                 MOVE 0 TO PV-SELL-THRU-PCT                       09819031
098191        END-COMPUTE                                               09819131
098900        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          09890004
099000        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  09900004
099100        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        09910004
099500        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        09950035
099700                                                                  09970004
099900        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        09990035
100000                                   TO DTL-01-ACTL-MD-AMT          10000035
100300        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   10030035
100400                                   TO DTL-01-ACTL-UNT-SLD-QTY     10040035
100700        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      10070035
100800                                   TO DTL-01-ACTL-PREP-UNT-QTY    10080035
101100                                                                  10110004
101200        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               10120004
101310           MOVE ZEROES             TO PV-MU-PCT                   10131035
101320           MOVE PV-MU-PCT          TO DTL-01-ACTL-MU-PCT          10132035
101330           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        10133035
101400        ELSE                                                      10140004
101500           COMPUTE PV-MU-PCT ROUNDED =                            10150004
101600                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            10160004
101700                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         10170004
101800                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        10180004
101900                    ON SIZE ERROR                                 10190004
102000                    MOVE 0 TO PV-MU-PCT                           10200004
102100           END-COMPUTE                                            10210004
102200           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10220004
102300           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  10230004
102400           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          10240004
102800           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        10280035
103000        END-IF                                                    10300004
103100     END-IF.                                                      10310004
103200                                                                  10320004
103300*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            10330004
103500     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         10350035
103600                                   TO DTL-01-FCST-SLS-RTL-AMT.    10360035
103900     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           10390035
104000                                   TO DTL-01-FCST-MD-AMT.         10400035
104300     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      10430035
104400                                   TO DTL-01-FCST-UNT-SLD-QTY.    10440035
104700     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         10470035
104800                                   TO DTL-01-FCST-PREP-UNT-QTY.   10480035
105100                                                                  10510004
105200     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  10520004
105300         CONTINUE                                                 10530004
105400     ELSE                                                         10540004
105500         COMPUTE PV-MU-PCT ROUNDED =                              10550004
105600                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              10560004
105700                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            10570004
105800                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           10580004
105900                 ON SIZE ERROR                                    10590004
106000                 MOVE 0 TO PV-MU-PCT                              10600004
106100         END-COMPUTE                                              10610004
106200         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          10620004
106300         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  10630004
106400         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          10640004
106800         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        10680035
107000     END-IF.                                                      10700004
107100                                                                  10710004
107200     MOVE 1                    TO PV-ADVANCE-LINES.               10720014
107300     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    10730004
107400     PERFORM 3200-CHECK-MAX-LINE-CNT.                             10740004
107500     MOVE DETAIL-01            TO PV-RPT-LINE.                    10750004
107600     PERFORM 8200-WRITE-RPT-LINE.                                 10760037
107700                                                                  10770004
107710     MOVE 1                    TO PV-ADVANCE-LINES.               10771004
107720     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    10772004
107730     PERFORM 3200-CHECK-MAX-LINE-CNT.                             10773004
107740     MOVE DETAIL-HEADER-02     TO PV-RPT-LINE.                    10774004
107750     PERFORM 8200-WRITE-RPT-LINE.                                 10775037
107760                                                                  10776004
107800*3110-EXIT.                                                       10780004
107900 EJECT.                                                           10790004
108000                                                                  10800004
108100*----------------------------------------------------------       10810004
108200* 3120-PROCESS-ADV-TOTAL.                                         10820004
108300*     PROCESS THE ADVERTISED TOTAL OF THE REPORT.                 10830004
108400*----------------------------------------------------------       10840004
108500 3120-PROCESS-ADV-TOTAL.                                          10850004
108600                                                                  10860004
108700     MOVE SPACES               TO DETAIL-01                       10870004
108710                                  DETAIL-VARIABLE.                10871004
108720                                                                  10872004
108730     MOVE PC-ADVERTISED         TO DTL-01-UNAD-TITLE.             10873004
108740                                                                  10874004
108750*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                10875004
108760     IF PM100-ACTUAL                                              10876004
108780        MOVE TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)                      10878035
108790                                   TO DTL-01-ACTL-SLS-RTL-AMT     10879035
108792                                                                  10879204
108793        IF TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               10879304
108794           CONTINUE                                               10879404
108795        ELSE                                                      10879504
108796           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       10879633
108797                 ((TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) -              10879733
108798                   TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)) /             10879833
108799                   TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)) * -100        10879933
108800                   ON SIZE ERROR                                  10880004
108801                   MOVE 0 TO PV-VOL-PCT-CHG                       10880104
108802           END-COMPUTE                                            10880204
108803           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10880304
108804           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  10880404
108805           IF PV-VOL-PCT-CHG < 0                                  10880504
108806              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 10880604
108807              MOVE PV-FINAL-VOL-PCT                               10880704
108808                                   TO DTL-01-VOL-PCT-CHG          10880804
108809           ELSE                                                   10880904
108810              MOVE PV-ROUND-TO-TENTHS                             10881004
108811                                   TO DTL-VAR-VOL-PCT-CHG         10881104
108812              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          10881204
108813           END-IF                                                 10881304
108817           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         10881735
108819        END-IF                                                    10881904
108820                                                                  10882004
108823        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        10882331
108824                (TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             10882431
108825                (TBL-ATOT-TOT-EOH-INV-QTY(PC-SUB-1) +             10882531
108826                 TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       10882631
108827                 ON SIZE ERROR                                    10882731
108828                 MOVE 0 TO PV-SELL-THRU-PCT                       10882831
108829        END-COMPUTE                                               10882931
108838        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          10883804
108839        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  10883904
108840        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        10884004
108844        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        10884435
108846                                                                  10884604
108848        MOVE TBL-ATOT-TOT-MD-AMT(PC-SUB-1)                        10884835
108849                                   TO DTL-01-ACTL-MD-AMT          10884935
108852        MOVE TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   10885235
108853                                   TO DTL-01-ACTL-UNT-SLD-QTY     10885335
108856        MOVE TBL-ATOT-PREP-UNT-QTY(PC-SUB-1)                      10885635
108857                                   TO DTL-01-ACTL-PREP-UNT-QTY    10885735
108860                                                                  10886004
108861        IF TBL-ATOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               10886104
108863           MOVE ZEROES             TO PV-MU-PCT                   10886335
108864           MOVE PV-MU-PCT          TO DTL-01-ACTL-MU-PCT          10886435
108865           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        10886535
108866        ELSE                                                      10886604
108867           COMPUTE PV-MU-PCT ROUNDED =                            10886704
108868                   ((TBL-ATOT-TOT-SALE-AMT(PC-SUB-1) -            10886804
108869                    TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-1))/         10886904
108870                    TBL-ATOT-TOT-SALE-AMT(PC-SUB-1)) * 100        10887004
108871                    ON SIZE ERROR                                 10887104
108872                    MOVE 0 TO PV-MU-PCT                           10887204
108873           END-COMPUTE                                            10887304
108874           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10887404
108875           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  10887504
108876           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          10887604
108880           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        10888035
108882        END-IF                                                    10888204
108883     END-IF.                                                      10888304
108884                                                                  10888404
108885*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            10888504
108887     MOVE TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)                         10888735
108888                                   TO DTL-01-FCST-SLS-RTL-AMT.    10888835
108891     MOVE TBL-ATOT-TOT-MD-AMT(PC-SUB-2)                           10889135
108892                                   TO DTL-01-FCST-MD-AMT.         10889235
108895     MOVE TBL-ATOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      10889535
108896                                   TO DTL-01-FCST-UNT-SLD-QTY.    10889635
108899     MOVE TBL-ATOT-PREP-UNT-QTY(PC-SUB-2)                         10889935
108900                                   TO DTL-01-FCST-PREP-UNT-QTY.   10890035
108902                                                                  10890204
108903     IF TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  10890304
108904         CONTINUE                                                 10890404
108905     ELSE                                                         10890504
108906         COMPUTE PV-MU-PCT ROUNDED =                              10890604
108907                 ((TBL-ATOT-TOT-SALE-AMT(PC-SUB-2) -              10890704
108908                 TBL-ATOT-TOT-SLS-COST-AMT(PC-SUB-2))/            10890804
108909                 TBL-ATOT-TOT-SALE-AMT(PC-SUB-2)) * 100           10890904
108910                 ON SIZE ERROR                                    10891004
108911                 MOVE 0 TO PV-MU-PCT                              10891104
108912         END-COMPUTE                                              10891204
108913         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          10891304
108914         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  10891404
108915         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          10891504
108919         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        10891935
108921     END-IF.                                                      10892104
108922                                                                  10892204
108923     MOVE 2                    TO PV-ADVANCE-LINES.               10892304
108924     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    10892404
108925     PERFORM 3200-CHECK-MAX-LINE-CNT.                             10892504
108926     MOVE DETAIL-01            TO PV-RPT-LINE.                    10892604
108927     PERFORM 8200-WRITE-RPT-LINE.                                 10892737
108928                                                                  10892804
108929*3120-EXIT.                                                       10892904
108930 EJECT.                                                           10893004
108931                                                                  10893104
108932*----------------------------------------------------------       10908740
108933* 3130-PROCESS-UNAD-TOTAL.                                        10908840
108934*     PROCESS THE UNADVERTISED TOTAL OF THE REPORT.               10908940
108935*----------------------------------------------------------       10909040
108936 3130-PROCESS-UNAD-TOTAL.                                         10909140
108937                                                                  10909240
108938     MOVE SPACES               TO DETAIL-01                       10909340
108939                                  DETAIL-VARIABLE.                10909440
108940                                                                  10909540
108941     MOVE PC-UNADVERTISED       TO DTL-01-UNAD-TITLE.             10909640
108942                                                                  10909740
108943*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                10909840
108944     IF PM100-ACTUAL                                              10909940
108946        MOVE TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)                     10910040
108947                                   TO DTL-01-ACTL-SLS-RTL-AMT     10910140
108949                                                                  10910240
108950        IF TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              10910340
108951           CONTINUE                                               10910440
108952        ELSE                                                      10910540
108953           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       10910640
108954                 ((TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) -             10910740
108955                   TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)) /            10910840
108956                   TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)) * -100       10910940
108957                   ON SIZE ERROR                                  10911040
108958                   MOVE 0 TO PV-VOL-PCT-CHG                       10911140
108959           END-COMPUTE                                            10911240
108960           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10911340
108961           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  10911440
108962           IF PV-VOL-PCT-CHG < 0                                  10911540
108963              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 10911640
108964              MOVE PV-FINAL-VOL-PCT                               10911740
108965                                   TO DTL-01-VOL-PCT-CHG          10911840
108966           ELSE                                                   10911940
108967              MOVE PV-ROUND-TO-TENTHS                             10912040
108968                                   TO DTL-VAR-VOL-PCT-CHG         10912140
108969              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          10912240
108970           END-IF                                                 10912340
108974           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         10912440
108976        END-IF                                                    10912540
108977                                                                  10912640
108978        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        10912740
108979                (TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            10912840
108980                (TBL-UATOT-TOT-EOH-INV-QTY(PC-SUB-1) +            10912940
108981                 TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      10913040
108982                 ON SIZE ERROR                                    10913140
108983                 MOVE 0 TO PV-SELL-THRU-PCT                       10913240
108984        END-COMPUTE                                               10913340
108993        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          10913440
108994        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  10913540
108995        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        10913640
108999        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        10913740
109001                                                                  10913840
109003        MOVE TBL-UATOT-TOT-MD-AMT(PC-SUB-1)                       10913940
109004                                   TO DTL-01-ACTL-MD-AMT          10914040
109007        MOVE TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  10914140
109008                                   TO DTL-01-ACTL-UNT-SLD-QTY     10914240
109011        MOVE TBL-UATOT-PREP-UNT-QTY(PC-SUB-1)                     10914340
109012                                   TO DTL-01-ACTL-PREP-UNT-QTY    10914440
109015                                                                  10914540
109016        IF TBL-UATOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              10914640
109018           MOVE ZEROES             TO PV-MU-PCT                   10914740
109019           MOVE PV-MU-PCT          TO DTL-01-ACTL-MU-PCT          10914840
109020           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        10914940
109021        ELSE                                                      10915040
109022           COMPUTE PV-MU-PCT ROUNDED =                            10915140
109023                   ((TBL-UATOT-TOT-SALE-AMT(PC-SUB-1) -           10915240
109024                    TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-1))/        10915340
109025                    TBL-UATOT-TOT-SALE-AMT(PC-SUB-1)) * 100       10915440
109026                    ON SIZE ERROR                                 10915540
109027                    MOVE 0 TO PV-MU-PCT                           10915640
109028           END-COMPUTE                                            10915740
109029           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10915840
109030           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  10915940
109031           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          10916040
109035           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        10916140
109037        END-IF                                                    10916240
109038     END-IF.                                                      10916340
109039                                                                  10916440
109040*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            10916540
109042     MOVE TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)                        10916640
109043                                   TO DTL-01-FCST-SLS-RTL-AMT.    10916740
109046     MOVE TBL-UATOT-TOT-MD-AMT(PC-SUB-2)                          10916840
109047                                   TO DTL-01-FCST-MD-AMT.         10916940
109050     MOVE TBL-UATOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     10917040
109051                                   TO DTL-01-FCST-UNT-SLD-QTY.    10917140
109054     MOVE TBL-UATOT-PREP-UNT-QTY(PC-SUB-2)                        10917240
109055                                   TO DTL-01-FCST-PREP-UNT-QTY.   10917340
109057                                                                  10917440
109058     IF TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 10917540
109059         CONTINUE                                                 10917640
109060     ELSE                                                         10917740
109061         COMPUTE PV-MU-PCT ROUNDED =                              10917840
109062                 ((TBL-UATOT-TOT-SALE-AMT(PC-SUB-2) -             10917940
109063                 TBL-UATOT-TOT-SLS-COST-AMT(PC-SUB-2))/           10918040
109064                 TBL-UATOT-TOT-SALE-AMT(PC-SUB-2)) * 100          10918140
109065                 ON SIZE ERROR                                    10918240
109066                 MOVE 0 TO PV-MU-PCT                              10918340
109067         END-COMPUTE                                              10918440
109068         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          10918540
109069         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  10918640
109070         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          10918740
109074         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        10918840
109076     END-IF.                                                      10918940
109077                                                                  10919040
109078     MOVE 1                    TO PV-ADVANCE-LINES.               10919140
109079     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    10919240
109080     PERFORM 3200-CHECK-MAX-LINE-CNT.                             10919340
109081     MOVE DETAIL-01            TO PV-RPT-LINE.                    10919440
109082     PERFORM 8200-WRITE-RPT-LINE.                                 10919540
109083                                                                  10919640
109084*3130-EXIT.                                                       10919740
109085 EJECT.                                                           10919840
109086                                                                  10919940
109087*----------------------------------------------------------       10920040
109088* 3140-PROCESS-PROMO-TOTAL.                                       10920140
109090*     PROCESS THE PROMOTION TOTAL OF THE REPORT.                  10920240
109100*----------------------------------------------------------       10920340
109200 3140-PROCESS-PROMO-TOTAL.                                        10921040
109300                                                                  10930001
109400     MOVE SPACES               TO DETAIL-01                       10940001
109500                                  DETAIL-VARIABLE.                10950001
109600                                                                  10960001
110300     MOVE PC-DMM-TOTAL          TO DTL-01-NEW-TITLE.              11030004
110600                                                                  11060001
110700*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11070001
110800     IF PM100-ACTUAL                                              11080001
111000        MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                     11100035
111100                                   TO DTL-01-ACTL-SLS-RTL-AMT     11110035
111300                                                                  11130001
111400        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              11140001
111500           CONTINUE                                               11150001
111600        ELSE                                                      11160001
111700           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11170033
111710                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             11171033
111800                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) /            11180033
111900                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * -100       11190033
112000                   ON SIZE ERROR                                  11200001
112100                   MOVE 0 TO PV-VOL-PCT-CHG                       11210001
112200           END-COMPUTE                                            11220001
112300           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11230001
112400           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11240001
112500           IF PV-VOL-PCT-CHG < 0                                  11250001
112600              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11260001
112700              MOVE PV-FINAL-VOL-PCT                               11270001
112800                                   TO DTL-01-VOL-PCT-CHG          11280001
112900           ELSE                                                   11290001
113000              MOVE PV-ROUND-TO-TENTHS                             11300001
113100                                   TO DTL-VAR-VOL-PCT-CHG         11310001
113200              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11320001
113300           END-IF                                                 11330001
113700           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         11370035
113900        END-IF                                                    11390001
114000                                                                  11400001
114040        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11404031
114050                (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            11405031
114060                (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +            11406031
114070                 TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      11407031
114080                 ON SIZE ERROR                                    11408031
114090                 MOVE 0 TO PV-SELL-THRU-PCT                       11409031
114091        END-COMPUTE                                               11409131
114800        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11480001
114900        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11490001
115000        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11500001
115400        MOVE PC-PERCENT-SIGN       TO DTL-01-SELL-PCT-SIGN        11540035
115600                                                                  11560001
115800        MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)                       11580035
115900                                   TO DTL-01-ACTL-MD-AMT          11590035
116200        MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  11620035
116300                                   TO DTL-01-ACTL-UNT-SLD-QTY     11630035
116600        MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                     11660035
116700                                   TO DTL-01-ACTL-PREP-UNT-QTY    11670035
116900                                                                  11690001
117000        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              11700001
117110           MOVE ZEROES             TO PV-MU-PCT                   11711035
117120           MOVE PV-MU-PCT          TO DTL-01-ACTL-MU-PCT          11712035
117130           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11713035
117200        ELSE                                                      11720001
117300           COMPUTE PV-MU-PCT ROUNDED =                            11730001
117400                   ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -           11740001
117500                    TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/        11750001
117600                    TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100       11760001
117700                    ON SIZE ERROR                                 11770001
117800                    MOVE 0 TO PV-MU-PCT                           11780001
117900           END-COMPUTE                                            11790001
118000           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11800001
118100           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11810001
118110           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11811001
118150           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11815035
118170        END-IF                                                    11817001
118180     END-IF.                                                      11818001
118190                                                                  11819001
118191*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11819101
118193     MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                        11819335
118194                                   TO DTL-01-FCST-SLS-RTL-AMT.    11819435
118197     MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)                          11819735
118198                                   TO DTL-01-FCST-MD-AMT.         11819835
118201     MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     11820135
118202                                   TO DTL-01-FCST-UNT-SLD-QTY.    11820235
118205     MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                        11820535
118206                                   TO DTL-01-FCST-PREP-UNT-QTY.   11820635
118208                                                                  11820801
118209     IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 11820901
118210         CONTINUE                                                 11821001
118220     ELSE                                                         11822001
118221         COMPUTE PV-MU-PCT ROUNDED =                              11822101
118222                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             11822201
118223                 TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/           11822301
118224                 TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100          11822401
118225                 ON SIZE ERROR                                    11822501
118226                 MOVE 0 TO PV-MU-PCT                              11822601
118227         END-COMPUTE                                              11822701
118228         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11822801
118229         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11822901
118230         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11823001
118234         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11823435
118236     END-IF.                                                      11823601
118237                                                                  11823701
118238     MOVE 1                     TO PV-ADVANCE-LINES.              11823814
118239     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    11823901
118240     PERFORM 3200-CHECK-MAX-LINE-CNT.                             11824004
118241     MOVE DETAIL-01            TO PV-RPT-LINE.                    11824101
118242     PERFORM 8200-WRITE-RPT-LINE.                                 11824237
118243                                                                  11824301
118244     MOVE 1                    TO PV-ADVANCE-LINES.               11824404
118245     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    11824504
118246     PERFORM 3200-CHECK-MAX-LINE-CNT.                             11824604
118247     MOVE DETAIL-HEADER-02     TO PV-RPT-LINE.                    11824704
118248     PERFORM 8200-WRITE-RPT-LINE.                                 11824837
118249                                                                  11824904
118250*3140-EXIT.                                                       11825004
118251 EJECT.                                                           11825101
118252                                                                  11825201
118253*----------------------------------------------------------       11825301
118254* 3200-CHECK-MAX-LINE-CNT.                                        11825404
118255*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          11825501
118256*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              11825601
118257*----------------------------------------------------------       11825701
118258 3200-CHECK-MAX-LINE-CNT.                                         11825804
118259                                                                  11825901
118260     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             11826001
118261         PERFORM 3300-PROCESS-PAGE-HEADER                         11826104
118262         MOVE 2                  TO PV-ADVANCE-LINES              11826201
118263         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   11826301
118264     END-IF.                                                      11826401
118265                                                                  11826501
118266*3200-EXIT.                                                       11826604
118267 EJECT.                                                           11826701
118270                                                                  11827001
118280*----------------------------------------------------------       11828001
118290* 3300-PROCESS-PAGE-HEADER.                                       11829004
118300*     PROCESS REPORT PAGE HEADERS.                                11830001
118310*----------------------------------------------------------       11831001
118320 3300-PROCESS-PAGE-HEADER.                                        11832004
118330                                                                  11833001
118340     MOVE ZEROES                 TO PV-LINE-CNT.                  11834001
118350     ADD 1                       TO PV-PAGE-CNT.                  11835001
118360     MOVE PV-PAGE-CNT            TO DP200O-PAGE-NUMBER.           11836001
118361     MOVE 1                      TO DP200O-REPORT-NUMBER.         11836101
118362                                                                  11836201
118363     MOVE DP200O-STANDRD-HEADER-200-COLS                          11836301
118364                                 TO PV-RPT-LINE.                  11836401
118365     PERFORM 8100-WRITE-SLS-RPT-NEW-PAGE.                         11836537
118366                                                                  11836601
118367     MOVE HEADER-01              TO PV-RPT-LINE.                  11836701
118368     MOVE 2                      TO PV-ADVANCE-LINES.             11836801
118369     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11836901
118370     PERFORM 8200-WRITE-RPT-LINE.                                 11837037
118371                                                                  11837101
118372     MOVE HEADER-02              TO PV-RPT-LINE.                  11837201
118373     MOVE 1                      TO PV-ADVANCE-LINES.             11837301
118374     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11837401
118375     PERFORM 8200-WRITE-RPT-LINE.                                 11837537
118376                                                                  11837601
118377     MOVE HEADER-03              TO PV-RPT-LINE.                  11837701
118378     MOVE 1                      TO PV-ADVANCE-LINES.             11837801
118379     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11837901
118380     PERFORM 8200-WRITE-RPT-LINE.                                 11838037
118381                                                                  11838101
118382     MOVE HEADER-04              TO PV-RPT-LINE.                  11838203
118383     MOVE 1                      TO PV-ADVANCE-LINES.             11838303
118384     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11838403
118385     PERFORM 8200-WRITE-RPT-LINE.                                 11838537
118386                                                                  11838603
118387     MOVE HEADER-05              TO PV-RPT-LINE.                  11838703
118388     MOVE 1                      TO PV-ADVANCE-LINES.             11838803
118389     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11838903
118390     PERFORM 8200-WRITE-RPT-LINE.                                 11839037
118391                                                                  11839103
118397     MOVE HEADER-06              TO PV-RPT-LINE.                  11839703
118398     MOVE 2                      TO PV-ADVANCE-LINES.             11839801
118399     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11839901
118400     PERFORM 8200-WRITE-RPT-LINE                                  11840037
118401                                                                  11840101
118402     MOVE HEADER-07              TO PV-RPT-LINE.                  11840203
118403     MOVE 1                      TO PV-ADVANCE-LINES.             11840301
118404     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11840401
118405     PERFORM 8200-WRITE-RPT-LINE.                                 11840537
118406                                                                  11840601
118407*3300-EXIT.                                                       11840704
118408 EJECT.                                                           11840801
118409                                                                  11840901
118410*----------------------------------------------------------       11841001
118500* 7000-COUNT-FIELD-LENGTH.                                        11850001
118600*     COUNTS THE ACTUAL FIELD'S LENGTH.                           11860001
118610*----------------------------------------------------------       11861001
118620 7000-COUNT-FIELD-LENGTH.                                         11862001
118630                                                                  11863001
118640     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         11864001
118650     MOVE PV-SAVE-VAR    TO PV-VARIABLE-OUTPUT-FIELD.             11865001
118660                                                                  11866001
118670     MOVE PV-SAVE-NUM TO PV-SUBSCRIPT.                            11867001
118680                                                                  11868001
118690     PERFORM                                                      11869001
118700        VARYING PV-BIT-IDX FROM PV-SAVE-NUM BY -1                 11870001
118701        UNTIL PV-BIT-VARIABLE(PV-BIT-IDX) NOT = SPACES            11870101
118702               OR PV-BIT-IDX = 1                                  11870201
118703        SUBTRACT 1 FROM PV-SUBSCRIPT                              11870301
118704     END-PERFORM.                                                 11870401
118705                                                                  11870501
118706     MOVE PV-SUBSCRIPT TO PV-SAVE-LENGTH.                         11870601
118707                                                                  11870701
118708*7000-EXIT.                                                       11870801
118709 EJECT.                                                           11870901
118710                                                                  11871001
118711*----------------------------------------------------------       11871101
118712* 8000-READ-SLS-GMA-RESULTS.                                      11871201
118713*     READ SALES RESULTS INPUT RECORDS.                           11871301
118714*----------------------------------------------------------       11871401
118715 8000-READ-SLS-GMA-RESULTS.                                       11871501
118716                                                                  11871601
118717     READ PROMO-SUMM-BUY-FILE INTO PM100-PROMO-ITM-SUMM           11871705
118718          AT END                                                  11871801
118719             SET PS-EOF-SLS-RSLTS TO TRUE                         11871905
118720     END-READ.                                                    11872001
118721                                                                  11872101
118722*8000-EXIT.                                                       11875101
118723 EJECT.                                                           11875201
118724                                                                  11875301
118739*----------------------------------------------------------       11875401
118740* 8100-WRITE-SLS-RPT-NEW-PAGE.                                    11875537
118750*     WRITES NEW PAGE.                                            11875601
118760*----------------------------------------------------------       11876001
118761 8100-WRITE-SLS-RPT-NEW-PAGE.                                     11876137
118762                                                                  11876201
118763     WRITE PROMO-SUMM-RPT-LINE                                    11876301
118764           FROM PV-RPT-LINE                                       11876401
118765           AFTER ADVANCING PAGE.                                  11876501
118766                                                                  11876601
118767     ADD 2            TO PV-LINE-CNT.                             11876701
118768                                                                  11876801
118769*8100-EXIT.                                                       11876937
118770 EJECT.                                                           11877001
118771                                                                  11877101
118772*----------------------------------------------------------       11877201
118773* 8200-WRITE-RPT-LINE.                                            11877337
118774*     WRITES OUT A LINE ON THE REPORT.                            11877401
118775*----------------------------------------------------------       11877501
118776 8200-WRITE-RPT-LINE.                                             11877637
118777                                                                  11877701
118778     WRITE PROMO-SUMM-RPT-LINE                                    11877801
118779           FROM PV-RPT-LINE                                       11877901
118780           AFTER ADVANCING PV-ADVANCE-LINES.                      11878001
118781                                                                  11878101
118782*8200-EXIT.                                                       11878237
118783 EJECT.                                                           11878301
118784                                                                  11878401
118797*----------------------------------------------------------       11879701
118798* 9000-ADD-PARENTH-TO-NEG-PCT.                                    11879801
118799*     PUTS PARENTHESES AROUND A NEGATIVE PERCENT FOR THE          11879901
118800*     VOLUME PERCETN CHANGE FIELD.                                11880001
118801*----------------------------------------------------------       11880101
118802 9000-ADD-PARENTH-TO-NEG-PCT.                                     11880201
118803                                                                  11880301
118804     INITIALIZE PV-ROUND-VOL-PCT                                  11880401
118805                PV-TRUNCAT-VOL-PCT                                11880501
118806                PV-NUM-VOL-PCT                                    11880601
118807                PV-FINAL-VOL-PCT                                  11880701
118808                PV-SEP-VOL-PCT                                    11880801
118809                PA-CNT-SPACES.                                    11880901
118810                                                                  11881001
118811     MOVE PV-ROUND-TO-TENTHS      TO PV-ROUND-VOL-PCT.            11881101
118812     MOVE PV-ROUND-VOL-PCT        TO PV-TRUNCAT-VOL-PCT.          11881201
118813     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-NUM-VOL-PCT.              11881301
118814     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-SEP-VOL-PCT.              11881401
118815     INSPECT PV-CHAR-VOL-PCT-1 REPLACING                          11881501
118816             LEADING ZERO BY " ".                                 11881601
118817     INSPECT PV-CHAR-VOL-PCT-1                                    11881701
118818            TALLYING PA-CNT-SPACES FOR ALL " ".                   11881801
118819     EVALUATE TRUE                                                11881901
118820         WHEN PA-CNT-SPACES = 0                                   11882001
118821              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-1         11882101
118822              MOVE PV-SEP-VOL-PCT-1 TO PV-FINAL-VOL-PCT-2         11882201
118823              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         11882301
118824              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11882401
118825              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11882501
118826              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11882624
118827         WHEN PA-CNT-SPACES = 1                                   11882701
118828              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-2         11882801
118829              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         11882901
118830              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11883001
118831              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11883101
118832              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11883224
118833         WHEN PA-CNT-SPACES = 2                                   11883301
118834              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-3         11883401
118835              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11883501
118836              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11883601
118837              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11883724
118838         WHEN PA-CNT-SPACES = 3                                   11883801
118839              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-4         11883901
118840              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11884001
118841              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11884124
118842         WHEN PA-CNT-SPACES = 4                                   11884224
118843              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-5         11884324
118844              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11884424
118845     END-EVALUATE.                                                11884501
118846     MOVE PC-BACK-PAR               TO PV-FINAL-VOL-PCT-7.        11884624
118847                                                                  11884701
118848                                                                  11884801
118849*9000-EXIT.                                                       11884901
118850 EJECT.                                                           11885001
118851                                                                  11885101
118852*----------------------------------------------------------       11885201
118853* 9100-CALENDAR-ROUTINE.                                          11885301
118854*     CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.           11885401
118855*----------------------------------------------------------       11885501
118856 9100-CALENDAR-ROUTINE.                                           11885601
118857                                                                  11885701
118858     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          11885801
118859                                             DPG53 DPG54          11885901
118860                                             DPG55 DPG56.         11886001
118861     EVALUATE TRUE                                                11886101
118862         WHEN DPG54-NO-ERROR                                      11886201
118863             CONTINUE                                             11886301
118864         WHEN DPG54-WARNING-ERROR                                 11886401
118865             DISPLAY '** WARNING - PROGRAM '                      11886501
118866                      PC-CURRENT-PROGRAM-NAME ' **'               11886601
118867             DISPLAY '** 9100-CALENDAR-ROUTINE'                   11886701
118868             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 11886801
118869             DISPLAY '** DPG54-ERROR-MESSAGE: '                   11886901
118870             DISPLAY '** ' DPG54-ERROR-MESSAGE                    11887001
118871             DISPLAY '** DPG51: ' DPG51                           11887101
118872             DISPLAY '** DPG52: ' DPG52                           11887201
118873             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           11887301
118874         WHEN DPG54-SEVERE-ERROR                                  11887401
118875             DISPLAY '** ABEND - PROGRAM '                        11887501
118876                      PC-CURRENT-PROGRAM-NAME ' **'               11887601
118877             DISPLAY '** 9100-CALENDAR-ROUTINE'                   11887701
118878             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  11887801
118879             IF DPG54-CALENDAR-TYPE-INVALID                       11887901
118880                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          11888001
118881                DISPLAY '** DPG51-CALENDAR-TYPE: '                11888101
118882                         DPG51-CALENDAR-TYPE                      11888201
118883             END-IF                                               11888301
118884             IF DPG54-DATE-INVALID                                11888401
118885                DISPLAY '** DPG54-DATE-INVALID'                   11888501
118886                DISPLAY '** DPG52-LK-DATE-INPUT: '                11888601
118887                         DPG52-LK-DATE-INPUT                      11888701
118890             END-IF                                               11889001
118900             IF DPG54-INCR-DECR-INVALID                           11890001
119000                DISPLAY '** DPG54-INCR-DECR-INVALID'              11900001
119100                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     11910001
119200                         DPG51-INCREMENT-DECREMENT-FLAG           11920001
119300             END-IF                                               11930001
119400             MOVE DPG54-ERROR-MESSAGE                             11940001
119500                                 TO PV-OPERATION-MSG-2            11950001
119600             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            11960001
119700             PERFORM 9800-ABEND                                   11970001
119800     END-EVALUATE.                                                11980001
119900                                                                  11990001
120000*9100-EXIT.                                                       12000001
120100 EJECT.                                                           12010001
120200                                                                  12020001
120300*----------------------------------------------------------       12030001
120400* 9800-ABEND.                                                     12040001
120500*     PERFORMS A NON-SQL-ABEND.                                   12050001
120600*----------------------------------------------------------       12060001
120700 9800-ABEND.                                                      12070001
120800                                                                  12080001
120900     DISPLAY '** ABEND           **'.                             12090001
121000     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  12100001
121100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        12110001
121200     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       12120001
121300     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       12130001
121400                                                                  12140001
121500     CALL 'ILBOABN0' USING ABEND-CODE.                            12150001
