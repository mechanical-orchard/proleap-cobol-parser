000100 IDENTIFICATION DIVISION.                                         00010017
000200 PROGRAM-ID.    RCKCS296.                                         00020013
000300 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                  00030013
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040013
000500 DATE-WRITTEN.  JULY 1998.                                        00050013
000600 DATE-COMPILED.                                                   00060013
000700*----------------------------------------------------------------*00070013
000800*    E216 - CONFIRM/VERFIY CRITERIA SPEC SCREEN                   00080013
000900*                                                                 00090013
001000*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY     00100013
001100*    SUBSEQUENT PROGRAMS TO CREATE UPDATABLE LIST SCREENS.        00110013
001200*    THE OPER UNIT IS A REQUIRED FIELD AND MUST EXIST ON THE      00120013
001300*    FACLTY TABLE.  ALL OTHER FIELDS ARE OPTIONAL, BUT WILL BE    00130013
001400*    VALIDATED.                                                   00140013
001500*----------------------------------------------------------------*00150013
001600* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00160027
001700* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00170028
001710* MAKING THE CALL DYNAMIC VS STATIC.                              00171028
001720*---------------------------------------------------------------* 00172028
001800 ENVIRONMENT DIVISION.                                            00180013
001900 DATA DIVISION.                                                   00190013
002000                                                                  00200013
002100 WORKING-STORAGE SECTION.                                         00210013
002200                                                                  00220013
002300 01  DK-DB2-KEYS.                                                 00230013
002400     05  DK-OPER-UNT-ID            PIC  S9(04) COMP.              00240013
002500     05  DK-FCLTY-ID               PIC  S9(04) COMP.              00250013
002600     05  DK-PO                     PIC  S9(09) COMP VALUE +0.     00260018
002700     05  DK-REC-SEQ-NBR            PIC  S9(09) COMP VALUE +0.     00270018
002800                                                                  00280013
002900 01  PC-PROGRAM-CONSTANTS.                                        00290013
003000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'RC296A  '.  00300016
003100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'RCKM296 '.  00310016
003200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'RCKCS296'.  00320016
003210     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00321028
003300     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00330016
003400     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00340016
003500     05  PC-TSYMSG-NUMBERS.                                       00350013
003600         10  PC-TSYMSG-00005       PIC  9(05)  VALUE 00005.       00360016
003700*            INVALID VALUE                                        00370013
003800         10  PC-TSYMSG-00007       PIC  9(05)  VALUE 00007.       00380016
003900*            REQUIRED ENTRY                                       00390013
004000         10  PC-TSYMSG-00008       PIC  9(05)  VALUE 00008.       00400016
004100*            MUST BE NUMERIC                                      00410013
004200         10  PC-TSYMSG-01004       PIC  9(05)  VALUE 01004.       00420016
004300*            INVALID OPERATING UNIT/FACILTY ID ENTERED            00430013
004400     05  PC-INNER-PREPACK          PIC X(06)   VALUE 'INPRPK'.    00440018
004500     05  PC-MULTI-SKU              PIC X(06)   VALUE 'MLTSKU'.    00450018
004600     05  PC-SINGLE-SKU             PIC X(06)   VALUE 'SGLSKU'.    00460018
004700     05  PC-CASEPACK               PIC X(06)   VALUE 'CASEPK'.    00470018
004800     05  PC-BULK                   PIC X(06)   VALUE 'BULK  '.    00480018
004900                                                                  00490013
005000 01  PS-PROGRAM-SWITCHES.                                         00500013
005100     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00510013
005200         88  PS-ERROR                          VALUE  'Y'.        00520013
005300         88  PS-NO-ERROR                       VALUE  'N'.        00530013
005400                                                                  00540013
005500*----------------------------------------------------------------*00550013
005600*    MAP LAYOUT                                                  *00560013
005700*----------------------------------------------------------------*00570013
005900     COPY RCKM296.                                                00590013
006000                                                                  00600023
006100*----------------------------------------------------------------*00610013
006200*    ATTRIBUTE SETTINGS COPYBOOK.                                *00620013
006300*----------------------------------------------------------------*00630013
006500     COPY DPWS015.                                                00650023
006600                                                                  00660013
006700*----------------------------------------------------------------*00670013
006800*    FUNCTION KEYS COPYBOOK                                      *00680013
006900*----------------------------------------------------------------*00690013
007100     COPY DPWS016.                                                00710023
007200                                                                  00720023
007300******************************************************************00730013
007400** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00740013
007500** SUB-ROUTINE (DPKUT100).                                      **00750013
007600******************************************************************00760013
007700     COPY DPWS010I.                                               00770023
007800                                                                  00780023
007900******************************************************************00790013
008000** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **00800028
008100** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **00810013
008200******************************************************************00820013
008300     COPY DPWS030.                                                00830023
008310     COPY DPWS930.                                                00831028
008400                                                                  00840023
008500***************************************************************** 00850013
008600*    STANDARD COMMAREA.                                           00860013
008700***************************************************************** 00870013
008800                                                                  00880013
008900     COPY DPWS020.                                                00890023
009000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                00900013
009100                                                                  00910013
009200***************************************************************** 00920013
009300*    INTER-APPLICATION COMMAREA.                                  00930013
009400***************************************************************** 00940013
009500                                                                  00950013
009600         10  INTER-APPL-COMM-AREA PIC X(200).                     00960013
009700     COPY RCWS015.                                                00970023
009800***************************************************************** 00980013
009900*    SPECIFIC COMMMAREA FOR RCKCS296.                             00990013
010000***************************************************************** 01000013
010100         10  ASC-SPECIFIC-COMMAREA.                               01010013
010200             15  ASC-OPER-UNT-ID             PIC  X(04)           01020013
010300                                 JUSTIFIED RIGHT.                 01030013
010400             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      01040013
010500                                             PIC  9(04).          01050013
010600             15  ASC-FCLTY-ID                PIC  X(04)           01060013
010700                                 JUSTIFIED RIGHT.                 01070013
010800             15  ASC-FCLTY-ID-N  REDEFINES  ASC-FCLTY-ID          01080013
010900                                             PIC  9(04).          01090013
011000             15  ASC-FCLTY-NME               PIC  X(25).          01100013
011100             15  ASC-PO-NBR                  PIC  X(08)           01110014
011200                                 JUSTIFIED RIGHT.                 01120013
011300             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                01130013
011400                                             PIC  9(08).          01140014
011500             15  ASC-REC-SEQ-NBR             PIC  X(04)           01150013
011600                                 JUSTIFIED RIGHT.                 01160013
011700             15  ASC-REC-SEQ-NBR-N REDEFINES ASC-REC-SEQ-NBR      01170013
011800                                             PIC  9(04).          01180013
011900             15  ASC-PO-LINE-NBR             PIC  X(04)           01190013
012000                                 JUSTIFIED RIGHT.                 01200013
012100             15  ASC-PO-LINE-NBR-N REDEFINES ASC-PO-LINE-NBR      01210013
012200                                             PIC  9(04).          01220013
012300             15  ASC-PO-STR-NBR              PIC  X(04)           01230016
012400                                 JUSTIFIED RIGHT.                 01240016
012500             15  ASC-PO-STR-NBR-N REDEFINES ASC-PO-STR-NBR        01250016
012600                                             PIC  9(04).          01260016
012700             15  ASC-LIST-QUEUE-NAME.                             01270016
012800                 20  ASC-LIST-TERM-ID PIC X(04).                  01280016
012900                 20  ASC-LIST-TASK-NUMBER                         01290016
013000                                      PIC S9(05) COMP-3.          01300016
013100                 20  ASC-LIST-SEQ     PIC 9(01).                  01310016
013200             15  ASC-SEL-QUEUE-NAME.                              01320016
013300                 20  ASC-SEL-TERM-ID  PIC X(04).                  01330016
013400                 20  ASC-SEL-TASK-NUMBER                          01340016
013500                                      PIC S9(05) COMP-3.          01350016
013600                 20  ASC-SEL-SEQ      PIC 9(01).                  01360016
013700             15  ASC-PKGNG-CD                PIC  X(01).          01370018
013800                 88  ASC-PRE-PACK-ORDER            VALUE 'I', 'M'.01380018
013900                 88  ASC-INNER-PREPK                    VALUE 'I'.01390018
014000                 88  ASC-MULTI-SKU-PREPK                VALUE 'M'.01400018
014100                 88  ASC-SINGLE-SKU-PREPK               VALUE 'S'.01410018
014200                 88  ASC-CASEPACK                       VALUE 'C'.01420018
014300                 88  ASC-BULK-PACK                      VALUE 'B'.01430018
014400                                                                  01440016
014600*----------------------------------------------------------------*01460016
014700*    ABEND PROCESSING COPYBOOK.                                  *01470016
014800*----------------------------------------------------------------*01480016
015000     COPY DPWS013.                                                01500023
015900                                                                  01590016
015910*----------------------------------------------------------------*01591028
015920*    LOCATION MODULE COPYBOOK.                                   *01592023
015930*----------------------------------------------------------------*01593023
015940     COPY XLWS071.                                                01594023
015950                                                                  01595023
015960*----------------------------------------------------------------*01596023
016000     EXEC SQL                                                     01600018
016100         INCLUDE TRECEIV                                          01610018
016200     END-EXEC.                                                    01620018
016300                                                                  01630018
016900*----------------------------------------------------------------*01690016
017000*    DB2 AREA FOR COMMUNICATIONS                                 *01700016
017100*----------------------------------------------------------------*01710016
017300     EXEC SQL                                                     01730016
017400         INCLUDE SQLCA                                            01740016
017500     END-EXEC.                                                    01750016
017600                                                                  01760016
017700                                                                  01770023
017800 LINKAGE SECTION.                                                 01780016
017900                                                                  01790016
018000 01  DFHCOMMAREA.                                                 01800016
018100     05  FILLER                         OCCURS  1 TO 4072 TIMES   01810016
018200                                        DEPENDING ON EIBCALEN.    01820016
018300         10  FILLER                     PIC X.                    01830016
018400                                                                  01840016
018500                                                                  01850016
018600 PROCEDURE DIVISION.                                              01860016
018800***************************************************************** 01880016
018900** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01890016
019000** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01900016
019100** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01910016
019200**                                                             ** 01920016
019300** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01930016
019400** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01940016
019500***************************************************************** 01950016
019600                                                                  01960016
019700 0000-MAIN-MODULE.                                                01970016
019800                                                                  01980016
019900     INITIALIZE DP030-CICS-API-FIELDS.                            01990016
020000     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         02000016
020100     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            02010016
020200     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           02020016
020300     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         02030016
020400     MOVE LENGTH OF RC296AI      TO DP030-MAP-LENGTH (1).         02040016
020500     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       02050016
020600                                                                  02060016
020700     PERFORM 0001-CALL-CICS-ARCH-API.                             02070016
020800     PERFORM 1000-CONTROL-PROCESSING                              02080016
020900                                                                  02090016
021000     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       02100016
021100     PERFORM 0001-CALL-CICS-ARCH-API.                             02110016
021200                                                                  02120016
021300                                                                  02130016
021400 0001-CALL-CICS-ARCH-API.                                         02140016
021500                                                                  02150016
021610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02161028
021700                                    DFHCOMMAREA                   02170028
021800                                    DP030-CICS-API-FIELDS         02180028
021900                                    DP020-STANDARD-COMMAREA       02190028
022000                                    RC296AI.                      02200028
022100                                                                  02210016
022200     IF  DP030-RC-CALL-SUCCESSFUL                                 02220016
022300         CONTINUE                                                 02230016
022400     ELSE                                                         02240016
022500         SET DP013-NO-ROLLBACK                                    02250016
022600             DP013-XCTL-DISPLAY-RESTART                           02260016
022700             DP013-CICS-ABEND    TO TRUE                          02270016
022800         MOVE 'BEFORE 0000-MAIN-MODULE'                           02280016
022900                                 TO DP013-PARAGRAPH               02290016
022920         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O02292028
022930-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02293028
023200         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        02320016
023300         PERFORM DP013-0000-PROCESS-ABEND                         02330016
023400     END-IF.                                                      02340016
023500                                                                  02350023
023600                                                                  02360016
023700*----------------------------------------------------------------*02370016
023800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02380016
023900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02390016
024000*----------------------------------------------------------------*02400016
024100                                                                  02410016
024200 1000-CONTROL-PROCESSING.                                         02420016
024300                                                                  02430016
024400     EVALUATE TRUE                                                02440016
024500         WHEN DP020-NEXT-ACT-INITIAL                              02450016
024600             INITIALIZE ASC-SPECIFIC-COMMAREA                     02460016
024700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            02470016
024800                                      ASC-SEL-TERM-ID             02480016
024900             MOVE DP020-SRC-TASK-NUMBER                           02490016
025000                                   TO ASC-LIST-TASK-NUMBER        02500016
025100                                      ASC-SEL-TASK-NUMBER         02510016
025200             MOVE PC-LIST-QUEUE-SEQ                               02520016
025300                                   TO ASC-LIST-SEQ                02530016
025400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 02540016
025500             PERFORM 4000-BUILD-INITIAL-PANEL                     02550016
025600                                                                  02560016
025700         WHEN DP020-NEXT-ACT-READ-MAP                             02570016
025800             PERFORM 2000-FKEY-PROCESSING                         02580016
025900                                                                  02590016
026000         WHEN DP020-NEXT-ACT-RETURN                               02600016
026100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02610016
026200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02620016
026300                                                                  02630016
026400         WHEN OTHER                                               02640016
026500             SET DP013-LOGIC-ABEND                                02650016
026600                 DP013-NO-ROLLBACK                                02660016
026700                                 TO TRUE                          02670016
026800             MOVE '1000-CONTROL-PROCESSING'                       02680016
026900                                 TO  DP013-PARAGRAPH              02690016
027000             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02700016
027100                                 TO  DP013-MESSAGE-TEXT(1)        02710016
027200             MOVE DP020-NEXT-APPL-ACTIVITY                        02720016
027300                                 TO DP013-MESSAGE-TEXT(2)         02730016
027400             PERFORM DP013-0000-PROCESS-ABEND                     02740016
027500     END-EVALUATE.                                                02750016
027600                                                                  02760016
027700*----------------------------------------------------------------*02770016
027800* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02780016
027900* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02790016
028000* EDITS.                                                         *02800016
028100*----------------------------------------------------------------*02810016
028200                                                                  02820016
028300 2000-FKEY-PROCESSING.                                            02830016
028400                                                                  02840016
028500     EVALUATE TRUE                                                02850016
028600                                                                  02860016
028700         WHEN DP020-SRC-AID = DP016-CLEAR                         02870016
028800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02880016
028900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02890016
029000                                                                  02900016
029100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     02910016
029200             INITIALIZE ASC-SPECIFIC-COMMAREA                     02920016
029300             PERFORM 4000-BUILD-INITIAL-PANEL                     02930016
029400             PERFORM 3100-RESET-ATTRIBUTES                        02940016
029500                                                                  02950016
029600         WHEN OTHER                                               02960016
029700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02970016
029800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02980016
029900             IF  PS-NO-ERROR                                      02990016
030000                 SET DP030-CONTINUE-GO                            03000016
030100                                 TO TRUE                          03010016
030200                 PERFORM 2100-CHECK-FUNCTION-KEY                  03020016
030300             ELSE                                                 03030016
030400                 SET DP030-OVERRIDE-GO                            03040016
030500                                 TO TRUE                          03050016
030600             END-IF                                               03060016
030700     END-EVALUATE.                                                03070016
030800                                                                  03080016
030900******************************************************************03090016
031000** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03100016
031100** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03110016
031200** FROM THE CICS ARCHITECTURE API.                              **03120016
031300******************************************************************03130016
031400                                                                  03140016
031500 2100-CHECK-FUNCTION-KEY.                                         03150016
031600                                                                  03160016
031700     EVALUATE TRUE                                                03170016
031800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03180016
031900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03190016
032000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03200016
032100         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              03210017
032200             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03220016
032300                                                                  03230016
032400         WHEN DP020-SRC-AID = DP016-ENTER                         03240016
032500             CONTINUE                                             03250016
032600                                                                  03260016
032700         WHEN OTHER                                               03270016
032800             SET DP013-NO-ROLLBACK                                03280016
032900                 DP013-XCTL-DISPLAY-RESTART                       03290016
033000                 DP013-CICS-ABEND                                 03300016
033100                                 TO TRUE                          03310016
033200             MOVE '2100-CHECK-FUNCTION-KEY'                       03320016
033300                                 TO DP013-PARAGRAPH               03330016
033400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03340016
033500                                 TO DP013-MESSAGE-TEXT (1)        03350016
033600             PERFORM DP013-0000-PROCESS-ABEND                     03360016
033700     END-EVALUATE.                                                03370016
033800                                                                  03380016
033900******************************************************************03390016
034000** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03400016
034100** INTER-APPLICATION COMMAREA.                                  **03410016
034200******************************************************************03420016
034300                                                                  03430016
034400 2110-PREPARE-INTER-APPL-COMM.                                    03440016
034500                                                                  03450016
034600     INITIALIZE RC015-INTER-APPL-COMMAREA.                        03460016
034700     MOVE ASC-OPER-UNT-ID-N      TO RC015-OPER-UNT-ID.            03470016
034800     MOVE ASC-FCLTY-ID-N         TO RC015-FCLTY-ID.               03480016
034900     MOVE ASC-PO-NBR-N           TO RC015-PO-NBR                  03490016
035000     MOVE ASC-REC-SEQ-NBR-N      TO RC015-REC-SEQ-NBR             03500016
035100     MOVE ASC-PO-LINE-NBR-N      TO RC015-PO-LNE-NBR.             03510016
035200     MOVE ASC-PO-STR-NBR-N       TO RC015-STR-NBR.                03520016
035300     MOVE ASC-SEL-QUEUE-NAME     TO RC015-SEL-QUEUE-NAME.         03530016
035400                                                                  03540023
035500                                                                  03550016
035600*----------------------------------------------------------------*03560016
035700* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03570016
035800* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03580016
035900* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03590016
036000*----------------------------------------------------------------*03600016
036100                                                                  03610016
036200 2200-MOVE-SCREEN-TO-COMMAREA.                                    03620016
036300                                                                  03630016
036400     IF  AOPERL > ZERO                                            03640016
036500         MOVE AOPERI               TO ASC-OPER-UNT-ID             03650016
036600     ELSE                                                         03660016
036700         IF  AOPERF = DP015-ERASE-EOF                             03670016
036800             MOVE SPACE            TO ASC-OPER-UNT-ID             03680016
036900         END-IF                                                   03690016
037000     END-IF.                                                      03700016
037100                                                                  03710016
037200     IF  AFCLTYL > ZERO                                           03720016
037300         MOVE AFCLTYI              TO ASC-FCLTY-ID                03730016
037400     ELSE                                                         03740016
037500         IF  AFCLTYF = DP015-ERASE-EOF                            03750016
037600             MOVE SPACE            TO ASC-FCLTY-ID                03760016
037700         END-IF                                                   03770016
037800     END-IF.                                                      03780016
037900                                                                  03790016
038000     IF  APOL > ZERO                                              03800016
038100         MOVE APOI                 TO ASC-PO-NBR                  03810016
038200     ELSE                                                         03820016
038300         IF  APOF = DP015-ERASE-EOF                               03830016
038400             MOVE SPACE            TO ASC-PO-NBR                  03840016
038500         END-IF                                                   03850016
038600     END-IF.                                                      03860016
038700                                                                  03870016
038800     IF  ARECSEQL > ZERO                                          03880016
038900         MOVE ARECSEQI             TO ASC-REC-SEQ-NBR             03890016
039000     ELSE                                                         03900016
039100         IF  ARECSEQF = DP015-ERASE-EOF                           03910016
039200             MOVE SPACE            TO ASC-REC-SEQ-NBR             03920016
039300         END-IF                                                   03930016
039400     END-IF.                                                      03940016
039500                                                                  03950016
039600     IF  APOLINEL > ZERO                                          03960016
039700         MOVE APOLINEI             TO ASC-PO-LINE-NBR             03970016
039800     ELSE                                                         03980016
039900         IF  APOLINEF = DP015-ERASE-EOF                           03990016
040000             MOVE SPACE            TO ASC-PO-LINE-NBR             04000016
040100         END-IF                                                   04010016
040200     END-IF.                                                      04020016
040300                                                                  04030016
040400     IF  APOSTRL > ZERO                                           04040016
040500         MOVE APOSTRI              TO ASC-PO-STR-NBR              04050016
040600     ELSE                                                         04060016
040700         IF  APOSTRF = DP015-ERASE-EOF                            04070016
040800             MOVE SPACE            TO ASC-PO-STR-NBR              04080016
040900         END-IF                                                   04090016
041000     END-IF.                                                      04100016
041100                                                                  04110016
041200*----------------------------------------------------------------*04120016
041300* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04130016
041400* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04140016
041500* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*04150016
041600* IN THE DESTINATION PROGRAM, NOT HERE.                          *04160016
041700*----------------------------------------------------------------*04170016
041800 3000-EDIT-DATA-IN-COMMAREA.                                      04180016
041900                                                                  04190016
042000     PERFORM 3100-RESET-ATTRIBUTES.                               04200016
042100                                                                  04210020
042200* OPER UNIT                                                       04220019
042300     IF ASC-OPER-UNT-ID = SPACES OR ZEROES                        04230019
042400         SET PS-ERROR                                             04240019
042500             DP020-MSG-FATAL         TO TRUE                      04250019
042600         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          04260019
042700         MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                    04270019
042800         MOVE DP015-RED              TO AOPERC                    04280019
042900         MOVE DP015-REVERSE          TO AOPERH                    04290019
043000         MOVE -1                     TO AOPERL                    04300019
043100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      04310019
043200     END-IF.                                                      04320019
043300                                                                  04330019
043400     IF PS-NO-ERROR                                               04340019
043500         MOVE ASC-OPER-UNT-ID            TO DP010I-UNEDITED-FIELD 04350019
043600         MOVE LENGTH OF ASC-OPER-UNT-ID  TO DP010I-MAXIMUM-DIGITS 04360019
043700         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 04370019
043800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04380019
043910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04391027
043920              USING DP010I-NUMERIC-EDIT-AREA                      04392027
044000         IF DP010I-ERROR-DETECTED                                 04400019
044100             SET PS-ERROR                                         04410019
044200                 DP020-MSG-FATAL         TO TRUE                  04420019
044300             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04430019
044400             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                04440019
044500             MOVE DP015-RED              TO AOPERC                04450019
044600             MOVE DP015-REVERSE          TO AOPERH                04460019
044700             MOVE -1                     TO AOPERL                04470019
044800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04480019
044900         ELSE                                                     04490019
045000             MOVE DP010I-NUMERIC-FIELD   TO ASC-OPER-UNT-ID-N     04500019
045100                                            DK-OPER-UNT-ID        04510019
045200             MOVE ASC-OPER-UNT-ID        TO AOPERO                04520019
045300             PERFORM 3300-VALIDATE-OPER-UNT-ID                    04530019
045400         END-IF                                                   04540019
045500     END-IF.                                                      04550019
045600                                                                  04560019
045700* FCLTY ID                                                        04570019
045800     IF ASC-FCLTY-ID = SPACES OR ZEROES                           04580019
045900         MOVE +1 TO ASC-FCLTY-ID-N                                04590019
046000     END-IF.                                                      04600019
046100                                                                  04610019
046200     IF PS-NO-ERROR                                               04620019
046300         MOVE ASC-FCLTY-ID               TO DP010I-UNEDITED-FIELD 04630019
046400         MOVE LENGTH OF ASC-FCLTY-ID     TO DP010I-MAXIMUM-DIGITS 04640019
046500         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 04650019
046600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04660019
046710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04671027
046720              USING DP010I-NUMERIC-EDIT-AREA                      04672027
046800         IF DP010I-ERROR-DETECTED                                 04680019
046900             SET PS-ERROR                                         04690019
047000                 DP020-MSG-FATAL         TO TRUE                  04700019
047100             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04710019
047200             MOVE DP015-UNP-ALP-BRT-OFF  TO AFCLTYA               04720019
047300             MOVE DP015-RED              TO AFCLTYC               04730019
047400             MOVE DP015-REVERSE          TO AFCLTYH               04740019
047500             MOVE -1                     TO AFCLTYL               04750019
047600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04760019
047700         ELSE                                                     04770019
047800             MOVE DP010I-NUMERIC-FIELD   TO ASC-FCLTY-ID-N        04780019
047900                                            DK-FCLTY-ID           04790019
048000             MOVE ASC-FCLTY-ID           TO AFCLTYO               04800019
048100         END-IF                                                   04810019
048200     END-IF.                                                      04820019
048300                                                                  04830019
048400     IF PS-NO-ERROR                                               04840019
048500         PERFORM 3200-VALIDATE-FCLTY-ID                           04850019
048600     END-IF.                                                      04860019
048700                                                                  04870019
048800* PO NUMBER                                                       04880016
048900     IF PS-NO-ERROR                                               04890019
049000         MOVE ASC-PO-NBR                 TO DP010I-UNEDITED-FIELD 04900019
049100         MOVE LENGTH OF ASC-PO-NBR       TO DP010I-MAXIMUM-DIGITS 04910019
049200         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 04920019
049300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04930019
049410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04941027
049420              USING DP010I-NUMERIC-EDIT-AREA                      04942027
049500         IF DP010I-ERROR-DETECTED                                 04950019
049600             SET PS-ERROR                                         04960019
049700                 DP020-MSG-FATAL         TO TRUE                  04970019
049800             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04980019
049900             MOVE DP015-UNP-ALP-BRT-OFF  TO APOA                  04990019
050000             MOVE DP015-RED              TO APOC                  05000019
050100             MOVE DP015-REVERSE          TO APOH                  05010019
050200             MOVE -1                     TO APOL                  05020019
050300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05030019
050400         ELSE                                                     05040019
050500             MOVE DP010I-NUMERIC-FIELD   TO ASC-PO-NBR-N          05050019
050600                                                                  05060019
050700             IF (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)           05070019
050800               OR DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          05080019
050900*              OR DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)          05090022
051000               OR DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID))         05100019
051100                AND (ASC-PO-NBR-N = ZERO)                         05110019
051200                 SET PS-ERROR                                     05120019
051300                     DP020-MSG-FATAL     TO TRUE                  05130019
051400                 MOVE SPACES             TO ASC-FCLTY-NME         05140019
051500                                            ADESCO                05150019
051600                 MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER      05160019
051700                 MOVE DP015-UNP-ALP-BRT-OFF                       05170019
051800                                         TO APOA                  05180019
051900                 MOVE DP015-RED          TO APOC                  05190019
052000                 MOVE DP015-REVERSE      TO APOH                  05200019
052100                 MOVE -1                 TO APOL                  05210019
052200                 SET DP030-SET-CURSOR-APPL-1                      05220019
052300                                         TO TRUE                  05230019
052400             END-IF                                               05240019
052500         END-IF                                                   05250019
052600     END-IF.                                                      05260019
052700                                                                  05270016
052800* RECEIVER NUMBER                                                 05280019
052900     IF PS-NO-ERROR                                               05290019
053000         MOVE ASC-REC-SEQ-NBR            TO DP010I-UNEDITED-FIELD 05300019
053100         MOVE LENGTH OF ASC-REC-SEQ-NBR  TO DP010I-MAXIMUM-DIGITS 05310019
053200         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 05320019
053300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  05330019
053410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05341027
053420              USING DP010I-NUMERIC-EDIT-AREA                      05342027
053500         IF DP010I-ERROR-DETECTED                                 05350019
053600             SET PS-ERROR                                         05360019
053700                 DP020-MSG-FATAL         TO TRUE                  05370019
053800             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      05380019
053900             MOVE DP015-UNP-ALP-BRT-OFF  TO ARECSEQA              05390019
054000             MOVE DP015-RED              TO ARECSEQC              05400019
054100             MOVE DP015-REVERSE          TO ARECSEQH              05410019
054200             MOVE -1                     TO ARECSEQL              05420019
054300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05430019
054400         ELSE                                                     05440019
054500             MOVE DP010I-NUMERIC-FIELD   TO ASC-REC-SEQ-NBR-N     05450019
054600                                                                  05460019
054700             IF (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)           05470019
054800               OR DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)          05480019
054900*              OR DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)          05490022
055000               OR DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID))         05500019
055100                AND (ASC-REC-SEQ-NBR-N = ZERO)                    05510019
055200                 SET PS-ERROR                                     05520019
055300                     DP020-MSG-FATAL     TO TRUE                  05530019
055400                 MOVE SPACES             TO ASC-FCLTY-NME         05540019
055500                                            ADESCO                05550019
055600                 MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER      05560019
055700                 MOVE DP015-UNP-ALP-BRT-OFF                       05570019
055800                                         TO ARECSEQA              05580019
055900                 MOVE DP015-RED          TO ARECSEQC              05590019
056000                 MOVE DP015-REVERSE      TO ARECSEQH              05600019
056100                 MOVE -1                 TO ARECSEQL              05610019
056200                 SET DP030-SET-CURSOR-APPL-1                      05620019
056300                                         TO TRUE                  05630019
056400             END-IF                                               05640019
056500         END-IF                                                   05650019
056600     END-IF.                                                      05660019
056700                                                                  05670019
056800     IF PS-NO-ERROR                                               05680019
056900       AND ASC-PO-NBR > ZEROES                                    05690019
057000       AND ASC-REC-SEQ-NBR > ZEROES                               05700019
057100         PERFORM 3250-GET-PKG-TYP-CDE                             05710018
057200     END-IF.                                                      05720018
057300                                                                  05730018
057400*  PO LINE NUMBER                                                 05740019
057500     IF PS-NO-ERROR                                               05750019
057600         MOVE ASC-PO-LINE-NBR            TO DP010I-UNEDITED-FIELD 05760019
057700         MOVE LENGTH OF ASC-PO-LINE-NBR  TO DP010I-MAXIMUM-DIGITS 05770019
057800         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 05780019
057900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  05790019
058010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05801027
058020              USING DP010I-NUMERIC-EDIT-AREA                      05802027
058100         IF DP010I-ERROR-DETECTED                                 05810019
058200             SET PS-ERROR                                         05820019
058300                 DP020-MSG-FATAL         TO TRUE                  05830019
058400             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      05840019
058500             MOVE DP015-UNP-ALP-BRT-OFF  TO APOLINEA              05850019
058600             MOVE DP015-RED              TO APOLINEC              05860019
058700             MOVE DP015-REVERSE          TO APOLINEH              05870019
058800             MOVE -1                     TO APOLINEL              05880019
058900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05890019
059000         ELSE                                                     05900019
059100             MOVE DP010I-NUMERIC-FIELD   TO ASC-PO-LINE-NBR-N     05910019
059200                                                                  05920019
059300             IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)            05930019
059400               AND ASC-PO-LINE-NBR-N = ZERO                       05940019
059500                 SET PS-ERROR                                     05950019
059600                     DP020-MSG-FATAL         TO TRUE              05960019
059700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05970019
059800                 MOVE DP015-UNP-ALP-BRT-OFF  TO APOLINEA          05980019
059900                 MOVE DP015-RED              TO APOLINEC          05990019
060000                 MOVE DP015-REVERSE          TO APOLINEH          06000019
060100                 MOVE -1                     TO APOLINEL          06010019
060200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06020019
060300             END-IF                                               06030019
060400         END-IF                                                   06040019
060500     END-IF.                                                      06050019
060600                                                                  06060019
060700*  PO STORE NUMBER                                                06070019
060800     IF PS-NO-ERROR                                               06080019
060900         MOVE ASC-PO-STR-NBR             TO DP010I-UNEDITED-FIELD 06090019
061000         MOVE LENGTH OF ASC-PO-STR-NBR   TO DP010I-MAXIMUM-DIGITS 06100019
061100         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 06110019
061200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  06120019
061310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         06131027
061320              USING DP010I-NUMERIC-EDIT-AREA                      06132027
061400         IF DP010I-ERROR-DETECTED                                 06140019
061500             SET PS-ERROR                                         06150019
061600                 DP020-MSG-FATAL         TO TRUE                  06160019
061700             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      06170019
061800             MOVE DP015-UNP-ALP-BRT-OFF  TO APOSTRA               06180019
061900             MOVE DP015-RED              TO APOSTRC               06190019
062000             MOVE DP015-REVERSE          TO APOSTRH               06200019
062100             MOVE -1                     TO APOSTRL               06210019
062200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06220019
062300         ELSE                                                     06230019
062400             MOVE DP010I-NUMERIC-FIELD   TO ASC-PO-STR-NBR-N      06240019
062500                                                                  06250019
062600             IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)            06260019
062700               AND ASC-PO-STR-NBR-N = ZERO                        06270019
062800                 SET PS-ERROR                                     06280019
062900                     DP020-MSG-FATAL         TO TRUE              06290019
063000                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  06300019
063100                 MOVE DP015-UNP-ALP-BRT-OFF  TO APOSTRA           06310019
063200                 MOVE DP015-RED              TO APOSTRC           06320019
063300                 MOVE DP015-REVERSE          TO APOSTRH           06330019
063400                 MOVE -1                     TO APOSTRL           06340019
063500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              06350019
063600             END-IF                                               06360019
063700         END-IF                                                   06370019
063800     END-IF.                                                      06380019
063900                                                                  06390019
064000     IF PS-NO-ERROR                                               06400020
064100         MOVE -1                     TO APOL                      06410020
064200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06420020
064300     END-IF.                                                      06430020
064400                                                                  06440020
064500*----------------------------------------------------------------*06450016
064600*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *06460016
064700*  MAP.                                                          *06470016
064800*----------------------------------------------------------------*06480016
064900                                                                  06490016
065000 3100-RESET-ATTRIBUTES.                                           06500016
065100                                                                  06510016
065200***  IF PS-NO-ERROR                                               06520020
065300***      MOVE -1                     TO APOL                      06530020
065400***      SET DP030-SET-CURSOR-APPL-1 TO TRUE                      06540020
065500***  END-IF.                                                      06550020
065600                                                                  06560020
065700     MOVE DP015-UNP-NUM-NOR-OFF    TO AOPERA                      06570016
065800                                      AFCLTYA                     06580016
065900                                      APOA                        06590016
066000                                      ARECSEQA                    06600016
066100                                      APOLINEA                    06610016
066200     MOVE DP015-GREEN              TO AOPERC                      06620016
066300                                      AFCLTYC                     06630016
066400                                      APOC                        06640016
066500                                      ARECSEQC                    06650016
066600                                      APOLINEC                    06660016
066700     MOVE DP015-UNDERLINE          TO AOPERH                      06670016
066800                                      AFCLTYH                     06680016
066900                                      APOH                        06690016
067000                                      ARECSEQH                    06700016
067100                                      APOLINEH.                   06710016
067200                                                                  06720016
067300*----------------------------------------------------------------*06730016
067400*  CHECK THE STORE TABLE TO VERIFY THAT THE FACILITY             *06740016
067500*  ENTERED ON THE MAP IS VALID.                                  *06750016
067600*----------------------------------------------------------------*06760016
067800 3200-VALIDATE-FCLTY-ID.                                          06780016
067900                                                                  06790016
067940     INITIALIZE XL071-COMMAREA-REC.                               06794023
067950     MOVE DK-OPER-UNT-ID         TO XL071-LOCATION-NUMBER.        06795023
067960                                                                  06796023
067970     CALL PC-LOCATION-MODULE  USING                               06797023
067980                                    DFHEIBLK                      06798023
067990                                    XL071-COMMAREA                06799023
067991                                    XL071-COMMAREA-REC.           06799123
067992     EVALUATE TRUE                                                06799223
067993         WHEN XL071-NO-ERRORS                                     06799323
067994             MOVE XL071-LOC-NM  TO  ASC-FCLTY-NME                 06799423
067996                                    ADESCO                        06799623
067997         WHEN XL071-LOC-NOT-FOUND                                 06799723
067998             SET PS-ERROR                                         06799823
067999                 DP020-MSG-FATAL  TO TRUE                         06799923
068000             MOVE SPACES          TO ASC-FCLTY-NME                06800023
068001                                     ADESCO                       06800123
068002             MOVE PC-TSYMSG-01004 TO DP020-MSG-NUMBER             06800223
068003             MOVE DP015-UNP-ALP-BRT-OFF  TO AFCLTYA               06800323
068005             MOVE DP015-RED              TO AFCLTYC               06800523
068006             MOVE DP015-REVERSE          TO AFCLTYH               06800623
068007             MOVE -1                     TO AFCLTYL               06800723
068008             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  06800823
068010         WHEN XL071-BAD-DB2-RETURN                                06801023
071300             MOVE '3200-VALIDATE-FCLTY-ID'  TO DP013-PARAGRAPH    07130023
071500             MOVE 'SELECT STORE NAME'  TO DP013-MESSAGE-TEXT (1)  07150023
071700             MOVE SQLCA      TO DP013-SQLCA                       07170023
071800             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)          07180023
071900             SET DP013-DB2-ABEND             TO TRUE              07190023
072100             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              07210023
072300             PERFORM DP013-0000-PROCESS-ABEND                     07230023
072400     END-EVALUATE.                                                07240023
072600                                                                  07260018
072700*----------------------------------------------------------------*07270018
072800*  GET PACKAGE TYPE CODE FOR PO-RCVR                             *07280018
072900*----------------------------------------------------------------*07290018
073000 3250-GET-PKG-TYP-CDE.                                            07300018
073100     MOVE ASC-PO-NBR       TO  DK-PO.                             07310018
073200     MOVE ASC-REC-SEQ-NBR  TO  DK-REC-SEQ-NBR.                    07320018
073300                                                                  07330018
073400     EXEC SQL                                                     07340018
073500          SELECT   PKGNG_CDE                                      07350018
073600            INTO  :ASC-PKGNG-CD                                   07360018
073700            FROM TRECEIV                                          07370018
073800           WHERE ORD_NBR       =  :DK-PO                          07380018
073900             AND REC_SEQ_NBR   =  :DK-REC-SEQ-NBR                 07390018
074000     END-EXEC.                                                    07400018
074100                                                                  07410018
074200     EVALUATE TRUE                                                07420018
074300         WHEN SQLCODE = ZERO                                      07430018
074400              IF  ASC-PRE-PACK-ORDER                              07440018
074500                  MOVE DP015-YELLOW    TO MPKGCDC                 07450018
074600              ELSE                                                07460021
074700                  MOVE DP015-BLUE      TO MPKGCDC                 07470021
074800              END-IF                                              07480021
074900              IF  ASC-INNER-PREPK                                 07490018
075000                  MOVE  PC-INNER-PREPACK TO MPKGCDO               07500018
075100              ELSE                                                07510018
075200              IF  ASC-MULTI-SKU-PREPK                             07520018
075300                  MOVE  PC-MULTI-SKU     TO MPKGCDO               07530018
075400              ELSE                                                07540018
075500              IF  ASC-SINGLE-SKU-PREPK                            07550018
075600                  MOVE  PC-SINGLE-SKU    TO MPKGCDO               07560018
075700              ELSE                                                07570018
075800              IF  ASC-CASEPACK                                    07580018
075900                  MOVE  PC-CASEPACK      TO MPKGCDO               07590018
076000              ELSE                                                07600018
076100              IF  ASC-BULK-PACK                                   07610018
076200                  MOVE  PC-BULK          TO MPKGCDO               07620018
076300              END-IF                                              07630018
076400              END-IF                                              07640018
076500              END-IF                                              07650018
076600              END-IF                                              07660018
076700              END-IF                                              07670018
076800         WHEN SQLCODE = +100                                      07680018
076900              MOVE SPACES           TO MPKGCDO                    07690018
077000                                                                  07700018
077100         WHEN SQLWARN0 NOT = SPACES                               07710018
077200         WHEN SQLCODE < ZERO                                      07720018
077300         WHEN SQLCODE > ZERO                                      07730018
077400              MOVE '3250-GET-PKG-TYP-CDE'                         07740018
077500                                  TO DP013-PARAGRAPH              07750018
077600              MOVE 'SELECT PACKAGING TYPE CODE  '                 07760018
077700                                  TO DP013-MESSAGE-TEXT (1)       07770018
077800              MOVE SQLCA          TO DP013-SQLCA                  07780018
077900              MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (1)     07790018
078000              SET DP013-DB2-ABEND TO TRUE                         07800018
078100              SET DP013-XCTL-DISPLAY-RESTART TO TRUE              07810018
078200              PERFORM DP013-0000-PROCESS-ABEND                    07820018
078300     END-EVALUATE.                                                07830018
078400                                                                  07840018
078700*----------------------------------------------------------------*07870016
078800*  CHECK THE OPER UNIT TABLE TO VERIFY THE OPER UNIT             *07880016
078900*  ENTERED ON THE MAP IS VALID.                                  *07890016
079000*----------------------------------------------------------------*07900016
079200 3300-VALIDATE-OPER-UNT-ID.                                       07920016
079300                                                                  07930016
079340     INITIALIZE XL071-COMMAREA-REC.                               07934023
079350     MOVE DK-OPER-UNT-ID         TO XL071-LOCATION-NUMBER.        07935023
079360                                                                  07936023
079370     CALL PC-LOCATION-MODULE  USING                               07937023
079380                                    DFHEIBLK                      07938023
079390                                    XL071-COMMAREA                07939023
079391                                    XL071-COMMAREA-REC.           07939123
079392     EVALUATE TRUE                                                07939223
079393         WHEN XL071-NO-ERRORS                                     07939323
079394             IF XL071-LOC-TYP-CDE = 'DC' OR 'HQ'                  07939424
079395                 CONTINUE                                         07939524
079396             ELSE                                                 07939624
079397                 SET PS-ERROR                                     07939724
079398                     DP020-MSG-FATAL  TO TRUE                     07939824
079399                 MOVE PC-TSYMSG-01004 TO DP020-MSG-NUMBER         07939924
079400                 MOVE SPACES          TO ASC-FCLTY-NME            07940024
079401                                         ADESCO                   07940124
079402                 MOVE DP015-UNP-ALP-BRT-OFF     TO AOPERA         07940224
079403                 MOVE DP015-RED                 TO AOPERC         07940324
079404                 MOVE DP015-REVERSE             TO AOPERH         07940424
079405                 MOVE -1                        TO AOPERL         07940524
079406                 SET DP030-SET-CURSOR-APPL-1    TO TRUE           07940624
079407             END-IF                                               07940724
079408         WHEN XL071-LOC-NOT-FOUND                                 07940824
079409             SET PS-ERROR                                         07940924
079410                 DP020-MSG-FATAL  TO TRUE                         07941024
079411             MOVE PC-TSYMSG-01004 TO DP020-MSG-NUMBER             07941124
079412             MOVE SPACES          TO ASC-FCLTY-NME                07941224
079413                                     ADESCO                       07941324
079414             MOVE DP015-UNP-ALP-BRT-OFF     TO AOPERA             07941424
079415             MOVE DP015-RED                 TO AOPERC             07941524
079416             MOVE DP015-REVERSE             TO AOPERH             07941624
079417             MOVE -1                        TO AOPERL             07941724
079418             SET DP030-SET-CURSOR-APPL-1    TO TRUE               07941824
079419         WHEN XL071-BAD-DB2-RETURN                                07941923
079420             MOVE '3300-VALIDATE-OPER-ID'  TO DP013-PARAGRAPH     07942023
079421             MOVE 'SELECT OPER UNIT '  TO DP013-MESSAGE-TEXT (1)  07942123
079422             MOVE SQLCA      TO DP013-SQLCA                       07942223
079423             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)          07942323
079424             SET DP013-DB2-ABEND             TO TRUE              07942423
079425             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              07942523
079426             PERFORM DP013-0000-PROCESS-ABEND                     07942623
079427     END-EVALUATE.                                                07942723
079430                                                                  07943023
084000*----------------------------------------------------------------*08400016
084100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *08410016
084200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *08420016
084300*  IT HERE.                                                      *08430016
084400*----------------------------------------------------------------*08440016
084600 4000-BUILD-INITIAL-PANEL.                                        08460016
084700                                                                  08470016
084800     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          08480020
084900     MOVE -1                     TO APOL                          08490016
085000     MOVE DP020-LOCATION-NBR     TO ASC-OPER-UNT-ID               08500026
085100     INSPECT ASC-OPER-UNT-ID REPLACING ALL SPACES BY ZERO.        08510016
085200     MOVE ASC-OPER-UNT-ID-N      TO DK-OPER-UNT-ID                08520016
085300                                                                  08530016
085400     MOVE DP020-FCLTY-ID         TO ASC-FCLTY-ID                  08540016
085500     INSPECT ASC-FCLTY-ID REPLACING ALL SPACES BY ZERO.           08550016
085600     MOVE ASC-FCLTY-ID-N         TO DK-FCLTY-ID                   08560016
085700     PERFORM 3200-VALIDATE-FCLTY-ID.                              08570016
085800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        08580016
085900                                                                  08590016
086000*----------------------------------------------------------------*08600016
086100*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *08610016
086200*----------------------------------------------------------------*08620016
086300                                                                  08630016
086400 4400-MOVE-COMMAREA-TO-SCREEN.                                    08640016
086500                                                                  08650016
086600     MOVE ASC-OPER-UNT-ID-N      TO AOPERO.                       08660016
086700     MOVE ASC-FCLTY-ID-N         TO AFCLTYO.                      08670016
086800     MOVE ASC-FCLTY-NME          TO ADESCO.                       08680016
086900     MOVE ASC-PO-NBR             TO APOO                          08690016
087000     MOVE ASC-REC-SEQ-NBR        TO ARECSEQO                      08700016
087100     MOVE ASC-PO-LINE-NBR        TO APOLINEO.                     08710016
087200     MOVE ASC-PO-STR-NBR         TO APOSTRO.                      08720016
087300                                                                  08730023
087400*----------------------------------------------------------------*08740016
087500*    ABEND PROCESSOR MODULE                                      *08750016
087600*----------------------------------------------------------------*08760016
087700                                                                  08770016
087800     COPY DPPD013.                                                08780023
