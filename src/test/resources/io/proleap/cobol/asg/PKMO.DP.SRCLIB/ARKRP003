000100******************************************************************00010007
000200 IDENTIFICATION DIVISION.                                         00020003
000300******************************************************************00030001
000400                                                                  00040003
000500 PROGRAM-ID.             ARKRP003.                                00050003
000600 AUTHOR.                 RICK TULLOCH.                            00060003
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070003
000800 DATE-WRITTEN            9-12-88.                                 00080003
000900 DATE-COMPILED.                                                   00090003
001000                                                                  00100003
001100******************************************************************00110003
001200*       THIS PROGRAM WILL SEQUENTIALLY PROCESS SORTED ACCOUNTS   *00120003
001300*  RECEIVABLE TRANSACTIONS, AND PRODUCE A SUMMARY OF TRANSACTION *00130003
001400*  COUNTS AND DOLLAR AMOUNTS BY TRANSACTION SOURCE, RESPONSIBLE  *00140003
001500*  USER (USERID), AND TRANSACTION CODE, BEFORE EDITING AND       *00150003
001600*  REFORMATTING INPUT TRANSACTIONS FOR CITICORP.  ANY INVALID    *00160003
001700*  TRANSACTION CODES WILL BE PLACED UNDER A CATCH-ALL            *00170003
001800*  TRANSACTION CODE OF 'INV'.  EACH CONTROL BREAK (COMPANY       *00180003
001900*  TOTAL, TRANSACTION SOURCE, AND USERID) WILL PRINT A BLOCK OF  *00190003
002000*  INFORMATION FOR EACH TRANSACTION CODE THAT HAD ACTIVITY AT    *00200003
002100*  THAT LEVEL OF DETAIL.  PAGE BREAKS WILL OCCUR AT CHANGES IN   *00210003
002200*  TRANSACTION SOURCE, AND BEFORE THE COMPANY TOTAL PAGE IS      *00220003
002300*  PRINTED.                                                      *00230003
002400*       ACCOUNTS RECEIVABLE TRANSACTIONS MUST BE SORTED BY       *00240003
002500*  ASCENDING TRANSACTION SOURCE, USERID, AND TRANSACTION CODE.   *00250003
002600******************************************************************00260003
002700******************************************************************00270007
002800*  01/17/2000 BRAD GROCHOWSKI                                    *00280007
002900*  RECOMPILE WITH UPDATED ARRD001I COPYBOOK. SALES TAX PROJECT.  *00290007
003000*  (WR#20264)                                                    *00300007
003100******************************************************************00310007
003210******************************************************************00321009
003220*  02/16/2001 KATHY PRIESTER                                     *00322009
003230*  RECOMPILE WITH UPDATED ARRD001I COPYBOOK. ECOMMERCE PROJECT.  *00323009
003250******************************************************************00325009
003251*  05/03/2001 BARB ERTL - SAFENET CONSULTING                     *00325110
003252*  RECOMPILE WITH UPDATED ARRD001I COPYBOOK. ECOMMERCE PROJECT.  *00325210
003253******************************************************************00325310
003251*  12/19/2002 JOANNE PIETROSKE                                   *00325413
003252*  CHANGED COPYBOOK ARRD001 TO INCREASE OPERATOR ID FIELD FROM   *00325513
003252*  6 TO 9 BYTES.  NEEDED TO RECOMPILE ONLY.                      *00325615
003253******************************************************************00325813
P9696 ******************************************************************00325919
P9696 *  02/17/2014 COGNIZANT                                          *00326019
P9696 *  CHANGED THE RECORD LENGTH OF INPUT FILE TO 311. SINCE THE     *00326119
P9696 *  COPYBOOK ARRD001 IS MODIFIED AND ADDED WITH ADDITIONAL FIELDS.*00326220
P9696 ******************************************************************00326419
CFEES *  11/09/2016 BARB SCHULTZ                                       *00326621
CFEES *  CHANGED THE RECORD LENGTH OF INPUT FILE TO 385.               *00326722
CFEES ******************************************************************00326921
003260                                                                  00327013
003300******************************************************************00330003
003400 ENVIRONMENT DIVISION.                                            00340003
003500******************************************************************00350003
003600                                                                  00360003
003700 CONFIGURATION SECTION.                                           00370003
003800                                                                  00380003
003900 SOURCE-COMPUTER.        IBM-3090.                                00390003
004000 OBJECT-COMPUTER.        IBM-3090.                                00400003
004100                                                                  00410003
004200 INPUT-OUTPUT SECTION.                                            00420003
004300                                                                  00430003
004400 FILE-CONTROL.                                                    00440003
004500                                                                  00450003
004600     SELECT AR-TRANSACTION-FILE                                   00460003
004700         ASSIGN TO INP01.                                         00470003
004800                                                                  00480003
004900     SELECT TRANSACTION-SUMMARY-FILE                              00490003
005000         ASSIGN TO RPT01.                                         00500003
005100                                                                  00510003
005200******************************************************************00520003
005300 DATA DIVISION.                                                   00530003
005400******************************************************************00540003
005500                                                                  00550003
005600 FILE SECTION.                                                    00560003
005700                                                                  00570003
005800 FD  AR-TRANSACTION-FILE                                          00580003
005900     RECORDING MODE IS F                                          00590003
006000     LABEL RECORDS ARE STANDARD                                   00600003
006100     BLOCK CONTAINS 0 RECORDS                                     00610003
CFEES      RECORD CONTAINS 385 CHARACTERS                               00620021
006300     DATA RECORD IS AT-AR-TRANSACTION-RECORD.                     00630003
006400                                                                  00640003
CFEES  01  AT-AR-TRANSACTION-RECORD    PIC X(385).                      00650021
006600                                                                  00660003
006700 FD  TRANSACTION-SUMMARY-FILE                                     00670003
006800     RECORDING MODE IS F                                          00680003
006900     LABEL RECORDS ARE STANDARD                                   00690003
007000     BLOCK CONTAINS 0 RECORDS                                     00700003
007100     RECORD CONTAINS 132 CHARACTERS                               00710003
007200     DATA RECORD IS TS-TRANSACTION-SUMMARY-RECORD.                00720003
007300                                                                  00730003
007400 01  TS-TRANSACTION-SUMMARY-RECORD                                00740003
007500                                 PIC X(132).                      00750003
007600                                                                  00760003
007700 WORKING-STORAGE SECTION.                                         00770003
007800                                                                  00780003
007900*                                                                 00790003
008000*  ACCOUNTS RECEIVABLE TRANSACTION FILE RECORD LAYOUT             00800003
008100*                                                                 00810003
008200                                                                  00820003
008300     COPY ARRD001.                                                00830012
008400                                                                  00840003
008500*                                                                 00850003
008600*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT                 00860003
008700*                                                                 00870003
008800                                                                  00880003
008900     COPY DPWS132O.                                               00890012
009000                                                                  00900003
009100*                                                                 00910001
009200*  STANDARD WORKING STORAGE FOR THE CALENDAR ROUTINE              00920001
009300*                                                                 00930001
009400     COPY DPWS500.                                                00940012
009500                                                                  00950003
009600 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         00960012
009700                                 COMP SYNC.                       00970003
009800                                                                  00980003
009900 01  PS-PROGRAM-SWITCHES.                                         00990003
010000     05  PS-END-OF-TRANS-FILE-IND                                 01000003
010100                                 PIC X(1)     VALUE 'N'.          01010003
010200         88  PS-END-OF-TRANS-FILE             VALUE 'Y'.          01020003
010300     05  PS-PRINT-TRANS-SOURCE-IND                                01030003
010400                                 PIC X(1)     VALUE 'Y'.          01040003
010500         88  PS-PRINT-TRANS-SOURCE            VALUE 'Y'.          01050003
010600         88  PS-DONT-PRINT-TRANS-SOURCE       VALUE 'N'.          01060003
010700     05  PS-PRINT-USERID-IND     PIC X(1)     VALUE 'Y'.          01070003
010800         88  PS-PRINT-USERID                  VALUE 'Y'.          01080003
010900         88  PS-DONT-PRINT-USERID             VALUE 'N'.          01090003
011000                                                                  01100003
011100 01  PC-PROGRAM-CONSTANTS.                                        01110003
011200     05  PC-PAGE-SIZE            PIC S9(4)    VALUE +63           01120003
011300                                 COMP SYNC.                       01130003
011400     05  PC-PAGE-BREAK           PIC S9(4)    VALUE +64           01140003
011500                                 COMP SYNC.                       01150003
011600     05  PC-COMPANY-TOTAL-LEVEL  PIC S9(4)    VALUE +3            01160003
011700                                 COMP SYNC.                       01170003
011800     05  PC-TRANS-SOURCE-LEVEL   PIC S9(4)    VALUE +2            01180003
011900                                 COMP SYNC.                       01190003
012000     05  PC-USERID-LEVEL         PIC S9(4)    VALUE +1            01200003
012100                                 COMP SYNC.                       01210003
012200     05  PC-MAXIMUM-VALID-TRANS-CODES                             01220003
012300                                 PIC S9(4)    VALUE +11           01230003
012400                                 COMP SYNC.                       01240003
012500     05  PC-MAXIMUM-TRANS-CODES  PIC S9(4)    VALUE +12           01250003
012600                                 COMP SYNC.                       01260003
012700     05  PC-MAXIMUM-DEBIT-TRANS-CODE                              01270003
012800                                 PIC X(3)     VALUE '199'.        01280003
012900     05  PC-TOTAL-USERID         PIC X(7)     VALUE 'TOTAL'.      01290003
013000                                                                  01300003
013100 01  PV-PROGRAM-VARIABLES.                                        01310003
013200     05  PV-PAGE-COUNT           PIC S9(5)    VALUE ZERO          01320003
013300                                 COMP-3.                          01330003
013400     05  PV-LINE-COUNT           PIC S9(4)    VALUE ZERO          01340003
013500                                 COMP SYNC.                       01350003
013600     05  PV-ADVANCE-COUNT        PIC S9(4)    VALUE ZERO          01360003
013700                                 COMP SYNC.                       01370003
013800                                                                  01380003
013900 01  CD-CURRENT-DATE.                                             01390003
014000     05  CD-CURRENT-YEAR         PIC 9(2)     VALUE ZERO.         01400003
014100     05  CD-CURRENT-MONTH        PIC 9(2)     VALUE ZERO.         01410003
014200     05  CD-CURRENT-DAY          PIC 9(2)     VALUE ZERO.         01420003
014300                                                                  01430003
014400 01  CT-CURRENT-TIME.                                             01440003
014500     05  CT-CURRENT-HOUR         PIC 9(2)     VALUE ZERO.         01450003
014600     05  CT-CURRENT-MINUTE       PIC 9(2)     VALUE ZERO.         01460003
014700     05  FILLER                  PIC 9(4)     VALUE ZERO.         01470003
014800                                                                  01480003
014900 01  CK-CURRENT-KEY-AREA.                                         01490003
015000     05  CK-TRANSACTION-SOURCE   PIC X(1)     VALUE SPACES.       01500003
015100         88  CK-POS-TRANSACTION               VALUE 'P'.          01510003
015200         88  CK-SUSPENSE-TRANSACTION          VALUE 'S'.          01520003
015300         88  CK-MAINTENANCE-TRANSACTION       VALUE 'M'.          01530003
015400         88  CK-COMPANY-TOTAL                 VALUE 'T'.          01540003
015500     05  CK-SUBMITTED-BY-USERID  PIC X(7)     VALUE SPACES.       01550003
015600     05  CK-TRANSACTION-CODE     PIC X(3)     VALUE SPACES.       01560003
015700                                                                  01570003
015800 01  CC-CONTROL-CARD.                                             01580003
015900     05  CC-CONTROL-CARD-DISPLAY.                                 01590003
016000         10  CC-POS-DATE         PIC 9(8)     VALUE ZERO.         01600003
016100         10  CC-POS-DATE-X       REDEFINES CC-POS-DATE.           01610003
016200             15  CC-POS-MONTH    PIC 9(2).                        01620003
016300             15  CC-POS-DAY      PIC 9(2).                        01630003
016400             15  CC-POS-CENTURY  PIC 9(2).                        01640003
016500             15  CC-POS-YEAR     PIC 9(2).                        01650003
016600         10  FILLER              PIC X(29)    VALUE SPACES.       01660003
016700     05  FILLER                  PIC X(43)    VALUE SPACES.       01670003
016800                                                                  01680003
016900 01  TC-TRANSACTION-CODE-DATA.                                    01690003
017000     05  FILLER                  PIC X(48)    VALUE               01700003
017100         '110 120 130 140 190 210 220 230 240 290 310 INV '.      01710003
017200                                                                  01720003
017300 01  TC-TRANSACTION-CODE-TABLE   REDEFINES                        01730003
017400                                     TC-TRANSACTION-CODE-DATA.    01740003
017500     05  TC-TRANSACTION-CODE-ENTRY                                01750003
017600                                 OCCURS 12 TIMES                  01760003
017700                                 INDEXED BY TC-CODE-INDEX.        01770003
017800         10  TC-TRANSACTION-CODE PIC X(3).                        01780003
017900         10  FILLER              PIC X(1).                        01790003
018000                                                                  01800003
018100 01  TT-TRANSACTION-TOTAL-TABLE.                                  01810003
018200     05  TT-LEVEL-OF-DETAIL-ENTRY                                 01820003
018300                                 OCCURS 3 TIMES                   01830003
018400                                 INDEXED BY TT-LEVEL-INDEX.       01840003
018500         10  TT-TRANS-CODE-ENTRY OCCURS 12 TIMES                  01850003
018600                                 INDEXED BY TT-CODE-INDEX.        01860003
018700             15  TT-TRANSACTION-COUNT                             01870003
018800                                 PIC S9(7)                        01880003
018900                                 COMP-3.                          01890003
019000             15  TT-TRANSACTION-AMOUNT                            01900003
019100                                 PIC S9(9)V99                     01910003
019200                                 COMP-3.                          01920003
019300                                                                  01930003
019400 01  HL2-HEADING-LINE-2.                                          01940003
019500     05  FILLER                  PIC X(54)    VALUE SPACES.       01950003
019600     05  FILLER                  PIC X(24)    VALUE               01960003
019700         'TRANSACTION FILE SUMMARY'.                              01970003
019800     05  FILLER                  PIC X(54)    VALUE SPACES.       01980003
019900                                                                  01990003
020000 01  HL3-HEADING-LINE-3.                                          02000003
020100     05  FILLER                  PIC X(54)    VALUE SPACES.       02010003
020200     05  HL3-POS-DATE            PIC 99/99/9999 VALUE ZERO.       02020003
020300     05  FILLER                  PIC X(14)    VALUE               02030003
020400         ' - BEFORE EDIT'.                                        02040003
020500     05  FILLER                  PIC X(54)    VALUE SPACES.       02050003
020600                                                                  02060003
020700 01  HL4-HEADING-LINE-4.                                          02070003
020800     05  FILLER                  PIC X(25)    VALUE SPACES.       02080003
020900     05  FILLER                  PIC X(29)    VALUE               02090003
021000         'TRANSACTION'.                                           02100003
021100     05  FILLER                  PIC X(14)    VALUE 'SUBMITTED'.  02110003
021200     05  FILLER                  PIC X(9)     VALUE 'TRANS'.      02120003
021300     05  FILLER                  PIC X(18)    VALUE               02130003
021400         'TRANSACTION'.                                           02140003
021500     05  FILLER                  PIC X(37)    VALUE               02150003
021600         'TRANSACTION'.                                           02160003
021700                                                                  02170003
021800 01  HL5-HEADING-LINE-5.                                          02180003
021900     05  FILLER                  PIC X(28)    VALUE SPACES.       02190003
022000     05  FILLER                  PIC X(30)    VALUE 'SOURCE'.     02200003
022100     05  FILLER                  PIC X(11)    VALUE 'BY'.         02210003
022200     05  FILLER                  PIC X(11)    VALUE 'CODE'.       02220003
022300     05  FILLER                  PIC X(18)    VALUE 'COUNT'.      02230003
022400     05  FILLER                  PIC X(34)    VALUE 'AMOUNT'.     02240003
022500                                                                  02250003
022600 01  DL-DETAIL-LINE.                                              02260003
022700     05  FILLER                  PIC X(25)    VALUE SPACES.       02270003
022800     05  DL-TRANSACTION-SOURCE   PIC X(25)    VALUE SPACES.       02280003
022900         88  DL-POS-TRANSACTION               VALUE               02290003
023000             'POINT-OF-SALE TRANSACTION'.                         02300003
023100         88  DL-SUSPENSE-TRANSACTION          VALUE               02310003
023200             'SUSPENSE TRANSACTION     '.                         02320003
023300         88  DL-MAINTENANCE-TRANSACTION       VALUE               02330003
023400             'MAINTENANCE TRANSACTION  '.                         02340003
023500         88  DL-COMPANY-TOTAL                 VALUE               02350003
023600             'COMPANY TOTAL            '.                         02360003
023700     05  FILLER                  PIC X(5)     VALUE SPACES.       02370003
023800     05  DL-SUBMITTED-BY-USERID  PIC X(7)     VALUE SPACES.       02380003
023900     05  FILLER                  PIC X(7)     VALUE SPACES.       02390003
024000     05  DL-TRANSACTION-CODE     PIC X(3)     VALUE SPACES.       02400003
024100     05  FILLER                  PIC X(6)     VALUE SPACES.       02410003
024200     05  DL-TRANSACTION-COUNT    PIC Z,ZZZ,ZZ9                    02420003
024300                                              VALUE ZERO.         02430003
024400     05  FILLER                  PIC X(5)     VALUE SPACES.       02440003
024500     05  DL-TRANSACTION-AMOUNT   PIC ZZZ,ZZZ,ZZ9.99-              02450003
024600                                              VALUE ZERO.         02460003
024700     05  FILLER                  PIC X(25)    VALUE SPACES.       02470003
024800                                                                  02480003
024900******************************************************************02490003
025000 PROCEDURE DIVISION.                                              02500003
025100******************************************************************02510003
025200                                                                  02520003
025300 0000-MAINLINE.                                                   02530003
025400     PERFORM 1000-INITIALIZE.                                     02540003
025500                                                                  02550003
025600     PERFORM 2000-PROCESS-TRANS-SOURCE                            02560003
025700         UNTIL PS-END-OF-TRANS-FILE.                              02570003
025800                                                                  02580003
025900     PERFORM 8000-PRINT-TITLE-LINES.                              02590003
026000     SET TT-LEVEL-INDEX TO PC-COMPANY-TOTAL-LEVEL.                02600003
026100     SET CK-COMPANY-TOTAL TO TRUE.                                02610003
026200     MOVE PC-TOTAL-USERID TO CK-SUBMITTED-BY-USERID.              02620003
026300     PERFORM                                                      02630003
026400             VARYING TT-CODE-INDEX                                02640003
026500             FROM 1 BY 1                                          02650003
026600             UNTIL TT-CODE-INDEX > PC-MAXIMUM-TRANS-CODES         02660003
026700         IF TT-TRANSACTION-COUNT                                  02670003
026800                   (TT-LEVEL-INDEX, TT-CODE-INDEX) > ZERO         02680003
026900             PERFORM 5000-PRINT-CONTROL-BREAK-LINE                02690003
027000         END-IF                                                   02700003
027100     END-PERFORM.                                                 02710003
027200                                                                  02720003
027300     PERFORM 9000-EOJ-ROUTINE.                                    02730003
027400                                                                  02740003
027500     STOP RUN.                                                    02750003
027600                                                                  02760003
027700******************************************************************02770003
027800*  SET UP FOR PROGRAM PROCESSING BY ACCEPTING, DISPLAYING, AND   *02780003
027900*  VERIFYING THE CONTROL CARD, OPENING ALL FILES,                *02790003
028000*  FILLING THE FIELDS OF THE STANDARD REPORT HEADER,             *02800003
028100*  READING THE FIRST ACCOUNTS RECEIVABLE TRANSACTION RECORD, AND *02810003
028200*  INITIALIZING THE COMPANY TRANSACTION TOTALS.                  *02820003
028300******************************************************************02830003
028400                                                                  02840003
028500 1000-INITIALIZE.                                                 02850003
028600     ACCEPT CC-CONTROL-CARD.                                      02860003
028700     DISPLAY 'ARKRP003 - CONTROL CARD = ('                        02870003
028800               CC-CONTROL-CARD-DISPLAY  ')'.                      02880003
028900                                                                  02890003
029000     PERFORM 1100-VERIFY-CONTROL-CARD.                            02900003
029100                                                                  02910003
029200     MOVE CC-POS-DATE TO HL3-POS-DATE.                            02920003
029300                                                                  02930003
029400     OPEN INPUT  AR-TRANSACTION-FILE                              02940003
029500          OUTPUT TRANSACTION-SUMMARY-FILE.                        02950003
029600                                                                  02960003
029700     ACCEPT CD-CURRENT-DATE FROM DATE.                            02970003
029800     MOVE CD-CURRENT-YEAR TO DP132O-RUN-YEAR.                     02980003
029900     MOVE CD-CURRENT-MONTH TO DP132O-RUN-MONTH.                   02990003
030000     MOVE CD-CURRENT-DAY TO DP132O-RUN-DAY.                       03000003
030100     ACCEPT CT-CURRENT-TIME FROM TIME.                            03010003
030200     MOVE CT-CURRENT-HOUR TO DP132O-RUN-HOUR.                     03020003
030300     MOVE CT-CURRENT-MINUTE TO DP132O-RUN-MINUTE.                 03030003
030400     MOVE 'ARKRP003' TO DP132O-PROGRAM-NAME.                      03040003
030500     MOVE 1 TO DP132O-REPORT-NUMBER.                              03050003
030600                                                                  03060003
030700     PERFORM 7000-READ-TRANSACTION-FILE.                          03070003
030800                                                                  03080003
030900     INITIALIZE TT-LEVEL-OF-DETAIL-ENTRY (3).                     03090003
031000*1000-EXIT.                                                       03100003
031100                                                                  03110003
031200******************************************************************03120003
031300*  VERIFY THE CONTROL CARD.  INSURE THAT A VALID NUMERIC P.O.S.  *03130003
031400*  DATE HAS BEEN PROVIDED.                                       *03140003
031500******************************************************************03150003
031600                                                                  03160003
031700 1100-VERIFY-CONTROL-CARD.                                        03170003
031800     ACCEPT DPG51-SYSTEM-DATE FROM DATE.                          03180007
031900     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03190007
032000     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     03200007
032100     SET DPG52-LK-DTE-GREG-CC        TO TRUE.                     03210007
032200     MOVE CC-POS-DATE                TO DPG52-LK-DATE-INPUT.      03220007
032300                                                                  03230007
032400     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03240007
032500                                             DPG54 DPG55 DPG56.   03250007
032600     IF DPG54-DATE-INVALID                                        03260007
032700        DISPLAY '*** ABEND ***'                                   03270007
032800        DISPLAY '*** PROGRAM = ARKRP003'                          03280007
032900        DISPLAY '*** PARA = 1100-VERIFY-CONTROL-CARD'             03290007
033000        DISPLAY '*** BAD RESPONSE FROM DATE ROUTINE ***'          03300007
033100        MOVE +4008  TO   ABEND-CODE                               03310007
033200        CALL 'ILBOABN0' USING ABEND-CODE                          03320023
033300     END-IF.                                                      03330007
033400*1100-EXIT.                                                       03340003
033500                                                                  03350003
033600******************************************************************03360003
033700*  PROCESS A TRANSACTION SOURCE.  INITIALIZE TRANSACTION SOURCE  *03370003
033800*  TOTALS.  FORCE A PAGE BREAK TO OCCUR.  PROCESS ALL ACCOUNTS   *03380003
033900*  RECEIVABLE TRANSACTIONS FOR THE CURRENT TRANSACTION SOURCE.   *03390003
034000*  AT THE END, PRODUCE CONTROL BREAK DETAIL LINES FOR ALL        *03400003
034100*  TRANSACTION CODES THAT HAVE TRANSACTIONS ASSOCIATED WITH      *03410003
034200*  THAT TRANSACTION SOURCE AND TRANSACTION CODE.                 *03420003
034300******************************************************************03430003
034400                                                                  03440003
034500 2000-PROCESS-TRANS-SOURCE.                                       03450003
034600     MOVE AR001-TRANSACTION-SOURCE TO CK-TRANSACTION-SOURCE.      03460012
034700     INITIALIZE TT-LEVEL-OF-DETAIL-ENTRY (2).                     03470003
034800     SET PS-PRINT-TRANS-SOURCE TO TRUE.                           03480003
034900     MOVE PC-PAGE-BREAK TO PV-LINE-COUNT.                         03490003
035000                                                                  03500003
035100     PERFORM 3000-PROCESS-USERID                                  03510003
035200         UNTIL PS-END-OF-TRANS-FILE                               03520003
035300                 OR AR001-TRANSACTION-SOURCE NOT =                03530012
035400                                   CK-TRANSACTION-SOURCE.         03540003
035500                                                                  03550003
035600     SET TT-LEVEL-INDEX TO PC-TRANS-SOURCE-LEVEL.                 03560003
035700     MOVE 3 TO PV-ADVANCE-COUNT.                                  03570003
035800     MOVE PC-TOTAL-USERID TO CK-SUBMITTED-BY-USERID.              03580003
035900     SET PS-PRINT-USERID TO TRUE.                                 03590003
036000     PERFORM                                                      03600003
036100             VARYING TT-CODE-INDEX                                03610003
036200             FROM 1 BY 1                                          03620003
036300             UNTIL TT-CODE-INDEX > PC-MAXIMUM-TRANS-CODES         03630003
036400         IF TT-TRANSACTION-COUNT                                  03640003
036500                   (TT-LEVEL-INDEX, TT-CODE-INDEX) > ZERO         03650003
036600             PERFORM 5000-PRINT-CONTROL-BREAK-LINE                03660003
036700         END-IF                                                   03670003
036800     END-PERFORM.                                                 03680003
036900*2000-EXIT.                                                       03690003
037000                                                                  03700003
037100******************************************************************03710003
037200*  PROCESS A USERID.  INITIALIZE USERID TOTALS.  PROCESS ALL     *03720003
037300*  ACCOUNTS RECEIVABLE TRANSACTIONS FOR THE CURRENT USERID.  AT  *03730003
037400*  THE END, PRODUCE CONTROL BREAK DETAIL LINES FOR ALL           *03740003
037500*  TRANSACTION CODES THAT HAVE TRANSACTIONS ASSOCIATED WITH      *03750003
037600*  THAT USERID AND TRANSACTION CODE.                             *03760003
037700******************************************************************03770003
037800                                                                  03780003
037900 3000-PROCESS-USERID.                                             03790003
038000     MOVE AR001-SUBMITTED-BY-USERID TO CK-SUBMITTED-BY-USERID.    03800012
038100     INITIALIZE TT-LEVEL-OF-DETAIL-ENTRY (1).                     03810003
038200     SET PS-PRINT-USERID TO TRUE.                                 03820003
038300                                                                  03830003
038400     PERFORM 4000-PROCESS-TRANS-CODE                              03840003
038500         UNTIL PS-END-OF-TRANS-FILE                               03850003
038600                 OR AR001-TRANSACTION-SOURCE NOT =                03860012
038700                                   CK-TRANSACTION-SOURCE          03870003
038800                 OR AR001-SUBMITTED-BY-USERID NOT =               03880012
038900                                   CK-SUBMITTED-BY-USERID.        03890003
039000                                                                  03900003
039100     SET TT-LEVEL-INDEX TO PC-USERID-LEVEL.                       03910003
039200     MOVE 2 TO PV-ADVANCE-COUNT.                                  03920003
039300     PERFORM                                                      03930003
039400             VARYING TT-CODE-INDEX                                03940003
039500             FROM 1 BY 1                                          03950003
039600             UNTIL TT-CODE-INDEX > PC-MAXIMUM-TRANS-CODES         03960003
039700         IF TT-TRANSACTION-COUNT                                  03970003
039800                   (TT-LEVEL-INDEX, TT-CODE-INDEX) > ZERO         03980003
039900             PERFORM 5000-PRINT-CONTROL-BREAK-LINE                03990003
040000         END-IF                                                   04000003
040100     END-PERFORM.                                                 04010003
040200*3000-EXIT.                                                       04020003
040300                                                                  04030003
040400******************************************************************04040003
040500*  PROCESS A TRANSACTION CODE.  DETERMINE THE INDEX RELATIVE TO  *04050003
040600*  SUMMARY TOTALS FOR THE CURRENT TRANSACTION CODE.  ANY UNKNOWN *04060003
040700*  TRANSACTION CODES WILL DEFAULT TO THE FINAL INDEX LOCATION.   *04070003
040800*  COUNT ALL TRANSACTIONS AND ACCUMULATE ALL TRANSACTION AMOUNTS *04080003
040900*  FOR THE CURRENT TRANSACTION CODE.  CREDIT TRANSACTIONS WILL   *04090003
041000*  BE TREATED AS NEGATIVE DOLLAR AMOUNTS FOR THIS ACCUMULATION.  *04100003
041100******************************************************************04110003
041200                                                                  04120003
041300 4000-PROCESS-TRANS-CODE.                                         04130003
041400     MOVE AR001-TRANSACTION-CODE TO CK-TRANSACTION-CODE.          04140012
041500                                                                  04150003
041600     SET TC-CODE-INDEX TO 1.                                      04160003
041700     PERFORM                                                      04170003
041800             UNTIL TC-CODE-INDEX > PC-MAXIMUM-VALID-TRANS-CODES   04180003
041900                     OR TC-TRANSACTION-CODE (TC-CODE-INDEX) =     04190003
042000                                   CK-TRANSACTION-CODE            04200003
042100         SET TC-CODE-INDEX UP BY 1                                04210003
042200     END-PERFORM.                                                 04220003
042300                                                                  04230003
042400     SET TT-CODE-INDEX TO TC-CODE-INDEX.                          04240003
042500                                                                  04250003
042600     PERFORM                                                      04260003
042700             UNTIL PS-END-OF-TRANS-FILE                           04270003
042800                    OR AR001-TRANSACTION-SOURCE NOT =             04280012
042900                                   CK-TRANSACTION-SOURCE          04290003
043000                    OR AR001-SUBMITTED-BY-USERID NOT =            04300012
043100                                   CK-SUBMITTED-BY-USERID         04310003
043200                    OR AR001-TRANSACTION-CODE NOT =               04320012
043300                                   CK-TRANSACTION-CODE            04330003
043400         ADD 1 TO TT-TRANSACTION-COUNT (1, TT-CODE-INDEX)         04340003
043500         IF CK-TRANSACTION-CODE > PC-MAXIMUM-DEBIT-TRANS-CODE     04350003
043600             SUBTRACT AR001-TRANSACTION-AMOUNT FROM               04360012
043700                       TT-TRANSACTION-AMOUNT (1, TT-CODE-INDEX)   04370003
043800         ELSE                                                     04380003
043900             ADD AR001-TRANSACTION-AMOUNT TO                      04390012
044000                       TT-TRANSACTION-AMOUNT (1, TT-CODE-INDEX)   04400003
044100         END-IF                                                   04410003
044200         PERFORM 7000-READ-TRANSACTION-FILE                       04420003
044300     END-PERFORM.                                                 04430003
044400*4000-EXIT.                                                       04440003
044500                                                                  04450003
044600******************************************************************04460003
044700*  FORMAT AND PRINT A CONTROL BREAK LINE FOR A PARTICULAR        *04470003
044800*  TRANSACTION CODE.  PRINT THE CURRENT TRANSACTION SOURCE FOR   *04480003
044900*  THE FIRST TRANSACTION CODE WITHIN EACH TRANSACTION SOURCE,    *04490003
045000*  AND PRINT THE CURRENT USERID FOR THE FIRST TRANSACTION CODE   *04500003
045100*  WITHIN EACH USERID.  PRINT BOTH THE CURRENT TRANSACTION       *04510003
045200*  SOURCE AND THE CURRENT USERID AT THE TOP OF EACH NEW PAGE     *04520003
045300*  PRINTED.  IF THE CURRENT LEVEL OF DETAIL IS NOT FOR THE       *04530003
045400*  COMPANY TOTAL LEVEL, ACCUMULATE THE NUMERIC TOTALS TO THE     *04540003
045500*  NEXT HIGHER LEVEL OF DETAIL.                                  *04550003
045600******************************************************************04560003
045700                                                                  04570003
045800 5000-PRINT-CONTROL-BREAK-LINE.                                   04580003
045900     ADD PV-ADVANCE-COUNT TO PV-LINE-COUNT.                       04590003
046000     IF PV-LINE-COUNT > PC-PAGE-SIZE                              04600003
046100         PERFORM 8000-PRINT-TITLE-LINES                           04610003
046200     END-IF.                                                      04620003
046300                                                                  04630003
046400     INITIALIZE DL-DETAIL-LINE.                                   04640003
046500                                                                  04650003
046600     IF PS-PRINT-TRANS-SOURCE                                     04660003
046700         EVALUATE TRUE                                            04670003
046800             WHEN CK-POS-TRANSACTION                              04680003
046900                 SET DL-POS-TRANSACTION TO TRUE                   04690003
047000             WHEN CK-SUSPENSE-TRANSACTION                         04700003
047100                 SET DL-SUSPENSE-TRANSACTION TO TRUE              04710003
047200             WHEN CK-MAINTENANCE-TRANSACTION                      04720003
047300                 SET DL-MAINTENANCE-TRANSACTION TO TRUE           04730003
047400             WHEN CK-COMPANY-TOTAL                                04740003
047500                 SET DL-COMPANY-TOTAL TO TRUE                     04750003
047600         END-EVALUATE                                             04760003
047700     END-IF.                                                      04770003
047800                                                                  04780003
047900     IF PS-PRINT-USERID                                           04790003
048000         MOVE CK-SUBMITTED-BY-USERID TO DL-SUBMITTED-BY-USERID    04800003
048100     END-IF.                                                      04810003
048200                                                                  04820003
048300     SET TC-CODE-INDEX TO TT-CODE-INDEX.                          04830003
048400     MOVE TC-TRANSACTION-CODE (TC-CODE-INDEX) TO                  04840003
048500               DL-TRANSACTION-CODE.                               04850003
048600                                                                  04860003
048700     MOVE TT-TRANSACTION-COUNT                                    04870003
048800                        (TT-LEVEL-INDEX, TT-CODE-INDEX) TO        04880003
048900               DL-TRANSACTION-COUNT.                              04890003
049000     MOVE TT-TRANSACTION-AMOUNT                                   04900003
049100                        (TT-LEVEL-INDEX, TT-CODE-INDEX) TO        04910003
049200               DL-TRANSACTION-AMOUNT.                             04920003
049300                                                                  04930003
049400     WRITE TS-TRANSACTION-SUMMARY-RECORD                          04940003
049500         FROM DL-DETAIL-LINE                                      04950003
049600         AFTER ADVANCING PV-ADVANCE-COUNT LINES.                  04960003
049700                                                                  04970003
049800     MOVE 1 TO PV-ADVANCE-COUNT.                                  04980003
049900                                                                  04990003
050000     IF TT-LEVEL-INDEX NOT = PC-COMPANY-TOTAL-LEVEL               05000003
050100         ADD TT-TRANSACTION-COUNT                                 05010003
050200                        (TT-LEVEL-INDEX, TT-CODE-INDEX) TO        05020003
050300                   TT-TRANSACTION-COUNT                           05030003
050400                        (TT-LEVEL-INDEX + 1, TT-CODE-INDEX)       05040003
050500         ADD TT-TRANSACTION-AMOUNT                                05050003
050600                        (TT-LEVEL-INDEX, TT-CODE-INDEX) TO        05060003
050700                   TT-TRANSACTION-AMOUNT                          05070003
050800                        (TT-LEVEL-INDEX + 1, TT-CODE-INDEX)       05080003
050900     END-IF.                                                      05090003
051000                                                                  05100003
051100     SET PS-DONT-PRINT-TRANS-SOURCE                               05110003
051200         PS-DONT-PRINT-USERID TO TRUE.                            05120003
051300*5000-EXIT.                                                       05130003
051400                                                                  05140003
051500******************************************************************05150003
051600*  READ AN ACCOUNTS RECEIVABLE TRANSACTION FILE RECORD.          *05160003
051700******************************************************************05170003
051800                                                                  05180003
051900 7000-READ-TRANSACTION-FILE.                                      05190003
052000     READ AR-TRANSACTION-FILE                                     05200003
052100         INTO AR001-AR-TRANSACTION-RECORD                         05210012
052200         AT END                                                   05220003
052300             SET PS-END-OF-TRANS-FILE TO TRUE                     05230003
052400     END-READ.                                                    05240003
052500*7000-EXIT.                                                       05250003
052600                                                                  05260003
052700******************************************************************05270003
052800*  PRINT TITLE LINES ON THE REPORT AT EACH PAGE BREAK.  UPDATE   *05280003
052900*  THE PAGE NUMBER.                                              *05290003
053000******************************************************************05300003
053100                                                                  05310003
053200 8000-PRINT-TITLE-LINES.                                          05320003
053300                                                                  05330003
053400     ADD 1 TO PV-PAGE-COUNT.                                      05340003
053500     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    05350003
053600     WRITE TS-TRANSACTION-SUMMARY-RECORD                          05360003
053700         FROM DP132O-STANDRD-HEADER-132-COLS                      05370003
053800         AFTER ADVANCING PAGE.                                    05380003
053900     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR                    05390003
054000     WRITE TS-TRANSACTION-SUMMARY-RECORD                          05400003
054100         FROM HL2-HEADING-LINE-2                                  05410003
054200         AFTER ADVANCING 1 LINE.                                  05420003
054300     WRITE TS-TRANSACTION-SUMMARY-RECORD                          05430003
054400         FROM HL3-HEADING-LINE-3                                  05440003
054500         AFTER ADVANCING 1 LINE.                                  05450003
054600     WRITE TS-TRANSACTION-SUMMARY-RECORD                          05460003
054700         FROM HL4-HEADING-LINE-4                                  05470003
054800         AFTER ADVANCING 2 LINES.                                 05480003
054900     WRITE TS-TRANSACTION-SUMMARY-RECORD                          05490003
055000         FROM HL5-HEADING-LINE-5                                  05500003
055100         AFTER ADVANCING 1 LINE.                                  05510003
055200                                                                  05520003
055300     MOVE 8 TO PV-LINE-COUNT.                                     05530003
055400     MOVE 2 TO PV-ADVANCE-COUNT.                                  05540003
055500                                                                  05550003
055600     SET PS-PRINT-TRANS-SOURCE                                    05560003
055700         PS-PRINT-USERID TO TRUE.                                 05570003
055800*8000-EXIT.                                                       05580003
055900                                                                  05590003
056000******************************************************************05600003
056100*  CLOSE ALL FILES.                                              *05610003
056200******************************************************************05620003
056300                                                                  05630003
056400 9000-EOJ-ROUTINE.                                                05640003
056500     CLOSE AR-TRANSACTION-FILE                                    05650003
056600           TRANSACTION-SUMMARY-FILE.                              05660003
056700*9000-EXIT.                                                       05670003
056800                                                                  05680003
