000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'PACK MARKING APRON REPORT AND ODD UNIT WORKSHEET'.        00020000
000300 PROGRAM-ID.             PCKCS708.                                00030000
000400 AUTHOR.                 PAUL JORGENSEN.                          00040000
000500 INSTALLATION.           KOHLS.                                   00050000
000600 DATE-WRITTEN.           OCTOBER, 1999.                           00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900*    ANY CHANGES THAT MAY EFFECT THE LAYOUT OF THIS REPORT SHOULD 00090000
001000*    BE TESTED ON EVERY MODEL OF PRINTER.  THERE MIGHT BE         00100000
001100*    DIFFERENCES IN CARRIAGE CONTROL AND GRAPHICS PRINTING FOR    00110000
001200*    EACH MODEL.  ALSO BE AWARE THAT WHEN USING PROGRAM DRS1INTC  00120000
001300*    TO PRINT THE REPORT, A NON-BLANK CHARACTER IN PRINT POSITION 00130000
001400*    132 WILL CAUSE A DOUBLE-SPACE TO OCCUR REGARDLESS OF THE     00140000
001500*    VALUE OF THE CARRIAGE CONTROL.                               00150000
001600                                                                  00160000
001700******************************************************************00170000
001800* THIS PROGRAM PRODUCES THE PACK MARKING APRON AND WORKSHEET.     00180000
001900* IT WAS COPIED FROM PCKCS010 AND MODIFIED.                       00190000
002000******************************************************************00200000
002100                                                                  00210000
002200******************************************************************00220000
002300 ENVIRONMENT DIVISION.                                            00230000
002400******************************************************************00240000
002500                                                                  00250000
002600******************************************************************00260000
002700 DATA DIVISION.                                                   00270000
002800******************************************************************00280000
002900                                                                  00290000
003000******************************************************************00300000
003100 WORKING-STORAGE SECTION.                                         00310000
003200******************************************************************00320000
003300                                                                  00330000
003400*                                                                 00340000
003500*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      00350000
003600*                                                                 00360000
003700     COPY DFHAID.                                                 00370000
003800                                                                  00380000
003900*                                                                 00390000
004000*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00400000
004100*                                                                 00410000
004200     COPY DPWS013.                                                00420000
004300 EJECT                                                            00430000
004400*                                                                 00440000
004500*                                                                 00450000
004600*  LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE                 00460000
004700*                                                                 00470000
004800     COPY XLWS001.                                                00480000
004900 EJECT                                                            00490000
005000*                                                                 00491000
005100*  LAYOUT FOR THE PRINT PACKAGE COMMAND WORKING STORAGE           00492000
005200*                                                                 00493000
005300     COPY DSWS004.                                                00494000
005400 EJECT                                                            00495000
005500*                                                                 00500000
005600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00510000
005700*  DISTRIBUTION TABLE.                                            00520000
005800*                                                                 00530000
005900     EXEC SQL                                                     00540000
006000          INCLUDE TRECDIS                                         00550000
006100     END-EXEC.                                                    00560000
006200 EJECT                                                            00570000
006300*                                                                 00580000
006400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIPT ITEM       00590000
006500*  TABLE.                                                         00600000
006600*                                                                 00610000
006700     EXEC SQL                                                     00620000
006800          INCLUDE TRECITM                                         00630000
006900     END-EXEC.                                                    00640000
007000 EJECT                                                            00650000
007100******************************************************************00730000
007200* DCLGEN OF XLT_LOC                                               00740000
007300******************************************************************00750000
007400*                                                                 00760000
007500     EXEC SQL                                                     00770000
007600         INCLUDE XLT00010                                         00780000
007700     END-EXEC.                                                    00790000
007800******************************************************************00791000
007900* DCLGEN OF XLT_DC_LOC_ASGMT                                      00792000
008000******************************************************************00793000
008100*                                                                 00794000
008200     EXEC SQL                                                     00795000
008300         INCLUDE XLT00014                                         00796000
008400     END-EXEC.                                                    00797000
008500 EJECT                                                            00798000
008600*                                                                 00800000
008700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVER TABLE     00810000
008800*                                                                 00820000
008900     EXEC SQL                                                     00830000
009000         INCLUDE TRECEIV                                          00840000
009100     END-EXEC.                                                    00850000
009200 EJECT                                                            00860000
009300*                                                                 00870000
009400*                                                                 00880000
009500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIP PO TABLE      00890000
009600*                                                                 00900000
009700     EXEC SQL                                                     00910000
009800         INCLUDE TSHPTPO                                          00920000
009900     END-EXEC.                                                    00930000
010000*                                                                 00940000
010100*                                                                 00950000
010200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT TABLE     00960000
010300*                                                                 00970000
010400     EXEC SQL                                                     00980000
010500         INCLUDE TSHIPMT                                          00990000
010600     END-EXEC.                                                    01000000
010700 EJECT                                                            01010000
010800*                                                                 01020000
010900*                                                                 01030000
011000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VEHICLE TRIP       01040000
011100*                                                                 01050000
011200     EXEC SQL                                                     01060000
011300         INCLUDE TVHTRIP                                          01070000
011400     END-EXEC.                                                    01080000
011500 EJECT                                                            01160000
011600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STATUS CODE TABLE  01400000
011700*                                                                 01410000
011800     EXEC SQL                                                     01420000
011900          INCLUDE TSTATCD                                         01430000
012000     END-EXEC.                                                    01440000
012100 EJECT                                                            01450000
012200*                                                                 01530000
012300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01540000
012400*  HEADER TABLE                                                   01550000
012500*                                                                 01560000
012600     EXEC SQL                                                     01570000
012700          INCLUDE TPURCHS                                         01580000
012800     END-EXEC.                                                    01590000
012900 EJECT                                                            01600000
013000*                                                                 01610000
013100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01620000
013200*  ITEM TABLE                                                     01630000
013300*                                                                 01640000
013400     EXEC SQL                                                     01650000
013500          INCLUDE TPURITM                                         01660000
013600     END-EXEC.                                                    01670000
013700 EJECT                                                            01680000
013800*                                                                 01690000
013900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE ENTERPRIZE NAME    01700000
014000*  TABLE.                                                         01710000
014100*                                                                 01720000
014200     EXEC SQL                                                     01730000
014300          INCLUDE TENTNME                                         01740000
014400     END-EXEC.                                                    01750000
014500 EJECT                                                            01760000
014600*                                                                 01770000
014700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01780000
014800*  INSTRUCTIONS TABLE                                             01790000
014900*                                                                 01800000
015000     EXEC SQL                                                     01810000
015100          INCLUDE TPOINST                                         01820000
015200     END-EXEC.                                                    01830000
015300 EJECT                                                            01840000
015400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01850000
015500*  PREPACK TABLE                                                  01860000
015600*                                                                 01870000
015700     EXEC SQL                                                     01880000
015800          INCLUDE TPOPRPK                                         01890000
015900     END-EXEC.                                                    01900000
016000 EJECT                                                            01910000
016100*                                                                 01920000
016200*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PURCHASE ORDER     01930000
016300*  INSTRUCTIONS CODE TABLE                                        01940000
016400*                                                                 01950000
016500     EXEC SQL                                                     01960000
016600          INCLUDE TINSTCD                                         01970000
016700     END-EXEC.                                                    01980000
016800 EJECT                                                            01990000
016900*                                                                 02000000
017000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE WORK ORDER         02010000
017100*  INSTRUCTIONS TABLE                                             02020000
017200*                                                                 02030000
017300     EXEC SQL                                                     02040000
017400          INCLUDE TWKORIN                                         02050000
017500     END-EXEC.                                                    02060000
017600/                                                                 02070000
017700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            02080000
017800*  NOTIFICATION TABLE                                             02090000
017900*                                                                 02100000
018000     EXEC SQL                                                     02110000
018100          INCLUDE TTRBNTF                                         02120000
018200     END-EXEC.                                                    02130000
018300                                                                  02140000
018400*                                                                 02150000
018500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TROUBLE            02160000
018600*  REASON CODE TABLE                                              02170000
018700*                                                                 02180000
018800     EXEC SQL                                                     02190000
018900          INCLUDE TTRBRSN                                         02200000
019000     END-EXEC.                                                    02210000
019100 EJECT                                                            02220000
019200*                                                                 02270000
019300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET FORMAT      02280000
019400*  TABLE                                                          02290000
019500*                                                                 02300000
019600     EXEC SQL                                                     02310000
019700          INCLUDE TTKTFMT                                         02320000
019800     END-EXEC.                                                    02330000
019900 EJECT                                                            02340000
020000*                                                                 02350000
020100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PRETICKET REQUEST  02360000
020200*  TABLE                                                          02370000
020300*                                                                 02380000
020400     EXEC SQL                                                     02390000
020500          INCLUDE TPTKREQ                                         02400000
020600     END-EXEC.                                                    02410000
020700 EJECT                                                            02420000
020800*                                                                 02430000
020900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET LINE ITEM   02440000
021000*  TABLE                                                          02450000
021100*                                                                 02460000
021200     EXEC SQL                                                     02470000
021300          INCLUDE TPTKLNE                                         02480000
021400     END-EXEC.                                                    02490000
021500 EJECT                                                            02500000
021600*                                                                 02510000
021700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TICKET PLACEMENT   02520000
021800*  DESCRIPTION TABLE                                              02530000
021900*                                                                 02540000
022000     EXEC SQL                                                     02550000
022100          INCLUDE TPLDESC                                         02560000
022200     END-EXEC.                                                    02570000
022300 EJECT                                                            02580000
022400*                                                                 02950000
022500*  COMMUNICATIONS AREA FOR DB2                                    02960000
022600*                                                                 02970000
022700     EXEC SQL                                                     02980000
022800         INCLUDE SQLCA                                            02990000
022900     END-EXEC.                                                    03000000
023000 EJECT                                                            03010000
023100*  WORKING STORAGE COPYBOOK FOR PACK VALIDATION ROUTINE           03020000
023200     COPY RCWS806.                                                03030000
023300*                                                                 03040000
023400*---------------------------------------------------------------* 03050000
023500*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 03060000
023600*---------------------------------------------------------------* 03070000
023700     COPY PCWS016.                                                03080000
023800                                                                  03090000
023900 01  CA-PCKCS014-COMMAREA.                                        03100000
024000   03  CA-COMMAREA.                                               03110000
024100     05  CA-WRK-ORD-KEY-X.                                        03120000
024200         10  CA-ORD-NBR-X                PIC  X(08)  VALUE SPACE. 03130000
024300         10  CA-ORD-NBR  REDEFINES  CA-ORD-NBR-X                  03140000
024400                                         PIC  9(08).              03150000
024500         10  CA-RCVR-SEQ-NBR-X           PIC  X(03)  VALUE SPACE. 03160000
024600         10  CA-RCVR-SEQ-NBR  REDEFINES  CA-RCVR-SEQ-NBR-X        03170000
024700                                         PIC  9(03).              03180000
024800         10  CA-ORD-LNE-NBR-X            PIC  X(04)  VALUE SPACE. 03190000
024900         10  CA-ORD-LNE-NBR  REDEFINES  CA-ORD-LNE-NBR-X          03200000
025000                                         PIC  9(04).              03210000
025100         10  CA-WORK-ORD-SEQ-NBR-X       PIC  X(03)  VALUE SPACE. 03220000
025200         10  CA-WORK-ORD-SEQ-NBR  REDEFINES  CA-WORK-ORD-SEQ-NBR-X03230000
025300                                         PIC  9(03).              03240000
025400     05  CA-DESTINATION                  PIC  X(08)  VALUE SPACE. 03250000
025500     05  CA-PREPARER-USER-ID             PIC  X(08)  VALUE SPACE. 03260000
025600     05  CA-OPER-UNT-ID                  PIC  9(04)  VALUE ZERO.  03270000
025700     05  CA-FCLTY-ID                     PIC  X(04)  VALUE SPACE. 03280000
025800     05  FILLER                          PIC  X(01)  VALUE SPACE. 03290000
025900     05  CA-PRTR-AUTO-CUTTER-IND         PIC  X(01)  VALUE SPACE. 03300000
026000     05  CA-PRTR-PRTR-BRCDE-IND          PIC  X(01)  VALUE SPACE. 03310000
026100     05  CA-PRTR-PRTR-CNTL-IND           PIC  X(01)  VALUE SPACE. 03320000
026200     05  CA-PRINT-PACKAGE-IND            PIC  X(01)  VALUE SPACE. 03330000
026300     05  CA-LINES-PER-INCH               PIC  X(03)  VALUE SPACE. 03340000
026400     05  FILLER                          PIC  X(08)  VALUE SPACE. 03350000
026500     05  CA-SEL-QUEUE-NAME.                                       03360000
026600         10  FILLER                      PIC X(4).                03370000
026700         10  CA-QUEUE-TASK               PIC S9(5) COMP-3.        03380000
026800         10  FILLER                      PIC X(1).                03390000
026900     05  FILLER                          PIC  X(02)  VALUE SPACE. 03400000
027000     05  CA-MRKG-APRON-HDR-IND           PIC  X(01)  VALUE SPACE. 03410000
027100         88  CA-PRINT-MRKG-APRON-HDR                 VALUE 'Y'.   03420000
027200     05  CA-MRKG-APRON-IND               PIC  X(01)  VALUE SPACE. 03430000
027300         88  CA-PRINT-MRKG-APRON                     VALUE 'Y'.   03440000
027400     05  CA-DRIB-AREA                    PIC X(480).              03450000
027500   02  CA-LINE-TABLE.                                             03460000
027600     05  CA-LINE-ENTRY OCCURS 999 TIMES INDEXED BY                03470000
027700                                      LINE-IDX.                   03480000
027800       10  CA-LINE-NBR             PIC S9(4) COMP.                03490000
027900*                                                                 03500000
028000 01  ASC-SPECIFIC-COMMAREA.                                       03510000
028100     05  FILLER                          PIC S9(04) COMP.         03520000
028200     05  ASC-NUMBER-OF-ITEMS-READ                                 03530000
028300                                         PIC S9(09) COMP-3.       03540000
028400     05  FILLER                          PIC S9(09) COMP-3.       03550000
028500     05  FILLER                          PIC S9(05) COMP-3.       03560000
028600     05  ASC-SEL-QUEUE-NAME-IN           PIC X(08).               03570000
028700*                                                                 03580000
028800 01  DK-DB2-KEYS.                                                 03590000
028900     05  DK-ORD-NBR                      PIC S9(09)  VALUE ZEROS  03600000
029000                                                     COMP.        03610000
029100     05  DK-RCVR-SEQ-NBR                 PIC S9(09)  VALUE ZEROS  03620000
029200                                                     COMP.        03630000
029300     05  DK-ORD-LNE-NBR                  PIC S9(04)  VALUE ZEROS  03640000
029400                                                     COMP.        03650000
029500     05  DK-WORK-ORD-SEQ-NBR             PIC S9(04)  VALUE ZEROS  03660000
029600                                                     COMP.        03670000
029700     05  DK-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  03680000
029800                                                     COMP.        03690000
029900     05  DK-OPER-UNT-ID-TALL             PIC S9(04)  VALUE ZEROS  03700000
030000                                                     COMP.        03710000
030100     05  DK-FCLTY-ID                     PIC S9(04)  VALUE ZEROS  03720000
030200                                                     COMP.        03730000
030300     05  DK-STR-NBR                      PIC S9(04)  VALUE ZEROS  03740000
030400                                                     COMP.        03750000
030500     05  DK-TKT-FMT-ID                PIC X(06)  VALUE SPACES.    03760000
030600     05  DK-VS-ID                     PIC S9(09) COMP VALUE +0.   03770000
030700     05  DK-HNG-TYP-SEQ-NBR           PIC S9(4) COMP VALUE +0.    03780000
030800     05  DK-MDSEAR-ID                 PIC S9(9) COMP VALUE +0.    03790000
030900     05  DK-ENT-ID                    PIC S9(04) COMP VALUE +0.   03800000
031000     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    03810000
031100     05  DK-SUBCLASS-NBR              PIC X(03) VALUE SPACE.      03820000
031200     05  DK-MAJCLASS-NBR              PIC X(02) VALUE SPACE.      03830000
031300     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    03840000
031400     05  DK-TYP-CDE                   PIC S9(04) VALUE +0         03850000
031500                                                  COMP.           03860000
031600     05  DK-PREPK-ID                  PIC S9(04) VALUE +0         03870000
031700                                                  COMP.           03880000
031800     COPY DPWS020.                                                03890000
031900*                                                                 03900000
032000 01  TL1-TROUBLE-LINE-1.                                          03910000
032100     05  FILLER                          PIC X(19)   VALUE        03920000
032200         'T R O U B L E  **  '.                                   03930000
032300     05  FILLER                          PIC X(19)   VALUE        03940000
032400         'T R O U B L E  **  '.                                   03950000
032500     05  FILLER                          PIC X(19)   VALUE        03960000
032600         'T R O U B L E  **  '.                                   03970000
032700     05  FILLER                          PIC X(19)   VALUE        03980000
032800         'T R O U B L E  **  '.                                   03990000
032900     05  FILLER                          PIC X(19)   VALUE        04000000
033000         'T R O U B L E  **  '.                                   04010000
033100     05  FILLER                          PIC X(19)   VALUE        04020000
033200         'T R O U B L E  **  '.                                   04030000
033300     05  FILLER                          PIC X(18)   VALUE        04040000
033400         'T R O U B L E  ** '.                                    04050000
033500*                                                                 04060000
033600 01  TL2-TROUBLE-LINE-2.                                          04070000
033700     05  TL2-TRBL-DESC-TABLE OCCURS 5 TIMES INDEXED BY            04080000
033800                                            TRBL-IDX.             04090000
033900         10  FILLER                      PIC X(06)   VALUE SPACES.04100000
034000         10  TL2-TRBL-DESC               PIC X(20).               04110000
034100     05  FILLER                          PIC X(02)   VALUE SPACES.04120000
034200*                                                                 04130000
034300 01  TL3-TROUBLE-LINE-3.                                          04140000
034400     05  TL3-TRBL-DESC-TABLE OCCURS 5 TIMES INDEXED BY            04150000
034500                                            TRBL-IDX2.            04160000
034600         10  FILLER                      PIC X(04)   VALUE SPACES.04170000
034700         10  TL3-TRBL-IND                PIC X(01)   VALUE SPACES.04180000
034800         10  TL3-DASH                    PIC X(01)   VALUE SPACES.04190000
034900         10  TL3-TRBL-DESC               PIC X(20).               04200000
035000     05  FILLER                          PIC X(02)   VALUE SPACES.04210000
035100*                                                                 04220000
035200 01  RL1-REPRINT-LINE-1.                                          04230000
035300     05  FILLER                          PIC X(19)   VALUE        04240000
035400         'R E P R I N T  **  '.                                   04250000
035500     05  FILLER                          PIC X(19)   VALUE        04260000
035600         'R E P R I N T  **  '.                                   04270000
035700     05  FILLER                          PIC X(19)   VALUE        04280000
035800         'R E P R I N T  **  '.                                   04290000
035900     05  FILLER                          PIC X(19)   VALUE        04300000
036000         'R E P R I N T  **  '.                                   04310000
036100     05  FILLER                          PIC X(19)   VALUE        04320000
036200         'R E P R I N T  **  '.                                   04330000
036300     05  FILLER                          PIC X(19)   VALUE        04340000
036400         'R E P R I N T  **  '.                                   04350000
036500     05  FILLER                          PIC X(18)   VALUE        04360000
036600         'R E P R I N T  ** '.                                    04370000
036700                                                                  04380000
036800 01  RT1-RTV-DISTRO-LINE-1.                                       04390000
036900     05  FILLER                          PIC X(38)   VALUE        04400000
037000         'R T V   D I S T R I B U T I O N   **  '.                04410000
037100     05  FILLER                          PIC X(49)   VALUE        04420000
037200         'RTV SHEETS LOCATED AT END OF MARKING APRON PACKET'.     04430000
037300     05  FILLER                          PIC X(38)   VALUE        04440000
037400         '   **  R T V   D I S T R I B U T I O N'.                04450000
037500     05  FILLER                          PIC X(07)  VALUE SPACE.  04460000
037600*                                                                 04470000
037700 01  HL1-HEADING-LINE-1.                                          04480000
037800     05  FILLER                          PIC X(02)   VALUE SPACE. 04490000
037900     05  HL1-RUN-DATE.                                            04500000
038000         10  HL1-RUN-MONTH               PIC  9(02)  VALUE ZERO.  04510000
038100         10  FILLER                      PIC  X(01)  VALUE '/'.   04520000
038200         10  HL1-RUN-DAY                 PIC  9(02)  VALUE ZERO.  04530000
038300         10  FILLER                      PIC  X(01)  VALUE '/'.   04540000
038400         10  HL1-RUN-YEAR                PIC  9(02)  VALUE ZERO.  04550000
038500     05  FILLER                          PIC  X(02)  VALUE SPACE. 04560000
038600     05  HL1-RUN-TIME.                                            04570000
038700         10  HL1-RUN-HOUR                PIC  9(02)  VALUE ZERO.  04580000
038800         10  FILLER                      PIC  X(01)  VALUE ':'.   04590000
038900         10  HL1-RUN-MINUTE              PIC  9(02)  VALUE ZERO.  04600000
039000     05  FILLER                          PIC  X(17)  VALUE SPACE. 04610000
039100     05  HL1-RPT-HDR                     PIC  X(52)  VALUE SPACE. 04620000
039200     05  FILLER                          PIC  X(18)  VALUE SPACE. 04630000
039300     05  HL1-PROGRAM-NAME                PIC  X(08)  VALUE        04640000
039400                                                      'PCKCS708'. 04650000
039500     05  FILLER                          PIC  X(01)  VALUE '-'.   04660000
039600     05  HL1-RPT-NBR                     PIC  X(01)  VALUE '1'.   04670000
039700     05  FILLER                          PIC  X(02)  VALUE SPACE. 04680000
039800     05  FILLER                          PIC  X(05)  VALUE        04690000
039900         'PAGE '.                                                 04700000
040000     05  HL1-PGE-NBR                     PIC  9(02)  VALUE ZERO.  04710000
040100     05  FILLER                          PIC  X(04)  VALUE        04720000
040200         ' OF '.                                                  04730000
040300     05  HL1-OF-PGE-NBR                  PIC  9(02)  VALUE ZERO.  04740000
040400     05  FILLER                          PIC  X(02)  VALUE SPACE. 04750000
040500*                                                                 04760000
040600 01  HL2-HEADING-LINE-2.                                          04770000
040700     05  FILLER                          PIC  X(07)  VALUE SPACE. 04780000
040800     05  FILLER                          PIC  X(11)  VALUE        04790000
040900         'P.O./SEQ.: '.                                           04800000
041000     05  HL2-PO-NBR                      PIC  X(08)  VALUE SPACE. 04810000
041100     05  FILLER                          PIC  X(01)  VALUE '-'.   04820000
041200     05  HL2-RCVR-SEQ-NBR                PIC  X(03)  VALUE SPACE. 04830000
041300     05  FILLER                          PIC  X(02)  VALUE SPACE. 04840000
041400     05  FILLER                          PIC  X(13)  VALUE        04850000
041500         'VENDOR NAME: '.                                         04860000
041600     05  HL2-VNDR-NME                    PIC  X(25)  VALUE SPACE. 04870000
041700     05  FILLER                          PIC  X(10)  VALUE SPACE. 04880000
041800     05  FILLER                          PIC  X(13)  VALUE        04890000
041900        'PICTURED AD: '.                                          04900000
042000     05  HL2-PICTURED-AD-FLG             PIC  X      VALUE SPACE. 04910000
042100     05  FILLER                          PIC  X(23)  VALUE SPACE. 04920000
042200     05  FILLER                          PIC  X(05)  VALUE        04930000
042300         'SET: '.                                                 04940000
042400     05  HL2-SET                         PIC  X(05)  VALUE SPACE. 04950000
042500     05  FILLER                          PIC  X(05)  VALUE SPACE. 04960000
042600*                                                                 04970000
042700 01  HL3-HEADING-LINE-3.                                          04980000
042800     05  FILLER                          PIC  X(19)  VALUE        04990000
042900         '  UNITS PER PACK:  '.                                   05000000
043000     05  HL3-UNITS-PER-PACK              PIC  ZZ9.                05010000
043100     05  FILLER                          PIC  X(07)  VALUE SPACE. 05020000
043200     05  FILLER                          PIC  X(16)  VALUE        05030000
043300         'BILL OF LADING: '.                                      05040000
043400     05  HL3-BOL                         PIC  X(30)  VALUE SPACE. 05050000
043500     05  FILLER                          PIC  X(09)  VALUE SPACE. 05060000
043600     05  FILLER                          PIC  X(09)  VALUE        05070000
043700         'AD DATE: '.                                             05080000
043800     05  HL3-PICTURED-AD-DTE             PIC  X(08)  VALUE SPACE. 05090000
043900     05  FILLER                          PIC  X(13)  VALUE SPACE. 05100000
044000     05  FILLER                          PIC  X(08)  VALUE        05110000
044100         'HANGER: '.                                              05120000
044200     05  HL3-GOH                         PIC  X(01)  VALUE SPACE. 05130000
044300     05  FILLER                          PIC  X(01)  VALUE SPACE. 05140000
044400     05  HL3-HANGER-SIZE                 PIC  X(02)  VALUE SPACE. 05150000
044500     05  FILLER                          PIC  X(06)  VALUE SPACE. 05160000
044600*                                                                 05170000
044700 01  HL4-HEADING-LINE-4.                                          05180000
044800     05  FILLER                          PIC  X(19)  VALUE        05190000
044900         '# OF INNER PACKS:  '.                                   05200000
045000     05  HL4-INNER-PACKS                 PIC  ZZ9.                05210000
045100     05  FILLER                          PIC  X(09)  VALUE SPACE. 05220000
045200     05  FILLER                          PIC  X(14)  VALUE        05230000
045300         'FREIGHT BILL: '.                                        05240000
045400     05  HL4-FOB                         PIC  X(22)  VALUE SPACE. 05250000
045500     05  FILLER                          PIC  X(03)  VALUE SPACE. 05260000
045600     05  FILLER                          PIC  X(11)  VALUE        05270000
045700         'PRETICKET: '.                                           05280000
045800     05  HL4-PRETICKET-IND               PIC  X(01)  VALUE SPACE. 05290000
045900     05  FILLER                          PIC  X(26)  VALUE SPACE. 05300000
046000     05  FILLER                          PIC  X(14)  VALUE        05310000
046100         'PRESENTATION: '.                                        05320000
046200     05  HL4-PRESENTATION                PIC  X(05)  VALUE SPACE. 05330000
046300     05  FILLER                          PIC  X(05)  VALUE SPACE. 05340000
046400*                                                                 05350000
046500 01  HL5-HEADING-LINE-5.                                          05360000
046600     05  FILLER                          PIC  X(18)  VALUE        05370000
046700         '  RECVR EXP CTNS: '.                                    05380000
046800     05  HL5-EXPECTED-CARTONS            PIC  ZZZ9.               05390000
046900     05  FILLER                          PIC  X(10)  VALUE SPACE. 05400000
047000     05  FILLER                          PIC  X(13)  VALUE        05410000
047100         'TRIP ID NO.: '.                                         05420000
047200     05  HL5-TRIP-ID                     PIC  ZZZZZZZZZ.          05430000
047300     05  FILLER                          PIC  X(14)  VALUE SPACE. 05440000
047400     05  FILLER                          PIC  X(13)  VALUE        05450000
047500         'TICKET TYPE: '.                                         05460000
047600     05  HL5-TICKET-TYPE                 PIC  X(20)  VALUE SPACE. 05470000
047700     05  FILLER                          PIC  X(31)  VALUE SPACE. 05480000
047800*                                                                 05490000
047900 01  HL6-HEADING-LINE-6.                                          05500000
048000     05  FILLER                          PIC  X(18)  VALUE        05510000
048100         'UNITS PER CARTON: '.                                    05520000
048200     05  HL6-UNITS-PER-CARTON            PIC  ZZZ9.               05530000
048300     05  FILLER                          PIC  X(10)  VALUE SPACE. 05540000
048400     05  FILLER                          PIC  X(13)  VALUE        05550000
048500         'TRAILER NO.: '.                                         05560000
048600     05  HL6-TRAILER                     PIC  X(10)  VALUE SPACE. 05570000
048700     05  FILLER                          PIC  X(08)  VALUE SPACE. 05580000
048800     05  FILLER                          PIC  X(18)  VALUE        05590000
048900         'TICKET PLACEMENT: '.                                    05600000
049000     05  HL6-TICKET-PLACEMENT            PIC  X(50)  VALUE SPACE. 05610000
049100     05  FILLER                          PIC  X(01)  VALUE SPACE. 05620000
049200*                                                                 05630000
049300 01  HL7-HEADING-LINE-7.                                          05640000
049400     05  FILLER                          PIC  X(09)  VALUE SPACE. 05650000
049500     05  FILLER                          PIC  X(11)  VALUE        05660000
049600         'PACK ID:   '.                                           05670000
049700     05  HL7-PACK-ID                     PIC  Z9     VALUE ZERO.  05680000
049800     05  FILLER                          PIC  X(17)  VALUE SPACE. 05690000
049900     05  FILLER                          PIC  X(06)  VALUE        05700000
050000         'SCAC: '.                                                05710000
050100     05  HL7-SCAC                        PIC  X(04)  VALUE SPACE. 05720000
050200     05  FILLER                          PIC  X(10)  VALUE SPACE. 05730000
050300     05  FILLER                          PIC  X(22)  VALUE        05740000
050400         'SPECIAL INSTRUCTIONS: '.                                05750000
050500     05  HL7-SPECIAL-INSTR               PIC  X(50)  VALUE SPACE. 05760000
050600     05  FILLER                          PIC  X(01)  VALUE SPACE. 05770000
050700*                                                                 05780000
050800 01  HL8-HEADING-LINE-8.                                          05790000
050900     05  FILLER                          PIC  X(18)  VALUE        05800000
051000         '       PACK TYPE: '.                                    05810000
051100     05  HL8-PACK-TYPE-DESC              PIC  X(22)  VALUE SPACE. 05820000
051200     05  FILLER                          PIC  X(19)  VALUE SPACE. 05830000
051300     05  HL8-SPECIAL-INSTR               PIC  X(72)  VALUE SPACE. 05840000
051400     05  FILLER                          PIC  X(01)  VALUE SPACE. 05850000
051500*                                                                 05860000
051600 01  HL9-HEADING-LINE-9.                                          05870000
051700     05  FILLER                          PIC  X(18)  VALUE        05880000
051800         'PACK DESCRIPTION: '.                                    05890000
051900     05  HL9-PACK-DESCRIPTION            PIC  X(40)  VALUE SPACE. 05900000
052000     05  FILLER                          PIC  X(01)  VALUE SPACE. 05910000
052100     05  HL9-SPECIAL-INSTR               PIC  X(28)  VALUE SPACE. 05920000
052200     05  FILLER                          PIC  X(02)  VALUE SPACE. 05930000
052300     05  FILLER                          PIC  X(13)  VALUE        05940000
052400         'PRINTER NO.: '.                                         05950000
052500     05  HL9-PRINTER-DEST                PIC  X(08)  VALUE SPACE. 05960000
052600     05  FILLER                          PIC  X(01)  VALUE SPACE. 05970000
052700     05  FILLER                          PIC  X(12)  VALUE        05980000
052800         'PRINTED BY: '.                                          05990000
052900     05  HL9-PREPARER-USER-ID            PIC  X(08)  VALUE SPACE. 06000000
053000     05  FILLER                          PIC  X(01)  VALUE SPACE. 06010000
053100*                                                                 06020000
053200 01  HL15-HEADING-LINE-15.                                        06030000
053300     05  FILLER                          PIC  X(01)  VALUE SPACE. 06040000
053400     05  FILLER                          PIC  X(25)  VALUE        06050000
053500         '*** RTV DISTRIBUTIONS ***'.                             06060000
053600     05  FILLER                          PIC  X(106) VALUE SPACE. 06070000
053700* CHANGED HEADING-LINE-1 & HEADING-LINE-2           WR/IR# 230ZZ**06080000
053800* TO MATCH THE NEW REPORT LAYOUT                    WR/IR# 230ZZ**06081000
053900 01  DH1-DETAIL-HEADING-LINE-1.                                   06090000
054000     05  FILLER                          PIC  X(30)  VALUE        06100000
054100         '  PO ---- SKU ----  CERT BOX  '.                        06110000
054200     05  FILLER                          PIC  X(31)  VALUE        06120000
054300         'PO RET.             SKU        '.                       06130000
054400     05  FILLER                          PIC  X(30)  VALUE        06140000
054500         'NRF NRF        SKU            '.                        06150000
054600     05  FILLER                          PIC  X(41)  VALUE        06160000
054700         ' VENDOR            TOTAL  BEST  ODD    R '.             06170000
054800*                                                                 06180000
054900 01  DH2-DETAIL-HEADING-LINE-2.                                   06190000
055000     05  FILLER                          PIC  X(30)  VALUE        06200000
055100         'LINE DPT CL    SKU   REQ ID   '.                        06211000
055200     05  FILLER                          PIC  X(31)  VALUE        06220000
055300         ' PRICE  RATIO SIZE  COLOR      '.                       06230000
055400     05  FILLER                          PIC  X(30)  VALUE        06240000
055500         ' #  COLOR      DESCRIPTION    '.                        06250000
055600     05  FILLER                          PIC  X(41)  VALUE        06260000
055700         ' STYLE           UNIT QTY CASE UNITS   D '.             06270000
055800*                                                                 06280000
055900 01  DH3-DETAIL-HEADING-LINE-1.                                   06290000
056000     05  FILLER                          PIC  X(33)  VALUE        06300000
056100         'STR  STR  EXPTED OVR/SHORT OTR   '.                     06310000
056200     05  FILLER                          PIC  X(33)  VALUE        06320000
056300         'STR  STR  EXPTED OVR/SHORT OTR   '.                     06330000
056400     05  FILLER                          PIC  X(33)  VALUE        06340000
056500         'STR  STR  EXPTED OVR/SHORT OTR   '.                     06350000
056600     05  FILLER                          PIC  X(33)  VALUE        06360000
056700         'STR  STR  EXPTED OVR/SHORT OTR   '.                     06370000
056800*                                                                 06380000
056900 01  DH4-DETAIL-HEADING-LINE-2.                                   06390000
057000     05  FILLER                          PIC  X(33)  VALUE        06400000
057100         'NO.  NAME  PACKS   PACKS  PACKS  '.                     06410000
057200     05  FILLER                          PIC  X(33)  VALUE        06420000
057300         'NO.  NAME  PACKS   PACKS  PACKS  '.                     06430000
057400     05  FILLER                          PIC  X(33)  VALUE        06440000
057500         'NO.  NAME  PACKS   PACKS  PACKS  '.                     06450000
057600     05  FILLER                          PIC  X(33)  VALUE        06460000
057700         'NO.  NAME  PACKS   PACKS  PACKS  '.                     06470000
057800*                                                                 06480000
057900 01  DH5-NO-DISTRO-MSG .                                          06490000
058000     05  FILLER                          PIC X(19)   VALUE        06500000
058100         '   NO DISTRO   **  '.                                   06510000
058200     05  FILLER                          PIC X(19)   VALUE        06520000
058300         '   NO DISTRO   **  '.                                   06530000
058400     05  FILLER                          PIC X(19)   VALUE        06540000
058500         '   NO DISTRO   **  '.                                   06550000
058600     05  FILLER                          PIC X(19)   VALUE        06560000
058700         '   NO DISTRO   **  '.                                   06570000
058800     05  FILLER                          PIC X(19)   VALUE        06580000
058900         '   NO DISTRO   **  '.                                   06590000
059000     05  FILLER                          PIC X(19)   VALUE        06600000
059100         '   NO DISTRO   **  '.                                   06610000
059200     05  FILLER                          PIC X(18)   VALUE        06620000
059300         '   NO DISTRO   ** '.                                    06630000
059400*                                                                 06640000
059500 01  DH4-STORE-PROBLEM-LINE.                                      06650000
059600     05  FILLER                          PIC X(01)   VALUE SPACE. 06660000
059700     05  FILLER                          PIC X(24)   VALUE        06670000
059800         '** WARNING ** WARNING **'.                              06680000
059900     05  FILLER                          PIC X(15)   VALUE SPACE. 06690000
060000     05  FILLER                          PIC X(52)   VALUE        06700000
060100         'POTENTIAL PROBLEMS WITH STORES FOR THIS DISTRIBUTION'.  06710000
060200     05  FILLER                          PIC X(15)   VALUE SPACE. 06720000
060300     05  FILLER                          PIC X(25)   VALUE        06730000
060400         '** WARNING ** WARNING ** '.                             06740000
060500                                                                  06750000
060600* * * LINE ITEM DETAIL                                            06760000
060700* CHANGED TO MATCH THE NEW REPORT LAYOUT           WR/IR# 230ZZ** 06762000
060800 01  DETAIL-LINE1.                                                06770000
060900     05  DL1-LINE-NBR                    PIC  ZZZ9   VALUE SPACE. 06780000
061000     05  FILLER                          PIC  X      VALUE SPACE. 06791000
061100     05  DL1-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 06800000
061200     05  FILLER                          PIC  X      VALUE SPACE. 06810000
061300     05  DL1-CLASS-NBR                   PIC  X(02)  VALUE SPACE. 06820000
061400     05  FILLER                          PIC  X      VALUE SPACE. 06830000
061500     05  DL1-SEQ-NBR                     PIC  X(08)  VALUE SPACE. 06840000
061600     05  FILLER                          PIC  XX     VALUE SPACE. 06850000
061700     05  DL1-UPC-CERT-REQ-FLG            PIC  X      VALUE SPACE. 06860000
061800     05  FILLER                          PIC  XX     VALUE SPACE. 06870000
061900     05  DL1-BOX-ID                      PIC  X(03)  VALUE SPACE. 06880000
062000     05  FILLER                          PIC  X      VALUE SPACE. 06890000
062100     05  DL1-SKU-RTL                     PIC ZZ,ZZZ.99.           06900000
062200     05  FILLER                          PIC  X      VALUE SPACE. 06910000
062300     05  DL1-RATIO                       PIC  Z9.                 06920000
062400     05  FILLER                          PIC  X(03)  VALUE SPACE. 06930000
062500     05  DL1-SIZE                        PIC  X(05)  VALUE SPACE. 06940000
062600     05  FILLER                          PIC  X      VALUE SPACE. 06951000
062700     05  DL1-COLOR                       PIC  X(10)  VALUE SPACE. 06960000
062800     05  FILLER                          PIC  X      VALUE SPACE. 06970000
062900     05  DL1-NRF-COLOR-CDE               PIC  X(03)  VALUE SPACE. 06980000
063000     05  FILLER                          PIC  X      VALUE SPACE. 06990000
063100     05  DL1-NRF-COLOR-DESC              PIC  X(10)  VALUE SPACE. 07000000
063200     05  FILLER                          PIC  X      VALUE SPACE. 07011000
063300     05  DL1-SKU-DESC                    PIC  X(15)  VALUE SPACE. 07020000
063400     05  FILLER                          PIC  X      VALUE SPACE. 07031000
063500     05  DL1-VNDR-STYLE-NME              PIC  X(15)  VALUE SPACE. 07040000
063600     05  FILLER                          PIC  X      VALUE SPACE. 07051000
063700     05  DL1-EXPTED-UNITS                PIC  ZZZ,ZZ9.            07060000
063800     05  FILLER                          PIC  X      VALUE SPACE. 07070000
063900     05  DL1-BEST-CASE-UNITS             PIC  ZZZZ9.              07080000
064000     05  FILLER                          PIC  X      VALUE SPACE. 07090000
064100     05  DL1-ODD-UNITS                   PIC  ZZZ9.               07100000
064200     05  FILLER                          PIC  XX     VALUE SPACE. 07110000
064300     05  FILLER                          PIC  XX     VALUE SPACE. 07130000
064400     05  DL1-RTL-DSCREP-FLG              PIC  X      VALUE SPACE. 07130100
064500     05  FILLER                          PIC  X      VALUE SPACE. 07131000
064600                                                                  07140000
064700* * * STORE DETAIL                                                07150000
064800 01  DETAIL-LINE2.                                                07160000
064900     05  DL2-STORE-DETAIL                   OCCURS 4 TIMES        07170000
065000                                            INDEXED BY            07180000
065100                                            STR-DTL-LNE-IDX.      07190000
065200         10  DL2-STR-NBR                  PIC  ZZZ9.              07200000
065300         10  FILLER                       PIC  X(01).             07210000
065400         10  DL2-CHAR5-ABBR-NAME          PIC  X(05).             07220000
065500         10  FILLER                       PIC  X(02).             07230000
065600         10  DL2-EXPTED-PACK-CNT          PIC  ZZ9.               07240000
065700         10  FILLER                       PIC  X(03).             07250000
065800         10  DL2-DIFF-OPER-UNIT           PIC  X(6).              07260000
065900         10  FILLER                       PIC  X(03).             07270000
066000         10  DL2-PACKS-OPEN-TO-RECEIVE    PIC  ZZ9.               07280000
066100         10  DL2-FILLER                   PIC  X(03).             07290000
066200                                                                  07300000
066300******************************************************************07301000
066400*  IMPORTANT !!!!!!!                                             *07301100
066500*  IF THE NEED ARISES TO ADJUST FILLER IN TL-LINE-1, TL-LINE-2,  *07301200
066600*  OR TL-LINE-3, YOU NEED TO BE VERY CAREFUL NOT TO GET ANY CHARS*07301300
066700*  IN COLS 131 OR 132, BECAUSE IT WILL CREATE AN ERROR AT THE    *07301400
066800*  DC PRINTER (WHICH HAPPENS TO BE A DIFFERENT MODEL FROM THE    *07301500
066900*  PRINTER AT CORP AS OF 5/2000). YOU NEED TO BE SURE TO TEST    *07301600
067000*  ANY CHANGES ON THE DC PRINTER AS WELL AS CORP BECAUSE THEY    *07301700
067100*  ARE DIFFERENT MODELS AND ALSO BECAUSE THE BAR CODE LINE WILL  *07301800
067200*  BE A DIFFERENT POINT SIZE WHEN IT PRINTS. THIS CAN LEAD TO    *07301900
067300*  VERY UNEXPECTED RESULTS WHEN YOU SIMPLY INTEND TO JUSTIFY     *07302000
067400*  COLUMNS, AND SUDDENLY THE REST OF THE PACK DOESN'T PRINT      *07302100
067500*  BECAUSE YOU GET AN UNDEFINED COMMAND ERROR IN THE CARRIAGE    *07302200
067600*  CONTROL COLUMNS WHICH MAY INCLUDE COL 131 AS WELL AS COL 132! *07302300
067700******************************************************************07302400
067800                                                                  07303000
067900 01 TL-LINE-1.                                                    07310000
068000     05  FILLER                          PIC  X(20)  VALUE        07320000
068100         ' EXPECTED PACK QTY: '.                                  07330000
068200     05  FILLER                          PIC  X(11)  VALUE SPACE. 07340000
068300     05  TL1-TOT-EXPTED-PACKS            PIC ZZ,ZZ9.              07350000
068400     05  FILLER                          PIC  X(05)  VALUE SPACE. 07360000
068500     05  FILLER                          PIC  X(27)  VALUE        07370000
068600         'EXPECTED PACK UNIT COUNT:  '.                           07380000
068700     05  TL1-TOT-EXPTED-PACK-UNITS       PIC Z,ZZZ,ZZ9.           07390000
068800     05  FILLER                          PIC  X(22)  VALUE SPACE. 07400000
068900     05  FILLER                          PIC  X(08)  VALUE        07410000
069000         'KEYREC: '.                                              07420000
069100     05  TL1-KEYREC                      PIC  9(08)  VALUE ZERO.  07430000
069200     05  FILLER                          PIC  X(16)  VALUE SPACE. 07440000
069300 01 TL-LINE-2.                                                    07450000
069400     05  FILLER                          PIC  X(26)  VALUE        07460000
069500         ' PACK EXPECTED CARTONS:   '.                            07470000
069600     05  FILLER                          PIC  X(06)  VALUE SPACE. 07480000
069700     05  TL2-TOT-EXPTED-CARTONS          PIC Z,ZZ9.               07490000
069800     05  FILLER                          PIC  X(05)  VALUE SPACE. 07500000
069900     05  FILLER                          PIC  X(29)  VALUE        07510000
070000         'EXPECTED ODD UNIT COUNT:     '.                         07520000
070100     05  TL2-TOT-EXPTED-ODD-UNITS        PIC ZZZ,ZZ9.             07530000
070200     05  FILLER                          PIC  X(54)  VALUE SPACE. 07540000
070300 01 TL-LINE-3-BARCODE.                                            07550000
070400     05  FILLER                          PIC X(15)  VALUE         07560000
070500         '^M0101000^T0010'.                                       07570000
070600     05  FILLER                          PIC  X(31)  VALUE        07580000
070700         'TOTAL STORES GIVEN ALLOCATION: '.                       07590000
070800     05  TL3-TOT-STR-GIVEN               PIC Z,ZZ9.               07600000
070900     05  FILLER                          PIC  X(05)  VALUE SPACE. 07610000
071000     05  FILLER                          PIC  X(27)  VALUE        07620000
071100         'TOTAL EXPECTED UNIT COUNT: '.                           07630000
071200     05  TL3-EXPECTED-UNITS-B            PIC Z,ZZZ,ZZZ.           07640000
071300*  SORTATION CONTROL NUMBER BARCODE                               07650000
071400     05  FILLER                          PIC X(19)   VALUE        07660000
071500         '^M0705000^T1000^BYZ'.                                   07670000
071600     05  TL3-SORT-CONTROL-NBR.                                    07680000
071700         10 TL3-SORT-KEYREC              PIC 9(08)   VALUE ZERO.  07690000
071800         10 TL3-SORT-LINE-NBR            PIC 9(3)    VALUE ZERO.  07700000
071900         10 TL3-SEQ-NBR                  PIC 9(2)    VALUE ZERO.  07710000
072000         10 TL3-SORT-CHKDGT              PIC 9(1)    VALUE ZERO.  07720000
072100     05  FILLER                          PIC X(4)    VALUE '^G^-'.07730000
072200     05  FILLER                          PIC X(3)    VALUE SPACE. 07740000
072300 01 TL-LINE-3-NO-BARCODE.                                         07750000
072400     05  FILLER                          PIC  X(32)  VALUE        07760000
072500         ' TOTAL STORES GIVEN ALLOCATION: '.                      07770000
072600     05  TL3-TOT-STR-GIVEN-NB            PIC Z,ZZ9.               07780000
072700     05  FILLER                          PIC  X(05)  VALUE SPACE. 07790000
072800     05  FILLER                          PIC  X(27)  VALUE        07800000
072900         'TOTAL EXPECTED UNIT COUNT: '.                           07810000
073000     05  TL3-EXPECTED-UNITS-NB           PIC Z,ZZZ,ZZZ.           07820000
073100     05  FILLER                          PIC  X(54)  VALUE SPACE. 07830000
073200******************************************************************07831000
073300*  IMPORTANT !!!!!!!                                             *07832000
073400*  IF THE NEED ARISES TO ADJUST FILLER IN TL-LINE-1, TL-LINE-2,  *07833000
073500*  OR TL-LINE-3, YOU NEED TO BE VERY CAREFUL NOT TO GET ANY CHARS*07834000
073600*  IN COLS 131 OR 132, BECAUSE IT WILL CREATE AN ERROR AT THE    *07835000
073700*  DC PRINTER (WHICH HAPPENS TO BE A DIFFERENT MODEL FROM THE    *07836000
073800*  PRINTER AT CORP AS OF 5/2000). YOU NEED TO BE SURE TO TEST    *07837000
073900*  ANY CHANGES ON THE DC PRINTER AS WELL AS CORP BECAUSE THEY    *07838000
074000*  ARE DIFFERENT MODELS AND ALSO BECAUSE THE BAR CODE LINE WILL  *07839000
074100*  BE A DIFFERENT POINT SIZE WHEN IT PRINTS. THIS CAN LEAD TO    *07839100
074200*  VERY UNEXPECTED RESULTS WHEN YOU SIMPLY INTEND TO JUSTIFY     *07839200
074300*  COLUMNS, AND SUDDENLY THE REST OF THE PACK DOESN'T PRINT      *07839300
074400*  BECAUSE YOU GET AN UNDEFINED COMMAND ERROR IN THE CARRIAGE    *07839400
074500*  CONTROL COLUMNS WHICH MAY INCLUDE COL 131 AS WELL AS COL 132! *07839500
074600******************************************************************07839600
074700 01 TL-LINE-4.                                                    07840000
074800     05  FILLER                          PIC  X(100) VALUE SPACE. 07850000
074900     05  TL4-SORT-CONTROL-NBR.                                    07860000
075000         10 TL4-SORT-KEYREC              PIC 9(08)   VALUE ZERO.  07870000
075100         10 TL4-SORT-LINE-NBR            PIC 9(3)    VALUE ZERO.  07880000
075200         10 TL4-SEQ-NBR                  PIC 9(2)    VALUE ZERO.  07890000
075300         10 TL4-SORT-CHKDGT              PIC 9(1)    VALUE ZERO.  07900000
075400     05  FILLER                          PIC X(18)   VALUE SPACE. 07910000
075500                                                                  07920000
075600* * * ODD UNIT WORKSHEET LINES                                    07930000
075700* LINE2-LINE6  CHANGED FOR THE NEW REPORT LAYOUT     WR/IR# 230ZZ*07931000
075800 01 OUW-LINE1.                                                    07940000
075900     05  FILLER                          PIC  X(29)  VALUE        07950000
076000         'RECORD EXPECTED ODD UNITS OR '.                         07960000
076100     05  FILLER                          PIC  X(28)  VALUE        07970000
076200         'IN-CARTON OVERAGE/SHORTAGES.'.                          07980000
076300     05  FILLER                          PIC  X(75)  VALUE SPACE. 07990000
076400 01 OUW-LINE2.                                                    08000000
076500     05  FILLER                          PIC  X(15)  VALUE SPACE. 08010000
076600     05  FILLER                          PIC  X(04)  VALUE        08020000
076700         'SKU '.                                                  08030000
076800     05  OUW-SKU-LINE.                                            08040000
076900         10  FILLER                      PIC  X(100).             08050000
077000     05  OUW-SKU-TBL REDEFINES OUW-SKU-LINE.                      08060000
077100         10  FILLER                      PIC  X(01).              08070000
077200         10  OUW-SKU-SEG OCCURS 11 TIMES.                         08080000
077300             15  OUW-SKU                 PIC  X(08).              08100000
077400             15  FILLER                  PIC  X(01).              08110000
077500     05  FILLER                          PIC  X(09)  VALUE        08120000
077600         '        |'.                                             08130000
077700     05  FILLER                          PIC  X(04)  VALUE SPACE. 08140000
077800 01 OUW-LINE3.                                                    08150000
077900     05  FILLER                          PIC  X(14)  VALUE SPACE. 08160000
078000     05  FILLER                          PIC  X(05)  VALUE        08170000
078100         'SIZE '.                                                 08180000
078200     05  OUW-SIZE-LINE.                                           08190000
078300         10  FILLER                      PIC  X(100).             08200000
078400     05  OUW-SIZE-TBL REDEFINES OUW-SIZE-LINE.                    08210000
078500         10  FILLER                      PIC  X(01).              08220000
078600         10  OUW-SIZE-SEG OCCURS 11 TIMES.                        08230000
078700             15  FILLER                  PIC  X(03).              08231000
078800             15  OUW-SIZE                PIC  X(05).              08240000
078900             15  FILLER                  PIC  X(01).              08250000
079000     05  FILLER                          PIC  X(09)  VALUE        08260000
079100         '        |'.                                             08270000
079200     05  FILLER                          PIC  X(04)  VALUE SPACE. 08280000
079300 01 OUW-LINE4.                                                    08290000
079400     05  FILLER                          PIC  X(10)  VALUE SPACE. 08300000
079500     05  FILLER                          PIC  X(09)  VALUE        08310000
079600         'PO LINES '.                                             08320000
079700     05  OUW-LINE-NBR-LINE.                                       08330000
079800         10  FILLER                      PIC  X(100).             08340000
079900     05  OUW-LINE-NBR-TBL REDEFINES OUW-LINE-NBR-LINE.            08350000
080000         10  FILLER                      PIC  X(01).              08360000
080100         10  OUW-LINE-NBR-SEG OCCURS 11 TIMES.                    08370000
080200             15  FILLER                  PIC  X(04).              08371000
080300             15  OUW-LINE-NBR            PIC  ZZZ9.               08380000
080400             15  FILLER                  PIC  X(01).              08390000
080500     05  FILLER                          PIC  X(09)  VALUE        08400000
080600         '        |'.                                             08410000
080700     05  FILLER                          PIC  X(04)  VALUE SPACE. 08420000
080800 01 OUW-LINE5.                                                    08430000
080900     05  FILLER                          PIC  X(19)  VALUE        08440000
081000         '    EXPECTED RATIO '.                                   08450000
081100     05  OUW-RATIO-LINE.                                          08460000
081200         10  FILLER                      PIC  X(100).             08470000
081300     05  OUW-RATIO-TBL REDEFINES OUW-RATIO-LINE.                  08480000
081400         10  FILLER                      PIC  X(01).              08490000
081500         10  OUW-RATIO-SEG OCCURS 11 TIMES.                       08500000
081600             15  FILLER                  PIC  X(06).              08510000
081700             15  OUW-RATIO               PIC  Z9.                 08520000
081800             15  FILLER                  PIC  X(01).              08530000
081900     05  FILLER                          PIC  X(09)  VALUE        08540000
082000         '        |'.                                             08550000
082100     05  FILLER                          PIC  X(04)  VALUE SPACE. 08560000
082200 01 OUW-LINE6.                                                    08570000
082300     05  FILLER                          PIC  X(19)  VALUE        08580000
082400         'EXPECTED ODD UNITS '.                                   08590000
082500     05  OUW-ODD-UNITS-LINE.                                      08600000
082600         10  FILLER                      PIC  X(100).             08610000
082700     05  OUW-ODD-UNITS-TBL REDEFINES OUW-ODD-UNITS-LINE.          08620000
082800         10  FILLER                      PIC  X(01).              08630000
082900         10  OUW-ODD-UNITS-SEG OCCURS 11 TIMES.                   08640000
083000             15  FILLER                  PIC  X(05).              08650000
083100             15  OUW-ODD-UNITS           PIC  ZZ9.                08660000
083200             15  FILLER                  PIC  X(01).              08670000
083300     05  FILLER                          PIC  X(09)  VALUE        08680000
083400         '        |'.                                             08690000
083500     05  FILLER                          PIC  X(04)  VALUE SPACE. 08700000
083600* LINE2-LINE6  CHANGED FOR THE NEW REPORT LAYOUT     WR/IR# 230ZZ*08701000
083700 01 OUW-LINE7.                                                    08710000
083800     05  OUW-STR-NBR-AREA.                                        08720000
083900         10  FILLER                      PIC  X(08)  VALUE SPACE. 08730000
084000         10  OUW-STR-NBR                 PIC  X(04)  VALUE SPACE. 08740000
084100         10  FILLER                      PIC  X(07)  VALUE SPACE. 08750000
084200     05  OUW-STR-ALLOC-AREA              PIC  X(109) VALUE SPACE. 08760000
084300     05  FILLER                          PIC  X(04)  VALUE SPACE. 08770000
084400 01  OUW-LINE8.                                                   08780000
084500     05  FILLER                    PIC  X(01)  VALUE SPACE.       08790000
084600     05  FILLER                    PIC  X(28)  VALUE              08800000
084700         'PROCESSED BY _______________'.                          08810000
084800     05  FILLER                    PIC  X(02)  VALUE SPACE.       08820000
084900     05  FILLER                    PIC  X(16)  VALUE              08830000
085000         'SHIFT __________'.                                      08840000
085100     05  FILLER                    PIC  X(02)  VALUE SPACE.       08850000
085200     05  FILLER                    PIC  X(20)  VALUE              08860000
085300         'DATE _______________'.                                  08870000
085400     05  FILLER                    PIC  X(62)  VALUE SPACES.      08880000
085500* NO. OF LINES REDUCED FOR THE NEW REPORT LAYOUT    WR/IR# 230ZZ**08890000
085600 01  OUW-VERTICAL-BAR-LINE.                                       08900000
085700     05  FILLER                          PIC  X      VALUE '|'.   08910000
085800     05  FILLER                          PIC  X(08)  VALUE SPACE. 08920000
085900     05  FILLER                          PIC  X      VALUE '|'.   08930000
086000     05  FILLER                          PIC  X(08)  VALUE SPACE. 08940000
086100     05  FILLER                          PIC  X      VALUE '|'.   08950000
086200     05  FILLER                          PIC  X(08)  VALUE SPACE. 08960000
086300     05  FILLER                          PIC  X      VALUE '|'.   08970000
086400     05  FILLER                          PIC  X(08)  VALUE SPACE. 08980000
086500     05  FILLER                          PIC  X      VALUE '|'.   08990000
086600     05  FILLER                          PIC  X(08)  VALUE SPACE. 09000000
086700     05  FILLER                          PIC  X      VALUE '|'.   09010000
086800     05  FILLER                          PIC  X(08)  VALUE SPACE. 09020000
086900     05  FILLER                          PIC  X      VALUE '|'.   09030000
087000     05  FILLER                          PIC  X(08)  VALUE SPACE. 09040000
087100     05  FILLER                          PIC  X      VALUE '|'.   09050000
087200     05  FILLER                          PIC  X(08)  VALUE SPACE. 09060000
087300     05  FILLER                          PIC  X      VALUE '|'.   09070000
087400     05  FILLER                          PIC  X(08)  VALUE SPACE. 09080000
087500     05  FILLER                          PIC  X      VALUE '|'.   09090000
087600     05  FILLER                          PIC  X(08)  VALUE SPACE. 09100000
087700     05  FILLER                          PIC  X      VALUE '|'.   09110000
087800     05  FILLER                          PIC  X(08)  VALUE SPACE. 09120000
087900     05  FILLER                          PIC  X      VALUE '|'.   09130000
088000     05  FILLER                          PIC  X(08)  VALUE SPACE. 09140000
088100     05  FILLER                          PIC  X      VALUE '|'.   09150000
088200     05  FILLER                          PIC  X(08)  VALUE SPACE. 09160000
088300     05  FILLER                          PIC  X      VALUE '|'.   09170000
088400* NO. OF LINES REDUCED FOR THE NEW REPORT LAYOUT    WR/IR# 230ZZ**09271000
088500 01  OUW-HORIZONTAL-LINE.                                         09280000
088600     05  FILLER                          PIC  X      VALUE '|'.   09290000
088700     05  FILLER                          PIC  X(08)  VALUE        09300000
088800         '________'.                                              09310000
088900     05  FILLER                          PIC  X      VALUE '|'.   09320000
089000     05  FILLER                          PIC  X(08)  VALUE        09330000
089100         '________'.                                              09340000
089200     05  FILLER                          PIC  X      VALUE '|'.   09350000
089300     05  FILLER                          PIC  X(08)  VALUE        09360000
089400         '________'.                                              09370000
089500     05  FILLER                          PIC  X      VALUE '|'.   09380000
089600     05  FILLER                          PIC  X(08)  VALUE        09390000
089700         '________'.                                              09400000
089800     05  FILLER                          PIC  X      VALUE '|'.   09410000
089900     05  FILLER                          PIC  X(08)  VALUE        09420000
090000         '________'.                                              09430000
090100     05  FILLER                          PIC  X      VALUE '|'.   09440000
090200     05  FILLER                          PIC  X(08)  VALUE        09450000
090300         '________'.                                              09460000
090400     05  FILLER                          PIC  X      VALUE '|'.   09470000
090500     05  FILLER                          PIC  X(08)  VALUE        09480000
090600         '________'.                                              09490000
090700     05  FILLER                          PIC  X      VALUE '|'.   09500000
090800     05  FILLER                          PIC  X(08)  VALUE        09510000
090900         '________'.                                              09520000
091000     05  FILLER                          PIC  X      VALUE '|'.   09530000
091100     05  FILLER                          PIC  X(08)  VALUE        09540000
091200         '________'.                                              09550000
091300     05  FILLER                          PIC  X      VALUE '|'.   09560000
091400     05  FILLER                          PIC  X(08)  VALUE        09570000
091500         '________'.                                              09580000
091600     05  FILLER                          PIC  X      VALUE '|'.   09590000
091700     05  FILLER                          PIC  X(08)  VALUE        09600000
091800         '________'.                                              09610000
091900     05  FILLER                          PIC  X      VALUE '|'.   09620000
092000     05  FILLER                          PIC  X(08)  VALUE        09630000
092100         '________'.                                              09640000
092200     05  FILLER                          PIC  X      VALUE '|'.   09650000
092300* NO. OF LINES REDUCED FOR THE NEW REPORT LAYOUT    WR/IR# 230ZZ**09831000
092400 01  DASHES-LINE.                                                 09840000
092500     05  FILLER                          PIC  X(33)  VALUE        09850000
092600         '---------------------------------'.                     09860000
092700     05  FILLER                          PIC  X(33)  VALUE        09870000
092800         '---------------------------------'.                     09880000
092900     05  FILLER                          PIC  X(33)  VALUE        09890000
093000         '---------------------------------'.                     09900000
093100     05  FILLER                          PIC  X(33)  VALUE        09910000
093200         '-------------------------------- '.                     09920000
093300*                                                                 09930000
093400 01  PC-PROGRAM-CONSTANTS.                                        09940000
093500     05  PC-DB2-DUMMY-DATE-TIME          PIC  X(26)  VALUE        09950000
093600         '9999-09-09-09.09.09.999999'.                            09960000
093700     05  PC-DB2-ZERO-DATE-TIME           PIC  X(26)  VALUE        09970000
093800         '0000-00-00-00.00.00.000000'.                            09980000
093900     05  PC-MULTIPLE-RESULT-SET-ROWS     PIC S9(04)  VALUE -811   09990000
094000                                                     COMP SYNC.   10000000
094100     05  PC-PCKCS014                     PIC  X(08)  VALUE        10010000
094200                                                     'PCKCS014'.  10020000
094300     05  PC-SLASH                        PIC  X(01)  VALUE '/'.   10030000
094400     05  PC-Y                            PIC  X(02)  VALUE 'Y'.   10040000
094500     05  PC-ONE                          PIC  9(01)  VALUE 1.     10050000
094600     05  PC-ZERO                         PIC S9(09)  COMP VALUE   10060000
094700         ZERO.                                                    10070000
094800     05  PC-2                            PIC  9(01)  VALUE 2.     10080000
094900     05  PC-5                            PIC  9(01)  VALUE 5.     10090000
095000     05  PC-3                            PIC  9(01)  VALUE 3.     10100000
095100     05  PC-B                            PIC  X(01)  VALUE 'B'.   10110000
095200     05  PC-C                            PIC  X(01)  VALUE 'C'.   10120000
095300     05  PC-T                            PIC  X(01)  VALUE 'T'.   10130000
095400     05  PC-M                            PIC  X(01)  VALUE 'M'.   10140000
095500     05  PC-N                            PIC  X(01)  VALUE 'N'.   10150000
095600     05  PC-I                            PIC  X(01)  VALUE 'I'.   10160000
095700     05  PC-U                            PIC  X(01)  VALUE 'U'.   10170000
095800     05  PC-V                            PIC  X(01)  VALUE 'V'.   10171000
095900     05  PC-R                            PIC  X(01)  VALUE 'R'.   10180000
096000     05  PC-S                            PIC  X(01)  VALUE 'S'.   10190000
096100     05  PC-DS                           PIC  X(02)  VALUE 'DS'.  10200000
096200     05  PC-CS                           PIC  X(02)  VALUE 'CS'.  10210000
096300     05  PC-DC                           PIC  X(02)  VALUE 'DC'.  10220000
096400     05  PC-RV                           PIC  X(02)  VALUE 'RV'.  10230000
096500     05  PC-DASH                         PIC  X(01)  VALUE '-'.   10240000
096600     05  PC-KOHLS-OPERATING-COMPANY      PIC  X(02)  VALUE '03'.  10250000
096700     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   10260000
096800                                                     COMP SYNC.   10270000
096900     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        10280000
097000                                              'PCKCS708'.         10290000
097100     05  PC-APRON-RPT-HDR                PIC  X(52)  VALUE        10300000
097200          'P  A  C  K     M  A  R  K  I  N  G     A  P  R  O  N'. 10310000
097300     05  PC-OUW-RPT-HDR                  PIC  X(52)  VALUE        10320000
097400          'O  D  D     U  N  I  T     W  O  R  K  S  H  E  E  T'. 10330000
097500     05  PC-ROWS-PER-PAGE-50             PIC S9(04)  VALUE +50    10340000
097600                                                     COMP SYNC.   10350000
097700     05  PC-MAX-STR-TBL-OCCURANCES       PIC S9(04)  VALUE +1500  10360000
097800                                                     COMP SYNC.   10370000
097900     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     10380000
098000                                                     COMP SYNC.   10390000
098100     05  PC-PUT                          PIC  X(03)  VALUE 'PUT'. 10400000
098200     05  PC-A                            PIC  X(02)  VALUE 'A'.   10410000
098300     05  PC-10                           PIC  X(02)  VALUE '10'.  10420000
098400     05  PC-TOP-OF-PAGE                  PIC  X(01)  VALUE '1'.   10430000
098500     05  PC-SINGLE-SPACE                 PIC  X(01)  VALUE ' '.   10440000
098600     05  PC-DOUBLE-SPACE                 PIC  X(01)  VALUE '0'.   10450000
098700     05  PC-TRIPLE-SPACE                 PIC  X(01)  VALUE '-'.   10460000
098800     05  PC-MULTIPLE-SKU-PPK             PIC  X(21)  VALUE        10470000
098900         'M - MULTI SKU PREPACK'.                                 10480000
099000     05  PC-SINGLE-SKU-PPK               PIC  X(22)  VALUE        10490000
099100         'S - SINGLE SKU PREPACK'.                                10500000
099200     05  PC-INNER-PPK                    PIC  X(17)  VALUE        10510000
099300         'I - INNER PREPACK'.                                     10520000
099400     05  PC-BULK-PPK                     PIC  X(13)  VALUE        10530000
099500         'B - BULK PACK'.                                         10540000
099600     05  PC-CASEPACK                     PIC  X(12)  VALUE        10550000
099700         'C - CASEPACK'.                                          10560000
099800     05  PC-STORE-NBR-LIT                PIC  X(13) VALUE         10570000
099900         'STORE NUMBERS'.                                         10580000
100000     05  PC-ACTUAL-ODD-LIT               PIC  X(16) VALUE         10590000
100100         'ACTUAL ODD UNITS'.                                      10600000
100200     05  PC-EXTERNAL-UPC-LOW          PIC S9(15)V                 10610000
100300                                      VALUE 000000000000000       10620000
100400                                      COMP-3.                     10630000
100500     05  PC-INTERNAL-UPC-LOW          PIC S9(15)V                 10640000
100600                                      VALUE 000399999999999       10650000
100700                                      COMP-3.                     10660000
100800     05  PC-INTERNAL-UPC-HIGH         PIC S9(15)V                 10670000
100900                                      VALUE 000500000000000       10680000
101000                                      COMP-3.                     10690000
101100     05  PC-EXTERNAL-UPC-HIGH         PIC S9(15)V                 10700000
101200                                      VALUE 999999999999999       10710000
101300                                      COMP-3.                     10720000
101400     05  PC-ABEND-MESSAGE                PIC  X(132) VALUE        10730000
101500          '  ***** ABEND   ABEND   ABEND   ABEND   ABEND ***'.    10740000
101600                                                                  10750000
101700     05  PC-VS-HNGFLD-TYPE-CDE       PIC S9(04) COMP              10760000
101800                                                VALUE +10.        10770000
101900     05  PC-SUBCLASS-MDSELV-CDE      PIC  X(03) VALUE 'SCL'.      10780000
102000     05  PC-MAJCLASS-MDSELV-CDE      PIC X(03) VALUE 'MCL'.       10790000
102100     05  PC-DPT-MDSELV-CDE           PIC X(03) VALUE 'DPT'.       10800000
102200     05  PC-000                       PIC X(03) VALUE '000'.      10807000
102300     05  PC-999                       PIC X(03) VALUE '999'.      10808000
102400*                                                                 10810000
102500 01  PS-PROGRAM-SWITCHES.                                         10820000
102600     05  PS-PACK-LINE-CSR-SW             PIC  X      VALUE '1'.   10830000
102700         88  PS-PACK-LINE-CSR                        VALUE '1'.   10840000
102800         88  PS-PACK-LINE-CSR2                       VALUE '2'.   10850000
102900     05  PS-PACK-LINES-SW                PIC  X      VALUE 'N'.   10860000
103000         88  PS-END-OF-PACK-ITEMS                    VALUE 'Y'.   10870000
103100     05  PS-ODD-UNITS-SW                 PIC  X      VALUE 'N'.   10880000
103200         88  PS-ODD-UNITS                            VALUE 'Y'.   10890000
103300     05  PS-UPDATES-DONE-SW              PIC  X      VALUE 'N'.   10900000
103400         88  PS-UPDATES-DONE                         VALUE 'Y'.   10910000
103500         88  PS-NO-UPDATES-DONE                      VALUE 'N'.   10920000
103600     05  PS-DISCREPANCY-SW               PIC  X      VALUE 'N'.   10920100
103700         88  PS-NO-DISCREPANCY                       VALUE 'N'.   10920200
103800         88  PS-DISCREPANCY                          VALUE 'Y'.   10921000
103900     05  PS-PRINT-NO-DISTRO-MSG-SW       PIC  X      VALUE 'N'.   10930000
104000         88  PS-PRINT-NO-DISTRO-MSG                  VALUE 'Y'.   10940000
104100         88  PS-DONT-PRINT-NO-DISTRO-MSG             VALUE 'N'.   10950000
104200     05  PS-PRINT-STORE-PROBLEM-SW       PIC  X      VALUE 'N'.   10960000
104300         88  PS-DONT-PRINT-STORE-PROBLEM             VALUE 'N'.   10970000
104400         88  PS-PRINT-STORE-PROBLEM                  VALUE 'Y'.   10980000
104500     05  PS-MORE-RECEIPT-SW              PIC  X      VALUE 'Y'.   10990000
104600         88  PS-NO-MORE-RECEIPT                      VALUE 'N'.   11000000
104700         88  PS-MORE-RECEIPT                         VALUE 'Y'.   11010000
104800     05  PS-REDISTRO-SW                  PIC  X      VALUE 'Y'.   11020000
104900         88  PS-NO-REDISTRO                          VALUE 'N'.   11030000
105000         88  PS-REDISTRO                             VALUE 'Y'.   11040000
105100     05  PS-MATCH-FOUND-SW               PIC  X      VALUE 'N'.   11050000
105200         88  PS-MATCH-FOUND                          VALUE 'Y'.   11060000
105300         88  PS-MATCH-NOT-FOUND                      VALUE 'N'.   11070000
105400     05  PS-SPECIAL-INSTRS-IND           PIC  X(01)  VALUE SPACE. 11080000
105500         88  PS-NO-SPECIAL-INSTRS-FOUND              VALUE 'N'.   11090000
105600         88  PS-MULT-SPECIAL-INSTRS-FOUND            VALUE 'Y'.   11100000
105700     05  PS-DIFF-OPER-UNIT-ID-IND        PIC  X(01)  VALUE 'N'.   11110000
105800         88  PS-DIFF-OPER-UNIT-ID                    VALUE 'Y'.   11120000
105900         88  PS-SAME-OPER-UNIT-ID                    VALUE 'N'.   11130000
106000     05  PS-VENDOR-REQ-CERT-IND          PIC X(1)    VALUE 'N'.   11140000
106100         88  PS-VENDOR-REQ-CERT                      VALUE 'Y'.   11150000
106200     05  PS-EOF-QUEUE-SW                 PIC  X(01)  VALUE 'N'.   11160000
106300         88  PS-EOF-QUEUE                            VALUE 'Y'.   11170000
106400     05  PS-START-NEW-PAGE-SW            PIC  X(01)  VALUE SPACE. 11180000
106500         88  PS-START-NEW-PAGE                       VALUE 'Y'.   11190000
106600     05  PS-TOP-OF-PAGE-SET-SW           PIC  X(01)  VALUE 'N'.   11200000
106700         88  PS-TOP-OF-PAGE-SET                      VALUE 'Y'.   11210000
106800         88  PS-TOP-OF-PAGE-NOT-SET                  VALUE 'N'.   11220000
106900     05  PS-TVNDAGR-FOUND-SW             PIC X(01)   VALUE 'Y'.   11270000
107000         88  PS-NO-TVNDAGR                           VALUE 'N'.   11280000
107100     05  PS-TRECITM-FOUND-SW             PIC X(01)   VALUE 'Y'.   11290000
107200         88  PS-NO-TRECITM                           VALUE 'N'.   11300000
107300         88  PS-YES-TRECITM                          VALUE 'Y'.   11310000
107400     05  PS-RTV-DISTRO-SW                PIC X(01)   VALUE 'N'.   11320000
107500         88  PS-NO-RTV-DISTRO                        VALUE 'N'.   11330000
107600         88  PS-RTV-DISTRO                           VALUE 'Y'.   11340000
107700     05  PS-PRINT-ITEM-DETAIL-SW         PIC X(01)   VALUE 'N'.   11350000
107800         88  PS-PRINT-ITEM-DETAIL                    VALUE 'Y'.   11360000
107900     05  PS-PRINT-STORE-WORKAREA-SW      PIC X(01)   VALUE 'N'.   11370000
108000         88  PS-PRINT-STORE-WORKAREA                 VALUE 'Y'.   11380000
108100     05  PS-END-OF-DETAIL-SW             PIC X(01)   VALUE 'N'.   11390000
108200         88  PS-END-OF-DETAIL                        VALUE 'Y'.   11400000
108300         88  PS-NOT-END-OF-DETAIL                    VALUE 'N'.   11410000
108400     05  PS-RTV-PRINT-SW                 PIC X(01)   VALUE 'N'.   11420000
108500         88  PS-RTV-PRINT                            VALUE 'Y'.   11430000
108600         88  PS-NO-RTV-PRINT                         VALUE 'N'.   11440000
108700     05  PS-SHORTEN-LAST-PAGE-SW         PIC X(01)   VALUE 'N'.   11450000
108800         88  PS-SHORTEN-LAST-PAGE                    VALUE 'Y'.   11460000
108900         88  PS-DONT-SHORTEN-LAST-PAGE               VALUE 'N'.   11470000
109000     05  PS-VSM-SW                        PIC  X     VALUE 'N'.   11480000
109100         88  PS-NOT-VSM                              VALUE 'N'.   11490000
109200         88  PS-VSM                                  VALUE 'Y'.   11500000
109300     05  PS-CALL-API                      PIC  X     VALUE 'N'.   11501000
109400         88  PS-CALL-API-NO                          VALUE 'N'.   11502000
109500         88  PS-CALL-API-YES                         VALUE 'Y'.   11503000
109600*                                                                 11510000
109700 01  PS-PROGRAM-SUBSCRIPTS.                                       11520000
109800     05  PS-DTL-LNE-SUB                  PIC S9(04)  VALUE +0     11530000
109900                                                     COMP SYNC.   11540000
110000     05  PS-COUNTER                      PIC S9(04)  VALUE +0     11550000
110100                                                     COMP SYNC.   11560000
110200     05  PS-PAGE-SUB                     PIC S9(04)  VALUE +0     11570000
110300                                                     COMP SYNC.   11580000
110400     05  PS-RTV-SUB                      PIC S9(04)  VALUE +0     11590000
110500                                                     COMP SYNC.   11600000
110600     05  STR-SUB                         PIC S9(04)  VALUE +0     11610000
110700                                                     COMP SYNC.   11620000
110800     05  PACK-LINE-SUB                   PIC S9(04)  VALUE +0     11630000
110900                                                     COMP SYNC.   11640000
111000     05  WORK-LINE-SUB                   PIC S9(04)  VALUE +0     11650000
111100                                                     COMP SYNC.   11660000
111200*                                                                 11670000
111300 01  PV-PROGRAM-VARIABLES.                                        11680000
111400     05  PV-DRIVER-LINE-NBR              PIC S9(09)  VALUE +0     11690000
111500                                                     COMP.        11700000
111600     05  PV-DRIVER-LINE-RATIO            PIC S9(05)  VALUE +0     11710000
111700                                                     COMP-3.      11720000
111800     05  PV-16-ITEM-CNT                  PIC S9(05)  VALUE +0     11730000
111900                                                     COMP-3.      11740000
112000     05  PV-EXPTED-PACK-CNT-SUM-TOT      PIC S9(05)  VALUE +0     11750000
112100                                                     COMP-3.      11760000
112200     05  PV-EXPTED-PACK-CNT-NUM          PIC S9(05)  VALUE +0     11770000
112300                                                     COMP-3.      11780000
112400     05  PV-WRK-QTY                      PIC S9(05)  VALUE +0     11790000
112500                                                     COMP-3.      11800000
112600     05  PV-REMAINDER                    PIC S9(03)  VALUE +0     11810000
112700                                                     COMP-3.      11820000
112800     05  PV-LINES-AVAILABLE              PIC S9(04)  VALUE +0     11830000
112900                                                     COMP SYNC.   11840000
113000     05  PV-LINES-USED                   PIC S9(04)  VALUE +0     11850000
113100                                                     COMP SYNC.   11860000
113200     05  PV-STR-LINES-REQD               PIC S9(04)  VALUE +0     11870000
113300                                                     COMP SYNC.   11880000
113400     05  PV-END-OF-APRON-LINES-REQD      PIC S9(04)  VALUE +0     11890000
113500                                                     COMP SYNC.   11900000
113600     05  PV-SAVE-LINES-USED              PIC S9(04)  VALUE +0     11910000
113700                                                     COMP SYNC.   11920000
113800     05  PV-COLS-PER-PAGE                PIC S9(04)  VALUE +4     11930000
113900                                                     COMP SYNC.   11940000
114000     05  PV-ROWS-PER-PAGE                PIC S9(04)  VALUE +0     11950000
114100                                                     COMP SYNC.   11960000
114200     05  PV-ROWS-DIV-BY-THREE            PIC S9(04)  VALUE +0     11961000
114300                                                     COMP SYNC.   11962000
114400     05  PV-STRS-PER-PAGE                PIC S9(04)  VALUE +0     11970000
114500                                                     COMP SYNC.   11980000
114600     05  PV-NUM-ITEMS                    PIC S9(4)   VALUE ZERO   11990000
114700                                                     COMP SYNC.   12000000
114800     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  12010000
114900                                                     COMP SYNC.   12020000
115000     05  PV-CICS-MSG-AREA                PIC X(75)   VALUE SPACE. 12030000
115100     05  PV-ITEM-NBR                     PIC S9(04)  COMP.        12040000
115200     05  PV-STR-REC-QTY                  PIC S9(9)   COMP.        12050000
115300     05  PV-LAST-STR-ON-PAGE             PIC S9(9)   COMP.        12060000
115400     05  PV-ENDING-IDX-LOCATION          PIC S9(9)   COMP.        12070000
115500     05  PV-SUM-STR-PLAN-QTY             PIC S9(9)   COMP.        12080000
115600     05  PV-RETRY-COUNTER                PIC S9(4)   VALUE ZERO   12090000
115700                                                     COMP SYNC.   12100000
115800     05  PV-SUM-VERIFIED-QTY             PIC S9(09)  VALUE ZERO   12110000
115900                                                     COMP SYNC.   12120000
116000     05  PV-VERIFIED-IND                 PIC S9(04)  VALUE ZERO   12130000
116100                                                     COMP SYNC.   12140000
116200     05  PV-OTR                          PIC S9(09)  VALUE ZEROS. 12150000
116300     05  PV-UNION-IND                    PIC  X(01).              12160000
116400     05  PV-DB2-CURRENT-TMST             PIC  X(26).              12200000
116500     05  PV-SELECT-COUNT                 PIC S9(08)  VALUE +0.    12210000
116600     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZERO   12220000
116700                                                     COMP SYNC.   12230000
116800     05  PV-PAGES-REQ                    PIC  9(02)  VALUE ZEROS. 12240000
116900     05  PV-TOTAL-PAGES                  PIC  9(02)  VALUE ZEROS. 12250000
117000     05  PV-LAST-PAGE-COUNT              PIC S9(04)  VALUE ZEROS  12260000
117100                                                     COMP SYNC.   12270000
117200     05  PV-STR-NBR                      PIC S9(4)   VALUE +0     12280000
117300                                                     COMP.        12290000
117400     05  PV-COUNT                        PIC S9(9)   VALUE +0     12330000
117500                                                     COMP-3.      12340000
117600     05  PV-EFF-CLOSE-DATE               PIC  X(10)  VALUE SPACES.12341000
117700     05  PV-DB2-CURRENT-DATE             PIC  X(10)  VALUE SPACES.12350000
117800     05  PV-DB2-AD-EVNT-DATE             PIC  X(10)  VALUE SPACES.12360000
117900     05  PV-DB2-DATE.                                             12370000
118000         10  PV-DB2-DATE-CC           PIC  X(02).                 12380000
118100         10  PV-DB2-DATE-YY           PIC  X(02).                 12390000
118200         10  FILLER                   PIC  X(01).                 12400000
118300         10  PV-DB2-DATE-MM           PIC  X(02).                 12410000
118400         10  FILLER                   PIC  X(01).                 12420000
118500         10  PV-DB2-DATE-DD           PIC  X(02).                 12430000
118600     05  PV-DISPLAY-DATE.                                         12440000
118700         10  PV-DISPLAY-DATE-MM       PIC  X(02).                 12450000
118800         10  FILLER                   PIC  X(01) VALUE '/'.       12460000
118900         10  PV-DISPLAY-DATE-DD       PIC  X(02).                 12470000
119000         10  FILLER                   PIC  X(01) VALUE '/'.       12480000
119100         10  PV-DISPLAY-DATE-YY       PIC  X(02).                 12490000
119200     05  PV-FRMTD-DIFF-OPER-UNT-ID.                               12500000
119300         10  FILLER                      PIC  X(01)  VALUE '('.   12520000
119400         10  PV-DIFF-OPER-UNT-ID         PIC  9(04)  VALUE ZEROS. 12530000
119500         10  FILLER                      PIC  X(01)  VALUE ')'.   12540000
119600     05  PV-EXPTED-ITM-CNT               PIC  9(06)  VALUE ZEROS. 12550000
119700     05  PV-STR-CNT                      PIC  9(04)  VALUE ZEROS. 12560000
119800     05  PV-STORES-GIVEN-PIECES          PIC  9(04)  VALUE ZEROS. 12570000
119900     05  PV-RTV-STORES                   PIC  9(04)  VALUE ZEROS. 12580000
120000     05  PV-TOT-EXPTED-ITM-CNT           PIC  9(09)  VALUE ZEROS. 12590000
120100     05  PV-TOT-RTV-EXPTED-ITM-CNT       PIC  9(09)  VALUE ZEROS. 12600000
120200     05  PV-TOT-BEST-CAST-UNITS          PIC S9(07)  VALUE ZERO.  12610000
120300     05  PV-TOT-ODD-UNITS                PIC S9(07)  VALUE ZERO.  12620000
120400     05  PV-TABLE-STORE-COUNT            PIC S9(05)  VALUE ZERO   12630000
120500                                                     COMP-3.      12640000
120600     05  PV-CICS-RESP                    PIC S9(8) VALUE ZERO     12650000
120700                                                COMP SYNC.        12660000
120800     05  PV-NULL-IND                     PIC S9(4) VALUE ZERO     12670000
120900                                                COMP SYNC.        12680000
121000     05  PV-SUBCLASS-NBR.                                         12690000
121100         10  FILLER                   PIC X(01) VALUE '0'.        12700000
121200         10  PV-SUBCLASS.                                         12710000
121300             15  PV-SUBCLASS-MAJ-NBR   PIC X(01).                 12720000
121400             15  PV-SUBCLASS-MIN-NBR  PIC X(01).                  12730000
121500     05  PV-MAJCLASS-NBR.                                         12740000
121600         10  PV-MAJCLASS-MAJ-NBR      PIC X(01).                  12750000
121700         10  FILLER                   PIC X(01) VALUE '0'.        12760000
121800     05  PV-CURRENT-DATE-X.                                       12770000
121900         10  PV-CURRENT-CENTURY-YEAR     PIC  9(04)  VALUE ZEROS. 12780000
122000         10  FILLER                      PIC  X(01)  VALUE '-'.   12790000
122100         10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 12800000
122200         10  FILLER                      PIC  X(01)  VALUE '-'.   12810000
122300         10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 12820000
122400     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            12830000
122500                                         PIC  X(10).              12840000
122600     05  PV-SQLCODE-NUMBER.                                       12850000
122700         10  FILLER                      PIC X(10)  VALUE         12860000
122800             'SQLCODE = '.                                        12870000
122900         10  PV-SQLCODE                  PIC +999.                12880000
123000     05  PV-DRS-ABEND-DISPLAY-LINE1.                              12890000
123100         10  FILLER                      PIC  X(14)  VALUE        12900000
123200             'DRRB ID = DRRB'.                                    12910000
123300         10  FILLER                      PIC  X(02)  VALUE SPACE. 12920000
123400         10  FILLER                      PIC  X(12)  VALUE        12930000
123500             'DRRB FUNC = '.                                      12940000
123600         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 12950000
123700         10  FILLER                      PIC  X(02)  VALUE SPACE. 12960000
123800         10  FILLER                      PIC  X(11)  VALUE        12970000
123900             'DRRB RID = '.                                       12980000
124000         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 12990000
124100         10  FILLER                      PIC  X(02)  VALUE SPACE. 13000000
124200         10  FILLER                      PIC  X(15)  VALUE        13010000
124300             'DRRB OPTIONS = '.                                   13020000
124400         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 13030000
124500     05  PV-DRS-ABEND-DISPLAY-LINE2.                              13040000
124600         10  FILLER                      PIC  X(10)  VALUE        13050000
124700             'DRRB RC = '.                                        13060000
124800         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 13070000
124900         10  FILLER                      PIC  X(02)  VALUE SPACE. 13080000
125000         10  FILLER                      PIC  X(18)  VALUE        13090000
125100             'DRRB ATTR-ERROR = '.                                13100000
125200         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 13110000
125300         10  FILLER                      PIC  X(02)  VALUE SPACE. 13120000
125400         10  FILLER                      PIC  X(12)  VALUE        13130000
125500             'DRRB DRDC = '.                                      13140000
125600         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 13150000
125700         10  FILLER                      PIC  X(02)  VALUE SPACE. 13160000
125800         10  FILLER                      PIC  X(13)  VALUE        13170000
125900             'DRRB LINES = '.                                     13180000
126000         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 13190000
126100     05  PV-DISPLAY-ITEM-NBR             PIC  9(15)  VALUE ZEROS. 13200000
126200     05  PV-DISPLAY-ENT-ID               PIC  9(09)  VALUE ZEROS. 13210000
126300     05  PV-DISPLAY-KEYS.                                         13220000
126400         10  FILLER                      PIC  X(02)  VALUE SPACES.13230000
126500         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  13240000
126600                                                BLANK WHEN ZEROS. 13250000
126700         10  FILLER                      PIC  X(02)  VALUE SPACE. 13260000
126800         10  PV-DISPLAY-RCVR-SEQ-NBR     PIC  9(09)  VALUE ZEROS  13270000
126900                                                BLANK WHEN ZEROS. 13280000
127000         10  FILLER                      PIC  X(02)  VALUE SPACE. 13290000
127100         10  PV-DISPLAY-ORD-LNE-NBR      PIC  9(04)  VALUE ZEROS  13300000
127200                                                BLANK WHEN ZEROS. 13310000
127300         10  FILLER                      PIC  X(02)  VALUE SPACE. 13320000
127400         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  13330000
127500                                                BLANK WHEN ZEROS. 13340000
127600         10  FILLER                      PIC  X(02)  VALUE SPACE. 13350000
127700         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  13360000
127800                                                BLANK WHEN ZEROS. 13370000
127900         10  FILLER                      PIC  X(02)  VALUE SPACE. 13380000
128000         10  PV-DISPLAY-PREPK-ID         PIC  9(04)  VALUE ZEROS. 13390000
128100*                                                                 13400000
128200     05  PV-PRC-FCLTY-AREA-ID         PIC  X(06)  VALUE SPACES.   13410000
128300     05  PV-RETRY-COUNT               PIC  S9(4)  VALUE ZERO      13420000
128400                                                  COMP SYNC.      13430000
128500*                                                                 13440000
128600*  USED FOR COMPUTING SORTATION CONTROL NUMBER CHECK DIGIT        13450000
128700     05  PV-CNTL-NBR-X                   PIC  X(13)  VALUE SPACE. 13460000
128800     05  PV-CNTL-NBR  REDEFINES  PV-CNTL-NBR-X                    13470000
128900                                         PIC  9(13).              13480000
129000     05  FILLER  REDEFINES  PV-CNTL-NBR.                          13490000
129100         10  PV-CNTL-NBR-DIGIT           PIC  9(01)               13500000
129200                                         OCCURS 13 TIMES          13510000
129300                                         INDEXED BY               13520000
129400                                         PV-DIGIT-IDX.            13530000
129500     05  PV-CNTL-NBR-PRODUCT             PIC  9(02)  VALUE ZEROS. 13540000
129600     05  FILLER  REDEFINES  PV-CNTL-NBR-PRODUCT.                  13550000
129700         10  PV-PRODUCT-DIGIT            PIC 9(01)                13560000
129800                                         OCCURS 2 TIMES.          13570000
129900     05  PV-CHECK-SUM                    PIC  9(03)  VALUE ZEROS. 13580000
130000     05  FILLER  REDEFINES  PV-CHECK-SUM.                         13590000
130100         10  FILLER                      PIC  9(02).              13600000
130200         10  PV-CKSUM-LEAST-SIGNIFICANT-DGT                       13610000
130300                                         PIC  9(01).              13620000
130400     05  PV-CHECK-DIGIT                  PIC  9(01)  VALUE ZEROS. 13630000
130500                                                                  13640000
130600 01  ST-SYSTEM-TIME-DATE-AREA.                                    13770000
130700     05  ST-ABSTIME                      PIC S9(15)  VALUE ZERO   13780000
130800                                                     COMP-3.      13790000
130900     05  ST-SYSTEM-TIME.                                          13800000
131000         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 13810000
131100         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 13820000
131200             15  ST-SYSTEM-HOUR          PIC  X(02).              13830000
131300             15  FILLER                  PIC  X(01).              13840000
131400             15  ST-SYSTEM-MINUTE        PIC  X(02).              13850000
131500             15  FILLER                  PIC  X(01).              13860000
131600             15  ST-SYSTEM-SECOND        PIC  X(02).              13870000
131700     05  SD-SYSTEM-DATE.                                          13880000
131800         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 13890000
131900         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 13900000
132000             15  SD-SYSTEM-MONTH         PIC  X(02).              13910000
132100             15  FILLER                  PIC  X(01).              13920000
132200             15  SD-SYSTEM-DAY           PIC  X(02).              13930000
132300             15  FILLER                  PIC  X(01).              13940000
132400             15  SD-SYSTEM-YEAR          PIC  X(02).              13950000
132500         10  FILLER                      PIC  X(02)  VALUE SPACE. 13960000
132600     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       13970000
132700         10  FILLER                      PIC  X(06).              13980000
132800         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              13990000
132900     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     14000000
133000                                                     COMP.        14010000
133100*                                                                 14020000
133200*  THIS TABLE WILL CONSIST OF DATA FOR ALL THE LINES IN THE PACK. 14030000
133300*                                                                 14040000
133400*LD-SEQ-NBR INCREASED TO 8 DIGITS                 WR/IR#230ZZ **  14041000
133500 01  LD-LINE-DETAIL-TBL.                                          14050000
133600     05  LD-LINE-DETAIL OCCURS 500 TIMES.                         14060000
133700         10  LD-LINE-NBR                 PIC  S9(04).             14070000
133800         10  LD-CLASS-NBR                PIC  X(02).              14080000
133900         10  LD-SEQ-NBR                  PIC  X(08).              14091000
134000         10  LD-BOX-ID                   PIC  X(03).              14100000
134100         10  LD-SKU-RTL                  PIC  9(05)V99 COMP-3.    14110000
134200         10  LD-RATIO                    PIC  99.                 14120000
134300         10  LD-SKU-DESC                 PIC  X(15).              14130000
134400         10  LD-VNDR-STYLE-NME           PIC  X(15).              14140000
134500         10  LD-SIZE                     PIC  X(05).              14150000
134600         10  LD-COLOR                    PIC  X(10).              14160000
134700         10  LD-NRF-COLOR-CDE            PIC  X(03).              14170000
134800         10  LD-NRF-COLOR-DESC           PIC  X(10).              14180000
134900         10  LD-UPC-CERT-REQ-FLG         PIC  X.                  14190000
135000         10  LD-EXPTED-UNITS             PIC  S9(07) COMP-3.      14200000
135100         10  LD-BEST-CASE-UNITS          PIC  S9(05) COMP-3.      14210000
135200         10  LD-ODD-UNITS                PIC  S9(03) COMP-3.      14220000
135300         10  LD-RTL-DSCREP-FLG           PIC  X.                  14231000
135400*                                                                 14240000
135500*  THIS TABLE WILL CONSIST OF ALL STORES OPEN FOR RECEIVING       14250000
135600*  FOR THE CURRENT DATE, FOR A GIVEN DISTRIBUTION CENTER.         14260000
135700*                                                                 14270000
135800 01  ST-STORE-TABLE.                                              14280000
135900                                                                  14290000
136000     05  ST-STORE-ENTRY                  OCCURS 1 TO 1500 TIMES   14300000
136100                                         DEPENDING ON             14310000
136200                                            PV-TABLE-STORE-COUNT  14320000
136300                                         ASCENDING KEY IS         14330000
136400                                            ST-STR-NBR            14340000
136500                                         INDEXED BY ST-STR-IDX.   14350000
136600         10  ST-STR-NBR                  PIC S9(4) COMP.          14360000
136700         10  ST-CHAR5-ABBR-NAME          PIC X(5).                14370000
136800         10  ST-DC-NMBR                  PIC 9(4).                14380000
136900         10  ST-DC-RCT-START-DATE        PIC X(10).               14390000
137000         10  ST-DC-RCT-STOP-DATE         PIC X(10).               14400000
137100*                                                                 14440000
137200*  THIS TABLE WILL CONSIST OF ONLY THOSE STORES WHICH HAVE AN     14450000
137300*  EXPECTED ITEM COUNT. IT IS USED FOR PRINTING THE STORE DETAIL  14460000
137400*  LINE INFORMATION.                                              14470000
137500*                                                                 14480000
137600 01  EA-EXPTED-ALLOC-TABLE.                                       14490000
137700     05  EA-ALLOC-ENTRY                  OCCURS 1500 TIMES        14500000
137800                                         INDEXED BY EA-ALLOC-IDX. 14510000
137900         10  EA-STR-NBR                  PIC  9(04).              14520000
138000         10  EA-CHAR5-ABBR-NAME          PIC  X(05).              14550000
138100         10  EA-EXPTED-ITM-CNT           PIC  9(06).              14560000
138200         10  EA-DIFF-OPER-UNT-ID         PIC  X(06).              14570000
138300*        10  EA-ITEMS-OPEN-TO-RECEIVE    PIC  X(06).              14580000
138400         10  EA-ITEMS-OPEN-TO-RECEIVE    PIC  9(06).              14590000
138500         10  EA-CLOSED-IND               PIC  X(01).              14600000
138600             88  EA-STR-OPEN                  VALUE SPACE.        14610000
138700             88  EA-STR-CLOSED                VALUE '*'.          14620000
138800                                                                  14630000
138900 01  RA-RTV-ALLOC-TABLE.                                          14640000
139000     05  RA-ALLOC-ENTRY                  OCCURS 3 TIMES           14650000
139100                                         INDEXED BY RA-ALLOC-IDX. 14660000
139200         10  RA-STR-NBR                  PIC  9(04).              14670000
139300         10  RA-CHAR5-ABBR-NAME          PIC  X(05).              14700000
139400         10  RA-EXPTED-ITM-CNT           PIC  9(06).              14710000
139500         10  RA-DIFF-OPER-UNT-ID         PIC  X(06).              14720000
139600*        10  RA-ITEMS-OPEN-TO-RECEIVE    PIC  X(06).              14730000
139700         10  RA-ITEMS-OPEN-TO-RECEIVE    PIC  9(06).              14740000
139800         10  RA-CLOSED-IND               PIC  X(01).              14750000
139900             88  RA-STR-OPEN                  VALUE SPACE.        14760000
140000             88  RA-STR-CLOSED                VALUE '*'.          14770000
140100*                                                                 14780000
140200 EJECT                                                            14790000
140300*                                                                 14800000
140400*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            14810000
140500*                                                                 14820000
140600     COPY DRRD001O.                                               14830000
140700                                                                  14840000
140800*                                                                 14850000
140900*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        14860000
141000*                                                                 14870000
141100     COPY DRRD002O.                                               14880000
141200                                                                  14890000
141300 EJECT                                                            14920000
141400*                                                                 14930000
141500*  DECLARE FOR ALL THE LINES OF THE RECEIVER PACK ID              14940000
141600*  USING MATCH ON VERSION NUMBER                                  14950000
141700*                                                                 14960000
141800         EXEC SQL                                                 14970000
141900         DECLARE PACK-LINE-CSR  CURSOR FOR                        14980000
142000             SELECT DISTINCT                                      14990000
142100                     A.PO_LNE_NBR,                                15000000
142200                     A.SKU_SEQ_NBR,                               15010000
142300                     A.VEND_STYL_NAME,                            15030000
142400                     A.UNT_QTY,                                   15040000
142500                     A.UNT_RTL_PR_AMT,                            15050000
142600                     A.ITM_NBR                                    15060000
142700                   , A.GP_RTL_AMT                                 15070000
142800                   , A.GP_QTY                                     15070100
142900                   , A.PREPK_RATO_QTY                             15071000
143000                   , B.ORD_LNE_NBR                                15080000
143100                   , B.PRE_TKT_IND                                15090000
143200                   , B.TKT_FMT_ID                                 15100000
143300                   , B.PKSL_ITM_QTY                               15110000
143400                   , B.DTL_CK_ITM_QTY                             15120000
143500                   , B.CASE_PACK_QTY                              15130000
143600                   , B.PREPK_RATO_QTY                             15140000
143700                   , B.PREPK_DRV_LNE_CDE                          15150000
143800               FROM  TPURITM A                                    15160000
143900                  ,  TRECITM B                                    15170000
144000              WHERE  A.PO_NBR          =  :DK-ORD-NBR             15180000
144100                AND  A.PO_NBR          =  B.ORD_NBR               15190000
144200                AND  A.PO_PREPK_ID     =  :DK-PREPK-ID            15200000
144300                AND  A.PO_PREPK_ID     =  B.PREPK_ID              15210000
144400                AND  A.APP_PO_LNE_NBR  =  B.ORD_LNE_NBR           15220000
144500                AND  A.VER_NBR         =  B.PO_VER_NBR            15230000
144600                AND  B.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR        15240000
144700                AND  B.OPER_UNT_ID     =  :DK-OPER-UNT-ID         15250000
144800                AND  B.FCLTY_ID        =  :DK-FCLTY-ID            15260000
144900                AND  B.VER_STATUS_CDE  =  :PC-A                   15270000
145000                AND  B.PREPK_RATO_QTY  >  :PC-ZERO                15280000
145100         END-EXEC                                                 15290000
145200*                                                                 15300000
145300*  DECLARE FOR ALL THE LINES OF THE RECEIVER PACK ID              15310000
145400*  LOOKING FOR TPURITM VERSION STATUS CODE OF 'A'                 15320000
145500*                                                                 15330000
145600         EXEC SQL                                                 15340000
145700         DECLARE PACK-LINE-CSR2 CURSOR FOR                        15350000
145800             SELECT DISTINCT                                      15360000
145900                     A.PO_LNE_NBR,                                15370000
146000                     A.SKU_SEQ_NBR,                               15380000
146100                     A.VEND_STYL_NAME,                            15400000
146200                     A.UNT_QTY,                                   15410000
146300                     A.UNT_RTL_PR_AMT,                            15420000
146400                     A.ITM_NBR                                    15430000
146500                   , A.GP_RTL_AMT                                 15431000
146600                   , A.GP_QTY                                     15432000
146700                   , A.PREPK_RATO_QTY                             15440000
146800                   , B.ORD_LNE_NBR                                15450000
146900                   , B.PRE_TKT_IND                                15460000
147000                   , B.TKT_FMT_ID                                 15470000
147100                   , B.PKSL_ITM_QTY                               15480000
147200                   , B.DTL_CK_ITM_QTY                             15490000
147300                   , B.CASE_PACK_QTY                              15500000
147400                   , B.PREPK_RATO_QTY                             15510000
147500                   , B.PREPK_DRV_LNE_CDE                          15520000
147600               FROM  TPURITM A                                    15530000
147700                  ,  TRECITM B                                    15540000
147800              WHERE  A.PO_NBR          =  :DK-ORD-NBR             15550000
147900                AND  A.PO_NBR          =  B.ORD_NBR               15560000
148000                AND  A.PO_PREPK_ID     =  :DK-PREPK-ID            15570000
148100                AND  A.PO_PREPK_ID     =  B.PREPK_ID              15580000
148200                AND  A.APP_PO_LNE_NBR  =  B.ORD_LNE_NBR           15590000
148300                AND  A.VER_STATUS_CDE  =  :PC-A                   15600000
148400                AND  B.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR        15610000
148500                AND  B.OPER_UNT_ID     =  :DK-OPER-UNT-ID         15620000
148600                AND  B.FCLTY_ID        =  :DK-FCLTY-ID            15630000
148700                AND  B.VER_STATUS_CDE  =  :PC-A                   15640000
148800                AND  B.PREPK_RATO_QTY  >  :PC-ZERO                15650000
148900         END-EXEC                                                 15660000
149000*                                                                 15670000
149100*  SQL DB2 STORE TABLE CURSOR DECLARATION                         15680000
149200*                                                                 15690000
149300                                                                  15700000
149400     EXEC SQL                                                     15851000
149500         DECLARE STR-NBR-CSR  CURSOR FOR                          15852000
149600             SELECT A.LOC_NBR                                     15853000
149700                  , A.LOC_5_ABBR_NM                               15854000
149800                  , A.CLO_DTE                                     15855000
149900                  , A.CLO_DTE -                                   15856000
150000                            COALESCE(A.STP_ORD_DAYS_QTY,0) DAYS   15857000
150100                            AS EFF_STOP_DATE                      15858000
150200                  , B.EFF_BEG_DTE                                 15859000
150300                  , B.DC_NBR                                      15859100
150400               FROM XLT_LOC A                                     15859200
150500                  , XLT_DC_LOC_ASGMT B                            15859300
150600              WHERE A.LOC_TYP_CDE IN ('DS', 'DC', 'CS', 'RV')     15859400
150700                AND B.LOC_NBR     = A.LOC_NBR                     15859500
150800                AND B.EFF_BEG_DTE =                               15859600
150900                (SELECT MAX(C.EFF_BEG_DTE)                        15859700
151000                   FROM XLT_DC_LOC_ASGMT C                        15859800
151100                  WHERE C.LOC_NBR = A.LOC_NBR                     15859900
151200                    AND DATE(EFF_BEG_DTE) <= CURRENT DATE         15860000
151300                )                                                 15860100
151400           ORDER BY A.LOC_NBR                                     15860200
151500     END-EXEC.                                                    15860300
151600                                                                  15860400
151700                                                                  15861000
151800*                                                                 15870000
151900*  SQL DB2 RECEIPT ITEM DISTRIBUTION CURSOR DECLARATION           15880000
152000*                                                                 15890000
152100     EXEC SQL                                                     15900000
152200          DECLARE RECDIS-CSR CURSOR FOR                           15910000
152300              SELECT  'A',                                        15920000
152400                      A.STR_NBR,                                  15930000
152500                      A.EXPTED_ITM_QTY                            15940000
152600                FROM  TRECDIS A                                   15950000
152700                    , XLT_LOC B                                   15960000
152800               WHERE  (A.ORD_NBR           =  :DK-ORD-NBR         15970000
152900                 AND   A.ORD_LNE_NBR       =  :DK-ORD-LNE-NBR     15980000
153000                 AND   A.REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR    15990000
153100                 AND   A.OPER_UNT_ID       =  :DK-OPER-UNT-ID     16000000
153200                 AND   A.FCLTY_ID          =  :DK-FCLTY-ID        16010000
153400                 AND   A.STR_NBR           =  B.LOC_NBR           16030000
153500                 AND   B.LOC_TYP_CDE     IN (:PC-DS, :PC-CS))     16040000
153600      UNION                                                       16050000
153700              SELECT  'B',                                        16060000
153800                      A.STR_NBR,                                  16070000
153900                      A.EXPTED_ITM_QTY                            16080000
154000                FROM  TRECDIS A                                   16090000
154100                    , XLT_LOC B                                   16100000
154200               WHERE  (A.ORD_NBR           =  :DK-ORD-NBR         16110000
154300                 AND   A.ORD_LNE_NBR       =  :DK-ORD-LNE-NBR     16120000
154400                 AND   A.REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR    16130000
154500                 AND   A.OPER_UNT_ID       =  :DK-OPER-UNT-ID     16140000
154600                 AND   A.FCLTY_ID          =  :DK-FCLTY-ID        16150000
154800                 AND   A.STR_NBR           =  B.LOC_NBR           16170000
154900                 AND   A.EXPTED_ITM_QTY    >  :PC-ZERO            16180000
155000                 AND   B.LOC_TYP_CDE     IN (:PC-DC, :PC-RV))     16190000
155100            ORDER BY  1, 2                                        16200000
155200     END-EXEC.                                                    16210000
155300                                                                  16220000
155400*                                                                 16230000
155500*  SQL DB2 TROUBLE RECORD CURSOR DECLARATION                      16240000
155600*                                                                 16250000
155700     EXEC SQL                                                     16260000
155800          DECLARE TRBL-CSR1 CURSOR FOR                            16270000
155900              SELECT  B.TRBL_LONG_DESC                            16280000
156000                FROM  TTRBNTF A                                   16290000
156100                    , TTRBRSN B                                   16300000
156200               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           16310000
156300                 AND ((A.PO_LNE_NBR      =  :DK-ORD-LNE-NBR       16320000
156400                       AND   B.TRBL_LVL_IND   <> :PC-M)           16330000
156500                       OR   (A.PREPK_ID       =  :DK-PREPK-ID     16340000
156600                       AND   B.TRBL_LVL_IND   =  :PC-M))          16350000
156700                 AND   A.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR      16360000
156800                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       16370000
156900*                AND   A.FCLTY_ID        =  :DK-FCLTY-ID          16380000
157000                 AND   A.RESOLVED_IND    IN ('N', 'I')            16390000
157100                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE)       16400000
157200     END-EXEC.                                                    16410000
157300                                                                  16420000
157400                                                                  16430000
157500     EXEC SQL                                                     16440000
157600          DECLARE TRBL-CSR2 CURSOR FOR                            16450000
157700              SELECT  B.TRBL_LONG_DESC,                           16460000
157800                      A.RESOLVED_IND                              16470000
157900                FROM  TTRBNTF A                                   16480000
158000                    , TTRBRSN B                                   16490000
158100               WHERE  (A.PO_NBR          =  :DK-ORD-NBR           16500000
158200                 AND ((A.PO_LNE_NBR      =  :DK-ORD-LNE-NBR       16510000
158300                       AND   B.TRBL_LVL_IND   <> :PC-M)           16520000
158400                       OR   (A.PREPK_ID        = :DK-PREPK-ID     16530000
158500                       AND   B.TRBL_LVL_IND    = :PC-M))          16540000
158600                 AND   A.REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR      16550000
158700                 AND   A.OPER_UNT_ID     =  :DK-OPER-UNT-ID       16560000
158800                 AND   A.TRBL_RSN_CDE    =  B.TRBL_RSN_CDE        16570000
158900                 AND   B.NOTIF_IND       =  :PC-T)                16580000
159000     END-EXEC.                                                    16590000
159100*                                                                 16850000
159200******************************************************************17100000
159300*  CURSOR FOR INSTRUCTIONS                                        17110000
159400******************************************************************17120000
159500     EXEC SQL                                                     17130000
159600         DECLARE INST-CSR CURSOR FOR                              17140000
159700         SELECT B.INSTR_DESC                                      17150000
159800         FROM   TPOINST A,                                        17160000
159900                TINSTCD B                                         17170000
160000           WHERE A.PO_NBR    = :DK-ORD-NBR                        17180000
160100             AND A.RECIP_CDE = :PC-DC                             17190000
160200             AND B.INSTR_NBR = A.INSTR_NBR                        17200000
160300     END-EXEC.                                                    17210000
160400                                                                  17220000
160500     COPY DPWS277.                                                17230000
160600 01  PV-SAVE-OTR-AREA.                                            17240000
160700     05  PV-SAVE-OTR-TABLE OCCURS 3 TIMES                         17250000
160800             INDEXED BY PV-SAVE-OTR-IDX.                          17260000
160900         10 PV-OTR-DIST          PIC 9(4).                        17270000
161000         10 PV-SAVE-OTR          PIC X(32000).                    17280000
161100*        10 PV-SAVE-OTR          PIC X(23000).                    17281000
161200* THIS TABLE HOLDS THE OTR TABLES FOR UP TO 3 D.C.'S.             17290000
161300/                                                                 17300000
161400******************************************************************17310000
161500 LINKAGE SECTION.                                                 17320000
161600******************************************************************17330000
161700 01  DFHCOMMAREA.                                                 17340000
161800     05  FILLER                       OCCURS 1 TO 600 TIMES       17350000
161900                                      DEPENDING ON EIBCALEN.      17360000
162000         10  FILLER                   PIC X.                      17370000
162100                                                                  17380000
162200 PROCEDURE DIVISION.                                              17390000
162300                                                                  17400000
162400     PERFORM 1000-INITIALIZE.                                     17410000
162500                                                                  17420000
162600     PERFORM 2000-PROCESS-QUEUE-REC                               17430000
162700              UNTIL PS-EOF-QUEUE.                                 17440000
162800                                                                  17450000
162900     IF CA-LINE-NBR (1) NOT = 0                                   17460000
163000         PERFORM 7900-START-TRANID-E014                           17470000
163100     END-IF.                                                      17480000
163200                                                                  17490000
163300 0000-GOBACK.                                                     17500000
163400                                                                  17510000
163500     GOBACK.                                                      17520000
163600 EJECT                                                            17530000
163700 1000-INITIALIZE.                                                 17540000
163800* SETUP KEY FIELDS                                                17550000
163900     INITIALIZE CA-PCKCS014-COMMAREA.                             17560000
164000     MOVE DFHCOMMAREA           TO CA-COMMAREA.                   17570000
164100     MOVE CA-ORD-NBR            TO DK-ORD-NBR.                    17580000
164200     MOVE CA-RCVR-SEQ-NBR       TO DK-RCVR-SEQ-NBR.               17590000
164300     MOVE CA-OPER-UNT-ID        TO DK-OPER-UNT-ID.                17600000
164400     MOVE CA-FCLTY-ID           TO DK-FCLTY-ID.                   17610000
164500     MOVE CA-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN.         17620000
164600                                                                  17630000
164700                                                                  17640000
164800*  THIS RESTORES THE DRIB WORK AREAS THAT WERE INITIALIZED        17650000
164900*  IN PCKCS013                                                    17660000
165000     MOVE CA-DRIB-AREA(1:264)   TO DRS01-COMMAREA.                17670000
165100     MOVE CA-DRIB-AREA(265:216) TO DRS02-DRIB.                    17680000
165200                                                                  17690000
165300                                                                  17700000
165400* SETUP DATE AND TIME FOR REPORT HEADERS                          17710000
165500     EXEC CICS                                                    17720000
165600         ASKTIME ABSTIME (ST-ABSTIME)                             17730000
165700     END-EXEC.                                                    17740000
165800     EXEC CICS                                                    17750000
165900         FORMATTIME ABSTIME  (ST-ABSTIME)                         17760000
166000                    MMDDYY   (SD-MMDDYY-FORMAT)                   17770000
166100                    DATESEP                                       17780000
166200                    TIME     (ST-HHMMSS-FORMAT)                   17790000
166300                    TIMESEP                                       17800000
166400     END-EXEC.                                                    17810000
166500     EXEC CICS                                                    17820000
166600         FORMATTIME ABSTIME  (ST-ABSTIME)                         17830000
166700                       YEAR  (SD-YYYY-FORMAT)                     17840000
166800     END-EXEC.                                                    17850000
166900     MOVE SD-YYYY-FORMAT  TO  PV-CURRENT-CENTURY-YEAR.            17860000
167000     MOVE SD-SYSTEM-MONTH TO  PV-CURRENT-MONTH.                   17870000
167100     MOVE SD-SYSTEM-DAY   TO  PV-CURRENT-DAY.                     17880000
167200                                                                  17890000
167300     SET ST-STR-IDX                                               17900000
167400         LINE-IDX                                                 17910000
167500         EA-ALLOC-IDX                                             17920000
167600         RA-ALLOC-IDX TO 1.                                       17930000
167700     INITIALIZE EA-EXPTED-ALLOC-TABLE                             17940000
167800                RA-RTV-ALLOC-TABLE.                               17950000
167900                                                                  17960000
168000* GET THE FIRST TS QUEUE RECORD FOR PROCESSING                    17970000
168100     MOVE +1                  TO PV-ITEM-NBR.                     17980000
168200     PERFORM 9100-READ-SEL-QUEUE                                  17990000
168300     IF PS-EOF-QUEUE                                              18000000
168400         NEXT SENTENCE                                            18010000
168500     ELSE                                                         18020000
168600         SET PC016-IDX        TO 1                                18030000
168700     END-IF.                                                      18040000
168800                                                                  18050000
168900* LOAD KEY FIELDS FROM THE QUEUE RECORD FIRST OCCURRENCE          18060000
169000     EVALUATE TRUE                                                18070000
169100     WHEN PS-EOF-QUEUE                                            18080000
169200         CONTINUE                                                 18090000
169300     WHEN PC016-ITEM (PC016-IDX) > ZERO                           18100000
169400         MOVE PC016-PO-NBR-N (PC016-IDX)                          18110000
169500                                 TO DK-ORD-NBR                    18120000
169600                                    CA-ORD-NBR                    18130000
169700        MOVE PC016-REC-SEQ-NBR-N (PC016-IDX)                      18140000
169800                                 TO DK-RCVR-SEQ-NBR               18150000
169900                                    CA-RCVR-SEQ-NBR               18160000
170000        MOVE PC016-PACK-ID (PC016-IDX)                            18170000
170100                                 TO DK-PREPK-ID                   18180000
170200                                    HL7-PACK-ID                   18190000
170300        MOVE PC016-WO-NBR-N(PC016-IDX) TO  DK-WORK-ORD-SEQ-NBR    18200000
170400                                           CA-WORK-ORD-SEQ-NBR    18210000
170500        MOVE PC016-OPER-UNT-ID (PC016-IDX)                        18220000
170600                                 TO DK-OPER-UNT-ID                18230000
170700                                    CA-OPER-UNT-ID                18240000
170800        MOVE PC016-FCLTY-ID (PC016-IDX)                           18250000
170900                                 TO DK-FCLTY-ID                   18260000
171000                                    CA-FCLTY-ID                   18270000
171100     WHEN PC016-ITEM (PC016-IDX) NOT > ZERO                       18280000
171200        SET PS-EOF-QUEUE         TO TRUE                          18290000
171300     END-EVALUATE.                                                18300000
171400/                                                                 18310000
171500                                                                  18320000
171600*  BUILD TABLE OF STORES                                          18330000
171700     PERFORM 7000-OPEN-STR-NBR-CSR.                               18340000
171800     PERFORM 7010-FETCH-STR-NBR-CSR.                              18350000
171900                                                                  18360000
172000     PERFORM 1200-LOAD-STR-NBR-TBL                                18370000
172100         VARYING ST-STR-IDX FROM 1 BY 1                           18380000
172200         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         18390000
172300         OR ST-STR-IDX > PC-MAX-STR-TBL-OCCURANCES.               18400000
172400     IF ST-STR-IDX > PC-MAX-STR-TBL-OCCURANCES                    18410000
172500         PERFORM 7020-CLOSE-STR-NBR-CSR                           18420000
172600         MOVE '1200-LOAD-STR-NBR-TBL'                             18430000
172700             TO DP013-PARAGRAPH                                   18440000
172800         MOVE 'STR TBL OVERFLOW.  MAX OCCURANCES IS: '            18450000
172900             TO DP013-MESSAGE-TEXT (1)                            18460000
173000         MOVE PC-MAX-STR-TBL-OCCURANCES                           18470000
173100             TO DP013-MESSAGE-TEXT (2)                            18480000
173200         SET DP013-LOGIC-ABEND TO TRUE                            18490000
173300         SET DP013-NO-ROLLBACK TO TRUE                            18500000
173400         PERFORM 9999-WRITE-CICS-LOG-MSG                          18510000
173500         GO TO 0000-GOBACK                                        18520000
173600     END-IF.                                                      18530000
173700     PERFORM 7020-CLOSE-STR-NBR-CSR.                              18540000
173800                                                                  18550000
173900                                                                  18560000
174000**************************************************************    18570000
174100* GET REPORT HEADER INFORMATION                                   18580000
174200**************************************************************    18590000
174300                                                                  18600000
174400                                                                  18610000
174500     PERFORM 7100-SELECT-PO-HDR-DATA.                             18620000
174600     MOVE CA-ORD-NBR-X           TO  HL2-PO-NBR.                  18630000
174700     MOVE PURCHS-DEPT-NBR        TO  DL1-DEPT-NBR.                18640000
174800     MOVE PURCHS-SEASET-SHRT-NM  TO  HL2-SET                      18650000
174900                                                                  18660000
175000     PERFORM 7110-GET-TRECEIV-DATA.                               18670000
175100     MOVE RECEIV-RCVR-NBR        TO  TL1-KEYREC.                  18680000
175200     MOVE RECEIV-EXPTED-CART-CNT TO  HL5-EXPECTED-CARTONS.        18690000
175300     MOVE RECEIV-GOH-IND         TO  HL3-GOH.                     18700000
175400     MOVE SPACES                 TO  HL8-PACK-TYPE-DESC           18710000
175500     EVALUATE TRUE                                                18720000
175600         WHEN RECEIV-PKGNG-CDE = PC-M                             18730000
175700             MOVE PC-MULTIPLE-SKU-PPK                             18740000
175800                                 TO  HL8-PACK-TYPE-DESC           18750000
175900         WHEN RECEIV-PKGNG-CDE = PC-S                             18760000
176000             MOVE PC-SINGLE-SKU-PPK                               18770000
176100                                 TO  HL8-PACK-TYPE-DESC           18780000
176200         WHEN RECEIV-PKGNG-CDE = PC-I                             18790000
176300             MOVE PC-INNER-PPK                                    18800000
176400                                 TO  HL8-PACK-TYPE-DESC           18810000
176500         WHEN RECEIV-PKGNG-CDE = PC-B                             18820000
176600             MOVE PC-BULK-PPK    TO  HL8-PACK-TYPE-DESC           18830000
176700         WHEN RECEIV-PKGNG-CDE = PC-C                             18840000
176800             MOVE PC-CASEPACK    TO  HL8-PACK-TYPE-DESC           18850000
176900     END-EVALUATE.                                                18860000
177000                                                                  18870000
177100     PERFORM 7120-GET-PRIMARY-VNDR-NME.                           18880000
177200     MOVE ENTNME-ENT-NAME-DESC   TO  HL2-VNDR-NME.                18890000
177300     MOVE CA-DESTINATION         TO  HL9-PRINTER-DEST.            18900000
177400                                                                  18910000
177500*  THIS PARAGRAPH SETS A SWITCH FOR USE IN THE DETAIL LINES       18920000
177600                                                                  18940000
177700     PERFORM 7160-OPEN-INST-CSR.                                  18950000
177800     PERFORM 7170-1ST-DC-SPCL-INSTR.                              18960000
177900     PERFORM 7180-CLOSE-INST-CSR.                                 18970000
178000     IF PS-NO-SPECIAL-INSTRS-FOUND                                18980000
178100         CONTINUE                                                 18990000
178200     ELSE                                                         19000000
178300         MOVE INSTCD-INSTR-DESC(1:50)   TO  HL7-SPECIAL-INSTR     19010000
178400         MOVE INSTCD-INSTR-DESC(51:72)  TO  HL8-SPECIAL-INSTR     19020000
178500         MOVE INSTCD-INSTR-DESC(123:28) TO  HL9-SPECIAL-INSTR     19030000
178600     END-IF.                                                      19040000
178700                                                                  19050000
178800     PERFORM 4050-SELECT-PRIM-SHIP                                19060000
178900                                                                  19070000
179000     MOVE CA-RCVR-SEQ-NBR-X    TO  HL2-RCVR-SEQ-NBR               19080000
179100*    MOVE CA-ORD-LNE-NBR-X     TO  DL-LINE-NBR                    19090000
179200                                                                  19100000
179300     INITIALIZE EA-EXPTED-ALLOC-TABLE                             19110000
179400                RA-RTV-ALLOC-TABLE                                19120000
179500     MOVE ZERO  TO  PV-TOT-EXPTED-ITM-CNT                         19130000
179600                    PV-STORES-GIVEN-PIECES                        19140000
179700                    PV-TOT-RTV-EXPTED-ITM-CNT                     19150000
179800                    PV-STR-CNT                                    19160000
179900                    PV-RTV-STORES                                 19170000
180000     SET EA-ALLOC-IDX                                             19180000
180100         RA-ALLOC-IDX         TO 1.                               19190000
180200                                                                  19200000
180300 1200-LOAD-STR-NBR-TBL.                                           19210000
180400                                                                  19220000
180500     MOVE XLT00010-LOC-NBR       TO ST-STR-NBR (ST-STR-IDX)       19230000
180600     MOVE XLT00010-LOC-5-ABBR-NM TO ST-CHAR5-ABBR-NAME            19250000
180700                                   (ST-STR-IDX)                   19260000
180800                                                                  19270000
180900     MOVE XLT00014-DC-NBR        TO ST-DC-NMBR (ST-STR-IDX)       19280000
181000     MOVE XLT00014-EFF-BEG-DTE   TO ST-DC-RCT-START-DATE          19300000
181100                                   (ST-STR-IDX)                   19310000
181200     MOVE PV-EFF-CLOSE-DATE      TO ST-DC-RCT-STOP-DATE           19330000
181300                                   (ST-STR-IDX)                   19340000
181400                                                                  19410000
181500     ADD +1                      TO PV-TABLE-STORE-COUNT          19420000
181600                                                                  19430000
181700     PERFORM 7010-FETCH-STR-NBR-CSR.                              19440000
181800     EJECT                                                        19450000
181900 2000-PROCESS-QUEUE-REC.                                          19460000
182000     INITIALIZE PS-PACK-LINES-SW                                  19470000
182100                RC806-PRODUCT-PACK-VALIDATION                     19480000
182200                PV-COUNT                                          19490000
182300                PV-DRIVER-LINE-RATIO                              19500000
182400                PV-TOT-ODD-UNITS                                  19510000
182500                PV-TOT-BEST-CAST-UNITS                            19520000
182600                LD-LINE-DETAIL-TBL                                19530000
182700                PS-ODD-UNITS-SW                                   19540000
182800                DP020-MSG-SEVERITY-IND                            19550000
182900                PV-EXPTED-PACK-CNT-SUM-TOT                        19560000
183000     SET RC806-VALIDATE-AND-CALC                                  19570000
183100         PS-PACK-LINE-CSR                                         19580000
183200         PS-NO-RTV-DISTRO                                         19590000
183300         PS-NO-RTV-PRINT                                          19600000
183400         PS-DONT-PRINT-NO-DISTRO-MSG                              19610000
183500         PS-DONT-PRINT-STORE-PROBLEM                              19620000
183600         PS-DONT-SHORTEN-LAST-PAGE                                19630000
183700         PS-NO-UPDATES-DONE      TO TRUE.                         19640000
183800     PERFORM 7300-GET-TPOPRPK-INFO.                               19650000
183900     MOVE ZERO                   TO PACK-LINE-SUB                 19660000
184000     PERFORM 7202-OPEN-PACK-LINE-CSR                              19670000
184100     PERFORM 2100-PROCESS-ITEM                                    19680000
184200         UNTIL PS-END-OF-PACK-ITEMS                               19690000
184300     PERFORM 7204-CLOSE-PACK-LINE-CSR                             19700000
184400     IF PACK-LINE-SUB = ZERO                                      19710000
184500       AND (DK-PREPK-ID NOT = 99)                                 19720000
184600         STRING '  PCKCS708 TPURCHS/TRECEIV VERSION UNEQUAL'      19730000
184700             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              19740000
184800         PERFORM 9998-WRITE-CSSL                                  19750000
184900         STRING '  ORDER NBR, RCVR NBR, LNE NBR, OPER UNT, '      19760000
185000                'FCLTY, PREPK ID'                                 19770000
185100             DELIMITED BY SIZE INTO PV-CICS-MSG-AREA              19780000
185200         PERFORM 9998-WRITE-CSSL                                  19790000
185300         MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR                 19800000
185400         MOVE DK-RCVR-SEQ-NBR                                     19810000
185500                            TO PV-DISPLAY-RCVR-SEQ-NBR            19820000
185600         MOVE DK-OPER-UNT-ID                                      19830000
185700                            TO PV-DISPLAY-OPER-UNT-ID             19840000
185800         MOVE DK-FCLTY-ID   TO PV-DISPLAY-FCLTY-ID                19850000
185900         MOVE DK-PREPK-ID   TO PV-DISPLAY-PREPK-ID                19860000
186000         MOVE PV-DISPLAY-KEYS TO PV-CICS-MSG-AREA                 19870000
186100         PERFORM 9998-WRITE-CSSL                                  19880000
186200         SET PS-PACK-LINE-CSR2   TO TRUE                          19890000
186300         INITIALIZE PS-PACK-LINES-SW                              19900000
186400         PERFORM 7192-OPEN-PACK-LINE-CSR2                         19910000
186500         PERFORM 2100-PROCESS-ITEM                                19920000
186600             UNTIL PS-END-OF-PACK-ITEMS                           19930000
186700         PERFORM 7194-CLOSE-PACK-LINE-CSR2                        19940000
186800     END-IF.                                                      19950000
186900                                                                  19960000
187000     IF PACK-LINE-SUB > ZERO                                      19970000
187100       AND DP020-MSG-SEVERITY-IND = SPACES                        19980000
187200         PERFORM 2002-PROCESS-PACK                                19990000
187300     ELSE                                                         20000000
187400         MOVE PC-PUT                     TO  DRS01-DRRB-FUNC      20010000
187500         MOVE PC-TOP-OF-PAGE             TO  DRS01-COMM-CTL       20020000
187600         IF DK-PREPK-ID = 99                                      20030000
187700             MOVE TL1-TROUBLE-LINE-1     TO  DRS01-COMM-DATA      20040000
187800             PERFORM 8000-LINK-TO-DRS                             20050000
187900             MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL       20060000
188000         END-IF                                                   20070000
188100         MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH        20080000
188200         MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY          20090000
188300         MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR         20100000
188400         MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR         20110000
188500         MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE       20120000
188600         MOVE PC-ONE                     TO  HL1-PGE-NBR          20130000
188700                                             HL1-OF-PGE-NBR       20140000
188800         MOVE PC-APRON-RPT-HDR           TO HL1-RPT-HDR           20150000
188900         MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA      20160000
189000         PERFORM 8000-LINK-TO-DRS                                 20170000
189100         MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA      20180000
189200         MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL       20190000
189300         PERFORM 8000-LINK-TO-DRS                                 20200000
189400         MOVE CA-PREPARER-USER-ID        TO  HL9-PREPARER-USER-ID 20210000
189500         MOVE CA-DESTINATION             TO  HL9-PRINTER-DEST     20220000
189600         MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA      20230000
189700         MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL       20240000
189800         PERFORM 8000-LINK-TO-DRS                                 20250000
189900         MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA      20260000
190000         PERFORM 8000-LINK-TO-DRS                                 20270000
190100         MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA      20280000
190200         PERFORM 8000-LINK-TO-DRS                                 20290000
190300         MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA      20300000
190400         PERFORM 8000-LINK-TO-DRS                                 20310000
190500         MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA      20320000
190600         PERFORM 8000-LINK-TO-DRS                                 20330000
190700         MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA      20340000
190800         PERFORM 8000-LINK-TO-DRS                                 20350000
190900         MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA      20360000
191000         PERFORM 8000-LINK-TO-DRS                                 20370000
191100         INITIALIZE DRS01-COMM-DATA                               20380000
191200         EVALUATE TRUE                                            20390000
191300           WHEN DK-PREPK-ID = 99                                  20400000
191400             STRING                                               20410000
191500             'MARKING APRON COULD NOT BE PRINTED BECAUSE '        20420000
191600             'PACK ID IS 99.'                                     20430000
191700             DELIMITED BY SIZE INTO DRS01-COMM-DATA               20440000
191800           WHEN DP020-MSG-SEVERITY-IND NOT = SPACES               20450000
191900             STRING                                               20460000
192000             'MARKING APRON COULD NOT BE PRINTED BECAUSE '        20470000
192100             'P.O. PACK INFORMATION AND RECEIVING PACK '          20480000
192200             'INFORMATION ARE OUT OF SYNC'                        20490000
192300             DELIMITED BY SIZE INTO DRS01-COMM-DATA               20500000
192400           WHEN OTHER                                             20510000
192500             STRING                                               20520000
192600             'MARKING APRON COULD NOT BE PRINTED BECAUSE '        20530000
192700             'THERE ARE NO LINES TO PROCESS.'                     20540000
192800             DELIMITED BY SIZE INTO DRS01-COMM-DATA               20550000
192900         END-EVALUATE                                             20560000
193000         MOVE PC-TRIPLE-SPACE            TO  DRS01-COMM-CTL       20570000
193100         PERFORM 8000-LINK-TO-DRS                                 20580000
193200     END-IF.                                                      20590000
193300                                                                  20600000
193400* GET THE NEXT QUEUE RECORD                                       20610000
193500     PERFORM 9200-GET-NEXT-PO.                                    20620000
193600                                                                  20630000
193700 2002-PROCESS-PACK.                                               20640000
193800     MOVE PACK-LINE-SUB        TO RC806-NBR-OF-LINES              20650000
193900     PERFORM 7800-LINK-RCKCS806                                   20660000
194000     MOVE RC806-INNER-PACK-RATIO-TOT                              20670000
194100                                    TO HL3-UNITS-PER-PACK         20680000
194200     MOVE RC806-NBR-OF-PACKS        TO HL4-INNER-PACKS            20690000
194300     MOVE RC806-UNITS-PER-CARTON    TO HL6-UNITS-PER-CARTON       20700000
194400     MOVE RC806-OUTER-PACK-QTY-TOT  TO TL3-EXPECTED-UNITS-B       20710000
194500                                       TL3-EXPECTED-UNITS-NB      20720000
194600     IF RECEIV-PKGNG-CDE = PC-M                                   20730000
194700         MOVE RC806-BEST-CASE-PACKS TO TL2-TOT-EXPTED-CARTONS     20740000
194800     ELSE                                                         20750000
194900         IF RC806-NBR-OF-PACKS NOT = ZERO                         20760000
195000             DIVIDE RC806-BEST-CASE-PACKS                         20770000
195100                 BY RC806-NBR-OF-PACKS                            20780000
195200                                GIVING TL2-TOT-EXPTED-CARTONS     20790000
195300         ELSE                                                     20800000
195400             MOVE RC806-BEST-CASE-PACKS                           20810000
195500                                    TO TL2-TOT-EXPTED-CARTONS     20820000
195600         END-IF                                                   20830000
195700     END-IF                                                       20840000
195800     MOVE +1                TO PACK-LINE-SUB                      20850000
195900     PERFORM UNTIL PACK-LINE-SUB > RC806-NBR-OF-LINES             20860000
196000         MOVE RC806-BEST-CASE-UNITS (PACK-LINE-SUB)               20870000
196100                            TO LD-BEST-CASE-UNITS (PACK-LINE-SUB) 20880000
196200         ADD  RC806-BEST-CASE-UNITS (PACK-LINE-SUB)               20890000
196300                            TO PV-TOT-BEST-CAST-UNITS             20900000
196400         MOVE RC806-ODD-UNITS (PACK-LINE-SUB)                     20910000
196500                            TO LD-ODD-UNITS (PACK-LINE-SUB)       20920000
196600         ADD  RC806-ODD-UNITS (PACK-LINE-SUB)                     20930000
196700                            TO PV-TOT-ODD-UNITS                   20940000
196800         IF RC806-ODD-UNITS (PACK-LINE-SUB) NOT = ZERO            20950000
196900             SET PS-ODD-UNITS TO TRUE                             20960000
197000         END-IF                                                   20970000
197100         ADD +1               TO PACK-LINE-SUB                    20980000
197200     END-PERFORM.                                                 20990000
197300                                                                  21000000
197400* * *  CALCULATE THE TOTAL PAGES TO PRINT                         21010000
197500     INITIALIZE PS-START-NEW-PAGE-SW                              21020000
197600     MOVE PC-ROWS-PER-PAGE-50 TO PV-LINES-AVAILABLE               21030000
197700     PERFORM 7410-SELECT-MKING-TMST.                              21040000
197800     IF PS-YES-TRECITM AND                                        21050000
197900        RECITM-MKING-APRON-TMST NOT = PC-DB2-DUMMY-DATE-TIME      21060000
198000         SUBTRACT 2 FROM PV-LINES-AVAILABLE                       21070000
198100     END-IF.                                                      21080000
198200     IF PS-PRINT-STORE-PROBLEM                                    21090000
198300         SUBTRACT 2 FROM PV-LINES-AVAILABLE                       21100000
198400     END-IF.                                                      21110000
198500     IF TL2-TRBL-DESC (1) = SPACES                                21120000
198600         CONTINUE                                                 21130000
198700     ELSE                                                         21140000
198800         SUBTRACT 4 FROM PV-LINES-AVAILABLE                       21150000
198900     END-IF.                                                      21160000
199000     IF PV-COUNT > 0                                              21170000
199100         SUBTRACT 2 FROM PV-LINES-AVAILABLE                       21180000
199200     END-IF.                                                      21190000
199300* * * HOW MANY PAGES/LINES DO THE THE LINE ITEMS TAKE UP          21200000
199400     IF RC806-NBR-OF-LINES > PV-LINES-AVAILABLE                   21210000
199500         DIVIDE RC806-NBR-OF-LINES BY PV-LINES-AVAILABLE          21220000
199600             GIVING PV-TOTAL-PAGES                                21230000
199700             REMAINDER PV-LINES-USED                              21240000
199800         IF PV-LINES-USED = ZERO                                  21250000
199900             SET PS-START-NEW-PAGE  TO TRUE                       21260000
200000         ELSE                                                     21270000
200100* * *  STORE LINES HEADER TAKES 3 LINES                           21280000
200200             ADD +3                 TO PV-LINES-USED              21290000
200300         END-IF                                                   21300000
200400     ELSE                                                         21310000
200500         MOVE PC-ONE                 TO PV-TOTAL-PAGES            21320000
200600         MOVE RC806-NBR-OF-LINES     TO PV-LINES-USED             21330000
200700         ADD +3                      TO PV-LINES-USED             21340000
200800     END-IF.                                                      21350000
200900     IF PS-PRINT-NO-DISTRO-MSG                                    21360000
201000         ADD +2                      TO PV-LINES-USED             21370000
201100     END-IF                                                       21380000
201200* * * CAN ALL THE STORE LINES FIT ON CURRENT PAGE?                21390000
201300     MOVE PV-LINES-USED              TO PV-SAVE-LINES-USED        21400000
201400* * * ACCOUNT FOR TOTAL LINES (3), SIGN-OFF LINES (6),            21410000
201500* * * BARCODE (6 OR 7), AND RTV DISTRO (3).                       21420000
201600     ADD +9                          TO PV-LINES-USED             21430000
201700     IF CA-OPER-UNT-ID = 85                                       21440000
201800       IF CA-PRTR-PRTR-BRCDE-IND = 'Y'                            21450000
201900         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           21460000
202000             ADD +7                  TO PV-LINES-USED             21470000
202100         ELSE                                                     21480000
202200             ADD +6                  TO PV-LINES-USED             21490000
202300         END-IF                                                   21500000
202400       END-IF                                                     21510000
202500     END-IF.                                                      21520000
202600     IF PS-RTV-DISTRO                                             21530000
202700         ADD +4                      TO PV-LINES-USED             21540000
202800     END-IF.                                                      21550000
202900     MOVE PC-ONE                     TO PV-COLS-PER-PAGE          21560000
203000     PERFORM WITH TEST AFTER                                      21570000
203100             UNTIL PV-COLS-PER-PAGE > +4                          21580000
203200                OR (PV-LINES-USED + PV-STR-LINES-REQD NOT >       21590000
203300                    PV-LINES-AVAILABLE)                           21600000
203400* * * STORES WILL TAKE UP PV-STR-LINES-REQD LINES                 21610000
203500         DIVIDE PV-STR-CNT BY PV-COLS-PER-PAGE                    21620000
203600                     GIVING PV-STR-LINES-REQD                     21630000
203700                     REMAINDER PV-REMAINDER                       21640000
203800         IF PV-REMAINDER > ZERO                                   21650000
203900              ADD +1                TO PV-STR-LINES-REQD          21660000
204000         END-IF                                                   21670000
204100*        IF PS-PRINT-NO-DISTRO-MSG                                21680000
204200*            ADD +2                  TO PV-STR-LINES-REQD         21690000
204300*        END-IF                                                   21700000
204400         ADD PC-ONE                  TO PV-COLS-PER-PAGE          21710000
204500     END-PERFORM                                                  21720000
204600     SUBTRACT PC-ONE               FROM PV-COLS-PER-PAGE          21730000
204700     ADD PV-STR-LINES-REQD           TO PV-LINES-USED             21740000
204800     IF PV-LINES-USED NOT > PV-LINES-AVAILABLE                    21750000
204900         MOVE PV-STR-LINES-REQD      TO PV-ROWS-PER-PAGE          21760000
205000         MOVE PV-TOTAL-PAGES         TO PV-PAGES-REQ              21770000
205100     ELSE                                                         21780000
205200         MOVE PV-SAVE-LINES-USED                                  21790000
205300                                     TO PV-LINES-USED             21800000
205400         PERFORM 2010-CALC-TOTAL-PAGES                            21810000
205500     END-IF                                                       21820000
205600                                                                  21830000
205700     MOVE PC-ONE              TO PV-LINES-USED                    21840000
205800     SET PS-PRINT-ITEM-DETAIL TO TRUE                             21850000
205900     SET PS-NOT-END-OF-DETAIL TO TRUE                             21860000
206000     MOVE PC-APRON-RPT-HDR    TO HL1-RPT-HDR                      21870000
206100     INITIALIZE PS-PRINT-STORE-WORKAREA-SW                        21880000
206200                PV-ENDING-IDX-LOCATION                            21890000
206300                PV-LAST-STR-ON-PAGE                               21900000
206400     PERFORM 4000-PRODUCE-RPT                                     21910000
206500         VARYING PS-PAGE-SUB                                      21920000
206600         FROM 1 BY 1                                              21930000
206700         UNTIL PS-PAGE-SUB > PV-PAGES-REQ                         21940000
206800     IF PS-RTV-DISTRO AND                                         21950000
206900        PS-NO-RTV-PRINT                                           21960000
207000         SET PS-END-OF-DETAIL TO TRUE                             21970000
207100         PERFORM 4000-PRODUCE-RPT                                 21980000
207200         ADD PC-ONE TO PS-PAGE-SUB                                21990000
207300     END-IF                                                       22000000
207400*    IF PS-ODD-UNITS                                              22010000
207500         PERFORM 3000-ODD-UNITS-WORKSHEET                         22020000
207600*    END-IF                                                       22030000
207700     IF RECITM-MKING-APRON-TMST = PC-DB2-DUMMY-DATE-TIME          22040000
207800       AND TL2-TRBL-DESC (1) = SPACES                             22050000
207900         PERFORM 7420-UPDATE-TRECITM-TMST                         22060000
208000     END-IF                                                       22070000
208100     IF PS-UPDATES-DONE                                           22080000
208200         EXEC CICS                                                22090000
208300             SYNCPOINT                                            22100000
208400         END-EXEC                                                 22110000
208500     END-IF.                                                      22120000
208600     IF PS-RTV-DISTRO                                             22130000
208700         IF CA-PRINT-MRKG-APRON-HDR                               22140000
208800             CONTINUE                                             22150000
208900         ELSE                                                     22160000
209000             MOVE +1               TO PACK-LINE-SUB               22170000
209100             PERFORM UNTIL PACK-LINE-SUB > RC806-NBR-OF-LINES     22180000
209200                 MOVE RC806-PKSL-LNE-NBR (PACK-LINE-SUB)          22190000
209300                                   TO CA-LINE-NBR (LINE-IDX)      22200000
209400                 SET LINE-IDX UP BY 1                             22210000
209500                 ADD +1            TO PACK-LINE-SUB               22220000
209600             END-PERFORM                                          22230000
209700         END-IF                                                   22240000
209800     END-IF.                                                      22250000
209900                                                                  22260000
210000 2010-CALC-TOTAL-PAGES.                                           22270000
210100* * *  IF STORE DETAIL LINES ARE TO START ON A NEW PAGE           22280000
210200     IF PS-START-NEW-PAGE                                         22290000
210300         MOVE PV-LINES-AVAILABLE     TO PV-ROWS-PER-PAGE          22300000
210400* * *  FIND OUT HOW MANY PAGES AND LINES USED YOU'LL GET          22310000
210500* * *  PV-STR-LINES-REQD IT THE TOTAL PRINT LINES FOR THE STORES. 22320000
210600         DIVIDE PV-STR-LINES-REQD BY PV-LINES-AVAILABLE           22330000
210700             GIVING PV-WRK-QTY                                    22340000
210800             REMAINDER PV-REMAINDER                               22350000
210900         ADD PV-WRK-QTY              TO PV-TOTAL-PAGES            22360000
211000         MOVE PV-REMAINDER           TO PV-LINES-USED             22370000
211100* * *  IF STORE DETAIL LINES MIGHT START ON THE CURRENT PAGE      22380000
211200     ELSE                                                         22390000
211300* * *  HOW MANY LINES WILL THE ROWS OF STORE DETAIL TAKE          22400000
211400* * *  IT IS REQUIRED TO PRINT AT LEAST 100 STORES ON A PAGE.     22410000
211500         IF PV-STR-CNT > +100                                     22420000
211600             MOVE +25                TO PV-ROWS-PER-PAGE          22430000
211700         ELSE                                                     22440000
211800             MOVE PV-STR-LINES-REQD  TO PV-ROWS-PER-PAGE          22450000
211900         END-IF                                                   22460000
212000         ADD PV-ROWS-PER-PAGE PV-LINES-USED GIVING PV-WRK-QTY     22470000
212100         IF PV-WRK-QTY > PV-LINES-AVAILABLE                       22480000
212200             MOVE PV-LINES-AVAILABLE    TO PV-ROWS-PER-PAGE       22490000
212300             SET PS-START-NEW-PAGE      TO TRUE                   22500000
212400             MOVE ZERO                  TO PV-LINES-USED          22510000
212500* * *  FIND OUT HOW MANY PAGES AND LINES USED YOU'LL GET          22520000
212600             DIVIDE PV-STR-LINES-REQD BY PV-LINES-AVAILABLE       22530000
212700                 GIVING PV-WRK-QTY                                22540000
212800                 REMAINDER PV-REMAINDER                           22550000
212900                 ADD PV-WRK-QTY          TO PV-TOTAL-PAGES        22560000
213000             IF PV-REMAINDER > ZERO                               22570000
213100                 ADD PC-ONE              TO PV-TOTAL-PAGES        22580000
213200             END-IF                                               22590000
213300             MOVE PV-REMAINDER           TO PV-LINES-USED         22600000
213400         ELSE                                                     22610000
213500             SUBTRACT PV-LINES-USED FROM PV-LINES-AVAILABLE       22620000
213600                 GIVING PV-ROWS-PER-PAGE                          22630000
213700             MOVE PV-WRK-QTY             TO PV-LINES-USED         22640000
213800* * * IF YOU HAVE MORE THAN 100 STORES, WE KNOW THAT WE CAN START 22650000
213900* * * ON THE CURRENT PAGE, HOW MANY MORE PAGES WILL IT REQUIRE?   22660000
214000             IF PV-STR-CNT > +100                                 22670000
214100                 SUBTRACT PV-ROWS-PER-PAGE FROM PV-STR-LINES-REQD 22680000
214200                     GIVING PV-WRK-QTY                            22690000
214300                 IF PV-WRK-QTY > ZERO                             22700000
214400                     DIVIDE PV-WRK-QTY BY PV-LINES-AVAILABLE      22710000
214500                         GIVING PV-WRK-QTY                        22720000
214600                         REMAINDER PV-REMAINDER                   22730000
214700                     ADD PV-WRK-QTY          TO PV-TOTAL-PAGES    22740000
214800                     IF PV-REMAINDER > ZERO                       22750000
214900                         ADD PC-ONE          TO PV-TOTAL-PAGES    22760000
215000                     END-IF                                       22770000
215100                     MOVE PV-REMAINDER       TO PV-LINES-USED     22780000
215200                 END-IF                                           22790000
215300             END-IF                                               22800000
215400         END-IF                                                   22810000
215500     END-IF.                                                      22820000
215600* * * ACCOUNT FOR TOTAL LINES (3), SIGN-OFF LINES (6),            22830000
215700* * * BARCODE (6 OR 7), AND RTV DISTRO (3).                       22840000
215800     INITIALIZE PV-END-OF-APRON-LINES-REQD                        22850000
215900     ADD +9                          TO PV-LINES-USED             22860000
216000                                        PV-END-OF-APRON-LINES-REQD22870000
216100     IF CA-OPER-UNT-ID = 85                                       22880000
216200       IF CA-PRTR-PRTR-BRCDE-IND = 'Y'                            22890000
216300         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           22900000
216400             ADD +7                  TO PV-LINES-USED             22910000
216500                                        PV-END-OF-APRON-LINES-REQD22920000
216600         ELSE                                                     22930000
216700             ADD +6                  TO PV-LINES-USED             22940000
216800                                        PV-END-OF-APRON-LINES-REQD22950000
216900         END-IF                                                   22960000
217000       END-IF                                                     22970000
217100     END-IF.                                                      22980000
217200     IF PS-RTV-DISTRO                                             22990000
217300         ADD +4                      TO PV-LINES-USED             23000000
217400                                        PV-END-OF-APRON-LINES-REQD23010000
217500         SET PS-SHORTEN-LAST-PAGE    TO TRUE                      23020000
217600     END-IF.                                                      23030000
217700     IF PV-LINES-USED > PV-LINES-AVAILABLE                        23040000
217800         ADD +1                      TO PV-TOTAL-PAGES            23050000
217900     END-IF.                                                      23060000
218000     MOVE PV-TOTAL-PAGES             TO PV-PAGES-REQ.             23070000
218100                                                                  23080000
218200 2100-PROCESS-ITEM.                                               23090000
218300     IF PS-PACK-LINE-CSR                                          23100000
218400         PERFORM 7200-PURITM-RECITM-DATA                          23110000
218500     ELSE                                                         23120000
218600         PERFORM 7190-PURITM-RECITM-DATA                          23130000
218700     END-IF.                                                      23140000
218800                                                                  23150000
218900     IF NOT PS-END-OF-PACK-ITEMS                                  23160000
219000         ADD +1                 TO PACK-LINE-SUB                  23170000
219100         PERFORM 2110-SAVE-LINE-DATA.                             23180000
219200                                                                  23190000
219300 2110-SAVE-LINE-DATA.                                             23200000
219400     MOVE RECITM-ORD-LNE-NBR TO DK-ORD-LNE-NBR                    23210000
219500                                CA-ORD-LNE-NBR                    23220000
219600                                LD-LINE-NBR (PACK-LINE-SUB)       23230000
219700                                RC806-PKSL-LNE-NBR (PACK-LINE-SUB)23240000
219800                                                                  23250000
219900     MOVE PURITM-UNT-QTY         TO RC806-UNIT-QTY (PACK-LINE-SUB)23260000
220000     MOVE PURITM-PREPK-RATO-QTY  TO RC806-PO-RATIO (PACK-LINE-SUB)23270000
220100     MOVE RECITM-PREPK-RATO-QTY  TO RC806-RC-RATIO (PACK-LINE-SUB)23280000
220200     IF RECITM-DTL-CK-ITM-QTY > ZERO                              23290000
220300         MOVE RECITM-DTL-CK-ITM-QTY                               23300000
220400                                 TO RC806-RCVG-QTY (PACK-LINE-SUB)23310000
220500                                   LD-EXPTED-UNITS (PACK-LINE-SUB)23320000
220600     ELSE                                                         23330000
220700         MOVE RECITM-PKSL-ITM-QTY                                 23340000
220800                                 TO RC806-RCVG-QTY (PACK-LINE-SUB)23350000
220900                                   LD-EXPTED-UNITS (PACK-LINE-SUB)23360000
221000     END-IF                                                       23370000
221100                                                                  23380000
221200     MOVE PURITM-UNT-RTL-PR-AMT  TO LD-SKU-RTL (PACK-LINE-SUB)    23410000
221300     MOVE RECITM-PREPK-RATO-QTY  TO LD-RATIO (PACK-LINE-SUB)      23420000
221400                                                                  23430000
221500*THE LOGISTICS  DOMAIN MODULE WILL BE USED TO        WR/IR# 230ZZ 23430100
221600*DISPLAY THE 8 DIGIT SKU                             WR/IR# 230ZZ 23430200
221700     INITIALIZE XL001-ITEM-COMMAREA.                              23430300
221800                                                                  23430400
221900     IF  PS-CALL-API-YES   AND                                    23430500
222000        (PURITM-SKU-SEQ-NBR NOT = PC-000 AND                      23430600
222100         PURITM-SKU-SEQ-NBR NOT = PC-999)                         23430700
222200         PERFORM 7210-CALL-CICS-API-ARCH                          23430800
222300     ELSE                                                         23430900
222400         IF (PURITM-SKU-SEQ-NBR = PC-000)                         23431000
222500             MOVE '00000000' TO XL001-SKU-NBR                     23431100
222600         ELSE                                                     23431200
222700             IF (PURITM-SKU-SEQ-NBR NOT = PC-999)                 23431300
222800                 MOVE '99999999' TO XL001-SKU-NBR                 23431400
222900             END-IF                                               23431500
223000         END-IF                                                   23431600
223100     END-IF                                                       23431700
223200                                                                  23432000
223300     MOVE XL001-SKU-NBR          TO LD-SEQ-NBR (PACK-LINE-SUB)    23433000
223400     MOVE XL001-SUB-CL-NBR-2CH   TO LD-CLASS-NBR (PACK-LINE-SUB)  23433100
223500                                                                  23434000
223600     PERFORM 7150-GET-AD-DATE                                     23440000
223700                                                                  23450000
223800     IF RECITM-PREPK-DRV-LNE-CDE = PC-A                           23460000
223900         MOVE RECITM-PREPK-RATO-QTY                               23470000
224000                                 TO PV-DRIVER-LINE-RATIO          23480000
224100         MOVE RECITM-CASE-PACK-QTY                                23490000
224200                                 TO RC806-INNER-PACK-QTY          23500000
224300         MOVE RECITM-ORD-LNE-NBR TO PV-DRIVER-LINE-NBR            23510000
224400         MOVE RECITM-PRE-TKT-IND TO  HL4-PRETICKET-IND            23520000
224500         MOVE RECITM-TKT-FMT-ID  TO  DK-TKT-FMT-ID                23530000
224600         PERFORM 4300-GET-TKT-DESC                                23540000
224700         PERFORM 4310-GET-TKT-PLACEMENT                           23550000
224800         PERFORM 2200-PO-LINE-TRBL                                23600000
224900         PERFORM 2230-PO-LINE-TRBL                                23610000
225000         INITIALIZE PV-SAVE-OTR-AREA                              23620000
225100         SET PV-SAVE-OTR-IDX     TO 1                             23630000
225200         SEARCH PV-SAVE-OTR-TABLE                                 23640000
225300         WHEN PC016-OPER-UNT-ID (PC016-IDX) = PV-OTR-DIST         23650000
225400                                             (PV-SAVE-OTR-IDX)    23660000
225500             CONTINUE                                             23670000
225600         WHEN PV-OTR-DIST(PV-SAVE-OTR-IDX) = ZERO                 23680000
225700             MOVE PC016-OPER-UNT-ID (PC016-IDX)                   23690000
225800                                 TO PV-OTR-DIST(PV-SAVE-OTR-IDX)  23700000
225900             PERFORM 4200-CALC-OPEN-TO-REC                        23710000
226000             MOVE DP277-STORE-TABLE                               23720000
226100                                 TO PV-SAVE-OTR (PV-SAVE-OTR-IDX) 23730000
226200         END-SEARCH                                               23740000
226300         PERFORM 2500-GET-RECDIS-DATA                             23750000
226400*        IF PS-RTV-DISTRO                                         23760000
226500*            IF CA-PRINT-MRKG-APRON-HDR                           23770000
226600*                CONTINUE                                         23780000
226700*            ELSE                                                 23790000
226800*                MOVE CA-ORD-LNE-NBR-X TO CA-LINE-NBR (LINE-IDX)  23800000
226900*                SET LINE-IDX UP BY 1                             23810000
227000*            END-IF                                               23820000
227100*        END-IF                                                   23830000
227200         PERFORM 4040-COUNT-RTV-DISTROS                           23840000
227300     END-IF.                                                      23850000
227400                                                                  23870000
227500     PERFORM 2320-PRICE-DISCREPANCY.                              23883000
227600     IF XL001-SKU-DESC = SPACES                                   23890600
227700        MOVE 'NO DESC.'           TO LD-SKU-DESC (PACK-LINE-SUB)  23890700
227800     ELSE                                                         23890800
227900        MOVE XL001-SKU-DESC       TO LD-SKU-DESC (PACK-LINE-SUB)  23891000
228000     END-IF                                                       23892000
228100     MOVE XL001-VS-NBR                                            23901000
228200                              TO LD-VNDR-STYLE-NME (PACK-LINE-SUB)23910000
228300     MOVE XL001-STKR-NBR      TO LD-BOX-ID (PACK-LINE-SUB)        23920000
228400     MOVE XL001-NRF-CLOR-CDE  TO LD-NRF-COLOR-CDE (PACK-LINE-SUB) 23930000
228500                                                                  23940000
228600     IF XL001-SKU-SQLCODE = PC-ROW-NOT-FOUND                      23950000
228700         PERFORM 7220-SELECT-TRECITM                              23960000
228800         MOVE RECITM-SIZE-DESC     TO  LD-SIZE (PACK-LINE-SUB)    23970000
228900         MOVE RECITM-COLOR-DESC    TO  LD-COLOR (PACK-LINE-SUB)   23980000
229000         MOVE SPACES         TO LD-NRF-COLOR-DESC (PACK-LINE-SUB) 23990000
229100     ELSE                                                         24000000
229200         MOVE XL001-SIZE-DESC      TO  LD-SIZE (PACK-LINE-SUB)    24021000
229300         MOVE XL001-CSTM-CLOR-DESC TO  LD-COLOR (PACK-LINE-SUB)   24022000
229400         MOVE XL001-SHRT-CLOR-DESC                                24040000
229500                             TO LD-NRF-COLOR-DESC (PACK-LINE-SUB) 24050000
229600     END-IF.                                                      24060000
229700                                                                  24070000
229800 EJECT                                                            24080000
229900******************************************************************24090000
230000*  DETERMINE THE CURRENT LINE LOCATION.                           24100000
230100******************************************************************24110000
230200 2200-PO-LINE-TRBL.                                               24120000
230300     PERFORM 7260-OPEN-TRBL-CSR.                                  24130000
230400     PERFORM 7270-FETCH-TRBL-CSR.                                 24140000
230500     INITIALIZE TL2-TROUBLE-LINE-2.                               24150000
230600     PERFORM 2210-LOAD-TRBL-TBL                                   24160000
230700         VARYING TRBL-IDX FROM 1 BY 1                             24170000
230800         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         24180000
230900         OR TRBL-IDX > 5.                                         24190000
231000     PERFORM 7280-CLOSE-TRBL-CSR.                                 24200000
231100                                                                  24210000
231200******************************************************************24220000
231300*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            24230000
231400******************************************************************24240000
231500 2210-LOAD-TRBL-TBL.                                              24250000
231600     MOVE TRBRSN-TRBL-LONG-DESC TO TL2-TRBL-DESC (TRBL-IDX).      24260000
231700     PERFORM 7270-FETCH-TRBL-CSR.                                 24270000
231800     EJECT                                                        24280000
231900 2230-PO-LINE-TRBL.                                               24290000
232000     PERFORM 7265-OPEN-TRBL-CSR2.                                 24300000
232100     PERFORM 7275-FETCH-TRBL-CSR2.                                24310000
232200     INITIALIZE TL3-TROUBLE-LINE-3.                               24320000
232300     PERFORM 2240-LOAD-TRBL-TBL2                                  24330000
232400         VARYING TRBL-IDX2 FROM 1 BY 1                            24340000
232500         UNTIL SQLCODE = PC-ROW-NOT-FOUND                         24350000
232600         OR TRBL-IDX2 > 5.                                        24360000
232700     PERFORM 7285-CLOSE-TRBL-CSR2.                                24370000
232800                                                                  24380000
232900******************************************************************24390000
233000*  LOAD THE TROUBLE DESCRIPTION INTO THE TROUBLE LINE.            24400000
233100******************************************************************24410000
233200 2240-LOAD-TRBL-TBL2.                                             24420000
233300     MOVE TRBRSN-TRBL-LONG-DESC TO TL3-TRBL-DESC (TRBL-IDX2).     24430000
233400     MOVE PC-DASH               TO TL3-DASH (TRBL-IDX2).          24440000
233500     IF TRBNTF-RESOLVED-IND = (PC-N OR PC-I)                      24450000
233600         MOVE PC-U              TO TL3-TRBL-IND (TRBL-IDX2)       24460000
233700     ELSE                                                         24470000
233800         MOVE PC-R              TO TL3-TRBL-IND (TRBL-IDX2)       24480000
233900     END-IF.                                                      24490000
234000     PERFORM 7275-FETCH-TRBL-CSR2.                                24500000
234100     EJECT                                                        24510000
234200                                                                  25060100
234300******************************************************************25060200
234400 2320-PRICE-DISCREPANCY.                                          25060300
234500                                                                  25060500
234600     SET PS-NO-DISCREPANCY       TO TRUE.                         25060600
234700                                                                  25060700
234800     IF PURITM-UNT-RTL-PR-AMT NOT = XL001-UNT-RTL-AMT             25061000
234900         SET PS-DISCREPANCY      TO TRUE                          25061100
235000     END-IF.                                                      25061200
235100                                                                  25061300
235200     IF PURITM-GP-QTY > +1                                        25061400
235300         IF PURITM-GP-QTY NOT = XL001-GP-QTY                      25061600
235400             SET PS-DISCREPANCY  TO TRUE                          25061700
235500         END-IF                                                   25061800
235600                                                                  25061900
235700         IF PURITM-GP-RTL-AMT NOT = XL001-GP-AMT                  25062100
235800             SET PS-DISCREPANCY  TO TRUE                          25062200
235900         END-IF                                                   25062300
236000     END-IF.                                                      25062400
236100     IF PS-DISCREPANCY                                            25063000
236200         MOVE PC-Y               TO                               25063100
236300                               LD-RTL-DSCREP-FLG (PACK-LINE-SUB)  25063200
236400     ELSE                                                         25063300
236500         MOVE PC-N               TO                               25063400
236600                               LD-RTL-DSCREP-FLG (PACK-LINE-SUB)  25063500
236700     END-IF.                                                      25063600
236800                                                                  25070000
236900******************************************************************25080000
237000*  THIS MODULE RETRIEVES DATA FROM THE RECEIPT ITEM DISTRIBUTION  25090000
237100*  TABLE.  THE RECEIPT ITEM DISTRIBUTION TABLE IS ACCESSED WHEN   25100000
237200*  THE WORK ORDER DISTRIBUTION INDICATOR IS EQUAL TO A 'N'.       25110000
237300******************************************************************25120000
237400 2500-GET-RECDIS-DATA.                                            25130000
237500     PERFORM 7320-OPEN-RECDIS-CSR.                                25140000
237600     PERFORM 7330-FETCH-RECDIS-CSR.                               25150000
237700     PERFORM 2510-PROCESS-RECDIS-ROWS                             25160000
237800         UNTIL SQLCODE = PC-ROW-NOT-FOUND.                        25170000
237900     PERFORM 7340-CLOSE-RECDIS-CSR.                               25180000
238000*                                                                 25190000
238100 2510-PROCESS-RECDIS-ROWS.                                        25200000
238200     MOVE RECDIS-STR-NBR         TO  PV-STR-NBR.                  25210000
238300     MOVE RECDIS-EXPTED-ITM-QTY  TO  PV-EXPTED-ITM-CNT.           25220000
238400     IF PV-UNION-IND = PC-A                                       25230000
238500         SET EA-STR-OPEN(EA-ALLOC-IDX)                            25240000
238600             PS-SAME-OPER-UNIT-ID      TO TRUE                    25250000
238700     ELSE                                                         25260000
238800         SET RA-STR-OPEN(RA-ALLOC-IDX)                            25270000
238900             PS-SAME-OPER-UNIT-ID      TO TRUE                    25280000
239000     END-IF                                                       25290000
239100                                                                  25300000
239200     SEARCH ALL ST-STORE-ENTRY                                    25310000
239300         AT END                                                   25320000
239400             IF PV-UNION-IND = PC-A                               25330000
239500                 SET EA-STR-CLOSED(EA-ALLOC-IDX)                  25340000
239600                     PS-PRINT-STORE-PROBLEM                       25350000
239700                                     TO TRUE                      25360000
239800             ELSE                                                 25370000
239900                 SET RA-STR-CLOSED(RA-ALLOC-IDX)                  25380000
240000                     PS-PRINT-STORE-PROBLEM                       25390000
240100                                     TO TRUE                      25400000
240200             END-IF                                               25410000
240300         WHEN ST-STR-NBR (ST-STR-IDX) = PV-STR-NBR                25420000
240400             PERFORM 2511-CHECK-IF-OPEN                           25430000
240500             PERFORM 2520-FILL-PRINT-TBL                          25440000
240600     END-SEARCH.                                                  25450000
240700                                                                  25460000
240800     PERFORM 7330-FETCH-RECDIS-CSR.                               25470000
240900 2511-CHECK-IF-OPEN.                                              25480000
241000     EVALUATE TRUE                                                25490000
241100     WHEN ST-DC-NMBR (ST-STR-IDX) = CA-OPER-UNT-ID                25500000
241200         IF  (PV-CURRENT-DATE NOT < ST-DC-RCT-START-DATE          25510000
241300                                  (ST-STR-IDX))                   25520000
241400             AND                                                  25530000
241500             (PV-CURRENT-DATE NOT > ST-DC-RCT-STOP-DATE           25540000
241600                                  (ST-STR-IDX))                   25550000
241700             CONTINUE                                             25560000
241800         ELSE                                                     25570000
241900             IF PV-UNION-IND = PC-A                               25580000
242000                 SET EA-STR-CLOSED(EA-ALLOC-IDX)                  25590000
242100                     PS-PRINT-STORE-PROBLEM                       25600000
242200                                     TO TRUE                      25610000
242300             ELSE                                                 25620000
242400                 SET RA-STR-CLOSED(RA-ALLOC-IDX)                  25630000
242500                     PS-PRINT-STORE-PROBLEM                       25640000
242600                                     TO TRUE                      25650000
242700             END-IF                                               25660000
242800         END-IF                                                   25670000
242900     WHEN OTHER                                                   25860000
243000*DIFFERENT OPER UNIT                                              25870000
243100         SET PS-DIFF-OPER-UNIT-ID TO TRUE                         25880000
243200     END-EVALUATE.                                                25890000
243300                                                                  25900000
243400                                                                  25910000
243500******************************************************************25920000
243600*  MOVE THE NECESSARY FIELDS TO THE WORKING STORAGE TABLE USED    25930000
243700*  FOR PRINTING THE REPORT.                                       25940000
243800******************************************************************25950000
243900 2520-FILL-PRINT-TBL.                                             25960000
244000     IF PV-UNION-IND = PC-A                                       25970000
244100         PERFORM 2530-INSERT-TO-EA-TABLE                          25980000
244200     ELSE                                                         25990000
244300         SET PS-RTV-DISTRO TO TRUE                                26000000
244400         PERFORM 2540-INSERT-TO-RA-TABLE                          26010000
244500     END-IF.                                                      26020000
244600 2530-INSERT-TO-EA-TABLE.                                         26030000
244700     MOVE PV-STR-NBR             TO EA-STR-NBR (EA-ALLOC-IDX)     26040000
244800     MOVE ST-CHAR5-ABBR-NAME (ST-STR-IDX)                         26050000
244900                                 TO EA-CHAR5-ABBR-NAME            26060000
245000                                   (EA-ALLOC-IDX)                 26070000
245100                                                                  26080000
245200     IF PS-DIFF-OPER-UNIT-ID                                      26090000
245300         MOVE ST-DC-NMBR (ST-STR-IDX)                             26180000
245400                                 TO PV-DIFF-OPER-UNT-ID           26200000
245500         MOVE PV-FRMTD-DIFF-OPER-UNT-ID                           26210000
245600                                 TO EA-DIFF-OPER-UNT-ID           26220000
245700                                    (EA-ALLOC-IDX)                26230000
245800         IF PV-DIFF-OPER-UNT-ID = SPACES OR ZERO                  26250000
245900             CONTINUE                                             26260000
246000         ELSE                                                     26270000
246100             SET PV-SAVE-OTR-IDX TO 1                             26280000
246200             SEARCH PV-SAVE-OTR-TABLE                             26290000
246300                 WHEN PV-DIFF-OPER-UNT-ID = PV-OTR-DIST           26300000
246400                                         (PV-SAVE-OTR-IDX)        26310000
246500                      MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)          26320000
246600                                 TO DP277-STORE-TABLE             26330000
246700                 WHEN PV-OTR-DIST(PV-SAVE-OTR-IDX) = ZERO         26340000
246800                     MOVE PV-DIFF-OPER-UNT-ID                     26350000
246900                                 TO PV-OTR-DIST(PV-SAVE-OTR-IDX)  26360000
247000                     PERFORM 4200-CALC-OPEN-TO-REC                26370000
247100                     MOVE DP277-STORE-TABLE                       26380000
247200                                 TO                               26390000
247300                          PV-SAVE-OTR (PV-SAVE-OTR-IDX)           26400000
247400             END-SEARCH                                           26410000
247500         END-IF                                                   26420000
247600     ELSE                                                         26430000
247700         SET PV-SAVE-OTR-IDX TO 1                                 26440000
247800         SEARCH PV-SAVE-OTR-TABLE                                 26450000
247900             WHEN PC016-OPER-UNT-ID (PC016-IDX) = PV-OTR-DIST     26460000
248000                                     (PV-SAVE-OTR-IDX)            26470000
248100                 MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)               26480000
248200                                 TO DP277-STORE-TABLE             26490000
248300         END-SEARCH                                               26500000
248400     END-IF.                                                      26510000
248500                                                                  26520000
248600     MOVE PV-STR-NBR            TO DP277-SEARCH-NBR               26530000
248700     PERFORM 4210-SEARCH-OTR                                      26540000
248800     MOVE DP277-PK-OTR-OUT      TO PV-OTR                         26550000
248900                                   EA-ITEMS-OPEN-TO-RECEIVE       26560000
249000                                   (EA-ALLOC-IDX)                 26570000
249100                                                                  26580000
249200     IF DP277-NO-DISTRO                                           26590000
249300         SET PS-PRINT-NO-DISTRO-MSG TO TRUE                       26600000
249400     END-IF.                                                      26610000
249500                                                                  26620000
249600                                                                  26630000
249700     MOVE PV-EXPTED-ITM-CNT                                       26640000
249800         TO  EA-EXPTED-ITM-CNT (EA-ALLOC-IDX).                    26650000
249900     COMPUTE  PV-TOT-EXPTED-ITM-CNT  =                            26660000
250000         PV-EXPTED-ITM-CNT  +  PV-TOT-EXPTED-ITM-CNT.             26670000
250100     ADD 1  TO  PV-STORES-GIVEN-PIECES.                           26680000
250200                                                                  26690000
250300     SET EA-ALLOC-IDX UP BY +1.                                   26700000
250400                                                                  26710000
250500 2540-INSERT-TO-RA-TABLE.                                         26720000
250600     MOVE PV-STR-NBR             TO RA-STR-NBR (RA-ALLOC-IDX)     26730000
250700     MOVE ST-CHAR5-ABBR-NAME (ST-STR-IDX)                         26740000
250800                                 TO RA-CHAR5-ABBR-NAME            26750000
250900                                   (RA-ALLOC-IDX)                 26760000
251000                                                                  26770000
251100     IF PS-DIFF-OPER-UNIT-ID                                      26780000
251200         MOVE ST-DC-NMBR (ST-STR-IDX)                             26870000
251300                                 TO PV-DIFF-OPER-UNT-ID           26890000
251400         MOVE PV-FRMTD-DIFF-OPER-UNT-ID                           26900000
251500                                 TO RA-DIFF-OPER-UNT-ID           26910000
251600                                    (RA-ALLOC-IDX)                26920000
251700         IF PV-DIFF-OPER-UNT-ID = SPACES OR ZERO                  26940000
251800             CONTINUE                                             26950000
251900         ELSE                                                     26960000
252000             SET PV-SAVE-OTR-IDX TO 1                             26970000
252100             SEARCH PV-SAVE-OTR-TABLE                             26980000
252200                 WHEN PV-DIFF-OPER-UNT-ID = PV-OTR-DIST           26990000
252300                                         (PV-SAVE-OTR-IDX)        27000000
252400                      MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)          27010000
252500*                                TO DP276-OTR-TABLE               27020000
252600                                 TO DP277-STORE-TABLE             27030000
252700                 WHEN PV-OTR-DIST(PV-SAVE-OTR-IDX) = ZERO         27040000
252800                     MOVE PV-DIFF-OPER-UNT-ID                     27050000
252900                                 TO PV-OTR-DIST(PV-SAVE-OTR-IDX)  27060000
253000                     PERFORM 4200-CALC-OPEN-TO-REC                27070000
253100*                    MOVE DP276-OTR-TABLE                         27080000
253200                     MOVE DP277-STORE-TABLE                       27090000
253300                                 TO                               27100000
253400                          PV-SAVE-OTR (PV-SAVE-OTR-IDX)           27110000
253500             END-SEARCH                                           27120000
253600         END-IF                                                   27130000
253700     ELSE                                                         27140000
253800         SET PV-SAVE-OTR-IDX TO 1                                 27150000
253900         SEARCH PV-SAVE-OTR-TABLE                                 27160000
254000             WHEN PC016-OPER-UNT-ID (PC016-IDX) = PV-OTR-DIST     27170000
254100                                     (PV-SAVE-OTR-IDX)            27180000
254200                 MOVE PV-SAVE-OTR (PV-SAVE-OTR-IDX)               27190000
254300*                                TO DP276-OTR-TABLE               27200000
254400                                 TO DP277-STORE-TABLE             27210000
254500         END-SEARCH                                               27220000
254600     END-IF.                                                      27230000
254700                                                                  27240000
254800     MOVE PV-STR-NBR            TO DP277-SEARCH-NBR               27250000
254900     PERFORM 4210-SEARCH-OTR                                      27260000
255000     MOVE DP277-PK-OTR-OUT      TO PV-OTR                         27270000
255100                                   RA-ITEMS-OPEN-TO-RECEIVE       27280000
255200                                   (RA-ALLOC-IDX)                 27290000
255300*    MOVE DP276-OTR-OUT-X       TO RA-ITEMS-OPEN-TO-RECEIVE       27300000
255400*                                  (RA-ALLOC-IDX)                 27310000
255500                                                                  27320000
255600     IF DP277-NO-DISTRO                                           27330000
255700         SET PS-PRINT-NO-DISTRO-MSG TO TRUE                       27340000
255800     END-IF.                                                      27350000
255900                                                                  27360000
256000                                                                  27370000
256100     MOVE PV-EXPTED-ITM-CNT                                       27380000
256200         TO  RA-EXPTED-ITM-CNT (RA-ALLOC-IDX).                    27390000
256300     COMPUTE  PV-TOT-EXPTED-ITM-CNT  =                            27400000
256400         PV-EXPTED-ITM-CNT  +  PV-TOT-EXPTED-ITM-CNT.             27410000
256500     ADD 1  TO  PV-STORES-GIVEN-PIECES.                           27420000
256600     ADD 1  TO  PV-RTV-STORES.                                    27430000
256700                                                                  27440000
256800     SET RA-ALLOC-IDX UP BY +1.                                   27450000
256900                                                                  27460000
257000     EJECT                                                        27470000
257100                                                                  27480000
257200 3000-ODD-UNITS-WORKSHEET.                                        29170000
257300      MOVE PC-OUW-RPT-HDR          TO HL1-RPT-HDR                 29180000
257400* * *  CALCULATE THE TOTAL PAGES TO PRINT                         29190000
257500     INITIALIZE PS-START-NEW-PAGE-SW                              29200000
257600* * * HOW MANY PAGES/LINES DO THE THE LINE ITEMS TAKE UP          29210000
257700     IF RC806-NBR-OF-LINES > PV-LINES-AVAILABLE                   29220000
257800         DIVIDE RC806-NBR-OF-LINES BY PV-LINES-AVAILABLE          29230000
257900             GIVING PV-TOTAL-PAGES                                29240000
258000             REMAINDER PV-LINES-USED                              29250000
258100         IF PV-LINES-USED = ZERO                                  29260000
258200             SET PS-START-NEW-PAGE TO TRUE                        29270000
258300         END-IF                                                   29280000
258400     ELSE                                                         29290000
258500*        MOVE PC-ONE                TO PV-TOTAL-PAGES             29300000
258600         MOVE ZERO                  TO PV-TOTAL-PAGES             29310000
258700         MOVE RC806-NBR-OF-LINES    TO PV-LINES-USED              29320000
258800     END-IF.                                                      29330000
258900* * * WE CAN GET 16 ITEMS ON 1 PRINT LINE.  IF MORE THAN 16       29340000
259000* * * WE HAVE TO PRINT LINES FOR THE STORES MULTIPLE TIMES        29350000
259100*    DIVIDE RC806-NBR-OF-LINES BY 16 GIVING PV-16-ITEM-CNT        29360000
259200*                                    REMAINDER PV-REMAINDER       29370000
259300     DIVIDE RC806-NBR-OF-LINES BY 11 GIVING PV-16-ITEM-CNT        29371000
259400                                     REMAINDER PV-REMAINDER       29372000
259500     IF PV-REMAINDER > ZERO                                       29380000
259600         ADD +1                     TO PV-16-ITEM-CNT             29390000
259700     END-IF.                                                      29400000
259800     ADD PV-16-ITEM-CNT             TO PV-TOTAL-PAGES             29410000
259900                                                                  29420000
260000* * * ARE THERE ENOUGH LINES FOR AT LEAST 1 STORE LINE?           29430000
260100* * * THE STORE AREA HEADING, 1 STORE LINE, AND THE 'ACTUAL       29440000
260200* * * ODD UNITS' TAKE 20 LINES.  ADD 2 FOR INSURANCE BECAUSE      29450000
260300* * * WE ONLY ADD TO LINES USED AFTER PRINTING THE 3 LINES        29460000
260400* * * REQUIRED FOR EACH STORE.                                    29470000
260500     ADD PV-LINES-USED +22 GIVING PV-WRK-QTY                      29480000
260600     IF PV-WRK-QTY > PV-LINES-AVAILABLE                           29490000
260700         ADD PC-ONE                  TO PV-TOTAL-PAGES            29500000
260800         MOVE ZERO                   TO PV-LINES-USED             29510000
260900         SET PS-START-NEW-PAGE       TO TRUE                      29520000
261000     END-IF                                                       29530000
261100                                                                  29540000
261200* * * STORE AREA HEADING IS 11 MORE LINES THAN ITEMS HEADER       29550000
261300* * * AND 'ACTUAL ODD UNITS' LINE AT BOTTOM TAKES 3 MORE.         29560000
261400* * * ADD 2 MORE INSURANCE LINES.                                 29570000
261500*    SUBTRACT +16 FROM PV-LINES-AVAILABLE                         29580000
261600     SUBTRACT +11 FROM PV-LINES-AVAILABLE                         29581000
261700* * * IF STARTING STORE WORK AREA ON A NEW PAGE                   29590000
261800     IF PS-START-NEW-PAGE                                         29600000
261900         MOVE PV-LINES-AVAILABLE     TO PV-ROWS-PER-PAGE          29610000
262000* * * STARTING STORE WORK AREA PRINTING ON CURRENT PAGE           29620000
262100     ELSE                                                         29630000
262200* * * HOW MANY STORE AREA LINES CAN WE GET ON THE CURRENT PAGE    29640000
262300         SUBTRACT PV-LINES-USED FROM PV-LINES-AVAILABLE           29650000
262400                                 GIVING PV-ROWS-PER-PAGE          29660000
262500* * * THE LAST LINES HAVE TO BE ALLIGNED TO FIT IN A PAGE  230ZZ  29670000
262600         DIVIDE PV-ROWS-PER-PAGE BY +3                            29670100
262700             GIVING PV-ROWS-DIV-BY-THREE                          29670200
262800         MULTIPLY PV-ROWS-DIV-BY-THREE BY +3                      29670300
262900             GIVING PV-ROWS-PER-PAGE                              29670400
263000* * * 3 MORE LINES ARE USED IF STARTING IN THE MIDDLE OF THE PAGE 29671000
263100         SUBTRACT +3 FROM PV-ROWS-PER-PAGE                        29680000
263200     END-IF.                                                      29690000
263300                                                                  29700000
263400     MOVE PC-ONE                      TO PS-PAGE-SUB              29710000
263500     MOVE PV-TOTAL-PAGES              TO PV-PAGES-REQ.            29720000
263600     SET PS-PRINT-ITEM-DETAIL         TO TRUE                     29730000
263700     PERFORM 4060-REPORT-HEADINGS.                                29740000
263800     MOVE ZERO                        TO PV-LINES-USED            29750000
263900     PERFORM 4002-PRINT-LINE-DETAIL                               29760000
264000         VARYING PS-DTL-LNE-SUB                                   29770000
264100         FROM 1 BY 1                                              29780000
264200         UNTIL PS-DTL-LNE-SUB > RC806-NBR-OF-LINES.               29790000
264300     INITIALIZE PS-PRINT-ITEM-DETAIL-SW                           29800000
264400                                                                  29810000
264500     SET PS-PRINT-STORE-WORKAREA      TO TRUE.                    29820000
264600     MOVE PC-ONE                      TO PACK-LINE-SUB            29830000
264700                                         PV-LINES-USED            29840000
264800     PERFORM 3010-PRINT-WORKAREA PV-16-ITEM-CNT TIMES.            29850000
264900                                                                  29860000
265000 3010-PRINT-WORKAREA.                                             29870000
265100     MOVE PC-ONE                      TO WORK-LINE-SUB            29880000
265200     PERFORM 3020-LOAD-WORKAREA-HDR                               29890000
265300                                                                  29900000
265400     IF PS-START-NEW-PAGE                                         29910000
265500         ADD PC-ONE                   TO PS-PAGE-SUB              29920000
265600         MOVE PC-ONE                  TO PV-LINES-USED            29930000
265700         MOVE PV-LINES-AVAILABLE      TO PV-ROWS-PER-PAGE         29940000
265800         PERFORM 4060-REPORT-HEADINGS                             29950000
265900     ELSE                                                         29960000
266000         MOVE DASHES-LINE              TO  DRS01-COMM-DATA        29970000
266100         MOVE PC-SINGLE-SPACE          TO  DRS01-COMM-CTL         29980000
266200         PERFORM 8000-LINK-TO-DRS                                 29990000
266300         PERFORM 4062-STORE-WORKAREA-HDR                          30000000
266400         SET PS-START-NEW-PAGE         TO TRUE                    30010000
266500     END-IF                                                       30020000
266600                                                                  30030000
266700*  TO ALLIGN THE LAST ROW TO FIT INTO THE PAGE,   WR/IR# 230ZZ    30030100
266800*  DIVISION BY 3 WAS REQUIRED                     WR/IR# 230ZZ    30030200
266900     COMPUTE PV-ROWS-PER-PAGE =                                   30030300
267000          (PV-ROWS-PER-PAGE / 3 ) * 3.                            30030400
267100     PERFORM 3012-LINES-FOR-STORE                                 30040000
267200         UNTIL PV-LINES-USED > PV-ROWS-PER-PAGE                   30050000
267300     PERFORM 3014-ACTUAL-ODD-LINE.                                30060000
267400                                                                  30070000
267500*    IF PS-PAGE-SUB = PC-ONE                                      30080000
267600*        ADD PC-ONE              TO PS-PAGE-SUB                   30090000
267700*        MOVE PC-ONE             TO PV-LINES-USED                 30100000
267800*        MOVE PV-LINES-AVAILABLE TO PV-ROWS-PER-PAGE              30110000
267900*        PERFORM 4060-REPORT-HEADINGS                             30120000
268000*        PERFORM 3012-LINES-FOR-STORE                             30130000
268100*            UNTIL PV-LINES-USED > PV-ROWS-PER-PAGE               30140000
268200*        PERFORM 3014-ACTUAL-ODD-LINE                             30150000
268300*    END-IF.                                                      30160000
268400                                                                  30170000
268500 3012-LINES-FOR-STORE.                                            30180000
268600     MOVE SPACES                 TO OUW-STR-NBR-AREA              30190000
268700     MOVE OUW-VERTICAL-BAR-LINE  TO OUW-STR-ALLOC-AREA            30200000
268800     MOVE OUW-LINE7              TO DRS01-COMM-DATA               30210000
268900     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                30220000
269000     PERFORM 8000-LINK-TO-DRS                                     30230000
269100     MOVE OUW-LINE7              TO DRS01-COMM-DATA               30240000
269200     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                30250000
269300     PERFORM 8000-LINK-TO-DRS                                     30260000
269400     MOVE ALL '_'                TO OUW-STR-NBR-AREA              30270000
269500     MOVE OUW-HORIZONTAL-LINE    TO OUW-STR-ALLOC-AREA            30280000
269600     MOVE OUW-LINE7              TO DRS01-COMM-DATA               30290000
269700     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                30300000
269800     PERFORM 8000-LINK-TO-DRS                                     30310000
269900     ADD +3                      TO PV-LINES-USED.                30320000
270000                                                                  30330000
270100 3014-ACTUAL-ODD-LINE.                                            30340000
270200     MOVE OUW-VERTICAL-BAR-LINE  TO OUW-STR-ALLOC-AREA            30350000
270300     MOVE SPACES                 TO OUW-STR-NBR-AREA              30360000
270400     MOVE OUW-LINE7              TO DRS01-COMM-DATA               30370000
270500     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                30380000
270600     PERFORM 8000-LINK-TO-DRS                                     30390000
270700     MOVE PC-ACTUAL-ODD-LIT      TO OUW-STR-NBR-AREA              30400000
270800     MOVE OUW-LINE7              TO DRS01-COMM-DATA               30410000
270900     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                30420000
271000     PERFORM 8000-LINK-TO-DRS                                     30430000
271100     MOVE SPACES                 TO OUW-STR-NBR-AREA              30440000
271200     MOVE OUW-HORIZONTAL-LINE    TO OUW-STR-ALLOC-AREA            30450000
271300     MOVE OUW-LINE7              TO DRS01-COMM-DATA               30460000
271400     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                30470000
271500     PERFORM 8000-LINK-TO-DRS.                                    30480000
271600*                                                                 30490000
271700 3020-LOAD-WORKAREA-HDR.                                          30500000
271800     MOVE OUW-VERTICAL-BAR-LINE  TO OUW-SKU-LINE                  30510000
271900                                    OUW-SIZE-LINE                 30520000
272000                                    OUW-LINE-NBR-LINE             30530000
272100                                    OUW-RATIO-LINE                30540000
272200                                    OUW-ODD-UNITS-LINE            30550000
272300                                    OUW-STR-ALLOC-AREA            30560000
272400     PERFORM UNTIL PACK-LINE-SUB > RC806-NBR-OF-LINES             30570000
272500*               OR WORK-LINE-SUB > +16                            30580000
272600                OR WORK-LINE-SUB > +11                            30581000
272700         MOVE LD-SEQ-NBR (PACK-LINE-SUB)                          30590000
272800                                 TO OUW-SKU (WORK-LINE-SUB)       30600000
272900         MOVE LD-SIZE (PACK-LINE-SUB)                             30610000
273000                                 TO OUW-SIZE (WORK-LINE-SUB)      30620000
273100         MOVE LD-LINE-NBR (PACK-LINE-SUB)                         30630000
273200                                 TO OUW-LINE-NBR (WORK-LINE-SUB)  30640000
273300         MOVE LD-RATIO (PACK-LINE-SUB)                            30650000
273400                                 TO OUW-RATIO (WORK-LINE-SUB)     30660000
273500         MOVE LD-ODD-UNITS (PACK-LINE-SUB)                        30670000
273600                                 TO OUW-ODD-UNITS (WORK-LINE-SUB) 30680000
273700         ADD PC-ONE              TO PACK-LINE-SUB                 30690000
273800                                    WORK-LINE-SUB                 30700000
273900     END-PERFORM.                                                 30710000
274000     EJECT                                                        30720000
274100*                                                                 30730000
274200******************************************************************30740000
274300*  WRITE THE DATA TO THE DETAIL AND HEADING LINES VIA DRS.        30750000
274400******************************************************************30760000
274500 4000-PRODUCE-RPT.                                                30770000
274600     PERFORM 4060-REPORT-HEADINGS.                                30780000
274700                                                                  30790000
274800     IF PS-PAGE-SUB = PC-ONE                                      30800000
274900         MOVE DASHES-LINE            TO  DRS01-COMM-DATA          30810000
275000         MOVE PC-SINGLE-SPACE        TO  DRS01-COMM-CTL           30820000
275100         PERFORM 8000-LINK-TO-DRS                                 30830000
275200     END-IF.                                                      30840000
275300                                                                  30850000
275400     IF PS-PRINT-ITEM-DETAIL                                      30860000
275500         MOVE ZERO                      TO PV-LINES-USED          30870000
275600         PERFORM 4002-PRINT-LINE-DETAIL                           30880000
275700             VARYING PS-DTL-LNE-SUB                               30890000
275800             FROM 1 BY 1                                          30900000
275900             UNTIL PS-DTL-LNE-SUB > RC806-NBR-OF-LINES            30910000
276000         INITIALIZE PS-PRINT-ITEM-DETAIL-SW                       30920000
276100     END-IF.                                                      30930000
276200                                                                  30940000
276300     IF PS-START-NEW-PAGE                                         30950000
276400         ADD +1 TO PS-PAGE-SUB                                    30960000
276500         PERFORM 4060-REPORT-HEADINGS                             30970000
276600*        INITIALIZE PS-START-NEW-PAGE-SW                          30980000
276700         INITIALIZE PV-LINES-USED                                 30990000
276800*        MOVE PV-LINES-AVAILABLE        TO PV-ROWS-PER-PAGE       31000000
276900     ELSE                                                         31010000
277000         IF PS-PAGE-SUB = PC-ONE                                  31020000
277100             MOVE DASHES-LINE           TO  DRS01-COMM-DATA       31030000
277200             MOVE PC-SINGLE-SPACE       TO  DRS01-COMM-CTL        31040000
277300             PERFORM 8000-LINK-TO-DRS                             31050000
277400             MOVE DH3-DETAIL-HEADING-LINE-1                       31060000
277500                                        TO  DRS01-COMM-DATA       31070000
277600             MOVE PC-SINGLE-SPACE       TO  DRS01-COMM-CTL        31080000
277700             PERFORM 8000-LINK-TO-DRS                             31090000
277800             MOVE DH4-DETAIL-HEADING-LINE-2                       31100000
277900                                        TO  DRS01-COMM-DATA       31110000
278000             MOVE PC-SINGLE-SPACE       TO  DRS01-COMM-CTL        31120000
278100             PERFORM 8000-LINK-TO-DRS                             31130000
278200             ADD +3                     TO PV-LINES-USED          31140000
278300         END-IF                                                   31150000
278400     END-IF.                                                      31160000
278500                                                                  31170000
278600     IF PS-PRINT-NO-DISTRO-MSG                                    31180000
278700         MOVE DH5-NO-DISTRO-MSG          TO  DRS01-COMM-DATA      31190000
278800         MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL       31200000
278900         ADD +2                          TO PV-LINES-USED         31210000
279000         PERFORM 8000-LINK-TO-DRS                                 31220000
279100         INITIALIZE PS-PRINT-NO-DISTRO-MSG-SW                     31230000
279200     END-IF.                                                      31240000
279300                                                                  31250000
279400     MOVE SPACES TO DETAIL-LINE2                                  31260000
279500     PERFORM 4010-PRINT-STORE-DETAIL                              31270000
279600         VARYING PS-DTL-LNE-SUB                                   31280000
279700         FROM 1 BY 1                                              31290000
279800         UNTIL PS-DTL-LNE-SUB > PV-ROWS-PER-PAGE OR               31300000
279900               PS-END-OF-DETAIL                                   31310000
280000     INITIALIZE PS-START-NEW-PAGE-SW                              31320000
280100     MOVE PV-LAST-STR-ON-PAGE   TO PV-ENDING-IDX-LOCATION         31330000
280200                                                                  31340000
280300     ADD PV-LAST-STR-ON-PAGE PC-ONE GIVING PV-WRK-QTY             31350000
280400     SET EA-ALLOC-IDX TO PV-WRK-QTY                               31360000
280500     IF PS-END-OF-DETAIL                                          31370000
280600       OR (PS-DTL-LNE-SUB > PV-ROWS-PER-PAGE                      31380000
280700           AND EA-STR-NBR (EA-ALLOC-IDX) = ZERO)                  31390000
280800         PERFORM 4001-END-OF-APRON                                31400000
280900     ELSE                                                         31410000
281000         MOVE PV-LINES-AVAILABLE TO PV-ROWS-PER-PAGE              31420000
281100     END-IF.                                                      31430000
281200                                                                  31440000
281300 4001-END-OF-APRON.                                               31450000
281400* * * ADD 3 FOR THE TOTAL LINES AND 6 FOR THE SIGN-OFF LINES.     31460000
281500     MOVE +9                      TO PV-WRK-QTY                   31470000
281600     IF PS-RTV-DISTRO                                             31480000
281700         ADD +4                   TO PV-WRK-QTY                   31490000
281800     END-IF                                                       31500000
281900     IF CA-OPER-UNT-ID = 85                                       31510000
282000       IF CA-PRTR-PRTR-BRCDE-IND = 'Y'                            31520000
282100         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           31530000
282200             ADD +7               TO PV-WRK-QTY                   31540000
282300         ELSE                                                     31550000
282400             ADD +6               TO PV-WRK-QTY                   31560000
282500         END-IF                                                   31570000
282600       END-IF                                                     31580000
282700     END-IF.                                                      31590000
282800     ADD PV-WRK-QTY                TO PV-LINES-USED               31600000
282900     IF PV-LINES-USED > PV-LINES-AVAILABLE                        31610000
283000         ADD PC-ONE                TO PS-PAGE-SUB                 31620000
283100         PERFORM 4060-REPORT-HEADINGS                             31630000
283200         MOVE PV-WRK-QTY           TO PV-LINES-USED               31640000
283300     END-IF                                                       31650000
283400     SUBTRACT PV-LINES-USED FROM PV-LINES-AVAILABLE               31660000
283500                               GIVING PV-WRK-QTY                  31670000
283600     MOVE SPACES                    TO DRS01-COMM-DATA            31680000
283700     MOVE PC-SINGLE-SPACE           TO DRS01-COMM-CTL             31690000
283800     PERFORM 8000-LINK-TO-DRS                                     31700000
283900         PV-WRK-QTY TIMES.                                        31710000
284000     IF PS-RTV-DISTRO                                             31720000
284100         SET PS-RTV-PRINT TO TRUE                                 31730000
284200         MOVE HL15-HEADING-LINE-15   TO  DRS01-COMM-DATA          31740000
284300         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           31750000
284400         PERFORM 8000-LINK-TO-DRS                                 31760000
284500         MOVE SPACES                 TO  DL2-STORE-DETAIL (4)     31770000
284600         PERFORM 4030-FILL-RTV-LNE                                31780000
284700         MOVE DETAIL-LINE2           TO  DRS01-COMM-DATA          31790000
284800         MOVE PC-SINGLE-SPACE        TO  DRS01-COMM-CTL           31800000
284900         PERFORM 8000-LINK-TO-DRS                                 31810000
285000         MOVE SPACES                 TO  DRS01-COMM-DATA          31820000
285100         MOVE PC-SINGLE-SPACE        TO  DRS01-COMM-CTL           31830000
285200         PERFORM 8000-LINK-TO-DRS                                 31840000
285300     END-IF.                                                      31850000
285400                                                                  31860000
285500                                                                  31870000
285600     MOVE PV-EXPTED-PACK-CNT-SUM-TOT TO TL1-TOT-EXPTED-PACKS      31880000
285700     MOVE PV-TOT-BEST-CAST-UNITS TO TL1-TOT-EXPTED-PACK-UNITS     31890000
285800     MOVE PV-TOT-ODD-UNITS       TO TL2-TOT-EXPTED-ODD-UNITS      31900000
285900     MOVE PV-STORES-GIVEN-PIECES TO TL3-TOT-STR-GIVEN             31910000
286000                                    TL3-TOT-STR-GIVEN-NB          31920000
286100     MOVE TL-LINE-1              TO DRS01-COMM-DATA               31930000
286200     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                31940000
286300     PERFORM 8000-LINK-TO-DRS                                     31950000
286400     MOVE TL-LINE-2              TO DRS01-COMM-DATA               31960000
286500     MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL                31970000
286600     PERFORM 8000-LINK-TO-DRS                                     31980000
286700                                                                  31990000
286800     IF CA-PRTR-PRTR-BRCDE-IND = 'Y'                              32000000
286900*    IF A MENOMONEE FALLS RECEIVER, PRINT THE SORTATION BARCODE   32010000
287000         AND CA-OPER-UNT-ID = 85                                  32020000
287100***  BARCODE CODING                                               32030000
287200         MOVE DS004-PLC-ACTIVATE-IMAGE1                           32040000
287300                                      TO DRS01-COMM-DATA          32050000
287400         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           32060000
287500         PERFORM 8000-LINK-TO-DRS                                 32070000
287600                                                                  32080000
287700*        IF THE PRINTER CONTROL INDICATOR SAYS IT IS A "FORMSPRO" 32090000
287800*        PRINTER, ACTIVATE FREE-FORM CONTROL                      32100000
287900         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           32110000
288000             MOVE DS004-PLC-ACTIVATE-FF-PROC                      32120000
288100                                          TO DRS01-COMM-DATA      32130000
288200             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       32140000
288300             PERFORM 8000-LINK-TO-DRS                             32150000
288400         END-IF                                                   32160000
288500                                                                  32170000
288600         MOVE RECEIV-RCVR-NBR    TO TL3-SORT-KEYREC               32180000
288700                                    TL4-SORT-KEYREC               32190000
288800         MOVE ZERO               TO TL3-SEQ-NBR                   32200000
288900                                    TL4-SEQ-NBR                   32210000
289000*        MOVE CA-ORD-LNE-NBR     TO TL3-SORT-LINE-NBR             32220000
289100         MOVE PV-DRIVER-LINE-NBR TO TL3-SORT-LINE-NBR             32230000
289200                                    TL4-SORT-LINE-NBR             32240000
289300         PERFORM 4020-COMPUTE-CNTL-NBR-CKDGT                      32250000
289400         MOVE TL-LINE-3-BARCODE   TO  DRS01-COMM-DATA             32260000
289500         MOVE PC-SINGLE-SPACE     TO  DRS01-COMM-CTL              32270000
289600         PERFORM 8000-LINK-TO-DRS                                 32280000
289700                                                                  32290000
289800*        IF THE PRINTER CONTROL INDICATOR SAYS IT IS A "FORMSPRO" 32300000
289900*        PRINTER, DEACTIVATE THE FREE-FORM CONTROL, AND END       32310000
290000*        GRAPHICS MODE.                                           32320000
290100         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           32330000
290200             MOVE DS004-PLC-DEACTIVATE-FF-PROC                    32340000
290300                                          TO DRS01-COMM-DATA      32350000
290400*            MOVE '^O'                    TO DRS01-COMM-DATA      32360000
290500             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       32370000
290600             PERFORM 8000-LINK-TO-DRS                             32380000
290700                                                                  32390000
290800             MOVE CA-LINES-PER-INCH       TO DS004-PLC-DI-LPI     32400000
290900             MOVE DS004-PLC-DEACTIVATE-IMAGE                      32410000
291000                                          TO DRS01-COMM-DATA      32420000
291100*            MOVE '^PN'                   TO DRS01-COMM-DATA      32430000
291200             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       32440000
291300             PERFORM 8000-LINK-TO-DRS                             32450000
291400                                                                  32460000
291500         ELSE                                                     32470000
291600             MOVE '^PN^-'                 TO DRS01-COMM-DATA      32480000
291700             MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL       32490000
291800             PERFORM 8000-LINK-TO-DRS                             32500000
291900         END-IF                                                   32510000
292000                                                                  32520000
292100     ELSE                                                         32530000
292200*    ELSE PRINT THE LINE WITHOUT THE SORTATION BARCODE            32540000
292300         MOVE TL-LINE-3-NO-BARCODE        TO  DRS01-COMM-DATA     32550000
292400         MOVE PC-SINGLE-SPACE             TO  DRS01-COMM-CTL      32560000
292500         PERFORM 8000-LINK-TO-DRS                                 32570000
292600     END-IF.                                                      32580000
292700***  BARCODE CODING                                               32590000
292800* * *  PRINT LAST 2 LINES AT THE BOTTOM OF THE PAGE.              32600000
292900     MOVE OUW-LINE8                   TO DRS01-COMM-DATA          32610000
293000     MOVE PC-TRIPLE-SPACE             TO DRS01-COMM-CTL           32620000
293100     PERFORM 8000-LINK-TO-DRS                                     32630000
293200     MOVE OUW-LINE8                   TO DRS01-COMM-DATA          32640000
293300     PERFORM 8000-LINK-TO-DRS.                                    32650000
293400******************************************************************32660000
293500*  THIS MODULE CONTROLS THE PRINTING OF THE LINE DETAIL LINES.    32670000
293600 4002-PRINT-LINE-DETAIL.                                          32680000
293700     IF PS-DTL-LNE-SUB > PV-LINES-AVAILABLE                       32690000
293800         ADD +1                           TO PS-PAGE-SUB          32700000
293900         PERFORM 4060-REPORT-HEADINGS                             32710000
294000         MOVE ZERO                        TO PV-LINES-USED        32720000
294100     ELSE                                                         32730000
294200         ADD +1                           TO PV-LINES-USED        32740000
294300     END-IF.                                                      32750000
294400     MOVE LD-LINE-NBR (PS-DTL-LNE-SUB)    TO DL1-LINE-NBR         32760000
294500     MOVE LD-CLASS-NBR (PS-DTL-LNE-SUB)   TO DL1-CLASS-NBR        32770000
294600     MOVE LD-SEQ-NBR (PS-DTL-LNE-SUB)     TO DL1-SEQ-NBR          32780000
294700     MOVE LD-BOX-ID (PS-DTL-LNE-SUB)      TO DL1-BOX-ID           32790000
294800     MOVE LD-SKU-RTL (PS-DTL-LNE-SUB)     TO DL1-SKU-RTL          32800000
294900     MOVE LD-RATIO (PS-DTL-LNE-SUB)       TO DL1-RATIO            32810000
295000     MOVE LD-SKU-DESC (PS-DTL-LNE-SUB)    TO DL1-SKU-DESC         32820000
295100     MOVE LD-VNDR-STYLE-NME (PS-DTL-LNE-SUB)                      32830000
295200                                          TO DL1-VNDR-STYLE-NME   32840000
295300     MOVE LD-SIZE (PS-DTL-LNE-SUB)        TO DL1-SIZE             32850000
295400     MOVE LD-COLOR (PS-DTL-LNE-SUB)       TO DL1-COLOR            32860000
295500     MOVE LD-NRF-COLOR-CDE (PS-DTL-LNE-SUB)                       32870000
295600                                          TO DL1-NRF-COLOR-CDE    32880000
295700     MOVE LD-NRF-COLOR-DESC (PS-DTL-LNE-SUB)                      32890000
295800                                          TO DL1-NRF-COLOR-DESC   32900000
295900     MOVE LD-UPC-CERT-REQ-FLG (PS-DTL-LNE-SUB)                    32910000
296000                                          TO DL1-UPC-CERT-REQ-FLG 32920000
296100     MOVE LD-EXPTED-UNITS (PS-DTL-LNE-SUB)                        32930000
296200                                          TO DL1-EXPTED-UNITS     32940000
296300     MOVE LD-BEST-CASE-UNITS (PS-DTL-LNE-SUB)                     32950000
296400                                          TO DL1-BEST-CASE-UNITS  32960000
296500     MOVE LD-ODD-UNITS (PS-DTL-LNE-SUB)   TO DL1-ODD-UNITS        32970000
296600     MOVE LD-RTL-DSCREP-FLG (PS-DTL-LNE-SUB)                      32981000
296700                                          TO DL1-RTL-DSCREP-FLG   32982000
296800     MOVE DETAIL-LINE1                    TO DRS01-COMM-DATA.     32990000
296900     MOVE PC-SINGLE-SPACE                 TO DRS01-COMM-CTL.      33000000
297000     PERFORM 8000-LINK-TO-DRS.                                    33010000
297100                                                                  33020000
297200******************************************************************33030000
297300*  THIS MODULE CONTROLS THE PRINTING OF THE STORE DETAIL LINES.   33040000
297400*  ONLY STORES WHICH HAVE AN EXPECTED ALLOCATION WILL BE PRINTED. 33050000
297500******************************************************************33060000
297600 4010-PRINT-STORE-DETAIL.                                         33070000
297700     IF PS-PAGE-SUB = PC-ONE                                      33080000
297800      OR PS-START-NEW-PAGE                                        33090000
297900         SET EA-ALLOC-IDX TO PS-DTL-LNE-SUB                       33100000
298000     ELSE                                                         33110000
298100         ADD PS-DTL-LNE-SUB PV-ENDING-IDX-LOCATION                33120000
298200                      GIVING PV-WRK-QTY                           33130000
298300         SET EA-ALLOC-IDX TO PV-WRK-QTY                           33140000
298400     END-IF.                                                      33150000
298500                                                                  33160000
298600     PERFORM 4011-FILL-DTL-LNE                                    33170000
298700        VARYING STR-DTL-LNE-IDX                                   33180000
298800        FROM 1 BY 1                                               33190000
298900        UNTIL STR-DTL-LNE-IDX > PV-COLS-PER-PAGE.                 33200000
299000                                                                  33210000
299100     MOVE DETAIL-LINE2               TO  DRS01-COMM-DATA.         33220000
299200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          33230000
299300     PERFORM 8000-LINK-TO-DRS.                                    33240000
299400     ADD +1                          TO PV-LINES-USED.            33250000
299500                                                                  33260000
299600 4011-FILL-DTL-LNE.                                               33270000
299700     IF EA-CLOSED-IND (EA-ALLOC-IDX) = '*'                        33280000
299800         MOVE ALL '*' TO  DL2-STORE-DETAIL (STR-DTL-LNE-IDX)      33290000
299900         IF STR-DTL-LNE-IDX = 4                                   33300000
300000             MOVE SPACES TO DL2-FILLER (STR-DTL-LNE-IDX)          33310000
300100         END-IF                                                   33320000
300200     ELSE                                                         33330000
300300         MOVE SPACES  TO  DL2-STORE-DETAIL (STR-DTL-LNE-IDX)      33340000
300400     END-IF.                                                      33350000
300500                                                                  33360000
300600     IF EA-STR-NBR (EA-ALLOC-IDX) = ZEROS                         33370000
300700         IF STR-DTL-LNE-IDX = 1                                   33380000
300800             SET PS-END-OF-DETAIL TO TRUE                         33390000
300900         END-IF                                                   33400000
301000     ELSE                                                         33410000
301100         MOVE EA-STR-NBR (EA-ALLOC-IDX)                           33420000
301200             TO  DL2-STR-NBR (STR-DTL-LNE-IDX)                    33430000
301300         MOVE EA-CHAR5-ABBR-NAME (EA-ALLOC-IDX)                   33440000
301400             TO  DL2-CHAR5-ABBR-NAME (STR-DTL-LNE-IDX)            33450000
301500         DIVIDE EA-EXPTED-ITM-CNT (EA-ALLOC-IDX)                  33460000
301600             BY PV-DRIVER-LINE-RATIO                              33470000
301700             GIVING DL2-EXPTED-PACK-CNT (STR-DTL-LNE-IDX)         33480000
301800             INITIALIZE PV-EXPTED-PACK-CNT-NUM                    33490000
301900             MOVE DL2-EXPTED-PACK-CNT (STR-DTL-LNE-IDX)           33500000
302000               TO PV-EXPTED-PACK-CNT-NUM                          33510000
302100              ADD PV-EXPTED-PACK-CNT-NUM                          33520000
302200               TO PV-EXPTED-PACK-CNT-SUM-TOT                      33530000
302300         MOVE EA-DIFF-OPER-UNT-ID (EA-ALLOC-IDX)                  33540000
302400             TO  DL2-DIFF-OPER-UNIT (STR-DTL-LNE-IDX)             33550000
302500         MOVE EA-ITEMS-OPEN-TO-RECEIVE (EA-ALLOC-IDX)             33560000
302600             TO DL2-PACKS-OPEN-TO-RECEIVE (STR-DTL-LNE-IDX)       33570000
302700         ADD PC-ONE TO PV-LAST-STR-ON-PAGE                        33580000
302800     END-IF.                                                      33590000
302900                                                                  33600000
303000     SET EA-ALLOC-IDX UP BY PV-ROWS-PER-PAGE.                     33610000
303100/                                                                 33620000
303200 4020-COMPUTE-CNTL-NBR-CKDGT.                                     33630000
303300     SET PV-DIGIT-IDX TO +13.                                     33640000
303400     MOVE TL3-SORT-CONTROL-NBR TO PV-CNTL-NBR-X.                  33650000
303500                                                                  33660000
303600     PERFORM                                                      33670000
303700         UNTIL PV-DIGIT-IDX = ZERO                                33680000
303800         COMPUTE PV-CNTL-NBR-PRODUCT =                            33690000
303900             PV-CNTL-NBR-DIGIT (PV-DIGIT-IDX) * 2                 33700000
304000         COMPUTE PV-CHECK-SUM =                                   33710000
304100             PV-CHECK-SUM + (PV-PRODUCT-DIGIT (1) +               33720000
304200                             PV-PRODUCT-DIGIT (2))                33730000
304300         SET PV-DIGIT-IDX DOWN BY 1                               33740000
304400         IF PV-DIGIT-IDX NOT = ZERO                               33750000
304500             COMPUTE PV-CHECK-SUM =                               33760000
304600                 PV-CHECK-SUM + PV-CNTL-NBR-DIGIT (PV-DIGIT-IDX)  33770000
304700             SET PV-DIGIT-IDX DOWN BY 1                           33780000
304800         END-IF                                                   33790000
304900     END-PERFORM.                                                 33800000
305000                                                                  33810000
305100     COMPUTE PV-CHECK-DIGIT = 10 - PV-CKSUM-LEAST-SIGNIFICANT-DGT.33820000
305200     MOVE PV-CHECK-DIGIT TO TL3-SORT-CHKDGT                       33830000
305300                            TL4-SORT-CHKDGT                       33840000
305400     INITIALIZE PV-CHECK-SUM.                                     33850000
305500*                                                                 33860000
305600 4030-FILL-RTV-LNE.                                               33870000
305700     IF RA-CLOSED-IND (1) = '*'                                   33880000
305800         MOVE ALL '*' TO  DL2-STORE-DETAIL (1)                    33890000
305900     ELSE                                                         33900000
306000         MOVE SPACES  TO  DL2-STORE-DETAIL (1)                    33910000
306100     END-IF.                                                      33920000
306200                                                                  33930000
306300     MOVE RA-STR-NBR (1)                                          33940000
306400         TO  DL2-STR-NBR (1).                                     33950000
306500     MOVE RA-CHAR5-ABBR-NAME (1)                                  33960000
306600         TO  DL2-CHAR5-ABBR-NAME (1).                             33970000
306700     DIVIDE RA-EXPTED-ITM-CNT (1)                                 33980000
306800         BY RC806-RC-RATIO (RC806-DRIVER-LNE-SUB)                 33990000
306900         GIVING DL2-EXPTED-PACK-CNT (1).                          34000000
307000             INITIALIZE PV-EXPTED-PACK-CNT-NUM                    34010000
307100             MOVE DL2-EXPTED-PACK-CNT (1)                         34020000
307200               TO PV-EXPTED-PACK-CNT-NUM                          34030000
307300              ADD PV-EXPTED-PACK-CNT-NUM                          34040000
307400               TO PV-EXPTED-PACK-CNT-SUM-TOT                      34050000
307500     MOVE RA-DIFF-OPER-UNT-ID (1)                                 34060000
307600         TO  DL2-DIFF-OPER-UNIT (1).                              34070000
307700     DIVIDE RA-ITEMS-OPEN-TO-RECEIVE (1)                          34080000
307800         BY RC806-RC-RATIO (RC806-DRIVER-LNE-SUB)                 34090000
307900         GIVING DL2-PACKS-OPEN-TO-RECEIVE (1).                    34100000
308000                                                                  34110000
308100     IF RA-CLOSED-IND (2) = '*'                                   34120000
308200         MOVE ALL '*' TO  DL2-STORE-DETAIL (2)                    34130000
308300     ELSE                                                         34140000
308400         MOVE SPACES  TO  DL2-STORE-DETAIL (2)                    34150000
308500     END-IF.                                                      34160000
308600                                                                  34170000
308700     IF RA-STR-NBR (2) = ZEROS                                    34180000
308800         CONTINUE                                                 34190000
308900     ELSE                                                         34200000
309000         MOVE RA-STR-NBR (2)                                      34210000
309100             TO  DL2-STR-NBR (2)                                  34220000
309200         MOVE RA-CHAR5-ABBR-NAME (2)                              34230000
309300             TO  DL2-CHAR5-ABBR-NAME (2)                          34240000
309400         DIVIDE RA-EXPTED-ITM-CNT (2)                             34250000
309500             BY RC806-RC-RATIO (RC806-DRIVER-LNE-SUB)             34260000
309600             GIVING DL2-EXPTED-PACK-CNT (2)                       34270000
309700             INITIALIZE PV-EXPTED-PACK-CNT-NUM                    34280000
309800             MOVE DL2-EXPTED-PACK-CNT (2)                         34290000
309900               TO PV-EXPTED-PACK-CNT-NUM                          34300000
310000              ADD PV-EXPTED-PACK-CNT-NUM                          34310000
310100               TO PV-EXPTED-PACK-CNT-SUM-TOT                      34320000
310200         MOVE RA-DIFF-OPER-UNT-ID (2)                             34330000
310300             TO  DL2-DIFF-OPER-UNIT (2)                           34340000
310400         DIVIDE RA-ITEMS-OPEN-TO-RECEIVE (2)                      34350000
310500             BY RC806-RC-RATIO (RC806-DRIVER-LNE-SUB)             34360000
310600             GIVING DL2-PACKS-OPEN-TO-RECEIVE (2)                 34370000
310700     END-IF.                                                      34380000
310800                                                                  34390000
310900     IF RA-CLOSED-IND (3) = '*'                                   34400000
311000         MOVE ALL '*' TO  DL2-STORE-DETAIL (3)                    34410000
311100     ELSE                                                         34420000
311200         MOVE SPACES  TO  DL2-STORE-DETAIL (3)                    34430000
311300     END-IF.                                                      34440000
311400                                                                  34450000
311500     IF RA-STR-NBR (3) = ZEROS                                    34460000
311600         CONTINUE                                                 34470000
311700     ELSE                                                         34480000
311800         MOVE RA-STR-NBR (3)                                      34490000
311900             TO  DL2-STR-NBR (3)                                  34500000
312000         MOVE RA-CHAR5-ABBR-NAME (3)                              34510000
312100             TO  DL2-CHAR5-ABBR-NAME (3)                          34520000
312200             DIVIDE RA-EXPTED-ITM-CNT (3)                         34530000
312300                 BY RC806-RC-RATIO (RC806-DRIVER-LNE-SUB)         34540000
312400                 GIVING DL2-EXPTED-PACK-CNT (3)                   34550000
312500             INITIALIZE PV-EXPTED-PACK-CNT-NUM                    34560000
312600             MOVE DL2-EXPTED-PACK-CNT (3)                         34570000
312700               TO PV-EXPTED-PACK-CNT-NUM                          34580000
312800              ADD PV-EXPTED-PACK-CNT-NUM                          34590000
312900               TO PV-EXPTED-PACK-CNT-SUM-TOT                      34600000
313000             MOVE RA-DIFF-OPER-UNT-ID (3)                         34610000
313100                 TO  DL2-DIFF-OPER-UNIT (3)                       34620000
313200             DIVIDE RA-ITEMS-OPEN-TO-RECEIVE (3)                  34630000
313300                 BY RC806-RC-RATIO (RC806-DRIVER-LNE-SUB)         34640000
313400                 GIVING DL2-PACKS-OPEN-TO-RECEIVE (3)             34650000
313500     END-IF.                                                      34660000
313600                                                                  34670000
313700 4040-COUNT-RTV-DISTROS.                                          34680002
313800                                                                  34690000
313900     MOVE ZERO TO PV-COUNT.                                       34700000
314000                                                                  34710000
314100     EXEC SQL                                                     34720000
314200          SELECT  COUNT(*)                                        34730000
314300            INTO  :PV-COUNT                                       34740000
314400            FROM  TRECDIS A                                       34750000
314500                , XLT_LOC B                                       34760000
314600           WHERE A.ORD_NBR           =  :DK-ORD-NBR               34770000
314700             AND A.ORD_LNE_NBR       =  :DK-ORD-LNE-NBR           34780000
314800             AND A.REC_SEQ_NBR       =  :DK-RCVR-SEQ-NBR          34790000
314900             AND A.OPER_UNT_ID       =  :DK-OPER-UNT-ID           34800000
315000             AND A.FCLTY_ID          =  :DK-FCLTY-ID              34810000
315200             AND A.EXPTED_ITM_QTY    >  :PC-ZERO                  34830000
315300             AND A.STR_NBR           =  B.LOC_NBR                 34840000
315400             AND B.LOC_TYP_CDE     IN (:PC-DC, :PC-RV)            34850000
315500     END-EXEC.                                                    34860000
315600                                                                  34870000
315700     EVALUATE TRUE                                                34880000
315800         WHEN SQLCODE = ZERO                                      34890000
315900             CONTINUE                                             34900000
316000         WHEN SQLWARN0 NOT = SPACE                                34910000
316100         WHEN SQLCODE < ZERO                                      34920000
316200         WHEN SQLCODE > ZERO                                      34930000
316300             MOVE '4040-COUNT-RTV-DISTROS'                        34940000
316400                 TO DP013-PARAGRAPH                               34950000
316500             MOVE 'SELECT A COUNT OR RTV DISTROS'                 34960000
316600                 TO DP013-MESSAGE-TEXT (1)                        34970000
316700             MOVE SQLCA            TO DP013-SQLCA                 34980000
316800             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    34990000
316900             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (2)    35000000
317000             SET DP013-DB2-ABEND   TO TRUE                        35010000
317100             SET DP013-NO-ROLLBACK TO TRUE                        35020000
317200             PERFORM 9999-WRITE-CICS-LOG-MSG                      35030000
317300             GO TO 0000-GOBACK                                    35040000
317400     END-EVALUATE.                                                35050000
317500                                                                  35060000
317600 4050-SELECT-PRIM-SHIP.                                           35070000
317700                                                                  35080000
317800     EXEC SQL                                                     35090000
317900         SELECT C.VEH_NBR                                         35100000
318000               ,B.PRO_SCAC_ID                                     35110000
318100               ,B.PRO_NBR                                         35120000
318200               ,B.BOL_NBR                                         35130000
318300               ,C.TRIP_ID                                         35140000
318400          INTO  :VHTRIP-VEH-NBR :PV-NULL-IND                      35150000
318500               ,:SHIPMT-PRO-SCAC-ID                               35160000
318600               ,:SHIPMT-PRO-NBR                                   35170000
318700               ,:SHIPMT-BOL-NBR                                   35180000
318800               ,:VHTRIP-TRIP-ID                                   35190000
318900           FROM TSHPTPO A                                         35200000
319000              , TSHIPMT B                                         35210000
319100              , TVHTRIP C                                         35220000
319200          WHERE A.PO_NBR         = :DK-ORD-NBR                    35230000
319300            AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               35240000
319400            AND A.SHIPT_ID       = B.SHIPT_ID                     35250000
319500            AND B.TRIP_ID        = C.TRIP_ID                      35260000
319600            AND A.PRIM_SHIPT_IND = :PC-Y                          35270000
319700     END-EXEC.                                                    35280000
319800                                                                  35290000
319900     EVALUATE TRUE                                                35300000
320000         WHEN SQLCODE = ZERO                                      35310000
320100             MOVE SHIPMT-PRO-NBR     TO HL4-FOB                   35320000
320200             MOVE SHIPMT-BOL-NBR     TO HL3-BOL                   35330000
320300             MOVE SHIPMT-PRO-SCAC-ID TO HL7-SCAC                  35340000
320400             IF PV-NULL-IND = -1                                  35350000
320500                 MOVE SPACES         TO HL6-TRAILER               35360000
320600             ELSE                                                 35370000
320700                 MOVE VHTRIP-VEH-NBR TO HL6-TRAILER               35380000
320800             END-IF                                               35390000
320900             MOVE VHTRIP-TRIP-ID     TO HL5-TRIP-ID               35400000
321000         WHEN SQLCODE = PC-ROW-NOT-FOUND                          35410000
321100             MOVE SPACES             TO HL4-FOB                   35420000
321200                                        HL3-BOL                   35430000
321300                                        HL6-TRAILER               35440000
321400                                        HL7-SCAC                  35450000
321500             MOVE ZEROES             TO HL5-TRIP-ID               35460000
321600             CONTINUE                                             35470000
321700         WHEN SQLWARN0 NOT = SPACE                                35480000
321800         WHEN SQLCODE < ZERO                                      35490000
321900         WHEN SQLCODE > ZERO                                      35500000
322000             MOVE '4050-SELECT-PRIM-SHIP '                        35510000
322100                 TO DP013-PARAGRAPH                               35520000
322200             MOVE 'ATTEMPTING TO SELECT TRIP ID  '                35530000
322300                 TO DP013-MESSAGE-TEXT (1)                        35540000
322400             MOVE SQLCA            TO DP013-SQLCA                 35550000
322500             MOVE 'TVHTRIP'        TO DP013-DB2-TABLE-NAME (1)    35560000
322600             SET DP013-DB2-ABEND   TO TRUE                        35570000
322700             SET DP013-NO-ROLLBACK TO TRUE                        35580000
322800             PERFORM 9999-WRITE-CICS-LOG-MSG                      35590000
322900             GO TO 0000-GOBACK                                    35600000
323000     END-EVALUATE.                                                35610000
323100                                                                  35620000
323200 4060-REPORT-HEADINGS.                                            35630000
323300                                                                  35640000
323400     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         35650000
323500                                                                  35660000
323600     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           35670000
323700     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             35680000
323800     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            35690000
323900     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            35700000
324000     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          35710000
324100                                                                  35720000
324200     IF PS-YES-TRECITM                                            35730000
324300         IF RECITM-MKING-APRON-TMST NOT = PC-DB2-DUMMY-DATE-TIME  35740000
324400             MOVE RL1-REPRINT-LINE-1 TO  DRS01-COMM-DATA          35750000
324500             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           35760000
324600             PERFORM 8000-LINK-TO-DRS                             35770000
324700             SET PS-TOP-OF-PAGE-SET  TO TRUE                      35780000
324800         ELSE                                                     35790000
324900             CONTINUE                                             35800000
325000     ELSE                                                         35810000
325100         INITIALIZE DRS01-COMM-DATA                               35820000
325200         STRING                                                   35830000
325300         'MARKING APRON COULD NOT BE PRINTED BECAUSE '            35840000
325400         'NO PACKSLIP DRIVER LINE WAS FOUND.'                     35850000
325500             DELIMITED BY SIZE INTO DRS01-COMM-DATA               35860000
325600             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           35870000
325700             PERFORM 8000-LINK-TO-DRS                             35880000
325800             SET PS-TOP-OF-PAGE-SET TO TRUE                       35890000
325900     END-IF.                                                      35900000
326000                                                                  35910000
326100     IF PV-COUNT > 0                                              35920000
326200         MOVE RT1-RTV-DISTRO-LINE-1 TO  DRS01-COMM-DATA           35930000
326300         IF PS-TOP-OF-PAGE-SET                                    35940000
326400             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           35950000
326500         ELSE                                                     35960000
326600             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           35970000
326700         END-IF                                                   35980000
326800         PERFORM 8000-LINK-TO-DRS                                 35990000
326900         SET PS-TOP-OF-PAGE-SET TO TRUE                           36000000
327000     END-IF.                                                      36010000
327100                                                                  36020000
327200     IF TL2-TRBL-DESC (1) NOT = SPACES                            36030000
327300         MOVE TL1-TROUBLE-LINE-1     TO  DRS01-COMM-DATA          36040000
327400         IF PS-TOP-OF-PAGE-SET                                    36050000
327500             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           36060000
327600         ELSE                                                     36070000
327700             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           36080000
327800         END-IF                                                   36090000
327900         PERFORM 8000-LINK-TO-DRS                                 36100000
328000         MOVE TL2-TROUBLE-LINE-2     TO  DRS01-COMM-DATA          36110000
328100         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           36120000
328200         PERFORM 8000-LINK-TO-DRS                                 36130000
328300         SET PS-TOP-OF-PAGE-SET TO TRUE                           36140000
328400     END-IF.                                                      36150000
328500                                                                  36160000
328600     IF PS-PRINT-STORE-PROBLEM                                    36170000
328700         MOVE DH4-STORE-PROBLEM-LINE     TO  DRS01-COMM-DATA      36180000
328800         IF PS-TOP-OF-PAGE-SET                                    36190000
328900             MOVE PC-DOUBLE-SPACE    TO  DRS01-COMM-CTL           36200000
329000         ELSE                                                     36210000
329100             MOVE PC-TOP-OF-PAGE     TO  DRS01-COMM-CTL           36220000
329200         END-IF                                                   36230000
329300         PERFORM 8000-LINK-TO-DRS                                 36240000
329400         SET PS-TOP-OF-PAGE-SET TO TRUE                           36250000
329500     END-IF.                                                      36260000
329600                                                                  36270000
329700     MOVE PS-PAGE-SUB                TO  HL1-PGE-NBR.             36280000
329800     MOVE PV-TOTAL-PAGES             TO  HL1-OF-PGE-NBR.          36290000
329900     MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA.         36300000
330000     IF PS-TOP-OF-PAGE-SET                                        36310000
330100         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           36320000
330200     ELSE                                                         36330000
330300         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL           36340000
330400     END-IF.                                                      36350000
330500     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          36360000
330600     PERFORM 8000-LINK-TO-DRS.                                    36370000
330700                                                                  36380000
330800     MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA.         36390000
330900     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          36400000
331000     PERFORM 8000-LINK-TO-DRS.                                    36410000
331100                                                                  36420000
331200     MOVE CA-PREPARER-USER-ID        TO  HL9-PREPARER-USER-ID.    36430000
331300     MOVE CA-DESTINATION             TO  HL9-PRINTER-DEST.        36440000
331400     MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA.         36450000
331500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36460000
331600     PERFORM 8000-LINK-TO-DRS.                                    36470000
331700                                                                  36480000
331800     MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA.         36490000
331900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36500000
332000     PERFORM 8000-LINK-TO-DRS.                                    36510000
332100                                                                  36520000
332200     MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA.         36530000
332300     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36540000
332400     PERFORM 8000-LINK-TO-DRS.                                    36550000
332500                                                                  36560000
332600     MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA.         36570000
332700     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36580000
332800     PERFORM 8000-LINK-TO-DRS.                                    36590000
332900                                                                  36600000
333000     MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA.         36610000
333100     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36620000
333200     PERFORM 8000-LINK-TO-DRS.                                    36630000
333300                                                                  36640000
333400     MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA.         36650000
333500     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36660000
333600     PERFORM 8000-LINK-TO-DRS.                                    36670000
333700                                                                  36680000
333800     MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA.         36690000
333900     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36700000
334000     PERFORM 8000-LINK-TO-DRS.                                    36710000
334100     MOVE DASHES-LINE                TO  DRS01-COMM-DATA.         36720000
334200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          36730000
334300     PERFORM 8000-LINK-TO-DRS.                                    36740000
334400     EVALUATE TRUE                                                36750000
334500     WHEN PS-PRINT-ITEM-DETAIL                                    36760000
334600         MOVE DH1-DETAIL-HEADING-LINE-1 TO  DRS01-COMM-DATA       36770000
334700         MOVE PC-SINGLE-SPACE           TO  DRS01-COMM-CTL        36780000
334800         PERFORM 8000-LINK-TO-DRS                                 36790000
334900         MOVE DH2-DETAIL-HEADING-LINE-2 TO  DRS01-COMM-DATA       36800000
335000         MOVE PC-SINGLE-SPACE           TO  DRS01-COMM-CTL        36810000
335100         PERFORM 8000-LINK-TO-DRS                                 36820000
335200     WHEN PS-PRINT-STORE-WORKAREA                                 36830000
335300         PERFORM 4062-STORE-WORKAREA-HDR                          36840000
335400     WHEN OTHER                                                   36850000
335500         MOVE DH3-DETAIL-HEADING-LINE-1 TO  DRS01-COMM-DATA       36860000
335600         MOVE PC-SINGLE-SPACE           TO  DRS01-COMM-CTL        36870000
335700         PERFORM 8000-LINK-TO-DRS                                 36880000
335800         MOVE DH4-DETAIL-HEADING-LINE-2 TO  DRS01-COMM-DATA       36890000
335900         MOVE PC-SINGLE-SPACE           TO  DRS01-COMM-CTL        36900000
336000         PERFORM 8000-LINK-TO-DRS                                 36910000
336100         IF PS-PAGE-SUB > PC-ONE                                  36920000
336200             MOVE ZERO                  TO PV-LINES-USED          36930000
336300             MOVE PV-LINES-AVAILABLE    TO PV-ROWS-PER-PAGE       36940000
336400             IF PS-PAGE-SUB = PV-PAGES-REQ                        36950000
336500                 SUBTRACT PV-END-OF-APRON-LINES-REQD              36960000
336600                     FROM PV-ROWS-PER-PAGE                        36970000
336700                 IF PS-PRINT-NO-DISTRO-MSG                        36980000
336800                     SUBTRACT PC-2 FROM PV-ROWS-PER-PAGE          36990000
336900                 END-IF                                           37000000
337000             END-IF                                               37010000
337100         END-IF                                                   37020000
337200     END-EVALUATE.                                                37030000
337300*                                                                 37040000
337400 4062-STORE-WORKAREA-HDR.                                         37050000
337500     MOVE OUW-LINE1                 TO  DRS01-COMM-DATA           37060000
337600     MOVE PC-SINGLE-SPACE           TO  DRS01-COMM-CTL            37070000
337700     PERFORM 8000-LINK-TO-DRS                                     37080000
337800     MOVE DASHES-LINE               TO  DRS01-COMM-DATA           37090000
337900     PERFORM 8000-LINK-TO-DRS                                     37100000
338000     MOVE OUW-LINE2                 TO  DRS01-COMM-DATA           37110000
338100     PERFORM 8000-LINK-TO-DRS                                     37120000
338200     MOVE SPACES                    TO  OUW-STR-NBR-AREA          37130000
338300     MOVE OUW-VERTICAL-BAR-LINE     TO  OUW-STR-ALLOC-AREA        37140000
338400     MOVE OUW-LINE7                 TO  DRS01-COMM-DATA           37150000
338500     PERFORM 8000-LINK-TO-DRS                                     37160000
338600     MOVE OUW-LINE3                 TO  DRS01-COMM-DATA           37170000
338700     PERFORM 8000-LINK-TO-DRS                                     37180000
338800     MOVE SPACES                    TO  OUW-STR-NBR-AREA          37190000
338900     MOVE OUW-VERTICAL-BAR-LINE     TO  OUW-STR-ALLOC-AREA        37200000
339000     MOVE OUW-LINE7                 TO  DRS01-COMM-DATA           37210000
339100     PERFORM 8000-LINK-TO-DRS                                     37220000
339200     MOVE OUW-LINE4                 TO  DRS01-COMM-DATA           37230000
339300     PERFORM 8000-LINK-TO-DRS                                     37240000
339400     MOVE SPACES                    TO  OUW-STR-NBR-AREA          37250000
339500     MOVE OUW-VERTICAL-BAR-LINE     TO  OUW-STR-ALLOC-AREA        37260000
339600     MOVE OUW-LINE7                 TO  DRS01-COMM-DATA           37270000
339700     PERFORM 8000-LINK-TO-DRS                                     37280000
339800     MOVE OUW-LINE5                 TO  DRS01-COMM-DATA           37290000
339900     PERFORM 8000-LINK-TO-DRS                                     37300000
340000     MOVE SPACES                    TO  OUW-STR-NBR-AREA          37310000
340100     MOVE OUW-VERTICAL-BAR-LINE     TO  OUW-STR-ALLOC-AREA        37320000
340200     MOVE OUW-LINE7                 TO  DRS01-COMM-DATA           37330000
340300     PERFORM 8000-LINK-TO-DRS                                     37340000
340400     MOVE OUW-LINE6                 TO  DRS01-COMM-DATA           37350000
340500     PERFORM 8000-LINK-TO-DRS                                     37360000
340600     MOVE ALL '-'                   TO  OUW-STR-NBR-AREA          37370000
340700     MOVE OUW-VERTICAL-BAR-LINE     TO  OUW-STR-ALLOC-AREA        37380000
340800     MOVE OUW-LINE7                 TO  DRS01-COMM-DATA           37390000
340900     MOVE PC-SINGLE-SPACE           TO  DRS01-COMM-CTL            37400000
341000     PERFORM 8000-LINK-TO-DRS                                     37410000
341100     MOVE PC-STORE-NBR-LIT          TO  OUW-STR-NBR-AREA          37420000
341200     MOVE OUW-LINE7                 TO  DRS01-COMM-DATA           37430000
341300     PERFORM 8000-LINK-TO-DRS.                                    37440000
341400                                                                  37450000
341500*                                                                 40930000
341600 4200-CALC-OPEN-TO-REC.                                           40940000
341700                                                                  40950000
341800     SET DP277-STORE-LEVEL-OTR                                    40960000
341900         DP277-RECEIVER-OTR               TO TRUE                 40970000
342000                                                                  40980000
342100     INITIALIZE DP277-KEYS                                        40990000
342200     MOVE PV-DRIVER-LINE-NBR              TO DP277-PO-LNE-NBR     41000000
342300     MOVE PC016-PO-NBR-N (PC016-IDX)      TO DP277-PO-NBR         41010000
342400     MOVE PC016-PACK-ID (PC016-IDX)       TO DP277-PO-PREPK-ID    41020000
342500     MOVE PC016-REC-SEQ-NBR-N (PC016-IDX) TO DP277-REC-SEQ-NBR    41030000
342600     MOVE PV-OTR-DIST(PV-SAVE-OTR-IDX)    TO DP277-OPER-UNT-ID    41040000
342700     MOVE PC016-FCLTY-ID (PC016-IDX)      TO DP277-FCLTY-ID.      41050000
342800                                                                  41060000
342900     COPY DPPD277.                                                41070000
343000*                                                                 41080000
343100******************************************************************41090000
343200*GET THE LONG DESCRIPTION FOR ON THE MARKING APRON.               41100000
343300******************************************************************41110000
343400 4300-GET-TKT-DESC.                                               41120000
343500     INITIALIZE DCLTTKTFMT.                                       41130000
343600                                                                  41140000
343700     PERFORM                                                      41150000
343800         WITH TEST AFTER                                          41160000
343900         VARYING PV-SELECT-COUNTER                                41170000
344000         FROM 1 BY 1                                              41180000
344100         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              41190000
344200            OR  (SQLCODE = ZERO)                                  41200000
344300            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     41210000
344400      EXEC SQL                                                    41220000
344500          SELECT DISTINCT TKT_FMT_DESC                            41230000
344600                INTO :TKTFMT-TKT-FMT-DESC                         41240000
344700              FROM TTKTFMT                                        41250000
344800           WHERE                                                  41260000
344900              TKT_FMT_ID   = :DK-TKT-FMT-ID                       41270000
345000     END-EXEC                                                     41280000
345100                                                                  41290000
345200                                                                  41300000
345300         EVALUATE TRUE                                            41310000
345400             WHEN SQLCODE = ZERO                                  41320000
345500                 MOVE TKTFMT-TKT-FMT-DESC TO                      41330000
345600                                         HL5-TICKET-TYPE          41340000
345700             WHEN SQLCODE = -904                                  41350000
345800             WHEN SQLCODE = -913                                  41360000
345900                 CONTINUE                                         41370000
346000             WHEN SQLCODE = PC-ROW-NOT-FOUND                      41380000
346100                 MOVE SPACES    TO                                41390000
346200                                   HL5-TICKET-TYPE                41400000
346300             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           41410000
346400                 MOVE TKTFMT-TKT-FMT-DESC TO                      41420000
346500                                   HL5-TICKET-TYPE                41430000
346600             WHEN SQLWARN0 NOT = SPACES                           41440000
346700             WHEN SQLCODE < ZERO                                  41450000
346800             WHEN SQLCODE > ZERO                                  41460000
346900                  MOVE '4300-GET-TKT-DESC'                        41470000
347000                                 TO DP013-PARAGRAPH               41480000
347100                  MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'           41490000
347200                                 TO DP013-MESSAGE-TEXT (1)        41500000
347300                  MOVE DK-TKT-FMT-ID                              41510000
347400                                 TO DP013-MESSAGE-TEXT (2)        41520000
347500                  MOVE PV-DISPLAY-KEYS                            41530000
347600                                     TO DP013-MESSAGE-TEXT (2)    41540000
347700                  MOVE SQLCA         TO DP013-SQLCA               41550000
347800                  MOVE 'TTKTFMT'     TO DP013-DB2-TABLE-NAME (1)  41560000
347900                  SET DP013-DB2-ABEND                             41570000
348000                                     TO TRUE                      41580000
348100                  SET DP013-NO-ROLLBACK                           41590000
348200                                     TO TRUE                      41600000
348300                  PERFORM 9999-WRITE-CICS-LOG-MSG                 41610000
348400                  GO TO 0000-GOBACK                               41620000
348500         END-EVALUATE                                             41630000
348600     END-PERFORM.                                                 41640000
348700                                                                  41650000
348800     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    41660000
348900         MOVE '4300-GET-TKT-DESC'                                 41670000
349000                                     TO DP013-PARAGRAPH           41680000
349100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     41690000
349200                                     TO DP013-MESSAGE-TEXT (1)    41700000
349300         MOVE 'UNSUCCESSFUL SELECT OF TTKTFMT'                    41710000
349400                                 TO DP013-MESSAGE-TEXT (1)        41720000
349500         MOVE DK-TKT-FMT-ID                                       41730000
349600                                 TO DP013-MESSAGE-TEXT (2)        41740000
349700         MOVE SQLCA                  TO DP013-SQLCA               41750000
349800         MOVE 'TTKTFMT'              TO DP013-DB2-TABLE-NAME (1)  41760000
349900         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  41770000
350000         SET DP013-DB2-ABEND         TO TRUE                      41780000
350100         SET DP013-NO-ROLLBACK       TO TRUE                      41790000
350200         PERFORM 9999-WRITE-CICS-LOG-MSG                          41800000
350300         GO TO 0000-GOBACK                                        41810000
350400     END-IF.                                                      41820000
350500 EJECT                                                            41830000
350600                                                                  41840000
350700******************************************************************41850000
350800*GET THE LONG DESCRIPTION FOR ON THE MARKING APRON.               41860000
350900******************************************************************41870000
351000 4310-GET-TKT-PLACEMENT.                                          41880000
351100     INITIALIZE DCLTPTKREQ                                        41890000
351200                DCLTPTKLNE                                        41900000
351300                DCLTPLDESC.                                       41910000
351400                                                                  41920000
351500     PERFORM                                                      41930000
351600         WITH TEST AFTER                                          41940000
351700         VARYING PV-SELECT-COUNTER                                41950000
351800         FROM 1 BY 1                                              41960000
351900         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              41970000
352000            OR  (SQLCODE = ZERO)                                  41980000
352100            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     41990000
352200      EXEC SQL                                                    42000000
352300      SELECT                                                      42010000
352400              A.PO_NBR,                                           42020000
352500              A.PO_REQ_NBR,                                       42030000
352600              B.PO_LNE_NBR,                                       42040000
352700              B.TKT_PLCMNT_CDE,                                   42050000
352800              C.TKT_PLCMNT_DESC                                   42060000
352900         INTO  :PTKREQ-PO-NBR                                     42070000
353000             , :PTKREQ-PO-REQ-NBR                                 42080000
353100             , :PTKLNE-PO-LNE-NBR                                 42090000
353200             , :PTKLNE-TKT-PLCMNT-CDE                             42100000
353300             , :PLDESC-TKT-PLCMNT-DESC                            42110000
353400         FROM                                                     42120000
353500              TPTKREQ A                                           42130000
353600             ,TPTKLNE B                                           42140000
353700             ,TPLDESC C                                           42150000
353800         WHERE  A.PO_NBR = :DK-ORD-NBR                            42160000
353900           AND  B.PO_LNE_NBR =  :DK-ORD-LNE-NBR                   42170000
354000           AND  A.PO_REQ_NBR = B.PO_REQ_NBR                       42180000
354100           AND  B.TKT_PLCMNT_CDE = C.TKT_PLCMNT_CDE               42190000
354200     END-EXEC                                                     42200000
354300                                                                  42210000
354400                                                                  42220000
354500         EVALUATE TRUE                                            42230000
354600             WHEN SQLCODE = ZERO                                  42240000
354700                 MOVE PLDESC-TKT-PLCMNT-DESC TO                   42250000
354800                      HL6-TICKET-PLACEMENT                        42260000
354900             WHEN SQLCODE = -904                                  42270000
355000             WHEN SQLCODE = -913                                  42280000
355100                 CONTINUE                                         42290000
355200             WHEN SQLCODE = PC-ROW-NOT-FOUND                      42300000
355300                 MOVE SPACES TO  HL6-TICKET-PLACEMENT             42310000
355400             WHEN SQLCODE = PC-MULTIPLE-RESULT-SET-ROWS           42320000
355500                 MOVE PLDESC-TKT-PLCMNT-DESC TO                   42330000
355600                                         HL6-TICKET-PLACEMENT     42340000
355700             WHEN SQLWARN0 NOT = SPACES                           42350000
355800             WHEN SQLCODE < ZERO                                  42360000
355900             WHEN SQLCODE > ZERO                                  42370000
356000                  MOVE '4310-GET-TKT-PLACEMENT'                   42380000
356100                                 TO DP013-PARAGRAPH               42390000
356200                  MOVE 'UNSUCCESSFUL SELECT OF PLACMNT'           42400000
356300                                 TO DP013-MESSAGE-TEXT (1)        42410000
356400                  MOVE DK-ORD-NBR                                 42420000
356500                                 TO DP013-MESSAGE-TEXT (2)        42430000
356600                  MOVE SQLCA         TO DP013-SQLCA               42440000
356700                  MOVE 'TPTKREQ'     TO DP013-DB2-TABLE-NAME (1)  42450000
356800                  MOVE 'TPTKLNE'     TO DP013-DB2-TABLE-NAME (2)  42460000
356900                  MOVE 'TPLDESC'     TO DP013-DB2-TABLE-NAME (3)  42470000
357000                  SET DP013-DB2-ABEND                             42480000
357100                                     TO TRUE                      42490000
357200                  SET DP013-NO-ROLLBACK                           42500000
357300                                     TO TRUE                      42510000
357400                  PERFORM 9999-WRITE-CICS-LOG-MSG                 42520000
357500                  GO TO 0000-GOBACK                               42530000
357600         END-EVALUATE                                             42540000
357700     END-PERFORM.                                                 42550000
357800                                                                  42560000
357900     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    42570000
358000         MOVE '4310-GET-TKT-PLACEMENT'                            42580000
358100                                     TO DP013-PARAGRAPH           42590000
358200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     42600000
358300                                     TO DP013-MESSAGE-TEXT (1)    42610000
358400         MOVE 'UNSUCCESSFUL SELECT OF TPLDESC'                    42620000
358500                                 TO DP013-MESSAGE-TEXT (1)        42630000
358600         MOVE DK-ORD-NBR                                          42640000
358700                                 TO DP013-MESSAGE-TEXT (2)        42650000
358800         MOVE SQLCA                  TO DP013-SQLCA               42660000
358900         MOVE 'TPTKREQ'              TO DP013-DB2-TABLE-NAME (1)  42670000
359000         MOVE 'TPTKLNE'              TO DP013-DB2-TABLE-NAME (2)  42680000
359100         MOVE 'TPLDESC'              TO DP013-DB2-TABLE-NAME (3)  42690000
359200         SET DP013-DB2-ABEND         TO TRUE                      42700000
359300         SET DP013-NO-ROLLBACK       TO TRUE                      42710000
359400         PERFORM 9999-WRITE-CICS-LOG-MSG                          42720000
359500         GO TO 0000-GOBACK                                        42730000
359600     END-IF.                                                      42740000
359700 EJECT                                                            42750000
359800 7000-OPEN-STR-NBR-CSR.                                           42760000
359900     EXEC SQL                                                     42770000
360000         OPEN STR-NBR-CSR                                         42780000
360100     END-EXEC.                                                    42790000
360200                                                                  42800000
360300     EVALUATE TRUE                                                42810000
360400         WHEN SQLCODE = ZERO                                      42820000
360500             CONTINUE                                             42830000
360600         WHEN SQLWARN0 NOT = SPACE                                42840000
360700         WHEN SQLCODE < ZERO                                      42850000
360800         WHEN SQLCODE > ZERO                                      42860000
360900             MOVE '7000-OPEN-STR-NBR-CSR'                         42870000
361000                 TO DP013-PARAGRAPH                               42880000
361100             MOVE 'OPEN THE STR-NBR-CSR'                          42890000
361200                 TO DP013-MESSAGE-TEXT (1)                        42900000
361300             MOVE SQLCA              TO DP013-SQLCA               42910000
361400             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  42921000
361500             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  42922000
361600             SET DP013-DB2-ABEND     TO TRUE                      42930000
361700             SET DP013-NO-ROLLBACK   TO TRUE                      42940000
361800             PERFORM 9999-WRITE-CICS-LOG-MSG                      42950000
361900             GO TO 0000-GOBACK                                    42960000
362000     END-EVALUATE.                                                42970000
362100*                                                                 42980000
362200     SKIP3                                                        42990000
362300 7010-FETCH-STR-NBR-CSR.                                          43000000
362400                                                                  43020000
362500     EXEC SQL                                                     43030000
362600         FETCH  STR-NBR-CSR                                       43040000
362700          INTO  :XLT00010-LOC-NBR                                 43042000
362800             ,  :XLT00010-LOC-5-ABBR-NM                           43043000
362900             ,  :XLT00010-CLO-DTE                                 43044000
363000             ,  :PV-EFF-CLOSE-DATE                                43045000
363100             ,  :XLT00014-EFF-BEG-DTE                             43046000
363200             ,  :XLT00014-DC-NBR                                  43047000
363300     END-EXEC.                                                    43130000
363400                                                                  43140000
363500     EVALUATE TRUE                                                43150000
363600         WHEN SQLCODE = ZERO                                      43160000
363700* * PV-EFF-CLOSE-DATE IS CALCULATED IN THE DECLARE, BUT           43161000
363800* * THERE IS NO CHECK TO SEE IF THE STORE IS CLOSED OR NOT        43162000
363900             IF XLT00010-CLO-DTE = '9999-09-99'                   43163000
364000                 MOVE '9999-09-09'   TO PV-EFF-CLOSE-DATE         43164000
364100             END-IF                                               43165000
364200         WHEN SQLCODE = PC-ROW-NOT-FOUND                          43170000
364300             CONTINUE                                             43180000
364400         WHEN SQLWARN0 NOT = SPACE                                43190000
364500         WHEN SQLCODE < ZERO                                      43200000
364600         WHEN SQLCODE > ZERO                                      43210000
364700             MOVE '7010-FETCH-STR-NBR-CSR'                        43220000
364800                 TO DP013-PARAGRAPH                               43230000
364900             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 43240000
365000-                 'FROM THE STR-NBR-CSR'                          43250000
365100                 TO DP013-MESSAGE-TEXT (1)                        43260000
365200             MOVE SQLCA              TO DP013-SQLCA               43270000
365300             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  43271000
365400             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  43272000
365500             SET DP013-DB2-ABEND     TO TRUE                      43290000
365600             SET DP013-NO-ROLLBACK   TO TRUE                      43300000
365700             PERFORM 9999-WRITE-CICS-LOG-MSG                      43310000
365800             GO TO 0000-GOBACK                                    43320000
365900     END-EVALUATE.                                                43330000
366000     SKIP3                                                        43340000
366100 7020-CLOSE-STR-NBR-CSR.                                          43350000
366200     EXEC SQL                                                     43360000
366300         CLOSE STR-NBR-CSR                                        43370000
366400     END-EXEC.                                                    43380000
366500                                                                  43390000
366600     EVALUATE TRUE                                                43400000
366700         WHEN SQLCODE = ZERO                                      43410000
366800             CONTINUE                                             43420000
366900         WHEN SQLWARN0 NOT = SPACE                                43430000
367000         WHEN SQLCODE < ZERO                                      43440000
367100         WHEN SQLCODE > ZERO                                      43450000
367200             MOVE '7020-CLOSE-STR-NBR-CSR'                        43460000
367300                 TO DP013-PARAGRAPH                               43470000
367400             MOVE 'CLOSE THE STR-NBR-CSR'                         43480000
367500                 TO DP013-MESSAGE-TEXT (1)                        43490000
367600             MOVE SQLCA              TO DP013-SQLCA               43500000
367700             MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)  43511000
367800             MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)  43512000
367900             SET DP013-DB2-ABEND     TO TRUE                      43520000
368000             SET DP013-NO-ROLLBACK   TO TRUE                      43530000
368100             PERFORM 9999-WRITE-CICS-LOG-MSG                      43540000
368200             GO TO 0000-GOBACK                                    43550000
368300     END-EVALUATE.                                                43560000
368400 EJECT                                                            43570000
368500 7100-SELECT-PO-HDR-DATA.                                         43580000
368600     INITIALIZE DCLTPURCHS                                        43590000
368700                DCLTSTATCD.                                       43600000
368800                                                                  43610000
368900     PERFORM                                                      43620000
369000         WITH TEST AFTER                                          43630000
369100         VARYING PV-SELECT-COUNTER                                43640000
369200         FROM 1 BY 1                                              43650000
369300         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              43660000
369400            OR  (SQLCODE = ZERO)                                  43670000
369500            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     43680000
369600                                                                  43690000
369700         EXEC SQL                                                 43700000
369800             SELECT  A.ENT_ID                                     43710000
369900                   , A.DEPT_NBR                                   43720000
370000                   , A.SEASET_SHRT_NM                             43730000
370100               INTO  :PURCHS-ENT-ID                               43740000
370200                   , :PURCHS-DEPT-NBR                             43750000
370300                   , :PURCHS-SEASET-SHRT-NM                       43760000
370400               FROM  TPURCHS A,                                   43770000
370500                     TSTATCD B                                    43780000
370600              WHERE  A.PO_NBR          =  :DK-ORD-NBR             43790000
370700                AND  A.VER_STATUS_CDE  =  'A'                     43800000
370800                AND  B.STATUS_TYP_CDE  =  'P'                     43810000
370900                AND  B.STATUS_CLS      IN ('ACT', 'CMP')          43820000
371000                AND  A.STATUS_CDE      =  B.STATUS_CDE            43830000
371100         END-EXEC                                                 43840000
371200                                                                  43850000
371300         EVALUATE TRUE                                            43860000
371400             WHEN SQLCODE = ZERO                                  43870000
371500             WHEN SQLCODE = -904                                  43880000
371600             WHEN SQLCODE = -913                                  43890000
371700             WHEN SQLCODE = PC-ROW-NOT-FOUND                      43900000
371800                  CONTINUE                                        43910000
371900             WHEN SQLWARN0 NOT = SPACES                           43920000
372000             WHEN SQLCODE < ZERO                                  43930000
372100             WHEN SQLCODE > ZERO                                  43940000
372200                  MOVE '7100-SELECT-PO-HDR-DATA'                  43950000
372300                                     TO DP013-PARAGRAPH           43960000
372400                  MOVE 'SELECT INFO FOR THE FOLLOWING RECEIVER: ' 43970000
372500                                     TO DP013-MESSAGE-TEXT (1)    43980000
372600                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       43990000
372700                  MOVE ZEROES        TO  PV-DISPLAY-ORD-LNE-NBR   44000000
372800                  MOVE PV-DISPLAY-KEYS                            44010000
372900                                     TO DP013-MESSAGE-TEXT (2)    44020000
373000                  MOVE SQLCA         TO DP013-SQLCA               44030000
373100                  MOVE 'TPURCHS'     TO DP013-DB2-TABLE-NAME (1)  44040000
373200                  MOVE 'TSTATCD'     TO DP013-DB2-TABLE-NAME (2)  44050000
373300                  SET DP013-DB2-ABEND                             44060000
373400                                     TO TRUE                      44070000
373500                  SET DP013-NO-ROLLBACK                           44080000
373600                                     TO TRUE                      44090000
373700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 44100000
373800                  GO TO 0000-GOBACK                               44110000
373900         END-EVALUATE                                             44120000
374000     END-PERFORM.                                                 44130000
374100                                                                  44140000
374200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    44150000
374300         MOVE '7100-SELECT-PO-HDR-DATA' TO DP013-PARAGRAPH        44160000
374400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     44170000
374500                                     TO DP013-MESSAGE-TEXT (1)    44180000
374600         MOVE 'THE FOLLOWING RECEIVER: '                          44190000
374700                                     TO DP013-MESSAGE-TEXT (2)    44200000
374800         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       44210000
374900         MOVE ZERO                   TO  PV-DISPLAY-ORD-LNE-NBR   44220000
375000         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    44230000
375100         MOVE SQLCA                  TO DP013-SQLCA               44240000
375200         MOVE 'TPURCHS'              TO DP013-DB2-TABLE-NAME (1)  44250000
375300         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (2)  44260000
375400         MOVE 'TSTATCD'              TO DP013-DB2-TABLE-NAME (3)  44270000
375500         SET DP013-DB2-ABEND         TO TRUE                      44280000
375600         SET DP013-NO-ROLLBACK       TO TRUE                      44290000
375700         PERFORM 9999-WRITE-CICS-LOG-MSG                          44300000
375800         GO TO 0000-GOBACK                                        44310000
375900     END-IF.                                                      44320000
376000     EJECT                                                        44330000
376100 7110-GET-TRECEIV-DATA.                                           44340000
376200     INITIALIZE DCLTRECEIV.                                       44350000
376300                                                                  44360000
376400     PERFORM                                                      44370000
376500         WITH TEST AFTER                                          44380000
376600         VARYING PV-SELECT-COUNTER                                44390000
376700         FROM 1 BY 1                                              44400000
376800         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              44410000
376900            OR  (SQLCODE = ZERO)                                  44420000
377000            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     44430000
377100                                                                  44440000
377200         EXEC SQL                                                 44450000
377300             SELECT  EXPTED_CART_CNT,                             44460000
377400                     RCVR_NBR,                                    44470000
377500                     GOH_IND,                                     44480000
377600                     PKGNG_CDE                                    44490000
377700               INTO  :RECEIV-EXPTED-CART-CNT,                     44500000
377800                     :RECEIV-RCVR-NBR,                            44510000
377900                     :RECEIV-GOH-IND,                             44520000
378000                     :RECEIV-PKGNG-CDE                            44530000
378100               FROM  TRECEIV                                      44540000
378200              WHERE  (ORD_NBR         =  :DK-ORD-NBR              44550000
378300                AND   REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR         44560000
378400                AND   OPER_UNT_ID     =  :DK-OPER-UNT-ID          44570000
378500                AND   FCLTY_ID        =  :DK-FCLTY-ID             44580000
378600                AND   VER_STATUS_CDE  =  'A')                     44590000
378700         END-EXEC                                                 44600000
378800                                                                  44610000
378900         EVALUATE TRUE                                            44620000
379000             WHEN SQLCODE = ZERO                                  44630000
379100             WHEN SQLCODE = -904                                  44640000
379200             WHEN SQLCODE = -913                                  44650000
379300             WHEN SQLCODE = PC-ROW-NOT-FOUND                      44660000
379400                 CONTINUE                                         44670000
379500             WHEN SQLWARN0 NOT = SPACES                           44680000
379600             WHEN SQLCODE < ZERO                                  44690000
379700             WHEN SQLCODE > ZERO                                  44700000
379800                  MOVE '7110-GET-TRECEIV-DATA'                    44710000
379900                                     TO DP013-PARAGRAPH           44720000
380000                  MOVE 'KEYS = '                                  44730000
380100                                     TO DP013-MESSAGE-TEXT (1)    44740000
380200                  MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR        44750000
380300                  MOVE DK-RCVR-SEQ-NBR                            44760000
380400                                     TO PV-DISPLAY-RCVR-SEQ-NBR   44770000
380500                  MOVE DK-OPER-UNT-ID                             44780000
380600                                     TO PV-DISPLAY-OPER-UNT-ID    44790000
380700                  MOVE DK-FCLTY-ID   TO PV-DISPLAY-FCLTY-ID       44800000
380800                  MOVE PV-DISPLAY-KEYS                            44810000
380900                                     TO DP013-MESSAGE-TEXT (2)    44820000
381000                  MOVE SQLCA         TO DP013-SQLCA               44830000
381100                  MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)  44840000
381200                  SET DP013-DB2-ABEND                             44850000
381300                                     TO TRUE                      44860000
381400                  SET DP013-NO-ROLLBACK                           44870000
381500                                     TO TRUE                      44880000
381600                  PERFORM 9999-WRITE-CICS-LOG-MSG                 44890000
381700                  GO TO 0000-GOBACK                               44900000
381800         END-EVALUATE                                             44910000
381900     END-PERFORM.                                                 44920000
382000                                                                  44930000
382100     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    44940000
382200         MOVE '7110-GET-TRECEIV-DATA'                             44950000
382300                                     TO DP013-PARAGRAPH           44960000
382400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     44970000
382500                                     TO DP013-MESSAGE-TEXT (1)    44980000
382600         MOVE 'THE KEYS = '                                       44990000
382700                                     TO DP013-MESSAGE-TEXT (2)    45000000
382800         MOVE DK-ORD-NBR             TO PV-DISPLAY-ORD-NBR        45010000
382900         MOVE DK-RCVR-SEQ-NBR        TO PV-DISPLAY-RCVR-SEQ-NBR   45020000
383000         MOVE DK-OPER-UNT-ID         TO PV-DISPLAY-OPER-UNT-ID    45030000
383100         MOVE DK-FCLTY-ID            TO PV-DISPLAY-FCLTY-ID       45040000
383200         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    45050000
383300         MOVE SQLCA                  TO DP013-SQLCA               45060000
383400         MOVE 'TRECEIV'              TO DP013-DB2-TABLE-NAME (1)  45070000
383500         SET DP013-DB2-ABEND         TO TRUE                      45080000
383600         SET DP013-NO-ROLLBACK       TO TRUE                      45090000
383700         PERFORM 9999-WRITE-CICS-LOG-MSG                          45100000
383800         GO TO 0000-GOBACK                                        45110000
383900     END-IF.                                                      45120000
384000/                                                                 45130000
384100 7120-GET-PRIMARY-VNDR-NME.                                       45140000
384200     INITIALIZE DCLTENTNME.                                       45150000
384300                                                                  45160000
384400     PERFORM                                                      45170000
384500         WITH TEST AFTER                                          45180000
384600         VARYING PV-SELECT-COUNTER                                45190000
384700         FROM 1 BY 1                                              45200000
384800         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              45210000
384900            OR   (SQLCODE = ZERO)                                 45220000
385000            OR   (SQLCODE = PC-ROW-NOT-FOUND))                    45230000
385100                                                                  45240000
385200         EXEC SQL                                                 45250000
385300             SELECT  ENT_NAME_DESC                                45260000
385400               INTO  :ENTNME-ENT-NAME-DESC                        45270000
385500               FROM  TENTNME                                      45280000
385600              WHERE  (ENT_ID    =  :PURCHS-ENT-ID                 45290000
385700                AND   TYPE_CDE  =  '01')                          45300000
385800         END-EXEC                                                 45310000
385900                                                                  45320000
386000         EVALUATE TRUE                                            45330000
386100             WHEN SQLCODE = ZERO                                  45340000
386200             WHEN SQLCODE = -904                                  45350000
386300             WHEN SQLCODE = -913                                  45360000
386400             WHEN SQLCODE = PC-ROW-NOT-FOUND                      45370000
386500                  CONTINUE                                        45380000
386600             WHEN SQLWARN0 NOT = SPACES                           45390000
386700             WHEN SQLCODE < ZERO                                  45400000
386800             WHEN SQLCODE > ZERO                                  45410000
386900                  MOVE '7120-GET-PRIMARY-VNDR-NME'                45420000
387000                                     TO DP013-PARAGRAPH           45430000
387100                  MOVE 'SELECT PRIMARY VENDOR NAME ENT ID = '     45440000
387200                                     TO DP013-MESSAGE-TEXT (1)    45450000
387300                  MOVE PURCHS-ENT-ID TO PV-DISPLAY-ENT-ID         45460000
387400                  MOVE PV-DISPLAY-ENT-ID                          45470000
387500                                     TO DP013-MESSAGE-TEXT (2)    45480000
387600                  MOVE SQLCA         TO DP013-SQLCA               45490000
387700                  MOVE 'TENTNME'     TO DP013-DB2-TABLE-NAME (1)  45500000
387800                  SET DP013-DB2-ABEND                             45510000
387900                                     TO TRUE                      45520000
388000                  SET DP013-NO-ROLLBACK                           45530000
388100                                     TO TRUE                      45540000
388200                  PERFORM 9999-WRITE-CICS-LOG-MSG                 45550000
388300                  GO TO 0000-GOBACK                               45560000
388400         END-EVALUATE                                             45570000
388500     END-PERFORM.                                                 45580000
388600                                                                  45590000
388700     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO    45600000
388800         MOVE '7120-GET-PRIMARY-VNDR-NME'                         45610000
388900                                     TO DP013-PARAGRAPH           45620000
389000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     45630000
389100                                     TO DP013-MESSAGE-TEXT (1)    45640000
389200         MOVE 'THE PRIMARY VENDOR NAME.  ENT ID = '               45650000
389300                                     TO DP013-MESSAGE-TEXT (2)    45660000
389400         MOVE PURCHS-ENT-ID          TO PV-DISPLAY-ENT-ID         45670000
389500         MOVE PV-DISPLAY-ENT-ID      TO DP013-MESSAGE-TEXT (3)    45680000
389600         MOVE SQLCA                  TO DP013-SQLCA               45690000
389700         MOVE 'TENTNME'              TO DP013-DB2-TABLE-NAME (1)  45700000
389800         SET DP013-DB2-ABEND         TO TRUE                      45710000
389900         SET DP013-NO-ROLLBACK       TO TRUE                      45720000
390000         PERFORM 9999-WRITE-CICS-LOG-MSG                          45730000
390100         GO TO 0000-GOBACK                                        45740000
390200     END-IF.                                                      45750000
390300/                                                                 45760000
390400*----------------------------------------------------------------*46190000
390500*    GET THE EARLIEST AD DATE                                    *46200000
390600*----------------------------------------------------------------*46210000
390700 7150-GET-AD-DATE.                                                46220000
390800                                                                  46230000
390900     MOVE SPACES        TO HL3-PICTURED-AD-DTE                    46240000
391000                           HL2-PICTURED-AD-FLG                    46250000
391100                                                                  46260000
391200     PERFORM                                                      46270000
391300         WITH TEST AFTER                                          46280000
391400         VARYING PV-SELECT-COUNTER                                46290000
391500         FROM 1 BY 1                                              46300000
391600         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              46310000
391700            OR  (SQLCODE = ZERO)                                  46320000
391800            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     46330000
391900                                                                  46340000
392000         EXEC SQL                                                 46350000
392100              SELECT MIN(AD_EVNT_DTE)                             46360000
392200                INTO :PV-DB2-AD-EVNT-DATE:PV-NULL-IND             46370000
392300                FROM TPURITM                                      46380000
392400               WHERE PO_NBR         = :DK-ORD-NBR                 46390000
392500                 AND PO_PREPK_ID    = :DK-PREPK-ID                46400000
392600                 AND VER_STATUS_CDE = 'A'                         46410000
392700                 AND AD_EVNT_DTE > '0001-01-01'                   46420000
392800                 AND STATUS_CDE NOT IN ('CA')                     46430000
392900         END-EXEC                                                 46440000
393000                                                                  46450000
393100         EVALUATE TRUE                                            46460000
393200             WHEN SQLCODE = ZERO                                  46470000
393300                 IF PV-NULL-IND < ZERO                            46480000
393400                     MOVE SPACES          TO HL3-PICTURED-AD-DTE  46490000
393500                     MOVE PC-N            TO HL2-PICTURED-AD-FLG  46500000
393600                 ELSE                                             46510000
393700                     MOVE PV-DB2-AD-EVNT-DATE TO PV-DB2-DATE      46520000
393800                     MOVE PV-DB2-DATE-MM  TO PV-DISPLAY-DATE-MM   46530000
393900                     MOVE PV-DB2-DATE-DD  TO PV-DISPLAY-DATE-DD   46540000
394000                     MOVE PV-DB2-DATE-YY  TO PV-DISPLAY-DATE-YY   46550000
394100                     MOVE PV-DISPLAY-DATE TO HL3-PICTURED-AD-DTE  46560000
394200                     MOVE PC-Y            TO HL2-PICTURED-AD-FLG  46570000
394300                 END-IF                                           46580000
394400                 CONTINUE                                         46590000
394500             WHEN SQLCODE = -904                                  46600000
394600             WHEN SQLCODE = -913                                  46610000
394700                 CONTINUE                                         46620000
394800             WHEN SQLCODE = PC-ROW-NOT-FOUND                      46630000
394900                 MOVE SPACES           TO HL3-PICTURED-AD-DTE     46640000
395000                 MOVE PC-N             TO HL2-PICTURED-AD-FLG     46650000
395100                 CONTINUE                                         46660000
395200             WHEN SQLWARN0 NOT = SPACES                           46670000
395300             WHEN SQLCODE < ZERO                                  46680000
395400             WHEN SQLCODE > ZERO                                  46690000
395500                  MOVE '7150-GET-AD-DATE'                         46700000
395600                                     TO DP013-PARAGRAPH           46710000
395700                  MOVE 'SELECT INFO: '                            46720000
395800                                     TO DP013-MESSAGE-TEXT (1)    46730000
395900                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       46740000
396000                  MOVE PV-DISPLAY-KEYS                            46750000
396100                                     TO DP013-MESSAGE-TEXT (2)    46760000
396200                  MOVE SQLCA         TO DP013-SQLCA               46770000
396300                  MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (1)  46780000
396400                  SET DP013-DB2-ABEND                             46790000
396500                                     TO TRUE                      46800000
396600                  SET DP013-NO-ROLLBACK                           46810000
396700                                     TO TRUE                      46820000
396800                  PERFORM 9999-WRITE-CICS-LOG-MSG                 46830000
396900                  GO TO 0000-GOBACK                               46840000
397000         END-EVALUATE                                             46850000
397100     END-PERFORM.                                                 46860000
397200                                                                  46870000
397300     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       46880000
397400         MOVE '7150-GET-AD-DATE'    TO DP013-PARAGRAPH            46890000
397500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46900000
397600                                     TO DP013-MESSAGE-TEXT (1)    46910000
397700         MOVE 'THE FOLLOWING ORDER: '                             46920000
397800                                     TO DP013-MESSAGE-TEXT (2)    46930000
397900         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       46940000
398000         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    46950000
398100         MOVE SQLCA                  TO DP013-SQLCA               46960000
398200         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (1)  46970000
398300         SET DP013-DB2-ABEND         TO TRUE                      46980000
398400         SET DP013-NO-ROLLBACK       TO TRUE                      46990000
398500         PERFORM 9999-WRITE-CICS-LOG-MSG                          47000000
398600         GO TO 0000-GOBACK                                        47010000
398700     END-IF.                                                      47020000
398800                                                                  47030000
398900                                                                  47040000
399000/                                                                 47050000
399100 7160-OPEN-INST-CSR.                                              47060000
399200     PERFORM                                                      47070000
399300         WITH TEST AFTER                                          47080000
399400         VARYING PV-RETRY-COUNT                                   47090000
399500         FROM 1 BY 1                                              47100000
399600         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 47110000
399700            OR  (SQLCODE = +0))                                   47120000
399800                                                                  47130000
399900         EXEC SQL                                                 47140000
400000             OPEN INST-CSR                                        47150000
400100         END-EXEC                                                 47160000
400200                                                                  47170000
400300         EVALUATE TRUE                                            47180000
400400             WHEN SQLCODE = +0                                    47190000
400500             WHEN SQLCODE = -904                                  47200000
400600             WHEN SQLCODE = -913                                  47210000
400700                  CONTINUE                                        47220000
400800             WHEN SQLWARN0 NOT = SPACE                            47230000
400900             WHEN SQLCODE  NOT = +0                               47240000
401000                  MOVE '7160-OPEN-INST'                           47250000
401100                                 TO DP013-PARAGRAPH               47260000
401200                  MOVE 'OPEN INST CURSOR'                         47270000
401300                                 TO DP013-MESSAGE-TEXT (1)        47280000
401400                  MOVE SQLCA     TO DP013-SQLCA                   47290000
401500                  MOVE 'TPOINST'   TO DP013-DB2-TABLE-NAME (1)    47300000
401600                  MOVE 'TINSTCD'   TO DP013-DB2-TABLE-NAME (2)    47310000
401700                  SET DP013-DB2-ABEND    TO  TRUE                 47320000
401800                  SET DP013-NO-ROLLBACK  TO  TRUE                 47330000
401900                  PERFORM 9999-WRITE-CICS-LOG-MSG                 47340000
402000                  GO TO 0000-GOBACK                               47350000
402100         END-EVALUATE                                             47360000
402200     END-PERFORM.                                                 47370000
402300                                                                  47380000
402400     IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       47390000
402500         MOVE '7160-OPEN-INST'                                    47400000
402600                                 TO DP013-PARAGRAPH               47410000
402700         MOVE 'MAX RETRIES EXCEEDED'                              47420000
402800                                 TO DP013-MESSAGE-TEXT (1)        47430000
402900         SET DP013-DB2-ABEND TO TRUE                              47440000
403000         SET DP013-NO-ROLLBACK TO TRUE                            47450000
403100         PERFORM 9999-WRITE-CICS-LOG-MSG                          47460000
403200         GO TO 0000-GOBACK                                        47470000
403300     END-IF.                                                      47480000
403400*                                                                 47490000
403500 7170-1ST-DC-SPCL-INSTR.                                          47500000
403600     INITIALIZE DCLTPOINST                                        47510000
403700                DCLTINSTCD.                                       47520000
403800                                                                  47530000
403900     PERFORM                                                      47540000
404000         WITH TEST AFTER                                          47550000
404100         VARYING PV-SELECT-COUNTER                                47560000
404200         FROM 1 BY 1                                              47570000
404300         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              47580000
404400            OR  (SQLCODE = ZERO)                                  47590000
404500            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     47600000
404600                                                                  47610000
404700         EXEC SQL                                                 47620000
404800              FETCH  INST-CSR                                     47630000
404900               INTO  :INSTCD-INSTR-DESC                           47640000
405000         END-EXEC                                                 47650000
405100                                                                  47660000
405200         EVALUATE TRUE                                            47670000
405300             WHEN SQLCODE = ZERO                                  47680000
405400                 CONTINUE                                         47690000
405500             WHEN SQLCODE = -904                                  47700000
405600             WHEN SQLCODE = -913                                  47710000
405700                 CONTINUE                                         47720000
405800             WHEN SQLCODE = PC-ROW-NOT-FOUND                      47730000
405900                 SET PS-NO-SPECIAL-INSTRS-FOUND    TO  TRUE       47740000
406000                 CONTINUE                                         47750000
406100             WHEN SQLWARN0 NOT = SPACES                           47760000
406200             WHEN SQLCODE < ZERO                                  47770000
406300             WHEN SQLCODE > ZERO                                  47780000
406400                  MOVE '7170-1ST-DC-SPCL-INSTR'                   47790000
406500                                     TO DP013-PARAGRAPH           47800000
406600                  MOVE 'FETCH SPECIAL INSTRUCTIONS  KEYS = '      47810000
406700                                     TO DP013-MESSAGE-TEXT (1)    47820000
406800                  MOVE DK-ORD-NBR    TO PV-DISPLAY-ORD-NBR        47830000
406900                  MOVE PV-DISPLAY-KEYS                            47840000
407000                                     TO DP013-MESSAGE-TEXT (2)    47850000
407100                  MOVE SQLCA         TO DP013-SQLCA               47860000
407200                  MOVE 'TPOINST'     TO DP013-DB2-TABLE-NAME (1)  47870000
407300                  MOVE 'TINSTCD'     TO DP013-DB2-TABLE-NAME (2)  47880000
407400                  SET DP013-DB2-ABEND                             47890000
407500                                     TO TRUE                      47900000
407600                  SET DP013-NO-ROLLBACK                           47910000
407700                                     TO TRUE                      47920000
407800                  PERFORM 9999-WRITE-CICS-LOG-MSG                 47930000
407900                  GO TO 0000-GOBACK                               47940000
408000         END-EVALUATE                                             47950000
408100     END-PERFORM.                                                 47960000
408200                                                                  47970000
408300     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES AND SQLCODE = ZERO    47980000
408400         MOVE '7170-1ST-DC-SPCL-INSTR'                            47990000
408500                                     TO DP013-PARAGRAPH           48000000
408600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     48010000
408700                                     TO DP013-MESSAGE-TEXT (1)    48020000
408800         MOVE 'THE SPECIAL INSTRUCTIONS.  KEYS = '                48030000
408900                                     TO DP013-MESSAGE-TEXT (2)    48040000
409000         MOVE DK-ORD-NBR             TO PV-DISPLAY-ORD-NBR        48050000
409100         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    48060000
409200         MOVE SQLCA                  TO DP013-SQLCA               48070000
409300         MOVE 'TPOINST'              TO DP013-DB2-TABLE-NAME (1)  48080000
409400         MOVE 'TINSTCD'              TO DP013-DB2-TABLE-NAME (2)  48090000
409500         SET DP013-DB2-ABEND         TO TRUE                      48100000
409600         SET DP013-NO-ROLLBACK       TO TRUE                      48110000
409700         PERFORM 9999-WRITE-CICS-LOG-MSG                          48120000
409800         GO TO 0000-GOBACK                                        48130000
409900     END-IF.                                                      48140000
410000 7180-CLOSE-INST-CSR.                                             48150000
410100     PERFORM                                                      48160000
410200         WITH TEST AFTER                                          48170000
410300         VARYING PV-RETRY-COUNT                                   48180000
410400         FROM 1 BY 1                                              48190000
410500         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 48200000
410600            OR  (SQLCODE = +0))                                   48210000
410700                                                                  48220000
410800            EXEC SQL                                              48230000
410900                CLOSE INST-CSR                                    48240000
411000            END-EXEC                                              48250000
411100                                                                  48260000
411200            EVALUATE TRUE                                         48270000
411300                WHEN SQLCODE = 0                                  48280000
411400                    CONTINUE                                      48290000
411500                WHEN SQLCODE = -911                               48300000
411600                WHEN SQLCODE = -904                               48310000
411700                    CONTINUE                                      48320000
411800                WHEN SQLCODE  NOT = +0                            48330000
411900                     MOVE '7180-CLOSE-INST-CSR'                   48340000
412000                                  TO DP013-PARAGRAPH              48350000
412100                     MOVE 'CLOSE INST CURSOR'                     48360000
412200                                  TO DP013-MESSAGE-TEXT (1)       48370000
412300                     MOVE SQLCA   TO DP013-SQLCA                  48380000
412400                     MOVE 'TPOINST'   TO DP013-MESSAGE-TEXT (1)   48390000
412500                     MOVE 'TINSTCD'   TO DP013-MESSAGE-TEXT (2)   48400000
412600                     SET DP013-DB2-ABEND TO TRUE                  48410000
412700                     SET DP013-NO-ROLLBACK TO TRUE                48420000
412800                     PERFORM 9999-WRITE-CICS-LOG-MSG              48430000
412900                     GO TO 0000-GOBACK                            48440000
413000            END-EVALUATE                                          48450000
413100                                                                  48460000
413200     END-PERFORM.                                                 48470000
413300                                                                  48480000
413400     IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       48490000
413500         MOVE '7180-CLOSE-INST'                                   48500000
413600                                 TO DP013-PARAGRAPH               48510000
413700         MOVE 'MAX RETRIES EXCEEDED'                              48520000
413800                                 TO DP013-MESSAGE-TEXT (1)        48530000
413900         SET DP013-DB2-ABEND TO TRUE                              48540000
414000         SET DP013-NO-ROLLBACK TO TRUE                            48550000
414100         PERFORM 9999-WRITE-CICS-LOG-MSG                          48560000
414200         GO TO 0000-GOBACK                                        48570000
414300     END-IF.                                                      48580000
414400/                                                                 48590000
414500 7190-PURITM-RECITM-DATA.                                         48600000
414600     INITIALIZE DCLTPURITM                                        48610000
414700                                                                  48620000
414800     PERFORM                                                      48630000
414900         WITH TEST AFTER                                          48640000
415000         VARYING PV-SELECT-COUNTER                                48650000
415100         FROM 1 BY 1                                              48660000
415200         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              48670000
415300            OR  (SQLCODE = ZERO)                                  48680000
415400            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     48690000
415500                                                                  48700000
415600         EXEC SQL                                                 48710000
415700             FETCH PACK-LINE-CSR2                                 48720000
415800               INTO  :PURITM-PO-LNE-NBR,                          48730000
415900                     :PURITM-SKU-SEQ-NBR,                         48740000
416000                     :PURITM-VEND-STYL-NAME,                      48760000
416100                     :PURITM-UNT-QTY,                             48770000
416200                     :PURITM-UNT-RTL-PR-AMT,                      48780000
416300                     :PURITM-ITM-NBR,                             48790000
416400                     :PURITM-GP-RTL-AMT,                          48791000
416500                     :PURITM-GP-QTY,                              48792000
416600                     :PURITM-PREPK-RATO-QTY,                      48800000
416700                     :RECITM-ORD-LNE-NBR,                         48810000
416800                     :RECITM-PRE-TKT-IND,                         48820000
416900                     :RECITM-TKT-FMT-ID,                          48830000
417000                     :RECITM-PKSL-ITM-QTY,                        48840000
417100                     :RECITM-DTL-CK-ITM-QTY,                      48850000
417200                     :RECITM-CASE-PACK-QTY,                       48860000
417300                     :RECITM-PREPK-RATO-QTY,                      48870000
417400                     :RECITM-PREPK-DRV-LNE-CDE                    48880000
417500         END-EXEC                                                 48890000
417600                                                                  48900000
417700         EVALUATE TRUE                                            48910000
417800             WHEN SQLCODE = ZERO                                  48920000
417900                  SET PS-CALL-API-YES TO TRUE                     48921000
418000             WHEN SQLCODE = -904                                  48930000
418100             WHEN SQLCODE = -913                                  48940000
418200                 CONTINUE                                         48950000
418300             WHEN SQLCODE = PC-ROW-NOT-FOUND                      48960000
418400                 SET PS-END-OF-PACK-ITEMS TO TRUE                 48970000
418500                 SET PS-CALL-API-NO       TO TRUE                 48980000
418600             WHEN SQLWARN0 NOT = SPACES                           48990000
418700             WHEN SQLCODE < ZERO                                  49000000
418800             WHEN SQLCODE > ZERO                                  49010000
418900                  MOVE '7190-PURITM-RECITM-DATA'                  49020000
419000                                     TO DP013-PARAGRAPH           49030000
419100                  MOVE 'FETCH INFO FOR THE FOLLOWING RECEIVER: '  49040000
419200                                     TO DP013-MESSAGE-TEXT (1)    49050000
419300                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       49060000
419400                  MOVE DK-ORD-LNE-NBR                             49070000
419500                                     TO  PV-DISPLAY-ORD-LNE-NBR   49080000
419600                  MOVE PV-DISPLAY-KEYS                            49090000
419700                                     TO DP013-MESSAGE-TEXT (2)    49100000
419800                  MOVE SQLCA         TO DP013-SQLCA               49110000
419900                  MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (1)  49120000
420000                  MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)  49130000
420100                  SET DP013-DB2-ABEND                             49140000
420200                                     TO TRUE                      49150000
420300                  SET DP013-NO-ROLLBACK                           49160000
420400                                     TO TRUE                      49170000
420500                  PERFORM 9999-WRITE-CICS-LOG-MSG                 49180000
420600                  GO TO 0000-GOBACK                               49190000
420700         END-EVALUATE                                             49200000
420800     END-PERFORM.                                                 49210000
420900                                                                  49220000
421000     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       49230000
421100         MOVE '7190-PURITM-RECITM-DATA' TO DP013-PARAGRAPH        49240000
421200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     49250000
421300                                     TO DP013-MESSAGE-TEXT (1)    49260000
421400         MOVE 'THE FOLLOWING RECEIVER: '                          49270000
421500                                     TO DP013-MESSAGE-TEXT (2)    49280000
421600         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       49290000
421700         MOVE DK-ORD-LNE-NBR         TO  PV-DISPLAY-ORD-LNE-NBR   49300000
421800         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    49310000
421900         MOVE SQLCA                  TO DP013-SQLCA               49320000
422000         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (1)  49330000
422100         MOVE 'TRECITM'              TO DP013-DB2-TABLE-NAME (2)  49340000
422200         SET DP013-DB2-ABEND         TO TRUE                      49350000
422300         SET DP013-NO-ROLLBACK       TO TRUE                      49360000
422400         PERFORM 9999-WRITE-CICS-LOG-MSG                          49370000
422500         GO TO 0000-GOBACK                                        49380000
422600     END-IF.                                                      49390000
422700 7192-OPEN-PACK-LINE-CSR2.                                        49400000
422800     PERFORM                                                      49410000
422900         WITH TEST AFTER                                          49420000
423000         VARYING PV-RETRY-COUNT                                   49430000
423100         FROM 1 BY 1                                              49440000
423200         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 49450000
423300            OR  (SQLCODE = +0))                                   49460000
423400                                                                  49470000
423500         EXEC SQL                                                 49480000
423600             OPEN PACK-LINE-CSR2                                  49490000
423700         END-EXEC                                                 49500000
423800                                                                  49510000
423900         EVALUATE TRUE                                            49520000
424000             WHEN SQLCODE = +0                                    49530000
424100             WHEN SQLCODE = -904                                  49540000
424200             WHEN SQLCODE = -913                                  49550000
424300                  CONTINUE                                        49560000
424400             WHEN SQLWARN0 NOT = SPACE                            49570000
424500             WHEN SQLCODE  NOT = +0                               49580000
424600                  MOVE '7192-OPEN-PACK-LINE-CSR2'                 49590000
424700                                 TO DP013-PARAGRAPH               49600000
424800                  MOVE 'OPEN PACK-LINE-CSR2 CURSOR'               49610000
424900                                 TO DP013-MESSAGE-TEXT (1)        49620000
425000                  MOVE SQLCA     TO DP013-SQLCA                   49630000
425100                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)    49640000
425200                  MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (2)    49650000
425300                  SET DP013-DB2-ABEND    TO  TRUE                 49660000
425400                  SET DP013-NO-ROLLBACK  TO  TRUE                 49670000
425500                  PERFORM 9999-WRITE-CICS-LOG-MSG                 49680000
425600                  GO TO 0000-GOBACK                               49690000
425700         END-EVALUATE                                             49700000
425800     END-PERFORM.                                                 49710000
425900                                                                  49720000
426000     IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       49730000
426100         MOVE '7192-OPEN-PACK-LINE-CSR2'                          49740000
426200                                 TO DP013-PARAGRAPH               49750000
426300         MOVE 'MAX RETRIES EXCEEDED'                              49760000
426400                                 TO DP013-MESSAGE-TEXT (1)        49770000
426500         SET DP013-DB2-ABEND TO TRUE                              49780000
426600         SET DP013-NO-ROLLBACK TO TRUE                            49790000
426700         PERFORM 9999-WRITE-CICS-LOG-MSG                          49800000
426800         GO TO 0000-GOBACK                                        49810000
426900     END-IF.                                                      49820000
427000*                                                                 49830000
427100 7194-CLOSE-PACK-LINE-CSR2.                                       49840000
427200     PERFORM                                                      49850000
427300         WITH TEST AFTER                                          49860000
427400         VARYING PV-RETRY-COUNT                                   49870000
427500         FROM 1 BY 1                                              49880000
427600         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 49890000
427700            OR  (SQLCODE = +0))                                   49900000
427800                                                                  49910000
427900            EXEC SQL                                              49920000
428000                CLOSE PACK-LINE-CSR2                              49930000
428100            END-EXEC                                              49940000
428200                                                                  49950000
428300            EVALUATE TRUE                                         49960000
428400                WHEN SQLCODE = 0                                  49970000
428500                    CONTINUE                                      49980000
428600                WHEN SQLCODE = -911                               49990000
428700                WHEN SQLCODE = -904                               50000000
428800                    CONTINUE                                      50010000
428900                WHEN SQLCODE  NOT = +0                            50020000
429000                     MOVE '7194-CLOSE-PACK-LINE-CSR2'             50030000
429100                                  TO DP013-PARAGRAPH              50040000
429200                     MOVE 'CLOSE PACK-LINE-CSR2 CURSOR'           50050000
429300                                  TO DP013-MESSAGE-TEXT (1)       50060000
429400                     MOVE SQLCA   TO DP013-SQLCA                  50070000
429500                     MOVE 'TPURITM'   TO DP013-MESSAGE-TEXT (1)   50080000
429600                     MOVE 'TRECITM'   TO DP013-MESSAGE-TEXT (2)   50090000
429700                     SET DP013-DB2-ABEND TO TRUE                  50100000
429800                     SET DP013-NO-ROLLBACK TO TRUE                50110000
429900                     PERFORM 9999-WRITE-CICS-LOG-MSG              50120000
430000                     GO TO 0000-GOBACK                            50130000
430100            END-EVALUATE                                          50140000
430200                                                                  50150000
430300     END-PERFORM.                                                 50160000
430400                                                                  50170000
430500     IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       50180000
430600         MOVE '7194-CLOSE-PACK-LINE-CSR2'                         50190000
430700                                 TO DP013-PARAGRAPH               50200000
430800         MOVE 'MAX RETRIES EXCEEDED'                              50210000
430900                                 TO DP013-MESSAGE-TEXT (1)        50220000
431000         SET DP013-DB2-ABEND TO TRUE                              50230000
431100         SET DP013-NO-ROLLBACK TO TRUE                            50240000
431200         PERFORM 9999-WRITE-CICS-LOG-MSG                          50250000
431300         GO TO 0000-GOBACK                                        50260000
431400     END-IF.                                                      50270000
431500*                                                                 50280000
431600 7200-PURITM-RECITM-DATA.                                         50290000
431700     INITIALIZE DCLTPURITM                                        50300000
431800                                                                  50310000
431900     PERFORM                                                      50320000
432000         WITH TEST AFTER                                          50330000
432100         VARYING PV-SELECT-COUNTER                                50340000
432200         FROM 1 BY 1                                              50350000
432300         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              50360000
432400            OR  (SQLCODE = ZERO)                                  50370000
432500            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     50380000
432600                                                                  50390000
432700         EXEC SQL                                                 50400000
432800             FETCH PACK-LINE-CSR                                  50410000
432900               INTO  :PURITM-PO-LNE-NBR,                          50420000
433000                     :PURITM-SKU-SEQ-NBR,                         50430000
433100                     :PURITM-VEND-STYL-NAME,                      50450000
433200                     :PURITM-UNT-QTY,                             50460000
433300                     :PURITM-UNT-RTL-PR-AMT,                      50470000
433400                     :PURITM-ITM-NBR,                             50480000
433500                     :PURITM-GP-RTL-AMT,                          50481000
433600                     :PURITM-GP-QTY,                              50482000
433700                     :PURITM-PREPK-RATO-QTY,                      50490000
433800                     :RECITM-ORD-LNE-NBR,                         50500000
433900                     :RECITM-PRE-TKT-IND,                         50510000
434000                     :RECITM-TKT-FMT-ID,                          50520000
434100                     :RECITM-PKSL-ITM-QTY,                        50530000
434200                     :RECITM-DTL-CK-ITM-QTY,                      50540000
434300                     :RECITM-CASE-PACK-QTY,                       50550000
434400                     :RECITM-PREPK-RATO-QTY,                      50560000
434500                     :RECITM-PREPK-DRV-LNE-CDE                    50570000
434600         END-EXEC                                                 50580000
434700                                                                  50590000
434800         EVALUATE TRUE                                            50600000
434900             WHEN SQLCODE = ZERO                                  50610000
435000                 SET PS-CALL-API-YES TO TRUE                      50611000
435100             WHEN SQLCODE = -904                                  50620000
435200             WHEN SQLCODE = -913                                  50630000
435300                 CONTINUE                                         50640000
435400             WHEN SQLCODE = PC-ROW-NOT-FOUND                      50650000
435500                 SET PS-END-OF-PACK-ITEMS TO TRUE                 50660000
435600                 SET PS-CALL-API-NO       TO TRUE                 50661000
435700*                CONTINUE                                         50670000
435800             WHEN SQLWARN0 NOT = SPACES                           50680000
435900             WHEN SQLCODE < ZERO                                  50690000
436000             WHEN SQLCODE > ZERO                                  50700000
436100                  MOVE '7200-PURITM-RECITM-DATA'                  50710000
436200                                     TO DP013-PARAGRAPH           50720000
436300                  MOVE 'FETCH INFO FOR THE FOLLOWING RECEIVER: '  50730000
436400                                     TO DP013-MESSAGE-TEXT (1)    50740000
436500                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       50750000
436600                  MOVE DK-ORD-LNE-NBR                             50760000
436700                                     TO  PV-DISPLAY-ORD-LNE-NBR   50770000
436800                  MOVE PV-DISPLAY-KEYS                            50780000
436900                                     TO DP013-MESSAGE-TEXT (2)    50790000
437000                  MOVE SQLCA         TO DP013-SQLCA               50800000
437100                  MOVE 'TPURITM'     TO DP013-DB2-TABLE-NAME (1)  50810000
437200                  MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)  50820000
437300                  SET DP013-DB2-ABEND                             50830000
437400                                     TO TRUE                      50840000
437500                  SET DP013-NO-ROLLBACK                           50850000
437600                                     TO TRUE                      50860000
437700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 50870000
437800                  GO TO 0000-GOBACK                               50880000
437900         END-EVALUATE                                             50890000
438000     END-PERFORM.                                                 50900000
438100                                                                  50910000
438200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       50920000
438300         MOVE '7200-PURITM-RECITM-DATA' TO DP013-PARAGRAPH        50930000
438400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     50940000
438500                                     TO DP013-MESSAGE-TEXT (1)    50950000
438600         MOVE 'THE FOLLOWING RECEIVER: '                          50960000
438700                                     TO DP013-MESSAGE-TEXT (2)    50970000
438800         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       50980000
438900         MOVE DK-ORD-LNE-NBR         TO  PV-DISPLAY-ORD-LNE-NBR   50990000
439000         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    51000000
439100         MOVE SQLCA                  TO DP013-SQLCA               51010000
439200         MOVE 'TPURITM'              TO DP013-DB2-TABLE-NAME (1)  51020000
439300         MOVE 'TRECITM'              TO DP013-DB2-TABLE-NAME (2)  51030000
439400         SET DP013-DB2-ABEND         TO TRUE                      51040000
439500         SET DP013-NO-ROLLBACK       TO TRUE                      51050000
439600         PERFORM 9999-WRITE-CICS-LOG-MSG                          51060000
439700         GO TO 0000-GOBACK                                        51070000
439800     END-IF.                                                      51080000
439900 7202-OPEN-PACK-LINE-CSR.                                         51090000
440000     PERFORM                                                      51100000
440100         WITH TEST AFTER                                          51110000
440200         VARYING PV-RETRY-COUNT                                   51120000
440300         FROM 1 BY 1                                              51130000
440400         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 51140000
440500            OR  (SQLCODE = +0))                                   51150000
440600                                                                  51160000
440700         EXEC SQL                                                 51170000
440800             OPEN PACK-LINE-CSR                                   51180000
440900         END-EXEC                                                 51190000
441000                                                                  51200000
441100         EVALUATE TRUE                                            51210000
441200             WHEN SQLCODE = +0                                    51220000
441300             WHEN SQLCODE = -904                                  51230000
441400             WHEN SQLCODE = -913                                  51240000
441500                  CONTINUE                                        51250000
441600             WHEN SQLWARN0 NOT = SPACE                            51260000
441700             WHEN SQLCODE  NOT = +0                               51270000
441800                  MOVE '7202-OPEN-PACK-LINE-CSR'                  51280000
441900                                 TO DP013-PARAGRAPH               51290000
442000                  MOVE 'OPEN PACK-LINE-CSR CURSOR'                51300000
442100                                 TO DP013-MESSAGE-TEXT (1)        51310000
442200                  MOVE SQLCA     TO DP013-SQLCA                   51320000
442300                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)    51330000
442400                  MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (2)    51340000
442500                  SET DP013-DB2-ABEND    TO  TRUE                 51350000
442600                  SET DP013-NO-ROLLBACK  TO  TRUE                 51360000
442700                  PERFORM 9999-WRITE-CICS-LOG-MSG                 51370000
442800                  GO TO 0000-GOBACK                               51380000
442900         END-EVALUATE                                             51390000
443000     END-PERFORM.                                                 51400000
443100                                                                  51410000
443200     IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       51420000
443300         MOVE '7202-OPEN-PACK-LINE-CSR'                           51430000
443400                                 TO DP013-PARAGRAPH               51440000
443500         MOVE 'MAX RETRIES EXCEEDED'                              51450000
443600                                 TO DP013-MESSAGE-TEXT (1)        51460000
443700         SET DP013-DB2-ABEND TO TRUE                              51470000
443800         SET DP013-NO-ROLLBACK TO TRUE                            51480000
443900         PERFORM 9999-WRITE-CICS-LOG-MSG                          51490000
444000         GO TO 0000-GOBACK                                        51500000
444100     END-IF.                                                      51510000
444200*                                                                 51520000
444300 7204-CLOSE-PACK-LINE-CSR.                                        51530000
444400     PERFORM                                                      51540000
444500         WITH TEST AFTER                                          51550000
444600         VARYING PV-RETRY-COUNT                                   51560000
444700         FROM 1 BY 1                                              51570000
444800         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 51580000
444900            OR  (SQLCODE = +0))                                   51590000
445000                                                                  51600000
445100            EXEC SQL                                              51610000
445200                CLOSE PACK-LINE-CSR                               51620000
445300            END-EXEC                                              51630000
445400                                                                  51640000
445500            EVALUATE TRUE                                         51650000
445600                WHEN SQLCODE = 0                                  51660000
445700                    CONTINUE                                      51670000
445800                WHEN SQLCODE = -911                               51680000
445900                WHEN SQLCODE = -904                               51690000
446000                    CONTINUE                                      51700000
446100                WHEN SQLCODE  NOT = +0                            51710000
446200                     MOVE '7204-CLOSE-PACK-LINE-CSR'              51720000
446300                                  TO DP013-PARAGRAPH              51730000
446400                     MOVE 'CLOSE PACK-LINE-CSR CURSOR'            51740000
446500                                  TO DP013-MESSAGE-TEXT (1)       51750000
446600                     MOVE SQLCA   TO DP013-SQLCA                  51760000
446700                     MOVE 'TPURITM'   TO DP013-MESSAGE-TEXT (1)   51770000
446800                     MOVE 'TRECITM'   TO DP013-MESSAGE-TEXT (2)   51780000
446900                     SET DP013-DB2-ABEND TO TRUE                  51790000
447000                     SET DP013-NO-ROLLBACK TO TRUE                51800000
447100                     PERFORM 9999-WRITE-CICS-LOG-MSG              51810000
447200                     GO TO 0000-GOBACK                            51820000
447300            END-EVALUATE                                          51830000
447400                                                                  51840000
447500     END-PERFORM.                                                 51850000
447600                                                                  51860000
447700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES AND SQLCODE > ZERO       51870000
447800         MOVE '7204-CLOSE-PACK-LINE-CSR'                          51880000
447900                                 TO DP013-PARAGRAPH               51890000
448000         MOVE 'MAX RETRIES EXCEEDED'                              51900000
448100                                 TO DP013-MESSAGE-TEXT (1)        51910000
448200         SET DP013-DB2-ABEND TO TRUE                              51920000
448300         SET DP013-NO-ROLLBACK TO TRUE                            51930000
448400         PERFORM 9999-WRITE-CICS-LOG-MSG                          51940000
448500         GO TO 0000-GOBACK                                        51950000
448600     END-IF.                                                      51960000
448700*                                                                 51970000
448800     EJECT                                                        51980000
448900 7210-CALL-CICS-API-ARCH.                                         51991000
449000                                                                  51992000
449100     MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.                  52000000
449200                                                                  52000100
449300     SET  XL001-BY-ITEM                                           52000200
449400          XL001-SELECT-SKU                                        52000300
449500          XL001-SELECT-SKU-STR                                    52000400
449600          XL001-SELECT-VND-STYL TO TRUE.                          52000600
449700                                                                  52000700
449800     CALL XL001-VSM-PGM USING  DFHEIBLK                           52000800
449900                               XL001-COMMAREA                     52000900
450000                               XL001-ITEM-COMMAREA.               52001000
450100     EVALUATE TRUE                                                52001100
450200                                                                  52001200
450300         WHEN XL001-SKU-CONTENTION                                52001300
450400         WHEN XL001-SKU-STR-CONTENTION                            52001400
450500         WHEN XL001-VND-STYL-CONTENTION                           52001500
450600             MOVE XL001-CONTENTION-ERR-PARA-NBR                   52001700
450700                 TO DP013-PARAGRAPH                               52001800
450800             MOVE 'PROCESSING ITEM NBR: '                         52001900
450900                 TO DP013-MESSAGE-TEXT (1)                        52002000
451000             MOVE PURITM-ITM-NBR   TO PV-DISPLAY-ITEM-NBR         52002100
451100             MOVE PV-DISPLAY-ITEM-NBR                             52002200
451200                 TO DP013-MESSAGE-TEXT (2)                        52002300
451300             MOVE XL001-SQLCA       TO DP013-SQLCA                52002400
451400             MOVE 'SKU/STR/VND/UPC' TO DP013-DB2-TABLE-NAME (1)   52002500
451500             SET DP013-DB2-ABEND    TO TRUE                       52002600
451600             SET DP013-NO-ROLLBACK  TO TRUE                       52002700
451700             PERFORM 9999-WRITE-CICS-LOG-MSG                      52002800
451800                                                                  52003000
451900         WHEN XL001-SKU-SQLCODE = ZERO                            52003100
452000             PERFORM 7211-SELECT-VND-STYL                         52003200
452100                                                                  52003300
452200         WHEN XL001-SKU-SQLCODE = PC-ROW-NOT-FOUND                52003400
452300             MOVE SPACES        TO  HL4-PRESENTATION              52003500
452400             MOVE 'NO DESC.'    TO  XL001-SKU-DESC                52003600
452500             MOVE ZERO          TO  XL001-SKU-NBR                 52003700
452600             MOVE SPACES        TO  XL001-SUB-CL-NBR-2CH          52003800
452700                                                                  52003900
452800         WHEN OTHER                                               52004000
452900             MOVE '7210-CALL-CICS-API-ARCH'                       52004100
453000                 TO DP013-PARAGRAPH                               52004200
453100             MOVE 'PROCESSING ITEM NBR: '                         52004300
453200                 TO DP013-MESSAGE-TEXT (1)                        52004400
453300             MOVE PURITM-ITM-NBR   TO PV-DISPLAY-ITEM-NBR         52004500
453400             MOVE PV-DISPLAY-ITEM-NBR                             52004600
453500                 TO DP013-MESSAGE-TEXT (2)                        52004700
453600             MOVE XL001-SKU-SQLCODE                               52004800
453700                                   TO SQLCODE                     52004900
453800             MOVE SQLCA            TO DP013-SQLCA                 52005000
453900             MOVE 'XLV_SKU'        TO DP013-DB2-TABLE-NAME (1)    52005100
454000             SET DP013-DB2-ABEND   TO TRUE                        52005200
454100             SET DP013-NO-ROLLBACK TO TRUE                        52005300
454200             PERFORM 9999-WRITE-CICS-LOG-MSG                      52005400
454300             GO TO 0000-GOBACK                                    52005500
454400     END-EVALUATE.                                                52005600
454500                                                                  52005700
454600 7211-SELECT-VND-STYL.                                            52005800
454700                                                                  52005900
454800     EVALUATE TRUE                                                52006000
454900          WHEN XL001-VND-STYL-SQLCODE = ZERO                      52006100
455000               MOVE  XL001-HNG-FOLD-DESC  TO                      52006200
455100                     HL4-PRESENTATION                             52006300
455200               PERFORM 7212-SELECT-SKU-STR                        52006400
455300                                                                  52006500
455400          WHEN XL001-VND-STYL-SQLCODE = PC-ROW-NOT-FOUND          52006600
455500               MOVE  SPACES TO HL4-PRESENTATION                   52006700
455600                               XL001-SUB-CL-NBR-2CH               52006800
455700                                                                  52006900
455800          WHEN OTHER                                              52007000
455900               MOVE '7211-SELECT-VND-STYL'                        52007100
456000                   TO DP013-PARAGRAPH                             52007200
456100               MOVE 'PROCESSING ITEM NBR: '                       52007300
456200                   TO DP013-MESSAGE-TEXT (1)                      52007400
456300               MOVE PURITM-ITM-NBR TO PV-DISPLAY-ITEM-NBR         52007500
456400               MOVE PV-DISPLAY-ITEM-NBR                           52007600
456500                   TO DP013-MESSAGE-TEXT (2)                      52007700
456600               MOVE XL001-VND-STYL-SQLCODE                        52007800
456700                                     TO SQLCODE                   52007900
456800               MOVE SQLCA            TO DP013-SQLCA               52008000
456900               MOVE 'XLV_VND_STYL'   TO DP013-DB2-TABLE-NAME (1)  52008100
457000               SET DP013-DB2-ABEND   TO TRUE                      52008200
457100               SET DP013-NO-ROLLBACK TO TRUE                      52008300
457200               PERFORM 9999-WRITE-CICS-LOG-MSG                    52008400
457300               GO TO 0000-GOBACK                                  52008500
457400     END-EVALUATE.                                                52008600
457500                                                                  52008700
457600 7212-SELECT-SKU-STR.                                             52008800
457700                                                                  52008900
457800     EVALUATE TRUE                                                52009000
457900         WHEN XL001-SKU-STR-SQLCODE = ZERO                        52009100
458000               CONTINUE                                           52009200
458100                                                                  52009300
458200         WHEN XL001-SKU-STR-SQLCODE = PC-ROW-NOT-FOUND            52009400
458300               CONTINUE                                           52009500
458400                                                                  52009600
458500         WHEN OTHER                                               52009700
458600              MOVE '7212-SELECT-SKU-STR'                          52009800
458700                  TO DP013-PARAGRAPH                              52009900
458800              MOVE 'PROCESSING ITEM NBR: '                        52010000
458900                  TO DP013-MESSAGE-TEXT (1)                       52010100
459000              MOVE PURITM-ITM-NBR TO PV-DISPLAY-ITEM-NBR          52010200
459100              MOVE PV-DISPLAY-ITEM-NBR                            52010300
459200                  TO DP013-MESSAGE-TEXT (2)                       52010400
459300              MOVE XL001-SKU-STR-SQLCODE                          52010500
459400                                    TO SQLCODE                    52010600
459500              MOVE SQLCA            TO DP013-SQLCA                52010700
459600              MOVE 'XLV_SKU_STR'    TO DP013-DB2-TABLE-NAME (1)   52010800
459700              SET DP013-DB2-ABEND   TO TRUE                       52010900
459800              SET DP013-NO-ROLLBACK TO TRUE                       52011000
459900              PERFORM 9999-WRITE-CICS-LOG-MSG                     52011100
460000              GO TO 0000-GOBACK                                   52011200
460100        END-EVALUATE.                                             52011300
460200                                                                  52011400
460300/                                                                 52420000
460400 7220-SELECT-TRECITM.                                             52430000
460500                                                                  52440000
460600     EXEC SQL                                                     52450000
460700         SELECT COLOR_DESC                                        52460000
460800              , SIZE_DESC                                         52470000
460900           INTO :RECITM-COLOR-DESC                                52480000
461000              , :RECITM-SIZE-DESC                                 52490000
461100           FROM  TRECITM                                          52500000
461200           WHERE ORD_NBR         = :DK-ORD-NBR                    52510000
461300             AND ORD_LNE_NBR     = :DK-ORD-LNE-NBR                52520000
461400             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                52530000
461500             AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR               52540000
461600             AND VER_STATUS_CDE  = :PC-A                          52550000
461700     END-EXEC.                                                    52560000
461800                                                                  52570000
461900     EVALUATE TRUE                                                52580000
462000         WHEN SQLCODE = ZERO                                      52590000
462100         WHEN SQLCODE = +100                                      52600000
462200              CONTINUE                                            52610000
462300         WHEN SQLWARN0 NOT = SPACES                               52620000
462400         WHEN SQLCODE < ZERO                                      52630000
462500         WHEN SQLCODE > ZERO                                      52640000
462600              MOVE '7220-SELECT-TRECITM'                          52650000
462700                                     TO  DP013-PARAGRAPH          52660000
462800              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  52670000
462900                                     TO  DP013-MESSAGE-TEXT (1)   52680000
463000              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   52690000
463100              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   52700000
463200              MOVE SQLCA             TO  DP013-SQLCA              52710000
463300              MOVE 'TRECITM'         TO  DP013-DB2-TABLE-NAME (1) 52720000
463400              SET DP013-DB2-ABEND    TO  TRUE                     52730000
463500              SET DP013-NO-ROLLBACK  TO  TRUE                     52740000
463600              PERFORM 9999-WRITE-CICS-LOG-MSG                     52750000
463700              GO TO 0000-GOBACK                                   52760000
463800     END-EVALUATE.                                                52770000
463900/                                                                 52780000
464000     EJECT                                                        53090000
464100 7260-OPEN-TRBL-CSR.                                              53100000
464200     EXEC SQL                                                     53110000
464300         OPEN TRBL-CSR1                                           53120000
464400     END-EXEC.                                                    53130000
464500                                                                  53140000
464600     EVALUATE TRUE                                                53150000
464700         WHEN SQLCODE = ZERO                                      53160000
464800             CONTINUE                                             53170000
464900         WHEN SQLWARN0 NOT = SPACE                                53180000
465000         WHEN SQLCODE < ZERO                                      53190000
465100         WHEN SQLCODE > ZERO                                      53200000
465200             MOVE '7260-OPEN-TRBL-CSR'                            53210000
465300                 TO DP013-PARAGRAPH                               53220000
465400             MOVE 'OPEN THE TRBL-CSR'                             53230000
465500                 TO DP013-MESSAGE-TEXT (1)                        53240000
465600             MOVE SQLCA            TO DP013-SQLCA                 53250000
465700             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    53260000
465800             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    53270000
465900             SET DP013-DB2-ABEND   TO TRUE                        53280000
466000             SET DP013-NO-ROLLBACK TO TRUE                        53290000
466100             PERFORM 9999-WRITE-CICS-LOG-MSG                      53300000
466200             GO TO 0000-GOBACK                                    53310000
466300     END-EVALUATE.                                                53320000
466400*                                                                 53330000
466500 7265-OPEN-TRBL-CSR2.                                             53340000
466600     EXEC SQL                                                     53350000
466700         OPEN TRBL-CSR2                                           53360000
466800     END-EXEC.                                                    53370000
466900                                                                  53380000
467000     EVALUATE TRUE                                                53390000
467100         WHEN SQLCODE = ZERO                                      53400000
467200             CONTINUE                                             53410000
467300         WHEN SQLWARN0 NOT = SPACE                                53420000
467400         WHEN SQLCODE < ZERO                                      53430000
467500         WHEN SQLCODE > ZERO                                      53440000
467600             MOVE '7265-OPEN-TRBL-CSR2'                           53450000
467700                 TO DP013-PARAGRAPH                               53460000
467800             MOVE 'OPEN THE TRBL-CSR2'                            53470000
467900                 TO DP013-MESSAGE-TEXT (1)                        53480000
468000             MOVE SQLCA            TO DP013-SQLCA                 53490000
468100             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    53500000
468200             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    53510000
468300             SET DP013-DB2-ABEND   TO TRUE                        53520000
468400             SET DP013-NO-ROLLBACK TO TRUE                        53530000
468500             PERFORM 9999-WRITE-CICS-LOG-MSG                      53540000
468600             GO TO 0000-GOBACK                                    53550000
468700     END-EVALUATE.                                                53560000
468800*                                                                 53570000
468900 7270-FETCH-TRBL-CSR.                                             53580000
469000     INITIALIZE DCLTTRBRSN.                                       53590000
469100                                                                  53600000
469200     EXEC SQL                                                     53610000
469300         FETCH  TRBL-CSR1                                         53620000
469400          INTO  :TRBRSN-TRBL-LONG-DESC                            53630000
469500     END-EXEC.                                                    53640000
469600                                                                  53650000
469700     EVALUATE TRUE                                                53660000
469800         WHEN SQLCODE = ZERO                                      53670000
469900             CONTINUE                                             53680000
470000         WHEN SQLCODE = PC-ROW-NOT-FOUND                          53690000
470100             CONTINUE                                             53700000
470200         WHEN SQLWARN0 NOT = SPACE                                53710000
470300         WHEN SQLCODE < ZERO                                      53720000
470400         WHEN SQLCODE > ZERO                                      53730000
470500             MOVE '7270-FETCH-TRBL-CSR'                           53740000
470600                 TO DP013-PARAGRAPH                               53750000
470700             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 53760000
470800-                 'FROM THE TRBL-CSR'                             53770000
470900               TO DP013-MESSAGE-TEXT (1)                          53780000
471000             MOVE SQLCA            TO DP013-SQLCA                 53790000
471100             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    53800000
471200             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    53810000
471300             SET DP013-DB2-ABEND   TO TRUE                        53820000
471400             SET DP013-NO-ROLLBACK TO TRUE                        53830000
471500             PERFORM 9999-WRITE-CICS-LOG-MSG                      53840000
471600             GO TO 0000-GOBACK                                    53850000
471700     END-EVALUATE.                                                53860000
471800*                                                                 53870000
471900 7275-FETCH-TRBL-CSR2.                                            53880000
472000     INITIALIZE DCLTTRBRSN.                                       53890000
472100                                                                  53900000
472200     EXEC SQL                                                     53910000
472300         FETCH  TRBL-CSR2                                         53920000
472400          INTO  :TRBRSN-TRBL-LONG-DESC                            53930000
472500              , :TRBNTF-RESOLVED-IND                              53940000
472600     END-EXEC.                                                    53950000
472700                                                                  53960000
472800     EVALUATE TRUE                                                53970000
472900         WHEN SQLCODE = ZERO                                      53980000
473000             CONTINUE                                             53990000
473100         WHEN SQLCODE = PC-ROW-NOT-FOUND                          54000000
473200             CONTINUE                                             54010000
473300         WHEN SQLWARN0 NOT = SPACE                                54020000
473400         WHEN SQLCODE < ZERO                                      54030000
473500         WHEN SQLCODE > ZERO                                      54040000
473600             MOVE '7275-FETCH-TRBL-CSR2'                          54050000
473700                 TO DP013-PARAGRAPH                               54060000
473800             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 54070000
473900-                 'FROM THE TRBL-CSR2'                            54080000
474000               TO DP013-MESSAGE-TEXT (1)                          54090000
474100             MOVE SQLCA            TO DP013-SQLCA                 54100000
474200             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    54110000
474300             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    54120000
474400             SET DP013-DB2-ABEND   TO TRUE                        54130000
474500             SET DP013-NO-ROLLBACK TO TRUE                        54140000
474600             PERFORM 9999-WRITE-CICS-LOG-MSG                      54150000
474700             GO TO 0000-GOBACK                                    54160000
474800     END-EVALUATE.                                                54170000
474900*                                                                 54180000
475000 7280-CLOSE-TRBL-CSR.                                             54190000
475100     EXEC SQL                                                     54200000
475200         CLOSE TRBL-CSR1                                          54210000
475300     END-EXEC.                                                    54220000
475400                                                                  54230000
475500     EVALUATE TRUE                                                54240000
475600         WHEN SQLCODE = ZERO                                      54250000
475700             CONTINUE                                             54260000
475800         WHEN SQLWARN0 NOT = SPACE                                54270000
475900         WHEN SQLCODE < ZERO                                      54280000
476000         WHEN SQLCODE > ZERO                                      54290000
476100             MOVE '7280-CLOSE-TRBL-CSR'                           54300000
476200                 TO DP013-PARAGRAPH                               54310000
476300             MOVE 'CLOSE THE TRBL-CSR'                            54320000
476400                 TO DP013-MESSAGE-TEXT (1)                        54330000
476500             MOVE SQLCA            TO DP013-SQLCA                 54340000
476600             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    54350000
476700             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    54360000
476800             SET DP013-DB2-ABEND   TO TRUE                        54370000
476900             SET DP013-NO-ROLLBACK TO TRUE                        54380000
477000             PERFORM 9999-WRITE-CICS-LOG-MSG                      54390000
477100             GO TO 0000-GOBACK                                    54400000
477200     END-EVALUATE.                                                54410000
477300 7285-CLOSE-TRBL-CSR2.                                            54420000
477400     EXEC SQL                                                     54430000
477500         CLOSE TRBL-CSR2                                          54440000
477600     END-EXEC.                                                    54450000
477700                                                                  54460000
477800     EVALUATE TRUE                                                54470000
477900         WHEN SQLCODE = ZERO                                      54480000
478000             CONTINUE                                             54490000
478100         WHEN SQLWARN0 NOT = SPACE                                54500000
478200         WHEN SQLCODE < ZERO                                      54510000
478300         WHEN SQLCODE > ZERO                                      54520000
478400             MOVE '7285-CLOSE-TRBL-CSR2'                          54530000
478500                 TO DP013-PARAGRAPH                               54540000
478600             MOVE 'CLOSE THE TRBL-CSR2'                           54550000
478700                 TO DP013-MESSAGE-TEXT (1)                        54560000
478800             MOVE SQLCA            TO DP013-SQLCA                 54570000
478900             MOVE 'TTRBNTF'        TO DP013-DB2-TABLE-NAME (1)    54580000
479000             MOVE 'TTRBRSN'        TO DP013-DB2-TABLE-NAME (2)    54590000
479100             SET DP013-DB2-ABEND   TO TRUE                        54600000
479200             SET DP013-NO-ROLLBACK TO TRUE                        54610000
479300             PERFORM 9999-WRITE-CICS-LOG-MSG                      54620000
479400             GO TO 0000-GOBACK                                    54630000
479500     END-EVALUATE.                                                54640000
479600                                                                  54650000
479700*                                                                 54660000
479800 7300-GET-TPOPRPK-INFO.                                           54670000
479900                                                                  54680000
480000     PERFORM                                                      54690000
480100         WITH TEST AFTER                                          54700000
480200         VARYING PV-SELECT-COUNTER                                54710000
480300         FROM 1 BY 1                                              54720000
480400         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              54730000
480500            OR  (SQLCODE = ZERO)                                  54740000
480600            OR  (SQLCODE = PC-ROW-NOT-FOUND))                     54750000
480700                                                                  54760000
480800         EXEC SQL                                                 54770000
480900             SELECT PREPK_DESC                                    54780000
481000              INTO  :POPRPK-PREPK-DESC                            54790000
481100              FROM  TPOPRPK                                       54800000
481200              WHERE PO_NBR         = :DK-ORD-NBR                  54810000
481300                AND PO_PREPK_ID    = :DK-PREPK-ID                 54820000
481400         END-EXEC                                                 54830000
481500                                                                  54840000
481600         EVALUATE TRUE                                            54850000
481700             WHEN SQLCODE = ZERO                                  54860000
481800                 MOVE POPRPK-PREPK-DESC                           54870000
481900                                    TO HL9-PACK-DESCRIPTION       54880000
482000                 CONTINUE                                         54890000
482100             WHEN SQLCODE = -904                                  54900000
482200             WHEN SQLCODE = -913                                  54910000
482300                 CONTINUE                                         54920000
482400             WHEN SQLCODE = PC-ROW-NOT-FOUND                      54930000
482500                 MOVE 'DESCRIPTION NOT FOUND'                     54940000
482600                                    TO HL9-PACK-DESCRIPTION       54950000
482700                 CONTINUE                                         54960000
482800             WHEN SQLWARN0 NOT = SPACES                           54970000
482900             WHEN SQLCODE < ZERO                                  54980000
483000             WHEN SQLCODE > ZERO                                  54990000
483100                  MOVE '7300-GET-TPOPRPK-INFO'                    55000000
483200                                     TO DP013-PARAGRAPH           55010000
483300                  MOVE 'PREPACK DESCRIPTION FOR ORDER'            55020000
483400                                     TO DP013-MESSAGE-TEXT (1)    55030000
483500                  MOVE DK-ORD-NBR    TO  PV-DISPLAY-ORD-NBR       55040000
483600                  MOVE PV-DISPLAY-KEYS                            55050000
483700                                     TO DP013-MESSAGE-TEXT (2)    55060000
483800                  MOVE SQLCA         TO DP013-SQLCA               55070000
483900                  MOVE 'TPOPRPK'     TO DP013-DB2-TABLE-NAME (1)  55080000
484000                  SET DP013-DB2-ABEND                             55090000
484100                                     TO TRUE                      55100000
484200                  SET DP013-NO-ROLLBACK                           55110000
484300                                     TO TRUE                      55120000
484400                  PERFORM 9999-WRITE-CICS-LOG-MSG                 55130000
484500                  GO TO 0000-GOBACK                               55140000
484600         END-EVALUATE                                             55150000
484700     END-PERFORM.                                                 55160000
484800                                                                  55170000
484900     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       55180000
485000         MOVE '7300-GET-TPOPRPK-INFO' TO DP013-PARAGRAPH          55190000
485100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     55200000
485200                                     TO DP013-MESSAGE-TEXT (1)    55210000
485300         MOVE 'THE FOLLOWING ORDER'                               55220000
485400                                     TO DP013-MESSAGE-TEXT (2)    55230000
485500         MOVE DK-ORD-NBR             TO  PV-DISPLAY-ORD-NBR       55240000
485600         MOVE PV-DISPLAY-KEYS        TO DP013-MESSAGE-TEXT (3)    55250000
485700         MOVE SQLCA                  TO DP013-SQLCA               55260000
485800         MOVE 'TPPORPK'              TO DP013-DB2-TABLE-NAME (1)  55270000
485900         SET DP013-DB2-ABEND         TO TRUE                      55280000
486000         SET DP013-NO-ROLLBACK       TO TRUE                      55290000
486100         PERFORM 9999-WRITE-CICS-LOG-MSG                          55300000
486200         GO TO 0000-GOBACK                                        55310000
486300     END-IF.                                                      55320000
486400     EJECT                                                        55330000
486500 7320-OPEN-RECDIS-CSR.                                            55340000
486600     EXEC SQL                                                     55350000
486700         OPEN RECDIS-CSR                                          55360000
486800     END-EXEC.                                                    55370000
486900                                                                  55380000
487000     EVALUATE TRUE                                                55390000
487100         WHEN SQLCODE = ZERO                                      55400000
487200             CONTINUE                                             55410000
487300         WHEN SQLWARN0 NOT = SPACE                                55420000
487400         WHEN SQLCODE < ZERO                                      55430000
487500         WHEN SQLCODE > ZERO                                      55440000
487600             MOVE '7320-OPEN-RECDIS-CSR'                          55450000
487700                 TO DP013-PARAGRAPH                               55460000
487800             MOVE 'OPEN THE RECDIS-CSR'                           55470000
487900                 TO DP013-MESSAGE-TEXT (1)                        55480000
488000             MOVE SQLCA             TO DP013-SQLCA                55490000
488100             MOVE 'TRECDIS'         TO DP013-DB2-TABLE-NAME (1)   55500000
488200             SET DP013-DB2-ABEND    TO TRUE                       55510000
488300             SET DP013-NO-ROLLBACK  TO TRUE                       55520000
488400             PERFORM 9999-WRITE-CICS-LOG-MSG                      55530000
488500             GO TO 0000-GOBACK                                    55540000
488600     END-EVALUATE.                                                55550000
488700*                                                                 55560000
488800 7330-FETCH-RECDIS-CSR.                                           55570000
488900     INITIALIZE DCLTRECDIS.                                       55580000
489000                                                                  55590000
489100     EXEC SQL                                                     55600000
489200         FETCH  RECDIS-CSR                                        55610000
489300          INTO  :PV-UNION-IND,                                    55620000
489400                :RECDIS-STR-NBR,                                  55630000
489500                :RECDIS-EXPTED-ITM-QTY                            55640000
489600     END-EXEC.                                                    55650000
489700                                                                  55660000
489800     EVALUATE TRUE                                                55670000
489900         WHEN SQLCODE = ZERO                                      55680000
490000              IF PV-UNION-IND = PC-A                              55690000
490100                  ADD 1 TO PV-STR-CNT                             55700000
490200              END-IF                                              55710000
490300         WHEN SQLCODE = PC-ROW-NOT-FOUND                          55720000
490400             CONTINUE                                             55730000
490500         WHEN SQLWARN0 NOT = SPACE                                55740000
490600         WHEN SQLCODE < ZERO                                      55750000
490700         WHEN SQLCODE > ZERO                                      55760000
490800             MOVE '7330-FETCH-RECDIS-CSR'                         55770000
490900                 TO DP013-PARAGRAPH                               55780000
491000             MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 55790000
491100-                 'FROM THE RECDIS-CSR'                           55800000
491200                 TO DP013-MESSAGE-TEXT (1)                        55810000
491300             MOVE SQLCA            TO DP013-SQLCA                 55820000
491400             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    55830000
491500             SET DP013-DB2-ABEND   TO TRUE                        55840000
491600             SET DP013-NO-ROLLBACK TO TRUE                        55850000
491700             PERFORM 9999-WRITE-CICS-LOG-MSG                      55860000
491800             GO TO 0000-GOBACK                                    55870000
491900     END-EVALUATE.                                                55880000
492000     SKIP2                                                        55890000
492100 7340-CLOSE-RECDIS-CSR.                                           55900000
492200     EXEC SQL                                                     55910000
492300         CLOSE RECDIS-CSR                                         55920000
492400     END-EXEC.                                                    55930000
492500                                                                  55940000
492600     EVALUATE TRUE                                                55950000
492700         WHEN SQLCODE = ZERO                                      55960000
492800             CONTINUE                                             55970000
492900         WHEN SQLWARN0 NOT = SPACE                                55980000
493000         WHEN SQLCODE < ZERO                                      55990000
493100         WHEN SQLCODE > ZERO                                      56000000
493200             MOVE '7340-CLOSE-RECDIS-CSR'                         56010000
493300                 TO DP013-PARAGRAPH                               56020000
493400             MOVE 'CLOSE THE RECDIS-CSR'                          56030000
493500                 TO DP013-MESSAGE-TEXT (1)                        56040000
493600             MOVE SQLCA            TO DP013-SQLCA                 56050000
493700             MOVE 'TRECDIS'        TO DP013-DB2-TABLE-NAME (1)    56060000
493800             SET DP013-DB2-ABEND   TO TRUE                        56070000
493900             SET DP013-NO-ROLLBACK TO TRUE                        56080000
494000             PERFORM 9999-WRITE-CICS-LOG-MSG                      56090000
494100             GO TO 0000-GOBACK                                    56100000
494200     END-EVALUATE.                                                56110000
494300     EJECT                                                        58890000
494400 7410-SELECT-MKING-TMST.                                          58900000
494500                                                                  58910000
494600     EXEC SQL                                                     58920000
494700         SELECT MKING_APRON_TMST                                  58930000
494800           INTO :RECITM-MKING-APRON-TMST                          58940000
494900           FROM  TRECITM                                          58950000
495000           WHERE ORD_NBR         = :DK-ORD-NBR                    58960000
495100             AND ORD_LNE_NBR     = :PV-DRIVER-LINE-NBR            58970000
495200             AND OPER_UNT_ID     = :DK-OPER-UNT-ID                58980000
495300             AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR               58990000
495400             AND VER_STATUS_CDE  = :PC-A                          59000000
495500     END-EXEC.                                                    59010000
495600                                                                  59020000
495700     EVALUATE TRUE                                                59030000
495800         WHEN SQLCODE = ZERO                                      59040000
495900              SET PS-YES-TRECITM     TO TRUE                      59050000
496000         WHEN SQLCODE = +100                                      59060000
496100              SET PS-NO-TRECITM      TO TRUE                      59070000
496200              MOVE PC-DB2-ZERO-DATE-TIME                          59080000
496300                                     TO RECITM-MKING-APRON-TMST   59090000
496400         WHEN SQLWARN0 NOT = SPACES                               59100000
496500         WHEN SQLCODE < ZERO                                      59110000
496600         WHEN SQLCODE > ZERO                                      59120000
496700              MOVE '7410-SELECT-MKING-TMST'                       59130000
496800                                     TO  DP013-PARAGRAPH          59140000
496900              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  59150000
497000                                     TO  DP013-MESSAGE-TEXT (1)   59160000
497100              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   59170000
497200              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   59180000
497300              MOVE SQLCA             TO  DP013-SQLCA              59190000
497400              MOVE 'TRECITM'         TO  DP013-DB2-TABLE-NAME (1) 59200000
497500              SET DP013-DB2-ABEND    TO  TRUE                     59210000
497600              SET DP013-NO-ROLLBACK  TO  TRUE                     59220000
497700              PERFORM 9999-WRITE-CICS-LOG-MSG                     59230000
497800              GO TO 0000-GOBACK                                   59240000
497900     END-EVALUATE.                                                59250000
498000     EJECT                                                        59260000
498100 7420-UPDATE-TRECITM-TMST.                                        59270000
498200                                                                  59280000
498300     PERFORM                                                      59290000
498400         WITH TEST AFTER                                          59300000
498500         VARYING PV-RETRY-COUNTER                                 59310000
498600         FROM 1 BY 1                                              59320000
498700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59330000
498800             OR (SQLCODE = +0))                                   59340000
498900                                                                  59350000
499000         EXEC SQL                                                 59360000
499100             UPDATE TRECITM                                       59370000
499200               SET  MKING_APRON_TMST     = CURRENT TIMESTAMP      59380000
499300               WHERE ORD_NBR         = :DK-ORD-NBR                59390000
499400                 AND ORD_LNE_NBR     = :PV-DRIVER-LINE-NBR        59400000
499500                 AND OPER_UNT_ID     = :DK-OPER-UNT-ID            59410000
499600                 AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR           59420000
499700                 AND VER_STATUS_CDE  = :PC-A                      59430000
499800         END-EXEC                                                 59440000
499900                                                                  59450000
500000         EVALUATE TRUE                                            59460000
500100             WHEN SQLCODE = +0                                    59470000
500200                 SET PS-UPDATES-DONE         TO TRUE              59480000
500300             WHEN SQLCODE = -904                                  59490000
500400             WHEN SQLCODE = -913                                  59500000
500500                 CONTINUE                                         59510000
500600                                                                  59520000
500700             WHEN SQLWARN0 NOT = SPACES                           59530000
500800             WHEN SQLCODE < +0                                    59540000
500900             WHEN SQLCODE > +0                                    59550000
501000                 MOVE '7420-UPDATE-TRECITM-TMST'                  59560000
501100                                   TO DP013-PARAGRAPH             59570000
501200                 MOVE 'UPDATE TIMESTMP ON TRECITM'                59580000
501300                                   TO DP013-MESSAGE-TEXT(1)       59590000
501400                 MOVE SQLCA        TO DP013-SQLCA                 59600000
501500                 MOVE 'TRECITM'    TO DP013-DB2-TABLE-NAME (1)    59610000
501600                 SET DP013-DB2-ABEND    TO  TRUE                  59620000
501700                 SET DP013-ROLLBACK  TO  TRUE                     59630000
501800                 PERFORM 9999-WRITE-CICS-LOG-MSG                  59640000
501900                 GO TO 0000-GOBACK                                59650000
502000         END-EVALUATE                                             59660000
502100                                                                  59670000
502200     END-PERFORM.                                                 59680000
502300                                                                  59690000
502400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND SQLCODE > ZERO     59700000
502500         MOVE '7420-UPDATE-TRECITM-TMST'                          59710000
502600                                   TO DP013-PARAGRAPH             59720000
502700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              59730000
502800                                   TO DP013-MESSAGE-TEXT (1)      59740000
502900         MOVE 'TO UPDATE A TRECITM ROW'                           59750000
503000                                   TO DP013-MESSAGE-TEXT (2)      59760000
503100         MOVE SQLCA                TO DP013-SQLCA                 59770000
503200         MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)    59780000
503300         SET DP013-DB2-ABEND       TO  TRUE                       59790000
503400         SET DP013-NO-ROLLBACK     TO  TRUE                       59800000
503500         PERFORM 9999-WRITE-CICS-LOG-MSG                          59810000
503600         GO TO 0000-GOBACK                                        59820000
503700     END-IF.                                                      59830000
503800     EJECT                                                        59840000
503900* * * LINK TO THE PACK VALIDATION ROUTINE                         60890000
504000 7800-LINK-RCKCS806.                                              60900000
504100     EXEC CICS LINK                                               60910000
504200         PROGRAM  ('RCKCS806')                                    60920000
504300         COMMAREA (RC806-PRODUCT-PACK-VALIDATION)                 60930000
504400         RESP     (PV-CICS-RESP)                                  60940000
504500     END-EXEC.                                                    60950000
504600                                                                  60960000
504700*  CHECK CICS RETURN CODE                                         60970000
504800     IF PV-CICS-RESP = DFHRESP(NORMAL)                            60980000
504900         CONTINUE                                                 60990000
505000     ELSE                                                         61000000
505100         MOVE '7800-LINK-RCKCS806'                                61010000
505200                              TO DP013-PARAGRAPH                  61020000
505300         MOVE 'TRYING TO LINK TO RCKCS806'                        61030000
505400                     TO DP013-MESSAGE-TEXT (1)                    61040000
505500         MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)           61050000
505600         MOVE SQLCA           TO DP013-SQLCA                      61060000
505700         SET DP013-LINK-RETURN                                    61070000
505800             DP013-CICS-ABEND                                     61080000
505900             DP013-NO-ROLLBACK TO TRUE                            61090000
506000         PERFORM 9999-WRITE-CICS-LOG-MSG                          61100000
506100         GO TO 0000-GOBACK                                        61110000
506200     END-IF.                                                      61120000
506300                                                                  61130000
506400*  CHECK RC806-ERROR-FLAG                                         61140000
506500     EVALUATE TRUE                                                61150000
506600     WHEN RC806-NO-ERRORS                                         61160000
506700         CONTINUE                                                 61170000
506800     WHEN OTHER                                                   61180000
506900         EVALUATE TRUE                                            61190000
507000         WHEN RC806-INV-LINE-DATA                                 61200000
507100         WHEN RC806-INV-FUNCTION-CD                               61210000
507200         WHEN RC806-INV-NBR-OF-LINES                              61220000
507300             MOVE '7800-LINK-RCKCS806'                            61230000
507400                              TO DP013-PARAGRAPH                  61240000
507500             STRING 'VALIDATION DATA ERROR '                      61250000
507600                     RC806-FUNCTION-STATUS                        61260000
507700                   DELIMITED BY SIZE INTO                         61270000
507800                                     DP013-MESSAGE-TEXT (1)       61280000
507900             MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)       61290000
508000             MOVE SQLCA           TO DP013-SQLCA                  61300000
508100             SET DP013-LINK-RETURN                                61310000
508200                 DP013-CICS-ABEND                                 61320000
508300                 DP013-NO-ROLLBACK TO TRUE                        61330000
508400             PERFORM 9999-WRITE-CICS-LOG-MSG                      61340000
508500             GO TO 0000-GOBACK                                    61350000
508600     END-EVALUATE.                                                61360000
508700                                                                  61370000
508800*----------------------------------------------------------------*61380000
508900*    START TRANID FOR PCKCS014 (MARKING APRON RTV PAGES)         *61390000
509000*----------------------------------------------------------------*61400000
509100 7900-START-TRANID-E014.                                          61410000
509200                                                                  61420000
509300                                                                  61430000
509400     EXEC CICS                                                    61440000
509500         LINK PROGRAM  (PC-PCKCS014)                              61450000
509600              COMMAREA (CA-PCKCS014-COMMAREA)                     61460000
509700              RESP     (PV-CICS-RESPONSE)                         61470000
509800     END-EXEC.                                                    61480000
509900                                                                  61490000
510000     EVALUATE TRUE                                                61500000
510100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 61510000
510200             CONTINUE                                             61520000
510300         WHEN OTHER                                               61530000
510400               MOVE '7900-START-TRANID-E014'                      61540000
510500                                    TO DP013-PARAGRAPH            61550000
510600               MOVE 'ATTEMPTING TO LINK TO E014 '                 61560000
510700                     TO DP013-MESSAGE-TEXT (1)                    61570000
510800               MOVE PV-DISPLAY-KEYS TO DP013-MESSAGE-TEXT (2)     61580000
510900               MOVE SQLCA           TO DP013-SQLCA                61590000
511000               SET DP013-LINK-RETURN                              61600000
511100                   DP013-CICS-ABEND                               61610000
511200                   DP013-NO-ROLLBACK TO TRUE                      61620000
511300               PERFORM 9999-WRITE-CICS-LOG-MSG                    61630000
511400               GO TO 0000-GOBACK                                  61640000
511500     END-EVALUATE.                                                61650000
511600                                                                  61660000
511700/                                                                 61670000
511800* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     61680000
511900******************************************************************61690000
512000 8000-LINK-TO-DRS.                                                61700000
512100                                                                  61710000
512200*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        61720000
512300*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          61730000
512400*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              61740000
512500     EXEC CICS                                                    61750000
512600         LINK                                                     61760000
512700             PROGRAM   ('DRS1INTC')                               61770000
512800             COMMAREA  (DRS01-COMMAREA)                           61780000
512900     END-EXEC.                                                    61790000
513000                                                                  61800000
513100     EVALUATE TRUE                                                61810000
513200         WHEN DRS01-DRRB-RC = ZERO                                61820000
513300             CONTINUE                                             61830000
513400         WHEN OTHER                                               61840000
513500             MOVE '8000-LINK-TO-DRS'    TO DP013-PARAGRAPH        61850000
513600             SET DP013-OTHER-ABEND      TO TRUE                   61860000
513700             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       61870000
513800             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        61880000
513900             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    61890000
514000             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         61900000
514100             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      61910000
514200             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       61920000
514300             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      61930000
514400             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      61940000
514500                 TO DP013-MESSAGE-TEXT (1)                        61950000
514600             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      61960000
514700                 TO DP013-MESSAGE-TEXT (2)                        61970000
514800             SET DP013-LINK-RETURN      TO TRUE                   61980000
514900             PERFORM DP013-0000-PROCESS-ABEND                     61990000
515000             GO TO 0000-GOBACK                                    62000000
515100     END-EVALUATE.                                                62010000
515200     EJECT                                                        62020000
515300******************************************************************62030000
515400* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *62040000
515500******************************************************************62050000
515600 9100-READ-SEL-QUEUE.                                             62060000
515700     EXEC CICS                                                    62070000
515800         READQ TS                                                 62080000
515900             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        62090000
516000             INTO  (PC016-TS-SEL-REC)                             62100000
516100             ITEM  (PV-ITEM-NBR)                                  62110000
516200             NUMITEMS (PV-NUM-ITEMS)                              62120000
516300             RESP  (PV-CICS-RESP)                                 62130000
516400     END-EXEC.                                                    62140000
516500                                                                  62150000
516600     EVALUATE TRUE                                                62160000
516700     WHEN PV-CICS-RESP EQUAL DFHRESP(NORMAL)                      62170000
516800         CONTINUE                                                 62180000
516900     WHEN PV-CICS-RESP EQUAL DFHRESP(ITEMERR)                     62190000
517000         SET PS-EOF-QUEUE TO TRUE                                 62200000
517100     WHEN OTHER                                                   62210000
517200         MOVE '9100-READ-SEL-QUEUE'                               62220000
517300             TO DP013-PARAGRAPH                                   62230000
517400         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    62240000
517500             TO DP013-MESSAGE-TEXT (1)                            62250000
517600         SET DP013-CICS-ABEND  TO TRUE                            62260000
517700         SET DP013-NO-ROLLBACK TO TRUE                            62270000
517800         PERFORM 9999-WRITE-CICS-LOG-MSG                          62280000
517900         GO TO 0000-GOBACK                                        62290000
518000     END-EVALUATE.                                                62300000
518100     EJECT                                                        62310000
518200 9200-GET-NEXT-PO.                                                62320000
518300                                                                  62330000
518400     SET PC016-IDX UP BY 1                                        62340000
518500                                                                  62350000
518600     IF (PC016-IDX > PC016-MAX-ITEMS)   OR                        62360000
518700                           (PC016-ITEM (PC016-IDX) NOT > ZERO)    62370000
518800         ADD +1                  TO PV-ITEM-NBR                   62380000
518900         IF PV-ITEM-NBR > PV-NUM-ITEMS                            62390000
519000             SET PS-EOF-QUEUE    TO TRUE                          62400000
519100         ELSE                                                     62410000
519200             PERFORM 9100-READ-SEL-QUEUE                          62420000
519300             SET PC016-IDX       TO 1                             62430000
519400         END-IF                                                   62440000
519500     END-IF.                                                      62450000
519600                                                                  62460000
519700     EVALUATE TRUE                                                62470000
519800     WHEN PS-EOF-QUEUE                                            62480000
519900         CONTINUE                                                 62490000
520000     WHEN PC016-ITEM (PC016-IDX) > ZERO                           62500000
520100         MOVE PC016-PO-NBR-N (PC016-IDX)                          62510000
520200                                 TO DK-ORD-NBR                    62520000
520300                                    CA-ORD-NBR                    62530000
520400         MOVE PC016-REC-SEQ-NBR-N (PC016-IDX)                     62540000
520500                                 TO DK-RCVR-SEQ-NBR               62550000
520600                                    CA-RCVR-SEQ-NBR               62560000
520700         MOVE PC016-PACK-ID (PC016-IDX)                           62570000
520800                                 TO DK-PREPK-ID                   62580000
520900                                    HL7-PACK-ID                   62590000
521000*        MOVE PC016-LINE-NBR-N (PC016-IDX)                        62600000
521100*                                TO DK-ORD-LNE-NBR                62610000
521200*                                   CA-ORD-LNE-NBR                62620000
521300         MOVE PC016-WO-NBR-N(PC016-IDX)                           62630000
521400                                 TO  DK-WORK-ORD-SEQ-NBR          62640000
521500                                     CA-WORK-ORD-SEQ-NBR          62650000
521600                                                                  62660000
521700         MOVE PC016-OPER-UNT-ID (PC016-IDX)                       62670000
521800                                 TO DK-OPER-UNT-ID                62680000
521900                                    CA-OPER-UNT-ID                62690000
522000         MOVE PC016-FCLTY-ID (PC016-IDX)                          62700000
522100                                 TO DK-FCLTY-ID                   62710000
522200                                    CA-FCLTY-ID                   62720000
522300                                                                  62730000
522400         PERFORM 4050-SELECT-PRIM-SHIP                            62740000
522500                                                                  62750000
522600         MOVE CA-RCVR-SEQ-NBR-X  TO  HL2-RCVR-SEQ-NBR             62760000
522700*        MOVE CA-ORD-LNE-NBR-X   TO  DL-LINE-NBR                  62770000
522800                                                                  62780000
522900        INITIALIZE EA-EXPTED-ALLOC-TABLE                          62790000
523000                   RA-RTV-ALLOC-TABLE                             62800000
523100        MOVE ZERO  TO  PV-TOT-EXPTED-ITM-CNT                      62810000
523200                       PV-STORES-GIVEN-PIECES                     62820000
523300                       PV-TOT-RTV-EXPTED-ITM-CNT                  62830000
523400                       PV-STR-CNT                                 62840000
523500                       PV-RTV-STORES                              62850000
523600        SET EA-ALLOC-IDX         TO 1                             62860000
523700        SET RA-ALLOC-IDX         TO 1                             62870000
523800                                                                  62880000
523900     WHEN PC016-ITEM (PC016-IDX) NOT > ZERO                       62890000
524000        SET PS-EOF-QUEUE         TO TRUE                          62900000
524100     END-EVALUATE.                                                62910000
524200                                                                  62920000
524300/                                                                 62930000
524400 9998-WRITE-CSSL.                                                 62940000
524500     EXEC CICS                                                    62950000
524600         WRITEQ TD                                                62960000
524700             QUEUE  ('CSSL')                                      62970000
524800             FROM   (PV-CICS-MSG-AREA)                            62980000
524900             RESP   (PV-CICS-RESP)                                62990000
525000     END-EXEC.                                                    63000000
525100                                                                  63010000
525200 9999-WRITE-CICS-LOG-MSG.                                         63020000
525300                                                                  63030000
525400     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              63040000
525500     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             63050000
525600                                                                  63060000
525700     MOVE PC-PUT                     TO  DRS01-DRRB-FUNC.         63070000
525800                                                                  63080000
525900     MOVE SD-SYSTEM-MONTH            TO  HL1-RUN-MONTH.           63090000
526000     MOVE SD-SYSTEM-DAY              TO  HL1-RUN-DAY.             63100000
526100     MOVE SD-SYSTEM-YEAR             TO  HL1-RUN-YEAR.            63110000
526200     MOVE ST-SYSTEM-HOUR             TO  HL1-RUN-HOUR.            63120000
526300     MOVE ST-SYSTEM-MINUTE           TO  HL1-RUN-MINUTE.          63130000
526400                                                                  63140000
526500     MOVE PC-ONE                     TO  HL1-PGE-NBR              63150000
526600                                         HL1-OF-PGE-NBR.          63160000
526700     MOVE PC-APRON-RPT-HDR           TO HL1-RPT-HDR               63170000
526800     MOVE HL1-HEADING-LINE-1         TO  DRS01-COMM-DATA.         63180000
526900     IF PS-TOP-OF-PAGE-SET                                        63190000
527000         MOVE PC-DOUBLE-SPACE        TO  DRS01-COMM-CTL           63200000
527100     ELSE                                                         63210000
527200         MOVE PC-TOP-OF-PAGE         TO  DRS01-COMM-CTL           63220000
527300     END-IF.                                                      63230000
527400     SET PS-TOP-OF-PAGE-NOT-SET TO TRUE.                          63240000
527500     PERFORM 8000-LINK-TO-DRS.                                    63250000
527600                                                                  63260000
527700     MOVE HL2-HEADING-LINE-2         TO  DRS01-COMM-DATA.         63270000
527800     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          63280000
527900     PERFORM 8000-LINK-TO-DRS.                                    63290000
528000                                                                  63300000
528100     MOVE CA-PREPARER-USER-ID        TO  HL9-PREPARER-USER-ID.    63310000
528200     MOVE CA-DESTINATION             TO  HL9-PRINTER-DEST.        63320000
528300     MOVE HL3-HEADING-LINE-3         TO  DRS01-COMM-DATA.         63330000
528400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63340000
528500     PERFORM 8000-LINK-TO-DRS.                                    63350000
528600                                                                  63360000
528700     MOVE HL4-HEADING-LINE-4         TO  DRS01-COMM-DATA.         63370000
528800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63380000
528900     PERFORM 8000-LINK-TO-DRS.                                    63390000
529000                                                                  63400000
529100     MOVE HL5-HEADING-LINE-5         TO  DRS01-COMM-DATA.         63410000
529200     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63420000
529300     PERFORM 8000-LINK-TO-DRS.                                    63430000
529400                                                                  63440000
529500     MOVE HL6-HEADING-LINE-6         TO  DRS01-COMM-DATA.         63450000
529600     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63460000
529700     PERFORM 8000-LINK-TO-DRS.                                    63470000
529800                                                                  63480000
529900     MOVE HL7-HEADING-LINE-7         TO  DRS01-COMM-DATA.         63490000
530000     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63500000
530100     PERFORM 8000-LINK-TO-DRS.                                    63510000
530200                                                                  63520000
530300     MOVE HL8-HEADING-LINE-8         TO  DRS01-COMM-DATA.         63530000
530400     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63540000
530500     PERFORM 8000-LINK-TO-DRS.                                    63550000
530600                                                                  63560000
530700     MOVE HL9-HEADING-LINE-9         TO  DRS01-COMM-DATA.         63570000
530800     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63580000
530900     PERFORM 8000-LINK-TO-DRS.                                    63590000
531000                                                                  63600000
531100     MOVE DH1-DETAIL-HEADING-LINE-1  TO  DRS01-COMM-DATA.         63610000
531200     MOVE PC-DOUBLE-SPACE            TO  DRS01-COMM-CTL.          63620000
531300     PERFORM 8000-LINK-TO-DRS.                                    63630000
531400                                                                  63640000
531500     MOVE DH2-DETAIL-HEADING-LINE-2  TO  DRS01-COMM-DATA.         63650000
531600     MOVE PC-SINGLE-SPACE            TO  DRS01-COMM-CTL.          63660000
531700     PERFORM 8000-LINK-TO-DRS.                                    63670000
531800                                                                  63680000
531900     MOVE PC-ABEND-MESSAGE         TO  DRS01-COMM-DATA.           63690000
532000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63700000
532100     PERFORM 8000-LINK-TO-DRS.                                    63710000
532200                                                                  63720000
532300     MOVE DP013-PARAGRAPH          TO  DRS01-COMM-DATA.           63730000
532400     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63740000
532500     PERFORM 8000-LINK-TO-DRS.                                    63750000
532600     MOVE DP013-MESSAGE-TEXT (1)   TO  DRS01-COMM-DATA.           63760000
532700     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63770000
532800     PERFORM 8000-LINK-TO-DRS.                                    63780000
532900     MOVE DP013-MESSAGE-TEXT (2)   TO  DRS01-COMM-DATA.           63790000
533000     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63800000
533100     PERFORM 8000-LINK-TO-DRS.                                    63810000
533200     MOVE DP013-MESSAGE-TEXT (3)   TO  DRS01-COMM-DATA.           63820000
533300     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63830000
533400     PERFORM 8000-LINK-TO-DRS.                                    63840000
533500     MOVE DP013-DB2-TABLE-NAME (1) TO  DRS01-COMM-DATA.           63850000
533600     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63860000
533700     PERFORM 8000-LINK-TO-DRS.                                    63870000
533800     MOVE DP013-DB2-TABLE-NAME (2) TO  DRS01-COMM-DATA.           63880000
533900     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63890000
534000     PERFORM 8000-LINK-TO-DRS.                                    63900000
534100     MOVE DP013-DB2-TABLE-NAME (3) TO  DRS01-COMM-DATA.           63910000
534200     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63920000
534300     PERFORM 8000-LINK-TO-DRS.                                    63930000
534400     MOVE SQLCODE TO PV-SQLCODE.                                  63940000
534500     MOVE PV-SQLCODE-NUMBER        TO  DRS01-COMM-DATA.           63950000
534600     MOVE PC-DOUBLE-SPACE          TO  DRS01-COMM-CTL.            63960000
534700     PERFORM 8000-LINK-TO-DRS.                                    63970000
534800                                                                  63980000
534900     SET DP013-LINK-RETURN         TO TRUE.                       63990000
535000     PERFORM DP013-0000-PROCESS-ABEND.                            64000000
535100                                                                  64010000
535200     COPY DPPD013.                                                64020000
535300/                                                                 64030000
