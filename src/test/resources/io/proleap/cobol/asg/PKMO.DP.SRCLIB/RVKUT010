000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.   RVKUT010.                                          00050000
000600 AUTHOR.       GERMAN BANDA.                                      00060000
000700 INSTALLATION. KOHLS DEPARTMENT STORES.                           00070000
000800 DATE-WRITTEN. FEBRUARY 2023.                                     00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200*  RTV - INMAR FILES: INITIAL CHECK OF INMAR SHIPMENT FILES       00120019
001300*  1)        EXPECTING 1 DETAIL FILE AND 1 HEADER FILE            00130019
001400*  2)        THE DETAIL FILE SHOULD CONTAIN 1 CONTROL RECORD      00140019
001410*  3)        IF THE DETAIL FILE CONTAINS A CONTROL RECORD ONLY    00141019
001420*            THEN THE HEADER FILE SHOULD BE EMPTY                 00142019
001430*  4)        IF THE DETAIL FILE HAS A CONTROL RECORD AND DETAIL   00143019
001440*            RECORDS, THEN THE HEADER FILE SHOULD CONTAIN         00144019
001450*            ASSOCIATED RECORDS                                   00145019
001460*    FOR ERROR RECORDS, THEY WILL BE WRITTEN TO AN ERROR FILE THAT00146019
001470*    WILL BE EMAILED TO THE SUPPORT TEAM FOR REVIEW               00147019
001500*----------------------------------------------------------------*00150000
002300 ENVIRONMENT DIVISION.                                            00230000
002400*----------------------------------------------------------------*00240000
002500                                                                  00250000
002600 CONFIGURATION SECTION.                                           00260000
002700                                                                  00270000
002800 SOURCE-COMPUTER.        IBM-3090.                                00280000
002900 OBJECT-COMPUTER.        IBM-3090.                                00290000
003000                                                                  00300000
003100 INPUT-OUTPUT SECTION.                                            00310000
003200                                                                  00320000
003300 FILE-CONTROL.                                                    00330000
003400                                                                  00340000
003500     SELECT RTV-DTL-FILE-561      ASSIGN TO INP01.                00350005
003510     SELECT RTV-DTL-FILE-566      ASSIGN TO INP02.                00351005
003520     SELECT RTV-DTL-FILE-582      ASSIGN TO INP03.                00352005
003530     SELECT RTV-DTL-FILE-629      ASSIGN TO INP04.                00353005
003540     SELECT RTV-DTL-FILE-635      ASSIGN TO INP05.                00354005
003550     SELECT RTV-DTL-FILE-811      ASSIGN TO INP06.                00355005
003600     SELECT RTV-HDR-FILE-561      ASSIGN TO INP07.                00360005
003601     SELECT RTV-HDR-FILE-566      ASSIGN TO INP08.                00360105
003602     SELECT RTV-HDR-FILE-582      ASSIGN TO INP09.                00360205
003603     SELECT RTV-HDR-FILE-629      ASSIGN TO INP10.                00360305
003604     SELECT RTV-HDR-FILE-635      ASSIGN TO INP11.                00360405
003605     SELECT RTV-HDR-FILE-811      ASSIGN TO INP12.                00360505
003606     SELECT RTV-ERROR-MESSG-FILE  ASSIGN TO OUT01.                00360606
003607                                                                  00360706
003608*----------------------------------------------------------------*00360806
003609 DATA DIVISION.                                                   00360906
003610*----------------------------------------------------------------*00361006
003611                                                                  00361106
003612 FILE SECTION.                                                    00361206
003613                                                                  00361306
003614 FD  RTV-DTL-FILE-561                                             00361406
003615     RECORDING MODE IS F                                          00361506
003616     LABEL RECORDS ARE STANDARD                                   00361606
003620     BLOCK CONTAINS 0 RECORDS.                                    00362000
003630                                                                  00363000
003640 01  RTV-DTL-RECORD-561               PIC X(200).                 00364005
003650                                                                  00365000
003660 FD  RTV-HDR-FILE-561                                             00366005
003670     RECORDING MODE IS F                                          00367000
003680     LABEL RECORDS ARE STANDARD                                   00368000
003690     BLOCK CONTAINS 0 RECORDS.                                    00369000
003700                                                                  00370000
003800 01  RTV-HDR-RECORD-561               PIC X(550).                 00380005
003801                                                                  00380100
003802 FD  RTV-DTL-FILE-566                                             00380200
003803     RECORDING MODE IS F                                          00380300
003804     LABEL RECORDS ARE STANDARD                                   00380400
003805     BLOCK CONTAINS 0 RECORDS.                                    00380500
003806                                                                  00380600
003807 01  RTV-DTL-RECORD-566               PIC X(200).                 00380700
003808                                                                  00380800
003809 FD  RTV-HDR-FILE-566                                             00380900
003810     RECORDING MODE IS F                                          00381000
003811     LABEL RECORDS ARE STANDARD                                   00381100
003812     BLOCK CONTAINS 0 RECORDS.                                    00381200
003813                                                                  00381300
003814 01  RTV-HDR-RECORD-566               PIC X(550).                 00381400
003815                                                                  00381500
003816 FD  RTV-DTL-FILE-582                                             00381600
003817     RECORDING MODE IS F                                          00381700
003818     LABEL RECORDS ARE STANDARD                                   00381800
003819     BLOCK CONTAINS 0 RECORDS.                                    00381900
003820                                                                  00382000
003821 01  RTV-DTL-RECORD-582               PIC X(200).                 00382100
003822                                                                  00382200
003823 FD  RTV-HDR-FILE-582                                             00382300
003824     RECORDING MODE IS F                                          00382400
003825     LABEL RECORDS ARE STANDARD                                   00382500
003826     BLOCK CONTAINS 0 RECORDS.                                    00382600
003827                                                                  00382700
003828 01  RTV-HDR-RECORD-582               PIC X(550).                 00382800
003829                                                                  00382900
003830 FD  RTV-DTL-FILE-629                                             00383000
003831     RECORDING MODE IS F                                          00383100
003832     LABEL RECORDS ARE STANDARD                                   00383200
003833     BLOCK CONTAINS 0 RECORDS.                                    00383300
003834                                                                  00383400
003835 01  RTV-DTL-RECORD-629               PIC X(200).                 00383500
003836                                                                  00383600
003837 FD  RTV-HDR-FILE-629                                             00383700
003838     RECORDING MODE IS F                                          00383800
003839     LABEL RECORDS ARE STANDARD                                   00383900
003840     BLOCK CONTAINS 0 RECORDS.                                    00384000
003841                                                                  00384100
003842 01  RTV-HDR-RECORD-629               PIC X(550).                 00384200
003843                                                                  00384300
003844 FD  RTV-DTL-FILE-635                                             00384400
003845     RECORDING MODE IS F                                          00384500
003846     LABEL RECORDS ARE STANDARD                                   00384600
003847     BLOCK CONTAINS 0 RECORDS.                                    00384700
003848                                                                  00384800
003849 01  RTV-DTL-RECORD-635               PIC X(200).                 00384900
003850                                                                  00385000
003851 FD  RTV-HDR-FILE-635                                             00385100
003852     RECORDING MODE IS F                                          00385200
003853     LABEL RECORDS ARE STANDARD                                   00385300
003854     BLOCK CONTAINS 0 RECORDS.                                    00385400
003855                                                                  00385500
003856 01  RTV-HDR-RECORD-635               PIC X(550).                 00385600
003857                                                                  00385700
003858 FD  RTV-DTL-FILE-811                                             00385800
003859     RECORDING MODE IS F                                          00385900
003860     LABEL RECORDS ARE STANDARD                                   00386000
003861     BLOCK CONTAINS 0 RECORDS.                                    00386100
003862                                                                  00386200
003863 01  RTV-DTL-RECORD-811               PIC X(200).                 00386300
003864                                                                  00386400
003865 FD  RTV-HDR-FILE-811                                             00386500
003866     RECORDING MODE IS F                                          00386600
003867     LABEL RECORDS ARE STANDARD                                   00386700
003868     BLOCK CONTAINS 0 RECORDS.                                    00386800
003869                                                                  00386900
003870 01  RTV-HDR-RECORD-811               PIC X(550).                 00387000
003871                                                                  00387100
003872 FD  RTV-ERROR-MESSG-FILE                                         00387201
003873     RECORDING MODE IS F                                          00387301
003874     LABEL RECORDS ARE STANDARD                                   00387401
003875     BLOCK CONTAINS 0 RECORDS.                                    00387501
003876                                                                  00387601
003877 01  RTV-ERROR-RECORD                 PIC X(80).                  00387708
003878                                                                  00387801
003879*----------------------------------------------------------------*00387901
003880 WORKING-STORAGE SECTION.                                         00388001
003881*----------------------------------------------------------------*00388101
003882                                                                  00388201
003883*----------------------------------------------------------------*00388301
003884* INPUT LAYOUT - RV052-GENCO-DTL-CNTL-RECORD.                     00388401
003885*----------------------------------------------------------------*00388501
003886                                                                  00388601
003887     COPY RVRD052.                                                00388701
003888                                                                  00388801
003889*----------------------------------------------------------------*00388901
003890* INPUT LAYOUT - RV050-GENCO-RTV-HEADER-RECORD.                   00389001
003891*----------------------------------------------------------------*00389101
003892                                                                  00389201
003893     COPY RVRD050.                                                00389301
003894                                                                  00389401
003895***  PROGRAM ACCUMULATORS                                         00389501
003896                                                                  00389601
003897 01  PA-PROGRAM-ACCUMULATORS.                                     00389701
003898     05  PA-TOTALS.                                               00389801
003899         10 PA-TOT-CTL-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 00389901
003900         10 PA-TOT-HDR-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 00390001
003901         10 PA-TOT-DTL-RECS-READ      PIC S9(09) VALUE +0 COMP-3. 00390101
003902                                                                  00390201
003903***  PROGRAM SWITCHES                                             00390301
003904 01  PS-PROGRAM-SWITCHES.                                         00390401
003910     05  PS-END-OF-DTL-INPUT-SW        PIC  X(01)    VALUE 'N'.   00391001
004000         88  PS-END-OF-DTL-INPUT-YES                 VALUE 'Y'.   00400000
004100         88  PS-END-OF-DTL-INPUT-NO                  VALUE 'N'.   00410000
004200     05  PS-END-OF-HDR-INPUT-SW        PIC  X(01)    VALUE 'N'.   00420000
004300         88  PS-END-OF-HDR-INPUT-YES                 VALUE 'Y'.   00430000
004400         88  PS-END-OF-HDR-INPUT-NO                  VALUE 'N'.   00440000
004410     05  PS-HEADER-WRITE-SW            PIC  X(01)    VALUE 'N'.   00441011
004420         88  PS-HEADER-WRITE-YES                     VALUE 'Y'.   00442011
004430         88  PS-HEADER-WRITE-NO                      VALUE 'N'.   00443011
004431     05  PS-PROCESS-561-SW             PIC  X(01)    VALUE 'N'.   00443111
004432         88  PS-PROCESS-561                          VALUE 'Y'.   00443211
004433         88  PS-PROCESS-561-NO                       VALUE 'N'.   00443311
004440     05  PS-PROCESS-566-SW             PIC  X(01)    VALUE 'N'.   00444003
004450         88  PS-PROCESS-566                          VALUE 'Y'.   00445003
004460         88  PS-PROCESS-566-NO                       VALUE 'N'.   00446003
004470     05  PS-PROCESS-582-SW             PIC  X(01)    VALUE 'N'.   00447003
004480         88  PS-PROCESS-582                          VALUE 'Y'.   00448003
004490         88  PS-PROCESS-582-NO                       VALUE 'N'.   00449003
004491     05  PS-PROCESS-629-SW             PIC  X(01)    VALUE 'N'.   00449103
004492         88  PS-PROCESS-629                          VALUE 'Y'.   00449203
004493         88  PS-PROCESS-629-NO                       VALUE 'N'.   00449303
004494     05  PS-PROCESS-635-SW             PIC  X(01)    VALUE 'N'.   00449403
004495         88  PS-PROCESS-635                          VALUE 'Y'.   00449503
004496         88  PS-PROCESS-635-NO                       VALUE 'N'.   00449603
004497     05  PS-PROCESS-811-SW             PIC  X(01)    VALUE 'N'.   00449703
004498         88  PS-PROCESS-811                          VALUE 'Y'.   00449803
004499         88  PS-PROCESS-811-NO                       VALUE 'N'.   00449903
004500                                                                  00450000
004511 01  PV-MSG-HDR-RECORD                   PIC X(80) VALUE SPACES.  00451111
004512 01  PV-MSG-RECORD                       PIC X(80) VALUE SPACES.  00451211
004513 01  PV-PROGRAM-VARIABLES.                                        00451311
004520     05  PV-MESSAGE-LINE-1               PIC  X(150) VALUE        00452002
004521             '***** NO RECORDS ON HDR AND DTL FILE *********'.    00452102
004600***  PROGRAM CONSTANTS                                            00460000
004700 01  PC-PROGRAM-CONSTANTS.                                        00470000
004900     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'RVKUT010'. 00490000
004901     05  PC-PROCESSING-HEADER        PIC X(40)  VALUE             00490112
004902                    'INMAR SHIPMENT FILE PROCESSING ERRORS   '.   00490217
004903     05  PC-LOCATION-561             PIC X(35)  VALUE             00490311
004904                    'LOCATION 561 - MODESTO            '.         00490411
004905     05  PC-LOCATION-566             PIC X(35)  VALUE             00490511
004906                    'LOCATION 566 - BREINIGSVILLE      '.         00490611
004907     05  PC-LOCATION-582             PIC X(35)  VALUE             00490711
004908                    'LOCATION 582 - INDIANAPOLIS       '.         00490811
004909     05  PC-LOCATION-629             PIC X(35)  VALUE             00490911
004910                    'LOCATION 629 - STOCKBRIDGE        '.         00491011
004911     05  PC-LOCATION-635             PIC X(35)  VALUE             00491111
004912                    'LOCATION 635 - ARLINGTON          '.         00491211
004913     05  PC-LOCATION-811             PIC X(35)  VALUE             00491311
004914                    'LOCATION 811 - FINDLAY            '.         00491411
004915     05  PC-HEADER-OR-DETAIL         PIC X(45)  VALUE             00491511
004916            '** NO RECORDS ON HEADER OR DETAIL FILES **  '.       00491611
004917*----------------------------------------------------------------*00491711
004918 LINKAGE SECTION.                                                 00491811
004919*----------------------------------------------------------------*00491911
004920                                                                  00492011
004921*----------------------------------------------------------------*00492111
004922 PROCEDURE DIVISION.                                              00492211
004923*----------------------------------------------------------------*00492311
004924                                                                  00492411
004925*----------------------------------------------------------------*00492511
004926*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM.  *00492611
004927*----------------------------------------------------------------*00492711
004928                                                                  00492811
004929 0000-PROGRAM-MAINLINE.                                           00492911
004930                                                                  00493011
004931     DISPLAY '************ START OF RVKUT010 ***************'     00493111
004932                                                                  00493211
004933     PERFORM 1000-INITIALIZE THRU 1000-EXIT.                      00493311
004934*----------------------------------------------------------------*00493411
004935*  PROCESS AND WRITE ANY ERRORS LOCATION BY LOCATION            * 00493519
004936*----------------------------------------------------------------*00493611
004937     SET PS-PROCESS-561 TO TRUE                                   00493711
004938     PERFORM 2100-READ-RTV-DTL-FILE-561.                          00493811
004939     PERFORM 3100-READ-RTV-HDR-FILE-561.                          00493911
004940     PERFORM 4000-RTV-FILE-CHECK                                  00494003
004941     SET PS-PROCESS-561-NO TO TRUE                                00494103
004942                                                                  00494202
004943     SET PS-PROCESS-566 TO TRUE                                   00494309
004944     PERFORM 2200-READ-RTV-DTL-FILE-566.                          00494402
004950     PERFORM 3200-READ-RTV-HDR-FILE-566.                          00495002
004951     PERFORM 4000-RTV-FILE-CHECK                                  00495110
004960     SET PS-PROCESS-566-NO TO TRUE                                00496009
006500                                                                  00650000
006501     SET PS-PROCESS-582 TO TRUE                                   00650109
006510     PERFORM 2300-READ-RTV-DTL-FILE-582.                          00651000
006520     PERFORM 3300-READ-RTV-HDR-FILE-582.                          00652000
006521     PERFORM 4000-RTV-FILE-CHECK                                  00652110
006522     SET PS-PROCESS-582-NO TO TRUE                                00652209
006530                                                                  00653000
006531     SET PS-PROCESS-629 TO TRUE                                   00653109
006540     PERFORM 2400-READ-RTV-DTL-FILE-629.                          00654000
006550     PERFORM 3400-READ-RTV-HDR-FILE-629.                          00655000
006551     PERFORM 4000-RTV-FILE-CHECK                                  00655110
006552     SET PS-PROCESS-629-NO TO TRUE                                00655209
006560                                                                  00656000
006561     SET PS-PROCESS-635 TO TRUE                                   00656109
006570     PERFORM 2500-READ-RTV-DTL-FILE-635.                          00657000
006580     PERFORM 3500-READ-RTV-HDR-FILE-635.                          00658000
006581     PERFORM 4000-RTV-FILE-CHECK                                  00658110
006582     SET PS-PROCESS-635-NO TO TRUE                                00658209
006590                                                                  00659000
006591     SET PS-PROCESS-811 TO TRUE                                   00659109
006592     PERFORM 2600-READ-RTV-DTL-FILE-811.                          00659207
006593     PERFORM 3600-READ-RTV-HDR-FILE-811.                          00659307
006594     PERFORM 4000-RTV-FILE-CHECK                                  00659410
006595     SET PS-PROCESS-811-NO TO TRUE                                00659509
006596                                                                  00659600
006597                                                                  00659700
006900     PERFORM 8000-EOJ-ROUTINE.                                    00690000
007000                                                                  00700000
007200                                                                  00720000
007300     GOBACK.                                                      00730000
007301                                                                  00730100
007302*----------------------------------------------------------------*00730200
007303*    INITIALIZE VARIABLES.                                        00730300
007304*    OPEN FILES.                                                  00730400
007305*    DO A PRIME READ FOR THE DTL                                  00730500
007306*----------------------------------------------------------------*00730600
007307                                                                  00730700
007308 1000-INITIALIZE.                                                 00730800
007309                                                                  00730900
007310     OPEN INPUT RTV-DTL-FILE-561                                  00731005
007311                RTV-DTL-FILE-566                                  00731100
007312                RTV-DTL-FILE-582                                  00731200
007313                RTV-DTL-FILE-629                                  00731300
007314                RTV-DTL-FILE-635                                  00731400
007315                RTV-DTL-FILE-811                                  00731500
007320                RTV-HDR-FILE-561                                  00732005
007321                RTV-HDR-FILE-566                                  00732100
007322                RTV-HDR-FILE-582                                  00732200
007323                RTV-HDR-FILE-629                                  00732300
007324                RTV-HDR-FILE-635                                  00732400
007325                RTV-HDR-FILE-811                                  00732506
007326        OUTPUT  RTV-ERROR-MESSG-FILE.                             00732601
007330                                                                  00733000
007500                                                                  00750000
007600 1000-EXIT.                                                       00760000
007700     EXIT.                                                        00770000
007701                                                                  00770100
007702*----------------------------------------------------------------*00770200
007703*    READ THE RTV DETAIL FILE - MODESTO - 561                     00770300
007704*----------------------------------------------------------------*00770400
007705                                                                  00770500
007706 2100-READ-RTV-DTL-FILE-561.                                      00770605
007707                                                                  00770700
007708     READ RTV-DTL-FILE-561 INTO RV052-GENCO-DTL-CNTL-RECORD       00770805
007709         AT END                                                   00770900
007710             SET PS-END-OF-DTL-INPUT-YES TO TRUE                  00771000
007720     END-READ.                                                    00772000
007730                                                                  00773000
007740     IF PS-END-OF-DTL-INPUT-NO                                    00774000
007750         IF RV052-CONTRL                                          00775000
007760             ADD 1 TO PA-TOT-CTL-RECS-READ                        00776000
007770         ELSE                                                     00777000
007780             ADD 1 TO PA-TOT-DTL-RECS-READ                        00778000
007790         END-IF                                                   00779000
007800     END-IF.                                                      00780000
007801                                                                  00780100
007802*----------------------------------------------------------------*00780200
007803*    READ THE RTV DETAIL FILE - BREINIGSVILLE - LOC 566           00780300
007804*----------------------------------------------------------------*00780400
007805                                                                  00780500
007806 2200-READ-RTV-DTL-FILE-566.                                      00780600
007807                                                                  00780700
007808     READ RTV-DTL-FILE-566 INTO RV052-GENCO-DTL-CNTL-RECORD       00780800
007809         AT END                                                   00780900
007810             SET PS-END-OF-DTL-INPUT-YES TO TRUE                  00781000
007811     END-READ.                                                    00781100
007812                                                                  00781200
007813     IF PS-END-OF-DTL-INPUT-NO                                    00781300
007814         IF RV052-CONTRL                                          00781400
007815             ADD 1 TO PA-TOT-CTL-RECS-READ                        00781500
007816         ELSE                                                     00781600
007817             ADD 1 TO PA-TOT-DTL-RECS-READ                        00781700
007818         END-IF                                                   00781800
007819     END-IF.                                                      00781900
007820                                                                  00782000
007821*----------------------------------------------------------------*00782100
007822*    READ THE RTV DETAIL FILE - INDIANAPOLIS - LOC 582            00782200
007823*----------------------------------------------------------------*00782300
007824                                                                  00782400
007825 2300-READ-RTV-DTL-FILE-582.                                      00782500
007826                                                                  00782600
007827     READ RTV-DTL-FILE-582 INTO RV052-GENCO-DTL-CNTL-RECORD       00782700
007828         AT END                                                   00782800
007829             SET PS-END-OF-DTL-INPUT-YES TO TRUE                  00782900
007830     END-READ.                                                    00783000
007831                                                                  00783100
007832     IF PS-END-OF-DTL-INPUT-NO                                    00783200
007833         IF RV052-CONTRL                                          00783300
007834             ADD 1 TO PA-TOT-CTL-RECS-READ                        00783400
007835         ELSE                                                     00783500
007836             ADD 1 TO PA-TOT-DTL-RECS-READ                        00783600
007837         END-IF                                                   00783700
007838     END-IF.                                                      00783800
007839                                                                  00783900
007840*----------------------------------------------------------------*00784000
007841*    READ THE RTV DETAIL FILE - STOCKBRIDGE LOC 629               00784100
007842*----------------------------------------------------------------*00784200
007843                                                                  00784300
007844 2400-READ-RTV-DTL-FILE-629.                                      00784400
007845                                                                  00784500
007846     READ RTV-DTL-FILE-629 INTO RV052-GENCO-DTL-CNTL-RECORD       00784600
007847         AT END                                                   00784700
007848             SET PS-END-OF-DTL-INPUT-YES TO TRUE                  00784800
007849     END-READ.                                                    00784900
007850                                                                  00785000
007851     IF PS-END-OF-DTL-INPUT-NO                                    00785100
007852         IF RV052-CONTRL                                          00785200
007853             ADD 1 TO PA-TOT-CTL-RECS-READ                        00785300
007854         ELSE                                                     00785400
007855             ADD 1 TO PA-TOT-DTL-RECS-READ                        00785500
007856         END-IF                                                   00785600
007857     END-IF.                                                      00785700
007858                                                                  00785800
007859*----------------------------------------------------------------*00785900
007860*    READ THE RTV DETAIL FILE - ARLINGTON - LOC 635               00786000
007861*----------------------------------------------------------------*00786100
007862                                                                  00786200
007863 2500-READ-RTV-DTL-FILE-635.                                      00786300
007864                                                                  00786400
007865     READ RTV-DTL-FILE-635 INTO RV052-GENCO-DTL-CNTL-RECORD       00786500
007866         AT END                                                   00786600
007867             SET PS-END-OF-DTL-INPUT-YES TO TRUE                  00786700
007868     END-READ.                                                    00786800
007869                                                                  00786900
007870     IF PS-END-OF-DTL-INPUT-NO                                    00787000
007871         IF RV052-CONTRL                                          00787100
007872             ADD 1 TO PA-TOT-CTL-RECS-READ                        00787200
007873         ELSE                                                     00787300
007874             ADD 1 TO PA-TOT-DTL-RECS-READ                        00787400
007875         END-IF                                                   00787500
007876     END-IF.                                                      00787600
007877                                                                  00787700
007878*----------------------------------------------------------------*00787800
007879*    READ THE RTV DETAIL FILE -  FINDALY 811                      00787900
007880*----------------------------------------------------------------*00788000
007881                                                                  00788100
007882 2600-READ-RTV-DTL-FILE-811.                                      00788200
007883                                                                  00788300
007884     READ RTV-DTL-FILE-811 INTO RV052-GENCO-DTL-CNTL-RECORD       00788400
007885         AT END                                                   00788500
007886             SET PS-END-OF-DTL-INPUT-YES TO TRUE                  00788600
007887     END-READ.                                                    00788700
007888                                                                  00788800
007889     IF PS-END-OF-DTL-INPUT-NO                                    00788900
007890         IF RV052-CONTRL                                          00789000
007891             ADD 1 TO PA-TOT-CTL-RECS-READ                        00789100
007892         ELSE                                                     00789200
007893             ADD 1 TO PA-TOT-DTL-RECS-READ                        00789300
007894         END-IF                                                   00789400
007895     END-IF.                                                      00789500
007896                                                                  00789600
007897*----------------------------------------------------------------*00789700
007898*    READ THE RTV HEADER FILE MODESTO - LOC 561                   00789800
007899*----------------------------------------------------------------*00789900
007900                                                                  00790000
007901 3100-READ-RTV-HDR-FILE-561.                                      00790105
007902                                                                  00790200
007903     READ RTV-HDR-FILE-561 INTO RV050-GENCO-RTV-HEADER-RECORD     00790305
007904         AT END                                                   00790400
007905             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00790500
007906     END-READ.                                                    00790600
007907                                                                  00790700
007908     IF PS-END-OF-HDR-INPUT-NO                                    00790800
007909        ADD 1 TO PA-TOT-HDR-RECS-READ                             00790900
007910     END-IF.                                                      00791000
007911                                                                  00791100
007912*----------------------------------------------------------------*00791200
007914*    READ THE RTV HEADER FILE BREINIGSVILLE - LOC 566             00791400
007915*----------------------------------------------------------------*00791500
007916                                                                  00791600
007917 3200-READ-RTV-HDR-FILE-566.                                      00791700
007918                                                                  00791800
007919     READ RTV-HDR-FILE-566 INTO RV050-GENCO-RTV-HEADER-RECORD     00791900
007920         AT END                                                   00792000
007930             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00793000
007940     END-READ.                                                    00794000
007950                                                                  00795000
007960     IF PS-END-OF-HDR-INPUT-NO                                    00796000
007970        ADD 1 TO PA-TOT-HDR-RECS-READ                             00797000
007980     END-IF.                                                      00798000
007990                                                                  00799000
007992*----------------------------------------------------------------*00799200
007993*    READ THE RTV HEADER FILE INDIANAPOLIS - LOC 582              00799300
007994*----------------------------------------------------------------*00799400
007995                                                                  00799500
007996 3300-READ-RTV-HDR-FILE-582.                                      00799600
007997                                                                  00799700
007998     READ RTV-HDR-FILE-582 INTO RV050-GENCO-RTV-HEADER-RECORD     00799800
007999         AT END                                                   00799900
008000             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00800000
008001     END-READ.                                                    00800100
008002                                                                  00800200
008003     IF PS-END-OF-HDR-INPUT-NO                                    00800300
008004        ADD 1 TO PA-TOT-HDR-RECS-READ                             00800400
008005     END-IF.                                                      00800500
008006                                                                  00800600
008008*----------------------------------------------------------------*00800800
008009*    READ THE RTV HEADER FILE STOCKBRIDGE LOC 629                 00800900
008010*----------------------------------------------------------------*00801000
008011                                                                  00801100
008012 3400-READ-RTV-HDR-FILE-629.                                      00801200
008013                                                                  00801300
008014     READ RTV-HDR-FILE-629 INTO RV050-GENCO-RTV-HEADER-RECORD     00801400
008015         AT END                                                   00801500
008016             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00801600
008017     END-READ.                                                    00801700
008018                                                                  00801800
008019     IF PS-END-OF-HDR-INPUT-NO                                    00801900
008020        ADD 1 TO PA-TOT-HDR-RECS-READ                             00802000
008021     END-IF.                                                      00802100
008022                                                                  00802200
008023*----------------------------------------------------------------*00802300
008025*    READ THE RTV HEADER FILE ARLINGTON - LOC 635                 00802500
008026*----------------------------------------------------------------*00802600
008027                                                                  00802700
008028 3500-READ-RTV-HDR-FILE-635.                                      00802800
008029                                                                  00802900
008030     READ RTV-HDR-FILE-635 INTO RV050-GENCO-RTV-HEADER-RECORD     00803000
008031         AT END                                                   00803100
008032             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00803200
008033     END-READ.                                                    00803300
008034                                                                  00803400
008035     IF PS-END-OF-HDR-INPUT-NO                                    00803500
008036        ADD 1 TO PA-TOT-HDR-RECS-READ                             00803600
008037     END-IF.                                                      00803700
008038                                                                  00803800
008040*----------------------------------------------------------------*00804000
008041*    READ THE RTV HEADER FILE FINDALY 811                         00804100
008042*----------------------------------------------------------------*00804200
008043                                                                  00804300
008044 3600-READ-RTV-HDR-FILE-811.                                      00804400
008045                                                                  00804500
008046     READ RTV-HDR-FILE-811 INTO RV050-GENCO-RTV-HEADER-RECORD     00804600
008047         AT END                                                   00804700
008048             SET PS-END-OF-HDR-INPUT-YES TO TRUE                  00804800
008049     END-READ.                                                    00804900
008050                                                                  00805000
008051     IF PS-END-OF-HDR-INPUT-NO                                    00805100
008052        ADD 1 TO PA-TOT-HDR-RECS-READ                             00805200
008053     END-IF.                                                      00805300
008054                                                                  00805400
008118                                                                  00811803
008127 4000-RTV-FILE-CHECK.                                             00812703
008130     MOVE PC-PROCESSING-HEADER TO PV-MSG-HDR-RECORD               00813011
008131     INITIALIZE PV-MSG-RECORD                                     00813111
008132     EVALUATE TRUE                                                00813211
008133       WHEN PS-PROCESS-561                                        00813311
008134         MOVE  PC-LOCATION-561  TO PV-MSG-RECORD                  00813411
008136       WHEN PS-PROCESS-566                                        00813611
008137         MOVE  PC-LOCATION-566  TO PV-MSG-RECORD                  00813711
008139       WHEN PS-PROCESS-582                                        00813911
008140         MOVE  PC-LOCATION-582  TO PV-MSG-RECORD                  00814011
008142       WHEN PS-PROCESS-629                                        00814211
008143         MOVE  PC-LOCATION-629  TO PV-MSG-RECORD                  00814311
008145       WHEN PS-PROCESS-635                                        00814511
008146         MOVE  PC-LOCATION-635  TO PV-MSG-RECORD                  00814611
008148       WHEN PS-PROCESS-811                                        00814811
008149         MOVE  PC-LOCATION-811  TO PV-MSG-RECORD                  00814911
008151     END-EVALUATE.                                                00815113
008152                                                                  00815211
008154     IF PS-END-OF-HDR-INPUT-YES AND                               00815411
008155        PS-END-OF-DTL-INPUT-YES                                   00815511
008156         IF PS-HEADER-WRITE-NO                                    00815612
008157            WRITE RTV-ERROR-RECORD  FROM PV-MSG-HDR-RECORD        00815712
008158            INITIALIZE PV-MSG-HDR-RECORD                          00815818
008159            WRITE RTV-ERROR-RECORD  FROM PV-MSG-HDR-RECORD        00815918
008160            SET PS-HEADER-WRITE-YES TO TRUE                       00816012
008161         END-IF                                                   00816112
008162         PERFORM 7000-WRITE-EXTRACT-RECORD                        00816211
008163                                                                  00816311
008164         INITIALIZE PV-MSG-RECORD                                 00816411
008165         MOVE PC-HEADER-OR-DETAIL TO PV-MSG-RECORD                00816511
008166         PERFORM 7000-WRITE-EXTRACT-RECORD                        00816611
008167         INITIALIZE PV-MSG-RECORD                                 00816711
008168         PERFORM 7000-WRITE-EXTRACT-RECORD                        00816811
008169     END-IF.                                                      00816911
008170                                                                  00817011
008171     IF PS-END-OF-DTL-INPUT-NO                                    00817111
008172         EVALUATE TRUE                                            00817211
008173           WHEN PS-PROCESS-561                                    00817311
008174             PERFORM 2100-READ-RTV-DTL-FILE-561                   00817411
008175                UNTIL PS-END-OF-DTL-INPUT-YES                     00817511
008176           WHEN PS-PROCESS-566                                    00817611
008177             PERFORM 2200-READ-RTV-DTL-FILE-566                   00817711
008178                UNTIL PS-END-OF-DTL-INPUT-YES                     00817811
008179           WHEN PS-PROCESS-582                                    00817911
008180             PERFORM 2300-READ-RTV-DTL-FILE-582                   00818011
008181                UNTIL PS-END-OF-DTL-INPUT-YES                     00818111
008182           WHEN PS-PROCESS-629                                    00818211
008183             PERFORM 2400-READ-RTV-DTL-FILE-629                   00818311
008184                UNTIL PS-END-OF-DTL-INPUT-YES                     00818411
008185           WHEN PS-PROCESS-635                                    00818511
008186             PERFORM 2500-READ-RTV-DTL-FILE-635                   00818611
008187                UNTIL PS-END-OF-DTL-INPUT-YES                     00818711
008188           WHEN PS-PROCESS-811                                    00818811
008189             PERFORM 2600-READ-RTV-DTL-FILE-811                   00818911
008190                UNTIL PS-END-OF-DTL-INPUT-YES                     00819011
008191         END-EVALUATE                                             00819111
008192         PERFORM 5000-PROCESS-FILE-MISMATCH                       00819211
008193     ELSE                                                         00819311
008194         IF PS-END-OF-DTL-INPUT-YES AND                           00819411
008195            PS-END-OF-HDR-INPUT-NO                                00819511
008196             PERFORM 7000-WRITE-EXTRACT-RECORD                    00819613
008197             INITIALIZE PV-MSG-RECORD                             00819711
008198             MOVE    '***** NO RECORDS ON DETAIL INPUT FILE ****' 00819811
008199                             TO PV-MSG-RECORD                     00819911
008200             PERFORM 7000-WRITE-EXTRACT-RECORD                    00820011
008201             INITIALIZE PV-MSG-RECORD                             00820111
008202             MOVE    '** RECORDS PRESENT ON HEADER INPUT FILE **' 00820211
008203                             TO PV-MSG-RECORD                     00820311
008204             PERFORM 7000-WRITE-EXTRACT-RECORD                    00820411
008205             INITIALIZE PV-MSG-RECORD                             00820511
008206             PERFORM 7000-WRITE-EXTRACT-RECORD                    00820611
008207         END-IF                                                   00820711
008208     END-IF.                                                      00820811
008209     PERFORM 5500-RESET-INDICATORS.                               00820911
008210*----------------------------------------------------------------*00821011
008211*                                                                *00821111
008212*----------------------------------------------------------------*00821211
008213 5000-PROCESS-FILE-MISMATCH.                                      00821311
008214     IF PA-TOT-CTL-RECS-READ GREATER THAN 1 AND                   00821411
008215        PA-TOT-HDR-RECS-READ = ZERO                               00821511
008216         PERFORM 7000-WRITE-EXTRACT-RECORD                        00821613
008217         INITIALIZE PV-MSG-RECORD                                 00821711
008218         MOVE  '********** HEADER FILE IS EMPTY           **'     00821811
008219                             TO PV-MSG-RECORD                     00821911
008220         PERFORM 7000-WRITE-EXTRACT-RECORD                        00822011
008221                                                                  00822111
008222         INITIALIZE PV-MSG-RECORD                                 00822211
008223         MOVE  '**DETAIL FILE HAS MORE THAN ONE CNTL RECORD**'    00822311
008224                             TO PV-MSG-RECORD                     00822411
008225         PERFORM 7000-WRITE-EXTRACT-RECORD                        00822511
008226         INITIALIZE PV-MSG-RECORD                                 00822611
008227         PERFORM 7000-WRITE-EXTRACT-RECORD                        00822711
008228     END-IF.                                                      00822811
008229                                                                  00822911
008230     IF PA-TOT-CTL-RECS-READ GREATER THAN 1 AND                   00823011
008231        PA-TOT-HDR-RECS-READ > ZERO                               00823111
008232         PERFORM 7000-WRITE-EXTRACT-RECORD                        00823213
008233         INITIALIZE PV-MSG-RECORD                                 00823311
008234         MOVE    '*HEADER FILE IS NOT EMPTY                 **'   00823411
008235                             TO PV-MSG-RECORD                     00823511
008236         PERFORM 7000-WRITE-EXTRACT-RECORD                        00823611
008237         INITIALIZE PV-MSG-RECORD                                 00823711
008238         MOVE    '*DETAIL FILE HAS MORE THAN ONE CTNL RECORD**'   00823811
008239                             TO PV-MSG-RECORD                     00823911
008240         PERFORM 7000-WRITE-EXTRACT-RECORD                        00824011
008241         INITIALIZE PV-MSG-RECORD                                 00824111
008242         PERFORM 7000-WRITE-EXTRACT-RECORD                        00824211
008243     END-IF.                                                      00824311
008244                                                                  00824411
008245     IF PS-END-OF-HDR-INPUT-NO AND                                00824511
008246        PA-TOT-DTL-RECS-READ = ZERO AND                           00824611
008247        PA-TOT-CTL-RECS-READ = 1                                  00824711
008248         PERFORM 7000-WRITE-EXTRACT-RECORD                        00824813
008249         INITIALIZE PV-MSG-RECORD                                 00824911
008250         MOVE  '**** HEADER FILE HAS RECORDS           **'        00825011
008251                             TO PV-MSG-RECORD                     00825111
008252         PERFORM 7000-WRITE-EXTRACT-RECORD                        00825211
008253         INITIALIZE PV-MSG-RECORD                                 00825311
008254         MOVE  '** DETAIL FILE HAS CNTL RECORD AND NO DETAILS **' 00825411
008255                             TO PV-MSG-RECORD                     00825511
008256         PERFORM 7000-WRITE-EXTRACT-RECORD                        00825611
008257         INITIALIZE PV-MSG-RECORD                                 00825711
008258         PERFORM 7000-WRITE-EXTRACT-RECORD                        00825811
008259     END-IF.                                                      00825911
008260                                                                  00826011
008261     IF PS-END-OF-HDR-INPUT-YES AND                               00826111
008262        PA-TOT-DTL-RECS-READ > ZERO AND                           00826211
008263        PA-TOT-CTL-RECS-READ = 1                                  00826311
008264         PERFORM 7000-WRITE-EXTRACT-RECORD                        00826413
008265         INITIALIZE PV-MSG-RECORD                                 00826511
008266         MOVE    '***** NO RECORDS ON HEADER INPUT FILE      ****'00826611
008267                             TO PV-MSG-RECORD                     00826711
008268         PERFORM 7000-WRITE-EXTRACT-RECORD                        00826811
008269         INITIALIZE PV-MSG-RECORD                                 00826911
008270         MOVE    '***   RECORDS PRESENT ON DETAIL INPUT FILE  ***'00827015
008271                             TO PV-MSG-RECORD                     00827111
008272         PERFORM 7000-WRITE-EXTRACT-RECORD                        00827211
008273         INITIALIZE PV-MSG-RECORD                                 00827311
008274         PERFORM 7000-WRITE-EXTRACT-RECORD                        00827411
008275     END-IF.                                                      00827511
008276                                                                  00827611
008277*----------------------------------------------------------------*00827711
008278 5500-RESET-INDICATORS.                                           00827811
008280      SET PS-END-OF-DTL-INPUT-NO                                  00828011
008281          PS-END-OF-HDR-INPUT-NO  TO TRUE.                        00828111
008282      MOVE +0   TO PA-TOT-CTL-RECS-READ                           00828211
008283                   PA-TOT-HDR-RECS-READ                           00828316
008284                   PA-TOT-DTL-RECS-READ.                          00828416
008285************************************************************      00828511
008286 7000-WRITE-EXTRACT-RECORD.                                       00828611
008287     WRITE RTV-ERROR-RECORD                                       00828711
008288           FROM PV-MSG-RECORD.                                    00828811
008289*                                                                 00828911
008290*----------------------------------------------------------------*00829011
008291*    DISPLAY SUMMARY STATS AND VERIFY CONTROL RECORD COUNTS       00829111
008292*----------------------------------------------------------------*00829211
008293                                                                  00829311
008294 8000-EOJ-ROUTINE.                                                00829411
008295                                                                  00829511
008296     CLOSE RTV-DTL-FILE-561                                       00829619
008297           RTV-DTL-FILE-566                                       00829719
008298           RTV-DTL-FILE-582                                       00829819
008299           RTV-DTL-FILE-629                                       00829919
008300           RTV-DTL-FILE-635                                       00830019
008301           RTV-DTL-FILE-811                                       00830119
008302           RTV-HDR-FILE-561                                       00830219
008303           RTV-HDR-FILE-566                                       00830319
008304           RTV-HDR-FILE-582                                       00830419
008305           RTV-HDR-FILE-629                                       00830519
008306           RTV-HDR-FILE-635                                       00830619
008307           RTV-HDR-FILE-811                                       00830719
008308           RTV-ERROR-MESSG-FILE.                                  00830819
008309                                                                  00830919
008320                                                                  00832000
008330     DISPLAY '************  END OF RVKUT010  ***************'.    00833020
011701                                                                  01170100
011702*----------------------------------------------------------------*01170200
011703*                       END OF PROGRAM                            01170300
011704*----------------------------------------------------------------*01170400
