000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    APKCS365.                                         00040000
000500 AUTHOR.        MARK BURNSIDE.                                    00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  11-30-98.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    A365 - ADJUSTMENT JOURNAL DISTRIBUTION ADD/UPDATE/DELETE   * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF ADJUSTMENT JOURNAL        * 00130000
001400*    DISTRIBUTION ENTRIES THAT WILL DISPLAY:                    * 00140000
001500*        STORE                                                  * 00150000
001600*        CLASS                                                  * 00160000
001700*        SKU                                                    * 00170000
001800*        GROSS COST                                             * 00180000
001900*        RETAIL AMOUNT                                          * 00190000
002000*        NET AMOUNT                                             * 00200000
002100*    FOR EACH DISTRIBUTION LINE.                                * 00210000
002200*    WHEN USING THIS SCREEN IN UPDATE MODE DISTRIBUTION LINE(S) * 00220000
002300*    TO BE UPDATED MUST BE SELECTED FIRST.                      * 00230000
002400*    WHEN USING THIS SCREEN IN DELETE MODE THE LINE(S) TO BE    * 00240000
002500*    DELETED MUST BE SELECTED WITH A 'D' AND ANY OTHER LINES    * 00250000
002600*    TO BE UPDATED IN ORDER FOR THE ADJUSTMENT TO BALANCE MUST  * 00260000
002700*    BE SELECTED WITH AN 'S'.                                   * 00270000
002800*                                                               * 00280000
002900*---------------------------------------------------------------* 00290000
003000*                                                               * 00300000
003100*  APKCS365 KOHLS ADJUSTMENT JOURNAL LIST SCREEN     11/30/98   * 00310000
003200* CHANGES MADE BY:  MARK BURNSIDE                               * 00320000
003300*                                                               * 00330000
003400* DATE  12/09/99                                                * 00340000
003500*    CHANGE MADE:  MODIFIED THE CHECK ON THE DATE ROUTINE TO    * 00350000
003600*    COMPLY WITH Y2K STANDARDS.                                 * 00360000
003700*    MADE BY: MARK BURNSIDE                   WR/IR #: 6041     * 00370000
003800*                                                               * 00380000
003900* DATE  01/26/00                                                * 00390000
004000*    CHANGE MADE: ADDED A NEW EDIT THAT CALCULATES THE MARKON   * 00400000
004100*    PERCENTAGE FOR ANY TRANSACTION THAT HAS A GROSS COST AND   * 00410000
004200*    RETAIL AMOUNT.  IF IT IS 85% OR GREATER OR 15% OR LESS, THEN*00420000
004300*    A WARNING MESSAGE COMES.  THE USER CAN THEN ADJUST ONE OF  * 00430000
004400*    THE AMOUNTS OR CONTINUE WITH THE ADD/UPDATE.               * 00440000
004500*    OPENED UP THE CHECK FOR THE GROSS COST > RETAIL AMOUNT     * 00450000
004600*    FOR ANY ADJUSTMENT REGARDLESS OF THE TRAN CODE. THIS       * 00460000
004700*    WOULD ONLY HAPPEN IF BOTH AMOUNTS ARE NOT EQUAL TO ZERO.   * 00470000
004800*    PARAS 3095-, 3097-                                         * 00480000
004900*    MADE BY: MIKE BESKE              WR/IR #: 20758            * 00490000
005000*                                                               * 00500000
005100* DATE  05/09/00                                                * 00510000
005200*    CHANGE MADE: ADDED A NEW EDIT THAT CHECKS FOR THE EXISTENCE* 00520000
005300*    OF THE GROSS COST WHENEVER THE RETAIL AMOUNT IS ENTERED    * 00530000
005400*    WITH EITHER THE FREIGHT OR MISC CHARGES.  IF NO GROSS COST * 00540000
005500*    EXISTS THEN AN ERROR MESSAGE IS DISPLAYED.                 * 00550000
005600*    PARAS 3096-                                                * 00560000
005700*    MADE BY: MIKE BESKE              WR/IR #: 20704            * 00570000
005800*                                                               * 00580000
005900* DATE  08/28/00                                                * 00590000
006000*    CHANGE MADE: ADDED TWO NEW FIELDS INVOLVING THE MARK OUT   * 00600000
006100*    OF STOCK PROJECT. THIS PROGRAM HANDLES THE ACTUAL INSERT   * 00610000
006200*    AND UPDATES TO THE TADJRNL TABLE.                          * 00620000
006300*    MADE BY: MIKE BESKE              WR/IR #: 20224            * 00630000
006400*                                                               * 00640000
006500* DATE  12/12/2000                                              * 00650000
006600*    CHANGE MADE: MODIFIED THE LENGTH OF ASC-KEY-VND-NBR FROM   * 00660000
006700*    TEN CHARACTERS TO NINE CHARACTERS TO IMPROVE THE           * 00670000
006800*    EFFICIENCY OF THE SQL CALLS TO THE ADJUSTMENT JOURNAL DB2  * 00680000
006900*    TABLES.                                                    * 00690000
007000*    MADE BY: MARK BURNSIDE          WR/IR #: 21699             * 00700000
007100*                                                               * 00710000
007200* DATE  01/16/01                                                * 00720000
007300*    RECOMPILED WITH NEW VERSION OF INPD500.                    * 00730000
007400*    MADE BY: L SCHALLHORN            WR/IR #: 20704            * 00740000
007500*                                                               * 00750000
007600* DATE  01/24/2002                                              * 00760000
007700*    CHANGE MADE: ADDED TWO MORE BYTES TO THE END OF THE        * 00770000
007800*    DISCOUNT STORAGE FIELDS, SO THAT THE PERCENTAGE WILL NOT   * 00780000
007900*    BE TRUNCATED AND STORED ON THE TADJRNL TABLE INCORRECTLY.  * 00790000
008000*    MADE BY: KEVIN CATLIN            WR/IR #: PM00444221       * 00800000
008100*                                                               * 00810000
008200* DATE  05/16/2002                                              * 00820000
008300*    CHANGE MADE:  NI-SKU CHANGES.  THE 3 BYTE SKU-SEQ FIELD IS * 00830000
008400*    REPLACED WITH A NUMERIC 8 BYTE SKU FIELD.  CHANGES MADE TO * 00840000
008500*    WORKING STORAGE FIELDS AND TO PARAGRAPHS 1105, 2107, 2109, * 00850000
008600*    2210, 3200, 3300, 3304, 3650, 3800, 3850, 4025, 4100, 4250,* 00860000
008700*    4300, 4305, 4310, 4420, 6600, 7800, 8000, 8100, AND 8200.  * 00870000
008800*    CHANGED SOME ASC- FIELDS IN COMMAREA FROM CHAR TO COMP-3   * 00880000
008900*    TO REDUCE THE TOTAL COMMAREA LENGTH.  MADE MODIFICATIONS   * 00890000
009000*    TO PARAGRAPHS WHERE THESE FIELDS ARE REFERENCED TO PROCESS * 00900000
009100*    THE COMP-3 DATA TYPE.                                      * 00910000
009200*    MADE BY: KEVIN CATLIN                    WR/IR #: 21278    * 00920000
009300*                                                               * 00930000
009400*   05/05/2003                                                  * 00940000
009500*      CHANGED THE WHERE CONDITION (IN 7800-VALIDATE-SKU) ON    * 00950000
009600*      TSKXREF TO USE DEPT & CLASS INSTEAD OF DEPT_NBR & CL_NBR.* 00960000
009700*      ADDED REDEFINES FOR THE ASC- FIELDS FOR CLASS AND DEPT FOR 00970000
009800*      NUMERIC DEFNS.  ADDED NEW W/S FIELDS DEFINED AS PACKED   * 00980000
009900*      DECIMAL TO MATCH DEPT & CLASS AS HOST VARIABLES. THESE   * 00990000
010000*      ARE USED IN THE 3650- PARAGRAPH.                         * 01000000
010100*      5/28/03 CHANGED PARAS 3650- AND 7800- TO TAKE THE        * 01010000
010200*      CLASS SCREEN INPUT VALUE AND USE THIS TO VALIDATE        * 01020000
010300*      AGAINST SUBCLASS ON TSKXREF. THIS ALLOWS THE USER TO ENTER 01030000
010400*      THE SUBCLASS VALUE SO THAT IT IS RETAINED ON THE TADJDIS * 01040000
010500*      TABLE FOR INVENTORY CONTROL AS IS DONE PRIOR TO NI-SKU   * 01050000
010600*      INSTALL.                                                 * 01060000
010700*   MADE BY: MIKE BESKE                   WR#: 22557            * 01070000
010800*                                                               * 01080000
010900* DATE  12/04/2003                                              * 01090000
011000*    CHANGE MADE: ADDED LOGIC IN PARAGRAPHS 3700-EDIT-DISTRO-   * 01100000
011100*    COST AND 3800-EDIT-DISTRO-RETAIL TO VERIFY THAT THE AMOUNT * 01110000
011200*    ENTERED ON THE DISTRO HAS THE CORRECT SIGN FOR THE POSTING * 01120000
011300*    TYPE BEING PROCESSED.  ALSO RESTRUCTURED AND ADDED COMMENT * 01130000
011400*    LINES IN 3800 TO IMPROVE READABILITY.                      * 01140000
011500*    MADE BY: NANCY EILBES            WR/IR #: P000613954       * 01150000
011600*                                                               * 01160000
011700* DATE  05/04/2004                                              * 01170000
011800*    CHANGE MADE: REPLACED TSTR000 WITH XFT00003.  CHANGED THE  * 01180000
011900*    LENGTH OF PV-STORE-NBR-3 FROM S9(03) TO S9(04) AND RENAMED * 01190000
012000*    IT PV-STORE-NBR-4.  RECODED PARA 7400-VALIDATE-STORE TO USE* 01200000
012100*    XFT00003 INSTEAD OF TSTR000.                               * 01210000
012200*    MADE BY: MIKE BESKE              WR/IR #: WR25805          * 01220000
012300*                                                               * 01230000
012400* DATE  09/20/2004                                              * 01240000
012500*     CHANGE MADE: ADDED 'CURRENT DATE <= FINCL_CLO_DTE' TO     * 01250000
012600*     SELECT STATEMENT THAT IS VALIDATING STORE NUMBER.         * 01260000
012700*     PARAGRAPH 7400-VALIDATE-STORE WAS MODIFIED.               * 01270000
012800*     MADE BY: KEVIN CATLIN            WR/IR #: P000693987      * 01280000
012900*                                                               * 01290000
013000* DATE  01/05/2005                                              * 01300000
013100*     CHANGE MADE: ADDED LOGIC THROUGHOUT PROGRAM TO ALLOW      * 01310000
013200*     OF NEW STORE DISCOUNT ONLY TRANSACTIONS.  DISTRIBUTION    * 01320000
013300*     OF THIS AMOUNT WILL BE KEYED IN THE COST FIELD AND        * 01330000
013400*     LOGIC THAT WOULD ORDINARILY DISTRIBUTE DISCOUNT WILL BE   * 01340000
013500*     SUPPRESSED.  SPECIAL HANDLING IS REQUIRED FOR THIS TYPE   * 01350000
013600*     OF TRANSACTION REGARDING FIELD SIGNS - THE SIGN IS        * 01360000
013700*     OPPOSITE WHAT WOULD BE EXPECTED FOR THE TRAN TYPE BEING   * 01370000
013800*     PROCESSED.                                                * 01380000
013900*     MADE BY: NANCY EILBES            WR/IR #: WR26679         * 01390000
014000*                                                               * 01400000
014100* DATE  05/25/2005                                              * 01410000
014200*     CHANGE MADE: ADDED STATEMENT IN PARAGRAPH 4200 TO COPY    * 01420000
014300*     THE NEWLY CALCULATED NSD TO THE ASC-HD-NEW-STR-AMT WHEN   * 01430000
014400*     IT IS NOT ZERO.  THIS RESOLVES AN ISSUE WHERE THE         * 01440000
014500*     RECALCULATED NSD WAS NOT GETTING UPDATED ON THE DATABASE  * 01450000
014600*     BECAUSE THIS WORK FIELD WAS NOT BEING UPDATED AFTER THE   * 01460000
014700*     RECALC WHEN THE GROSS COST WAS CHANGED.                   * 01470000
014800*     MADE BY: NANCY EILBES            WR/IR #: P000765705      * 01480000
014900*                                                               * 01490000
015000*   06/21/2005                                                   *01500000
015100*      LOGIC HANDLING THE NEW STORE DISCOUNT ONLY TRANSACTION    *01510000
015200*      WAS LOOKING FOR THE WRONG SIGN. THE TRANCODE WAS ACTUALLY *01520000
015300*      CREATED WITH THE SIGN THAT MATCHES THE DISCOUNT AMOUNT,   *01530000
015400*      BUT THE LOGIC WAS ASSUMING THE TRANCODE WAS SET UP WITH   *01540000
015500*      THE SIGN MATCHING THE RESULTING NET COST AMOUNT.          *01550000
015600*   MADE BY: NANCY EILBES                 WR#: P000773596        *01560000
015700*                                                                *01570000
015800*   DATE  09/22/2005                                             *01580000
015900*       CHANGE MADE: PRODUCT LICENSE FEES                        *01590000
016000*       MODIFIED THE CODE TO HANDLE THE ADD, UPDATE & DELETE OF  *01600000
016100*       OFFSET ADJUSTMENT AS IT RELATES TO AN ORIGINATING ADJUST-*01610000
016200*       MENT.  ALSO MODIFIED CODE THAT DEALS WITH THE DELETION   *01620000
016300*       OF INDIVIDUAL DISTRIB LINE(S) OF THE ORIGINATING ADJUST- *01630000
016400*       MENT AND HOW IT AFFECTS A RELATED OFFSET ADJUSTMENT.     *01640000
016500*       A SPECIALLY FORMATTED COMMENT IS CREATED FOR ALL OFFSET  *01650000
016600*       ADJUSTMENTS.  IT CONTAINS THE DOC NBR OF THE RELATED     *01660000
016700*       ORIGINATING ADJUSTMENT AND IS KEPT IN THE REASON 1 FIELD.*01670000
016800*       THIS COMMENT IS ALSO USED TO IDENTIFY AN ADJUSTMENT AS   *01680000
016900*       BEING AN OFFSET ADJUSTMENT OR NOT.                       *01690000
017000*       NEW PARAS: 6501-, 6601-, 6602-, 8210-                    *01700000
017100*       MOD PARAS: 1000-, 1105-, 2100-                           *01710000
017200*       MADE BY: MIKE BESKE              WR/IR #: WR28882        *01720000
017300*                                                                *01730000
017400*   DATE  05/23/2006                                             *01740000
017500*       CHANGE MADE: PRODUCT LICENSE FEES                        *01750000
017600*       MODIFIED CODE FOR CYPHERING THE OFFSET ADJUSTMENT        *01760000
017700*       AMOUNTS TO BE SIGNED ACCORDING TO THE POSTING TYPE CODE  *01770000
017800*       VALUE FOR THAT OFFSET TRAN CODE.  THE OFFSET NET COST AMT*01780000
017900*       IS CALCULATED IN A NEW PARA 6551-.  IT USES THE TADJRNL  *01790000
018000*       AMT FIELDS BECAUSE THESE ALREADY HAVE THE CORRECT        *01800000
018100*       SIGN ON THEM.  THE NET AMOUNT SIGN SHOULD NOT HAVE TO BE *01810000
018200*       CHECKED AGAINST POSTING TYPE CODE VALUE AS A RESULT.     *01820000
018300*       MOD PARAS: 6501-, 6601-, 6602-                           *01830000
018400*       MADE BY: MIKE BESKE              WR/IR #: WR28882        *01840000
018500*                                                                *01850000
018600*   DATE  07/21/2006                                             *01860000
018700*       CHANGE MADE: PRODUCT LICENSE FEES                        *01870000
018800*       MODIFIED CODE FOR TO ZERO OUT THE RETAIL AMOUNT FOR THE  *01880000
018900*       OFFSET ADJUSTMENT AT THE HEADER AND DISTRIB LEVELS.      *01890000
019000*       RETAIL AMOUNT IS NOT SUPPOSED TO CARRY OVER FROM THE     *01900000
019100*       ORIGINATING ADJUSTMENT PER THE UAT TESTING RESULTS.      *01910000
019200*       MOD PARAS: 6501-, 6601-, 6602-                           *01920000
019300*       MADE BY: MIKE BESKE              WR/IR #: WR28882        *01930000
019400*                                                                *01940000
019500*   DATE  09/07/2006                                             *01950000
019600*       CHANGE MADE: MODIFIED CODE TO ALLOW THE COMMENTS FROM THE*01960000
019700*       ORIGINATING ADJUSTMENT TO CARRY OVER TO THE OFFSET       *01970000
019800*       ADJUSTMENT.                                              *01980000
019900*       MOD PARA: 6501-.                                         *01990000
020000*       MADE BY: MIKE BESKE              WR/IR #: P000919920     *02000000
020010*                                                                *02001000
020020*   DATE  03/27/2007                                             *02002000
020030*       CHANGE MADE: RECOMPILE FROM PRODUCTION TO INCORPORATE    *02003000
020040*       CHANGES TO PS_XFT_LOC TABLE FOR STORE DEMOGRAPHICS.      *02004000
020050*       MADE BY: KEVIN CATLIN            WR/IR #: WR31452        *02005000
020060*                                                                *02006000
020070*   DATE  05/12/2008                                             *02007000
020080*       CHANGE MADE: RECOMPILE WITH NEW VERSION OF INPD500.      *02008000
020090*       MADE BY: ROLF NOHE               WR/IR #: WR34276        *02009000
020091*                                                                *02009100
020092*   DATE  09/04/2009                                             *02009200
020093*       CHANGE MADE: BYPASS CUTOFF DATE PROMPT, (INPD500),       *02009300
020094*       TO ALLOW DBA'S TO CHANGE TABLES FOR HILO PROJECT.        *02009400
020095*       MADE BY: ROLF NOHE               WR/IR #: WR33304        *02009500
020096*                                                                *02009600
020097*   DATE  09/08/2009                                             *02009700
020098*       CHANGE MADE: BACK OUT BYPASS CUTOFF DATE PROMPT,         *02009800
020099*       AND RECOMPILE WITH NEW VERSION OF INPD500.               *02009900
020100*       MADE BY: ROLF NOHE               WR/IR #: WR33304        *02010000
020101*                                                                *02010100
020102*   DATE  01/26/2010                                             *02010200
020103*       CHANGE MADE: DELETED THE INVENTORY CUTOFF DATE FROM      *02010300
020104*       THE SCREEN AND ALL LINES OF CODE THAT WAS USING THIS     *02010400
020105*       EXCEPT FOR IN THE COMMAREA.  ALSO DELETED THE COPYBOOKS  *02010500
020106*       INWS500 AND INPD500.                                     *02010600
020107*       MADE BY: BARB SCHULTZ            WR/IR #: WR37487        *02010700
020108*                                                                *02010800
020109*   DATE  07/20/2011                                             *02010900
020110*       CHANGE MADE: DB2 RE-PLATFORM TO ORACLE AS A PART OF      *02011000
020111*       PEOPLESOFT FINANCIAL UPGRADE TO VERSION 9.1. THE LOCATION*02011100
020112*       DOMAIN TABLE FI_XFT_LOC THAT RESIDES IN DB3P WILL NOW    *02011200
020113*       BE MOVED TO DB2P. THE NEW DCLGEN FOR THE DB2P TABLE WILL *02011300
020114*       BE XFT00017. CHANGES ARE MADE TO INCLUDE THE NEW TABLE   *02011400
020115*       AND ALL THE NEW TABLE FIELDS.                            *02011500
020116*       MADE BY: MADHURA PETHE           WR/IR #: WR37038         02011600
020117* DATE  09/01/2021                                                02011701
020118*            - CHANGE CALL OF  DPKUT100  TO                     * 02011801
020119*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 02011901
020120*              MAKING THE CALL DYNAMIC VS STATIC                * 02012001
020121*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        02012102
020122* DATE  10/24/2022                                               *02012203
020123*     CHANGE MADE: ADD COPYBOOK DPWS930                          *02012303
020124*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API   *02012403
020125*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864       *02012503
020126*                                                                *02012601
020127*----------------------------------------------------------------*02012700
020128 EJECT                                                            02012800
020129 ENVIRONMENT DIVISION.                                            02012900
020130                                                                  02013000
020131 DATA DIVISION.                                                   02013100
020132                                                                  02013200
020133 WORKING-STORAGE SECTION.                                         02013300
020134                                                                  02013400
020135******************************************************************02013500
020136* WORK AREA PASSED IN CALL TO DPKUT500 DATE ROUTINE.             *02013600
020137******************************************************************02013700
020138     COPY DPWS500.                                                02013800
020139                                                                  02013900
020140 01  PC-PROGRAM-CONSTANTS.                                        02014000
020141     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         02014100
020142                                                    'AP365A  '.   02014200
020143     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         02014300
020144                                                    'APKM365 '.   02014400
020145     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         02014500
020146                                                    'APKCS365'.   02014600
020147     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      02014700
020148     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      02014800
020149     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +11     02014900
020150                                                    COMP SYNC.    02015000
020151     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      02015100
020160                                                    COMP SYNC.    02016000
020170     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         02017000
020180                                                    +1000000      02018000
020190                                                    COMP-3.       02019000
020200     05  PC-MAX-ADD-ITEMS               PIC S9(09)  VALUE         02020000
020300                                                    +550          02030000
020400                                                    COMP-3.       02040000
020500     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       02050000
020600                                                    COMP-3.       02060000
020700     05  PC-MSG-NUMBER-LENGTH           PIC  S9(04) VALUE +5      02070000
020800                                                    COMP SYNC.    02080000
020900     05  PC-STORE-90                    PIC  9(04)  VALUE 90.     02090000
021000     05  PC-EXP-TRN-TYP-CDE             PIC  X(03)  VALUE 'EXP'.  02100000
021100*                                                                 02110000
021200     05  PC-TSYMSG-NUMBERS.                                       02120000
021300         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  02130000
021400         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  02140000
021500         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  02150000
021600         10  PC-TSYMSG-00009            PIC  9(05)  VALUE 00009.  02160000
021700         10  PC-TSYMSG-00034            PIC  9(05)  VALUE 00034.  02170000
021800         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  02180000
021900         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  02190000
022000         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  02200000
022100         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  02210000
022200         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  02220000
022300         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  02230000
022400         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  02240000
022500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  02250000
022600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  02260000
022700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  02270000
022800         10  PC-TSYMSG-00115            PIC  9(05)  VALUE 00115.  02280000
022900         10  PC-TSYMSG-00118            PIC  9(05)  VALUE 00118.  02290000
023000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  02300000
023100         10  PC-TSYMSG-00354            PIC  9(05)  VALUE 00354.  02310000
023200         10  PC-TSYMSG-01902            PIC  9(05)  VALUE 01902.  02320000
023300         10  PC-TSYMSG-01903            PIC  9(05)  VALUE 01903.  02330000
023400         10  PC-TSYMSG-01904            PIC  9(05)  VALUE 01904.  02340000
023500         10  PC-TSYMSG-01906            PIC  9(05)  VALUE 01906.  02350000
023600         10  PC-TSYMSG-01920            PIC  9(05)  VALUE 01920.  02360000
023700         10  PC-TSYMSG-01921            PIC  9(05)  VALUE 01921.  02370000
023800         10  PC-TSYMSG-01922            PIC  9(05)  VALUE 01922.  02380000
023900         10  PC-TSYMSG-01923            PIC  9(05)  VALUE 01923.  02390000
024000         10  PC-TSYMSG-01924            PIC  9(05)  VALUE 01924.  02400000
024100         10  PC-TSYMSG-01925            PIC  9(05)  VALUE 01925.  02410000
024200         10  PC-TSYMSG-01929            PIC  9(05)  VALUE 01929.  02420000
024300         10  PC-TSYMSG-01930            PIC  9(05)  VALUE 01930.  02430000
024400         10  PC-TSYMSG-01931            PIC  9(05)  VALUE 01931.  02440000
024500         10  PC-TSYMSG-01933            PIC  9(05)  VALUE 01933.  02450000
024600         10  PC-TSYMSG-01934            PIC  9(05)  VALUE 01934.  02460000
024700         10  PC-TSYMSG-01935            PIC  9(05)  VALUE 01935.  02470000
024800         10  PC-TSYMSG-01937            PIC  9(05)  VALUE 01937.  02480000
024900         10  PC-TSYMSG-01938            PIC  9(05)  VALUE 01938.  02490000
025000         10  PC-TSYMSG-01967            PIC  9(05)  VALUE 01967.  02500000
025100         10  PC-TSYMSG-02316            PIC  9(05)  VALUE 02316.  02510000
025200         10  PC-TSYMSG-02481            PIC  9(05)  VALUE 02481.  02520000
025300         10  PC-TSYMSG-03427            PIC  9(05)  VALUE 03427.  02530000
025400                                                                  02540000
025500 01  PS-PROGRAM-SWITCHES.                                         02550000
025600     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02560000
025700         88  PS-NO-ERROR                            VALUE 'Y'.    02570000
025800         88  PS-ERROR                               VALUE 'N'.    02580000
025900     05  PS-VALID-DATE-SW               PIC  X(01).               02590000
026000         88  PS-VALID-DATE                          VALUE 'Y'.    02600000
026100         88  PS-INVALID-DATE                        VALUE 'N'.    02610000
026200         88  PS-DATE-RANGE-ERROR                    VALUE 'E'.    02620000
026300     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02630000
026400         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02640000
026500         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02650000
026600*                                                                 02660000
026700 01  PV-PROGRAM-VARIABLES.                                        02670000
026800     05  PV-ONE                         PIC X(01).                02680000
026900     05  PV-SUB                         PIC S9(04)  VALUE +0      02690000
027000                                                    COMP SYNC.    02700000
027100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02710000
027200                                                    COMP SYNC.    02720000
027300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02730000
027400                                                    COMP-3.       02740000
027500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02750000
027600                                                    COMP-3.       02760000
027700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02770000
027800                                                    COMP-3.       02780000
027900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02790000
028000                                                    COMP-3.       02800000
028100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02810000
028200                                                    COMP-3.       02820000
028300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02830000
028400                                                    COMP-3.       02840000
028500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02850000
028600                                                    COMP-3.       02860000
028700     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02870000
028800                                                    COMP SYNC.    02880000
028900     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02890000
029000                                                    COMP SYNC.    02900000
029100     05  PV-ITEM                        PIC S9(04)  VALUE +0      02910000
029200                                                    COMP SYNC.    02920000
029300     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02930000
029400                                                    COMP SYNC.    02940000
029500     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02950000
029600                                                    COMP SYNC.    02960000
029700     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02970000
029800                                                    COMP SYNC.    02980000
029900     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02990000
030000                                                    COMP SYNC.    03000000
030100     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03010000
030200                                                    COMP SYNC.    03020000
030300     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03030000
030400                                                    COMP SYNC.    03040000
030500     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03050000
030600                                                    COMP SYNC.    03060000
030700     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03070000
030800                                                    COMP SYNC.    03080000
030900     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03090000
031000                                                    COMP SYNC.    03100000
031100     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03110000
031200                                                    COMP SYNC.    03120000
031300     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03130000
031400                                                    COMP SYNC.    03140000
031500     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03150000
031600                                                    COMP SYNC.    03160000
031700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03170000
031800                                                    COMP SYNC.    03180000
031900     05  PV-CCYYMMDD-DATE               PIC  X(10).               03190000
032000     05  PV-CCYYMMDD-DATE-RDF           REDEFINES                 03200000
032100         PV-CCYYMMDD-DATE.                                        03210000
032200         10  PV-CCYY                    PIC  X(04).               03220000
032300         10  PV-CCYY-9   REDEFINES PV-CCYY                        03230000
032400                                        PIC  9(04).               03240000
032500         10  PV-CCYY-RDF REDEFINES PV-CCYY.                       03250000
032600             15  PV-CC                  PIC  9(02).               03260000
032700             15  PV-YY                  PIC  9(02).               03270000
032800         10  PV-DASH1                   PIC  X(01).               03280000
032900         10  PV-MM                      PIC  X(02).               03290000
033000         10  PV-MM-9     REDEFINES PV-MM                          03300000
033100                                        PIC  9(02).               03310000
033200         10  PV-DASH2                   PIC  X(01).               03320000
033300         10  PV-DD                      PIC  X(02).               03330000
033400         10  PV-DD-9     REDEFINES PV-DD                          03340000
033500                                        PIC  9(02).               03350000
033600     05  PV-NUM4                        PIC  9(04).               03360000
033700     05  PV-NUM4-X REDEFINES                                      03370000
033800         PV-NUM4                        PIC  X(04).               03380000
033900     05  PV-NUM8                        PIC  9(08).               03390000
034000     05  PV-NUM8-X REDEFINES                                      03400000
034100         PV-NUM8                        PIC  X(08).               03410000
034200     05  PV-10V99                       PIC ----------.99.        03420000
034300     05  PV-10V99-X REDEFINES                                     03430000
034400         PV-10V99                       PIC  X(13).               03440000
034500     05  PV-SKU                         PIC  X(08).               03450000
034600     05  PV-SKU-9 REDEFINES                                       03460000
034700         PV-SKU                         PIC  9(08).               03470000
034800     05  PV-STORE-NBR-4                 PIC S9(04).               03480000
034900     05  PV-OFFSET-BTCH-NBR.                                      03490000
035000         10  FILLER                     PIC  X(10).               03500000
035100         10  PV-OFFSET-BTCH-SRC-CDE     PIC  X(03).               03510000
035200         10  FILLER                     PIC  X(02).               03520000
035300     05  PV-TEMP-DOLLAR-FIELD           PIC  X(13).               03530000
035400     05  PV-TEMP-DOLLAR-FIELD-9         PIC  S9(10)V99  COMP-3.   03540000
035500     05  PV-DISC-AMT                    PIC  S9(10)V99.           03550000
035600     05  PV-DET-RETAIL                  PIC  S9(10)V99.           03560000
035700     05  PV-TEMP-GROSS                  PIC  S9(10)V99.           03570000
035800     05  PV-RETAIL-PERC                 PIC  S9(01)V999999.       03580000
035900     05  PV-CALC-RETAIL                 PIC  S9(10)V999999.       03590000
036000     05  PV-DISP-RETAIL                 PIC  S9(10)V99.           03600000
036100     05  PV-NET-COST                    PIC  S9(10)V99.           03610000
036200     05  PV-OFFSET-NET-COST-AMT         PIC  S9(10)V99            03620000
036300                                                    COMP-3.       03630000
036400     05  PV-DIS-RET-DIFF                PIC  S9(10)V99.           03640000
036500     05  PV-ROUNDING-FACTOR             PIC  S9(01)V9999.         03650000
036600     05  PV-DISTRO-FRGT-AMT             PIC  S9(10)V99.           03660000
036700     05  PV-DISTRO-MISC-CHRG            PIC  S9(10)V99.           03670000
036800     05  PV-DISTRO-DISC-AMT             PIC  S9(10)V99.           03680000
036900     05  PV-TOT-DISTRO-FRGT-AMT         PIC  S9(10)V99.           03690000
037000     05  PV-TOT-DISTRO-MISC-CHRG        PIC  S9(10)V99.           03700000
037100     05  PV-TOT-DISTRO-DISC-AMT         PIC  S9(10)V99.           03710000
037200     05  PV-TOT-DISTRO-NET-COST         PIC  S9(10)V99.           03720000
037300     05  PV-ALLOC-PERC                  PIC  S9(01)V999999.       03730000
037400     05  PV-DIS-CNTR                    PIC  S9(05) COMP-3.       03740000
037500     05  PV-DIS-DOL-DIFF                PIC  S9(10)V99.           03750000
037600     05  PV-FORMAT-DOL-DIFF             PIC  $,$$$,$$$,$$$.99-.   03760000
037700     05  PV-TERM-DISC-AMT               PIC  S9(10)V999999.       03770000
037800     05  PV-NW-STR-DISC-AMT             PIC  S9(10)V999999.       03780000
037900     05  PV-MOS-DISC-AMT                PIC  S9(10)V999999.       03790000
038000     05  PV-TRD-DISC-AMT                PIC  S9(10)V999999.       03800000
038100     05  PV-DUP-COUNT                   PIC  S9(04) VALUE ZERO    03810000
038200                                                    COMP SYNC.    03820000
038300     05  PV-ABS-RETAIL-AMT              PIC   9(10)V99.           03830000
038400     05  PV-ABS-GROSS-COST              PIC   9(10)V99.           03840000
038500     05  PV-MARKON-PCT                  PIC  S9(04)V9999.         03850000
038600     05  PV-DEPARTMENT                  PIC  S9(4)V COMP-3.       03860000
038700     05  PV-CLASS                       PIC  S9(4)V COMP-3.       03870000
038800 01  PV-CLASS-TABLE.                                              03880000
038900     05  PV-CLASS-ENTRIES               OCCURS 1000 TIMES         03890000
039000                                        INDEXED BY ENTRY-IDX.     03900000
039100         10  PV-STORE-ENTRY             PIC  X(04).               03910000
039200         10  PV-CLASS-ENTRY             PIC  X(02).               03920000
039300         10  PV-SKU-ENTRY               PIC  9(08).               03930000
039400                                                                  03940000
039500*---------------------------------------------------------------* 03950000
039600*  RECORD LAYOUT FOR THE ADJUSTMENT SELECTION TEMP STORAGE      * 03960000
039700*  QUEUE.                                                       * 03970000
039800*---------------------------------------------------------------* 03980000
039900                                                                  03990000
040000     COPY APWS362.                                                04000000
040100     COPY APWS363.                                                04010000
040200                                                                  04020000
040300     EJECT                                                        04030000
040400*---------------------------------------------------------------* 04040000
040500*    MAP LAYOUT                                                 * 04050000
040600*---------------------------------------------------------------* 04060000
040700                                                                  04070000
040800     COPY APKM365.                                                04080000
040900*                                                                 04090000
041000 01  MR-OCCURS-LAYOUT                   REDEFINES  AP365AO.       04100000
041100     05  MR-FILLER                      PIC X(0255).              04110000
041200     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          04120000
041300         10  MR-SELECTL                 PIC S9(04) COMP.          04130000
041400         10  MR-SELECTA                 PIC  X(01).               04140000
041500         10  MR-SELECTC                 PIC  X(01).               04150000
041600         10  MR-SELECTH                 PIC  X(01).               04160000
041700         10  MR-SELECTI                 PIC  X(01).               04170000
041800                                                                  04180000
041900         10  MR-STOREL                  PIC S9(04) COMP.          04190000
042000         10  MR-STOREA                  PIC  X(01).               04200000
042100         10  MR-STOREC                  PIC  X(01).               04210000
042200         10  MR-STOREH                  PIC  X(01).               04220000
042300         10  MR-STORE                   PIC  X(04).               04230000
042400         10  MR-STORE-9 REDEFINES                                 04240000
042500             MR-STORE                   PIC  ZZZZ.                04250000
042600                                                                  04260000
042700         10  MR-CLASSL                  PIC S9(04) COMP.          04270000
042800         10  MR-CLASSA                  PIC  X(01).               04280000
042900         10  MR-CLASSC                  PIC  X(01).               04290000
043000         10  MR-CLASSH                  PIC  X(01).               04300000
043100         10  MR-CLASS                   PIC  X(02).               04310000
043200                                                                  04320000
043300         10  MR-SKUL                    PIC S9(04) COMP.          04330000
043400         10  MR-SKUA                    PIC  X(01).               04340000
043500         10  MR-SKUC                    PIC  X(01).               04350000
043600         10  MR-SKUH                    PIC  X(01).               04360000
043700         10  MR-SKU                     PIC  X(08).               04370000
043800                                                                  04380000
043900         10  MR-GROSSL                  PIC S9(04) COMP.          04390000
044000         10  MR-GROSSA                  PIC  X(01).               04400000
044100         10  MR-GROSSC                  PIC  X(01).               04410000
044200         10  MR-GROSSH                  PIC  X(01).               04420000
044300         10  MR-GROSS                   PIC  X(13).               04430000
044400                                                                  04440000
044500         10  MR-RETAILL                 PIC S9(04) COMP.          04450000
044600         10  MR-RETAILA                 PIC  X(01).               04460000
044700         10  MR-RETAILC                 PIC  X(01).               04470000
044800         10  MR-RETAILH                 PIC  X(01).               04480000
044900         10  MR-RETAIL                  PIC  X(13).               04490000
045000                                                                  04500000
045100         10  MR-NETL                    PIC S9(04) COMP.          04510000
045200         10  MR-NETA                    PIC  X(01).               04520000
045300         10  MR-NETC                    PIC  X(01).               04530000
045400         10  MR-NETH                    PIC  X(01).               04540000
045500         10  MR-NET                     PIC  X(13).               04550000
045600                                                                  04560000
045700     EJECT                                                        04570000
045800*---------------------------------------------------------------* 04580000
045900*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04590000
046000*---------------------------------------------------------------* 04600000
046100                                                                  04610000
046200     COPY DPWS015.                                                04620000
046300                                                                  04630000
046400*---------------------------------------------------------------* 04640000
046500*    FUNCTION KEYS COPYBOOK.                                    * 04650000
046600*---------------------------------------------------------------* 04660000
046700                                                                  04670000
046800     COPY DPWS016.                                                04680000
046900                                                                  04690000
047000*---------------------------------------------------------------* 04700000
047100*    NUMERIC EDIT LAYOUT.                                       * 04710000
047200*---------------------------------------------------------------* 04720000
047300                                                                  04730000
047400     COPY DPWS010I.                                               04740000
047500 EJECT                                                            04750000
047600*---------------------------------------------------------------* 04760000
047700*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 04770000
047800*---------------------------------------------------------------* 04780000
047900                                                                  04790000
048000     COPY DPWS030.                                                04800000
048010     COPY DPWS930.                                                04801003
048100 EJECT                                                            04810000
048200*---------------------------------------------------------------* 04820000
048300*    STANDARD COMMAREA.                                         * 04830000
048400*---------------------------------------------------------------* 04840000
048500                                                                  04850000
048600     COPY DPWS020.                                                04860000
048700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04870000
048800                                                                  04880000
048900*---------------------------------------------------------------* 04890000
049000* INTER-APPLICATION COMMAREA.                                   * 04900000
049100*   APWS361 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04910000
049200*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04920000
049300*---------------------------------------------------------------* 04930000
049400                                                                  04940000
049500         10  INTER-APPL-COMM-AREA       PIC X(200).               04950000
049600     COPY APWS361.                                                04960000
049700*---------------------------------------------------------------* 04970000
049800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04980000
049900*---------------------------------------------------------------* 04990000
050000         10  ASC-SPECIFIC-COMMAREA.                               05000000
050100             15  ASC-INT-APPL-FORMAT-IND             PIC  X.      05010000
050200                 88  ASC-INTER-APPL-ADD                VALUE ' '. 05020000
050300             15  ASC-LIST-KEYS.                                   05030000
050400                 20  ASC-KEY-VND-NBR                 PIC  X(09).  05040000
050500                 20  ASC-KEY-DOC-NBR                 PIC  X(16).  05050000
050600                 20  ASC-KEY-DOC-DTE                 PIC  X(10).  05060000
050700                 20  ASC-KEY-AP-TRN-CDE              PIC  X(02).  05070000
050800             15  ASC-ALPHA-FIELDS.                                05080000
050900                 20  ASC-ALP-HD-GRO-COST             PIC  X(13).  05090000
051000                 20  ASC-ALP-HD-GRO-COST-9 REDEFINES              05100000
051100                     ASC-ALP-HD-GRO-COST            PIC -9(10)V99.05110000
051200                 20  ASC-ALP-HD-RET-AMT              PIC  X(13).  05120000
051300                 20  ASC-ALP-HD-RET-AMT-9 REDEFINES               05130000
051400                     ASC-ALP-HD-RET-AMT             PIC -9(10)V99.05140000
051500                 20  ASC-ALP-HD-FRGT-AMT            PIC   X(13).  05150000
051600                 20  ASC-ALP-HD-FRGT-AMT-9 REDEFINES              05160000
051700                     ASC-ALP-HD-FRGT-AMT            PIC -9(10)V99.05170000
051800                 20  ASC-ALP-HD-NEW-STR-AMT         PIC   X(13).  05180000
051900                 20  ASC-ALP-HD-NEW-STR-AMT-9 REDEFINES           05190000
052000                     ASC-ALP-HD-NEW-STR-AMT         PIC -9(10)V99.05200000
052100             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05210000
052200                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05220000
052300                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05230000
052400                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05240000
052500                                                                  05250000
052600                 20  ASC-ITEM-ARRAY.                              05260000
052700                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        05270000
052800                         30  ASC-LIST-ITEM-NUMBER                 05280000
052900                                                     PIC S9(09)   05290000
053000                                                     COMP-3.      05300000
053100                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05310000
053200                             88  ASC-VALID-SELECT    VALUE ' '    05320000
053300                                                           'S'    05330000
053400                                                           'D'.   05340000
053500                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05350000
053600                             88  ASC-TEMP-DELETE     VALUE 'D'.   05360000
053700                             88  ASC-TEMP-SELECT     VALUE 'S'.   05370000
053800                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05380000
053900                             88  ASC-TEMP-END        VALUE 'E'.   05390000
054000                         30  ASC-SELECTED-SW         PIC  X(01).  05400000
054100                             88  ASC-NO-SELECT       VALUE ' '.   05410000
054200                             88  ASC-DELETE          VALUE 'D'.   05420000
054300                             88  ASC-SELECT          VALUE 'S'.   05430000
054400                             88  ASC-BEGIN           VALUE 'B'.   05440000
054500                             88  ASC-END             VALUE 'E'.   05450000
054600                         30  ASC-DISTRB-SEQ-NBR      PIC S9(04)   05460000
054700                                                           COMP.  05470000
054800                         30  ASC-DEPT-NBR            PIC  X(03).  05480000
054900                         30  ASC-STORE-ALL.                       05490000
055000                             35  ASC-ALP-STORE       PIC  X(04).  05500000
055100                             35  ASC-STORE           PIC  9(04).  05510000
055200                         30  ASC-CLASS               PIC  X(02).  05520000
055300                         30  ASC-CLASS-9 REDEFINES ASC-CLASS      05530000
055400                                                     PIC  9(02).  05540000
055500                         30  ASC-SKU               PIC  S9(08)    05550000
055600                                                           COMP-3.05560000
055700                         30  ASC-GROSS-COST        PIC  S9(10)V99 05570000
055800                                                           COMP-3.05580000
055900                         30  ASC-RETAIL-AMT        PIC  S9(10)V99 05590000
056000                                                           COMP-3.05600000
056100                         30  ASC-DT-FRGT-AMT       PIC  S9(10)V99 05610000
056200                                                           COMP-3.05620000
056300                         30  ASC-DT-MISC-CHRG-AMT  PIC  S9(10)V99 05630000
056400                                                           COMP-3.05640000
056500                         30  ASC-DISC-AMT          PIC  S9(10)V99 05650000
056600                                                           COMP-3.05660000
056700                         30  ASC-NET-COST          PIC  S9(11)V99 05670000
056800                                                           COMP-3.05680000
056900                         30  ASC-LINE-CHANGED-SW   PIC  X(01).    05690000
057000                             88  ASC-LINE-UPDATED  VALUE 'A'.     05700000
057100                             88  ASC-LINE-CHANGED  VALUE 'Y'.     05710000
057200                             88  ASC-LINE-NOT-CHANGED             05720000
057300                                                   VALUE ' '.     05730000
057400                         30  ASC-LINE-PROBLEM-SW   PIC  X(01).    05740000
057500                             88  ASC-LINE-ERROR    VALUE 'E'.     05750000
057600                             88  ASC-LINE-OK       VALUE ' '.     05760000
057700                                                                  05770000
057800             15  ASC-BLK-SUB                         PIC S9(04)   05780000
057900                                                          COMP    05790000
058000                                                          SYNC.   05800000
058100             15  ASC-ITEM-SUB                        PIC S9(04)   05810000
058200                                                          COMP    05820000
058300                                                          SYNC.   05830000
058400             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05840000
058500                                                          COMP-3. 05850000
058600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05860000
058700                                                          COMP-3. 05870000
058800             15  ASC-NUMBER-OF-DELETED-ITEMS         PIC S9(09)   05880000
058900                                                          COMP-3. 05890000
059000             15  ASC-NO-OF-DIS-ITEMS                 PIC S9(05)   05900000
059100                                                         COMP-3.  05910000
059200             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05920000
059300                                                          COMP-3. 05930000
059400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05940000
059500                                                          COMP-3. 05950000
059600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05960000
059700                                                          COMP-3. 05970000
059800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05980000
059900                                                          COMP    05990000
060000                                                          SYNC.   06000000
060100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   06010000
060200                                                          COMP-3. 06020000
060300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   06030000
060400                                                          COMP-3. 06040000
060500             15  ASC-STORE-WITHIN-INV-IND            PIC  X(01).  06050000
060600                 88  ASC-NO-STORES-IN-PER            VALUE 'N'.   06060000
060700                 88  ASC-STORE-WITHIN-PER            VALUE 'Y'.   06070000
060800             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06080000
060900                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06090000
061000                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06100000
061100             15  ASC-MULT-DISTRO-IND                 PIC  X(01).  06110000
061200                 88  ASC-MULT-DIST                   VALUE 'Y'.   06120000
061300                 88  ASC-SINGLE-DIST                 VALUE 'N'.   06130000
061400             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  06140000
061500                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   06150000
061600                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   06160000
061700             15  ASC-LIST-QUEUE-NAME.                             06170000
061800                 20  ASC-LIST-TERM-ID                PIC  X(04).  06180000
061900                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   06190000
062000                                                          COMP-3. 06200000
062100                 20  ASC-LIST-SEQ                    PIC  9(01).  06210000
062200             15  ASC-SEL-QUEUE-NAME.                              06220000
062300                 20  ASC-SEL-TERM-ID                 PIC  X(04).  06230000
062400                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   06240000
062500                                                          COMP-3. 06250000
062600                 20  ASC-SEL-SEQ                     PIC  9(01).  06260000
062700             15  ASC-START-ITEM-REQUEST.                          06270000
062800                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06280000
062900             15  ASC-STORE-FOUND-SW                  PIC  X(01).  06290000
063000                 88  ASC-STORE-NOT-FOUND                VALUE 'Y'.06300000
063100                 88  ASC-STORE-FOUND                    VALUE 'N'.06310000
063200             15  ASC-SKU-ENTERED-SW                  PIC  X(01).  06320000
063300                 88  ASC-SKU-NOT-ENTERED                VALUE 'Y'.06330000
063400                 88  ASC-SKU-ENTERED                    VALUE 'N'.06340000
063500                 88  ASC-SKU-NOT-ALLOWED                VALUE 'O'.06350000
063600             15  ASC-ALLOCATION-SW                   PIC  X(01).  06360000
063700                 88  ASC-GROSS-COST-ALLOCATION          VALUE 'G'.06370000
063800                 88  ASC-RETAIL-AMT-ALLOCATION          VALUE 'R'.06380000
063900                 88  ASC-FREIGHT-COST-ALLOCATION        VALUE 'F'.06390000
064000                 88  ASC-NEW-STR-COST-ALLOCATION        VALUE 'N'.06400000
064100             15  ASC-CLASS-FOUND-SW                  PIC  X(01).  06410000
064200                 88  ASC-CLASS-FOUND                    VALUE 'Y'.06420000
064300                 88  ASC-CLASS-NOT-FOUND                VALUE 'N'.06430000
064400             15  ASC-DELETE-PROCESS-SW               PIC  X(03).  06440000
064500                 88  ASC-NO-DELETE                    VALUE '   '.06450000
064600                 88  ASC-DELETE-REQUESTED             VALUE 'REQ'.06460000
064700                 88  ASC-DELETE-PENDING               VALUE 'PND'.06470000
064800             15  ASC-SKU-FOUND-SW                    PIC  X(01).  06480000
064900                 88  ASC-SKU-FOUND                      VALUE 'Y'.06490000
065000                 88  ASC-SKU-NOT-FOUND                  VALUE 'N'.06500000
065100             15  ASC-COST-MATCH-IND                  PIC  X(01).  06510000
065200                 88  ASC-COST-MATCH                     VALUE 'Y'.06520000
065300                 88  ASC-COST-NOT-MATCH                 VALUE 'N'.06530000
065400             15  ASC-RETAIL-MATCH-IND                PIC  X(01).  06540000
065500                 88  ASC-RETAIL-MATCH                   VALUE 'Y'.06550000
065600                 88  ASC-RETAIL-NOT-MATCH               VALUE 'N'.06560000
065700             15  ASC-OFFSET-ADJ-FOUND-SW             PIC  X(01).  06570000
065800                 88  ASC-OFFSET-ADJ-FOUND               VALUE 'Y'.06580000
065900                 88  ASC-OFFSET-ADJ-NOT-FOUND           VALUE 'N'.06590000
066000             15  ASC-CURRENT-DATE                    PIC  X(10).  06600000
066100             15  ASC-CUTOFF-DATE                     PIC  X(10).  06610000
066200             15  ASC-CUTOFF-DATE-RDF REDEFINES                    06620000
066300                 ASC-CUTOFF-DATE.                                 06630000
066400                 20  ASC-CUTOFF-CC                   PIC  X(02).  06640000
066500                 20  ASC-CUTOFF-YY                   PIC  X(02).  06650000
066600                 20  FILLER                          PIC  X(01).  06660000
066700                 20  ASC-CUTOFF-MM                   PIC  X(02).  06670000
066800                 20  FILLER                          PIC  X(01).  06680000
066900                 20  ASC-CUTOFF-DD                   PIC  X(02).  06690000
067000             15  ASC-HD-STORE                        PIC  9(04).  06700000
067100             15  ASC-DOC-NBR                         PIC  X(16).  06710000
067200             15  ASC-PO-NBR                          PIC  X(09).  06720000
067300             15  ASC-DEPT                            PIC  X(03).  06730000
067400             15  ASC-DEPT-9 REDEFINES ASC-DEPT       PIC  9(03).  06740000
067500             15  ASC-ACCOUNT                         PIC  X(07).  06750000
067600             15  ASC-HD-GRO-COST                    PIC S9(10)V99 06760000
067700                                                        COMP-3.   06770000
067800             15  ASC-VND-NBR                         PIC  X(09).  06780000
067900             15  ASC-VND-NAME                        PIC  X(25).  06790000
068000             15  ASC-HD-RET-AMT                     PIC S9(10)V99 06800000
068100                                                        COMP-3.   06810000
068200             15  ASC-DOC-DTE                         PIC  X(10).  06820000
068300             15  ASC-AP-TRN-CDE                      PIC  X(02).  06830000
068400*            15  ASC-ENTR-TMST                       PIC  X(26).  06840000
068500             15  ASC-ENTR-ID                         PIC  X(08).  06850000
068600             15  ASC-ORGN-CDE                        PIC  X(01).  06860000
068700             15  ASC-HD-FRGT-AMT                    PIC S9(10)V99 06870000
068800                                                        COMP-3.   06880000
068900             15  ASC-HD-NEW-STR-AMT                 PIC S9(10)V99 06890000
069000                                                        COMP-3.   06900000
069100             15  ASC-MISC-CHRG-AMT                  PIC S9(10)V99 06910000
069200                                                        COMP-3.   06920000
069300             15  ASC-TERM-DISC-PCT               PIC 9(03)V9(4).  06930000
069400             15  ASC-TERM-DISC-AMT                  PIC S9(10)V99 06940000
069500                                                        COMP-3.   06950000
069600             15  ASC-NET-COST-AMT                   PIC S9(10)V99 06960000
069700                                                        COMP-3.   06970000
069800             15  ASC-INV-CTOFF-DTE                   PIC  X(10).  06980000
069900             15  ASC-TRN-TYP-CDE                     PIC  X(03).  06990000
070000             15  ASC-DOC-EXTR-IND                    PIC  X(01).  07000000
070100             15  ASC-DOC-EXTR-DTE                    PIC  X(10).  07010000
070200             15  ASC-PSTG-FYR-NBR                    PIC  X(04).  07020000
070300             15  ASC-PSTG-FMN-NBR                    PIC  X(02).  07030000
070400             15  ASC-PSTG-FWK-NBR                    PIC  X(02).  07040000
070500             15  ASC-BRCDE-NBR                       PIC  X(09).  07050000
070600             15  ASC-PS-BTCH-NBR                     PIC  X(15).  07060000
070700             15  ASC-PS-PSTG-IND                     PIC  X(01).  07070000
070800             15  ASC-ENT-ID                          PIC  9(09)   07080000
070900                                                          COMP-3. 07090000
071000             15  ASC-NW-STR-DISC-PCT             PIC  9(03)V9(4). 07100000
071100             15  ASC-NW-STR-DISC-AMT                PIC S9(10)V99 07110000
071200                                                        COMP-3.   07120000
071300             15  ASC-TRD-DISC-PCT                PIC  9(03)V9(4). 07130000
071400             15  ASC-TRD-DISC-AMT                   PIC S9(10)V99 07140000
071500                                                        COMP-3.   07150000
071600             15  ASC-MOS-DISC-PCT                PIC  9(03)V9(4). 07160000
071700             15  ASC-MOS-DISC-AMT                   PIC S9(10)V99 07170000
071800                                                        COMP-3.   07180000
071900             15  ASC-TOTAL-DISC-AMT                 PIC S9(10)V99 07190000
072000                                                        COMP-3.   07200000
072100             15  ASC-TOTAL-GROSS-COST               PIC S9(10)V99 07210000
072200                                                        COMP-3.   07220000
072300             15  ASC-TOTAL-RETAIL-AMT               PIC S9(10)V99 07230000
072400                                                        COMP-3.   07240000
072500             15  ASC-DUE-DTE                         PIC  X(10).  07250000
072600             15  ASC-DOC-HLD-CDE                     PIC  X(01).  07260000
072700             15  ASC-RSN-1ST-LNE-TXT                 PIC  X(50).  07270000
072800             15  ASC-RSN-2ND-LNE-TXT                 PIC  X(50).  07280000
072900             15  ASC-AUTH-NBR                        PIC  X(10).  07290000
073000             15  ASC-DIS-STR-NBR                     PIC  9(04)   07300000
073100                                                          COMP-3. 07310000
073200             15  ASC-DIS-CL-NBR                      PIC  X(02).  07320000
073300             15  ASC-DIS-SKU-NBR                     PIC S9(08)   07330000
073400                                                          COMP-3. 07340000
073500             15  ASC-DIS-GRO-COST-AMT               PIC S9(10)V99 07350000
073600                                                        COMP-3.   07360000
073700             15  ASC-DIS-RTL-AMT                    PIC S9(10)V99 07370000
073800                                                        COMP-3.   07380000
073900             15  ASC-DIS-NET-COST-AMT               PIC S9(10)V99 07390000
074000                                                        COMP-3.   07400000
074100             15  ASC-DIS-DISTRB-SEQ                  PIC  S9(09)  07410000
074200                                                          COMP-3. 07420000
074300             15  ASC-COST-PRCCTL-CDE                 PIC  X(01).  07430000
074400             15  ASC-AP-PSTG-IND                     PIC  X(01).  07440000
074500             15  ASC-RTL-PRCCTL-CDE                  PIC  X(01).  07450000
074600             15  ASC-PSTG-TYP-CDE                    PIC  X(02).  07460000
074700             15  ASC-SUB-CL-REQR-IND                 PIC  X(01).  07470000
074800             15  ASC-SKU-SEQ-REQR-IND                PIC  X(01).  07480000
074900             15  ASC-FRGT-REQR-IND                   PIC  X(01).  07490000
075000             15  ASC-ACTION-SW                       PIC  X(03).  07500000
075100             15  ASC-SAVE-BLK-SUB                    PIC  9(04).  07510000
075200             15  ASC-SAVE-ITEM-SUB                   PIC  9(04).  07520000
075300             15  ASC-TS-QUEUE-NAME                   PIC  X(08).  07530000
075400             15  ASC-OFFSET-TRAN-CD                  PIC  X(02).  07540000
075500             15  ASC-OFFSET-ACCT-NO                  PIC  X(06).  07550000
075600             15  ASC-OFFSET-BYPASS-IND               PIC  X(01).  07560000
075700             15  ASC-OFFSET-DOC-NBR                  PIC  X(16).  07570000
075800             15  ASC-OFFSET-BTCH-SRC-CDE             PIC  X(03).  07580000
075900             15  ASC-OFFSET-PSTG-TYP-CDE             PIC  X(02).  07590000
076000             15  ASC-OFFSET-NET-COST-AMT            PIC S9(10)V99 07600000
076100                                                        COMP-3.   07610000
076200     EJECT                                                        07620000
076300*---------------------------------------------------------------* 07630000
076400*    ABEND PROCESSING COPYBOOK.                                 * 07640000
076500*---------------------------------------------------------------* 07650000
076600                                                                  07660000
076700     COPY DPWS013.                                                07670000
076800                                                                  07680000
076900 EJECT                                                            07690000
077000*---------------------------------------------------------------* 07700000
077100*    DB2 AREA FOR ADJUSTMENT JOURNAL HEADER                     * 07710000
077200*---------------------------------------------------------------* 07720000
077300     EXEC SQL                                                     07730000
077400          INCLUDE TADJRNL                                         07740000
077500     END-EXEC.                                                    07750000
077600*---------------------------------------------------------------* 07760000
077700*    DB2 AREA FOR ADJUSTMENT JOURNAL DISTRIBUTION               * 07770000
077800*---------------------------------------------------------------* 07780000
077900     EXEC SQL                                                     07790000
078000          INCLUDE TADJDIS                                         07800000
078100     END-EXEC.                                                    07810000
078200*---------------------------------------------------------------* 07820000
078300*    DB2 AREA FOR ADJUSTMENT JOURNAL PEOPLESOFT INTERFACE       * 07830000
078400*---------------------------------------------------------------* 07840000
078500     EXEC SQL                                                     07850000
078600          INCLUDE TAJPSINT                                        07860000
078700     END-EXEC.                                                    07870000
078800*---------------------------------------------------------------* 07880000
078900*    DB2 AREA FOR TMDSEAR                                       * 07890000
079000*---------------------------------------------------------------* 07900000
079100     EXEC SQL                                                     07910000
079200          INCLUDE TMDSEAR                                         07920000
079300     END-EXEC.                                                    07930000
079400*---------------------------------------------------------------* 07940000
079500*    DB2 AREA FOR TSKXREF                                       * 07950000
079600*---------------------------------------------------------------* 07960000
079700     EXEC SQL                                                     07970000
079800          INCLUDE TSKXREF                                         07980000
079900     END-EXEC.                                                    07990000
080000*---------------------------------------------------------------* 08000000
080100*    DB2 AREA FOR SYSDUMMY1                                     * 08010000
080200*---------------------------------------------------------------* 08020000
080300     EXEC SQL                                                     08030000
080400          INCLUDE SYSDUMMY                                        08040000
080500     END-EXEC.                                                    08050000
080600*---------------------------------------------------------------* 08060000
080700*    DB2 AREA FOR LOCATION MASTER                               * 08070000
080800*---------------------------------------------------------------* 08080000
080900     EXEC SQL                                                     08090000
081000          INCLUDE XFT00017                                        08100000
081100     END-EXEC.                                                    08110000
081200*---------------------------------------------------------------* 08120000
081300*    DB2 AREA FOR TINVPAR TABLE                                 * 08130000
081400*---------------------------------------------------------------* 08140000
081500     EXEC SQL                                                     08150000
081600          INCLUDE TINVPAR                                         08160000
081700     END-EXEC.                                                    08170000
081800*---------------------------------------------------------------* 08180000
081900*    DB2 AREA FOR COMMUNICATIONS                                * 08190000
082000*---------------------------------------------------------------* 08200000
082100     EXEC SQL                                                     08210000
082200          INCLUDE SQLCA                                           08220000
082300     END-EXEC.                                                    08230000
082400                                                                  08240000
082500***************************************************************** 08250000
082600*    CURSOR TO EXTRACT THE ADJUSTMENT DISTRIBUTION              * 08260000
082700***************************************************************** 08270000
082800     EXEC SQL                                                     08280000
082900          DECLARE DISTRO-CSR CURSOR FOR                           08290000
083000              SELECT VND_NBR                                      08300000
083100                    ,DOC_NBR                                      08310000
083200                    ,DOC_DTE                                      08320000
083300                    ,AP_TRN_CDE                                   08330000
083400                    ,DISTRB_SEQ_NBR                               08340000
083500                    ,STR_NBR                                      08350000
083600                    ,DEPT_NBR                                     08360000
083700                    ,CL_NBR                                       08370000
083800                    ,SKU_NBR                                      08380000
083900                    ,GRO_COST_AMT                                 08390000
084000                    ,RTL_AMT                                      08400000
084100                    ,FRGT_AMT                                     08410000
084200                    ,MISC_CHRG_AMT                                08420000
084300                    ,DISC_AMT                                     08430000
084400                    ,NET_COST_AMT                                 08440000
084500              FROM TADJDIS                                        08450000
084600              WHERE VND_NBR    = :ASC-KEY-VND-NBR                 08460000
084700              AND   DOC_NBR    = :ASC-KEY-DOC-NBR                 08470000
084800              AND   DOC_DTE    = :ASC-KEY-DOC-DTE                 08480000
084900              AND   AP_TRN_CDE = :ASC-KEY-AP-TRN-CDE              08490000
085000              ORDER BY VND_NBR, DOC_NBR, DOC_DTE, AP_TRN_CDE,     08500000
085100                       DISTRB_SEQ_NBR                             08510000
085200     END-EXEC.                                                    08520000
085300                                                                  08530000
085400 EJECT                                                            08540000
085500 LINKAGE SECTION.                                                 08550000
085600                                                                  08560000
085700 01  DFHCOMMAREA.                                                 08570000
085800     05  FILLER                         OCCURS  1 TO 4072 TIMES   08580000
085900                                        DEPENDING ON EIBCALEN.    08590000
086000         10  FILLER                     PIC X.                    08600000
086100                                                                  08610000
086200 EJECT                                                            08620000
086300 PROCEDURE DIVISION.                                              08630000
086400******************************************************************08640000
086500**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **08650000
086600**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **08660000
086700**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **08670000
086800******************************************************************08680000
086900 0000-MAIN-MODULE.                                                08690000
087000                                                                  08700000
087100     INITIALIZE DP030-CICS-API-FIELDS.                            08710000
087200                                                                  08720000
087300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08730000
087400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08740000
087500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08750000
087600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08760000
087700     MOVE LENGTH OF AP365AI        TO DP030-MAP-LENGTH (1).       08770000
087800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08780000
087900                                                                  08790000
088000     PERFORM 0001-CALL-CICS-ARCH-API.                             08800000
088100                                                                  08810000
088200     PERFORM 1000-CONTROL-PROCESSING.                             08820000
088300                                                                  08830000
088400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08840000
088500                                                                  08850000
088600     PERFORM 0001-CALL-CICS-ARCH-API.                             08860000
088700                                                                  08870000
088800******************************************************************08880000
088900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08890000
089000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08900000
089100******************************************************************08910000
089200 0001-CALL-CICS-ARCH-API.                                         08920000
089300                                                                  08930000
089400     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     08940003
089500                                     DFHCOMMAREA                  08950003
089600                                     DP030-CICS-API-FIELDS        08960003
089700                                     DP020-STANDARD-COMMAREA      08970003
089800                                     AP365AI.                     08980003
089900                                                                  08990000
090000     IF  DP030-RC-CALL-SUCCESSFUL                                 09000000
090100         CONTINUE                                                 09010000
090200     ELSE                                                         09020000
090300         SET DP013-NO-ROLLBACK                                    09030000
090400             DP013-XCTL-DISPLAY-RESTART                           09040000
090500             DP013-CICS-ABEND      TO TRUE                        09050000
090600         MOVE '0001-CALL-CICS-ARCH-API'                           09060000
090700                                   TO DP013-PARAGRAPH             09070000
090910         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O09091003
090920-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09092003
091000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09100000
091100         PERFORM DP013-0000-PROCESS-ABEND                         09110000
091200     END-IF.                                                      09120000
091300                                                                  09130000
091400******************************************************************09140000
091500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09150000
091600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09160000
091700*                                                                *09170000
091800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09180000
091900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09190000
092000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09200000
092100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09210000
092200******************************************************************09220000
092300 1000-CONTROL-PROCESSING.                                         09230000
092400                                                                  09240000
092500     EVALUATE TRUE                                                09250000
092600         WHEN DP020-NEXT-ACT-INITIAL                              09260000
092700             INITIALIZE ASC-SPECIFIC-COMMAREA                     09270000
092800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09280000
092900                                      ASC-SEL-TERM-ID             09290000
093000             MOVE DP020-SRC-TASK-NUMBER                           09300000
093100                                   TO ASC-LIST-TASK-NUMBER        09310000
093200                                      ASC-SEL-TASK-NUMBER         09320000
093300             MOVE PC-LIST-QUEUE-SEQ                               09330000
093400                                   TO ASC-LIST-SEQ                09340000
093500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09350000
093600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09360000
093700             IF  PS-ERROR                                         09370000
093800                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            09380000
093900             ELSE                                                 09390000
094000** THIS IF WILL PERFORM LOGIC TO PERFORM A "QUICK" UPDATE OR      09400000
094100** INSERT IN THE CASE THAT THERE IS ONLY ONE LINE OF DISTRIBUTION 09410000
094200** FOR AN ADJUSTMENT.  CONTROL WILL BE RETURNED BACK TO THE       09420000
094300** ADJUSTMENT HEADER SCREEN AFTER SUCCESSFUL DB2 INSERT OR        09430000
094400** UPDATE.                                                        09440000
094500                 IF ASC-COST-MATCH AND                            09450000
094600                    ASC-RETAIL-MATCH                              09460000
094700                    IF ASC-ACTION-SW = 'UPD' AND                  09470000
094800                       ASC-SINGLE-DIST                            09480000
094900                       PERFORM 6500-FORMAT-HEADER-DCLGEN          09490000
095000                       PERFORM 7200-UPDATE-TADJRNL                09500000
095100                       PERFORM 7250-UPDATE-TAJPSINT               09510000
095200                       PERFORM 6600-FORMAT-FOR-SINGLE-DIST        09520000
095300                       PERFORM 8200-ADJUSTMENT-DISTRO-UPDATE      09530000
095400                       IF ASC-OFFSET-ADJ-FOUND                    09540000
095500                          PERFORM 6501-FORMAT-OFFSET-HEADER       09550000
095600                          PERFORM 7200-UPDATE-TADJRNL             09560000
095700                          PERFORM 7250-UPDATE-TAJPSINT            09570000
095800                          PERFORM 6601-FORMAT-OFFSET-SINGLE-DIST  09580000
095900                          PERFORM 8200-ADJUSTMENT-DISTRO-UPDATE   09590000
096000                       END-IF                                     09600000
096100                       MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER   09610000
096200                       SET DP020-MSG-INFORMATIONAL TO TRUE        09620000
096300*                      SET DP020-NEXT-ACT-APPL-ERROR TO TRUE      09630000
096400                       MOVE DP016-PF3 TO DP020-SRC-AID            09640000
096500                    ELSE                                          09650000
096600                       IF ASC-ACTION-SW = 'ADD'                   09660000
096700                             MOVE ASC-CURRENT-DATE TO             09670000
096800                                                  ASC-CUTOFF-DATE 09680000
096900                          IF ASC-NO-STORES-IN-PER                 09690000
097000                             PERFORM 6500-FORMAT-HEADER-DCLGEN    09700000
097100                             PERFORM 7100-INSERT-ADJUSTMENT-HEADER09710000
097200                             PERFORM 7150-INSERT-TAJPSINT         09720000
097300                             PERFORM 6600-FORMAT-FOR-SINGLE-DIST  09730000
097400                             MOVE +1 TO ADJDIS-DISTRB-SEQ-NBR     09740000
097500                             PERFORM 8100-ADJUSTMENT-DISTRO-ADD   09750000
097600                             IF ASC-OFFSET-BYPASS-IND = 'N'       09760000
097700                                PERFORM                           09770000
097800                                   6501-FORMAT-OFFSET-HEADER      09780000
097900                                PERFORM                           09790000
098000                                   7100-INSERT-ADJUSTMENT-HEADER  09800000
098100                                PERFORM                           09810000
098200                                   7150-INSERT-TAJPSINT           09820000
098300                                PERFORM                           09830000
098400                                   6601-FORMAT-OFFSET-SINGLE-DIST 09840000
098500                                MOVE +1 TO ADJDIS-DISTRB-SEQ-NBR  09850000
098600                                PERFORM                           09860000
098700                                   8100-ADJUSTMENT-DISTRO-ADD     09870000
098800                                MOVE PC-TSYMSG-03427              09880000
098900                                               TO DP020-MSG-NUMBER09890000
099000                             ELSE                                 09900000
099100                                MOVE PC-TSYMSG-00034              09910000
099200                                               TO DP020-MSG-NUMBER09920000
099300                             END-IF                               09930000
099400                             SET DP020-MSG-INFORMATIONAL TO TRUE  09940000
099500*                            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE09950000
099600                             MOVE DP016-PF3 TO DP020-SRC-AID      09960000
099700                          ELSE                                    09970000
099800                             PERFORM 4000-BUILD-INITIAL-PANEL     09980000
099900                          END-IF                                  09990000
100000                       END-IF                                     10000000
100100                    END-IF                                        10010000
100200                 ELSE                                             10020000
100300                    PERFORM 4000-BUILD-INITIAL-PANEL              10030000
100400                 END-IF                                           10040000
100500             END-IF                                               10050000
100600                                                                  10060000
100700         WHEN DP020-NEXT-ACT-READ-MAP                             10070000
100800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10080000
100900                                   TO PV-TOP-ITEM                 10090000
101000             PERFORM 2000-PROCESS-PANEL                           10100000
101100                                                                  10110000
101200         WHEN OTHER                                               10120000
101300             SET DP013-LOGIC-ABEND TO TRUE                        10130000
101400             SET DP013-NO-ROLLBACK TO TRUE                        10140000
101500             MOVE '1000-CONTROL-PROCESSING'                       10150000
101600                                   TO DP013-PARAGRAPH             10160000
101700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10170000
101800                                   TO DP013-MESSAGE-TEXT(1)       10180000
101900             PERFORM DP013-0000-PROCESS-ABEND                     10190000
102000     END-EVALUATE.                                                10200000
102100                                                                  10210000
102200 EJECT                                                            10220000
102300******************************************************************10230000
102400* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10240000
102500* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10250000
102600******************************************************************10260000
102700 1100-PROCESS-INTER-APPL-COMM.                                    10270000
102800                                                                  10280000
102900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     10290000
103000     SET ASC-NO-STORES-IN-PER      TO TRUE.                       10300000
103100                                                                  10310000
103200     EXEC SQL                                                     10320000
103300         SET :ASC-CURRENT-DATE = CURRENT DATE                     10330000
103400     END-EXEC.                                                    10340000
103500                                                                  10350000
103600     MOVE AP361-VND-NBR            TO ASC-KEY-VND-NBR.            10360000
103700     MOVE AP361-DOC-NO             TO ASC-KEY-DOC-NBR.            10370000
103800     MOVE AP361-DOC-DATE           TO ASC-KEY-DOC-DTE.            10380000
103900     MOVE AP361-TRN-CDE            TO ASC-KEY-AP-TRN-CDE.         10390000
104000*MMAFTER                                                          10400000
104100     MOVE AP361-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME.         10410000
104200     MOVE AP361-TS-QUEUE-NAME      TO ASC-TS-QUEUE-NAME.          10420000
104300*MMBEFORE                                                         10430000
104400     MOVE DP020-INT-APPL-FORMAT-IND                               10440000
104500                                   TO ASC-INT-APPL-FORMAT-IND.    10450000
104600     MOVE +1 TO PV-SEL-QUEUE-ITEM.                                10460000
104700                                                                  10470000
104800     PERFORM 6108-READ-TEMP-QUEUE.                                10480000
104900                                                                  10490000
105000     PERFORM 6109-DELETE-TEMP-QUEUE.                              10500000
105100                                                                  10510000
105200     PERFORM 1105-MOVE-TEMP-STORE-FIELDS.                         10520000
105300                                                                  10530000
105400** IF IN ADD MODE THEN DO NOT SHOW ITEM COUNT.                    10540000
105500     IF ASC-ACTION-SW = 'ADD'                                     10550000
105600        MOVE DP015-HL-OFF          TO ASTRTITH                    10560000
105700        MOVE DP015-PRO-DRK-MDT     TO LABELA                      10570000
105800                                      LABEL2A                     10580000
105900                                      LABEL3A                     10590000
106000                                      LABEL4A                     10600000
106100                                      ASTRTITA                    10610000
106200        MOVE DP015-PRO-DRK-MDT     TO ATOTITA                     10620000
106300                                      AENDITA                     10630000
106400                                      AENDITA                     10640000
106500        PERFORM                                                   10650000
106600            VARYING PV-SUB                                        10660000
106700            FROM 1 BY 1                                           10670000
106800            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     10680000
106900            MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)         10690000
107000            MOVE DP015-HL-OFF      TO MR-SELECTH (PV-SUB)         10700000
107100        END-PERFORM                                               10710000
107200     END-IF.                                                      10720000
107300                                                                  10730000
107400     IF ASC-ACTION-SW = 'DEL'                                     10740000
107500        SET ASC-DELETE-REQUESTED TO TRUE                          10750000
107600     ELSE                                                         10760000
107700        SET ASC-NO-DELETE TO TRUE                                 10770000
107800     END-IF.                                                      10780000
107900                                                                  10790000
108000******************************************************************10800000
108100* THIS PARAGRAPH WILL MOVE THE TEMPORARY STORAGE QUEUE ITEMS     *10810000
108200* FROM THE HEADER SCREEN TO THE ASC FIELDS.                      *10820000
108300******************************************************************10830000
108400 1105-MOVE-TEMP-STORE-FIELDS.                                     10840000
108500                                                                  10850000
108600     MOVE AP363-VND-NBR            TO ASC-VND-NBR.                10860000
108700     MOVE AP363-DOC-NBR            TO ASC-DOC-NBR.                10870000
108800     MOVE AP363-PO-NBR             TO ASC-PO-NBR.                 10880000
108900     MOVE AP363-DEPT-NBR           TO ASC-DEPT.                   10890000
109000     MOVE AP363-STR-NBR            TO ASC-HD-STORE.               10900000
109100     MOVE AP363-GL-ACCT-NBR        TO ASC-ACCOUNT.                10910000
109200     MOVE AP363-VENDOR-NAME        TO ASC-VND-NAME.               10920000
109300     MOVE AP363-GRO-COST-AMT       TO ASC-ALP-HD-GRO-COST-9       10930000
109400                                      ASC-HD-GRO-COST.            10940000
109500     MOVE AP363-RTL-AMT            TO ASC-ALP-HD-RET-AMT-9        10950000
109600                                      ASC-HD-RET-AMT.             10960000
109700                                                                  10970000
109800     MOVE AP363-DOC-DTE            TO ASC-DOC-DTE.                10980000
109900     MOVE AP363-AP-TRN-CDE         TO ASC-AP-TRN-CDE.             10990000
110000*    MOVE AP363-ENTR-TMST          TO ASC-ENTR-TMST.              11000000
110100     MOVE AP363-ENTR-ID            TO ASC-ENTR-ID.                11010000
110200     MOVE AP363-ORGN-CDE           TO ASC-ORGN-CDE.               11020000
110300     MOVE AP363-FRGT-AMT           TO ASC-ALP-HD-FRGT-AMT-9       11030000
110400                                      ASC-HD-FRGT-AMT.            11040000
110500     MOVE AP363-MISC-CHRG-AMT      TO ASC-MISC-CHRG-AMT.          11050000
110600     MOVE AP363-TERM-DISC-PCT      TO ASC-TERM-DISC-PCT.          11060000
110700                                                                  11070000
110800     MOVE AP363-TERM-DISC-AMT      TO ASC-TERM-DISC-AMT.          11080000
110900     MOVE AP363-NET-COST-AMT       TO ASC-NET-COST-AMT.           11090000
111000     MOVE AP363-INV-CTOFF-DTE      TO ASC-CUTOFF-DATE.            11100000
111100     MOVE AP363-TRN-TYP-CDE        TO ASC-TRN-TYP-CDE.            11110000
111200     MOVE AP363-DOC-EXTR-IND       TO ASC-DOC-EXTR-IND.           11120000
111300     MOVE AP363-DOC-EXTR-DTE       TO ASC-DOC-EXTR-DTE.           11130000
111400     MOVE AP363-PSTG-FYR-NBR       TO ASC-PSTG-FYR-NBR.           11140000
111500     MOVE AP363-PSTG-FMN-NBR       TO ASC-PSTG-FMN-NBR.           11150000
111600     MOVE AP363-PSTG-FWK-NBR       TO ASC-PSTG-FWK-NBR.           11160000
111700     MOVE AP363-BRCDE-NBR          TO ASC-BRCDE-NBR.              11170000
111800     MOVE AP363-PS-BTCH-NBR        TO ASC-PS-BTCH-NBR.            11180000
111900     MOVE AP363-PS-PSTG-IND        TO ASC-PS-PSTG-IND.            11190000
112000     MOVE AP363-ENT-ID             TO ASC-ENT-ID.                 11200000
112100                                                                  11210000
112200     MOVE AP363-NW-STR-DISC-PCT    TO ASC-NW-STR-DISC-PCT.        11220000
112300     MOVE AP363-NW-STR-DISC-AMT    TO ASC-NW-STR-DISC-AMT         11230000
112400                                      ASC-ALP-HD-NEW-STR-AMT-9    11240000
112500                                      ASC-HD-NEW-STR-AMT.         11250000
112600     MOVE AP363-TRD-DISC-PCT       TO ASC-TRD-DISC-PCT.           11260000
112700     MOVE AP363-TRD-DISC-AMT       TO ASC-TRD-DISC-AMT.           11270000
112800     MOVE AP363-MOS-DISC-PCT       TO ASC-MOS-DISC-PCT.           11280000
112900     MOVE AP363-MOS-DISC-AMT       TO ASC-MOS-DISC-AMT.           11290000
113000     MOVE AP363-DUE-DTE            TO ASC-DUE-DTE.                11300000
113100     MOVE AP363-DOC-HLD-CDE        TO ASC-DOC-HLD-CDE.            11310000
113200     MOVE AP363-RSN-1ST-LNE-TXT    TO ASC-RSN-1ST-LNE-TXT.        11320000
113300     MOVE AP363-RSN-2ND-LNE-TXT    TO ASC-RSN-2ND-LNE-TXT.        11330000
113400     MOVE AP363-AUTH-NBR           TO ASC-AUTH-NBR.               11340000
113500     MOVE AP363-DIS-STR-NBR        TO ASC-DIS-STR-NBR.            11350000
113600     MOVE AP363-DIS-CL-NBR         TO ASC-DIS-CL-NBR.             11360000
113700     MOVE AP363-DIS-SKU-NBR        TO ASC-DIS-SKU-NBR.            11370000
113800     MOVE AP363-DIS-GRO-COST-AMT   TO ASC-DIS-GRO-COST-AMT.       11380000
113900     MOVE AP363-DIS-RTL-AMT        TO ASC-DIS-RTL-AMT.            11390000
114000                                                                  11400000
114100     MOVE AP363-DIS-NET-COST-AMT   TO ASC-DIS-NET-COST-AMT.       11410000
114200     MOVE AP363-COST-PRCCTL-CDE    TO ASC-COST-PRCCTL-CDE.        11420000
114300     MOVE AP363-AP-PSTG-IND        TO ASC-AP-PSTG-IND.            11430000
114400     MOVE AP363-RTL-PRCCTL-CDE     TO ASC-RTL-PRCCTL-CDE.         11440000
114500     MOVE AP363-PSTG-TYP-CDE       TO ASC-PSTG-TYP-CDE.           11450000
114600     MOVE AP363-SKU-SEQ-REQR-IND   TO ASC-SKU-SEQ-REQR-IND.       11460000
114700     MOVE AP363-SUB-CL-REQR-IND    TO ASC-SUB-CL-REQR-IND.        11470000
114800     MOVE AP363-FRGT-REQR-IND      TO ASC-FRGT-REQR-IND.          11480000
114900     MOVE AP363-ACTION-SW          TO ASC-ACTION-SW.              11490000
115000     MOVE AP363-MULT-DISTRO-IND    TO ASC-MULT-DISTRO-IND.        11500000
115100     MOVE AP363-DISTRB-SEQ-NBR     TO ASC-DIS-DISTRB-SEQ.         11510000
115200     MOVE AP363-COST-MATCH-IND     TO ASC-COST-MATCH-IND.         11520000
115300     MOVE AP363-RETAIL-MATCH-IND   TO ASC-RETAIL-MATCH-IND.       11530000
115400     MOVE AP363-SKU-ENTERED-SW     TO ASC-SKU-ENTERED-SW.         11540000
115500     MOVE AP363-ALLOCATION-SW      TO ASC-ALLOCATION-SW.          11550000
115600     MOVE AP363-OFFSET-TRAN-CD     TO ASC-OFFSET-TRAN-CD.         11560000
115700     MOVE AP363-OFFSET-ACCT-NO     TO ASC-OFFSET-ACCT-NO.         11570000
115800     MOVE AP363-OFFSET-BYPASS-IND  TO ASC-OFFSET-BYPASS-IND.      11580000
115900     MOVE AP363-OFFSET-DOC-NBR     TO ASC-OFFSET-DOC-NBR.         11590000
116000     MOVE AP363-OFFSET-BTCH-SRC-CDE                               11600000
116100                                   TO ASC-OFFSET-BTCH-SRC-CDE.    11610000
116200     MOVE AP363-OFFSET-ADJ-FOUND-SW                               11620000
116300                                   TO ASC-OFFSET-ADJ-FOUND-SW.    11630000
116400     MOVE AP363-OFFSET-PSTG-TYP-CDE                               11640000
116500                                   TO ASC-OFFSET-PSTG-TYP-CDE.    11650000
116600                                                                  11660000
116700     COMPUTE PV-DISC-AMT =                                        11670000
116800             (ASC-TERM-DISC-AMT +                                 11680000
116900              ASC-NW-STR-DISC-AMT +                               11690000
117000              ASC-TRD-DISC-AMT +                                  11700000
117100              ASC-MOS-DISC-AMT).                                  11710000
117200                                                                  11720000
117300     IF PV-DISC-AMT GREATER THAN ZERO                             11730000
117400        COMPUTE ASC-TOTAL-DISC-AMT =                              11740000
117500               (ASC-TERM-DISC-AMT +                               11750000
117600                ASC-NW-STR-DISC-AMT +                             11760000
117700                ASC-TRD-DISC-AMT +                                11770000
117800                ASC-MOS-DISC-AMT) + .005                          11780000
117900     ELSE                                                         11790000
118000        IF PV-DISC-AMT LESS THAN ZERO                             11800000
118100           COMPUTE ASC-TOTAL-DISC-AMT =                           11810000
118200                  (ASC-TERM-DISC-AMT +                            11820000
118300                   ASC-NW-STR-DISC-AMT +                          11830000
118400                   ASC-TRD-DISC-AMT +                             11840000
118500                   ASC-MOS-DISC-AMT) - .005                       11850000
118600        ELSE                                                      11860000
118700           MOVE ZERO TO ASC-TOTAL-DISC-AMT                        11870000
118800        END-IF                                                    11880000
118900     END-IF.                                                      11890000
119000 EJECT                                                            11900000
119100******************************************************************11910000
119200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11920000
119300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11930000
119400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11940000
119500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11950000
119600* FUNCTION KEYS CAN GET THIS FAR.                                *11960000
119700******************************************************************11970000
119800 2000-PROCESS-PANEL.                                              11980000
119900                                                                  11990000
120000     EVALUATE TRUE                                                12000000
120100         WHEN DP020-SRC-AID = DP016-CLEAR                         12010000
120200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12020000
120300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12030000
120400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12040000
120500                                                                  12050000
120600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12060000
120700            SET ASC-NO-STORES-IN-PER TO TRUE                      12070000
120800            MOVE +1 TO PV-SEL-QUEUE-ITEM                          12080000
120900            IF ASC-ACTION-SW = 'ADD'                              12090000
121000               MOVE DP015-HL-OFF   TO ASTRTITH                    12100000
121100               MOVE DP015-PRO-DRK-MDT                             12110000
121200                                   TO LABELA                      12120000
121300                                      LABEL2A                     12130000
121400                                      LABEL3A                     12140000
121500                                      LABEL4A                     12150000
121600                                      ASTRTITA                    12160000
121700               MOVE DP015-PRO-DRK-MDT                             12170000
121800                                   TO ATOTITA                     12180000
121900                                      AENDITA                     12190000
122000                                      AENDITA                     12200000
122100               PERFORM                                            12210000
122200                   VARYING PV-SUB                                 12220000
122300                   FROM 1 BY 1                                    12230000
122400                   UNTIL PV-SUB > PC-ITEMS-PER-PANEL              12240000
122500                   MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)  12250000
122600                   MOVE DP015-HL-OFF TO MR-SELECTH (PV-SUB)       12260000
122700               END-PERFORM                                        12270000
122800             END-IF                                               12280000
122900             IF ASC-ACTION-SW = 'DEL'                             12290000
123000                SET ASC-DELETE-REQUESTED TO TRUE                  12300000
123100             ELSE                                                 12310000
123200                SET ASC-NO-DELETE TO TRUE                         12320000
123300             END-IF                                               12330000
123400             PERFORM 2050-DELETE-LIST-QUEUE                       12340000
123500             PERFORM 4000-BUILD-INITIAL-PANEL                     12350000
123600                                                                  12360000
123700         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12370000
123800             PERFORM 2140-DESELECT-ALL-ITEMS                      12380000
123900             PERFORM 3200-RESET-ATTRIBUTES                        12390000
124000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12400000
124100                                                                  12410000
124200         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  12420000
124300             PERFORM 2150-SELECT-ALL-ITEMS                        12430000
124400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12440000
124500                                                                  12450000
124600         WHEN OTHER                                               12460000
124700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12470000
124800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12480000
124900             IF  PS-NO-ERROR                                      12490000
125000                 SET DP030-CONTINUE-GO                            12500000
125100                                 TO TRUE                          12510000
125200                 PERFORM 2100-CHECK-FUNCTION-KEY                  12520000
125300             ELSE                                                 12530000
125400                 SET DP030-OVERRIDE-GO                            12540000
125500                                 TO TRUE                          12550000
125600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12560000
125700             END-IF                                               12570000
125800     END-EVALUATE.                                                12580000
125900 EJECT                                                            12590000
126000******************************************************************12600000
126100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12610000
126200******************************************************************12620000
126300 2050-DELETE-LIST-QUEUE.                                          12630000
126400                                                                  12640000
126500     EXEC CICS                                                    12650000
126600         DELETEQ TS                                               12660000
126700             QUEUE (ASC-LIST-QUEUE-NAME)                          12670000
126800             RESP  (PV-CICS-RESP)                                 12680000
126900     END-EXEC.                                                    12690000
127000                                                                  12700000
127100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12710000
127200        (PV-CICS-RESP = DFHRESP(QIDERR))                          12720000
127300         CONTINUE                                                 12730000
127400     ELSE                                                         12740000
127500         SET DP013-CICS-ABEND      TO TRUE                        12750000
127600         SET DP013-NO-ROLLBACK     TO TRUE                        12760000
127700                                                                  12770000
127800         MOVE '2050-DELETE-LIST-QUEUE'                            12780000
127900                                   TO DP013-PARAGRAPH             12790000
128000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12800000
128100                                   TO DP013-MESSAGE-TEXT (1)      12810000
128200         PERFORM DP013-0000-PROCESS-ABEND                         12820000
128300     END-IF.                                                      12830000
128400                                                                  12840000
128500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12850000
128600 EJECT                                                            12860000
128700******************************************************************12870000
128800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12880000
128900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12890000
129000* CICS ARCHITECTURE API.                                         *12900000
129100******************************************************************12910000
129200 2100-CHECK-FUNCTION-KEY.                                         12920000
129300                                                                  12930000
129400     EVALUATE TRUE                                                12940000
129500         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               12950000
129600             IF PS-NO-ERROR                                       12960000
129700                 PERFORM 2105-WRITE-TSQ                           12970000
129800                 PERFORM 2106-GROSS-RETAIL-SUMMATION              12980000
129900                 IF PS-NO-ERROR                                   12990000
130000                    PERFORM 6500-FORMAT-HEADER-DCLGEN             13000000
130100                    PERFORM 7100-INSERT-ADJUSTMENT-HEADER         13010000
130200                    PERFORM 7150-INSERT-TAJPSINT                  13020000
130300** PERFORM TADJDIS INSERTS                                        13030000
130400                    PERFORM 4100-TRAVERSE-TSQ-INSERT              13040000
130500                    IF ASC-OFFSET-BYPASS-IND = 'N'                13050000
130600                       PERFORM 6501-FORMAT-OFFSET-HEADER          13060000
130700                       PERFORM 7100-INSERT-ADJUSTMENT-HEADER      13070000
130800                       PERFORM 7150-INSERT-TAJPSINT               13080000
130900                       PERFORM 6602-FORMAT-OFFSET-SINGLE-DIST     13090000
131000                       MOVE +1 TO ADJDIS-DISTRB-SEQ-NBR           13100000
131100                       PERFORM 8100-ADJUSTMENT-DISTRO-ADD         13110000
131200                       MOVE PC-TSYMSG-03427                       13120000
131300                                      TO DP020-MSG-NUMBER         13130000
131400                    ELSE                                          13140000
131500                       MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER   13150000
131600                    END-IF                                        13160000
131700                    SET DP030-CONTINUE-GO TO TRUE                 13170000
131800*                   MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER      13180000
131900                    SET DP020-MSG-INFORMATIONAL TO TRUE           13190000
132000                    SET DP030-ERASE-UNPROT TO TRUE                13200000
132100                 END-IF                                           13210000
132200             END-IF                                               13220000
132300                                                                  13230000
132400         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               13240000
132500                IF PS-NO-ERROR                                    13250000
132600                    PERFORM 2105-WRITE-TSQ                        13260000
132700                    PERFORM 2106-GROSS-RETAIL-SUMMATION           13270000
132800                    IF PS-NO-ERROR                                13280000
132900                       PERFORM 6500-FORMAT-HEADER-DCLGEN          13290000
133000                       PERFORM 7200-UPDATE-TADJRNL                13300000
133100                       PERFORM 7250-UPDATE-TAJPSINT               13310000
133200** PERFORM TADJDIS UPDATES                                        13320000
133300                       PERFORM 4110-TRAVERSE-TSQ-UPDATE           13330000
133400                       IF ASC-OFFSET-ADJ-FOUND                    13340000
133500                          PERFORM 6501-FORMAT-OFFSET-HEADER       13350000
133600                          PERFORM 7200-UPDATE-TADJRNL             13360000
133700                          PERFORM 7250-UPDATE-TAJPSINT            13370000
133800                          PERFORM 6602-FORMAT-OFFSET-SINGLE-DIST  13380000
133900                          PERFORM 8200-ADJUSTMENT-DISTRO-UPDATE   13390000
134000                       END-IF                                     13400000
134100                       SET DP030-CONTINUE-GO TO TRUE              13410000
134200                       MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER   13420000
134300                       SET DP020-MSG-INFORMATIONAL TO TRUE        13430000
134400                    END-IF                                        13440000
134500                END-IF                                            13450000
134600                                                                  13460000
134700         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               13470000
134800             IF ASC-NUMBER-OF-DELETED-ITEMS > ZERO                13480000
134900                PERFORM 2105-WRITE-TSQ                            13490000
135000                PERFORM 2106-GROSS-RETAIL-SUMMATION               13500000
135100                IF PS-NO-ERROR                                    13510000
135200                   IF ASC-DELETE-REQUESTED                        13520000
135300                      SET ASC-DELETE-PENDING TO TRUE              13530000
135400                      MOVE PC-TSYMSG-00354 TO DP020-MSG-NUMBER    13540000
135500                      SET DP020-MSG-INFORMATIONAL TO TRUE         13550000
135600                   END-IF                                         13560000
135700                END-IF                                            13570000
135800             ELSE                                                 13580000
135900                SET DP030-OVERRIDE-GO TO TRUE                     13590000
136000                MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER          13600000
136100                SET DP020-MSG-WARNING TO TRUE                     13610000
136200             END-IF                                               13620000
136300                                                                  13630000
136400         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    13640000
136500             IF PS-NO-ERROR                                       13650000
136600                 PERFORM 2105-WRITE-TSQ                           13660000
136700                 PERFORM 2106-GROSS-RETAIL-SUMMATION              13670000
136800                 IF PS-NO-ERROR                                   13680000
136900                 EVALUATE TRUE                                    13690000
137000                    WHEN ASC-DELETE-PENDING                       13700000
137100** PERFORM TADJDIS DELETES                                        13710000
137200                          PERFORM 6500-FORMAT-HEADER-DCLGEN       13720000
137300                          PERFORM 7210-UPDATE-DOLLARS-TADJRNL     13730000
137400                          PERFORM 4110-TRAVERSE-TSQ-UPDATE        13740000
137500                          IF ASC-OFFSET-ADJ-FOUND                 13750000
137600                             PERFORM 6501-FORMAT-OFFSET-HEADER    13760000
137700                             PERFORM 7210-UPDATE-DOLLARS-TADJRNL  13770000
137800                             PERFORM                              13780000
137900                                  6602-FORMAT-OFFSET-SINGLE-DIST  13790000
138000                             PERFORM                              13800000
138100                                  8210-OFFSET-ADJUST-DISTRO-UPDT  13810000
138200                          END-IF                                  13820000
138300                          MOVE PC-TSYMSG-00115 TO DP020-MSG-NUMBER13830000
138400                          SET DP020-MSG-INFORMATIONAL TO TRUE     13840000
138500                          SET ASC-DELETE-REQUESTED TO TRUE        13850000
138600                          PERFORM 2050-DELETE-LIST-QUEUE          13860000
138700                          PERFORM 4001-BUILD-DELETE-FIRST-PANEL   13870000
138800                          SET DP030-CONTINUE-GO TO TRUE           13880000
138900                                                                  13890000
139000                    WHEN ASC-DELETE-REQUESTED                     13900000
139100                       MOVE PC-TSYMSG-00118 TO DP020-MSG-NUMBER   13910000
139200                       SET DP020-MSG-FATAL TO TRUE                13920000
139300                 END-EVALUATE                                     13930000
139400                 END-IF                                           13940000
139500             END-IF                                               13950000
139600                                                                  13960000
139700         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  13970000
139800             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13980000
139900                 INITIALIZE AP361-INTER-APPL-COMMAREA             13990000
140000                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14000000
140100                                TO AP361-NUMBER-OF-SELECTED-ITEMS 14010000
140200             ELSE                                                 14020000
140300                 SET DP030-OVERRIDE-GO                            14030000
140400                                   TO TRUE                        14040000
140500                 MOVE PC-TSYMSG-00057                             14050000
140600                                   TO DP020-MSG-NUMBER            14060000
140700                 SET DP020-MSG-WARNING                            14070000
140800                                   TO TRUE                        14080000
140900             END-IF                                               14090000
141000                                                                  14100000
141100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14110000
141200             MOVE +1               TO PV-TOP-ITEM                 14120000
141300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14130000
141400                                                                  14140000
141500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14150000
141600             PERFORM 2110-BROWSE-BACKWARD                         14160000
141700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14170000
141800                                                                  14180000
141900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14190000
142000*TEST                                                             14200000
142100             PERFORM 2105-WRITE-TSQ                               14210000
142200             PERFORM 3303-CHECK-FOR-DUPS                          14220000
142300*TEST                                                             14230000
142400             IF PS-ERROR                                          14240000
142500                CONTINUE                                          14250000
142600             ELSE                                                 14260000
142700                PERFORM 2120-BROWSE-FORWARD                       14270000
142800                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14280000
142900             END-IF                                               14290000
143000                                                                  14300000
143100         WHEN DP020-SRC-AID = DP016-ENTER                         14310000
143200             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   14320000
143300             IF  PS-ERROR                                         14330000
143400                 CONTINUE                                         14340000
143500             ELSE                                                 14350000
143600                 PERFORM 2105-WRITE-TSQ                           14360000
143700                 PERFORM 2106-GROSS-RETAIL-SUMMATION              14370000
143800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14380000
143900             END-IF                                               14390000
144000                                                                  14400000
144100         WHEN OTHER                                               14410000
144200             SET DP013-NO-ROLLBACK                                14420000
144300                 DP013-XCTL-DISPLAY-RESTART                       14430000
144400                 DP013-CICS-ABEND  TO TRUE                        14440000
144500             MOVE '2100-CHECK-FUNCTION-KEY'                       14450000
144600                                   TO DP013-PARAGRAPH             14460000
144700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      14470000
144800                                   TO DP013-MESSAGE-TEXT (1)      14480000
144900             PERFORM DP013-0000-PROCESS-ABEND                     14490000
145000     END-EVALUATE.                                                14500000
145100                                                                  14510000
145200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14520000
145300                                                                  14530000
145400******************************************************************14540000
145500*    THIS PARAGRAPH WILL WRITE NEWLY ENTERED LINES OF            *14550000
145600*    DISTRIBUTION TO THE TEMPORARY STORAGE QUEUE.                *14560000
145700******************************************************************14570000
145800 2105-WRITE-TSQ.                                                  14580000
145900                                                                  14590000
146000     MOVE +1                    TO ASC-BLK-SUB.                   14600000
146100                                                                  14610000
146200     PERFORM 5100-WRITE-TEMP-STORAGE.                             14620000
146300                                                                  14630000
146400     ADD +1                     TO ASC-BLK-SUB.                   14640000
146500                                                                  14650000
146600     PERFORM 5100-WRITE-TEMP-STORAGE.                             14660000
146700                                                                  14670000
146800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14680000
146900                                TO PV-LIST-ITEM-NUMBER.           14690000
147000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14700000
147100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14710000
147200                                                                  14720000
147300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14730000
147400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14740000
147500         MOVE +1                   TO PV-BLOCK-NUMBER             14750000
147600                                                                  14760000
147700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14770000
147800             PV-FIRST-BLOCK-IN-ARRAY - 1                          14780000
147900                                                                  14790000
148000         PERFORM                                                  14800000
148100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14810000
148200                                                                  14820000
148300             PERFORM 4410-READ-TEMP-STORAGE                       14830000
148400             PERFORM 5100-WRITE-TEMP-STORAGE                      14840000
148500                                                                  14850000
148600             ADD +1                TO PV-BLOCK-NUMBER             14860000
148700                                                                  14870000
148800         END-PERFORM                                              14880000
148900                                                                  14890000
149000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14900000
149100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14910000
149200         PERFORM                                                  14920000
149300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14930000
149400                   ASC-HIGHEST-BLOCK-WRITTEN                      14940000
149500                                                                  14950000
149600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14960000
149700                                   TO PV-BLOCK-NUMBER             14970000
149800                                                                  14980000
149900             PERFORM 4410-READ-TEMP-STORAGE                       14990000
150000                                                                  15000000
150100             PERFORM 5100-WRITE-TEMP-STORAGE                      15010000
150200                                                                  15020000
150300             ADD +1            TO PV-NEXT-BLOCK-IN-ARRAY          15030000
150400                                                                  15040000
150500         END-PERFORM                                              15050000
150600                                                                  15060000
150700         MOVE +1                   TO ASC-BLK-SUB                 15070000
150800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15080000
150900                                   TO PV-BLOCK-NUMBER             15090000
151000                                                                  15100000
151100         PERFORM 4410-READ-TEMP-STORAGE                           15110000
151200                                                                  15120000
151300         ADD +1                    TO PV-BLOCK-NUMBER             15130000
151400                                      ASC-BLK-SUB                 15140000
151500         PERFORM 4410-READ-TEMP-STORAGE                           15150000
151600     END-IF.                                                      15160000
151700                                                                  15170000
151800******************************************************************15180000
151900* THIS PARAGRAPH WILL SUM ALL OF THE GROSS COSTS AND RETAIL      *15190000
152000* AMOUNTS FROM THE DISTRIBUTION PORTION OF THE SCREEN TO VERIFY  *15200000
152100* THAT THEY MATCH THE HEADER GROSS COST AND RETAIL AMOUNTS.      *15210000
152200* ALL LINES ARE INCLUDED IN THIS SUMMATION *EXCEPT* LINES THAT   *15220000
152300* ARE MARKED FOR DELETION - SELECT CODE OF 'D'.                  *15230000
152400******************************************************************15240000
152500 2106-GROSS-RETAIL-SUMMATION.                                     15250000
152600                                                                  15260000
152700     INITIALIZE ASC-NO-OF-DIS-ITEMS                               15270000
152800                ASC-TOTAL-GROSS-COST                              15280000
152900                ASC-TOTAL-RETAIL-AMT.                             15290000
153000                                                                  15300000
153100     MOVE +1         TO PV-DUP-COUNT                              15310000
153200                        PV-SUB.                                   15320000
153300     MOVE LOW-VALUES TO PV-CLASS-TABLE.                           15330000
153400                                                                  15340000
153500     PERFORM 2107-SUM-ALL-GROSS-RETAIL.                           15350000
153600                                                                  15360000
153700     IF ASC-FREIGHT-COST-ALLOCATION                               15370000
153800        IF ASC-TOTAL-GROSS-COST NOT EQUAL ASC-HD-FRGT-AMT         15380000
153900           SET DP030-OVERRIDE-GO       TO TRUE                    15390000
154000           SET DP020-MSG-FATAL         TO TRUE                    15400000
154100           MOVE DP015-UNP-ALP-BRT-OFF  TO AHDFRGTA                15410000
154200           MOVE DP015-RED              TO AHDFRGTC                15420000
154300           MOVE DP015-REVERSE          TO AHDFRGTH                15430000
154400           INITIALIZE PV-DIS-DOL-DIFF                             15440000
154500           COMPUTE PV-DIS-DOL-DIFF =                              15450000
154600                   ASC-HD-FRGT-AMT - ASC-TOTAL-GROSS-COST         15460000
154700           MOVE PV-DIS-DOL-DIFF TO PV-FORMAT-DOL-DIFF             15470000
154800           IF PS-NO-ERROR                                         15480000
154900              MOVE -1                  TO AHDFRGTL                15490000
155000              MOVE PC-TSYMSG-01931     TO DP020-MSG-NUMBER        15500000
155100              MOVE PV-FORMAT-DOL-DIFF  TO DP020-MSG-TEXT          15510000
155200           END-IF                                                 15520000
155300           SET PS-ERROR                TO TRUE                    15530000
155400        END-IF                                                    15540000
155500     ELSE                                                         15550000
155600        IF ASC-NEW-STR-COST-ALLOCATION                            15560000
155700           IF ASC-TOTAL-GROSS-COST NOT EQUAL ASC-HD-NEW-STR-AMT   15570000
155800              SET DP030-OVERRIDE-GO       TO TRUE                 15580000
155900              SET DP020-MSG-FATAL         TO TRUE                 15590000
156000              MOVE DP015-UNP-ALP-BRT-OFF  TO AHDNWSTA             15600000
156100              MOVE DP015-RED              TO AHDNWSTC             15610000
156200              MOVE DP015-REVERSE          TO AHDNWSTH             15620000
156300              INITIALIZE PV-DIS-DOL-DIFF                          15630000
156400              COMPUTE PV-DIS-DOL-DIFF =                           15640000
156500                      ASC-HD-GRO-COST - ASC-TOTAL-GROSS-COST      15650000
156600              MOVE PV-DIS-DOL-DIFF TO PV-FORMAT-DOL-DIFF          15660000
156700              IF PS-NO-ERROR                                      15670000
156800                 MOVE -1                  TO AHDNWSTL             15680000
156900                 MOVE +0                  TO AHDFRGTL             15690000
157000                 MOVE PC-TSYMSG-01931     TO DP020-MSG-NUMBER     15700000
157100                 MOVE PV-FORMAT-DOL-DIFF  TO DP020-MSG-TEXT       15710000
157200              END-IF                                              15720000
157300              SET PS-ERROR TO TRUE                                15730000
157400           END-IF                                                 15740000
157500        ELSE                                                      15750000
157600           IF ASC-TOTAL-GROSS-COST NOT EQUAL ASC-HD-GRO-COST      15760000
157700              SET DP030-OVERRIDE-GO       TO TRUE                 15770000
157800              SET DP020-MSG-FATAL         TO TRUE                 15780000
157900              MOVE DP015-UNP-ALP-BRT-OFF  TO AHDCSTA              15790000
158000              MOVE DP015-RED              TO AHDCSTC              15800000
158100              MOVE DP015-REVERSE          TO AHDCSTH              15810000
158200              INITIALIZE PV-DIS-DOL-DIFF                          15820000
158300              COMPUTE PV-DIS-DOL-DIFF =                           15830000
158400                      ASC-HD-GRO-COST - ASC-TOTAL-GROSS-COST      15840000
158500              MOVE PV-DIS-DOL-DIFF TO PV-FORMAT-DOL-DIFF          15850000
158600              IF PS-NO-ERROR                                      15860000
158700                 MOVE -1                  TO AHDCSTL              15870000
158800                 MOVE +0                  TO AHDFRGTL             15880000
158900                 MOVE PC-TSYMSG-01931     TO DP020-MSG-NUMBER     15890000
159000                 MOVE PV-FORMAT-DOL-DIFF  TO DP020-MSG-TEXT       15900000
159100              END-IF                                              15910000
159200              SET PS-ERROR TO TRUE                                15920000
159300           END-IF                                                 15930000
159400        END-IF                                                    15940000
159500     END-IF.                                                      15950000
159600                                                                  15960000
159700     IF ASC-TOTAL-RETAIL-AMT NOT EQUAL ASC-HD-RET-AMT             15970000
159800        IF ASC-SAVE-BLK-SUB NOT EQUAL ZERO AND                    15980000
159900           ASC-SAVE-ITEM-SUB NOT EQUAL ZERO                       15990000
160000           INITIALIZE PV-DIS-RET-DIFF                             16000000
160100                      PV-DET-RETAIL                               16010000
160200        ELSE                                                      16020000
160300           SET DP030-OVERRIDE-GO       TO TRUE                    16030000
160400           SET DP020-MSG-FATAL         TO TRUE                    16040000
160500           MOVE DP015-UNP-ALP-BRT-OFF  TO AHDRETA                 16050000
160600           MOVE DP015-RED              TO AHDRETC                 16060000
160700           MOVE DP015-REVERSE          TO AHDRETH                 16070000
160800           INITIALIZE PV-DIS-DOL-DIFF                             16080000
160900           COMPUTE PV-DIS-DOL-DIFF =                              16090000
161000                   ASC-HD-RET-AMT - ASC-TOTAL-RETAIL-AMT          16100000
161100           MOVE PV-DIS-DOL-DIFF TO PV-FORMAT-DOL-DIFF             16110000
161200           IF PS-NO-ERROR                                         16120000
161300              MOVE -1                  TO AHDRETL                 16130000
161400              MOVE +0                  TO AHDFRGTL                16140000
161500              MOVE PC-TSYMSG-01930     TO DP020-MSG-NUMBER        16150000
161600              MOVE PV-FORMAT-DOL-DIFF  TO DP020-MSG-TEXT          16160000
161700           END-IF                                                 16170000
161800           SET PS-ERROR TO TRUE                                   16180000
161900        END-IF                                                    16190000
162000     END-IF.                                                      16200000
162100                                                                  16210000
162200     IF PS-NO-ERROR                                               16220000
162300        PERFORM 4200-RECALCULATE-ADJ-DOLLARS                      16230000
162400        INITIALIZE PV-DIS-CNTR                                    16240000
162500                   PV-TOT-DISTRO-FRGT-AMT                         16250000
162600                   PV-TOT-DISTRO-MISC-CHRG                        16260000
162700                   PV-TOT-DISTRO-DISC-AMT                         16270000
162800                   PV-TOT-DISTRO-NET-COST                         16280000
162900        PERFORM 2109-CALCULATE-DISTRO-NETS                        16290000
163000        PERFORM 2105-WRITE-TSQ                                    16300000
163100     END-IF.                                                      16310000
163200                                                                  16320000
163300******************************************************************16330000
163400* THIS PARAGRAPH WILL TRAVERSE THE DISTRIBUTION GROSS COSTS AND  *16340000
163500* RETAIL AMOUNTS TO SUM EACH SEPARATELY.                         *16350000
163600******************************************************************16360000
163700 2107-SUM-ALL-GROSS-RETAIL.                                       16370000
163800                                                                  16380000
163900     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              16390000
164000                                 TO PV-LIST-ITEM-NUMBER.          16400000
164100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16410000
164200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16420000
164300                                                                  16430000
164400     MOVE +1                     TO ASC-BLK-SUB.                  16440000
164500                                                                  16450000
164600     PERFORM                                                      16460000
164700         VARYING PV-BLOCK-NUMBER                                  16470000
164800         FROM 1 BY 1                                              16480000
164900         UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN        16490000
165000                                                                  16500000
165100         PERFORM 4410-READ-TEMP-STORAGE                           16510000
165200                                                                  16520000
165300         PERFORM                                                  16530000
165400             VARYING ASC-ITEM-SUB                                 16540000
165500             FROM 1 BY 1                                          16550000
165600             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              16560000
165700                                                                  16570000
165800             IF NOT ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB) AND     16580000
165900               (ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES 16590000
166000                OR                                                16600000
166100                ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR  16610000
166200                ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO OR      16620000
166300                ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB)         16630000
166400                                            NOT EQUAL ZERO OR     16640000
166500                ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)         16650000
166600                                            NOT EQUAL ZERO)       16660000
166700                INITIALIZE PV-TEMP-DOLLAR-FIELD-9                 16670000
166800                ADD  ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB)    16680000
166900                    TO ASC-TOTAL-GROSS-COST                       16690000
167000                INITIALIZE PV-TEMP-DOLLAR-FIELD-9                 16700000
167100                ADD ASC-RETAIL-AMT  (ASC-BLK-SUB ASC-ITEM-SUB)    16710000
167200                    TO ASC-TOTAL-RETAIL-AMT                       16720000
167300                ADD +1 TO ASC-NO-OF-DIS-ITEMS                     16730000
167400             END-IF                                               16740000
167500             IF (ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES16750000
167600                OR                                                16760000
167700                ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR  16770000
167800                ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO)        16780000
167900                IF PV-DUP-COUNT > 1                               16790000
168000                   IF PV-SUB = +12                                16800000
168100                      MOVE +1 TO PV-SUB                           16810000
168200                   END-IF                                         16820000
168300                   PERFORM 4250-CHECK-FOR-DUP-STR-CLS-SEQ         16830000
168400                END-IF                                            16840000
168500                MOVE ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) TO  16850000
168600                                   PV-STORE-ENTRY (PV-DUP-COUNT)  16860000
168700                MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) TO      16870000
168800                                   PV-CLASS-ENTRY (PV-DUP-COUNT)  16880000
168900                MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) TO        16890000
169000                                   PV-SKU-ENTRY (PV-DUP-COUNT)    16900000
169100                ADD +1 TO PV-DUP-COUNT                            16910000
169200                          PV-SUB                                  16920000
169300             END-IF                                               16930000
169400         END-PERFORM                                              16940000
169500                                                                  16950000
169600     END-PERFORM.                                                 16960000
169700                                                                  16970000
169800     MOVE +1                        TO ASC-BLK-SUB.               16980000
169900     MOVE PV-FIRST-BLOCK-IN-ARRAY   TO PV-BLOCK-NUMBER.           16990000
170000                                                                  17000000
170100     PERFORM 4410-READ-TEMP-STORAGE.                              17010000
170200                                                                  17020000
170300     ADD +1                         TO PV-BLOCK-NUMBER            17030000
170400                                       ASC-BLK-SUB.               17040000
170500     PERFORM 4410-READ-TEMP-STORAGE.                              17050000
170600                                                                  17060000
170700******************************************************************17070000
170800* THIS PARAGRAPH WILL HANDLE THE EVEN ALLOCATION OF THE          *17080000
170900* DISTRIBUTION DOLLARS TO THE ADJUSTMENT DISTRO LINES.           *17090000
171000******************************************************************17100000
171100 2108-ALLOCATE-DISTRO-DOLLARS.                                    17110000
171200                                                                  17120000
171300     IF ASC-PSTG-TYP-CDE = 'CH'                                   17130000
171400        MOVE +.005 TO PV-ROUNDING-FACTOR                          17140000
171500     ELSE                                                         17150000
171600        MOVE -.005 TO PV-ROUNDING-FACTOR                          17160000
171700     END-IF.                                                      17170000
171800                                                                  17180000
171900     IF NOT ASC-FREIGHT-COST-ALLOCATION                           17190000
172000        IF ASC-HD-FRGT-AMT NOT EQUAL ZERO                         17200000
172100           COMPUTE PV-DISTRO-FRGT-AMT =                           17210000
172200                   (ASC-HD-FRGT-AMT / ASC-NO-OF-DIS-ITEMS)        17220000
172300                   + PV-ROUNDING-FACTOR                           17230000
172400        ELSE                                                      17240000
172500           MOVE ZERO TO PV-DISTRO-FRGT-AMT                        17250000
172600        END-IF                                                    17260000
172700     ELSE                                                         17270000
172800        MOVE ZERO TO PV-DISTRO-FRGT-AMT                           17280000
172900     END-IF.                                                      17290000
173000                                                                  17300000
173100     IF ASC-MISC-CHRG-AMT NOT EQUAL ZERO                          17310000
173200        COMPUTE PV-DISTRO-MISC-CHRG =                             17320000
173300                (ASC-MISC-CHRG-AMT / ASC-NO-OF-DIS-ITEMS)         17330000
173400                + PV-ROUNDING-FACTOR                              17340000
173500     ELSE                                                         17350000
173600        MOVE ZERO TO PV-DISTRO-MISC-CHRG                          17360000
173700     END-IF.                                                      17370000
173800                                                                  17380000
173900     IF NOT ASC-NEW-STR-COST-ALLOCATION                           17390000
174000        IF ASC-TOTAL-DISC-AMT NOT EQUAL ZERO                      17400000
174100           COMPUTE PV-DISTRO-DISC-AMT =                           17410000
174200                   (ASC-TOTAL-DISC-AMT / ASC-NO-OF-DIS-ITEMS)     17420000
174300                   + PV-ROUNDING-FACTOR                           17430000
174400        ELSE                                                      17440000
174500           MOVE ZERO TO PV-DISTRO-DISC-AMT                        17450000
174600        END-IF                                                    17460000
174700     END-IF.                                                      17470000
174800                                                                  17480000
174900******************************************************************17490000
175000* THIS PARAGRAPH WILL CALCULATE THE INDIVIDUAL DISTRIBUTION NET  *17500000
175100* NET COST AMOUNT FOR EACH DISTRIBUTION LINE.                    *17510000
175200******************************************************************17520000
175300 2109-CALCULATE-DISTRO-NETS.                                      17530000
175400                                                                  17540000
175500     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              17550000
175600                                 TO PV-LIST-ITEM-NUMBER.          17560000
175700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17570000
175800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17580000
175900                                                                  17590000
176000     MOVE +1                     TO ASC-BLK-SUB.                  17600000
176100                                                                  17610000
176200     PERFORM                                                      17620000
176300         VARYING PV-BLOCK-NUMBER                                  17630000
176400         FROM 1 BY 1                                              17640000
176500         UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN        17650000
176600                                                                  17660000
176700         PERFORM 4410-READ-TEMP-STORAGE                           17670000
176800                                                                  17680000
176900         PERFORM                                                  17690000
177000             VARYING ASC-ITEM-SUB                                 17700000
177100             FROM 1 BY 1                                          17710000
177200             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              17720000
177300                                                                  17730000
177400             IF ((ASC-ACTION-SW = 'ADD' AND                       17740000
177500               (ASC-CLASS  (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR 17750000
177600                ASC-SKU    (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO   OR 17760000
177700                ASC-GROSS-COST(ASC-BLK-SUB ASC-ITEM-SUB)          17770000
177800                                               NOT EQUAL ZERO  OR 17780000
177900                ASC-RETAIL-AMT(ASC-BLK-SUB ASC-ITEM-SUB)          17790000
178000                              NOT EQUAL ZERO) OR                  17800000
178100                ASC-ACTION-SW = 'UPD' OR                          17810000
178200                ASC-ACTION-SW = 'DEL') AND                        17820000
178300                NOT ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB))        17830000
178400                ADD +1 TO PV-DIS-CNTR                             17840000
178500                PERFORM 4210-ALLOCATE-DOLLARS                     17850000
178600                INITIALIZE PV-TEMP-GROSS                          17860000
178700                           PV-NET-COST                            17870000
178800                           PV-ROUNDING-FACTOR                     17880000
178900                IF  ASC-NEW-STR-COST-ALLOCATION                   17890000
179000                    CONTINUE                                      17900000
179100                ELSE                                              17910000
179200                    MOVE ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB)17920000
179300                                     TO PV-TEMP-GROSS             17930000
179400                END-IF                                            17940000
179500                INITIALIZE PV-NET-COST                            17950000
179600                COMPUTE PV-NET-COST =                             17960000
179700                        (PV-TEMP-GROSS + PV-DISTRO-FRGT-AMT +     17970000
179800                         PV-DISTRO-MISC-CHRG - PV-DISTRO-DISC-AMT)17980000
179900                IF PV-NET-COST GREATER THAN ZERO                  17990000
180000                   MOVE +.005 TO PV-ROUNDING-FACTOR               18000000
180100                ELSE                                              18010000
180200                   IF PV-NET-COST LESS THAN ZERO                  18020000
180300                      MOVE -.005 TO PV-ROUNDING-FACTOR            18030000
180400                   ELSE                                           18040000
180500                      MOVE ZERO TO PV-ROUNDING-FACTOR             18050000
180600                   END-IF                                         18060000
180700                END-IF                                            18070000
180800                COMPUTE PV-NET-COST =                             18080000
180900                        (PV-TEMP-GROSS + PV-DISTRO-FRGT-AMT +     18090000
181000                         PV-DISTRO-MISC-CHRG - PV-DISTRO-DISC-AMT)18100000
181100                         + PV-ROUNDING-FACTOR                     18110000
181200                ADD PV-NET-COST TO PV-TOT-DISTRO-NET-COST         18120000
181300                IF PV-DIS-CNTR = ASC-NO-OF-DIS-ITEMS              18130000
181400                   INITIALIZE PV-DIS-DOL-DIFF                     18140000
181500                   COMPUTE PV-DIS-DOL-DIFF =                      18150000
181600                           ASC-NET-COST-AMT -                     18160000
181700                                           PV-TOT-DISTRO-NET-COST 18170000
181800                   ADD PV-DIS-DOL-DIFF TO PV-NET-COST             18180000
181900                END-IF                                            18190000
182000                MOVE PV-NET-COST TO ASC-NET-COST                  18200000
182100                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18210000
182200                IF ASC-FREIGHT-COST-ALLOCATION                    18220000
182300                   MOVE ASC-GROSS-COST                            18230000
182400                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18240000
182500                                           TO ASC-DT-FRGT-AMT     18250000
182600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18260000
182700                ELSE                                              18270000
182800                   MOVE PV-DISTRO-FRGT-AMT TO ASC-DT-FRGT-AMT     18280000
182900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18290000
183000                END-IF                                            18300000
183100                IF ASC-NEW-STR-COST-ALLOCATION                    18310000
183200                   MOVE ASC-GROSS-COST                            18320000
183300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    18330000
183400                                           TO ASC-DISC-AMT        18340000
183500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18350000
183600                ELSE                                              18360000
183700                   MOVE PV-DISTRO-DISC-AMT TO ASC-DISC-AMT        18370000
183800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18380000
183900                END-IF                                            18390000
184000                MOVE PV-DISTRO-MISC-CHRG TO ASC-DT-MISC-CHRG-AMT  18400000
184100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18410000
184200                SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE       18420000
184300             END-IF                                               18430000
184400         END-PERFORM                                              18440000
184500         IF ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                       18450000
184600            PERFORM 5105-REWRITE-ASC-LISTQ                        18460000
184700         END-IF                                                   18470000
184800                                                                  18480000
184900     END-PERFORM.                                                 18490000
185000                                                                  18500000
185100     MOVE +1                        TO ASC-BLK-SUB.               18510000
185200     MOVE PV-FIRST-BLOCK-IN-ARRAY   TO PV-BLOCK-NUMBER.           18520000
185300                                                                  18530000
185400     PERFORM 4410-READ-TEMP-STORAGE.                              18540000
185500                                                                  18550000
185600     ADD +1                         TO PV-BLOCK-NUMBER            18560000
185700                                       ASC-BLK-SUB.               18570000
185800     PERFORM 4410-READ-TEMP-STORAGE.                              18580000
185900                                                                  18590000
186000******************************************************************18600000
186100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *18610000
186200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *18620000
186300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *18630000
186400*    MESSAGE.                                                    *18640000
186500******************************************************************18650000
186600 2110-BROWSE-BACKWARD.                                            18660000
186700                                                                  18670000
186800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    18680000
186900         GIVING PV-TOP-ITEM.                                      18690000
187000                                                                  18700000
187100     IF  ((PV-TOP-ITEM < +1)                                      18710000
187200       OR (PV-TOP-ITEM = +1))                                     18720000
187300         MOVE +1                   TO PV-TOP-ITEM                 18730000
187400*        -- TOP OF LIST --                                        18740000
187500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            18750000
187600         SET DP020-MSG-INFORMATIONAL TO TRUE                      18760000
187700     END-IF.                                                      18770000
187800                                                                  18780000
187900 EJECT                                                            18790000
188000*****************************************************************118800000
188100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *18810000
188200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *18820000
188300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *18830000
188400******************************************************************18840000
188500 2120-BROWSE-FORWARD.                                             18850000
188600                                                                  18860000
188700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              18870000
188800         GIVING PV-TOP-ITEM.                                      18880000
188900                                                                  18890000
189000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   18900000
189100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            18910000
189200                                   TO PV-TOP-ITEM                 18920000
189300*        -- BOTTOM OF LIST --                                     18930000
189400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            18940000
189500         SET DP020-MSG-INFORMATIONAL                              18950000
189600                                   TO TRUE                        18960000
189700     ELSE                                                         18970000
189800         COMPUTE PV-BOTTOM-ITEM =                                 18980000
189900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 18990000
190000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            19000000
190100*            -- BOTTOM OF LIST --                                 19010000
190200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            19020000
190300             SET DP020-MSG-INFORMATIONAL                          19030000
190400                                   TO TRUE                        19040000
190500         END-IF                                                   19050000
190600     END-IF.                                                      19060000
190700 EJECT                                                            19070000
190800******************************************************************19080000
190900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *19090000
191000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *19100000
191100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *19110000
191200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *19120000
191300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *19130000
191400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *19140000
191500******************************************************************19150000
191600 2130-CHECK-FOR-JUMP-BROWSE.                                      19160000
191700                                                                  19170000
191800     SET PS-NO-ERROR               TO TRUE.                       19180000
191900                                                                  19190000
192000     IF (ASC-START-ITEM-REQUEST = SPACE)                          19200000
192100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            19210000
192200                                   TO PV-TOP-ITEM                 19220000
192300     ELSE                                                         19230000
192400         MOVE ASC-START-ITEM-REQUEST                              19240000
192500                                   TO DP010I-UNEDITED-FIELD       19250000
192600         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       19260000
192700         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     19270000
192800         SET DP010I-NEGATIVE-NOT-ALLOWED                          19280000
192900                                   TO TRUE                        19290000
193010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19301001
193020                         USING DP010I-NUMERIC-EDIT-AREA           19302001
193100                                                                  19310000
193200         IF  NOT DP010I-ERROR-DETECTED                            19320000
193300             MOVE DP010I-NUMERIC-FIELD                            19330000
193400                                   TO  ASC-START-ITEM-REQUEST-N   19340000
193500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  19350000
193600                 IF  ASC-START-ITEM-REQUEST-N >                   19360000
193700                                          ASC-NUMBER-OF-ITEMS-READ19370000
193800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         19380000
193900                     COMPUTE PV-TOP-ITEM =                        19390000
194000                             ASC-NUMBER-OF-ITEMS-READ             19400000
194100                             - PC-ITEMS-PER-PANEL + 1             19410000
194200                     IF  PV-TOP-ITEM < +1                         19420000
194300                         MOVE +1   TO PV-TOP-ITEM                 19430000
194400                         MOVE PC-TSYMSG-00070                     19440000
194500                                   TO DP020-MSG-NUMBER            19450000
194600                         SET DP020-MSG-INFORMATIONAL              19460000
194700                                   TO TRUE                        19470000
194800                     END-IF                                       19480000
194900                 ELSE                                             19490000
195000                     MOVE ASC-START-ITEM-REQUEST-N                19500000
195100                                   TO PV-TOP-ITEM                 19510000
195200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      19520000
195300                     COMPUTE PV-BOTTOM-ITEM =                     19530000
195400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     19540000
195500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ19550000
195600*                        -- BOTTOM OF LIST --                     19560000
195700                         MOVE PC-TSYMSG-00070                     19570000
195800                                   TO DP020-MSG-NUMBER            19580000
195900                         SET DP020-MSG-INFORMATIONAL              19590000
196000                                   TO TRUE                        19600000
196100                     END-IF                                       19610000
196200                 END-IF                                           19620000
196300             ELSE                                                 19630000
196400*                --- VALUE OUT OF RANGE ----                      19640000
196500                 MOVE PC-TSYMSG-00101                             19650000
196600                                   TO DP020-MSG-NUMBER            19660000
196700                 MOVE -1           TO ASTRTITL                    19670000
196800                 SET DP030-SET-CURSOR-APPL-1                      19680000
196900                                   TO TRUE                        19690000
197000                 MOVE DP015-REVERSE                               19700000
197100                                   TO ASTRTITH                    19710000
197200                 MOVE DP015-RED    TO ASTRTITC                    19720000
197300                 MOVE DP015-UNP-NUM-BRT-MDT                       19730000
197400                                   TO ASTRTITA                    19740000
197500                 SET DP020-MSG-FATAL                              19750000
197600                                   TO TRUE                        19760000
197700                 SET PS-ERROR      TO TRUE                        19770000
197800             END-IF                                               19780000
197900                                                                  19790000
198000         ELSE                                                     19800000
198100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            19810000
198200             MOVE -1               TO ASTRTITL                    19820000
198300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19830000
198400             MOVE DP015-REVERSE    TO ASTRTITH                    19840000
198500             MOVE DP015-RED        TO ASTRTITC                    19850000
198600             MOVE DP015-UNP-NUM-BRT-MDT                           19860000
198700                                   TO ASTRTITA                    19870000
198800             SET DP020-MSG-FATAL   TO TRUE                        19880000
198900             SET PS-ERROR          TO TRUE                        19890000
199000         END-IF                                                   19900000
199100     END-IF.                                                      19910000
199200 EJECT                                                            19920000
199300******************************************************************19930000
199400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *19940000
199500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *19950000
199600******************************************************************19960000
199700 2140-DESELECT-ALL-ITEMS.                                         19970000
199800                                                                  19980000
199900     MOVE +1                       TO ASC-BLK-SUB.                19990000
200000                                                                  20000000
200100     PERFORM 2141-CLEAR-SELECTED-INDS                             20010000
200200         VARYING ASC-ITEM-SUB                                     20020000
200300         FROM 1 BY 1                                              20030000
200400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20040000
200500                                                                  20050000
200600     ADD +1                        TO ASC-BLK-SUB.                20060000
200700                                                                  20070000
200800     PERFORM 2141-CLEAR-SELECTED-INDS                             20080000
200900         VARYING ASC-ITEM-SUB                                     20090000
201000         FROM 1 BY 1                                              20100000
201100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20110000
201200                                                                  20120000
201300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20130000
201400                                   TO PV-LIST-ITEM-NUMBER.        20140000
201500                                                                  20150000
201600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20160000
201700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    20170000
201800                                                                  20180000
201900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     20190000
202000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      20200000
202100         MOVE +1                   TO ASC-BLK-SUB                 20210000
202200                                                                  20220000
202300         PERFORM 5100-WRITE-TEMP-STORAGE                          20230000
202400                                                                  20240000
202500         MOVE +1                   TO PV-BLOCK-NUMBER             20250000
202600                                                                  20260000
202700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20270000
202800             PV-FIRST-BLOCK-IN-ARRAY - 1                          20280000
202900                                                                  20290000
203000         PERFORM                                                  20300000
203100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       20310000
203200                                                                  20320000
203300             PERFORM 4410-READ-TEMP-STORAGE                       20330000
203400                                                                  20340000
203500             PERFORM 2141-CLEAR-SELECTED-INDS                     20350000
203600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 20360000
203700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20370000
203800                                                                  20380000
203900             PERFORM 5100-WRITE-TEMP-STORAGE                      20390000
204000                                                                  20400000
204100             ADD +1                TO PV-BLOCK-NUMBER             20410000
204200                                                                  20420000
204300         END-PERFORM                                              20430000
204400                                                                  20440000
204500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20450000
204600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20460000
204700                                                                  20470000
204800         PERFORM                                                  20480000
204900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20490000
205000                   ASC-HIGHEST-BLOCK-WRITTEN                      20500000
205100                                                                  20510000
205200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20520000
205300                                   TO PV-BLOCK-NUMBER             20530000
205400                                                                  20540000
205500             PERFORM 4410-READ-TEMP-STORAGE                       20550000
205600                                                                  20560000
205700             PERFORM 2141-CLEAR-SELECTED-INDS                     20570000
205800                 VARYING ASC-ITEM-SUB                             20580000
205900                 FROM 1 BY 1                                      20590000
206000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20600000
206100                                                                  20610000
206200             PERFORM 5100-WRITE-TEMP-STORAGE                      20620000
206300                                                                  20630000
206400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20640000
206500                                                                  20650000
206600         END-PERFORM                                              20660000
206700                                                                  20670000
206800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20680000
206900                                   TO PV-BLOCK-NUMBER             20690000
207000                                                                  20700000
207100         PERFORM 4410-READ-TEMP-STORAGE                           20710000
207200     END-IF.                                                      20720000
207300                                                                  20730000
207400     MOVE +0                 TO ASC-NUMBER-OF-SELECTED-ITEMS      20740000
207500                                ASC-NUMBER-OF-DELETED-ITEMS       20750000
207600                                ASC-START-OF-SELECTED-RANGE       20760000
207700                                ASC-END-OF-SELECTED-RANGE.        20770000
207800                                                                  20780000
207900     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20790000
208000                                                                  20800000
208100 EJECT                                                            20810000
208200******************************************************************20820000
208300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *20830000
208400******************************************************************20840000
208500 2141-CLEAR-SELECTED-INDS.                                        20850000
208600                                                                  20860000
208700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20870000
208800             NOT EQUAL ZERO                                       20880000
208900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20890000
209000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20900000
209100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    20910000
209200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20920000
209300                                   TO TRUE                        20930000
209400         END-IF                                                   20940000
209500     END-IF.                                                      20950000
209600                                                                  20960000
209700 EJECT                                                            20970000
209800******************************************************************20980000
209900*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *20990000
210000*  FOR ALL ITEMS.                                                *21000000
210100******************************************************************21010000
210200 2150-SELECT-ALL-ITEMS.                                           21020000
210300                                                                  21030000
210400     MOVE +1                       TO ASC-BLK-SUB.                21040000
210500                                                                  21050000
210600     PERFORM 2151-SET-SELECTED-INDS                               21060000
210700         VARYING ASC-ITEM-SUB                                     21070000
210800         FROM 1 BY 1                                              21080000
210900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21090000
211000                                                                  21100000
211100     ADD +1                        TO ASC-BLK-SUB.                21110000
211200                                                                  21120000
211300     PERFORM 2151-SET-SELECTED-INDS                               21130000
211400         VARYING ASC-ITEM-SUB                                     21140000
211500         FROM 1 BY 1                                              21150000
211600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 21160000
211700                                                                  21170000
211800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               21180000
211900                                   TO PV-LIST-ITEM-NUMBER.        21190000
212000                                                                  21200000
212100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            21210000
212200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    21220000
212300                                                                  21230000
212400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     21240000
212500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    21250000
212600         MOVE +1                   TO ASC-BLK-SUB                 21260000
212700                                                                  21270000
212800         PERFORM 5100-WRITE-TEMP-STORAGE                          21280000
212900                                                                  21290000
213000         MOVE +1                   TO PV-BLOCK-NUMBER             21300000
213100                                                                  21310000
213200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21320000
213300             PV-FIRST-BLOCK-IN-ARRAY - 1                          21330000
213400                                                                  21340000
213500         PERFORM                                                  21350000
213600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       21360000
213700                                                                  21370000
213800             PERFORM 4410-READ-TEMP-STORAGE                       21380000
213900                                                                  21390000
214000             PERFORM 2151-SET-SELECTED-INDS                       21400000
214100                 VARYING ASC-ITEM-SUB                             21410000
214200                 FROM 1 BY 1                                      21420000
214300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21430000
214400                                                                  21440000
214500             PERFORM 5100-WRITE-TEMP-STORAGE                      21450000
214600                                                                  21460000
214700             ADD +1                TO PV-BLOCK-NUMBER             21470000
214800                                                                  21480000
214900         END-PERFORM                                              21490000
215000                                                                  21500000
215100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21510000
215200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21520000
215300                                                                  21530000
215400         PERFORM                                                  21540000
215500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21550000
215600                   ASC-HIGHEST-BLOCK-WRITTEN                      21560000
215700                                                                  21570000
215800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21580000
215900                                   TO PV-BLOCK-NUMBER             21590000
216000                                                                  21600000
216100             PERFORM 4410-READ-TEMP-STORAGE                       21610000
216200                                                                  21620000
216300             PERFORM 2151-SET-SELECTED-INDS                       21630000
216400                 VARYING ASC-ITEM-SUB                             21640000
216500                 FROM 1 BY 1                                      21650000
216600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21660000
216700                                                                  21670000
216800             PERFORM 5100-WRITE-TEMP-STORAGE                      21680000
216900                                                                  21690000
217000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21700000
217100                                                                  21710000
217200         END-PERFORM                                              21720000
217300                                                                  21730000
217400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21740000
217500                                   TO PV-BLOCK-NUMBER             21750000
217600                                                                  21760000
217700         PERFORM 4410-READ-TEMP-STORAGE                           21770000
217800     END-IF.                                                      21780000
217900                                                                  21790000
218000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             21800000
218100                       ASC-NUMBER-OF-SELECTED-ITEMS.              21810000
218200                                                                  21820000
218300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21830000
218400                                                                  21840000
218500 EJECT                                                            21850000
218600******************************************************************21860000
218700*    MARK EACH ITEM AS BEING SELECTED.                           *21870000
218800******************************************************************21880000
218900 2151-SET-SELECTED-INDS.                                          21890000
219000                                                                  21900000
219100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           21910000
219200             NOT EQUAL ZERO                                       21920000
219300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             21930000
219400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             21940000
219500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        21950000
219600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  21960000
219700                               TO  TRUE                           21970000
219800         END-IF                                                   21980000
219900     END-IF.                                                      21990000
220000                                                                  22000000
220100******************************************************************22010000
220200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **22020000
220300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **22030000
220400******************************************************************22040000
220500 2200-MOVE-SCREEN-TO-COMMAREA.                                    22050000
220600                                                                  22060000
220700     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             22070000
220800     MOVE +1                       TO PV-SUB.                     22080000
220900                                                                  22090000
221000     PERFORM 3100-SET-SUBSCRIPTS.                                 22100000
221100                                                                  22110000
221200     IF  ASTRTITL > ZERO                                          22120000
221300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          22130000
221400     ELSE                                                         22140000
221500         IF  ASTRTITF = DP015-ERASE-EOF                           22150000
221600             INITIALIZE ASC-START-ITEM-REQUEST                    22160000
221700         END-IF                                                   22170000
221800     END-IF.                                                      22180000
221900                                                                  22190000
222000     IF AHDNWSTL > ZERO                                           22200000
222100        MOVE AHDNWSTI          TO ASC-ALP-HD-NEW-STR-AMT          22210000
222200     ELSE                                                         22220000
222300        IF AHDNWSTF = DP015-ERASE-EOF                             22230000
222400           MOVE SPACE          TO ASC-ALP-HD-NEW-STR-AMT          22240000
222500        END-IF                                                    22250000
222600     END-IF.                                                      22260000
222700                                                                  22270000
222800     IF AHDFRGTL > ZERO                                           22280000
222900        MOVE AHDFRGTI          TO ASC-ALP-HD-FRGT-AMT             22290000
223000     ELSE                                                         22300000
223100        IF AHDFRGTF = DP015-ERASE-EOF                             22310000
223200           MOVE SPACE          TO ASC-ALP-HD-FRGT-AMT             22320000
223300        END-IF                                                    22330000
223400     END-IF.                                                      22340000
223500                                                                  22350000
223600     IF AHDCSTL > ZERO                                            22360000
223700        MOVE AHDCSTI           TO ASC-ALP-HD-GRO-COST             22370000
223800     ELSE                                                         22380000
223900        IF AHDCSTF = DP015-ERASE-EOF                              22390000
224000           MOVE SPACE          TO ASC-ALP-HD-GRO-COST             22400000
224100        END-IF                                                    22410000
224200     END-IF.                                                      22420000
224300                                                                  22430000
224400     IF AHDRETL > ZERO                                            22440000
224500        MOVE AHDRETI           TO ASC-ALP-HD-RET-AMT              22450000
224600     ELSE                                                         22460000
224700        IF AHDRETF = DP015-ERASE-EOF                              22470000
224800           MOVE SPACE          TO ASC-ALP-HD-RET-AMT              22480000
224900        END-IF                                                    22490000
225000     END-IF.                                                      22500000
225100                                                                  22510000
225200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          22520000
225300         VARYING PV-SUB                                           22530000
225400         FROM 1 BY 1                                              22540000
225500         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      22550000
225600                                                                  22560000
225700******************************************************************22570000
225800** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**22580000
225900******************************************************************22590000
226000 2210-MOVE-LINES-TO-COMMAREA.                                     22600000
226100                                                                  22610000
226200     IF  MR-SELECTL (PV-SUB) > ZERO                               22620000
226300         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             22630000
226400         MOVE MR-SELECTI (PV-SUB)                                 22640000
226500                                   TO ASC-TEMP-SELECTED-SW        22650000
226600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      22660000
226700     ELSE                                                         22670000
226800         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                22680000
226900                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     22690000
227000                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        22700000
227100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      22710000
227200         END-IF                                                   22720000
227300     END-IF.                                                      22730000
227400                                                                  22740000
227500     IF MR-STOREL (PV-SUB) > ZERO                                 22750000
227600        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE              22760000
227700        MOVE MR-STORE (PV-SUB) TO ASC-ALP-STORE                   22770000
227800                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     22780000
227900        IF MR-STORE (PV-SUB) = SPACES                             22790000
228000           SET ASC-LINE-NOT-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)   22800000
228100                                   TO TRUE                        22810000
228200        ELSE                                                      22820000
228300           SET ASC-LINE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)       22830000
228400                                   TO TRUE                        22840000
228500        END-IF                                                    22850000
228600     ELSE                                                         22860000
228700        IF MR-STOREA (PV-SUB) = DP015-ERASE-EOF                   22870000
228800           SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                   22880000
228900                                   TO TRUE                        22890000
229000           MOVE SPACES             TO ASC-ALP-STORE               22900000
229100                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     22910000
229200           SET ASC-LINE-NOT-CHANGED                               22920000
229300                     (ASC-BLK-SUB, ASC-ITEM-SUB) TO TRUE          22930000
229400        END-IF                                                    22940000
229500     END-IF.                                                      22950000
229600                                                                  22960000
229700     IF MR-CLASSL (PV-SUB) > ZERO                                 22970000
229800        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE              22980000
229900        MOVE MR-CLASS (PV-SUB)          TO ASC-CLASS              22990000
230000                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  23000000
230100        IF MR-CLASS (PV-SUB) = SPACES                             23010000
230200           SET ASC-LINE-NOT-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)   23020000
230300                                        TO TRUE                   23030000
230400        ELSE                                                      23040000
230500           SET ASC-LINE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)       23050000
230600                                        TO TRUE                   23060000
230700        END-IF                                                    23070000
230800     ELSE                                                         23080000
230900        IF MR-CLASSA (PV-SUB) = DP015-ERASE-EOF                   23090000
231000           SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE           23100000
231100           MOVE SPACES         TO ASC-CLASS                       23110000
231200                                (ASC-BLK-SUB, ASC-ITEM-SUB)       23120000
231300           SET ASC-LINE-NOT-CHANGED                               23130000
231400                           (ASC-BLK-SUB, ASC-ITEM-SUB)            23140000
231500                               TO TRUE                            23150000
231600        END-IF                                                    23160000
231700     END-IF.                                                      23170000
231800                                                                  23180000
231900     IF MR-SKUL (PV-SUB) > ZERO                                   23190000
232000        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE              23200000
232100        IF MR-SKU (PV-SUB) EQUAL SPACES                           23210000
232200            MOVE ZERO             TO ASC-SKU                      23220000
232300                                    (ASC-BLK-SUB, ASC-ITEM-SUB)   23230000
232400        ELSE                                                      23240000
232500            INITIALIZE PV-SKU                                     23250000
232600            MOVE MR-SKU (PV-SUB)  TO PV-SKU                       23260000
232700            MOVE PV-SKU-9         TO ASC-SKU                      23270000
232800                                    (ASC-BLK-SUB, ASC-ITEM-SUB)   23280000
232900        END-IF                                                    23290000
233000        IF MR-SKU (PV-SUB) = SPACES                               23300000
233100           SET ASC-LINE-NOT-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)   23310000
233200                                 TO TRUE                          23320000
233300        ELSE                                                      23330000
233400           SET ASC-LINE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)       23340000
233500                                 TO TRUE                          23350000
233600        END-IF                                                    23360000
233700     ELSE                                                         23370000
233800        IF MR-SKUA (PV-SUB) = DP015-ERASE-EOF                     23380000
233900           SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE           23390000
234000           MOVE ZERO             TO ASC-SKU                       23400000
234100                                   (ASC-BLK-SUB, ASC-ITEM-SUB)    23410000
234200           SET ASC-LINE-NOT-CHANGED                               23420000
234300                             (ASC-BLK-SUB, ASC-ITEM-SUB) TO TRUE  23430000
234400        END-IF                                                    23440000
234500     END-IF.                                                      23450000
234600                                                                  23460000
234700     IF MR-GROSSL (PV-SUB) > ZERO                                 23470000
234800        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE              23480000
234900        IF MR-GROSS (PV-SUB) EQUAL SPACES                         23490000
235000           MOVE ZERO              TO ASC-GROSS-COST               23500000
235100                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     23510000
235200        ELSE                                                      23520000
235300           MOVE MR-GROSS (PV-SUB)     TO DP010I-UNEDITED-FIELD    23530000
235400           MOVE 10                    TO DP010I-MAXIMUM-DIGITS    23540000
235500           MOVE 2                     TO DP010I-MAXIMUM-DECIMALS  23550000
235600           SET DP010I-NEGATIVE-ALLOWED                            23560000
235700                                      TO TRUE                     23570000
235810           CALL DP010I-NUMERIC-EDIT-ROUTINE                       23581001
235820                         USING DP010I-NUMERIC-EDIT-AREA           23582001
235900                                                                  23590000
236000           IF DP010I-ERROR-DETECTED                               23600000
236100              SET DP020-MSG-FATAL           TO TRUE               23610000
236200              MOVE DP015-UNP-ALP-BRT-OFF    TO AHDFRGTA           23620000
236300              MOVE DP015-RED                TO AHDFRGTC           23630000
236400              MOVE DP015-REVERSE            TO AHDFRGTH           23640000
236500              MOVE -1                       TO AHDFRGTL           23650000
236600              IF PS-NO-ERROR                                      23660000
236700                 MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER   23670000
236800              END-IF                                              23680000
236900              SET PS-ERROR                  TO TRUE               23690000
237000           ELSE                                                   23700000
237100              MOVE DP010I-NUMERIC-FIELD TO ASC-GROSS-COST         23710000
237200                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     23720000
237300           END-IF                                                 23730000
237400        END-IF                                                    23740000
237500        IF MR-GROSS (PV-SUB) = SPACES                             23750000
237600           SET ASC-LINE-NOT-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)   23760000
237700                                   TO TRUE                        23770000
237800        ELSE                                                      23780000
237900           SET ASC-LINE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)       23790000
238000                                   TO TRUE                        23800000
238100        END-IF                                                    23810000
238200     ELSE                                                         23820000
238300        IF MR-GROSSA (PV-SUB) = DP015-ERASE-EOF                   23830000
238400           SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE           23840000
238500           MOVE ZERO             TO ASC-GROSS-COST                23850000
238600                                   (ASC-BLK-SUB, ASC-ITEM-SUB)    23860000
238700           SET ASC-LINE-NOT-CHANGED                               23870000
238800                        (ASC-BLK-SUB, ASC-ITEM-SUB)               23880000
238900                                 TO TRUE                          23890000
239000        END-IF                                                    23900000
239100     END-IF.                                                      23910000
239200                                                                  23920000
239300     IF MR-RETAILL (PV-SUB) > ZERO                                23930000
239400        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE              23940000
239500        IF MR-RETAIL (PV-SUB) EQUAL SPACES                        23950000
239600           MOVE ZERO               TO ASC-RETAIL-AMT              23960000
239700                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  23970000
239800        ELSE                                                      23980000
239900           MOVE MR-RETAIL (PV-SUB)    TO DP010I-UNEDITED-FIELD    23990000
240000           MOVE 10                    TO DP010I-MAXIMUM-DIGITS    24000000
240100           MOVE 2                     TO DP010I-MAXIMUM-DECIMALS  24010000
240200           SET DP010I-NEGATIVE-ALLOWED                            24020000
240300                                      TO TRUE                     24030000
240410           CALL DP010I-NUMERIC-EDIT-ROUTINE                       24041001
240420                         USING DP010I-NUMERIC-EDIT-AREA           24042001
240500                                                                  24050000
240600           IF DP010I-ERROR-DETECTED                               24060000
240700              SET DP020-MSG-FATAL           TO TRUE               24070000
240800              MOVE DP015-UNP-ALP-BRT-OFF    TO AHDFRGTA           24080000
240900              MOVE DP015-RED                TO AHDFRGTC           24090000
241000              MOVE DP015-REVERSE            TO AHDFRGTH           24100000
241100              MOVE -1                       TO AHDFRGTL           24110000
241200              IF PS-NO-ERROR                                      24120000
241300                 MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER   24130000
241400              END-IF                                              24140000
241500              SET PS-ERROR                  TO TRUE               24150000
241600           ELSE                                                   24160000
241700              MOVE DP010I-NUMERIC-FIELD TO ASC-RETAIL-AMT         24170000
241800                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     24180000
241900           END-IF                                                 24190000
242000        END-IF                                                    24200000
242100        IF MR-RETAIL (PV-SUB) = SPACES                            24210000
242200           SET ASC-LINE-NOT-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)   24220000
242300                                   TO TRUE                        24230000
242400        ELSE                                                      24240000
242500           SET ASC-LINE-CHANGED (ASC-BLK-SUB, ASC-ITEM-SUB)       24250000
242600                                   TO TRUE                        24260000
242700        END-IF                                                    24270000
242800     ELSE                                                         24280000
242900        IF MR-RETAILA (PV-SUB) = DP015-ERASE-EOF                  24290000
243000           SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE           24300000
243100           MOVE ZERO             TO ASC-RETAIL-AMT                24310000
243200                                   (ASC-BLK-SUB, ASC-ITEM-SUB)    24320000
243300           SET ASC-LINE-NOT-CHANGED                               24330000
243400                        (ASC-BLK-SUB, ASC-ITEM-SUB)               24340000
243500                                 TO TRUE                          24350000
243600        END-IF                                                    24360000
243700     END-IF.                                                      24370000
243800                                                                  24380000
243900     ADD +1                        TO ASC-ITEM-SUB.               24390000
244000                                                                  24400000
244100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24410000
244200         ADD +1                    TO ASC-BLK-SUB                 24420000
244300         MOVE +1                   TO ASC-ITEM-SUB                24430000
244400     END-IF.                                                      24440000
244500                                                                  24450000
244600******************************************************************24460000
244700** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **24470000
244800** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **24480000
244900******************************************************************24490000
245000 3000-EDIT-DATA-IN-COMMAREA.                                      24500000
245100                                                                  24510000
245200     SET PS-NO-ERROR               TO TRUE.                       24520000
245300                                                                  24530000
245400     PERFORM 3200-RESET-ATTRIBUTES.                               24540000
245500                                                                  24550000
245600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     24560000
245700                                                                  24570000
245800     IF ASC-NEW-STR-COST-ALLOCATION                               24580000
245900        PERFORM 3070-EDIT-HD-NEW-STR                              24590000
246000     END-IF.                                                      24600000
246100                                                                  24610000
246200     PERFORM 3075-EDIT-HD-FREIGHT.                                24620000
246300     PERFORM 3080-EDIT-HD-COST.                                   24630000
246400     PERFORM 3090-EDIT-HD-RETAIL-AMOUNT.                          24640000
246500     PERFORM 3095-CHECK-GROSS-GREATER-RTL.                        24650000
246600     PERFORM 3096-CHECK-FOR-HD-GROSS-COST.                        24660000
246700     PERFORM 3097-CALC-MARKON-PERCENTAGE.                         24670000
246800**                                                                24680000
246900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              24690000
247000* EDITTING IS DONE FROM THE BOTTOM UP.                            24700000
247100**                                                                24710000
247200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       24720000
247300         ASC-ITEMS-DISPLAYED - 1.                                 24730000
247400                                                                  24740000
247500     PERFORM 3100-SET-SUBSCRIPTS.                                 24750000
247600                                                                  24760000
247700     PERFORM 3300-EDIT-SELECTIONS                                 24770000
247800         VARYING PV-SUB                                           24780000
247900         FROM PV-SUB BY -1                                        24790000
248000         UNTIL PV-SUB < +1                                        24800000
248100     IF PS-NO-ERROR                                               24810000
248200        IF ASC-NO-STORES-IN-PER                                   24820000
248300              IF ASC-ACTION-SW = 'ADD'                            24830000
248400                 MOVE ASC-CURRENT-DATE TO ASC-CUTOFF-DATE         24840000
248500              END-IF                                              24850000
248600        END-IF                                                    24860000
248700     END-IF.                                                      24870000
248800                                                                  24880000
248900     IF  PS-NO-ERROR                                              24890000
249000         MOVE -1               TO AHDFRGTL                        24900000
249100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        24910000
249200     END-IF.                                                      24920000
249300                                                                  24930000
249400     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         24940000
249500                                                                  24950000
249600     IF  ((PS-NO-ERROR)                                           24960000
249700       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   24970000
249800       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    24980000
249900             PERFORM 3500-MARK-RANGE-AS-SELECTED                  24990000
250000     END-IF.                                                      25000000
250100 EJECT                                                            25010000
250200******************************************************************25020000
250300* THIS PARAGRAPH WILL PERFORM EDITS ON THE HEADER NEW STORE      *25030000
250400* AMOUNT FIELD.                                                  *25040000
250500******************************************************************25050000
250600 3070-EDIT-HD-NEW-STR.                                            25060000
250700                                                                  25070000
250800     IF ASC-ALP-HD-NEW-STR-AMT > SPACES AND                       25080000
250900        ASC-ALP-HD-NEW-STR-AMT NOT = '000000000000'               25090000
251000        IF ASC-COST-PRCCTL-CDE = 'A' OR                           25100000
251100           ASC-COST-PRCCTL-CDE = 'R'                              25110000
251200           MOVE ASC-ALP-HD-NEW-STR-AMT TO DP010I-UNEDITED-FIELD   25120000
251300           MOVE 10                    TO DP010I-MAXIMUM-DIGITS    25130000
251400           MOVE 2                     TO DP010I-MAXIMUM-DECIMALS  25140000
251500           SET DP010I-NEGATIVE-ALLOWED                            25150000
251600                                      TO TRUE                     25160000
251710           CALL DP010I-NUMERIC-EDIT-ROUTINE                       25171001
251720                         USING DP010I-NUMERIC-EDIT-AREA           25172001
251800                                                                  25180000
251900           IF DP010I-ERROR-DETECTED                               25190000
252000              SET DP020-MSG-FATAL           TO TRUE               25200000
252100              MOVE DP015-UNP-ALP-BRT-OFF    TO AHDNWSTA           25210000
252200              MOVE DP015-RED                TO AHDNWSTC           25220000
252300              MOVE DP015-REVERSE            TO AHDNWSTH           25230000
252400              MOVE -1                       TO AHDNWSTL           25240000
252500              IF PS-NO-ERROR                                      25250000
252600                 MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER   25260000
252700              END-IF                                              25270000
252800              SET PS-ERROR                  TO TRUE               25280000
252900           ELSE                                                   25290000
253000              MOVE DP010I-NUMERIC-FIELD TO ASC-HD-NEW-STR-AMT     25300000
253100                                        ASC-ALP-HD-NEW-STR-AMT-9  25310000
253200              IF ASC-HD-NEW-STR-AMT < 0 AND                       25320000
253300                 ASC-PSTG-TYP-CDE = 'CH'                          25330000
253400                 SET DP020-MSG-FATAL        TO TRUE               25340000
253500                 MOVE DP015-UNP-ALP-BRT-OFF TO AHDNWSTA           25350000
253600                 MOVE DP015-RED             TO AHDNWSTC           25360000
253700                 MOVE DP015-REVERSE         TO AHDNWSTH           25370000
253800                 MOVE -1                    TO AHDNWSTL           25380000
253900                 IF PS-NO-ERROR                                   25390000
254000                    MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER   25400000
254100                 END-IF                                           25410000
254200                 SET PS-ERROR TO TRUE                             25420000
254300              END-IF                                              25430000
254400              IF ASC-HD-NEW-STR-AMT > 0 AND                       25440000
254500                 ASC-PSTG-TYP-CDE = 'CR'                          25450000
254600                 SET DP020-MSG-FATAL        TO TRUE               25460000
254700                 MOVE DP015-UNP-ALP-BRT-OFF TO AHDNWSTA           25470000
254800                 MOVE DP015-RED             TO AHDNWSTC           25480000
254900                 MOVE DP015-REVERSE         TO AHDNWSTH           25490000
255000                 MOVE -1                    TO AHDNWSTL           25500000
255100                 IF PS-NO-ERROR                                   25510000
255200                    MOVE PC-TSYMSG-01902    TO DP020-MSG-NUMBER   25520000
255300                 END-IF                                           25530000
255400                 SET PS-ERROR TO TRUE                             25540000
255500              END-IF                                              25550000
255600           END-IF                                                 25560000
255700        ELSE                                                      25570000
255800           IF ASC-COST-PRCCTL-CDE = 'N' OR                        25580000
255900              (ASC-ALP-HD-GRO-COST = SPACES AND                   25590000
256000               ASC-ALP-HD-RET-AMT NOT = SPACES)                   25600000
256100              SET DP020-MSG-FATAL            TO TRUE              25610000
256200              MOVE DP015-UNP-ALP-BRT-OFF     TO AHDNWSTA          25620000
256300              MOVE DP015-RED                 TO AHDNWSTC          25630000
256400              MOVE DP015-REVERSE             TO AHDNWSTH          25640000
256500              MOVE -1                        TO AHDNWSTL          25650000
256600              IF PS-NO-ERROR                                      25660000
256700                 MOVE PC-TSYMSG-01929        TO DP020-MSG-NUMBER  25670000
256800              END-IF                                              25680000
256900              SET PS-ERROR                   TO TRUE              25690000
257000           END-IF                                                 25700000
257100        END-IF                                                    25710000
257200     END-IF.                                                      25720000
257300                                                                  25730000
257400 EJECT                                                            25740000
257500******************************************************************25750000
257600* THIS PARAGRAPH WILL PERFORM EDITS ON THE HEADER FREIGHT AMOUNT *25760000
257700* FIELD.                                                         *25770000
257800******************************************************************25780000
257900 3075-EDIT-HD-FREIGHT.                                            25790000
258000                                                                  25800000
258100     IF ASC-ALP-HD-FRGT-AMT > SPACES AND                          25810000
258200        ASC-ALP-HD-FRGT-AMT NOT = '000000000000'                  25820000
258300        IF ASC-COST-PRCCTL-CDE = 'A' OR                           25830000
258400           ASC-COST-PRCCTL-CDE = 'R'                              25840000
258500           MOVE ASC-ALP-HD-FRGT-AMT   TO DP010I-UNEDITED-FIELD    25850000
258600           MOVE 10                    TO DP010I-MAXIMUM-DIGITS    25860000
258700           MOVE 2                     TO DP010I-MAXIMUM-DECIMALS  25870000
258800           SET DP010I-NEGATIVE-ALLOWED                            25880000
258900                                      TO TRUE                     25890000
259010           CALL DP010I-NUMERIC-EDIT-ROUTINE                       25901001
259020                         USING DP010I-NUMERIC-EDIT-AREA           25902001
259100                                                                  25910000
259200           IF DP010I-ERROR-DETECTED                               25920000
259300              SET DP020-MSG-FATAL           TO TRUE               25930000
259400              MOVE DP015-UNP-ALP-BRT-OFF    TO AHDFRGTA           25940000
259500              MOVE DP015-RED                TO AHDFRGTC           25950000
259600              MOVE DP015-REVERSE            TO AHDFRGTH           25960000
259700              MOVE -1                       TO AHDFRGTL           25970000
259800              IF PS-NO-ERROR                                      25980000
259900                 MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER   25990000
260000              END-IF                                              26000000
260100              SET PS-ERROR                  TO TRUE               26010000
260200           ELSE                                                   26020000
260300              MOVE DP010I-NUMERIC-FIELD TO ASC-HD-FRGT-AMT        26030000
260400                                           ASC-ALP-HD-FRGT-AMT-9  26040000
260500              IF ASC-HD-FRGT-AMT < 0 AND                          26050000
260600                 ASC-PSTG-TYP-CDE = 'CH'                          26060000
260700                 SET DP020-MSG-FATAL        TO TRUE               26070000
260800                 MOVE DP015-UNP-ALP-BRT-OFF TO AHDFRGTA           26080000
260900                 MOVE DP015-RED             TO AHDFRGTC           26090000
261000                 MOVE DP015-REVERSE         TO AHDFRGTH           26100000
261100                 MOVE -1                    TO AHDFRGTL           26110000
261200                 IF PS-NO-ERROR                                   26120000
261300                    MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER   26130000
261400                 END-IF                                           26140000
261500                 SET PS-ERROR TO TRUE                             26150000
261600              END-IF                                              26160000
261700              IF ASC-HD-FRGT-AMT > 0 AND                          26170000
261800                 ASC-PSTG-TYP-CDE = 'CR'                          26180000
261900                 SET DP020-MSG-FATAL        TO TRUE               26190000
262000                 MOVE DP015-UNP-ALP-BRT-OFF TO AHDFRGTA           26200000
262100                 MOVE DP015-RED             TO AHDFRGTC           26210000
262200                 MOVE DP015-REVERSE         TO AHDFRGTH           26220000
262300                 MOVE -1                    TO AHDFRGTL           26230000
262400                 IF PS-NO-ERROR                                   26240000
262500                    MOVE PC-TSYMSG-01902    TO DP020-MSG-NUMBER   26250000
262600                 END-IF                                           26260000
262700                 SET PS-ERROR TO TRUE                             26270000
262800              END-IF                                              26280000
262900           END-IF                                                 26290000
263000        ELSE                                                      26300000
263100           IF ASC-COST-PRCCTL-CDE = 'N' OR                        26310000
263200              (ASC-ALP-HD-GRO-COST = SPACES AND                   26320000
263300               ASC-ALP-HD-RET-AMT NOT = SPACES)                   26330000
263400              SET DP020-MSG-FATAL            TO TRUE              26340000
263500              MOVE DP015-UNP-ALP-BRT-OFF     TO AHDFRGTA          26350000
263600              MOVE DP015-RED                 TO AHDFRGTC          26360000
263700              MOVE DP015-REVERSE             TO AHDFRGTH          26370000
263800              MOVE -1                        TO AHDFRGTL          26380000
263900              IF PS-NO-ERROR                                      26390000
264000                 MOVE PC-TSYMSG-01929        TO DP020-MSG-NUMBER  26400000
264100              END-IF                                              26410000
264200              SET PS-ERROR                   TO TRUE              26420000
264300           END-IF                                                 26430000
264400        END-IF                                                    26440000
264500     ELSE                                                         26450000
264600        INITIALIZE ASC-HD-FRGT-AMT                                26460000
264700        IF ASC-FRGT-REQR-IND = 'Y'                                26470000
264800           SET DP020-MSG-FATAL               TO TRUE              26480000
264900           MOVE DP015-UNP-ALP-BRT-OFF        TO AHDFRGTA          26490000
265000           MOVE DP015-RED                    TO AHDFRGTC          26500000
265100           MOVE DP015-REVERSE                TO AHDFRGTH          26510000
265200           MOVE -1                           TO AHDFRGTL          26520000
265300           IF PS-NO-ERROR                                         26530000
265400              MOVE PC-TSYMSG-00007           TO DP020-MSG-NUMBER  26540000
265500           END-IF                                                 26550000
265600           SET PS-ERROR                      TO TRUE              26560000
265700        END-IF                                                    26570000
265800     END-IF.                                                      26580000
265900                                                                  26590000
266000******************************************************************26600000
266100* THIS PARAGRAPH WILL PERFORM EDITS ON THE HEADER GROSS COST     *26610000
266200* FIELD.                                                         *26620000
266300******************************************************************26630000
266400 3080-EDIT-HD-COST.                                               26640000
266500                                                                  26650000
266600     IF ASC-ALP-HD-GRO-COST > SPACES AND                          26660000
266700        ASC-ALP-HD-GRO-COST NOT = '000000000000'                  26670000
266800        IF ASC-COST-PRCCTL-CDE = 'A' OR                           26680000
266900           ASC-COST-PRCCTL-CDE = 'R'                              26690000
267000           MOVE ASC-ALP-HD-GRO-COST TO DP010I-UNEDITED-FIELD      26700000
267100           MOVE 10                  TO DP010I-MAXIMUM-DIGITS      26710000
267200           MOVE 2                   TO DP010I-MAXIMUM-DECIMALS    26720000
267300           SET DP010I-NEGATIVE-ALLOWED                            26730000
267400                                    TO TRUE                       26740000
267510           CALL DP010I-NUMERIC-EDIT-ROUTINE                       26751001
267520                         USING DP010I-NUMERIC-EDIT-AREA           26752001
267600                                                                  26760000
267700           IF DP010I-ERROR-DETECTED                               26770000
267800              SET DP020-MSG-FATAL TO TRUE                         26780000
267900              MOVE DP015-UNP-ALP-BRT-OFF TO AHDCSTA               26790000
268000              MOVE DP015-RED             TO AHDCSTC               26800000
268100              MOVE DP015-REVERSE         TO AHDCSTH               26810000
268200              MOVE -1                    TO AHDCSTL               26820000
268300              IF PS-NO-ERROR                                      26830000
268400                 MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER      26840000
268500              END-IF                                              26850000
268600              SET PS-ERROR TO TRUE                                26860000
268700           ELSE                                                   26870000
268800              MOVE DP010I-NUMERIC-FIELD TO ASC-HD-GRO-COST        26880000
268900                                           ASC-ALP-HD-GRO-COST-9  26890000
269000              IF ASC-HD-GRO-COST < 0 AND                          26900000
269100                 ASC-PSTG-TYP-CDE = 'CH'                          26910000
269200                 SET DP020-MSG-FATAL     TO TRUE                  26920000
269300                 MOVE DP015-UNP-ALP-BRT-OFF  TO AHDCSTA           26930000
269400                 MOVE DP015-RED              TO AHDCSTC           26940000
269500                 MOVE DP015-REVERSE          TO AHDCSTH           26950000
269600                 MOVE -1                     TO AHDCSTL           26960000
269700                 IF PS-NO-ERROR                                   26970000
269800                    MOVE PC-TSYMSG-01903     TO DP020-MSG-NUMBER  26980000
269900                 END-IF                                           26990000
270000                 SET PS-ERROR TO TRUE                             27000000
270100              END-IF                                              27010000
270200              IF ASC-HD-GRO-COST > 0 AND                          27020000
270300                 ASC-PSTG-TYP-CDE = 'CR'                          27030000
270400                 SET DP020-MSG-FATAL          TO TRUE             27040000
270500                 MOVE DP015-UNP-ALP-BRT-OFF   TO AHDCSTA          27050000
270600                 MOVE DP015-RED               TO AHDCSTC          27060000
270700                 MOVE DP015-REVERSE           TO AHDCSTH          27070000
270800                 MOVE -1                      TO AHDCSTL          27080000
270900                 IF PS-NO-ERROR                                   27090000
271000                    MOVE PC-TSYMSG-01902 TO DP020-MSG-NUMBER      27100000
271100                 END-IF                                           27110000
271200                 SET PS-ERROR TO TRUE                             27120000
271300              END-IF                                              27130000
271400           END-IF                                                 27140000
271500        ELSE                                                      27150000
271600           IF ASC-COST-PRCCTL-CDE = 'N'                           27160000
271700              SET DP020-MSG-FATAL      TO TRUE                    27170000
271800              MOVE DP015-UNP-ALP-BRT-OFF TO AHDCSTA               27180000
271900              MOVE DP015-RED             TO AHDCSTC               27190000
272000              MOVE DP015-REVERSE         TO AHDCSTH               27200000
272100              MOVE -1                    TO AHDCSTL               27210000
272200              IF PS-NO-ERROR                                      27220000
272300                 MOVE PC-TSYMSG-01906    TO DP020-MSG-NUMBER      27230000
272400              END-IF                                              27240000
272500              SET PS-ERROR TO TRUE                                27250000
272600           END-IF                                                 27260000
272700        END-IF                                                    27270000
272800*    ELSE                                                         27280000
272900*       INITIALIZE ASC-HD-GRO-COST                                27290000
273000*       IF ASC-COST-PRCCTL-CDE = 'R'                              27300000
273100*          SET DP020-MSG-FATAL        TO TRUE                     27310000
273200*          MOVE DP015-UNP-ALP-BRT-OFF TO AHDCSTA                  27320000
273300*          MOVE DP015-RED             TO AHDCSTC                  27330000
273400*          MOVE DP015-REVERSE         TO AHDCSTH                  27340000
273500*          MOVE -1                    TO AHDCSTL                  27350000
273600*          IF PS-NO-ERROR                                         27360000
273700*             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER            27370000
273800*          END-IF                                                 27380000
273900*          SET PS-ERROR TO TRUE                                   27390000
274000*       END-IF                                                    27400000
274100     END-IF.                                                      27410000
274200                                                                  27420000
274300******************************************************************27430000
274400* THIS PARAGRAPH WILL PERFORM EDITS ON THE HEADER RETAIL AMOUNT  *27440000
274500* FIELD.                                                         *27450000
274600******************************************************************27460000
274700 3090-EDIT-HD-RETAIL-AMOUNT.                                      27470000
274800                                                                  27480000
274900     IF ASC-ALP-HD-RET-AMT > SPACES AND                           27490000
275000        ASC-ALP-HD-RET-AMT NOT EQUAL TO '000000000000'            27500000
275100        IF ASC-RTL-PRCCTL-CDE = 'A' OR                            27510000
275200           ASC-RTL-PRCCTL-CDE = 'R'                               27520000
275300           MOVE ASC-ALP-HD-RET-AMT   TO DP010I-UNEDITED-FIELD     27530000
275400           MOVE 10                   TO DP010I-MAXIMUM-DIGITS     27540000
275500           MOVE 2                    TO DP010I-MAXIMUM-DECIMALS   27550000
275600           SET DP010I-NEGATIVE-ALLOWED                            27560000
275700                                     TO TRUE                      27570000
275810           CALL DP010I-NUMERIC-EDIT-ROUTINE                       27581001
275820                         USING DP010I-NUMERIC-EDIT-AREA           27582001
275900           IF DP010I-ERROR-DETECTED                               27590000
276000              SET DP020-MSG-FATAL TO TRUE                         27600000
276100              MOVE DP015-UNP-ALP-BRT-OFF TO AHDRETA               27610000
276200              MOVE DP015-RED             TO AHDRETC               27620000
276300              MOVE DP015-REVERSE         TO AHDRETH               27630000
276400              MOVE -1                    TO AHDRETL               27640000
276500              IF PS-NO-ERROR                                      27650000
276600                 MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER         27660000
276700              END-IF                                              27670000
276800              SET PS-ERROR TO TRUE                                27680000
276900           ELSE                                                   27690000
277000              MOVE DP010I-NUMERIC-FIELD                           27700000
277100                                      TO ASC-HD-RET-AMT           27710000
277200                                         ASC-ALP-HD-RET-AMT-9     27720000
277300              IF ASC-HD-RET-AMT < 0 AND                           27730000
277400                 ASC-PSTG-TYP-CDE = 'CH'                          27740000
277500                 SET DP020-MSG-FATAL TO TRUE                      27750000
277600                 MOVE DP015-UNP-ALP-BRT-OFF TO AHDRETA            27760000
277700                 MOVE DP015-RED             TO AHDRETC            27770000
277800                 MOVE DP015-REVERSE         TO AHDRETH            27780000
277900                 MOVE -1                    TO AHDRETL            27790000
278000                 IF PS-NO-ERROR                                   27800000
278100                    MOVE PC-TSYMSG-01903    TO DP020-MSG-NUMBER   27810000
278200                 END-IF                                           27820000
278300                 SET PS-ERROR TO TRUE                             27830000
278400              END-IF                                              27840000
278500              IF ASC-HD-RET-AMT > 0 AND                           27850000
278600                 ASC-PSTG-TYP-CDE = 'CR'                          27860000
278700                 SET DP020-MSG-FATAL        TO TRUE               27870000
278800                 MOVE DP015-UNP-ALP-BRT-OFF TO AHDRETA            27880000
278900                 MOVE DP015-RED             TO AHDRETC            27890000
279000                 MOVE DP015-REVERSE         TO AHDRETH            27900000
279100                 MOVE -1                    TO AHDRETL            27910000
279200                 IF PS-NO-ERROR                                   27920000
279300                    MOVE PC-TSYMSG-01902    TO DP020-MSG-NUMBER   27930000
279400                 END-IF                                           27940000
279500                 SET PS-ERROR TO TRUE                             27950000
279600              END-IF                                              27960000
279700           END-IF                                                 27970000
279800        ELSE                                                      27980000
279900           IF ASC-RTL-PRCCTL-CDE = 'N'                            27990000
280000              SET DP020-MSG-FATAL           TO TRUE               28000000
280100              MOVE DP015-UNP-ALP-BRT-OFF    TO AHDRETA            28010000
280200              MOVE DP015-RED                TO AHDRETC            28020000
280300              MOVE DP015-REVERSE            TO AHDRETH            28030000
280400              MOVE -1                       TO AHDRETL            28040000
280500              IF PS-NO-ERROR                                      28050000
280600                 MOVE PC-TSYMSG-01929       TO DP020-MSG-NUMBER   28060000
280700              END-IF                                              28070000
280800              SET PS-ERROR TO TRUE                                28080000
280900           END-IF                                                 28090000
281000        END-IF                                                    28100000
281100     ELSE                                                         28110000
281200        INITIALIZE ASC-HD-RET-AMT                                 28120000
281300        IF ASC-RTL-PRCCTL-CDE = 'R'                               28130000
281400           SET DP020-MSG-FATAL               TO TRUE              28140000
281500           MOVE DP015-UNP-ALP-BRT-OFF        TO AHDRETA           28150000
281600           MOVE DP015-RED                    TO AHDRETC           28160000
281700           MOVE DP015-REVERSE                TO AHDRETH           28170000
281800           MOVE -1                           TO AHDRETL           28180000
281900           IF PS-NO-ERROR                                         28190000
282000              MOVE PC-TSYMSG-00007           TO DP020-MSG-NUMBER  28200000
282100           END-IF                                                 28210000
282200           SET PS-ERROR TO TRUE                                   28220000
282300        END-IF                                                    28230000
282400     END-IF.                                                      28240000
282500                                                                  28250000
282600******************************************************************28260000
282700* IF THE RETAIL AMOUNT AND THE GROSS COST                        *28270000
282800* ARE NOT EQUAL TO ZERO THIS PARAGRAPH WILL                      *28280000
282900* DETERMINE IF THE UNSIGNED (ABSOLUTE VALUE) GROSS COST IS       *28290000
283000* GREATER THAN THE UNSIGNED (ABSOLUTE VALUE) RETAIL AMOUNT.      *28300000
283100* IF THIS CONDITION EXISTS A WARNING MESSAGE IS DISPLAYED.       *28310000
283200******************************************************************28320000
283300 3095-CHECK-GROSS-GREATER-RTL.                                    28330000
283400                                                                  28340000
283500     IF ASC-HD-RET-AMT NOT EQUAL ZERO AND                         28350000
283600        ASC-HD-GRO-COST NOT EQUAL ZERO                            28360000
283700        MOVE ASC-HD-RET-AMT TO PV-ABS-RETAIL-AMT                  28370000
283800        MOVE ASC-HD-GRO-COST TO PV-ABS-GROSS-COST                 28380000
283900        IF PV-ABS-GROSS-COST > PV-ABS-RETAIL-AMT AND              28390000
284000           PS-NO-ERROR                                            28400000
284100           SET DP020-MSG-WARNING TO TRUE                          28410000
284200           MOVE PC-TSYMSG-01967  TO DP020-MSG-NUMBER              28420000
284300        END-IF                                                    28430000
284400     END-IF.                                                      28440000
284500                                                                  28450000
284600******************************************************************28460000
284700* THIS PARAGRAPH CHECKS FOR THE HEADER GROSS COST IF THE HEADER  *28470000
284800* RETAIL COST EXISTS AND THE HEADER FREIGHT OR MISC CHARGES ARE  *28480000
284900* NOT ZERO.  THE HEADER GROSS COST MUST HAVE A VALUE OTHER THAN  *28490000
285000* ZERO FOR THE ERROR MESSAGE TO NOT BE DISPLAYED.                *28500000
285100******************************************************************28510000
285200 3096-CHECK-FOR-HD-GROSS-COST.                                    28520000
285300                                                                  28530000
285400     IF  ASC-HD-GRO-COST = 0                                      28540000
285500     AND (ASC-HD-RET-AMT NOT = 0                                  28550000
285600          AND (ASC-HD-FRGT-AMT NOT = 0                            28560000
285700           OR ASC-HD-NEW-STR-AMT   NOT = 0                        28570000
285800           OR ASC-MISC-CHRG-AMT   NOT = 0))                       28580000
285900        SET DP020-MSG-FATAL                  TO TRUE              28590000
286000        MOVE DP015-UNP-ALP-BRT-OFF           TO AHDFRGTA          28600000
286100                                                AHDNWSTA          28610000
286200                                                AHDCSTA           28620000
286300                                                AHDRETA           28630000
286400        MOVE DP015-RED                       TO AHDFRGTC          28640000
286500                                                AHDNWSTC          28650000
286600                                                AHDCSTC           28660000
286700                                                AHDRETC           28670000
286800        MOVE DP015-REVERSE                   TO AHDFRGTH          28680000
286900                                                AHDNWSTH          28690000
287000                                                AHDCSTH           28700000
287100                                                AHDRETH           28710000
287200        MOVE -1                              TO AHDFRGTL          28720000
287300                                                AHDNWSTL          28730000
287400                                                AHDCSTL           28740000
287500                                                AHDRETL           28750000
287600*       -- INVALID COMBINATION OF RETAIL AND OTHER AMOUNT FIELDS  28760000
287700        IF PS-NO-ERROR                                            28770000
287800             MOVE PC-TSYMSG-02481 TO DP020-MSG-NUMBER             28780000
287900        END-IF                                                    28790000
288000        SET PS-ERROR TO TRUE                                      28800000
288100     END-IF.                                                      28810000
288200                                                                  28820000
288300******************************************************************28830000
288400* THIS PARAGRAPH CALCULATES THE MARKON PERCENTAGE FOR ANY TRANS- *28840000
288500* ACTION THAT HAS BOTH A RETAIL AND GROSS COST AMOUNT NOT EQUAL  *28850000
288600* TO ZERO.  IF THE PERCENTAGE IS 85% OR GREATER THEN A WARNING   *28860000
288700* MESSAGE IS DISPLAYED AND THE USER WILL HAVE TO CORRECT THE     *28870000
288800* AMOUNTS (RETAIL AND/OR GROSS COST).  ALSO IF THE PERCENTAGE IS *28880000
288900* 15% OR LESS THEN THE SAME WARNING IS SET.                      *28890000
289000******************************************************************28900000
289100 3097-CALC-MARKON-PERCENTAGE.                                     28910000
289200                                                                  28920000
289300     MOVE ZEROES TO PV-MARKON-PCT.                                28930000
289400                                                                  28940000
289500     IF ASC-HD-RET-AMT  NOT EQUAL ZERO AND                        28950000
289600        ASC-HD-GRO-COST NOT EQUAL ZERO                            28960000
289700        MOVE ASC-HD-RET-AMT TO PV-ABS-RETAIL-AMT                  28970000
289800        MOVE ASC-HD-GRO-COST TO PV-ABS-GROSS-COST                 28980000
289900        IF PV-ABS-GROSS-COST <= PV-ABS-RETAIL-AMT                 28990000
290000           COMPUTE PV-MARKON-PCT = (PV-ABS-RETAIL-AMT -           29000000
290100                   PV-ABS-GROSS-COST) * 100 / PV-ABS-RETAIL-AMT   29010000
290200           IF PV-MARKON-PCT >= 85.000 OR                          29020000
290300                            <= 15.000                             29030000
290400** WARNING!! CALCULATED MARKON PCNT IS NOT CONSISTENT WITH NORMAL 29040000
290500*            MARKON                                               29050000
290600              IF PS-NO-ERROR                                      29060000
290700                 SET DP020-MSG-WARNING TO TRUE                    29070000
290800                 MOVE PC-TSYMSG-02316 TO DP020-MSG-NUMBER         29080000
290900              END-IF                                              29090000
291000           END-IF                                                 29100000
291100        END-IF                                                    29110000
291200     END-IF.                                                      29120000
291300                                                                  29130000
291400*----------------------------------------------------------------*29140000
291500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *29150000
291600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*29160000
291700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *29170000
291800*                                                                *29180000
291900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *29190000
292000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *29200000
292100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *29210000
292200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *29220000
292300*----------------------------------------------------------------*29230000
292400 3100-SET-SUBSCRIPTS.                                             29240000
292500                                                                  29250000
292600     COMPUTE ASC-ITEM-SUB =                                       29260000
292700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        29270000
292800                                                                  29280000
292900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         29290000
293000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            29300000
293100                                                                  29310000
293200         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               29320000
293300     ELSE                                                         29330000
293400         MOVE +1                     TO ASC-BLK-SUB               29340000
293500     END-IF.                                                      29350000
293600                                                                  29360000
293700******************************************************************29370000
293800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **29380000
293900******************************************************************29390000
294000 3200-RESET-ATTRIBUTES.                                           29400000
294100                                                                  29410000
294200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   29420000
294300     MOVE DP015-GREEN              TO ASTRTITC.                   29430000
294400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   29440000
294500                                                                  29450000
294600     MOVE DP015-UNP-ALP-NOR-OFF    TO AHDNWSTA.                   29460000
294700     MOVE DP015-GREEN              TO AHDNWSTC.                   29470000
294800     MOVE DP015-UNDERLINE          TO AHDNWSTH.                   29480000
294900                                                                  29490000
295000     MOVE DP015-UNP-ALP-NOR-OFF    TO AHDFRGTA.                   29500000
295100     MOVE DP015-GREEN              TO AHDFRGTC.                   29510000
295200     MOVE DP015-UNDERLINE          TO AHDFRGTH.                   29520000
295300                                                                  29530000
295400     MOVE DP015-UNP-ALP-NOR-OFF    TO AHDCSTA.                    29540000
295500     MOVE DP015-GREEN              TO AHDCSTC.                    29550000
295600     MOVE DP015-UNDERLINE          TO AHDCSTH.                    29560000
295700                                                                  29570000
295800     MOVE DP015-UNP-ALP-NOR-OFF    TO AHDRETA.                    29580000
295900     MOVE DP015-GREEN              TO AHDRETC.                    29590000
296000     MOVE DP015-UNDERLINE          TO AHDRETH.                    29600000
296100                                                                  29610000
296200     PERFORM                                                      29620000
296300         VARYING PV-SUB                                           29630000
296400         FROM 1 BY 1                                              29640000
296500         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        29650000
296600         MOVE DP015-UNP-ALP-NOR-OFF                               29660000
296700                                   TO MR-SELECTA (PV-SUB)         29670000
296800                                      MR-STOREA  (PV-SUB)         29680000
296900                                      MR-CLASSA  (PV-SUB)         29690000
297000                                      MR-SKUA    (PV-SUB)         29700000
297100                                      MR-GROSSA  (PV-SUB)         29710000
297200                                      MR-RETAILA (PV-SUB)         29720000
297300         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         29730000
297400                                      MR-STOREC  (PV-SUB)         29740000
297500                                      MR-CLASSC  (PV-SUB)         29750000
297600                                      MR-SKUC    (PV-SUB)         29760000
297700                                      MR-GROSSC  (PV-SUB)         29770000
297800                                      MR-RETAILC (PV-SUB)         29780000
297900         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         29790000
298000                                      MR-STOREH  (PV-SUB)         29800000
298100                                      MR-CLASSH  (PV-SUB)         29810000
298200                                      MR-SKUH    (PV-SUB)         29820000
298300                                      MR-GROSSH  (PV-SUB)         29830000
298400                                      MR-RETAILH (PV-SUB)         29840000
298500     END-PERFORM.                                                 29850000
298600                                                                  29860000
298700** IF IN ADD MODE THEN DO NOT SHOW ITEM COUNT.                    29870000
298800     IF ASC-ACTION-SW = 'ADD'                                     29880000
298900        MOVE DP015-HL-OFF          TO ASTRTITH                    29890000
299000        MOVE DP015-PRO-DRK-MDT     TO LABELA                      29900000
299100                                      LABEL2A                     29910000
299200                                      LABEL3A                     29920000
299300                                      LABEL4A                     29930000
299400                                      ASTRTITA                    29940000
299500        MOVE DP015-PRO-DRK-MDT     TO ATOTITA                     29950000
299600                                      AENDITA                     29960000
299700        PERFORM                                                   29970000
299800            VARYING PV-SUB                                        29980000
299900            FROM 1 BY 1                                           29990000
300000            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     30000000
300100            MOVE DP015-PRO-DRK-MDT TO MR-SELECTA (PV-SUB)         30010000
300200            MOVE DP015-HL-OFF      TO MR-SELECTH (PV-SUB)         30020000
300300        END-PERFORM                                               30030000
300400     END-IF.                                                      30040000
300500                                                                  30050000
300600******************************************************************30060000
300700** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **30070000
300800** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **30080000
300900** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **30090000
301000** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **30100000
301100******************************************************************30110000
301200 3300-EDIT-SELECTIONS.                                            30120000
301300                                                                  30130000
301400     EVALUATE TRUE                                                30140000
301500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     30150000
301600             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         30160000
301700                 CONTINUE                                         30170000
301800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         30180000
301900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        30190000
302000                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   30200000
302100                 MOVE ASC-TEMP-SELECTED-SW                        30210000
302200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30220000
302300                                TO ASC-SELECTED-SW                30230000
302400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30240000
302500             END-IF                                               30250000
302600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     30260000
302700                 = SPACE                                          30270000
302800             EVALUATE TRUE                                        30280000
302900                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       30290000
303000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS30300000
303100                     MOVE SPACE TO ASC-SELECTED-SW                30310000
303200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30320000
303300                 WHEN ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB)       30330000
303400                     SUBTRACT +1 FROM ASC-NUMBER-OF-DELETED-ITEMS 30340000
303500                     MOVE SPACE TO ASC-SELECTED-SW                30350000
303600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30360000
303700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        30370000
303800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    30380000
303900                     MOVE SPACE TO ASC-SELECTED-SW                30390000
304000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30400000
304100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          30410000
304200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      30420000
304300                     MOVE SPACE TO ASC-SELECTED-SW                30430000
304400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30440000
304500             END-EVALUATE                                         30450000
304600         WHEN ASC-TEMP-DELETE  (ASC-BLK-SUB ASC-ITEM-SUB)         30460000
304700             IF  NOT ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB)        30470000
304800                 ADD +1         TO ASC-NUMBER-OF-DELETED-ITEMS    30480000
304900                 MOVE ASC-TEMP-SELECTED-SW                        30490000
305000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30500000
305100                                TO ASC-SELECTED-SW                30510000
305200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30520000
305300             END-IF                                               30530000
305400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     30540000
305500                 = SPACE                                          30550000
305600             IF ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB)             30560000
305700                 SUBTRACT +1 FROM ASC-NUMBER-OF-DELETED-ITEMS     30570000
305800                 MOVE SPACE TO ASC-SELECTED-SW                    30580000
305900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30590000
306000             END-IF                                               30600000
306100         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           30610000
306200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            30620000
306300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    30630000
306400             END-IF                                               30640000
306500             PERFORM 3310-EDIT-RANGE                              30650000
306600         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             30660000
306700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            30670000
306800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    30680000
306900             END-IF                                               30690000
307000             PERFORM 3310-EDIT-RANGE                              30700000
307100         WHEN OTHER                                               30710000
307200             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           30720000
307300             SET DP020-MSG-FATAL    TO TRUE                       30730000
307400             MOVE -1                TO MR-SELECTL (PV-SUB)        30740000
307500             SET DP030-SET-CURSOR-APPL-1                          30750000
307600                                    TO TRUE                       30760000
307700             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        30770000
307800             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        30780000
307900             SET PS-ERROR TO TRUE                                 30790000
308000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            30800000
308100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     30810000
308200                 MOVE SPACE         TO ASC-SELECTED-SW            30820000
308300                                        (ASC-BLK-SUB ASC-ITEM-SUB)30830000
308400             END-IF                                               30840000
308500     END-EVALUATE.                                                30850000
308600                                                                  30860000
308700     IF (ASC-ACTION-SW = 'UPD' OR                                 30870000
308800         ASC-ACTION-SW = 'DEL') AND                               30880000
308900        ASC-LINE-CHANGED (ASC-BLK-SUB ASC-ITEM-SUB) AND           30890000
309000        ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                  30900000
309100        SET DP020-MSG-FATAL  TO TRUE                              30910000
309200        MOVE -1              TO MR-SELECTL (PV-SUB)               30920000
309300        MOVE DP015-RED       TO MR-SELECTC (PV-SUB)               30930000
309400                                MR-STOREC  (PV-SUB)               30940000
309500                                MR-SKUC    (PV-SUB)               30950000
309600                                MR-CLASSC  (PV-SUB)               30960000
309700                                MR-GROSSC  (PV-SUB)               30970000
309800                                MR-RETAILC (PV-SUB)               30980000
309900        MOVE DP015-REVERSE   TO MR-SELECTH (PV-SUB)               30990000
310000                                MR-STOREH  (PV-SUB)               31000000
310100                                MR-SKUH    (PV-SUB)               31010000
310200                                MR-CLASSH  (PV-SUB)               31020000
310300                                MR-GROSSH  (PV-SUB)               31030000
310400                                MR-RETAILH (PV-SUB)               31040000
310500        MOVE DP015-UNP-ALP-BRT-OFF                                31050000
310600                             TO MR-SELECTA (PV-SUB)               31060000
310700                                MR-STOREA  (PV-SUB)               31070000
310800                                MR-SKUA    (PV-SUB)               31080000
310900                                MR-CLASSA  (PV-SUB)               31090000
311000                                MR-GROSSA  (PV-SUB)               31100000
311100                                MR-RETAILA (PV-SUB)               31110000
311200        IF PS-NO-ERROR                                            31120000
311300           MOVE PC-TSYMSG-01933 TO DP020-MSG-NUMBER               31130000
311400        END-IF                                                    31140000
311500        SET PS-ERROR TO TRUE                                      31150000
311600     ELSE                                                         31160000
311700        IF (ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)) OR             31170000
311800           ((ASC-ACTION-SW = 'ADD') AND                           31180000
311900            (ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR 31190000
312000            ASC-CLASS  (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR     31200000
312100            ASC-SKU    (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO   OR     31210000
312200            ASC-GROSS-COST(ASC-BLK-SUB ASC-ITEM-SUB)              31220000
312300                                           NOT EQUAL ZERO  OR     31230000
312400            ASC-RETAIL-AMT(ASC-BLK-SUB ASC-ITEM-SUB)              31240000
312500                                               NOT EQUAL ZERO))   31250000
312600            PERFORM 3600-EDIT-DISTRO-STORE                        31260000
312700            PERFORM 3650-EDIT-DISTRO-CLS-SEQ                      31270000
312800            PERFORM 3700-EDIT-DISTRO-COST                         31280000
312900            PERFORM 3850-CALC-DISTRO-RETAIL                       31290000
313000            PERFORM 3800-EDIT-DISTRO-RETAIL                       31300000
313100        ELSE                                                      31310000
313200           IF ASC-ACTION-SW = 'UPD' OR                            31320000
313300              ASC-ACTION-SW = 'DEL' AND                           31330000
313400              NOT ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB)           31340000
313500              PERFORM 3700-EDIT-DISTRO-COST                       31350000
313600              PERFORM 3850-CALC-DISTRO-RETAIL                     31360000
313700              PERFORM 3800-EDIT-DISTRO-RETAIL                     31370000
313800           END-IF                                                 31380000
313900        END-IF                                                    31390000
314000     END-IF.                                                      31400000
314100                                                                  31410000
314200     IF ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB) AND                 31420000
314300        ASC-ACTION-SW = 'UPD'                                     31430000
314400        MOVE PC-TSYMSG-00005       TO DP020-MSG-NUMBER            31440000
314500        SET DP020-MSG-FATAL        TO TRUE                        31450000
314600        MOVE -1                    TO MR-SELECTL (PV-SUB)         31460000
314700        SET DP030-SET-CURSOR-APPL-1                               31470000
314800                                   TO TRUE                        31480000
314900        MOVE DP015-RED             TO MR-SELECTC (PV-SUB)         31490000
315000        MOVE DP015-REVERSE         TO MR-SELECTH (PV-SUB)         31500000
315100        SET PS-ERROR               TO TRUE                        31510000
315200     END-IF.                                                      31520000
315300                                                                  31530000
315400     SUBTRACT +1             FROM PV-ITEM-IN-USE                  31540000
315500                                  ASC-ITEM-SUB.                   31550000
315600                                                                  31560000
315700     IF  ASC-ITEM-SUB < 1                                         31570000
315800         SUBTRACT +1 FROM ASC-BLK-SUB                             31580000
315900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                31590000
316000     END-IF.                                                      31600000
316100                                                                  31610000
316200******************************************************************31620000
316300* THIS PARAGRAPH WILL CONTROL THE CHECKING FOR DUPLICATE         *31630000
316400* DISTRIBUTION LINES.                                            *31640000
316500******************************************************************31650000
316600 3303-CHECK-FOR-DUPS.                                             31660000
316700                                                                  31670000
316800     MOVE +1         TO PV-DUP-COUNT                              31680000
316900                        PV-SUB.                                   31690000
317000     MOVE LOW-VALUES TO PV-CLASS-TABLE.                           31700000
317100                                                                  31710000
317200     PERFORM 3304-CHECK-LINES-FOR-DUPS.                           31720000
317300                                                                  31730000
317400******************************************************************31740000
317500* THIS PARAGRAPH WILL EXAMINE THE INDIVIDUAL LINES OF            *31750000
317600* DISTRIBUTION TO DETERMINE IF ANY ARE DUPLICATES OF THE OTHERS. *31760000
317700******************************************************************31770000
317800 3304-CHECK-LINES-FOR-DUPS.                                       31780000
317900                                                                  31790000
318000     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              31800000
318100                                 TO PV-LIST-ITEM-NUMBER.          31810000
318200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            31820000
318300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    31830000
318400                                                                  31840000
318500     MOVE +1                     TO ASC-BLK-SUB.                  31850000
318600                                                                  31860000
318700     PERFORM                                                      31870000
318800         VARYING PV-BLOCK-NUMBER                                  31880000
318900         FROM 1 BY 1                                              31890000
319000         UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN        31900000
319100                                                                  31910000
319200         PERFORM 4410-READ-TEMP-STORAGE                           31920000
319300                                                                  31930000
319400         PERFORM                                                  31940000
319500             VARYING ASC-ITEM-SUB                                 31950000
319600             FROM 1 BY 1                                          31960000
319700             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              31970000
319800                                                                  31980000
319900             IF (ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES31990000
320000                OR                                                32000000
320100                ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR  32010000
320200                ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO  )      32020000
320300                IF PV-DUP-COUNT > 1                               32030000
320400                   IF PV-SUB = +12                                32040000
320500                      MOVE +1 TO PV-SUB                           32050000
320600                   END-IF                                         32060000
320700                   PERFORM 4250-CHECK-FOR-DUP-STR-CLS-SEQ         32070000
320800                END-IF                                            32080000
320900                MOVE ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) TO  32090000
321000                                   PV-STORE-ENTRY (PV-DUP-COUNT)  32100000
321100                MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) TO      32110000
321200                                   PV-CLASS-ENTRY (PV-DUP-COUNT)  32120000
321300                MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) TO        32130000
321400                                   PV-SKU-ENTRY (PV-DUP-COUNT)    32140000
321500                ADD +1 TO PV-DUP-COUNT                            32150000
321600                          PV-SUB                                  32160000
321700             END-IF                                               32170000
321800         END-PERFORM                                              32180000
321900                                                                  32190000
322000     END-PERFORM.                                                 32200000
322100                                                                  32210000
322200     MOVE +1                        TO ASC-BLK-SUB.               32220000
322300     MOVE PV-FIRST-BLOCK-IN-ARRAY   TO PV-BLOCK-NUMBER.           32230000
322400                                                                  32240000
322500     PERFORM 4410-READ-TEMP-STORAGE.                              32250000
322600                                                                  32260000
322700     ADD +1                         TO PV-BLOCK-NUMBER            32270000
322800                                       ASC-BLK-SUB.               32280000
322900     PERFORM 4410-READ-TEMP-STORAGE.                              32290000
323000                                                                  32300000
323100******************************************************************32310000
323200* THIS PARAGRAPH PERFORMS COMMON DATE EDITS.                     *32320000
323300******************************************************************32330000
323400 3309-EDIT-DATE.                                                  32340000
323500                                                                  32350000
323600     IF PV-MM NUMERIC                                             32360000
323700     OR PV-MM = SPACE                                             32370000
323800         CONTINUE                                                 32380000
323900     ELSE                                                         32390000
324000         MOVE PV-MM                  TO DP010I-UNEDITED-FIELD     32400000
324100         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     32410000
324200         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   32420000
324300         SET DP010I-NEGATIVE-NOT-ALLOWED                          32430000
324400                                     TO TRUE                      32440000
324510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         32451001
324520                         USING DP010I-NUMERIC-EDIT-AREA           32452001
324600         IF DP010I-ERROR-DETECTED                                 32460000
324700             CONTINUE                                             32470000
324800         ELSE                                                     32480000
324900             MOVE DP010I-NUMERIC-FIELD                            32490000
325000                                     TO PV-MM-9                   32500000
325100         END-IF                                                   32510000
325200     END-IF.                                                      32520000
325300                                                                  32530000
325400     IF PV-DD NUMERIC                                             32540000
325500     OR PV-DD = SPACE                                             32550000
325600         CONTINUE                                                 32560000
325700     ELSE                                                         32570000
325800         MOVE PV-DD                  TO DP010I-UNEDITED-FIELD     32580000
325900         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     32590000
326000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   32600000
326100         SET DP010I-NEGATIVE-NOT-ALLOWED                          32610000
326200                                     TO TRUE                      32620000
326310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         32631001
326320                         USING DP010I-NUMERIC-EDIT-AREA           32632001
326400         IF DP010I-ERROR-DETECTED                                 32640000
326500             CONTINUE                                             32650000
326600         ELSE                                                     32660000
326700             MOVE DP010I-NUMERIC-FIELD                            32670000
326800                                     TO PV-DD-9                   32680000
326900         END-IF                                                   32690000
327000     END-IF.                                                      32700000
327100                                                                  32710000
327200     IF PV-CCYY = SPACE                                           32720000
327300         CONTINUE                                                 32730000
327400     ELSE                                                         32740000
327500         IF PV-CCYY NUMERIC                                       32750000
327600             IF PV-YY < 80                                        32760000
327700                 MOVE 20             TO PV-CC                     32770000
327800             ELSE                                                 32780000
327900                 MOVE 19             TO PV-CC                     32790000
328000             END-IF                                               32800000
328100         ELSE                                                     32810000
328200             MOVE PV-CCYY            TO DP010I-UNEDITED-FIELD     32820000
328300             MOVE 4                  TO DP010I-MAXIMUM-DIGITS     32830000
328400             MOVE 0                  TO DP010I-MAXIMUM-DECIMALS   32840000
328500             SET DP010I-NEGATIVE-NOT-ALLOWED                      32850000
328600                                         TO TRUE                  32860000
328710             CALL DP010I-NUMERIC-EDIT-ROUTINE                     32871001
328720                         USING DP010I-NUMERIC-EDIT-AREA           32872001
328800             IF DP010I-ERROR-DETECTED                             32880000
328900                 CONTINUE                                         32890000
329000             ELSE                                                 32900000
329100                 MOVE DP010I-NUMERIC-FIELD                        32910000
329200                                         TO PV-CCYY-9             32920000
329300*         ALLOW THEM TO ENTER A TWO DIGIT YEAR W/OUT CENT         32930000
329400                 IF PV-YY < 80                                    32940000
329500                     MOVE 20             TO PV-CC                 32950000
329600                 ELSE                                             32960000
329700                     IF PV-CCYY-9 > 1999                          32970000
329800                         CONTINUE                                 32980000
329900                     ELSE                                         32990000
330000                         MOVE 19         TO PV-CC                 33000000
330100                     END-IF                                       33010000
330200                 END-IF                                           33020000
330300             END-IF                                               33030000
330400         END-IF                                                   33040000
330500     END-IF.                                                      33050000
330600                                                                  33060000
330700     SET PS-VALID-DATE TO TRUE.                                   33070000
330800                                                                  33080000
330900     INITIALIZE DPG51                                             33090000
331000                DPG52                                             33100000
331100                DPG53                                             33110000
331200                DPG54                                             33120000
331300                DPG55                                             33130000
331400                DPG56.                                            33140000
331500                                                                  33150000
331600*    MOVE 'F2'                 TO DPG51-CALENDAR-TYPE.            33160000
331700     SET DPG51-FISCAL-454-CALENDAR TO TRUE.                       33170000
331800                                                                  33180000
331900     SET DPG51-DO-NOT-INCR-DECR-DATE                              33190000
332000         DPG52-LK-DTE-ISO-FMT  TO TRUE.                           33200000
332100                                                                  33210000
332200     IF PV-CCYY NUMERIC AND                                       33220000
332300        PV-MM NUMERIC AND                                         33230000
332400        PV-DD NUMERIC                                             33240000
332500         MOVE '-'  TO PV-DASH1                                    33250000
332600                          PV-DASH2                                33260000
332700         MOVE PV-CCYYMMDD-DATE TO DPG52-LK-DATE-INPUT             33270000
332800                                                                  33280000
332900         CALL DP500-KOHLS-CALENDAR-ROUTINE                        33290000
333000             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            33300000
333100                                                                  33310000
333200         IF (DPG54-WARNING-ERROR OR                               33320000
333300             DPG54-SEVERE-ERROR)                                  33330000
333400             SET PS-INVALID-DATE TO TRUE                          33340000
333500         END-IF                                                   33350000
333600     ELSE                                                         33360000
333700         SET PS-INVALID-DATE TO TRUE                              33370000
333800     END-IF.                                                      33380000
333900                                                                  33390000
334000******************************************************************33400000
334100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **33410000
334200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **33420000
334300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**33430000
334400** THE ENDING.                                                  **33440000
334500******************************************************************33450000
334600 3310-EDIT-RANGE.                                                 33460000
334700                                                                  33470000
334800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                33480000
334900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   33490000
335000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)33500000
335100                                   TO ASC-SELECTED-SW             33510000
335200                                        (ASC-BLK-SUB ASC-ITEM-SUB)33520000
335300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 33530000
335400         ELSE                                                     33540000
335500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     33550000
335600                 CONTINUE                                         33560000
335700             ELSE                                                 33570000
335800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        33580000
335900                 MOVE PC-TSYMSG-00054                             33590000
336000                                   TO DP020-MSG-NUMBER            33600000
336100                 SET DP020-MSG-FATAL                              33610000
336200                                   TO TRUE                        33620000
336300                 MOVE -1           TO MR-SELECTL (PV-SUB)         33630000
336400                 SET DP030-SET-CURSOR-APPL-1                      33640000
336500                                   TO TRUE                        33650000
336600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         33660000
336700                 MOVE DP015-UNDERLINE                             33670000
336800                                   TO MR-SELECTH (PV-SUB)         33680000
336900                 SET PS-ERROR      TO TRUE                        33690000
337000             END-IF                                               33700000
337100         END-IF                                                   33710000
337200     ELSE                                                         33720000
337300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     33730000
337400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33740000
337500                                   TO ASC-SELECTED-SW             33750000
337600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   33760000
337700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   33770000
337800         ELSE                                                     33780000
337900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       33790000
338000                 CONTINUE                                         33800000
338100             ELSE                                                 33810000
338200*                -- ONLY ONE END-OF-RANGE ALLOWED --              33820000
338300                 MOVE PC-TSYMSG-00055                             33830000
338400                                   TO DP020-MSG-NUMBER            33840000
338500                 SET DP020-MSG-FATAL                              33850000
338600                                   TO TRUE                        33860000
338700                 MOVE -1           TO MR-SELECTL (PV-SUB)         33870000
338800                 SET DP030-SET-CURSOR-APPL-1                      33880000
338900                                   TO TRUE                        33890000
339000                 SET PS-ERROR      TO TRUE                        33900000
339100             END-IF                                               33910000
339200         END-IF                                                   33920000
339300     END-IF.                                                      33930000
339400                                                                  33940000
339500******************************************************************33950000
339600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **33960000
339700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **33970000
339800******************************************************************33980000
339900 3400-CHECK-RANGE-SEQUENCE.                                       33990000
340000                                                                  34000000
340100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34010000
340200       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      34020000
340300       AND  ASC-START-OF-SELECTED-RANGE >                         34030000
340400                                         ASC-END-OF-SELECTED-RANGE34040000
340500*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                34050000
340600         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 34060000
340700         SET DP020-MSG-FATAL TO TRUE                              34070000
340800         SET PS-ERROR TO TRUE                                     34080000
340900         PERFORM 3410-POSITION-AT-ERROR                           34090000
341000     END-IF.                                                      34100000
341100                                                                  34110000
341200******************************************************************34120000
341300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **34130000
341400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **34140000
341500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **34150000
341600******************************************************************34160000
341700 3410-POSITION-AT-ERROR.                                          34170000
341800                                                                  34180000
341900     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       34190000
342000                                                                  34200000
342100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34210000
342200                    - PV-TOP-ITEM + 1.                            34220000
342300                                                                  34230000
342400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34240000
342500         CONTINUE                                                 34250000
342600     ELSE                                                         34260000
342700         MOVE -1                   TO MR-SELECTL (PV-SUB)         34270000
342800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34280000
342900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         34290000
343000     END-IF.                                                      34300000
343100                                                                  34310000
343200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34320000
343300                    - PV-TOP-ITEM + 1.                            34330000
343400                                                                  34340000
343500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34350000
343600         CONTINUE                                                 34360000
343700     ELSE                                                         34370000
343800         MOVE -1                   TO MR-SELECTL (PV-SUB)         34380000
343900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34390000
344000         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         34400000
344100     END-IF.                                                      34410000
344200 EJECT                                                            34420000
344300*----------------------------------------------------------------*34430000
344400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *34440000
344500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *34450000
344600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *34460000
344700*----------------------------------------------------------------*34470000
344800 3500-MARK-RANGE-AS-SELECTED.                                     34480000
344900                                                                  34490000
345000     MOVE +1                       TO  ASC-BLK-SUB.               34500000
345100                                                                  34510000
345200     PERFORM 3510-MARK-SELECTED-INDS                              34520000
345300         VARYING ASC-ITEM-SUB                                     34530000
345400         FROM 1 BY 1                                              34540000
345500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 34550000
345600                                                                  34560000
345700     ADD +1                        TO ASC-BLK-SUB.                34570000
345800                                                                  34580000
345900     PERFORM 3510-MARK-SELECTED-INDS                              34590000
346000         VARYING ASC-ITEM-SUB                                     34600000
346100         FROM 1 BY 1                                              34610000
346200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 34620000
346300                                                                  34630000
346400     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO  PV-LIST-ITEM-NUMBER.      34640000
346500                                                                  34650000
346600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            34660000
346700         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         34670000
346800               PC-ITEMS-PER-PANEL).                               34680000
346900                                                                  34690000
347000     MOVE ASC-START-OF-SELECTED-RANGE                             34700000
347100                                   TO PV-START-OF-SELECTED-RANGE. 34710000
347200                                                                  34720000
347300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            34730000
347400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  34740000
347500               PC-ITEMS-PER-PANEL).                               34750000
347600                                                                  34760000
347700     MOVE ASC-END-OF-SELECTED-RANGE                               34770000
347800                                   TO  PV-END-OF-SELECTED-RANGE.  34780000
347900                                                                  34790000
348000     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             34800000
348100         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    34810000
348200               PC-ITEMS-PER-PANEL).                               34820000
348300                                                                  34830000
348400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             34840000
348500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             34850000
348600                                                                  34860000
348700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    34870000
348800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        34880000
348900         MOVE +1                   TO ASC-BLK-SUB                 34890000
349000         PERFORM 5100-WRITE-TEMP-STORAGE                          34900000
349100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         34910000
349200             PV-FIRST-BLOCK-IN-ARRAY - 1                          34920000
349300                                                                  34930000
349400         PERFORM                                                  34940000
349500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      34950000
349600                   PV-PREV-BLOCK-IN-ARRAY                         34960000
349700             MOVE PV-FIRST-BLOCK-IN-RANGE                         34970000
349800                                   TO PV-BLOCK-NUMBER             34980000
349900             PERFORM 4410-READ-TEMP-STORAGE                       34990000
350000             PERFORM 3510-MARK-SELECTED-INDS                      35000000
350100                 VARYING ASC-ITEM-SUB                             35010000
350200                 FROM 1 BY 1                                      35020000
350300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          35030000
350400             PERFORM 5100-WRITE-TEMP-STORAGE                      35040000
350500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     35050000
350600         END-PERFORM                                              35060000
350700                                                                  35070000
350800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         35080000
350900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     35090000
351000         PERFORM                                                  35100000
351100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       35110000
351200                   PV-LAST-BLOCK-IN-RANGE                         35120000
351300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          35130000
351400                                   TO PV-BLOCK-NUMBER             35140000
351500             PERFORM 4410-READ-TEMP-STORAGE                       35150000
351600             PERFORM 3510-MARK-SELECTED-INDS                      35160000
351700                 VARYING ASC-ITEM-SUB                             35170000
351800                 FROM 1 BY 1                                      35180000
351900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          35190000
352000             PERFORM 5100-WRITE-TEMP-STORAGE                      35200000
352100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      35210000
352200         END-PERFORM                                              35220000
352300                                                                  35230000
352400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             35240000
352500                                   TO PV-BLOCK-NUMBER             35250000
352600         PERFORM 4410-READ-TEMP-STORAGE                           35260000
352700     END-IF.                                                      35270000
352800                                                                  35280000
352900     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE   35290000
353000                                    ASC-END-OF-SELECTED-RANGE.    35300000
353100                                                                  35310000
353200 EJECT                                                            35320000
353300*----------------------------------------------------------------*35330000
353400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *35340000
353500*----------------------------------------------------------------*35350000
353600 3510-MARK-SELECTED-INDS.                                         35360000
353700                                                                  35370000
353800     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         35380000
353900                                ASC-ITEM-SUB) >                   35390000
354000         ASC-START-OF-SELECTED-RANGE)                             35400000
354100     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         35410000
354200                                ASC-ITEM-SUB) =                   35420000
354300         ASC-START-OF-SELECTED-RANGE)                             35430000
354400                                                                  35440000
354500         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     35450000
354600                                    ASC-ITEM-SUB) <               35460000
354700             ASC-END-OF-SELECTED-RANGE)                           35470000
354800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     35480000
354900                                    ASC-ITEM-SUB) =               35490000
355000             ASC-END-OF-SELECTED-RANGE)                           35500000
355100                                                                  35510000
355200             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          35520000
355300                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   35530000
355400                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   35540000
355500                               TO TRUE                            35550000
355600                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              35560000
355700                               TO TRUE                            35570000
355800                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    35580000
355900             END-IF                                               35590000
356000         END-IF                                                   35600000
356100     END-IF.                                                      35610000
356200                                                                  35620000
356300 EJECT                                                            35630000
356400******************************************************************35640000
356500* THIS PARAGRAPH WILL PERFORM EDITS ON THE STORE ENTRIES IN THE  *35650000
356600* DISTRIBUTION PORTION OF THE SCREEN.                            *35660000
356700******************************************************************35670000
356800 3600-EDIT-DISTRO-STORE.                                          35680000
356900                                                                  35690000
357000     IF ASC-HD-STORE = ZERO                                       35700000
357100        IF ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES      35710000
357200           SET DP020-MSG-FATAL     TO TRUE                        35720000
357300           MOVE DP015-UNP-ALP-BRT-OFF                             35730000
357400                                   TO MR-STOREA (PV-SUB)          35740000
357500           MOVE DP015-REVERSE      TO MR-STOREH (PV-SUB)          35750000
357600           MOVE DP015-RED          TO MR-STOREC (PV-SUB)          35760000
357700           MOVE -1                 TO MR-STOREL (PV-SUB)          35770000
357800           IF PS-NO-ERROR                                         35780000
357900              MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER            35790000
358000           END-IF                                                 35800000
358100           SET PS-ERROR            TO TRUE                        35810000
358200        END-IF                                                    35820000
358300     END-IF.                                                      35830000
358400                                                                  35840000
358500* MB IF ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) NOT NUMERIC AND  35850000
358600* MB    ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES         35860000
358700* MB    SET DP020-MSG-FATAL        TO TRUE                        35870000
358800* MB    MOVE DP015-UNP-ALP-BRT-OFF TO MR-STOREA (PV-SUB)          35880000
358900* MB    MOVE DP015-REVERSE         TO MR-STOREH (PV-SUB)          35890000
359000* MB    MOVE DP015-RED             TO MR-STOREC (PV-SUB)          35900000
359100* MB    MOVE -1                    TO MR-STOREL (PV-SUB)          35910000
359200* MB    IF PS-NO-ERROR                                            35920000
359300* MB       MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER            35930000
359400* MB    END-IF                                                    35940000
359500* MB    SET PS-ERROR               TO TRUE                        35950000
359600* MB END-IF.                                                      35960000
359700                                                                  35970000
359800     SET ASC-STORE-NOT-FOUND TO TRUE.                             35980000
359900                                                                  35990000
360000     IF ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES         36000000
360100        MOVE ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB)             36010000
360200                                   TO DP010I-UNEDITED-FIELD       36020000
360300        MOVE 4                     TO DP010I-MAXIMUM-DIGITS       36030000
360400        MOVE 0                     TO DP010I-MAXIMUM-DECIMALS     36040000
360500        SET DP010I-NEGATIVE-NOT-ALLOWED                           36050000
360600                                   TO TRUE                        36060000
360710        CALL DP010I-NUMERIC-EDIT-ROUTINE                          36071001
360720                         USING DP010I-NUMERIC-EDIT-AREA           36072001
360800        IF DP010I-ERROR-DETECTED                                  36080000
360900           SET DP020-MSG-FATAL TO TRUE                            36090000
361000           MOVE DP015-UNP-ALP-BRT-OFF                             36100000
361100                                   TO MR-STOREA (PV-SUB)          36110000
361200           MOVE DP015-RED          TO MR-STOREC (PV-SUB)          36120000
361300           MOVE DP015-REVERSE      TO MR-STOREH (PV-SUB)          36130000
361400           MOVE -1                 TO MR-STOREL (PV-SUB)          36140000
361500           IF PS-NO-ERROR                                         36150000
361600              MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER            36160000
361700           END-IF                                                 36170000
361800           SET PS-ERROR TO TRUE                                   36180000
361900        ELSE                                                      36190000
362000           INITIALIZE PV-STORE-NBR-4                              36200000
362100           MOVE DP010I-NUMERIC-FIELD   TO ASC-STORE               36210000
362200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36220000
362300                                          PV-STORE-NBR-4          36230000
362400           MOVE PV-STORE-NBR-4 TO XFT00017-LOC-NBR                36240000
362500*MAB 07-22-99 BEGIN                                               36250000
362600           IF ASC-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > 9998 OR      36260000
362700              ASC-STORE (ASC-BLK-SUB ASC-ITEM-SUB) = 80           36270000
362800              SET ASC-STORE-NOT-FOUND TO TRUE                     36280000
362900           ELSE                                                   36290000
363000*MAB 07-22-99 END                                                 36300000
363100              PERFORM 7400-VALIDATE-STORE                         36310000
363200           END-IF                                                 36320000
363300** STORE IN HEADER IS GREATER THAN ZERO AND DOES NOT EQUAL THE    36330000
363400** STORE IN THE DISTRIBUTION PORTION OF THE SCREEN.               36340000
363500           IF ASC-HD-STORE GREATER THAN ZERO AND                  36350000
363600              (ASC-HD-STORE NOT EQUAL TO ASC-STORE                36360000
363700                                     (ASC-BLK-SUB ASC-ITEM-SUB))  36370000
363800              MOVE DP015-UNP-ALP-BRT-OFF                          36380000
363900                                      TO MR-STOREA (PV-SUB)       36390000
364000              MOVE DP015-RED          TO MR-STOREC (PV-SUB)       36400000
364100              MOVE DP015-REVERSE      TO MR-STOREH (PV-SUB)       36410000
364200              MOVE -1                 TO MR-STOREL (PV-SUB)       36420000
364300              IF PS-NO-ERROR                                      36430000
364400                 MOVE PC-TSYMSG-01920 TO DP020-MSG-NUMBER         36440000
364500              END-IF                                              36450000
364600              SET PS-ERROR            TO TRUE                     36460000
364700           END-IF                                                 36470000
364800           IF ASC-STORE-NOT-FOUND                                 36480000
364900              MOVE DP015-UNP-ALP-BRT-OFF                          36490000
365000                                      TO MR-STOREA (PV-SUB)       36500000
365100              MOVE DP015-RED          TO MR-STOREC (PV-SUB)       36510000
365200              MOVE DP015-REVERSE      TO MR-STOREH (PV-SUB)       36520000
365300              MOVE -1                 TO MR-STOREL (PV-SUB)       36530000
365400              IF PS-NO-ERROR                                      36540000
365500                 MOVE PC-TSYMSG-01904 TO DP020-MSG-NUMBER         36550000
365600              END-IF                                              36560000
365700              SET PS-ERROR            TO TRUE                     36570000
365800           END-IF                                                 36580000
365900        END-IF                                                    36590000
366000     ELSE                                                         36600000
366100        IF ASC-HD-STORE > ZERO                                    36610000
366200           MOVE ASC-HD-STORE TO ASC-STORE                         36620000
366300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    36630000
366400                                ASC-ALP-STORE                     36640000
366500                                    (ASC-BLK-SUB ASC-ITEM-SUB)    36650000
366600        END-IF                                                    36660000
366700     END-IF.                                                      36670000
366800                                                                  36680000
366900******************************************************************36690000
367000* THIS PARAGRAPH WILL PERFORM EDITS ON THE DISTRIBUTION CLASS    *36700000
367100* AND SEQUENCE FIELDS.                                           *36710000
367200******************************************************************36720000
367300 3650-EDIT-DISTRO-CLS-SEQ.                                        36730000
367400                                                                  36740000
367500     IF ASC-TRN-TYP-CDE = 'MDS'                                   36750000
367600        IF ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) = ZERO              36760000
367700           IF ASC-SKU-SEQ-REQR-IND = 'Y' OR                       36770000
367800              ASC-SKU-ENTERED                                     36780000
367900              SET DP020-MSG-FATAL     TO TRUE                     36790000
368000              MOVE DP015-UNP-ALP-BRT-OFF TO MR-SKUA  (PV-SUB)     36800000
368100              MOVE DP015-RED             TO MR-SKUC  (PV-SUB)     36810000
368200              MOVE DP015-REVERSE         TO MR-SKUH  (PV-SUB)     36820000
368300              MOVE -1                    TO MR-SKUL  (PV-SUB)     36830000
368400              IF PS-NO-ERROR                                      36840000
368500                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         36850000
368600              END-IF                                              36860000
368700              SET PS-ERROR            TO TRUE                     36870000
368800           ELSE                                                   36880000
368900              IF ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES    36890000
369000                 SET DP020-MSG-FATAL TO TRUE                      36900000
369100                 MOVE DP015-UNP-ALP-BRT-OFF TO MR-CLASSA (PV-SUB) 36910000
369200                 MOVE DP015-RED             TO MR-CLASSC (PV-SUB) 36920000
369300                 MOVE DP015-REVERSE         TO MR-CLASSH (PV-SUB) 36930000
369400                 MOVE -1                    TO MR-CLASSL (PV-SUB) 36940000
369500                 IF PS-NO-ERROR                                   36950000
369600                   MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER       36960000
369700                 END-IF                                           36970000
369800                 SET PS-ERROR     TO TRUE                         36980000
369900              ELSE                                                36990000
370000**SUB-CLASS IS REQUIRED FOR THIS TRANSACTION                      37000000
370100**A ZERO MUST BE STRUNG IN FRONT OF CLASS FOR VALIDATION          37010000
370200                 MOVE ASC-DEPT TO MDSEAR-DEPT-NBR                 37020000
370300                 SET ASC-CLASS-NOT-FOUND TO TRUE                  37030000
370400                 IF ASC-SUB-CL-REQR-IND = 'Y'                     37040000
370500**USER ENTERED A SPACE IN  FIRST BYTE OF DISTRO CLASS, MUST       37050000
370600**STRING A ZERO IN FRONT OF MAJOR CLASS                           37060000
370700                    STRING                                        37070000
370800                      '0',                                        37080000
370900                      ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)        37090000
371000                      DELIMITED BY SIZE                           37100000
371100                      INTO MDSEAR-SUB-CL-NBR                      37110000
371200                    END-STRING                                    37120000
371300                    PERFORM 7600-VALIDATE-SUB-CLASS               37130000
371400                 ELSE                                             37140000
371500**SUB-CLASS IS NOT REQUIRED, SO USER MAY HAVE ENTERED MAJOR CLASS.37150000
371600**VALIDATE FOR MAJOR CLASS.                                       37160000
371700                    MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)     37170000
371800                                       TO MDSEAR-MAJ-CL-NBR       37180000
371900                    PERFORM 7700-VALIDATE-MAJ-CLASS               37190000
372000                 END-IF                                           37200000
372100                 IF ASC-CLASS-NOT-FOUND                           37210000
372200                    SET DP020-MSG-FATAL TO TRUE                   37220000
372300                    MOVE DP015-UNP-ALP-BRT-OFF                    37230000
372400                                            TO MR-CLASSA (PV-SUB) 37240000
372500                    MOVE DP015-RED          TO MR-CLASSC (PV-SUB) 37250000
372600                    MOVE DP015-REVERSE      TO MR-CLASSH (PV-SUB) 37260000
372700                    MOVE -1                 TO MR-CLASSL (PV-SUB) 37270000
372800                    IF PS-NO-ERROR                                37280000
372900                       MOVE PC-TSYMSG-01921 TO DP020-MSG-NUMBER   37290000
373000                    END-IF                                        37300000
373100                    SET PS-ERROR TO TRUE                          37310000
373200                 END-IF                                           37320000
373300              END-IF                                              37330000
373400           END-IF                                                 37340000
373500        ELSE                                                      37350000
373600**DISTRO SEQUENCE IS ENTERED, VALIDATE THE DEPARTMENT, CLASS,     37360000
373700**AND SKU COMBINATION AGAINST THE TSKXREF DB2 TABLE.              37370000
373800           IF ASC-SKU-NOT-ENTERED                                 37380000
373900              SET DP020-MSG-FATAL        TO TRUE                  37390000
374000              MOVE DP015-UNP-ALP-BRT-OFF TO MR-SKUA  (PV-SUB)     37400000
374100              MOVE DP015-RED             TO MR-SKUC  (PV-SUB)     37410000
374200              MOVE DP015-REVERSE         TO MR-SKUH  (PV-SUB)     37420000
374300              MOVE -1                    TO MR-SKUL  (PV-SUB)     37430000
374400              IF PS-NO-ERROR                                      37440000
374500                 MOVE PC-TSYMSG-01934    TO DP020-MSG-NUMBER      37450000
374600              END-IF                                              37460000
374700              SET PS-ERROR               TO TRUE                  37470000
374800           ELSE                                                   37480000
374900              MOVE ZERO             TO PV-CLASS                   37490000
375000              IF ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) NOT = SPACE 37500000
375100                 MOVE ASC-CLASS-9 (ASC-BLK-SUB ASC-ITEM-SUB)      37510000
375200                                    TO PV-CLASS                   37520000
375300              END-IF                                              37530000
375400              MOVE PV-CLASS         TO SKXREF-SUBCLASS            37540000
375500              MOVE ZERO             TO PV-DEPARTMENT              37550000
375600              IF ASC-DEPT NOT = SPACE                             37560000
375700                 MOVE ASC-DEPT-9    TO PV-DEPARTMENT              37570000
375800              END-IF                                              37580000
375900              MOVE PV-DEPARTMENT    TO SKXREF-DEPT                37590000
376000              MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)             37600000
376100                                    TO SKXREF-SKU                 37610000
376200              SET ASC-SKU-NOT-FOUND TO TRUE                       37620000
376300              PERFORM 7800-VALIDATE-SKU                           37630000
376400**SKU COMBINATION WAS NOT VALID ON TSKXREF DB2 TABLE.             37640000
376500              IF ASC-SKU-NOT-FOUND                                37650000
376600                 SET DP020-MSG-FATAL TO TRUE                      37660000
376700                 MOVE DP015-UNP-ALP-BRT-OFF                       37670000
376800                                     TO MR-CLASSA (PV-SUB)        37680000
376900                                        MR-SKUA (PV-SUB)          37690000
377000                 MOVE DP015-RED   TO MR-CLASSC (PV-SUB)           37700000
377100                                        MR-SKUC (PV-SUB)          37710000
377200                 MOVE DP015-REVERSE TO MR-CLASSH (PV-SUB)         37720000
377300                                        MR-SKUH (PV-SUB)          37730000
377400                 MOVE -1          TO MR-CLASSL (PV-SUB)           37740000
377500                                        MR-SKUL (PV-SUB)          37750000
377600                 IF PS-NO-ERROR                                   37760000
377700                    MOVE PC-TSYMSG-01922 TO DP020-MSG-NUMBER      37770000
377800                 END-IF                                           37780000
377900                 SET PS-ERROR          TO TRUE                    37790000
378000              END-IF                                              37800000
378100           END-IF                                                 37810000
378200        END-IF                                                    37820000
378300     ELSE                                                         37830000
378400        IF ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES          37840000
378500           SET DP020-MSG-FATAL         TO TRUE                    37850000
378600           MOVE DP015-UNP-ALP-BRT-OFF  TO MR-CLASSA (PV-SUB)      37860000
378700           MOVE DP015-RED              TO MR-CLASSC (PV-SUB)      37870000
378800           MOVE DP015-REVERSE          TO MR-CLASSH (PV-SUB)      37880000
378900           MOVE -1                     TO MR-CLASSL (PV-SUB)      37890000
379000           IF PS-NO-ERROR                                         37900000
379100              MOVE PC-TSYMSG-01923     TO DP020-MSG-NUMBER        37910000
379200           END-IF                                                 37920000
379300           SET PS-ERROR                TO TRUE                    37930000
379400        END-IF                                                    37940000
379500        IF ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO              37950000
379600           SET DP020-MSG-FATAL         TO TRUE                    37960000
379700           MOVE DP015-UNP-ALP-BRT-OFF  TO MR-SKUA   (PV-SUB)      37970000
379800           MOVE DP015-RED              TO MR-SKUC   (PV-SUB)      37980000
379900           MOVE DP015-REVERSE          TO MR-SKUH   (PV-SUB)      37990000
380000           MOVE -1                     TO MR-SKUL   (PV-SUB)      38000000
380100           IF PS-NO-ERROR                                         38010000
380200              MOVE PC-TSYMSG-01924     TO DP020-MSG-NUMBER        38020000
380300           END-IF                                                 38030000
380400           SET PS-ERROR                TO TRUE                    38040000
380500        END-IF                                                    38050000
380600     END-IF.                                                      38060000
380700                                                                  38070000
380800******************************************************************38080000
380900* THIS PARAGRAPH WILL PERFORM EDITS ON THE DISTRIBUTION GROSS    *38090000
381000* COST FIELD.                                                    *38100000
381100******************************************************************38110000
381200 3700-EDIT-DISTRO-COST.                                           38120000
381300                                                                  38130000
381400     IF ASC-HD-GRO-COST NOT EQUAL ZERO                            38140000
381500     OR ASC-FREIGHT-COST-ALLOCATION                               38150000
381600     OR ASC-NEW-STR-COST-ALLOCATION                               38160000
381700        IF ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB) = 0          38170000
381800*** COST DISTRO REQD WHEN HDR COST KEYED OR FREIGHT OR NEWSTR ONLY38180000
381900           SET DP020-MSG-FATAL               TO TRUE              38190000
382000           MOVE DP015-UNP-ALP-BRT-OFF        TO MR-GROSSA (PV-SUB)38200000
382100           MOVE DP015-RED                    TO MR-GROSSC (PV-SUB)38210000
382200           MOVE DP015-REVERSE                TO MR-GROSSH (PV-SUB)38220000
382300           MOVE -1                           TO MR-GROSSL (PV-SUB)38230000
382400           IF PS-NO-ERROR                                         38240000
382500              MOVE PC-TSYMSG-00007           TO DP020-MSG-NUMBER  38250000
382600           END-IF                                                 38260000
382700           SET PS-ERROR                      TO TRUE              38270000
382800        END-IF                                                    38280000
382900     ELSE                                                         38290000
383000       IF ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB) NOT EQUAL ZERO38300000
383100*** COST DISTRO NOT ALLOWED WHEN HEADER COST,FREIGHT & NEWSTR ZERO38310000
383200          SET DP020-MSG-FATAL               TO TRUE               38320000
383300          MOVE DP015-UNP-ALP-BRT-OFF        TO MR-GROSSA (PV-SUB) 38330000
383400          MOVE DP015-RED                    TO MR-GROSSC (PV-SUB) 38340000
383500          MOVE DP015-REVERSE                TO MR-GROSSH (PV-SUB) 38350000
383600          MOVE -1                           TO MR-GROSSL (PV-SUB) 38360000
383700          IF PS-NO-ERROR                                          38370000
383800             MOVE PC-TSYMSG-01935           TO DP020-MSG-NUMBER   38380000
383900          END-IF                                                  38390000
384000          SET PS-ERROR                      TO TRUE               38400000
384100       END-IF                                                     38410000
384200     END-IF.                                                      38420000
384300                                                                  38430000
384400*    IF  ASC-NEW-STR-COST-ALLOCATION                              38440000
384500*        IF  ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB) > 0        38450000
384600*        AND ASC-PSTG-TYP-CDE = 'CH'                              38460000
384700*** THE SIGN ON THE DISTRO COST FOR NEW STORE ONLY MUST BE        38470000
384800*** OPPOSITE WHAT IT WOULD NORMALLY BE FOR THAT POSTING TYPE      38480000
384900*           SET DP020-MSG-FATAL         TO TRUE                   38490000
385000*           MOVE DP015-UNP-ALP-BRT-OFF  TO MR-GROSSA (PV-SUB)     38500000
385100*           MOVE DP015-RED              TO MR-GROSSC (PV-SUB)     38510000
385200*           MOVE DP015-REVERSE          TO MR-GROSSH (PV-SUB)     38520000
385300*           MOVE -1                     TO MR-GROSSL (PV-SUB)     38530000
385400*           IF PS-NO-ERROR                                        38540000
385500*              MOVE PC-TSYMSG-01903     TO DP020-MSG-NUMBER       38550000
385600*           END-IF                                                38560000
385700*           SET PS-ERROR                TO TRUE                   38570000
385800*        ELSE                                                     38580000
385900*           IF  ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB) < 0     38590000
386000*           AND ASC-PSTG-TYP-CDE = 'CR'                           38600000
386100*               SET DP020-MSG-FATAL         TO TRUE               38610000
386200*               MOVE DP015-UNP-ALP-BRT-OFF  TO MR-GROSSA (PV-SUB) 38620000
386300*               MOVE DP015-RED              TO MR-GROSSC (PV-SUB) 38630000
386400*               MOVE DP015-REVERSE          TO MR-GROSSH (PV-SUB) 38640000
386500*               MOVE -1                     TO MR-GROSSL (PV-SUB) 38650000
386600*               IF PS-NO-ERROR                                    38660000
386700*                  MOVE PC-TSYMSG-01902     TO DP020-MSG-NUMBER   38670000
386800*               END-IF                                            38680000
386900*               SET PS-ERROR                TO TRUE               38690000
387000*           END-IF                                                38700000
387100*        END-IF                                                   38710000
387200*    ELSE                                                         38720000
387300        IF  ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB) > 0         38730000
387400        AND ASC-PSTG-TYP-CDE = 'CR'                               38740000
387500*** THE SIGN ON THE DISTRO COST MUST BE CONSISTENT WITH POST TYPE 38750000
387600            SET DP020-MSG-FATAL         TO TRUE                   38760000
387700            MOVE DP015-UNP-ALP-BRT-OFF  TO MR-GROSSA (PV-SUB)     38770000
387800            MOVE DP015-RED              TO MR-GROSSC (PV-SUB)     38780000
387900            MOVE DP015-REVERSE          TO MR-GROSSH (PV-SUB)     38790000
388000            MOVE -1                     TO MR-GROSSL (PV-SUB)     38800000
388100            IF PS-NO-ERROR                                        38810000
388200               MOVE PC-TSYMSG-01902     TO DP020-MSG-NUMBER       38820000
388300            END-IF                                                38830000
388400            SET PS-ERROR                TO TRUE                   38840000
388500        ELSE                                                      38850000
388600            IF  ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB) < 0     38860000
388700            AND ASC-PSTG-TYP-CDE = 'CH'                           38870000
388800*** THE SIGN ON THE DISTRO COST MUST BE CONSISTENT WITH POST TYPE 38880000
388900                SET DP020-MSG-FATAL         TO TRUE               38890000
389000                MOVE DP015-UNP-ALP-BRT-OFF  TO MR-GROSSA (PV-SUB) 38900000
389100                MOVE DP015-RED              TO MR-GROSSC (PV-SUB) 38910000
389200                MOVE DP015-REVERSE          TO MR-GROSSH (PV-SUB) 38920000
389300                MOVE -1                     TO MR-GROSSL (PV-SUB) 38930000
389400                IF PS-NO-ERROR                                    38940000
389500                   MOVE PC-TSYMSG-01903     TO DP020-MSG-NUMBER   38950000
389600                END-IF                                            38960000
389700                SET PS-ERROR                TO TRUE               38970000
389800            END-IF                                                38980000
389900*       END-IF                                                    38990000
390000     END-IF.                                                      39000000
390100                                                                  39010000
390200******************************************************************39020000
390300* THIS PARAGRAPH WILL PERFORM EDITS ON THE DISTRIBUTION RETAIL   *39030000
390400* DOLLAR FIELD.                                                  *39040000
390500******************************************************************39050000
390600 3800-EDIT-DISTRO-RETAIL.                                         39060000
390700                                                                  39070000
390800     IF  ASC-HD-RET-AMT = ZERO                                    39080000
390900         IF  ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB) = ZERO     39090000
391000             CONTINUE                                             39100000
391100         ELSE                                                     39110000
391200*** DISTRIB RETAIL NOT ALLOWED WHEN NO HEADER RETAIL IS ENTERED   39120000
391300             SET DP020-MSG-FATAL            TO TRUE               39130000
391400             MOVE DP015-UNP-ALP-BRT-OFF     TO MR-RETAILA (PV-SUB)39140000
391500             MOVE DP015-RED                 TO MR-RETAILC (PV-SUB)39150000
391600             MOVE DP015-REVERSE             TO MR-RETAILH (PV-SUB)39160000
391700             MOVE -1                        TO MR-RETAILL (PV-SUB)39170000
391800             IF PS-NO-ERROR                                       39180000
391900                MOVE PC-TSYMSG-01937        TO DP020-MSG-NUMBER   39190000
392000             END-IF                                               39200000
392100             SET PS-ERROR                   TO TRUE               39210000
392200         END-IF                                                   39220000
392300     ELSE                                                         39230000
392400         IF  ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) NOT EQUAL ZERO    39240000
392500         OR  ASC-RTL-PRCCTL-CDE = 'R'                             39250000
392600             IF  ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB) = ZERO 39260000
392700***  DISTRIB RETAIL REQUIRED WHEN SKU IS ENTERED OR RETAIL REQ'D  39270000
392800***  AND A HEADER RETAIL IS ENTERED.  (DON'T WANT TO AUTO CALC    39280000
392900***  DISTRIB RETAIL IN THIS INSTANCE).                            39290000
393000                 SET DP020-MSG-FATAL        TO TRUE               39300000
393100                 MOVE DP015-UNP-ALP-BRT-OFF TO MR-RETAILA (PV-SUB)39310000
393200                 MOVE DP015-RED             TO MR-RETAILC (PV-SUB)39320000
393300                 MOVE DP015-REVERSE         TO MR-RETAILH (PV-SUB)39330000
393400                 MOVE -1                    TO MR-RETAILL (PV-SUB)39340000
393500                 IF PS-NO-ERROR                                   39350000
393600                    MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER   39360000
393700                 END-IF                                           39370000
393800                 SET PS-ERROR               TO TRUE               39380000
393900             END-IF                                               39390000
394000         ELSE                                                     39400000
394100             IF  ASC-HD-GRO-COST = ZERO                           39410000
394200                 IF  ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB) = 039420000
394300***  DISTRIB RETAIL REQUIRED WHEN HEADER RETAIL ENTERED BUT NO    39430000
394400***  HEADER COST IS ENTERED (DISTRIB OF RETAIL CANNOT BE CALC'D   39440000
394500***  WHEN NO HEADER COST IS ENTERED).                             39450000
394600                     SET DP020-MSG-FATAL    TO TRUE               39460000
394700                     MOVE DP015-UNP-ALP-BRT-OFF                   39470000
394800                                            TO MR-RETAILA (PV-SUB)39480000
394900                     MOVE DP015-RED         TO MR-RETAILC (PV-SUB)39490000
395000                     MOVE DP015-REVERSE     TO MR-RETAILH (PV-SUB)39500000
395100                     MOVE -1                TO MR-RETAILL (PV-SUB)39510000
395200                     IF PS-NO-ERROR                               39520000
395300                        MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER  39530000
395400                     END-IF                                       39540000
395500                     SET PS-ERROR           TO TRUE               39550000
395600                 END-IF                                           39560000
395700             END-IF                                               39570000
395800         END-IF                                                   39580000
395900     END-IF.                                                      39590000
396000                                                                  39600000
396100     IF  ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB) > 0            39610000
396200     AND ASC-PSTG-TYP-CDE = 'CR'                                  39620000
396300*** SIGN ON THE DISTRO RETAIL MUST BE CONSISTENT WITH POST TYPE   39630000
396400         SET DP020-MSG-FATAL         TO TRUE                      39640000
396500         MOVE DP015-UNP-ALP-BRT-OFF  TO MR-RETAILA (PV-SUB)       39650000
396600         MOVE DP015-RED              TO MR-RETAILC (PV-SUB)       39660000
396700         MOVE DP015-REVERSE          TO MR-RETAILH (PV-SUB)       39670000
396800         MOVE -1                     TO MR-RETAILL (PV-SUB)       39680000
396900         IF PS-NO-ERROR                                           39690000
397000            MOVE PC-TSYMSG-01902     TO DP020-MSG-NUMBER          39700000
397100         END-IF                                                   39710000
397200         SET PS-ERROR                TO TRUE                      39720000
397300     END-IF.                                                      39730000
397400                                                                  39740000
397500     IF  ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB) < 0            39750000
397600     AND ASC-PSTG-TYP-CDE = 'CH'                                  39760000
397700*** SIGN ON THE DISTRO RETAIL MUST BE CONSISTENT WITH POST TYPE   39770000
397800         SET DP020-MSG-FATAL         TO TRUE                      39780000
397900         MOVE DP015-UNP-ALP-BRT-OFF  TO MR-RETAILA (PV-SUB)       39790000
398000         MOVE DP015-RED              TO MR-RETAILC (PV-SUB)       39800000
398100         MOVE DP015-REVERSE          TO MR-RETAILH (PV-SUB)       39810000
398200         MOVE -1                     TO MR-RETAILL (PV-SUB)       39820000
398300         IF PS-NO-ERROR                                           39830000
398400            MOVE PC-TSYMSG-01903     TO DP020-MSG-NUMBER          39840000
398500         END-IF                                                   39850000
398600         SET PS-ERROR                TO TRUE                      39860000
398700     END-IF.                                                      39870000
398800                                                                  39880000
398900******************************************************************39890000
399000* THIS PARAGRAPH WILL CALCULATE THE DISTRIBUTION RETAIL AMOUNT   *39900000
399100* WHEN THERE IS A HEADER RETAIL AMOUNT AND THE SKU SEQUENCE      *39910000
399200* NUMBER IS GREATER THAN ZERO.                                   *39920000
399300******************************************************************39930000
399400 3850-CALC-DISTRO-RETAIL.                                         39940000
399500                                                                  39950000
399600     IF PS-NO-ERROR                                               39960000
399700        IF  ASC-HD-RET-AMT NOT EQUAL ZERO                         39970000
399800        AND ASC-HD-GRO-COST NOT EQUAL ZERO                        39980000
399900        AND ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL ZERO         39990000
400000            IF (ASC-COST-PRCCTL-CDE = 'R'                         40000000
400100            AND ASC-RTL-PRCCTL-CDE = 'R')                         40010000
400200               INITIALIZE PV-CALC-RETAIL                          40020000
400300                          ASC-SAVE-BLK-SUB                        40030000
400400                          ASC-SAVE-ITEM-SUB                       40040000
400500            ELSE                                                  40050000
400600                SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE       40060000
400700                INITIALIZE PV-CALC-RETAIL                         40070000
400800                           PV-TEMP-GROSS                          40080000
400900                           PV-RETAIL-PERC                         40090000
401000                           PV-DISP-RETAIL                         40100000
401100                MOVE ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB)    40110000
401200                  TO PV-TEMP-GROSS                                40120000
401300                COMPUTE PV-RETAIL-PERC =                          40130000
401400                        PV-TEMP-GROSS / ASC-HD-GRO-COST           40140000
401500                COMPUTE PV-CALC-RETAIL =                          40150000
401600                        PV-RETAIL-PERC * ASC-HD-RET-AMT           40160000
401700                IF PV-CALC-RETAIL GREATER THAN ZERO               40170000
401800                   COMPUTE PV-DISP-RETAIL =                       40180000
401900                              PV-CALC-RETAIL + .005               40190000
402000                ELSE                                              40200000
402100                   IF PV-CALC-RETAIL LESS THAN ZERO               40210000
402200                      COMPUTE PV-DISP-RETAIL =                    40220000
402300                                 PV-CALC-RETAIL - .005            40230000
402400                   ELSE                                           40240000
402500                      MOVE ZERO TO PV-DISP-RETAIL                 40250000
402600                   END-IF                                         40260000
402700                END-IF                                            40270000
402800                MOVE PV-DISP-RETAIL                               40280000
402900                  TO ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)    40290000
403000                IF  ASC-SAVE-BLK-SUB EQUAL ZERO                   40300000
403100                AND ASC-SAVE-ITEM-SUB EQUAL ZERO                  40310000
403200                    MOVE ASC-BLK-SUB TO ASC-SAVE-BLK-SUB          40320000
403300                    MOVE ASC-ITEM-SUB TO ASC-SAVE-ITEM-SUB        40330000
403400                END-IF                                            40340000
403500            END-IF                                                40350000
403600        ELSE                                                      40360000
403700            IF  ASC-HD-GRO-COST = ZERO                            40370000
403800            AND ASC-HD-RET-AMT = ZERO                             40380000
403900            AND ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL ZERO     40390000
404000                INITIALIZE PV-CALC-RETAIL                         40400000
404100                         ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)40410000
404200                         ASC-SAVE-BLK-SUB                         40420000
404300                         ASC-SAVE-ITEM-SUB                        40430000
404400           END-IF                                                 40440000
404500        END-IF                                                    40450000
404600     END-IF.                                                      40460000
404700                                                                  40470000
404800*----------------------------------------------------------------*40480000
404900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *40490000
405000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *40500000
405100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *40510000
405200*    DISPLAY THE PANEL TO USER.                                  *40520000
405300*----------------------------------------------------------------*40530000
405400 4000-BUILD-INITIAL-PANEL.                                        40540000
405500                                                                  40550000
405600     INITIALIZE  ASC-BLOCK-ENTRIES (1)                            40560000
405700                 ASC-BLOCK-ENTRIES (2)                            40570000
405800                 DCLTADJDIS.                                      40580000
405900                                                                  40590000
406000     MOVE +1                  TO ASC-BLK-SUB.                     40600000
406100     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            40610000
406200                                                                  40620000
406300     MOVE +0                 TO ASC-ITEM-SUB                      40630000
406400                                ASC-NUMBER-OF-ITEMS-READ          40640000
406500                                ASC-NUMBER-OF-SELECTED-ITEMS      40650000
406600                                ASC-NUMBER-OF-DELETED-ITEMS       40660000
406700                                ASC-HIGHEST-BLOCK-WRITTEN         40670000
406800                                ASC-START-OF-SELECTED-RANGE       40680000
406900                                ASC-END-OF-SELECTED-RANGE         40690000
407000                                ASC-ITEM-AT-TOP-OF-PANEL.         40700000
407100                                                                  40710000
407200     IF ASC-ACTION-SW = 'ADD'                                     40720000
407300        PERFORM 4305-INITIALIZE-DISTRO                            40730000
407400        PERFORM 4025-FILL-INITIAL-DIST                            40740000
407500     ELSE                                                         40750000
407600        PERFORM 4010-OPEN-CURSOR                                  40760000
407700        PERFORM 4300-READ-ITEMS-FROM-DB                           40770000
407800        PERFORM 4020-CLOSE-CURSOR                                 40780000
407900        PERFORM 4025-FILL-INITIAL-DIST                            40790000
408000     END-IF.                                                      40800000
408100                                                                  40810000
408200     MOVE +1                     TO PV-TOP-ITEM.                  40820000
408300     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         40830000
408400                                                                  40840000
408500     IF PS-NO-ERROR                                               40850000
408600        MOVE -1 TO AHDCSTL                                        40860000
408700**      MOVE -1 TO AHDFRGTL                                       40870000
408800     END-IF.                                                      40880000
408900                                                                  40890000
409000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        40900000
409100                                                                  40910000
409200 EJECT                                                            40920000
409300******************************************************************40930000
409400* THIS PARAGRAPH WILL RESET THE DISTRIBUTION DELETE SCREEN AFTER *40940000
409500* DELETES HAVE BEEN PERFORMED.  THE DELETED LINES WILL NO LONGER *40950000
409600* APPEAR AND ANY UPDATES THAT MAY HAVE TAKEN PLACE WILL DISPLAY. *40960000
409700******************************************************************40970000
409800 4001-BUILD-DELETE-FIRST-PANEL.                                   40980000
409900                                                                  40990000
410000     INITIALIZE  ASC-BLOCK-ENTRIES (1)                            41000000
410100                 ASC-BLOCK-ENTRIES (2)                            41010000
410200                 DCLTADJDIS.                                      41020000
410300                                                                  41030000
410400     MOVE +1                  TO ASC-BLK-SUB.                     41040000
410500     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            41050000
410600                                                                  41060000
410700     MOVE +0                 TO ASC-ITEM-SUB                      41070000
410800                                ASC-NUMBER-OF-ITEMS-READ          41080000
410900                                ASC-NUMBER-OF-SELECTED-ITEMS      41090000
411000                                ASC-NUMBER-OF-DELETED-ITEMS       41100000
411100                                ASC-HIGHEST-BLOCK-WRITTEN         41110000
411200                                ASC-START-OF-SELECTED-RANGE       41120000
411300                                ASC-END-OF-SELECTED-RANGE         41130000
411400                                ASC-ITEM-AT-TOP-OF-PANEL.         41140000
411500                                                                  41150000
411600     PERFORM 4010-OPEN-CURSOR.                                    41160000
411700     PERFORM 4300-READ-ITEMS-FROM-DB.                             41170000
411800     PERFORM 4020-CLOSE-CURSOR.                                   41180000
411900                                                                  41190000
412000     MOVE +1                     TO PV-TOP-ITEM.                  41200000
412100     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         41210000
412200                                                                  41220000
412300     IF PS-NO-ERROR                                               41230000
412400        MOVE -1 TO AHDFRGTL                                       41240000
412500     END-IF.                                                      41250000
412600                                                                  41260000
412700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        41270000
412800                                                                  41280000
412900 EJECT                                                            41290000
413000*----------------------------------------------------------------*41300000
413100* OPEN THE ADJUSTMENT CURSOR.                                    *41310000
413200*   IN THIS PARTICULAR APPLICATION ONE OF 10 DIFFERENT CURSORS   *41320000
413300*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *41330000
413400*   USER.                                                        *41340000
413500*----------------------------------------------------------------*41350000
413600 4010-OPEN-CURSOR.                                                41360000
413700                                                                  41370000
413800     EXEC SQL                                                     41380000
413900         OPEN DISTRO-CSR                                          41390000
414000     END-EXEC.                                                    41400000
414100                                                                  41410000
414200     EVALUATE TRUE                                                41420000
414300         WHEN SQLCODE = +0                                        41430000
414400             CONTINUE                                             41440000
414500         WHEN OTHER                                               41450000
414600              MOVE '4010-OPEN-CURSOR'                             41460000
414700                               TO DP013-PARAGRAPH                 41470000
414800              MOVE 'OPEN INVOICE-ITEM-CSR'                        41480000
414900                               TO DP013-MESSAGE-TEXT (1)          41490000
415000              MOVE SQLCA           TO DP013-SQLCA                 41500000
415100              SET DP013-DB2-ABEND                                 41510000
415200                               TO TRUE                            41520000
415300              PERFORM DP013-0000-PROCESS-ABEND                    41530000
415400     END-EVALUATE.                                                41540000
415500                                                                  41550000
415600 EJECT                                                            41560000
415700*----------------------------------------------------------------*41570000
415800* CLOSE THE ADJUSTMENT CURSOR.                                   *41580000
415900*----------------------------------------------------------------*41590000
416000 4020-CLOSE-CURSOR.                                               41600000
416100                                                                  41610000
416200     EXEC SQL                                                     41620000
416300         CLOSE DISTRO-CSR                                         41630000
416400     END-EXEC.                                                    41640000
416500                                                                  41650000
416600     EVALUATE TRUE                                                41660000
416700         WHEN SQLCODE = ZERO                                      41670000
416800             CONTINUE                                             41680000
416900         WHEN SQLWARN0 NOT = SPACES                               41690000
417000         WHEN SQLCODE < ZERO                                      41700000
417100         WHEN SQLCODE > ZERO                                      41710000
417200             MOVE '4020-CLOSE-CURSOR'                             41720000
417300                               TO DP013-PARAGRAPH                 41730000
417400             MOVE 'CLOSE ADJUSTMENT CURSOR '                      41740000
417500                               TO DP013-MESSAGE-TEXT (1)          41750000
417600             MOVE SQLCA        TO DP013-SQLCA                     41760000
417700             MOVE 'TADJRNL '   TO DP013-DB2-TABLE-NAME (1)        41770000
417800             SET DP013-DB2-ABEND                                  41780000
417900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               41790000
418000             PERFORM DP013-0000-PROCESS-ABEND                     41800000
418100     END-EVALUATE.                                                41810000
418200                                                                  41820000
418300 EJECT                                                            41830000
418400******************************************************************41840000
418500* THIS PARAGRAPH WILL FILL THE INITIAL DISTRIBUTION LINE.        *41850000
418600******************************************************************41860000
418700 4025-FILL-INITIAL-DIST.                                          41870000
418800                                                                  41880000
418900     MOVE ASC-DIS-STR-NBR      TO ASC-STORE     (1 1).            41890000
419000     MOVE ASC-STORE (1 1)      TO ASC-ALP-STORE (1 1).            41900000
419100     MOVE ASC-DIS-CL-NBR       TO ASC-CLASS     (1 1).            41910000
419200     MOVE ASC-DIS-SKU-NBR      TO ASC-SKU (1 1).                  41920000
419300     MOVE ASC-DIS-GRO-COST-AMT TO ASC-GROSS-COST (1 1).           41930000
419400     MOVE ASC-DIS-RTL-AMT      TO ASC-RETAIL-AMT (1 1).           41940000
419500     MOVE ASC-DIS-NET-COST-AMT TO ASC-NET-COST (1 1).             41950000
419600                                                                  41960000
419700******************************************************************41970000
419800* THIS PARAGRAPH PHYSICALLY LOOPS THROUGH ALL ITEMS IN THE LIST  *41980000
419900* TEMP STORAGE QUEUE.                                            *41990000
420000******************************************************************42000000
420100 4100-TRAVERSE-TSQ-INSERT.                                        42010000
420200                                                                  42020000
420300     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              42030000
420400                                 TO PV-LIST-ITEM-NUMBER.          42040000
420500     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            42050000
420600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    42060000
420700                                                                  42070000
420800     MOVE +1                     TO ASC-BLK-SUB.                  42080000
420900                                                                  42090000
421000     PERFORM                                                      42100000
421100         VARYING PV-BLOCK-NUMBER                                  42110000
421200         FROM 1 BY 1                                              42120000
421300         UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN        42130000
421400                                                                  42140000
421500         PERFORM 4410-READ-TEMP-STORAGE                           42150000
421600                                                                  42160000
421700         PERFORM                                                  42170000
421800             VARYING ASC-ITEM-SUB                                 42180000
421900             FROM 1 BY 1                                          42190000
422000             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              42200000
422100                                                                  42210000
422200             IF (ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB)         42220000
422300                                                      > SPACES OR 42230000
422400                ASC-CLASS  (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR 42240000
422500                ASC-SKU    (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO   OR 42250000
422600                ASC-GROSS-COST(ASC-BLK-SUB ASC-ITEM-SUB)          42260000
422700                                              NOT EQUAL ZERO   OR 42270000
422800                ASC-RETAIL-AMT(ASC-BLK-SUB ASC-ITEM-SUB)          42280000
422900                                              NOT EQUAL ZERO)     42290000
423000                PERFORM 8000-FORMAT-ADJUSTMENT-DISTRO             42300000
423100                PERFORM 8100-ADJUSTMENT-DISTRO-ADD                42310000
423200             END-IF                                               42320000
423300         END-PERFORM                                              42330000
423400                                                                  42340000
423500     END-PERFORM.                                                 42350000
423600                                                                  42360000
423700     MOVE +1                        TO ASC-BLK-SUB.               42370000
423800     MOVE PV-FIRST-BLOCK-IN-ARRAY   TO PV-BLOCK-NUMBER.           42380000
423900                                                                  42390000
424000     PERFORM 4410-READ-TEMP-STORAGE.                              42400000
424100                                                                  42410000
424200     ADD +1                         TO PV-BLOCK-NUMBER            42420000
424300                                       ASC-BLK-SUB.               42430000
424400     PERFORM 4410-READ-TEMP-STORAGE.                              42440000
424500                                                                  42450000
424600******************************************************************42460000
424700* THIS PARAGRAPH WILL TRAVERSE THE TEMPORARY STORAGE QUEUE FOR   *42470000
424800* PURPOSES OF UPDATING THE ADJUSTMENT DISTRIBUTION LINES.        *42480000
424900******************************************************************42490000
425000 4110-TRAVERSE-TSQ-UPDATE.                                        42500000
425100                                                                  42510000
425200     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              42520000
425300                                 TO PV-LIST-ITEM-NUMBER.          42530000
425400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            42540000
425500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    42550000
425600                                                                  42560000
425700     MOVE +1                     TO ASC-BLK-SUB.                  42570000
425800                                                                  42580000
425900     PERFORM                                                      42590000
426000         VARYING PV-BLOCK-NUMBER                                  42600000
426100         FROM 1 BY 1                                              42610000
426200         UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN        42620000
426300                                                                  42630000
426400         PERFORM 4410-READ-TEMP-STORAGE                           42640000
426500                                                                  42650000
426600         PERFORM                                                  42660000
426700             VARYING ASC-ITEM-SUB                                 42670000
426800             FROM 1 BY 1                                          42680000
426900             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              42690000
427000                                                                  42700000
427100             IF NOT ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB)         42710000
427200                IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)42720000
427300                   GREATER THAN ZERO                              42730000
427400                   PERFORM 8000-FORMAT-ADJUSTMENT-DISTRO          42740000
427500                   PERFORM 8200-ADJUSTMENT-DISTRO-UPDATE          42750000
427600                   IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       42760000
427700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS42770000
427800                      SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE 42780000
427900                      SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)42790000
428000                                                       TO TRUE    42800000
428100                      SET ASC-TEMP-NO-SELECT                      42810000
428200                                        (ASC-BLK-SUB ASC-ITEM-SUB)42820000
428300                                                       TO TRUE    42830000
428400                   END-IF                                         42840000
428500                END-IF                                            42850000
428600             ELSE                                                 42860000
428700                IF ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB)          42870000
428800                   IF ASC-LIST-ITEM-NUMBER                        42880000
428900                                    (ASC-BLK-SUB ASC-ITEM-SUB)    42890000
429000                      GREATER THAN ZERO                           42900000
429100                      PERFORM 8010-FORMAT-ADJ-DISTRO-DEL          42910000
429200                      PERFORM 8600-ADJUSTMENT-DISTRO-DELETE       42920000
429300                      SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE 42930000
429400                      SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)42940000
429500                                                          TO TRUE 42950000
429600                      SET ASC-TEMP-NO-SELECT                      42960000
429700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   42970000
429800                                                          TO TRUE 42980000
429900                      SUBTRACT +1 FROM ASC-NUMBER-OF-DELETED-ITEMS42990000
430000                   END-IF                                         43000000
430100                END-IF                                            43010000
430200             END-IF                                               43020000
430300         END-PERFORM                                              43030000
430400                                                                  43040000
430500         IF ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                       43050000
430600            PERFORM 5105-REWRITE-ASC-LISTQ                        43060000
430700         END-IF                                                   43070000
430800                                                                  43080000
430900     END-PERFORM.                                                 43090000
431000                                                                  43100000
431100     MOVE +1                        TO ASC-BLK-SUB.               43110000
431200     MOVE PV-FIRST-BLOCK-IN-ARRAY   TO PV-BLOCK-NUMBER.           43120000
431300                                                                  43130000
431400     PERFORM 4410-READ-TEMP-STORAGE.                              43140000
431500                                                                  43150000
431600     ADD +1                         TO PV-BLOCK-NUMBER            43160000
431700                                       ASC-BLK-SUB.               43170000
431800     PERFORM 4410-READ-TEMP-STORAGE.                              43180000
431900                                                                  43190000
432000******************************************************************43200000
432100* THIS PARAGRAPH WILL TRAVERSE THE TEMPORARY STORAGE QUEUE FOR   *43210000
432200* PURPOSES OF DELETING THE ADJUSTMENT DISTRIBUTION LINES.        *43220000
432300******************************************************************43230000
432400 4120-TRAVERSE-TSQ-DELETE.                                        43240000
432500                                                                  43250000
432600     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              43260000
432700                                 TO PV-LIST-ITEM-NUMBER.          43270000
432800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            43280000
432900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    43290000
433000                                                                  43300000
433100     MOVE +1                     TO ASC-BLK-SUB.                  43310000
433200                                                                  43320000
433300     PERFORM                                                      43330000
433400         VARYING PV-BLOCK-NUMBER                                  43340000
433500         FROM 1 BY 1                                              43350000
433600         UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN        43360000
433700                                                                  43370000
433800         PERFORM 4410-READ-TEMP-STORAGE                           43380000
433900                                                                  43390000
434000         PERFORM                                                  43400000
434100             VARYING ASC-ITEM-SUB                                 43410000
434200             FROM 1 BY 1                                          43420000
434300             UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL              43430000
434400                                                                  43440000
434500             IF ASC-DELETE (ASC-BLK-SUB ASC-ITEM-SUB)             43450000
434600                PERFORM 8010-FORMAT-ADJ-DISTRO-DEL                43460000
434700                PERFORM 8600-ADJUSTMENT-DISTRO-DELETE             43470000
434800                SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE       43480000
434900                SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)      43490000
435000                                                    TO TRUE       43500000
435100                SET ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB) 43510000
435200                                                    TO TRUE       43520000
435300                SUBTRACT +1 FROM ASC-NUMBER-OF-DELETED-ITEMS      43530000
435400             END-IF                                               43540000
435500         END-PERFORM                                              43550000
435600                                                                  43560000
435700         IF ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                       43570000
435800            PERFORM 5105-REWRITE-ASC-LISTQ                        43580000
435900         END-IF                                                   43590000
436000                                                                  43600000
436100     END-PERFORM.                                                 43610000
436200                                                                  43620000
436300     MOVE +1                        TO ASC-BLK-SUB.               43630000
436400     MOVE PV-FIRST-BLOCK-IN-ARRAY   TO PV-BLOCK-NUMBER.           43640000
436500                                                                  43650000
436600     PERFORM 4410-READ-TEMP-STORAGE.                              43660000
436700                                                                  43670000
436800     ADD +1                         TO PV-BLOCK-NUMBER            43680000
436900                                       ASC-BLK-SUB.               43690000
437000     PERFORM 4410-READ-TEMP-STORAGE.                              43700000
437100                                                                  43710000
437200******************************************************************43720000
437300* THIS PARAGRAPH WILL PERFORM CALCULATIONS TO ARRIVE AT A        *43730000
437400* REVISED NET COST, TERM DISCOUNT AMOUNT, NEW STORE DISCOUNT     *43740000
437500* AMOUNT, AND TRADE DISCOUNT AMOUNT IN THE CASE THAT THE GROSS   *43750000
437600* COST HAS BEEN UPDATED.                                         *43760000
437700******************************************************************43770000
437800 4200-RECALCULATE-ADJ-DOLLARS.                                    43780000
437900                                                                  43790000
438000     IF ASC-HD-GRO-COST GREATER THAN ZERO                         43800000
438100        COMPUTE PV-TERM-DISC-AMT  =                               43810000
438200                (ASC-TERM-DISC-PCT * ASC-HD-GRO-COST) + .005      43820000
438300        COMPUTE PV-NW-STR-DISC-AMT  =                             43830000
438400                (ASC-NW-STR-DISC-PCT * ASC-HD-GRO-COST) + .005    43840000
438500        COMPUTE PV-TRD-DISC-AMT  =                                43850000
438600                (ASC-TRD-DISC-PCT * ASC-HD-GRO-COST) + .005       43860000
438700        COMPUTE PV-MOS-DISC-AMT  =                                43870000
438800                (ASC-MOS-DISC-PCT * ASC-HD-GRO-COST) + .005       43880000
438900     ELSE                                                         43890000
439000        IF ASC-HD-GRO-COST LESS THAN ZERO                         43900000
439100           COMPUTE PV-TERM-DISC-AMT  =                            43910000
439200                   (ASC-TERM-DISC-PCT * ASC-HD-GRO-COST) - .005   43920000
439300           COMPUTE PV-NW-STR-DISC-AMT  =                          43930000
439400                   (ASC-NW-STR-DISC-PCT * ASC-HD-GRO-COST)        43940000
439500                                                         - .005   43950000
439600           COMPUTE PV-TRD-DISC-AMT  =                             43960000
439700                   (ASC-TRD-DISC-PCT * ASC-HD-GRO-COST) - .005    43970000
439800           COMPUTE PV-MOS-DISC-AMT  =                             43980000
439900                   (ASC-MOS-DISC-PCT * ASC-HD-GRO-COST) - .005    43990000
440000        ELSE                                                      44000000
440100           MOVE ZERO TO PV-TERM-DISC-AMT                          44010000
440200                        PV-NW-STR-DISC-AMT                        44020000
440300                        PV-TRD-DISC-AMT                           44030000
440400                        PV-MOS-DISC-AMT                           44040000
440500        END-IF                                                    44050000
440600     END-IF.                                                      44060000
440700                                                                  44070000
440800     MOVE PV-TERM-DISC-AMT   TO ASC-TERM-DISC-AMT.                44080000
440900     MOVE PV-NW-STR-DISC-AMT TO ASC-NW-STR-DISC-AMT.              44090000
441000     MOVE PV-TRD-DISC-AMT    TO ASC-TRD-DISC-AMT.                 44100000
441100     MOVE PV-MOS-DISC-AMT    TO ASC-MOS-DISC-AMT.                 44110000
441200                                                                  44120000
441300     IF PV-NW-STR-DISC-AMT NOT EQUAL ZERO                         44130000
441400        MOVE PV-NW-STR-DISC-AMT TO ASC-HD-NEW-STR-AMT             44140000
441500     END-IF.                                                      44150000
441600                                                                  44160000
441700     INITIALIZE PV-DISC-AMT.                                      44170000
441800                                                                  44180000
441900     COMPUTE PV-DISC-AMT =                                        44190000
442000             (ASC-TERM-DISC-AMT +                                 44200000
442100              ASC-NW-STR-DISC-AMT +                               44210000
442200              ASC-TRD-DISC-AMT +                                  44220000
442300              ASC-MOS-DISC-AMT).                                  44230000
442400                                                                  44240000
442500     IF PV-DISC-AMT GREATER THAN ZERO                             44250000
442600        COMPUTE ASC-TOTAL-DISC-AMT =                              44260000
442700               (ASC-TERM-DISC-AMT +                               44270000
442800                ASC-NW-STR-DISC-AMT +                             44280000
442900                ASC-TRD-DISC-AMT +                                44290000
443000                ASC-MOS-DISC-AMT) + .005                          44300000
443100     ELSE                                                         44310000
443200        IF PV-DISC-AMT LESS THAN ZERO                             44320000
443300           COMPUTE ASC-TOTAL-DISC-AMT =                           44330000
443400                  (ASC-TERM-DISC-AMT +                            44340000
443500                   ASC-NW-STR-DISC-AMT +                          44350000
443600                   ASC-TRD-DISC-AMT +                             44360000
443700                   ASC-MOS-DISC-AMT) - .005                       44370000
443800        ELSE                                                      44380000
443900           MOVE ZERO TO ASC-TOTAL-DISC-AMT                        44390000
444000        END-IF                                                    44400000
444100     END-IF.                                                      44410000
444200                                                                  44420000
444300     PERFORM 6550-CALCULATE-NET-COST.                             44430000
444400                                                                  44440000
444500******************************************************************44450000
444600* THIS PARAGRAPH WILL ALLOCATE THE DOLLARS FROM THE HEADER OF    *44460000
444700* THE ADJUSTMENT TO THE DISTRIBUTION LINES OF THE ADJUSTMENT     *44470000
444800* BASED ON GROSS COST, FREIGHT AMOUNT, OR RETAIL AMOUNT.         *44480000
444900******************************************************************44490000
445000 4210-ALLOCATE-DOLLARS.                                           44500000
445100                                                                  44510000
445200     INITIALIZE  PV-ALLOC-PERC                                    44520000
445300                 PV-DISTRO-FRGT-AMT                               44530000
445400                 PV-DISTRO-MISC-CHRG                              44540000
445500                 PV-DISTRO-DISC-AMT                               44550000
445600                 PV-ROUNDING-FACTOR.                              44560000
445700                                                                  44570000
445800     IF ASC-PSTG-TYP-CDE = 'CH'                                   44580000
445900        MOVE +.005 TO PV-ROUNDING-FACTOR                          44590000
446000     ELSE                                                         44600000
446100        MOVE -.005 TO PV-ROUNDING-FACTOR                          44610000
446200     END-IF.                                                      44620000
446300                                                                  44630000
446400     IF ASC-FREIGHT-COST-ALLOCATION                               44640000
446500        MOVE ASC-GROSS-COST  (ASC-BLK-SUB ASC-ITEM-SUB)           44650000
446600                                TO PV-TEMP-GROSS                  44660000
446700        COMPUTE PV-ALLOC-PERC =                                   44670000
446800                        PV-TEMP-GROSS / ASC-HD-FRGT-AMT           44680000
446900     ELSE                                                         44690000
447000        IF ASC-NEW-STR-COST-ALLOCATION                            44700000
447100           MOVE ASC-GROSS-COST  (ASC-BLK-SUB ASC-ITEM-SUB)        44710000
447200                                 TO PV-TEMP-GROSS                 44720000
447300           COMPUTE PV-ALLOC-PERC =                                44730000
447400                        PV-TEMP-GROSS / ASC-HD-NEW-STR-AMT        44740000
447500        ELSE                                                      44750000
447600           IF ASC-GROSS-COST-ALLOCATION                           44760000
447700              MOVE ASC-GROSS-COST  (ASC-BLK-SUB ASC-ITEM-SUB)     44770000
447800                                    TO PV-TEMP-GROSS              44780000
447900              COMPUTE PV-ALLOC-PERC =                             44790000
448000                           PV-TEMP-GROSS / ASC-HD-GRO-COST        44800000
448100           ELSE                                                   44810000
448200              IF ASC-RETAIL-AMT-ALLOCATION                        44820000
448300                 MOVE ASC-RETAIL-AMT   (ASC-BLK-SUB ASC-ITEM-SUB) 44830000
448400                                        TO PV-TEMP-GROSS          44840000
448500                 COMPUTE PV-ALLOC-PERC =                          44850000
448600                                 PV-TEMP-GROSS / ASC-HD-RET-AMT   44860000
448700              END-IF                                              44870000
448800           END-IF                                                 44880000
448900        END-IF                                                    44890000
449000     END-IF.                                                      44900000
449100                                                                  44910000
449200     IF ASC-FREIGHT-COST-ALLOCATION                               44920000
449300        MOVE ZERO              TO PV-DISTRO-FRGT-AMT              44930000
449400     ELSE                                                         44940000
449500        COMPUTE PV-DISTRO-FRGT-AMT =                              44950000
449600                       (PV-ALLOC-PERC * ASC-HD-FRGT-AMT) +        44960000
449700                                      PV-ROUNDING-FACTOR          44970000
449800     END-IF.                                                      44980000
449900                                                                  44990000
450000     ADD PV-DISTRO-FRGT-AMT    TO PV-TOT-DISTRO-FRGT-AMT.         45000000
450100                                                                  45010000
450200     COMPUTE PV-DISTRO-MISC-CHRG =                                45020000
450300                       (PV-ALLOC-PERC * ASC-MISC-CHRG-AMT) +      45030000
450400                                      PV-ROUNDING-FACTOR.         45040000
450500     ADD PV-DISTRO-MISC-CHRG   TO PV-TOT-DISTRO-MISC-CHRG.        45050000
450600                                                                  45060000
450700     IF ASC-NEW-STR-COST-ALLOCATION                               45070000
450800        MOVE ASC-GROSS-COST  (ASC-BLK-SUB ASC-ITEM-SUB)           45080000
450900                               TO PV-DISTRO-DISC-AMT              45090000
451000     ELSE                                                         45100000
451100        COMPUTE PV-DISTRO-DISC-AMT =                              45110000
451200                       (PV-ALLOC-PERC * ASC-TOTAL-DISC-AMT) +     45120000
451300                                      PV-ROUNDING-FACTOR          45130000
451400     END-IF.                                                      45140000
451500     ADD PV-DISTRO-DISC-AMT    TO PV-TOT-DISTRO-DISC-AMT.         45150000
451600                                                                  45160000
451700     IF PV-DIS-CNTR = ASC-NO-OF-DIS-ITEMS                         45170000
451800        PERFORM 4220-ADJUST-REMAINING-DOLLARS                     45180000
451900     END-IF.                                                      45190000
452000                                                                  45200000
452100******************************************************************45210000
452200* THIS PARAGRAPH WILL EXAMINE THE TOTAL ALLOCATED DOLLAR FIELD   *45220000
452300* THAT HAS BEEN ACCUMULATED IN THE DISTRIBUTION FOR THE FREIGHT, *45230000
452400* MISCELLANEOUS, AND DISCOUNTS.  THIS PARAGRAPH WILL BE CALLED   *45240000
452500* ONLY FOR THE LAST DISTRIBUTION LINE AND IF THERE IS ANY        *45250000
452600* DIFFERENCE BETWEEN THE DISTRIBUTION DOLLAR SUM FOR EACH OF     *45260000
452700* THESE FIELDS AND THE HEADER RECORD TOTAL, THE CUSHION IS       *45270000
452800* APPLIED TO THE LAST DISTRIBUTION RECORD TO BALANCE.            *45280000
452900******************************************************************45290000
453000 4220-ADJUST-REMAINING-DOLLARS.                                   45300000
453100                                                                  45310000
453200     INITIALIZE PV-DIS-DOL-DIFF.                                  45320000
453300     COMPUTE PV-DIS-DOL-DIFF =                                    45330000
453400             ASC-MISC-CHRG-AMT - PV-TOT-DISTRO-MISC-CHRG.         45340000
453500     ADD PV-DIS-DOL-DIFF TO PV-DISTRO-MISC-CHRG.                  45350000
453600                                                                  45360000
453700     IF NOT ASC-NEW-STR-COST-ALLOCATION                           45370000
453800        INITIALIZE PV-DIS-DOL-DIFF                                45380000
453900        COMPUTE PV-DIS-DOL-DIFF =                                 45390000
454000                ASC-TOTAL-DISC-AMT - PV-TOT-DISTRO-DISC-AMT       45400000
454100        ADD PV-DIS-DOL-DIFF TO PV-DISTRO-DISC-AMT                 45410000
454200     END-IF.                                                      45420000
454300                                                                  45430000
454400     IF NOT ASC-FREIGHT-COST-ALLOCATION                           45440000
454500        INITIALIZE PV-DIS-DOL-DIFF                                45450000
454600        COMPUTE PV-DIS-DOL-DIFF =                                 45460000
454700                ASC-HD-FRGT-AMT - PV-TOT-DISTRO-FRGT-AMT          45470000
454800        ADD PV-DIS-DOL-DIFF TO PV-DISTRO-FRGT-AMT                 45480000
454900     END-IF.                                                      45490000
455000                                                                  45500000
455100* ADJUST THE RETAIL AMOUNT ON THE LAST DISTRIBUTION RECORD SO THE 45510000
455200* SUM ON ALL OF THE DISTRIBUTION RECORDS FOR THE REATIL AMOUNT    45520000
455300* WILL BALANCE THE RETAIL AMOUNT IN THE HEADER RECORD.            45530000
455400****************************************************************  45540000
455500** NOTE THIS WILL ONLY OCCUR WHEN THE RETAIL DISTRIBUTION AMOUNT  45550000
455600** IS CALCULATED.                                                 45560000
455700     IF ASC-SAVE-BLK-SUB NOT EQUAL ZERO AND                       45570000
455800        ASC-SAVE-ITEM-SUB NOT EQUAL ZERO                          45580000
455900        INITIALIZE PV-DIS-RET-DIFF                                45590000
456000                   PV-DET-RETAIL                                  45600000
456100        COMPUTE PV-DIS-RET-DIFF =                                 45610000
456200                ASC-HD-RET-AMT - ASC-TOTAL-RETAIL-AMT             45620000
456300        ADD PV-DIS-RET-DIFF TO ASC-RETAIL-AMT                     45630000
456400                            (ASC-BLK-SUB ASC-ITEM-SUB)            45640000
456500     END-IF.                                                      45650000
456600                                                                  45660000
456700******************************************************************45670000
456800* THIS PARAGRAPH WILL CHECK FOR DUPLICATE ENTRIES OF STORE       *45680000
456900* AND/OR CLASS AND SKU.                                          *45690000
457000******************************************************************45700000
457100 4250-CHECK-FOR-DUP-STR-CLS-SEQ.                                  45710000
457200                                                                  45720000
457300     SET ENTRY-IDX TO 1.                                          45730000
457400*    IF ASC-HD-STORE = ZERO                                       45740000
457500        SEARCH PV-CLASS-ENTRIES                                   45750000
457600           WHEN ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) =        45760000
457700                               PV-STORE-ENTRY (ENTRY-IDX) AND     45770000
457800                ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) =            45780000
457900                               PV-CLASS-ENTRY (ENTRY-IDX) AND     45790000
458000                ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) =              45800000
458100                               PV-SKU-ENTRY (ENTRY-IDX)           45810000
458200             SET DP020-MSG-FATAL        TO TRUE                   45820000
458300             IF ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES 45830000
458400*02-19-99       AND ASC-HD-STORE = ZERO                           45840000
458500                MOVE DP015-UNP-ALP-BRT-OFF TO MR-STOREA           45850000
458600*02-16-99                                         (PV-DUP-COUNT)  45860000
458700                                                  (PV-SUB)        45870000
458800                MOVE DP015-REVERSE         TO MR-STOREH           45880000
458900*02-16-99                                         (PV-DUP-COUNT)  45890000
459000                                                  (PV-SUB)        45900000
459100                MOVE DP015-RED             TO MR-STOREC           45910000
459200*02-16-99                                         (PV-DUP-COUNT)  45920000
459300                                                  (PV-SUB)        45930000
459400                MOVE -1                    TO MR-STOREL           45940000
459500*02-16-99                                         (PV-DUP-COUNT)  45950000
459600                                                  (PV-SUB)        45960000
459700             END-IF                                               45970000
459800             IF ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES     45980000
459900                MOVE DP015-UNP-ALP-BRT-OFF TO MR-CLASSA           45990000
460000*02-16-99                                         (PV-DUP-COUNT)  46000000
460100                                                  (PV-SUB)        46010000
460200                MOVE DP015-REVERSE         TO MR-CLASSH           46020000
460300*02-16-99                                         (PV-DUP-COUNT)  46030000
460400                                                  (PV-SUB)        46040000
460500                MOVE DP015-RED             TO MR-CLASSC           46050000
460600*02-16-99                                         (PV-DUP-COUNT)  46060000
460700                                                  (PV-SUB)        46070000
460800                MOVE -1                    TO MR-CLASSL           46080000
460900*02-16-99                                         (PV-DUP-COUNT)  46090000
461000                                                  (PV-SUB)        46100000
461100             END-IF                                               46110000
461200             IF ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) > ZERO         46120000
461300                MOVE DP015-UNP-ALP-BRT-OFF TO MR-SKUA             46130000
461400*02-16-99                                         (PV-DUP-COUNT)  46140000
461500                                                  (PV-SUB)        46150000
461600                MOVE DP015-REVERSE         TO MR-SKUH             46160000
461700*02-16-99                                         (PV-DUP-COUNT)  46170000
461800                                                  (PV-SUB)        46180000
461900                MOVE DP015-RED             TO MR-SKUC             46190000
462000*02-16-99                                         (PV-DUP-COUNT)  46200000
462100                                                  (PV-SUB)        46210000
462200             END-IF                                               46220000
462300             MOVE +0                    TO AHDFRGTL               46230000
462400             IF PS-NO-ERROR                                       46240000
462500                MOVE PC-TSYMSG-01938 TO DP020-MSG-NUMBER          46250000
462600             END-IF                                               46260000
462700             SET PS-ERROR TO TRUE                                 46270000
462800             SET DP030-OVERRIDE-GO TO TRUE                        46280000
462900           WHEN PV-CLASS-ENTRY (ENTRY-IDX) = LOW-VALUES AND       46290000
463000                PV-STORE-ENTRY (ENTRY-IDX) = LOW-VALUES AND       46300000
463100                PV-SKU-ENTRY   (ENTRY-IDX) = LOW-VALUES           46310000
463200                NEXT SENTENCE                                     46320000
463300        END-SEARCH.                                               46330000
463400*    ELSE                                                         46340000
463500*    END-IF.                                                      46350000
463600                                                                  46360000
463700*----------------------------------------------------------------*46370000
463800*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *46380000
463900*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *46390000
464000*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *46400000
464100*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *46410000
464200*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *46420000
464300*                                                                *46430000
464400*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *46440000
464500*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *46450000
464600*    UPON INITIALIZATION.                                        *46460000
464700*----------------------------------------------------------------*46470000
464800 4300-READ-ITEMS-FROM-DB.                                         46480000
464900                                                                  46490000
465000     PERFORM                                                      46500000
465100         VARYING PV-READ-COUNT                                    46510000
465200         FROM 1 BY 1                                              46520000
465300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    46530000
465400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         46540000
465500                                                                  46550000
465600         PERFORM 4310-FETCH                                       46560000
465700                                                                  46570000
465800         IF  ASC-ITEMS-LEFT-ON-DB                                 46580000
465900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                46590000
466000                 ADD +1            TO ASC-ITEM-SUB                46600000
466100             ELSE                                                 46610000
466200                 ADD +1            TO ASC-BLK-SUB                 46620000
466300                 MOVE +1           TO ASC-ITEM-SUB                46630000
466400                                                                  46640000
466500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         46650000
466600                     MOVE +1       TO ASC-BLK-SUB                 46660000
466700                     SET ASC-BLOCK-MODIFIED (1)                   46670000
466800                                   TO TRUE                        46680000
466900                     PERFORM 5100-WRITE-TEMP-STORAGE              46690000
467000                     MOVE ASC-BLOCK-ENTRIES                       46700000
467100                               (PC-MAX-BLOCKS-IN-ARRAY)           46710000
467200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 46720000
467300                     ADD +1        TO ASC-BLK-SUB                 46730000
467400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   46740000
467500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      46750000
467600                                   TO TRUE                        46760000
467700                 END-IF                                           46770000
467800             END-IF                                               46780000
467900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    46790000
468000             MOVE ASC-NUMBER-OF-ITEMS-READ                        46800000
468100                                   TO ASC-LIST-ITEM-NUMBER        46810000
468200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  46820000
468300             MOVE ADJDIS-DISTRB-SEQ-NBR                           46830000
468400                                   TO ASC-DISTRB-SEQ-NBR          46840000
468500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  46850000
468600             MOVE ADJDIS-STR-NBR   TO ASC-STORE                   46860000
468700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  46870000
468800                                      ASC-ALP-STORE               46880000
468900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  46890000
469000             MOVE ADJDIS-DEPT-NBR  TO ASC-DEPT-NBR                46900000
469100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  46910000
469200             MOVE ADJDIS-CL-NBR    TO ASC-CLASS                   46920000
469300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  46930000
469400             MOVE ADJDIS-SKU-NBR   TO ASC-SKU                     46940000
469500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  46950000
469600             IF ASC-FREIGHT-COST-ALLOCATION                       46960000
469700                IF ADJDIS-FRGT-AMT NOT EQUAL ZERO                 46970000
469800                   MOVE ADJDIS-FRGT-AMT TO ASC-GROSS-COST         46980000
469900                                        (ASC-BLK-SUB ASC-ITEM-SUB)46990000
470000                ELSE                                              47000000
470100                   MOVE ZERO            TO ASC-GROSS-COST         47010000
470200                                        (ASC-BLK-SUB ASC-ITEM-SUB)47020000
470300                END-IF                                            47030000
470400             ELSE                                                 47040000
470500                IF ASC-NEW-STR-COST-ALLOCATION                    47050000
470600                   IF ADJDIS-DISC-AMT NOT EQUAL ZERO              47060000
470700                      MOVE ADJDIS-DISC-AMT TO ASC-GROSS-COST      47070000
470800                                        (ASC-BLK-SUB ASC-ITEM-SUB)47080000
470900                   ELSE                                           47090000
471000                      MOVE ZERO            TO ASC-GROSS-COST      47100000
471100                                        (ASC-BLK-SUB ASC-ITEM-SUB)47110000
471200                   END-IF                                         47120000
471300                ELSE                                              47130000
471400                   IF ADJDIS-GRO-COST-AMT NOT EQUAL ZERO          47140000
471500                      MOVE ADJDIS-GRO-COST-AMT TO ASC-GROSS-COST  47150000
471600                                        (ASC-BLK-SUB ASC-ITEM-SUB)47160000
471700                   ELSE                                           47170000
471800                      MOVE ZERO                TO ASC-GROSS-COST  47180000
471900                                        (ASC-BLK-SUB ASC-ITEM-SUB)47190000
472000                      MOVE ADJDIS-DISC-AMT     TO ASC-DISC-AMT    47200000
472100                                        (ASC-BLK-SUB ASC-ITEM-SUB)47210000
472200                   END-IF                                         47220000
472300                END-IF                                            47230000
472400             END-IF                                               47240000
472500             MOVE ADJDIS-FRGT-AMT     TO ASC-DT-FRGT-AMT          47250000
472600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 47260000
472700             IF ADJDIS-RTL-AMT NOT EQUAL ZERO                     47270000
472800                MOVE ADJDIS-RTL-AMT   TO ASC-RETAIL-AMT           47280000
472900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 47290000
473000             ELSE                                                 47300000
473100                MOVE ZERO             TO ASC-RETAIL-AMT           47310000
473200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 47320000
473300             END-IF                                               47330000
473400             MOVE ADJDIS-MISC-CHRG-AMT                            47340000
473500                                   TO ASC-DT-MISC-CHRG-AMT        47350000
473600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 47360000
473700             MOVE ADJDIS-NET-COST-AMT TO PV-10V99                 47370000
473800             MOVE PV-10V99            TO ASC-NET-COST             47380000
473900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 47390000
474000         END-IF                                                   47400000
474100     END-PERFORM.                                                 47410000
474200                                                                  47420000
474300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          47430000
474400         MOVE +1               TO ASC-BLK-SUB                     47440000
474500         PERFORM 5100-WRITE-TEMP-STORAGE                          47450000
474600         ADD +1                TO ASC-BLK-SUB                     47460000
474700         PERFORM 5100-WRITE-TEMP-STORAGE                          47470000
474800                                                                  47480000
474900         MOVE 1                TO ASC-BLK-SUB                     47490000
475000                                  PV-BLOCK-NUMBER                 47500000
475100         PERFORM 4410-READ-TEMP-STORAGE                           47510000
475200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             47520000
475300             MOVE 2            TO ASC-BLK-SUB                     47530000
475400                                  PV-BLOCK-NUMBER                 47540000
475500             PERFORM 4410-READ-TEMP-STORAGE                       47550000
475600         END-IF                                                   47560000
475700     END-IF.                                                      47570000
475800 EJECT                                                            47580000
475900******************************************************************47590000
476000* THIS PARAGRAPH WILL INITIALIZE THE DISTRIBUTION FIELDS IF IN   *47600000
476100* ADD MODE.                                                      *47610000
476200******************************************************************47620000
476300 4305-INITIALIZE-DISTRO.                                          47630000
476400                                                                  47640000
476500     PERFORM                                                      47650000
476600         VARYING PV-READ-COUNT                                    47660000
476700         FROM 1 BY 1                                              47670000
476800         UNTIL (PV-READ-COUNT > PC-MAX-ADD-ITEMS)                 47680000
476900                                                                  47690000
477000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                47700000
477100                 ADD +1            TO ASC-ITEM-SUB                47710000
477200             ELSE                                                 47720000
477300                 ADD +1            TO ASC-BLK-SUB                 47730000
477400                 MOVE +1           TO ASC-ITEM-SUB                47740000
477500                                                                  47750000
477600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         47760000
477700                     MOVE +1       TO ASC-BLK-SUB                 47770000
477800                     SET ASC-BLOCK-MODIFIED (1)                   47780000
477900                                   TO TRUE                        47790000
478000                     PERFORM 5100-WRITE-TEMP-STORAGE              47800000
478100                     MOVE ASC-BLOCK-ENTRIES                       47810000
478200                               (PC-MAX-BLOCKS-IN-ARRAY)           47820000
478300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 47830000
478400                     ADD +1        TO ASC-BLK-SUB                 47840000
478500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   47850000
478600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      47860000
478700                                   TO TRUE                        47870000
478800                 END-IF                                           47880000
478900             END-IF                                               47890000
479000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    47900000
479100             MOVE ASC-NUMBER-OF-ITEMS-READ                        47910000
479200                                   TO ASC-LIST-ITEM-NUMBER        47920000
479300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  47930000
479400             MOVE ASC-NUMBER-OF-ITEMS-READ                        47940000
479500                                   TO ASC-DISTRB-SEQ-NBR          47950000
479600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 47960000
479700             MOVE SPACES           TO ASC-ALP-STORE               47970000
479800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 47980000
479900             MOVE SPACES           TO ASC-DEPT-NBR                47990000
480000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48000000
480100             MOVE SPACES           TO ASC-CLASS                   48010000
480200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48020000
480300             MOVE ZERO             TO ASC-SKU                     48030000
480400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48040000
480500             MOVE ZERO             TO ASC-GROSS-COST              48050000
480600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48060000
480700             MOVE ZERO             TO ASC-RETAIL-AMT              48070000
480800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48080000
480900             MOVE ZERO             TO ASC-DT-FRGT-AMT             48090000
481000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48100000
481100             MOVE ZERO             TO ASC-DT-MISC-CHRG-AMT        48110000
481200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48120000
481300             MOVE ZERO             TO ASC-DISC-AMT                48130000
481400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48140000
481500             MOVE ZERO             TO ASC-NET-COST                48150000
481600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 48160000
481700     END-PERFORM.                                                 48170000
481800                                                                  48180000
481900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          48190000
482000         MOVE +1               TO ASC-BLK-SUB                     48200000
482100         PERFORM 5100-WRITE-TEMP-STORAGE                          48210000
482200         ADD +1                TO ASC-BLK-SUB                     48220000
482300         PERFORM 5100-WRITE-TEMP-STORAGE                          48230000
482400                                                                  48240000
482500         MOVE 1                TO ASC-BLK-SUB                     48250000
482600                                  PV-BLOCK-NUMBER                 48260000
482700         PERFORM 4410-READ-TEMP-STORAGE                           48270000
482800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             48280000
482900             MOVE 2            TO ASC-BLK-SUB                     48290000
483000                                  PV-BLOCK-NUMBER                 48300000
483100             PERFORM 4410-READ-TEMP-STORAGE                       48310000
483200         END-IF                                                   48320000
483300     END-IF.                                                      48330000
483400 EJECT                                                            48340000
483500*----------------------------------------------------------------*48350000
483600*    FETCH THE ADJUSTMENT DISTRIBUTION CURSOR.                   *48360000
483700*----------------------------------------------------------------*48370000
483800 4310-FETCH.                                                      48380000
483900                                                                  48390000
484000     EXEC SQL                                                     48400000
484100          FETCH DISTRO-CSR                                        48410000
484200          INTO  :ADJDIS-VND-NBR                                   48420000
484300              , :ADJDIS-DOC-NBR                                   48430000
484400              , :ADJDIS-DOC-DTE                                   48440000
484500              , :ADJDIS-AP-TRN-CDE                                48450000
484600              , :ADJDIS-DISTRB-SEQ-NBR                            48460000
484700              , :ADJDIS-STR-NBR                                   48470000
484800              , :ADJDIS-DEPT-NBR                                  48480000
484900              , :ADJDIS-CL-NBR                                    48490000
485000              , :ADJDIS-SKU-NBR                                   48500000
485100              , :ADJDIS-GRO-COST-AMT                              48510000
485200              , :ADJDIS-RTL-AMT                                   48520000
485300              , :ADJDIS-FRGT-AMT                                  48530000
485400              , :ADJDIS-MISC-CHRG-AMT                             48540000
485500              , :ADJDIS-DISC-AMT                                  48550000
485600              , :ADJDIS-NET-COST-AMT                              48560000
485700     END-EXEC                                                     48570000
485800                                                                  48580000
485900     EVALUATE TRUE                                                48590000
486000         WHEN SQLCODE = ZERO                                      48600000
486100         WHEN SQLCODE = +100                                      48610000
486200              CONTINUE                                            48620000
486300         WHEN SQLWARN0 NOT = SPACE                                48630000
486400         WHEN SQLCODE NOT = ZERO                                  48640000
486500              MOVE '4310-FETCH-CURSOR'                            48650000
486600                               TO DP013-PARAGRAPH                 48660000
486700              MOVE 'FETCH ADJUSTMENT CURSOR'                      48670000
486800                               TO DP013-MESSAGE-TEXT (1)          48680000
486900              MOVE SQLCA       TO DP013-SQLCA                     48690000
487000              SET DP013-DB2-ABEND                                 48700000
487100                               TO TRUE                            48710000
487200              PERFORM DP013-0000-PROCESS-ABEND                    48720000
487300     END-EVALUATE.                                                48730000
487400                                                                  48740000
487500     IF  SQLCODE EQUAL +100                                       48750000
487600         SET ASC-NO-ITEMS-LEFT-ON-DB                              48760000
487700                                   TO TRUE                        48770000
487800     END-IF.                                                      48780000
487900                                                                  48790000
488000 EJECT                                                            48800000
488100*----------------------------------------------------------------*48810000
488200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *48820000
488300*----------------------------------------------------------------*48830000
488400 4400-MOVE-COMMAREA-TO-SCREEN.                                    48840000
488500                                                                  48850000
488600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             48860000
488700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          48870000
488800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          48880000
488900             MOVE +1    TO ASC-BLK-SUB                            48890000
489000             PERFORM 5100-WRITE-TEMP-STORAGE                      48900000
489100             ADD +1     TO ASC-BLK-SUB                            48910000
489200             PERFORM 5100-WRITE-TEMP-STORAGE                      48920000
489300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             48930000
489400                 GIVING PV-BLOCK-NUMBER                           48940000
489500                 REMAINDER PV-REMAINDER                           48950000
489600             IF  PV-REMAINDER > ZERO                              48960000
489700                 ADD +1 TO PV-BLOCK-NUMBER                        48970000
489800             END-IF                                               48980000
489900             MOVE +1    TO ASC-BLK-SUB                            48990000
490000             PERFORM 4410-READ-TEMP-STORAGE                       49000000
490100             ADD +1     TO ASC-BLK-SUB                            49010000
490200                           PV-BLOCK-NUMBER                        49020000
490300             PERFORM 4410-READ-TEMP-STORAGE                       49030000
490400     END-IF.                                                      49040000
490500                                                                  49050000
490600     MOVE +1            TO ASC-BLK-SUB.                           49060000
490700                                                                  49070000
490800     COMPUTE ASC-ITEM-SUB =                                       49080000
490900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              49090000
491000         + PC-ITEMS-PER-PANEL).                                   49100000
491100                                                                  49110000
491200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        49120000
491300         ADD +1         TO ASC-BLK-SUB                            49130000
491400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            49140000
491500     END-IF.                                                      49150000
491600                                                                  49160000
491700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           49170000
491800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                49180000
491900                                                                  49190000
492000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        49200000
492100                                                                  49210000
492200     PERFORM 4420-FORMAT-LIST-LINES                               49220000
492300         VARYING PV-SUB                                           49230000
492400         FROM PC-ITEMS-PER-PANEL BY -1                            49240000
492500         UNTIL PV-SUB < +1.                                       49250000
492600                                                                  49260000
492700     COMPUTE ASC-ITEMS-DISPLAYED =                                49270000
492800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          49280000
492900                                                                  49290000
493000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    49300000
493100                                      ASTRTITO.                   49310000
493200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    49320000
493300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    49330000
493400     MOVE ASC-HD-STORE             TO AHDSTRO.                    49340000
493500     MOVE ASC-DOC-NBR              TO ADOCNUMO.                   49350000
493600     MOVE ASC-PO-NBR               TO APONUMO.                    49360000
493700     MOVE ASC-DEPT                 TO ADEPTO.                     49370000
493800     MOVE ASC-ACCOUNT              TO AACCNOO.                    49380000
493900     MOVE ASC-VND-NBR              TO AVNDNOO.                    49390000
494000     MOVE ASC-VND-NAME             TO AVNDNMO.                    49400000
494100                                                                  49410000
494200     IF ASC-ALP-HD-FRGT-AMT(2:12) NUMERIC                         49420000
494300        IF ASC-HD-FRGT-AMT = +0                                   49430000
494400           MOVE SPACES             TO AHDFRGTO                    49440000
494500                                      ASC-ALP-HD-FRGT-AMT         49450000
494600        ELSE                                                      49460000
494700           INITIALIZE PV-10V99                                    49470000
494800           MOVE ASC-HD-FRGT-AMT    TO PV-10V99                    49480000
494900           MOVE PV-10V99           TO AHDFRGTO                    49490000
495000                                      ASC-ALP-HD-FRGT-AMT         49500000
495100        END-IF                                                    49510000
495200     ELSE                                                         49520000
495300        MOVE ASC-ALP-HD-FRGT-AMT   TO AHDFRGTO                    49530000
495400     END-IF.                                                      49540000
495500                                                                  49550000
495600     IF ASC-ALP-HD-NEW-STR-AMT(2:12) NUMERIC                      49560000
495700        IF ASC-HD-NEW-STR-AMT = +0                                49570000
495800           MOVE SPACES             TO AHDNWSTO                    49580000
495900                                      ASC-ALP-HD-NEW-STR-AMT      49590000
496000        ELSE                                                      49600000
496100           INITIALIZE PV-10V99                                    49610000
496200           MOVE ASC-HD-NEW-STR-AMT TO PV-10V99                    49620000
496300           MOVE PV-10V99           TO AHDNWSTO                    49630000
496400                                      ASC-ALP-HD-NEW-STR-AMT      49640000
496500        END-IF                                                    49650000
496600     ELSE                                                         49660000
496700        MOVE ASC-ALP-HD-NEW-STR-AMT TO AHDNWSTO                   49670000
496800     END-IF.                                                      49680000
496900                                                                  49690000
497000     IF ASC-NEW-STR-COST-ALLOCATION                               49700000
497100        CONTINUE                                                  49710000
497200     ELSE                                                         49720000
497300        MOVE DP015-PRO-NOR-OFF TO AHDNWSTA                        49730000
497400        MOVE DP015-BLUE        TO AHDNWSTC                        49740000
497500     END-IF.                                                      49750000
497600                                                                  49760000
497700     IF ASC-ALP-HD-GRO-COST(2:12) NUMERIC                         49770000
497800        IF ASC-HD-GRO-COST = +0                                   49780000
497900           MOVE SPACES             TO AHDCSTO                     49790000
498000                                      ASC-ALP-HD-GRO-COST         49800000
498100        ELSE                                                      49810000
498200           INITIALIZE PV-10V99                                    49820000
498300           MOVE ASC-HD-GRO-COST    TO PV-10V99                    49830000
498400           MOVE PV-10V99           TO AHDCSTO                     49840000
498500                                      ASC-ALP-HD-GRO-COST         49850000
498600        END-IF                                                    49860000
498700     ELSE                                                         49870000
498800        MOVE ASC-ALP-HD-GRO-COST   TO AHDCSTO                     49880000
498900     END-IF.                                                      49890000
499000                                                                  49900000
499100     IF ASC-ALP-HD-RET-AMT(2:12) NUMERIC                          49910000
499200        IF ASC-HD-RET-AMT = +0                                    49920000
499300           MOVE SPACES             TO AHDRETO                     49930000
499400                                      ASC-ALP-HD-RET-AMT          49940000
499500        ELSE                                                      49950000
499600           INITIALIZE PV-10V99                                    49960000
499700           MOVE ASC-HD-RET-AMT     TO PV-10V99                    49970000
499800           MOVE PV-10V99           TO AHDRETO                     49980000
499900                                      ASC-ALP-HD-RET-AMT          49990000
500000        END-IF                                                    50000000
500100     ELSE                                                         50010000
500200        MOVE ASC-ALP-HD-RET-AMT    TO AHDRETO                     50020000
500300     END-IF.                                                      50030000
500400                                                                  50040000
500500     IF  DP020-MSG-NUMBER-X = SPACE                               50050000
500600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  50060000
500700*            --- MORE ITEMS TO DISPLAY ----                       50070000
500800             IF ASC-ACTION-SW NOT = 'ADD'                         50080000
500900                MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER          50090000
501000                SET DP020-MSG-INFORMATIONAL TO TRUE               50100000
501100             END-IF                                               50110000
501200         END-IF                                                   50120000
501300     END-IF.                                                      50130000
501400                                                                  50140000
501500*----------------------------------------------------------------*50150000
501600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *50160000
501700*----------------------------------------------------------------*50170000
501800 4410-READ-TEMP-STORAGE.                                          50180000
501900                                                                  50190000
502000     EXEC CICS                                                    50200000
502100         READQ TS                                                 50210000
502200             QUEUE (ASC-LIST-QUEUE-NAME)                          50220000
502300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               50230000
502400             ITEM  (PV-BLOCK-NUMBER)                              50240000
502500             RESP  (PV-CICS-RESP)                                 50250000
502600     END-EXEC.                                                    50260000
502700                                                                  50270000
502800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       50280000
502900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     50290000
503000         CONTINUE                                                 50300000
503100     ELSE                                                         50310000
503200         SET DP013-CICS-ABEND     TO TRUE                         50320000
503300         SET DP013-NO-ROLLBACK    TO TRUE                         50330000
503400         MOVE '4410-READ-TEMP-STORAGE'                            50340000
503500                                  TO DP013-PARAGRAPH              50350000
503600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      50360000
503700                                  TO DP013-MESSAGE-TEXT(1)        50370000
503800         PERFORM DP013-0000-PROCESS-ABEND                         50380000
503900     END-IF.                                                      50390000
504000                                                                  50400000
504100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             50410000
504200                                                                  50420000
504300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         50430000
504400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               50440000
504500     END-IF.                                                      50450000
504600 EJECT                                                            50460000
504700*----------------------------------------------------------------*50470000
504800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *50480000
504900*----------------------------------------------------------------*50490000
505000 4420-FORMAT-LIST-LINES.                                          50500000
505100                                                                  50510000
505200     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      50520000
505300         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                50530000
505400         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           50540000
505500                                    MR-STOREA  (PV-SUB)           50550000
505600                                    MR-CLASSA  (PV-SUB)           50560000
505700                                    MR-SKUA    (PV-SUB)           50570000
505800                                    MR-GROSSA  (PV-SUB)           50580000
505900                                    MR-RETAILA (PV-SUB)           50590000
506000         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           50600000
506100                                    MR-STOREH  (PV-SUB)           50610000
506200                                    MR-CLASSH  (PV-SUB)           50620000
506300                                    MR-SKUH    (PV-SUB)           50630000
506400                                    MR-GROSSH  (PV-SUB)           50640000
506500                                    MR-RETAILH (PV-SUB)           50650000
506600         MOVE SPACE              TO MR-SELECTI (PV-SUB)           50660000
506700                                    MR-STORE  (PV-SUB)            50670000
506800                                    MR-CLASS  (PV-SUB)            50680000
506900                                    MR-SKU    (PV-SUB)            50690000
507000                                    MR-GROSS  (PV-SUB)            50700000
507100                                    MR-RETAIL (PV-SUB)            50710000
507200                                    MR-NET    (PV-SUB)            50720000
507300     ELSE                                                         50730000
507400         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      50740000
507500                                                   > SPACE        50750000
507600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 50760000
507700                                 TO MR-SELECTI (PV-SUB)           50770000
507800         ELSE                                                     50780000
507900             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      50790000
508000                                 TO MR-SELECTI (PV-SUB)           50800000
508100         END-IF                                                   50810000
508200                                                                  50820000
508300         IF  DP030-SET-CURSOR-TRAILER                             50830000
508400             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)50840000
508500                 > SPACE)                                         50850000
508600               OR (PV-SUB = 1))                                   50860000
508700                SET DP030-SET-CURSOR-APPL-1 TO TRUE               50870000
508800                MOVE -1          TO MR-SELECTL (PV-SUB)           50880000
508900             END-IF                                               50890000
509000         END-IF                                                   50900000
509100                                                                  50910000
509200         IF ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB) NUMERIC      50920000
509300            MOVE ASC-STORE (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-NUM4  50930000
509400            MOVE PV-NUM4-X   TO MR-STORE       (PV-SUB)           50940000
509500         ELSE                                                     50950000
509600            MOVE ASC-ALP-STORE (ASC-BLK-SUB ASC-ITEM-SUB)         50960000
509700                             TO MR-STORE       (PV-SUB)           50970000
509800         END-IF                                                   50980000
509900                                                                  50990000
510000         MOVE ASC-CLASS  (ASC-BLK-SUB ASC-ITEM-SUB)               51000000
510100                             TO MR-CLASS       (PV-SUB)           51010000
510200                                                                  51020000
510300         IF ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL ZERO         51030000
510400            MOVE SPACES      TO MR-SKU   (PV-SUB)                 51040000
510500         ELSE                                                     51050000
510600            INITIALIZE PV-NUM8                                    51060000
510700            MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB) TO PV-NUM8    51070000
510800            MOVE PV-NUM8-X   TO MR-SKU (PV-SUB)                   51080000
510900         END-IF                                                   51090000
511000                                                                  51100000
511100         IF ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL ZERO  51110000
511200            MOVE SPACES      TO MR-GROSS    (PV-SUB)              51120000
511300         ELSE                                                     51130000
511400            INITIALIZE PV-10V99                                   51140000
511500            MOVE ASC-GROSS-COST (ASC-BLK-SUB ASC-ITEM-SUB)        51150000
511600                                 TO PV-10V99                      51160000
511700            MOVE PV-10V99    TO  MR-GROSS   (PV-SUB)              51170000
511800         END-IF                                                   51180000
511900                                                                  51190000
512000         IF ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL ZERO  51200000
512100            MOVE SPACES      TO MR-RETAIL     (PV-SUB)            51210000
512200         ELSE                                                     51220000
512300            INITIALIZE PV-10V99                                   51230000
512400            MOVE ASC-RETAIL-AMT (ASC-BLK-SUB ASC-ITEM-SUB)        51240000
512500                                 TO PV-10V99                      51250000
512600            MOVE PV-10V99    TO MR-RETAIL     (PV-SUB)            51260000
512700         END-IF                                                   51270000
512800                                                                  51280000
512900         IF ASC-NET-COST (ASC-BLK-SUB ASC-ITEM-SUB) EQUAL ZERO    51290000
513000            MOVE SPACES   TO MR-NET             (PV-SUB)          51300000
513100         ELSE                                                     51310000
513200            INITIALIZE PV-10V99                                   51320000
513300            MOVE ASC-NET-COST (ASC-BLK-SUB ASC-ITEM-SUB) TO       51330000
513400                               PV-10V99                           51340000
513500            MOVE PV-10V99 TO MR-NET             (PV-SUB)          51350000
513600         END-IF                                                   51360000
513700     END-IF.                                                      51370000
513800                                                                  51380000
513900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               51390000
514000                                                                  51400000
514100     IF  ASC-ITEM-SUB < + 1                                       51410000
514200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  51420000
514300         MOVE +1                 TO ASC-BLK-SUB                   51430000
514400     END-IF.                                                      51440000
514500                                                                  51450000
514600******************************************************************51460000
514700** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **51470000
514800** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **51480000
514900** ISSUE A WARNING.                                             **51490000
515000******************************************************************51500000
515100 4430-CHECK-FOR-BEGIN-AND-END.                                    51510000
515200                                                                  51520000
515300     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       51530000
515400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     51540000
515500*            -- NO END-OF-RANGE SPECFIED ---                      51550000
515600             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            51560000
515700             SET DP020-MSG-WARNING TO TRUE                        51570000
515800             PERFORM 4431-POSITION-AT-WARNING                     51580000
515900         END-IF                                                   51590000
516000     ELSE                                                         51600000
516100         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     51610000
516200*            -- NO BEGINNING-OF-RANGE SPECFIED ---                51620000
516300             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            51630000
516400             SET DP020-MSG-WARNING TO TRUE                        51640000
516500             PERFORM 4431-POSITION-AT-WARNING                     51650000
516600         END-IF                                                   51660000
516700     END-IF.                                                      51670000
516800                                                                  51680000
516900******************************************************************51690000
517000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **51700000
517100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **51710000
517200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **51720000
517300** POSITION THE CURSOR THERE.                                   **51730000
517400******************************************************************51740000
517500 4431-POSITION-AT-WARNING.                                        51750000
517600                                                                  51760000
517700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 51770000
517800                    - PV-TOP-ITEM + 1.                            51780000
517900                                                                  51790000
518000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      51800000
518100         CONTINUE                                                 51810000
518200     ELSE                                                         51820000
518300         SET DP030-SET-CURSOR-APPL-1                              51830000
518400                                   TO TRUE                        51840000
518500         MOVE -1                   TO MR-SELECTL (PV-SUB)         51850000
518600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         51860000
518700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         51870000
518800     END-IF.                                                      51880000
518900                                                                  51890000
519000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   51900000
519100                    - PV-TOP-ITEM + 1.                            51910000
519200                                                                  51920000
519300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      51930000
519400         CONTINUE                                                 51940000
519500     ELSE                                                         51950000
519600         SET DP030-SET-CURSOR-APPL-1                              51960000
519700                                   TO TRUE                        51970000
519800         MOVE -1                   TO MR-SELECTL (PV-SUB)         51980000
519900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         51990000
520000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         52000000
520100     END-IF.                                                      52010000
520200 EJECT                                                            52020000
520300*----------------------------------------------------------------*52030000
520400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *52040000
520500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *52050000
520600*----------------------------------------------------------------*52060000
520700 5100-WRITE-TEMP-STORAGE.                                         52070000
520800                                                                  52080000
520900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     52090000
521000                                   TO PV-LIST-ITEM-NUMBER.        52100000
521100                                                                  52110000
521200     COMPUTE PV-BLOCK-NUMBER =                                    52120000
521300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    52130000
521400                                                                  52140000
521500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             52150000
521600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             52160000
521700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      52170000
521800             PERFORM 5105-REWRITE-ASC-LISTQ                       52180000
521900         END-IF                                                   52190000
522000     ELSE                                                         52200000
522100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       52210000
522200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            52220000
522300         PERFORM 5110-WRITE-ASC-LISTQ                             52230000
522400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   52240000
522500     END-IF.                                                      52250000
522600                                                                  52260000
522700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             52270000
522800                                                                  52280000
522900******************************************************************52290000
523000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **52300000
523100** SPECIFIC COMMAREA.                                           **52310000
523200******************************************************************52320000
523300 5105-REWRITE-ASC-LISTQ.                                          52330000
523400                                                                  52340000
523500     EXEC CICS                                                    52350000
523600         WRITEQ TS                                                52360000
523700             QUEUE (ASC-LIST-QUEUE-NAME)                          52370000
523800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               52380000
523900             ITEM  (PV-BLOCK-NUMBER)                              52390000
524000             REWRITE                                              52400000
524100             RESP  (PV-CICS-RESP)                                 52410000
524200     END-EXEC.                                                    52420000
524300                                                                  52430000
524400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           52440000
524500         CONTINUE                                                 52450000
524600     ELSE                                                         52460000
524700         SET DP013-CICS-ABEND            TO TRUE                  52470000
524800         SET DP013-NO-ROLLBACK           TO TRUE                  52480000
524900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       52490000
525000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     52500000
525100                                         TO DP013-MESSAGE-TEXT(1) 52510000
525200         PERFORM DP013-0000-PROCESS-ABEND                         52520000
525300     END-IF.                                                      52530000
525400                                                                  52540000
525500******************************************************************52550000
525600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **52560000
525700** SPECIFIC COMMAREA.                                           **52570000
525800******************************************************************52580000
525900 5110-WRITE-ASC-LISTQ.                                            52590000
526000                                                                  52600000
526100     EXEC CICS                                                    52610000
526200         WRITEQ TS                                                52620000
526300             QUEUE (ASC-LIST-QUEUE-NAME)                          52630000
526400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               52640000
526500             ITEM  (PV-BLOCK-NUMBER)                              52650000
526600             RESP  (PV-CICS-RESP)                                 52660000
526700     END-EXEC.                                                    52670000
526800                                                                  52680000
526900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      52690000
527000         SET DP013-CICS-ABEND      TO TRUE                        52700000
527100         SET DP013-NO-ROLLBACK     TO TRUE                        52710000
527200         MOVE '5110-WRITE-ASC-LISTQ'                              52720000
527300                                   TO DP013-PARAGRAPH             52730000
527400         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           52740000
527500                                   TO DP013-MESSAGE-TEXT(1)       52750000
527600         PERFORM DP013-0000-PROCESS-ABEND                         52760000
527700     END-IF.                                                      52770000
527800 EJECT                                                            52780000
527900******************************************************************52790000
528000*    READ THE TEMPORARY QUEUE FOR THE DATA PASSED FROM THE       *52800000
528100*    HEADER SCREEN.                                              *52810000
528200******************************************************************52820000
528300 6108-READ-TEMP-QUEUE.                                            52830000
528400                                                                  52840000
528500     EXEC CICS                                                    52850000
528600          READQ TS                                                52860000
528700              QUEUE (ASC-TS-QUEUE-NAME)                           52870000
528800              INTO  (AP363-ADJUST-HEADER-AREA)                    52880000
528900              ITEM  (PV-SEL-QUEUE-ITEM)                           52890000
529000              RESP  (PV-CICS-RESP)                                52900000
529100     END-EXEC.                                                    52910000
529200                                                                  52920000
529300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          52930000
529400         CONTINUE                                                 52940000
529500     ELSE                                                         52950000
529600         SET DP013-CICS-ABEND      TO  TRUE                       52960000
529700         SET DP013-NO-ROLLBACK     TO  TRUE                       52970000
529800         MOVE '6108-READ-TEMP-QUEU'                               52980000
529900                                   TO  DP013-PARAGRAPH            52990000
530000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           53000000
530100                                   TO  DP013-MESSAGE-TEXT(1)      53010000
530200         PERFORM DP013-0000-PROCESS-ABEND                         53020000
530300     END-IF.                                                      53030000
530400 EJECT                                                            53040000
530500******************************************************************53050000
530600* THIS PARAGRAPH WILL DELETE THE TEMPORARY QUEUE THAT IS USED    *53060000
530700* TO PASS DATA FROM THE ADJUSTMENT HEADER SCREEN TO THE          *53070000
530800* ADJUSTMENT DETAIL SCREEN.                                      *53080000
530900******************************************************************53090000
531000 6109-DELETE-TEMP-QUEUE.                                          53100000
531100                                                                  53110000
531200     EXEC CICS                                                    53120000
531300         DELETEQ TS                                               53130000
531400             QUEUE (ASC-TS-QUEUE-NAME)                            53140000
531500             RESP  (PV-CICS-RESP)                                 53150000
531600     END-EXEC.                                                    53160000
531700                                                                  53170000
531800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       53180000
531900       (PV-CICS-RESP = DFHRESP(QIDERR))                           53190000
532000         CONTINUE                                                 53200000
532100     ELSE                                                         53210000
532200        SET DP013-CICS-ABEND TO TRUE                              53220000
532300        SET DP013-NO-ROLLBACK TO TRUE                             53230000
532400                                                                  53240000
532500        MOVE '6109-DELETE-TEMP-QUEUE  ' TO DP013-PARAGRAPH        53250000
532600        MOVE 'ERROR TRYING TO DELETE TEMP STORAGE QUEUE       '   53260000
532700                        TO DP013-MESSAGE-TEXT (1)                 53270000
532800        PERFORM DP013-0000-PROCESS-ABEND                          53280000
532900     END-IF.                                                      53290000
533000                                                                  53300000
533100******************************************************************53310000
533200* THIS PARAGRAPH WILL FORMAT THE DATA BEFORE ANY DB2 IS          *53320000
533300* PERFORMED.                                                     *53330000
533400******************************************************************53340000
533500 6500-FORMAT-HEADER-DCLGEN.                                       53350000
533600                                                                  53360000
533700     INITIALIZE DCLTADJRNL                                        53370000
533800                DCLTAJPSINT.                                      53380000
533900                                                                  53390000
534000     MOVE ASC-VND-NBR                 TO ADJRNL-VND-NBR           53400000
534100                                         AJPSINT-VND-NBR.         53410000
534200     MOVE ASC-DOC-NBR                 TO ADJRNL-DOC-NBR           53420000
534300                                         AJPSINT-DOC-NBR.         53430000
534400     MOVE ASC-DOC-DTE                 TO ADJRNL-DOC-DTE           53440000
534500                                         AJPSINT-DOC-DTE.         53450000
534600     MOVE ASC-AP-TRN-CDE              TO ADJRNL-AP-TRN-CDE        53460000
534700                                         AJPSINT-AP-TRN-CDE.      53470000
534800                                                                  53480000
534900     MOVE ASC-PO-NBR                  TO ADJRNL-PO-NBR.           53490000
535000     MOVE ASC-DEPT                    TO ADJRNL-DEPT-NBR.         53500000
535100     MOVE ASC-ACCOUNT                 TO ADJRNL-GL-ACCT-NBR.      53510000
535200     MOVE ASC-HD-STORE                TO ADJRNL-STR-NBR.          53520000
535300     MOVE ASC-ENTR-ID                 TO ADJRNL-ENTR-ID.          53530000
535400     MOVE ASC-ORGN-CDE                TO ADJRNL-ORGN-CDE.         53540000
535500     MOVE ASC-HD-GRO-COST             TO ADJRNL-GRO-COST-AMT.     53550000
535600     MOVE ASC-HD-RET-AMT              TO ADJRNL-RTL-AMT.          53560000
535700     MOVE ASC-HD-FRGT-AMT             TO ADJRNL-FRGT-AMT.         53570000
535800     MOVE ASC-MISC-CHRG-AMT           TO ADJRNL-MISC-CHRG-AMT.    53580000
535900     MOVE ASC-TERM-DISC-PCT           TO ADJRNL-TERM-DISC-PCT.    53590000
536000     MOVE ASC-TERM-DISC-AMT           TO ADJRNL-TERM-DISC-AMT.    53600000
536100     MOVE ASC-NW-STR-DISC-PCT         TO ADJRNL-NW-STR-DISC-PCT.  53610000
536200     MOVE ASC-HD-NEW-STR-AMT          TO ADJRNL-NW-STR-DISC-AMT.  53620000
536300     MOVE ASC-TRD-DISC-PCT            TO ADJRNL-TRD-DISC-PCT.     53630000
536400     MOVE ASC-TRD-DISC-AMT            TO ADJRNL-TRD-DISC-AMT.     53640000
536500     MOVE ASC-CUTOFF-DATE             TO ADJRNL-INV-CTOFF-DTE.    53650000
536600     MOVE ASC-TRN-TYP-CDE             TO ADJRNL-TRN-TYP-CDE.      53660000
536700     MOVE ASC-PS-BTCH-NBR             TO ADJRNL-PS-BTCH-NBR.      53670000
536800     MOVE ASC-DOC-EXTR-DTE            TO ADJRNL-DOC-EXTR-DTE.     53680000
536900     MOVE ASC-DOC-EXTR-IND            TO ADJRNL-DOC-EXTR-IND.     53690000
537000     MOVE ASC-PS-PSTG-IND             TO ADJRNL-PS-PSTG-IND.      53700000
537100     MOVE ASC-BRCDE-NBR               TO ADJRNL-BRCDE-NBR.        53710000
537200     MOVE ASC-PSTG-FYR-NBR            TO ADJRNL-PSTG-FYR-NBR.     53720000
537300     MOVE ASC-PSTG-FMN-NBR            TO ADJRNL-PSTG-FMN-NBR.     53730000
537400     MOVE ASC-PSTG-FWK-NBR            TO ADJRNL-PSTG-FWK-NBR.     53740000
537500     MOVE ASC-ENT-ID                  TO ADJRNL-ENT-ID.           53750000
537600     MOVE ASC-MOS-DISC-PCT            TO ADJRNL-MOS-DISC-PCT.     53760000
537700     MOVE ASC-MOS-DISC-AMT            TO ADJRNL-MOS-DISC-AMT.     53770000
537800                                                                  53780000
537900** COMPUTE NEW NET COST IN THE CASE THAT THE RETAIL OR GROSS      53790000
538000** DOLLAR FIELDS WERE CHANGED ON THE DISTRIBUTION SCREEN.         53800000
538100     PERFORM 6550-CALCULATE-NET-COST.                             53810000
538200                                                                  53820000
538300     MOVE ASC-NET-COST-AMT            TO ADJRNL-NET-COST-AMT.     53830000
538400                                                                  53840000
538500     MOVE ASC-DUE-DTE                 TO AJPSINT-DUE-DTE.         53850000
538600     MOVE ASC-DOC-HLD-CDE             TO AJPSINT-DOC-HLD-CDE.     53860000
538700     MOVE ASC-RSN-1ST-LNE-TXT         TO AJPSINT-RSN-1ST-LNE-TXT. 53870000
538800     MOVE ASC-RSN-2ND-LNE-TXT         TO AJPSINT-RSN-2ND-LNE-TXT. 53880000
538900     MOVE ASC-AUTH-NBR                TO AJPSINT-AUTH-NBR.        53890000
539000                                                                  53900000
539100******************************************************************53910000
539200* THIS PARAGRAPH WILL FORMAT THE OFFSET DATA BEFORE ANY DB2 IS   *53920000
539300* PERFORMED.                                                     *53930000
539400******************************************************************53940000
539500 6501-FORMAT-OFFSET-HEADER.                                       53950000
539600                                                                  53960000
539700     INITIALIZE DCLTADJRNL                                        53970000
539800                DCLTAJPSINT.                                      53980000
539900                                                                  53990000
540000     MOVE ASC-VND-NBR                 TO ADJRNL-VND-NBR           54000000
540100                                         AJPSINT-VND-NBR.         54010000
540200     MOVE ASC-OFFSET-DOC-NBR          TO ADJRNL-DOC-NBR           54020000
540300                                         AJPSINT-DOC-NBR.         54030000
540400     MOVE ASC-DOC-DTE                 TO ADJRNL-DOC-DTE           54040000
540500                                         AJPSINT-DOC-DTE.         54050000
540600     MOVE ASC-OFFSET-TRAN-CD          TO ADJRNL-AP-TRN-CDE        54060000
540700                                         AJPSINT-AP-TRN-CDE.      54070000
540800                                                                  54080000
540900     MOVE ASC-PO-NBR                  TO ADJRNL-PO-NBR.           54090000
541000     MOVE SPACE                       TO ADJRNL-DEPT-NBR.         54100000
541100     MOVE ASC-OFFSET-ACCT-NO          TO ADJRNL-GL-ACCT-NBR.      54110000
541200     MOVE PC-STORE-90                 TO ADJRNL-STR-NBR.          54120000
541300     MOVE ASC-ENTR-ID                 TO ADJRNL-ENTR-ID.          54130000
541400     MOVE ASC-ORGN-CDE                TO ADJRNL-ORGN-CDE.         54140000
541500                                                                  54150000
541600     IF ASC-HD-GRO-COST >= 0                                      54160000
541700        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         54170000
541800* THE SIGN ON THE ADJRNL-GRO-COST-AMT FOR THE OFFSET HEADER       54180000
541900* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54190000
542000           MOVE ASC-HD-GRO-COST TO ADJRNL-GRO-COST-AMT            54200000
542100        ELSE                                                      54210000
542200           COMPUTE ADJRNL-GRO-COST-AMT = ASC-HD-GRO-COST * -1     54220000
542300        END-IF                                                    54230000
542400     ELSE                                                         54240000
542500        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         54250000
542600* THE SIGN ON THE GRO-COST-AMT FOR THE OFFSET HEADER MUST BE      54260000
542700* SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.             54270000
542800           MOVE ASC-HD-GRO-COST TO ADJRNL-GRO-COST-AMT            54280000
542900        ELSE                                                      54290000
543000           COMPUTE ADJRNL-GRO-COST-AMT = ASC-HD-GRO-COST * -1     54300000
543100        END-IF                                                    54310000
543200     END-IF.                                                      54320000
543300                                                                  54330000
543400* ZEROS ARE MOVED TO THE ADJRNL-RTL-AMT FOR THE OFFSET ADJUSTMENT 54340000
543500* HEADER SO THAT THE RETAIL AMOUNT FOR THE ORIGINATING ADJUSTMENT 54350000
543600* IS NOT CARRIED OVER TO THE OFFSET ADJUSTMENT.                   54360000
543700     MOVE ZEROS TO ADJRNL-RTL-AMT.                                54370000
543800*    MOVE ASC-HD-RET-AMT TO ADJRNL-RTL-AMT.                       54380000
543900                                                                  54390000
544000     IF ASC-HD-FRGT-AMT >= 0                                      54400000
544100        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         54410000
544200* THE SIGN ON THE ADJRNL-FRGT-AMT FOR THE OFFSET HEADER           54420000
544300* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54430000
544400           MOVE ASC-HD-FRGT-AMT TO ADJRNL-FRGT-AMT                54440000
544500        ELSE                                                      54450000
544600           COMPUTE ADJRNL-FRGT-AMT = ASC-HD-FRGT-AMT * -1         54460000
544700        END-IF                                                    54470000
544800     ELSE                                                         54480000
544900        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         54490000
545000* THE SIGN ON THE ADJRNL-FRGT-AMT FOR THE OFFSET HEADER           54500000
545100* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54510000
545200           MOVE ASC-HD-FRGT-AMT TO ADJRNL-FRGT-AMT                54520000
545300        ELSE                                                      54530000
545400           COMPUTE ADJRNL-FRGT-AMT = ASC-HD-FRGT-AMT * -1         54540000
545500        END-IF                                                    54550000
545600     END-IF.                                                      54560000
545700                                                                  54570000
545800     IF ASC-MISC-CHRG-AMT >= 0                                    54580000
545900        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         54590000
546000* THE SIGN ON THE ADJRNL-MISC-CHRG-AMT FOR THE OFFSET HEADER      54600000
546100* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54610000
546200           MOVE ASC-MISC-CHRG-AMT TO ADJRNL-MISC-CHRG-AMT         54620000
546300        ELSE                                                      54630000
546400           COMPUTE ADJRNL-MISC-CHRG-AMT = ASC-MISC-CHRG-AMT * -1  54640000
546500        END-IF                                                    54650000
546600     ELSE                                                         54660000
546700        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         54670000
546800* THE SIGN ON THE ADJRNL-MISC-CHRG-AMT FOR THE OFFSET HEADER      54680000
546900* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54690000
547000           MOVE ASC-MISC-CHRG-AMT TO ADJRNL-MISC-CHRG-AMT         54700000
547100        ELSE                                                      54710000
547200           COMPUTE ADJRNL-MISC-CHRG-AMT = ASC-MISC-CHRG-AMT * -1  54720000
547300        END-IF                                                    54730000
547400     END-IF.                                                      54740000
547500                                                                  54750000
547600     IF ASC-TERM-DISC-AMT >= 0                                    54760000
547700        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         54770000
547800* THE SIGN ON THE ADJRNL-TERM-DISC-AMT FOR THE OFFSET HEADER      54780000
547900* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54790000
548000           MOVE ASC-TERM-DISC-AMT TO ADJRNL-TERM-DISC-AMT         54800000
548100        ELSE                                                      54810000
548200           COMPUTE ADJRNL-TERM-DISC-AMT = ASC-TERM-DISC-AMT * -1  54820000
548300        END-IF                                                    54830000
548400     ELSE                                                         54840000
548500        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         54850000
548600* THE SIGN ON THE ADJRNL-TERM-DISC-AMT FOR THE OFFSET HEADER      54860000
548700* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54870000
548800           MOVE ASC-TERM-DISC-AMT TO ADJRNL-TERM-DISC-AMT         54880000
548900        ELSE                                                      54890000
549000           COMPUTE ADJRNL-TERM-DISC-AMT = ASC-TERM-DISC-AMT * -1  54900000
549100        END-IF                                                    54910000
549200     END-IF.                                                      54920000
549300                                                                  54930000
549400     IF ASC-HD-NEW-STR-AMT >= 0                                   54940000
549500        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         54950000
549600* THE SIGN ON THE ADJRNL-NW-STR-DISC-AMT FOR THE OFFSET HEADER    54960000
549700* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     54970000
549800           MOVE ASC-HD-NEW-STR-AMT TO ADJRNL-NW-STR-DISC-AMT      54980000
549900        ELSE                                                      54990000
550000           COMPUTE ADJRNL-NW-STR-DISC-AMT =                       55000000
550100                                          ASC-HD-NEW-STR-AMT * -1 55010000
550200        END-IF                                                    55020000
550300     ELSE                                                         55030000
550400        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         55040000
550500* THE SIGN ON THE ADJRNL-NW-STR-DISC-AMT FOR THE OFFSET HEADER    55050000
550600* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     55060000
550700           MOVE ASC-HD-NEW-STR-AMT TO ADJRNL-NW-STR-DISC-AMT      55070000
550800        ELSE                                                      55080000
550900           COMPUTE ADJRNL-NW-STR-DISC-AMT =                       55090000
551000                                          ASC-HD-NEW-STR-AMT * -1 55100000
551100        END-IF                                                    55110000
551200     END-IF.                                                      55120000
551300                                                                  55130000
551400     IF ASC-TRD-DISC-AMT >= 0                                     55140000
551500        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         55150000
551600* THE SIGN ON THE ADJRNL-TRD-DISC-AMT FOR THE OFFSET HEADER       55160000
551700* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     55170000
551800           MOVE ASC-TRD-DISC-AMT TO ADJRNL-TRD-DISC-AMT           55180000
551900        ELSE                                                      55190000
552000           COMPUTE ADJRNL-TRD-DISC-AMT = ASC-TRD-DISC-AMT * -1    55200000
552100        END-IF                                                    55210000
552200     ELSE                                                         55220000
552300        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         55230000
552400* THE SIGN ON THE ADJRNL-TRD-DISC-AMT FOR THE OFFSET HEADER       55240000
552500* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     55250000
552600           MOVE ASC-TRD-DISC-AMT TO ADJRNL-TRD-DISC-AMT           55260000
552700        ELSE                                                      55270000
552800           COMPUTE ADJRNL-TRD-DISC-AMT = ASC-TRD-DISC-AMT * -1    55280000
552900        END-IF                                                    55290000
553000     END-IF.                                                      55300000
553100                                                                  55310000
553200     IF ASC-MOS-DISC-AMT >= 0                                     55320000
553300        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         55330000
553400* THE SIGN ON THE ADJRNL-MOS-DISC-AMT FOR THE OFFSET HEADER       55340000
553500* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     55350000
553600           MOVE ASC-MOS-DISC-AMT TO ADJRNL-MOS-DISC-AMT           55360000
553700        ELSE                                                      55370000
553800           COMPUTE ADJRNL-MOS-DISC-AMT = ASC-MOS-DISC-AMT * -1    55380000
553900        END-IF                                                    55390000
554000     ELSE                                                         55400000
554100        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         55410000
554200* THE SIGN ON THE ADJRNL-MOS-DISC-AMT FOR THE OFFSET HEADER       55420000
554300* MUST BE SIGNED BASED ON THE OFFSET POSTING TYPE CODE VALUE.     55430000
554400           MOVE ASC-MOS-DISC-AMT TO ADJRNL-MOS-DISC-AMT           55440000
554500        ELSE                                                      55450000
554600           COMPUTE ADJRNL-MOS-DISC-AMT = ASC-MOS-DISC-AMT * -1    55460000
554700        END-IF                                                    55470000
554800     END-IF.                                                      55480000
554900                                                                  55490000
555000     MOVE ASC-TERM-DISC-PCT           TO ADJRNL-TERM-DISC-PCT.    55500000
555100     MOVE ASC-NW-STR-DISC-PCT         TO ADJRNL-NW-STR-DISC-PCT.  55510000
555200     MOVE ASC-TRD-DISC-PCT            TO ADJRNL-TRD-DISC-PCT.     55520000
555300     MOVE ASC-MOS-DISC-PCT            TO ADJRNL-MOS-DISC-PCT.     55530000
555400     MOVE ASC-CUTOFF-DATE             TO ADJRNL-INV-CTOFF-DTE.    55540000
555500     MOVE PC-EXP-TRN-TYP-CDE          TO ADJRNL-TRN-TYP-CDE.      55550000
555600     MOVE ASC-PS-BTCH-NBR             TO PV-OFFSET-BTCH-NBR.      55560000
555700     MOVE ASC-OFFSET-BTCH-SRC-CDE     TO PV-OFFSET-BTCH-SRC-CDE.  55570000
555800     MOVE PV-OFFSET-BTCH-NBR          TO ADJRNL-PS-BTCH-NBR.      55580000
555900     MOVE ASC-DOC-EXTR-DTE            TO ADJRNL-DOC-EXTR-DTE.     55590000
556000     MOVE ASC-DOC-EXTR-IND            TO ADJRNL-DOC-EXTR-IND.     55600000
556100     MOVE ASC-PS-PSTG-IND             TO ADJRNL-PS-PSTG-IND.      55610000
556200     MOVE ASC-BRCDE-NBR               TO ADJRNL-BRCDE-NBR.        55620000
556300     MOVE ASC-PSTG-FYR-NBR            TO ADJRNL-PSTG-FYR-NBR.     55630000
556400     MOVE ASC-PSTG-FMN-NBR            TO ADJRNL-PSTG-FMN-NBR.     55640000
556500     MOVE ASC-PSTG-FWK-NBR            TO ADJRNL-PSTG-FWK-NBR.     55650000
556600     MOVE ASC-ENT-ID                  TO ADJRNL-ENT-ID.           55660000
556700                                                                  55670000
556800** COMPUTE NEW NET COST IN THE CASE THAT THE RETAIL OR GROSS      55680000
556900** DOLLAR FIELDS WERE CHANGED ON THE DISTRIBUTION SCREEN.         55690000
557000     PERFORM 6551-CALCULATE-OFFSET-NET-COST.                      55700000
557100     MOVE PV-OFFSET-NET-COST-AMT TO ADJRNL-NET-COST-AMT           55710000
557200                                    ASC-OFFSET-NET-COST-AMT.      55720000
557300                                                                  55730000
557400     MOVE ASC-DUE-DTE                 TO AJPSINT-DUE-DTE.         55740000
557500     MOVE ASC-DOC-HLD-CDE             TO AJPSINT-DOC-HLD-CDE.     55750000
557600     MOVE ASC-RSN-1ST-LNE-TXT         TO AJPSINT-RSN-1ST-LNE-TXT. 55760000
557700     MOVE ASC-RSN-2ND-LNE-TXT         TO AJPSINT-RSN-2ND-LNE-TXT. 55770000
557800     MOVE ASC-AUTH-NBR                TO AJPSINT-AUTH-NBR.        55780000
557900                                                                  55790000
558000******************************************************************55800000
558100* THIS PARAGRAPH WILL CALCULATE THE NET COST FOR THE ENTIRE      *55810000
558200* ADJUSTMENT.  THIS CALCULATION IS NEEDED IN CASE THE GROSS OR   *55820000
558300* RETAIL DOLLAR FIELDS ARE CHANGED ON THE DISTRIBUTION SCREEN.   *55830000
558400******************************************************************55840000
558500 6550-CALCULATE-NET-COST.                                         55850000
558600                                                                  55860000
558700     INITIALIZE PV-NET-COST.                                      55870000
558800                                                                  55880000
558900     COMPUTE ASC-NET-COST-AMT =                                   55890000
559000            (ASC-HD-GRO-COST     + ASC-HD-FRGT-AMT +              55900000
559100             ASC-MISC-CHRG-AMT - ASC-TERM-DISC-AMT -              55910000
559200             ASC-HD-NEW-STR-AMT - ASC-TRD-DISC-AMT -              55920000
559300             ASC-MOS-DISC-AMT).                                   55930000
559400                                                                  55940000
559500******************************************************************55950000
559600* THIS PARAGRAPH WILL CALCULATE THE NET COST FOR THE ENTIRE OFF- *55960000
559700* SET ADJUSTMENT. THIS CALCULATION IS NEEDED IN CASE THE GROSS OR*55970000
559800* RETAIL DOLLAR FIELDS ARE CHANGED ON THE DISTRIBUTION SCREEN.   *55980000
559900******************************************************************55990000
560000 6551-CALCULATE-OFFSET-NET-COST.                                  56000000
560100                                                                  56010000
560200     INITIALIZE PV-OFFSET-NET-COST-AMT.                           56020000
560300                                                                  56030000
560400* THE PV-OFFSET-NET-COST-AMT IS BEING CALCULATED USING THE INDI-  56040000
560500* VIDUAL TADJRNL FIELDS BECAUSE THESE HAVE ALREADY HAD THEIR SIGNS56050000
560600* CORRECTED, ACCORDING TO THE OFFSET POSTING TYPE CODE VALUE,     56060000
560700* IN PARAGRAPH 6501-FORMAT-OFFSET-HEADER.                         56070000
560800     COMPUTE PV-OFFSET-NET-COST-AMT =                             56080000
560900            (ADJRNL-GRO-COST-AMT + ADJRNL-FRGT-AMT +              56090000
561000             ADJRNL-MISC-CHRG-AMT - ADJRNL-TERM-DISC-AMT -        56100000
561100             ADJRNL-NW-STR-DISC-AMT - ADJRNL-TRD-DISC-AMT -       56110000
561200             ADJRNL-MOS-DISC-AMT).                                56120000
561300                                                                  56130000
561400******************************************************************56140000
561500* THIS PARAGRAPH WILL FORMAT THE ADJUSTMENT DISTRIBUTION LINE IN *56150000
561600* THE INSTANCE OF WHEN THERE IS A SINGLE DISTRIBUTION LINE.      *56160000
561700******************************************************************56170000
561800 6600-FORMAT-FOR-SINGLE-DIST.                                     56180000
561900                                                                  56190000
562000     MOVE ASC-KEY-AP-TRN-CDE          TO ADJDIS-AP-TRN-CDE.       56200000
562100     MOVE ASC-KEY-VND-NBR             TO ADJDIS-VND-NBR.          56210000
562200     MOVE ASC-KEY-DOC-NBR             TO ADJDIS-DOC-NBR.          56220000
562300     MOVE ASC-KEY-DOC-DTE             TO ADJDIS-DOC-DTE.          56230000
562400     MOVE ASC-DIS-DISTRB-SEQ          TO ADJDIS-DISTRB-SEQ-NBR.   56240000
562500     MOVE ASC-DIS-STR-NBR             TO ADJDIS-STR-NBR.          56250000
562600     MOVE ASC-DIS-CL-NBR              TO ADJDIS-CL-NBR.           56260000
562700     MOVE ASC-DIS-SKU-NBR             TO ADJDIS-SKU-NBR.          56270000
562800                                                                  56280000
562900     IF ASC-FREIGHT-COST-ALLOCATION                               56290000
563000        MOVE ASC-DIS-GRO-COST-AMT     TO ADJDIS-FRGT-AMT          56300000
563100        MOVE ZERO                     TO ADJDIS-GRO-COST-AMT      56310000
563200                                         ADJDIS-DISC-AMT          56320000
563300     ELSE                                                         56330000
563400        IF ASC-NEW-STR-COST-ALLOCATION                            56340000
563500           MOVE ASC-DIS-GRO-COST-AMT     TO ADJDIS-DISC-AMT       56350000
563600           MOVE ZERO                     TO ADJDIS-GRO-COST-AMT   56360000
563700                                            ADJDIS-FRGT-AMT       56370000
563800        ELSE                                                      56380000
563900           MOVE ASC-DIS-GRO-COST-AMT     TO ADJDIS-GRO-COST-AMT   56390000
564000           MOVE ASC-HD-FRGT-AMT          TO ADJDIS-FRGT-AMT       56400000
564100           MOVE ASC-TOTAL-DISC-AMT       TO ADJDIS-DISC-AMT       56410000
564200        END-IF                                                    56420000
564300     END-IF.                                                      56430000
564400                                                                  56440000
564500     MOVE ASC-DIS-RTL-AMT             TO ADJDIS-RTL-AMT.          56450000
564600     MOVE ASC-DIS-NET-COST-AMT        TO ADJDIS-NET-COST-AMT.     56460000
564700     MOVE ASC-DEPT                    TO ADJDIS-DEPT-NBR.         56470000
564800     MOVE ASC-MISC-CHRG-AMT           TO ADJDIS-MISC-CHRG-AMT.    56480000
564900                                                                  56490000
565000******************************************************************56500000
565100* THIS PARAGRAPH WILL FORMAT THE OFFSET ADJUSTMENT DISTRIB LINE  *56510000
565200* IN THE INSTANCE OF WHEN THERE IS A SINGLE DISTRIBUTION LINE    *56520000
565300* FOR THE ORGINATING ADJUSTMENT.                                 *56530000
565400******************************************************************56540000
565500 6601-FORMAT-OFFSET-SINGLE-DIST.                                  56550000
565600                                                                  56560000
565700     MOVE ASC-OFFSET-TRAN-CD          TO ADJDIS-AP-TRN-CDE.       56570000
565800     MOVE ASC-KEY-VND-NBR             TO ADJDIS-VND-NBR.          56580000
565900     MOVE ASC-OFFSET-DOC-NBR          TO ADJDIS-DOC-NBR.          56590000
566000     MOVE ASC-KEY-DOC-DTE             TO ADJDIS-DOC-DTE.          56600000
566100     MOVE ASC-DIS-DISTRB-SEQ          TO ADJDIS-DISTRB-SEQ-NBR.   56610000
566200     MOVE PC-STORE-90                 TO ADJDIS-STR-NBR.          56620000
566300     MOVE SPACE                       TO ADJDIS-CL-NBR.           56630000
566400     MOVE ZEROES                      TO ADJDIS-SKU-NBR.          56640000
566500                                                                  56650000
566600     IF ASC-FREIGHT-COST-ALLOCATION                               56660000
566700        IF ASC-DIS-GRO-COST-AMT >= 0                              56670000
566800           IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                      56680000
566900              MOVE ASC-DIS-GRO-COST-AMT TO ADJDIS-FRGT-AMT        56690000
567000           ELSE                                                   56700000
567100              COMPUTE ADJDIS-FRGT-AMT = ASC-DIS-GRO-COST-AMT * -1 56710000
567200           END-IF                                                 56720000
567300        ELSE                                                      56730000
567400           IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                      56740000
567500              MOVE ASC-DIS-GRO-COST-AMT TO ADJDIS-FRGT-AMT        56750000
567600           ELSE                                                   56760000
567700              COMPUTE ADJDIS-FRGT-AMT = ASC-DIS-GRO-COST-AMT * -1 56770000
567800           END-IF                                                 56780000
567900        END-IF                                                    56790000
568000        MOVE ZERO                     TO ADJDIS-GRO-COST-AMT      56800000
568100                                         ADJDIS-DISC-AMT          56810000
568200     ELSE                                                         56820000
568300        IF ASC-NEW-STR-COST-ALLOCATION                            56830000
568400           IF ASC-DIS-GRO-COST-AMT >= 0                           56840000
568500              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   56850000
568600                 MOVE ASC-DIS-GRO-COST-AMT TO ADJDIS-DISC-AMT     56860000
568700              ELSE                                                56870000
568800                 COMPUTE ADJDIS-DISC-AMT =                        56880000
568900                                      ASC-DIS-GRO-COST-AMT * -1   56890000
569000              END-IF                                              56900000
569100           ELSE                                                   56910000
569200              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   56920000
569300                 MOVE ASC-DIS-GRO-COST-AMT TO ADJDIS-DISC-AMT     56930000
569400              ELSE                                                56940000
569500                 COMPUTE ADJDIS-DISC-AMT =                        56950000
569600                                      ASC-DIS-GRO-COST-AMT * -1   56960000
569700              END-IF                                              56970000
569800           END-IF                                                 56980000
569900           MOVE ZERO                  TO ADJDIS-GRO-COST-AMT      56990000
570000                                         ADJDIS-FRGT-AMT          57000000
570100        ELSE                                                      57010000
570200           IF ASC-DIS-GRO-COST-AMT >= 0                           57020000
570300              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   57030000
570400                 MOVE ASC-DIS-GRO-COST-AMT TO ADJDIS-GRO-COST-AMT 57040000
570500              ELSE                                                57050000
570600                 COMPUTE ADJDIS-GRO-COST-AMT =                    57060000
570700                                      ASC-DIS-GRO-COST-AMT * -1   57070000
570800              END-IF                                              57080000
570900           ELSE                                                   57090000
571000              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   57100000
571100                 MOVE ASC-DIS-GRO-COST-AMT TO ADJDIS-GRO-COST-AMT 57110000
571200              ELSE                                                57120000
571300                 COMPUTE ADJDIS-GRO-COST-AMT =                    57130000
571400                                      ASC-DIS-GRO-COST-AMT * -1   57140000
571500              END-IF                                              57150000
571600           END-IF                                                 57160000
571700           IF ASC-HD-FRGT-AMT >= 0                                57170000
571800              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   57180000
571900                 MOVE ASC-HD-FRGT-AMT TO ADJDIS-FRGT-AMT          57190000
572000              ELSE                                                57200000
572100                 COMPUTE ADJDIS-FRGT-AMT =                        57210000
572200                                      ASC-HD-FRGT-AMT * -1        57220000
572300              END-IF                                              57230000
572400           ELSE                                                   57240000
572500              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   57250000
572600                 MOVE ASC-HD-FRGT-AMT TO ADJDIS-FRGT-AMT          57260000
572700              ELSE                                                57270000
572800                 COMPUTE ADJDIS-FRGT-AMT =                        57280000
572900                                      ASC-HD-FRGT-AMT * -1        57290000
573000              END-IF                                              57300000
573100           END-IF                                                 57310000
573200           IF ASC-TOTAL-DISC-AMT >= 0                             57320000
573300              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   57330000
573400                 MOVE ASC-TOTAL-DISC-AMT TO ADJDIS-DISC-AMT       57340000
573500              ELSE                                                57350000
573600                 COMPUTE ADJDIS-DISC-AMT =                        57360000
573700                                      ASC-TOTAL-DISC-AMT * -1     57370000
573800              END-IF                                              57380000
573900           ELSE                                                   57390000
574000              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   57400000
574100                 MOVE ASC-TOTAL-DISC-AMT TO ADJDIS-DISC-AMT       57410000
574200              ELSE                                                57420000
574300                 COMPUTE ADJDIS-DISC-AMT =                        57430000
574400                                      ASC-TOTAL-DISC-AMT * -1     57440000
574500              END-IF                                              57450000
574600           END-IF                                                 57460000
574700        END-IF                                                    57470000
574800     END-IF.                                                      57480000
574900                                                                  57490000
575000* ZEROS ARE MOVED TO THE ADJDIS-RTL-AMT FOR THE OFFSET ADJUSTMENT 57500000
575100* DISTRIB SO THAT THE RETAIL AMOUNT FOR THE ORIGINATING ADJUSTMENT57510000
575200* IS NOT CARRIED OVER TO THE OFFSET ADJUSTMENT.                   57520000
575300     MOVE ZEROS TO ADJDIS-RTL-AMT.                                57530000
575400*    COMPUTE ADJDIS-RTL-AMT       = ASC-DIS-RTL-AMT * -1.         57540000
575500                                                                  57550000
575600     IF ASC-DIS-NET-COST-AMT >= 0                                 57560000
575700        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         57570000
575800           MOVE ASC-DIS-NET-COST-AMT TO ADJDIS-NET-COST-AMT       57580000
575900        ELSE                                                      57590000
576000           COMPUTE ADJDIS-NET-COST-AMT =                          57600000
576100                                ASC-DIS-NET-COST-AMT * -1         57610000
576200        END-IF                                                    57620000
576300     ELSE                                                         57630000
576400        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         57640000
576500           MOVE ASC-DIS-NET-COST-AMT TO ADJDIS-NET-COST-AMT       57650000
576600        ELSE                                                      57660000
576700           COMPUTE ADJDIS-NET-COST-AMT =                          57670000
576800                                ASC-DIS-NET-COST-AMT * -1         57680000
576900        END-IF                                                    57690000
577000     END-IF.                                                      57700000
577100                                                                  57710000
577200     IF ASC-MISC-CHRG-AMT >= 0                                    57720000
577300        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         57730000
577400           MOVE ASC-MISC-CHRG-AMT TO ADJDIS-MISC-CHRG-AMT         57740000
577500        ELSE                                                      57750000
577600           COMPUTE ADJDIS-MISC-CHRG-AMT =                         57760000
577700                                ASC-MISC-CHRG-AMT * -1            57770000
577800        END-IF                                                    57780000
577900     ELSE                                                         57790000
578000        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         57800000
578100           MOVE ASC-MISC-CHRG-AMT TO ADJDIS-MISC-CHRG-AMT         57810000
578200        ELSE                                                      57820000
578300           COMPUTE ADJDIS-MISC-CHRG-AMT =                         57830000
578400                                ASC-MISC-CHRG-AMT * -1            57840000
578500        END-IF                                                    57850000
578600     END-IF.                                                      57860000
578700     MOVE SPACE                       TO ADJDIS-DEPT-NBR.         57870000
578800                                                                  57880000
578900******************************************************************57890000
579000* THIS PARAGRAPH WILL FORMAT THE OFFSET ADJUSTMENT DISTRIB LINE  *57900000
579100* IN THE INSTANCE OF WHEN THERE IS MULTIPLE DISTRIBUTION LINES   *57910000
579200* FOR THE ORGINATING ADJUSTMENT.                                 *57920000
579300******************************************************************57930000
579400 6602-FORMAT-OFFSET-SINGLE-DIST.                                  57940000
579500                                                                  57950000
579600     MOVE ASC-OFFSET-TRAN-CD          TO ADJDIS-AP-TRN-CDE.       57960000
579700     MOVE ASC-KEY-VND-NBR             TO ADJDIS-VND-NBR.          57970000
579800     MOVE ASC-OFFSET-DOC-NBR          TO ADJDIS-DOC-NBR.          57980000
579900     MOVE ASC-KEY-DOC-DTE             TO ADJDIS-DOC-DTE.          57990000
580000     MOVE ASC-DIS-DISTRB-SEQ          TO ADJDIS-DISTRB-SEQ-NBR.   58000000
580100     MOVE PC-STORE-90                 TO ADJDIS-STR-NBR.          58010000
580200     MOVE SPACE                       TO ADJDIS-CL-NBR.           58020000
580300     MOVE ZEROES                      TO ADJDIS-SKU-NBR.          58030000
580400                                                                  58040000
580500     IF ASC-FREIGHT-COST-ALLOCATION                               58050000
580600        IF ASC-HD-GRO-COST >= 0                                   58060000
580700           IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                      58070000
580800              MOVE ASC-HD-GRO-COST TO ADJDIS-FRGT-AMT             58080000
580900           ELSE                                                   58090000
581000              COMPUTE ADJDIS-FRGT-AMT = ASC-HD-GRO-COST * -1      58100000
581100           END-IF                                                 58110000
581200        ELSE                                                      58120000
581300           IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                      58130000
581400              MOVE ASC-HD-GRO-COST TO ADJDIS-FRGT-AMT             58140000
581500           ELSE                                                   58150000
581600              COMPUTE ADJDIS-FRGT-AMT = ASC-HD-GRO-COST * -1      58160000
581700           END-IF                                                 58170000
581800        END-IF                                                    58180000
581900        MOVE ZERO                  TO ADJDIS-GRO-COST-AMT         58190000
582000                                      ADJDIS-DISC-AMT             58200000
582100     ELSE                                                         58210000
582200        IF ASC-NEW-STR-COST-ALLOCATION                            58220000
582300           IF ASC-HD-GRO-COST >= 0                                58230000
582400              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   58240000
582500                 MOVE ASC-HD-GRO-COST TO ADJDIS-DISC-AMT          58250000
582600              ELSE                                                58260000
582700                 COMPUTE ADJDIS-DISC-AMT = ASC-HD-GRO-COST * -1   58270000
582800              END-IF                                              58280000
582900           ELSE                                                   58290000
583000              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   58300000
583100                 MOVE ASC-HD-GRO-COST TO ADJDIS-DISC-AMT          58310000
583200              ELSE                                                58320000
583300                 COMPUTE ADJDIS-DISC-AMT = ASC-HD-GRO-COST * -1   58330000
583400              END-IF                                              58340000
583500           END-IF                                                 58350000
583600           MOVE ZERO                  TO ADJDIS-GRO-COST-AMT      58360000
583700                                         ADJDIS-FRGT-AMT          58370000
583800        ELSE                                                      58380000
583900           IF ASC-HD-GRO-COST >= 0                                58390000
584000              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   58400000
584100                 MOVE ASC-HD-GRO-COST TO ADJDIS-GRO-COST-AMT      58410000
584200              ELSE                                                58420000
584300                 COMPUTE ADJDIS-GRO-COST-AMT                      58430000
584400                                         = ASC-HD-GRO-COST * -1   58440000
584500              END-IF                                              58450000
584600           ELSE                                                   58460000
584700              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   58470000
584800                 MOVE ASC-HD-GRO-COST TO ADJDIS-GRO-COST-AMT      58480000
584900              ELSE                                                58490000
585000                 COMPUTE ADJDIS-GRO-COST-AMT                      58500000
585100                                         = ASC-HD-GRO-COST * -1   58510000
585200              END-IF                                              58520000
585300           END-IF                                                 58530000
585400           IF ASC-HD-FRGT-AMT >= 0                                58540000
585500              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   58550000
585600                 MOVE ASC-HD-FRGT-AMT TO ADJDIS-FRGT-AMT          58560000
585700              ELSE                                                58570000
585800                 COMPUTE ADJDIS-FRGT-AMT = ASC-HD-FRGT-AMT * -1   58580000
585900              END-IF                                              58590000
586000           ELSE                                                   58600000
586100              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   58610000
586200                 MOVE ASC-HD-FRGT-AMT TO ADJDIS-FRGT-AMT          58620000
586300              ELSE                                                58630000
586400                 COMPUTE ADJDIS-FRGT-AMT = ASC-HD-FRGT-AMT * -1   58640000
586500              END-IF                                              58650000
586600           END-IF                                                 58660000
586700           IF ASC-TOTAL-DISC-AMT >= 0                             58670000
586800              IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                   58680000
586900                 MOVE ASC-TOTAL-DISC-AMT TO ADJDIS-DISC-AMT       58690000
587000              ELSE                                                58700000
587100                 COMPUTE ADJDIS-DISC-AMT                          58710000
587200                                     = ASC-TOTAL-DISC-AMT * -1    58720000
587300              END-IF                                              58730000
587400           ELSE                                                   58740000
587500              IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                   58750000
587600                 MOVE ASC-TOTAL-DISC-AMT TO ADJDIS-DISC-AMT       58760000
587700              ELSE                                                58770000
587800                 COMPUTE ADJDIS-DISC-AMT                          58780000
587900                                     = ASC-TOTAL-DISC-AMT * -1    58790000
588000              END-IF                                              58800000
588100           END-IF                                                 58810000
588200        END-IF                                                    58820000
588300     END-IF.                                                      58830000
588400                                                                  58840000
588500* ZEROS ARE MOVED TO THE ADJDIS-RTL-AMT FOR THE OFFSET ADJUSTMENT 58850000
588600* DISTRIB SO THAT THE RETAIL AMOUNT FOR THE ORIGINATING ADJUSTMENT58860000
588700* IS NOT CARRIED OVER TO THE OFFSET ADJUSTMENT.                   58870000
588800     MOVE ZEROS TO ADJDIS-RTL-AMT.                                58880000
588900*    COMPUTE ADJDIS-RTL-AMT       = ASC-HD-RET-AMT * -1.          58890000
589000                                                                  58900000
589100     MOVE ASC-OFFSET-NET-COST-AMT TO ADJDIS-NET-COST-AMT.         58910000
589200                                                                  58920000
589300     IF ASC-MISC-CHRG-AMT >= 0                                    58930000
589400        IF ASC-OFFSET-PSTG-TYP-CDE = 'CH'                         58940000
589500           MOVE ASC-MISC-CHRG-AMT TO ADJDIS-MISC-CHRG-AMT         58950000
589600        ELSE                                                      58960000
589700           COMPUTE ADJDIS-MISC-CHRG-AMT = ASC-MISC-CHRG-AMT * -1  58970000
589800        END-IF                                                    58980000
589900     ELSE                                                         58990000
590000        IF ASC-OFFSET-PSTG-TYP-CDE = 'CR'                         59000000
590100           MOVE ASC-MISC-CHRG-AMT TO ADJDIS-MISC-CHRG-AMT         59010000
590200        ELSE                                                      59020000
590300           COMPUTE ADJDIS-MISC-CHRG-AMT = ASC-MISC-CHRG-AMT * -1  59030000
590400        END-IF                                                    59040000
590500     END-IF.                                                      59050000
590600     MOVE SPACE                       TO ADJDIS-DEPT-NBR.         59060000
590700                                                                  59070000
590800******************************************************************59080000
590900* THIS PARAGRAPH WILL INSERT A ROW INTO THE TADJRNL TABLE.       *59090000
591000******************************************************************59100000
591100 7100-INSERT-ADJUSTMENT-HEADER.                                   59110000
591200                                                                  59120000
591300     PERFORM                                                      59130000
591400         WITH TEST AFTER                                          59140000
591500         VARYING PV-RETRY-COUNTER                                 59150000
591600         FROM 1 BY 1                                              59160000
591700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               59170000
591800                   OR (SQLCODE = ZERO))                           59180000
591900         EXEC SQL                                                 59190000
592000             INSERT INTO TADJRNL                                  59200000
592100                (VND_NBR,                                         59210000
592200                 DOC_NBR,                                         59220000
592300                 DOC_DTE,                                         59230000
592400                 AP_TRN_CDE,                                      59240000
592500                 PO_NBR,                                          59250000
592600                 DEPT_NBR,                                        59260000
592700                 GL_ACCT_NBR,                                     59270000
592800                 STR_NBR,                                         59280000
592900                 ENTR_TMST,                                       59290000
593000                 ENTR_ID,                                         59300000
593100                 ORGN_CDE,                                        59310000
593200                 GRO_COST_AMT,                                    59320000
593300                 RTL_AMT,                                         59330000
593400                 FRGT_AMT,                                        59340000
593500                 MISC_CHRG_AMT,                                   59350000
593600                 TERM_DISC_PCT,                                   59360000
593700                 TERM_DISC_AMT,                                   59370000
593800                 NW_STR_DISC_PCT,                                 59380000
593900                 NW_STR_DISC_AMT,                                 59390000
594000                 TRD_DISC_PCT,                                    59400000
594100                 TRD_DISC_AMT,                                    59410000
594200                 NET_COST_AMT,                                    59420000
594300                 INV_CTOFF_DTE,                                   59430000
594400                 TRN_TYP_CDE,                                     59440000
594500                 DOC_EXTR_IND,                                    59450000
594600                 DOC_EXTR_DTE,                                    59460000
594700                 PSTG_FYR_NBR,                                    59470000
594800                 PSTG_FMN_NBR,                                    59480000
594900                 PSTG_FWK_NBR,                                    59490000
595000                 BRCDE_NBR,                                       59500000
595100                 PS_BTCH_NBR,                                     59510000
595200                 PS_PSTG_IND,                                     59520000
595300                 ENT_ID,                                          59530000
595400                 MOS_DISC_PCT,                                    59540000
595500                 MOS_DISC_AMT)                                    59550000
595600             VALUES                                               59560000
595700                (:ADJRNL-VND-NBR,                                 59570000
595800                 :ADJRNL-DOC-NBR,                                 59580000
595900                 :ADJRNL-DOC-DTE,                                 59590000
596000                 :ADJRNL-AP-TRN-CDE,                              59600000
596100                 :ADJRNL-PO-NBR,                                  59610000
596200                 :ADJRNL-DEPT-NBR,                                59620000
596300                 :ADJRNL-GL-ACCT-NBR,                             59630000
596400                 :ADJRNL-STR-NBR,                                 59640000
596500                  CURRENT TIMESTAMP,                              59650000
596600                 :ADJRNL-ENTR-ID,                                 59660000
596700                 :ADJRNL-ORGN-CDE,                                59670000
596800                 :ADJRNL-GRO-COST-AMT,                            59680000
596900                 :ADJRNL-RTL-AMT,                                 59690000
597000                 :ADJRNL-FRGT-AMT,                                59700000
597100                 :ADJRNL-MISC-CHRG-AMT,                           59710000
597200                 :ADJRNL-TERM-DISC-PCT,                           59720000
597300                 :ADJRNL-TERM-DISC-AMT,                           59730000
597400                 :ADJRNL-NW-STR-DISC-PCT,                         59740000
597500                 :ADJRNL-NW-STR-DISC-AMT,                         59750000
597600                 :ADJRNL-TRD-DISC-PCT,                            59760000
597700                 :ADJRNL-TRD-DISC-AMT,                            59770000
597800                 :ADJRNL-NET-COST-AMT,                            59780000
597900                 :ADJRNL-INV-CTOFF-DTE,                           59790000
598000                 :ADJRNL-TRN-TYP-CDE,                             59800000
598100                 :ADJRNL-DOC-EXTR-IND,                            59810000
598200                 :ADJRNL-DOC-EXTR-DTE,                            59820000
598300                 :ADJRNL-PSTG-FYR-NBR,                            59830000
598400                 :ADJRNL-PSTG-FMN-NBR,                            59840000
598500                 :ADJRNL-PSTG-FWK-NBR,                            59850000
598600                 :ADJRNL-BRCDE-NBR,                               59860000
598700                 :ADJRNL-PS-BTCH-NBR,                             59870000
598800                 :ADJRNL-PS-PSTG-IND,                             59880000
598900                 :ADJRNL-ENT-ID,                                  59890000
599000                 :ADJRNL-MOS-DISC-PCT,                            59900000
599100                 :ADJRNL-MOS-DISC-AMT)                            59910000
599200         END-EXEC                                                 59920000
599300                                                                  59930000
599400         EVALUATE TRUE                                            59940000
599500             WHEN SQLCODE = ZERO                                  59950000
599600             WHEN SQLCODE = -904                                  59960000
599700             WHEN SQLCODE = -913                                  59970000
599800                 CONTINUE                                         59980000
599900             WHEN SQLWARN0 NOT = SPACES                           59990000
600000             WHEN SQLCODE < ZERO                                  60000000
600100             WHEN SQLCODE > ZERO                                  60010000
600200                 MOVE '7100-INSERT-ADJUSTMENT'                    60020000
600300                                  TO DP013-PARAGRAPH              60030000
600400                 MOVE 'INSERT A ROW INTO THE ADJUSTMENT JRN TABLE'60040000
600500                                  TO DP013-MESSAGE-TEXT(1)        60050000
600600                 MOVE SQLCA        TO DP013-SQLCA                 60060000
600700                 MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1)    60070000
600800                 SET DP013-DB2-ABEND                              60080000
600900                    DP013-XCTL-DISPLAY-RESTART TO TRUE            60090000
601000                 PERFORM DP013-0000-PROCESS-ABEND                 60100000
601100         END-EVALUATE                                             60110000
601200     END-PERFORM.                                                 60120000
601300                                                                  60130000
601400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60140000
601500        MOVE '7100-INSERT-ADJUSTMENT'                             60150000
601600                                   TO DP013-PARAGRAPH             60160000
601700        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT A NEW 60170000
601800-             ' ADJUSTMENT    '    TO DP013-MESSAGE-TEXT (1)      60180000
601900        MOVE SQLCA                TO DP013-SQLCA                  60190000
602000         MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)    60200000
602100        SET DP013-DB2-ABEND                                       60210000
602200             DP013-XCTL-DISPLAY-RESTART                           60220000
602300                                  TO TRUE                         60230000
602400         PERFORM DP013-0000-PROCESS-ABEND                         60240000
602500     END-IF.                                                      60250000
602600                                                                  60260000
602700******************************************************************60270000
602800* THIS PARAGRAPH WILL PERFORM AN INSERT INTO THE DB2 TABLE       *60280000
602900* TAJPSINT.                                                      *60290000
603000******************************************************************60300000
603100 7150-INSERT-TAJPSINT.                                            60310000
603200                                                                  60320000
603300     PERFORM                                                      60330000
603400         WITH TEST AFTER                                          60340000
603500         VARYING PV-RETRY-COUNTER                                 60350000
603600         FROM 1 BY 1                                              60360000
603700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               60370000
603800                   OR (SQLCODE = ZERO))                           60380000
603900                                                                  60390000
604000         EXEC SQL                                                 60400000
604100             INSERT INTO TAJPSINT                                 60410000
604200                (VND_NBR,                                         60420000
604300                 DOC_NBR,                                         60430000
604400                 DOC_DTE,                                         60440000
604500                 AP_TRN_CDE,                                      60450000
604600                 DUE_DTE,                                         60460000
604700                 DOC_HLD_CDE,                                     60470000
604800                 RSN_1ST_LNE_TXT,                                 60480000
604900                 RSN_2ND_LNE_TXT,                                 60490000
605000                 AUTH_NBR)                                        60500000
605100             VALUES                                               60510000
605200                (:AJPSINT-VND-NBR,                                60520000
605300                 :AJPSINT-DOC-NBR,                                60530000
605400                 :AJPSINT-DOC-DTE,                                60540000
605500                 :AJPSINT-AP-TRN-CDE,                             60550000
605600                 :AJPSINT-DUE-DTE,                                60560000
605700                 :AJPSINT-DOC-HLD-CDE,                            60570000
605800                 :AJPSINT-RSN-1ST-LNE-TXT,                        60580000
605900                 :AJPSINT-RSN-2ND-LNE-TXT,                        60590000
606000                 :AJPSINT-AUTH-NBR)                               60600000
606100         END-EXEC                                                 60610000
606200                                                                  60620000
606300         EVALUATE TRUE                                            60630000
606400            WHEN SQLCODE = ZERO                                   60640000
606500            WHEN SQLCODE = -904                                   60650000
606600            WHEN SQLCODE = -913                                   60660000
606700                 CONTINUE                                         60670000
606800            WHEN SQLWARN0 NOT = SPACES                            60680000
606900            WHEN SQLCODE < ZERO                                   60690000
607000            WHEN SQLCODE > ZERO                                   60700000
607100                 MOVE '7150-INSERT-TAJPSINT  '                    60710000
607200                                  TO DP013-PARAGRAPH              60720000
607300                 MOVE 'INSERT A ROW INTO THE TAJPSINT            '60730000
607400                                  TO DP013-MESSAGE-TEXT(1)        60740000
607500                 MOVE SQLCA       TO DP013-SQLCA                  60750000
607600                 MOVE 'TAJPSINT'  TO DP013-DB2-TABLE-NAME (1)     60760000
607700                 SET DP013-DB2-ABEND                              60770000
607800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           60780000
607900                 PERFORM DP013-0000-PROCESS-ABEND                 60790000
608000         END-EVALUATE                                             60800000
608100     END-PERFORM.                                                 60810000
608200                                                                  60820000
608300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        60830000
608400        MOVE '7150-INSERT-TAJPSINT  '                             60840000
608500                                   TO DP013-PARAGRAPH             60850000
608600        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT A NEW 60860000
608700-             ' TAJPSINT ROW  '    TO DP013-MESSAGE-TEXT (1)      60870000
608800        MOVE SQLCA                TO DP013-SQLCA                  60880000
608900        MOVE 'TAJPSINT'           TO DP013-DB2-TABLE-NAME (1)     60890000
609000        SET DP013-DB2-ABEND                                       60900000
609100             DP013-XCTL-DISPLAY-RESTART                           60910000
609200                                  TO TRUE                         60920000
609300         PERFORM DP013-0000-PROCESS-ABEND                         60930000
609400     END-IF.                                                      60940000
609500                                                                  60950000
609600******************************************************************60960000
609700* THIS PARAGRAPH WILL UPDATE AN EXISTING RECORD IN THE TADJRNL   *60970000
609800* DB2 TABLE.                                                     *60980000
609900******************************************************************60990000
610000 7200-UPDATE-TADJRNL.                                             61000000
610100                                                                  61010000
610200     PERFORM                                                      61020000
610300        WITH TEST AFTER                                           61030000
610400         VARYING PV-RETRY-COUNTER                                 61040000
610500        FROM 1 BY 1                                               61050000
610600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               61060000
610700            OR (SQLCODE = +0))                                    61070000
610800                                                                  61080000
610900        EXEC SQL                                                  61090000
611000            UPDATE TADJRNL                                        61100000
611100            SET PO_NBR            = :ADJRNL-PO-NBR                61110000
611200               ,DEPT_NBR          = :ADJRNL-DEPT-NBR              61120000
611300               ,GL_ACCT_NBR       = :ADJRNL-GL-ACCT-NBR           61130000
611400               ,STR_NBR           = :ADJRNL-STR-NBR               61140000
611500               ,ENTR_ID           = :ADJRNL-ENTR-ID               61150000
611600               ,ORGN_CDE          = :ADJRNL-ORGN-CDE              61160000
611700               ,GRO_COST_AMT      = :ADJRNL-GRO-COST-AMT          61170000
611800               ,RTL_AMT           = :ADJRNL-RTL-AMT               61180000
611900               ,FRGT_AMT          = :ADJRNL-FRGT-AMT              61190000
612000               ,MISC_CHRG_AMT     = :ADJRNL-MISC-CHRG-AMT         61200000
612100               ,TERM_DISC_PCT     = :ADJRNL-TERM-DISC-PCT         61210000
612200               ,TERM_DISC_AMT     = :ADJRNL-TERM-DISC-AMT         61220000
612300               ,NW_STR_DISC_PCT   = :ADJRNL-NW-STR-DISC-PCT       61230000
612400               ,NW_STR_DISC_AMT   = :ADJRNL-NW-STR-DISC-AMT       61240000
612500               ,TRD_DISC_PCT      = :ADJRNL-TRD-DISC-PCT          61250000
612600               ,TRD_DISC_AMT      = :ADJRNL-TRD-DISC-AMT          61260000
612700               ,NET_COST_AMT      = :ADJRNL-NET-COST-AMT          61270000
612800               ,INV_CTOFF_DTE     = :ADJRNL-INV-CTOFF-DTE         61280000
612900               ,TRN_TYP_CDE       = :ADJRNL-TRN-TYP-CDE           61290000
613000               ,DOC_EXTR_IND      = :ADJRNL-DOC-EXTR-IND          61300000
613100               ,DOC_EXTR_DTE      = :ADJRNL-DOC-EXTR-DTE          61310000
613200               ,PSTG_FYR_NBR      = :ADJRNL-PSTG-FYR-NBR          61320000
613300               ,PSTG_FMN_NBR      = :ADJRNL-PSTG-FMN-NBR          61330000
613400               ,PSTG_FWK_NBR      = :ADJRNL-PSTG-FWK-NBR          61340000
613500               ,BRCDE_NBR         = :ADJRNL-BRCDE-NBR             61350000
613600               ,PS_BTCH_NBR       = :ADJRNL-PS-BTCH-NBR           61360000
613700               ,PS_PSTG_IND       = :ADJRNL-PS-PSTG-IND           61370000
613800               ,ENT_ID            = :ADJRNL-ENT-ID                61380000
613900               ,MOS_DISC_PCT      = :ADJRNL-MOS-DISC-PCT          61390000
614000               ,MOS_DISC_AMT      = :ADJRNL-MOS-DISC-AMT          61400000
614100            WHERE VND_NBR         = :ADJRNL-VND-NBR               61410000
614200            AND   DOC_NBR         = :ADJRNL-DOC-NBR               61420000
614300            AND   DOC_DTE         = :ADJRNL-DOC-DTE               61430000
614400            AND   AP_TRN_CDE      = :ADJRNL-AP-TRN-CDE            61440000
614500            END-EXEC                                              61450000
614600                                                                  61460000
614700            EVALUATE TRUE                                         61470000
614800                WHEN SQLCODE = +0                                 61480000
614900                WHEN SQLCODE = -904                               61490000
615000                WHEN SQLCODE = -913                               61500000
615100                    CONTINUE                                      61510000
615200                WHEN SQLWARN0 NOT = SPACES                        61520000
615300                WHEN SQLCODE < +0                                 61530000
615400                WHEN SQLCODE > +0                                 61540000
615500                   MOVE '7200-UPDATE-ADJUSTM'                     61550000
615600                                      TO DP013-PARAGRAPH          61560000
615700                   MOVE 'UPDATE A ROW ON TADJRNL'                 61570000
615800                                      TO DP013-MESSAGE-TEXT(1)    61580000
615900                   MOVE SQLCA        TO DP013-SQLCA               61590000
616000                    MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1) 61600000
616100                   SET DP013-DB2-ABEND                            61610000
616200                        DP013-XCTL-DISPLAY-RESTART TO TRUE        61620000
616300                   PERFORM DP013-0000-PROCESS-ABEND               61630000
616400            END-EVALUATE                                          61640000
616500     END-PERFORM.                                                 61650000
616600                                                                  61660000
616700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        61670000
616800        MOVE '7200-UPDATE-TADJRNL' TO DP013-PARAGRAPH             61680000
616900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              61690000
617000                                  TO DP013-MESSAGE-TEXT (1)       61700000
617100         MOVE 'TO UPDATE A TADJRNL ROW'                           61710000
617200                                  TO DP013-MESSAGE-TEXT (2)       61720000
617300         MOVE SQLCA                TO DP013-SQLCA                 61730000
617400        MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)     61740000
617500         SET DP013-DB2-ABEND                                      61750000
617600            DP013-XCTL-DISPLAY-RESTART                            61760000
617700                                   TO TRUE                        61770000
617800        PERFORM DP013-0000-PROCESS-ABEND                          61780000
617900     END-IF.                                                      61790000
618000                                                                  61800000
618100******************************************************************61810000
618200* THIS PARAGRAPH WILL PERFORM A DB2 UPDATE TO THE TADJRNL TABLE  *61820000
618300* IN THE CASE THAT THE USER HAS UPDATED THE GROSS AND/OR RETAIL  *61830000
618400* DOLLAR FIELDS FOR A DELETE ACTION TO MAKE AN ADJUSTMENT        *61840000
618500* BALANCE.                                                       *61850000
618600******************************************************************61860000
618700 7210-UPDATE-DOLLARS-TADJRNL.                                     61870000
618800                                                                  61880000
618900     PERFORM                                                      61890000
619000        WITH TEST AFTER                                           61900000
619100         VARYING PV-RETRY-COUNTER                                 61910000
619200        FROM 1 BY 1                                               61920000
619300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               61930000
619400            OR (SQLCODE = +0))                                    61940000
619500                                                                  61950000
619600        EXEC SQL                                                  61960000
619700            UPDATE TADJRNL                                        61970000
619800            SET GRO_COST_AMT      = :ADJRNL-GRO-COST-AMT          61980000
619900               ,RTL_AMT           = :ADJRNL-RTL-AMT               61990000
620000               ,TERM_DISC_AMT     = :ADJRNL-TERM-DISC-AMT         62000000
620100               ,NW_STR_DISC_AMT   = :ADJRNL-NW-STR-DISC-AMT       62010000
620200               ,TRD_DISC_AMT      = :ADJRNL-TRD-DISC-AMT          62020000
620300               ,NET_COST_AMT      = :ADJRNL-NET-COST-AMT          62030000
620400               ,MOS_DISC_AMT      = :ADJRNL-MOS-DISC-AMT          62040000
620500            WHERE VND_NBR         = :ADJRNL-VND-NBR               62050000
620600            AND   DOC_NBR         = :ADJRNL-DOC-NBR               62060000
620700            AND   DOC_DTE         = :ADJRNL-DOC-DTE               62070000
620800            AND   AP_TRN_CDE      = :ADJRNL-AP-TRN-CDE            62080000
620900            END-EXEC                                              62090000
621000                                                                  62100000
621100            EVALUATE TRUE                                         62110000
621200                WHEN SQLCODE = +0                                 62120000
621300                WHEN SQLCODE = -904                               62130000
621400                WHEN SQLCODE = -913                               62140000
621500                    CONTINUE                                      62150000
621600                WHEN SQLWARN0 NOT = SPACES                        62160000
621700                WHEN SQLCODE < +0                                 62170000
621800                WHEN SQLCODE > +0                                 62180000
621900                   MOVE '7210-UPDATE-DOLLARS'                     62190000
622000                                      TO DP013-PARAGRAPH          62200000
622100                   MOVE 'UPDATE A ROW ON TADJRNL'                 62210000
622200                                      TO DP013-MESSAGE-TEXT(1)    62220000
622300                   MOVE SQLCA        TO DP013-SQLCA               62230000
622400                    MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1) 62240000
622500                   SET DP013-DB2-ABEND                            62250000
622600                        DP013-XCTL-DISPLAY-RESTART TO TRUE        62260000
622700                   PERFORM DP013-0000-PROCESS-ABEND               62270000
622800            END-EVALUATE                                          62280000
622900     END-PERFORM.                                                 62290000
623000                                                                  62300000
623100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        62310000
623200        MOVE '7210-UPDATE-DOLLARS' TO DP013-PARAGRAPH             62320000
623300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              62330000
623400                                  TO DP013-MESSAGE-TEXT (1)       62340000
623500         MOVE 'TO UPDATE A TADJRNL ROW'                           62350000
623600                                  TO DP013-MESSAGE-TEXT (2)       62360000
623700         MOVE SQLCA                TO DP013-SQLCA                 62370000
623800        MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)     62380000
623900         SET DP013-DB2-ABEND                                      62390000
624000            DP013-XCTL-DISPLAY-RESTART                            62400000
624100                                   TO TRUE                        62410000
624200        PERFORM DP013-0000-PROCESS-ABEND                          62420000
624300     END-IF.                                                      62430000
624400                                                                  62440000
624500******************************************************************62450000
624600* THIS PARAGRAPH WILL PERFORM AN UPDATE TO A ROW ON THE DB2      *62460000
624700* TABLE TAJPSINT.                                                *62470000
624800******************************************************************62480000
624900 7250-UPDATE-TAJPSINT.                                            62490000
625000                                                                  62500000
625100     PERFORM                                                      62510000
625200        WITH TEST AFTER                                           62520000
625300         VARYING PV-RETRY-COUNTER                                 62530000
625400        FROM 1 BY 1                                               62540000
625500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               62550000
625600            OR (SQLCODE = +0))                                    62560000
625700                                                                  62570000
625800        EXEC SQL                                                  62580000
625900            UPDATE TAJPSINT                                       62590000
626000            SET DUE_DTE           = :AJPSINT-DUE-DTE              62600000
626100               ,DOC_HLD_CDE       = :AJPSINT-DOC-HLD-CDE          62610000
626200               ,RSN_1ST_LNE_TXT   = :AJPSINT-RSN-1ST-LNE-TXT      62620000
626300               ,RSN_2ND_LNE_TXT   = :AJPSINT-RSN-2ND-LNE-TXT      62630000
626400               ,AUTH_NBR          = :AJPSINT-AUTH-NBR             62640000
626500            WHERE VND_NBR         = :AJPSINT-VND-NBR              62650000
626600            AND DOC_NBR           = :AJPSINT-DOC-NBR              62660000
626700            AND DOC_DTE           = :AJPSINT-DOC-DTE              62670000
626800            AND AP_TRN_CDE        = :AJPSINT-AP-TRN-CDE           62680000
626900        END-EXEC                                                  62690000
627000                                                                  62700000
627100        EVALUATE TRUE                                             62710000
627200            WHEN SQLCODE = +0                                     62720000
627300            WHEN SQLCODE = -904                                   62730000
627400            WHEN SQLCODE = -913                                   62740000
627500                CONTINUE                                          62750000
627600                                                                  62760000
627700            WHEN SQLWARN0 NOT = SPACES                            62770000
627800            WHEN SQLCODE < +0                                     62780000
627900            WHEN SQLCODE > +0                                     62790000
628000                MOVE '7250-UPDATE-TAJPSIN'                        62800000
628100                                  TO DP013-PARAGRAPH              62810000
628200                MOVE 'UPDATE A ROW ON TAJPSIN'                    62820000
628300                                  TO DP013-MESSAGE-TEXT(1)        62830000
628400                MOVE SQLCA        TO DP013-SQLCA                  62840000
628500                MOVE 'TAJPSINT'   TO DP013-DB2-TABLE-NAME (1)     62850000
628600                SET DP013-DB2-ABEND                               62860000
628700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            62870000
628800                PERFORM DP013-0000-PROCESS-ABEND                  62880000
628900        END-EVALUATE                                              62890000
629000     END-PERFORM.                                                 62900000
629100                                                                  62910000
629200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         62920000
629300        MOVE '7250-UPDATE-TAJPSIN' TO DP013-PARAGRAPH             62930000
629400        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '               62940000
629500                                 TO DP013-MESSAGE-TEXT (1)        62950000
629600        MOVE 'TO UPDATE TAJPSINT ROW'                             62960000
629700                                 TO DP013-MESSAGE-TEXT (2)        62970000
629800        MOVE SQLCA               TO DP013-SQLCA                   62980000
629900        MOVE 'TAJPSINT'          TO DP013-DB2-TABLE-NAME (1)      62990000
630000        SET DP013-DB2-ABEND                                       63000000
630100            DP013-XCTL-DISPLAY-RESTART                            63010000
630200                                 TO TRUE                          63020000
630300        PERFORM DP013-0000-PROCESS-ABEND                          63030000
630400     END-IF.                                                      63040000
630500                                                                  63050000
630600******************************************************************63060000
630700* THIS PARAGRAPH WILL PERFORM A DB2 SELECT TO VALIDATE THE       *63070000
630800* STORE IN THE DISTRIBUTION PORTION OF THE SCREEN.               *63080000
630900******************************************************************63090000
631000 7400-VALIDATE-STORE.                                             63100000
631100                                                                  63110000
631200     PERFORM                                                      63120000
631300         WITH TEST AFTER                                          63130000
631400         VARYING PV-RETRY-COUNTER                                 63140000
631500         FROM 1 BY 1                                              63150000
631600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               63160000
631700            OR (SQLCODE = +0)                                     63170000
631800            OR (SQLCODE = +100))                                  63180000
631900                                                                  63190000
632000         EXEC SQL                                                 63200000
632100           SELECT  LOC_NBR                                        63210000
632200                  ,LOC_TYP_CDE                                    63220000
632300            INTO   :XFT00017-LOC-NBR                              63230000
632400                  ,:XFT00017-LOC-TYP-CDE                          63240000
632500             FROM   XFT_LOC                                       63250000
632600          WHERE LOC_NBR      = :XFT00017-LOC-NBR                  63260000
632700          AND   LOC_TYP_CDE IN                                    63270000
632800                 ('DC', 'DS', 'CS', 'RV', 'HQ', 'AL', 'DA')       63280000
632900          AND CURRENT DATE <= FINCL_CLO_DTE                       63290000
633000         END-EXEC                                                 63300000
633100                                                                  63310000
633200         EVALUATE TRUE                                            63320000
633300             WHEN SQLCODE = +0                                    63330000
633400                 SET ASC-STORE-FOUND           TO TRUE            63340000
633500             WHEN SQLCODE = -904                                  63350000
633600             WHEN SQLCODE = -913                                  63360000
633700                 CONTINUE                                         63370000
633800             WHEN SQLCODE = +100                                  63380000
633900                 SET ASC-STORE-NOT-FOUND       TO TRUE            63390000
634000                                                                  63400000
634100             WHEN SQLWARN0 NOT = SPACES                           63410000
634200             WHEN SQLCODE < ZERO                                  63420000
634300             WHEN SQLCODE > ZERO                                  63430000
634400                 MOVE '7400-VALIDATE-STORE'                       63440000
634500                                   TO DP013-PARAGRAPH             63450000
634600                 MOVE 'SELECT ON XFT00017       '                 63460000
634700                                   TO DP013-MESSAGE-TEXT (1)      63470000
634800                 MOVE SQLCA        TO DP013-SQLCA                 63480000
634900                 MOVE 'XFT00017'   TO DP013-DB2-TABLE-NAME (1)    63490000
635000                 MOVE '       '    TO DP013-DB2-TABLE-NAME (2)    63500000
635100                 SET DP013-DB2-ABEND                              63510000
635200                     DP013-XCTL-DISPLAY-RESTART                   63520000
635300                                   TO TRUE                        63530000
635400                 PERFORM DP013-0000-PROCESS-ABEND                 63540000
635500             END-EVALUATE                                         63550000
635600         END-PERFORM.                                             63560000
635700                                                                  63570000
635800         IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                    63580000
635900            MOVE '7400-VALIDATE-STORE'                            63590000
636000                                      TO DP013-PARAGRAPH          63600000
636100            MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'  63610000
636200                                      TO DP013-MESSAGE-TEXT (1)   63620000
636300            MOVE SQLCA                TO DP013-SQLCA              63630000
636400            MOVE 'XFT00017'           TO DP013-DB2-TABLE-NAME (1) 63640000
636500            MOVE '       '            TO DP013-DB2-TABLE-NAME (2) 63650000
636600            SET DP013-DB2-ABEND                                   63660000
636700                DP013-XCTL-DISPLAY-RESTART                        63670000
636800                                      TO TRUE                     63680000
636900            PERFORM DP013-0000-PROCESS-ABEND                      63690000
637000         END-IF.                                                  63700000
637100                                                                  63710000
637200******************************************************************63720000
637300* THIS PARAGRAPH WILL PERFORM A DB2 CALL TO VALIDATE THE         *63730000
637400* SUBCLASS ENTERED IN THE DISTRIBUTION SECTION OF THE SCREEN.    *63740000
637500******************************************************************63750000
637600 7600-VALIDATE-SUB-CLASS.                                         63760000
637700                                                                  63770000
637800     EXEC SQL                                                     63780000
637900       SELECT DEPT_NBR                                            63790000
638000             ,MAJ_CL_NBR                                          63800000
638100             ,SUB_CL_NBR                                          63810000
638200             ,MDSELV_CDE                                          63820000
638300        INTO :MDSEAR-DEPT-NBR                                     63830000
638400            ,:MDSEAR-MAJ-CL-NBR                                   63840000
638500            ,:MDSEAR-SUB-CL-NBR                                   63850000
638600            ,:MDSEAR-MDSELV-CDE                                   63860000
638700         FROM  TMDSEAR                                            63870000
638800      WHERE SUB_CL_NBR = :MDSEAR-SUB-CL-NBR                       63880000
638900      AND   DEPT_NBR   = :MDSEAR-DEPT-NBR                         63890000
639000      AND   MDSELV_CDE =  'SCL'                                   63900000
639100      AND   CURRENT DATE  BETWEEN STRT_DTE AND END_DTE            63910000
639200     END-EXEC.                                                    63920000
639300                                                                  63930000
639400     EVALUATE TRUE                                                63940000
639500         WHEN SQLCODE = +0                                        63950000
639600             SET ASC-CLASS-FOUND               TO TRUE            63960000
639700         WHEN SQLCODE = -904                                      63970000
639800         WHEN SQLCODE = -913                                      63980000
639900             CONTINUE                                             63990000
640000         WHEN SQLCODE = +100                                      64000000
640100             SET ASC-CLASS-NOT-FOUND           TO TRUE            64010000
640200                                                                  64020000
640300         WHEN SQLWARN0 NOT = SPACES                               64030000
640400         WHEN SQLCODE < ZERO                                      64040000
640500         WHEN SQLCODE > ZERO                                      64050000
640600             MOVE '7600-VALIDATE-SUB-C'                           64060000
640700                               TO DP013-PARAGRAPH                 64070000
640800             MOVE 'SELECT ON TMDSEAR        '                     64080000
640900                               TO DP013-MESSAGE-TEXT (1)          64090000
641000             MOVE SQLCA            TO DP013-SQLCA                 64100000
641100             MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)    64110000
641200             MOVE '       '        TO DP013-DB2-TABLE-NAME (2)    64120000
641300             SET DP013-DB2-ABEND                                  64130000
641400                 DP013-XCTL-DISPLAY-RESTART                       64140000
641500                               TO TRUE                            64150000
641600             PERFORM DP013-0000-PROCESS-ABEND                     64160000
641700     END-EVALUATE.                                                64170000
641800                                                                  64180000
641900******************************************************************64190000
642000* THIS PARAGRAPH WILL PERFORM VALIDATION ON THE MAJOR CLASS      *64200000
642100* ENTERED IN THE DISTRIBUTION SECTION OF THE SCREEN IN DB2.      *64210000
642200******************************************************************64220000
642300 7700-VALIDATE-MAJ-CLASS.                                         64230000
642400                                                                  64240000
642500     EXEC SQL                                                     64250000
642600       SELECT DEPT_NBR                                            64260000
642700             ,MAJ_CL_NBR                                          64270000
642800             ,SUB_CL_NBR                                          64280000
642900             ,MDSELV_CDE                                          64290000
643000        INTO :MDSEAR-DEPT-NBR                                     64300000
643100            ,:MDSEAR-MAJ-CL-NBR                                   64310000
643200            ,:MDSEAR-SUB-CL-NBR                                   64320000
643300            ,:MDSEAR-MDSELV-CDE                                   64330000
643400         FROM  TMDSEAR                                            64340000
643500      WHERE MAJ_CL_NBR = :MDSEAR-MAJ-CL-NBR                       64350000
643600      AND   DEPT_NBR   = :MDSEAR-DEPT-NBR                         64360000
643700      AND   MDSELV_CDE =  'MCL'                                   64370000
643800      AND   CURRENT_DATE BETWEEN STRT_DTE AND END_DTE             64380000
643900     END-EXEC.                                                    64390000
644000                                                                  64400000
644100     EVALUATE TRUE                                                64410000
644200         WHEN SQLCODE = +0                                        64420000
644300             SET ASC-CLASS-FOUND               TO TRUE            64430000
644400         WHEN SQLCODE = -904                                      64440000
644500         WHEN SQLCODE = -913                                      64450000
644600             CONTINUE                                             64460000
644700         WHEN SQLCODE = +100                                      64470000
644800             SET ASC-CLASS-NOT-FOUND           TO TRUE            64480000
644900                                                                  64490000
645000         WHEN SQLWARN0 NOT = SPACES                               64500000
645100         WHEN SQLCODE < ZERO                                      64510000
645200         WHEN SQLCODE > ZERO                                      64520000
645300             MOVE '7700-VALIDATE-MAJ-C'                           64530000
645400                               TO DP013-PARAGRAPH                 64540000
645500             MOVE 'SELECT ON TMDSEAR        '                     64550000
645600                               TO DP013-MESSAGE-TEXT (1)          64560000
645700             MOVE SQLCA            TO DP013-SQLCA                 64570000
645800             MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)    64580000
645900             MOVE '       '        TO DP013-DB2-TABLE-NAME (2)    64590000
646000             SET DP013-DB2-ABEND                                  64600000
646100                 DP013-XCTL-DISPLAY-RESTART                       64610000
646200                               TO TRUE                            64620000
646300             PERFORM DP013-0000-PROCESS-ABEND                     64630000
646400     END-EVALUATE.                                                64640000
646500                                                                  64650000
646600******************************************************************64660000
646700* THIS PARAGRAPH WILL VALIDATE THE SKU ENTERED.                  *64670000
646800******************************************************************64680000
646900 7800-VALIDATE-SKU.                                               64690000
647000                                                                  64700000
647100     EXEC SQL                                                     64710000
647200          SELECT '1'                                              64720000
647300            INTO :PV-ONE                                          64730000
647400            FROM SYSIBM.SYSDUMMY1 X                               64740000
647500           WHERE EXISTS (SELECT 1                                 64750000
647600                           FROM TSKXREF                           64760000
647700                          WHERE DEPT      = :SKXREF-DEPT          64770000
647800                            AND SUBCLASS  = :SKXREF-SUBCLASS      64780000
647900                            AND SKU       = :SKXREF-SKU           64790000
648000                            AND X.IBMREQD = X.IBMREQD)            64800000
648100     END-EXEC.                                                    64810000
648200                                                                  64820000
648300     EVALUATE TRUE                                                64830000
648400         WHEN SQLCODE = +0                                        64840000
648500             SET ASC-SKU-FOUND               TO TRUE              64850000
648600         WHEN SQLCODE = -904                                      64860000
648700         WHEN SQLCODE = -913                                      64870000
648800             CONTINUE                                             64880000
648900         WHEN SQLCODE = +100                                      64890000
649000             SET ASC-SKU-NOT-FOUND           TO TRUE              64900000
649100                                                                  64910000
649200         WHEN SQLWARN0 NOT = SPACES                               64920000
649300         WHEN SQLCODE < ZERO                                      64930000
649400         WHEN SQLCODE > ZERO                                      64940000
649500             MOVE '7800-VALIDATE-SKU  '                           64950000
649600                               TO DP013-PARAGRAPH                 64960000
649700             MOVE 'SELECT ON TSKXREF        '                     64970000
649800                               TO DP013-MESSAGE-TEXT (1)          64980000
649900             MOVE SQLCA            TO DP013-SQLCA                 64990000
650000             MOVE 'TSKXREF'        TO DP013-DB2-TABLE-NAME (1)    65000000
650100             MOVE '       '        TO DP013-DB2-TABLE-NAME (2)    65010000
650200             SET DP013-DB2-ABEND                                  65020000
650300                 DP013-XCTL-DISPLAY-RESTART                       65030000
650400                               TO TRUE                            65040000
650500             PERFORM DP013-0000-PROCESS-ABEND                     65050000
650600     END-EVALUATE.                                                65060000
650700                                                                  65070000
650800******************************************************************65080000
650900* THIS PARAGRAPH WILL FORMAT THE DISTRIBUTION FIELDS FOR A DB2   *65090000
651000* INSERT INTO TADJDIS.                                           *65100000
651100******************************************************************65110000
651200 8000-FORMAT-ADJUSTMENT-DISTRO.                                   65120000
651300                                                                  65130000
651400     MOVE ASC-KEY-VND-NBR                TO ADJDIS-VND-NBR.       65140000
651500     MOVE ASC-KEY-DOC-NBR                TO ADJDIS-DOC-NBR.       65150000
651600     MOVE ASC-KEY-DOC-DTE                TO ADJDIS-DOC-DTE.       65160000
651700     MOVE ASC-KEY-AP-TRN-CDE             TO ADJDIS-AP-TRN-CDE.    65170000
651800     MOVE ASC-DISTRB-SEQ-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)          65180000
651900                                         TO ADJDIS-DISTRB-SEQ-NBR.65190000
652000     MOVE ASC-STORE (ASC-BLK-SUB ASC-ITEM-SUB) TO ADJDIS-STR-NBR. 65200000
652100     MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB) TO ADJDIS-CL-NBR.  65210000
652200     MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)                      65220000
652300                                         TO ADJDIS-SKU-NBR.       65230000
652400                                                                  65240000
652500     IF ASC-FREIGHT-COST-ALLOCATION                               65250000
652600        MOVE ASC-GROSS-COST  (ASC-BLK-SUB ASC-ITEM-SUB)           65260000
652700                                         TO ADJDIS-FRGT-AMT       65270000
652800        MOVE ZERO                        TO ADJDIS-GRO-COST-AMT   65280000
652900                                            ADJDIS-DISC-AMT       65290000
653000     ELSE                                                         65300000
653100        IF ASC-NEW-STR-COST-ALLOCATION                            65310000
653200           MOVE ASC-GROSS-COST  (ASC-BLK-SUB ASC-ITEM-SUB)        65320000
653300                                         TO ADJDIS-DISC-AMT       65330000
653400           MOVE ZERO                     TO ADJDIS-GRO-COST-AMT   65340000
653500                                            ADJDIS-FRGT-AMT       65350000
653600        ELSE                                                      65360000
653700           MOVE ASC-GROSS-COST  (ASC-BLK-SUB ASC-ITEM-SUB)        65370000
653800                                            TO ADJDIS-GRO-COST-AMT65380000
653900           MOVE ASC-DT-FRGT-AMT (ASC-BLK-SUB ASC-ITEM-SUB)        65390000
654000                                            TO ADJDIS-FRGT-AMT    65400000
654100           MOVE ASC-DISC-AMT     (ASC-BLK-SUB ASC-ITEM-SUB)       65410000
654200                                            TO ADJDIS-DISC-AMT    65420000
654300     END-IF.                                                      65430000
654400                                                                  65440000
654500     MOVE ASC-RETAIL-AMT   (ASC-BLK-SUB ASC-ITEM-SUB)             65450000
654600                                         TO ADJDIS-RTL-AMT.       65460000
654700     MOVE ASC-DT-MISC-CHRG-AMT (ASC-BLK-SUB ASC-ITEM-SUB)         65470000
654800                                         TO ADJDIS-MISC-CHRG-AMT. 65480000
654900     MOVE ASC-NET-COST     (ASC-BLK-SUB ASC-ITEM-SUB)             65490000
655000                                         TO ADJDIS-NET-COST-AMT.  65500000
655100     MOVE ASC-DEPT                       TO ADJDIS-DEPT-NBR.      65510000
655200                                                                  65520000
655300******************************************************************65530000
655400* THIS PARAGRAPH WILL FORMAT THE DISTRIBUTION KEY FIELDS TO      *65540000
655500* DELETE A ROW FROM TADJDIS.                                     *65550000
655600******************************************************************65560000
655700 8010-FORMAT-ADJ-DISTRO-DEL.                                      65570000
655800                                                                  65580000
655900     MOVE ASC-KEY-VND-NBR                TO ADJDIS-VND-NBR.       65590000
656000     MOVE ASC-KEY-DOC-NBR                TO ADJDIS-DOC-NBR.       65600000
656100     MOVE ASC-KEY-DOC-DTE                TO ADJDIS-DOC-DTE.       65610000
656200     MOVE ASC-KEY-AP-TRN-CDE             TO ADJDIS-AP-TRN-CDE.    65620000
656300     MOVE ASC-DISTRB-SEQ-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)          65630000
656400                                         TO ADJDIS-DISTRB-SEQ-NBR.65640000
656500                                                                  65650000
656600******************************************************************65660000
656700* THIS PARAGRAPH WILL ADD THE LINES OF ADJUSTMENT DISTRIBUTION   *65670000
656800* TO THE TADJDIS DB2 TABLE.                                      *65680000
656900******************************************************************65690000
657000 8100-ADJUSTMENT-DISTRO-ADD.                                      65700000
657100                                                                  65710000
657200     PERFORM                                                      65720000
657300         WITH TEST AFTER                                          65730000
657400         VARYING PV-RETRY-COUNTER                                 65740000
657500         FROM 1 BY 1                                              65750000
657600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65760000
657700                   OR (SQLCODE = ZERO))                           65770000
657800         EXEC SQL                                                 65780000
657900             INSERT INTO TADJDIS                                  65790000
658000                (VND_NBR,                                         65800000
658100                 DOC_NBR,                                         65810000
658200                 DOC_DTE,                                         65820000
658300                 AP_TRN_CDE,                                      65830000
658400                 DISTRB_SEQ_NBR,                                  65840000
658500                 STR_NBR,                                         65850000
658600                 DEPT_NBR,                                        65860000
658700                 CL_NBR,                                          65870000
658800                 SKU_NBR,                                         65880000
658900                 GRO_COST_AMT,                                    65890000
659000                 RTL_AMT,                                         65900000
659100                 FRGT_AMT,                                        65910000
659200                 MISC_CHRG_AMT,                                   65920000
659300                 DISC_AMT,                                        65930000
659400                 NET_COST_AMT)                                    65940000
659500         VALUES                                                   65950000
659600            (:ADJDIS-VND-NBR                                      65960000
659700            ,:ADJDIS-DOC-NBR                                      65970000
659800            ,:ADJDIS-DOC-DTE                                      65980000
659900            ,:ADJDIS-AP-TRN-CDE                                   65990000
660000            ,:ADJDIS-DISTRB-SEQ-NBR                               66000000
660100            ,:ADJDIS-STR-NBR                                      66010000
660200            ,:ADJDIS-DEPT-NBR                                     66020000
660300            ,:ADJDIS-CL-NBR                                       66030000
660400            ,:ADJDIS-SKU-NBR                                      66040000
660500            ,:ADJDIS-GRO-COST-AMT                                 66050000
660600            ,:ADJDIS-RTL-AMT                                      66060000
660700            ,:ADJDIS-FRGT-AMT                                     66070000
660800            ,:ADJDIS-MISC-CHRG-AMT                                66080000
660900            ,:ADJDIS-DISC-AMT                                     66090000
661000            ,:ADJDIS-NET-COST-AMT)                                66100000
661100         END-EXEC                                                 66110000
661200                                                                  66120000
661300         EVALUATE TRUE                                            66130000
661400             WHEN SQLCODE = ZERO                                  66140000
661500             WHEN SQLCODE = -904                                  66150000
661600             WHEN SQLCODE = -913                                  66160000
661700                  CONTINUE                                        66170000
661800             WHEN SQLWARN0 NOT = SPACES                           66180000
661900             WHEN SQLCODE < ZERO                                  66190000
662000             WHEN SQLCODE > ZERO                                  66200000
662100                 MOVE '8100-ADJUSTMENT-DISTRO'                    66210000
662200                                    TO DP013-PARAGRAPH            66220000
662300                 MOVE 'INSERT A ROW INTO THE ADJ. DISTRO TABLE'   66230000
662400                                    TO DP013-MESSAGE-TEXT(1)      66240000
662500                 MOVE SQLCA         TO DP013-SQLCA                66250000
662600                 MOVE 'TADJDIS'     TO DP013-DB2-TABLE-NAME(1)    66260000
662700                 SET DP013-DB2-ABEND                              66270000
662800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           66280000
662900                 PERFORM DP013-0000-PROCESS-ABEND                 66290000
663000         END-EVALUATE                                             66300000
663100     END-PERFORM.                                                 66310000
663200                                                                  66320000
663300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        66330000
663400        MOVE '8100-ADJUSTMENT-DISTRO'                             66340000
663500                                   TO DP013-PARAGRAPH             66350000
663600        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT A NEW 66360000
663700-            ' DISTRO LINE   '    TO DP013-MESSAGE-TEXT (1)       66370000
663800        MOVE SQLCA                TO DP013-SQLCA                  66380000
663900        MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)     66390000
664000        SET DP013-DB2-ABEND                                       66400000
664100             DP013-XCTL-DISPLAY-RESTART                           66410000
664200                                  TO TRUE                         66420000
664300         PERFORM DP013-0000-PROCESS-ABEND                         66430000
664400     END-IF.                                                      66440000
664500                                                                  66450000
664600******************************************************************66460000
664700* THIS PARAGRAPH WILL UPDATE THE ONE DISTRIB LINE OF THE OFFSET  *66470000
664800* ADJUSTMENT.                                                    *66480000
664900******************************************************************66490000
665000 8200-ADJUSTMENT-DISTRO-UPDATE.                                   66500000
665100                                                                  66510000
665200     PERFORM                                                      66520000
665300        WITH TEST AFTER                                           66530000
665400         VARYING PV-RETRY-COUNTER                                 66540000
665500        FROM 1 BY 1                                               66550000
665600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               66560000
665700            OR (SQLCODE = +0))                                    66570000
665800                                                                  66580000
665900        EXEC SQL                                                  66590000
666000            UPDATE TADJDIS                                        66600000
666100            SET STR_NBR           = :ADJDIS-STR-NBR               66610000
666200               ,DEPT_NBR          = :ADJDIS-DEPT-NBR              66620000
666300               ,CL_NBR            = :ADJDIS-CL-NBR                66630000
666400               ,SKU_NBR           = :ADJDIS-SKU-NBR               66640000
666500               ,GRO_COST_AMT      = :ADJDIS-GRO-COST-AMT          66650000
666600               ,RTL_AMT           = :ADJDIS-RTL-AMT               66660000
666700               ,FRGT_AMT          = :ADJDIS-FRGT-AMT              66670000
666800               ,MISC_CHRG_AMT     = :ADJDIS-MISC-CHRG-AMT         66680000
666900               ,DISC_AMT          = :ADJDIS-DISC-AMT              66690000
667000               ,NET_COST_AMT      = :ADJDIS-NET-COST-AMT          66700000
667100            WHERE VND_NBR      = :ADJDIS-VND-NBR                  66710000
667200            AND DOC_NBR        = :ADJDIS-DOC-NBR                  66720000
667300            AND DOC_DTE        = :ADJDIS-DOC-DTE                  66730000
667400            AND AP_TRN_CDE     = :ADJDIS-AP-TRN-CDE               66740000
667500            AND DISTRB_SEQ_NBR = :ADJDIS-DISTRB-SEQ-NBR           66750000
667600        END-EXEC                                                  66760000
667700                                                                  66770000
667800        EVALUATE TRUE                                             66780000
667900           WHEN SQLCODE = +0                                      66790000
668000           WHEN SQLCODE = -904                                    66800000
668100           WHEN SQLCODE = -913                                    66810000
668200               CONTINUE                                           66820000
668300           WHEN SQLWARN0 NOT = SPACES                             66830000
668400           WHEN SQLCODE < +0                                      66840000
668500           WHEN SQLCODE > +0                                      66850000
668600              MOVE '8200-ADJ-DISTRO-UPD'                          66860000
668700                                 TO DP013-PARAGRAPH               66870000
668800              MOVE 'UPDATE A ROW ON TADJDIS'                      66880000
668900                                 TO DP013-MESSAGE-TEXT(1)         66890000
669000              MOVE SQLCA        TO DP013-SQLCA                    66900000
669100              MOVE 'TADJDIS'    TO DP013-DB2-TABLE-NAME (1)       66910000
669200              SET DP013-DB2-ABEND                                 66920000
669300                   DP013-XCTL-DISPLAY-RESTART TO TRUE             66930000
669400              PERFORM DP013-0000-PROCESS-ABEND                    66940000
669500        END-EVALUATE                                              66950000
669600     END-PERFORM.                                                 66960000
669700                                                                  66970000
669800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        66980000
669900       MOVE '8200-ADJ-DISTRO-UPD' TO DP013-PARAGRAPH              66990000
670000        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '               67000000
670100                                 TO DP013-MESSAGE-TEXT (1)        67010000
670200        MOVE 'TO UPDATE A TADJDIS ROW'                            67020000
670300                                 TO DP013-MESSAGE-TEXT (2)        67030000
670400        MOVE SQLCA                TO DP013-SQLCA                  67040000
670500        MOVE 'TADJDIS'           TO DP013-DB2-TABLE-NAME (1)      67050000
670600        SET DP013-DB2-ABEND                                       67060000
670700           DP013-XCTL-DISPLAY-RESTART                             67070000
670800                                  TO TRUE                         67080000
670900        PERFORM DP013-0000-PROCESS-ABEND                          67090000
671000     END-IF.                                                      67100000
671100                                                                  67110000
671200******************************************************************67120000
671300* THIS PARAGRAPH WILL UPDATE THE ONE DISTRIB LINE OF THE OFFSET  *67130000
671400* ADJUSTMENT.  IT ONLY UPDATES THE AMOUNTS OF THE DISTRIB LINE.  *67140000
671500******************************************************************67150000
671600 8210-OFFSET-ADJUST-DISTRO-UPDT.                                  67160000
671700                                                                  67170000
671800     PERFORM                                                      67180000
671900        WITH TEST AFTER                                           67190000
672000         VARYING PV-RETRY-COUNTER                                 67200000
672100        FROM 1 BY 1                                               67210000
672200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67220000
672300            OR (SQLCODE = +0))                                    67230000
672400                                                                  67240000
672500        EXEC SQL                                                  67250000
672600            UPDATE TADJDIS                                        67260000
672700            SET GRO_COST_AMT      = :ADJDIS-GRO-COST-AMT          67270000
672800               ,RTL_AMT           = :ADJDIS-RTL-AMT               67280000
672900               ,FRGT_AMT          = :ADJDIS-FRGT-AMT              67290000
673000               ,MISC_CHRG_AMT     = :ADJDIS-MISC-CHRG-AMT         67300000
673100               ,DISC_AMT          = :ADJDIS-DISC-AMT              67310000
673200               ,NET_COST_AMT      = :ADJDIS-NET-COST-AMT          67320000
673300            WHERE VND_NBR      = :ADJDIS-VND-NBR                  67330000
673400            AND DOC_NBR        = :ADJDIS-DOC-NBR                  67340000
673500            AND DOC_DTE        = :ADJDIS-DOC-DTE                  67350000
673600            AND AP_TRN_CDE     = :ADJDIS-AP-TRN-CDE               67360000
673700            AND DISTRB_SEQ_NBR = :ADJDIS-DISTRB-SEQ-NBR           67370000
673800        END-EXEC                                                  67380000
673900                                                                  67390000
674000        EVALUATE TRUE                                             67400000
674100           WHEN SQLCODE = +0                                      67410000
674200           WHEN SQLCODE = -904                                    67420000
674300           WHEN SQLCODE = -913                                    67430000
674400               CONTINUE                                           67440000
674500           WHEN SQLWARN0 NOT = SPACES                             67450000
674600           WHEN SQLCODE < +0                                      67460000
674700           WHEN SQLCODE > +0                                      67470000
674800              MOVE '8210-OFFSET-ADJUST-DISTRO-UPDT'               67480000
674900                                 TO DP013-PARAGRAPH               67490000
675000              MOVE 'UPDATE A ROW ON TADJDIS'                      67500000
675100                                 TO DP013-MESSAGE-TEXT(1)         67510000
675200              MOVE SQLCA        TO DP013-SQLCA                    67520000
675300              MOVE 'TADJDIS'    TO DP013-DB2-TABLE-NAME (1)       67530000
675400              SET DP013-DB2-ABEND                                 67540000
675500                   DP013-XCTL-DISPLAY-RESTART TO TRUE             67550000
675600              PERFORM DP013-0000-PROCESS-ABEND                    67560000
675700        END-EVALUATE                                              67570000
675800     END-PERFORM.                                                 67580000
675900                                                                  67590000
676000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        67600000
676100       MOVE '8210-OFFSET-ADJUST-DISTRO-UPDT' TO DP013-PARAGRAPH   67610000
676200        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '               67620000
676300                                 TO DP013-MESSAGE-TEXT (1)        67630000
676400        MOVE 'TO UPDATE A TADJDIS ROW'                            67640000
676500                                 TO DP013-MESSAGE-TEXT (2)        67650000
676600        MOVE SQLCA                TO DP013-SQLCA                  67660000
676700        MOVE 'TADJDIS'           TO DP013-DB2-TABLE-NAME (1)      67670000
676800        SET DP013-DB2-ABEND                                       67680000
676900           DP013-XCTL-DISPLAY-RESTART                             67690000
677000                                  TO TRUE                         67700000
677100        PERFORM DP013-0000-PROCESS-ABEND                          67710000
677200     END-IF.                                                      67720000
677300                                                                  67730000
677400******************************************************************67740000
677500* THIS PARAGRAPH WILL DELETE AN ADJUSTMENT RECORD.               *67750000
677600******************************************************************67760000
677700 8500-DELETE-TADJRNL.                                             67770000
677800                                                                  67780000
677900     PERFORM                                                      67790000
678000        WITH TEST AFTER                                           67800000
678100         VARYING PV-RETRY-COUNTER                                 67810000
678200        FROM 1 BY 1                                               67820000
678300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67830000
678400            OR (SQLCODE = +0))                                    67840000
678500                                                                  67850000
678600        EXEC SQL                                                  67860000
678700           DELETE FROM                                            67870000
678800              TADJRNL                                             67880000
678900              WHERE VND_NBR      = :ADJRNL-VND-NBR                67890000
679000              AND DOC_NBR        = :ADJRNL-DOC-NBR                67900000
679100              AND DOC_DTE        = :ADJRNL-DOC-DTE                67910000
679200              AND AP_TRN_CDE     = :ADJRNL-AP-TRN-CDE             67920000
679300        END-EXEC                                                  67930000
679400                                                                  67940000
679500        EVALUATE TRUE                                             67950000
679600             WHEN SQLCODE = +0                                    67960000
679700             WHEN SQLCODE = -904                                  67970000
679800             WHEN SQLCODE = -913                                  67980000
679900                 CONTINUE                                         67990000
680000                                                                  68000000
680100             WHEN SQLWARN0 NOT = SPACES                           68010000
680200             WHEN SQLCODE < +0                                    68020000
680300             WHEN SQLCODE < +0                                    68030000
680400             WHEN SQLCODE > +0                                    68040000
680500                 MOVE '8500-DELETE-TADJRNL'                       68050000
680600                                   TO DP013-PARAGRAPH             68060000
680700                 MOVE 'DELETE A ROW ON TADJRNL'                   68070000
680800                                   TO DP013-MESSAGE-TEXT(1)       68080000
680900                 MOVE SQLCA        TO DP013-SQLCA                 68090000
681000                 MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1)    68100000
681100                 SET DP013-DB2-ABEND                              68110000
681200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           68120000
681300                 PERFORM DP013-0000-PROCESS-ABEND                 68130000
681400         END-EVALUATE                                             68140000
681500     END-PERFORM.                                                 68150000
681600                                                                  68160000
681700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        68170000
681800         MOVE '8500-DELETE-TADJRNL' TO DP013-PARAGRAPH            68180000
681900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              68190000
682000                                   TO DP013-MESSAGE-TEXT (1)      68200000
682100         MOVE 'TO DELETE A TADJRNL ROW'                           68210000
682200                                   TO DP013-MESSAGE-TEXT (2)      68220000
682300         MOVE SQLCA                TO DP013-SQLCA                 68230000
682400         MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)    68240000
682500         SET DP013-DB2-ABEND                                      68250000
682600             DP013-XCTL-DISPLAY-RESTART                           68260000
682700                                   TO TRUE                        68270000
682800         PERFORM DP013-0000-PROCESS-ABEND                         68280000
682900     END-IF.                                                      68290000
683000                                                                  68300000
683100******************************************************************68310000
683200* THIS PARAGRAPH DELETE ANY SELECTED LINES OF ADJUSTMENT         *68320000
683300* DISTRIBUTION OF THE TADJDIS DB2 TABLE.                         *68330000
683400******************************************************************68340000
683500 8600-ADJUSTMENT-DISTRO-DELETE.                                   68350000
683600                                                                  68360000
683700     PERFORM                                                      68370000
683800        WITH TEST AFTER                                           68380000
683900         VARYING PV-RETRY-COUNTER                                 68390000
684000        FROM 1 BY 1                                               68400000
684100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               68410000
684200            OR (SQLCODE = +0))                                    68420000
684300                                                                  68430000
684400        EXEC SQL                                                  68440000
684500            DELETE FROM                                           68450000
684600               TADJDIS                                            68460000
684700               WHERE VND_NBR   = :ADJDIS-VND-NBR                  68470000
684800               AND DOC_NBR     = :ADJDIS-DOC-NBR                  68480000
684900               AND DOC_DTE     = :ADJDIS-DOC-DTE                  68490000
685000               AND AP_TRN_CDE  = :ADJDIS-AP-TRN-CDE               68500000
685100               AND DISTRB_SEQ_NBR = :ADJDIS-DISTRB-SEQ-NBR        68510000
685200        END-EXEC                                                  68520000
685300                                                                  68530000
685400        EVALUATE TRUE                                             68540000
685500           WHEN SQLCODE = +0                                      68550000
685600           WHEN SQLCODE = -904                                    68560000
685700           WHEN SQLCODE = -913                                    68570000
685800               CONTINUE                                           68580000
685900           WHEN SQLWARN0 NOT = SPACES                             68590000
686000           WHEN SQLCODE < +0                                      68600000
686100           WHEN SQLCODE > +0                                      68610000
686200              MOVE '8600-ADJ-DISTRO-DEL'                          68620000
686300                                 TO DP013-PARAGRAPH               68630000
686400              MOVE 'DELETE A ROW ON TADJDIS'                      68640000
686500                                 TO DP013-MESSAGE-TEXT(1)         68650000
686600              MOVE SQLCA        TO DP013-SQLCA                    68660000
686700              MOVE 'TADJDIS'    TO DP013-DB2-TABLE-NAME (1)       68670000
686800              SET DP013-DB2-ABEND                                 68680000
686900                   DP013-XCTL-DISPLAY-RESTART TO TRUE             68690000
687000              PERFORM DP013-0000-PROCESS-ABEND                    68700000
687100        END-EVALUATE                                              68710000
687200     END-PERFORM.                                                 68720000
687300                                                                  68730000
687400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        68740000
687500       MOVE '8600-ADJ-DISTRO-DEL' TO DP013-PARAGRAPH              68750000
687600        MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '               68760000
687700                                 TO DP013-MESSAGE-TEXT (1)        68770000
687800        MOVE 'TO DELETE A TADJDIS ROW'                            68780000
687900                                 TO DP013-MESSAGE-TEXT (2)        68790000
688000        MOVE SQLCA                TO DP013-SQLCA                  68800000
688100        MOVE 'TADJDIS'           TO DP013-DB2-TABLE-NAME (1)      68810000
688200        SET DP013-DB2-ABEND                                       68820000
688300           DP013-XCTL-DISPLAY-RESTART                             68830000
688400                                  TO TRUE                         68840000
688500        PERFORM DP013-0000-PROCESS-ABEND                          68850000
688600     END-IF.                                                      68860000
688700                                                                  68870000
688800*----------------------------------------------------------------*68880000
688900*  ABEND PROCESSOR MODULE                                        *68890000
689000*----------------------------------------------------------------*68900000
689100                                                                  68910000
689200     COPY DPPD013.                                                68920000
