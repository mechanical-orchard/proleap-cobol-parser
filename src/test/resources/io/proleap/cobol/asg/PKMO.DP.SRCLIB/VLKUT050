000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.             VLKUT050.                                00050099
000600 AUTHOR.                 PAUL JORGENSEN.                          00060099
000700 INSTALLATION.           KOHLS.                                   00070099
000800 DATE-WRITTEN            MARCH 2009.                              00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*  THIS PROGRAM WILL GIVE A QUERY ON HOW MANY RECEIPT UNITS       00120099
001300*  ARE FOR A PARTICULAR PO/RCVR AT EACH DC FOR PO'S THAT HAVE A   00130099
001400*  SEASONAL SET CODE IN TSEASET WITH PO_RCPT_RPTG_IND SET TO 'Y'  00140099
001500*  THE PROGRAM STARTED OUT AS A REPORT WHICH IS WHY THERE ARE     00150099
001600*  REPORT STYLE DATA NAMES. THEN IT WAS CONVERTED TO DATA FILE    00160099
001700*  OUTPUT.                                                        00170099
001800***************************************************************** 00180099
001900*                                                               * 00190099
AV0524*  CHANGED 06/03/21 BY ANIL VEDURUPARTHI                        * 00200099
AV0524*   WR# CHG0257543 : MODIFIED PROGRAM MAIN CURSOR FOR BETTER    * 00210099
AV0524*                    PERFORMANCE                                * 00220099
AV0524*                                                               * 00230099
002400******************************************************************00240099
002500 ENVIRONMENT DIVISION.                                            00250099
002600******************************************************************00260099
002700                                                                  00270099
002800 CONFIGURATION SECTION.                                           00280099
002900                                                                  00290099
003000 SOURCE-COMPUTER.        IBM-3090.                                00300099
003100 OBJECT-COMPUTER.        IBM-3090.                                00310099
003200                                                                  00320099
003300 INPUT-OUTPUT SECTION.                                            00330099
003400                                                                  00340099
003500 FILE-CONTROL.                                                    00350099
003600                                                                  00360099
003700     SELECT DI-OUTPUT-FILE                                        00370099
003800         ASSIGN TO OUT01.                                         00380099
003900                                                                  00390099
004000******************************************************************00400099
004100 DATA DIVISION.                                                   00410099
004200******************************************************************00420099
004300                                                                  00430099
004400 FILE SECTION.                                                    00440099
004500                                                                  00450099
004600 FD  DI-OUTPUT-FILE                                               00460099
004700     RECORDING MODE IS F                                          00470099
004800     LABEL RECORDS ARE STANDARD                                   00480099
004900     BLOCK CONTAINS 0 RECORDS.                                    00490099
005000                                                                  00500099
005100 01  DI-OUTPUT-RECORD                    PIC  X(400).             00510099
005200                                                                  00520099
005300******************************************************************00530099
005400 WORKING-STORAGE SECTION.                                         00540099
005500******************************************************************00550099
005600                                                                  00560099
005700*                                                                 00570099
005800*  STANDARD REPORT HEADER FOR A 200 COLUMN REPORT.                00580099
005900*                                                                 00590099
006000     COPY DPWS200O.                                               00600099
006100                                                                  00610099
006200 01  ABEND-CODE                          PIC S9(04) VALUE +0      00620099
006300                                                     COMP SYNC.   00630099
006400                                                                  00640099
006500*                                                                 00650099
006600*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      00660099
006700*                                                                 00670099
006800     COPY DPWS004.                                                00680099
006900                                                                  00690099
007000 01  DH2-DETAIL-HEADING.                                          00700099
007100     05  FILLER                          PIC  X(06)  VALUE        00710099
007200         'SEASET'.                                                00720099
007300     05  FILLER                          PIC  X(01)  VALUE ' '.   00730099
007400     05  FILLER                          PIC  X(09)  VALUE SPACES.00740099
007500     05  FILLER                          PIC  X(01)  VALUE ' '.   00750099
007600     05  FILLER                          PIC  X(03)  VALUE        00760099
007700         'PKG'.                                                   00770099
007800     05  FILLER                          PIC  X(01)  VALUE ' '.   00780099
007900     05  FILLER                          PIC  X(04)  VALUE        00790099
008000         ' PO '.                                                  00800099
008100     05  FILLER                          PIC  X(01)  VALUE ' '.   00810099
008200     05  FILLER                          PIC  X(30)  VALUE SPACES.00820099
008300     05  FILLER                          PIC  X(01)  VALUE ' '.   00830099
008400     05  FILLER                          PIC  X(04)  VALUE SPACES.00840099
008500     05  FILLER                          PIC  X(01)  VALUE ' '.   00850099
008600     05  FILLER                          PIC  X(10)  VALUE SPACES.00860099
008700     05  FILLER                          PIC  X(01)  VALUE ' '.   00870099
008800     05  FILLER                          PIC  X(10)  VALUE SPACES.00880099
008900     05  FILLER                          PIC  X(02)  VALUE ' '.   00890099
009000     05  FILLER                          PIC  X(09)  VALUE SPACES.00900099
009100     05  FILLER                          PIC  X(01)  VALUE ' '.   00910099
009200     05  FILLER                          PIC  X(09)  VALUE        00920099
009300         '    TOTAL'.                                             00930099
009400     05  FILLER                          PIC  X(01)  VALUE ' '.   00940099
009500     05  FILLER                          PIC  X(08)  VALUE SPACES.00950099
009600     05  FILLER                          PIC  X(01)  VALUE ' '.   00960099
009700     05  FILLER                          PIC  X(09)  VALUE SPACES.00970099
009800     05  FILLER                          PIC  X(01)  VALUE ' '.   00980099
009900     05  FILLER                          PIC  X(09)  VALUE SPACES.00990099
010000     05  FILLER                          PIC  X(01)  VALUE ' '.   01000099
010100     05  FILLER                          PIC  X(09)  VALUE SPACES.01010099
010200     05  FILLER                          PIC  X(01)  VALUE ' '.   01020099
010300     05  FILLER                          PIC  X(09)  VALUE        01030099
010400         'RECEIVER '.                                             01040099
010500     05  FILLER                          PIC  X(01)  VALUE ' '.   01050099
010600     05  FILLER                          PIC  X(09)  VALUE        01060099
010700         'UNITS    '.                                             01070099
010800     05  FILLER                          PIC  X(01)  VALUE ' '.   01080099
010900     05  FILLER                          PIC  X(09)  VALUE SPACES.01090099
011000     05  FILLER                          PIC  X(01)  VALUE ' '.   01100099
011100     05  FILLER                          PIC  X(09)  VALUE SPACES.01110099
011200     05  FILLER                          PIC  X(01)  VALUE ' '.   01120099
011300     05  FILLER                          PIC  X(09)  VALUE SPACES.01130099
011400     05  FILLER                          PIC  X(01)  VALUE ' '.   01140099
011500     05  FILLER                          PIC  X(09)  VALUE SPACES.01150099
011600     05  FILLER                          PIC  X(01)  VALUE ' '.   01160099
011700     05  FILLER                          PIC  X(09)  VALUE SPACES.01170099
011800                                                                  01180099
011900 01  DH2-DETAIL-HEADING-2.                                        01190099
012000     05  FILLER                          PIC  X(06)  VALUE        01200099
012100         ' NAME '.                                                01210099
012200     05  FILLER                          PIC  X(01)  VALUE ' '.   01220099
012300     05  FILLER                          PIC  X(09)  VALUE        01230099
012400         '   PO NBR'.                                             01240099
012500     05  FILLER                          PIC  X(01)  VALUE ' '.   01250099
012600     05  FILLER                          PIC  X(03)  VALUE        01260099
012700         'CDE'.                                                   01270099
012800     05  FILLER                          PIC  X(01)  VALUE ' '.   01280099
012900     05  FILLER                          PIC  X(04)  VALUE        01290099
013000         'TYPE'.                                                  01300099
013100     05  FILLER                          PIC  X(01)  VALUE ' '.   01310099
013200     05  FILLER                          PIC  X(30)  VALUE        01320099
013300         'VENDOR                        '.                        01330099
013400     05  FILLER                          PIC  X(01)  VALUE ' '.   01340099
013500     05  FILLER                          PIC  X(04)  VALUE        01350099
013600         'DEPT'.                                                  01360099
013700     05  FILLER                          PIC  X(01)  VALUE ' '.   01370099
013800     05  FILLER                          PIC  X(10)  VALUE        01380099
013900         '   SHIP   '.                                            01390099
014000     05  FILLER                          PIC  X(01)  VALUE ' '.   01400099
014100     05  FILLER                          PIC  X(10)  VALUE        01410099
014200         '  CANCEL  '.                                            01420099
014300     05  FILLER                          PIC  X(01)  VALUE ' '.   01430099
014400     05  FILLER                          PIC  X(10)  VALUE        01440099
014500         'EXT CANCEL'.                                            01450099
014600     05  FILLER                          PIC  X(01)  VALUE ' '.   01460099
014700     05  FILLER                          PIC  X(09)  VALUE        01470099
014800         '    UNITS'.                                             01480099
014900     05  FILLER                          PIC  X(01)  VALUE ' '.   01490099
015000     05  FILLER                          PIC  X(08)  VALUE        01500099
015100         ' STATUS '.                                              01510099
015200     05  FILLER                          PIC  X(01)  VALUE ' '.   01520099
015300     05  WS-HEADER-DC-DET                OCCURS 0 TO 30 TIMES     01530099
015400         DEPENDING ON                    WS-DC-ACTIVE-CNT.        01540099
015500         10  WS-HEADER-DC                PIC  ZZZZZZZZ9.          01550099
015600         10  FILLER                      PIC  X(01)  VALUE SPACE. 01560099
015700*                                                                 01570099
015800 01  DL-DETAIL-LINE.                                              01580099
015900     05  DL-SEASET                       PIC  X(06).              01590099
016000     05  FILLER                          PIC  X(01)  VALUE ' '.   01600099
016100     05  DL-PO-NUMBER                    PIC  X(09).              01610099
016200     05  FILLER                          PIC  X(01)  VALUE ' '.   01620099
016300     05  DL-PKGNG-CDE                    PIC  X(03).              01630099
016400     05  FILLER                          PIC  X(01)  VALUE ' '.   01640099
016500     05  DL-PO-TYP-CDE                   PIC  X(04).              01650099
016600     05  FILLER                          PIC  X(01)  VALUE ' '.   01660099
016700     05  DL-VENDOR-NAME                  PIC  X(30).              01670099
016800     05  FILLER                          PIC  X(01)  VALUE ' '.   01680099
016900     05  DL-DEPT-NBR                     PIC  X(04).              01690099
017000     05  FILLER                          PIC  X(01)  VALUE ' '.   01700099
017100     05  DL-SHIP-DATE                    PIC  X(10).              01710099
017200     05  FILLER                          PIC  X(01)  VALUE ' '.   01720099
017300     05  DL-CANCEL-DATE                  PIC  X(10).              01730099
017400     05  FILLER                          PIC  X(01)  VALUE ' '.   01740099
017500     05  DL-EXT-CANCEL-DATE              PIC  X(10).              01750099
017600     05  FILLER                          PIC  X(01)  VALUE ' '.   01760099
017700     05  DL-TOTAL-UNITS                  PIC  X(09).              01770099
017800     05  FILLER                          PIC  X(01)  VALUE ' '.   01780099
017900     05  DL-RECEIV-STATUS.                                        01790099
018000         10  DL-RECEIV-STATUS-CDE        PIC  X(02).              01800099
018100         10  FILLER                      PIC  X(01)  VALUE SPACES.01810099
018200         10  DL-RECEIV-ENROUTE           PIC  X(05).              01820099
018300     05  FILLER                          PIC  X(01)  VALUE ' '.   01830099
018400     05  WS-DC-ITEM-QTY-DET              OCCURS 0 TO 30 TIMES     01840099
018500         DEPENDING ON                    WS-DC-ACTIVE-CNT.        01850099
018600         10 WS-DC-ITEM-QTY-HDR           PIC  ZZZZZZZZ9.          01860099
018700         10 FILLER                       PIC  X(01)  VALUE ' '.   01870099
018800*                                                                 01880099
018810 01  DL-DETAIL-DUMMY-LINE.                                        01881099
018820     05  DL-DUMMY-SEASET                 PIC  X(06).              01882099
018830     05  FILLER                          PIC  X(01)  VALUE ' '.   01883099
018840     05  DL-DUMMY-PO-NUMBER              PIC  9(09).              01884099
018850     05  FILLER                          PIC  X(01)  VALUE ' '.   01885099
018860     05  DL-DUMMY-PKGNG-CDE              PIC  X(03).              01886099
018870     05  FILLER                          PIC  X(01)  VALUE ' '.   01887099
018880     05  DL-DUMMY-PO-TYP-CDE             PIC  X(04).              01888099
018890     05  FILLER                          PIC  X(01)  VALUE ' '.   01889099
018891     05  DL-DUMMY-VENDOR-NAME            PIC  X(30).              01889199
018892     05  FILLER                          PIC  X(01)  VALUE ' '.   01889299
018893     05  DL-DUMMY-DEPT-NBR               PIC  9(04).              01889399
018894     05  FILLER                          PIC  X(01)  VALUE ' '.   01889499
018895     05  DL-DUMMY-SHIP-DATE              PIC  X(10).              01889599
018896     05  FILLER                          PIC  X(01)  VALUE ' '.   01889699
018897     05  DL-DUMMY-CANCEL-DATE            PIC  X(10).              01889799
018898     05  FILLER                          PIC  X(01)  VALUE ' '.   01889899
018899     05  DL-DUMMY-EXT-CANCEL-DATE        PIC  X(10).              01889999
018900     05  FILLER                          PIC  X(01)  VALUE ' '.   01890099
018901     05  DL-DUMMY-TOTAL-UNITS            PIC  9(09).              01890199
018902     05  FILLER                          PIC  X(01)  VALUE ' '.   01890299
018903     05  DL-DUMMY-RECEIV-STATUS          PIC  X(08).              01890399
018907     05  FILLER                          PIC  X(01)  VALUE ' '.   01890499
018908     05  WS-DUMMY-DC-ITEM-QTY-DET        OCCURS 0 TO 30 TIMES     01890599
018909         DEPENDING ON                    WS-DC-ACTIVE-CNT.        01890699
018910         10 WS-DUMMY-DC-ITEM-QTY-HDR     PIC  ZZZZZZZZ9.          01890799
018911         10 FILLER                       PIC  X(01)  VALUE ' '.   01890899
018912*                                                                 01890999
018920                                                                  01891099
019000 01  DH2-SUMMARY-COLS-HEADING.                                    01892099
019100     05  FILLER                          PIC  X(06)  VALUE SPACES.01893099
019200     05  FILLER                          PIC  X(01)  VALUE ' '.   01894099
019300     05  FILLER                          PIC  X(09)  VALUE SPACES.01895099
019400     05  FILLER                          PIC  X(01)  VALUE ' '.   01896099
019500     05  FILLER                          PIC  X(03)  VALUE SPACES.01897099
019600     05  FILLER                          PIC  X(01)  VALUE ' '.   01898099
019700     05  FILLER                          PIC  X(04)  VALUE SPACES.01899099
019800     05  FILLER                          PIC  X(01)  VALUE ' '.   01900099
019900     05  FILLER                          PIC  X(30)  VALUE        01910099
020000         '  TOTAL UNITS PER DISTRIBUTION'.                        01920099
020100     05  FILLER                          PIC  X(01)  VALUE ' '.   01930099
020200     05  FILLER                          PIC  X(04)  VALUE SPACES.01940099
020300     05  FILLER                          PIC  X(01)  VALUE ' '.   01950099
020400     05  FILLER                          PIC  X(10)  VALUE SPACES.01960099
020500     05  FILLER                          PIC  X(01)  VALUE ' '.   01970099
020600     05  FILLER                          PIC  X(10)  VALUE SPACES.01980099
020700     05  FILLER                          PIC  X(01)  VALUE ' '.   01990099
020800     05  FILLER                          PIC  X(10)  VALUE SPACES.02000099
020900     05  FILLER                          PIC  X(01)  VALUE ' '.   02010099
021000     05  FILLER                          PIC  X(09)  VALUE SPACES.02020099
021100     05  FILLER                          PIC  X(01)  VALUE ' '.   02030099
021200     05  FILLER                          PIC  X(08)  VALUE SPACES.02040099
021300     05  FILLER                          PIC  X(01)  VALUE ' '.   02050099
021400     05  WS-SUMMARY-DC-DET               OCCURS 0 TO 30 TIMES     02060099
021500         DEPENDING ON                    WS-DC-ACTIVE-CNT.        02070099
021600         10  WS-SUMM-DC                  PIC  ZZZZZZZZ9.          02080099
021700         10  FILLER                      PIC  X(01)  VALUE SPACE. 02090099
021800                                                                  02100099
021900 01  DH2-DETAIL-SUMMARY.                                          02110099
022000     05  FILLER                          PIC  X(06)  VALUE SPACES.02120099
022100     05  FILLER                          PIC  X(01)  VALUE ' '.   02130099
022200     05  FILLER                          PIC  X(09)  VALUE SPACES.02140099
022300     05  FILLER                          PIC  X(01)  VALUE ' '.   02150099
022400     05  FILLER                          PIC  X(03)  VALUE SPACES.02160099
022500     05  FILLER                          PIC  X(01)  VALUE ' '.   02170099
022600     05  FILLER                          PIC  X(04)  VALUE SPACES.02180099
022700     05  FILLER                          PIC  X(01)  VALUE ' '.   02190099
022800     05  FILLER                          PIC  X(30)  VALUE SPACES.02200099
022900     05  FILLER                          PIC  X(01)  VALUE ' '.   02210099
023000     05  FILLER                          PIC  X(04)  VALUE SPACES.02220099
023100     05  FILLER                          PIC  X(01)  VALUE ' '.   02230099
023200     05  FILLER                          PIC  X(10)  VALUE SPACES.02240099
023300     05  FILLER                          PIC  X(01)  VALUE ' '.   02250099
023400     05  FILLER                          PIC  X(10)  VALUE SPACES.02260099
023500     05  FILLER                          PIC  X(01)  VALUE ' '.   02270099
023600     05  FILLER                          PIC  X(10)  VALUE SPACES.02280099
023700     05  FILLER                          PIC  X(01)  VALUE ' '.   02290099
023800     05  FILLER                          PIC  X(09)  VALUE SPACES.02300099
023900     05  FILLER                          PIC  X(01)  VALUE ' '.   02310099
024000     05  FILLER                          PIC  X(08)  VALUE        02320099
024100         'CM:     '.                                              02330099
024200     05  FILLER                          PIC  X(1) VALUE ' '.     02340099
024300     05  DL-CM-DC-TOTAL-DET              OCCURS 0 TO 30 TIMES     02350099
024400         DEPENDING ON                    WS-DC-ACTIVE-CNT.        02360099
024500          10 DL-CM-DC-TOTAL              PIC  ZZZZZZZZ9.          02370099
024600          10 FILLER                      PIC  X(1) VALUE ' '.     02380099
024700                                                                  02390099
024800 01  DL-DETAIL-SUMMARY1.                                          02400099
024900     05  FILLER                          PIC  X(06)  VALUE SPACES.02410099
025000     05  FILLER                          PIC  X(01)  VALUE ' '.   02420099
025100     05  FILLER                          PIC  X(09)  VALUE SPACES.02430099
025200     05  FILLER                          PIC  X(01)  VALUE ' '.   02440099
025300     05  FILLER                          PIC  X(03)  VALUE SPACES.02450099
025400     05  FILLER                          PIC  X(01)  VALUE ' '.   02460099
025500     05  FILLER                          PIC  X(04)  VALUE SPACES.02470099
025600     05  FILLER                          PIC  X(01)  VALUE ' '.   02480099
025700     05  FILLER                          PIC  X(30)  VALUE SPACES.02490099
025800     05  FILLER                          PIC  X(01)  VALUE ' '.   02500099
025900     05  FILLER                          PIC  X(04)  VALUE SPACES.02510099
026000     05  FILLER                          PIC  X(01)  VALUE ' '.   02520099
026100     05  FILLER                          PIC  X(10)  VALUE SPACES.02530099
026200     05  FILLER                          PIC  X(01)  VALUE ' '.   02540099
026300     05  FILLER                          PIC  X(10)  VALUE SPACES.02550099
026400     05  FILLER                          PIC  X(01)  VALUE ' '.   02560099
026500     05  FILLER                          PIC  X(10)  VALUE SPACES.02570099
026600     05  FILLER                          PIC  X(01)  VALUE ' '.   02580099
026700     05  FILLER                          PIC  X(09)  VALUE SPACES.02590099
026800     05  FILLER                          PIC  X(01)  VALUE ' '.   02600099
026900     05  FILLER                          PIC  X(08)  VALUE        02610099
027000         'IP ENRT:'.                                              02620099
027100     05  FILLER                          PIC  X(01)  VALUE ' '.   02630099
027200     05  DL-ENRT-DC-TOTAL-DET            OCCURS 0 TO 30 TIMES     02640099
027300         DEPENDING ON                    WS-DC-ACTIVE-CNT.        02650099
027400         10 DL-ENRT-DC-TOTAL             PIC  ZZZZZZZZ9.          02660099
027500         10 FILLER                       PIC  X(1) VALUE ' '.     02670099
027600                                                                  02680099
027700 01  DL-DETAIL-SUMMARY2.                                          02690099
027800     05  FILLER                          PIC  X(06)  VALUE SPACES.02700099
027900     05  FILLER                          PIC  X(01)  VALUE ' '.   02710099
028000     05  FILLER                          PIC  X(09)  VALUE SPACES.02720099
028100     05  FILLER                          PIC  X(01)  VALUE ' '.   02730099
028200     05  FILLER                          PIC  X(03)  VALUE SPACES.02740099
028300     05  FILLER                          PIC  X(01)  VALUE ' '.   02750099
028400     05  FILLER                          PIC  X(04)  VALUE SPACES.02760099
028500     05  FILLER                          PIC  X(01)  VALUE ' '.   02770099
028600     05  FILLER                          PIC  X(30)  VALUE SPACES.02780099
028700     05  FILLER                          PIC  X(01)  VALUE ' '.   02790099
028800     05  FILLER                          PIC  X(04)  VALUE SPACES.02800099
028900     05  FILLER                          PIC  X(01)  VALUE ' '.   02810099
029000     05  FILLER                          PIC  X(10)  VALUE SPACES.02820099
029100     05  FILLER                          PIC  X(01)  VALUE ' '.   02830099
029200     05  FILLER                          PIC  X(10)  VALUE SPACES.02840099
029300     05  FILLER                          PIC  X(01)  VALUE ' '.   02850099
029400     05  FILLER                          PIC  X(10)  VALUE SPACES.02860099
029500     05  FILLER                          PIC  X(01)  VALUE ' '.   02870099
029600     05  FILLER                          PIC  X(09)  VALUE SPACES.02880099
029700     05  FILLER                          PIC  X(01)  VALUE ' '.   02890099
029800     05  FILLER                          PIC  X(08)  VALUE        02900099
029900         'IP:     '.                                              02910099
030000     05  FILLER                          PIC  X(1) VALUE ' '.     02920099
030100     05  DL-IP-DC-TOTAL-DET              OCCURS 0 TO 30 TIMES     02930099
030200         DEPENDING ON                    WS-DC-ACTIVE-CNT.        02940099
030300         10 DL-IP-DC-TOTAL               PIC  ZZZZZZZZ9.          02950099
030400         10 FILLER                       PIC  X(1) VALUE ' '.     02960099
030500                                                                  02970099
030600 01  DL-DETAIL-SUMMARY3.                                          02980099
030700     05  FILLER                          PIC  X(06)  VALUE SPACES.02990099
030800     05  FILLER                          PIC  X(01)  VALUE ' '.   03000099
030900     05  FILLER                          PIC  X(09)  VALUE SPACES.03010099
031000     05  FILLER                          PIC  X(01)  VALUE ' '.   03020099
031100     05  FILLER                          PIC  X(03)  VALUE SPACES.03030099
031200     05  FILLER                          PIC  X(01)  VALUE ' '.   03040099
031300     05  FILLER                          PIC  X(04)  VALUE SPACES.03050099
031400     05  FILLER                          PIC  X(01)  VALUE ' '.   03060099
031500     05  FILLER                          PIC  X(30)  VALUE SPACES.03070099
031600     05  FILLER                          PIC  X(01)  VALUE ' '.   03080099
031700     05  FILLER                          PIC  X(04)  VALUE SPACES.03090099
031800     05  FILLER                          PIC  X(01)  VALUE ' '.   03100099
031900     05  FILLER                          PIC  X(10)  VALUE SPACES.03110099
032000     05  FILLER                          PIC  X(01)  VALUE ' '.   03120099
032100     05  FILLER                          PIC  X(10)  VALUE SPACES.03130099
032200     05  FILLER                          PIC  X(01)  VALUE ' '.   03140099
032300     05  FILLER                          PIC  X(10)  VALUE SPACES.03150099
032400     05  FILLER                          PIC  X(01)  VALUE ' '.   03160099
032500     05  FILLER                          PIC  X(09)  VALUE SPACES.03170099
032600     05  FILLER                          PIC  X(01)  VALUE ' '.   03180099
032700     05  FILLER                          PIC  X(08)  VALUE        03190099
032800         'VE:     '.                                              03200099
032900     05  FILLER                          PIC  X(01) VALUE ' '.    03210099
033000     05  DL-VE-DC-TOTAL-DET              OCCURS 0 TO 30 TIMES     03220099
033100         DEPENDING ON                    WS-DC-ACTIVE-CNT.        03230099
033200         10  DL-VE-DC-TOTAL              PIC  ZZZZZZZZ9.          03240099
033300         10  FILLER                      PIC  X(01) VALUE ' '.    03250099
033400*                                                                 03260099
033500 01  BLANK-LINE.                                                  03270099
033600     05  FILLER                          PIC  X(06)  VALUE SPACES.03280099
033700     05  FILLER                          PIC  X(01)  VALUE ' '.   03290099
033800     05  FILLER                          PIC  X(09)  VALUE SPACES.03300099
033900     05  FILLER                          PIC  X(01)  VALUE ' '.   03310099
034000     05  FILLER                          PIC  X(03)  VALUE SPACES.03320099
034100     05  FILLER                          PIC  X(01)  VALUE ' '.   03330099
034200     05  FILLER                          PIC  X(04)  VALUE SPACES.03340099
034300     05  FILLER                          PIC  X(01)  VALUE ' '.   03350099
034400     05  FILLER                          PIC  X(30)  VALUE SPACES.03360099
034500     05  FILLER                          PIC  X(01)  VALUE ' '.   03370099
034600     05  FILLER                          PIC  X(04)  VALUE SPACES.03380099
034700     05  FILLER                          PIC  X(01)  VALUE ' '.   03390099
034800     05  FILLER                          PIC  X(10)  VALUE SPACES.03400099
034900     05  FILLER                          PIC  X(01)  VALUE ' '.   03410099
035000     05  FILLER                          PIC  X(10)  VALUE SPACES.03420099
035100     05  FILLER                          PIC  X(02)  VALUE ' '.   03430099
035200     05  FILLER                          PIC  X(09)  VALUE SPACES.03440099
035300     05  FILLER                          PIC  X(01)  VALUE ' '.   03450099
035400     05  FILLER                          PIC  X(09)  VALUE SPACES.03460099
035500     05  FILLER                          PIC  X(01)  VALUE ' '.   03470099
035600     05  FILLER                          PIC  X(08)  VALUE SPACES.03480099
035700     05  FILLER                          PIC  X(01)  VALUE ' '.   03490099
035800     05  FILLER                          PIC  X(09)  VALUE SPACES.03500099
035900     05  FILLER                          PIC  X(01)  VALUE ' '.   03510099
036000     05  FILLER                          PIC  X(09)  VALUE SPACES.03520099
036100     05  FILLER                          PIC  X(01)  VALUE ' '.   03530099
036200     05  FILLER                          PIC  X(09)  VALUE SPACES.03540099
036300     05  FILLER                          PIC  X(01)  VALUE ' '.   03550099
036400     05  FILLER                          PIC  X(09)  VALUE SPACES.03560099
036500     05  FILLER                          PIC  X(01)  VALUE ' '.   03570099
036600     05  FILLER                          PIC  X(09)  VALUE SPACES.03580099
036700     05  FILLER                          PIC  X(01)  VALUE ' '.   03590099
036800     05  FILLER                          PIC  X(09)  VALUE SPACES.03600099
036900     05  FILLER                          PIC  X(01)  VALUE ' '.   03610099
037000     05  FILLER                          PIC  X(09)  VALUE SPACES.03620099
037100     05  FILLER                          PIC  X(01)  VALUE ' '.   03630099
037200     05  FILLER                          PIC  X(09)  VALUE SPACES.03640099
037300     05  FILLER                          PIC  X(01)  VALUE ' '.   03650099
037400     05  FILLER                          PIC  X(09)  VALUE SPACES.03660099
037500     05  FILLER                          PIC  X(01)  VALUE ' '.   03670099
037600     05  FILLER                          PIC  X(09)  VALUE SPACES.03680099
037700     05  FILLER                          PIC  X(01)  VALUE ' '.   03690099
037800     05  FILLER                          PIC  X(09)  VALUE SPACES.03700099
037900                                                                  03710099
038000 01  ER-EMPTY-REPORT-LINE.                                        03720099
038100     05  FILLER                          PIC  X(56)  VALUE SPACE. 03730099
038200     05  FILLER                          PIC  X(25)  VALUE        03740099
038300         '******* NO DATA *********'.                             03750099
038400     05  FILLER                          PIC  X(87)  VALUE SPACE. 03760099
038500                                                                  03770099
038600 01  END-OF-REPORT-LINE.                                          03780099
038700     05  FILLER                          PIC  X(88)  VALUE SPACE. 03790099
038800     05  FILLER                          PIC  X(25)  VALUE        03800099
038900         '***** END OF REPORT *****'.                             03810099
039000     05  FILLER                          PIC  X(87)  VALUE SPACE. 03820099
039100                                                                  03830099
039200 01  PV-PROGRAM-VARIABLES.                                        03840099
039300     05  PV-PREV-SEASET                  PIC  X(05)  VALUE SPACE. 03850099
AV0524     05  PV-DISP-DET-C                   PIC  ZZ,ZZZ,ZZ9.         03851099
AV0524     05  PV-DISP-RPT-C                   PIC  ZZ,ZZZ,ZZ9.         03852099
AV0524     05  PV-DISP-SST-C                   PIC  ZZ,ZZZ,ZZ9.         03853099
039301                                                                  03860099
039310 01  PC-CONSTANTS.                                                03870099
039320     05  PC-COMMIT-INTEVLAL              PIC  9(02)  VALUE 10.    03880099
039400     05  PC-UNDERSCORE-11                PIC  X(11)  VALUE        03890099
039500                                                     ALL '_'.     03900099
039600     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +65    03910099
039700                                                     COMP SYNC.   03920099
039800     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   03930099
039900                                                     COMP SYNC.   03940099
040000     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        03950099
040100         'VLKUT050'.                                              03960099
040200     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        03970099
040300         'VLK???? '.                                              03980099
040301     05  PC-SPACE                        PIC  X(01)  VALUE ' '.   03990099
040310                                                                  04000099
040400     05 WS-DC-ACTIVE-CNT                 PIC S9(04)  VALUE +0.    04010099
040500     05 WS-CNT                           PIC S9(04)  VALUE +0.    04020099
040600     05 WS-CNT1                          PIC S9(04)  VALUE +0.    04030099
040700     05 WS-CNT2                          PIC S9(04)  VALUE +0.    04040099
040800     05 WS-CNT3                          PIC S9(04)  VALUE +0.    04050099
040900     05 WS-DC-LOC                        PIC S9(04) COMP.         04060099
041000     05 WS-ACT-DC-LOC                    PIC  9(03)  VALUE ZEROES 04070099
041100                                         OCCURS 0 TO 30 TIMES     04080099
041200        DEPENDING ON                     WS-DC-ACTIVE-CNT.        04090099
041300 01  PS-PROGRAM-SWITCHES.                                         04100099
041400     05  PS-COUNT-CURSOR-IND             PIC  X(01)  VALUE 'N'.   04110099
041500         88  PS-COUNT-CURSOR-OPENED                  VALUE 'Y'.   04120099
041600         88  PS-COUNT-CURSOR-CLOSED                  VALUE 'N'.   04130099
041700                                                                  04140099
041800     05  PS-CHANGE-STATUS-IND            PIC  X(01)  VALUE 'N'.   04150099
041900         88  PS-STATUS-IND-CHANGED                   VALUE 'Y'.   04160099
042000         88  PS-STATUS-IND-NOT-CHANGED               VALUE 'N'.   04170099
042100                                                                  04180099
AV0524     05  PS-TLUNIT-PRINT-IND             PIC  X(01)  VALUE 'N'.   04181099
AV0524         88  PS-TLUNIT-PRINT-IND-Y                   VALUE 'Y'.   04182099
AV0524         88  PS-TLUNIT-PRINT-IND-N                   VALUE 'N'.   04183099
AV0524                                                                  04184099
042200     05  PS-END-OF-COUNT-CURSOR-IND      PIC  X(01)  VALUE 'N'.   04190099
042300         88  PS-END-OF-COUNT-CURSOR                  VALUE 'Y'.   04200099
042400         88  PS-NOT-END-OF-COUNT-CURSOR              VALUE 'N'.   04210099
042500                                                                  04220099
042600     05  PS-END-OF-DC-CSR-FLAG           PIC  X(01)  VALUE 'N'.   04230099
042700         88  END-OF-DC-CSR                           VALUE 'Y'.   04240099
042800         88  NOT-END-OF-DC-CSR                       VALUE 'N'.   04250099
042900                                                                  04260099
043000     05  PS-VALID-SORT-REC-IND           PIC  X(01)  VALUE 'N'.   04270099
043100         88  PS-VALID-SORT-RECORD                    VALUE 'Y'.   04280099
043200         88  PS-INVALID-SORT-RECORD                  VALUE 'N'.   04290099
043300                                                                  04300099
043400     05  PS-VENDOR-BREAK-IND             PIC  X(01)  VALUE 'N'.   04310099
043500         88  PS-VENDOR-BREAK                         VALUE 'Y'.   04320099
043600         88  PS-NO-VENDOR-BREAK                      VALUE 'N'.   04330099
043700                                                                  04340099
043800     05  PS-END-OF-RPT-CURSOR-IND        PIC  X(01)  VALUE 'N'.   04350099
043900         88  PS-END-OF-RPT-CURSOR                    VALUE 'Y'.   04360099
044000         88  PS-NOT-END-OF-RPT-CURSOR                VALUE 'N'.   04370099
AV0524                                                                  04380099
AV0524     05  PS-PRINT-HEADER-IND             PIC  X(01)  VALUE 'N'.   04380199
AV0524         88  PS-PRINT-HEADER-YES                     VALUE 'Y'.   04380299
AV0524         88  PS-PRINT-HEADER-NO                      VALUE 'N'.   04380399
AV0524                                                                  04380499
AV0524     05  PS-PRINT-BLANK-LINE             PIC  X(01)  VALUE 'N'.   04380599
AV0524         88  PS-PRINT-BLANK-LINE-YES                 VALUE 'Y'.   04380699
AV0524         88  PS-PRINT-BLANK-LINE-NO                  VALUE 'N'.   04380799
AV0524                                                                  04380899
AV0524     05  PS-END-OF-SST-CURSOR-IND        PIC  X(01)  VALUE 'N'.   04381099
AV0524         88  PS-END-OF-SST-CURSOR                    VALUE 'Y'.   04382099
AV0524         88  PS-NOT-END-OF-SST-CURSOR                VALUE 'N'.   04383099
044100                                                                  04384099
044200     05  PS-END-OF-TOT-CURSOR-IND        PIC  X(01)  VALUE 'N'.   04390099
044300         88  PS-END-OF-TOT-CURSOR                    VALUE 'Y'.   04400099
044400         88  PS-NOT-END-OF-TOT-CURSOR                VALUE 'N'.   04410099
044500                                                                  04420099
044600     05  PS-NO-DATA-IND                  PIC  X(01)  VALUE 'N'.   04430099
044700         88  PS-NO-DATA                              VALUE 'Y'.   04440099
044800                                                                  04450099
044900     05  PS-SUM-ROW-NOT-FOUND-IND        PIC  X(01)  VALUE 'N'.   04460099
045000         88  PS-SUM-ROW-NOT-FOUND                    VALUE 'Y'.   04470099
045100         88  PS-SUM-ROW-FOUND                        VALUE 'N'.   04480099
045200                                                                  04490099
045300     05  PS-FINAL-SUMMARY-RPT-IND        PIC  X(01)  VALUE 'N'.   04500099
045400         88  PS-FINAL-SUMMARY-RPT                    VALUE 'Y'.   04510099
045500         88  PS-NOT-A-FINAL-SUMMARY-RPT              VALUE 'N'.   04520099
045600                                                                  04530099
045700 01  WS-PROGRAM-VARIABLES.                                        04540099
045800     05  WS-PRINT-QTY                    PIC  ZZZ,ZZZ,ZZ9.        04550099
045900                                                                  04560099
046000     05  WS-CURR-TMST                    PIC  X(26)  VALUE SPACES.04570099
046100     05  WS-COMMIT-TMST                  PIC  X(26)  VALUE SPACES.04580099
046200     05  WS-VND-UPDT-COUNT               PIC S9(04)  VALUE +0     04590099
046300                                                     COMP SYNC.   04600099
046400     05  WS-PAGE-COUNT                   PIC S9(04)  VALUE +0     04610099
046500                                                     COMP SYNC.   04620099
046600     05  WS-LINE-COUNT                   PIC S9(04)  VALUE +0     04630099
046700                                                     COMP SYNC.   04640099
046800     05  WS-LINES-AHEAD                 PIC S9(04)  VALUE +0      04650099
046900                                                     COMP SYNC.   04650199
AV0524     05  WS-DETAIL-CNT                  PIC S9(04)  VALUE +0      04650299
AV0524                                                      COMP SYNC.  04650399
AV0524     05  WS-RPT-FETCH-CNT               PIC S9(04)  VALUE +0      04650499
AV0524                                                      COMP SYNC.  04650599
AV0524     05  WS-SST-FETCH-CNT               PIC S9(04)  VALUE +0      04650699
AV0524                                                      COMP SYNC.  04650799
AV0524     05  WS-SEASET-SHRT-NM              PIC  X(05).               04652099
AV0524     05  WS-SEASET-YR                   PIC  X(04).               04653099
047000     05  WS-CRSR-BEGIN-TMST             PIC  X(26)  VALUE SPACE.  04670099
047100     05  WS-TEMP-BEGIN-TMST.                                      04680099
047200         10  WS-CRSR-BEGIN-DATE         PIC  X(10).               04690099
047300         10  FILLER                     PIC  X(16)                04700099
047400             VALUE '-00.00.00.000000'.                            04710099
047500     05  WS-CRSR-END-TMST               PIC  X(26)  VALUE SPACE.  04720099
047600     05  WS-TEMP-END-TMST.                                        04730099
047700         10  WS-CRSR-END-DATE           PIC  X(10).               04740099
047800         10  FILLER                     PIC  X(16)                04750099
047900             VALUE '-23.59.59.999999'.                            04760099
048000                                                                  04770099
048100     05  WS-DOLLARS-VERIFIED-NULL       PIC S9(04) VALUE +0       04780099
048200                                                   COMP.          04790099
048300     05  WS-DOLLARS-VER-AMT             PIC S9(11)V99 COMP-3.     04800099
048400     05  WS-HOLD-PKGNG-CDE              PIC  X(01).               04810099
048500     05  WS-HOLD-SEASET-YR              PIC  X(04).               04820099
048600     05  WS-HOLD-SEASET                 PIC  X(05).               04830099
048700     05  WS-HOLD-PO-NBR                 PIC S9(09) COMP.          04840099
048800     05  WS-HOLD-REC-SEQ-NBR            PIC S9(09) COMP.          04850099
048900     05  WS-HOLD-STATUS-CDE             PIC  X(02).               04860099
049000     05  WS-HOLD-ENT-NAME-DESC          PIC X(30).                04870099
049100     05  WS-HOLD-DEPT-NBR               PIC X(04).                04880099
049200     05  WS-HOLD-DONT-SHIP-BEF-DTE      PIC X(10).                04890099
049300     05  WS-HOLD-CAN-IFNOT-SHIP-DTE     PIC X(10).                04900099
049400     05  WS-HOLD-EXT-CAN-DTE            PIC X(10).                04910099
049500     05  WS-HOLD-PO-TYP-CDE             PIC X(02).                04920099
049600     05  WS-HOLD-TOT-UNT-QTY            PIC S9(09) COMP.          04930099
049700                                                                  04940099
049800     05  WS-HOLD-DC-AMT                 PIC S9(11)V99 COMP.       04950099
049900     05  WS-HOLD-OTB                    PIC X(6) VALUE SPACES.    04960099
050000*                                                                 04970099
050100     05  WS-TEMP-TOT-UNT-QTY            PIC ZZZZZZZZ9.            04980099
050200     05  WS-TEMP-OPER-UNT-ID            PIC S9(04) COMP.          04990099
050300     05  WS-HOLD-ARRIVAL-DTE            PIC X(10)  VALUE SPACES.  05000099
050400     05  WS-HOLD-ARRIVAL-TIM            PIC X(15)  VALUE SPACES.  05010099
050500     05  WS-REC-ARRIVAL-DTE             PIC X(10)  VALUE SPACES.  05020099
050600     05  WS-REC-ARRIVAL-TIM             PIC X(15)  VALUE SPACES.  05030099
050700*                                                                 05040099
050800     05  WS-DATE-MINUS-30               PIC  X(10).               05050099
050900     05  WS-CURR-DATE-CCYYMMDD          PIC  X(10).               05060099
051000     05  WS-CURR-DATE.                                            05070099
051100         10  WS-CURR-CENTURY             PIC  9(02).              05080099
051200         10  WS-CURR-YEAR                PIC  9(02).              05090099
051300         10  FILLER                      PIC  X(01) VALUE '-'.    05100099
051400         10  WS-CURR-MONTH               PIC  9(02).              05110099
051500         10  FILLER                      PIC  X(01) VALUE '-'.    05120099
051600         10  WS-CURR-DAY                 PIC  9(02).              05130099
051700     05  WS-CURRENT-TIME                 PIC  X(10).              05140099
051800     05  WS-CURR-TIME.                                            05150099
051900         10  WS-CURR-HOUR                PIC  9(02).              05160099
052000         10  FILLER                      PIC  X(01) VALUE '-'.    05170099
052100         10  WS-CURR-MIN                 PIC  9(02).              05180099
052200         10  FILLER                      PIC  X(01) VALUE '-'.    05190099
052300         10  WS-CURR-SEC                 PIC  9(02).              05200099
052400                                                                  05210099
052500     05  WS-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 05220099
052600     05  WS-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 05230099
052700     05  WS-DB2-OPER-UNT-ID              PIC  X(03).              05240099
052800     05  WS-BEGIN-DATE.                                           05250099
052900         10  WS-BEGIN-CCYY               PIC  9(04).              05260099
053000         10  FILLER                      PIC  X(01).              05270099
053100         10  WS-BEGIN-MM                 PIC  9(02).              05280099
053200         10  FILLER                      PIC  X(01).              05290099
053300         10  WS-BEGIN-DD                 PIC  9(02).              05300099
053400     05  WS-END-DATE.                                             05310099
053500         10  WS-END-CCYY                 PIC  9(04).              05320099
053600         10  FILLER                      PIC  X(01).              05330099
053700         10  WS-END-MM                   PIC  9(02).              05340099
053800         10  FILLER                      PIC  X(01).              05350099
053900         10  WS-END-DD                   PIC  9(02).              05360099
054000                                                                  05370099
054100     05  WS-CHAR-COUNT                   PIC S9(02)  VALUE +0     05380099
054200                                                     COMP SYNC.   05390099
054300                                                                  05400099
054400 01  SD-SYSTEM-DATE-YYMMDD.                                       05410099
054500     05  SD-SYSTEM-YEAR                  PIC  9(02)  VALUE ZEROS. 05420099
054600     05  SD-SYSTEM-MONTH                 PIC  9(02)  VALUE ZEROS. 05430099
054700     05  SD-SYSTEM-DAY                   PIC  9(02)  VALUE ZEROS. 05440099
054800                                                                  05450099
054900 01  ST-SYSTEM-TIME.                                              05460099
055000     05  ST-SYSTEM-HOUR                  PIC  9(02)  VALUE ZEROS. 05470099
055100     05  ST-SYSTEM-MINUTE                PIC  9(02)  VALUE ZEROS. 05480099
055200                                                                  05490099
055300 01  CC-CONTROL-CARD.                                             05500099
055400     05  CC-REPORT-TYPE                  PIC  X(03)  VALUE SPACE. 05510099
055500     05  CC-BEGIN-DATE                   PIC  X(10)  VALUE SPACE. 05520099
055600         88 CC-DEFAULT-BEGIN-DATE        VALUE 'YYYY-MM-DD'.      05530099
055700     05  FILLER REDEFINES CC-BEGIN-DATE.                          05540099
055800         10  CC-BEGIN-CENTURY            PIC  9(02).              05550099
055900         10  CC-BEGIN-YEAR               PIC  9(02).              05560099
056000         10  FILLER                      PIC  X(01).              05570099
056100         10  CC-BEGIN-MONTH              PIC  9(02).              05580099
056200         10  FILLER                      PIC  X(01).              05590099
056300         10  CC-BEGIN-DAY                PIC  9(02).              05600099
056400     05  CC-END-DATE                     PIC  X(10)  VALUE SPACE. 05610099
056500         88 CC-DEFAULT-END-DATE          VALUE 'YYYY-MM-DD'.      05620099
056600     05  FILLER REDEFINES CC-END-DATE.                            05630099
056700         10  CC-END-CENTURY              PIC  9(02).              05640099
056800         10  CC-END-YEAR                 PIC  9(02).              05650099
056900         10  FILLER                      PIC  X(01).              05660099
057000         10  CC-END-MONTH                PIC  9(02).              05670099
057100         10  FILLER                      PIC  X(01).              05680099
057200         10  CC-END-DAY                  PIC  9(02).              05690099
057300                                                                  05700099
057400 01  WS-VARIABLE-OCCURS.                                          05710099
057500     05  WS-HOLD-ENRT-QTY               PIC S9(11) COMP           05720099
057600                                        OCCURS 0 TO 30 TIMES      05730099
057700         DEPENDING ON                   WS-DC-ACTIVE-CNT.         05740099
057800     05  WS-HOLD-IP-QTY                 PIC S9(11) COMP           05750099
057900                                        OCCURS 0 TO 30 TIMES      05760099
058000         DEPENDING ON                   WS-DC-ACTIVE-CNT.         05770099
058100     05  WS-HOLD-CM-QTY                 PIC S9(11) COMP           05780099
058200                                        OCCURS 0 TO 30 TIMES      05790099
058300         DEPENDING ON                   WS-DC-ACTIVE-CNT.         05800099
058400     05  WS-HOLD-VE-QTY                 PIC S9(11) COMP           05810099
058500                                        OCCURS 0 TO 30 TIMES      05820099
058600         DEPENDING ON                   WS-DC-ACTIVE-CNT.         05830099
058700*                                                                 05840099
058800     05  WS-HOLD-DC-QTY                 PIC S9(09) COMP           05850099
058900                                        OCCURS 0 TO 30 TIMES      05860099
059000         DEPENDING ON                   WS-DC-ACTIVE-CNT.         05870099
059100*                                                                 05880099
059200     05  WS-DC-ITEM-QTY-TABLE            OCCURS 0 TO 30 TIMES     05890099
059300         DEPENDING ON                    WS-DC-ACTIVE-CNT.        05900099
059400         10 WS-DC-ITEM-QTY               PIC  9(09).              05910099
059500*                                                                 05920099
059600     05  WS-HOLD-DC-VE-QTY              PIC S9(11) COMP           05930099
059700                                        OCCURS 0 TO 30 TIMES      05940099
059800         DEPENDING ON                   WS-DC-ACTIVE-CNT.         05950099
059900******************************************************************05960099
060000*  WORK FIELDS FOR THE MBS SUBROUTINE                             05970099
060100******************************************************************05980099
060200     COPY DPWS003.                                                05990099
060300*                                                                 06000099
060400******************************************************************06010099
060500*  DB2 COMMUNICATION AREA.                                        06020099
060600******************************************************************06030099
060700     EXEC SQL                                                     06040099
060800          INCLUDE SQLCA                                           06050099
060900     END-EXEC.                                                    06060099
061000*                                                                 06070099
061100*---------------------------------------------------------------* 06080099
061200*    SEASONAL SET TABLE                                         * 06090099
061300*---------------------------------------------------------------* 06100099
061400     EXEC SQL                                                     06110099
061500          INCLUDE TSEASET                                         06120099
061600     END-EXEC.                                                    06130099
061700*                                                                 06140099
061800******************************************************************06150099
061900*  COBOL DELCARATION FOR THE RECEIPTS TABLE                       06160099
062000******************************************************************06170099
062100     EXEC SQL                                                     06180099
062200          INCLUDE TRECEIV                                         06190099
062300     END-EXEC.                                                    06200099
062400*                                                                 06210099
062500******************************************************************06220099
062600*  COBOL DELCARATION FOR THE RECEIVING DISTRIBUTION TABLE         06230099
062700******************************************************************06240099
062800     EXEC SQL                                                     06250099
062900          INCLUDE TRECDIS                                         06260099
063000     END-EXEC.                                                    06270099
063100*                                                                 06280099
063200******************************************************************06290099
063300*  COBOL DELCARATION FOR THE PURCHASE ORDER TABLE                 06300099
063400******************************************************************06310099
063500     EXEC SQL                                                     06320099
063600          INCLUDE TENTNME                                         06330099
063700     END-EXEC.                                                    06340099
063800*                                                                 06350099
063900*                                                                 06360099
064000******************************************************************06370099
064100*  COBOL DELCARATION FOR THE PURCHASE ORDER TABLE                 06380099
064200******************************************************************06390099
064300     EXEC SQL                                                     06400099
064400          INCLUDE TPLNSHP                                         06410099
064500     END-EXEC.                                                    06420099
064600*                                                                 06430099
064700*                                                                 06440099
064800******************************************************************06450099
064900*  COBOL DELCARATION FOR THE PURCHASE ORDER TABLE                 06460099
065000******************************************************************06470099
065100     EXEC SQL                                                     06480099
065200          INCLUDE TPURCHS                                         06490099
065300     END-EXEC.                                                    06500099
065400*                                                                 06510099
065500******************************************************************06520099
065600*  COBOL DELCARATION FOR THE PO-MERCHANDISE STORE DISTRIBUTION    06530099
065700******************************************************************06540099
065800     EXEC SQL                                                     06550099
065900          INCLUDE TMESTDS                                         06560099
066000     END-EXEC.                                                    06570099
066100*                                                                 06580099
066110******************************************************************06590099
066120*  COBOL DELCARATION FOR THE XLT_LOC                              06600099
066130******************************************************************06610099
066140     EXEC SQL                                                     06611099
066150          INCLUDE XLT00010                                        06612099
066160     END-EXEC.                                                    06613099
066170*                                                                 06614099
066200*   DB2 COMMUNICATIONS AREA2                                      06615099
066300*                                                                 06616099
066400     COPY SQLCA2.                                                 06617099
066500*                                                                 06618099
066600*                                                                 06619099
066700******************************************************************06620099
066800*  COBOL CURSOR DELCARATION FOR THE VERIFIED RPT PO''S            06630099
066900******************************************************************06640099
067000     EXEC SQL                                                     06650099
AV0524     DECLARE RPT_CURSOR1 CURSOR FOR                               06660099
AV0524         SELECT A.PO_NBR                                          06680099
067400               ,A.PO_TYP_CDE                                      06690099
067500               ,A.TOT_UNT_QTY                                     06700099
067600               ,A.DEPT_NBR                                        06710099
067700               ,A.VER_NBR                                         06720099
067800               ,A.PKGNG_CDE                                       06730099
067900               ,A.SEASET_YR                                       06740099
068000               ,A.SEASET_SHRT_NM                                  06750099
068100               ,B.DONT_SHIP_BEF_DTE                               06760099
068200               ,B.CAN_IFNOT_SHIP_DTE                              06770099
068300               ,B.EXT_CAN_DTE                                     06780099
068400               ,C.ENT_NAME_DESC                                   06790099
068500               ,D.STATUS_CDE                                      06800099
068600               ,D.FCLTY_ID                                        06810099
068700               ,D.REC_SEQ_NBR                                     06820099
068800               ,DATE(D.REC_TMST)                                  06830099
068900               ,TIME(D.REC_TMST)                                  06840099
069000               ,A.OTB_PER_NBR                                     06850099
069100         FROM  TPURCHS A                                          06860099
069200              ,TPLNSHP B                                          06870099
069300              ,TENTNME C                                          06880099
069400              ,TRECEIV D                                          06890099
AV0524         WHERE A.SEASET_SHRT_NM       = :WS-SEASET-SHRT-NM        06921099
AV0524              AND A.SEASET_YR         = :WS-SEASET-YR             06922099
070000              AND A.VER_STATUS_CDE    = 'A'                       06950099
070100              AND B.PO_NBR            = A.PO_NBR                  06960099
070200              AND B.VER_STATUS_CDE    = 'A'                       06970099
070300              AND C.ENT_ID            = A.ENT_ID                  06980099
070400              AND C.TYPE_CDE          = '01'                      06990099
070500              AND D.ORD_NBR           = B.PO_NBR                  07000099
070600              AND D.VER_STATUS_CDE    = 'A'                       07010099
070700              AND D.STATUS_CDE       IN ('CM','IP','VE')          07020099
072700        ORDER BY                                                  07220099
072800                A.SEASET_YR                                       07230099
072900               ,A.SEASET_SHRT_NM                                  07240099
073000               ,A.PO_NBR                                          07250099
AV0524               ,DATE(D.REC_TMST)                                  07251099
073100               ,D.STATUS_CDE                                      07260099
073200              WITH UR                                             07270099
073300     END-EXEC.                                                    07280099
073400*                                                                 07290099
073500******************************************************************07300099
073600*  COBOL CURSOR DELCARATION FOR ACTIVE DC LOCATIONS               07310099
073700******************************************************************07320099
073800     EXEC SQL                                                     07330099
073900        DECLARE DC_CSR  CURSOR FOR                                07340099
074000            SELECT LOC_NBR                                        07350099
074100              FROM XLT_LOC                                        07360099
074200             WHERE LOC_TYP_CDE   = 'DC'                           07370099
074300               AND (CURRENT DATE BETWEEN  OPN_DTE AND CLO_DTE)    07380099
074400          ORDER BY LOC_NBR                                        07390099
074500     END-EXEC.                                                    07400099
AV0524     EXEC SQL                                                     07401099
AV0524        DECLARE SST_CSR CURSOR FOR                                07402099
AV0524            SELECT SEASET_YR                                      07403099
AV0524                  ,SEASET_SHRT_NM                                 07404099
AV0524              FROM TSEASET                                        07405099
AV0524             WHERE SEASET_STAT_CDE   = 'A'                        07406099
AV0524              AND  PO_RCPT_RPTG_IND  = 'Y'                        07407099
AV0524          ORDER BY SEASET_YR                                      07409099
AV0524                  ,SEASET_SHRT_NM                                 07409199
AV0524     END-EXEC.                                                    07409299
074600                                                                  07410099
074700* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07420099
074800 PROCEDURE DIVISION.                                              07430099
074900* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 07440099
075000                                                                  07450099
075100******************************************************************07460099
075200*  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    07470099
075300******************************************************************07480099
075400 0000-PROGRAM-MAINLINE.                                           07490099
075500                                                                  07500099
075600     PERFORM 1000-INITIALIZE.                                     07510099
075700                                                                  07520099
AV0524     PERFORM 6500-OPEN-SST-CURSOR.                                07521099
AV0524     PERFORM 6700-FETCH-SST-CURSOR.                               07522099
AV0524                                                                  07523099
AV0524     IF PS-END-OF-SST-CURSOR                                      07531099
075900         PERFORM 6900-CLOSE-SST-CURSOR                            07540099
075900         PERFORM 8900-EMPTY-VENDOR-RPT                            07541099
076000     ELSE                                                         07550099
AV0524         PERFORM 6600-PROCESS-SST-CURSOR                          07560099
AV0524           UNTIL PS-END-OF-SST-CURSOR                             07561099
AV0524                                                                  07580099
AV0524         IF WS-RPT-FETCH-CNT = ZERO                               07581099
AV0524            PERFORM 8900-EMPTY-VENDOR-RPT                         07583099
AV0524         END-IF                                                   07584099
076200     END-IF.                                                      07584199
AV0524     MOVE WS-RPT-FETCH-CNT  TO PV-DISP-RPT-C.                     07584299
AV0524     MOVE WS-SST-FETCH-CNT  TO PV-DISP-SST-C.                     07584399
AV0524     MOVE WS-DETAIL-CNT     TO PV-DISP-DET-C.                     07584499
045900                                                                  07584599
AV0524     DISPLAY '******* VLKUT050 COUNTS *******'.                   07584699
AV0524     DISPLAY ' REPORT CURSOR TPURCHS COUNT: ' PV-DISP-RPT-C.      07584799
AV0524     DISPLAY ' DRIVER CURSOR SEASET  COUNT: ' PV-DISP-SST-C.      07584899
AV0524     DISPLAY ' DETAIL RECORDS WRITE  COUNT: ' PV-DISP-DET-C.      07584999
AV0524     DISPLAY '******* END OF VLKUT050 *******'.                   07585099
076300                                                                  07586099
076400     CLOSE DI-OUTPUT-FILE.                                        07590099
076500     STOP RUN.                                                    07600099
076600                                                                  07610099
076700 1000-INITIALIZE.                                                 07620099
076800                                                                  07630099
076900*    ACCEPT CC-CONTROL-CARD FROM SYSIN.                           07640099
077000                                                                  07650099
077100*    DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   07660099
077200                                                                  07670099
077300     PERFORM 1050-GET-DATES.                                      07680099
077400                                                                  07690099
077500     DISPLAY '**** ...CREATING THE ACTIVE RECEIVER FILE'.         07700099
077600                                                                  07710099
077700     MOVE SD-SYSTEM-YEAR         TO DP200O-RUN-YEAR.              07720099
077800     MOVE SD-SYSTEM-MONTH        TO DP200O-RUN-MONTH.             07730099
077900     MOVE SD-SYSTEM-DAY          TO DP200O-RUN-DAY.               07740099
078000                                                                  07750099
078100     MOVE ST-SYSTEM-HOUR         TO DP200O-RUN-HOUR.              07760099
078200     MOVE ST-SYSTEM-MINUTE       TO DP200O-RUN-MINUTE.            07770099
078300                                                                  07780099
078400     MOVE PC-MAX-REPORT-LINES    TO WS-LINE-COUNT.                07790099
078500     MOVE +0                     TO WS-PAGE-COUNT.                07800099
078600                                                                  07810099
078700*    INITIALIZE DL-DETAIL-LINE.                                   07820099
078800*                                                                 07830099
078900     OPEN OUTPUT DI-OUTPUT-FILE.                                  07840099
079000*                                                                 07850099
079100     PERFORM 6100-OPEN-DC-CURSOR                                  07860099
079200     SET     NOT-END-OF-DC-CSR TO TRUE                            07870099
079300     MOVE    +0                TO WS-CNT1                         07880099
079400     PERFORM 6200-FETCH-DC-CURSOR                                 07890099
079500       UNTIL END-OF-DC-CSR                                        07900099
AV0524     PERFORM 6300-CLOSE-DC-CURSOR.                                07910099
079700*                                                                 07920099
080000                                                                  07950099
080100******************************************************************07960099
080200*  1050-GET-DATES - GETS CURRENT-DATE AND CURRENT DATE +1 YEAR    07970099
080300*  FROM DB2.                                                      07980099
080400******************************************************************07990099
080500 1050-GET-DATES.                                                  08000099
080600                                                                  08010099
080700     EXEC SQL                                                     08020099
080800         SET :WS-CURR-DATE-CCYYMMDD = CURRENT DATE                08030099
080900     END-EXEC.                                                    08040099
081000     EXEC SQL                                                     08050099
081100         SET :WS-DATE-MINUS-30 = CURRENT DATE - 30 DAYS           08060099
081200     END-EXEC.                                                    08070099
081300                                                                  08080099
081400     EXEC SQL                                                     08090099
081500         SET :WS-CURRENT-TIME = CURRENT TIME                      08100099
081600     END-EXEC.                                                    08110099
081700                                                                  08120099
081800     EVALUATE TRUE                                                08130099
081900         WHEN SQLCODE = ZERO                                      08140099
082000             MOVE WS-CURR-DATE-CCYYMMDD TO WS-CURR-DATE           08150099
082100             MOVE WS-CURR-YEAR       TO SD-SYSTEM-YEAR            08160099
082200             MOVE WS-CURR-MONTH      TO SD-SYSTEM-MONTH           08170099
082300             MOVE WS-CURR-DAY        TO SD-SYSTEM-DAY             08180099
082400             MOVE WS-CURRENT-TIME    TO WS-CURR-TIME              08190099
082500             MOVE WS-CURR-HOUR       TO ST-SYSTEM-HOUR            08200099
082600             MOVE WS-CURR-MIN        TO ST-SYSTEM-MINUTE          08210099
082700         WHEN OTHER                                               08220099
082800              MOVE '1050-GET-DATES'                               08230099
082900                               TO  WS-PARAGRAPH-NAME              08240099
083000              MOVE 'SET REPORT DATES FROM CURRENT DATE'           08250099
083100                               TO  WS-DB2-OPERATION-ATTEMPTED     08260099
083200              PERFORM 9100-SQL-ABEND                              08270099
083300     END-EVALUATE.                                                08280099
083400                                                                  08290099
083500*                                                                 08300099
083600******************************************************************08310099
083700* 2000-CREATE-REPORT.                                             08320099
083800* PROCESS:  THIS PARAGRAPH CREATE THE REPORT                      08330099
083900******************************************************************08340099
084000 2000-CREATE-REPORT.                                              08350099
084100*                                                                 08360099
084200     MOVE PURCHS-SEASET-YR        TO WS-HOLD-SEASET-YR            08370099
084300     MOVE PURCHS-SEASET-SHRT-NM   TO WS-HOLD-SEASET               08380099
084400     MOVE PURCHS-PO-NBR           TO WS-HOLD-PO-NBR.              08390099
084500     MOVE RECEIV-STATUS-CDE       TO WS-HOLD-STATUS-CDE.          08400099
084600     MOVE RECEIV-REC-SEQ-NBR      TO WS-HOLD-REC-SEQ-NBR.         08410099
084700     MOVE ENTNME-ENT-NAME-DESC    TO WS-HOLD-ENT-NAME-DESC.       08420099
084710*                                                                 08430099
084720*** DMH BEGIN - 1/25/16                                           08440099
084730*** REMOVE SPECIAL CHARACTERS FROM THE ENT-NAME FIELD             08450099
084740*                                                                 08460099
084741     MOVE SPACE TO  PC-SPACE.                                     08470099
084744     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08471099
084745         ','   BY PC-SPACE.                                       08472099
084746     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08473099
084747         '/'   BY PC-SPACE.                                       08474099
084748     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08474199
084749         '<'   BY PC-SPACE.                                       08474299
084750     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08474399
084751         '>'   BY PC-SPACE.                                       08474499
084752     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08474599
084753         '*'   BY PC-SPACE.                                       08474699
084754     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08474799
084755         '-'   BY PC-SPACE.                                       08474899
084756     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08474999
084757         QUOTE  BY PC-SPACE.                                      08475099
084758     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08475199
084759         '!'   BY PC-SPACE.                                       08475299
084760     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  08475399
084761         '.'   BY PC-SPACE.                                       08475499
084762*                                                                 08475599
084763*** DMH END - 1/25/16                                             08475699
084770*                                                                 08475799
084800     MOVE PURCHS-DEPT-NBR         TO WS-HOLD-DEPT-NBR.            08475899
084900     MOVE PLNSHP-DONT-SHIP-BEF-DTE                                08475999
085000                                  TO WS-HOLD-DONT-SHIP-BEF-DTE.   08476099
085100     MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                               08477099
085200                                  TO WS-HOLD-CAN-IFNOT-SHIP-DTE.  08478099
085300     MOVE PLNSHP-EXT-CAN-DTE      TO WS-HOLD-EXT-CAN-DTE          08479099
085400     MOVE PURCHS-PO-TYP-CDE       TO WS-HOLD-PO-TYP-CDE           08480099
085500     MOVE PURCHS-PKGNG-CDE        TO WS-HOLD-PKGNG-CDE            08490099
085600     MOVE PURCHS-TOT-UNT-QTY      TO WS-HOLD-TOT-UNT-QTY.         08500099
085700     MOVE WS-REC-ARRIVAL-DTE      TO WS-HOLD-ARRIVAL-DTE.         08510099
085800     MOVE WS-REC-ARRIVAL-TIM      TO WS-HOLD-ARRIVAL-TIM.         08520099
085900     MOVE PURCHS-OTB-PER-NBR      TO WS-HOLD-OTB.                 08530099
086000                                                                  08540099
AV0524     IF PS-PRINT-HEADER-NO                                        08541099
AV0524        PERFORM 8300-WRITE-PAGE-HEADING                           08550099
AV0524        PERFORM 8400-WRITE-COLUMN-HEADING                         08560099
AV0524        PERFORM 8500-WRITE-BLANK-LINE                             08570099
AV0524        SET PS-PRINT-HEADER-YES TO TRUE                           08571099
AV0524     END-IF.                                                      08572099
086400                                                                  08580099
086500     PERFORM UNTIL PS-END-OF-RPT-CURSOR                           08590099
086600                                                                  08600099
086700         IF PURCHS-PO-NBR              = WS-HOLD-PO-NBR           08610099
086800            IF RECEIV-STATUS-CDE   NOT = WS-HOLD-STATUS-CDE OR    08620099
086900              (RECEIV-STATUS-CDE       = 'IP'           AND       08630099
087000               WS-REC-ARRIVAL-DTE      = '9999-09-09'   AND       08640099
087100               WS-HOLD-ARRIVAL-DTE NOT = '9999-09-09') OR         08650099
087200              (RECEIV-STATUS-CDE       = 'IP'           AND       08660099
087300               WS-REC-ARRIVAL-DTE  NOT = '9999-09-09' AND         08670099
087400               WS-HOLD-ARRIVAL-DTE     = '9999-09-09')            08680099
087500               PERFORM 2300-MOVE-DETAIL-LINES                     08690099
087600               PERFORM 2500-PRINT-RPT-LINES                       08700099
087700               MOVE 'Y'                TO PS-CHANGE-STATUS-IND    08710099
087800            ELSE                                                  08720099
087900               PERFORM 2300-MOVE-DETAIL-LINES                     08730099
088000            END-IF                                                08740099
088100            PERFORM 2100-DETERMINE-PCS-RECEIVED                   08750099
088200         ELSE                                                     08760099
088300            PERFORM 2300-MOVE-DETAIL-LINES                        08770099
088400            PERFORM 2500-PRINT-RPT-LINES                          08780099
088500            MOVE 'N'                 TO PS-CHANGE-STATUS-IND      08790099
088600            PERFORM 2100-DETERMINE-PCS-RECEIVED                   08800099
088700         END-IF                                                   08810099
088710*                                                                 08820099
088720*** DMH - 2/9/16 BEGIN                                            08830099
088730         IF  PURCHS-SEASET-SHRT-NM  =  PV-PREV-SEASET             08840099
088740             CONTINUE                                             08850099
088750         ELSE                                                     08860099
088760             PERFORM 2510-IP-DUMMY                                08870099
088770             PERFORM 2515-CM-DUMMY                                08871099
088780             PERFORM 2520-VE-DUMMY                                08872099
AV0524             SET PS-TLUNIT-PRINT-IND-N  TO TRUE                   08872199
088790             MOVE PURCHS-SEASET-SHRT-NM TO PV-PREV-SEASET         08873099
088791         END-IF                                                   08874099
088792*** DMH - 2/9/16 END                                              08875099
088793*                                                                 08876099
088800         PERFORM 7200-FETCH-MAIN-RPT-CURSOR                       08877099
088900     END-PERFORM.                                                 08878099
089050                                                                  08879099
089100     PERFORM 2300-MOVE-DETAIL-LINES.                              08880099
089200     PERFORM 2500-PRINT-RPT-LINES.                                08890099
089300     PERFORM 7100-CLOSE-MAIN-RPT-CURSOR.                          08900099
089400                                                                  08910099
089500     PERFORM 8500-WRITE-BLANK-LINE.                               08920099
089600     PERFORM 8500-WRITE-BLANK-LINE.                               08930099
089700     PERFORM 4000-DC-SUMMARY-TOTALS.                              08940099
089800                                                                  08950099
089900*                                                                 08960099
090000******************************************************************08970099
090100* 2100-DETERMINE-PCS-RECEIVED.                                    08980099
090200* PROCESS:  FOR EACH PO NUMBER, REC SEQ NUMBER DETERMINE HOW      08990099
090300* MANY PIECES WERE RECEIVED AT EACH DC LOCATION.                  09000099
090400******************************************************************09010099
090500 2100-DETERMINE-PCS-RECEIVED.                                     09020099
090600*                                                                 09030099
090700     MOVE ZEROES                    TO RECDIS-EXPTED-ITM-QTY      09040099
090800                                       RECDIS-AP-VERIFY-ITM-QTY   09050099
090900                                       WS-HOLD-DC-AMT             09060099
091000                                       WS-DOLLARS-VER-AMT.        09070099
091100*                                                                 09080099
091200     PERFORM                       VARYING WS-CNT FROM 1 BY 1     09090099
091300                                   UNTIL WS-CNT > WS-DC-ACTIVE-CNT09100099
091400         MOVE WS-ACT-DC-LOC(WS-CNT) TO WS-TEMP-OPER-UNT-ID        09110099
091500         PERFORM 7700-SUM-AP-VERIFY-QTY                           09120099
091600         IF PS-SUM-ROW-FOUND                                      09130099
091700            ADD  RECDIS-EXPTED-ITM-QTY   TO WS-HOLD-DC-QTY(WS-CNT)09140099
091800            ADD  RECDIS-AP-VERIFY-ITM-QTY                         09150099
091900                                     TO WS-HOLD-DC-VE-QTY(WS-CNT) 09160099
092000            PERFORM 2200-SUM-DC-TOTALS                            09170099
092100         END-IF                                                   09180099
092200     END-PERFORM                                                  09190099
092300*                                                                 09200099
092400     IF WS-HOLD-STATUS-CDE = 'VE'                                 09210099
092500         PERFORM                 VARYING WS-CNT FROM 1 BY 1       09220099
092600                                 UNTIL WS-CNT > WS-DC-ACTIVE-CNT  09230099
092700            MOVE ZEROES          TO  WS-DC-ITEM-QTY(WS-CNT)       09240099
092800            MOVE WS-HOLD-DC-VE-QTY(WS-CNT)                        09250099
092900                                 TO  WS-DC-ITEM-QTY(WS-CNT)       09260099
093000         END-PERFORM                                              09270099
093100     ELSE                                                         09280099
093200         PERFORM                 VARYING WS-CNT FROM 1 BY 1       09290099
093300                                 UNTIL WS-CNT > WS-DC-ACTIVE-CNT  09300099
093400            MOVE ZEROES          TO  WS-DC-ITEM-QTY(WS-CNT)       09310099
093500            MOVE WS-HOLD-DC-QTY(WS-CNT)                           09320099
093600                                 TO  WS-DC-ITEM-QTY(WS-CNT)       09330099
093700         END-PERFORM                                              09340099
093800     END-IF.                                                      09350099
093900*                                                                 09360099
094000                                                                  09370099
094100******************************************************************09380099
094200* 2200-SUM-DC-TOTALS.                                             09390099
094300* PROCESS:  KEEPS A RUNNING TOTAL OF THE VERIFIED UNITS PER DC    09400099
094400******************************************************************09410099
094500 2200-SUM-DC-TOTALS.                                              09420099
094600*                                                                 09430099
094700     IF RECEIV-STATUS-CDE          = 'IP' AND                     09440099
094800        WS-REC-ARRIVAL-DTE         = '9999-09-09'                 09450099
094900        ADD  RECDIS-EXPTED-ITM-QTY  TO WS-HOLD-ENRT-QTY(WS-CNT)   09460099
095000     END-IF                                                       09470099
095100*                                                                 09480099
095200     IF RECEIV-STATUS-CDE          = 'IP' AND                     09490099
095300        WS-REC-ARRIVAL-DTE    NOT  = '9999-09-09'                 09500099
095400        ADD  RECDIS-EXPTED-ITM-QTY TO WS-HOLD-IP-QTY(WS-CNT)      09510099
095500     END-IF                                                       09520099
095600*                                                                 09530099
095700     IF RECEIV-STATUS-CDE          = 'CM'                         09540099
095800        ADD  RECDIS-EXPTED-ITM-QTY TO WS-HOLD-CM-QTY(WS-CNT)      09550099
095900     END-IF                                                       09560099
096000*                                                                 09570099
096100     IF RECEIV-STATUS-CDE          = 'VE'                         09580099
096200        ADD  RECDIS-AP-VERIFY-ITM-QTY                             09590099
096300                                   TO WS-HOLD-VE-QTY(WS-CNT)      09600099
096400     END-IF.                                                      09610099
096500                                                                  09620099
096600 2500-PRINT-RPT-LINES.                                            09630099
096700*                                                                 09640099
096800     IF  PS-STATUS-IND-CHANGED                                    09650099
096900         MOVE '        0'          TO DL-TOTAL-UNITS              09650199
097000     END-IF.                                                      09650299
AV0524*BELOW CODE ADDED TO PRINT UNIT-TOTALS ON DETAILS AFTER DUMMY     09650399
AV0524*RECORDS AFTER EACH SEASET NAME.                                  09650499
AV0524     IF PS-TLUNIT-PRINT-IND-N                                     09651099
AV0524        MOVE WS-TEMP-TOT-UNT-QTY  TO DL-TOTAL-UNITS               09651199
AV0524        SET PS-TLUNIT-PRINT-IND-Y TO TRUE                         09651299
AV0524     END-IF.                                                      09671099
097100     MOVE WS-HOLD-STATUS-CDE       TO DL-RECEIV-STATUS-CDE.       09680099
097200     MOVE SPACES                   TO DL-RECEIV-ENROUTE.          09690099
097300*                                                                 09700099
097400     IF (WS-HOLD-ARRIVAL-DTE = '9999-09-09' AND                   09710099
097500         WS-HOLD-ARRIVAL-TIM = '09.09.09')                        09720099
097600          MOVE 'ENRTE'             TO DL-RECEIV-ENROUTE           09730099
097700     END-IF                                                       09740099
097800*                                                                 09750099
097900     PERFORM 8000-WRITE-DETAIL-LINE.                              09760099
098000     IF NOT PS-END-OF-RPT-CURSOR                                  09770099
098100         IF PURCHS-SEASET-SHRT-NM NOT = WS-HOLD-SEASET            09780099
098200         OR PURCHS-SEASET-YR      NOT = WS-HOLD-SEASET-YR         09790099
098300             PERFORM 8500-WRITE-BLANK-LINE 2 TIMES                09800099
098400             PERFORM 4000-DC-SUMMARY-TOTALS                       09810099
098500             PERFORM 8500-WRITE-BLANK-LINE 3 TIMES                09820099
098600         END-IF                                                   09830099
098700     END-IF.                                                      09840099
098800*                                                                 09850099
098900     MOVE PURCHS-SEASET-YR         TO WS-HOLD-SEASET-YR           09860099
099000     MOVE PURCHS-SEASET-SHRT-NM    TO WS-HOLD-SEASET              09870099
099100     MOVE PURCHS-PO-NBR            TO WS-HOLD-PO-NBR.             09880099
099200     MOVE ENTNME-ENT-NAME-DESC     TO WS-HOLD-ENT-NAME-DESC.      09890099
099210*                                                                 09900099
099220*** DMH BEGIN - 1/25/16                                           09910099
099230*** REMOVE SPECIAL CHARACTERS FROM THE ENT-NAME FIELD             09920099
099240*                                                                 09921099
099250     MOVE SPACE TO  PC-SPACE.                                     09922099
099260     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09923099
099270         ','   BY PC-SPACE.                                       09924099
099280     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09925099
099290         '/'   BY PC-SPACE.                                       09926099
099291     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09927099
099292         '<'   BY PC-SPACE.                                       09928099
099293     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09929099
099294         '>'   BY PC-SPACE.                                       09929199
099295     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09929299
099296         '*'   BY PC-SPACE.                                       09929399
099297     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09929499
099298         '-'   BY PC-SPACE.                                       09929599
099299     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09929699
099300         QUOTE  BY PC-SPACE.                                      09929799
099301     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09929899
099302         '!'   BY PC-SPACE.                                       09929999
099303     INSPECT WS-HOLD-ENT-NAME-DESC REPLACING ALL                  09930099
099304         '.'   BY PC-SPACE.                                       09930199
099305*                                                                 09930299
099306*** DMH END - 1/25/16                                             09930399
099307*                                                                 09930499
099310     MOVE PURCHS-DEPT-NBR          TO WS-HOLD-DEPT-NBR.           09930599
099400     MOVE PLNSHP-DONT-SHIP-BEF-DTE TO WS-HOLD-DONT-SHIP-BEF-DTE.  09930699
099500     MOVE PLNSHP-CAN-IFNOT-SHIP-DTE                               09930799
099600                                  TO WS-HOLD-CAN-IFNOT-SHIP-DTE.  09930899
099700     MOVE PLNSHP-EXT-CAN-DTE      TO WS-HOLD-EXT-CAN-DTE          09930999
099800     MOVE PURCHS-PO-TYP-CDE       TO WS-HOLD-PO-TYP-CDE.          09931099
099900     MOVE PURCHS-PKGNG-CDE        TO WS-HOLD-PKGNG-CDE            09932099
100000     MOVE PURCHS-TOT-UNT-QTY      TO WS-HOLD-TOT-UNT-QTY.         09933099
100100     MOVE RECEIV-STATUS-CDE       TO WS-HOLD-STATUS-CDE.          09934099
100200     MOVE WS-REC-ARRIVAL-DTE      TO WS-HOLD-ARRIVAL-DTE.         09935099
100300     MOVE WS-REC-ARRIVAL-TIM      TO WS-HOLD-ARRIVAL-TIM.         09936099
100400     MOVE PURCHS-OTB-PER-NBR      TO WS-HOLD-OTB.                 09937099
100500     MOVE '        0'              TO DL-TOTAL-UNITS.             09938099
100600*                                                                 09939099
100700     PERFORM                     VARYING WS-CNT3 FROM 1 BY 1      09940099
100800                                 UNTIL WS-CNT3 > WS-DC-ACTIVE-CNT 09950099
100900                                                                  09960099
101000         MOVE +0                 TO WS-HOLD-DC-QTY(WS-CNT3)       09970099
101100                                    WS-HOLD-DC-VE-QTY(WS-CNT3)    09980099
101200     END-PERFORM.                                                 09990099
101201                                                                  10000099
101202******************************************************************10010099
101203* WRITE DUMMY IP (INPROCESS) ROW FOR SEASET                     * 10020099
101204* ADDED 2/9/16                                                   *10030099
101205******************************************************************10040099
101210 2510-IP-DUMMY.                                                   10050099
101211                                                                  10060099
101212     MOVE PURCHS-SEASET-SHRT-NM TO  DL-DUMMY-SEASET               10070099
101214     MOVE 0                     TO  DL-DUMMY-PO-NUMBER            10080099
101216     MOVE ' '                   TO  DL-DUMMY-PKGNG-CDE            10090099
101218     MOVE ' '                   TO  DL-DUMMY-PO-TYP-CDE           10100099
101220     MOVE 'DUMMY IP'            TO  DL-DUMMY-VENDOR-NAME          10110099
101222     MOVE 0                     TO  DL-DUMMY-DEPT-NBR             10120099
101224     MOVE '          '          TO  DL-DUMMY-SHIP-DATE            10121099
101226     MOVE '          '          TO  DL-DUMMY-CANCEL-DATE          10122099
101228     MOVE '          '          TO  DL-DUMMY-EXT-CANCEL-DATE      10122199
101230     MOVE 0                     TO  DL-DUMMY-TOTAL-UNITS          10122299
101232     MOVE 'IP'                  TO  DL-DUMMY-RECEIV-STATUS        10122399
101233     PERFORM                                                      10122499
101234         VARYING WS-CNT3 FROM 1 BY 1                              10122599
101235           UNTIL WS-CNT3 > WS-DC-ACTIVE-CNT                       10122699
101237                 MOVE +0  TO  WS-DUMMY-DC-ITEM-QTY-HDR(WS-CNT3)   10122799
101239     END-PERFORM.                                                 10122899
101240                                                                  10122999
101241     WRITE DI-OUTPUT-RECORD                                       10123099
101242       FROM DL-DETAIL-DUMMY-LINE                                  10124099
101244     ADD +2                     TO WS-LINE-COUNT.                 10124199
101245                                                                  10124299
101246                                                                  10124399
101247******************************************************************10124499
101248* WRITE DUMMY CM (COMPLETED) ROW FOR SEASET                     * 10124599
101249* ADDED 2/9/16                                                   *10124699
101250******************************************************************10124799
101251 2515-CM-DUMMY.                                                   10124899
101253                                                                  10124999
101254     MOVE PURCHS-SEASET-SHRT-NM TO  DL-DUMMY-SEASET               10125099
101255     MOVE 0                     TO  DL-DUMMY-PO-NUMBER            10125199
101256     MOVE ' '                   TO  DL-DUMMY-PKGNG-CDE            10125299
101257     MOVE ' '                   TO  DL-DUMMY-PO-TYP-CDE           10125399
101258     MOVE 'DUMMY CM'            TO  DL-DUMMY-VENDOR-NAME          10125499
101259     MOVE 0                     TO  DL-DUMMY-DEPT-NBR             10125599
101260     MOVE '          '          TO  DL-DUMMY-SHIP-DATE            10125699
101261     MOVE '          '          TO  DL-DUMMY-CANCEL-DATE          10125799
101262     MOVE '          '          TO  DL-DUMMY-EXT-CANCEL-DATE      10125899
101263     MOVE 0                     TO  DL-DUMMY-TOTAL-UNITS          10125999
101264     MOVE 'CM'                  TO  DL-DUMMY-RECEIV-STATUS        10126099
101265     PERFORM                                                      10126199
101266         VARYING WS-CNT3 FROM 1 BY 1                              10126299
101267           UNTIL WS-CNT3 > WS-DC-ACTIVE-CNT                       10126399
101268                 MOVE +0  TO  WS-DUMMY-DC-ITEM-QTY-HDR(WS-CNT3)   10126499
101269     END-PERFORM.                                                 10126599
101270                                                                  10126699
101271     WRITE DI-OUTPUT-RECORD                                       10126799
101272       FROM DL-DETAIL-DUMMY-LINE                                  10126899
101273     ADD +2                     TO WS-LINE-COUNT.                 10126999
101294                                                                  10127099
101295                                                                  10128099
101296******************************************************************10129099
101297* WRITE DUMMY VE (VERIFIED) ROW FOR SEASET                      * 10129199
101298* ADDED 2/9/16                                                   *10129299
101299******************************************************************10129399
101300 2520-VE-DUMMY.                                                   10129499
101301                                                                  10129599
101302                                                                  10129699
101303     MOVE PURCHS-SEASET-SHRT-NM TO  DL-DUMMY-SEASET               10129799
101304     MOVE 0                     TO  DL-DUMMY-PO-NUMBER            10129899
101305     MOVE ' '                   TO  DL-DUMMY-PKGNG-CDE            10129999
101306     MOVE ' '                   TO  DL-DUMMY-PO-TYP-CDE           10130099
101307     MOVE 'DUMMY VE'            TO  DL-DUMMY-VENDOR-NAME          10130199
101308     MOVE 0                     TO  DL-DUMMY-DEPT-NBR             10130299
101309     MOVE '          '          TO  DL-DUMMY-SHIP-DATE            10130399
101310     MOVE '          '          TO  DL-DUMMY-CANCEL-DATE          10130499
101311     MOVE '          '          TO  DL-DUMMY-EXT-CANCEL-DATE      10130599
101312     MOVE 0                     TO  DL-DUMMY-TOTAL-UNITS          10130699
101313     MOVE 'VE'                  TO  DL-DUMMY-RECEIV-STATUS        10130799
101314     PERFORM                                                      10130899
101315         VARYING WS-CNT3 FROM 1 BY 1                              10130999
101316           UNTIL WS-CNT3 > WS-DC-ACTIVE-CNT                       10131099
101317                 MOVE +0  TO  WS-DUMMY-DC-ITEM-QTY-HDR(WS-CNT3)   10131199
101318     END-PERFORM.                                                 10131299
101319                                                                  10131399
101320     WRITE DI-OUTPUT-RECORD                                       10131499
101321       FROM DL-DETAIL-DUMMY-LINE                                  10131599
101322     ADD +2                     TO WS-LINE-COUNT.                 10131699
101343                                                                  10131799
101344                                                                  10131899
101345******************************************************************10131999
101346*                                                               * 10132099
101347*                                                                *10133099
101348******************************************************************10134099
101350*                                                                 10135099
101400 2300-MOVE-DETAIL-LINES.                                          10136099
101500*                                                                 10137099
101600     MOVE WS-HOLD-SEASET      TO DL-SEASET                        10138099
101700     MOVE WS-HOLD-PO-NBR      TO DL-PO-NUMBER                     10139099
101800     MOVE WS-HOLD-ENT-NAME-DESC                                   10140099
101900                              TO DL-VENDOR-NAME                   10150099
102000     MOVE WS-HOLD-DEPT-NBR    TO DL-DEPT-NBR                      10160099
102100     MOVE WS-HOLD-PKGNG-CDE   TO DL-PKGNG-CDE                     10170099
102200     MOVE WS-HOLD-PO-TYP-CDE  TO DL-PO-TYP-CDE                    10180099
102300     MOVE WS-HOLD-DONT-SHIP-BEF-DTE                               10190099
102400                              TO DL-SHIP-DATE                     10200099
102500     MOVE WS-HOLD-CAN-IFNOT-SHIP-DTE                              10210099
102600                              TO DL-CANCEL-DATE                   10220099
102700     IF WS-HOLD-EXT-CAN-DTE = '0001-01-01'                        10230099
102800         MOVE SPACES          TO DL-EXT-CANCEL-DATE               10240099
102900     ELSE                                                         10250099
103000         MOVE WS-HOLD-EXT-CAN-DTE                                 10260099
103100                              TO DL-EXT-CANCEL-DATE               10270099
103200     END-IF                                                       10280099
103300     MOVE WS-HOLD-TOT-UNT-QTY                                     10290099
103400                             TO WS-TEMP-TOT-UNT-QTY               10300099
103500     MOVE WS-TEMP-TOT-UNT-QTY                                     10310099
103600                             TO DL-TOTAL-UNITS.                   10320099
103700*                                                                 10330099
103800 4000-DC-SUMMARY-TOTALS.                                          10340099
103900*                                                                 10350099
104000     PERFORM                       VARYING WS-CNT                 10360099
104100                                   FROM 1 BY 1 UNTIL              10370099
104200                                   WS-CNT > WS-DC-ACTIVE-CNT      10380099
104300        MOVE WS-HOLD-ENRT-QTY(WS-CNT)                             10390099
104400                                   TO DL-ENRT-DC-TOTAL(WS-CNT)    10400099
104500        MOVE WS-HOLD-IP-QTY(WS-CNT)                               10410099
104600                                   TO DL-IP-DC-TOTAL(WS-CNT)      10420099
104700        MOVE WS-HOLD-CM-QTY(WS-CNT)                               10430099
104800                                   TO DL-CM-DC-TOTAL(WS-CNT)      10440099
104900        MOVE WS-HOLD-VE-QTY(WS-CNT)                               10450099
105000                                   TO DL-VE-DC-TOTAL(WS-CNT)      10460099
105100     END-PERFORM.                                                 10470099
105200*                                                                 10480099
105300                                                                  10490099
105400     PERFORM 8500-WRITE-BLANK-LINE.                               10500099
105500*                                                                 10510099
105600     WRITE DI-OUTPUT-RECORD                                       10520099
105700       FROM DH2-SUMMARY-COLS-HEADING                              10530099
105800*                                                                 10540099
105900     PERFORM 8500-WRITE-BLANK-LINE.                               10550099
106000*                                                                 10560099
106100     WRITE DI-OUTPUT-RECORD                                       10570099
106200       FROM DH2-DETAIL-SUMMARY                                    10580099
106300*                                                                 10590099
106400     WRITE DI-OUTPUT-RECORD                                       10600099
106500       FROM DL-DETAIL-SUMMARY1                                    10610099
106600*                                                                 10620099
106700     WRITE DI-OUTPUT-RECORD                                       10630099
106800       FROM DL-DETAIL-SUMMARY2                                    10640099
106900*                                                                 10650099
107000     WRITE DI-OUTPUT-RECORD                                       10660099
107100       FROM DL-DETAIL-SUMMARY3.                                   10670099
107200*                                                                 10680099
107300     PERFORM                       VARYING WS-CNT                 10690099
107400                                   FROM 1 BY 1 UNTIL              10700099
107500                                   WS-CNT > WS-DC-ACTIVE-CNT      10710099
107600        MOVE +0                    TO WS-HOLD-ENRT-QTY(WS-CNT)    10720099
107700                                      WS-HOLD-IP-QTY(WS-CNT)      10730099
107800                                      WS-HOLD-VE-QTY(WS-CNT)      10740099
107900                                      WS-HOLD-CM-QTY(WS-CNT)      10750099
108000     END-PERFORM.                                                 10760099
108100*                                                                 10770099
108200******************************************************************10780099
108300* 6100-OPEN-DC-CURSOR.                                           *10790099
108400*  THIS PROCEDURE WILL OPEN THE ACTIVE DC CURSOR                 *10800099
108500******************************************************************10810099
108600 6100-OPEN-DC-CURSOR.                                             10820099
108700*                                                                 10830099
108800     EXEC SQL                                                     10840099
108900          OPEN DC_CSR                                             10850099
109000     END-EXEC                                                     10860099
109100*                                                                 10870099
109200     EVALUATE TRUE                                                10880099
109300         WHEN SQLCODE = ZERO                                      10890099
109400              CONTINUE                                            10900099
109500*                                                                 10910099
109600         WHEN SQLWARN0 NOT EQUAL SPACE                            10920099
109700         WHEN SQLCODE NOT EQUAL ZERO                              10930099
109800              MOVE '6100-OPEN-DC-CURSOR'                          10940099
109900                               TO  WS-PARAGRAPH-NAME              10950099
110000              MOVE 'OPEN DC_CSR'                                  10960099
110100                               TO  WS-DB2-OPERATION-ATTEMPTED     10970099
110200              PERFORM 9100-SQL-ABEND                              10980099
110300     END-EVALUATE.                                                10990099
110400*                                                                 11000099
110500******************************************************************11010099
110600* 6200-FETCH-DC-CURSOR.                                          *11020099
110700*  THIS PROCEDURE WILL FETCH THE ACTIVE DC LOCATIONS             *11030099
110800******************************************************************11040099
110900*                                                                 11050099
111000 6200-FETCH-DC-CURSOR.                                            11060099
111100*                                                                 11070099
111200     EXEC SQL                                                     11080099
111300          FETCH DC_CSR                                            11090099
111400           INTO :WS-DC-LOC                                        11100099
111500     END-EXEC.                                                    11110099
111600*                                                                 11120099
111700     EVALUATE TRUE                                                11130099
111800         WHEN SQLCODE            = ZERO                           11140099
111900              ADD   +1           TO WS-CNT1                       11150099
112000                                    WS-DC-ACTIVE-CNT              11160099
112100              MOVE WS-DC-LOC     TO WS-ACT-DC-LOC(WS-CNT1)        11170099
112200              MOVE WS-ACT-DC-LOC(WS-CNT1)                         11180099
112300                                 TO WS-HEADER-DC(WS-CNT1)         11190099
112400                                    WS-SUMM-DC (WS-CNT1)          11200099
112500*                                                                 11210099
112600         WHEN SQLCODE = PC-ROW-NOT-FOUND                          11220099
112700              SET END-OF-DC-CSR TO  TRUE                          11230099
112800*                                                                 11240099
112900         WHEN SQLWARN0 NOT EQUAL SPACE                            11250099
113000         WHEN SQLCODE NOT EQUAL ZERO                              11260099
113100              MOVE '6200-FETCH-DC-CURSOR'                         11270099
113200                               TO  WS-PARAGRAPH-NAME              11280099
113300              MOVE 'FETCH DC_CSR'                                 11290099
113400                               TO  WS-DB2-OPERATION-ATTEMPTED     11300099
113500              PERFORM 9100-SQL-ABEND                              11310099
113600     END-EVALUATE.                                                11320099
113700*                                                                 11330099
113800******************************************************************11340099
113900* 6300-CLOSE-DC-CURSOR.                                          *11350099
114000*  THIS PROCEDURE WILL CLOSE DC CURSOR                           *11360099
114100******************************************************************11370099
114200*                                                                 11380099
114300 6300-CLOSE-DC-CURSOR.                                            11390099
114400*                                                                 11400099
114500     EXEC SQL                                                     11410099
114600          CLOSE DC_CSR                                            11420099
114700     END-EXEC                                                     11430099
114800*                                                                 11440099
114900     EVALUATE TRUE                                                11450099
115000         WHEN SQLWARN0 NOT EQUAL SPACE                            11460099
115100         WHEN SQLCODE NOT EQUAL ZERO                              11470099
115200              MOVE '6300-CLOSE-DC-CURSOR'                         11480099
115300                               TO  WS-PARAGRAPH-NAME              11490099
115400              MOVE 'CLOSE DC-CSR'                                 11500099
115500                               TO  WS-DB2-OPERATION-ATTEMPTED     11510099
115600              PERFORM 9100-SQL-ABEND                              11520099
115700     END-EVALUATE.                                                11530099
AV0524******************************************************************11531099
AV0524* 6500-OPEN-SST-CURSOR.                                          *11532099
AV0524*  THIS PROCEDURE WILL OPEN THE SST CURSOR                       *11533099
AV0524******************************************************************11534099
AV0524 6500-OPEN-SST-CURSOR.                                            11535099
AV0524*                                                                 11536099
AV0524     EXEC SQL                                                     11538099
AV0524          OPEN SST_CSR                                            11539099
AV0524     END-EXEC                                                     11539199
AV0524*                                                                 11539299
AV0524     EVALUATE TRUE                                                11539399
AV0524         WHEN SQLCODE = ZERO                                      11539499
AV0524              SET PS-NOT-END-OF-SST-CURSOR                        11539599
AV0524                               TO  TRUE                           11539699
AV0524*                                                                 11539799
AV0524         WHEN SQLWARN0 NOT EQUAL SPACE                            11539899
AV0524         WHEN SQLCODE NOT EQUAL ZERO                              11539999
AV0524              MOVE '6500-OPEN-SST-CURSOR'                         11540099
AV0524                               TO  WS-PARAGRAPH-NAME              11540199
AV0524              MOVE 'OPEN SST_CSR'                                 11540299
AV0524                               TO  WS-DB2-OPERATION-ATTEMPTED     11540399
AV0524              PERFORM 9100-SQL-ABEND                              11540499
AV0524     END-EVALUATE.                                                11540599
AV0524                                                                  11540699
AV0524******************************************************************11540799
AV0524*6600-PROCESS-SST-CURSOR.                                         11540899
AV0524******************************************************************11540999
AV0524 6600-PROCESS-SST-CURSOR.                                         11541099
AV0524     MOVE SEASET-SEASET-YR      TO WS-SEASET-YR.                  11542099
AV0524     MOVE SEASET-SEASET-SHRT-NM TO WS-SEASET-SHRT-NM.             11543099
AV0524     PERFORM 7000-OPEN-MAIN-RPT-CURSOR.                           11544099
AV0524     PERFORM 7200-FETCH-MAIN-RPT-CURSOR.                          11545099
AV0524     IF PS-PRINT-BLANK-LINE-NO                                    11545699
AV0524        SET PS-PRINT-BLANK-LINE-YES TO TRUE                       11545799
AV0524     ELSE                                                         11545899
AV0524        IF NOT PS-END-OF-RPT-CURSOR                               11545999
AV0524           PERFORM 8500-WRITE-BLANK-LINE                          11546099
AV0524           PERFORM 8500-WRITE-BLANK-LINE                          11546199
AV0524           PERFORM 8500-WRITE-BLANK-LINE                          11546299
AV0524        END-IF                                                    11546399
AV0524     END-IF.                                                      11546499
AV0524     IF PS-END-OF-RPT-CURSOR                                      11546599
AV0524        PERFORM 7100-CLOSE-MAIN-RPT-CURSOR                        11546699
AV0524     ELSE                                                         11546799
AV0524        PERFORM 2000-CREATE-REPORT                                11547099
AV0524     END-IF                                                       11547199
AV0524     PERFORM 6700-FETCH-SST-CURSOR.                               11547299
AV0524                                                                  11547399
AV0524                                                                  11547499
AV0524                                                                  11547599
AV0524******************************************************************11547699
AV0524* 6700-FETCH-SST-CURSOR.                                         *11547799
AV0524*  THIS PROCEDURE WILL FETCH THE DATA OF SST CURSOR              *11547899
AV0524******************************************************************11547999
AV0524*                                                                 11548099
AV0524 6700-FETCH-SST-CURSOR.                                           11548199
AV0524*                                                                 11548299
AV0524     EXEC SQL                                                     11548399
AV0524          FETCH SST_CSR                                           11548499
AV0524          INTO                                                    11548599
AV0524                :SEASET-SEASET-YR                                 11548699
AV0524               ,:SEASET-SEASET-SHRT-NM                            11548799
AV0524     END-EXEC                                                     11548899
AV0524                                                                  11548999
AV0524     EVALUATE TRUE                                                11549099
AV0524         WHEN SQLCODE = ZERO                                      11549199
AV0524              ADD 01 TO WS-SST-FETCH-CNT                          11549299
AV0524              MOVE SEASET-SEASET-YR TO WS-SEASET-YR               11549399
AV0524              MOVE SEASET-SEASET-SHRT-NM TO WS-SEASET-SHRT-NM     11549499
AV0524                                                                  11549599
AV0524         WHEN SQLCODE = PC-ROW-NOT-FOUND                          11549699
AV0524              SET PS-END-OF-SST-CURSOR                            11549799
AV0524                           TO  TRUE                               11549899
AV0524                                                                  11549999
AV0524         WHEN SQLWARN0 NOT EQUAL SPACE                            11550099
AV0524         WHEN SQLCODE NOT EQUAL ZERO                              11550199
AV0524              MOVE '6700-FETCH-SST-CURSOR'                        11550299
AV0524                               TO  WS-PARAGRAPH-NAME              11550399
AV0524              MOVE 'FETCH SST_CSR'                                11550499
AV0524                               TO  WS-DB2-OPERATION-ATTEMPTED     11550599
AV0524              PERFORM 9100-SQL-ABEND                              11550699
AV0524     END-EVALUATE.                                                11550799
AV0524******************************************************************11550899
AV0524* 6900-CLOSE-SST-CURSOR.                                         *11550999
AV0524*  THIS PROCEDURE WILL CLOSE THE SST CURSOR                      *11551099
AV0524******************************************************************11551199
AV0524 6900-CLOSE-SST-CURSOR.                                           11551299
AV0524*                                                                 11551399
AV0524     EXEC SQL                                                     11551499
AV0524          CLOSE SST_CSR                                           11551599
AV0524     END-EXEC                                                     11551699
AV0524*                                                                 11551799
AV0524     EVALUATE TRUE                                                11551899
AV0524         WHEN SQLWARN0 NOT EQUAL SPACE                            11551999
AV0524         WHEN SQLCODE NOT EQUAL ZERO                              11552099
AV0524              MOVE '6900-CLOSE-SST-CURSOR'                        11552199
AV0524                               TO  WS-PARAGRAPH-NAME              11552299
AV0524              MOVE 'CLOSE SST_CSR'                                11552399
AV0524                               TO  WS-DB2-OPERATION-ATTEMPTED     11552499
AV0524              PERFORM 9100-SQL-ABEND                              11552599
AV0524     END-EVALUATE.                                                11552699
115800*                                                                 11552799
115900******************************************************************11553099
116000* 7000-OPEN-MAIN-RPT-CURSOR.                                     *11560099
116100*  THIS PROCEDURE WILL OPEN THE APPROPRIATE CURSOR DEPENDING     *11570099
116200*  UPON THE CONTROL CARD SUPPLIED.                               *11580099
116300******************************************************************11590099
116400 7000-OPEN-MAIN-RPT-CURSOR.                                       11600099
116500*                                                                 11610099
116600     EXEC SQL                                                     11620099
116700          OPEN RPT_CURSOR1                                        11630099
116800     END-EXEC                                                     11640099
116900*                                                                 11650099
117000     EVALUATE TRUE                                                11660099
117100         WHEN SQLCODE = ZERO                                      11670099
117200              SET PS-NOT-END-OF-RPT-CURSOR                        11680099
117300                               TO  TRUE                           11690099
117400*                                                                 11700099
117500         WHEN SQLWARN0 NOT EQUAL SPACE                            11710099
117600         WHEN SQLCODE NOT EQUAL ZERO                              11720099
117700              MOVE '7000-OPEN-RPT-CURSOR'                         11730099
117800                               TO  WS-PARAGRAPH-NAME              11740099
117900              MOVE 'OPEN RPT_CURSOR1'                             11750099
118000                               TO  WS-DB2-OPERATION-ATTEMPTED     11760099
118100              PERFORM 9100-SQL-ABEND                              11770099
118200     END-EVALUATE.                                                11780099
118300                                                                  11790099
118400*                                                                 11800099
118500******************************************************************11810099
118600* 7100-CLOSE-MAIN-RPT-CURSOR.                                    *11820099
118700*  THIS PROCEDURE WILL CLOSE THE APPROPRIATE CURSOR DEPENDING    *11830099
118800*  UPON THE CONTROL CARD SUPPLIED.                               *11840099
118900******************************************************************11850099
119000 7100-CLOSE-MAIN-RPT-CURSOR.                                      11860099
119100*                                                                 11870099
119200     EXEC SQL                                                     11880099
119300          CLOSE RPT_CURSOR1                                       11890099
119400     END-EXEC                                                     11900099
119500*                                                                 11910099
119600     EVALUATE TRUE                                                11920099
119700         WHEN SQLWARN0 NOT EQUAL SPACE                            11930099
119800         WHEN SQLCODE NOT EQUAL ZERO                              11940099
119900              MOVE '7100-CLOSE-RPT-CURSOR'                        11950099
120000                               TO  WS-PARAGRAPH-NAME              11960099
120100              MOVE 'CLOSE RPT_CURSOR1'                            11970099
120200                               TO  WS-DB2-OPERATION-ATTEMPTED     11980099
120300              PERFORM 9100-SQL-ABEND                              11990099
120400     END-EVALUATE.                                                12000099
120500*                                                                 12010099
120600 7200-FETCH-MAIN-RPT-CURSOR.                                      12020099
120700*                                                                 12030099
120800     EXEC SQL                                                     12040099
120900          FETCH RPT_CURSOR1                                       12050099
121000          INTO                                                    12060099
121100                :PURCHS-PO-NBR                                    12070099
121200               ,:PURCHS-PO-TYP-CDE                                12080099
121300               ,:PURCHS-TOT-UNT-QTY                               12090099
121400               ,:PURCHS-DEPT-NBR                                  12100099
121500               ,:PURCHS-VER-NBR                                   12110099
121600               ,:PURCHS-PKGNG-CDE                                 12120099
121700               ,:PURCHS-SEASET-YR                                 12130099
121800               ,:PURCHS-SEASET-SHRT-NM                            12140099
121900               ,:PLNSHP-DONT-SHIP-BEF-DTE                         12150099
122000               ,:PLNSHP-CAN-IFNOT-SHIP-DTE                        12160099
122100               ,:PLNSHP-EXT-CAN-DTE                               12170099
122200               ,:ENTNME-ENT-NAME-DESC                             12180099
122300               ,:RECEIV-STATUS-CDE                                12190099
122400               ,:RECEIV-FCLTY-ID                                  12200099
122500               ,:RECEIV-REC-SEQ-NBR                               12210099
122600               ,:WS-REC-ARRIVAL-DTE                               12220099
122700               ,:WS-REC-ARRIVAL-TIM                               12230099
122800               ,:PURCHS-OTB-PER-NBR                               12240099
122900     END-EXEC                                                     12250099
123000                                                                  12260099
123100     EVALUATE TRUE                                                12270099
123200         WHEN SQLCODE = ZERO                                      12280099
AV0524              ADD 01 TO WS-RPT-FETCH-CNT                          12290099
123400                                                                  12300099
123500         WHEN SQLCODE = PC-ROW-NOT-FOUND                          12310099
123600              SET PS-END-OF-RPT-CURSOR                            12320099
123700                               TO  TRUE                           12330099
123800                                                                  12340099
123900         WHEN SQLWARN0 NOT EQUAL SPACE                            12350099
124000         WHEN SQLCODE NOT EQUAL ZERO                              12360099
124100              MOVE '7200-FETCH-RPT-CURSOR'                        12370099
124200                               TO  WS-PARAGRAPH-NAME              12380099
124300              MOVE 'FETCH RPT_CURSOR1'                            12390099
124400                               TO  WS-DB2-OPERATION-ATTEMPTED     12400099
124500              PERFORM 9100-SQL-ABEND                              12410099
124600     END-EVALUATE.                                                12420099
124700*                                                                 12430099
124800******************************************************************12440099
124900* 7700-SUM-AP-VERIFY-QTY - SUMS UP THE AP VERIFY QTY FOR ALL OF   12450099
125000* THE REC SEQ NUMBERS.                                            12460099
125100******************************************************************12470099
125200 7700-SUM-AP-VERIFY-QTY.                                          12480099
125300*                                                                 12490099
125400      MOVE +0                TO  RECDIS-EXPTED-ITM-QTY            12500099
125500                                 RECDIS-AP-VERIFY-ITM-QTY.        12510099
125600     EXEC SQL                                                     12520099
125700      SELECT DISTINCT                                             12530099
125800           SUM(EXPTED_ITM_QTY)                                    12540099
125900          ,SUM(AP_VERIFY_ITM_QTY)                                 12550099
126000      INTO                                                        12560099
126100          :RECDIS-EXPTED-ITM-QTY                                  12570099
126200         ,:RECDIS-AP-VERIFY-ITM-QTY                               12580099
126300      FROM                                                        12590099
126400           TRECDIS                                                12600099
126500      WHERE                                                       12610099
126600            ORD_NBR          = :PURCHS-PO-NBR                     12620099
126700        AND REC_SEQ_NBR      = :RECEIV-REC-SEQ-NBR                12630099
126800        AND OPER_UNT_ID      = :WS-TEMP-OPER-UNT-ID               12640099
126900        AND FCLTY_ID         = :RECEIV-FCLTY-ID                   12650099
127100              WITH UR                                             12670099
127200     END-EXEC.                                                    12680099
127300                                                                  12690099
127400     EVALUATE TRUE                                                12700099
127500         WHEN SQLCODE = ZERO                                      12710099
127600              MOVE 'N'         TO PS-SUM-ROW-NOT-FOUND-IND        12720099
127700         WHEN SQLWARN0 NOT EQUAL SPACE                            12730099
127800              CONTINUE                                            12740099
127900         WHEN SQLCODE = PC-ROW-NOT-FOUND                          12750099
128000         WHEN SQLCODE = -305                                      12760099
128100              MOVE 'Y'         TO PS-SUM-ROW-NOT-FOUND-IND        12770099
128200         WHEN SQLCODE NOT EQUAL ZERO                              12780099
128300              DISPLAY 'ORD_NBR = ' RECEIV-ORD-NBR                 12790099
128400              MOVE '7700-SUM-AP-VERIFY-QTY'                       12800099
128500                               TO  WS-PARAGRAPH-NAME              12810099
128600              MOVE 'SELECT DISTINCT'                              12820099
128700                               TO  WS-DB2-OPERATION-ATTEMPTED     12830099
128800              PERFORM 9100-SQL-ABEND                              12840099
128900     END-EVALUATE.                                                12850099
129000*                                                                 12860099
129100 8000-WRITE-DETAIL-LINE.                                          12870099
129200*                                                                 12880099
129300     PERFORM                   VARYING WS-CNT2 FROM 1 BY 1        12890099
129400                               UNTIL WS-CNT2 > WS-DC-ACTIVE-CNT   12900099
129500       MOVE ZEROES        TO   WS-DC-ITEM-QTY-HDR(WS-CNT2)        12910099
129600       MOVE WS-DC-ITEM-QTY(WS-CNT2) TO WS-DC-ITEM-QTY-HDR(WS-CNT2)12920099
129700     END-PERFORM.                                                 12930099
129800*                                                                 12940099
129900     WRITE DI-OUTPUT-RECORD                                       12950099
130000       FROM DL-DETAIL-LINE                                        12960099
130100                                                                  12970099
AV0524     ADD +1                        TO WS-DETAIL-CNT.              12971099
AV0524                                                                  12972099
130200     ADD +2                        TO WS-LINE-COUNT.              12980099
130300                                                                  12990099
130400******************************************************************13000099
130500* 8300-WRITE-PAGE-HEADING - WRITE THE PAGE AND DETAIL HEADINGS FOR13010099
130600* THE DEFECITVE ITEM REPORT.                                      13020099
130700******************************************************************13030099
130800 8300-WRITE-PAGE-HEADING.                                         13040099
130900                                                                  13050099
131000     ADD 1 TO WS-PAGE-COUNT.                                      13060099
131100     MOVE WS-PAGE-COUNT TO DP200O-PAGE-NUMBER.                    13070099
131200                                                                  13080099
131300     WRITE DI-OUTPUT-RECORD                                       13090099
131400         FROM BLANK-LINE.                                         13100099
131500                                                                  13110099
131600******************************************************************13120099
131700* 8400-WRITE-COLUMN-HEADING - WRITE THE COLUMN HEADINGS FOR       13130099
131800* THE DEFECITVE ITEM REPORT.                                      13140099
131900******************************************************************13150099
132000 8400-WRITE-COLUMN-HEADING.                                       13160099
132100                                                                  13170099
132200     WRITE DI-OUTPUT-RECORD                                       13180099
132300        FROM DH2-DETAIL-HEADING                                   13190099
132400                                                                  13200099
132500     WRITE DI-OUTPUT-RECORD                                       13210099
132600        FROM DH2-DETAIL-HEADING-2                                 13220099
132700                                                                  13230099
132800     PERFORM 8500-WRITE-BLANK-LINE.                               13240099
132900                                                                  13250099
133000     MOVE +8      TO WS-LINE-COUNT.                               13260099
133100                                                                  13270099
133200******************************************************************13280099
133300* 8500-WRITE-BLANK-LINE - CENTRAL LOCATION FOR THIS CODE.         13290099
133400******************************************************************13300099
133500 8500-WRITE-BLANK-LINE.                                           13310099
133600                                                                  13320099
133700     WRITE DI-OUTPUT-RECORD                                       13330099
133800         FROM BLANK-LINE.                                         13340099
133900                                                                  13350099
134000******************************************************************13360099
134100* 8900-EMPTY-VENDOR-RPT - IF THERE WAS NO DATA THAT SATISFIED THE 13370099
134200* SELECTION CRITERIA, DISPLAY THE CONTROL CARD VALUES IN A MORE   13380099
134300* READABLE FORMAT.                                                13390099
134400******************************************************************13400099
134500 8900-EMPTY-VENDOR-RPT.                                           13410099
134600                                                                  13420099
134700*    PERFORM 8300-WRITE-PAGE-HEADING.                             13430099
134800*    PERFORM 8400-WRITE-COLUMN-HEADING.                           13440099
134900                                                                  13450099
135000*    WRITE DI-OUTPUT-REPORT-LINE                                  13460099
135100*        FROM ER-EMPTY-REPORT-LINE                                13470099
135200*        AFTER ADVANCING 1 LINES.                                 13480099
135300     DISPLAY ER-EMPTY-REPORT-LINE.                                13490099
135400                                                                  13500099
135500                                                                  13510099
135600******************************************************************13520099
135700* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      13530099
135800* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 13540099
135900******************************************************************13550099
136000 9100-SQL-ABEND.                                                  13560099
136100     DISPLAY '** ABEND     **'.                                   13570099
136200     DISPLAY '** PROGRAM   ** = VLKUT050'.                        13580099
136300     DISPLAY '** PARAGRAPH ** = ' WS-PARAGRAPH-NAME.              13590099
136400     DISPLAY '** OPERATION ** = ' WS-DB2-OPERATION-ATTEMPTED.     13600099
136500                                                                  13610099
136600******************************************************************13620099
136700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    13630099
136800* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         13640099
136900* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     13650099
137000* FORMAT.                                                         13660099
137100******************************************************************13670099
137200     COPY DPPD004.                                                13680099
137300                                                                  13690099
137400     MOVE +4013 TO ABEND-CODE.                                    13700099
137500     CALL 'ILBOABN0' USING ABEND-CODE.                            13710099
