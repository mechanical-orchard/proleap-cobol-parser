000100 IDENTIFICATION DIVISION.                                         00010037
000300 PROGRAM-ID.      MLKUT601.                                       00030054
000400 AUTHOR.          DAVE METZGER.                                   00040054
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050054
000600 DATE-WRITTEN.    04/22/99.                                       00060054
000700 DATE-COMPILED.                                                   00070037
000800                                                                  00080037
000900******************************************************************00090037
001000*        BUILD PLATINUM UNLOAD AND DATE EXTRACT CONTROL CARDS.    00100037
001100*                                                                 00110037
001300*     *** BUILD PLATINUM UNLOAD CONTROL CARDS ****                00130037
001400*                                                                 00140037
001500*  2 PLATINUM UNLOAD CONTROL CARDS ARE BUILT FOR UNLOADING        00150037
001600*  DATA FROM THE VENDOR ANALYSIS DB2 TABLE TVAMCL.  ONE CONTROL   00160037
001700*  CARD WILL BE CREATED FOR UNLOADING "THIS YEAR" DATA AND        00170037
001800*  ONE WILL BE CREATED FOR UNLOADING "LAST YEAR" DATA BASED ON    00180037
001900*  THE OPEN FISCAL YEAR.                                          00190037
002000*                                                                 00200037
002200*     *** BUILD DATE CONTROL CARD FOR DATA EXTRACT ****           00220037
002300*                                                                 00230037
002400* A DATE CONTROL CARD IS BUILT FOR THE OPEN FISCAL YEAR FROM THE  00240037
002500* BEGINNING OF THE CURR SEASON THRU MAX POSTING DATE. IF THE MAX  00250037
002600* MAX POSTING DATE HAS CROSSED OVER INTO THE NEXT FISCAL YEAR, THE00260037
002700* DATE ENDS WITH THE OPEN FISCAL MONTH INSTEAD OF THE MAX POSTING 00270037
002800* MONTH.                                                          00280037
002900*                                                                 00290037
003000* A CONTROL CARD MAY BE USED TO OVERRIDE THE USE OF THE MAX       00300037
003100* POSTING DATE. IF A CONTROL CARD IS USED, THE OUTPUT CONTROL DATE00310037
003200* WILL BE BUILT FROM THE BEGINNING OF THE FISCAL YEAR (INTO WHICH 00320037
003300* THE CONTROL CARD DATE FALLS) THROUGH THE CONTROL CARD DATE.     00330037
003400*                                                                 00340037
003100******************************************************************00350037
003800* CHANGED BY:  B. MCASEY          06-18-1999         WR#10587     00360037
003900* CHANGED THE CONTROL CARDS THAT ARE CREATED TO GRAB THE          00370037
004000* SEA_BEG_DTE INSTEAD OF THE FSCL_YR_BEG_DTE                      00380037
003100******************************************************************00390037
003800* CHANGED BY:  D. METZGER         03-21-2000         WR#10587     00400037
003900* CHANGED THE SQL TO GET THE A MAX POSTING SEASON BEG DATE        00410037
004000* SO THAT WHEN THE MAX POSTING DATE IS MOVED TO THE CONTROL CARDS 00420037
004000* THE CORRESPONDING SEASON BEGIN DATE IS ALSO USED.               00430037
003100******************************************************************00440039
003800* CHANGED BY:  D. METZGER         01-08-2000         WR#99999     00450039
003900* FIXED THE SQL TO GET THE 53RD WEEK DATA (FIRST SELECT IN UNIION)00460039
004000* ADDED HARDCOD '9999-09-09' DATE SO THAT THIS QUERY WILL ONLY    00470039
004000* RETRIEVE DATA FOR 53RD OF A YEAR.                               00480039
004100******************************************************************00490039
W02191* CHANGED BY:  R. JANSSEN         02/19/2001         WR#99999     00491049
  |   * CHANGE DATE CONTROL LOGIC TO USE THE POSTING FISCAL MTH DATE    00492049
  |   * IN PLACE OF THE OPEN FISCAL MTH DATE.                           00493049
W02191******************************************************************00495049
W03142* CHANGED BY:  R. JANSSEN         03/14/2002         WR#99999     00496056
  |   * ADJUST CONTROL TABLE DATE LOGIC TO PROPERLY USE MINIC AN ENTERED00497056
  |   * EXTRACT DATE EXCEPT USING THE TMLCNTL TABLE PSTG FSCL MN DATE.  00498056
W03142******************************************************************00499056
003600                                                                  00500039
003700 ENVIRONMENT DIVISION.                                            00510037
003900 CONFIGURATION SECTION.                                           00530037
004100 SOURCE-COMPUTER. IBM-3090.                                       00550037
004200 OBJECT-COMPUTER. IBM-3090.                                       00560037
004400 INPUT-OUTPUT SECTION.                                            00580037
004600 FILE-CONTROL.                                                    00600037
004700                                                                  00610037
004800     SELECT CONTROL-CARD-FILE                                     00620037
004900         ASSIGN TO INP01.                                         00630037
005600                                                                  00640037
005700     SELECT VA-DATE-EXTRACT-CNTL-FILE                             00650037
005800         ASSIGN TO OUT01.                                         00660037
005000                                                                  00670037
005100     SELECT TVAMCL-TY-DATE-CNTL-FILE                              00680037
005200         ASSIGN TO OUT02.                                         00690037
005300                                                                  00700037
005400     SELECT TVAMCL-LY-DATE-CNTL-FILE                              00710037
005500         ASSIGN TO OUT03.                                         00720037
005900                                                                  00730037
006000 DATA DIVISION.                                                   00740037
006300 FILE SECTION.                                                    00770037
006400                                                                  00780037
006500 FD  CONTROL-CARD-FILE                                            00790037
006600     RECORDING MODE IS F                                          00800037
006700     LABEL RECORDS ARE STANDARD                                   00810037
006800     BLOCK CONTAINS 0 RECORDS.                                    00820037
007000 01  CONTROL-CARD-RECORD              PIC X(80).                  00840037
008800                                                                  00850037
008900 FD  VA-DATE-EXTRACT-CNTL-FILE                                    00870037
009000     RECORDING MODE IS F                                          00880037
009100     LABEL RECORDS ARE STANDARD                                   00890037
009200     BLOCK CONTAINS 0 RECORDS.                                    00900037
009400 01  VA-DATE-EXTRACT-CNTL-RECORD      PIC X(80).                  00920037
007200                                                                  00930037
007300 FD  TVAMCL-TY-DATE-CNTL-FILE                                     00950037
007400     RECORDING MODE IS F                                          00960037
007500     LABEL RECORDS ARE STANDARD                                   00970037
007600     BLOCK CONTAINS 0 RECORDS.                                    00980037
007800 01  TVAMCL-TY-DATE-CNTL-RECORD       PIC X(80).                  01000037
007900                                                                  01010037
008100 FD  TVAMCL-LY-DATE-CNTL-FILE                                     01030037
008200     RECORDING MODE IS F                                          01040037
008300     LABEL RECORDS ARE STANDARD                                   01050037
008400     BLOCK CONTAINS 0 RECORDS.                                    01060037
008600 01  TVAMCL-LY-DATE-CNTL-RECORD       PIC X(80).                  01080037
008700                                                                  01090037
009900/***************************************************************  01100054
009700 WORKING-STORAGE SECTION.                                         01120037
009900****************************************************************  01121054
009800                                                                  01130037
010300     COPY MLRD114.                                                01180037
010400                                                                  01190037
010900     COPY DPWS004.                                                01240037
011000                                                                  01250037
011500 01  CC-CONTROL-CARD.                                             01290037
011600     05  CC-EXTRACT-DTE               PIC X(10).                  01300037
011700     05  FILLER                       PIC X(70).                  01310037
011800                                                                  01320037
011900 01  PC-PROGRAM-CONSTANTS.                                        01330037
012000     05  PC-WEEK53-DATE               PIC X(10)  VALUE            01340037
012100                                                '9999-09-09'.     01350037
012200                                                                  01360037
012300 01  PS-PROGRAM-SWITCHES.                                         01370037
012400     05  PS-END-OF-CONTROL-CARDS-SW   PIC X      VALUE 'N'.       01380037
012500         88  END-OF-CONTROL-CARDS                VALUE 'Y'.       01390037
012600     05  PS-DATE-FOUND-SW             PIC X      VALUE 'N'.       01400037
012700         88  DATE-FOUND                          VALUE 'Y'.       01410037
012800         88  DATE-NOT-FOUND                      VALUE 'N'.       01420037
0101RM     05  PS-TY-KY-DTE-IS-YREND-SW     PIC X(01)  VALUE 'N'.       01421040
0101RM         88  PS-TY-KY-DTE-IS-YREND               VALUE 'Y'.       01422040
012900                                                                  01430037
013000 01  PV-PROGRAM-VARIABLES.                                        01440037
013200     05  PV-MXPSTG-FSCL-MN-END-DTE    PIC X(10)  VALUE SPACE.     01450037
013200     05  PV-MXPSTG-FSCL-YR-NBR        PIC X(04)  VALUE SPACE.     01460037
013200     05  PV-TY-MXPSTG-SEA-BEG-DTE     PIC X(10)  VALUE SPACE.     01470037
013500     05  PV-OPN-FSCL-MN-END-DTE       PIC X(10)  VALUE SPACE.     01480037
013500     05  PV-OPN-FSCL-YR-NBR           PIC X(04)  VALUE SPACE.     01490037
013710     05  PV-TY-FSCL-SEA-BEG-DTE       PIC X(10)  VALUE SPACE.     01500037
013720     05  PV-TY-FSCL-MN-END-DTE        PIC X(10)  VALUE SPACE.     01510037
013721     05  PV-TY-FSCL-MN-NBR            PIC X(02)  VALUE SPACE.     01520037
013722     05  PV-LY-FSCL-SEA-BEG-DTE       PIC X(10)  VALUE SPACE.     01530037
013723     05  PV-LY-FSCL-MN-END-DTE        PIC X(10)  VALUE SPACE.     01540037
013200     05  PV-LY-MXPSTG-SEA-BEG-DTE     PIC X(10)  VALUE SPACE.     01550037
013200     05  PV-LY-MXPSTG-MN-END-DTE      PIC X(10)  VALUE SPACE.     01560037
0101RM     05  PV-KY-DTE                    PIC X(10)  VALUE SPACES.    01570040
0101RM     05  PV-PSTG-MN-YEAR              PIC X(04).                  01590048
0101RM     05  PV-MAXPSTG-MN-YEAR           PIC X(04).                  01630048
013900                                                                  01650040
014000     05  PV-DB2-OPER-ATTEMPTED        PIC X(30).                  01660037
014100     05  PV-PARAGRAPH-NAME            PIC X(30).                  01670037
014200                                                                  01680037
014300****************************************************************  01690037
014400* RECORD FORMAT FOR CREATING "THIS YEAR" AND "LAST YEAR"          01700037
014500* CONTROL FILES FOR USE WITH THE PLATINUM UNLOAD UNTILITY         01710037
014600****************************************************************  01720037
014700 01  PV-TVAMCL-UNLOAD-CNTL-RECORD.                                01730037
014800     05  FILLER                       PIC X(33)  VALUE            01740037
014900         '  WHERE FSCL_MN_END_DTE BETWEEN '''.                    01750037
015000     05  PV-TVAMCL-BEGIN-DATE         PIC X(10)  VALUE SPACES.    01760037
015100     05  FILLER                       PIC X(07)  VALUE            01770037
015200         ''' AND '''.                                             01780037
015300     05  PV-TVAMCL-END-DATE           PIC X(10)  VALUE SPACES.    01790037
015400     05  FILLER                       PIC X(20)  VALUE ''';'.     01800037
015500                                                                  01810037
015600                                                                  01820037
015700 01  ABEND-CODE                       PIC S9(04) COMP             01830037
015800                                                 VALUE ZERO.      01840037
015900                                                                  01850037
016000****************************************************************  01860037
016100* MERCHANDISE LEDGER CONTROL TABLE                                01870037
016200****************************************************************  01880037
016400     EXEC SQL                                                     01900037
016500         INCLUDE TMLCNTL                                          01910037
016600     END-EXEC.                                                    01920037
016700                                                                  01930037
016800****************************************************************  01940037
016900* DATE ATTRIBUTE TABLE                                            01950037
017000****************************************************************  01960037
017200     EXEC SQL                                                     01980037
017300         INCLUDE TDTATTR                                          01990037
017400     END-EXEC.                                                    02000037
017500                                                                  02010037
017600****************************************************************  02020037
017700*  COMMUNICATION AREAS FOR DB2                                    02030037
017800****************************************************************  02040037
018000     EXEC SQL                                                     02060037
018100         INCLUDE SQLCA                                            02070037
018200     END-EXEC.                                                    02080037
018300                                                                  02090037
018400 LINKAGE SECTION.                                                 02100037
018500                                                                  02110037
018800/***************************************************************  02111054
018800****************************************************************  02112054
018600 PROCEDURE DIVISION.                                              02120037
019000****************************************************************  02121054
018700                                                                  02130037
019100 1000-MAIN-MODULE.                                                02170037
019200                                                                  02180037
019300     OPEN INPUT  CONTROL-CARD-FILE                                02190037
019400          OUTPUT TVAMCL-TY-DATE-CNTL-FILE                         02200037
019500                 TVAMCL-LY-DATE-CNTL-FILE                         02210037
019600                 VA-DATE-EXTRACT-CNTL-FILE.                       02220037
019700                                                                  02230037
019800     PERFORM 3000-SET-EXTRACT-DTE.                                02240037
019900                                                                  02250037
020200     CLOSE CONTROL-CARD-FILE                                      02260037
020300           TVAMCL-TY-DATE-CNTL-FILE                               02270037
020400           TVAMCL-LY-DATE-CNTL-FILE                               02280037
020500           VA-DATE-EXTRACT-CNTL-FILE.                             02290037
020600                                                                  02300037
020700     STOP RUN.                                                    02310037
020900                                                                  02320037
021000****************************************************************  02330037
021100*  BUILD VA EXTRACT CONTROL CARD                                  02340037
021200****************************************************************  02350037
021300 3000-SET-EXTRACT-DTE.                                            02360037
021400                                                                  02370037
021500     PERFORM 7000-READ-CONTROL-CARD-FILE.                         02380037
021600                                                                  02390037
021700     IF END-OF-CONTROL-CARDS                                      02400037
021800     OR CC-EXTRACT-DTE = SPACE                                    02410037
W03142         PERFORM 3300-USE-TMLCNTL-DATES                           02420055
W03142******   PERFORM 3200-USE-ML-CNTL-DTES                            02421055
022000     ELSE                                                         02430037
022100         DISPLAY '** INPUT CONTROL CARD: ' CC-CONTROL-CARD        02440037
022200         PERFORM 3100-USE-CONTROL-CARD-DTE                        02450037
022300     END-IF.                                                      02460037
022400                                                                  02470037
022500     DISPLAY '** SELECTED EXTRACT DATE: ' ML114-EXTRACT-DTE.      02480037
022700                                                                  02500037
022800****************************************************************  02510037
022900*  BUILD VA EXTRACT CONTROL CARD DATE BASED ON CONTROL CARD DATE  02520037
023000****************************************************************  02530037
023100 3100-USE-CONTROL-CARD-DTE.                                       02540037
023200                                                                  02550037
023300     DISPLAY '** USING CONTROL CARD DATE FOR EXTRACT DATE.'       02560037
023400                                                                  02570037
0101RM     MOVE CC-EXTRACT-DTE TO PV-KY-DTE.                            02620040
0101RM     PERFORM 8200-SELECT-TY-DATES.                                02630040
0101RM     IF PV-KY-DTE = DTATTR-FSCL-MN-END-DTE                        02851040
0101RM*        BUILD DATE EXTRACT CONTROL CARD FOR MBS DATA             02852040
0101RM         MOVE DTATTR-FSCL-MN-END-DTE TO ML114-EXTRACT-DTE         02853040
0101RM         MOVE DTATTR-FSCL-MN-NBR     TO ML114-EXTRACT-MN-NBR      02854040
0101RM         DISPLAY '** UNLOAD EXTRACT DATA'                         02854141
0101RM         DISPLAY '   ** EXTR DTE = ' ML114-EXTRACT-DTE            02854241
0101RM         DISPLAY '   ** EXTR MN  = ' ML114-EXTRACT-MN-NBR         02854341
0101RM         DISPLAY ' '                                              02854441
0101RM         PERFORM  7100-WRITE-VA-EXTRACT-DATE                      02855040
0101RM*        BUILD "THIS" YEAR DB2 UNLOAD CONTROL CARD                02856040
0101RM         PERFORM  7100-WRITE-VA-EXTRACT-DATE                      02857040
0101RM         MOVE DTATTR-SEA-BEG-DTE        TO PV-TVAMCL-BEGIN-DATE   02858040
0101RM         MOVE DTATTR-FSCL-MN-END-DTE    TO PV-TVAMCL-END-DATE     02859040
0101RM         DISPLAY ' '                                              02859140
0101RM         DISPLAY '** UNLOAD CONTROL CARD FOR THIS YEAR DATA'      02859240
0101RM         DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         02859340
0101RM         DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           02859440
0101RM         DISPLAY ' '                                              02859540
0101RM         PERFORM 7200-WRITE-THIS-YR-UNLOAD-CNTL                   02859640
0101RM         MOVE DTATTR-LY-THIS-DAY-KY-DTE TO PV-KY-DTE              02859740
0101RM         PERFORM 8300-SELECT-LY-DATES                             02859840
0101RM*        BUILD "LAST" YEAR DB2 UNLOAD CONTROL CARD                02859940
0101RM         MOVE DTATTR-SEA-BEG-DTE        TO PV-TVAMCL-BEGIN-DATE   02860040
                                                                        02860154
0101RM***************************************************************** 02860240
0101RM*  CHECK IF CURRENT END DATE WAS YEAR END AND IF IT WAS USE THE   02860340
0101RM*  DTATTR-FSCL-YR-END-DTE OF THE PRIOR FISCAL YEAR.               02860440
0101RM*  THIS TEST IS USED WHEN THE CURRENT YEAR IS A 52 WEEK YEAR      02860540
0101RM*  AND THE LAST LEAR IS A 53 WEEK YEAR. THE LAST DAY IN A 52 WEEK 02860640
0101RM*  YEAR CORRESPONDS TO THE 52ND WEEK DAY IN A 53 WEEK YEAR, NOT   02860740
0101RM*  THE FSCL-YR-END-DTE!                                           02860840
0101RM***************************************************************** 02860940
                                                                        02861054
               IF PS-TY-KY-DTE-IS-YREND                                 02861155
0101RM             MOVE DTATTR-FSCL-YR-END-DTE TO PV-TVAMCL-END-DATE    02861242
0101RM         ELSE                                                     02861340
0101RM             MOVE PV-KY-DTE              TO PV-TVAMCL-END-DATE    02861440
0101RM         END-IF                                                   02861540
0101RM         DISPLAY '** UNLOAD CONTROL CARD FOR LAST YEAR DATA'      02861640
0101RM         DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         02861740
0101RM         DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           02861840
0101RM         DISPLAY ' '                                              02861940
0101RM         PERFORM 7300-WRITE-LAST-YR-UNLOAD-CNTL                   02862040
024400     ELSE                                                         02863037
024500         DISPLAY '** ABEND **'                                    02870037
024600         DISPLAY '** PROGRAM MLKUT601 **'                         02880037
024700         DISPLAY '** PARAGRAPH 3100-USE-CONTROL-CARD-DTE'         02890037
024800         DISPLAY '** CONTROL CARD DATE NOT A VALID FISCAL'        02900037
024900         DISPLAY '** MONTH-END DATE. '                            02910037
025000         MOVE +4003 TO ABEND-CODE                                 02920037
025100         PERFORM 9999-ABEND                                       02930037
025200     END-IF.                                                      02940037
025300                                                                  02950037
025400****************************************************************  02961037
025500*  BUILD VA EXTRACT CONTROL CARD DATE BASED ON CONTROL TABLE DATE 02970037
025600****************************************************************  02980037
025700 3200-USE-ML-CNTL-DTES.                                           02990037
025800                                                                  03000037
025900     PERFORM 8000-GET-OPN-FSCL-MNTH-DATE.                         03010037
026000                                                                  03020037
0101RM     PERFORM 8400-SELECT-PSTG-MAX-YEARS.                          03051048
026800                                                                  03060037
026900     DISPLAY                                                      03070037
W02191         '** PSTG FISCAL MONTH DATE: ' MLCNTL-PSTG-FSCL-MN-DTE.   03080049
W02191******   '** OPEN FISCAL MONTH DATE: ' MLCNTL-OPN-FSCL-MN-DTE.    03081049
                                                                        03082049
027100     DISPLAY                                                      03090037
027200         '** MAX POSTING MONTH DATE: ' MLCNTL-MXPSTG-FSCL-MN-DTE. 03100037
                                                                        03101049
027300* CHANGED TO CHECK THE POSTING MONTH AGAINST THE MAX POSTING      03110047
027300* VERSUS THE OPEN FSCL MONTH AGAINST THE MAX POSTING              03110147
0101RM     IF  PV-PSTG-MN-YEAR = PV-MAXPSTG-MN-YEAR                     03371948
0101RM*        USE MAX POSTING DATE FOR EXTRACT CNTL CARD FOR MBS DATA  03372042
0101RM         MOVE MLCNTL-MXPSTG-FSCL-MN-DTE TO ML114-EXTRACT-DTE      03373042
0101RM         MOVE MLCNTL-MXPSTG-FSCL-MN-NBR TO ML114-EXTRACT-MN-NBR   03374042
0101RM         PERFORM  7100-WRITE-VA-EXTRACT-DATE                      03375042
0101RM         DISPLAY ' '                                              03376042
0101RM         DISPLAY '  ** EXTRACT DTE & MN ' ML114-EXTRACT-DTE ' '   03377042
0101RM                                          ML114-EXTRACT-MN-NBR    03378042
0101RM         MOVE MLCNTL-MXPSTG-FSCL-MN-DTE TO PV-KY-DTE              03379042
0101RM         PERFORM 8200-SELECT-TY-DATES                             03379142
0101RM*        BUILD "THIS" YEAR DB2 UNLOAD CONTROL CARD                03379242
0101RM         MOVE DTATTR-SEA-BEG-DTE         TO PV-TVAMCL-BEGIN-DATE  03379342
0101RM         MOVE MLCNTL-MXPSTG-FSCL-MN-DTE  TO PV-TVAMCL-END-DATE    03379442
0101RM         PERFORM 7200-WRITE-THIS-YR-UNLOAD-CNTL                   03379542
0101RM         DISPLAY ' '                                              03379642
0101RM         DISPLAY '** UNLOAD CONTROL CARD FOR THIS YEAR DATA'      03379742
0101RM         DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         03379842
0101RM         DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           03379942
0101RM         DISPLAY ' '                                              03380042
0101RM         MOVE DTATTR-LY-THIS-DAY-KY-DTE TO PV-KY-DTE              03380145
0101RM         PERFORM 8300-SELECT-LY-DATES                             03380242
0101RM*        BUILD "LAST" YEAR DB2 UNLOAD CONTROL CARD                03380342
0101RM         MOVE DTATTR-SEA-BEG-DTE        TO PV-TVAMCL-BEGIN-DATE   03380442
                                                                        03380554
0101RM***************************************************************** 03380642
0101RM*  CHECK IF CURRENT END DATE WAS YEAR END AND IF IT WAS USE THE   03380742
0101RM*  DTATTR-FSCL-YR-END-DTE OF THE PRIOR FISCAL YEAR.               03380842
0101RM*  THIS TEST IS USED WHEN THE CURRENT YEAR IS A 52 WEEK YEAR      03380942
0101RM*  AND THE LAST LEAR IS A 53 WEEK YEAR. THE LAST DAY IN A 52 WEEK 03381042
0101RM*  YEAR CORRESPONDS TO THE 52ND WEEK DAY IN A 53 WEEK YEAR, NOT   03381142
0101RM*  THE FSCL-YR-END-DTE!                                           03381242
0101RM***************************************************************** 03381342
                                                                        03381454
0101RM         IF PS-TY-KY-DTE-IS-YREND                                 03381542
0101RM             MOVE DTATTR-FSCL-YR-END-DTE TO PV-TVAMCL-END-DATE    03381642
0101RM         ELSE                                                     03381742
0101RM             MOVE PV-KY-DTE              TO PV-TVAMCL-END-DATE    03381842
0101RM         END-IF                                                   03381942
0101RM         DISPLAY '** UNLOAD CONTROL CARD FOR LAST YEAR DATA'      03382042
0101RM         DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         03382142
0101RM         DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           03382242
0101RM         DISPLAY ' '                                              03382342
0101RM         PERFORM 7300-WRITE-LAST-YR-UNLOAD-CNTL                   03382442
027900     ELSE                                                         03383037
                                                                        03384049
027510*        USE OPEN FISCAL DATE FOR EXTRACT CNTL CARD FOR MBS DATA  03390037
W02191         DISPLAY '** USING PSTG FISCAL MONTH FOR EXTRACT DATE.'   03400050
  |            MOVE MLCNTL-PSTG-FSCL-MN-DTE   TO ML114-EXTRACT-DTE      03410050
  |            MOVE MLCNTL-PSTG-FSCL-MN-NBR   TO ML114-EXTRACT-MN-NBR   03420049
  |   *****    DISPLAY '** USING OPEN FISCAL MONTH FOR EXTRACT DATE.'   03421050
  |   *****    MOVE MLCNTL-OPN-FSCL-MN-DTE    TO ML114-EXTRACT-DTE      03430049
W02191*****    MOVE MLCNTL-OPN-FSCL-MN-NBR    TO ML114-EXTRACT-MN-NBR   03440049
0101RM         PERFORM  7100-WRITE-VA-EXTRACT-DATE                      03454042
0101RM         DISPLAY ' '                                              03455042
0101RM         DISPLAY '  ** EXTRACT DTE & MN ' ML114-EXTRACT-DTE ' '   03456042
0101RM                                          ML114-EXTRACT-MN-NBR    03457042
                                                                        03457149
W02191         MOVE MLCNTL-PSTG-FSCL-MN-DTE   TO PV-KY-DTE              03458049
W02191*****    MOVE MLCNTL-OPN-FSCL-MN-DTE TO PV-KY-DTE                 03458149
0101RM         PERFORM 8200-SELECT-TY-DATES                             03459042
                                                                        03459149
0101RM*        BUILD "THIS" YEAR DB2 UNLOAD CONTROL CARD                03459242
0101RM         MOVE DTATTR-SEA-BEG-DTE       TO PV-TVAMCL-BEGIN-DATE    03459342
W02191         MOVE MLCNTL-PSTG-FSCL-MN-DTE  TO PV-TVAMCL-END-DATE      03459449
W02191*****    MOVE MLCNTL-OPN-FSCL-MN-DTE   TO PV-TVAMCL-END-DATE      03459549
0101RM         PERFORM 7200-WRITE-THIS-YR-UNLOAD-CNTL                   03459642
0101RM         DISPLAY ' '                                              03459742
0101RM         DISPLAY '** UNLOAD CONTROL CARD FOR THIS YEAR DATA'      03459842
0101RM         DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         03459942
0101RM         DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           03460042
0101RM         DISPLAY ' '                                              03460142
                                                                        03460249
0101RM         MOVE DTATTR-LY-THIS-DAY-KY-DTE TO PV-KY-DTE              03460347
0101RM         PERFORM 8300-SELECT-LY-DATES                             03460442
0101RM*        BUILD "LAST" YEAR DB2 UNLOAD CONTROL CARD                03460542
0101RM         MOVE DTATTR-SEA-BEG-DTE        TO PV-TVAMCL-BEGIN-DATE   03460642
0101RM***************************************************************** 03460742
0101RM*  CHECK IF CURRENT END DATE WAS YEAR END AND IF IT WAS USE THE   03460842
0101RM*  DTATTR-FSCL-YR-END-DTE OF THE PRIOR FISCAL YEAR.               03460942
0101RM*  THIS TEST IS USED WHEN THE CURRENT YEAR IS A 52 WEEK YEAR      03461042
0101RM*  AND THE LAST LEAR IS A 53 WEEK YEAR. THE LAST DAY IN A 52 WEEK 03461142
0101RM*  YEAR CORRESPONDS TO THE 52ND WEEK DAY IN A 53 WEEK YEAR, NOT   03461242
0101RM*  THE FSCL-YR-END-DTE!                                           03461342
0101RM***************************************************************** 03461442
0101RM         IF PS-TY-KY-DTE-IS-YREND                                 03461542
0101RM             MOVE DTATTR-FSCL-YR-END-DTE TO PV-TVAMCL-END-DATE    03461642
0101RM         ELSE                                                     03461742
0101RM             MOVE PV-KY-DTE              TO PV-TVAMCL-END-DATE    03461842
0101RM         END-IF                                                   03461942
0101RM         DISPLAY '** UNLOAD CONTROL CARD FOR LAST YEAR DATA'      03462042
0101RM         DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         03462142
0101RM         DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           03462242
0101RM         DISPLAY ' '                                              03462342
0101RM         PERFORM 7300-WRITE-LAST-YR-UNLOAD-CNTL                   03463042
028300     END-IF.                                                      03630037
028400                                                                  03640037
W03142****************************************************************  03650055
  |   * 3300-USE-TMLCNTL-DATES.                                         03651055
  |   ****************************************************************  03652055
  |    3300-USE-TMLCNTL-DATES.                                          03652155
  |                                                                     03652255
  |        DISPLAY '** USING TMLCNTL DATES FOR EXTRACT DATE.'           03652355
  |                                                                     03652455
  |        PERFORM 8000-GET-OPN-FSCL-MNTH-DATE.                         03652555
  |                                                                     03652655
  |        MOVE MLCNTL-PSTG-FSCL-MN-DTE  TO PV-KY-DTE.                  03652755
  |        PERFORM 8200-SELECT-TY-DATES.                                03652955
  |                                                                     03653055
  |        DISPLAY                                                      03653155
  |            '** PSTG FISCAL MONTH DATE: ' MLCNTL-PSTG-FSCL-MN-DTE.   03653255
  |        DISPLAY                                                      03653455
  |            '** MAX POSTING MONTH DATE: ' MLCNTL-MXPSTG-FSCL-MN-DTE. 03653555
  |                                                                     03653655
  |        IF PV-KY-DTE = DTATTR-FSCL-MN-END-DTE                        03653755
  |   *        BUILD DATE EXTRACT CONTROL CARD FOR MBS DATA             03653855
  |            MOVE DTATTR-FSCL-MN-END-DTE TO ML114-EXTRACT-DTE         03653955
  |            MOVE DTATTR-FSCL-MN-NBR     TO ML114-EXTRACT-MN-NBR      03654055
  |            DISPLAY '** UNLOAD EXTRACT DATA'                         03654155
  |            DISPLAY '   ** EXTR DTE = ' ML114-EXTRACT-DTE            03654255
  |            DISPLAY '   ** EXTR MN  = ' ML114-EXTRACT-MN-NBR         03654355
  |            DISPLAY ' '                                              03654455
  |            PERFORM  7100-WRITE-VA-EXTRACT-DATE                      03654555
  |   *        BUILD "THIS" YEAR DB2 UNLOAD CONTROL CARD                03654655
  |            PERFORM  7100-WRITE-VA-EXTRACT-DATE                      03654755
  |            MOVE DTATTR-SEA-BEG-DTE        TO PV-TVAMCL-BEGIN-DATE   03654855
  |            MOVE DTATTR-FSCL-MN-END-DTE    TO PV-TVAMCL-END-DATE     03654955
  |            DISPLAY ' '                                              03655055
  |            DISPLAY '** UNLOAD CONTROL CARD FOR THIS YEAR DATA'      03655155
  |            DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         03655255
  |            DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           03655355
  |            DISPLAY ' '                                              03655455
  |            PERFORM 7200-WRITE-THIS-YR-UNLOAD-CNTL                   03655555
  |            MOVE DTATTR-LY-THIS-DAY-KY-DTE TO PV-KY-DTE              03655655
  |            PERFORM 8300-SELECT-LY-DATES                             03655755
  |   *        BUILD "LAST" YEAR DB2 UNLOAD CONTROL CARD                03655855
  |            MOVE DTATTR-SEA-BEG-DTE        TO PV-TVAMCL-BEGIN-DATE   03655955
  |                                                                     03656055
  |   ***************************************************************** 03656155
  |   *  CHECK IF CURRENT END DATE WAS YEAR END AND IF IT WAS USE THE   03656255
  |   *  DTATTR-FSCL-YR-END-DTE OF THE PRIOR FISCAL YEAR.               03656355
  |   *  THIS TEST IS USED WHEN THE CURRENT YEAR IS A 52 WEEK YEAR      03656455
  |   *  AND THE LAST LEAR IS A 53 WEEK YEAR. THE LAST DAY IN A 52 WEEK 03656555
  |   *  YEAR CORRESPONDS TO THE 52ND WEEK DAY IN A 53 WEEK YEAR, NOT   03656655
  |   *  THE FSCL-YR-END-DTE!                                           03656755
  |   ***************************************************************** 03656855
  |                                                                     03656955
  |            IF PS-TY-KY-DTE-IS-YREND                                 03657055
  |                MOVE DTATTR-FSCL-YR-END-DTE TO PV-TVAMCL-END-DATE    03657155
  |            ELSE                                                     03657255
  |                MOVE PV-KY-DTE              TO PV-TVAMCL-END-DATE    03657355
  |            END-IF                                                   03657455
  |            DISPLAY '** UNLOAD CONTROL CARD FOR LAST YEAR DATA'      03657555
  |            DISPLAY '   ** BEG DATE = ' PV-TVAMCL-BEGIN-DATE         03657655
  |            DISPLAY '   ** END DATE = ' PV-TVAMCL-END-DATE           03657755
  |            DISPLAY ' '                                              03657855
  |            PERFORM 7300-WRITE-LAST-YR-UNLOAD-CNTL                   03657955
   |       ELSE                                                         03658055
   |           DISPLAY '** ABEND **'                                    03658155
   |           DISPLAY '** PROGRAM MLKUT601 **'                         03658255
   |           DISPLAY '** PARAGRAPH 3100-USE-CONTROL-CARD-DTE'         03658355
   |           DISPLAY '** CONTROL CARD DATE NOT A VALID FISCAL'        03658455
   |           DISPLAY '** MONTH-END DATE. '                            03658555
   |           MOVE +4003 TO ABEND-CODE                                 03658655
   |           PERFORM 9999-ABEND                                       03658755
   |       END-IF.                                                      03658855
W03142                                                                  03658955
030720****************************************************************  03659055
030730*  READ CONTROL CARD FILE                                         03660037
030740****************************************************************  03670037
030750 7000-READ-CONTROL-CARD-FILE.                                     03680037
030800                                                                  03690037
030900     READ CONTROL-CARD-FILE INTO CC-CONTROL-CARD                  03700037
031000         AT END SET END-OF-CONTROL-CARDS TO TRUE.                 03710037
031200                                                                  03720037
031300****************************************************************  03730037
031400*  WRITE DATE EXTRACT CONTROL CARD FILE                           03740037
031500****************************************************************  03750037
031600 7100-WRITE-VA-EXTRACT-DATE.                                      03760037
031700                                                                  03770037
031800     WRITE VA-DATE-EXTRACT-CNTL-RECORD                            03780037
031900         FROM ML114-LEDGER-EXTRACT-DATE-REC.                      03790037
032000                                                                  03800037
031300****************************************************************  03810037
031400*  WRITE "THIS" YEAR DB2 UNLOAD CONTROL CARD FILE                 03820037
031500****************************************************************  03830037
031600 7200-WRITE-THIS-YR-UNLOAD-CNTL.                                  03840037
031700                                                                  03850037
031800     WRITE TVAMCL-TY-DATE-CNTL-RECORD                             03860037
031900         FROM PV-TVAMCL-UNLOAD-CNTL-RECORD.                       03870037
032000                                                                  03880037
031300****************************************************************  03890037
031400*  WRITE "LAST" YEAR DB2 UNLOAD CONTROL CARD FILE                 03900037
031500****************************************************************  03910037
031600 7300-WRITE-LAST-YR-UNLOAD-CNTL.                                  03920037
031700                                                                  03930037
031800     WRITE TVAMCL-LY-DATE-CNTL-RECORD                             03940037
031900         FROM PV-TVAMCL-UNLOAD-CNTL-RECORD.                       03950037
032000                                                                  03960037
035800****************************************************************  03970037
035900*  GET THE OPEN FISCAL MONTH DATE SO IT CAN BE USED TO GET        03980037
035900*  ALL OF THE DATE INFO TO CREATE THE CONTROL CARDS               03990037
036000****************************************************************  04000037
036100 8000-GET-OPN-FSCL-MNTH-DATE.                                     04010037
036200                                                                  04020037
036300     EXEC SQL                                                     04030037
036400        SELECT  OPN_FSCL_MN_DTE                                   04040037
0101RM              , OPN_FSCL_MN_NBR                                   04041044
0101RM              , OPN_FSCL_WK_DTE                                   04042046
0101RM              , OPN_FSCL_WK_NBR                                   04043046
0101RM              , PSTG_FSCL_MN_DTE                                  04044046
0101RM              , PSTG_FSCL_MN_NBR                                  04045046
0101RM              , PSTG_FSCL_WK_DTE                                  04046046
0101RM              , PSTG_FSCL_WK_NBR                                  04047046
0101RM              , MXPSTG_FSCL_MN_DTE                                04048046
0101RM              , MXPSTG_FSCL_MN_NBR                                04049046
0101RM              , MXPSTG_FSCL_WK_DTE                                04049146
0101RM              , MXPSTG_FSCL_WK_NBR                                04049246
036500          INTO :MLCNTL-OPN-FSCL-MN-DTE                            04050037
036500              ,:MLCNTL-OPN-FSCL-MN-NBR                            04051044
036500              ,:MLCNTL-OPN-FSCL-WK-DTE                            04052046
036500              ,:MLCNTL-OPN-FSCL-WK-NBR                            04053046
036500              ,:MLCNTL-PSTG-FSCL-MN-DTE                           04054046
036500              ,:MLCNTL-PSTG-FSCL-MN-NBR                           04055046
036500              ,:MLCNTL-PSTG-FSCL-WK-DTE                           04056046
036500              ,:MLCNTL-PSTG-FSCL-WK-NBR                           04057046
036500              ,:MLCNTL-MXPSTG-FSCL-MN-DTE                         04058046
036500              ,:MLCNTL-MXPSTG-FSCL-MN-NBR                         04059046
036500              ,:MLCNTL-MXPSTG-FSCL-WK-DTE                         04059146
036500              ,:MLCNTL-MXPSTG-FSCL-WK-NBR                         04059246
                FROM TMLCNTL                                            04062152
036700     END-EXEC.                                                    04070037
036800                                                                  04080037
036900     EVALUATE TRUE                                                04090037
037000         WHEN SQLCODE = ZERO                                      04100037
037100             CONTINUE                                             04110037
037200         WHEN OTHER                                               04120037
037300             MOVE    '8000-GET-OPN-FSCL-MNTH-DATE'                04130037
037400                                          TO PV-PARAGRAPH-NAME    04140037
037500             MOVE    'SELECT ROW FROM TDTATTR'                    04150037
037600                                          TO PV-DB2-OPER-ATTEMPTED04160037
037700             PERFORM 9998-SQL-ABEND                               04170037
037800     END-EVALUATE.                                                04180037
037900                                                                  04190037
0101RM****************************************************************  05260040
0101RM*  GET "THIS YEAR" DATES.                                         05270040
0101RM****************************************************************  05280040
0101RM 8200-SELECT-TY-DATES.                                            05290040
0101RM     EXEC SQL                                                     05300040
0101RM       SELECT LY_THIS_DAY_KY_DTE                                  05310040
0101RM             ,SEA_BEG_DTE                                         05320040
0101RM             ,SEA_END_DTE                                         05321040
0101RM             ,FSCL_MN_NBR                                         05330040
0101RM             ,FSCL_MN_END_DTE                                     05340040
0101RM             ,FSCL_YR_END_DTE                                     05341040
0101RM        INTO :DTATTR-LY-THIS-DAY-KY-DTE                           05350040
0101RM            ,:DTATTR-SEA-BEG-DTE                                  05360040
0101RM            ,:DTATTR-SEA-END-DTE                                  05361040
0101RM            ,:DTATTR-FSCL-MN-NBR                                  05370040
0101RM            ,:DTATTR-FSCL-MN-END-DTE                              05380040
0101RM            ,:DTATTR-FSCL-YR-END-DTE                              05381040
0101RM       FROM TDTATTR                                               05390040
0101RM       WHERE KY_DTE = :PV-KY-DTE                                  05400040
0101RM     END-EXEC.                                                    05410040
0101RM                                                                  05420040
0101RM     EVALUATE TRUE                                                05430040
0101RM         WHEN SQLCODE = ZERO                                      05440040
0101RM             CONTINUE                                             05450040
0101RM         WHEN OTHER                                               05460040
0101RM             DISPLAY '** PV-KY-DTE: ' PV-KY-DTE                   05470040
0101RM             MOVE    '8200-SELECT-TY-DATES'                       05480040
0101RM                                          TO PV-PARAGRAPH-NAME    05490040
0101RM             MOVE    'SELECT FROM TDTATTR'                        05500040
0101RM                                          TO PV-DB2-OPER-ATTEMPTED05510040
0101RM             PERFORM 9998-SQL-ABEND                               05520040
0101RM     END-EVALUATE.                                                05530040
0101RM                                                                  05531040
0101RM* CHECK FOR DATE = '9999-09-09' IE. NON-EXISTANT DATE             05540040
0101RM     IF DTATTR-LY-THIS-DAY-KY-DTE  = PC-WEEK53-DATE               05550040
0101RM         PERFORM 8210-RESELECT-LY-THIS-DAY                        05560040
0101RM     END-IF.                                                      05570040
0101RM                                                                  05580040
0101RM* CHECK IF SELECTING YEAR END DATE.  THIS SWITCH WILL BE USED WHEN05581040
0101RM* PROCESSING LAST YEAR'S DATES.  IF THE CURRENT FISCAL YEAR HAS   05582040
0101RM* 52 WEEKS AND THE PRIOR YEAR HAS 53 WEEKS, THE                   05583040
0101RM* DTATTR-LY-THIS-DAY-KY-DTE IS NOT THE YEAR END DATE, SO THE      05584040
0101RM* ACTUAL YEAR END DATE HAS TO BE USED INSTEAD.                    05585040
0101RM     INITIALIZE PS-TY-KY-DTE-IS-YREND-SW.                         05585140
0101RM     IF PV-KY-DTE = DTATTR-FSCL-YR-END-DTE                        05586040
0101RM         SET PS-TY-KY-DTE-IS-YREND TO TRUE                        05587040
0101RM     END-IF.                                                      05588040
0101RM****************************************************************  05590040
0101RM*  IF THE YEAR BEING SELECTED CONTAINS 53 WEEKS, THE MONTH END    05600040
0101RM*  DATE DOES NOT EXIST IN THE PREVIOUS YEAR (FOR THE LAST WEEK OF 05610040
0101RM*  THE YEAR) TO GET THE CORRECT DATE, SUBTRACT 7 FROM THE DATE    05620040
0101RM*  TO GET THE ACTUAL MONTH END DATE FROM THE PRIOR YEAR.          05630040
0101RM****************************************************************  05640040
0101RM 8210-RESELECT-LY-THIS-DAY.                                       05650040
0101RM     EXEC SQL                                                     05660040
0101RM       SELECT LY_THIS_DAY_KY_DTE                                  05670040
0101RM        INTO :DTATTR-LY-THIS-DAY-KY-DTE                           05680040
0101RM       FROM TDTATTR                                               05690040
0101RM       WHERE KY_DTE =  DATE(:PV-KY-DTE) - 7 DAYS                  05700040
0101RM     END-EXEC.                                                    05710040
0101RM                                                                  05720040
0101RM     EVALUATE TRUE                                                05730040
0101RM         WHEN SQLCODE = ZERO                                      05740040
0101RM             CONTINUE                                             05750040
0101RM         WHEN OTHER                                               05760040
0101RM             DISPLAY '** KEY DATE: ' PV-KY-DTE                    05770040
0101RM             MOVE    '8210-RESELECT-LY-THIS-DAY'                  05780040
0101RM                                          TO PV-PARAGRAPH-NAME    05790040
0101RM             MOVE    'SELECT FROM TDTATTR'                        05800040
0101RM                                          TO PV-DB2-OPER-ATTEMPTED05810040
0101RM             PERFORM 9998-SQL-ABEND                               05820040
0101RM     END-EVALUATE.                                                05830040
0101RM****************************************************************  05840040
0101RM*  GET "LAST YEAR" DATES.                                         05850040
0101RM****************************************************************  05860040
0101RM 8300-SELECT-LY-DATES.                                            05870040
0101RM     EXEC SQL                                                     05880040
0101RM       SELECT SEA_BEG_DTE                                         05890040
0101RM             ,SEA_END_DTE                                         05891040
0101RM             ,FSCL_YR_END_DTE                                     05892040
0101RM       INTO  :DTATTR-SEA-BEG-DTE                                  05900040
0101RM            ,:DTATTR-SEA-END-DTE                                  05901040
0101RM            ,:DTATTR-FSCL-YR-END-DTE                              05902040
             FROM TDTATTR                                               05910054
             WHERE KY_DTE = :PV-KY-DTE                                  05920054
0101RM     END-EXEC.                                                    05930040
0101RM                                                                  05940040
0101RM     EVALUATE TRUE                                                05950040
0101RM         WHEN SQLCODE = ZERO                                      05960040
0101RM             CONTINUE                                             05970040
0101RM         WHEN OTHER                                               05980040
0101RM             DISPLAY '** PV-KY-DTE: ' PV-KY-DTE                   05990040
0101RM             MOVE    '8300-SELECT-LY-DATE'                        06000040
0101RM                                          TO PV-PARAGRAPH-NAME    06010040
0101RM             MOVE    'SELECT FROM TDTATTR'                        06020040
0101RM                                          TO PV-DB2-OPER-ATTEMPTED06030040
0101RM             PERFORM 9998-SQL-ABEND                               06040040
0101RM     END-EVALUATE.                                                06050040
0101RM                                                                  06060040
0101RM****************************************************************  06061048
0101RM*  SELECT POSTING YEARS                                           06062048
0101RM****************************************************************  06063048
0101RM 8400-SELECT-PSTG-MAX-YEARS.                                      06070048
0101RM     EXEC SQL                                                     06080048
0101RM       SELECT A.FSCL_YR_NBR                                       06080148
0101RM             ,B.FSCL_YR_NBR                                       06080248
0101RM       INTO  :PV-PSTG-MN-YEAR                                     06080448
0101RM            ,:PV-MAXPSTG-MN-YEAR                                  06080548
0101RM       FROM TDTATTR A                                             06080748
0101RM          , TDTATTR B                                             06080848
0101RM       WHERE A.KY_DTE = :MLCNTL-PSTG-FSCL-MN-DTE                  06080948
0101RM         AND B.KY_DTE = :MLCNTL-MXPSTG-FSCL-MN-DTE                06081048
0101RM     END-EXEC.                                                    06081148
0101RM                                                                  06081248
0101RM     EVALUATE TRUE                                                06081648
0101RM         WHEN SQLCODE = ZERO                                      06081748
0101RM             CONTINUE                                             06081848
0101RM         WHEN OTHER                                               06081948
0101RM             DISPLAY '** PV-KY-DTE: ' PV-KY-DTE                   06082048
0101RM             MOVE    '8400-SELECT-PSTG-MAX-YEARS'                 06082148
0101RM                                      TO PV-PARAGRAPH-NAME        06082248
0101RM             MOVE    'SELECT FISCAL YEARS FROM TDTATTR'           06082348
0101RM                                      TO PV-DB2-OPER-ATTEMPTED    06082448
0101RM             PERFORM 9998-SQL-ABEND                               06082548
0101RM     END-EVALUATE.                                                06082648
000000****************************************************************  06083040
047300*  BUILD SQL ABEND INFO                                           06090037
047400****************************************************************  06100037
047500 9998-SQL-ABEND.                                                  06110037
047600                                                                  06120037
047700     MOVE +4013 TO ABEND-CODE.                                    06130037
047800     DISPLAY ' '.                                                 06140037
047900     DISPLAY '** ABEND **         ** = SQLERROR'.                 06150037
048000     DISPLAY '** PROGRAM          ** = MLKUT601'.                 06160037
048100     DISPLAY '** PARAGRAPH        ** = ' PV-PARAGRAPH-NAME.       06170037
048200     DISPLAY '** OPERATION        ** = ' PV-DB2-OPER-ATTEMPTED.   06180037
048300                                                                  06190037
048400*    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         06200037
048500*    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        06210037
048600     COPY DPPD004.                                                06220037
048700                                                                  06230037
048800     PERFORM 9999-ABEND.                                          06240037
048900                                                                  06250037
049000****************************************************************  06260037
049100* PROGRAM ABEND PARAGRAPH                                         06270037
049200****************************************************************  06280037
049300 9999-ABEND.                                                      06290037
049400                                                                  06300037
049500     CALL 'ILBOABN0'  USING ABEND-CODE.                           06310037
