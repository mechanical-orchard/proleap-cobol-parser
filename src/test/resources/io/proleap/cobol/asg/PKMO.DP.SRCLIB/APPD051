00001 *--------------- APPD051 STARTS HERE ---------------------------  12/07/95
00002 *                                                                 APPD051 
00003 *     INCLUDE MEMBERS REQUIRED:                                      LV001
00004 *         APWS051  - WORKING STORAGE FOR APPD051                  APPD051 
00005 *         DPWS500  - WORKING STORAGE FOR CALLED PROGRAM DPKUT500  APPD051 
00006 *                                                                 APPD051 
00007 *     CALLED PROGRAMS:                                            APPD051 
00008 *         DPKUT500 - DATE MANIPULATION ROUTINE                    APPD051 
00009 *                                                                 APPD051 
00010 * 12/07/95  CHANGED TO ADD FLOAT DAYS TO THE INVOICE DATE BEFORE  APPD051 
00011 * MKK       THE START DATE IS CALCULATED FOR END OF MONTH TERMS.  APPD051 
00011 *                                                                 APPD051 
00011 * 04/14/98  CHANGED THE DATE MANIPULATION ROUTINE (DPKUT500)      APPD051 
00011 *           SO THAT IT IS CALLED DYNAMICALLY TO MATCH Y2K         APPD051 
00011 *           STANDARDS.                                            APPD051 
00011 * 08/24/99  CHANGED APWS051 RETURN DATE TO INCLUDE CENTURY        APPD051 
00011 * LAS       REMOVED JULIAN RETURN DATE.                           APPD051 
00012 *---------------------------------------------------------------- APPD051 
00013  CALC-PAYMENT-DUE-DATE.                                           APPD051 
00014      INITIALIZE DPG51                                             APPD051 
00015                 DPG52                                             APPD051 
00016                 DPG53                                             APPD051 
00017                 DPG54                                             APPD051 
00018                 DPG55                                             APPD051 
00019                 DPG56.                                            APPD051 
00020                                                                   APPD051 
00021      MOVE 'F2'                 TO DPG51-CALENDAR-TYPE.            APPD051 
00022                                                                   APPD051 
00023      SET DPG52-LK-DTE-ISO-FMT                                     APPD051 
00024          DPG51-INCREMENT-DATE TO TRUE.                            APPD051 
00025                                                                   APPD051 
00026      IF APPD051-EOM-IND = 'Y'                                     APPD051 
00027          MOVE APPD051-INVOICE-DATE      TO DPG52-LK-DATE-INPUT    APPD051 
00028          MOVE APPD051-FLOAT-DAYS        TO DPG51-INCR-DECR-DAYS-9 APPD051 
00029          CALL DP500-KOHLS-CALENDAR-ROUTINE                        APPD051 
00030              USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            APPD051 
00031                                                                   APPD051 
00032          IF (DPG54-DATE-INVALID OR                                APPD051 
00033              DPG54-SEVERE-ERROR)                                  APPD051 
00034              CONTINUE                                             APPD051 
00035          ELSE                                                     APPD051 
00036              MOVE DPG55-DB2-ISO-DATE-FMT TO                       APPD051 
00037                    APPD051-INVOICE-DATE                           APPD051 
00042          END-IF                                                   APPD051 
00043                                                                   APPD051 
00044          PERFORM CALC-START-DATE THRU CALC-START-DATE-EXIT        APPD051 
00045          MOVE APPD051-START-DATE        TO DPG52-LK-DATE-INPUT    APPD051 
00046          IF APPD051-DISCOUNT-DAYS = ZERO AND                      APPD051 
00047             APPD051-EXTENDED-DAYS = ZERO                          APPD051 
00048              MOVE 1                     TO DPG51-INCR-DECR-DAYS-9 APPD051 
00049              SET DPG51-DECREMENT-DATE  TO TRUE                    APPD051 
00050          ELSE                                                     APPD051 
00051              COMPUTE DPG51-INCR-DECR-DAYS-9 =                     APPD051 
00052                  (APPD051-DISCOUNT-DAYS +                         APPD051 
00053                   APPD051-EXTENDED-DAYS -                         APPD051 
00054                   1)                                              APPD051 
00055              END-COMPUTE                                          APPD051 
00056          END-IF                                                   APPD051 
00057      ELSE                                                         APPD051 
00058          MOVE APPD051-INVOICE-DATE TO DPG52-LK-DATE-INPUT         APPD051 
00059          COMPUTE DPG51-INCR-DECR-DAYS-9 =                         APPD051 
00060              (APPD051-DISCOUNT-DAYS +                             APPD051 
00061               APPD051-EXTENDED-DAYS +                             APPD051 
00062               APPD051-FLOAT-DAYS)                                 APPD051 
00063          END-COMPUTE                                              APPD051 
00064      END-IF.                                                      APPD051 
00065                                                                   APPD051 
00066      CALL DP500-KOHLS-CALENDAR-ROUTINE                            APPD051 
00067          USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               APPD051 
00068                                                                   APPD051 
00069      IF (DPG54-DATE-INVALID OR                                    APPD051 
00070          DPG54-SEVERE-ERROR)                                      APPD051 
00071          CONTINUE                                                 APPD051 
00072      ELSE                                                         APPD051 
00073          MOVE DPG55-DB2-ISO-DATE-FMT TO                           APPD051 
00074                APPD051-RETURN-DATE-CCYY-MM-DD                     APPD051 
00075      END-IF.                                                      APPD051 
00076                                                                   APPD051 
00077  CALC-PAYMENT-DUE-DATE-EXIT.                                      APPD051 
00078      EXIT.                                                        APPD051 
00079                                                                   APPD051 
00080  CALC-START-DATE.                                                 APPD051 
00081      MOVE 01 TO APPD051-START-DD.                                 APPD051 
00082      IF APPD051-INVC-DD < '25'                                    APPD051 
00083          IF APPD051-INVC-MM = '12'                                APPD051 
00084              MOVE 01 TO APPD051-START-MM                          APPD051 
00085              PERFORM INCR-YR THRU INCR-YR-EXIT                    APPD051 
00086          ELSE                                                     APPD051 
00087              MOVE APPD051-INVC-MM TO APPD051-START-MM             APPD051 
00088              ADD 1 TO APPD051-START-MM                            APPD051 
00089              MOVE APPD051-INVC-YY TO APPD051-START-YY             APPD051 
00090              MOVE APPD051-INVC-CC TO APPD051-START-CC             APPD051 
00091          END-IF                                                   APPD051 
00092      ELSE                                                         APPD051 
00093          IF APPD051-INVC-MM = '12'                                APPD051 
00094              MOVE 02 TO APPD051-START-MM                          APPD051 
00095              PERFORM INCR-YR THRU INCR-YR-EXIT                    APPD051 
00096          ELSE                                                     APPD051 
00097              IF APPD051-INVC-MM = '11'                            APPD051 
00098                  MOVE 01 TO APPD051-START-MM                      APPD051 
00099                  PERFORM INCR-YR THRU INCR-YR-EXIT                APPD051 
00100              ELSE                                                 APPD051 
00101                  MOVE APPD051-INVC-MM TO APPD051-START-MM         APPD051 
00102                  ADD 2 TO APPD051-START-MM                        APPD051 
00103                  MOVE APPD051-INVC-YY TO APPD051-START-YY         APPD051 
00104                  MOVE APPD051-INVC-CC TO APPD051-START-CC         APPD051 
00105              END-IF                                               APPD051 
00106          END-IF                                                   APPD051 
00107      END-IF.                                                      APPD051 
00108  CALC-START-DATE-EXIT.                                            APPD051 
00109      EXIT.                                                        APPD051 
00110  INCR-YR.                                                         APPD051 
00111      IF APPD051-INVC-YY = '99'                                    APPD051 
00112          MOVE 00 TO APPD051-START-YY                              APPD051 
00113          MOVE 20 TO APPD051-START-CC                              APPD051 
00114      ELSE                                                         APPD051 
00115          MOVE APPD051-INVC-YY TO APPD051-START-YY                 APPD051 
00116          ADD 1 TO APPD051-START-YY                                APPD051 
00117          MOVE APPD051-INVC-CC TO APPD051-START-CC                 APPD051 
00118      END-IF.                                                      APPD051 
00119                                                                   APPD051 
00120  INCR-YR-EXIT.                                                    APPD051 
00121      EXIT.                                                        APPD051 
00122 *--------------- APPD051 ENDS HERE ---------------------------    APPD051 
