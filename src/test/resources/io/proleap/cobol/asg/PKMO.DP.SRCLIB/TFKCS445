      *-----------------------*                                         00010000
       IDENTIFICATION DIVISION.                                         00020000
      *-----------------------*                                         00030000
       PROGRAM-ID.    TFKCS445.                                         00040000
       AUTHOR.        JACK KRAMER.                                      00050000
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
       DATE-WRITTEN.  JANUARY 1997.                                     00070000
       DATE-COMPILED.                                                   00080000
                                                                        00090000
      *---------------------------------------------------------------* 00100000
      *    P445 - TRANSFER WORKSHEET INQUIRY.                         * 00110000
      *                                                               * 00120000
      *    THIS PROGRAM ALLOWS DISPLAY OF TRANSFER WORKSHEET DETAIL.  * 00130000
      *    THE PROGRAM USES MULTIPLE MAPS, THE SPECIFIC MAPS USED ARE * 00240000
      *    DETERMINED BY THE TRANSFER AND CONTAINER TYPES.            * 00250000
      *    THE PROGRAM HANDLES BOTH RETAIL AND NON-RETAIL DETAIL      * 00270000
      *    TRANSFER LINES. THERE IS A LIMIT OF 2 SCREENS OF DETAIL    * 00280000
      *    INFORMATION (20 LINES PER SCREEN FOR RETAIL TRANSFERS AND  * 00290000
      *    10 LINES PER SCREEN FOR NON-RETAIL TRANSFERS). THE DETAIL  * 00300000
      *    INFORMATION IS HELD IN AN ARRAY OF 2 BLOCKS IN THE         * 00310000
      *    COMMAREA. THE PROGRAM TOGGLES BETWEEN THE 2 BLOCKS BY USE  * 00320000
      *    OF F7 PREVPAGE AND F8 NEXTPAGE.                            * 00330000
      *---------------------------------------------------------------* 00340000
      *  1/20/2003 - RAY GRAF                                           00341000
      *   PROCESS NONINTELLIGENT SKU.                                   00342000
      ******************************************************************00343000
111703* 11/17/2003 - RAY GRAF                                           00344000
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00345000
111703******************************************************************00349100
080204**DATE:08/02/2004 CHANGED BY: RAY GRAF                            00349200
080204**     CHANGE PRINTER DESTINATION TO NEW 8 CHARACTER FORMAT       00349300
      ***************************************************************** 00349400
100404**DATE:10/04/2004 CHANGED BY: RAY GRAF                            00349500
100404**     EXPAND STORE NUMBER.  MAKE DOMAIN COMPLIANT.               00349600
      ***************************************************************** 00349700
051705*  DATE 05/17/05 RAY GRAF                                         00349800
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00349900
051705******************************************************************00350000
SR3403*  DATE 03/08/2012 TUSHAR PANDIT                                  00350100
SR3403*  SR3403 LARGE RETAIL UNIT PRICE FIELD EXPANSION.                00350200
SR3403******************************************************************00350300
CICS  * CHANGED 11/17/2022    BY JIM HUNTER      WR: CHG0278345         00350499
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00350599
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00350699
CICS  *-----------------------------------------------------------------00350799
      * CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369         00350899
      * REMOVED COPYBOOK FOR UPC CHECK DIGIT ROUTINE                    00350999
      *-----------------------------------------------------------------00351199
       EJECT                                                            00352000
       ENVIRONMENT DIVISION.                                            00360000
                                                                        00370000
       DATA DIVISION.                                                   00380000
                                                                        00390000
       WORKING-STORAGE SECTION.                                         00400000
                                                                        00410000
       01  DK-DB2-KEYS.                                                 00420000
           05  DK-XFER-TYPE                   PIC  X(02)  VALUE SPACE.  00430000
           05  DK-CONTNR-TYPE                 PIC  X(02)  VALUE SPACE.  00440000
           05  DK-XFER-DKEY-ID                PIC  S9(9)  VALUE ZERO    00450000
                                                          COMP.         00451000
           05  DK-STORE-NBR                   PIC  S9(4)  VALUE ZERO    00460000
                                                          COMP.         00460100
           05  DK-STORE-NBR-9                 PIC S9(04)  VALUE ZEROS   00460200
                                                          COMP.         00460300
           05  DK-UPC-NBR                     PIC S9(15)  VALUE ZERO    00461000
                                                          COMP-3.       00462000
           05  DK-ITEM-NBR                    PIC S9(15)  VALUE ZEROS   01990000
                                                           COMP-3.      01990100
           05  DK-DEPT-NBR                    PIC S9(04)  VALUE ZEROS   01990200
                                                           COMP-3.      01990300
           05  DK-CLASS-NBR                   PIC S9(04)  VALUE ZEROS   01990400
                                                           COMP-3.      01990500
           05  DK-SUBCLASS-NBR                PIC S9(04)  VALUE ZEROS   01990600
                                                           COMP-3.      01990700
           05  DK-SKU-STATUS-CODE             PIC S9(03)  VALUE ZEROS   01990800
                                                           COMP-3.      01990900
                                                                        01991000
       01  PC-PROGRAM-CONSTANTS.                                        01991100
           05  PC-ZERO-SKU                    PIC  X(03)  VALUE '000'.  01991200
           05  PC-099                         PIC  9(03)  VALUE 099.    01991300
           05  PC-100                         PIC  9(03)  VALUE 100.    01991400
           05  PC-FROM-CRIT-SPEC              PIC  X(01)  VALUE '2'.    01991500
           05  PC-FROM-WORKSHEET-SETUP        PIC  X(01)  VALUE '1'.    01991600
           05  PC-COMPLETE-STATUS             PIC  X(02)  VALUE 'CM'.   01992000
           05  PC-ZERO                        PIC S9(04)  VALUE ZERO    01992200
                                                          COMP.         01992300
           05  PC-SCL                         PIC  X(03)  VALUE 'SCL'.  01993000
           05  PC-KOHLS-OPERATING-COMPANY     PIC  X(02)  VALUE '03'.   01994000
           05  PC-FIVE-DAYS                   PIC  9(01)  VALUE 5.      01994100
           05  PC-CLEARANCE                   PIC  9(02)  VALUE 30.     01994400
           05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         01994600
                                                          'TF445A  '.   01994700
           05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         01994800
                                                          'TFKM445 '.   01994900
           05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         01995000
                                                          'TFKCS445'.   01995100
           05  PC-COMMON-HEADER-MAP-NAME      PIC  X(08)  VALUE         01995200
                                                          'TF445A  '.   01995300
           05  PC-RTL-DETAIL-MAP-NAME         PIC  X(08)  VALUE         01995400
                                                          'TF445B  '.   01995500
           05  PC-NRTL-DETAIL-MAP-NAME        PIC  X(08)  VALUE         01995600
                                                          'TF445C  '.   01995700
           05  PC-YES                         PIC  X(01)  VALUE 'Y'.    01995800
           05  PC-RTV-TYPE                    PIC  X(02)  VALUE 'RV'.   01995900
           05  PC-STORE-TYPE                  PIC  X(02)  VALUE 'DS'.   01996000
           05  PC-DC                          PIC  X(02)  VALUE 'DC'.   01996100
           05  PC-ENTRY-METHOD                PIC  X(02)  VALUE '02'.   01996200
111703*    05  PC-DEFECTIVE-DAMAGE            PIC  X(02)  VALUE '01'.   01996300
111703     05  PC-DEFECTIVE-DAMAGE-SORT1      PIC  X(02)  VALUE '00'.   01996400
111703     05  PC-DEFECTIVE-DAMAGE-SORT2      PIC  X(02)  VALUE '01'.   01996500
           05  PC-CALLBACK                    PIC  X(02)  VALUE '02'.   01996600
           05  PC-STOCK-BAL-CORP              PIC  X(02)  VALUE '03'.   01996700
           05  PC-STOCK-BAL-STORE             PIC  X(02)  VALUE '04'.   01996800
           05  PC-CUSTOMER                    PIC  X(02)  VALUE '05'.   01996900
           05  PC-NON-RETAIL                  PIC  X(02)  VALUE '06'.   01997000
           05  PC-OFFSITE-STORAGE             PIC  X(02)  VALUE '07'.   01997100
           05  PC-SECURE-TOTE                 PIC  X(02)  VALUE '02'.   01997200
           05  PC-TRAILER                     PIC  X(02)  VALUE '04'.   01997300
           05  PC-HAND-CARRY                  PIC  X(02)  VALUE '05'.   01997400
           05  PC-SETUP-FORMAT                PIC  X(01)  VALUE '1'.    01997500
           05  PC-MAX-TIMESTAMP               PIC  X(26)  VALUE         01997600
                            '9999-12-31-24.00.00.000000'.               01997700
           05 PC-INIT                   PIC  X(04)  VALUE 'INIT'.       01997800
           05 PC-PUT                    PIC  X(04)  VALUE 'PUT'.        01997900
           05 PC-TERM                   PIC  X(04)  VALUE 'TERM'.       01998000
           05 PC-TOP-OF-PAGE            PIC  X(01)  VALUE '1'.          01998100
           05 PC-SINGLE-SPACE           PIC  X(01)  VALUE ' '.          01998200
           05 PC-DOUBLE-SPACE           PIC  X(01)  VALUE '0'.          01998300
           05  PC-LINE-MAX                    PIC S9(02)  VALUE +60     01998400
                                                          COMP-3.       01998500
           05  PC-ITEMS-PER-RTL-PANEL         PIC S9(04)  VALUE +20     01998600
                                                          COMP SYNC.    01998700
           05  PC-ITEMS-PER-NRTL-PANEL        PIC S9(04)  VALUE +10     01998800
                                                          COMP SYNC.    01998900
           05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      01999000
                                                          COMP SYNC.    01999100
           05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       01999200
                                                          COMP-3.       02000000
           05 PC-MAX-DATE               PIC X(10) VALUE '9999-09-09'.   03850200
      *                                                                 03850300
           05  PC-TSYMSG-NUMBERS.                                       03850400
               10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  03850500
               10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  03850600
               10  PC-TSYMSG-00098            PIC  9(05)  VALUE 00098.  03850700
               10  PC-TSYMSG-01403            PIC  9(05)  VALUE 01403.  03850800
               10  PC-TSYMSG-01483            PIC  9(05)  VALUE 01483.  03850900
               10  PC-TSYMSG-01487            PIC  9(05)  VALUE 01487.  03851000
               10  PC-TSYMSG-01488            PIC  9(05)  VALUE 01488.  03851100
               10  PC-TSYMSG-01495            PIC  9(05)  VALUE 01495.  03851200
               10  PC-TSYMSG-01680            PIC  9(05)  VALUE 01680.  03851300
               10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  03851400
           05  PC-CALLBACK-LITERAL            PIC  X(16)  VALUE         03851500
                   'CALLBACK NO...:'.                                   03851600
           05  PC-APPROVAL-LITERAL            PIC  X(16)  VALUE         03851700
                   'APPROVAL NO...:'.                                   03851800
           05  PC-REQUESTOR-LITERAL           PIC  X(16)  VALUE         03851900
                   'REQUESTED BY..:'.                                   03852000
           05  PC-ATTENTION-LITERAL           PIC  X(15)  VALUE         03852100
                   'ATTENTION TO.:'.                                    03852200
           05  PC-CUST-NAME-LITERAL           PIC  X(14)  VALUE         03852300
                   'CUSTOMER NAME:'.                                    03852400
           05  PC-PHONE-LITERAL               PIC  X(15)  VALUE         03852500
                   'CUSTOMER PHONE:'.                                   03852600
           05  PC-ADDR-LITERAL                PIC  X(14)  VALUE         03852700
                   '   ADDRESS...:'.                                    03852800
           05  PC-CITY-LITERAL                PIC  X(12)  VALUE         03852900
                   'CITY.......:'.                                      03853000
           05  PC-STATE-LITERAL               PIC  X(12)  VALUE         03853100
                   'STATE/ZIP..:'.                                      03853200
           05  PC-LG-TOTE-LITERAL             PIC  X(15)  VALUE         03853300
                   'LG TOTE SEAL.:'.                                    03853400
           05  PC-SM-TOTE-LITERAL             PIC  X(16)  VALUE         03853500
                   'SM TOTE SEAL..:'.                                   03853600
           05  PC-TRLR-SEAL-LITERAL           PIC  X(15)  VALUE         03853700
                   'TRAILER SEAL.:'.                                    03853800
           05  PC-TRLR-NBR-LITERAL            PIC  X(16)  VALUE         03853900
                   'TRAILER NUMBER:'.                                   03854000
           05  PC-WORKSHEET-LITERAL           PIC  X(14)  VALUE         03854100
                   'WORKSHEET NO.:'.                                    03854200
           05  PC-TRANSFER-LITERAL            PIC  X(14)  VALUE         03854300
                   'TRANSFER NO..:'.                                    03854400
      *                                                                 03854500
       01  PS-PROGRAM-SWITCHES.                                         03854600
           05  PS-STORE-FOUND-SW              PIC  X(01)  VALUE 'Y'.    03854700
               88  PS-STORE-FOUND                         VALUE 'Y'.    03854800
               88  PS-STORE-NOT-FOUND                     VALUE 'N'.    03854900
           05  PS-CONTROL-FOUND-SW            PIC  X(01)  VALUE 'Y'.    03855000
               88  PS-CONTROL-FOUND                       VALUE 'Y'.    03855100
               88  PS-CONTROL-NOT-FOUND                   VALUE 'N'.    03855200
           05  PS-VALID-CALLBACK-SW           PIC  X(01)  VALUE 'N'.    03855300
               88  PS-VALID-CALLBACK                      VALUE 'Y'.    03855400
               88  PS-INVALID-CALLBACK                    VALUE 'N'.    03855500
           05  PS-VALID-DEPT-CL-SW            PIC  X(01)  VALUE 'N'.    03855600
               88  PS-VALID-DEPT-CL                       VALUE 'Y'.    03855700
               88  PS-INVALID-DEPT-CL                     VALUE 'N'.    03855800
           05  PS-VALID-UPC-SW                PIC  X(01)  VALUE 'N'.    03856200
               88  PS-VALID-UPC                           VALUE 'Y'.    03856300
               88  PS-INVALID-UPC                         VALUE 'N'.    03856400
           05  PS-VALID-CHECK-DIGIT-SW        PIC  X(01)  VALUE 'N'.    03856500
               88  PS-VALID-CHECK-DIGIT                   VALUE 'Y'.    03856600
               88  PS-INVALID-CHECK-DIGIT                 VALUE 'N'.    03856700
           05  PS-ITEM-FOUND-SW               PIC  X(01)  VALUE 'N'.    03856800
               88  PS-ITEM-FOUND                          VALUE 'Y'.    03856900
               88  PS-NO-ITEM-FOUND                       VALUE 'N'.    03857000
           05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    03857100
               88  PS-COMMAREA-VALID                      VALUE 'Y'.    03857200
               88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    03857300
      *                                                                 03857400
       01  PV-PROGRAM-VARIABLES.                                        03857500
100404*****HOLD FOR REGIONAL AND NONREGIONAL FIELDS                     03857600
100404     05  PV-NREGN-UNT-RTL-AMT          PIC S9(7)V9(2) VALUE ZERO. 03857700
100404     05  PV-NREGN-UPC-STAT-CHG-DTE     PIC  X(10)     VALUE SPACE.03857800
100404     05  PV-NREGN-UNT-RTL-CHG-DTE      PIC  X(10)     VALUE SPACE.03857900
100404     05  PV-NREGN-LOC-SKU-STAT-CDE     PIC  X(02)     VALUE SPACE.03858000
100404     05  PV-NREGN-LOC-SKU-STAT-CDE-9 REDEFINES                    03858100
100404             PV-NREGN-LOC-SKU-STAT-CDE PIC  9(02).                03858200
100404     05  PV-REGN-LOC-SKU-STAT-CDE      PIC  X(02)     VALUE SPACE.03858300
100404     05  PV-GP-RTL-QTY-NULL-IND        PIC S9(04)     VALUE +0    03858400
100404                                                      COMP SYNC.  03858500
100404     05  PV-GP-RTL-AMT-NULL-IND        PIC S9(04)     VALUE +0    03858600
100404                                                      COMP SYNC.  03858700
           05  PV-READ-COUNT                  PIC S9(04)  VALUE +0      03858800
                                                          COMP SYNC.    03858900
           05  PV-REMAINDER                   PIC S9(04)  VALUE +0      03859000
                                                          COMP SYNC.    03859100
           05  PV-NULL-IND                    PIC S9(04)  VALUE +0      03859200
                                                    COMP SYNC.          03859300
           05  PV-SUB                         PIC S9(04)  VALUE +0      03859400
                                                          COMP SYNC.    03859500
           05  PV-BLOCK                       PIC S9(04)  VALUE +0      03859600
                                                          COMP SYNC.    03859700
           05  PV-ITEM                        PIC S9(04)  VALUE +0      03859800
                                                          COMP SYNC.    03859900
           05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03860000
                                                          COMP SYNC.    03860100
           05  PV-RETRY-COUNT                 PIC S9(04)  VALUE +0      03860200
                                                          COMP SYNC.    03860300
100404*    05  PV-XFER-NBR                    PIC 9(09).                03860400
100404     05  PV-XFER-NBR                    PIC 9(10).                03860500
           05  FILLER REDEFINES PV-XFER-NBR.                            03860600
100404*        10  PV-FROM-STORE-NBR          PIC 9(03).                03860700
100404         10  PV-FROM-STORE-NBR          PIC 9(04).                03860800
               10  PV-SEQ-NBR                 PIC 9(06).                03860900
           05  PV-DISP-XFER-NBR.                                        03861000
100404*        10  PV-DISP-FROM-STORE-NBR     PIC X(03).                03861100
100404         10  PV-DISP-FROM-STORE-NBR     PIC X(04).                03861200
               10                             PIC X(01)  VALUE '-'.     03861300
               10  PV-DISP-SEQ-NBR            PIC 9(06).                03861400
           05  PV-PHONE.                                                03861500
               10                             PIC X(01)  VALUE '('.     03861600
               10  PV-PHONE-AREA              PIC 9(03).                03861700
               10                             PIC X(02)  VALUE ')-'.    03861800
               10  PV-PHONE-EXCH              PIC 9(03).                03861900
               10                             PIC X(01)  VALUE '-'.     03862000
               10  PV-PHONE-NBR               PIC 9(04).                03862100
           05  PV-DISPLAY-ITM-NBR              PIC  9(15)  VALUE ZEROS. 03862200
           05  PV-XFER-SEQ-NBR                 PIC S9(09)  VALUE ZERO   03862300
                                                          COMP SYNC.    03862400
           05  PV-UPC-CODE                     PIC S9(15)  VALUE ZERO   03862500
                                                           COMP-3.      03862600
           05  PV-HOLD-UPC-NBR.                                         03862700
               10  PV-KOHLS-UPC-DIGITS         PIC X(04).               03862800
               10  PV-KOHLS-DEPT               PIC 9(03).               03862900
               10  PV-KOHLS-CL.                                         03863000
                   15  PV-KOHLS-CL-1           PIC 9(01).               03863100
                   15  PV-KOHLS-CL-2           PIC 9(01).               03863200
               10  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL                  03863300
                                               PIC 9(02).               03863400
               10  PV-KOHLS-DUMMY-SKU          PIC X(03).               03863500
               10  PV-KOHLS-CHECKDIGIT         PIC X(01).               03863600
           05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR              03863700
                                               PIC 9(13).               03863800
           05  PV-UPC-CODE-DISPLAY             PIC 9(15)  VALUE ZERO.   03863900
           05  PV-MAP-START-BYTE              PIC S9(04)  VALUE ZERO    03864000
                                                          COMP SYNC.    03864100
           05  PV-DISPLAY-XFER-DKEY-ID         PIC  9(09)  VALUE ZEROS. 03864200
           05  PV-LINE-COUNT                  PIC  S9(03)  VALUE +0.    03864300
           05  PV-PAGE-COUNT                  PIC  S9(03)  VALUE +0.    03864400
           05  PV-HOLD-QTY                    PIC S9(04)  COMP.         03864500
           05  PV-LINE-NBR                    PIC S9(04)  COMP.         03864600
           05  PV-PRICE                       PIC ZZZZ.99.              03864700
           05  PV-QUANTITY                    PIC ZZZ.                  03864800
           05  PV-LG-TOTE-FIELD.                                        03864900
               10  PV-LG-TOTE-SEAL1            PIC X(08).               03865000
               10                              PIC X(01)  VALUE SPACE.  03865100
               10  PV-LG-TOTE-SEAL2            PIC X(08).               03865200
           05  PV-NAME.                                                 03865300
               10  PV-INT                      PIC X(01).               03865400
               10                              PIC X(01)  VALUE SPACE.  03865500
               10  PV-LAST-NAME                PIC X(20).               03865600
           05  PV-ZIP.                                                  03865700
               10  PV-ZIP-5                    PIC X(05).               03865800
               10  PV-ZIP-DASH                 PIC X(01)  VALUE SPACE.  03865900
               10  PV-ZIP-EXT                  PIC X(04).               03866000
           05  PV-ABSTIME                      PIC S9(16)  VALUE +0     03866100
                                                           COMP SYNC.   03866200
           05  PV-DB2-TIMESTAMP               PIC X(26).                03866300
           05  PV-DISPLAY-UPC-NBR              PIC  9(13)  VALUE ZEROS. 03866400
           05  PV-DISPLAY-INTR-UPC-ID          PIC  9(09)  VALUE ZEROS. 03866500
051705*    05  PV-CURRENT-DATE.                                         03866600
051705*        10  PV-CURRENT-YEAR             PIC  9(02)  VALUE ZEROS. 03866700
051705*        10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 03866800
051705*        10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 03866900
051705*    05  PV-GREGORIAN-DATE.                                       03867000
051705*        10  PV-GD-MONTH                 PIC  9(02)  VALUE ZEROS. 03868000
051705*        10  PV-GD-DAY                   PIC  9(02)  VALUE ZEROS. 03869000
051705*        10  PV-GD-YEAR                  PIC  9(02)  VALUE ZEROS. 03870000
051705*    05  PV-CURRENT-ISO-DATE             PIC X(10)   VALUE SPACE. 03880000
051705*    05  PV-FR-STR-INV-DTE               PIC X(10)   VALUE SPACE. 03890000
051705*    05  PV-TO-STR-INV-DTE               PIC X(10)   VALUE SPACE. 03900000
051705*    05  PV-XFER-INV-CTOFF-DTE           PIC X(10)   VALUE SPACE. 03910000
051705*    05  PV-MAX-PLND-INV-DTE             PIC X(10)   VALUE SPACE. 03920000
051705*    05  PV-PHY-INV-PERD-IND             PIC X(01)   VALUE SPACE. 03930000
           05  PV-CUR-RTL-AMT                  PIC S9(7)V9(2) COMP-3.   03930100
           05  PV-GP-QTY                       PIC S9(3)V COMP-3.       03930200
SR3403     05  PV-GP-RTL-AMT                   PIC S9(7)V9(2) COMP-3.   03932000
       01  SD-SYSTEM-DATE.                                              03940000
           05  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE.     03950000
           05  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                     03960000
               10  SD-SYSTEM-MONTH         PIC  X(02).                  03970000
               10  FILLER                  PIC  X(01).                  03980000
               10  SD-SYSTEM-DAY           PIC  X(02).                  03990000
               10  FILLER                  PIC  X(01).                  04000000
               10  SD-SYSTEM-YEAR          PIC  X(02).                  04000100
           EJECT                                                        04000200
      *--- REPORT LINE DEFINITIONS FOR THE DRS REPORT                   04000300
      *                                                                 04000400
           COPY DPWS132O.                                               04000500
       01  HL2-HEADING-LINE-2.                                          04000600
           05  FILLER                          PIC  X(57)  VALUE SPACE. 04000700
           05  FILLER                          PIC  X(30)  VALUE        04000800
               'TRANSFER WORKSHEET'.                                    04000900
      *                                                                 04001000
       01  HL3-HEADING-LINE-3.                                          04001100
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04001200
           05  FILLER                          PIC  X(15)  VALUE        04001300
                'WORKSHEET NO.:'.                                       04001400
           05  HL3-CONTROL-NBR                 PIC  9(09).              04001500
100404     05  FILLER                          PIC  X(24)  VALUE SPACE. 04001600
           05  FILLER                          PIC  X(16)  VALUE        04001800
                'TO STORE......:'.                                      04001900
100404*    05  HL3-TO-STORE-NBR                PIC  9(03).              04002000
100404     05  HL3-TO-STORE-NBR                PIC  9(04).              04002100
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04002200
           05  HL3-TO-STORE-NAM                PIC  X(10).              04002300
       01  HL4-HEADING-LINE-4.                                          04002400
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04002500
           05  FILLER                          PIC  X(15)  VALUE        04002600
                'TRANSFER TYPE:'.                                       04002700
           05  HL4-XFER-TYPE                   PIC  X(02).              04002800
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04002900
           05  HL4-XFER-DESC                   PIC  X(20).              04003000
           05  FILLER                          PIC  X(10)  VALUE SPACE. 04003100
100404*    05  FILLER                          PIC  X(16)  VALUE        04003200
100404     05  FILLER                          PIC  X(18)  VALUE        04003300
                'CONTAINER TYPE:'.                                      04003400
           05  HL4-CONTNR-TYPE                 PIC  X(02).              04003500
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04003600
           05  HL4-CONTNR-DESC                 PIC  X(20).              04003700
       01  HL5-HEADING-LINE-5.                                          04003800
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04003900
           05  FILLER                          PIC  X(15)  VALUE        04004000
                'COMPLETED BY.:'.                                       04004100
           05  HL5-COMP-BY-INT                 PIC  X(01).              04004200
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04004300
           05  HL5-COMP-BY-NAM                 PIC  X(20).              04004400
           05  FILLER                          PIC  X(11)  VALUE SPACE. 04004500
           05  HL5-LITERAL                     PIC  X(16)  VALUE SPACE. 04004600
           05  HL5-FIELD                       PIC  X(22).              04004700
       01  HL6A-HEADING-LINE-6A.                                        04004800
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04004900
           05  FILLER                          PIC  X(15)  VALUE        04005000
                'ATTENTION TO.:'.                                       04005100
           05  HL6A-ATTN-TO-INT                PIC  X(01).              04005200
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04005300
           05  HL6A-ATTN-TO-NAM                PIC  X(20).              04005400
       01  HL6B-HEADING-LINE-6B.                                        04005500
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04005600
           05  FILLER                          PIC  X(15)  VALUE        04005700
                'CUSTOMER NAME:'.                                       04005800
           05  HL6B-CUST-NAME                  PIC  X(20).              04005900
           05  FILLER                          PIC  X(13)  VALUE SPACE. 04006000
           05  FILLER                          PIC  X(16)  VALUE        04006100
                'CUSTOMER PHONE:'.                                      04006200
           05  FILLER                          PIC  X(01)  VALUE '('.   04006300
           05  HL6B-PHONE-AREA                 PIC  X(03).              04006400
           05  FILLER                          PIC  X(02)  VALUE ')-'.  04006500
           05  HL6B-PHONE-EXCH                 PIC  X(03).              04006600
           05  FILLER                          PIC  X(01)  VALUE '-'.   04006700
           05  HL6B-PHONE-NBR                  PIC  X(04).              04006800
       01  HL7-HEADING-LINE-7.                                          04006900
           05  FILLER                          PIC  X(05)  VALUE SPACE. 04007000
           05  FILLER                          PIC  X(12)  VALUE        04007100
                'ADDRESS...:'.                                          04007200
           05  HL7-ADDRESS                     PIC  X(20).              04007300
           05  FILLER                          PIC  X(16)  VALUE SPACE. 04007400
           05  FILLER                          PIC  X(13)  VALUE        04007500
                'CITY.......:'.                                         04007600
           05  HL7-CITY                        PIC  X(20).              04007700
       01  HL8-HEADING-LINE-8.                                          04007800
           05  FILLER                          PIC  X(05)  VALUE SPACE. 04007900
           05  FILLER                          PIC  X(12)  VALUE        04008000
                '          :'.                                          04008100
           05  HL8-ADDRESS                     PIC  X(20).              04008200
           05  FILLER                          PIC  X(16)  VALUE SPACE. 04008300
           05  FILLER                          PIC  X(13)  VALUE        04008400
                'STATE/ZIP..:'.                                         04008500
           05  HL8-STATE                       PIC  X(02).              04008600
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04008700
           05  HL8-ZIP                         PIC  X(05).              04008800
           05  HL8-DASH                        PIC  X(01)  VALUE SPACE. 04008900
           05  HL8-ZIP-EXT                     PIC  X(04).              04009000
       01  HL9-HEADING-LINE-9.                                          04009100
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04009200
           05  HL9-LITERAL-1                   PIC  X(15)  VALUE SPACE. 04009300
           05  HL9-FIELD-1                     PIC  X(20).              04009400
           05  FILLER                          PIC  X(13)  VALUE SPACE. 04009500
           05  HL9-LITERAL-2                   PIC  X(16)  VALUE SPACE. 04009600
           05  HL9-FIELD-2                     PIC  X(08).              04009700
       01  HL10A-HEADING-LINE-10A.                                      04009800
           05  FILLER                          PIC  X(33)  VALUE        04009900
             '  LN   D/M/S     UPC'.                                    04010000
           05  FILLER                          PIC  X(18)  VALUE        04010100
SR3403       ' TICKET   QTY'.                                           04010300
           05  FILLER                          PIC  X(33)  VALUE        04010400
             '  LN   D/M/S     UPC'.                                    04010500
           05  FILLER                          PIC  X(18)  VALUE        04010699
SR3403       '  TICKET   QTY'.                                          04010800
       01  HL10B-HEADING-LINE-10B.                                      04010900
           05  FILLER                          PIC  X(49)  VALUE        04011000
             '  LN   ITEM DESCRIPTION'.                                 04011100
           05  FILLER                          PIC  X(22)  VALUE        04011200
             'FIXTURE'.                                                 04011300
           05  FILLER                          PIC  X(10)  VALUE        04011400
             'DPT   QTY'.                                               04011500
       01  DL1A-DETAIL-LINE-1A.                                         04011600
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04011700
           05  DL1A-LIN1                       PIC  ZZ9.                04011800
           05  FILLER                          PIC  X(03)  VALUE SPACE. 04011900
           05  DL1A-DPT-CL-SUBCL.                                       04012000
               10  DL1A-DEPT                  PIC ZZZ.                  04012100
               10  DL1A-GROUP-1.                                        04012300
                   15 FILLER                  PIC X(01)   VALUE SPACE.  04012400
                   15 DL1A-CLASS-1            PIC ZZ      VALUE ZEROS.  04012500
                   15 FILLER                  PIC X(01)   VALUE SPACE.  04012600
                   15 DL1A-SUBCLASS-1         PIC ZZ      VALUE ZEROS.  04012700
               10  DL1A-GROUP-2 REDEFINES DL1A-GROUP-1.                 04012800
                   15 DL1A-CLASS-2            PIC  ZZ.                  04013000
                   15 DL1A-SUBCLASS-2         PIC  ZZZ.                 04013100
                   15 DL1A-FILLER-2A          PIC X(01).                04013200
               10  DL1A-GROUP-3 REDEFINES DL1A-GROUP-1.                 04013300
                   15 DL1A-CLASS-3            PIC  ZZZ.                 04013400
                   15 DL1A-SUBCLASS-3         PIC  ZZ.                  04013600
                   15 DL1A-FILLER-3A          PIC X(01).                04013700
               10  DL1A-GROUP-4 REDEFINES DL1A-GROUP-1.                 04013800
                   15 DL1A-CLASS-4            PIC  ZZZ.                 04013900
                   15 DL1A-SUBCLASS-4         PIC  ZZZ.                 04014100
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04014600
           05  DL1A-UPC1                       PIC  Z(13).              04014700
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04014800
SR3403     05  DL1A-PRC1                       PIC  ZZZZZ.ZZ.           04015000
           05  FILLER                          PIC  X(03)  VALUE SPACE. 04015100
           05  DL1A-QTY1                       PIC  ZZZ.                04015200
           05  FILLER                          PIC  X(07)  VALUE SPACE. 04015300
           05  DL1A-LIN2                       PIC  ZZ9.                04015400
           05  FILLER                          PIC  X(03)  VALUE SPACE. 04015500
           05  DL2A-DPT-CL-SUBCL.                                       04015800
               10  DL2A-DEPT                  PIC ZZZ.                  04015900
               10  DL2A-GROUP-1.                                        04016000
                   15 FILLER                  PIC X(01)   VALUE SPACE.  04016100
                   15 DL2A-CLASS-1            PIC ZZ      VALUE ZEROS.  04016200
                   15 FILLER                  PIC X(01)   VALUE SPACE.  04016300
                   15 DL2A-SUBCLASS-1         PIC ZZ      VALUE ZEROS.  04016400
               10  DL2A-GROUP-2 REDEFINES DL2A-GROUP-1.                 04016500
                   15 DL2A-CLASS-2            PIC  ZZ.                  04016600
                   15 DL2A-SUBCLASS-2         PIC  ZZZ.                 04016700
                   15 DL2A-FILLER-2A          PIC X(01).                04016800
               10  DL2A-GROUP-3 REDEFINES DL2A-GROUP-1.                 04016900
                   15 DL2A-CLASS-3            PIC  ZZZ.                 04017000
                   15 DL2A-SUBCLASS-3         PIC  ZZ.                  04017100
                   15 DL2A-FILLER-3A          PIC X(01).                04017200
               10  DL2A-GROUP-4 REDEFINES DL2A-GROUP-1.                 04017300
                   15 DL2A-CLASS-4            PIC  ZZZ.                 04017400
                   15 DL2A-SUBCLASS-4         PIC  ZZZ.                 04017500
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04018000
           05  DL1A-UPC2                       PIC  Z(13).              04018100
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04018200
SR3403     05  DL1A-PRC2                       PIC  ZZZZZ.ZZ.           04018400
           05  FILLER                          PIC  X(03)  VALUE SPACE. 04018500
           05  DL1A-QTY2                       PIC  ZZZ.                04018600
           05  FILLER                          PIC  X(03)  VALUE SPACE. 04018700
       01  DL1B-DETAIL-LINE-1B.                                         04018800
           05  FILLER                          PIC  X(01)  VALUE SPACE. 04018900
           05  DL1B-LINE                       PIC  ZZ9.                04019000
           05  FILLER                          PIC  X(03)  VALUE SPACE. 04019100
           05  DL1B-DESCRIPTION                PIC  X(40)  VALUE SPACE. 04019200
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04019300
           05  DL1B-FIXTURE                    PIC  X(20)  VALUE SPACE. 04019400
           05  FILLER                          PIC  X(02)  VALUE SPACE. 04019500
           05  DL1B-DEPT                       PIC  X(03)  VALUE SPACE. 04019600
           05  FILLER                          PIC  X(03)  VALUE SPACE. 04019700
           05  DL1B-QTY                        PIC  ZZZ.                04019800
       01  BL-BLANK-LINE.                                               04019900
           05  FILLER                          PIC  X(80)  VALUE SPACE. 04020000
      ***************************************************************** 04020100
      **                  SYMBOLIC MAP DESCRIPTION                   ** 04020200
      **                                                             ** 04020300
      **  THE MAPSET FOR THIS PROGRAM CONSISTS OF 10 SEPERATE MAPS.  ** 04020400
      **  4 MAPS WILL BE DISPLAYED AT ONE TIME; THE SPECIFIC MAPS    ** 04020500
      **  DISPLAYED WILL DEPEND ON THE TRANSFER AND CONTAINER TYPES  ** 04020600
      **  BEING PROCESSED.                                           ** 04020700
      **  THE MAPS CONTAIN DATA AS FOLLOWS:                          ** 04020800
      **                                                             ** 04020900
      **  A)  COMMON HEADER INFO FOR ALL TRANSFER TYPES.             ** 04021000
      **  B)  COMPLETED BY INFO FOR DEF/DAMAGE & STOCK BALANCE-STORE.** 04021100
      **  C)  CALLBACK NUMBER FOR CALLBACK TRANSFERS.                ** 04021200
      **  D)  APPROVAL NUMBER FOR CORPORATE STOCK BALANCE TRANSFERS. ** 04021300
      **  E)  CUSTOMER INFO FOR CUSTOMER TRANSFERS.                  ** 04021400
      **  F)  NON-RETAIL SPECIFIC HEADER INFO.                       ** 04021500
      **  G)  TOTE SEAL INFO FOR ALL CONTAINERS EXCEPT TRAILER.      ** 04021600
      **  H)  TRAILER NUMBER & SEAL INFO FOR TRAILER CONTAINERS.     ** 04021700
      **  I)  DETAIL INFORMATION FOR RETAIL TRANSFERS.               ** 04021800
      **  J)  DETAIL INFORMATION FOR NON-RETAIL TRANSFERS.           ** 04021900
      ***************************************************************** 04022000
       01  MR-MAPSET-REDEFINITION.                                      04022100
           05  MR-A-HEADER.                                             04022200
               10  FILLER                        PIC  X(12).            04022300
      *                                                                 04022400
               10  MR-A-CTL-LIT-L                PIC S9(04)  COMP.      04022500
               10  MR-A-CTL-LIT-A                PIC  X(01).            04022600
               10  MR-A-CTL-LIT-C                PIC  X(01).            04022700
               10  MR-A-CTL-LIT-H                PIC  X(01).            04022800
               10  MR-A-CTL-LIT                  PIC  X(14).            04022900
      *                                                                 04023000
               10  MR-A-CTL-NBR-L                PIC S9(04)  COMP.      04023100
               10  MR-A-CTL-NBR-A                PIC  X(01).            04023200
               10  MR-A-CTL-NBR-C                PIC  X(01).            04023300
               10  MR-A-CTL-NBR-H                PIC  X(01).            04023400
               10  MR-A-CTL-NBR                  PIC  X(10).            04023500
      *                                                                 04023600
               10  MR-A-TO-STORE-NBR-L           PIC S9(04)  COMP.      04023700
               10  MR-A-TO-STORE-NBR-A           PIC  X(01).            04023800
               10  MR-A-TO-STORE-NBR-C           PIC  X(01).            04023900
               10  MR-A-TO-STORE-NBR-H           PIC  X(01).            04024000
               10  MR-A-TO-STORE-NBR.                                   04024100
100404*            15  MR-A-TO-STORE-NBR-N       PIC  9(03).            04024200
100404             15  MR-A-TO-STORE-NBR-N       PIC  9(04).            04024300
      *                                                                 04024400
               10  MR-A-TO-STORE-NAM-L           PIC S9(04)  COMP.      04024500
               10  MR-A-TO-STORE-NAM-A           PIC  X(01).            04024600
               10  MR-A-TO-STORE-NAM-C           PIC  X(01).            04024700
               10  MR-A-TO-STORE-NAM-H           PIC  X(01).            04024800
               10  MR-A-TO-STORE-NAM             PIC  X(10).            04024900
      *                                                                 04025000
               10  MR-A-XFER-TYPE-L              PIC S9(04)  COMP.      04025100
               10  MR-A-XFER-TYPE-A              PIC  X(01).            04025200
               10  MR-A-XFER-TYPE-C              PIC  X(01).            04025300
               10  MR-A-XFER-TYPE-H              PIC  X(01).            04025400
               10  MR-A-XFER-TYPE                PIC  X(01).            04025500
      *                                                                 04025600
               10  MR-A-XFER-DESC-L              PIC S9(04)  COMP.      04025700
               10  MR-A-XFER-DESC-A              PIC  X(01).            04025800
               10  MR-A-XFER-DESC-C              PIC  X(01).            04025900
               10  MR-A-XFER-DESC-H              PIC  X(01).            04026000
               10  MR-A-XFER-DESC                PIC  X(21).            04026100
      *                                                                 04026200
               10  MR-A-CONT-TYPE-L              PIC S9(04)  COMP.      04026300
               10  MR-A-CONT-TYPE-A              PIC  X(01).            04026400
               10  MR-A-CONT-TYPE-C              PIC  X(01).            04026500
               10  MR-A-CONT-TYPE-H              PIC  X(01).            04026600
               10  MR-A-CONT-TYPE                PIC  X(01).            04026700
      *                                                                 04026800
               10  MR-A-CONT-DESC-L              PIC S9(04)  COMP.      04026900
               10  MR-A-CONT-DESC-A              PIC  X(01).            04027000
               10  MR-A-CONT-DESC-C              PIC  X(01).            04027100
               10  MR-A-CONT-DESC-H              PIC  X(01).            04027200
               10  MR-A-CONT-DESC                PIC  X(18).            04027300
      *                                                                 04027400
               10  MR-A-COMP-BY-INT-L            PIC S9(04)  COMP.      04027500
               10  MR-A-COMP-BY-INT-A            PIC  X(01).            04027600
               10  MR-A-COMP-BY-INT-C            PIC  X(01).            04027700
               10  MR-A-COMP-BY-INT-H            PIC  X(01).            04027800
               10  MR-A-COMP-BY-INT              PIC  X(01).            04027900
      *                                                                 04028000
               10  MR-A-COMP-BY-NAM-L            PIC S9(04)  COMP.      04028100
               10  MR-A-COMP-BY-NAM-A            PIC  X(01).            04028200
               10  MR-A-COMP-BY-NAM-C            PIC  X(01).            04028300
               10  MR-A-COMP-BY-NAM-H            PIC  X(01).            04028400
               10  MR-A-COMP-BY-NAM              PIC  X(20).            04028500
      *                                                                 04028600
               10  MR-A-LITERAL1-L               PIC S9(04)  COMP.      04028700
               10  MR-A-LITERAL1-A               PIC  X(01).            04028800
               10  MR-A-LITERAL1-C               PIC  X(01).            04028900
               10  MR-A-LITERAL1-H               PIC  X(01).            04029000
               10  MR-A-LITERAL1                 PIC  X(15).            04029100
      *                                                                 04029200
               10  MR-A-FIELD1-L                 PIC S9(04)  COMP.      04029300
               10  MR-A-FIELD1-A                 PIC  X(01).            04029400
               10  MR-A-FIELD1-C                 PIC  X(01).            04029500
               10  MR-A-FIELD1-H                 PIC  X(01).            04029600
               10  MR-A-FIELD1                   PIC  X(22).            04029700
      *                                                                 04029800
               10  MR-A-CUST-NAME-LIT-L          PIC S9(04)  COMP.      04029900
               10  MR-A-CUST-NAME-LIT-A          PIC  X(01).            04030000
               10  MR-A-CUST-NAME-LIT-C          PIC  X(01).            04030100
               10  MR-A-CUST-NAME-LIT-H          PIC  X(01).            04030200
               10  MR-A-CUST-NAME-LIT            PIC  X(14).            04030300
      *                                                                 04030400
               10  MR-A-CUST-NAME-L              PIC S9(04)  COMP.      04030500
               10  MR-A-CUST-NAME-A              PIC  X(01).            04030600
               10  MR-A-CUST-NAME-C              PIC  X(01).            04030700
               10  MR-A-CUST-NAME-H              PIC  X(01).            04030800
               10  MR-A-CUST-NAME                PIC  X(22).            04030900
      *                                                                 04031000
               10  MR-A-PHONE-LIT-L              PIC S9(04)  COMP.      04031100
               10  MR-A-PHONE-LIT-A              PIC  X(01).            04031200
               10  MR-A-PHONE-LIT-C              PIC  X(01).            04031300
               10  MR-A-PHONE-LIT-H              PIC  X(01).            04031400
               10  MR-A-PHONE-LIT                PIC  X(15).            04031500
      *                                                                 04031600
               10  MR-A-PHONE-NBR-L              PIC S9(04)  COMP.      04031700
               10  MR-A-PHONE-NBR-A              PIC  X(01).            04031800
               10  MR-A-PHONE-NBR-C              PIC  X(01).            04031900
               10  MR-A-PHONE-NBR-H              PIC  X(01).            04032000
               10  MR-A-PHONE-NBR                PIC  X(14).            04032100
      *                                                                 04032200
               10  MR-A-ADDR-LIT-L               PIC S9(04)  COMP.      04032300
               10  MR-A-ADDR-LIT-A               PIC  X(01).            04032400
               10  MR-A-ADDR-LIT-C               PIC  X(01).            04032500
               10  MR-A-ADDR-LIT-H               PIC  X(01).            04032600
               10  MR-A-ADDR-LIT                 PIC  X(14).            04032700
      *                                                                 04032800
               10  MR-A-ADDR1-L                  PIC S9(04)  COMP.      04032900
               10  MR-A-ADDR1-A                  PIC  X(01).            04033000
               10  MR-A-ADDR1-C                  PIC  X(01).            04033100
               10  MR-A-ADDR1-H                  PIC  X(01).            04033200
               10  MR-A-ADDR1                    PIC  X(20).            04033300
      *                                                                 04033400
               10  MR-A-CITY-LIT-L               PIC S9(04)  COMP.      04033500
               10  MR-A-CITY-LIT-A               PIC  X(01).            04033600
               10  MR-A-CITY-LIT-C               PIC  X(01).            04033700
               10  MR-A-CITY-LIT-H               PIC  X(01).            04033800
               10  MR-A-CITY-LIT                 PIC  X(12).            04033900
      *                                                                 04034000
               10  MR-A-CITY-L                   PIC S9(04)  COMP.      04034100
               10  MR-A-CITY-A                   PIC  X(01).            04034200
               10  MR-A-CITY-C                   PIC  X(01).            04034300
               10  MR-A-CITY-H                   PIC  X(01).            04034400
               10  MR-A-CITY                     PIC  X(20).            04034500
      *                                                                 04034600
               10  MR-A-ADDR2-L                  PIC S9(04)  COMP.      04034700
               10  MR-A-ADDR2-A                  PIC  X(01).            04034800
               10  MR-A-ADDR2-C                  PIC  X(01).            04034900
               10  MR-A-ADDR2-H                  PIC  X(01).            04035000
               10  MR-A-ADDR2                    PIC  X(20).            04035100
      *                                                                 04035200
               10  MR-A-STATE-LIT-L              PIC S9(04)  COMP.      04035300
               10  MR-A-STATE-LIT-A              PIC  X(01).            04035400
               10  MR-A-STATE-LIT-C              PIC  X(01).            04035500
               10  MR-A-STATE-LIT-H              PIC  X(01).            04035600
               10  MR-A-STATE-LIT                PIC  X(12).            04035700
      *                                                                 04035800
               10  MR-A-STATE-L                  PIC S9(04)  COMP.      04035900
               10  MR-A-STATE-A                  PIC  X(01).            04036000
               10  MR-A-STATE-C                  PIC  X(01).            04036100
               10  MR-A-STATE-H                  PIC  X(01).            04036200
               10  MR-A-STATE                    PIC  X(02).            04036300
      *                                                                 04036400
               10  MR-A-ZIP-L                    PIC S9(04)  COMP.      04036500
               10  MR-A-ZIP-A                    PIC  X(01).            04036600
               10  MR-A-ZIP-C                    PIC  X(01).            04036700
               10  MR-A-ZIP-H                    PIC  X(01).            04036800
               10  MR-A-ZIP                      PIC  X(10).            04036900
      *                                                                 04037000
               10  MR-A-SEAL1-LIT-L              PIC S9(04)  COMP.      04037100
               10  MR-A-SEAL1-LIT-A              PIC  X(01).            04037200
               10  MR-A-SEAL1-LIT-C              PIC  X(01).            04037300
               10  MR-A-SEAL1-LIT-H              PIC  X(01).            04037400
               10  MR-A-SEAL1-LIT                PIC  X(14).            04037500
      *                                                                 04038000
               10  MR-A-SEAL1-L                  PIC S9(04)  COMP.      04190000
               10  MR-A-SEAL1-A                  PIC  X(01).            04200000
               10  MR-A-SEAL1-C                  PIC  X(01).            04210000
               10  MR-A-SEAL1-H                  PIC  X(01).            04220000
               10  MR-A-SEAL1                    PIC  X(15).            04230000
      *                                                                 04230100
               10  MR-A-SEAL2-LIT-L              PIC S9(04)  COMP.      04230200
               10  MR-A-SEAL2-LIT-A              PIC  X(01).            04230300
               10  MR-A-SEAL2-LIT-C              PIC  X(01).            04230400
               10  MR-A-SEAL2-LIT-H              PIC  X(01).            04230500
               10  MR-A-SEAL2-LIT                PIC  X(15).            04230600
      *                                                                 04230700
               10  MR-A-SEAL2-L                  PIC S9(04)  COMP.      04230800
               10  MR-A-SEAL2-A                  PIC  X(01).            04230900
               10  MR-A-SEAL2-C                  PIC  X(01).            04231000
               10  MR-A-SEAL2-H                  PIC  X(01).            04231100
               10  MR-A-SEAL2                    PIC  X(08).            04231200
      *                                                                 04231300
               10  MR-A-TQTY-L                   PIC S9(04)  COMP.      04231400
               10  MR-A-TQTY-A                   PIC  X(01).            04231500
               10  MR-A-TQTY-C                   PIC  X(01).            04231600
               10  MR-A-TQTY-H                   PIC  X(01).            04231700
               10  MR-A-TQTY                     PIC  Z(05).            04231800
      *                                                                 04231900
               10  MR-A-DSCRP-L                  PIC S9(04)  COMP.      04232000
               10  MR-A-DSCRP-A                  PIC  X(01).            04232100
               10  MR-A-DSCRP-C                  PIC  X(01).            04232200
               10  MR-A-DSCRP-H                  PIC  X(01).            04232300
               10  MR-A-DSCRP                    PIC  X(01).            04232400
      *                                                                 04240000
           05  MR-B-RTL-DETAIL.                                         04510000
               10  FILLER                        PIC  X(12).            04520000
               10  MR-B-SCROLL-AREA              OCCURS 20 TIMES.       04530000
                   15  MR-B-LINE-NBR-L           PIC S9(04) COMP.       04540000
                   15  MR-B-LINE-NBR-A           PIC  X(01).            04550000
                   15  MR-B-LINE-NBR-C           PIC  X(01).            04560000
                   15  MR-B-LINE-NBR-H           PIC  X(01).            04570000
                   15  MR-B-LINE-NBR.                                   04580000
                       20  MR-B-LINE-NBR-N       PIC  Z9.               04590000
      *                                                                 04600000
                   15 MR-B-DPT-CL-SUBCLL         PIC S9(04) COMP.       04601000
                   15 MR-B-DPT-CL-SUBCLA         PIC  X(01).            04602000
                   15 MR-B-DPT-CL-SUBCLC         PIC  X(01).            04603000
                   15 MR-B-DPT-CL-SUBCLH         PIC  X(01).            04604000
                   15 MR-B-DPT-CL-SUBCL          PIC  Z(09).            04605000
                   15 FILLER REDEFINES MR-B-DPT-CL-SUBCL.               04606000
                      20  MR-B-DEPT              PIC Z(03).             04607000
                      20  MR-B-CLASS             PIC Z(03).             04608000
                      20  MR-B-SUBCL             PIC Z(03).             04609000
      *                                                                 04670000
                   15  MR-B-UPC-L                PIC S9(04) COMP.       04680000
                   15  MR-B-UPC-A                PIC  X(01).            04690000
                   15  MR-B-UPC-C                PIC  X(01).            04700000
                   15  MR-B-UPC-H                PIC  X(01).            04710000
                   15  MR-B-UPC                  PIC  Z(13).            04720000
      *                                                                 04740000
                   15  MR-B-PRICE-L              PIC S9(04) COMP.       04750000
                   15  MR-B-PRICE-A              PIC  X(01).            04760000
                   15  MR-B-PRICE-C              PIC  X(01).            04770000
                   15  MR-B-PRICE-H              PIC  X(01).            04780000
                   15  MR-B-PRICE.                                      04790000
SR3403                 20  MR-B-PRICE-N          PIC ZZZZZ.99.          04801000
      *                                                                 04810000
                   15  MR-B-QTY-L                PIC S9(04) COMP.       04820000
                   15  MR-B-QTY-A                PIC  X(01).            04830000
                   15  MR-B-QTY-C                PIC  X(01).            04840000
                   15  MR-B-QTY-H                PIC  X(01).            04850000
                   15  MR-B-QTY.                                        04860000
                       20  MR-B-QTY-N            PIC  Z(03).            04870000
      *                                                                 04880000
           05  MR-C-NRTL-DETAIL.                                        04890000
               10  FILLER                        PIC  X(12).            04900000
               10  MR-C-SCROLL-AREA              OCCURS 10 TIMES.       04910000
                   15  MR-C-LINE-NBR-L           PIC S9(04) COMP.       04920000
                   15  MR-C-LINE-NBR-A           PIC  X(01).            04930000
                   15  MR-C-LINE-NBR-C           PIC  X(01).            04940000
                   15  MR-C-LINE-NBR-H           PIC  X(01).            04950000
                   15  MR-C-LINE-NBR.                                   04960000
                       20  MR-C-LINE-NBR-N       PIC  Z9.               04970000
      *                                                                 04980000
                   15  MR-C-DESC-L               PIC S9(04) COMP.       04990000
                   15  MR-C-DESC-A               PIC  X(01).            05000000
                   15  MR-C-DESC-C               PIC  X(01).            05010000
                   15  MR-C-DESC-H               PIC  X(01).            05020000
                   15  MR-C-DESC                 PIC X(40).             05030000
      *                                                                 05040000
                   15  MR-C-FIXTURE-L            PIC S9(04) COMP.       05050000
                   15  MR-C-FIXTURE-A            PIC  X(01).            05060000
                   15  MR-C-FIXTURE-C            PIC  X(01).            05070000
                   15  MR-C-FIXTURE-H            PIC  X(01).            05080000
                   15  MR-C-FIXTURE              PIC X(20).             05090000
      *                                                                 05100000
                   15  MR-C-DEPT-L               PIC S9(04) COMP.       05110000
                   15  MR-C-DEPT-A               PIC  X(01).            05120000
                   15  MR-C-DEPT-C               PIC  X(01).            05130000
                   15  MR-C-DEPT-H               PIC  X(01).            05140000
                   15  MR-C-DEPT                 PIC X(03).             05150000
      *                                                                 05160000
                   15  MR-C-QTY-L                PIC S9(04) COMP.       05170000
                   15  MR-C-QTY-A                PIC  X(01).            05180000
                   15  MR-C-QTY-C                PIC  X(01).            05190000
                   15  MR-C-QTY-H                PIC  X(01).            05200000
                   15  MR-C-QTY.                                        05210000
                       20  MR-C-QTY-N            PIC  9(03).            05220000
      *                                                                 05230000
       01  MD-MAP-DATA-AREA                      PIC X(3000).           05240000
      *                                                                 05250000
           EJECT                                                        05260000
      *---------------------------------------------------------------* 05270000
      *    ATTRIBUTE SETTINGS COPYBOOK.                               * 05280000
      *---------------------------------------------------------------* 05290000
                                                                        05300000
           COPY DPWS015.                                                05310000
                                                                        05320000
      *---------------------------------------------------------------* 05330000
      *    FUNCTION KEYS COPYBOOK.                                    * 05340000
      *---------------------------------------------------------------* 05350000
                                                                        05360000
           COPY DPWS016.                                                05370000
                                                                        05380000
      *---------------------------------------------------------------* 05390000
      *    NUMERIC EDIT LAYOUT.                                       * 05400000
      *---------------------------------------------------------------* 05410000
                                                                        05420000
           COPY DPWS010I.                                               05430000
       EJECT                                                            05440000
      *                                                                 05450000
      *  COPY BOOK FOR THE CALENDAR ROUTINE                             05460000
      *                                                                 05470000
           COPY DPWS500.                                                05480000
                                                                        05480100
      *---------------------------------------------------------------* 05480200
      *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 05480399
      *---------------------------------------------------------------* 05480400
                                                                        05480500
           COPY DPWS030.                                                05490000
CICS       COPY DPWS930.                                                05491099
       EJECT                                                            05500000
      *---------------------------------------------------------------* 05510000
      *    STANDARD COMMAREA.                                         * 05520000
      *---------------------------------------------------------------* 05530000
                                                                        05540000
           COPY DPWS020.                                                05550000
           05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05560000
                                                                        05570000
      *---------------------------------------------------------------* 05580000
      * INTER-APPLICATION COMMAREA.                                   * 05590000
      *   TFWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE          * 05600000
      *             TRANSFER WORKSHEET SETUP SCREEN.                  * 05610000
      *   TFWS001 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED TO THE   * 05620000
      *             TRANSFER WORKSHEET INQUIRY SCREEN.                * 05630000
      *---------------------------------------------------------------* 05640000
                                                                        05650000
               10  INTER-APPL-COMM-AREA       PIC X(200).               05660000
           COPY TFWS001.                                                05670000
      *---------------------------------------------------------------* 05680000
      *  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05690000
      *---------------------------------------------------------------* 05700000
               10  ASC-SPECIFIC-COMMAREA.                               05710000
                   15  ASC-CONTROL-NBR                     PIC  9(09).  05720000
                   15  ASC-XFER-SEQ-NBR                    PIC  S9(09)  05721000
                                                                COMP.   05740000
                   15  ASC-XFER-DKEY-ID                    PIC  S9(09)  05740100
                                                                COMP.   05740200
                   15  ASC-XFER-TYPE                       PIC  X(02).  05750000
                       88  ASC-NON-RETAIL-XFER             VALUE '06'.  05750100
                       88  ASC-RETAIL-XFER                 VALUE        05750200
111703*                                          '01' THRU '05', '07'.  05751000
111703                                           '00' THRU '05', '07'.  05752000
                   15  ASC-XFER-DESC                       PIC  X(21).  05760000
                   15  ASC-CONTNR-TYPE                     PIC  X(02).  05770000
                   15  ASC-CONTNR-DESC                     PIC  X(18).  05780000
100404*            15  ASC-FR-STORE-NBR                    PIC  X(03).  05790000
100404             15  ASC-FR-STORE-NBR                    PIC  X(04).  05791000
                   15  ASC-FR-STORE-NBR-N REDEFINES ASC-FR-STORE-NBR    05800000
100404*                                                    PIC  9(03).  05810000
100404                                                     PIC  9(04).  05810100
100404*            15  ASC-TO-STORE-NBR                    PIC  X(03).  05810200
100404             15  ASC-TO-STORE-NBR                    PIC  X(04).  05810300
                   15  ASC-TO-STORE-NBR-N REDEFINES ASC-TO-STORE-NBR    05810400
100404*                                                    PIC  9(03).  05810500
100404                                                     PIC  9(04).  05810600
                   15  ASC-TO-STORE-NAM                    PIC  X(10).  05820000
                   15  ASC-TO-STORE-TYPE                   PIC  X(02).  05821000
                   15  ASC-COMP-BY-INT                     PIC  X(01).  05830000
                   15  ASC-COMP-BY-NAM                     PIC  X(20).  05840000
                   15  ASC-REQ-BY-INT                      PIC  X(01).  05850000
                   15  ASC-REQ-BY-NAM                      PIC  X(20).  05860000
                   15  ASC-ATTN-TO-INT                     PIC  X(01).  05870000
                   15  ASC-ATTN-TO-NAM                     PIC  X(20).  05880000
                   15  ASC-CALLBACK-NBR                    PIC  X(04).  05890000
                   15  ASC-CALLBACK-NBR-N REDEFINES ASC-CALLBACK-NBR    05900000
                                                           PIC  9(04).  05910000
                   15  ASC-APPROVAL-NBR                    PIC  X(09).  05920000
                   15  ASC-APPROVAL-NBR-N REDEFINES ASC-APPROVAL-NBR    05930000
                                                           PIC  9(09).  05940000
                   15  ASC-CUST-NAME                       PIC  X(20).  05950000
                   15  ASC-PHONE                           PIC  X(10).  05960000
                   15  FILLER REDEFINES ASC-PHONE.                      05970000
                       20  ASC-PHONE-AREA.                              05980000
                           25  ASC-PHONE-AREA-N            PIC  9(03).  05990000
                       20  ASC-PHONE-EXCH.                              06000000
                           25  ASC-PHONE-EXCH-N            PIC  9(03).  06010000
                       20  ASC-PHONE-NBR.                               06020000
                           25  ASC-PHONE-NBR-N             PIC  9(04).  06030000
                   15  ASC-ADDR1                           PIC  X(20).  06040000
                   15  ASC-ADDR2                           PIC  X(20).  06050000
                   15  ASC-CITY                            PIC  X(20).  06060000
                   15  ASC-STATE                           PIC  X(02).  06070000
                   15  ASC-ZIP                             PIC X(05).   06080000
                   15  ASC-ZIP-N REDEFINES ASC-ZIP         PIC  9(05).  06090000
                   15  ASC-ZIP-EXT                         PIC  X(04).  06100000
                   15  ASC-ZIP-EXT-N REDEFINES ASC-ZIP-EXT PIC  9(04).  06110000
                   15  ASC-LG-TOTE-SEAL1                   PIC  X(07).  06120000
                   15  ASC-LG-TOTE-SEAL2                   PIC  X(07).  06130000
                   15  ASC-SM-TOTE-SEAL                    PIC  X(07).  06140000
                   15  ASC-TRAILER-SEAL                    PIC  X(07).  06150000
                   15  ASC-TRAILER-NBR                     PIC  X(08).  06160000
                   15  ASC-DSCRP-IND                       PIC  X(01).  06160100
                       88  ASC-DISCREPANCY-EXISTS       VALUE 'Y'.      06160200
                       88  ASC-NO-DISCREPANCY-EXISTS    VALUE 'N'.      06160300
                   15  ASC-TQTY                            PIC  9(05).  06160400
                   15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06170000
                       20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06180000
                           88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06190000
                           88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06200000
                       20  ASC-RETAIL-ITEM-ARRAY.                       06210000
                           25  ASC-RETAIL-ENTRIES OCCURS 20 TIMES.      06220000
                               30  FILLER                PIC  X(07).    06230000
                               30  ASC-DPT-CL-SUBCL.                    06231000
                                   35  ASC-DEPT          PIC  9(03).    06240000
                                   35  ASC-CLASS         PIC  9(03).    06250000
                                   35  ASC-SUBCLASS      PIC  9(03).    06260000
                               30  ASC-DPT-CL-SUBCL-N REDEFINES         06270000
                                       ASC-DPT-CL-SUBCL  PIC  9(09).    06271000
                               30  ASC-UPC               PIC  9(13).    06280000
                               30  ASC-UPC-X REDEFINES ASC-UPC.         06290000
                                   45  ASC-UPC-DIGITS    PIC X(04).     06291000
                                   45  FILLER            PIC X(05).     06300000
                                   45  ASC-DUMMY-000     PIC X(03).     06300100
                                   45  FILLER            PIC X(01).     06300200
                               30  ASC-UPC-XXX REDEFINES ASC-UPC.       06300300
                                   45  ASC-KOHLS-UPC-DIGITS PIC X(04).  06300400
                                   45  ASC-KOHLS-DEPT       PIC X(03).  06300500
                                   45  FILLER               PIC X(02).  06300600
                                   45  ASC-KOHLS-DUMMY-SKU  PIC X(03).  06300700
                                   45  FILLER               PIC X(01).  06300800
                               30  ASC-KOHLS-UPC         PIC S9(15)     06301000
                                                         COMP-3.        06302000
                               30  ASC-ITEM-NBR          PIC S9(15)     06302100
                                                         COMP-3.        06302200
SR3403                         30  ASC-PRICE             PIC X(08).     06311099
                               30  ASC-PRICE-N REDEFINES ASC-PRICE      06331099
SR3403                                                   PIC  9(06)V99. 06332099
                               30  ASC-FILE-PRICE        PIC S9(05)V99  06340000
                                                         COMP-3.        06341000
                               30  ASC-RTL-QTY           PIC X(03).     06350000
                               30  ASC-RTL-QTY-N REDEFINES ASC-RTL-QTY  06360000
                                                         PIC  9(03).    06370000
                               30  ASC-CALLBACK-PRICE-SW PIC X(01).     06401000
                                   88  ASC-VALID-CALLBACK-PRICE         06402000
                                                            VALUE 'Y'.  06403000
                                   88  ASC-INVALID-CALLBACK-PRICE       06404000
                                                            VALUE 'N'.  06405000
                               30  ASC-RTL-ITEM-UPDATED-SW PIC X(01).   06410000
                                   88  ASC-RTL-ITEM-UPDATED             06420000
                                                            VALUE 'Y'.  06430000
                                   88  ASC-RTL-ITEM-NOT-UPDATED         06440000
                                                            VALUE ' '.  06450000
                               30  ASC-GROUP-PRICED-SW     PIC X(01).   06450100
                                   88  ASC-GROUP-PRICED-ITEM            06450200
                                                            VALUE 'Y'.  06450300
                                   88  ASC-NOT-GROUP-PRICED-ITEM        06450400
                                                            VALUE 'N'.  06450500
                       20  ASC-NON-RETAIL-ITEM-ARRAY                    06460000
                           REDEFINES ASC-RETAIL-ITEM-ARRAY.             06470000
                           25  ASC-NON-RETAIL-ENTRIES OCCURS 10 TIMES.  06480000
                               30  ASC-ITEM-DESC.                       06490000
                                   35  ASC-ITEM-DESC1    PIC X(20).     06500000
                                   35  ASC-ITEM-DESC2    PIC X(20).     06510000
                               30  ASC-NRTL-DEPT         PIC  X(03).    06520000
                               30  ASC-FIXTURE           PIC  X(20).    06530000
                               30  ASC-NRTL-QTY          PIC X(03).     06540000
                               30  ASC-NRTL-QTY-N REDEFINES ASC-NRTL-QTY06550000
                                                         PIC 9(03).     06560000
                               30  ASC-NRTL-ITEM-UPDATED-SW PIC X(01).  06561000
                                   88  ASC-NRTL-ITEM-UPDATED            06562000
                                                            VALUE 'Y'.  06563000
                                   88  ASC-NRTL-ITEM-NOT-UPDATED        06564000
                                                            VALUE ' '.  06565000
                                                                        06570000
                   15  ASC-ERROR-SW                      PIC  X(01).    06571000
                       88  ASC-NO-ERROR                   VALUE 'N'.    06572000
                       88  ASC-ERROR                      VALUE 'Y'.    06573000
                   15  ASC-XFER-COMPLETE-SW                PIC  X(01).  06574000
                       88  ASC-XFER-IS-COMPLETE            VALUE 'Y'.   06575000
                       88  ASC-XFER-IS-NOT-COMPLETE        VALUE ' '.   06576000
                   15  ASC-COMPLETE-REQUEST-SW             PIC  X(01).  06580000
                       88  ASC-COMPLETE-REQUEST            VALUE 'Y'.   06590000
                       88  ASC-NO-COMPLETE-REQUEST         VALUE 'N'.   06600000
                   15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  06601000
                       88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   06602000
                       88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   06603000
                   15  ASC-CUSTOMER-EXISTS-SW              PIC  X(01).  06610000
                       88  ASC-CUSTOMER-EXISTS             VALUE 'Y'.   06620000
                       88  ASC-CUSTOMER-DOES-NOT-EXIST     VALUE 'N'.   06630000
                   15  ASC-PRINT-REQUEST-SW      PIC X(01).             06630200
                       88  ASC-PRINT-LIST-REQUEST       VALUE 'L'.      06630400
                       88  ASC-NO-PRINT-REQUEST         VALUE 'N'.      06630500
                       88  ASC-PRINT-DOC-REQUEST        VALUE 'D'.      06630600
                   15  ASC-DO-NOT-SHIP-SW                  PIC  X(01).  06630700
                       88  ASC-DO-NOT-SHIP                 VALUE 'N'.   06630800
                       88  ASC-OK-TO-SHIP                  VALUE 'Y'.   06630900
                   15  ASC-NBR-OF-LINES-ENTERED          PIC S9(03)     06631000
                                                              COMP-3.   06632000
                   15  ASC-BLK-SUB                       PIC S9(04)     06640000
                                                              COMP      06650000
                                                              SYNC.     06660000
                   15  ASC-ITEM-SUB                      PIC S9(04)     06670000
                                                              COMP      06680000
                                                              SYNC.     06690000
                   15  ASC-HIGHEST-BLOCK-WRITTEN         PIC S9(04)     06700000
                                                              COMP      06710000
                                                              SYNC.     06720000
           EJECT                                                        06740000
                                                                        06740100
      *----------------------------------------------------------------*06740200
      *  RF COPYBOOK TO FORMAT PRINTER DESTINATION                      06740300
      *----------------------------------------------------------------*06740400
080204     COPY RFWS009.                                                06740500
                                                                        06740600
      *                                                                 06740700
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            06740800
      *                                                                 06740900
           COPY DRRD001O.                                               06741000
                                                                        06741100
      *                                                                 06741200
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        06741300
      *                                                                 06741400
           COPY DRRD002O.                                               06741500
                                                                        06741600
      *                                                                 06741700
      *  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) OUTPUT BLOCK        06741800
      *                                                                 06741900
           COPY DRSDROBC.                                               06742000
                                                                        06742100
           EJECT                                                        06743000
      *---------------------------------------------------------------* 06750000
      *    ABEND PROCESSING COPYBOOK.                                 * 06760000
      *---------------------------------------------------------------* 06770000
                                                                        06780000
           COPY DPWS013.                                                06790000
                                                                        06800000
       EJECT                                                            06810000
      *---------------------------------------------------------------* 06880000
      *    DB2 AREA FOR TRANSFER TABLE                                * 06890000
      *---------------------------------------------------------------* 06900000
           EXEC SQL                                                     06910000
                INCLUDE TTFMSTR                                         06920000
           END-EXEC.                                                    06930000
      *---------------------------------------------------------------* 06940000
      *    DB2 AREA FOR TRANSFER ITEM TABLE                           * 06950000
      *---------------------------------------------------------------* 06960000
           EXEC SQL                                                     06970000
                INCLUDE TTFITEM                                         06980000
           END-EXEC.                                                    06990000
      *---------------------------------------------------------------* 07000000
      *    DB2 AREA FOR TRANSFER CUSTOMER TABLE                       * 07010000
      *---------------------------------------------------------------* 07020000
           EXEC SQL                                                     07030000
                INCLUDE TTFCUST                                         07040000
           END-EXEC.                                                    07050000
      *---------------------------------------------------------------* 07060000
      *    DB2 AREA FOR TRANSFER STATUS TABLE                         * 07070000
      *---------------------------------------------------------------* 07080000
           EXEC SQL                                                     07090000
                INCLUDE TTFSTAT                                         07100000
           END-EXEC.                                                    07100100
      *---------------------------------------------------------------* 07100200
      *    DB2 AREA FOR TRANSFER TYPE TABLE                           * 07100300
      *---------------------------------------------------------------* 07100400
           EXEC SQL                                                     07100500
                INCLUDE TTFTYCD                                         07100600
           END-EXEC.                                                    07100700
      *---------------------------------------------------------------* 07100800
      *    DB2 AREA FOR TRANSFER CONTAINER TYPE TABLE                 * 07100900
      *---------------------------------------------------------------* 07101000
           EXEC SQL                                                     07101100
                INCLUDE TTFSHCT                                         07101200
           END-EXEC.                                                    07101300
      *---------------------------------------------------------------* 07318200
      *    DB2 AREA FOR PERMANENT PRICE CHANGE HISTORY TABLE          * 07318300
      *---------------------------------------------------------------* 07318400
           EXEC SQL                                                     07318500
               INCLUDE TPPCPRC                                          07318600
           END-EXEC.                                                    07318700
051705*---------------------------------------------------------------* 07319400
051705*    DB2 AREA FOR TRANSFER CONTROL TABLE                        * 07319500
051705*---------------------------------------------------------------* 07319600
051705*    EXEC SQL                                                     07319700
051705*         INCLUDE TTFCNTL                                         07319800
051705*    END-EXEC.                                                    07319900
051705*---------------------------------------------------------------* 07320000
051705*    DB2 AREA FOR INVENTORY PARAMETERS TABLE                    * 07320100
051705*---------------------------------------------------------------* 07320200
051705*    EXEC SQL                                                     07320300
051705*         INCLUDE TINVPAR                                         07320400
051705*    END-EXEC.                                                    07320500
      *---------------------------------------------------------------* 07320600
      *    DB2 AREA FOR TSKXREF (SKU CROSS REFERENCE TABLE)           * 07320700
      *---------------------------------------------------------------* 07320800
           EXEC SQL                                                     07320900
                INCLUDE TSKXREF                                         07321000
           END-EXEC.                                                    07321100
      *---------------------------------------------------------------* 07321200
100404*    DB2 AREA FOR XST_LOC TABLE                                 * 07321300
      *---------------------------------------------------------------* 07321400
           EXEC SQL                                                     07321500
100404          INCLUDE XST00001                                        07321600
           END-EXEC.                                                    07321700
      *---------------------------------------------------------------* 07321800
100404*    DB2 AREA FOR XST_SKU_LOC TABLE                             * 07321900
      *---------------------------------------------------------------* 07322000
           EXEC SQL                                                     07322100
100404          INCLUDE XST00008                                        07322200
           END-EXEC.                                                    07322300
      *---------------------------------------------------------------* 07322400
100404*    DB2 AREA FOR XST_SKU TABLE                                 * 07322500
      *---------------------------------------------------------------* 07322600
           EXEC SQL                                                     07322700
100404          INCLUDE XST00010                                        07322800
           END-EXEC.                                                    07322900
      *---------------------------------------------------------------* 07323000
100404*    DB2 AREA FOR XST_UPC TABLE                                 * 07323100
      *---------------------------------------------------------------* 07323200
           EXEC SQL                                                     07323300
100404          INCLUDE XST00012                                        07323400
           END-EXEC.                                                    07323500
      *---------------------------------------------------------------* 07323600
      *    DB2 AREA FOR COMMUNICATIONS                                * 07323700
      *---------------------------------------------------------------* 07323800
           EXEC SQL                                                     07323900
                INCLUDE SQLCA                                           07324000
           END-EXEC.                                                    07324100
                                                                        07324200
      *---------------------------------------------------------------* 07324300
      *    CURSOR TO GET TRANSFER ITEMS FOR A RETAIL TRANSFER.        * 07324400
      *---------------------------------------------------------------* 07324500
                                                                        07324600
           EXEC SQL                                                     07324700
                DECLARE RTL-ITEM-CSR CURSOR                             07324800
                FOR SELECT                                              07324900
                      A.XFER_LNE_NBR                                    07325000
                     ,A.CPLD_RTL_PRIC_AMT                               07330000
                     ,A.SCN_UPC_NBR                                     07340000
                     ,A.KOHLS_UPC_NBR                                   07340100
                     ,A.ITM_NBR                                         07340200
                     ,A.XFER_PRIC_AMT                                   07340300
                     ,A.XFER_QTY                                        07350000
                FROM  TTFITEM A                                         07370000
               WHERE  A.XFER_DKEY_ID   = :DK-XFER-DKEY-ID               07380000
                                                                        07381000
               ORDER BY  XFER_LNE_NBR                                   07390000
               WITH UR                                                  07391000
                                                                        07400000
           END-EXEC.                                                    07410000
                                                                        07420000
      *---------------------------------------------------------------* 07430000
      *    CURSOR TO GET TRANSFER ITEMS FOR A NON-RETAIL TRANSFER.    * 07440000
      *---------------------------------------------------------------* 07450000
                                                                        07460000
           EXEC SQL                                                     07470000
                DECLARE NRTL-ITEM-CSR CURSOR                            07480000
                FOR SELECT                                              07490000
                      XFER_LNE_NBR                                      07500000
                     ,NRTL_1ST_LNE_DESC                                 07510000
                     ,NRTL_2ND_LNE_DESC                                 07520000
                     ,NRTL_FIXT_ID                                      07530000
                     ,NRTL_DEPT_NBR                                     07540000
                     ,XFER_QTY                                          07550000
                FROM  TTFITEM                                           07560000
               WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID                 07570000
               ORDER BY  XFER_LNE_NBR                                   07580000
               WITH UR                                                  07581000
                                                                        07590000
           END-EXEC.                                                    07600000
       EJECT                                                            07610000
       LINKAGE SECTION.                                                 07620000
                                                                        07630000
       01  DFHCOMMAREA.                                                 07640000
           05  FILLER                         OCCURS  1 TO 4072 TIMES   07650000
                                              DEPENDING ON EIBCALEN.    07660000
               10  FILLER                     PIC X.                    07670000
                                                                        07680000
       EJECT                                                            07690000
       PROCEDURE DIVISION.                                              07700000
      ******************************************************************07710000
      **  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07720000
      **  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07730000
      **  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07740000
      ******************************************************************07750000
       0000-MAIN-MODULE.                                                07760000
           INITIALIZE DP030-CICS-API-FIELDS.                            07770000
           MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07780000
           SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07790000
           MOVE +2                       TO DP030-NUMBER-OF-MAPS.       07800000
           MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07810000
           PERFORM 0001-CALL-CICS-ARCH-API.                             07820000
      *                                                                 07830000
           MOVE 1                      TO PV-MAP-START-BYTE.            07840000
           MOVE LENGTH OF MR-A-HEADER  TO DP030-MAP-LENGTH (1).         07850000
           MOVE MD-MAP-DATA-AREA                                        07860000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (1))          07870000
                                       TO MR-A-HEADER.                  07880000
           ADD DP030-MAP-LENGTH (1)                                     07890000
                                       TO PV-MAP-START-BYTE.            07900000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         08520000
                   MOVE LENGTH OF MR-B-RTL-DETAIL                       08530000
                                       TO DP030-MAP-LENGTH (2)          08540000
                   MOVE MD-MAP-DATA-AREA                                08550000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          08560000
                                       TO MR-B-RTL-DETAIL               08570000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     08580000
           ELSE                                                         08590000
                   MOVE LENGTH OF MR-C-NRTL-DETAIL                      08600000
                                       TO DP030-MAP-LENGTH (2)          08610000
                   MOVE MD-MAP-DATA-AREA                                08620000
                      (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))          08630000
                                       TO MR-C-NRTL-DETAIL              08640000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     08650000
           END-IF.                                                      08660000
      *                                                                 08670000
           PERFORM 1000-CONTROL-PROCESSING                              08680000
      *                                                                 08690000
           MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08700000
           PERFORM 0001-CALL-CICS-ARCH-API.                             08710000
                                                                        08720000
      ******************************************************************08730000
      **  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08740000
      **  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08750000
      ******************************************************************08760000
       0001-CALL-CICS-ARCH-API.                                         08770000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08780099
                                          DFHCOMMAREA                   08790099
                                          DP030-CICS-API-FIELDS         08800099
                                          DP020-STANDARD-COMMAREA       08810099
                                          MD-MAP-DATA-AREA.             08820099
      *                                                                 08830000
           IF  DP030-RC-CALL-SUCCESSFUL                                 08840000
               CONTINUE                                                 08850000
           ELSE                                                         08860000
               SET DP013-NO-ROLLBACK                                    08870000
                   DP013-XCTL-DISPLAY-RESTART                           08880000
                   DP013-CICS-ABEND      TO TRUE                        08890000
               MOVE '0001-CALL-CICS-ARCH-API'                           08900000
                                         TO DP013-PARAGRAPH             08910000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08911099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08912099
               MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08940000
               PERFORM DP013-0000-PROCESS-ABEND                         08950000
           END-IF.                                                      08960000
      *----------------------------------------------------------------*08970000
      * PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08980000
      * COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08990000
      *----------------------------------------------------------------*09000000
                                                                        09010000
       1000-CONTROL-PROCESSING.                                         09020000
                                                                        09030000
           EVALUATE TRUE                                                09040000
               WHEN DP020-NEXT-ACT-INITIAL                              09050000
                   INITIALIZE ASC-SPECIFIC-COMMAREA                     09060000
                   SET ASC-NO-ERROR      TO TRUE                        13900000
                   PERFORM 1100-PROCESS-INTER-APPL-COMM                 13900100
      ***-----$TEMPLATE NOTE$-------------------------------------------13900200
      *** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,13900300
      *** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  13900400
      *** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.13900500
      ***---------------------------------------------------------------13900600
                   IF  PS-COMMAREA-NOT-VALID                            13900700
      ***              MOVE PC-TSYMSG-99901                             13900800
      ***                                TO DP020-MSG-NUMBER            13900900
      ***              SET DP020-MSG-FATAL                              13901000
      ***                                TO TRUE                        13901100
                       SET DP020-NEXT-ACT-APPL-ERROR                    13901200
                                         TO TRUE                        13901300
                   ELSE                                                 13901400
                       PERFORM 4000-BUILD-INITIAL-PANEL                 13901500
                   END-IF                                               13901600
                                                                        13901700
               WHEN DP020-NEXT-ACT-READ-MAP                             13901800
                   SET ASC-NO-ERROR      TO TRUE                        13901900
                   PERFORM 2000-PROCESS-PANEL                           13902000
                                                                        13902100
               WHEN DP020-NEXT-ACT-RETURN                               13902200
                   IF ASC-PRINT-LIST-REQUEST        AND                 13902300
                         TF001-PRINT-YES            AND                 13902400
                         TF001-PRINTER-DEST NOT = SPACES                13902500
                       PERFORM 6500-PRINT-LIST                          13902600
                       MOVE PC-TSYMSG-00098                             13902700
                                         TO DP020-MSG-NUMBER            13902800
                       SET DP020-MSG-INFORMATIONAL  TO TRUE             13902900
                   ELSE                                                 13903000
                       IF ASC-PRINT-DOC-REQUEST     AND                 13904000
                             TF001-PRINT-DOC                            13905000
                           IF ASC-DO-NOT-SHIP                           13905100
                               MOVE PC-TSYMSG-01680 TO DP020-MSG-NUMBER 13905200
                           ELSE                                         13905300
                               MOVE PC-TSYMSG-01495 TO DP020-MSG-NUMBER 13905400
                           END-IF                                       13905500
                           MOVE ASC-FR-STORE-NBR TO                     28400400
                                                 PV-DISP-FROM-STORE-NBR 28400500
                           MOVE ASC-XFER-SEQ-NBR TO PV-DISP-SEQ-NBR     28400600
                           MOVE PV-DISP-XFER-NBR TO DP020-MSG-TEXT      28401000
                           SET DP020-MSG-INFORMATIONAL TO TRUE          28401100
                           MOVE +1                  TO ASC-BLK-SUB      28401200
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         28401300
                       END-IF                                           28401400
                   END-IF                                               28401500
                   SET ASC-NO-COMPLETE-REQUEST                          28401600
                       ASC-NO-PRINT-REQUEST    TO TRUE                  28401700
                   MOVE +1                  TO ASC-BLK-SUB              28401800
                   SET ASC-NO-ERROR      TO TRUE                        28401900
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28402000
                                                                        28402100
               WHEN OTHER                                               28402200
                   SET DP013-LOGIC-ABEND TO TRUE                        28402300
                   SET DP013-NO-ROLLBACK TO TRUE                        28402400
                   MOVE '1000-CONTROL-PROCESSING'                       28402500
                                         TO DP013-PARAGRAPH             28402600
                   MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    28402700
                                         TO DP013-MESSAGE-TEXT(1)       28402800
                   PERFORM DP013-0000-PROCESS-ABEND                     28402900
           END-EVALUATE.                                                28403000
                                                                        28403100
       EJECT                                                            28403200
      *----------------------------------------------------------------*28403300
      * DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA FROM  *28403400
      * THE WORKSHEET SETUP PROGRAM OR FROM THE CRITERIA SPEC.         *28403500
      *----------------------------------------------------------------*28403600
                                                                        28403700
       1100-PROCESS-INTER-APPL-COMM.                                    28403800
                                                                        28403900
           SET PS-COMMAREA-VALID         TO TRUE.                       28404000
           MOVE TF001-DKEY-ID            TO DK-XFER-DKEY-ID             28404100
                                            ASC-XFER-DKEY-ID            28404200
                                            ASC-CONTROL-NBR.            28404300
           MOVE TF001-XFER-FROM-STR      TO ASC-FR-STORE-NBR-N.         28404400
           MOVE +0                       TO ASC-NBR-OF-LINES-ENTERED.   28404500
           PERFORM 6000-GET-CONTROL-INFO.                               28404600
                                                                        28404700
       EJECT                                                            28404800
      *----------------------------------------------------------------*28404900
      * DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *28405000
      * ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *28405100
      * USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *28405200
      * OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *28405300
      * FUNCTION KEYS CAN GET THIS FAR.                                *28405400
      *----------------------------------------------------------------*28405500
                                                                        28405600
       2000-PROCESS-PANEL.                                              28405700
           IF ASC-XFER-IS-NOT-COMPLETE                                  28405800
             EVALUATE TRUE                                              28405900
               WHEN DP020-SRC-AID = DP016-ENTER                         28406000
               WHEN DP020-SRC-AID = DP016-CLEAR                         28406100
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    28406200
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  28406300
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28406400
                                                                        28406500
      *---  CTL MNT  -----------------------------------------------*   28406600
               WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              28406700
                   INITIALIZE TF001-INTER-APPL-COMMAREA                 28406800
                   MOVE ASC-CONTROL-NBR    TO TF001-DKEY-ID             28406900
                   MOVE ASC-FR-STORE-NBR-N TO TF001-XFER-FROM-STR       28407000
                                                                        28407100
      *---  PRINT WKST  --------------------------------------------*   28407200
               WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              28407300
                   MOVE +1                    TO ASC-BLK-SUB            28407400
                   SET ASC-PRINT-LIST-REQUEST TO TRUE                   28407500
                   INITIALIZE TF001-DRS-DATA                            28407600
080204             MOVE ASC-FR-STORE-NBR      TO RFWS009-STORE-NBR      28407700
080204             MOVE RFWS009-STORE-PRINTER-DEST                      28407900
080204                                        TO TF001-PRINTER-DEST     28408000
                                                                        28408100
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  28408200
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  28408300
                   MOVE +1           TO ASC-BLK-SUB                     28408400
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28408500
                                                                        28408600
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   28408700
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  28408800
                   IF ASC-BLK-SUB = +1                                  28408900
                       MOVE PC-TSYMSG-00069                             28409000
                                         TO DP020-MSG-NUMBER            28409100
                       SET DP020-MSG-INFORMATIONAL                      28409200
                                         TO TRUE                        28409300
                   ELSE                                                 28409400
                       MOVE +1           TO ASC-BLK-SUB                 28409500
                   END-IF                                               28409600
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28409700
                                                                        28409800
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   28409900
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  28410000
                   IF ASC-BLK-SUB = +2                                  28410100
                       MOVE PC-TSYMSG-00070                             28410200
                                         TO DP020-MSG-NUMBER            28410300
                       SET DP020-MSG-INFORMATIONAL                      28410400
                                         TO TRUE                        28410500
                   ELSE                                                 28410600
                       MOVE +2           TO ASC-BLK-SUB                 28410700
                   END-IF                                               28410800
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28410900
                                                                        28411000
               WHEN OTHER                                               28411100
                   IF  ASC-NO-ERROR                                     28411200
                       SET DP030-CONTINUE-GO                            28411300
                                       TO TRUE                          28411400
                       PERFORM 2100-CHECK-FUNCTION-KEY                  28411500
                   ELSE                                                 28411600
                       SET DP030-OVERRIDE-GO                            28411700
                                       TO TRUE                          28411800
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             28411900
                   END-IF                                               28412000
             END-EVALUATE                                               28412100
           ELSE                                                         28412200
             EVALUATE TRUE                                              28412300
               WHEN DP020-SRC-AID = DP016-ENTER                         28412400
               WHEN DP020-SRC-AID = DP016-CLEAR                         28412500
               WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    28412600
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28412700
                                                                        28412800
               WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  28412900
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  28413000
                   MOVE +1           TO ASC-BLK-SUB                     28413100
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28413200
                                                                        28413300
               WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   28413400
                   SET ASC-NO-COMPLETE-REQUEST TO TRUE                  28413500
                   IF ASC-BLK-SUB = +1                                  28413600
                       MOVE PC-TSYMSG-00069                             28413700
                                         TO DP020-MSG-NUMBER            28413800
                       SET DP020-MSG-INFORMATIONAL                      28413900
                                         TO TRUE                        28414000
                   ELSE                                                 28414100
                       MOVE +1           TO ASC-BLK-SUB                 28414200
                   END-IF                                               28414300
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28414400
                                                                        28414500
               WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   28414600
                   IF ASC-BLK-SUB = +2                                  28414700
                       MOVE PC-TSYMSG-00070                             28414800
                                         TO DP020-MSG-NUMBER            28414900
                       SET DP020-MSG-INFORMATIONAL                      28415000
                                         TO TRUE                        28415100
                   ELSE                                                 28415200
                       MOVE +2           TO ASC-BLK-SUB                 28415300
                   END-IF                                               28415400
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28415500
                                                                        28415600
               WHEN OTHER                                               28415700
                   MOVE PC-TSYMSG-01487       TO DP020-MSG-NUMBER       28415800
                   MOVE ASC-FR-STORE-NBR      TO PV-DISP-FROM-STORE-NBR 28415900
                   MOVE ASC-XFER-SEQ-NBR      TO PV-DISP-SEQ-NBR        28416000
                   MOVE PV-DISP-XFER-NBR      TO DP020-MSG-TEXT         28416100
                   SET DP020-MSG-FATAL                                  28416200
                       DP030-OVERRIDE-GO      TO TRUE                   28416300
                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 28416400
                                                                        28416500
             END-EVALUATE                                               28416600
           END-IF.                                                      28416700
       EJECT                                                            28416800
      *----------------------------------------------------------------*28416900
      * ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*28417000
      * NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *28417100
      * CICS ARCHITECTURE API.                                         *28417200
      *----------------------------------------------------------------*28417300
       2100-CHECK-FUNCTION-KEY.                                         28417400
           EVALUATE TRUE                                                28417500
                                                                        28417600
      *---  COMPLETE  ----------------------------------------------*   28417700
               WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              28417800
                   PERFORM 3000-EDIT-DATA-IN-COMMAREA                   28417900
                   MOVE +1           TO ASC-BLK-SUB                     28418000
                   IF ASC-ERROR                                         28418100
                       SET ASC-DISCREPANCY-EXISTS  TO TRUE              28418200
                   END-IF                                               28418300
                   IF ASC-DISCREPANCY-EXISTS                            28418400
                       SET ASC-NO-COMPLETE-REQUEST TO TRUE              28418500
                       MOVE PC-TSYMSG-01488       TO DP020-MSG-NUMBER   28418600
                       SET DP020-MSG-FATAL                              28418700
                           DP030-OVERRIDE-GO      TO TRUE               28418800
                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             28418900
                   ELSE                                                 28419000
                       IF ASC-NBR-OF-LINES-ENTERED = 0                  28419100
                           SET ASC-NO-COMPLETE-REQUEST TO TRUE          28419200
                           MOVE PC-TSYMSG-01483    TO DP020-MSG-NUMBER  28419300
                           SET DP020-MSG-FATAL                          28419400
                                DP030-OVERRIDE-GO  TO TRUE              28419500
                           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         28419600
                       ELSE                                             28419700
                           IF ASC-COMPLETE-REQUEST                      28419800
                               PERFORM 7000-COMPLETE-TRANSFER           28419900
                               SET ASC-NO-COMPLETE-REQUEST TO TRUE      28420000
                               INITIALIZE TF001-INTER-APPL-COMMAREA     28420100
                               MOVE ASC-FR-STORE-NBR                    28420200
                                                  TO RFWS009-STORE-NBR  28420300
                                                     PV-FROM-STORE-NBR  28420400
                               MOVE PV-XFER-NBR   TO TF001-XFER-NBR     28420500
                               MOVE RFWS009-STORE-PRINTER-DEST          28420600
                                                  TO TF001-PRINTER-DEST 28420700
                               SET ASC-XFER-IS-COMPLETE    TO TRUE      28420800
                           ELSE                                         28420900
                               SET ASC-COMPLETE-REQUEST                 28421000
                                   ASC-PRINT-DOC-REQUEST  TO TRUE       28421100
                               MOVE PC-TSYMSG-01403 TO DP020-MSG-NUMBER 28421200
                               MOVE 'F23-COMPLETE'   TO DP020-MSG-TEXT  28421300
                               SET DP020-MSG-INFORMATIONAL              28421400
                                   DP030-OVERRIDE-GO      TO TRUE       28421500
                               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     28421600
                           END-IF                                       28421700
                       END-IF                                           28421800
                   END-IF                                               28421900
                                                                        28422000
               WHEN OTHER                                               28422100
                   SET DP013-NO-ROLLBACK                                28422200
                       DP013-XCTL-DISPLAY-RESTART                       28422300
                       DP013-CICS-ABEND  TO TRUE                        28422400
                   MOVE '2100-CHECK-FUNCTION-KEY'                       28422500
                                         TO DP013-PARAGRAPH             28422600
                   MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      28422700
                                         TO DP013-MESSAGE-TEXT (1)      28422800
                   PERFORM DP013-0000-PROCESS-ABEND                     28422900
           END-EVALUATE.                                                28423000
      *                                                                 28423100
       EJECT                                                            28423200
      ******************************************************************28423300
      ** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **28423400
      ** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **28423500
      ******************************************************************28423600
       3000-EDIT-DATA-IN-COMMAREA.                                      28423700
051705     SET ASC-OK-TO-SHIP            TO TRUE.                       28423800
           SET ASC-NO-ERROR              TO TRUE.                       28423900
           PERFORM 3300-EDIT-HEADER-INFO.                               28424000
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         28424100
               PERFORM 3400-EDIT-RTL-DETAIL-INFO                        28425000
                 VARYING ASC-BLK-SUB                                    38341100
                   FROM 1 BY 1 UNTIL                                    38341200
                         ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY           38341300
                 AFTER ASC-ITEM-SUB                                     38341400
                   FROM 1 BY 1                                          38341500
                   UNTIL ASC-ITEM-SUB >  PC-ITEMS-PER-RTL-PANEL         38341600
           ELSE                                                         38341700
               PERFORM 3450-EDIT-NRTL-DETAIL-INFO                       38341800
                 VARYING ASC-BLK-SUB                                    38341900
                   FROM 1 BY 1 UNTIL                                    38342000
                         ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY           38342100
                 AFTER ASC-ITEM-SUB                                     38342200
                   FROM 1 BY 1                                          38342300
                   UNTIL ASC-ITEM-SUB >  PC-ITEMS-PER-NRTL-PANEL        38342400
           END-IF.                                                      38342500
051705******************************************************************38342600
051705** IF NO OTHER EDIT ERRORS, CHECK INVENTORY DATE.               **38342700
051705******************************************************************38342800
051705*    IF ASC-NO-ERROR                                       AND    38342900
051705*       ASC-XFER-TYPE                NOT = PC-NON-RETAIL   AND    38343000
051705*       ASC-XFER-TYPE                NOT = PC-OFFSITE-STORAGE     38343100
051705*        PERFORM 3380-GET-CUR-DATE                                38343200
051705*        PERFORM 4520-READ-CONTROL-TABLE                          38343300
051705*        IF PV-PHY-INV-PERD-IND = PC-YES                          38343400
051705*            PERFORM 4530-CHECK-INVENTORY                         38343500
051705*        END-IF                                                   38343600
051705*    END-IF.                                                      38343700
051705*EJECT                                                            38343800
      ******************************************************************38343900
      ** EDIT THE HEADING INFORMATION.                                **38344000
      ******************************************************************38344100
       3300-EDIT-HEADER-INFO.                                           38344200
           IF ASC-TO-STORE-NBR NOT > SPACES                             38344300
               IF ASC-NO-ERROR                                          38344400
                   SET ASC-ERROR          TO TRUE                       38344500
               END-IF                                                   38344600
           ELSE                                                         38344700
               IF ASC-TO-STORE-NBR = ASC-FR-STORE-NBR                   38344800
                   IF ASC-NO-ERROR                                      38344900
                      SET  ASC-ERROR          TO TRUE                   38345000
                   END-IF                                               38345100
               ELSE                                                     38345200
                   MOVE ASC-TO-STORE-NBR-N    TO DK-STORE-NBR           38345300
                   SET PS-STORE-NOT-FOUND     TO TRUE                   38345400
                   PERFORM 4500-READ-STORE                              38345500
                   IF PS-STORE-NOT-FOUND                                38345600
                       IF ASC-NO-ERROR                                  38345700
                           SET ASC-ERROR          TO TRUE               38345800
                       END-IF                                           38345900
                   ELSE                                                 38346000
                     EVALUATE ASC-XFER-TYPE                             38346100
111703*                WHEN PC-DEFECTIVE-DAMAGE                         38346200
111703                 WHEN PC-DEFECTIVE-DAMAGE-SORT1                   38346300
111703                 WHEN PC-DEFECTIVE-DAMAGE-SORT2                   38346400
                       WHEN PC-CALLBACK                                 38346500
                         IF ASC-TO-STORE-TYPE NOT = PC-RTV-TYPE         38346600
                           IF ASC-NO-ERROR                              38346700
                               SET ASC-ERROR          TO TRUE           38346800
                           END-IF                                       38346900
                         END-IF                                         38347000
                       WHEN PC-NON-RETAIL                               38347100
                         IF ASC-TO-STORE-TYPE NOT = PC-STORE-TYPE AND   38347200
                            ASC-TO-STORE-TYPE NOT = PC-DC               38347300
                           IF ASC-NO-ERROR                              38347400
                               SET ASC-ERROR          TO TRUE           38347500
                           END-IF                                       38347600
                         END-IF                                         38347700
                       WHEN OTHER                                       38347800
                         IF ASC-TO-STORE-TYPE NOT = PC-STORE-TYPE       38347900
                           IF ASC-NO-ERROR                              38348000
                               SET ASC-ERROR          TO TRUE           38348100
                           END-IF                                       38348200
                         END-IF                                         38348300
                     END-EVALUATE                                       38348400
                   END-IF                                               38348500
               END-IF                                                   38348600
           END-IF.                                                      38348700
           EVALUATE ASC-XFER-TYPE                                       38348800
111703*        WHEN PC-DEFECTIVE-DAMAGE                                 38348900
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           38349000
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           38349100
               WHEN PC-STOCK-BAL-STORE                                  38349200
                   PERFORM 3310-EDIT-DEF-DAMAGE                         38349300
               WHEN PC-CALLBACK                                         38349400
                   PERFORM 3320-EDIT-CALLBACK                           38349500
               WHEN PC-STOCK-BAL-CORP                                   38349600
                   PERFORM 3330-EDIT-STOCK-BAL-CORP                     38349700
               WHEN PC-CUSTOMER                                         38349800
                   PERFORM 3340-EDIT-CUSTOMER                           38349900
               WHEN PC-NON-RETAIL                                       38350000
                   PERFORM 3350-EDIT-NON-RETAIL                         38350100
           END-EVALUATE.                                                38350200
           EVALUATE ASC-CONTNR-TYPE                                     38350300
               WHEN PC-TRAILER                                          38350400
                   PERFORM 3360-EDIT-TRAILER                            38350500
               WHEN PC-SECURE-TOTE                                      38350600
                   PERFORM 3370-EDIT-TOTE                               38350700
           END-EVALUATE.                                                38350800
                                                                        38350900
      ******************************************************************38351000
      ** EDIT THE HEADING INFO FOR DEFECTIVE/DAMAGE OR STOCK BAL-STORE *38351100
      ******************************************************************38351200
       3310-EDIT-DEF-DAMAGE.                                            38351300
           IF ASC-COMP-BY-INT NOT > SPACES                              38351400
               IF ASC-NO-ERROR                                          38351500
                   SET ASC-ERROR          TO TRUE                       38351600
               END-IF                                                   38351700
           END-IF                                                       38351800
           IF ASC-COMP-BY-NAM NOT > SPACES                              38351900
               IF ASC-NO-ERROR                                          38352000
                   SET ASC-ERROR          TO TRUE                       38352100
               END-IF                                                   38352200
           END-IF.                                                      38352300
      ******************************************************************38352400
      ** EDIT THE HEADING INFO FOR CALLBACK TRANSFERS.                **38352500
      ******************************************************************38352600
       3320-EDIT-CALLBACK.                                              38352700
           IF ASC-COMP-BY-INT NOT > SPACES                              38352800
               IF ASC-NO-ERROR                                          38352900
                   SET ASC-ERROR          TO TRUE                       38353000
               END-IF                                                   38353100
           END-IF                                                       38353200
           IF ASC-COMP-BY-NAM NOT > SPACES                              38353300
               IF ASC-NO-ERROR                                          38353400
                   SET ASC-ERROR          TO TRUE                       38353500
               END-IF                                                   38353600
           END-IF                                                       38353700
           IF ASC-CALLBACK-NBR NOT > ZEROES                             38353800
               IF ASC-NO-ERROR                                          38353900
                   SET ASC-ERROR          TO TRUE                       38354000
               END-IF                                                   38354100
           END-IF.                                                      38354200
      ******************************************************************38354300
      ** EDIT THE HEADING INFO FOR STOCK BALANCE - CORP TRANSFERS.    **38354400
      ******************************************************************38354500
       3330-EDIT-STOCK-BAL-CORP.                                        38354600
           IF ASC-COMP-BY-INT NOT > SPACES                              38354700
               IF ASC-NO-ERROR                                          38354800
                   SET ASC-ERROR          TO TRUE                       38354900
               END-IF                                                   38355000
           END-IF                                                       38355100
           IF ASC-COMP-BY-NAM NOT > SPACES                              38355200
               IF ASC-NO-ERROR                                          38355300
                   SET ASC-ERROR          TO TRUE                       38355400
               END-IF                                                   38355500
           END-IF                                                       38355600
           IF ASC-APPROVAL-NBR NOT > ZEROES                             38355700
               IF ASC-NO-ERROR                                          38355800
                   SET ASC-ERROR          TO TRUE                       38355900
               END-IF                                                   38356000
           END-IF.                                                      38356100
      ******************************************************************38356200
      ** EDIT THE HEADING INFO FOR CUSTOMER TRANSFERS.                **38356300
      ******************************************************************38356400
       3340-EDIT-CUSTOMER.                                              38356500
           IF ASC-COMP-BY-INT NOT > SPACES                              38356600
               IF ASC-NO-ERROR                                          38356700
                   SET ASC-ERROR          TO TRUE                       38356800
               END-IF                                                   38356900
           END-IF                                                       38357000
           IF ASC-COMP-BY-NAM NOT > SPACES                              38357100
               IF ASC-NO-ERROR                                          38357200
                   SET ASC-ERROR          TO TRUE                       38357300
               END-IF                                                   38357400
           END-IF                                                       38357500
           IF ASC-REQ-BY-INT NOT > SPACES                               38357600
               IF ASC-NO-ERROR                                          38357700
                   SET ASC-ERROR          TO TRUE                       38357800
               END-IF                                                   38357900
           END-IF                                                       38358000
           IF ASC-REQ-BY-NAM NOT > SPACES                               38358100
               IF ASC-NO-ERROR                                          38358200
                   SET ASC-ERROR          TO TRUE                       38358300
               END-IF                                                   38358400
           END-IF                                                       38358500
           IF ASC-CUST-NAME NOT > SPACES                                38358600
               IF ASC-NO-ERROR                                          38358700
                   SET ASC-ERROR          TO TRUE                       38358800
               END-IF                                                   38358900
           END-IF.                                                      38359000
           IF ASC-PHONE NOT > SPACES                                    38359100
               IF ASC-NO-ERROR                                          38359200
                   SET ASC-ERROR          TO TRUE                       38359300
               END-IF                                                   38359400
           END-IF.                                                      38359500
      ******************************************************************38359600
      ** EDIT THE HEADING INFO FOR NON-RETAIL TRANSFERS.              **38359700
      ******************************************************************38359800
       3350-EDIT-NON-RETAIL.                                            38359900
           IF ASC-COMP-BY-INT NOT > SPACES                              38360000
               IF ASC-NO-ERROR                                          38360100
                   SET ASC-ERROR          TO TRUE                       38360200
               END-IF                                                   38360300
           END-IF                                                       38360400
           IF ASC-COMP-BY-NAM NOT > SPACES                              38360500
               IF ASC-NO-ERROR                                          38360600
                   SET ASC-ERROR          TO TRUE                       38360700
               END-IF                                                   38360800
           END-IF                                                       38360900
           IF ASC-REQ-BY-INT NOT > SPACES                               38361000
               IF ASC-NO-ERROR                                          38361100
                   SET ASC-ERROR          TO TRUE                       38361200
               END-IF                                                   38361300
           END-IF                                                       38361400
           IF ASC-REQ-BY-NAM NOT > SPACES                               38361500
               IF ASC-NO-ERROR                                          38361600
                   SET ASC-ERROR          TO TRUE                       38361700
               END-IF                                                   38361800
           END-IF.                                                      38361900
      ******************************************************************38362000
      ** EDIT THE TRAILER INFORMATION.                                **38362100
      ******************************************************************38362200
       3360-EDIT-TRAILER.                                               38362300
           IF ASC-TRAILER-SEAL NOT > SPACES                             38362400
               IF ASC-NO-ERROR                                          38362500
                   SET ASC-ERROR          TO TRUE                       38362600
               END-IF                                                   38362700
           END-IF.                                                      38362800
           IF ASC-TRAILER-NBR NOT > SPACES                              38362900
               IF ASC-NO-ERROR                                          38363000
                   SET ASC-ERROR          TO TRUE                       38363100
               END-IF                                                   38363200
           END-IF.                                                      38363300
      ******************************************************************38363400
      ** EDIT THE TOTE INFORMATION - ONLY REQUIRED FOR SECURE TOTES.  **38363500
      ******************************************************************38363600
       3370-EDIT-TOTE.                                                  38363700
           IF ASC-LG-TOTE-SEAL1 NOT > SPACES                            38363800
               IF ASC-NO-ERROR                                          38363900
                   SET ASC-ERROR          TO TRUE                       38364000
               END-IF                                                   38364100
           END-IF.                                                      38364200
           IF ASC-LG-TOTE-SEAL2 NOT > SPACES                            38364300
               IF ASC-NO-ERROR                                          38364400
                   SET ASC-ERROR          TO TRUE                       38364500
               END-IF                                                   38364600
           END-IF.                                                      38364700
051705*3380-GET-CUR-DATE.                                               38364800
051705*    EXEC CICS                                                    38364900
051705*        ASKTIME ABSTIME (PV-ABSTIME)                             38365000
051705*    END-EXEC.                                                    38365100
051705*                                                                 38365200
051705*    EXEC CICS                                                    38365300
051705*        FORMATTIME ABSTIME  (PV-ABSTIME)                         38365400
051705*                   MMDDYY   (SD-MMDDYY-FORMAT)                   38366000
051705*                   DATESEP                                       38367000
051705*    END-EXEC.                                                    38368000
051705*                                                                 38369000
051705*    MOVE SD-SYSTEM-MONTH           TO  PV-CURRENT-MONTH.         38370000
051705*    MOVE SD-SYSTEM-DAY             TO  PV-CURRENT-DAY.           38380000
051705*    MOVE SD-SYSTEM-YEAR            TO  PV-CURRENT-YEAR.          38390000
051705*    INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              38400000
051705*                                                                 38410000
051705*    MOVE PV-CURRENT-DATE              TO  DPG51-SYSTEM-DATE.     38420000
051705*    SET  DPG51-ACTUAL-CALENDAR-ONLY                              38430000
051705*         DPG51-DO-NOT-INCR-DECR-DATE                             38440000
051705*         DPG52-LK-DTE-GREG          TO TRUE.                     38450000
051705*                                                                 38460000
051705*    MOVE PV-CURRENT-MONTH           TO  PV-GD-MONTH.             38470000
051705*    MOVE PV-CURRENT-DAY             TO  PV-GD-DAY.               38480000
051705*    MOVE PV-CURRENT-YEAR            TO  PV-GD-YEAR.              38490000
051705*    MOVE PV-GREGORIAN-DATE          TO  DPG52-LK-DATE-INPUT.     38500000
051705*                                                                 38510000
051705*    CALL DP500-KOHLS-CALENDAR-ROUTINE                            38520000
051705*        USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               38530000
051705*                                                                 38540000
051705*    EVALUATE TRUE                                                38550000
051705*        WHEN DPG54-DATE-VALID                                    38560000
051705*            MOVE DPG55-DB2-ISO-DATE-FMT TO PV-CURRENT-ISO-DATE   38570000
051705*        WHEN OTHER                                               38580000
051705*            MOVE '3380-GET-CUR-DATE'  TO DP013-PARAGRAPH         38590000
051705*            MOVE 'GET THE CURRENT DATE'                          38600000
051705*                                      TO DP013-MESSAGE-TEXT (1)  38610000
051705*            MOVE DPG54-ERROR-MESSAGE  TO DP013-MESSAGE-TEXT (2)  38620000
051705*            SET DP013-OTHER-ABEND     TO TRUE                    38620100
051705*            PERFORM DP013-0000-PROCESS-ABEND                     38620200
051705*    END-EVALUATE.                                                38620300
      ******************************************************************38620400
      ** EDIT THE RETAIL TRANSFER DETAIL INFORMATION.                 **38620500
      ******************************************************************38620600
       3400-EDIT-RTL-DETAIL-INFO.                                       38620700
           SET PS-INVALID-UPC                                           38621000
               PS-INVALID-DEPT-CL  TO TRUE                              38622000
           IF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES               38623300
               IF ASC-UPC-DIGITS (ASC-BLK-SUB ASC-ITEM-SUB) = '0400'    38623400
                  AND ASC-DUMMY-000 (ASC-BLK-SUB ASC-ITEM-SUB)          38623500
                                                    = PC-ZERO-SKU       38623600
                   MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) TO           38623700
                        ASC-KOHLS-UPC (ASC-BLK-SUB ASC-ITEM-SUB)        38623800
                        PV-HOLD-UPC-NBR                                 38623900
                   MOVE ZEROS TO ASC-ITEM-NBR                           38624000
                                      (ASC-BLK-SUB ASC-ITEM-SUB)        38624100
                   PERFORM 3905-VALIDATE-UPC-DEPT-CLASS                 38624200
                   IF PS-INVALID-DEPT-CL                                38624300
                       IF ASC-NO-ERROR                                  38624400
                           SET ASC-ERROR          TO TRUE               38624500
                       END-IF                                           38624600
                   END-IF                                               38624700
               ELSE                                                     38624800
                   MOVE ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB)              38625000
                                            TO DK-UPC-NBR               38625100
                   PERFORM 3700-SELECT-UPC-NBR                          38625200
                   IF PS-INVALID-UPC                                    38625300
                       IF ASC-NO-ERROR                                  38625400
                           SET ASC-ERROR        TO TRUE                 38625500
                       END-IF                                           38625600
                   END-IF                                               38625700
               END-IF                                                   38625800
           END-IF.                                                      38625900
                                                                        38626000
      *- IF A QTY OR PRICE IS ENTERED, THEN A UPC MUST BE ENTERED       38626100
           IF (ASC-RTL-QTY      (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  OR 38626200
               ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)           38626300
               IF (ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) = ZEROES)         38626400
      *            -- MUST ENTER UPC --                                 38626500
                   IF ASC-NO-ERROR                                      38626600
                       SET ASC-ERROR          TO TRUE                   38626700
                   END-IF                                               38626800
              END-IF                                                    38626900
           END-IF.                                                      38627000
           IF ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES             38627100
               IF (PS-VALID-UPC)                                        38627200
                   PERFORM 4600-VALIDATE-PRICE                          38627300
               END-IF                                                   38627400
           ELSE                                                         38627500
      *- IF UPC OR QTY WAS ENTERED, PRICE IS REQUIRED                   38627600
               IF (ASC-UPC   (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  OR    38627700
                   ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)     38627800
      *            -- REQUIRED FIELD --                                 38627900
                   IF ASC-NO-ERROR                                      38628000
                       SET ASC-ERROR          TO TRUE                   38628100
                   END-IF                                               38628200
               END-IF                                                   38628300
           END-IF.                                                      38628400
           IF ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) NOT > ZEROES       38628500
               IF (ASC-UPC   (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  OR    38628600
                   ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)       38628700
      *            -- REQUIRED FIELD --                                 38628800
                   IF ASC-NO-ERROR                                      38628900
                       SET ASC-ERROR          TO TRUE                   38629000
                   END-IF                                               38629100
               END-IF                                                   38629200
           END-IF.                                                      38629300
      ******************************************************************38629400
      ** EDIT THE NON-RETAIL TRANSFER DETAIL INFORMATION.             **38629500
      ******************************************************************38629600
       3450-EDIT-NRTL-DETAIL-INFO.                                      38629700
      *- IF DEPT OR QTY OR FIXTURE WAS ENTERED, DESCRIPTION IS REQUIRED 38629800
           IF (ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR     38629900
               ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES  OR     38630000
               ASC-FIXTURE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)         38630100
               IF ASC-ITEM-DESC (ASC-BLK-SUB ASC-ITEM-SUB) NOT > SPACES 38630200
      *            -- REQUIRED FIELD --                                 38630300
                   IF ASC-NO-ERROR                                      38630400
                       SET ASC-ERROR          TO TRUE                   38630500
                   END-IF                                               38630600
               END-IF                                                   38630700
           END-IF.                                                      38630800
           IF ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) NOT > ZEROES      38630900
      *- IF DEPT OR DESCRIPTION OR FIXTURE WAS ENTERED, QTY IS REQUIRED 38631000
               IF (ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR 38631100
                   ASC-ITEM-DESC (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES OR 38631200
                   ASC-FIXTURE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES)     38631300
      *            -- REQUIRED FIELD --                                 38631400
                   IF ASC-NO-ERROR                                      38631500
                       SET ASC-ERROR          TO TRUE                   38631600
                   END-IF                                               38631700
               END-IF                                                   38631800
           END-IF.                                                      38631900
                                                                        41580100
       EJECT                                                            41580200
      *----------------------------------------------------------------*41580300
      *    READ XST_UPC AND XST_SKU_LOC USING THE ENTERED UPC NUMBER   *41580400
      *----------------------------------------------------------------*41580600
       3700-SELECT-UPC-NBR.                                             41580700
100404     INITIALIZE DCLXST00008                                       41580800
100404                DCLXST00010.                                      41580900
                                                                        41581000
           PERFORM                                                      41581200
             WITH TEST AFTER                                            41581300
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41581400
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41581500
                    OR SQLCODE = ZERO                                   41581600
                    OR SQLCODE = +100                                   41581700
               EXEC SQL                                                 41581800
100404             SELECT B.UNT_RTL_AMT                                 41581900
100404                   ,B.UPC_STAT_CHG_DTE                            41582000
100404                   ,B.UNT_RTL_CHG_DTE                             41582100
100404                   ,B.LOC_SKU_STAT_CDE                            41583000
100404                   ,C.ITM_NBR                                     41584000
100404                   ,B.GP_RTL_AMT                                  41584100
100404                   ,B.GP_RTL_QTY                                  41584200
100404                   ,D.REGN_PRIC_IND                               41584300
100404                   ,B.INTR_UPC_ID                                 41584400
100404               INTO :XST00008-UNT-RTL-AMT                         41584500
100404                   ,:PV-NREGN-UPC-STAT-CHG-DTE                    41584600
100404                   ,:PV-NREGN-UNT-RTL-CHG-DTE                     41584700
100404                   ,:PV-NREGN-LOC-SKU-STAT-CDE                    41584800
100404                   ,:SKXREF-ITM-NBR                               41584900
100404                   ,:XST00008-GP-RTL-AMT                          41585000
100404                    :PV-GP-RTL-AMT-NULL-IND                       41585100
100404                   ,:XST00008-GP-RTL-QTY                          41585200
100404                    :PV-GP-RTL-QTY-NULL-IND                       41585300
100404                   ,:XST00010-REGN-PRIC-IND                       41585400
100404                   ,:XST00008-INTR-UPC-ID                         41585500
100404                FROM XST_UPC     A                                41585600
100404                    ,XST_SKU_LOC B                                41585700
100404                    ,TSKXREF     C                                41585800
100404                    ,XST_SKU     D                                41585900
100404          WHERE  (A.UPC_NBR               =  :DK-UPC-NBR   AND    41586000
100404                  A.LAST_ACTN_CDE        IN ('A', 'U')     AND    41586100
100404                  A.INTR_UPC_ID           = B.INTR_UPC_ID  AND    41586200
100404                  B.LOC_NBR               = 0              AND    41586300
100404                  B.END_TMST             IS NULL           AND    41586400
100404                  B.LOC_SKU_STAT_CDE NOT IN ('98')         AND    41586500
100404                  B.INTR_UPC_ID           = C.INTR_UPC_ID  AND    41586600
100404                  C.SKU_STAT_CDE     NOT IN ('98')         AND    41586700
100404                  A.INTR_UPC_ID           = D.INTR_UPC_ID)        41586800
               END-EXEC                                                 41586900
                                                                        41587000
               EVALUATE TRUE                                            41587100
                   WHEN SQLCODE = ZERO                                  41587200
                       SET PS-VALID-UPC          TO TRUE                41587300
100404                 MOVE SKXREF-ITM-NBR       TO ASC-ITEM-NBR        41587400
                                        (ASC-BLK-SUB ASC-ITEM-SUB)      41588000
100404                 MOVE XST00008-UNT-RTL-AMT  TO PV-CUR-RTL-AMT     41588100
100404                 IF PV-GP-RTL-QTY-NULL-IND < 0                    41588200
100404                     MOVE ZEROS TO XST00008-GP-RTL-QTY            41588300
100404                 END-IF                                           41588400
100404                 IF PV-GP-RTL-AMT-NULL-IND < 0                    41588500
100404                     MOVE ZEROS TO XST00008-GP-RTL-AMT            41588600
100404                 END-IF                                           41588700
100404                 MOVE XST00008-GP-RTL-QTY   TO PV-GP-QTY          41588800
100404                 MOVE XST00008-GP-RTL-AMT   TO PV-GP-RTL-AMT      41588900
100404                 IF XST00010-REGN-PRIC-IND = PC-YES               41589000
                           EVALUATE ASC-XFER-TYPE                       41589300
111703*                        WHEN  PC-DEFECTIVE-DAMAGE                41589400
111703                         WHEN  PC-DEFECTIVE-DAMAGE-SORT1          41589500
111703                         WHEN  PC-DEFECTIVE-DAMAGE-SORT2          41589600
                               WHEN  PC-CALLBACK                        41589700
                                  MOVE ASC-FR-STORE-NBR TO DK-STORE-NBR 41589800
                                  PERFORM 7800-CHECK-REGN-PRC           41589900
                               WHEN  PC-STOCK-BAL-CORP                  41590000
                               WHEN  PC-STOCK-BAL-STORE                 41590100
                               WHEN  PC-CUSTOMER                        41590200
                                  MOVE ASC-TO-STORE-NBR TO DK-STORE-NBR 41590300
                                  PERFORM 7800-CHECK-REGN-PRC           41590400
                           END-EVALUATE                                 41590500
                       END-IF                                           41590600
                       MOVE PV-CUR-RTL-AMT TO ASC-FILE-PRICE            41590700
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    41590800
                       IF PV-GP-QTY > +1                                41590900
                           COMPUTE PV-CUR-RTL-AMT =                     41591000
                                        PV-GP-RTL-AMT / PV-GP-QTY       41591100
                           SET ASC-GROUP-PRICED-ITEM                    41591200
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    41591300
                                                 TO TRUE                41591400
                       ELSE                                             41591500
                           SET ASC-NOT-GROUP-PRICED-ITEM                41591600
                                          (ASC-BLK-SUB ASC-ITEM-SUB)    41591700
                                                 TO TRUE                41591800
                       END-IF                                           41591900
                   WHEN SQLCODE = -904                                  41690200
                   WHEN SQLCODE = -913                                  41690300
                       CONTINUE                                         41690400
                   WHEN SQLCODE = +100                                  41690500
                       SET PS-INVALID-UPC          TO TRUE              41690600
                   WHEN OTHER                                           41690700
                       MOVE '3700-SELECT-UPC-NBR'                       41691000
                                           TO DP013-PARAGRAPH           41691100
100404                 MOVE 'READ A ROW FROM XST_UPC'                   41691200
                                           TO DP013-MESSAGE-TEXT (1)    41691300
                       MOVE SQLCA          TO DP013-SQLCA               41691400
100404                 MOVE 'XST_UPC'      TO DP013-DB2-TABLE-NAME (1)  41691500
100404                 MOVE 'XST_SKU_LOC'  TO DP013-DB2-TABLE-NAME (2)  41691600
100404                 MOVE 'XST_SKU'      TO DP013-DB2-TABLE-NAME (3)  41691700
100404                 MOVE 'TSKXREF'      TO DP013-DB2-TABLE-NAME (4)  41691800
                       SET DP013-DB2-ABEND TO TRUE                      41691900
                       PERFORM DP013-0000-PROCESS-ABEND                 41692000
               END-EVALUATE                                             41692100
           END-PERFORM.                                                 41692200
                                                                        41692300
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41692400
               MOVE '3700-SELECT-UPC-NBR'  TO DP013-PARAGRAPH           41692500
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    41692600
                                           TO DP013-MESSAGE-TEXT (1)    41692700
100404         MOVE 'DATA FROM XST_UPC & XST_SKU_LOC'                   41692800
                                           TO DP013-MESSAGE-TEXT (2)    41692900
               MOVE SQLCA                  TO DP013-SQLCA               41693000
100404         MOVE 'XST_UPC'              TO DP013-DB2-TABLE-NAME (1)  41693100
100404         MOVE 'XST_SKU_LOC'          TO DP013-DB2-TABLE-NAME (2)  41693200
100404         MOVE 'XST_SKU'              TO DP013-DB2-TABLE-NAME (3)  41693300
100404         MOVE 'TSKXREF'              TO DP013-DB2-TABLE-NAME (4)  41693400
               SET DP013-DB2-ABEND         TO TRUE                      41693700
               PERFORM DP013-0000-PROCESS-ABEND                         41693800
           END-IF.                                                      41693900
           IF PS-VALID-UPC                                              41694000
               PERFORM 3800-SELECT-KOHLS-INTERNAL-UPC                   41694100
               IF PS-INVALID-CHECK-DIGIT                                41694200
                   SET PS-INVALID-UPC      TO TRUE                      41694300
               END-IF                                                   41694400
           END-IF.                                                      41694500
                                                                        41694600
      ******************************************************************41694700
      *  GENERATE THE KOHL'S INTERNAL UPC NUMBER                        41694800
      ******************************************************************41694900
       3800-SELECT-KOHLS-INTERNAL-UPC.                                  41695000
           SET PS-VALID-CHECK-DIGIT        TO TRUE.                     41695100
           EXEC SQL                                                     41695200
100404         SELECT UPC_NBR                                           41695300
100404           INTO :XST00012-UPC-NBR                                 41695400
100404           FROM XST_UPC                                           41695500
100404          WHERE UPC_ID     =  :XST00008-INTR-UPC-ID               41695600
100404            AND LAST_ACTN_CDE IN ('A', 'U')                       41695700
           END-EXEC.                                                    41696300
                                                                        41696400
           EVALUATE TRUE                                                41696500
               WHEN SQLCODE = ZERO                                      41696600
100404             MOVE XST00012-UPC-NBR TO DK-UPC-NBR                  41696700
                                            ASC-KOHLS-UPC               41696800
                                           (ASC-BLK-SUB ASC-ITEM-SUB)   41696900
               WHEN SQLCODE = +100                                      41697000
                   SET PS-INVALID-CHECK-DIGIT  TO TRUE                  41697100
               WHEN OTHER                                               41697200
                   MOVE '3800-SELECT-KOHLS-INTERNAL-UPC'                41697300
                                       TO DP013-PARAGRAPH               41697400
                   MOVE 'SELECT-KOHLS-INTERNAL-UPC'                     41697500
                                       TO DP013-MESSAGE-TEXT (1)        41697600
                   MOVE SQLCA              TO DP013-SQLCA               41697700
100404             MOVE 'XST_UPC'          TO DP013-DB2-TABLE-NAME (1)  41697800
                   SET DP013-DB2-ABEND TO TRUE                          41697900
                   PERFORM DP013-0000-PROCESS-ABEND                     41698000
           END-EVALUATE.                                                41698100
      *                                                                 41698200
       EJECT                                                            41698300
                                                                        41698400
      ******************************************************************41698500
      ** VALIDATE EMBEDDED DEPT AND CLASS IN UPC                      **41698600
      ******************************************************************41698700
       3905-VALIDATE-UPC-DEPT-CLASS.                                    41698800
           MOVE PV-KOHLS-DEPT     TO DK-DEPT-NBR.                       41698900
           MOVE PV-KOHLS-CL-9     TO DK-SUBCLASS-NBR.                   41699000
           MOVE ZERO              TO PV-KOHLS-CL-2.                     41699100
           MOVE PV-KOHLS-CL-9     TO DK-CLASS-NBR.                      41699200
                                                                        41699300
           PERFORM                                                      41699400
             WITH TEST AFTER                                            41699500
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41699600
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41699700
                    OR SQLCODE = ZERO                                   41699800
                    OR SQLCODE = +100                                   41699900
               EXEC SQL                                                 41700000
                   SELECT  COUNT(*)                                     41700100
                     INTO  :PV-READ-COUNT                               41701000
                     FROM  TSKXREF                                      41702000
                    WHERE  (DEPT        =  :DK-DEPT-NBR                 41703000
                      AND   CLASS       =  :DK-CLASS-NBR                41704000
                      AND   SUBCLASS    =  :DK-SUBCLASS-NBR)            41705000
               END-EXEC                                                 41706000
                                                                        41707000
               EVALUATE TRUE                                            41708000
                   WHEN SQLCODE = ZERO                                  41709000
                       IF PV-READ-COUNT > +0                            41709100
                           SET PS-VALID-DEPT-CL    TO TRUE              41709200
                       ELSE                                             41709300
                           SET PS-INVALID-DEPT-CL  TO TRUE              41709400
                       END-IF                                           41709500
                   WHEN SQLCODE = -904                                  41709600
                   WHEN SQLCODE = -913                                  41709700
                       CONTINUE                                         41709800
                   WHEN SQLCODE = +100                                  41709900
                       SET PS-INVALID-DEPT-CL      TO TRUE              41710000
                   WHEN OTHER                                           41711000
                       MOVE '3905-VALIDATE-UPC-DEPT-CLASS'              41714000
                                           TO DP013-PARAGRAPH           41715000
                       MOVE 'READ A ROW FROM TSKXREF'                   41716000
                                           TO DP013-MESSAGE-TEXT (1)    41717000
                       MOVE SQLCA          TO DP013-SQLCA               41718000
                       MOVE 'TSKXREF'      TO DP013-DB2-TABLE-NAME (1)  41719000
                       SET DP013-DB2-ABEND TO TRUE                      41719100
                       PERFORM DP013-0000-PROCESS-ABEND                 41719200
               END-EVALUATE                                             41719300
           END-PERFORM.                                                 41719400
                                                                        41719500
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          41719600
               MOVE '3905-VALIDATE-UPC-DEPT-CLASS' TO DP013-PARAGRAPH   41719700
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    41719800
                                           TO DP013-MESSAGE-TEXT (1)    41719900
               MOVE 'DATA FROM TSKXREF'    TO DP013-MESSAGE-TEXT (2)    41720000
               MOVE SQLCA                  TO DP013-SQLCA               41721000
               MOVE 'TSKXREF'              TO DP013-DB2-TABLE-NAME (1)  41722000
               SET DP013-DB2-ABEND         TO TRUE                      41723000
               PERFORM DP013-0000-PROCESS-ABEND                         41724000
           END-IF.                                                      41725000
                                                                        41726000
      *                                                                 41730000
      *                                                                 41734200
      *----------------------------------------------------------------*41734300
      *    INITIALIZE BLOCK & ITEM COUNTERS. GET TRANSFER TYPE         *41734400
      *    DESCRIPTION AND CONTAINER TYPE DESCRIPTION.                 *41734500
      *    DISPLAY THE PANEL TO USER.                                  *41734600
      *----------------------------------------------------------------*41734700
                                                                        41734800
       4000-BUILD-INITIAL-PANEL.                                        41734900
                                                                        41735000
           MOVE +1                 TO ASC-BLK-SUB.                      41735100
                                                                        41735200
           MOVE +0                 TO ASC-ITEM-SUB                      41735300
                                      ASC-HIGHEST-BLOCK-WRITTEN.        41735400
           PERFORM 4140-GET-XFER-DESC.                                  41735500
           PERFORM 4150-GET-CONTNR-DESC.                                41735600
                                                                        41735700
           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        41735800
       EJECT                                                            41735900
       4140-GET-XFER-DESC.                                              41736000
           MOVE ASC-XFER-TYPE          TO DK-XFER-TYPE.                 41736100
           PERFORM WITH TEST AFTER                                      41736200
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41736300
               UNTIL   SQLCODE = +100 OR                                41736400
                       SQLCODE = ZERO OR                                41736500
                       PV-RETRY-COUNT > PC-MAX-RETRIES                  41736600
                                                                        41736700
               EXEC SQL                                                 41736800
                  SELECT                                                41736900
                      TYP_1ST_LNE_DESC                                  41737000
                     ,TYP_2ND_LNE_DESC                                  41737100
                  INTO                                                  41737200
                      :TFTYCD-TYP-1ST-LNE-DESC                          41737300
                     ,:TFTYCD-TYP-2ND-LNE-DESC                          41737400
                  FROM                                                  41737500
                      TTFTYCD                                           41737600
                  WHERE   XFER_TYP_CDE   = :DK-XFER-TYPE                41737700
               END-EXEC                                                 41737800
                                                                        41737900
               EVALUATE TRUE                                            41738000
                   WHEN SQLCODE = ZERO                                  41738100
                      IF TFTYCD-TYP-2ND-LNE-DESC = SPACES               41738200
                          MOVE TFTYCD-TYP-1ST-LNE-DESC                  41738300
                                         TO ASC-XFER-DESC               41738400
                      ELSE                                              41738500
                          STRING                                        41738600
                              TFTYCD-TYP-1ST-LNE-DESC DELIMITED BY '  ' 41738700
                              TFTYCD-TYP-2ND-LNE-DESC DELIMITED BY '  ' 41738800
                                         INTO ASC-XFER-DESC             41738900
                      END-IF                                            41739000
                   WHEN SQLCODE = +100                                  41739100
                       MOVE 'NOT FOUND'  TO ASC-XFER-DESC               41739200
                   WHEN SQLCODE = -904                                  41739300
                   WHEN SQLCODE = -913                                  41739400
                        CONTINUE                                        41739500
                   WHEN OTHER                                           41739600
                        MOVE '4140-GET-XFER-DESC'                       41739700
                                           TO DP013-PARAGRAPH           41739800
                        MOVE 'SELECT TRANSFER TYPE DESCRIPTION'         41739900
                                           TO DP013-MESSAGE-TEXT (1)    41740000
                        MOVE SQLCA         TO DP013-SQLCA               41740100
                        MOVE 'TTFTYCD'     TO DP013-DB2-TABLE-NAME (1)  41740200
                        SET DP013-DB2-ABEND                             41740300
                            DP013-XCTL-DISPLAY-RESTART                  41740400
                                           TO TRUE                      41740500
                        PERFORM DP013-0000-PROCESS-ABEND                41740600
               END-EVALUATE                                             41740700
           END-PERFORM.                                                 41740800
                                                                        41740900
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       41741000
              SQLCODE NOT = +100                                        41741100
               MOVE '4140-GET-XFER-DESC' TO DP013-PARAGRAPH             41741200
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     41741300
                                           TO DP013-MESSAGE-TEXT (1)    41741400
               MOVE 'TRANSFER TYPE DESCRIPTION'                         41741500
                                           TO DP013-MESSAGE-TEXT (2)    41741600
               MOVE SQLCA                  TO DP013-SQLCA               41741700
               MOVE 'TTFTYCD'              TO DP013-DB2-TABLE-NAME (1)  41741800
               SET DP013-DB2-ABEND                                      41741900
                   DP013-XCTL-DISPLAY-RESTART                           41742000
                                           TO TRUE                      41742100
               PERFORM DP013-0000-PROCESS-ABEND                         41742200
           END-IF.                                                      41742300
       EJECT                                                            41742400
       4150-GET-CONTNR-DESC.                                            41742500
           MOVE ASC-CONTNR-TYPE            TO DK-CONTNR-TYPE.           41742600
           PERFORM WITH TEST AFTER                                      41742700
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41742800
               UNTIL   SQLCODE = +100 OR                                41742900
                       SQLCODE = ZERO OR                                41743000
                       PV-RETRY-COUNT > PC-MAX-RETRIES                  41743100
                                                                        41743200
               EXEC SQL                                                 41743300
                  SELECT                                                41743400
                      CONTNR_TYP_DESC                                   41743500
                  INTO                                                  41743600
                      :TFSHCT-CONTNR-TYP-DESC                           41743700
                  FROM                                                  41743800
                      TTFSHCT                                           41743900
                  WHERE   CONTNR_TYP_CDE   = :DK-CONTNR-TYPE            41744000
               END-EXEC                                                 41744100
                                                                        41744200
               EVALUATE TRUE                                            41744300
                   WHEN SQLCODE = ZERO                                  41744400
                        MOVE TFSHCT-CONTNR-TYP-DESC                     41744500
                                         TO ASC-CONTNR-DESC             41744600
                   WHEN SQLCODE = +100                                  41744700
                        MOVE 'NOT FOUND'  TO ASC-CONTNR-DESC            41744800
                   WHEN SQLCODE = -904                                  41744900
                   WHEN SQLCODE = -913                                  41745000
                        CONTINUE                                        41745100
                   WHEN OTHER                                           41745200
                        MOVE '4150-GET-CONTNR-DESC'                     41745300
                                           TO DP013-PARAGRAPH           41745400
                        MOVE 'SELECT CONTAINER DESCRIPTION'             41745500
                                           TO DP013-MESSAGE-TEXT (1)    41745600
                        MOVE SQLCA         TO DP013-SQLCA               41745700
                        MOVE 'TTFSHCT'     TO DP013-DB2-TABLE-NAME (1)  41745800
                        SET DP013-DB2-ABEND                             41745900
                            DP013-XCTL-DISPLAY-RESTART                  41746000
                                           TO TRUE                      41746100
                        PERFORM DP013-0000-PROCESS-ABEND                41746200
               END-EVALUATE                                             41746300
           END-PERFORM.                                                 41746400
                                                                        41746500
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       41746600
              SQLCODE NOT = +100                                        41746700
               MOVE '4150-GET-CONTNR-DESC' TO DP013-PARAGRAPH           41746800
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     41746900
                                           TO DP013-MESSAGE-TEXT (1)    41747000
               MOVE 'CONTAINER DESCRIPTION'                             41747100
                                           TO DP013-MESSAGE-TEXT (2)    41747200
               MOVE SQLCA                  TO DP013-SQLCA               41747300
               MOVE 'TTFSHCT'              TO DP013-DB2-TABLE-NAME (1)  41747400
               SET DP013-DB2-ABEND                                      41747500
                   DP013-XCTL-DISPLAY-RESTART                           41747600
                                           TO TRUE                      41747700
               PERFORM DP013-0000-PROCESS-ABEND                         41747800
           END-IF.                                                      41747900
       EJECT                                                            41748000
      *----------------------------------------------------------------*41748100
      * MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *41748200
      *----------------------------------------------------------------*41748300
                                                                        41748400
       4400-MOVE-COMMAREA-TO-SCREEN.                                    41748500
           IF ASC-XFER-IS-NOT-COMPLETE                                  41748600
               MOVE PC-WORKSHEET-LITERAL       TO MR-A-CTL-LIT          41748700
               MOVE ASC-CONTROL-NBR            TO MR-A-CTL-NBR          41748800
           ELSE                                                         41748900
               MOVE PC-TRANSFER-LITERAL        TO MR-A-CTL-LIT          41749000
               MOVE ASC-FR-STORE-NBR           TO PV-DISP-FROM-STORE-NBR41749100
               MOVE ASC-XFER-SEQ-NBR           TO PV-DISP-SEQ-NBR       41749200
               MOVE PV-DISP-XFER-NBR           TO MR-A-CTL-NBR          41749300
           END-IF.                                                      41749400
           MOVE ASC-XFER-TYPE(2:1)             TO MR-A-XFER-TYPE.       41749500
           MOVE ASC-XFER-DESC                  TO MR-A-XFER-DESC.       41749600
           MOVE ASC-CONTNR-TYPE(2:1)           TO MR-A-CONT-TYPE.       41749700
           MOVE ASC-CONTNR-DESC                TO MR-A-CONT-DESC.       41749800
           MOVE ASC-TO-STORE-NBR               TO MR-A-TO-STORE-NBR.    41749900
           MOVE ASC-TO-STORE-NAM               TO MR-A-TO-STORE-NAM.    41750000
           MOVE ASC-COMP-BY-INT                TO MR-A-COMP-BY-INT.     41750100
           MOVE ASC-COMP-BY-NAM                TO MR-A-COMP-BY-NAM.     41750200
           MOVE ASC-DSCRP-IND                  TO MR-A-DSCRP.           41750300
           MOVE ASC-TQTY                       TO MR-A-TQTY.            41750400
           EVALUATE ASC-XFER-TYPE                                       41750500
111703*        WHEN PC-DEFECTIVE-DAMAGE                                 41750600
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT1                           41750700
111703         WHEN PC-DEFECTIVE-DAMAGE-SORT2                           41750800
               WHEN PC-STOCK-BAL-STORE                                  41750900
                   MOVE SPACES                 TO MR-A-LITERAL1         41751000
                                                  MR-A-FIELD1           41751100
                                                  MR-A-CUST-NAME-LIT    41751200
                                                  MR-A-CUST-NAME        41751300
                                                  MR-A-PHONE-LIT        41751400
                                                  MR-A-PHONE-NBR        41751500
                                                  MR-A-ADDR-LIT         41751600
                                                  MR-A-ADDR1            41751700
                                                  MR-A-ADDR2            41751800
                                                  MR-A-CITY-LIT         41751900
                                                  MR-A-STATE-LIT        41752000
                                                  MR-A-STATE            41752100
                                                  MR-A-ZIP              41752200
                                                  MR-A-SEAL1-LIT        41752300
                                                  MR-A-SEAL1            41752400
                                                  MR-A-SEAL2-LIT        41752500
                                                  MR-A-SEAL2            41752600
               WHEN PC-CALLBACK                                         41752700
                   MOVE ASC-CALLBACK-NBR       TO MR-A-FIELD1           41752800
                   MOVE PC-CALLBACK-LITERAL    TO MR-A-LITERAL1         41752900
                   MOVE SPACES                 TO MR-A-CUST-NAME-LIT    41753000
                                                  MR-A-CUST-NAME        41753100
                                                  MR-A-PHONE-LIT        41753200
                                                  MR-A-PHONE-NBR        41753300
                                                  MR-A-ADDR-LIT         41753400
                                                  MR-A-ADDR1            41753500
                                                  MR-A-ADDR2            41753600
                                                  MR-A-CITY-LIT         41753700
                                                  MR-A-STATE-LIT        41753800
                                                  MR-A-STATE            41753900
                                                  MR-A-ZIP              41754000
                                                  MR-A-SEAL1-LIT        41754100
                                                  MR-A-SEAL1            41754200
                                                  MR-A-SEAL2-LIT        41754300
                                                  MR-A-SEAL2            41754400
               WHEN PC-STOCK-BAL-CORP                                   41754500
                   MOVE ASC-APPROVAL-NBR       TO MR-A-FIELD1           41754600
                   MOVE PC-APPROVAL-LITERAL    TO MR-A-LITERAL1         41754700
                   MOVE SPACES                 TO MR-A-CUST-NAME-LIT    41754800
                                                  MR-A-CUST-NAME        41754900
                                                  MR-A-PHONE-LIT        41755000
                                                  MR-A-PHONE-NBR        41755100
                                                  MR-A-ADDR-LIT         41755200
                                                  MR-A-ADDR1            41755300
                                                  MR-A-ADDR2            41755400
                                                  MR-A-CITY-LIT         41755500
                                                  MR-A-STATE-LIT        41755600
                                                  MR-A-STATE            41755700
                                                  MR-A-ZIP              41755800
                                                  MR-A-SEAL1-LIT        41755900
                                                  MR-A-SEAL1            41756000
                                                  MR-A-SEAL2-LIT        41756100
                                                  MR-A-SEAL2            41756200
               WHEN PC-CUSTOMER                                         41756300
                   MOVE PC-REQUESTOR-LITERAL   TO MR-A-LITERAL1         41756400
                   MOVE ASC-REQ-BY-INT         TO PV-INT                41756500
                   MOVE ASC-REQ-BY-NAM         TO PV-LAST-NAME          41756600
                   MOVE PV-NAME                TO MR-A-FIELD1           41756700
                   MOVE PC-CUST-NAME-LITERAL   TO MR-A-CUST-NAME-LIT    41756800
                   MOVE ASC-CUST-NAME          TO MR-A-CUST-NAME        41756900
                   MOVE PC-PHONE-LITERAL       TO MR-A-PHONE-LIT        41757000
                   MOVE ASC-PHONE-AREA         TO PV-PHONE-AREA         41757100
                   MOVE ASC-PHONE-EXCH         TO PV-PHONE-EXCH         41757200
                   MOVE ASC-PHONE-NBR          TO PV-PHONE-NBR          41757300
                   MOVE PV-PHONE               TO MR-A-PHONE-NBR        41757400
                   MOVE PC-ADDR-LITERAL        TO MR-A-ADDR-LIT         41757500
                   MOVE ASC-ADDR1              TO MR-A-ADDR1            41757600
                   MOVE ASC-ADDR2              TO MR-A-ADDR2            41757700
                   MOVE PC-CITY-LITERAL        TO MR-A-CITY-LIT         41757800
                   MOVE ASC-CITY               TO MR-A-CITY             41757900
                   MOVE PC-STATE-LITERAL       TO MR-A-STATE-LIT        41758000
                   MOVE ASC-STATE              TO MR-A-STATE            41758100
                   MOVE ASC-ZIP                TO PV-ZIP-5              41758200
                   IF PV-ZIP-EXT > SPACES                               41758300
                       MOVE ASC-ZIP-EXT        TO PV-ZIP-EXT            41758400
                       MOVE '-'                TO PV-ZIP-DASH           41758500
                   END-IF                                               41758600
                   MOVE PV-ZIP                 TO MR-A-ZIP              41758700
               WHEN PC-NON-RETAIL                                       41758800
                   MOVE PC-REQUESTOR-LITERAL   TO MR-A-LITERAL1         41758900
                   MOVE ASC-REQ-BY-INT         TO PV-INT                41759000
                   MOVE ASC-REQ-BY-NAM         TO PV-LAST-NAME          41759100
                   MOVE PV-NAME                TO MR-A-FIELD1           41759200
                   MOVE PC-ATTENTION-LITERAL   TO MR-A-ADDR-LIT         41759300
                   MOVE ASC-ATTN-TO-INT        TO PV-INT                41759400
                   MOVE ASC-ATTN-TO-NAM        TO PV-LAST-NAME          41759500
                   MOVE PV-NAME                TO MR-A-ADDR1            41759600
           END-EVALUATE.                                                41759700
           EVALUATE ASC-CONTNR-TYPE                                     41759800
               WHEN PC-TRAILER                                          41759900
                   MOVE PC-TRLR-SEAL-LITERAL   TO MR-A-SEAL1-LIT        41760000
                   MOVE PC-TRLR-NBR-LITERAL    TO MR-A-SEAL2-LIT        41760100
                   MOVE ASC-TRAILER-NBR        TO MR-A-SEAL2            41760200
                   MOVE ASC-TRAILER-SEAL       TO MR-A-SEAL1            41760300
               WHEN OTHER                                               41760400
                   MOVE PC-LG-TOTE-LITERAL     TO MR-A-SEAL1-LIT        41760500
                   MOVE PC-SM-TOTE-LITERAL     TO MR-A-SEAL2-LIT        41760600
                   MOVE ASC-LG-TOTE-SEAL1      TO PV-LG-TOTE-SEAL1      41760700
                   MOVE ASC-LG-TOTE-SEAL2      TO PV-LG-TOTE-SEAL2      41760800
                   MOVE PV-LG-TOTE-FIELD       TO MR-A-SEAL1            41760900
                   MOVE ASC-SM-TOTE-SEAL       TO MR-A-SEAL2            41761000
           END-EVALUATE.                                                41761100
           SET DP030-ERASE                                              41761200
               DP030-SEND-MAP-AND-DATA (1)                              41761300
               DP030-SEND-MAP-AND-DATA (2) TO TRUE.                     41761400
           MOVE PC-COMMON-HEADER-MAP-NAME      TO DP030-MAP-NAME (1).   41761500
           MOVE 1                              TO PV-MAP-START-BYTE.    41761600
           MOVE MR-A-HEADER                    TO MD-MAP-DATA-AREA.     41761700
           MOVE LENGTH OF MR-A-HEADER          TO DP030-MAP-LENGTH (1). 41761800
           ADD DP030-MAP-LENGTH (1)            TO PV-MAP-START-BYTE.    41761900
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         41762000
               PERFORM 4420-FORMAT-RTL-LIST-LINES                       41762100
                   VARYING ASC-ITEM-SUB                                 41762200
                   FROM 1 BY 1                                          41762300
                   UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-RTL-PANEL          41762400
                   MOVE PC-RTL-DETAIL-MAP-NAME                          41762500
                                               TO DP030-MAP-NAME (2)    41762600
                   MOVE LENGTH OF MR-B-RTL-DETAIL                       41762700
                                               TO DP030-MAP-LENGTH (2)  41762800
                   MOVE MR-B-RTL-DETAIL        TO MD-MAP-DATA-AREA      41762900
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   41763000
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     41763100
           ELSE                                                         41763200
               PERFORM 4430-FORMAT-NRTL-LIST-LINES                      41763300
                   VARYING ASC-ITEM-SUB                                 41763400
                   FROM 1 BY 1                                          41763500
                   UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-NRTL-PANEL         41763600
                   MOVE PC-NRTL-DETAIL-MAP-NAME                         41763700
                                               TO DP030-MAP-NAME (2)    41763800
                   MOVE LENGTH OF MR-C-NRTL-DETAIL                      41763900
                                               TO DP030-MAP-LENGTH (2)  41764000
                   MOVE MR-C-NRTL-DETAIL       TO MD-MAP-DATA-AREA      41764100
                             (PV-MAP-START-BYTE:DP030-MAP-LENGTH (2))   41764200
                   ADD DP030-MAP-LENGTH (2)    TO PV-MAP-START-BYTE     41764300
           END-IF.                                                      41764400
           SET DP030-SET-CURSOR-TRAILER  TO TRUE.                       41764500
       EJECT                                                            41764600
      *----------------------------------------------------------------*41764700
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP FOR *41764800
      *    RETAIL TRANSFER TYPES.                                      *41764900
      *----------------------------------------------------------------*41765000
                                                                        41765100
       4420-FORMAT-RTL-LIST-LINES.                                      41765200
      *                                                                 41765300
           IF ASC-BLK-SUB = +1                                          41765400
               MOVE ASC-ITEM-SUB       TO MR-B-LINE-NBR-N (ASC-ITEM-SUB)41765500
           ELSE                                                         41765600
               COMPUTE PV-LINE-NBR =                                    41765700
                         ASC-ITEM-SUB + PC-ITEMS-PER-RTL-PANEL          41765800
               MOVE PV-LINE-NBR        TO MR-B-LINE-NBR-N (ASC-ITEM-SUB)41765900
           END-IF.                                                      41766000
                                                                        41766100
           MOVE ASC-DEPT (ASC-BLK-SUB ASC-ITEM-SUB)                     41766200
                                 TO MR-B-DEPT (ASC-ITEM-SUB).           41766300
           MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)                    41766400
                                 TO MR-B-CLASS (ASC-ITEM-SUB).          41766500
           MOVE ASC-SUBCLASS (ASC-BLK-SUB ASC-ITEM-SUB)                 41766600
                                 TO MR-B-SUBCL (ASC-ITEM-SUB).          41766700
      **>  MOVE ASC-DPT-CL-SUBCL-N   (ASC-BLK-SUB ASC-ITEM-SUB)         41766800
      **>                   TO MR-B-DPT-CL-SUBCL     (ASC-ITEM-SUB)     41766900
                                                                        41767000
           MOVE ASC-UPC    (ASC-BLK-SUB ASC-ITEM-SUB)                   41767100
                                       TO MR-B-UPC   (ASC-ITEM-SUB)     41767200
           IF ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES             41767300
               INSPECT ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)             41767400
                 REPLACING LEADING ' ' BY '0'                           41767500
               MOVE ASC-PRICE-N (ASC-BLK-SUB ASC-ITEM-SUB)              41767600
                                       TO MR-B-PRICE-N (ASC-ITEM-SUB)   41767700
           END-IF.                                                      41767800
           MOVE ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                  41767900
                                       TO MR-B-QTY   (ASC-ITEM-SUB).    41768000
       EJECT                                                            41768100
      *----------------------------------------------------------------*41768200
      *    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP FOR *41768300
      *    NON-RETAIL TRANSFER TYPES.                                  *41768400
      *----------------------------------------------------------------*41768500
                                                                        41768600
       4430-FORMAT-NRTL-LIST-LINES.                                     41768700
      *                                                                 41768800
           IF ASC-BLK-SUB = +1                                          41768900
               MOVE ASC-ITEM-SUB       TO MR-C-LINE-NBR-N (ASC-ITEM-SUB)41769000
           ELSE                                                         41769100
               COMPUTE PV-LINE-NBR =                                    41769200
                         ASC-ITEM-SUB + PC-ITEMS-PER-NRTL-PANEL         41769300
               MOVE PV-LINE-NBR        TO MR-C-LINE-NBR-N (ASC-ITEM-SUB)41769400
           END-IF.                                                      41769500
           MOVE ASC-ITEM-DESC (ASC-BLK-SUB ASC-ITEM-SUB)                41769600
                                       TO MR-C-DESC  (ASC-ITEM-SUB).    41769700
           MOVE ASC-FIXTURE (ASC-BLK-SUB ASC-ITEM-SUB)                  41769800
                                       TO MR-C-FIXTURE (ASC-ITEM-SUB).  41769900
           MOVE ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB)                41770000
                                       TO MR-C-DEPT (ASC-ITEM-SUB).     41770100
           MOVE ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                 41770200
                                       TO MR-C-QTY   (ASC-ITEM-SUB).    41770300
      *----------------------------------------------------------------*41770400
      *    GET THE 10 CHARACTER ABBREVIATED STORE NAME.                *41770500
      *----------------------------------------------------------------*41770600
       4500-READ-STORE.                                                 41770700
           PERFORM WITH TEST AFTER                                      41770800
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       41770900
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  41771000
                    OR SQLCODE = ZERO                                   41771100
                    OR SQLCODE = +100                                   41771200
               EXEC SQL                                                 41771300
100404             SELECT LOC_10_ABBR_NM                                41771400
100404                   ,LOC_TYP_CDE                                   41771500
100404                 INTO :XST00001-LOC-10-ABBR-NM                    41771600
100404                   ,  :XST00001-LOC-TYP-CDE                       41771700
100404                 FROM XST_LOC                                     41771800
100404                 WHERE   (LOC_NBR        = :DK-STORE-NBR)         41771900
100404                   AND   (CHAR(OPN_DTE) <= CURRENT DATE           41772000
                                         AND                            41773000
100404                          CHAR(CLO_DTE) >= CURRENT DATE)          41774000
               END-EXEC                                                 41774200
               EVALUATE TRUE                                            41774300
                   WHEN SQLCODE = ZERO                                  41774400
100404                 MOVE XST00001-LOC-10-ABBR-NM TO                  41774500
                                                    ASC-TO-STORE-NAM    41774600
100404                 MOVE XST00001-LOC-TYP-CDE TO ASC-TO-STORE-TYPE   41774700
                       SET PS-STORE-FOUND  TO TRUE                      41774800
                   WHEN SQLCODE = -904                                  41774900
                   WHEN SQLCODE = -913                                  41775000
                   WHEN SQLCODE = +100                                  41775100
                       CONTINUE                                         41775200
                   WHEN OTHER                                           41775400
                        MOVE '4500-READ-STORE'                          41775700
                                          TO DP013-PARAGRAPH            41775800
                        MOVE 'READ A ROW FROM THE STORE TABLE'          41775900
                                          TO DP013-MESSAGE-TEXT(1)      41776000
                        MOVE SQLCA        TO DP013-SQLCA                41776100
100404                  MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (1)   41776200
                        SET DP013-DB2-ABEND                             41776300
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          41776400
                        PERFORM DP013-0000-PROCESS-ABEND                41776500
               END-EVALUATE                                             41776600
           END-PERFORM.                                                 41776700
                                                                        41776800
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       41776900
              SQLCODE NOT = 0                                           41777000
               MOVE '4500-READ-STORE' TO DP013-PARAGRAPH                41777100
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO READ'       41777200
                                          TO DP013-MESSAGE-TEXT (1)     41777300
               MOVE 'THE STORE TABLE'     TO DP013-MESSAGE-TEXT (2)     41777400
               MOVE SQLCA                 TO DP013-SQLCA                41777500
100404         MOVE 'XST_LOC'             TO DP013-DB2-TABLE-NAME (1)   41777600
               SET DP013-DB2-ABEND                                      41777700
                   DP013-XCTL-DISPLAY-RESTART                           41777800
                                          TO TRUE                       41777900
               PERFORM DP013-0000-PROCESS-ABEND                         41778000
           END-IF.                                                      41778100
       EJECT                                                            41779000
051705*----------------------------------------------------------------*41780000
051705*    GET THE PHYSICAL INVENTORY PERIOD INDICATOR FROM TTFCNTL    *41790000
051705*----------------------------------------------------------------*41800000
051705*4520-READ-CONTROL-TABLE.                                         41810000
051705*    PERFORM                                                      41820000
051705*        WITH TEST AFTER                                          41830000
051705*        VARYING PV-RETRY-COUNT                                   41840000
051705*        FROM 1 BY 1                                              41850000
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 41860000
051705*            OR (SQLCODE = +0))                                   41870000
051705*        EXEC SQL                                                 41880000
051705*            SELECT PHY_INV_PERD_IND                              41890000
051705*                  ,XFER_INV_CTOFF_DTE                            41900000
051705*                  ,MAX_PLND_INV_DTE                              41910000
051705*             INTO :TFCNTL-PHY-INV-PERD-IND                       41920000
051705*                 ,:TFCNTL-XFER-INV-CTOFF-DTE                     41930000
051705*                 ,:TFCNTL-MAX-PLND-INV-DTE                       41940000
051705*             FROM TTFCNTL                                        41950000
051705*        END-EXEC                                                 41960000
051705*        EVALUATE TRUE                                            41970000
051705*            WHEN SQLCODE = ZERO                                  41980000
051705*                  MOVE TFCNTL-PHY-INV-PERD-IND                   41990000
051705*                                    TO PV-PHY-INV-PERD-IND       42000000
051705*                  MOVE TFCNTL-MAX-PLND-INV-DTE                   42010000
051705*                                    TO PV-MAX-PLND-INV-DTE       42020000
051705*                  MOVE TFCNTL-XFER-INV-CTOFF-DTE                 42030000
051705*                                    TO PV-XFER-INV-CTOFF-DTE     42040000
051705*            WHEN SQLCODE = -904                                  42050000
051705*            WHEN SQLCODE = -913                                  42060000
051705*                CONTINUE                                         42070000
051705*            WHEN OTHER                                           42080000
051705*                MOVE '4520-READ-CONTROL-TABLE'                   42110000
051705*                                  TO DP013-PARAGRAPH             42120000
051705*                MOVE 'GET THE PHYSICAL INV. PERIOD INDICATOR'    42130000
051705*                                      TO DP013-MESSAGE-TEXT (1)  42140000
051705*                MOVE SQLCA            TO DP013-SQLCA             42150000
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)42160000
051705*                SET DP013-DB2-ABEND                              42170000
051705*                DP013-XCTL-DISPLAY-RESTART                       42180000
051705*                                     TO TRUE                     42190000
051705*                PERFORM DP013-0000-PROCESS-ABEND                 42200000
051705*        END-EVALUATE                                             42210000
051705*    END-PERFORM.                                                 42220000
051705*                                                                 42230000
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42240000
051705*                MOVE '4520-READ-CONTROL-TABLE'                   42250000
051705*                                  TO DP013-PARAGRAPH             42260000
051705*                MOVE 'MAX RETRIES EXCEEDED READING '             42270000
051705*                                      TO DP013-MESSAGE-TEXT (1)  42280000
051705*                MOVE SQLCA            TO DP013-SQLCA             42290000
051705*                MOVE 'TTFCNTL'        TO DP013-DB2-TABLE-NAME (1)42300000
051705*                SET DP013-DB2-ABEND                              42310000
051705*                DP013-XCTL-DISPLAY-RESTART                       42320000
051705*                                     TO TRUE                     42330000
051705*                PERFORM DP013-0000-PROCESS-ABEND                 42340000
051705*    END-IF.                                                      42340100
051705*4530-CHECK-INVENTORY.                                            42340200
051705*    MOVE ASC-FR-STORE-NBR-N TO DK-STORE-NBR-9.                   42340400
051705*    PERFORM 4540-GET-PLND-INV-DTE.                               42340500
051705*    MOVE INVPAR-PLND-INV-DTE   TO PV-FR-STR-INV-DTE.             42340600
051705*    MOVE ASC-TO-STORE-NBR-N TO DK-STORE-NBR-9.                   42340700
051705*    PERFORM 4540-GET-PLND-INV-DTE.                               42340800
051705*    MOVE INVPAR-PLND-INV-DTE   TO PV-TO-STR-INV-DTE.             42340900
051705*    IF ASC-CONTNR-TYPE = PC-HAND-CARRY                           42341000
051705*        EVALUATE TRUE                                            42342000
051705*            WHEN PV-FR-STR-INV-DTE >= PV-CURRENT-ISO-DATE AND    42343000
051705*                 PV-TO-STR-INV-DTE >= PV-CURRENT-ISO-DATE        42344000
051705*            WHEN PV-FR-STR-INV-DTE <  PV-CURRENT-ISO-DATE AND    42345000
051705*                 PV-TO-STR-INV-DTE <  PV-CURRENT-ISO-DATE        42346000
051705*                CONTINUE                                         42347000
051705*            WHEN OTHER                                           42347100
051705*                IF ASC-NO-ERROR                                  42347200
051705*                    SET ASC-ERROR          TO TRUE               42347300
051705*                END-IF                                           42347400
051705*        END-EVALUATE                                             42347500
051705*    ELSE                                                         42347600
051705*        IF PV-CURRENT-ISO-DATE > PV-XFER-INV-CTOFF-DTE  AND      42347700
051705*           PV-CURRENT-ISO-DATE <= PV-FR-STR-INV-DTE              42347800
051705*            SET ASC-DO-NOT-SHIP          TO TRUE                 42347900
051705*        END-IF                                                   42348000
051705*    END-IF.                                                      42348100
051705*----------------------------------------------------------------*42348200
051705*    GET THE MAX PLANNED INVENTORY DATE FOR THIS STORE           *42348300
051705*----------------------------------------------------------------*42348400
051705*4540-GET-PLND-INV-DTE.                                           42348500
051705*    PERFORM                                                      42348600
051705*        WITH TEST AFTER                                          42348700
051705*        VARYING PV-RETRY-COUNT                                   42348800
051705*        FROM 1 BY 1                                              42348900
051705*        UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42349000
051705*            OR (SQLCODE = +100)                                  42350000
051705*            OR (SQLCODE = +0))                                   42350100
051705*        EXEC SQL                                                 42350200
051705*            SELECT MAX(PLND_INV_DTE)                             42350300
051705*                INTO :INVPAR-PLND-INV-DTE                        42350400
051705*                     :PV-NULL-IND                                42350500
051705*                FROM TINVPAR                                     42350600
051705*                WHERE  LOC_NBR      = :DK-STORE-NBR-9   AND      42350700
051705*                       PLND_INV_DTE < :PC-MAX-DATE               42350800
051705*        END-EXEC                                                 42350900
051705*        EVALUATE TRUE                                            42351000
051705*            WHEN SQLCODE = ZERO                                  42352000
051705*            WHEN SQLCODE = -904                                  42353000
051705*            WHEN SQLCODE = -913                                  42354000
051705*                CONTINUE                                         42354100
051705*            WHEN SQLCODE = +100                                  42354200
051705*                MOVE PV-CURRENT-ISO-DATE TO INVPAR-PLND-INV-DTE  42354300
051705*            WHEN OTHER                                           42354400
051705*                MOVE '4540-GET-PLND-INV-DTE'                     42354700
051705*                                  TO DP013-PARAGRAPH             42354800
051705*                MOVE 'GET THE PLANNED INVENTORY DATE FOR STORE:' 42354900
051705*                                      TO DP013-MESSAGE-TEXT (1)  42355000
051705*                MOVE DK-STORE-NBR-9                              42356000
051705*                                      TO DP013-MESSAGE-TEXT (2)  42357000
051705*                MOVE SQLCA            TO DP013-SQLCA             42358000
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)42359000
051705*                SET DP013-DB2-ABEND                              42360000
051705*                DP013-XCTL-DISPLAY-RESTART                       42370000
051705*                                     TO TRUE                     42380000
051705*                PERFORM DP013-0000-PROCESS-ABEND                 42380100
051705*        END-EVALUATE                                             42380200
051705*    END-PERFORM.                                                 42380300
051705*                                                                 42380400
051705*    IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42380500
051705*                MOVE '4540-GET-PLND-INV-DTE'                     42380600
051705*                                  TO DP013-PARAGRAPH             42380700
051705*                MOVE 'MAX RETRIES EXCEEDED READING FOR STORE:'   42380800
051705*                                      TO DP013-MESSAGE-TEXT (1)  42380900
051705*                MOVE DK-STORE-NBR-9                              42381000
051705*                                      TO DP013-MESSAGE-TEXT (2)  42382000
051705*                MOVE SQLCA            TO DP013-SQLCA             42383000
051705*                MOVE 'TINVPAR'        TO DP013-DB2-TABLE-NAME (1)42384000
051705*                SET DP013-DB2-ABEND                              42385000
051705*                DP013-XCTL-DISPLAY-RESTART                       42386000
051705*                                     TO TRUE                     42387000
051705*                PERFORM DP013-0000-PROCESS-ABEND                 42388000
051705*    END-IF.                                                      42389000
051705*    IF PV-NULL-IND < 0                                           42390000
051705*        MOVE PV-CURRENT-ISO-DATE TO INVPAR-PLND-INV-DTE          42400000
051705*    END-IF.                                                      42400100
051705*EJECT                                                            42400200
       4600-VALIDATE-PRICE.                                             42400300
           IF ASC-GROUP-PRICED-ITEM   (ASC-BLK-SUB ASC-ITEM-SUB)        42400400
               IF ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)                 42400500
                                   NOT = PV-CUR-RTL-AMT                 42400600
      * -- THIS IS A GROUP PRICED ITEM; TRANSFER PRICE SHOULD BE --     42400700
                   IF ASC-NO-ERROR                                      42400800
                       SET ASC-ERROR          TO TRUE                   42400900
                   END-IF                                               42401000
               END-IF                                                   42402000
           ELSE                                                         42402100
             EVALUATE ASC-XFER-TYPE                                     42402200
111703*         WHEN PC-DEFECTIVE-DAMAGE                                42402300
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT1                          42402400
111703          WHEN PC-DEFECTIVE-DAMAGE-SORT2                          42402500
                   IF ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)             42402600
                                   < PV-CUR-RTL-AMT                     42402700
      * -- DAMAGED TAG PRICE MUST MATCH CURRENT FILE PRICE --           42402800
                       IF ASC-NO-ERROR                                  42402900
                           SET ASC-ERROR          TO TRUE               42403000
                       END-IF                                           42403100
                   END-IF                                               42403200
                WHEN PC-CALLBACK                                        42403300
                   CONTINUE                                             42403400
                WHEN PC-STOCK-BAL-STORE                                 42403500
                WHEN PC-STOCK-BAL-CORP                                  42403600
                WHEN PC-CUSTOMER                                        42403700
100404            IF (PV-NREGN-LOC-SKU-STAT-CDE = PC-CLEARANCE  AND     42403800
100404                XST00010-REGN-PRIC-IND NOT = PC-YES)              42403900
100404                IF PV-NREGN-UPC-STAT-CHG-DTE                      42404000
100404                                       < PV-NREGN-UNT-RTL-CHG-DTE 42404100
                          PERFORM 7750-GET-CLR-ITM-1ST-MKDN-PRIC        42404500
                      ELSE                                              42404600
100404                    MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT   42404700
                      END-IF                                            42404900
                      IF ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)          42405000
                                        >  PPCPRC-RTL-AMT               42405100
      * -- ITEM IS IN CLEARANCE STATUS - COMPLETE INSTORE PRICE CHANGE -42405200
                         IF ASC-NO-ERROR                                42405300
                             SET ASC-ERROR          TO TRUE             42405400
                         END-IF                                         42405500
                      END-IF                                            42405600
                  ELSE                                                  42405700
                      IF ASC-PRICE-N(ASC-BLK-SUB ASC-ITEM-SUB)          42405800
                                   NOT = PV-CUR-RTL-AMT                 42405900
      * -- PRICE MUST MATCH FILE PRICE - COMPLETE INSTORE PRICE CHANGE -42406000
                         IF ASC-NO-ERROR                                42406100
                             SET ASC-ERROR          TO TRUE             42406200
                         END-IF                                         42406300
                      END-IF                                            42406400
                  END-IF                                                42406500
             END-EVALUATE                                               42406600
           END-IF.                                                      42406700
       EJECT                                                            42406800
       5500-DELETE-XFER-ITEMS.                                          42406900
           MOVE ASC-XFER-DKEY-ID    TO DK-XFER-DKEY-ID.                 42407000
           PERFORM WITH TEST AFTER                                      42407100
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42407200
               UNTIL SQLCODE = 0    OR                                  42407300
                     SQLCODE = +100 OR                                  42407400
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    42407500
               EXEC SQL                                                 42407600
                    DELETE FROM TTFITEM                                 42407700
                    WHERE  (XFER_DKEY_ID   =  :DK-XFER-DKEY-ID)         42407800
               END-EXEC                                                 42407900
                                                                        42408000
               EVALUATE TRUE                                            42408100
                   WHEN SQLCODE = ZERO                                  42408200
                   WHEN SQLCODE = +100                                  42408300
                   WHEN SQLCODE = -904                                  42408400
                   WHEN SQLCODE = -913                                  42408500
                      CONTINUE                                          42408600
                   WHEN OTHER                                           42408700
                      MOVE '5500-DELETE-XFER-ITEMS'                     42408800
                                             TO DP013-PARAGRAPH         42408900
                      MOVE 'DELETE TRANSFER ITEM FOR KEY: '             42409000
                                             TO DP013-MESSAGE-TEXT (1)  42409100
                      MOVE DK-XFER-DKEY-ID   TO PV-DISPLAY-XFER-DKEY-ID 42409200
                      MOVE PV-DISPLAY-XFER-DKEY-ID                      42409300
                                             TO DP013-MESSAGE-TEXT (2)  42409400
                      MOVE SQLCA             TO DP013-SQLCA             42409500
                      MOVE 'TTFITEM'         TO DP013-DB2-TABLE-NAME (1)42409600
                      SET DP013-DB2-ABEND    TO TRUE                    42409700
               END-EVALUATE                                             42409800
           END-PERFORM.                                                 42409900
                                                                        42410000
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       42410100
              SQLCODE NOT = 0                                           42410200
               MOVE '5500-DELETE-XFER-ITEMS'       TO DP013-PARAGRAPH   42410300
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO DELETE'     42410400
                                          TO DP013-MESSAGE-TEXT (1)     42410500
               MOVE 'TRANSFER ITEMS FOR:' TO DP013-MESSAGE-TEXT (2)     42410600
               MOVE DK-XFER-DKEY-ID       TO PV-DISPLAY-XFER-DKEY-ID    42410700
               MOVE PV-DISPLAY-XFER-DKEY-ID                             42410800
                                          TO DP013-MESSAGE-TEXT (3)     42410900
               MOVE SQLCA                 TO DP013-SQLCA                42411000
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   42411100
               SET DP013-DB2-ABEND                                      42411200
                   DP013-XCTL-DISPLAY-RESTART                           42411300
                                          TO TRUE                       42411400
               PERFORM DP013-0000-PROCESS-ABEND                         42411500
           END-IF.                                                      42411600
      *----------------------------------------------------------------*42411700
      * SELECT DATA FROM THE TRANSFER TABLES WHEN PROCESSING AN         42411800
      * EXISTING WORKSHEET FROM THE CRITERIA SPEC SCREEN.              *42411900
      *----------------------------------------------------------------*42412000
       6000-GET-CONTROL-INFO.                                           42412100
           PERFORM                                                      42412200
               WITH TEST AFTER                                          42412300
               VARYING PV-RETRY-COUNT                                   42412400
               FROM 1 BY 1                                              42412500
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42412600
                         OR (SQLCODE = ZERO)                            42412700
                         OR (SQLCODE = +100))                           42412800
      *                                                                 42412900
               EXEC SQL                                                 42413000
                   SELECT ENTR_MTHD_TYP_CDE                             42413100
                         ,XFER_TYP_CDE                                  42413200
                         ,CONTNR_TYP_CDE                                42413300
                         ,XFER_SEQ_NBR                                  42413400
                         ,TO_STR_NBR                                    42413500
                         ,CPLD_INIT_1ST_NM                              42413600
                         ,CPLD_LAST_NM                                  42413700
                         ,LG_TTE_1ST_SEAL_ID                            42413800
                         ,LG_TTE_2ND_SEAL_ID                            42413900
                         ,SM_TTE_BAG_SEAL_ID                            42414000
                         ,TRLR_NBR                                      42414100
                         ,TRLR_SEAL_ID                                  42414200
                         ,CLBK_NBR                                      42414300
                         ,STK_BAL_APVL_NBR                              42414400
                         ,RQSTR_INIT_1ST_NM                             42414500
                         ,RQSTR_LAST_NM                                 42414600
                         ,ATTN_INIT_1ST_NM                              42414700
                         ,ATTN_LAST_NM                                  42414800
                         ,WRKSHT_PROB_IND                               42414900
100404                   ,LOC_10_ABBR_NM                                42415000
                   INTO   :TFMSTR-ENTR-MTHD-TYP-CDE                     42415100
                         ,:TFMSTR-XFER-TYP-CDE                          42415200
                         ,:TFMSTR-CONTNR-TYP-CDE                        42415300
                         ,:TFMSTR-XFER-SEQ-NBR                          42415400
                            :PV-NULL-IND                                42415500
                         ,:TFMSTR-TO-STR-NBR                            42415600
                         ,:TFMSTR-CPLD-INIT-1ST-NM                      42415700
                         ,:TFMSTR-CPLD-LAST-NM                          42415800
                         ,:TFMSTR-LG-TTE-1ST-SEAL-ID                    42415900
                         ,:TFMSTR-LG-TTE-2ND-SEAL-ID                    42416000
                         ,:TFMSTR-SM-TTE-BAG-SEAL-ID                    42416100
                         ,:TFMSTR-TRLR-NBR                              42416200
                         ,:TFMSTR-TRLR-SEAL-ID                          42416300
                         ,:TFMSTR-CLBK-NBR                              42416400
                         ,:TFMSTR-STK-BAL-APVL-NBR                      42416500
                         ,:TFMSTR-RQSTR-INIT-1ST-NM                     42416600
                         ,:TFMSTR-RQSTR-LAST-NM                         42416700
                         ,:TFMSTR-ATTN-INIT-1ST-NM                      42416800
                         ,:TFMSTR-ATTN-LAST-NM                          42416900
                         ,:TFMSTR-WRKSHT-PROB-IND                       42417000
100404                   ,:XST00001-LOC-10-ABBR-NM                      42417100
                   FROM   TTFMSTR                                       42417200
100404                   ,XST_LOC                                       42417300
                   WHERE  XFER_DKEY_ID   = :DK-XFER-DKEY-ID     AND     42417400
100404                    TO_STR_NBR     = LOC_NBR                      42417500
               END-EXEC                                                 42417600
                                                                        42417700
               EVALUATE TRUE                                            42417800
                   WHEN SQLCODE = ZERO                                  42417900
      *               SET PS-TRANSFER-FOUND     TO TRUE                 42418000
                      MOVE TFMSTR-XFER-TYP-CDE  TO ASC-XFER-TYPE        42418100
                      MOVE TFMSTR-CONTNR-TYP-CDE TO ASC-CONTNR-TYPE     42418200
                      MOVE TFMSTR-TO-STR-NBR    TO ASC-TO-STORE-NBR-N   42418300
                      MOVE TFMSTR-CPLD-INIT-1ST-NM                      42418400
                                                TO ASC-COMP-BY-INT      42418500
                      MOVE TFMSTR-CPLD-LAST-NM  TO ASC-COMP-BY-NAM      42418600
                      MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                    42418700
                                                TO ASC-LG-TOTE-SEAL1    42418800
                      MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                    42418900
                                                TO ASC-LG-TOTE-SEAL2    42419000
                      MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                    42419100
                                                TO ASC-SM-TOTE-SEAL     42419200
                      MOVE TFMSTR-TRLR-NBR      TO ASC-TRAILER-NBR      42419300
                      MOVE TFMSTR-TRLR-SEAL-ID  TO ASC-TRAILER-SEAL     42419400
                      MOVE TFMSTR-CLBK-NBR      TO ASC-CALLBACK-NBR-N   42419500
                      MOVE TFMSTR-STK-BAL-APVL-NBR                      42419600
                                                TO ASC-APPROVAL-NBR-N   42419700
                      MOVE TFMSTR-RQSTR-INIT-1ST-NM                     42419800
                                                TO ASC-REQ-BY-INT       42419900
                      MOVE TFMSTR-RQSTR-LAST-NM TO ASC-REQ-BY-NAM       42420000
                      MOVE TFMSTR-ATTN-INIT-1ST-NM                      42420100
                                                TO ASC-ATTN-TO-INT      42420200
                      MOVE TFMSTR-ATTN-LAST-NM  TO ASC-ATTN-TO-NAM      42420300
                      MOVE TFMSTR-WRKSHT-PROB-IND                       42420400
                                                TO ASC-DSCRP-IND        42420500
100404                MOVE XST00001-LOC-10-ABBR-NM                      42420600
                                                TO ASC-TO-STORE-NAM     42420700
                      IF ASC-XFER-TYPE = PC-CUSTOMER                    42420800
                          PERFORM 6100-READ-CUSTOMER                    42420900
                      END-IF                                            42421000
                      IF ASC-XFER-TYPE NOT = PC-NON-RETAIL              42421100
                          INITIALIZE ASC-RETAIL-ITEM-ARRAY (1)          42421200
                                     ASC-RETAIL-ITEM-ARRAY (2)          42421300
                          PERFORM 6110-OPEN-RTL-CURSOR                  42421400
                          PERFORM 6120-READ-RTL-ITEMS-FROM-DB           42421500
                          PERFORM 6130-CLOSE-RTL-CURSOR                 42421600
                      ELSE                                              42421700
                          INITIALIZE ASC-NON-RETAIL-ITEM-ARRAY (1)      42421800
                                     ASC-NON-RETAIL-ITEM-ARRAY (2)      42421900
                          PERFORM 6210-OPEN-NRTL-CURSOR                 42422000
                          PERFORM 6220-READ-NRTL-ITEMS-FROM-DB          42422100
                          PERFORM 6230-CLOSE-NRTL-CURSOR                42422200
                      END-IF                                            42422300
                      IF PV-NULL-IND NOT < 0                            42422400
                          MOVE TFMSTR-XFER-SEQ-NBR TO ASC-XFER-SEQ-NBR  42422500
                          SET ASC-XFER-IS-COMPLETE TO TRUE              42422600
                      END-IF                                            42422700
                                                                        42422800
                   WHEN SQLCODE = +100                                  42422900
                   WHEN SQLCODE = -904                                  42423000
                   WHEN SQLCODE = -913                                  42423100
                       CONTINUE                                         42423200
                   WHEN OTHER                                           42423300
                       MOVE '6000-GET-CONTROL-INFO'                     42423400
                                         TO DP013-PARAGRAPH             42423500
                       MOVE 'SELECT TRANSFER DATA'                      42423600
                                         TO DP013-MESSAGE-TEXT (1)      42423700
                       MOVE SQLCA        TO DP013-SQLCA                 42423800
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    42423900
100404                 MOVE 'XST_LOC'    TO DP013-DB2-TABLE-NAME (2)    42424000
                       SET DP013-DB2-ABEND                              42424100
                           DP013-XCTL-DISPLAY-RESTART                   42424200
                                         TO TRUE                        42424300
                       PERFORM DP013-0000-PROCESS-ABEND                 42424400
               END-EVALUATE                                             42424500
           END-PERFORM.                                                 42424600
      *                                                                 42424700
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42424800
               MOVE '6000-GET-CONTROL-INFO'                             42424900
                                         TO DP013-PARAGRAPH             42425000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     42425100
                                         TO DP013-MESSAGE-TEXT (1)      42425200
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      42425300
               MOVE SQLCA                TO DP013-SQLCA                 42425400
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    42425500
100404         MOVE 'XST_LOC'            TO DP013-DB2-TABLE-NAME (2)    42425600
               SET DP013-DB2-ABEND                                      42425700
                   DP013-XCTL-DISPLAY-RESTART                           42425800
                                         TO TRUE                        42425900
               PERFORM DP013-0000-PROCESS-ABEND                         42426000
           END-IF.                                                      42426100
       EJECT                                                            42426200
      *----------------------------------------------------------------*42426300
      * SELECT DATA FROM THE TRANSFER THE CUSTOMER TABLE.              *42426400
      *----------------------------------------------------------------*42426500
       6100-READ-CUSTOMER.                                              42426600
           INITIALIZE DCLTTFCUST.                                       42426700
           PERFORM WITH TEST AFTER                                      42426800
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42426900
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  42427000
                    OR SQLCODE = ZERO                                   42427100
                    OR SQLCODE = +100                                   42427200
               EXEC SQL                                                 42427300
                   SELECT CUST_NM                                       42427400
                         ,CUST_1ST_LNE_ADDR                             42427500
                         ,CUST_2ND_LNE_ADDR                             42427600
                         ,CTY_NM                                        42427700
                         ,ST_CDE                                        42427800
                         ,ZIP_CDE                                       42427900
                         ,ZIP_EXT_CDE                                   42428000
                         ,PHN_NBR                                       42428100
                       INTO :TFCUST-CUST-NM                             42428200
                           ,:TFCUST-CUST-1ST-LNE-ADDR                   42428300
                           ,:TFCUST-CUST-2ND-LNE-ADDR                   42428400
                           ,:TFCUST-CTY-NM                              42428500
                           ,:TFCUST-ST-CDE                              42428600
                           ,:TFCUST-ZIP-CDE                             42428700
                           ,:TFCUST-ZIP-EXT-CDE                         42428800
                           ,:TFCUST-PHN-NBR                             42428900
                       FROM TTFCUST                                     42429000
                       WHERE XFER_DKEY_ID  = :DK-XFER-DKEY-ID           42429100
               END-EXEC                                                 42429200
               EVALUATE TRUE                                            42429300
                   WHEN SQLCODE = ZERO                                  42429400
                       SET ASC-CUSTOMER-EXISTS                          42429500
                                          TO TRUE                       42429600
                       MOVE TFCUST-CUST-NM                              42429700
                                          TO ASC-CUST-NAME              42429800
                       MOVE TFCUST-CUST-1ST-LNE-ADDR                    42429900
                                          TO ASC-ADDR1                  42430000
                       MOVE TFCUST-CUST-2ND-LNE-ADDR                    42430100
                                          TO ASC-ADDR2                  42430200
                       MOVE TFCUST-CTY-NM                               42430300
                                          TO ASC-CITY                   42430400
                       MOVE TFCUST-ST-CDE                               42430500
                                          TO ASC-STATE                  42430600
                       MOVE TFCUST-ZIP-CDE                              42430700
                                          TO ASC-ZIP                    42430800
                       MOVE TFCUST-ZIP-EXT-CDE                          42430900
                                          TO ASC-ZIP-EXT                42431000
                       MOVE TFCUST-PHN-NBR                              42431100
                                          TO ASC-PHONE                  42431200
                   WHEN SQLCODE = +100                                  42431300
                       SET ASC-CUSTOMER-DOES-NOT-EXIST                  42431400
                                          TO TRUE                       42431500
                       MOVE 'NOT FOUND'   TO ASC-CUST-NAME              42431600
                   WHEN SQLCODE = -904                                  42431700
                   WHEN SQLCODE = -913                                  42432000
                       CONTINUE                                         42432100
                   WHEN OTHER                                           42432200
                       MOVE '6100-READ-CUSTOMER'                        42432500
                                         TO DP013-PARAGRAPH             42432600
                       MOVE 'READ DATA FROM TTFCUST'                    42432700
                                         TO DP013-MESSAGE-TEXT (1)      42432800
                       MOVE SQLCA        TO DP013-SQLCA                 42432900
                       MOVE 'TTFCUST'    TO DP013-DB2-TABLE-NAME (1)    42433000
                       SET DP013-DB2-ABEND                              42433100
                           DP013-XCTL-DISPLAY-RESTART                   42433200
                                         TO TRUE                        42433300
                       PERFORM DP013-0000-PROCESS-ABEND                 42433400
               END-EVALUATE                                             42433500
           END-PERFORM.                                                 42433600
      *                                                                 42433700
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42433800
               MOVE '6100-READ-CUSTOMER'                                42433900
                                         TO DP013-PARAGRAPH             42434000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     42434100
                                         TO DP013-MESSAGE-TEXT (1)      42434200
               MOVE 'DATA FROM TTFCUST'  TO DP013-MESSAGE-TEXT (2)      42434300
               MOVE SQLCA                TO DP013-SQLCA                 42434400
               MOVE 'TTFCUST'            TO DP013-DB2-TABLE-NAME (1)    42434500
               SET DP013-DB2-ABEND                                      42434600
                   DP013-XCTL-DISPLAY-RESTART                           42434700
                                         TO TRUE                        42434800
               PERFORM DP013-0000-PROCESS-ABEND                         42434900
           END-IF.                                                      42435000
           EJECT                                                        42435100
      *----------------------------------------------------------------*42435200
      * OPEN THE RETAIL TRANSFER ITEM CURSOR.                          *42435300
      *----------------------------------------------------------------*42435400
       6110-OPEN-RTL-CURSOR.                                            42435500
           PERFORM                                                      42435600
               WITH TEST AFTER                                          42435700
               VARYING PV-RETRY-COUNT                                   42435800
               FROM 1 BY 1                                              42435900
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42436000
                         OR (SQLCODE = ZERO))                           42436100
                   EXEC SQL                                             42436200
                        OPEN RTL-ITEM-CSR                               42436300
                   END-EXEC                                             42436400
                                                                        42436500
               EVALUATE TRUE                                            42436600
                   WHEN SQLCODE = ZERO                                  42436700
                   WHEN SQLCODE = -904                                  42436800
                   WHEN SQLCODE = -913                                  42436900
                       CONTINUE                                         42437000
                   WHEN OTHER                                           42437100
                       MOVE '6110-OPEN-RTL-CURSOR'                      42437400
                                         TO DP013-PARAGRAPH             42437500
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              42437600
                                         TO DP013-MESSAGE-TEXT (1)      42437700
                       MOVE SQLCA        TO DP013-SQLCA                 42437800
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    42437900
                       SET DP013-DB2-ABEND                              42438000
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           42438100
                       PERFORM DP013-0000-PROCESS-ABEND                 42438200
               END-EVALUATE                                             42438300
           END-PERFORM.                                                 42438400
      *                                                                 42438500
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42438600
               MOVE '6110-OPEN-RTL-CURSOR'   TO DP013-PARAGRAPH         42438700
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   42438800
                                         TO DP013-MESSAGE-TEXT (1)      42438900
               MOVE SQLCA                TO DP013-SQLCA                 42439000
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    42439100
               SET DP013-DB2-ABEND                                      42439200
                   DP013-XCTL-DISPLAY-RESTART                           42439300
                                         TO TRUE                        42439400
               PERFORM DP013-0000-PROCESS-ABEND                         42439500
           END-IF.                                                      42439600
                                                                        42439700
       EJECT                                                            42439800
      *----------------------------------------------------------------*42439900
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *42440000
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *42440100
      *    BECOME FULL, STOP PROCESSING. (RETAIL TRANSFERS)            *42440200
      *----------------------------------------------------------------*42440300
                                                                        42440400
       6120-READ-RTL-ITEMS-FROM-DB.                                     42440500
                                                                        42440600
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       42440700
           MOVE ZEROES                   TO ASC-TQTY.                   42440800
           PERFORM                                                      42440900
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           42441000
                                                                        42441100
               PERFORM 6140-FETCH-RTL-ITEMS                             42441200
                                                                        42441300
               IF  ASC-ITEMS-LEFT-ON-DB                                 42441400
                   IF  TFITEM-XFER-LNE-NBR > PC-ITEMS-PER-RTL-PANEL     42441500
                       MOVE +2           TO ASC-BLK-SUB                 42441600
                       SUBTRACT PC-ITEMS-PER-RTL-PANEL FROM             42441700
                                         TFITEM-XFER-LNE-NBR            42441800
                   ELSE                                                 42441900
                       MOVE +1           TO ASC-BLK-SUB                 42442000
                   END-IF                                               42442100
                   ADD +1                TO ASC-NBR-OF-LINES-ENTERED    42442200
                   MOVE TFITEM-XFER-LNE-NBR TO ASC-ITEM-SUB             42442300
                   MOVE TFITEM-XFER-QTY                  TO             42443000
                           ASC-RTL-QTY-N     (ASC-BLK-SUB ASC-ITEM-SUB) 42443100
                   ADD  TFITEM-XFER-QTY                  TO ASC-TQTY    42443200
                   MOVE TFITEM-CPLD-RTL-PRIC-AMT         TO             42443300
                           ASC-FILE-PRICE    (ASC-BLK-SUB ASC-ITEM-SUB) 42443400
                   IF TFITEM-SCN-UPC-NBR > 0                            42443500
                       MOVE TFITEM-SCN-UPC-NBR           TO             42443600
                           ASC-UPC           (ASC-BLK-SUB ASC-ITEM-SUB) 42443700
                   END-IF                                               42443800
                   MOVE TFITEM-ITM-NBR                   TO             42443900
                           ASC-ITEM-NBR      (ASC-BLK-SUB ASC-ITEM-SUB) 42444000
                   MOVE SKXREF-DEPT                      TO             42444400
                           ASC-DEPT          (ASC-BLK-SUB ASC-ITEM-SUB) 42444500
                   MOVE SKXREF-CLASS                     TO             42444600
                           ASC-CLASS         (ASC-BLK-SUB ASC-ITEM-SUB) 42444700
                   MOVE SKXREF-SUBCLASS                  TO             42444800
                           ASC-SUBCLASS      (ASC-BLK-SUB ASC-ITEM-SUB) 42444900
                   MOVE TFITEM-KOHLS-UPC-NBR             TO             42445000
                           ASC-KOHLS-UPC     (ASC-BLK-SUB ASC-ITEM-SUB) 42445100
                   MOVE TFITEM-XFER-PRIC-AMT             TO             42445200
                           ASC-PRICE-N       (ASC-BLK-SUB ASC-ITEM-SUB) 42445300
               END-IF                                                   42445400
           END-PERFORM.                                                 42445500
                                                                        42445600
       EJECT                                                            42445700
      *----------------------------------------------------------------*42445800
      * CLOSE THE TRANSFER ITEM CURSOR.                                *42445900
      *----------------------------------------------------------------*42446000
                                                                        42446100
       6130-CLOSE-RTL-CURSOR.                                           42446200
           EXEC SQL                                                     42446300
               CLOSE RTL-ITEM-CSR                                       42446400
           END-EXEC                                                     42446500
      *                                                                 42446600
           EVALUATE TRUE                                                42446700
               WHEN SQLCODE = ZERO                                      42446800
                   CONTINUE                                             42446900
               WHEN OTHER                                               42447000
                   MOVE '6130-CLOSE-RTL-CURSOR'                         42447300
                                     TO DP013-PARAGRAPH                 42447400
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   42447500
                                     TO DP013-MESSAGE-TEXT (1)          42447600
                   MOVE SQLCA        TO DP013-SQLCA                     42447700
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        42447800
                   SET DP013-DB2-ABEND                                  42447900
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               42448000
                   PERFORM DP013-0000-PROCESS-ABEND                     42448100
           END-EVALUATE.                                                42448200
                                                                        42448300
       EJECT                                                            42448400
      *----------------------------------------------------------------*42448500
      *    FETCH THE TRANSFER ITEM CURSOR. (RETAIL TRANSFERS)          *42448600
      *----------------------------------------------------------------*42448700
                                                                        42448800
       6140-FETCH-RTL-ITEMS.                                            42448900
                                                                        42449000
           EXEC SQL                                                     42449100
               FETCH RTL-ITEM-CSR                                       42449200
               INTO                                                     42449300
                      :TFITEM-XFER-LNE-NBR                              42449400
                    , :TFITEM-CPLD-RTL-PRIC-AMT                         42449500
                    , :TFITEM-SCN-UPC-NBR                               42449600
                    , :TFITEM-KOHLS-UPC-NBR                             42449700
                    , :TFITEM-ITM-NBR                                   42449800
                    , :TFITEM-XFER-PRIC-AMT                             42449900
                    , :TFITEM-XFER-QTY                                  42450000
           END-EXEC                                                     42450400
                                                                        42450500
           EVALUATE TRUE                                                42450600
               WHEN SQLCODE = ZERO                                      42450700
                    PERFORM 6150-SELECT-DEPT-CLASS                      42450800
               WHEN SQLCODE = +100                                      42450900
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         42451000
                                         TO TRUE                        42451100
               WHEN OTHER                                               42451200
                    MOVE '6140-FETCH-RTL-ITEMS'                         42451400
                                     TO DP013-PARAGRAPH                 42451500
                    MOVE 'FETCH RETAIL TRANSFER ITEM CURSOR'            42451600
                                     TO DP013-MESSAGE-TEXT (1)          42451700
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        42451800
                    MOVE SQLCA       TO DP013-SQLCA                     42451900
                    SET DP013-DB2-ABEND                                 42452000
                                     TO TRUE                            42452100
                    PERFORM DP013-0000-PROCESS-ABEND                    42452200
           END-EVALUATE.                                                42452300
                                                                        42452400
       EJECT                                                            42452500
                                                                        42452600
       6150-SELECT-DEPT-CLASS.                                          42452700
           PERFORM                                                      42452800
             WITH TEST AFTER                                            42452900
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42453000
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  42453100
                    OR SQLCODE = ZERO                                   42453200
                    OR SQLCODE = +100                                   42453300
               EXEC SQL                                                 42453400
                   SELECT  DEPT,                                        42453500
                           CLASS,                                       42453600
                           SUBCLASS                                     42453700
                     INTO  :SKXREF-DEPT,                                42453800
                           :SKXREF-CLASS,                               42453900
                           :SKXREF-SUBCLASS                             42454000
                     FROM  TSKXREF                                      42454100
                    WHERE   ITM_NBR     =  :TFITEM-ITM-NBR              42454200
               END-EXEC                                                 42454400
                                                                        42454500
               EVALUATE TRUE                                            42454600
                   WHEN SQLCODE = ZERO                                  42454700
                       CONTINUE                                         42454800
                   WHEN SQLCODE = -904                                  42455300
                   WHEN SQLCODE = -913                                  42455400
                       CONTINUE                                         42455500
                   WHEN SQLCODE = +100                                  42455600
      ******* EXTRACT DEPT, CLASS AND SUBCLASS EMBEDDED IN UPC          42455700
                       MOVE TFITEM-KOHLS-UPC-NBR TO PV-HOLD-UPC-NBR-9   42455800
                       MOVE PV-KOHLS-DEPT TO SKXREF-DEPT                42455900
                       MOVE PV-KOHLS-CL-9 TO SKXREF-SUBCLASS            42456000
                       MOVE ZERO          TO PV-KOHLS-CL-2              42456100
                       MOVE PV-KOHLS-CL-9 TO SKXREF-CLASS               42456200
                   WHEN OTHER                                           42456400
                       MOVE '6150-SELECT-DEPT-CLASS'                    42456700
                                           TO DP013-PARAGRAPH           42456800
                       MOVE 'READ A ROW FROM TSKXREF'                   42456900
                                           TO DP013-MESSAGE-TEXT (1)    42457000
                       MOVE SQLCA          TO DP013-SQLCA               42457100
                       MOVE 'TSKXREF'      TO DP013-DB2-TABLE-NAME (1)  42457200
                       SET DP013-DB2-ABEND TO TRUE                      42457300
                       PERFORM DP013-0000-PROCESS-ABEND                 42457400
               END-EVALUATE                                             42457500
           END-PERFORM.                                                 42457600
                                                                        42457700
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42457800
               MOVE '6150-SELECT-DEPT-CLASS' TO DP013-PARAGRAPH         42457900
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT '    42458000
                                           TO DP013-MESSAGE-TEXT (1)    42458100
               MOVE 'DATA FROM TSKXREF'    TO DP013-MESSAGE-TEXT (2)    42458200
               MOVE SQLCA                  TO DP013-SQLCA               42458300
               MOVE 'TSKXREF'              TO DP013-DB2-TABLE-NAME (1)  42458400
               SET DP013-DB2-ABEND         TO TRUE                      42458500
               PERFORM DP013-0000-PROCESS-ABEND                         42458600
           END-IF.                                                      42458700
                                                                        42458800
      *----------------------------------------------------------------*42458900
      * OPEN THE NON-RETAIL TRANSFER ITEM CURSOR.                      *42459000
      *----------------------------------------------------------------*42459100
       6210-OPEN-NRTL-CURSOR.                                           42459200
           PERFORM                                                      42459300
               WITH TEST AFTER                                          42459400
               VARYING PV-RETRY-COUNT                                   42459500
               FROM 1 BY 1                                              42459600
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42459700
                         OR (SQLCODE = ZERO))                           42459800
                   EXEC SQL                                             42459900
                        OPEN NRTL-ITEM-CSR                              42460000
                   END-EXEC                                             42460100
                                                                        42460200
               EVALUATE TRUE                                            42460300
                   WHEN SQLCODE = ZERO                                  42460400
                   WHEN SQLCODE = -904                                  42460500
                   WHEN SQLCODE = -913                                  42460600
                       CONTINUE                                         42460700
                   WHEN OTHER                                           42460800
                       MOVE '6210-OPEN-NRTL-CURSOR'                     42461100
                                         TO DP013-PARAGRAPH             42461200
                       MOVE 'OPEN TRANSFER ITEM CURSOR - '              42461300
                                         TO DP013-MESSAGE-TEXT (1)      42461400
                       MOVE SQLCA        TO DP013-SQLCA                 42461500
                       MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)    42461600
                       SET DP013-DB2-ABEND                              42461700
                           DP013-XCTL-DISPLAY-RESTART TO TRUE           42461800
                       PERFORM DP013-0000-PROCESS-ABEND                 42461900
               END-EVALUATE                                             42462000
           END-PERFORM.                                                 42462100
      *                                                                 42462200
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42462300
               MOVE '6210-OPEN-NRTL-CURSOR'   TO DP013-PARAGRAPH        42462400
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   42462500
                                         TO DP013-MESSAGE-TEXT (1)      42462600
               MOVE SQLCA                TO DP013-SQLCA                 42462700
               MOVE 'TTFITEM '           TO DP013-DB2-TABLE-NAME (1)    42462800
               SET DP013-DB2-ABEND                                      42462900
                   DP013-XCTL-DISPLAY-RESTART                           42463000
                                         TO TRUE                        42463100
               PERFORM DP013-0000-PROCESS-ABEND                         42463200
           END-IF.                                                      42463300
                                                                        42463400
       EJECT                                                            42463500
      *----------------------------------------------------------------*42463600
      *    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *42463700
      *    BLOCKS IN THE ARRAY.  THE LIMIT IS 2 BLOCKS; WHEN THEY      *42463800
      *    BECOME FULL, STOP PROCESSING. (NON-RETAIL TRANSFERS)        *42463900
      *----------------------------------------------------------------*42464000
                                                                        42464100
       6220-READ-NRTL-ITEMS-FROM-DB.                                    42464200
                                                                        42464300
           SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       42464400
           MOVE ZEROES                   TO ASC-TQTY.                   42464500
           PERFORM                                                      42464600
               UNTIL  ASC-NO-ITEMS-LEFT-ON-DB                           42464700
                                                                        42464800
               PERFORM 6240-FETCH-NRTL-ITEMS                            42464900
                                                                        42465000
               IF  ASC-ITEMS-LEFT-ON-DB                                 42465100
                   IF  TFITEM-XFER-LNE-NBR > PC-ITEMS-PER-NRTL-PANEL    42465200
                       MOVE +2           TO ASC-BLK-SUB                 42465300
                       SUBTRACT PC-ITEMS-PER-NRTL-PANEL FROM            42465400
                                         TFITEM-XFER-LNE-NBR            42465500
                   ELSE                                                 42465600
                       MOVE +1           TO ASC-BLK-SUB                 42465700
                   END-IF                                               42465800
                   ADD +1                TO ASC-NBR-OF-LINES-ENTERED    42465900
                   MOVE TFITEM-XFER-LNE-NBR TO ASC-ITEM-SUB             42466000
                   MOVE TFITEM-NRTL-FIXT-ID              TO             42466100
                           ASC-FIXTURE       (ASC-BLK-SUB ASC-ITEM-SUB) 42466200
                   MOVE TFITEM-NRTL-DEPT-NBR             TO             42466300
                           ASC-NRTL-DEPT     (ASC-BLK-SUB ASC-ITEM-SUB) 42466400
                   MOVE TFITEM-NRTL-1ST-LNE-DESC         TO             42466500
                           ASC-ITEM-DESC1    (ASC-BLK-SUB ASC-ITEM-SUB) 42466600
                   MOVE TFITEM-NRTL-2ND-LNE-DESC         TO             42466700
                           ASC-ITEM-DESC2    (ASC-BLK-SUB ASC-ITEM-SUB) 42466800
                   MOVE TFITEM-XFER-QTY                  TO             42466900
                           ASC-NRTL-QTY-N    (ASC-BLK-SUB ASC-ITEM-SUB) 42467000
                   ADD  TFITEM-XFER-QTY                  TO ASC-TQTY    42467100
               END-IF                                                   42467200
           END-PERFORM.                                                 42467300
                                                                        42467400
       EJECT                                                            42467500
      *----------------------------------------------------------------*42467600
      * CLOSE THE NON-RETAIL TRANSFER ITEM CURSOR.                     *42467700
      *----------------------------------------------------------------*42467800
                                                                        42467900
       6230-CLOSE-NRTL-CURSOR.                                          42468000
           EXEC SQL                                                     42468100
               CLOSE NRTL-ITEM-CSR                                      42468200
           END-EXEC                                                     42468300
      *                                                                 42468400
           EVALUATE TRUE                                                42468500
               WHEN SQLCODE = ZERO                                      42468600
                   CONTINUE                                             42468700
               WHEN OTHER                                               42468800
                   MOVE '6230-CLOSE-NRTL-CURSOR'                        42469100
                                     TO DP013-PARAGRAPH                 42469200
                   MOVE 'CLOSE TRANSFER ITEM CURSOR '                   42469300
                                     TO DP013-MESSAGE-TEXT (1)          42469400
                   MOVE SQLCA        TO DP013-SQLCA                     42469500
                   MOVE 'TTFITEM '   TO DP013-DB2-TABLE-NAME (1)        42469600
                   SET DP013-DB2-ABEND                                  42469700
                       DP013-XCTL-DISPLAY-RESTART TO TRUE               42469800
                   PERFORM DP013-0000-PROCESS-ABEND                     42469900
           END-EVALUATE.                                                42470000
                                                                        42470100
       EJECT                                                            42470200
      *----------------------------------------------------------------*42470300
      *    FETCH THE TRANSFER ITEM CURSOR. (NON-RETAIL)                *42470400
      *----------------------------------------------------------------*42470500
                                                                        42470600
       6240-FETCH-NRTL-ITEMS.                                           42470700
                                                                        42470800
           EXEC SQL                                                     42470900
               FETCH NRTL-ITEM-CSR                                      42471000
               INTO                                                     42471100
                      :TFITEM-XFER-LNE-NBR                              42471200
                    , :TFITEM-NRTL-1ST-LNE-DESC                         42471300
                    , :TFITEM-NRTL-2ND-LNE-DESC                         42471400
                    , :TFITEM-NRTL-FIXT-ID                              42471500
                    , :TFITEM-NRTL-DEPT-NBR                             42471600
                    , :TFITEM-XFER-QTY                                  42471700
           END-EXEC                                                     42471800
                                                                        42471900
           EVALUATE TRUE                                                42472000
               WHEN SQLCODE = ZERO                                      42472100
                    CONTINUE                                            42472200
               WHEN SQLCODE = +100                                      42472300
                    SET ASC-NO-ITEMS-LEFT-ON-DB                         42472400
                                         TO TRUE                        42472500
               WHEN OTHER                                               42472600
                    MOVE '6240-FETCH-NRTL-ITEMS'                        42472800
                                     TO DP013-PARAGRAPH                 42472900
                    MOVE 'FETCH NON-RETAIL TRANSFER ITEM CURSOR'        42473000
                                     TO DP013-MESSAGE-TEXT (1)          42473100
                    MOVE 'TTFITEM '  TO DP013-DB2-TABLE-NAME (1)        42473200
                    MOVE SQLCA       TO DP013-SQLCA                     42473300
                    SET DP013-DB2-ABEND                                 42473400
                                     TO TRUE                            42473500
                    PERFORM DP013-0000-PROCESS-ABEND                    42473600
           END-EVALUATE.                                                42473700
                                                                        42473800
       EJECT                                                            42473900
      *----------------------------------------------------------------*42474000
      * PRODUCE THE LIST REPORT USING THE DRS FACILITY.                *42474100
      *----------------------------------------------------------------*42474200
       6500-PRINT-LIST.                                                 42474300
                                                                        42474400
           PERFORM 6510-INITIALIZE.                                     42474500
           MOVE PC-PUT                 TO DRS01-DRRB-FUNC.              42474600
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         42474700
               PERFORM 6520-PRINT-RTL-REPORT                            42474800
                 VARYING PV-BLOCK                                       42474900
                   FROM 1 BY 1 UNTIL                                    42475000
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              42475100
                 AFTER PV-ITEM                                          42475200
                   FROM 1 BY 1                                          42475300
                   UNTIL PV-ITEM >  PC-ITEMS-PER-RTL-PANEL              42475400
           ELSE                                                         42475500
               PERFORM 6530-PRINT-NRTL-REPORT                           42475600
                 VARYING PV-BLOCK                                       42475700
                   FROM 1 BY 1 UNTIL                                    42475800
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              42475900
                 AFTER PV-ITEM                                          42476000
                   FROM 1 BY 1                                          42476100
                   UNTIL PV-ITEM >  PC-ITEMS-PER-NRTL-PANEL             42476200
           END-IF.                                                      42476300
                                                                        42476400
           MOVE PC-TERM                TO DRS01-DRRB-FUNC.              42476500
           PERFORM 8000-LINK-TO-DRS.                                    42476600
                                                                        42476700
      *----------------------------------------------------------------*42476800
      * INITIALIZE VARIABLES FOR DRS PRINTING.                         *42476900
      *----------------------------------------------------------------*42477000
       6510-INITIALIZE.                                                 42477100
           PERFORM 8100-FORMAT-TIME.                                    42477200
                                                                        42477300
           IF TF001-PRINTER-DEST = 'XXXX'                               42477400
               MOVE 'R'                TO DRS02-DRIB-CLASS              42477500
               MOVE 'N'                TO DRS02-DRIB-HOLD               42477600
               MOVE 'LOCAL'            TO DRS02-DRIB-DEST               42477700
           ELSE                                                         42477800
               MOVE 'A'                TO DRS02-DRIB-CLASS              42477900
               MOVE 'N'                TO DRS02-DRIB-HOLD               42478000
               MOVE TF001-PRINTER-DEST TO DRS02-DRIB-DEST               42478100
           END-IF.                                                      42478200
                                                                        42478300
           MOVE PC-INIT                TO DRS01-DRRB-FUNC.              42478400
           MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          42478500
           MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          42478600
                                                                        42478700
           PERFORM 8000-LINK-TO-DRS.                                    42478800
                                                                        42478900
           MOVE PC-CURRENT-PROGRAM-NAME TO DP132O-PROGRAM-NAME.         42479000
           MOVE 1                       TO DP132O-REPORT-NUMBER.        42479100
           MOVE ASC-CONTROL-NBR         TO HL3-CONTROL-NBR.             42479200
           MOVE ASC-TO-STORE-NBR        TO HL3-TO-STORE-NBR.            42479300
           MOVE ASC-TO-STORE-NAM        TO HL3-TO-STORE-NAM.            42479400
           MOVE ASC-XFER-TYPE           TO HL4-XFER-TYPE.               42479500
           MOVE ASC-XFER-DESC           TO HL4-XFER-DESC.               42479600
           MOVE ASC-CONTNR-TYPE         TO HL4-CONTNR-TYPE.             42479700
           MOVE ASC-CONTNR-DESC         TO HL4-CONTNR-DESC.             42479800
           MOVE ASC-COMP-BY-INT         TO HL5-COMP-BY-INT.             42479900
           MOVE ASC-COMP-BY-NAM         TO HL5-COMP-BY-NAM.             42480000
           EVALUATE ASC-XFER-TYPE                                       42480100
              WHEN PC-CALLBACK                                          42480200
                 MOVE PC-CALLBACK-LITERAL                               42480300
                                        TO HL5-LITERAL                  42480400
                 MOVE ASC-CALLBACK-NBR  TO HL5-FIELD                    42480500
              WHEN PC-STOCK-BAL-CORP                                    42480600
                 MOVE PC-APPROVAL-LITERAL                               42480700
                                        TO HL5-LITERAL                  42480800
                 MOVE ASC-APPROVAL-NBR  TO HL5-FIELD                    42480900
              WHEN PC-NON-RETAIL                                        42481000
                 MOVE PC-REQUESTOR-LITERAL                              42481100
                                        TO HL5-LITERAL                  42481200
                 MOVE ASC-REQ-BY-INT    TO PV-INT                       42481300
                 MOVE ASC-REQ-BY-NAM    TO PV-LAST-NAME                 42481400
                 MOVE PV-NAME           TO HL5-FIELD                    42481500
                 MOVE ASC-ATTN-TO-INT   TO HL6A-ATTN-TO-INT             42481600
                 MOVE ASC-ATTN-TO-NAM   TO HL6A-ATTN-TO-NAM             42481700
              WHEN PC-CUSTOMER                                          42481800
                 MOVE PC-REQUESTOR-LITERAL                              42481900
                                        TO HL5-LITERAL                  42482000
                 MOVE ASC-REQ-BY-INT    TO PV-INT                       42482100
                 MOVE ASC-REQ-BY-NAM    TO PV-LAST-NAME                 42482200
                 MOVE PV-NAME           TO HL5-FIELD                    42482300
                 MOVE ASC-CUST-NAME     TO HL6B-CUST-NAME               42482400
                 MOVE ASC-PHONE-AREA    TO HL6B-PHONE-AREA              42482500
                 MOVE ASC-PHONE-EXCH    TO HL6B-PHONE-EXCH              42482600
                 MOVE ASC-PHONE-NBR     TO HL6B-PHONE-NBR               42482700
                 MOVE ASC-ADDR1         TO HL7-ADDRESS                  42482800
                 MOVE ASC-CITY          TO HL7-CITY                     42482900
                 MOVE ASC-ADDR2         TO HL8-ADDRESS                  42483000
                 MOVE ASC-STATE         TO HL8-STATE                    42483100
                 MOVE ASC-ZIP           TO HL8-ZIP                      42483200
                 IF ASC-ZIP-EXT > SPACES                                42483300
                     MOVE ASC-ZIP-EXT   TO HL8-ZIP-EXT                  42483400
                     MOVE '-'           TO HL8-DASH                     42483500
                 END-IF                                                 42483600
           END-EVALUATE.                                                42483700
           EVALUATE ASC-CONTNR-TYPE                                     42483800
              WHEN PC-TRAILER                                           42483900
                 MOVE PC-TRLR-SEAL-LITERAL                              42484000
                                        TO HL9-LITERAL-1                42484100
                 MOVE ASC-TRAILER-SEAL  TO HL9-FIELD-1                  42484200
                 MOVE PC-TRLR-NBR-LITERAL                               42484300
                                        TO HL9-LITERAL-2                42484400
                 MOVE ASC-TRAILER-NBR   TO HL9-FIELD-2                  42484500
              WHEN OTHER                                                42484600
                 MOVE PC-LG-TOTE-LITERAL                                42484700
                                        TO HL9-LITERAL-1                42484800
                 MOVE ASC-LG-TOTE-SEAL1 TO PV-LG-TOTE-SEAL1             42484900
                 MOVE ASC-LG-TOTE-SEAL2 TO PV-LG-TOTE-SEAL2             42485000
                 MOVE PV-LG-TOTE-FIELD  TO HL9-FIELD-1                  42485100
                 MOVE PC-SM-TOTE-LITERAL                                42485200
                                        TO HL9-LITERAL-2                42485300
                 MOVE ASC-SM-TOTE-SEAL  TO HL9-FIELD-2                  42485400
           END-EVALUATE.                                                42485500
                                                                        42485600
           MOVE 99                      TO PV-LINE-COUNT.               42485700
           MOVE 0                       TO PV-PAGE-COUNT.               42485800
       EJECT                                                            42485900
      *----------------------------------------------------------------*42486000
      * MOVE THE APPROPRIATE FIELDS TO THE DETAIL LINE AND PRINT.      *42486100
      *  RETAIL TRANSFER TYPES.                                        *42486200
      *----------------------------------------------------------------*42486300
       6520-PRINT-RTL-REPORT.                                           42486400
           IF PV-LINE-COUNT > PC-LINE-MAX                               42486500
               PERFORM 8200-PRINT-HEADINGS                              42486600
           END-IF.                                                      42486700
           IF PV-BLOCK = +2                                             42486800
               COMPUTE PV-LINE-NBR = PV-ITEM + PC-ITEMS-PER-RTL-PANEL   42486900
           ELSE                                                         42487000
               MOVE PV-ITEM              TO PV-LINE-NBR                 42487100
           END-IF.                                                      42487200
           DIVIDE PV-ITEM BY +2                                         42487300
               GIVING PV-SUB                                            42487400
                 REMAINDER PV-REMAINDER.                                42487500
           IF  PV-REMAINDER > ZERO                                      42487600
               MOVE PV-LINE-NBR          TO DL1A-LIN1                   42487700
      *********************************************************         42487800
               MOVE ASC-DEPT (PV-BLOCK PV-ITEM)                         42487900
                               TO DL1A-DEPT                             42488000
               IF ASC-CLASS (PV-BLOCK PV-ITEM)                          42488100
                                           < PC-100 AND                 42488200
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42488300
                                           < PC-100                     42488400
                MOVE ASC-CLASS                                          42488500
                (PV-BLOCK PV-ITEM) TO DL1A-CLASS-1                      42488600
                MOVE ASC-SUBCLASS                                       42488700
                (PV-BLOCK PV-ITEM) TO DL1A-SUBCLASS-1                   42488800
               ELSE IF                                                  42488900
                ASC-CLASS (PV-BLOCK PV-ITEM)                            42489000
                                           < PC-100 AND                 42489100
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42489200
                                           > PC-099                     42489300
                MOVE ASC-CLASS                                          42489400
                (PV-BLOCK PV-ITEM) TO DL1A-CLASS-2                      42489500
                MOVE ASC-SUBCLASS                                       42489600
                (PV-BLOCK PV-ITEM) TO DL1A-SUBCLASS-2                   42489700
                MOVE SPACES TO DL1A-FILLER-2A                           42489800
               ELSE IF                                                  42489900
                ASC-CLASS (PV-BLOCK PV-ITEM)                            42490000
                                           > PC-099 AND                 42490100
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42490200
                                           < PC-100                     42490300
                MOVE ASC-CLASS                                          42490400
                (PV-BLOCK PV-ITEM) TO DL1A-CLASS-3                      42490500
                MOVE ASC-SUBCLASS                                       42490600
                (PV-BLOCK PV-ITEM) TO DL1A-SUBCLASS-3                   42490700
                MOVE SPACES TO DL1A-FILLER-3A                           42490800
               ELSE IF                                                  42490900
                ASC-CLASS (PV-BLOCK PV-ITEM)                            42491000
                                           > PC-099 AND                 42491100
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42491200
                                           > PC-099                     42491300
                MOVE ASC-CLASS                                          42491400
                (PV-BLOCK PV-ITEM) TO DL1A-CLASS-4                      42491500
                MOVE ASC-SUBCLASS                                       42491600
                (PV-BLOCK PV-ITEM) TO DL1A-SUBCLASS-4                   42491700
               END-IF                                                   42491800
               END-IF                                                   42491900
               END-IF                                                   42492000
               END-IF                                                   42492100
      *********************************************************         42492200
               MOVE ASC-UPC (PV-BLOCK PV-ITEM)                          42492300
                                         TO DL1A-UPC1                   42492400
               IF ASC-PRICE (PV-BLOCK PV-ITEM) > SPACES                 42492500
                   MOVE ASC-PRICE-N (PV-BLOCK PV-ITEM)                  42492600
                                         TO DL1A-PRC1                   42492700
               END-IF                                                   42492800
               MOVE ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)                    42492900
                                         TO DL1A-QTY1                   42493000
           ELSE                                                         42493100
               MOVE PV-LINE-NBR          TO DL1A-LIN2                   42493200
      *********************************************************         42493300
               MOVE ASC-DEPT (PV-BLOCK PV-ITEM)                         42493400
                               TO DL2A-DEPT                             42493500
               IF ASC-CLASS (PV-BLOCK PV-ITEM)                          42493600
                                           < PC-100 AND                 42493700
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42493800
                                           < PC-100                     42493900
                MOVE ASC-CLASS                                          42494000
                (PV-BLOCK PV-ITEM) TO DL2A-CLASS-1                      42494100
                MOVE ASC-SUBCLASS                                       42494200
                (PV-BLOCK PV-ITEM) TO DL2A-SUBCLASS-1                   42494300
               ELSE IF                                                  42494400
                ASC-CLASS (PV-BLOCK PV-ITEM)                            42494500
                                           < PC-100 AND                 42494600
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42494700
                                           > PC-099                     42494800
                MOVE ASC-CLASS                                          42494900
                (PV-BLOCK PV-ITEM) TO DL2A-CLASS-2                      42495000
                MOVE ASC-SUBCLASS                                       42495100
                (PV-BLOCK PV-ITEM) TO DL2A-SUBCLASS-2                   42495200
                MOVE SPACES TO DL2A-FILLER-2A                           42495300
               ELSE IF                                                  42495400
                ASC-CLASS (PV-BLOCK PV-ITEM)                            42495500
                                           > PC-099 AND                 42495600
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42495700
                                           < PC-100                     42495800
                MOVE ASC-CLASS                                          42495900
                (PV-BLOCK PV-ITEM) TO DL2A-CLASS-3                      42496000
                MOVE ASC-SUBCLASS                                       42496100
                (PV-BLOCK PV-ITEM) TO DL2A-SUBCLASS-3                   42496200
                MOVE SPACES TO DL2A-FILLER-3A                           42496300
               ELSE IF                                                  42496400
                ASC-CLASS (PV-BLOCK PV-ITEM)                            42496500
                                           > PC-099 AND                 42496600
                ASC-SUBCLASS (PV-BLOCK PV-ITEM)                         42496700
                                           > PC-099                     42496800
                MOVE ASC-CLASS                                          42496900
                (PV-BLOCK PV-ITEM) TO DL2A-CLASS-4                      42497000
                MOVE ASC-SUBCLASS                                       42497100
                (PV-BLOCK PV-ITEM) TO DL2A-SUBCLASS-4                   42497200
               END-IF                                                   42497300
               END-IF                                                   42497400
               END-IF                                                   42497500
               END-IF                                                   42497600
      *********************************************************         42497700
               MOVE ASC-UPC (PV-BLOCK PV-ITEM)                          42497800
                                         TO DL1A-UPC2                   42497900
               IF ASC-PRICE (PV-BLOCK PV-ITEM) > SPACES                 42498000
                   MOVE ASC-PRICE-N (PV-BLOCK PV-ITEM)                  42498100
                                         TO DL1A-PRC2                   42498200
               END-IF                                                   42498300
               MOVE ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)                    42498400
                                         TO DL1A-QTY2                   42498500
               MOVE DL1A-DETAIL-LINE-1A                                 42498600
                                         TO DRS01-COMM-DATA             42498700
               MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              42498800
               PERFORM 8000-LINK-TO-DRS                                 42498900
               ADD 1                     TO PV-LINE-COUNT               42499000
               MOVE SPACES               TO DL1A-DETAIL-LINE-1A         42499100
           END-IF                                                       42499200
           IF PV-BLOCK = +2 AND                                         42499300
              PV-ITEM  = +1                                             42499400
               MOVE BL-BLANK-LINE        TO DRS01-COMM-DATA             42499500
               MOVE PC-SINGLE-SPACE      TO DRS01-COMM-CTL              42499600
               PERFORM 8000-LINK-TO-DRS                                 42499700
               ADD 1                   TO PV-LINE-COUNT                 42499800
           END-IF.                                                      42499900
       EJECT                                                            42500000
      *----------------------------------------------------------------*42500100
      * MOVE THE APPROPRIATE FIELDS TO THE DETAIL LINE AND PRINT.      *42500200
      *  RETAIL TRANSFER TYPES.                                        *42500300
      *----------------------------------------------------------------*42500400
       6530-PRINT-NRTL-REPORT.                                          42500500
           IF PV-LINE-COUNT > PC-LINE-MAX                               42500600
               PERFORM 8200-PRINT-HEADINGS                              42500700
           END-IF.                                                      42500800
           IF PV-BLOCK = +2 AND                                         42500900
              PV-ITEM  = +1                                             42501000
               MOVE BL-BLANK-LINE        TO DRS01-COMM-DATA             42501100
               MOVE PC-SINGLE-SPACE    TO DRS01-COMM-CTL                42501200
               PERFORM 8000-LINK-TO-DRS                                 42501300
               ADD 1                   TO PV-LINE-COUNT                 42501400
           END-IF.                                                      42501500
           IF PV-BLOCK = +2                                             42501600
               COMPUTE PV-LINE-NBR = PV-ITEM + PC-ITEMS-PER-NRTL-PANEL  42501700
           ELSE                                                         42501800
               MOVE PV-ITEM              TO PV-LINE-NBR                 42501900
           END-IF.                                                      42502000
           MOVE PV-LINE-NBR              TO DL1B-LINE                   42502100
           MOVE ASC-ITEM-DESC (PV-BLOCK PV-ITEM)                        42502200
                                         TO DL1B-DESCRIPTION            42502300
           MOVE ASC-NRTL-QTY-N  (PV-BLOCK PV-ITEM)                      42502400
                                         TO DL1B-QTY                    42502500
           MOVE ASC-FIXTURE (PV-BLOCK PV-ITEM)                          42502600
                                         TO DL1B-FIXTURE                42502700
           MOVE ASC-NRTL-DEPT (PV-BLOCK PV-ITEM)                        42502800
                                         TO DL1B-DEPT                   42502900
           MOVE DL1B-DETAIL-LINE-1B                                     42503000
                                         TO DRS01-COMM-DATA             42503100
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               42503200
           PERFORM 8000-LINK-TO-DRS.                                    42503300
           ADD 1                       TO PV-LINE-COUNT.                42503400
       EJECT                                                            42503500
      *----------------------------------------------------------------*42503600
      *  UPDATE AND INSERT ROWS IN THE APPROPRIATE TABLES WHEN THE     *42503700
      *  COMPLETE TRANSFER FUNCTION IS SELECTED.                       *42503800
      *----------------------------------------------------------------*42503900
       7000-COMPLETE-TRANSFER.                                          42504000
           PERFORM 7100-PREPARE-COMPLETE.                               42504100
           INITIALIZE DCLTTFMSTR.                                       42504200
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          42504300
           MOVE DP020-USERID               TO TFMSTR-CPLD-XFER-USR-ID.  42504400
           MOVE PV-XFER-SEQ-NBR            TO TFMSTR-XFER-SEQ-NBR       42504500
                                              ASC-XFER-SEQ-NBR.         42504600
           MOVE ASC-ERROR-SW               TO TFMSTR-WRKSHT-PROB-IND.   42504700
           EXEC SQL                                                     42504800
               SET :PV-DB2-TIMESTAMP = CURRENT TIMESTAMP                42504900
           END-EXEC.                                                    42505000
           PERFORM 7200-COMPLETE-TTFMSTR                                42505100
           PERFORM 5500-DELETE-XFER-ITEMS.                              42505200
           MOVE 0                    TO PV-LINE-NBR.                    42505300
           IF ASC-XFER-TYPE NOT = PC-NON-RETAIL                         42505400
               PERFORM 9000-CHECK-RETAIL-ITEMS                          42505500
                 VARYING ASC-BLK-SUB                                    42505600
                   FROM 1 BY 1 UNTIL                                    42505700
                         ASC-BLK-SUB  > PC-MAX-BLOCKS-IN-ARRAY          42505800
                 AFTER ASC-ITEM-SUB                                     42505900
                   FROM 1 BY 1 UNTIL                                    42506000
                         ASC-ITEM-SUB > PC-ITEMS-PER-RTL-PANEL          42506100
           ELSE                                                         42506200
               PERFORM 9200-CHECK-NON-RETAIL-ITEMS                      42506300
                 VARYING ASC-BLK-SUB                                    42506400
                   FROM 1 BY 1 UNTIL                                    42506500
                         ASC-BLK-SUB  > PC-MAX-BLOCKS-IN-ARRAY          42506600
                 AFTER ASC-ITEM-SUB                                     42506700
                   FROM 1 BY 1 UNTIL                                    42506800
                         ASC-ITEM-SUB > PC-ITEMS-PER-NRTL-PANEL         42506900
           END-IF.                                                      42507000
           PERFORM 7400-INSERT-STATUS.                                  42507100
      *----------------------------------------------------------------*42507200
      *  DETERMINE THE NEXT SEQUENCE NUMBER TO BE ASSIGNED AS THE      *42507300
      *  TRANSFER NUMBER FOR THIS STORE.                               *42507400
      *----------------------------------------------------------------*42507500
       7100-PREPARE-COMPLETE.                                           42507600
           MOVE ASC-FR-STORE-NBR-N TO DK-STORE-NBR.                     42507700
           PERFORM                                                      42507800
               WITH TEST AFTER                                          42507900
               VARYING PV-RETRY-COUNT                                   42508000
               FROM 1 BY 1                                              42508100
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42508200
                         OR (SQLCODE = ZERO)                            42508300
                         OR (SQLCODE = +100))                           42508400
      *                                                                 42508500
               EXEC SQL                                                 42508600
                   SELECT MAX(XFER_SEQ_NBR)                             42508700
                   INTO   :PV-XFER-SEQ-NBR                              42508800
                          :PV-NULL-IND                                  42508900
                   FROM   TTFMSTR                                       42509000
                   WHERE  FR_STR_NBR     = :DK-STORE-NBR        AND     42509100
                          XFER_SEQ_NBR   IS NOT NULL                    42509200
               END-EXEC                                                 42509300
                                                                        42509400
               EVALUATE TRUE                                            42509500
                   WHEN SQLCODE = ZERO                                  42509600
                   WHEN SQLCODE = +100                                  42509700
                   WHEN SQLCODE = -904                                  42509800
                   WHEN SQLCODE = -913                                  42509900
                       CONTINUE                                         42510000
                   WHEN OTHER                                           42510100
                       MOVE '7100-PREPARE-COMPLETE'                     42510400
                                         TO DP013-PARAGRAPH             42510500
                       MOVE 'SELECT TRANSFER DATA'                      42510600
                                         TO DP013-MESSAGE-TEXT (1)      42510700
                       MOVE SQLCA        TO DP013-SQLCA                 42510800
                       MOVE 'TTFMSTR'    TO DP013-DB2-TABLE-NAME (1)    42510900
                       SET DP013-DB2-ABEND                              42511000
                           DP013-XCTL-DISPLAY-RESTART                   42511100
                                         TO TRUE                        42511200
                       PERFORM DP013-0000-PROCESS-ABEND                 42511300
               END-EVALUATE                                             42511400
           END-PERFORM.                                                 42511500
      *                                                                 42511600
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42511700
               MOVE '7100-PREPARE-COMPLETE'                             42511800
                                         TO DP013-PARAGRAPH             42511900
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     42512000
                                         TO DP013-MESSAGE-TEXT (1)      42512100
               MOVE 'TRANSFER DATA'      TO DP013-MESSAGE-TEXT (2)      42512200
               MOVE SQLCA                TO DP013-SQLCA                 42512300
               MOVE 'TTFMSTR'            TO DP013-DB2-TABLE-NAME (1)    42512400
               SET DP013-DB2-ABEND                                      42512500
                   DP013-XCTL-DISPLAY-RESTART                           42512600
                                         TO TRUE                        42512700
               PERFORM DP013-0000-PROCESS-ABEND                         42512800
           END-IF.                                                      42512900
           IF SQLCODE = +100                                            42513000
               MOVE +1                    TO PV-XFER-SEQ-NBR            42513100
           ELSE                                                         42513200
               IF PV-NULL-IND < 0                                       42513300
                   MOVE +1                TO PV-XFER-SEQ-NBR            42513400
               ELSE                                                     42513500
                   ADD +1                 TO PV-XFER-SEQ-NBR            42513600
               END-IF                                                   42513700
           END-IF.                                                      42513800
       EJECT                                                            42513900
      *----------------------------------------------------------------*42514000
      *  UPDATE THE TRANSFER MASTER TABLE WITH COMPLETE TRANSFER DATA. *42514100
      *----------------------------------------------------------------*42514200
       7200-COMPLETE-TTFMSTR.                                           42514300
           PERFORM                                                      42514400
             WITH TEST AFTER                                            42514500
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42514600
                 UNTIL PV-RETRY-COUNT > PC-MAX-RETRIES                  42514700
                    OR SQLCODE = ZERO                                   42514800
                    OR SQLCODE = +100                                   42514900
               EXEC SQL                                                 42515000
                 UPDATE TTFMSTR                                         42515100
                   SET  XFER_SEQ_NBR       = :TFMSTR-XFER-SEQ-NBR       42515200
                       ,CMPT_XFER_END_TMST = :PV-DB2-TIMESTAMP          42515300
                       ,CPLD_XFER_USR_ID   = :TFMSTR-CPLD-XFER-USR-ID   42515400
                       ,WRKSHT_PROB_IND    = :TFMSTR-WRKSHT-PROB-IND    42515500
                   WHERE (XFER_DKEY_ID  = :DK-XFER-DKEY-ID)             42515600
               END-EXEC                                                 42515700
               EVALUATE TRUE                                            42515800
                   WHEN SQLCODE = ZERO                                  42515900
                   WHEN SQLCODE = -904                                  42516000
                   WHEN SQLCODE = -913                                  42516100
                       CONTINUE                                         42516200
                   WHEN OTHER                                           42516300
                       MOVE '7200-COMPLETE-TTFMSTR'                     42516600
                                           TO DP013-PARAGRAPH           42516700
                       MOVE 'UPDATE A ROW IN TTFMSTR'                   42516800
                                           TO DP013-MESSAGE-TEXT (1)    42516900
                       MOVE SQLCA          TO DP013-SQLCA               42517000
                       MOVE 'TTFMSTR'      TO DP013-DB2-TABLE-NAME (1)  42517100
                       SET DP013-DB2-ABEND TO TRUE                      42517200
                       PERFORM DP013-0000-PROCESS-ABEND                 42517300
               END-EVALUATE                                             42517400
           END-PERFORM.                                                 42517500
                                                                        42517600
           IF PV-RETRY-COUNT > PC-MAX-RETRIES                           42517700
              MOVE '7200-COMPLETE-TTFMSTR'                              42517800
                                           TO DP013-PARAGRAPH           42517900
              MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE A ROW'42518000
                                           TO DP013-MESSAGE-TEXT (1)    42518100
              MOVE 'IN THE TRANSFER MASTER TABLE'                       42518200
                                           TO DP013-MESSAGE-TEXT (2)    42518300
              MOVE SQLCA                   TO DP013-SQLCA               42518400
              MOVE 'TTFMSTR'               TO DP013-DB2-TABLE-NAME (1)  42518500
              SET DP013-DB2-ABEND          TO TRUE                      42518600
              PERFORM DP013-0000-PROCESS-ABEND                          42518700
           END-IF.                                                      42518800
       EJECT                                                            42518900
      *----------------------------------------------------------------*42519000
      *  INSERT A ROW IN THE TRANSFER STATUS TABLE FOR COMPLETE XFER.  *42519100
      *----------------------------------------------------------------*42519200
       7400-INSERT-STATUS.                                              42519300
           PERFORM WITH TEST AFTER                                      42519400
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42519500
               UNTIL SQLCODE = 0 OR                                     42519600
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    42519700
               EXEC SQL                                                 42519800
                    INSERT                                              42519900
                      INTO TTFSTAT                                      42520000
                          (XFER_DKEY_ID                                 42520100
                         , XFER_STAT_TMST                               42520200
                         , XFER_STAT_CDE)                               42520300
                    VALUES                                              42520400
                          (:DK-XFER-DKEY-ID                             42520500
                         , :PV-DB2-TIMESTAMP                            42520600
                         , :PC-COMPLETE-STATUS)                         42520700
               END-EXEC                                                 42520800
                                                                        42520900
               EVALUATE TRUE                                            42521000
                   WHEN SQLCODE = ZERO                                  42521100
                   WHEN SQLCODE = -904                                  42521200
                   WHEN SQLCODE = -913                                  42521300
                        CONTINUE                                        42521400
                   WHEN OTHER                                           42521500
                        MOVE '7400-INSERT-STATUS'                       42521600
                                          TO DP013-PARAGRAPH            42521700
                        MOVE 'INSERT A ROW INTO THE TTFSTAT TABLE'      42521800
                                          TO DP013-MESSAGE-TEXT(1)      42521900
                        MOVE SQLCA        TO DP013-SQLCA                42522000
                        MOVE 'TTFSTAT'    TO DP013-DB2-TABLE-NAME (1)   42522100
                        SET DP013-DB2-ABEND                             42522200
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          42522300
                        PERFORM DP013-0000-PROCESS-ABEND                42522400
               END-EVALUATE                                             42522500
           END-PERFORM.                                                 42522600
                                                                        42522700
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       42522800
              SQLCODE NOT = 0                                           42522900
               MOVE '7400-INSERT-STATUS' TO DP013-PARAGRAPH             42523000
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     42523100
                                          TO DP013-MESSAGE-TEXT (1)     42523200
               MOVE 'A TRANSFER STATUS'   TO DP013-MESSAGE-TEXT (2)     42523300
               MOVE SQLCA                 TO DP013-SQLCA                42523400
               MOVE 'TTFSTAT'             TO DP013-DB2-TABLE-NAME (1)   42523500
               SET DP013-DB2-ABEND                                      42523600
                   DP013-XCTL-DISPLAY-RESTART                           42523700
                                          TO TRUE                       42523800
               PERFORM DP013-0000-PROCESS-ABEND                         42523900
           END-IF.                                                      42524000
       EJECT                                                            42524100
      *----------------------------------------------------------------*42524200
      *  SELECT THE CLEARANCE ITEM FIRST MARKDOWN PRICE.               *42524300
      *----------------------------------------------------------------*42524400
       7750-GET-CLR-ITM-1ST-MKDN-PRIC.                                  42524500
           INITIALIZE DCLTPPCPRC.                                       42524600
           MOVE ASC-ITEM-NBR (ASC-BLK-SUB ASC-ITEM-SUB) TO DK-ITEM-NBR. 42524700
100404     MOVE PV-NREGN-LOC-SKU-STAT-CDE-9 TO DK-SKU-STATUS-CODE.      42524800
                                                                        42524900
           PERFORM                                                      42525000
               WITH TEST AFTER                                          42525100
               VARYING PV-RETRY-COUNT                                   42525200
               FROM 1 BY 1                                              42525300
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42525400
                   OR (SQLCODE = +0)                                    42525500
                   OR (SQLCODE = +100))                                 42525600
                                                                        42525700
               EXEC SQL                                                 42525800
                   SELECT  MAX(RTL_AMT)                                 42525900
                     INTO  :PPCPRC-RTL-AMT                              42526000
                              :PV-NULL-IND                              42530000
                     FROM  TPPCPRC                                      42540000
                    WHERE  (TSK_ITM_NBR  =  :DK-ITEM-NBR                42550000
                      AND   STR_NBR      =  :PC-ZERO                    42551000
100404                AND   STATUS_CDE   =  :DK-SKU-STATUS-CODE)        42560000
               END-EXEC                                                 42570000
                                                                        42570100
               EVALUATE TRUE                                            42570200
                   WHEN SQLCODE = ZERO                                  42570300
                   WHEN SQLCODE = -904                                  42570400
                   WHEN SQLCODE = -913                                  42570500
                       CONTINUE                                         42570600
                   WHEN SQLCODE = +100                                  42570700
100404                 MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT      42570800
                   WHEN OTHER                                           42571000
                       MOVE '7750-GET-CLR-ITM-1ST-MKDN-PRIC'            42573000
                                             TO DP013-PARAGRAPH         42574000
                       MOVE 'SELECT THE 1ST MARKDOWN PRICE FOR A CLEARAN42575000
      -                 'CE ITEM.  TSK-ITEM-NMBR:'                      42576000
                                             TO DP013-MESSAGE-TEXT (1)  42577000
                       MOVE DK-ITEM-NBR  TO PV-DISPLAY-ITM-NBR          42578000
                       MOVE PV-DISPLAY-ITM-NBR TO DP013-MESSAGE-TEXT (2)42579000
                       MOVE SQLCA            TO DP013-SQLCA             42580000
                       MOVE 'TPPCPRC'        TO DP013-DB2-TABLE-NAME (1)42580100
                       SET DP013-DB2-ABEND                              42580200
                       DP013-XCTL-DISPLAY-RESTART                       42580300
                                            TO TRUE                     42580400
                       PERFORM DP013-0000-PROCESS-ABEND                 42580500
               END-EVALUATE                                             42580600
           END-PERFORM.                                                 42580700
                                                                        42580800
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42580900
                   MOVE '7750-GET-CLR-ITM-1ST-MKDN-PRIC'                42581000
                                             TO DP013-PARAGRAPH         42582000
                   MOVE 'SELECT THE 1ST MARKDOWN PRICE FOR A CLEARANCE I42583000
      -                 'TEM.  TSK-ITEM-NMBR:'                          42584000
                                             TO DP013-MESSAGE-TEXT (1)  42585000
                   MOVE DK-ITEM-NBR     TO PV-DISPLAY-ITM-NBR           42586000
                   MOVE PV-DISPLAY-ITM-NBR   TO DP013-MESSAGE-TEXT (2)  42587000
                   MOVE SQLCA                TO DP013-SQLCA             42588000
                   MOVE 'TPPCPRC'            TO DP013-DB2-TABLE-NAME (1)42588100
                   SET DP013-DB2-ABEND                                  42588200
                       DP013-XCTL-DISPLAY-RESTART                       42588300
                                            TO TRUE                     42588400
                   PERFORM DP013-0000-PROCESS-ABEND                     42588500
           END-IF.                                                      42588600
           IF PV-NULL-IND IS NEGATIVE                                   42588700
100404         MOVE XST00008-UNT-RTL-AMT TO PPCPRC-RTL-AMT              42588800
           END-IF.                                                      42589000
                                                                        42589100
       7800-CHECK-REGN-PRC.                                             42589200
           PERFORM                                                      42589400
               WITH TEST AFTER                                          42589500
               VARYING PV-RETRY-COUNT                                   42589600
               FROM 1 BY 1                                              42589700
               UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 42589800
                   OR (SQLCODE = +0)                                    42589900
                   OR (SQLCODE = +100))                                 42590000
               EXEC SQL                                                 42590100
100404             SELECT  LOC_SKU_STAT_CDE                             42590200
100404                    ,UNT_RTL_AMT                                  42590300
100404               INTO :PV-REGN-LOC-SKU-STAT-CDE                     42590400
100404                   ,:XST00008-UNT-RTL-AMT                         42590500
100404               FROM  XST_SKU_LOC A                                42590600
100404              WHERE  A.INTR_UPC_ID  = :XST00008-INTR-UPC-ID       42590700
100404                AND  A.LOC_NBR      = :DK-STORE-NBR               42590800
100404                AND  A.BEG_TMST    <= CURRENT TIMESTAMP           42590900
100404                AND  (A.END_TMST    > CURRENT TIMESTAMP           42591000
100404                 OR  A.END_TMST IS NULL)                          42592000
               END-EXEC                                                 42592100
                                                                        42592200
               EVALUATE TRUE                                            42592300
                   WHEN SQLCODE = ZERO                                  42592400
100404                 IF PV-REGN-LOC-SKU-STAT-CDE = PC-CLEARANCE       42592500
100404                     MOVE XST00008-UNT-RTL-AMT TO PV-CUR-RTL-AMT  42592600
                           MOVE +1                 TO PV-GP-QTY         42592900
                       END-IF                                           42593000
                   WHEN SQLCODE = +100                                  42593100
                   WHEN SQLCODE = -904                                  42593200
                   WHEN SQLCODE = -913                                  42593300
                       CONTINUE                                         42593400
                   WHEN OTHER                                           42593500
                       MOVE '7800-CHECK-REGN-PRC'                       42593600
                                             TO DP013-PARAGRAPH         42593700
100404                 MOVE 'SELECT DATA FROM XST_SKU_LOC'              42593800
                                             TO DP013-MESSAGE-TEXT (1)  42593900
                       MOVE SQLCA            TO DP013-SQLCA             42594000
100404                 MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)42594100
                       SET DP013-DB2-ABEND                              42594400
                           DP013-XCTL-DISPLAY-RESTART                   42594500
                                         TO TRUE                        42594600
                       PERFORM DP013-0000-PROCESS-ABEND                 42594700
               END-EVALUATE                                             42594800
           END-PERFORM.                                                 42594900
                                                                        42595000
           IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          42595100
               MOVE '7800-CHECK-REGN-PRC'                               42595200
                                     TO DP013-PARAGRAPH                 42595300
100404         MOVE 'SELECT DATA FROM XST_SKU_LOC'                      42595400
                                     TO DP013-MESSAGE-TEXT (1)          42595500
               MOVE SQLCA            TO DP013-SQLCA                     42595600
100404         MOVE 'XST_SKU_LOC'    TO DP013-DB2-TABLE-NAME (1)        42595700
               SET DP013-DB2-ABEND                                      42596000
                   DP013-XCTL-DISPLAY-RESTART                           42596100
                                 TO TRUE                                42596200
               PERFORM DP013-0000-PROCESS-ABEND                         42596300
           END-IF.                                                      42596400
      *                                                                 42596500
      *----------------------------------------------------------------*42596600
      * THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     42596700
      *----------------------------------------------------------------*42596800
       8000-LINK-TO-DRS.                                                42596900
                                                                        42597000
           EXEC CICS                                                    42597100
               LINK                                                     42597200
                   PROGRAM   ('DRS1INTC')                               42597300
                   COMMAREA  (DRS01-COMMAREA)                           42597400
           END-EXEC.                                                    42597500
                                                                        42597600
      *----------------------------------------------------------------*42597700
      * FORMAT THE REPORT HEADING DATE AND TIME FIELDS.                 42597800
      *----------------------------------------------------------------*42597900
       8100-FORMAT-TIME.                                                42598000
                                                                        42598100
           EXEC CICS                                                    42598200
               ASKTIME ABSTIME (PV-ABSTIME)                             42598300
           END-EXEC.                                                    42598400
                                                                        42598500
           EXEC CICS                                                    42598600
               FORMATTIME ABSTIME  (PV-ABSTIME)                         42598700
                          MMDDYY   (DP132O-RUN-DATE)                    42598800
                          DATESEP  ('/')                                42598900
                          TIME     (DP132O-RUN-TIME)                    42599000
                          TIMESEP  (':')                                42599100
           END-EXEC.                                                    42599200
                                                                        42599300
       EJECT                                                            42599400
      *----------------------------------------------------------------*42599500
      *  PRINT THE REPORT HEADING LINES.                                42599600
      *----------------------------------------------------------------*42599700
       8200-PRINT-HEADINGS.                                             42599800
           ADD 1                       TO PV-PAGE-COUNT.                42599900
           MOVE 11                     TO PV-LINE-COUNT.                42600000
           MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           42600100
           MOVE DP132O-STANDRD-HEADER-132-COLS                          42600200
                                       TO DRS01-COMM-DATA.              42600300
           MOVE PC-TOP-OF-PAGE         TO DRS01-COMM-CTL.               42600400
           PERFORM 8000-LINK-TO-DRS.                                    42600500
                                                                        42600600
           MOVE HL2-HEADING-LINE-2     TO DRS01-COMM-DATA.              42600700
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               42600800
           PERFORM 8000-LINK-TO-DRS.                                    42600900
                                                                        42601000
           MOVE HL3-HEADING-LINE-3     TO DRS01-COMM-DATA.              42601100
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               42601200
           PERFORM 8000-LINK-TO-DRS.                                    42601300
                                                                        42601400
           MOVE HL4-HEADING-LINE-4     TO DRS01-COMM-DATA.              42601500
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               42601600
           PERFORM 8000-LINK-TO-DRS.                                    42601700
                                                                        42601800
           MOVE HL5-HEADING-LINE-5     TO DRS01-COMM-DATA.              42601900
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               42602000
           PERFORM 8000-LINK-TO-DRS.                                    42602100
                                                                        42602200
           EVALUATE ASC-XFER-TYPE                                       42602300
               WHEN PC-NON-RETAIL                                       42602400
                   MOVE HL6A-HEADING-LINE-6A                            42602500
                                       TO DRS01-COMM-DATA               42602600
                   MOVE PC-SINGLE-SPACE                                 42602700
                                       TO DRS01-COMM-CTL                42602800
                   PERFORM 8000-LINK-TO-DRS                             42602900
                   ADD 1               TO PV-LINE-COUNT                 42603000
               WHEN PC-CUSTOMER                                         42603100
                   MOVE HL6B-HEADING-LINE-6B                            42603200
                                       TO DRS01-COMM-DATA               42603300
                   MOVE PC-SINGLE-SPACE                                 42603400
                                       TO DRS01-COMM-CTL                42603500
                   PERFORM 8000-LINK-TO-DRS                             42603600
                   MOVE HL7-HEADING-LINE-7                              42603700
                                       TO DRS01-COMM-DATA               42603800
                   MOVE PC-SINGLE-SPACE                                 42603900
                                       TO DRS01-COMM-CTL                42604000
                   PERFORM 8000-LINK-TO-DRS                             42604100
                   MOVE HL8-HEADING-LINE-8                              42604200
                                       TO DRS01-COMM-DATA               42604300
                   MOVE PC-SINGLE-SPACE                                 42604400
                                       TO DRS01-COMM-CTL                42604500
                   PERFORM 8000-LINK-TO-DRS                             42604600
                   ADD 3               TO PV-LINE-COUNT                 42604700
           END-EVALUATE.                                                42604800
                                                                        42604900
           MOVE HL9-HEADING-LINE-9     TO DRS01-COMM-DATA.              42605000
           MOVE PC-DOUBLE-SPACE        TO DRS01-COMM-CTL.               42605100
           PERFORM 8000-LINK-TO-DRS.                                    42605200
                                                                        42605300
           EVALUATE TRUE                                                42605400
               WHEN ASC-RETAIL-XFER                                     42605500
                   MOVE HL10A-HEADING-LINE-10A                          42605600
                                       TO DRS01-COMM-DATA               42605700
                   MOVE PC-DOUBLE-SPACE                                 42605800
                                       TO DRS01-COMM-CTL                42605900
                   PERFORM 8000-LINK-TO-DRS                             42606000
               WHEN OTHER                                               42606100
                   MOVE HL10B-HEADING-LINE-10B                          42606200
                                       TO DRS01-COMM-DATA               42606300
                   MOVE PC-DOUBLE-SPACE                                 42606400
                                       TO DRS01-COMM-CTL                42606500
                   PERFORM 8000-LINK-TO-DRS                             42606600
           END-EVALUATE.                                                42606700
                                                                        42606800
           MOVE BL-BLANK-LINE          TO DRS01-COMM-DATA.              42606900
           MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL.               42607000
           PERFORM 8000-LINK-TO-DRS.                                    42607100
       EJECT                                                            42607200
       9000-CHECK-RETAIL-ITEMS.                                         42607300
           IF ASC-RTL-ITEM-NOT-UPDATED (ASC-BLK-SUB ASC-ITEM-SUB)       42607400
                 AND ASC-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    42607500
               MOVE ASC-RTL-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)            42607600
                                       TO PV-HOLD-QTY                   42607700
               SET ASC-RTL-ITEM-UPDATED (ASC-BLK-SUB ASC-ITEM-SUB)      42607800
                                       TO TRUE                          42607900
               PERFORM 9050-COMPLETE-RETAIL-ITEMS                       42608000
                 VARYING PV-BLOCK                                       42608100
                   FROM ASC-BLK-SUB BY 1 UNTIL                          42608200
                         PV-BLOCK > PC-MAX-BLOCKS-IN-ARRAY              42608300
                 AFTER PV-ITEM                                          42608400
                   FROM ASC-ITEM-SUB BY 1                               42608500
                     UNTIL PV-ITEM >  PC-ITEMS-PER-RTL-PANEL            42608600
               PERFORM 9100-INSERT-RETAIL-ITEMS                         42608700
           END-IF.                                                      42608800
       9050-COMPLETE-RETAIL-ITEMS.                                      42608900
           IF ASC-RTL-ITEM-NOT-UPDATED (PV-BLOCK PV-ITEM)               42609000
               IF ASC-KOHLS-UPC-DIGITS (PV-BLOCK PV-ITEM) = '0400' AND  42609100
                  ASC-KOHLS-DUMMY-SKU  (PV-BLOCK PV-ITEM) = '000'       42609200
                   IF (ASC-KOHLS-UPC   (PV-BLOCK PV-ITEM) =             42610000
                       ASC-KOHLS-UPC  (ASC-BLK-SUB ASC-ITEM-SUB)) AND   42610100
                      (ASC-PRICE (PV-BLOCK PV-ITEM) =                   42610200
                       ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB))            42610300
                        ADD ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)            42610400
                                        TO PV-HOLD-QTY                  42610500
                        SET ASC-RTL-ITEM-UPDATED (PV-BLOCK PV-ITEM)     42610600
                                        TO TRUE                         42610700
                   END-IF                                               42610800
               ELSE                                                     42610900
                   IF (ASC-ITEM-NBR  (PV-BLOCK PV-ITEM) =               42611000
                       ASC-ITEM-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)) AND    42611100
                      (ASC-PRICE (PV-BLOCK PV-ITEM) =                   42611200
                       ASC-PRICE (ASC-BLK-SUB ASC-ITEM-SUB))            42611300
                        ADD ASC-RTL-QTY-N (PV-BLOCK PV-ITEM)            42611400
                                        TO PV-HOLD-QTY                  42611500
                        SET ASC-RTL-ITEM-UPDATED (PV-BLOCK PV-ITEM)     42611600
                                        TO TRUE                         42611700
                   END-IF                                               42611800
               END-IF                                                   42611900
           END-IF.                                                      42612000
       EJECT                                                            42612100
       9100-INSERT-RETAIL-ITEMS.                                        42612200
           INITIALIZE DCLTTFITEM.                                       42612300
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          42612400
           ADD +1                          TO PV-LINE-NBR.              42612500
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      42612600
           IF ASC-UPC (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES               42612700
               MOVE ASC-UPC   (ASC-BLK-SUB ASC-ITEM-SUB)                42612800
                                           TO TFITEM-SCN-UPC-NBR        42612900
           END-IF.                                                      42613000
           MOVE ASC-KOHLS-UPC (ASC-BLK-SUB ASC-ITEM-SUB)                42613100
                                           TO TFITEM-KOHLS-UPC-NBR.     42613200
           MOVE ASC-ITEM-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)                42613300
                                           TO TFITEM-ITM-NBR.           42613400
           MOVE ASC-PRICE-N (ASC-BLK-SUB ASC-ITEM-SUB)                  42613500
                                           TO TFITEM-XFER-PRIC-AMT.     42613600
           MOVE ASC-FILE-PRICE (ASC-BLK-SUB ASC-ITEM-SUB)               42613700
                                           TO TFITEM-CPLD-RTL-PRIC-AMT. 42613800
           MOVE ASC-GROUP-PRICED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          42613900
                                           TO TFITEM-ITM-PRIC-MLT-IND.  42614000
           MOVE PV-HOLD-QTY                TO TFITEM-XFER-QTY.          42614100
           PERFORM WITH TEST AFTER                                      42614200
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42614300
               UNTIL SQLCODE = 0 OR                                     42614400
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    42614500
                                                                        42614600
               EXEC SQL                                                 42614700
                    INSERT                                              42614800
                      INTO TTFITEM                                      42614900
                          (XFER_DKEY_ID                                 42615000
                         , XFER_LNE_NBR                                 42615100
                         , CPLD_RTL_PRIC_AMT                            42615200
                         , SCN_UPC_NBR                                  42615300
                         , KOHLS_UPC_NBR                                42615400
                         , ITM_NBR                                      42615500
                         , XFER_PRIC_AMT                                42615600
                         , ITM_PRIC_MLT_IND                             42615700
                         , XFER_QTY)                                    42615800
                    VALUES                                              42615900
                          (:DK-XFER-DKEY-ID                             42616000
                         , :TFITEM-XFER-LNE-NBR                         42616100
                         , :TFITEM-CPLD-RTL-PRIC-AMT                    42616200
                         , :TFITEM-SCN-UPC-NBR                          42616300
                         , :TFITEM-KOHLS-UPC-NBR                        42616400
                         , :TFITEM-ITM-NBR                              42616500
                         , :TFITEM-XFER-PRIC-AMT                        42616600
                         , :TFITEM-ITM-PRIC-MLT-IND                     42616700
                         , :TFITEM-XFER-QTY)                            42616800
               END-EXEC                                                 42616900
                                                                        42617000
               EVALUATE TRUE                                            42617100
                   WHEN SQLCODE = 0                                     42617200
                   WHEN SQLCODE = -904                                  42617300
                   WHEN SQLCODE = -913                                  42617400
                        CONTINUE                                        42617500
                   WHEN OTHER                                           42617600
                        MOVE '9100-INSERT-RETAIL-ITEMS'                 42617700
                                          TO DP013-PARAGRAPH            42617800
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      42617900
                                          TO DP013-MESSAGE-TEXT(1)      42618000
                        MOVE SQLCA        TO DP013-SQLCA                42618100
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   42618200
                        SET DP013-DB2-ABEND                             42618300
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          42618400
                        PERFORM DP013-0000-PROCESS-ABEND                42618500
               END-EVALUATE                                             42618600
           END-PERFORM.                                                 42618700
                                                                        42618800
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       42618900
              SQLCODE NOT = 0                                           42619000
               MOVE '9100-INSERT-RETAIL-ITEMS' TO DP013-PARAGRAPH       42619100
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     42619200
                                          TO DP013-MESSAGE-TEXT (1)     42619300
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     42619400
               MOVE SQLCA                 TO DP013-SQLCA                42619500
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   42619600
               SET DP013-DB2-ABEND                                      42619700
                   DP013-XCTL-DISPLAY-RESTART                           42619800
                                          TO TRUE                       42619900
               PERFORM DP013-0000-PROCESS-ABEND                         42620000
           END-IF.                                                      42620100
       EJECT                                                            42620200
       9200-CHECK-NON-RETAIL-ITEMS.                                     42620300
           IF ASC-NRTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES          42620400
               PERFORM 9300-INSERT-NON-RETAIL-ITEMS                     42620500
           END-IF.                                                      42620600
       9300-INSERT-NON-RETAIL-ITEMS.                                    42620700
           INITIALIZE DCLTTFITEM.                                       42620800
           MOVE ASC-XFER-DKEY-ID           TO DK-XFER-DKEY-ID.          42620900
           ADD +1                          TO PV-LINE-NBR.              42621000
           MOVE PV-LINE-NBR                TO TFITEM-XFER-LNE-NBR.      42621100
           MOVE ASC-ITEM-DESC1 (ASC-BLK-SUB ASC-ITEM-SUB)               42621200
                                           TO TFITEM-NRTL-1ST-LNE-DESC. 42621300
           MOVE ASC-ITEM-DESC2 (ASC-BLK-SUB ASC-ITEM-SUB)               42621400
                                           TO TFITEM-NRTL-2ND-LNE-DESC. 42621500
           MOVE ASC-NRTL-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)               42621600
                                           TO TFITEM-XFER-QTY.          42621700
           MOVE ASC-NRTL-DEPT (ASC-BLK-SUB ASC-ITEM-SUB)                42621800
                                           TO TFITEM-NRTL-DEPT-NBR      42621900
           MOVE ASC-FIXTURE  (ASC-BLK-SUB ASC-ITEM-SUB)                 42622000
                                           TO TFITEM-NRTL-FIXT-ID.      42622100
           PERFORM WITH TEST AFTER                                      42622200
               VARYING PV-RETRY-COUNT FROM 1 BY 1                       42622300
               UNTIL SQLCODE = 0 OR                                     42622400
                     PV-RETRY-COUNT > PC-MAX-RETRIES                    42622500
                                                                        42622600
               EXEC SQL                                                 42622700
                    INSERT                                              42622800
                      INTO TTFITEM                                      42622900
                          (XFER_DKEY_ID                                 42623000
                         , XFER_LNE_NBR                                 42623100
                         , NRTL_1ST_LNE_DESC                            42623200
                         , NRTL_2ND_LNE_DESC                            42623300
                         , NRTL_FIXT_ID                                 42623400
                         , NRTL_DEPT_NBR                                42623500
                         , XFER_QTY)                                    42623600
                    VALUES                                              42623700
                          (:DK-XFER-DKEY-ID                             42623800
                         , :TFITEM-XFER-LNE-NBR                         42623900
                         , :TFITEM-NRTL-1ST-LNE-DESC                    42624000
                         , :TFITEM-NRTL-2ND-LNE-DESC                    42624100
                         , :TFITEM-NRTL-FIXT-ID                         42624200
                         , :TFITEM-NRTL-DEPT-NBR                        42624300
                         , :TFITEM-XFER-QTY)                            42624400
               END-EXEC                                                 42624500
                                                                        42624600
               EVALUATE TRUE                                            42624700
                   WHEN SQLCODE = 0                                     42624800
                   WHEN SQLCODE = -904                                  42624900
                   WHEN SQLCODE = -913                                  42625000
                        CONTINUE                                        42625100
                   WHEN OTHER                                           42625200
                        MOVE '9300-INSERT-NON-RETAIL-ITEMS'             42625300
                                          TO DP013-PARAGRAPH            42625400
                        MOVE 'INSERT A ROW INTO THE TTFITEM TABLE'      42625500
                                          TO DP013-MESSAGE-TEXT(1)      42625600
                        MOVE SQLCA        TO DP013-SQLCA                42625700
                        MOVE 'TTFITEM'    TO DP013-DB2-TABLE-NAME (1)   42625800
                        SET DP013-DB2-ABEND                             42625900
                            DP013-XCTL-DISPLAY-RESTART TO TRUE          42626000
                        PERFORM DP013-0000-PROCESS-ABEND                42626100
               END-EVALUATE                                             42626200
           END-PERFORM.                                                 42626300
                                                                        42626400
           IF PV-RETRY-COUNT > PC-MAX-RETRIES AND                       42626500
              SQLCODE NOT = 0                                           42626600
               MOVE '9300-INSERT-NON-RETAIL-ITEMS' TO DP013-PARAGRAPH   42626700
               MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     42626800
                                          TO DP013-MESSAGE-TEXT (1)     42626900
               MOVE 'A TRANSFER ITEM'     TO DP013-MESSAGE-TEXT (2)     42627000
               MOVE SQLCA                 TO DP013-SQLCA                42627100
               MOVE 'TTFITEM'             TO DP013-DB2-TABLE-NAME (1)   42627200
               SET DP013-DB2-ABEND                                      42627300
                   DP013-XCTL-DISPLAY-RESTART                           42627400
                                          TO TRUE                       42627500
               PERFORM DP013-0000-PROCESS-ABEND                         42627600
           END-IF.                                                      42627700
       EJECT                                                            42627800
      *----------------------------------------------------------------*42627900
      *    ABEND PROCESSOR MODULE                                      *42628000
      *----------------------------------------------------------------*42628100
                                                                        42628200
           COPY DPPD013.                                                42629000
