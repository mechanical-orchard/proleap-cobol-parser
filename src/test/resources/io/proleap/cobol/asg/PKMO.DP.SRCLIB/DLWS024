000100**************************************************************    00010000
000110*  DLWS024  --  DLKUT028                                     *    00011001
000120**************************************************************    00012000
000200*    ******                IMPORTANT                 ******  *    00020000
000300*   THIS IS THE COMMUNICATION AREA TO BE USED BY A CALLING   *    00030000
000400*   PROGRAM THAT WILL USE ROUTINE DLKUT028 TO HANDLE         *    00040000
000500*   REMOVING ASSOCIATE FROM ACTIVE ASSIGNMENTS WHEN THEY     *    00050000
000600*   ARE ON MULTIPLE ACTIVE ASSIGNMENT.                       *    00060000
000700*                                                            *    00070000
001100*   TO INVOKE THIS PROGRAM FROM A CICS EXIT YOU MUST USE THIS*    00110000
001200*   FORMAT:                                                  *    00120000
001300*     CALL DL024-USER-PGM USING DFHEIBLK                     *    00130000
001400*                              DL024-COMMAREA                *    00140000
001500*                              DL024-USER-COMMAREA           *    00150000
001600*                                                            *    00160007
001800*    ******                IMPORTANT                 ******  *    00180000
001900*                                                            *    00190000
002000*     INITIALIZE DL024-USER-COMMAREA BEFORE CALLING DLKUT028 *    00200000
002100*                                                            *    00210000
002200*     DL028-ACCESS-METHOD IS REQUIRED.                       *    00220000
002300*                                                            *    00230000
002400*     THE APPROPRIATE DL028-KEYS FIELDS ARE REQUIRED.        *    00240000
002500*                                                            *    00250000
002600*     REGARDING DL028-OUTPUT-FIELDS:                         *    00260000
002700*       THE APPROPRIATE OUTPUT FIELDS WILL BE RETURNED TO    *    00270000
002800*       THE CALLING PROGRAM BASED ON WHAT THE DLKUT028       *    00280000
002900*       MODULE DETERMINES.                                   *    00290000
003000*                                                            *    00300000
003100*     NOTE: IF FIELD(S) ARE ADDED TO THIS COPYBOOK           *    00310000
003200*           DECREMENT THE FILLER NEAR THE END OF THIS        *    00320000
003300*           COPYBOOK SO THE TOTAL LENGTH REMAINS THE SAME    *    00330000
003400*           AT LENGTH OF 550                                 *    00340000
003500**************************************************************    00350000
003600 01  DL024-ASGMT-COMMAREA.                                        00360000
003700     05  DL024-ACCESS-METHOD              PIC  X(04).             00370000
003800         88  DL024-BY-ASSOC-MULT-ASGMT         VALUE 'MLTA'.      00380002
003900     05  DL024-FILLER                     PIC  X(20).             00390000
003910                                                                  00391000
004000     05  DL024-KEYS.                                              00400000
004100         10  DL024-KEY-WK-TYP             PIC X(15).              00410000
004200                 88  DL024-NO-KEY-WK-TYP       VALUE SPACES.      00420002
004300         10  DL024-KEY-WK-AREA  PIC X(20).                        00430000
004400                 88  DL024-NO-KEY-WK-AREA      VALUE SPACES.      00440002
004500         10  DL024-KEY-DC-NBR             PIC S9(04) COMP.        00450002
004600             88  DL024-NO-KEY-DC-NBR           VALUE ZEROS.       00460002
004610         10  DL024-KEY-USER-ID            PIC  X(08).             00461000
004620             88  DL003-NO-KEY-USER-ID          VALUE SPACES.      00462002
004630         10  DL024-USER-FOUND-CODE        PIC  X(01).             00463002
004640             88  DL024-USER-NOT-FOUND          VALUE 'N'.         00464002
004650             88  DL024-USER-IS-KOHLS           VALUE 'K'.         00465002
004660             88  DL024-USER-IS-TEMP            VALUE 'T'.         00466002
004700         10  DL024-FILLER                 PIC  X(49).             00470002
004710                                                                  00471000
004800     05  DL024-RETURN-CODE                PIC  X(02).             00480000
004900         88  DL024-SUCCESSFUL             VALUES ZERO.            00490000
005000         88  DL024-SQL-ERROR              VALUE '01'.             00500000
005100         88  DL024-MISSING-KEY-FIELDS     VALUE '02'.             00510000
005200         88  DL024-CALLED-MODULE-FAILURE  VALUE '98'.             00520000
005300         88  DL024-INVALID-ACCESS         VALUE '99'.             00530000
005310                                                                  00531000
005400     05  DL024-RETURN-SQLCODES.                                   00540000
005500         10  DL024-ASGMT-SQLCODE          PIC  S9(9).             00550000
005600             88  DL024-SQL-NOT-FOUND      VALUE  +100.            00560000
005700             88  DL024-SQL-CONTENTION     VALUES -904 -911 -913.  00570000
005800         10  DL024-FILLER                 PIC  X(32).             00580000
005810                                                                  00581000
005900* THE FOLLOWING FIELD SHOULD CONTAIN THE ORIGINAL CALLING         00590000
006000* PROGRAM ASSOCIATED TO THE PROCESSING TO BE DONE.                00600000
006100     05  DL024-ORIG-CALLING-PGM-NM        PIC  X(08).             00610000
006200     05  DL024-FILLER                     PIC  X(17).             00620000
006210                                                                  00621000
006300* THE FOLLOWING ARE TO CONTAIN PARAGRAPH NUMBERS ASSOCIATED TO    00630000
006400* THE ABOVE SQL RETURN CODES.                                     00640000
006500     05  DL024-CALL-MOD-FAIL-SQL-PARA     PIC  X(5).              00650006
006600     05  DL024-CALL-MOD-FAIL-NM           PIC  X(08).             00660000
006700     05  DL024-CALL-MOD-FAIL-ERR-CDE      PIC  X(02).             00670000
006710     05  DL024-CALL-MOD-FAIL-SQL-CDE      PIC  S9(9).             00671005
006800     05  DL024-FILLER                     PIC  X(10).             00680000
006900                                                                  00690000
007000     05  DL024-OUTPUT-FIELDS.                                     00700000
009400         10  DL024-FILLER                 PIC  X(108).            00940000
009500                                                                  00950000
009600     05  DL024-FILLER                     PIC  X(92).             00960000
009700     05  DL024-SQLCA                      PIC  X(138).            00970000
009800 01  DL024-COMMAREA                       PIC  X(01).             00980000
009900 01  DL024-MULT-ASGMT-PGM                 PIC  X(08)              00990004
010000                                          VALUE 'DLKUT028'.       01000003
