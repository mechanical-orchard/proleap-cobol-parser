000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             PCKRP015.                                00020000
000300 AUTHOR.                 DEANNA BRANTNER.                         00030000
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040000
000500 DATE-WRITTEN.           MAY, 2006.                               00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800* THIS WILL PRODUCE THE 'INVENTORY STORES UNBALANCED STORE        00080000
000900* EXPECTED REPORT WITH LOCATION INFORMATION.                      00090000
001000                                                                  00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200 CONFIGURATION SECTION.                                           00120000
001300 SOURCE-COMPUTER.                        IBM-3090.                00130000
001400 OBJECT-COMPUTER.                        IBM-3090.                00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600 FILE-CONTROL.                                                    00160000
001700                                                                  00170000
001800     SELECT EXTRACT-FILE                                          00180000
001900         ASSIGN TO INP01.                                         00190000
002000                                                                  00200000
002100     SELECT  REPORT-FILE                                          00210000
002200         ASSIGN TO RPT01.                                         00220000
002300                                                                  00230000
002400 DATA DIVISION.                                                   00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  EXTRACT-FILE                                                 00270000
002800     RECORDING MODE IS F                                          00280000
002900     LABEL RECORDS ARE STANDARD                                   00290000
003000     BLOCK CONTAINS 0 RECORDS.                                    00300000
003100 01  ERROR-RECORD                     PIC X(150).                 00310000
003200                                                                  00320000
003300 FD  REPORT-FILE                                                  00330000
003400     RECORDING MODE IS F                                          00340000
003500     LABEL RECORDS ARE STANDARD                                   00350000
003600     BLOCK CONTAINS 0 RECORDS.                                    00360000
003700 01  REPORT-RECORD                    PIC X(132).                 00370000
003800/                                                                 00380000
003900 WORKING-STORAGE SECTION.                                         00390000
004000 01  PS-SWITCHES.                                                 00400000
004100     05  PS-EOF-ERROR-SWITCH          PIC X(01) VALUE 'N'.        00410000
004200         88  PS-EOF-ERROR-FILE                  VALUE 'Y'.        00420000
004300                                                                  00430000
004400 01  DK-DB-KEYS.                                                  00440000
004500     05  DK-STORE-NBR                 PIC S9(04) COMP VALUE ZERO. 00450000
004600     05  DK-LINE-NBR                  PIC S9(09) COMP VALUE ZERO. 00460000
004700                                                                  00470000
004800 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00480000
004900                                                 COMP SYNC.       00490000
005000     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00500000
005100                                                                  00510000
005200 01  SD-SYSTEM-DATE.                                              00520000
005300     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00530000
005400     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00540000
005500     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00550000
005600                                                                  00560000
005700 01  ST-SYSTEM-TIME.                                              00570000
005800     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00580000
005900     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00590000
006000     05  FILLER                     PIC  9(04)   VALUE ZERO.      00600000
006100                                                                  00610000
006200 01  PV-VARIABLES.                                                00620000
006300     05  PV-TMST                      PIC X(26) VALUE SPACES.     00630000
006400     05  PV-READ-COUNT                PIC S9(7) COMP-3            00640000
006500                                                VALUE ZERO.       00650000
006510     05  PV-NOCALL-CNT                PIC S9(7) COMP-3            00640000
006520                                                VALUE ZERO.       00650000
006530     05  PV-CALL-CNT                  PIC S9(7) COMP-3            00640000
006540                                                VALUE ZERO.       00650000
006600     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00660000
006700                                                VALUE ZERO.       00670000
006800     05  PV-PAGE-COUNT                PIC S9(7) COMP-3            00680000
006900                                                VALUE ZERO.       00690000
007000     05  PV-LINES-USED                PIC S9(4) COMP-3            00700000
007100                                                VALUE ZERO.       00710000
007200     05  PV-RETRY-COUNTER             PIC S9(04) VALUE ZERO       00720000
007300                                                 COMP SYNC.       00730000
007400     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     00740000
007500     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     00750000
007600     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              00760000
007700     05  PV-DISP-COUNT                PIC Z,ZZZ,ZZZ,ZZ9.          00770000
007800     05  PV-PREV-OPER                 PIC 9(05).                  00780000
007900     05  PV-PREV-LOC                  PIC 9(04) COMP VALUE ZEROES.00790000
008000     05  PV-PREV-PO                   PIC S9(09) COMP VALUE +0.   00800000
008100     05  PV-PREV-RCVR                 PIC S9(09) COMP VALUE +0.   00810000
008200     05  PV-PREV-TRIP                 PIC S9(09) COMP VALUE +0.   00820006
008300     05  PV-PREV-CARTON               PIC S9(18)V     VALUE +0.   00830006
008400     05  PV-PREV-LINE                 PIC  9(04) VALUE ZEROES.    00840000
008500     05  PV-PREV-LINE-X REDEFINES PV-PREV-LINE                    00850004
008600                                      PIC  X(04).                 00860003
008700     05  PV-CLEAN4-DAYS               PIC S9(09) COMP.            00870000
008800     05  PV-TRIP                      PIC Z(10).                  00880000
008810     05  PV-PREV-CARTON-ID            PIC S9(18)V VALUE ZEROES.           
008820     05  PV-PREV-STATUS               PIC X(40)   VALUE SPACES.           
008900     05  PV-CARTON                    PIC Z(18).                  00890000
009000                                                                  00900000
009100     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     00910000
009200     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     00920000
009300*    05  PV-TALLY                     PIC S9(09) COMP.                    
009400     05  PV-DB2-DATE.                                             00930000
009500         10  PV-DB2-CC                  PIC X(02).                00940000
009600         10  PV-DB2-YY                  PIC X(02).                00950000
009700         10  FILLER                     PIC X(01).                00960000
009800         10  PV-DB2-MM                  PIC X(02).                00970000
009900         10  FILLER                     PIC X(01).                00980000
010000         10  PV-DB2-DD                  PIC X(02).                00990000
010100         10  FILLER                     PIC X(01).                01000000
010200         10  PV-DB2-HH                  PIC X(02).                01010000
010300         10  FILLER                     PIC X(01).                01020000
010400         10  PV-DB2-MN                  PIC X(02).                01030000
010500         10  FILLER                     PIC X(01).                01040000
010600         10  PV-DB2-SS                  PIC X(09).                01050000
010700     05  PV-KEY-DATE.                                             01060000
010800         10  PV-KEY-MM               PIC X(02).                   01070000
010900         10  FILLER                  PIC X(01) VALUE '/'.         01080000
011000         10  PV-KEY-DD               PIC X(02).                   01090000
011100         10  FILLER                  PIC X(01) VALUE '/'.         01100000
011200         10  PV-KEY-YY               PIC X(02).                   01110000
011300                                                                  01120000
011301     05  PV-KEY-INTR-DATE.                                        01060000
011302         10  PV-KEY-INTR-MM          PIC X(02).                   01070000
011303         10  FILLER                  PIC X(01) VALUE '/'.         01080000
011304         10  PV-KEY-INTR-DD          PIC X(02).                   01090000
011305         10  FILLER                  PIC X(01) VALUE '/'.         01100000
011306         10  PV-KEY-INTR-YY          PIC X(02).                   01110000
011307                                                                          
011308     05  PV-INTR-TRN-DTE.                                                 
011309         10  PV-INTR-CC                 PIC X(02).                        
011310         10  PV-INTR-YY                 PIC X(02).                        
011311         10  FILLER                     PIC X(01).                        
011312         10  PV-INTR-MM                 PIC X(02).                        
011313         10  FILLER                     PIC X(01).                        
011314         10  PV-INTR-DD                 PIC X(02).                        
011315                                                                          
011316     05  PV-SHPD-UNT-QTY                PIC S9(09)V  COMP-3.              
011320                                                                          
011400 01  PC-CONSTANTS.                                                01130000
011500     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP015'. 01140000
011600     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 01150000
011700     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3  COMP.  01160000
011800                                                                  01170000
011900***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 01180000
012000     COPY DPWS132O.                                               01190000
012100                                                                  01200000
012200*    ERROR EXTRACT                                                01210000
012300     COPY PCRD038.                                                01220000
012400                                                                  01230000
012500*COPYBOOK FOR CARTON STATUS MODULE - PCKUT713                     01240000
012600     COPY PCWS046.                                                01250000
012700                                                                  01260000
012800 01  HL-HEADING-LINE-1.                                           01270000
012900     05  FILLER                      PIC  X(50)  VALUE SPACES.    01280000
013000     05  FILLER                      PIC  X(41)  VALUE            01290000
013100      ' PRE INVENTORY STORE EXPECTED CLEAN      '.                01300000
013200     05  FILLER                      PIC  X(37)  VALUE SPACES.    01310000
013300                                                                  01320000
013400 01  HL-HEADING-LINE-1A.                                          01330000
013500     05  FILLER                      PIC  X(40)  VALUE SPACES.    01340000
013600     05  FILLER                      PIC  X(48)  VALUE            01350002
013700      'INVENTORY STORES WITH UNBALANCED STORE EXPECTED '.         01360000
013800     05  FILLER                      PIC  X(15) VALUE             01370002
013900         'CARTON LOCATION'.                                       01380002
014000     05  FILLER                      PIC  X(11)  VALUE SPACES.    01390000
014100                                                                  01400000
014200 01  HL-HEADING-LINE-2A.                                          01410000
014300     05  FILLER                      PIC  X(07) VALUE  SPACES.    01420000
014400     05  FILLER                      PIC  X(04) VALUE             01430000
014500         'STOR'.                                                  01440000
014600     05  FILLER                      PIC  X(26) VALUE  SPACES.    01450000
014700     05  FILLER                      PIC  X(03) VALUE             01460000
014800         'REC'.                                                   01470000
014900     05  FILLER                      PIC  X(17) VALUE  SPACES.    01480000
015000     05  FILLER                      PIC  X(04) VALUE             01490000
015100         'LINE'.                                                  01500000
015110     05  FILLER                      PIC  X(02) VALUE  SPACES.    01480000
015120     05  FILLER                      PIC  X(06) VALUE             01490000
015130         'SE CLN'.                                                01500000
015140     05  FILLER                      PIC  X(03) VALUE  SPACES.    01480000
015150     05  FILLER                      PIC  X(08) VALUE             01490000
015160         'EXT RETL'.                                              01500000
015200     05  FILLER                      PIC  X(03) VALUE  SPACES.    01510000
015300     05  FILLER                      PIC  X(08) VALUE             01520000
015400         'LAST ACT'.                                              01530000
015500     05  FILLER                      PIC  X(02) VALUE  SPACES.    01540000
015600     05  FILLER                      PIC  X(07) VALUE             01550000
015700         'CRTN'.                                                  01560000
015800     05  FILLER                      PIC  X(36) VALUE  SPACES.    01570000
015900                                                                  01580000
016000 01  HL-HEADING-LINE-2.                                           01590000
016100     05  FILLER                      PIC  X(03) VALUE  SPACES.    01600000
016200     05  FILLER                      PIC  X(02) VALUE             01610000
016300         'DC'.                                                    01620000
016400     05  FILLER                      PIC  X(03) VALUE  SPACES.    01630000
016500     05  FILLER                      PIC  X(03) VALUE             01640000
016600         'NBR'.                                                   01650000
016700     05  FILLER                      PIC  X(03) VALUE  SPACES.    01660000
016800     05  FILLER                      PIC  X(11) VALUE             01670000
016900         'PO/RECEIVER'.                                           01680000
017000     05  FILLER                      PIC  X(02) VALUE  SPACES.    01690000
017100     05  FILLER                      PIC  X(08) VALUE             01700000
017200         'VRFD DTE'.                                              01710000
017300     05  FILLER                      PIC  X(02) VALUE  SPACES.    01720000
017400     05  FILLER                      PIC  X(03) VALUE             01730000
017500         'TYP'.                                                   01740000
017600     05  FILLER                      PIC  X(02) VALUE  SPACES.    01750000
017700     05  FILLER                      PIC  X(03) VALUE             01760000
017800         'DPT'.                                                   01770000
017900     05  FILLER                      PIC  X(03) VALUE  SPACES.    01780000
018000     05  FILLER                      PIC  X(03) VALUE             01790000
018100         'SKU'.                                                   01800000
018200     05  FILLER                      PIC  X(06) VALUE  SPACES.    01810000
018300     05  FILLER                      PIC  X(03) VALUE             01820000
018400         'NBR'.                                                   01830000
018500     05  FILLER                      PIC  X(04) VALUE  SPACES.    01840000
018600     05  FILLER                      PIC  X(05) VALUE             01850000
018700         'UNITS'.                                                 01860000
018800     05  FILLER                      PIC  X(05) VALUE  SPACES.    01870000
018900     05  FILLER                      PIC  X(04) VALUE             01880000
019000         'CALC'.                                                  01890000
019100     05  FILLER                      PIC  X(07) VALUE  SPACES.    01900000
019200     05  FILLER                      PIC  X(04) VALUE             01910000
019300         'DATE'.                                                  01920000
019310     05  FILLER                      PIC  X(04) VALUE  SPACES.    01900000
019320     05  FILLER                      PIC  X(04) VALUE             01910000
019330         'UNTS'.                                                  01920000
019400     05  FILLER                      PIC  X(02) VALUE  SPACES.    01930000
019500     05  FILLER                      PIC  X(15) VALUE             01940002
019600         'CARTON LOCATION'.                                       01950002
019700     05  FILLER                      PIC  X(16) VALUE  SPACES.    01960002
019800                                                                  01970000
019900 01  HL-HEADING-LINE-3.                                           01980000
020000     05  FILLER                      PIC  X(01) VALUE  SPACES.    01990000
020100     05  FILLER                      PIC  X(04) VALUE             02000000
020200         '----'.                                                  02010000
020300     05  FILLER                      PIC  X(02) VALUE  SPACES.    02020000
020400     05  FILLER                      PIC  X(04) VALUE             02030000
020500         '----'.                                                  02040000
020600     05  FILLER                      PIC  X(02) VALUE  SPACES.    02050000
020700     05  FILLER                      PIC  X(12) VALUE             02060000
020800         '------------'.                                          02070000
020900     05  FILLER                      PIC  X(02) VALUE  SPACES.    02080000
021000     05  FILLER                      PIC  X(08) VALUE             02090000
021100         '--------'.                                              02100000
021200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02110000
021300     05  FILLER                      PIC  X(03) VALUE             02120000
021400         '---'.                                                   02130000
021500     05  FILLER                      PIC  X(02) VALUE  SPACES.    02140000
021600     05  FILLER                      PIC  X(03) VALUE             02150000
021700         '---'.                                                   02160000
021800     05  FILLER                      PIC  X(02) VALUE  SPACES.    02170000
021900     05  FILLER                      PIC  X(08) VALUE             02180000
022000         '--------'.                                              02190000
022100     05  FILLER                      PIC  X(02) VALUE  SPACES.    02200000
022200     05  FILLER                      PIC  X(04) VALUE             02210000
022300         '----'.                                                  02220000
022400     05  FILLER                      PIC  X(02) VALUE  SPACES.    02230000
022500     05  FILLER                      PIC  X(06) VALUE             02240000
022600         '------'.                                                02250000
022700     05  FILLER                      PIC  X(02) VALUE  SPACES.    02260000
022800     05  FILLER                      PIC  X(10) VALUE             02270000
022900         '----------'.                                            02280000
023000     05  FILLER                      PIC  X(02) VALUE  SPACES.    02290000
023100     05  FILLER                      PIC  X(08) VALUE             02300000
023200         '--------'.                                              02310000
023210     05  FILLER                      PIC  X(02) VALUE  SPACES.    02290000
023220     05  FILLER                      PIC  X(04) VALUE             02300000
023230         '----'.                                                  02310000
023300     05  FILLER                      PIC  X(02) VALUE  SPACES.    02320000
023400     05  FILLER                      PIC  X(33) VALUE             02330000
023500         '---------------------------------'.                     02340000
023600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02350000
023700                                                                  02360000
023800 01  DL-DETAIL-LINE-1.                                            02370000
023900     05  FILLER                      PIC  X(01) VALUE  SPACES.    02380000
024000     05  DL-OPER-UNT-ID              PIC  ZZZ9  VALUE ZERO.       02390000
024100     05  FILLER                      PIC  X(02) VALUE  SPACES.    02400000
024200     05  DL-STORE-NBR                PIC  ZZZ9  VALUE ZERO.       02410000
024300     05  FILLER                      PIC  X(02) VALUE  SPACES.    02420000
024400     05  DL-PO-RCVR.                                              02430000
024500         10  DL-PO                   PIC  ZZZZZZZ9  VALUE ZERO.   02440000
024600         10  DL-DASH                 PIC  X(01) VALUE  '-'.       02450000
024700         10  DL-RCVR                 PIC  9(03) VALUE  ZEROES.    02460000
024800     05  FILLER                      PIC  X(02) VALUE  SPACES.    02470000
024900     05  DL-VRFD-DATE                PIC  X(08) VALUE SPACES.     02480000
025000     05  FILLER                      PIC  X(02) VALUE  SPACES.    02490000
025100     05  DL-REC-TYP                  PIC  X(03) VALUE SPACES.     02500000
025200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02510000
025300     05  DL-DEPT-NBR                 PIC  9(03) VALUE ZERO.       02520000
025400     05  FILLER                      PIC  X(02) VALUE  SPACES.    02530000
025500     05  DL-SKU-NBR                  PIC  9(08) VALUE  ZEROES.    02540000
025600     05  FILLER                      PIC  X(02) VALUE  SPACES.    02550000
025700     05  DL-APP-PO-LNE-NBR           PIC  ZZZ9.                   02560000
025800     05  DL-APP-PO-LNE-NBR-X REDEFINES DL-APP-PO-LNE-NBR          02570000
025900                                     PIC  X(04).                  02580000
026000     05  FILLER                      PIC  X(02) VALUE  SPACES.    02590000
026100     05  DL-STORE-EXP-UNITS          PIC  ZZZZ9-.                 02600000
026200     05  FILLER                      PIC  X(02) VALUE  SPACES.    02610000
026210     05  DL-EXT-RTL-AMT              PIC  ZZ,ZZZ.99-.             02640000
026400     05  FILLER                      PIC  X(02) VALUE  SPACES.    02630000
026510     05  DL-LAST-ACT-DATE            PIC  X(08) VALUE  ZEROES.    02620000
026600     05  FILLER                      PIC  X(02) VALUE  SPACES.    02650000
026610     05  DL-CTN-UNITS                PIC  ZZZ9.                           
026620     05  FILLER                      PIC  X(02) VALUE  SPACES.            
026700     05  DL-STATUS                   PIC  X(32) VALUE  ZEROES.    02660000
026800                                                                  02670000
026900 01  DL-DETAIL-LINE-2.                                            02680003
027000     05  FILLER                      PIC  X(06) VALUE  SPACES.    02690004
027100     05  FILLER                      PIC  X(07) VALUE  SPACES.    02700003
027200     05  FILLER                      PIC  X(15) VALUE  SPACES.    02710003
027300     05  FILLER                      PIC  X(10) VALUE  SPACES.    02720003
027400     05  FILLER                      PIC  X(05) VALUE  SPACES.    02730003
027500     05  FILLER                      PIC  X(06) VALUE  SPACES.    02740003
027600     05  FILLER                      PIC  X(10) VALUE  SPACES.    02750003
027700     05  FILLER                      PIC  X(06) VALUE  SPACES.    02760003
027800     05  FILLER                      PIC  X(10) VALUE  SPACES.    02770003
027900     05  FILLER                      PIC  X(13) VALUE  SPACES.    02780003
028000     05  FILLER                      PIC  X(11) VALUE  SPACES.    02790003
028100     05  DL-STATUS-2                 PIC  X(40) VALUE  SPACES.    02800003
028200                                                                  02810003
028300 01  EP-EMPTY-REPORT-LINE.                                        02820003
028400     05  FILLER                       PIC X(54)  VALUE SPACES.    02830000
028500     05  FILLER                       PIC X(25)  VALUE            02840000
028600         '******* NO DATA *********'.                             02850000
028700     05  FILLER                       PIC X(54)  VALUE SPACES.    02860000
028800 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    02870000
028900                                                                  02880000
029000 01  END-OF-REPORT-LINE.                                          02890000
029100     05  FILLER                  PIC  X(44)    VALUE SPACES.      02900000
029200     05  FILLER                  PIC  X(45)    VALUE              02910000
029300          '*******   E N D   O F   R E P O R T   *******'.        02920000
029400     05  FILLER                  PIC  X(43)    VALUE SPACES.      02930000
029500/                                                                 02940000
029600******************************************************************02950000
029700     COPY SQLCA2.                                                 02960000
029800                                                                  02970000
029900     EXEC SQL                                                     02980000
030000         INCLUDE SQLCA                                            02990000
030100     END-EXEC.                                                    03000000
030200*----------------------------------------------------------------*03010000
030300*    DB2 DCLGEN FOR TRECEIV TABLE                                 03020000
030400*----------------------------------------------------------------*03030000
030500     EXEC SQL                                                     03040000
030600          INCLUDE TRECEIV                                         03050000
030700     END-EXEC.                                                    03060000
030800                                                                  03070000
030900*---------------------------------------------------------------* 03080000
031000*    SUT_OTBND_CART OUTBOUND CARTON TABLE                         03090000
031100*---------------------------------------------------------------* 03100000
031200     EXEC SQL                                                     03110000
031300          INCLUDE SUT00024                                        03120000
031400     END-EXEC.                                                    03130000
031500                                                                  03140000
031600*---------------------------------------------------------------* 03150000
031700*    SUT_OTBND_UPC UPC TABLE                                      03160000
031800*---------------------------------------------------------------* 03170000
031900     EXEC SQL                                                     03180000
032000          INCLUDE SUT00028                                        03190000
032100     END-EXEC.                                                    03200000
032200                                                                  03210000
032300*---------------------------------------------------------------* 03220000
032400*    SUT_OTBND_VND                                                03230000
032500*---------------------------------------------------------------* 03240000
032600     EXEC SQL                                                     03250000
032700          INCLUDE SUT00026                                        03260000
032800     END-EXEC.                                                    03270000
032900                                                                  03280000
033000*---------------------------------------------------------------* 03290000
033100*    TPKSLIP                                                      03300000
033200*---------------------------------------------------------------* 03310000
033300     EXEC SQL                                                     03320000
033400          INCLUDE TPKSLIP                                         03330000
033500     END-EXEC.                                                    03340000
033600                                                                  03350000
033700*----------------------------------------------------------------*03360000
033800*    CURSOR TO RETRIEVE CARTONS BY PO/RCVR/LINE/STORE             03370000
033900*----------------------------------------------------------------*03380000
034000     EXEC SQL                                                     03390000
034100          DECLARE CARTON-CSR CURSOR FOR                           03400000
034200        SELECT  DISTINCT (A.SHIPT_UNT_ID)                         03410000
034210               ,SUM(A.SHPD_UNT_QTY)                                       
034300          FROM  SUT_OTBND_UPC A                                   03420000
034400               ,SUT_OTBND_CART B                                  03430000
034500         WHERE  A.TRN_NBR           = :PC038-PO-NBR               03440000
034600           AND  A.RCVR_SEQ_NBR      = :PC038-RCVR-SEQ-NBR         03450000
034700           AND  A.TRN_LNE_NBR       = :DK-LINE-NBR                03460000
034800           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              03470000
034900           AND  B.ACTV_IND          = 'Y'                         03480000
035000           AND  B.DEST_LOC_NBR      = :DK-STORE-NBR               03490000
035010         GROUP BY A.SHIPT_UNT_ID                                          
036900     END-EXEC.                                                    03680000
037000                                                                  03690000
037100****************************************************************  03700000
037200 PROCEDURE DIVISION.                                              03710000
037300****************************************************************  03720000
037400 0000-MAINLINE.                                                   03730000
037500                                                                  03740000
037600     PERFORM 1000-INITIALIZE                                      03750000
037700                                                                  03760000
037800     PERFORM 2000-PROCESS UNTIL PS-EOF-ERROR-FILE                 03770000
037900                                                                  03780000
038000     PERFORM 9000-EOJ.                                            03790000
038100                                                                  03800000
038200 THE-DUMPER.                                                      03810000
038300     GOBACK.                                                      03820000
038400                                                                  03830000
038500 1000-INITIALIZE.                                                 03840000
038600                                                                  03850000
038700     DISPLAY ' PCKRP015 STARTED'                                  03860000
038800     EXEC SQL SET :PV-TMST = CURRENT TIMESTAMP END-EXEC           03870000
038900                                                                  03880000
039000     OPEN OUTPUT REPORT-FILE                                      03890000
039100* LOAD SYSTEM DATE INTO HEADINGS                                  03900000
039200     ACCEPT SD-SYSTEM-DATE FROM DATE.                             03910000
039300     ACCEPT ST-SYSTEM-TIME FROM TIME.                             03920000
039400                                                                  03930000
039500     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              03940000
039600     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             03950000
039700     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               03960000
039800     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              03970000
039900     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            03980000
040000                                                                  03990000
040100     MOVE PC-CURRENT-PROGRAM-NAME                                 04000000
040200                                 TO DP132O-PROGRAM-NAME.          04010000
040300     MOVE 1                      TO DP132O-REPORT-NUMBER          04020000
040400                                    DP132O-PAGE-NUMBER            04030000
040500                                                                  04040000
040600     PERFORM 8100-WRITE-MAIN-HEADINGS                             04050000
040700                                                                  04060000
040800     OPEN INPUT EXTRACT-FILE                                      04070000
040900     PERFORM 8000-READ-EXTRACT                                    04080000
041000                                                                  04090003
041100     MOVE PC038-OPER-UNT-ID    TO PV-PREV-OPER.                   04100003
041200                                                                  04110003
041300     IF PS-EOF-ERROR-FILE                                         04120000
041400         DISPLAY ' -- NO UNBALANCED STR EXP -- '                  04130000
041500         WRITE REPORT-RECORD FROM EP-EMPTY-REPORT-LINE            04140000
041600             AFTER ADVANCING 3 LINES                              04150000
041700     END-IF.                                                      04160000
041800******************************************************************04170003
041900 2000-PROCESS.                                                    04180000
042000******************************************************************04190003
042100     INITIALIZE DL-DETAIL-LINE-1.                                 04200000
042200                                                                  04210000
042300     IF PC038-OPER-UNT-ID = PV-PREV-OPER                          04220001
042400         MOVE PC038-OPER-UNT-ID       TO DL-OPER-UNT-ID           04230001
042500     ELSE                                                         04240000
042600         WRITE REPORT-RECORD FROM DL-BLANK-LINE                   04250000
042700               AFTER ADVANCING 1 LINES                            04260000
042800         ADD 1                   TO PV-LINES-USED                 04270000
042900         IF PV-LINES-USED > PC-END-OF-PAGE                        04280000
043000             PERFORM 8100-WRITE-MAIN-HEADINGS                     04290000
043100         END-IF                                                   04300000
043200         MOVE PC038-OPER-UNT-ID       TO DL-OPER-UNT-ID           04310001
043300         MOVE PC038-OPER-UNT-ID       TO PV-PREV-OPER             04320001
043400     END-IF.                                                      04330000
043500                                                                  04340000
043600     MOVE PC038-LOC-NBR               TO DL-STORE-NBR.            04350009
043700     IF PC038-APP-PO-LNE-NBR-X NUMERIC                            04360000
043800          MOVE PC038-APP-PO-LNE-NBR   TO DL-APP-PO-LNE-NBR        04370000
043900     ELSE                                                         04380000
044000          MOVE PC038-APP-PO-LNE-NBR-X TO DL-APP-PO-LNE-NBR-X      04390000
044100     END-IF.                                                      04400000
044200                                                                  04410000
044300     MOVE PC038-PO-NBR                TO DL-PO                    04420000
044400     MOVE '-'                         TO DL-DASH.                 04430000
044500     MOVE PC038-RCVR-SEQ-NBR          TO DL-RCVR.                 04440000
044600     MOVE PC038-REC-TYP-CDE           TO DL-REC-TYP.              04450000
044700     MOVE PC038-DEPT-NBR              TO DL-DEPT-NBR.             04460000
044800     MOVE PC038-SKU-9                 TO DL-SKU-NBR.              04470000
044900     MOVE PC038-STR-EXPECTED-UNITS    TO DL-STORE-EXP-UNITS.      04480000
045000     MOVE PC038-INTRNST-TRN-DTE       TO PV-INTR-TRN-DTE.         04490000
045100     MOVE PV-INTR-YY                  TO PV-KEY-INTR-YY.          04500000
045200     MOVE PV-INTR-MM                  TO PV-KEY-INTR-MM.          04510000
045300     MOVE PV-INTR-DD                  TO PV-KEY-INTR-DD.          04520000
045400     MOVE PV-KEY-INTR-DATE            TO DL-LAST-ACT-DATE.        04530000
045500     MOVE PC038-EXTD-RTL-AMT          TO DL-EXT-RTL-AMT.          04540000
045600                                                                  04550000
045700     IF PC038-RCVR-SEQ-NBR  =  ZEROES                             04560003
045800         MOVE SPACES      TO DL-VRFD-DATE                         04570003
045900     ELSE                                                         04580003
046000         IF PC038-PO-NBR   =     PV-PREV-PO                       04590003
046100             IF PC038-RCVR-SEQ-NBR  =     PV-PREV-RCVR            04600003
046200                 MOVE PV-KEY-DATE TO DL-VRFD-DATE                 04610003
046300             ELSE                                                 04620003
046400                 IF PC038-RCVR-SEQ-NBR  NOT = ZEROES              04630003
046500                     PERFORM 2400-GET-TRECEIV-VFYD-DATE           04640003
046600                     MOVE PC038-RCVR-SEQ-NBR    TO PV-PREV-RCVR   04642017
046700                 END-IF                                           04650003
046800             END-IF                                               04660003
046900          ELSE                                                    04670003
047000             PERFORM 2400-GET-TRECEIV-VFYD-DATE                   04680003
047100             MOVE PC038-PO-NBR          TO PV-PREV-PO             04681017
047200             MOVE PC038-RCVR-SEQ-NBR    TO PV-PREV-RCVR           04682017
047300         END-IF                                                   04690003
047400     END-IF.                                                      04700003
047500                                                                  04710000
047600     INITIALIZE PC046-COMMAREA-REC.                               04720000
047700     PERFORM 5000-RETRIEVE-CARTONS                                04730000
047800     IF PC046-OTBD-TRIP-ID = ZEROES                               04740000
047900         IF PC046-CARTON-ID    = ZEROES                           04750003
048000             WRITE REPORT-RECORD FROM DL-DETAIL-LINE-1            04760003
048100               AFTER ADVANCING 1 LINES                            04770000
048200             ADD 1                        TO PV-LINES-USED        04780003
048300             IF PV-LINES-USED > PC-END-OF-PAGE                    04790003
048400                 PERFORM 8100-WRITE-MAIN-HEADINGS                 04800003
048500             END-IF                                               04810003
048600         END-IF                                                   04820003
048700     END-IF.                                                      04830000
048800     PERFORM 8000-READ-EXTRACT.                                   04840000
048900                                                                  04850000
049000******************************************************************04860000
049100 2400-GET-TRECEIV-VFYD-DATE.                                      04870000
049200******************************************************************04880000
049300     MOVE '2400-GET-TRECEIV-VFYD-DATE'    TO PV-PARAGRAPH.        04890000
049400                                                                  04900000
049500     INITIALIZE RECEIV-VERFYD-TMST.                               04910000
049600                                                                  04920000
049700     PERFORM                                                      04930000
049800         WITH TEST AFTER                                          04940000
049900         VARYING PV-RETRY-COUNTER                                 04950000
050000         FROM 1 BY 1                                              04960000
050100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               04970000
050200            OR  (SQLCODE = +100)                                  04980000
050300            OR  (SQLCODE = +0))                                   04990000
050400                                                                  05000000
050500         EXEC SQL                                                 05010000
050600             SELECT VERFYD_TMST                                   05020000
050700              INTO :RECEIV-VERFYD-TMST                            05030000
050800              FROM  TRECEIV                                       05040000
050900             WHERE  ORD_NBR     = :PC038-PO-NBR                   05050000
051000               AND  REC_SEQ_NBR = :PC038-RCVR-SEQ-NBR             05060000
051100         WITH UR                                                  05070000
051200         END-EXEC                                                 05080000
051300                                                                  05090000
051400         EVALUATE TRUE                                            05100000
051500             WHEN SQLCODE = ZERO                                  05110000
051600                 IF RECEIV-VERFYD-TMST NOT =                      05120000
051700                                     '9999-09-09-09.09.09.999999' 05130000
051800                     MOVE RECEIV-VERFYD-TMST TO PV-DB2-DATE       05140000
051900                     MOVE PV-DB2-YY   TO PV-KEY-YY                05150000
052000                     MOVE PV-DB2-MM   TO PV-KEY-MM                05160000
052100                     MOVE PV-DB2-DD   TO PV-KEY-DD                05170000
052200                     MOVE PV-KEY-DATE TO DL-VRFD-DATE             05180000
052300                 ELSE                                             05190000
052400                     MOVE SPACES TO   DL-VRFD-DATE                05200000
052410                                      PV-KEY-DATE                         
052500                 END-IF                                           05210000
052600             WHEN SQLCODE = +100                                  05220000
052700                 MOVE SPACES TO   DL-VRFD-DATE                    05230000
052800             WHEN SQLCODE = -904                                  05240000
052900             WHEN SQLCODE = -911                                  05250000
053000             WHEN SQLCODE = -913                                  05260000
053100                  CONTINUE                                        05270000
053200                                                                  05280000
053300             WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')              05290000
053400                 DISPLAY '**************************************' 05300000
053500                 DISPLAY 'WARNING ISSUED '                        05310000
053600                 DISPLAY 'SELECT TRECEIV                        ' 05320000
053700                 DISPLAY '**************************************' 05330000
053800                 PERFORM 9300-SQL-WARNING                         05340000
053900                                                                  05350000
054000             WHEN SQLCODE < ZERO                                  05360000
054100                 DISPLAY '**************************************' 05370000
054200                 DISPLAY 'ERROR ISSUED ON                       ' 05380000
054300                 DISPLAY 'SELECT TRECEIV                        ' 05390000
054400                 DISPLAY '**************************************' 05400000
054500                 PERFORM 9200-SQL-ERROR                           05410000
054600                                                                  05420000
054700         END-EVALUATE                                             05430000
054800     END-PERFORM.                                                 05440000
054900                                                                  05450000
055000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05460000
055100         SQLCODE NOT = ZERO                                       05470000
055200         DISPLAY '**************************************'         05480000
055300         DISPLAY 'MAX RETRIES EXCEEDED ATTEMPTING TO    '         05490000
055400         DISPLAY 'SELECT TRECEIV         '                        05500000
055500         DISPLAY '**************************************'         05510000
055600         PERFORM 9200-SQL-ERROR                                   05520000
055700     END-IF.                                                      05530000
055800                                                                  05540000
055900*----------------------------------------------------------------*05550000
056000 5000-RETRIEVE-CARTONS.                                           05560000
056100     MOVE '5000-RETRIEVE-CARTONS '    TO PV-PARAGRAPH.            05570000
056200                                                                  05580000
056300     MOVE PC038-APP-PO-LNE-NBR  TO DK-LINE-NBR.                   05590000
056400     MOVE PC038-LOC-NBR         TO DK-STORE-NBR.                  05600000
056500     PERFORM 5100-OPEN-CURSOR.                                    05610000
056600     PERFORM 5200-FETCH UNTIL SQLCODE = +100.                     05620000
056700     PERFORM 5300-CLOSE-CURSOR.                                   05630000
056800                                                                  05640000
056900*----------------------------------------------------------------*05650000
057000* OPEN THE CURSOR                                                 05660000
057100*----------------------------------------------------------------*05670000
057200 5100-OPEN-CURSOR.                                                05680000
057300         EXEC SQL                                                 05690000
057400              OPEN CARTON-CSR                                     05700000
057500         END-EXEC                                                 05710000
057600                                                                  05720000
057700         EVALUATE TRUE                                            05730000
057800             WHEN SQLCODE = ZERO                                  05740000
057900             WHEN SQLCODE = -904                                  05750000
058000             WHEN SQLCODE = -913                                  05760000
058100                 CONTINUE                                         05770000
058200             WHEN SQLWARN0 NOT = SPACES                           05780000
058300             WHEN SQLCODE < ZERO                                  05790000
058400             WHEN SQLCODE > ZERO                                  05800000
058500                 CONTINUE                                         05810000
058600         END-EVALUATE.                                            05820000
058700*                                                                 05830000
058800*----------------------------------------------------------------*05840000
058900*    FETCH THE CURSOR                                             05850000
059000*----------------------------------------------------------------*05860000
059100 5200-FETCH.                                                      05870000
059200                                                                  05880000
059300     EXEC SQL                                                     05890000
059400         FETCH CARTON-CSR                                         05900000
059500         INTO  :SUT00028-SHIPT-UNT-ID                             05910000
059510              ,:SUT00028-SHPD-UNT-QTY                                     
059600     END-EXEC.                                                    05920000
059700                                                                  05930000
059800     EVALUATE TRUE                                                05940000
059900         WHEN SQLCODE = ZEROS                                     05950000
060000              INITIALIZE PC046-COMMAREA-REC                               
060100              MOVE SUT00028-SHIPT-UNT-ID TO  PC046-CARTON-ID      05960000
060110              MOVE SUT00028-SHPD-UNT-QTY TO  DL-CTN-UNITS                 
060200              PERFORM 6000-CALL-CRTN-STATUS-PGM                   05970000
060300         WHEN SQLCODE = +100                                      05980000
060400              CONTINUE                                            05990000
060500         WHEN OTHER                                               06000000
060600              CONTINUE                                            06010000
060700     END-EVALUATE.                                                06020000
060800                                                                  06030000
060900*----------------------------------------------------------------*06040000
061000* CLOSE THE CURSOR.                                               06050000
061100*----------------------------------------------------------------*06060000
061200 5300-CLOSE-CURSOR.                                               06070000
061300                                                                  06080000
061400     EXEC SQL                                                     06090000
061500          CLOSE CARTON-CSR                                        06100000
061600     END-EXEC.                                                    06110000
061700                                                                  06120000
061800     EVALUATE TRUE                                                06130000
061900         WHEN SQLCODE = ZERO                                      06140000
062000         WHEN SQLCODE = +100                                      06150000
062100             CONTINUE                                             06160000
062200         WHEN SQLWARN0 NOT = SPACES                               06170000
062300         WHEN SQLCODE < ZERO                                      06180000
062400         WHEN SQLCODE > ZERO                                      06190000
062500             CONTINUE                                             06200000
062600     END-EVALUATE.                                                06210000
062700                                                                  06220000
062800**************************************************************    06230000
062900* DETERMINE LAST ACTIVITY FOR CARTON (CHECK IN REVERSE ORDER)     06240000
063000* THIS WILL CALL PCKUT713 WHICH BRINGS BACK ALL INFORMATION ON    06250000
063100* THE CARTON ENTERED.                                             06260000
063200**************************************************************    06270000
063300 6000-CALL-CRTN-STATUS-PGM.                                       06280000
063400                                                                  06290000
063500     MOVE '6000-CALL-CRTN-STATUS-PGM '    TO PV-PARAGRAPH.        06300000
063510                                                                          
063520     IF  PC046-CARTON-ID = PV-PREV-CARTON-ID                              
063530         MOVE PV-PREV-STATUS TO DL-STATUS                                 
063531         ADD +1  TO  PV-NOCALL-CNT                                        
063540     ELSE                                                                 
063550         MOVE SPACES TO PV-PREV-STATUS                                    
063560         MOVE PC046-CARTON-ID TO PV-PREV-CARTON-ID                        
063561         ADD +1  TO  PV-CALL-CNT                                          
063570         CALL PC046-CARTON-STATUS-MODULE                                  
063580                   USING PC046-COMMAREA-REC                               
063591         PERFORM 6005-VALIDATE-STATUS-CALL                                
063592     END-IF.                                                              
063600                                                                  06310000
064100                                                                  06360003
064200*    IF PC046-TRIP-STATUS = 'SU' AND PC046-OTBD-TRIP-ID > ZERO    06800014
064300*        CONTINUE                                                         
064400*    ELSE                                                                 
064500                                                                          
064600         WRITE REPORT-RECORD FROM DL-DETAIL-LINE-1                06550018
064700              AFTER ADVANCING 1 LINES                             06560018
064800         ADD 1  TO PV-LINES-USED                                  06570018
064900         IF PV-LINES-USED > PC-END-OF-PAGE                        06580018
065000             PERFORM 8100-WRITE-MAIN-HEADINGS                     06590018
065100         END-IF.                                                  06600018
065200*    END-IF.                                                      06600018
065300                                                                  06720014
065400                                                                  06370020
065500                                                                  06720014
065600**************************************************************    06730014
065700* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL 06740014
065800**************************************************************    06750014
065900 6005-VALIDATE-STATUS-CALL.                                       06760014
066000                                                                  06770014
066100     IF PC046-SUCCESSFUL                                          06780014
066200         MOVE SPACES TO DL-STATUS                                 06790014
066300         IF PC046-OTBD-TRIP-ID > 0                                06800014
066400             MOVE PC046-OTBD-TRIP-ID TO PV-TRIP                   06810014
066500                                        PV-PREV-TRIP              06820014
066510             MOVE PC046-CARTON-ID    TO PV-CARTON                         
066600             STRING PV-CARTON           DELIMITED BY SIZE         06830014
066700                ' '                     DELIMITED BY SIZE         06840014
066800                PV-TRIP                 DELIMITED BY SIZE         06850014
066810                ' '                     DELIMITED BY SIZE                 
066820                PC046-TRIP-STATUS       DELIMITED BY SIZE                 
066900                                           INTO DL-STATUS         06860014
066910             MOVE DL-STATUS TO PV-PREV-STATUS                             
067000         ELSE                                                     06870014
067100             MOVE PC046-CARTON-ID TO PV-CARTON                    06880014
067200                                     PV-PREV-CARTON               06890014
067300             STRING PV-CARTON             DELIMITED BY SIZE       06900014
067400                   ' '                    DELIMITED BY SIZE       06910014
067500                  PC046-CRTN-STAT-DESC    DELIMITED BY SIZE       06920014
067600                                           INTO DL-STATUS         06930000
067610             MOVE DL-STATUS TO PV-PREV-STATUS                             
067700         END-IF                                                   06940000
067800     ELSE                                                         06950000
067900         IF PC046-ERROR                                           06960000
068000             DISPLAY '** ABEND - PROGRAM '                        06970000
068100                     PC-CURRENT-PROGRAM-NAME ' **'                06980000
068200             DISPLAY '** BAD CALL TO CRTN STATUS PGM PCKUT713'    06990000
068300             DISPLAY PC046-CRA-RET-MSG                            07000000
068400             MOVE +4019 TO ABEND-CODE                             07010000
068500             CALL 'ILBOABN0' USING ABEND-CODE                     07020000
068600             MOVE '6005-'                TO PC046-CRA-REQ-ID      07030000
068700         ELSE                                                     07040013
068800             MOVE SPACES TO DL-STATUS                             07050013
068810                            PV-PREV-STATUS                                
068900         END-IF                                                   07060013
069000     END-IF.                                                      07070013
069100                                                                  07080013
069200 8000-READ-EXTRACT.                                               07090013
069300     READ EXTRACT-FILE                                            07100013
069400         INTO PC038-SE-UNBALANCED-RPT-REC                         07110013
069500     AT END                                                       07120013
069600         SET PS-EOF-ERROR-FILE        TO TRUE                     07130013
069700     NOT AT END                                                   07140013
069800         ADD 1                        TO PV-READ-COUNT            07150000
069900     END-READ.                                                    07160000
070000                                                                  07170000
070100*    IF PC038-PO-NBR   = 4562481                                  07170000
070200*           AND PC038-RCVR-SEQ-NBR  = 4                           07170000
070300*        DISPLAY 'TRAP1'                                                  
070400*    END-IF.                                                              
070500                                                                  07170000
070600                                                                  07170000
070700 8100-WRITE-MAIN-HEADINGS.                                        07180000
070800                                                                  07190000
070900     ADD 1                            TO PV-PAGE-COUNT.           07200000
071000     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      07210000
071100     MOVE ZERO                        TO PV-LINES-USED            07220000
071200                                                                  07230000
071300     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      07240000
071400                 AFTER ADVANCING PAGE                             07250000
071500                                                                  07260000
071600     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1                   07270000
071700        AFTER ADVANCING 2 LINES.                                  07280000
071800     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1A                  07290000
071900        AFTER ADVANCING 1 LINES.                                  07300000
072000     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07310000
072100        AFTER ADVANCING 1 LINES.                                  07320000
072200     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2A                  07330000
072300        AFTER ADVANCING 1 LINES.                                  07340000
072400     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2                   07350000
072500        AFTER ADVANCING 1 LINES.                                  07360000
072600     ADD 6                            TO PV-LINES-USED.           07370000
072700                                                                  07380000
072800     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3                   07390000
072900        AFTER ADVANCING 2 LINES.                                  07400000
073000                                                                  07410000
073100*    WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07420002
073200*       AFTER ADVANCING 1 LINES.                                  07430002
073300                                                                  07440000
073400     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   07450000
073500     ADD  3                           TO PV-LINES-USED.           07460000
073600/                                                                 07470000
073700 9000-EOJ.                                                        07480000
073800                                                                  07490000
073900     WRITE REPORT-RECORD                                          07500000
074000       FROM END-OF-REPORT-LINE                                    07510000
074100         AFTER ADVANCING 2 LINES.                                 07520000
074200                                                                  07530000
074300     CLOSE REPORT-FILE                                            07540000
074400           EXTRACT-FILE.                                          07550000
074500     MOVE PV-READ-COUNT               TO PV-DISP-COUNT            07560000
074600     DISPLAY ' RECORDS READ  = ' PV-DISP-COUNT.                   07570000
074610     DISPLAY ' CALLS TO 713  = ' PV-CALL-CNT.                             
074620     DISPLAY ' NO CALLS 713  = ' PV-NOCALL-CNT.                           
074700/                                                                 07580000
074800 9100-ABEND.                                                      07590000
074900                                                                  07600000
075000     CLOSE EXTRACT-FILE                                           07610000
075100           REPORT-FILE                                            07620000
075200                                                                  07630000
075300     MOVE +4013                       TO ABEND-CODE.              07640000
075400     CALL 'ILBOABN0' USING ABEND-CODE.                            07650000
075500                                                                  07660000
075600 9200-SQL-ERROR.                                                  07670000
075700                                                                  07680000
075800     MOVE SQLCODE                     TO SQLCODE2.                07690000
075900     MOVE SQLERRD(3)                  TO SQLERRD3.                07700000
076000                                                                  07710000
076100     DISPLAY '** ABEND **         ** = SQLERROR'.                 07720000
076200     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07730000
076300     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   07740000
076400     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07750000
076500                                                                  07760000
076600     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                07770000
076700     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                07780000
076800     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 07790000
076900     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                07800000
077000                                                                  07810000
077100                                                                  07820000
077200     MOVE +4013                       TO ABEND-CODE.              07830000
077300     CALL 'ILBOABN0' USING ABEND-CODE.                            07840000
077400                                                                  07850000
077500 9300-SQL-WARNING.                                                07860000
077600                                                                  07870000
077700     DISPLAY '9300-SQL-WARNING'.                                  07880000
077800     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        07890000
077900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   07900000
078000     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                07910000
078100                                                                  07920000
078200     MOVE SQLCODE                     TO SQLCODE2.                07930000
078300     MOVE SQLERRD(3)                  TO SQLERRD3.                07940000
078400     DISPLAY '** ABEND **       ** = SQLWARNING'.                 07950000
078500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  07960000
078600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  07970000
078700     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  07980000
078800     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  07990000
078900     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  08000000
079000     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  08010000
079100     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  08020000
079200     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  08030000
079300     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  08040000
079400     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  08050000
079500                                                                  08060000
079600     MOVE +4013                       TO ABEND-CODE.              08070000
079700     CALL 'ILBOABN0' USING ABEND-CODE.                            08080000
079800                                                                  08090000
