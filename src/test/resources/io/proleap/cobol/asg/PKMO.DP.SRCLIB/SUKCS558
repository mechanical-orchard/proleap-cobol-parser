000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    SUKCS558.                                         00020000
000300 AUTHOR.        DENNIS STEFFEN.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  JULY, 2002.                                       00050000
000600 DATE-COMPILED.                                                   00060000
000700*----------------------------------------------------------------*00070000
000800*    S558 - OUTBOUND TRLR/DOOR STATUS CRITERIA SPECIFICATION     *00080000
000900*----------------------------------------------------------------*00090000
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00092067
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00093067
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00094067
001130*                                                                 00094168
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00094268
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00094368
263968*---------------------------------------------------------------* 00095067
001000 ENVIRONMENT DIVISION.                                            00100000
001100 DATA DIVISION.                                                   00110000
001200                                                                  00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400*----------------------------------------------------------------*00140000
001500*   PROGRAM CONSTANTS                                            *00150000
001600*----------------------------------------------------------------*00160000
001700 01  PC-PROGRAM-CONSTANTS.                                        00170000
001800     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU558A  '.  00180000
001900     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM558 '.  00190000
002000     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS558'.  00200000
002100     05  PC-TRLR-STATUS-PGM        PIC  X(08)  VALUE 'PCKCS896'.  00210000
002200     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00220013
002300     05  PC-OP-CO-NBR              PIC  X(02)  VALUE '03'.        00230000
002400     05  PC-000                    PIC  X(03)  VALUE '000'.       00240000
002500     05  PC-Y                      PIC  X(25)  VALUE              00250000
002600                                     'Y                        '. 00260000
002700     05  PC-FCLTY-ID-0001          PIC  9(04)  VALUE  0001.       00270000
002800     05  PC-CORPORATE-OFFICE       PIC  X(03)  VALUE '090'.       00280000
002900     05  PC-MENO-FALLS-DC          PIC  9(04)  VALUE  0085.       00290000
003000     05  PC-01                     PIC  X(02)  VALUE '01'.        00300000
003100     05  PC-CS                     PIC  X(02)  VALUE 'CS'.        00310000
003200     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00320000
003300     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00330000
003400     05  PC-ALL                    PIC  X(04)  VALUE 'ALL '.      00340000
003500     05  PC-DFLT-FROM-MONTH        PIC  9(02)  VALUE 01.          00350000
003600     05  PC-DFLT-FROM-DAY          PIC  9(02)  VALUE 01.          00360000
003700     05  PC-DFLT-FROM-YEAR         PIC  9(04)  VALUE 1999.        00370000
003800     05  PC-DFLT-TO-MONTH          PIC  9(02)  VALUE 12.          00380000
003900     05  PC-DFLT-TO-DAY            PIC  9(02)  VALUE 31.          00390000
004000     05  PC-DFLT-TO-YEAR           PIC  9(04)  VALUE 2099.        00400000
004100     05  PC-A                      PIC  X(01)  VALUE 'A'.         00410000
004200     05  PC-P                      PIC  X(01)  VALUE 'P'.         00420000
004300     05  PC-Z                      PIC  X(01)  VALUE 'Z'.         00430000
004400     05  PC-DPT                    PIC  X(03)  VALUE 'DPT'.       00440000
004410     05  PC-DFLT-TMST              PIC  X(26)  VALUE              00441025
004420                                   '9999-09-09-09.09.09.999999'.  00442025
004500                                                                  00450000
004600*-----------------------------------------------------------------00460000
004700*  DB2 KEYS                                                       00470000
004800*-----------------------------------------------------------------00480000
004900 01  DK-DB2-KEYS.                                                 00490000
005000                                                                  00500000
005100     05  DK-CURR-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.00510000
005200     05  DK-CURR-FCLTY-ID               PIC S9(04)  COMP VALUE +0.00520000
005210*ROOPA START                                                      00521055
005220     05  DK-ORGN-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.00522056
005230*ROOPA END                                                        00523056
005300     05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.00530000
005400     05  DK-STORE-NBR                   PIC S9(04)  COMP VALUE +0.00540000
005500     05  DK-TRLR-SRL-NBR                PIC S9(09)  COMP VALUE +0.00550000
005600     05  DK-TRLR-ID                     PIC  X(12)  VALUE SPACES. 00560000
005610*ROOPA START                                                      00561056
005620     05  DK-SCR-SHIP                    PIC  X(10)  VALUE SPACE.  00562056
005621     05  DK-TRIP-ID                     PIC S9(09)  COMP VALUE +0.00562156
005622*ROOPA END                                                        00562256
005700     05  DK-SCAC-CDE                    PIC  X(04)  VALUE SPACES. 00570000
005800     05  DK-OTBND-TRIP-ID               PIC S9(09)  COMP VALUE +0.00580000
005900     05  DK-OPER-UNT-ID-DISPLAY.                                  00590000
006000         10  FILLER                     PIC  X(01)  VALUE SPACES. 00600000
006100         10  DK-OPER-UNT-ID-3           PIC  X(03)  VALUE SPACES. 00610000
006200     05  DK-STORE-NUMBER                PIC  X(04)  VALUE SPACES. 00620000
006300     05  DK-STORE-NUMBER-R REDEFINES DK-STORE-NUMBER.             00630000
006400         10  FILLER                     PIC  X(01).               00640000
006500         10  DK-STORE-NUMBER-3POS       PIC  X(03).               00650000
006600                                                                  00660000
006700*----------------------------------------------------------------*00670000
006800*  SYSTEM MESSAGES                                               *00680000
006900*----------------------------------------------------------------*00690000
007000*   00005 = INVALID VALUE                                         00700000
007100*   00007 = REQUIRED ENTRY                                        00710000
007200*   00008 = MUST BE NUMERIC                                       00720000
007300*   00009 = INVALID DATE                                          00730000
007400*   00045 = INVALID FUNCTION KEY                                  00740000
007500*   00840 = YOU ARE NOT AUTHORIZED TO VIEW THIS DATA              00750000
007600*   02221 = CREATE FROM DATE MUST BE BEFORE CREATE TO DATE        00760000
007700*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                  00770000
007800*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          00780000
007900*   02697 - OUTBOUND TRIP ID NOT CONNECTED TO TRAILER SERIAL NBR  00790000
008000*   02698 - DATE RANGE INVALID                                    00800000
008100*   02926 - A TRAILER STATUS MUST BE SELECTED WHEN STATUS DAYS IS 00810000
008200*           ENTERED                                               00820000
008300*   03051 - INVALID TRAILER SEAL                                  00830000
008400*   03052 - MULTIPLE TRIPS W/ SEAL TRIP ID REQUIRED               00840000
008500*   03053 - INVALID OUTBOUND TRIP ID                              00850000
008510*   03728 - BEGIN DIVERT HAS BEEN SET                             00851024
008600*                                                                 00860000
008700*----------------------------------------------------------------*00870000
008800 01  PC-TSYMSG-NUMBERS.                                           00880000
008900     05  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.          00890000
009000     05  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.          00900000
009100     05  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.          00910000
009200     05  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.          00920000
009300     05  PC-TSYMSG-00032       PIC  9(05)  VALUE  00032.          00930000
009400     05  PC-TSYMSG-00045       PIC  9(05)  VALUE  00045.          00940000
009500     05  PC-TSYMSG-00840       PIC  9(05)  VALUE  00840.          00950000
009600     05  PC-TSYMSG-02221       PIC  9(05)  VALUE  02221.          00960000
009700     05  PC-TSYMSG-02224       PIC  9(05)  VALUE  02224.          00970000
009800     05  PC-TSYMSG-02227       PIC  9(05)  VALUE  02227.          00980000
009900     05  PC-TSYMSG-02307       PIC  9(05)  VALUE  02307.          00990000
010000     05  PC-TSYMSG-02516       PIC  9(05)  VALUE  02516.          01000000
010100     05  PC-TSYMSG-02697       PIC  9(05)  VALUE  02697.          01010000
010200     05  PC-TSYMSG-02698       PIC  9(05)  VALUE  02698.          01020000
010300     05  PC-TSYMSG-02926       PIC  9(05)  VALUE  02926.          01030000
010400     05  PC-TSYMSG-03051       PIC  9(05)  VALUE  03051.          01040000
010500     05  PC-TSYMSG-03052       PIC  9(05)  VALUE  03052.          01050000
010600     05  PC-TSYMSG-03053       PIC  9(05)  VALUE  03053.          01060000
010610*ROOPA START                                                      01061056
010620     05  PC-TSYMSG-03745       PIC  9(05)  VALUE  03745.          01062040
010630     05  PC-TSYMSG-01303       PIC  9(05)  VALUE  01303.          01063040
010640*ROOPA END                                                        01064040
010700     05  PC-TSYMSG-03310       PIC  9(05)  VALUE  03310.          01070006
010800     05  PC-TSYMSG-03363       PIC  9(05)  VALUE  03363.          01080019
010810     05  PC-TSYMSG-03728       PIC  9(05)  VALUE  03728.          01081024
010900                                                                  01090000
011000*----------------------------------------------------------------*01100000
011100*   PROGRAM MESSAGES                                             *01110000
011200*----------------------------------------------------------------*01120000
011300 01  PM-PROGRAM-MESSAGES.                                         01130000
011400     05  PM-ABEND-INFO-A.                                         01140000
011500         10  FILLER                PIC X(15)   VALUE              01150000
011600                                   'DP020-SRC-AID: '.             01160000
011700         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      01170000
011800         10  FILLER                PIC X(19)   VALUE              01180000
011900                                   '. DP020-FK-ACTION: '.         01190000
012000         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      01200000
012100         10  FILLER                PIC X(22)   VALUE              01210000
012200                                   '. DP020-FK-DISPN-IND: '.      01220000
012300         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      01230000
012400         10  FILLER                PIC X(01)   VALUE '.'.         01240000
012500         10  FILLER                PIC X(19)   VALUE SPACE.       01250000
012600                                                                  01260000
012700*----------------------------------------------------------------*01270000
012800*   SWITCHES                                                     *01280000
012900*----------------------------------------------------------------*01290000
013000 01  PS-PROGRAM-SWITCHES.                                         01300000
013100     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01310000
013200         88  PS-ERROR                          VALUE  'Y'.        01320000
013300         88  PS-NO-ERROR                       VALUE  'N'.        01330000
013400     05  PS-CONFIRM-PROCESSING-IND PIC  X(01)  VALUE  'N'.        01340000
013500         88  PS-CONFIRM-PROCESSING             VALUE  'Y'.        01350000
013600         88  PS-NOT-CONFIRM-PROCESSING         VALUE  'N'.        01360000
013700     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01370000
013800         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01380000
013900         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01390000
014000                                                                  01400000
014100*----------------------------------------------------------------*01410000
014200*   PROGRAM VARIABLES                                            *01420000
014300*----------------------------------------------------------------*01430000
014400 01  PV-PROGRAM-VARIABLES.                                        01440000
014500     05  PV-RACF-ERROR-CODE        PIC  9(04)  VALUE ZEROES.      01450000
014600     05  PV-USER-LOCATION          PIC  9(04)  VALUE  ZEROES.     01460000
014700     05  PV-USER-LOCATION-R REDEFINES PV-USER-LOCATION.           01470000
014800         10  FILLER                PIC  X(01).                    01480000
014900         10  PV-DP020-LOCATION     PIC  9(03).                    01490000
015000     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0.          01500000
015100     05  PV-CS-LOCATION            PIC S9(04)  VALUE ZEROES.      01510000
015200     05  PV-CS-NAME                PIC  X(25)  VALUE SPACES.      01520000
015300     05  PV-DC1-NBR-SIGNED         PIC S9(04)  COMP.              01530000
015400     05  PV-CS-LOC-SIGNED          PIC S9(04)  COMP.              01540000
015500     05  PV-REF-NBR-COUNT          PIC S9(09)  COMP.              01550000
015600     05  PV-CEPLDS-COUNT           PIC S9(09)  VALUE ZEROES       01560000
015700                                               COMP.              01570000
015800     05  PV-TCEPLMF-COUNT          PIC S9(09)  VALUE ZEROES       01580000
015900                                               COMP.              01590000
016000     05  PV-TCEPLAU-COUNT          PIC S9(09)  VALUE ZEROES       01600000
016100                                               COMP.              01610000
016200     05  PV-LINES-NEW              PIC S9(09)  VALUE ZEROES       01620000
016300                                               COMP.              01630000
016400     05  PV-LINES-POSTED-DISTRB    PIC S9(09)  COMP.              01640000
016500     05  PV-CICS-RESPONSE          PIC S9(08)  VALUE ZEROES       01650000
016600                                   COMP SYNC.                     01660000
016700     05  PV-CICS-MSG-AREA2         PIC  X(100) VALUE SPACE.       01670000
016800     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      01680000
016900     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             01690000
017000         10  PV-CURR-YY            PIC  9(04).                    01700000
017100         10  FILLER                PIC  X(01).                    01710000
017200         10  PV-CURR-MM            PIC  9(02).                    01720000
017300         10  FILLER                PIC  X(01).                    01730000
017400         10  PV-CURR-DD            PIC  9(02).                    01740000
017500     05  PV-DEFAULT-FROM-DATE      PIC  X(10)  VALUE SPACES.      01750000
017600     05  PV-DEFAULT-DATE-R REDEFINES PV-DEFAULT-FROM-DATE.        01760000
017700         10  PV-DFLT-YY            PIC  9(04).                    01770000
017800         10  FILLER                PIC  X(01).                    01780000
017900         10  PV-DFLT-MM            PIC  9(02).                    01790000
018000         10  FILLER                PIC  X(01).                    01800000
018100         10  PV-DFLT-DD            PIC  9(02).                    01810000
018200                                                                  01820000
018300     05  PV-FROM-DATE-HOLD.                                       01830000
018400         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      01840000
018500         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      01850000
018600         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      01860000
018700                                                                  01870000
018800     05  PV-TO-DATE-HOLD.                                         01880000
018900         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      01890000
019000         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      01900000
019100         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      01910000
019200                                                                  01920000
019201*ROOPA START                                                      01920140
019202     05  PV-TRIP-ID                PIC S9(09) COMP.               01920240
019212*ROOPA END                                                        01921240
019213* DMH 1/29/13 - BEGIN                                             01921325
019214     05  PV-ERROR-INFO             PIC  X(43)  VALUE SPACES.      01921438
019215     05  PV-ERROR-INFO-R REDEFINES PV-ERROR-INFO.                 01921533
019220         10  PV-ERROR-SML          PIC  9(18).                    01922034
019230         10  PV-ERROR-FUNCTION     PIC  X(09).                    01923036
019240         10  PV-ERROR-DATE         PIC  X(10).                    01924034
019241         10  PV-ERROR-AT           PIC  X(01).                    01924139
019242         10  PV-ERROR-TIME         PIC  X(05).                    01924237
019243     05  PV-DIVERT-DATE            PIC  X(10)  VALUE SPACES.      01924337
019244     05  PV-DIVERT-TIME            PIC  X(05)  VALUE SPACES.      01924437
019245* DMH 1/29/13 - END                                               01924537
019246     05  PV-DISP-STR               PIC  9(05)  VALUE ZEROES.      01924657
019250                                                                  01925025
019300*----------------------------------------------------------------*01930000
019400*    MAP LAYOUT                                                  *01940000
019500*----------------------------------------------------------------*01950000
019600     COPY SUKM558.                                                01960000
019700                                                                  01970000
019800*----------------------------------------------------------------*01980000
019900**  SECURITY SUBROUTINE PARAMETERS                                01990000
020000*----------------------------------------------------------------*02000000
020100     COPY DPWS008.                                                02010005
020200                                                                  02020000
020300*----------------------------------------------------------------*02030000
020400*    CALENDAR ROUTINE                                            *02040000
020500*----------------------------------------------------------------*02050000
020600     COPY DPWS500.                                                02060005
020700                                                                  02070000
020800*---------------------------------------------------------------* 02080000
020900*  SENDING/RECEIVING AREA FOR THE CONFIRMATION ROUTINE          * 02090000
021000*  (CEKCS610)                                                   * 02100000
021100*---------------------------------------------------------------* 02110000
021200     COPY CEWS005.                                                02120000
021300                                                                  02130000
021400*---------------------------------------------------------------* 02140000
021500*  TRAILER INFO MODULE                                          * 02150000
021600*---------------------------------------------------------------* 02160000
021700     COPY PCWS048.                                                02170000
021800                                                                  02180000
021900*----------------------------------------------------------------*02190000
022000*    ATTRIBUTE SETTINGS COPYBOOK.                                *02200000
022100*----------------------------------------------------------------*02210000
022200     COPY DPWS015.                                                02220005
022300                                                                  02230000
022400*----------------------------------------------------------------*02240000
022500*    FUNCTION KEYS COPYBOOK                                      *02250000
022600*----------------------------------------------------------------*02260000
022700     COPY DPWS016.                                                02270005
022800                                                                  02280000
022900*----------------------------------------------------------------*02290000
023000*    ABEND PROCESSING COPYBOOK.                                  *02300000
023100*----------------------------------------------------------------*02310000
023200     COPY DPWS013.                                                02320005
023300                                                                  02330000
023400*----------------------------------------------------------------*02340000
023500*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *02350000
023600*  SUB-ROUTINE (DPKUT100).                                       *02360000
023700*----------------------------------------------------------------*02370000
023800     COPY DPWS010I.                                               02380005
023900                                                                  02390000
024000*----------------------------------------------------------------*02400000
024100*  PARAMETERS FOR CALLING CICS ARCHITECTURE API                  *02410068
024300*----------------------------------------------------------------*02430000
024400     COPY DPWS030.                                                02440005
024400     COPY DPWS930.                                                02441068
024500                                                                  02450000
024600*    ITEM COMMAREA FOR XLKUT071                                   02460014
024700     COPY XLWS071.                                                02470011
024800                                                                  02480011
024900*----------------------------------------------------------------*02490000
025000*    STANDARD COMMAREA.                                          *02500000
025100*----------------------------------------------------------------*02510000
025200     COPY DPWS020.                                                02520005
025300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02530000
025400                                                                  02540000
025500*----------------------------------------------------------------*02550000
025600*    INTER-APPLICATION COMMAREA.                                 *02560000
025700*----------------------------------------------------------------*02570000
025800         10  INTER-APPL-COMM-AREA PIC X(200).                     02580000
025900     COPY SUWS008.                                                02590005
026000                                                                  02600000
026100*----------------------------------------------------------------*02610000
026200*    SPECIFIC COMMMAREA FOR SUKCS558.                            *02620000
026300*----------------------------------------------------------------*02630000
026400         10  ASC-SPECIFIC-COMMAREA.                               02640000
026500             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          02650000
026600             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 02660000
026700                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          02670000
026800             15  ASC-CURR-OPER-NAME          PIC  X(25).          02680000
026900             15  ASC-OPER-UNT-ID.                                 02690000
027000                 20 ASC-OPER-UNT-ID-N        PIC  9(04).          02700000
027100             15  ASC-OPER-NAME               PIC  X(24).          02710000
027200             15  ASC-DOOR-ID                 PIC  X(04).          02720000
027300             15  ASC-DOOR-DESC               PIC  X(24).          02730000
027400             15  ASC-DOOR-TYPE.                                   02740000
027500                 20  ASC-SHUTTLE             PIC X(02).           02750000
027600                 20  ASC-SHIPPING            PIC X(02).           02760000
027700                 20  ASC-RECEIVING           PIC X(02).           02770000
027800                 20  ASC-STORAGE             PIC X(02).           02780000
027900                 20  ASC-STRIPPING           PIC X(02).           02790000
028000                 20  ASC-YARD                PIC X(02).           02800000
028100             15  ASC-TRLR-SRL-NBR-X          PIC  X(09).          02810000
028200             15  ASC-TRLR-SRL-NBR REDEFINES ASC-TRLR-SRL-NBR-X    02820000
028300                                             PIC  9(09).          02830000
028400             15  ASC-SCAC-CODE               PIC  X(04).          02840000
028500             15  ASC-TRLR-ID                 PIC  X(12).          02850000
028600             15  ASC-TRLR-STATUS.                                 02860000
028700                 20  ASC-DCOPEN              PIC X(02).           02870000
028800                 20  ASC-DCCLOSED            PIC X(02).           02880000
028900                 20  ASC-SHIPPED             PIC X(02).           02890000
029000                 20  ASC-AUDIT               PIC X(02).           02900000
029100                 20  ASC-STOREOPEN           PIC X(02).           02910000
029200                 20  ASC-STOREUNLOADED       PIC X(02).           02920000
029300             15  ASC-STATUS-DAYS-X           PIC  X(02).          02930000
029400             15  ASC-STATUS-DAYS-N REDEFINES ASC-STATUS-DAYS-X.   02940000
029500                 20  ASC-STATUS-DAYS         PIC  9(02).          02950000
029600             15  ASC-DATE-FROM.                                   02960000
029700                 20  ASC-FROM-MM             PIC  X(02).          02970000
029800                 20  ASC-FROM-DD             PIC  X(02).          02980000
029900                 20  ASC-FROM-YY             PIC  X(04).          02990000
030000             15  ASC-DATE-TO.                                     03000000
030100                 20  ASC-TO-MM               PIC  X(02).          03010000
030200                 20  ASC-TO-DD               PIC  X(02).          03020000
030300                 20  ASC-TO-YY               PIC  X(04).          03030000
030400             15  ASC-CARTONS                 PIC  X(01).          03040000
030500             15  ASC-STORE-NBR-X             PIC  X(04).          03050000
030600             15  ASC-STORE-NBR-N REDEFINES ASC-STORE-NBR-X.       03060000
030700                 20  ASC-STORE-NBR           PIC  9(04).          03070000
030800             15  ASC-STORE-NAME              PIC  X(20).          03080000
030810* DMH 8/17 BEGIN                                                  03081057
030811             15  ASC-STR-DC-X                PIC  X(06).          03081157
030812             15  ASC-STR-DC-R   REDEFINES  ASC-STR-DC-X.          03081259
030813                 20  ASC-STR-DC-PAREN-1      PIC X(01).           03081357
030814                 20  ASC-STR-DC-NBR          PIC  9(04).          03081457
030816                 20  ASC-STR-DC-PAREN-2      PIC X(01).           03081657
030820* DMH 8/17 END                                                    03082057
030900             15  ASC-OTBND-TRIP-ID-X.                             03090000
031000                 20  ASC-OTBND-TRIP-ID       PIC  9(09).          03100000
031100             15  ASC-TRLR-SEAL               PIC  X(20).          03110000
031110*ROOPA START                                                      03111040
031120             15  ASC-SCR-SHIP-X              PIC  X(15).          03112040
031130             15  ASC-SCR-SHIP REDEFINES ASC-SCR-SHIP-X            03113040
031140                                             PIC  X(10).          03114040
031150             15  ASC-SCR-SHIP-N              PIC  X(15).          03115040
031160*ROOPA END                                                        03116040
031200                                                                  03120000
031300         10  ASC-HOLD-INTER-APPL             PIC  X(200).         03130000
031400                                                                  03140000
031500*-----------------------------------------------------------------03150000
031600*  DOOR ID TABLE                                                  03160000
031700*-----------------------------------------------------------------03170000
031800     EXEC SQL                                                     03180000
031900          INCLUDE TCNDCDR                                         03190000
032000     END-EXEC.                                                    03200000
032100                                                                  03210000
032200*-----------------------------------------------------------------03220000
032300*  CONVEYOR CUTOFF TABLE - TSUCDOT                                03230025
032400*-----------------------------------------------------------------03240000
032500     EXEC SQL                                                     03250000
032600          INCLUDE TSUCDOT                                         03260025
032700     END-EXEC.                                                    03270000
032800                                                                  03280000
032801*-----------------------------------------------------------------03280125
032802*  CONVEYOR DIVERT TABLE - TSUCRDV                                03280225
032803*-----------------------------------------------------------------03280325
032804     EXEC SQL                                                     03280425
032805          INCLUDE TSUCRDV                                         03280525
032806     END-EXEC.                                                    03280625
032807                                                                  03280725
032810*-----------------------------------------------------------------03281025
032820*  TRAILER ID TABLE                                               03282025
032830*-----------------------------------------------------------------03283025
032840     EXEC SQL                                                     03284025
032850          INCLUDE TCNTRID                                         03285025
032860     END-EXEC.                                                    03286025
032870                                                                  03287025
032900*-----------------------------------------------------------------03290000
033000*  OUTBOUND TRAILER TABLE                                         03300000
033100*-----------------------------------------------------------------03310000
033200     EXEC SQL                                                     03320000
033300         INCLUDE TSUOBTR                                          03330000
033400     END-EXEC.                                                    03340000
033500                                                                  03350000
033600*-----------------------------------------------------------------03360000
033700*  TRAILER SEAL TABLE                                             03370000
033800*-----------------------------------------------------------------03380000
033900     EXEC SQL                                                     03390000
034000          INCLUDE TSUOBTS                                         03400000
034100     END-EXEC.                                                    03410000
034200                                                                  03420000
034300*-----------------------------------------------------------------03430000
034400*  CONTROL TABLE                                                  03440000
034500*-----------------------------------------------------------------03450000
034600     EXEC SQL                                                     03460000
034700          INCLUDE TCOCNTL                                         03470000
034800     END-EXEC.                                                    03480000
034900                                                                  03490000
035000*-----------------------------------------------------------------03500000
035100*  PARM TABLE                                                     03510000
035200*-----------------------------------------------------------------03520000
035300     EXEC SQL                                                     03530000
035400          INCLUDE TKRPRPM                                         03540000
035500     END-EXEC.                                                    03550000
035600                                                                  03560000
035610*ROOPA START                                                      03561042
035620*-----------------------------------------------------------------03562042
035630* * * WST_SHPMT_XREF_HDR VIEW - WMS SHIPMENT XREF HEADER          03563042
035640*-----------------------------------------------------------------03564042
035650     EXEC SQL                                                     03565042
035660         INCLUDE WST00001                                         03566042
035670     END-EXEC.                                                    03567042
035685                                                                  03568543
035686*-----------------------------------------------------------------03568658
035687*  XLT_DC_LOC_ASGMT                                               03568758
035688*-----------------------------------------------------------------03568858
035689     EXEC SQL                                                     03568958
035690         INCLUDE XLT00014                                         03569058
035691     END-EXEC.                                                    03569158
035692                                                                  03569258
035693/                                                                 03569343
035694*ROOPA END                                                        03569442
035700*-----------------------------------------------------------------03570000
035800*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                03580000
035900*-----------------------------------------------------------------03590000
036000     EXEC SQL                                                     03600000
036100          INCLUDE SQLCA                                           03610000
036200     END-EXEC.                                                    03620000
036300                                                                  03630000
036400*-----------------------------------------------------------------03640000
036500 LINKAGE SECTION.                                                 03650000
036600*-----------------------------------------------------------------03660000
036700 01  DFHCOMMAREA.                                                 03670000
036800     05  FILLER                         OCCURS  1 TO 4072 TIMES   03680000
036900                                        DEPENDING ON EIBCALEN.    03690000
037000         10  FILLER                     PIC X.                    03700000
037100                                                                  03710000
037200                                                                  03720000
037300 PROCEDURE DIVISION.                                              03730000
037400*----------------------------------------------------------------*03740000
037500*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *03750000
037600*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *03760000
037700*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *03770000
037800*                                                                *03780000
037900*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *03790000
038000*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *03800000
038100*----------------------------------------------------------------*03810000
038200 0000-MAIN-MODULE.                                                03820000
038300     INITIALIZE DP030-CICS-API-FIELDS.                            03830000
038400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03840000
038500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03850000
038600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03860000
038700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03870000
038800     MOVE LENGTH OF SU558AI        TO DP030-MAP-LENGTH (1).       03880000
038900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03890000
039000     PERFORM 0001-CALL-CICS-ARCH-API.                             03900000
039100                                                                  03910000
039200     PERFORM 1000-CONTROL-PROCESSING                              03920000
039300                                                                  03930000
039400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03940000
039500     PERFORM 0001-CALL-CICS-ARCH-API.                             03950000
039600                                                                  03960000
039700*----------------------------------------------------------------*03970000
039800 0001-CALL-CICS-ARCH-API.                                         03980000
039900*    CALL 'DPKCS030' USING DFHEIBLK                               03990068
039900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03991068
040000                           DFHCOMMAREA                            04000000
040100                           DP030-CICS-API-FIELDS                  04010000
040200                           DP020-STANDARD-COMMAREA                04020000
040300                           SU558AI.                               04030000
040400                                                                  04040000
040500     IF  DP030-RC-CALL-SUCCESSFUL                                 04050000
040600         CONTINUE                                                 04060000
040700     ELSE                                                         04070000
040800         SET DP013-NO-ROLLBACK                                    04080000
040900             DP013-XCTL-DISPLAY-RESTART                           04090000
041000             DP013-CICS-ABEND      TO TRUE                        04100000
041100         MOVE 'BEFORE 0000-MAIN-MODULE'                           04110000
041200                                   TO DP013-PARAGRAPH             04120000
041300*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL'                   04130068
041400*                                  TO DP013-MESSAGE-TEXT (2)      04140068
041300         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O04141068
041310-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04141168
041500         MOVE  SPACES              TO DP013-MESSAGE-TEXT (3)      04150000
041600         STRING  'RETURN CODE - '     DELIMITED BY SIZE           04160000
041700                  DP030-RETURN-CODE   DELIMITED BY SIZE           04170000
041800                                 INTO DP013-MESSAGE-TEXT (3)      04180000
041900         PERFORM DP013-0000-PROCESS-ABEND                         04190000
042000     END-IF.                                                      04200000
042100                                                                  04210000
042200*----------------------------------------------------------------*04220000
042300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04230000
042400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04240000
042500*----------------------------------------------------------------*04250000
042600 1000-CONTROL-PROCESSING.                                         04260000
042700                                                                  04270000
042800     EVALUATE TRUE                                                04280000
042900         WHEN DP020-NEXT-ACT-INITIAL                              04290000
043000             INITIALIZE ASC-SPECIFIC-COMMAREA                     04300000
043100             PERFORM 4000-BUILD-INITIAL-PANEL                     04310000
043200             PERFORM 3200-RESET-ATTRIBUTES                        04320000
043300                                                                  04330000
043400         WHEN DP020-NEXT-ACT-READ-MAP                             04340000
043500             PERFORM 2000-FKEY-PROCESSING                         04350000
043600                                                                  04360000
043700         WHEN DP020-NEXT-ACT-RETURN                               04370000
043800             MOVE ASC-OPER-UNT-ID-N        TO AOPERO              04380000
043900             MOVE ASC-OPER-NAME            TO AOPRNMEO            04390000
044000             INITIALIZE ASC-SPECIFIC-COMMAREA                     04400000
044100             PERFORM 4000-BUILD-INITIAL-PANEL                     04410000
044200             PERFORM 3200-RESET-ATTRIBUTES                        04420000
044300                                                                  04430000
044400         WHEN OTHER                                               04440000
044500             SET DP013-LOGIC-ABEND                                04450000
044600                 DP013-NO-ROLLBACK TO TRUE                        04460000
044700             MOVE 'SUKCS558 - 1000-CONTROL-PROCESSING'            04470000
044800                                   TO  DP013-PARAGRAPH            04480000
044900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04490000
045000                                   TO  DP013-MESSAGE-TEXT(1)      04500000
045100             MOVE DP020-NEXT-APPL-ACTIVITY                        04510000
045200                                   TO DP013-MESSAGE-TEXT(2)       04520000
045300             PERFORM DP013-0000-PROCESS-ABEND                     04530000
045400     END-EVALUATE.                                                04540000
045500                                                                  04550000
045600*----------------------------------------------------------------*04560000
045700* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04570000
045800* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04580000
045900* EDITS.                                                         *04590000
046000*----------------------------------------------------------------*04600000
046100 2000-FKEY-PROCESSING.                                            04610000
046200                                                                  04620000
046300     EVALUATE TRUE                                                04630000
046400                                                                  04640000
046500         WHEN DP020-SRC-AID = DP016-CLEAR                         04650000
046600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04660000
046700             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 04670000
046800             MOVE -1                   TO AOPERL                  04680000
046900                                                                  04690000
047000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04700000
047100             INITIALIZE ASC-SPECIFIC-COMMAREA                     04710000
047200             PERFORM 4000-BUILD-INITIAL-PANEL                     04720000
047300             PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                 04730000
047400             PERFORM 3200-RESET-ATTRIBUTES                        04740000
047500             MOVE -1                   TO AOPERL                  04750000
047600                                                                  04760000
047700         WHEN OTHER                                               04770000
047800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04780000
047900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04790000
048000                                                                  04800000
048100             IF  PS-NO-ERROR                                      04810000
048200                 SET DP030-CONTINUE-GO TO TRUE                    04820000
048300                 PERFORM 2100-CHECK-FUNCTION-KEY                  04830000
048400                 IF  PS-NO-ERROR                                  04840000
048500                     PERFORM 8000-MOVE-COMMAREA-TO-SCREEN         04850000
048600                 ELSE                                             04860000
048700                     SET DP030-OVERRIDE-GO TO TRUE                04870000
048800                 END-IF                                           04880000
048900             ELSE                                                 04890000
049000                 SET DP030-OVERRIDE-GO TO TRUE                    04900000
049100             END-IF                                               04910000
049200     END-EVALUATE.                                                04920000
049300                                                                  04930000
049400*----------------------------------------------------------------*04940000
049500*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *04950000
049600*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *04960000
049700*  FROM THE CICS ARCHITECTURE API.                               *04970000
049800*----------------------------------------------------------------*04980000
049900 2100-CHECK-FUNCTION-KEY.                                         04990000
050000     EVALUATE TRUE                                                05000000
050100*                                                                 05010000
050200* ENTER                                                           05020000
050300         WHEN DP020-SRC-AID = DP016-ENTER                         05030000
050400              PERFORM 8000-MOVE-COMMAREA-TO-SCREEN                05040000
050500              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 05050000
050600              MOVE -1                   TO AOPERL                 05060000
050700                                                                  05070000
050800*                                                                 05080000
050900* F14 - GET NEXT DIVERTED CARTON                                  05090000
051000         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              05100000
051100             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05110000
051210*                                                                 05121056
051220* F15 - UPDATE TRAILER SERIAL NUMBER                              05122056
051230         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              05123056
051240             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05124056
051241                                                                  05124156
051250*                                                                 05125056
051300* F16 - SHIP / RELEASE TRAILER                                    05130000
051400         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              05140000
051500             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05150000
051600*                                                                 05160000
051700* F17 - TRAILER HISTORY                                           05170000
051800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05180000
051900             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05190000
052000                                                                  05200000
052100*                                                                 05210000
052200* F18 - TRAILER CARTONS                                           05220000
052300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              05230000
052400             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05240000
052500                                                                  05250000
052600*                                                                 05260000
052700* F21 - TRAILER LIST                                              05270000
052800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              05280000
052900             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05290000
053000                                                                  05300000
053100*                                                                 05310000
053200* F22 - DOOR TRAILERS                                             05320000
053300         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              05330000
053400             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05340000
053500                                                                  05350000
053600*                                                                 05360000
053700* F23 - TRAILER SEAL LIST                                         05370000
053800         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              05380000
053900             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05390000
054000                                                                  05400000
054100*                                                                 05410000
054200* F24 - DOOR CARTON LIST                                          05420000
054300         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              05430000
054400                                                                  05440000
054500             PERFORM 2110-PREPARE-INTER-APPL-COMM                 05450000
054600                                                                  05460000
054700         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 05470000
054800         WHEN DP020-FK-DISPN-GO (DP020-SRC-AID)                   05480000
054900              PERFORM 2110-PREPARE-INTER-APPL-COMM                05490000
055000*                                                                 05500000
055100* OTHER                                                           05510000
055200         WHEN OTHER                                               05520000
055300              SET DP013-NO-ROLLBACK                               05530000
055400                  DP013-XCTL-DISPLAY-RESTART                      05540000
055500                  DP013-CICS-ABEND  TO TRUE                       05550000
055600              MOVE '2100-CHECK-FUNCTION-KEY'                      05560000
055700                                    TO DP013-PARAGRAPH            05570000
055800              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     05580000
055900                                   TO DP013-MESSAGE-TEXT (1)      05590000
056000             MOVE 'OR CODE MISSING FROM THIS PROGRAM TO PROCESS:' 05600000
056100                                   TO DP013-MESSAGE-TEXT (2)      05610000
056200             MOVE DP020-SRC-AID    TO PM-A-SRC-AID                05620000
056300             MOVE DP020-FK-ACTION (DP020-SRC-AID)                 05630000
056400                                   TO PM-A-FK-ACTION              05640000
056500             MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)              05650000
056600                                   TO PM-A-FK-DISPN               05660000
056700             MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)      05670000
056800             MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'        05680000
056900                                   TO DP013-MESSAGE-TEXT (4)      05690000
057000             PERFORM DP013-0000-PROCESS-ABEND                     05700000
057100     END-EVALUATE.                                                05710000
057200                                                                  05720000
057300/                                                                 05730000
057400*----------------------------------------------------------------*05740000
057500* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     05750000
057600*----------------------------------------------------------------*05760000
057700 2105-RACF-ACCESS.                                                05770000
057800                                                                  05780000
057900      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  05790000
058000      SET DP008-ACCESS-TYPE-USE          TO TRUE                  05800000
058100                                                                  05810000
058200      EXEC CICS                                                   05820000
058300         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 05830000
058400              COMMAREA (DP008-SECURITY-COMMAREA)                  05840000
058500              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             05850000
058600      END-EXEC                                                    05860000
058700                                                                  05870000
058800      IF DP008-CALL-SUCCESSFUL                                    05880000
058900         IF DP008-ACCESS-ALLOWED                                  05890000
059000             SET PS-ACCESS-ALLOWED TO TRUE                        05900000
059100         ELSE                                                     05910000
059200             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    05920000
059300             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          05930000
059400             STRING ' SUKCS558- RACF -'  DELIMITED BY SIZE        05940000
059500                    ' DP008-ACCESS-SW- ' DELIMITED BY SIZE        05950000
059600                      DP008-ACCESS-SW    DELIMITED BY SIZE        05960000
059700                    ' RACF ERROR CODE-'  DELIMITED BY SIZE        05970000
059800                      PV-RACF-ERROR-CODE DELIMITED BY SIZE        05980000
059900                                    INTO PV-CICS-MSG-AREA2        05990000
060000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     06000000
060100               TO PV-COMMAREA-LENGTH                              06010000
060200             EXEC CICS                                            06020000
060300                  WRITEQ TD                                       06030000
060400                   QUEUE  ('CSSL')                                06040000
060500                    FROM  (PV-CICS-MSG-AREA2)                     06050000
060600                  LENGTH  (PV-COMMAREA-LENGTH)                    06060000
060700                    RESP  (PV-CICS-RESPONSE)                      06070000
060800             END-EXEC                                             06080000
060900         END-IF                                                   06090000
061000     ELSE                                                         06100000
061100         MOVE '2105-RACF-ACCESS' TO DP013-PARAGRAPH               06110000
061200          MOVE 'UNABLE TO ACCESS CICS'                            06120000
061300                               TO DP013-MESSAGE-TEXT (1)          06130000
061400          MOVE SQLCA                 TO DP013-SQLCA               06140000
061500          SET DP013-DB2-ABEND                                     06150000
061600              DP013-XCTL-DISPLAY-RESTART TO TRUE                  06160000
061700          PERFORM DP013-0000-PROCESS-ABEND                        06170000
061800      END-IF.                                                     06180000
061900                                                                  06190000
062000                                                                  06200000
062100*----------------------------------------------------------------*06210000
062200*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *06220000
062300*  INTER-APPLICATION COMMAREA.                                   *06230000
062400*----------------------------------------------------------------*06240000
062500 2110-PREPARE-INTER-APPL-COMM.                                    06250000
062600                                                                  06260000
062700     INITIALIZE SU008-INTER-APPL-COMMAREA.                        06270000
062800                                                                  06280000
062900     MOVE ASC-CURR-OPER-UNT-ID-N  TO SU008-CURR-OPER-UNT-ID.      06290000
063000     MOVE ASC-OPER-UNT-ID-N       TO SU008-OPER-UNT-ID.           06300000
063100     MOVE ASC-DOOR-ID             TO SU008-DOOR-ID                06310000
063200     MOVE ASC-DOOR-TYPE           TO SU008-DOOR-TYPE.             06320000
063300     MOVE ASC-TRLR-SRL-NBR        TO SU008-TRLR-SRL-NBR.          06330000
063400     MOVE ASC-SCAC-CODE           TO SU008-SCAC-CDE.              06340000
063500     MOVE ASC-TRLR-ID             TO SU008-TRLR-ID                06350000
063600                                                                  06360000
063700     IF ASC-TRLR-STATUS = SPACES                                  06370000
063800         MOVE 'DO'                TO ASC-DCOPEN                   06380000
063900         MOVE 'DC'                TO ASC-DCCLOSED                 06390000
064000         MOVE 'SH'                TO ASC-SHIPPED                  06400000
064100         MOVE 'AO'                TO ASC-AUDIT                    06410000
064200         MOVE 'SO'                TO ASC-STOREOPEN                06420000
064300         MOVE 'SU'                TO ASC-STOREUNLOADED            06430000
064400     END-IF                                                       06440000
064500                                                                  06450000
064600     MOVE ASC-TRLR-STATUS         TO SU008-TRLR-STATUS            06460000
064700     MOVE ASC-DATE-FROM           TO SU008-DATE-RANGE-FROM.       06470000
064800     MOVE ASC-DATE-TO             TO SU008-DATE-RANGE-TO.         06480000
064900     MOVE ASC-CARTONS             TO SU008-CARTONS.               06490000
065000     MOVE ASC-STORE-NBR           TO SU008-DEST-STR-NBR.          06500000
065100     MOVE ASC-OTBND-TRIP-ID       TO SU008-TRIP-ID.               06510000
065200     MOVE ASC-TRLR-SEAL           TO SU008-TRLR-SEAL-NBR.         06520000
065300     MOVE ASC-STATUS-DAYS         TO SU008-STATUS-DAYS.           06530000
065400                                                                  06540000
065500*----------------------------------------------------------------*06550000
065600* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06560000
065700* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *06570000
065800* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *06580000
065900*----------------------------------------------------------------*06590000
066000 2200-MOVE-SCREEN-TO-COMMAREA.                                    06600000
066100                                                                  06610000
066200* OPER UNT ID                                                     06620000
066300     IF  AOPERL  > ZERO                                           06630000
066400         MOVE AOPERI           TO ASC-OPER-UNT-ID                 06640000
066500     ELSE                                                         06650000
066600         IF AOPERF = DP015-ERASE-EOF                              06660000
066700             MOVE SPACES       TO ASC-OPER-UNT-ID                 06670000
066800         END-IF                                                   06680000
066900     END-IF.                                                      06690000
067000                                                                  06700000
067100* DOOR ID                                                         06710000
067200     IF  ADOORL   > ZERO                                          06720000
067300         MOVE ADOORI           TO ASC-DOOR-ID                     06730000
067400     ELSE                                                         06740000
067500         IF ADOORF = DP015-ERASE-EOF                              06750000
067600             MOVE SPACES       TO ASC-DOOR-ID                     06760000
067700         END-IF                                                   06770000
067800     END-IF.                                                      06780000
067900                                                                  06790000
068000* DOOR TYPE SHUTTLE                                               06800000
068100     IF  ADRTP1L > ZERO AND ADRTP1O NOT = SPACE                   06810000
068200         MOVE 'DS'      TO ASC-SHUTTLE                            06820000
068300     ELSE                                                         06830000
068400         IF ADRTP1F = DP015-ERASE-EOF                             06840000
068500             MOVE SPACES TO ASC-SHUTTLE                           06850000
068600         END-IF                                                   06860000
068700     END-IF.                                                      06870000
068800                                                                  06880000
068900* DOOR TYPE SHIPPING                                              06890000
069000     IF  ADRTP2L > ZERO AND ADRTP2O NOT = SPACE                   06900000
069100         MOVE 'SH'      TO ASC-SHIPPING                           06910000
069200     ELSE                                                         06920000
069300         IF ADRTP2F = DP015-ERASE-EOF                             06930000
069400             MOVE SPACES TO ASC-SHIPPING                          06940000
069500         END-IF                                                   06950000
069600     END-IF.                                                      06960000
069700                                                                  06970000
069800* DOOR TYPE RECEIVING                                             06980000
069900     IF  ADRTP3L > ZERO AND ADRTP3O NOT = SPACE                   06990000
070000         MOVE 'RC'      TO ASC-RECEIVING                          07000000
070100     ELSE                                                         07010000
070200         IF ADRTP3F = DP015-ERASE-EOF                             07020000
070300             MOVE SPACES TO ASC-RECEIVING                         07030000
070400         END-IF                                                   07040000
070500     END-IF.                                                      07050000
070600                                                                  07060000
070700* DOOR TYPE STORAGE                                               07070000
070800     IF  ADRTP4L > ZERO AND ADRTP4O NOT = SPACE                   07080000
070900         MOVE 'ST'       TO ASC-STORAGE                           07090000
071000     ELSE                                                         07100000
071100         IF ADRTP4F = DP015-ERASE-EOF                             07110000
071200             MOVE SPACES TO ASC-STORAGE                           07120000
071300         END-IF                                                   07130000
071400     END-IF.                                                      07140000
071500                                                                  07150000
071600* DOOR TYPE STRIPPING                                             07160000
071700     IF  ADRTP5L > ZERO AND ADRTP5O NOT = SPACE                   07170000
071800         MOVE 'SG'       TO ASC-STRIPPING                         07180000
071900     ELSE                                                         07190000
072000         IF ADRTP5F = DP015-ERASE-EOF                             07200000
072100             MOVE SPACES TO ASC-STRIPPING                         07210000
072200         END-IF                                                   07220000
072300     END-IF.                                                      07230000
072400                                                                  07240000
072500* DOOR TYPE YARD                                                  07250000
072600     IF  ADRTP6L > ZERO AND ADRTP6O NOT = SPACE                   07260000
072700         MOVE 'YD'       TO ASC-YARD                              07270000
072800     ELSE                                                         07280000
072900         IF ADRTP6F = DP015-ERASE-EOF                             07290000
073000             MOVE SPACES TO ASC-YARD                              07300000
073100         END-IF                                                   07310000
073200     END-IF.                                                      07320000
073300                                                                  07330000
073400                                                                  07340000
073500* TRAILER SERIAL NUMBER                                           07350000
073600     IF  ATRLRL   > ZERO                                          07360000
073700         MOVE ATRLRI          TO ASC-TRLR-SRL-NBR-X               07370000
073800     ELSE                                                         07380000
073900         IF ATRLRF = DP015-ERASE-EOF                              07390000
074000             MOVE ZEROES      TO ASC-TRLR-SRL-NBR                 07400000
074100         END-IF                                                   07410000
074200     END-IF.                                                      07420000
074300                                                                  07430000
074400* SCAC CODE                                                       07440000
074500     IF  ASCACL   > ZERO                                          07450000
074600         MOVE ASCACI           TO ASC-SCAC-CODE                   07460000
074700     ELSE                                                         07470000
074800         IF ASCACF = DP015-ERASE-EOF                              07480000
074900             MOVE SPACES       TO ASC-SCAC-CODE                   07490000
075000         END-IF                                                   07500000
075100     END-IF.                                                      07510000
075200                                                                  07520000
075300* TRAILER ID                                                      07530000
075400     IF  ATRLIDL  > ZERO                                          07540000
075500         MOVE ATRLIDI          TO ASC-TRLR-ID                     07550000
075600     ELSE                                                         07560000
075700         IF ATRLIDF = DP015-ERASE-EOF                             07570000
075800             MOVE SPACES       TO ASC-TRLR-ID                     07580000
075900         END-IF                                                   07590000
076000     END-IF.                                                      07600000
076100                                                                  07610000
076200* TRAILER STATUS - DC OPEN                                        07620000
076300     IF  ATRST1L  > ZERO AND ATRST1O NOT = SPACE                  07630000
076400         MOVE 'DO'       TO ASC-DCOPEN                            07640000
076500     ELSE                                                         07650000
076600         IF ATRST1F = DP015-ERASE-EOF                             07660000
076700             MOVE SPACES TO ASC-DCOPEN                            07670000
076800         END-IF                                                   07680000
076900     END-IF.                                                      07690000
077000                                                                  07700000
077100* TRAILER STATUS - DC CLOSED                                      07710000
077200     IF  ATRST2L  > ZERO AND ATRST1O NOT = SPACE                  07720000
077300         MOVE 'DC'       TO  ASC-DCCLOSED                         07730000
077400     ELSE                                                         07740000
077500         IF ATRST2F = DP015-ERASE-EOF                             07750000
077600             MOVE SPACES TO  ASC-DCCLOSED                         07760000
077700         END-IF                                                   07770000
077800     END-IF.                                                      07780000
077900                                                                  07790000
078000* TRAILER STATUS - SHIPPED                                        07800000
078100     IF  ATRST3L  > ZERO AND ATRST3O NOT = SPACE                  07810000
078200         MOVE 'SH'       TO  ASC-SHIPPED                          07820000
078300     ELSE                                                         07830000
078400         IF ATRST3F = DP015-ERASE-EOF                             07840000
078500             MOVE SPACES TO  ASC-SHIPPED                          07850000
078600         END-IF                                                   07860000
078700     END-IF.                                                      07870000
078800                                                                  07880000
078900* TRAILER STATUS - AUDIT                                          07890000
079000     IF  ATRST4L  > ZERO AND ATRST4O NOT = SPACE                  07900000
079100         MOVE 'AO'       TO  ASC-AUDIT                            07910000
079200     ELSE                                                         07920000
079300         IF ATRST4F = DP015-ERASE-EOF                             07930000
079400             MOVE SPACES TO  ASC-AUDIT                            07940000
079500         END-IF                                                   07950000
079600     END-IF.                                                      07960000
079700                                                                  07970000
079800* TRAILER STATUS - STORE OPEN                                     07980000
079900     IF  ATRST5L  > ZERO AND ATRST5O NOT = SPACE                  07990000
080000         MOVE 'SO'       TO  ASC-STOREOPEN                        08000000
080100     ELSE                                                         08010000
080200         IF ATRST5F = DP015-ERASE-EOF                             08020000
080300             MOVE SPACES TO  ASC-STOREOPEN                        08030000
080400         END-IF                                                   08040000
080500     END-IF.                                                      08050000
080600                                                                  08060000
080700* TRAILER STATUS - STORE UNLOADED                                 08070000
080800     IF  ATRST6L  > ZERO AND ATRST6O NOT = SPACE                  08080000
080900         MOVE 'SU'       TO  ASC-STOREUNLOADED                    08090000
081000     ELSE                                                         08100000
081100         IF ATRST6F = DP015-ERASE-EOF                             08110000
081200             MOVE SPACES TO  ASC-STOREUNLOADED                    08120000
081300         END-IF                                                   08130000
081400     END-IF.                                                      08140000
081500                                                                  08150000
081600                                                                  08160000
081700     IF  ADAYSL   > ZERO                                          08170000
081800         MOVE ADAYSI           TO ASC-STATUS-DAYS-X               08180000
081900     ELSE                                                         08190000
082000         IF ADAYSF = DP015-ERASE-EOF                              08200000
082100             MOVE SPACES       TO ASC-STATUS-DAYS-X               08210000
082200         END-IF                                                   08220000
082300     END-IF.                                                      08230000
082400                                                                  08240000
082500                                                                  08250000
082600* FROM DATE RANGE                                                 08260000
082700     IF  AFDTMML  > ZERO                                          08270000
082800         MOVE AFDTMMI          TO ASC-FROM-MM                     08280000
082900     ELSE                                                         08290000
083000         IF AFDTMMF = DP015-ERASE-EOF                             08300000
083100             MOVE SPACES       TO ASC-FROM-MM                     08310000
083200         END-IF                                                   08320000
083300     END-IF.                                                      08330000
083400                                                                  08340000
083500     IF  AFDTDDL  > ZERO                                          08350000
083600         MOVE AFDTDDI          TO ASC-FROM-DD                     08360000
083700     ELSE                                                         08370000
083800         IF AFDTDDF = DP015-ERASE-EOF                             08380000
083900             MOVE SPACES       TO ASC-FROM-DD                     08390000
084000         END-IF                                                   08400000
084100     END-IF.                                                      08410000
084200                                                                  08420000
084300     IF  AFDTCYL  > ZERO                                          08430000
084400         MOVE AFDTCYI          TO ASC-FROM-YY                     08440000
084500     ELSE                                                         08450000
084600         IF AFDTCYF = DP015-ERASE-EOF                             08460000
084700              MOVE SPACES      TO ASC-FROM-YY                     08470000
084800         END-IF                                                   08480000
084900     END-IF.                                                      08490000
085000                                                                  08500000
085100* TO DATE RANGE                                                   08510000
085200     IF  ATDTMML  > ZERO                                          08520000
085300         MOVE ATDTMMI          TO ASC-TO-MM                       08530000
085400     ELSE                                                         08540000
085500         IF ATDTMMF = DP015-ERASE-EOF                             08550000
085600             MOVE SPACES       TO ASC-TO-MM                       08560000
085700         END-IF                                                   08570000
085800     END-IF.                                                      08580000
085900                                                                  08590000
086000     IF  ATDTDDL  > ZERO                                          08600000
086100         MOVE ATDTDDI         TO ASC-TO-DD                        08610000
086200     ELSE                                                         08620000
086300         IF ATDTDDF = DP015-ERASE-EOF                             08630000
086400             MOVE SPACES      TO ASC-TO-DD                        08640000
086500         END-IF                                                   08650000
086600     END-IF.                                                      08660000
086700                                                                  08670000
086800     IF  ATDTCYL  > ZERO                                          08680000
086900         MOVE ATDTCYI         TO ASC-TO-YY                        08690000
087000     ELSE                                                         08700000
087100         IF ATDTCYF = DP015-ERASE-EOF                             08710000
087200             MOVE SPACES      TO ASC-TO-YY                        08720000
087300         END-IF                                                   08730000
087400     END-IF.                                                      08740000
087500                                                                  08750000
087600* CARTONS                                                         08760000
087700     IF  ACRTNSL  > ZERO                                          08770000
087800         MOVE ACRTNSI          TO ASC-CARTONS                     08780000
087900     ELSE                                                         08790000
088000         IF ACRTNSF = DP015-ERASE-EOF                             08800000
088100             MOVE SPACES       TO ASC-CARTONS                     08810000
088200         END-IF                                                   08820000
088300     END-IF.                                                      08830000
088400                                                                  08840000
088500* STORE DESTINATION                                               08850000
088600     IF  ASTDSTL  > ZERO                                          08860000
088700         MOVE ASTDSTI             TO ASC-STORE-NBR-X              08870000
088800     ELSE                                                         08880000
088900         IF ASTDSTF = DP015-ERASE-EOF                             08890000
089000             MOVE SPACES          TO ASC-STORE-NBR-X              08900000
089010             MOVE SPACES          TO ASC-STR-DC-X                 08901057
089100         END-IF                                                   08910000
089200     END-IF.                                                      08920000
089300                                                                  08930000
089400* OUTBOUND TRIP ID                                                08940000
089500     IF  AOTRIPL  > ZERO                                          08950000
089600         MOVE AOTRIPI             TO ASC-OTBND-TRIP-ID-X          08960000
089700     ELSE                                                         08970000
089800         IF AOTRIPF = DP015-ERASE-EOF                             08980000
089900             MOVE ZEROES          TO ASC-OTBND-TRIP-ID-X          08990000
090000         END-IF                                                   09000000
090100     END-IF.                                                      09010000
090200                                                                  09020000
090210*ROOPA START                                                      09021041
090220* EFC SHIPMENT NUMBER                                             09022041
090230     IF  ASHIPL  > ZERO                                           09023041
090240         MOVE ASHIPI             TO ASC-SCR-SHIP-X                09024041
090250     ELSE                                                         09025041
090260         IF ASHIPF = DP015-ERASE-EOF                              09026041
090270            MOVE SPACES          TO ASC-SCR-SHIP-X                09027048
090280         END-IF                                                   09028041
090290     END-IF.                                                      09029041
090291*ROOPA END                                                        09029141
090292                                                                  09029241
090300* TRAILER SEAL                                                    09030000
090400     IF  ATRSELL  > ZERO                                          09040000
090500         MOVE ATRSELI         TO ASC-TRLR-SEAL                    09050000
090600     ELSE                                                         09060000
090700         IF ATRSELF = DP015-ERASE-EOF                             09070000
090800             MOVE SPACES      TO ASC-TRLR-SEAL                    09080000
090900         END-IF                                                   09090000
091000     END-IF.                                                      09100000
091100                                                                  09110000
091200*----------------------------------------------------------------*09120000
091300* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *09130000
091400* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *09140000
091500* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*09150000
091600* IN THE DESTINATION PROGRAM, NOT HERE.                          *09160000
091700*----------------------------------------------------------------*09170000
091800 3000-EDIT-DATA-IN-COMMAREA.                                      09180000
091900                                                                  09190000
092000     PERFORM 3200-RESET-ATTRIBUTES.                               09200000
092100                                                                  09210000
092200     IF  ASC-TRLR-SRL-NBR-X  >  SPACES  AND                       09220008
092300         ASC-TRLR-SRL-NBR-X  >  ZEROES                            09230008
092400         PERFORM 3000C-TRLR-SRL-NBR                               09240008
092500     ELSE                                                         09250008
092600     IF  ASC-SCAC-CODE       >  SPACES  AND                       09260008
092700         ASC-TRLR-ID         >  SPACES                            09270008
092800         PERFORM 3000D-TRLR-SRL-NBR                               09280008
092900     END-IF                                                       09290008
093000     END-IF.                                                      09300008
093100                                                                  09310008
093200                                                                  09320008
093300*    FUNC-01    F17 - TRAILER HISTORY                             09330000
093400*    FUNC-02    F18 - TRAILER CARTONS                             09340000
093500*    FUNC-03    F21 - TRAILER LIST                                09350000
093600*    FUNC-04    F22 - DOOR TRAILERS                               09360000
093700*    FUNC-05    F23 - TRAILER SEAL LIST                           09370000
093800*    FUNC-06    F24 - DOOR CARTON LIST                            09380000
093900*    FUNC-07    F16 - SHIP & RELEASE                              09390000
094000*    FUNC-08    F14 - RETRIEVE NEXT CARTON ON DIVERTER LINE       09400000
094010*    FUNC-09    F15 - TRAILER SERIAL UPDATE                       09401056
094100                                                                  09410000
094200     EVALUATE TRUE                                                09420000
094300                                                                  09430000
094310* DMH 8/17 BEGIN                                                  09431061
094311         WHEN DP020-SRC-AID = DP016-ENTER                         09431161
094312              IF  ASC-STORE-NBR > ZEROES                          09431261
094313                  PERFORM 3000E-STORE-NBR                         09431363
094320                  PERFORM 3000K-GET-STR-DC                        09432061
094321              END-IF                                              09432161
094322* DMH 6/16 START                                                  09432265
094324             IF  ASC-SCR-SHIP-X      > SPACES                     09432465
094325                 PERFORM 3000F1-TRIP-ID                           09432565
094326                 IF  PS-NO-ERROR                                  09432665
094327                     PERFORM 3000F2-POPULATE-FIELDS               09432765
094328                 END-IF                                           09432865
094329             END-IF                                               09432965
094330             PERFORM 3000A-OPER-UNT                               09433066
094331* DMH 6/16 START                                                  09433165
094332                                                                  09433265
094340* DMH 8/17 BEGIN                                                  09434061
094400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              09440000
094500             PERFORM 3000A-OPER-UNT                               09450000
094600             EVALUATE TRUE                                        09460000
094700             WHEN ASC-OTBND-TRIP-ID-X  >  ZEROES                  09470000
094800                 PERFORM 3000F-TRIP-ID                            09480000
094900             WHEN ASC-TRLR-SRL-NBR-X > SPACES                     09490000
095000                 PERFORM 3000C-TRLR-SRL-NBR                       09500000
095100             WHEN OTHER                                           09510000
095200                 SET PS-ERROR                                     09520000
095300                     DP020-MSG-FATAL                              09530000
095400                     DP030-SET-CURSOR-APPL-1 TO TRUE              09540000
095500                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  09550000
095600                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOTRIPA           09560000
095700                                                ATRLRA            09570000
095800                 MOVE DP015-RED              TO AOTRIPC           09580000
095900                                                ATRLRC            09590000
096000                 MOVE DP015-REVERSE          TO AOTRIPH           09600000
096100                                                ATRLRH            09610000
096200                 MOVE -1                     TO ATRLRL            09620000
096300             END-EVALUATE                                         09630000
096400                                                                  09640000
096500         IF  ASC-TRLR-SRL-NBR      > ZEROES  AND                  09650000
096600             ASC-OTBND-TRIP-ID     > ZEROES  AND                  09660009
096700             ASC-OTBND-TRIP-ID-X   > SPACES                       09670009
096800                 PERFORM 3000I-TRLR-VS-SRL                        09680000
096900         END-IF                                                   09690000
097000                                                                  09700000
097100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              09710000
097200             PERFORM 3000A-OPER-UNT                               09720000
097300             EVALUATE TRUE                                        09730000
097400             WHEN ASC-OTBND-TRIP-ID-X   >  SPACES  AND            09740008
097500                  ASC-OTBND-TRIP-ID-X   >  ZEROES                 09750008
097600                 PERFORM 3000F-TRIP-ID                            09760000
097700             WHEN ASC-TRLR-SRL-NBR-X  >  SPACES                   09770000
097800                 PERFORM 3000C-TRLR-SRL-NBR                       09780000
097900             WHEN OTHER                                           09790000
098000                 SET PS-ERROR                                     09800000
098100                     DP020-MSG-FATAL                              09810000
098200                     DP030-SET-CURSOR-APPL-1 TO TRUE              09820000
098300                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  09830000
098400                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOTRIPA           09840000
098500                                                ATRLRA            09850000
098600                 MOVE DP015-RED              TO AOTRIPC           09860000
098700                                                ATRLRC            09870000
098800                 MOVE DP015-REVERSE          TO AOTRIPH           09880000
098900                                                ATRLRH            09890000
099000                 MOVE -1                     TO ATRLRL            09900000
099100             END-EVALUATE                                         09910000
099200                                                                  09920000
099300         IF  ASC-TRLR-SRL-NBR      > ZEROES  AND                  09930000
099400             ASC-OTBND-TRIP-ID-X   > SPACES  AND                  09940009
099500             ASC-OTBND-TRIP-ID     > ZEROES                       09950009
099600                 PERFORM 3000I-TRLR-VS-SRL                        09960000
099700         END-IF                                                   09970000
099800                                                                  09980000
099900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09990000
100000             PERFORM 3000A-OPER-UNT                               10000000
100100                                                                  10010000
100200             EVALUATE TRUE                                        10020000
100300             WHEN ASC-STORE-NBR > ZEROES AND                      10030006
100400                                  ASC-DATE-FROM > SPACES          10040006
100500                 PERFORM 3000E-STORE-NBR                          10050000
100600                 PERFORM 3000H-CREATE-DATES                       10060000
100601* DMH 8/17 BEGIN                                                  10060157
100610                 PERFORM 3000K-GET-STR-DC                         10061057
100620* DMH 8/17 BEGIN                                                  10062057
100700                                                                  10070006
100800             WHEN ASC-STORE-NBR > ZEROES AND                      10080006
100900                                  ASC-DATE-FROM = SPACES          10090006
100910* DMH 8/17 BEGIN                                                  10091057
100920                 PERFORM 3000K-GET-STR-DC                         10092057
100930* DMH 8/17 BEGIN                                                  10093057
101000                 SET PS-ERROR                                     10100006
101100                     DP020-MSG-FATAL                              10110006
101200                     DP030-SET-CURSOR-APPL-1 TO TRUE              10120006
101300                 MOVE PC-TSYMSG-03310        TO DP020-MSG-NUMBER  10130006
101400                 MOVE DP015-UNP-ALP-BRT-OFF  TO AFDTMMA           10140007
101500                                                AFDTDDA           10150007
101600                                                AFDTCYA           10160007
101700                 MOVE DP015-RED              TO AFDTMMC           10170007
101800                                                AFDTDDC           10180007
101900                                                AFDTCYC           10190007
102000                 MOVE DP015-REVERSE          TO AFDTMMH           10200007
102100                                                AFDTDDH           10210007
102200                                                AFDTCYH           10220007
102300                 MOVE -1                     TO AFDTMML           10230007
102400                                                                  10240000
102500             WHEN ASC-STOREUNLOADED = 'SU'                        10250000
102600                 AND (ASC-DATE-FROM > SPACES OR                   10260000
102700                      ASC-DATE-TO > SPACES)                       10270000
102800                 PERFORM 3000H-CREATE-DATES                       10280000
102900                                                                  10290000
103000*            WHEN ASC-TRLR-STATUS > SPACES                        10300000
103100*                CONTINUE                                         10310000
103200                                                                  10320000
103300             WHEN ASC-TRLR-SRL-NBR-X > SPACES                     10330000
103400                 PERFORM 3000C-TRLR-SRL-NBR                       10340000
103500                                                                  10350000
103600             WHEN ASC-OTBND-TRIP-ID-X   >  ZEROES                 10360000
103700                 PERFORM 3000F-TRIP-ID                            10370000
103800                                                                  10380000
103900             WHEN ASC-SCAC-CODE         >  SPACES                 10390000
104000                 CONTINUE                                         10400000
104100                                                                  10410000
104200             WHEN ASC-STATUS-DAYS       >  SPACES                 10420000
104300*                PERFORM 3000H-CREATE-DATES                       10430000
104400                 PERFORM 3000D-STATUS-DAYS                        10440000
104500                                                                  10450000
104600             END-EVALUATE                                         10460000
104700                                                                  10470000
104800         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              10480000
104900             PERFORM 3000A-OPER-UNT                               10490000
105000                                                                  10500000
105100         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              10510000
105200             PERFORM 3000J-SEAL-RACF                              10520000
105300             IF  PS-NO-ERROR                                      10530000
105400                 PERFORM 3000A-OPER-UNT                           10540000
105500                 EVALUATE TRUE                                    10550000
105600                    WHEN ASC-TRLR-SRL-NBR     > ZERO              10560000
105700                       PERFORM 3000C-TRLR-SRL-NBR                 10570000
105800                    WHEN ASC-OTBND-TRIP-ID-X  > ZERO              10580000
105900                       PERFORM 3000F-TRIP-ID                      10590000
106000                    WHEN ASC-TRLR-SEAL        > SPACES            10600000
106100                       PERFORM 3000G-TRLR-SEAL                    10610000
106200                    WHEN OTHER                                    10620000
106300                       SET PS-ERROR                               10630000
106400                           DP020-MSG-FATAL                        10640000
106500                           DP030-SET-CURSOR-APPL-1                10650000
106600                           DP030-OVERRIDE-GO       TO TRUE        10660000
106700                       MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER 10670000
106800                       MOVE DP015-UNP-ALP-BRT-OFF  TO ATRLRA      10680000
106900                                                      AOTRIPA     10690000
107000                                                      ATRSELA     10700000
107100                       MOVE DP015-RED              TO ATRLRC      10710000
107200                                                      AOTRIPC     10720000
107300                                                      ATRSELC     10730000
107400                       MOVE DP015-REVERSE          TO ATRLRH      10740000
107500                                                      AOTRIPH     10750000
107600                                                      ATRSELH     10760000
107700                       MOVE -1                     TO ATRLRL      10770000
107800             END-IF                                               10780000
107900                                                                  10790000
108000         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              10800000
108100             PERFORM 3000A-OPER-UNT                               10810000
108200                                                                  10820000
108300             EVALUATE TRUE                                        10830000
108400             WHEN ASC-OTBND-TRIP-ID-X   >  SPACES                 10840000
108500                 PERFORM 3000F-TRIP-ID                            10850000
108600             WHEN OTHER                                           10860000
108700*                DOOR AND DATE RANGE                              10870000
108800                 IF ASC-DOOR-ID > SPACES  AND                     10880010
108900                    ASC-DOOR-ID > ZEROES                          10890010
109000                     PERFORM 3000B-DOOR-ID                        10900000
109100                 ELSE                                             10910000
109200                     SET PS-ERROR                                 10920000
109300                         DP020-MSG-FATAL                          10930000
109400                         DP030-SET-CURSOR-APPL-1 TO TRUE          10940000
109500                     MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER10950000
109600                     MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORA        10960000
109700                     MOVE DP015-RED              TO ADOORC        10970000
109800                     MOVE DP015-REVERSE          TO ADOORH        10980000
109900                     MOVE -1                     TO ADOORL        10990000
110000                 END-IF                                           11000000
110100                                                                  11010000
110200                 PERFORM 3000H-CREATE-DATES                       11020000
110300                                                                  11030000
110400             END-EVALUATE                                         11040000
110500                                                                  11050000
110600         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              11060000
110700                                                                  11070000
110800             EVALUATE TRUE                                        11080000
110900             WHEN ASC-TRLR-SEAL   >  SPACES                       11090000
111000                 PERFORM 3000G-TRLR-SEAL                          11100000
111100             WHEN ASC-OTBND-TRIP-ID-X >  ZEROES                   11110000
111200                 PERFORM 3000F-TRIP-ID                            11120000
111300             WHEN OTHER                                           11130000
111400                 SET PS-ERROR                                     11140000
111500                     DP020-MSG-FATAL         TO TRUE              11150000
111600                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  11160000
111700                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOTRIPA           11170000
111800                                                ATRSELA           11180000
111900                 MOVE DP015-RED              TO AOTRIPC           11190000
112000                                                ATRSELC           11200000
112100                 MOVE DP015-REVERSE          TO AOTRIPH           11210000
112200                                                ATRSELH           11220000
112300                 MOVE -1                     TO AOTRIPL           11230000
112400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              11240000
112500         END-EVALUATE                                             11250000
112600                                                                  11260000
112700                                                                  11270000
112800         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              11280000
112900                                                                  11290000
113000             PERFORM 3000A-OPER-UNT                               11300000
113100                                                                  11310000
113200             IF ASC-DOOR-ID > SPACES  OR                          11320029
113300                ASC-DOOR-ID > ZEROES                              11330010
113400                 PERFORM 3000B-DOOR-ID                            11340000
113500             ELSE                                                 11350000
113600                 SET PS-ERROR                                     11360000
113700                     DP020-MSG-FATAL                              11370000
113800                     DP030-SET-CURSOR-APPL-1 TO TRUE              11380000
113900                 MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER    11390000
114000                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORA            11400000
114100                 MOVE DP015-RED              TO ADOORC            11410000
114200                 MOVE DP015-REVERSE          TO ADOORH            11420000
114300                 MOVE -1                     TO ADOORL            11430000
114400             END-IF                                               11440000
114401*                                                                 11440156
114402*** DMH 1/29/13 BEGIN                                             11440256
114403*                                                                 11440356
114404             IF  PS-NO-ERROR                                      11440456
114405                 PERFORM 7040-CHECK-BEGIN-DIVERT                  11440556
114406             END-IF                                               11440656
114407*                                                                 11440756
114408*** DMH 1/29/13 END                                               11440856
114409*                                                                 11440956
114410                                                                  11441056
114420         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              11442056
114440             EVALUATE TRUE                                        11444056
114450                 WHEN ASC-OTBND-TRIP-ID-X  > ZERO                 11445056
114460                      PERFORM 3000F-TRIP-ID                       11446056
114490                 WHEN OTHER                                       11449056
114491                      SET PS-ERROR                                11449156
114492                          DP020-MSG-FATAL                         11449256
114493                          DP030-SET-CURSOR-APPL-1 TO TRUE         11449356
114494                      MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER 11449456
114495                      MOVE DP015-UNP-ALP-BRT-OFF  TO AOTRIPA      11449556
114497                      MOVE DP015-RED              TO AOTRIPC      11449756
114499                      MOVE DP015-REVERSE          TO AOTRIPH      11449956
114501                      MOVE -1                     TO AOTRIPL      11450156
114502             END-EVALUATE                                         11450256
114503                                                                  11450356
114509                                                                  11450956
114700         WHEN DP020-SRC-AID = DP016-CLEAR                         11470000
114800             PERFORM 3000A-OPER-UNT                               11480000
114900                                                                  11490000
115000         WHEN OTHER                                               11500000
115100             PERFORM 3000A-OPER-UNT                               11510000
115110*ROOPA START                                                      11511041
115120             IF  ASC-SCR-SHIP-X      > SPACES                     11512041
115130                 PERFORM 3000F1-TRIP-ID                           11513041
115140                 IF  PS-NO-ERROR                                  11514041
115150                     PERFORM 3000F2-POPULATE-FIELDS               11515041
115160                 END-IF                                           11516041
115170             END-IF                                               11517041
115180*ROOPA END                                                        11518041
115200                                                                  11520000
115300     END-EVALUATE.                                                11530000
115400                                                                  11540000
115500 3000A-OPER-UNT.                                                  11550000
115600*-----------------------------------------------------------------11560000
115700* VERIFY THAT OPER UNIT ID IS NUMERIC                             11570000
115800*-----------------------------------------------------------------11580000
115900     IF  ASC-OPER-UNT-ID >  SPACES                                11590000
116000         MOVE ASC-OPER-UNT-ID           TO DP010I-UNEDITED-FIELD  11600000
116100         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  11610000
116200         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 11620000
116300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11630000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11641067
263968              USING DP010I-NUMERIC-EDIT-AREA                      11642067
116500         IF  DP010I-ERROR-DETECTED                                11650000
116600             SET PS-ERROR                                         11660000
116700                 DP020-MSG-FATAL         TO TRUE                  11670000
116800             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      11680000
116900             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                11690000
117000             MOVE DP015-RED              TO AOPERC                11700000
117100             MOVE DP015-REVERSE          TO AOPERH                11710000
117200             MOVE -1                     TO AOPERL                11720000
117300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11730000
117400         ELSE                                                     11740000
117500             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       11750000
117600                                          AOPERO                  11760000
117700                                          DK-STORE-NBR            11770000
117800             PERFORM 7010-STORE                                   11780000
117900             IF SQLCODE = +100                                    11790000
118000                 MOVE SPACES             TO ASC-OPER-NAME         11800000
118100                 SET PS-ERROR                                     11810000
118200                     DP020-MSG-FATAL                              11820000
118300                     DP030-SET-CURSOR-APPL-1 TO TRUE              11830000
118400                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  11840000
118500                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            11850000
118600                 MOVE DP015-RED              TO AOPERC            11860000
118700                 MOVE DP015-REVERSE          TO AOPERH            11870000
118800                 MOVE -1                     TO AOPERL            11880000
118900             END-IF                                               11890000
119000         END-IF                                                   11900000
119100     END-IF.                                                      11910000
119200                                                                  11920000
119300 3000B-DOOR-ID.                                                   11930000
119400*-----------------------------------------------------------------11940000
119500* VERIFY THAT DOOR ID ENTERED IS VALID                            11950000
119600*-----------------------------------------------------------------11960000
119700     PERFORM 7000-DOOR-DESC.                                      11970010
119800                                                                  11980000
119900 3000C-TRLR-SRL-NBR.                                              11990000
120000*-----------------------------------------------------------------12000000
120100* VERIFY THAT TRAILER SERIAL NUMBER IS NUMERIC                    12010000
120200*-----------------------------------------------------------------12020000
120300     MOVE ASC-TRLR-SRL-NBR-X     TO DP010I-UNEDITED-FIELD         12030000
120400     MOVE LENGTH OF ASC-TRLR-SRL-NBR  TO    DP010I-MAXIMUM-DIGITS 12040000
120500     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS         12050000
120600     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      12060000
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12071067
263968          USING DP010I-NUMERIC-EDIT-AREA                          12072067
120800     IF  DP010I-ERROR-DETECTED                                    12080000
120900         SET PS-ERROR                                             12090000
121000             DP020-MSG-FATAL         TO TRUE                      12100000
121100         MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER          12110000
121200         MOVE DP015-UNP-ALP-BRT-OFF  TO ATRLRA                    12120000
121300         MOVE DP015-RED              TO ATRLRC                    12130000
121400         MOVE DP015-REVERSE          TO ATRLRH                    12140000
121500         MOVE -1                     TO ATRLRL                    12150000
121600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      12160000
121700     ELSE                                                         12170000
121800         MOVE DP010I-NUMERIC-FIELD TO ASC-TRLR-SRL-NBR            12180000
121900                                      ATRLRO                      12190000
122000     END-IF.                                                      12200000
122100                                                                  12210000
122200*-----------------------------------------------------------------12220000
122300* VERIFY THAT TRAILER SERIAL NUMBER ENTERED IS VALID              12230000
122400*-----------------------------------------------------------------12240000
122500     IF  PS-NO-ERROR                                              12250000
122600         IF  ASC-TRLR-SRL-NBR  >  ZEROES                          12260000
122700             MOVE  ASC-TRLR-SRL-NBR  TO  DK-TRLR-SRL-NBR          12270000
122800             PERFORM 7020-SCAC-BY-TRLR                            12280000
122900             IF SQLCODE = ZERO                                    12290000
123000                 MOVE CNTRID-SCAC-CDE TO ASC-SCAC-CODE            12300000
123100                 MOVE CNTRID-TRLR-ID  TO ASC-TRLR-ID              12310000
123200                 PERFORM 3010-TRAILER-INFO                        12320000
123300                 IF ASC-DOOR-ID > SPACES  AND                     12330010
123400                    ASC-DOOR-ID > ZEROES                          12340010
123500                     PERFORM 7000-DOOR-DESC                       12350000
123600                 END-IF                                           12360000
123700             END-IF                                               12370003
123800         ELSE                                                     12380000
123900             IF ASC-SCAC-CODE   >  SPACES AND                     12390000
124000                ASC-TRLR-ID     >  SPACES                         12400000
124100                 MOVE  ASC-SCAC-CODE     TO  DK-SCAC-CDE          12410000
124200                 MOVE  ASC-TRLR-ID       TO  DK-TRLR-ID           12420000
124300                 PERFORM 7030-GET-SRL-NBR                         12430000
124400                 IF SQLCODE = ZERO                                12440000
124500                     MOVE CNTRID-TRLR-SRL-NBR TO  ASC-TRLR-SRL-NBR12450000
124600                 END-IF                                           12460000
124700             END-IF                                               12470000
124800         END-IF                                                   12480000
124900     END-IF.                                                      12490000
125000                                                                  12500000
125100                                                                  12510008
125200*-----------------------------------------------------------------12520008
125300* VALIDATE SCAC-TRLR                                              12530008
125400*-----------------------------------------------------------------12540008
125500 3000D-TRLR-SRL-NBR.                                              12550008
125600                                                                  12560008
125700     IF  PS-NO-ERROR                                              12570008
125800         MOVE  ASC-SCAC-CODE  TO  DK-SCAC-CDE                     12580008
125900         MOVE  ASC-TRLR-ID    TO  DK-TRLR-ID                      12590008
126000         PERFORM 7030-GET-SRL-NBR                                 12600008
126100         IF  SQLCODE = ZERO                                       12610008
126200             MOVE CNTRID-TRLR-SRL-NBR  TO  ASC-TRLR-SRL-NBR       12620008
126300         END-IF                                                   12630008
126400     END-IF.                                                      12640008
126500                                                                  12650008
126600 3000D-STATUS-DAYS.                                               12660000
126700*-----------------------------------------------------------------12670000
126800* VERIFY THAT STATUS DAYS IS NUMERIC                              12680000
126900*-----------------------------------------------------------------12690000
127000     IF  PS-NO-ERROR                                              12700000
127100         IF  ASC-STATUS-DAYS-X > SPACES                           12710000
127200             MOVE ASC-STATUS-DAYS-X      TO DP010I-UNEDITED-FIELD 12720000
127300             MOVE LENGTH OF ASC-STATUS-DAYS TO                    12730000
127400                                            DP010I-MAXIMUM-DIGITS 12740000
127500             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 12750000
127600             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              12760000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12771067
263968                  USING DP010I-NUMERIC-EDIT-AREA                  12772067
127800             IF  DP010I-ERROR-DETECTED                            12780000
127900                 SET PS-ERROR                                     12790000
128000                     DP020-MSG-FATAL         TO TRUE              12800000
128100                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  12810000
128200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ADAYSA            12820000
128300                 MOVE DP015-RED              TO ADAYSC            12830000
128400                 MOVE DP015-REVERSE          TO ADAYSH            12840000
128500                 MOVE -1                     TO ADAYSL            12850000
128600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              12860000
128700             ELSE                                                 12870000
128800                 MOVE DP010I-NUMERIC-FIELD TO ASC-STATUS-DAYS     12880000
128900                 MOVE ASC-STATUS-DAYS      TO ADAYSO              12890000
129000             END-IF                                               12900000
129100         END-IF                                                   12910000
129200     END-IF.                                                      12920000
129300                                                                  12930000
129400 3000E-STORE-NBR.                                                 12940000
129500*-----------------------------------------------------------------12950000
129600* VERIFY THAT STORE NUMBER IS NUMERIC                             12960000
129700*-----------------------------------------------------------------12970000
129800     IF  PS-NO-ERROR                                              12980000
129900         IF  ASC-STORE-NBR  >  ZEROES                             12990000
130000             MOVE ASC-STORE-NBR          TO DP010I-UNEDITED-FIELD 13000000
130100             MOVE LENGTH OF ASC-STORE-NBR  TO                     13010000
130200                                            DP010I-MAXIMUM-DIGITS 13020000
130300             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13030000
130400             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13040000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13051067
263968                  USING DP010I-NUMERIC-EDIT-AREA                  13052067
130600             IF  DP010I-ERROR-DETECTED                            13060000
130700                 SET PS-ERROR                                     13070000
130800                     DP020-MSG-FATAL         TO TRUE              13080000
130900                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13090000
131000                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASTDSTA           13100000
131100                 MOVE DP015-RED              TO ASTDSTC           13110000
131200                 MOVE DP015-REVERSE          TO ASTDSTH           13120000
131300                 MOVE -1                     TO ASTDSTL           13130000
131400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13140000
131500             ELSE                                                 13150000
131600                 MOVE DP010I-NUMERIC-FIELD TO ASC-STORE-NBR       13160000
131700                 MOVE ASC-STORE-NBR        TO ASTDSTO             13170000
131701*DMH 8/17 - BEGIN                                                 13170160
131710                 MOVE ASC-STR-DC-X         TO ASTRDCO             13171060
131720*DMH 8/17 - BEGIN                                                 13172060
131800             END-IF                                               13180000
131900         END-IF                                                   13190000
132000     END-IF.                                                      13200000
132100                                                                  13210000
132200*-----------------------------------------------------------------13220000
132300* VERIFY THAT STORE NUMBER ENTERED IS VALID                       13230000
132400*-----------------------------------------------------------------13240000
132500     IF  PS-NO-ERROR                                              13250000
132600         IF  ASC-STORE-NBR  >  ZEROES                             13260000
132700                                                                  13270011
133100             INITIALIZE XL071-COMMAREA-REC                        13310011
133200             MOVE ASC-STORE-NBR   TO XL071-LOCATION-NUMBER        13320011
133300                                                                  13330011
133400             CALL PC-LOCATION-MODULE  USING DFHEIBLK              13340011
133500                                            XL071-COMMAREA        13350011
133600                                            XL071-COMMAREA-REC    13360011
133700                                                                  13370011
133800             IF XL071-NO-ERRORS                                   13380011
133900                 MOVE XL071-LOC-NM  TO ASC-STORE-NAME             13390011
134000             ELSE                                                 13400011
134100                 IF XL071-LOC-NOT-FOUND                           13410011
134200                     MOVE SPACES    TO ASC-STORE-NAME             13420011
134300                     SET PS-ERROR                                 13430011
134400                         DP020-MSG-FATAL         TO TRUE          13440011
134500                     MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER   13450011
134600                     MOVE DP015-UNP-ALP-BRT-OFF  TO ASTDSTA       13460011
134700                     MOVE DP015-RED              TO ASTDSTC       13470011
134800                     MOVE DP015-REVERSE          TO ASTDSTH       13480011
134900                     MOVE -1                     TO ASTDSTL       13490011
135000                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          13500011
135100                 ELSE                                             13510011
135200                     IF XL071-BAD-DB2-RETURN                      13520011
135300                         MOVE '3000E-STORE-NBR' TO DP013-PARAGRAPH13530011
135400                         MOVE 'VALIDATE STORE DESTINATION ' TO    13540011
135500                                            DP013-MESSAGE-TEXT (1)13550011
135600                         MOVE XL071-SQLCA    TO SQLCA             13560011
135700                         MOVE SQLCA          TO DP013-SQLCA       13570011
135800                       MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)13580011
135900                         SET DP013-DB2-ABEND TO TRUE              13590011
136000                         SET DP013-XCTL-DISPLAY-RESTART TO TRUE   13600011
136100                         SET DP013-NO-ROLLBACK TO TRUE            13610011
136200                         PERFORM DP013-0000-PROCESS-ABEND         13620011
136300                    END-IF                                        13630011
136400                 END-IF                                           13640011
136500             END-IF                                               13650011
136600         END-IF                                                   13660000
136700     END-IF.                                                      13670000
136800                                                                  13680000
136900*-----------------------------------------------------------------13690000
137000* VERIFY THAT OUTBOUND TRIP ID IS NUMERIC                         13700000
137100*-----------------------------------------------------------------13710000
137200 3000F-TRIP-ID.                                                   13720011
137300             MOVE ASC-OTBND-TRIP-ID-X TO DP010I-UNEDITED-FIELD    13730000
137400             MOVE LENGTH OF ASC-OTBND-TRIP-ID-X  TO               13740000
137500                                            DP010I-MAXIMUM-DIGITS 13750000
137600             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 13760000
137700             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13770000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13781067
263968                  USING DP010I-NUMERIC-EDIT-AREA                  13782067
137900             IF  DP010I-ERROR-DETECTED                            13790000
138000                 SET PS-ERROR                                     13800000
138100                     DP020-MSG-FATAL         TO TRUE              13810000
138200                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  13820000
138300                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOTRIPA           13830000
138400                 MOVE DP015-RED              TO AOTRIPC           13840000
138500                 MOVE DP015-REVERSE          TO AOTRIPH           13850000
138600                 MOVE -1                     TO AOTRIPL           13860000
138700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13870000
138800             ELSE                                                 13880000
138900                 MOVE DP010I-NUMERIC-FIELD TO ASC-OTBND-TRIP-ID   13890000
139000                                              AOTRIPO             13900000
139100             END-IF.                                              13910000
139200                                                                  13920000
139300*-----------------------------------------------------------------13930000
139400* VERIFY THAT OUTBOUND TRIP ID ENTERED IS VALID                   13940000
139500*-----------------------------------------------------------------13950000
139600     IF  PS-NO-ERROR                                              13960000
139700         IF  ASC-OTBND-TRIP-ID     >  ZEROES                      13970000
139800             MOVE  ASC-OTBND-TRIP-ID     TO  DK-OTBND-TRIP-ID     13980000
139900             EXEC SQL                                             13990000
140000                  SELECT OTBND_TRIP_ID                            14000000
140100                    INTO :SUOBTR-OTBND-TRIP-ID                    14010000
140200                    FROM TSUOBTR                                  14020000
140300                  WHERE OTBND_TRIP_ID =  :DK-OTBND-TRIP-ID        14030000
140400              END-EXEC                                            14040000
140500                                                                  14050000
140600              EVALUATE TRUE                                       14060000
140700                  WHEN SQLCODE = +0                               14070000
140800                       CONTINUE                                   14080000
140900                  WHEN SQLCODE = +100                             14090000
141000                       SET PS-ERROR                               14100000
141100                           DP020-MSG-FATAL         TO TRUE        14110000
141200                       MOVE PC-TSYMSG-03053   TO DP020-MSG-NUMBER 14120000
141300                       MOVE DP015-UNP-ALP-BRT-OFF  TO AOTRIPA     14130000
141400                       MOVE DP015-RED              TO AOTRIPC     14140000
141500                       MOVE DP015-REVERSE          TO AOTRIPH     14150000
141600                       MOVE -1                     TO AOTRIPL     14160000
141700                       SET DP030-SET-CURSOR-APPL-1 TO TRUE        14170000
141800                  WHEN OTHER                                      14180000
141900                      MOVE '3000-EDIT-DATA-IN-COMMAREA'           14190000
142000                                               TO DP013-PARAGRAPH 14200000
142100                      MOVE 'VALIDATE OUTBOUND TRIP ID  '          14210000
142200                                       TO DP013-MESSAGE-TEXT (1)  14220000
142300                      MOVE SQLCA   TO DP013-SQLCA                 14230000
142400                      MOVE 'TSUOBTR ' TO DP013-DB2-TABLE-NAME (1) 14240000
142500                      SET DP013-DB2-ABEND                         14250000
142600                          DP013-XCTL-DISPLAY-RESTART TO TRUE      14260000
142700                      PERFORM DP013-0000-PROCESS-ABEND            14270000
142800             END-EVALUATE                                         14280000
142900         END-IF                                                   14290000
143000     END-IF.                                                      14300000
143100                                                                  14310000
143110*ROOPA START                                                      14311041
143120*-----------------------------------------------------------------14312041
143130*-----------------------------------------------------------------14313041
143140 3000F1-TRIP-ID.                                                  14314041
143150     IF ASC-SCR-SHIP-X > SPACES                                   14315041
143160         IF ASC-SCR-SHIP-X(1:1) = 'K'                             14316041
143170            MOVE ASC-SCR-SHIP-X                                   14317048
143180                                         TO ASC-SCR-SHIP-N        14318048
143190            MOVE ASC-SCR-SHIP-N(1:10)    TO ASC-SCR-SHIP          14319048
143191                                            DK-SCR-SHIP           14319148
143192                                                                  14319248
143193         ELSE                                                     14319348
143194             SET PS-ERROR                                         14319448
143195                 DP020-MSG-FATAL         TO TRUE                  14319548
143196             MOVE PC-TSYMSG-01303        TO DP020-MSG-NUMBER      14319648
143197             MOVE DP015-UNP-ALP-BRT-OFF  TO ASHIPA                14319748
143198             MOVE DP015-RED              TO ASHIPC                14319848
143199             MOVE DP015-REVERSE          TO ASHIPH                14319948
143200             MOVE -1                     TO AOTRIPL               14320049
143201             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14320148
143202             MOVE SPACES                 TO ASC-SCR-SHIP-N        14320249
143203                                                                  14320348
143204         END-IF                                                   14320448
143206     ELSE                                                         14320641
143207         MOVE SPACES                     TO ASC-SCR-SHIP-N        14320748
143208     END-IF.                                                      14320841
143209                                                                  14320941
143210*-----------------------------------------------------------------14321041
143211* POPULATE TRIP ID FROM THE EFC SHIPMENT NUMBER                   14321141
143212*-----------------------------------------------------------------14321241
143213     IF  ASC-SCR-SHIP-N > SPACES                                  14321341
143214                                                                  14321441
143215         EXEC SQL                                                 14321541
143216             SELECT DISTINCT                                      14321641
143217                    A.INTR_TRIP_ID                                14321741
143219               INTO :PV-TRIP-ID                                   14321941
143221               FROM WST_SHPMT_XREF_HDR A                          14322141
143222              WHERE A.EXT_SHP_ID = :DK-SCR-SHIP                   14322241
143223                AND A.SOR_CDE    = 'SH'                           14322341
143224         END-EXEC                                                 14322441
143225                                                                  14322541
143226                                                                  14322641
143227         EVALUATE TRUE                                            14322741
143228             WHEN SQLCODE = +0                                    14322841
143229                  MOVE PV-TRIP-ID             TO DK-TRIP-ID       14322941
143246                  CONTINUE                                        14324643
143247             WHEN SQLCODE = +100                                  14324741
143248                  SET PS-ERROR                                    14324841
143249                      DP020-MSG-FATAL        TO TRUE              14324941
143250                  MOVE PC-TSYMSG-03745       TO DP020-MSG-NUMBER  14325041
143251                  MOVE DP015-UNP-ALP-BRT-OFF TO ASHIPA            14325141
143252                  MOVE DP015-RED             TO ASHIPC            14325241
143253                  MOVE DP015-REVERSE         TO ASHIPH            14325341
143254                  MOVE -1                    TO AOTRIPL           14325441
143255                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             14325541
143256             WHEN OTHER                                           14325641
143257                 MOVE '3000-EDIT-DATA-IN-COMMAREA'                14325741
143258                                          TO DP013-PARAGRAPH      14325841
143259                 MOVE 'VALIDATE EFC SHIPMENT NUMBER'              14325941
143260                                  TO DP013-MESSAGE-TEXT (1)       14326041
143261                 MOVE SQLCA       TO DP013-SQLCA                  14326141
143262                 MOVE 'TSUOBTR '  TO DP013-DB2-TABLE-NAME (1)     14326248
143263                 SET DP013-DB2-ABEND                              14326341
143264                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14326441
143265                 PERFORM DP013-0000-PROCESS-ABEND                 14326541
143266         END-EVALUATE                                             14326641
143267     END-IF.                                                      14326741
143268                                                                  14326841
143269*-----------------------------------------------------------------14326941
143317 3000F2-POPULATE-FIELDS.                                          14331741
143318                                                                  14331841
143319*-----------------------------------------------------------------14331941
143320* POPULATE OTHER FIELDS FROM THE TRIP ID                          14332041
143321*-----------------------------------------------------------------14332141
143322                                                                  14332241
143324                                                                  14332441
143325     EXEC SQL                                                     14332541
143326         SELECT  OBTR.ORGN_OPER_UNT_ID                            14332641
143327          INTO  :SUOBTR-ORGN-OPER-UNT-ID                          14332741
143328           FROM  TSUOBTR OBTR                                     14332841
143329          WHERE  OBTR.TRIP_ACTV_CDE  = 'A'                        14332941
143330            AND  OBTR.OTBND_TRIP_ID  = :DK-TRIP-ID                14333041
143331                                                                  14333141
143332     END-EXEC                                                     14333241
143333                                                                  14333341
143334     EVALUATE TRUE                                                14333441
143335         WHEN SQLCODE = +0                                        14333541
143336             MOVE SUOBTR-ORGN-OPER-UNT-ID TO DK-ORGN-OPER-UNT-ID  14333641
143337                                             ASC-OPER-UNT-ID-N    14333741
143338         WHEN SQLCODE = +100                                      14333848
143339             SET PS-ERROR                                         14333941
143340                 DP020-MSG-FATAL         TO TRUE                  14334041
143341             MOVE PC-TSYMSG-01303        TO DP020-MSG-NUMBER      14334141
143342             MOVE DP015-UNP-ALP-BRT-OFF  TO ASHIPA                14334241
143343             MOVE DP015-RED              TO ASHIPC                14334341
143344             MOVE DP015-REVERSE          TO ASHIPH                14334441
143345             MOVE -1                     TO AOTRIPL               14334541
143346             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14334641
143347         WHEN OTHER                                               14334748
143348            MOVE '3000-EDIT-DATA-IN-COMMAREA'                     14334841
143349                                     TO DP013-PARAGRAPH           14334941
143350            MOVE 'VALIDATE EFC SHIPMENT NUMBER'                   14335041
143351                                     TO DP013-MESSAGE-TEXT (1)    14335141
143352            MOVE SQLCA               TO DP013-SQLCA               14335248
143353            MOVE 'TSUOBTR '          TO DP013-DB2-TABLE-NAME (1)  14335348
143354            SET DP013-DB2-ABEND                                   14335448
143355                DP013-XCTL-DISPLAY-RESTART TO TRUE                14335548
143356            PERFORM DP013-0000-PROCESS-ABEND                      14335648
143357     END-EVALUATE.                                                14335741
143358                                                                  14335841
143359     EXEC SQL                                                     14335941
143360         SELECT  OBTR.OTBND_TRIP_ID                               14336055
143369          INTO  :SUOBTR-OTBND-TRIP-ID                             14336955
143378           FROM  TSUOBTR OBTR                                     14337841
143379                ,TSUOBTS OBTS                                     14337941
143380                ,TCNTRID TRID                                     14338041
143381          WHERE  OBTR.OTBND_TRIP_ID  = OBTS.OTBND_TRIP_ID         14338141
143382            AND  OBTR.TRLR_SRL_NBR   = TRID.TRLR_SRL_NBR          14338241
143383                                                                  14338341
143384            AND  OBTR.TRIP_ACTV_CDE  = 'A'                        14338441
143385            AND  OBTR.ORGN_OPER_UNT_ID = :DK-ORGN-OPER-UNT-ID     14338541
143386            AND  OBTR.OTBND_TRIP_ID  = :DK-TRIP-ID                14338641
143387                                                                  14338741
143388            AND OTBND_STAT_TMST =                                 14338841
143389                 (SELECT MAX(OBTS1.OTBND_STAT_TMST)               14338941
143390            FROM TSUOBTS OBTS1                                    14339041
143391          WHERE OBTS.OTBND_TRIP_ID = OBTS1.OTBND_TRIP_ID)         14339141
143392                                                                  14339241
143393     END-EXEC                                                     14339341
143394                                                                  14339441
143395                                                                  14339541
143396     EVALUATE TRUE                                                14339641
143397         WHEN SQLCODE = +0                                        14339741
143400             MOVE SUOBTR-OTBND-TRIP-ID    TO ASC-OTBND-TRIP-ID    14340048
143479            CONTINUE                                              14347951
143480        WHEN SQLCODE = +100                                       14348051
143481             SET PS-ERROR                                         14348151
143482                 DP020-MSG-FATAL         TO TRUE                  14348251
143483             MOVE PC-TSYMSG-01303        TO DP020-MSG-NUMBER      14348351
143484             MOVE DP015-UNP-ALP-BRT-OFF  TO ASHIPA                14348451
143485             MOVE DP015-RED              TO ASHIPC                14348551
143486             MOVE DP015-REVERSE          TO ASHIPH                14348651
143487             MOVE -1                     TO AOTRIPL               14348751
143488             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14348851
143489        WHEN OTHER                                                14348951
143490            MOVE '3000-EDIT-DATA-IN-COMMAREA'                     14349051
143491                                     TO DP013-PARAGRAPH           14349151
143492            MOVE 'VALIDATE EFC SHIPMENT NUMBER'                   14349251
143493                                     TO DP013-MESSAGE-TEXT (1)    14349351
143494            MOVE SQLCA               TO DP013-SQLCA               14349451
143495            MOVE 'TSUOBTR '          TO DP013-DB2-TABLE-NAME (1)  14349551
143496            SET DP013-DB2-ABEND                                   14349651
143497                DP013-XCTL-DISPLAY-RESTART TO TRUE                14349751
143498            PERFORM DP013-0000-PROCESS-ABEND                      14349851
143499     END-EVALUATE.                                                14349951
143500                                                                  14350051
143501*ROOPA END                                                        14350151
143502*-----------------------------------------------------------------14350251
143503* VERIFY THAT TRAILER SEAL ENTERED IS VALID                       14350351
143504*-----------------------------------------------------------------14350451
143510 3000G-TRLR-SEAL.                                                 14351051
143600     EXEC SQL                                                     14360000
143700         SELECT DISTINCT(OTBND_TRIP_ID)                           14370001
143800         INTO :SUOBTS-OTBND-TRIP-ID                               14380001
143900         FROM TSUOBTS                                             14390000
144000         WHERE TRLR_SEAL_ID  =  :ASC-TRLR-SEAL                    14400000
144100     END-EXEC                                                     14410000
144200                                                                  14420000
144300     EVALUATE TRUE                                                14430000
144400         WHEN SQLCODE = +0                                        14440000
144500             MOVE  SUOBTS-OTBND-TRIP-ID  TO  ASC-OTBND-TRIP-ID    14450000
144600         WHEN SQLCODE = -811                                      14460000
144700             IF  ASC-OTBND-TRIP-ID  > 0                           14470002
144800                 CONTINUE                                         14480002
144900             ELSE                                                 14490002
145000                 SET PS-ERROR                                     14500002
145100                     DP020-MSG-FATAL                              14510002
145200                     DP030-SET-CURSOR-APPL-1 TO TRUE              14520002
145300                 MOVE PC-TSYMSG-03052    TO DP020-MSG-NUMBER      14530002
145400                 MOVE DP015-UNP-ALP-BRT-OFF TO ATRSELA            14540002
145500                                                AOTRIPA           14550002
145600                 MOVE DP015-RED          TO ATRSELC               14560002
145700                                                AOTRIPC           14570002
145800                 MOVE DP015-REVERSE      TO ATRSELH               14580002
145900                                                AOTRIPH           14590002
146000                 MOVE -1                 TO ATRSELL               14600002
146100                                                AOTRIPL           14610002
146200             END-IF                                               14620002
146300                                                                  14630002
146400         WHEN SQLCODE = +100                                      14640000
146500             SET PS-ERROR                                         14650000
146600                 DP020-MSG-FATAL                                  14660000
146700                 DP030-SET-CURSOR-APPL-1 TO TRUE                  14670000
146800             MOVE PC-TSYMSG-03051   TO DP020-MSG-NUMBER           14680000
146900             MOVE DP015-UNP-ALP-BRT-OFF  TO ATRSELA               14690000
147000             MOVE DP015-RED              TO ATRSELC               14700000
147100             MOVE DP015-REVERSE          TO ATRSELH               14710000
147200             MOVE -1                     TO ATRSELL               14720000
147300         WHEN OTHER                                               14730000
147400             MOVE '3000G-TRLR-SEAL'      TO DP013-PARAGRAPH       14740000
147500             MOVE 'VALIDATE TRAILER SEAL ID  '                    14750000
147600                                TO DP013-MESSAGE-TEXT (1)         14760000
147700             MOVE SQLCA   TO DP013-SQLCA                          14770000
147800             MOVE 'TSUOBTS ' TO DP013-DB2-TABLE-NAME (1)          14780000
147900             SET DP013-DB2-ABEND                                  14790000
148000                       DP013-XCTL-DISPLAY-RESTART TO TRUE         14800000
148100             PERFORM DP013-0000-PROCESS-ABEND                     14810000
148200     END-EVALUATE.                                                14820000
148300                                                                  14830000
148400 3000H-CREATE-DATES.                                              14840000
148500*-----------------------------------------------------------------14850000
148600*  VALIDATE CREATE FROM AND TO DATES                              14860000
148700*-----------------------------------------------------------------14870000
148800     IF ASC-DATE-FROM > SPACES                                    14880000
148900         PERFORM 3000H1-VALIDATE-FROM-TO                          14890000
149000     END-IF                                                       14900000
149100                                                                  14910000
149200* A TRAILER STATUS MUST BE SELECTED WHEN STATUS DAYS ARE ENTERED  14920000
149300     IF  PS-NO-ERROR                                              14930000
149400         IF ASC-STATUS-DAYS-X > ZEROES AND                        14940000
149500            ASC-DCOPEN        = SPACES AND                        14950000
149600            ASC-DCCLOSED      = SPACES AND                        14960000
149700            ASC-SHIPPED       = SPACES AND                        14970000
149800            ASC-AUDIT         = SPACES AND                        14980000
149900            ASC-STOREOPEN     = SPACES AND                        14990000
150000            ASC-STOREUNLOADED = SPACES                            15000000
150100             SET PS-ERROR                                         15010000
150200                 DP020-MSG-FATAL         TO TRUE                  15020000
150300             MOVE PC-TSYMSG-02926        TO DP020-MSG-NUMBER      15030000
150400             MOVE DP015-UNP-ALP-BRT-OFF  TO ATRST1A               15040000
150500             MOVE DP015-RED              TO ATRST1C               15050000
150600             MOVE DP015-REVERSE          TO ATRST1H               15060000
150700             MOVE -1                     TO ATRST1L               15070000
150800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15080000
150900         END-IF                                                   15090000
151000     END-IF.                                                      15100000
151100                                                                  15110000
151200*-----------------------------------------------------------------15120000
151300*  VALIDATE CREATE FROM AND TO DATES                              15130000
151400*-----------------------------------------------------------------15140000
151500 3000H1-VALIDATE-FROM-TO.                                         15150000
151600                                                                  15160000
151700     MOVE  ASC-FROM-MM  TO  PV-FROM-MM.                           15170000
151800     MOVE  ASC-FROM-DD  TO  PV-FROM-DD.                           15180000
151900     MOVE  ASC-FROM-YY  TO  PV-FROM-YY.                           15190000
152000                                                                  15200000
152100     MOVE  ASC-TO-MM    TO  PV-TO-MM.                             15210000
152200     MOVE  ASC-TO-DD    TO  PV-TO-DD.                             15220000
152300     MOVE  ASC-TO-YY    TO  PV-TO-YY.                             15230000
152400                                                                  15240000
152500     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   15250000
152600         CONTINUE                                                 15260000
152700     ELSE                                                         15270000
152800*        DATE RANGE IS INVALID                                    15280000
152900         SET PS-ERROR                                             15290000
153000         DP020-MSG-FATAL             TO TRUE                      15300000
153100         MOVE PC-TSYMSG-02698        TO DP020-MSG-NUMBER          15310000
153200         MOVE DP015-UNP-ALP-BRT-OFF  TO AFDTMMA                   15320000
153300                                        AFDTDDA                   15330000
153400                                        AFDTCYA                   15340000
153500                                        ATDTMMA                   15350000
153600                                        ATDTDDA                   15360000
153700                                        ATDTCYA                   15370000
153800         MOVE DP015-RED              TO AFDTMMC                   15380000
153900                                        AFDTDDC                   15390000
154000                                        AFDTCYC                   15400000
154100                                        ATDTMMC                   15410000
154200                                        ATDTDDC                   15420000
154300                                        ATDTCYC                   15430000
154400         MOVE DP015-REVERSE          TO AFDTMMH                   15440000
154500                                        AFDTDDH                   15450000
154600                                        AFDTCYH                   15460000
154700                                        ATDTMMH                   15470000
154800                                        ATDTDDH                   15480000
154900                                        ATDTCYH                   15490000
155000         MOVE -1                     TO AFDTMML                   15500000
155100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15510000
155200     END-IF.                                                      15520000
155300                                                                  15530000
155400     IF  PS-NO-ERROR                                              15540000
155500         INITIALIZE DPG51 DPG52 DPG53                             15550000
155600                    DPG54 DPG55 DPG56                             15560000
155700         SET  DPG51-ACTUAL-CALENDAR-ONLY                          15570000
155800              DPG51-DO-NOT-INCR-DECR-DATE                         15580000
155900                                    TO TRUE                       15590000
156000*            'CCYYMMDD'                                           15600000
156100         SET  DPG52-LK-DTE-ISO                                    15610000
156200                                    TO TRUE                       15620000
156300         MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT        15630000
156400         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          15640000
156500                                       DPG54 DPG55 DPG56          15650000
156600         IF (DPG54-DATE-INVALID  OR                               15660000
156700             DPG54-SEVERE-ERROR)                                  15670000
156800             SET PS-ERROR                                         15680000
156900                 DP020-MSG-FATAL       TO TRUE                    15690000
157000             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        15700000
157100             MOVE DP015-UNP-ALP-BRT-OFF                           15710000
157200                                       TO AFDTMMA                 15720000
157300                                          AFDTDDA                 15730000
157400                                          AFDTCYA                 15740000
157500             MOVE DP015-RED            TO AFDTMMC                 15750000
157600                                          AFDTDDC                 15760000
157700                                          AFDTCYC                 15770000
157800             MOVE DP015-REVERSE        TO AFDTMMH                 15780000
157900                                          AFDTDDH                 15790000
158000                                          AFDTCYH                 15800000
158100             MOVE -1                   TO AFDTMML                 15810000
158200             SET DP030-SET-CURSOR-APPL-1                          15820000
158300                                       TO TRUE                    15830000
158400         END-IF                                                   15840000
158500                                                                  15850000
158600         INITIALIZE DPG51 DPG52 DPG53                             15860000
158700                    DPG54 DPG55 DPG56                             15870000
158800         SET  DPG51-ACTUAL-CALENDAR-ONLY                          15880000
158900              DPG51-DO-NOT-INCR-DECR-DATE                         15890000
159000                                    TO TRUE                       15900000
159100*            'CCYYMMDD'                                           15910000
159200             SET  DPG52-LK-DTE-ISO                                15920000
159300                                    TO TRUE                       15930000
159400         MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT        15940000
159500         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          15950000
159600                                       DPG54 DPG55 DPG56          15960000
159700         IF (DPG54-DATE-INVALID                                   15970000
159800         OR  DPG54-SEVERE-ERROR)                                  15980000
159900             SET PS-ERROR                                         15990000
160000                 DP020-MSG-FATAL       TO TRUE                    16000000
160100             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        16010000
160200             MOVE DP015-UNP-ALP-BRT-OFF                           16020000
160300                                       TO ATDTMMA                 16030000
160400                                          ATDTDDA                 16040000
160500                                          ATDTCYA                 16050000
160600             MOVE DP015-RED            TO ATDTMMC                 16060000
160700                                          ATDTDDC                 16070000
160800                                          ATDTCYC                 16080000
160900             MOVE DP015-REVERSE        TO ATDTMMH                 16090000
161000                                          ATDTDDH                 16100000
161100                                          ATDTCYH                 16110000
161200             MOVE -1                   TO ATDTMML                 16120000
161300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16130000
161400         END-IF                                                   16140000
161500     END-IF.                                                      16150000
161600                                                                  16160000
161700 3000I-TRLR-VS-SRL.                                               16170000
161800*-----------------------------------------------------------------16180000
161900* VERIFY TRAILER SERIAL # AND TRIP ID IF BOTH ENTERED             16190000
162000*-----------------------------------------------------------------16200000
162100     MOVE ASC-TRLR-SRL-NBR      TO  DK-TRLR-SRL-NBR               16210000
162200     MOVE ASC-OTBND-TRIP-ID     TO  DK-OTBND-TRIP-ID              16220000
162300     EXEC SQL                                                     16230000
162400         SELECT ORGN_OPER_UNT_ID                                  16240000
162500               ,DEST_OPER_UNT_ID                                  16250000
162600               ,TRIP_ACTV_CDE                                     16260000
162700         INTO :SUOBTR-ORGN-OPER-UNT-ID                            16270000
162800             ,:SUOBTR-DEST-OPER-UNT-ID                            16280000
162900             ,:SUOBTR-TRIP-ACTV-CDE                               16290000
163000         FROM TSUOBTR                                             16300000
163100         WHERE OTBND_TRIP_ID   =  :DK-OTBND-TRIP-ID               16310000
163200          AND  TRLR_SRL_NBR    =  :DK-TRLR-SRL-NBR                16320000
163300     END-EXEC.                                                    16330000
163400                                                                  16340000
163500     EVALUATE TRUE                                                16350000
163600         WHEN SQLCODE = +0                                        16360000
163700              CONTINUE                                            16370000
163800         WHEN SQLCODE = +100                                      16380000
163900             SET PS-ERROR                                         16390000
164000                 DP020-MSG-FATAL   TO TRUE                        16400000
164100             MOVE PC-TSYMSG-02697  TO DP020-MSG-NUMBER            16410000
164200             MOVE DP015-UNP-ALP-BRT-OFF TO AOTRIPA                16420000
164300                                           ATRLRA                 16430000
164400             MOVE DP015-RED             TO AOTRIPC                16440000
164500                                           ATRLRC                 16450000
164600             MOVE DP015-REVERSE         TO AOTRIPH                16460000
164700                                           ATRLRH                 16470000
164800             MOVE -1                    TO ATRLRL                 16480000
164900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16490000
165000         WHEN OTHER                                               16500000
165100             MOVE '3000I-TRLR-VS-SRL'                             16510000
165200                               TO DP013-PARAGRAPH                 16520000
165300             MOVE 'VERIFY SERIAL NBR/OUT TRIP COMBINATION'        16530000
165400                               TO DP013-MESSAGE-TEXT (1)          16540000
165500              STRING 'TRLR SRL '  DELIMITED BY SIZE               16550000
165600                 ASC-TRLR-SRL-NBR  DELIMITED BY SIZE              16560000
165700                    '  OUT TRIP '  DELIMITED BY SIZE              16570000
165800              ASC-OTBND-TRIP-ID DELIMITED BY SIZE                 16580000
165900                             INTO DP013-MESSAGE-TEXT (2)          16590000
166000              MOVE SQLCA   TO DP013-SQLCA                         16600000
166100              MOVE 'TSUOBTR ' TO DP013-DB2-TABLE-NAME (1)         16610000
166200              SET DP013-DB2-ABEND                                 16620000
166300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              16630000
166400              PERFORM DP013-0000-PROCESS-ABEND                    16640000
166500     END-EVALUATE.                                                16650000
166600                                                                  16660000
166700 3000J-SEAL-RACF.                                                 16670000
166800     MOVE 'SUTRLRSL' TO DP008-FUNCTION-NAME                       16680000
166900     PERFORM 2105-RACF-ACCESS                                     16690000
167000     IF  PS-ACCESS-NOT-ALLOWED                                    16700000
167100         SET  PS-ERROR                                            16710000
167200              DP020-MSG-FATAL                                     16720000
167300              DP030-SET-CURSOR-APPL-1                             16730000
167400              DP030-OVERRIDE-GO       TO TRUE                     16740000
167500         MOVE PC-TSYMSG-00840 TO DP020-MSG-NUMBER                 16750000
167600         MOVE -1              TO AOPERL                           16760000
167700     END-IF.                                                      16770000
167800                                                                  16780000
167801**************************************************************    16780157
167802* DETERMINE THE DC THE STORE IS SERVICED BY                  *    16780257
167803* DMH 8/17 - ADDED                                           *    16780357
167804**************************************************************    16780457
167810 3000K-GET-STR-DC.                                                16781057
167811     MOVE ASC-STORE-NBR         TO  XLT00014-LOC-NBR              16781157
167815     EXEC SQL                                                     16781557
167816         SELECT DC_NBR                                            16781657
167819         INTO :XLT00014-DC-NBR                                    16781957
167822         FROM XLT_DC_LOC_ASGMT A                                  16782257
167823         WHERE A.LOC_NBR       =  :XLT00014-LOC-NBR               16782357
167824           AND A.EFF_BEG_DTE    IN                                16782457
167825              (SELECT MAX(B.EFF_BEG_DTE)                          16782557
167826                 FROM XLT_DC_LOC_ASGMT B                          16782657
167827                WHERE A.LOC_NBR  =  B.LOC_NBR                     16782757
167828                  AND B.EFF_BEG_DTE  <= CURRENT DATE)             16782857
167829     END-EXEC.                                                    16782957
167830                                                                  16783057
167831     EVALUATE TRUE                                                16783157
167832         WHEN SQLCODE = +0                                        16783257
167835              MOVE  '('             TO  ASC-STR-DC-PAREN-1        16783557
167836              MOVE XLT00014-DC-NBR  TO  ASC-STR-DC-NBR            16783657
167837              MOVE  ')'             TO  ASC-STR-DC-PAREN-2        16783757
167839         WHEN SQLCODE = +100                                      16783957
167840              MOVE SPACES           TO  ASC-STR-DC-X              16784057
167851         WHEN OTHER                                               16785157
167852             MOVE '3000K-GET-STR-DC '                             16785257
167853                               TO DP013-PARAGRAPH                 16785357
167854             MOVE 'GET SERVICING DC NUMBER               '        16785457
167855                               TO DP013-MESSAGE-TEXT (1)          16785557
167856             MOVE XLT00014-LOC-NBR TO PV-DISP-STR                 16785657
167860             MOVE PV-DISP-STR  TO DP013-MESSAGE-TEXT (2)          16786057
167861              MOVE SQLCA   TO DP013-SQLCA                         16786157
167862              MOVE 'XLT00014' TO DP013-DB2-TABLE-NAME (1)         16786257
167863              SET DP013-DB2-ABEND                                 16786357
167864                  DP013-XCTL-DISPLAY-RESTART TO TRUE              16786457
167865              PERFORM DP013-0000-PROCESS-ABEND                    16786557
167866     END-EVALUATE.                                                16786657
167867                                                                  16786757
167868                                                                  16786857
167870                                                                  16787057
167900 3010-TRAILER-INFO.                                               16790000
168000                                                                  16800000
168100     INITIALIZE  PC048-COMMAREA-REC.                              16810000
168200                                                                  16820000
168300     MOVE  ASC-TRLR-SRL-NBR       TO  PC048-TRLR-SRL-NBR.         16830000
168400                                                                  16840000
168500     EXEC CICS                                                    16850000
168600          LINK PROGRAM  (PC-TRLR-STATUS-PGM)                      16860000
168700               COMMAREA (PC048-COMMAREA-REC)                      16870000
168800               RESP     (PV-CICS-RESPONSE)                        16880000
168900     END-EXEC                                                     16890000
169000                                                                  16900000
169100     EVALUATE TRUE                                                16910000
169200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16920000
169300              SET PS-NO-ERROR  TO TRUE                            16930000
169400              PERFORM 3011-VALIDATE-STATUS-CALL                   16940000
169500         WHEN OTHER                                               16950000
169600             MOVE '3010-TRAILERC-INFO' TO DP013-PARAGRAPH         16960000
169700             MOVE 'UNABLE TO ACCESS CICS'                         16970000
169800                               TO DP013-MESSAGE-TEXT (1)          16980000
169900             MOVE SQLCA                 TO DP013-SQLCA            16990000
170000             SET DP013-DB2-ABEND                                  17000000
170100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17010000
170200             PERFORM DP013-0000-PROCESS-ABEND                     17020000
170300     END-EVALUATE.                                                17030000
170400                                                                  17040000
170500                                                                  17050000
170600 3011-VALIDATE-STATUS-CALL.                                       17060000
170700                                                                  17070000
170800                                                                  17080000
170900     EVALUATE TRUE                                                17090000
171000     WHEN  PC048-SUCCESSFUL                                       17100000
171100                                                                  17110000
171200         IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR           17120004
171300             DP020-SRC-AID = DP016-ENTER                          17130004
171400             CONTINUE                                             17140003
171500         ELSE                                                     17150003
171600             IF  PC048-OTBND-TRIP-STATUS = 'DO'                   17160003
171700                 MOVE  PC048-DOOR-ID     TO  ASC-DOOR-ID          17170003
171800             END-IF                                               17180003
171900         END-IF                                                   17190003
172000                                                                  17200000
172100*        MOVE  PC048-TRIP-STAT-TMST      TO  PC045-TRIP-STAT-TMST 17210000
172200*        MOVE  PC048-ORGN-OPER-UNT-ID    TO  PC045-OPER-UNT-ID    17220000
172300*        MOVE  PC048-SCAC-CDE            TO  PC045-SCAC-CDE       17230000
172400*        MOVE  PC048-OTBND-TRIP-ID       TO  PC045-OTBND-TRIP-ID  17240000
172500*        MOVE  PC048-STATUS-USER-ID      TO  PC045-STATUS-USER-ID 17250000
172600*        MOVE  PC048-DOOR-TYP-CDE        TO  PC045-DOOR-TYP-CDE   17260000
172700*        MOVE  PC048-DEST-OPER-UNT-ID    TO                       17270000
172800*                                  PC045-DEST-OPER-UNT-ID         17280000
172900*        MOVE  PC048-OTBND-TRIP-STATUS-DESC TO                    17290000
173000*                                    PC045-OTBND-TRIP-STATUS-DESC 17300000
173100*                                                                 17310000
173200*        MOVE  PC048-TRIP-STAT-SHRT-DESC TO                       17320000
173300*                                            PC233-TRAILER-STATUS 17330000
173400                                                                  17340000
173500       WHEN PC048-ERROR                                           17350000
173600       WHEN PC048-INVALID-SQL                                     17360000
173700       WHEN PC048-DATABASE-BUSY                                   17370000
173800       WHEN PC048-INVALID-TRLR                                    17380000
173900       WHEN PC048-NO-ACTIVE-TRIP                                  17390000
174000         SET PS-ERROR  TO TRUE                                    17400000
174100     END-EVALUATE.                                                17410000
174200                                                                  17420000
174300*----------------------------------------------------------------*17430000
174400*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *17440000
174500*  MAP.                                                          *17450000
174600*----------------------------------------------------------------*17460000
174700 3200-RESET-ATTRIBUTES.                                           17470000
174800                                                                  17480000
174900     MOVE DP015-ASK-NOR-MDT        TO ACROPRA                     17490000
175000                                      ACRNMEA                     17500000
175100                                      AOPRNMEA                    17510000
175200                                      ADRLOCA                     17520000
175300                                      ASTDSCA                     17530000
175400                                                                  17540000
175500     MOVE DP015-UNP-ALP-NOR-OFF    TO                             17550000
175600                                      ADRTP1A                     17560000
175700                                      ADRTP2A                     17570000
175800                                      ADRTP3A                     17580000
175900                                      ADRTP4A                     17590000
176000                                      ADRTP5A                     17600000
176100                                      ADRTP6A                     17610000
176200                                      ASCACA                      17620000
176300                                      ATRLIDA                     17630000
176400                                      ATRST1A                     17640000
176500                                      ATRST2A                     17650000
176600                                      ATRST3A                     17660000
176700                                      ATRST4A                     17670000
176800                                      ATRST5A                     17680000
176900                                      ATRST6A                     17690000
177000                                      ACRTNSA                     17700000
177100                                      ATRSELA                     17710000
177200                                      ADOORA                      17720000
177300                                                                  17730000
177400     MOVE DP015-UNP-NUM-NOR-OFF    TO                             17740000
177500                                      ASTDSTA                     17750000
177600                                      AOTRIPA                     17760000
177700                                      ADAYSA                      17770000
177800                                      AOPERA                      17780000
177900                                      ATRLRA                      17790000
178000                                      AFDTMMA                     17800000
178100                                      AFDTDDA                     17810000
178200                                      AFDTCYA                     17820000
178300                                      ATDTMMA                     17830000
178400                                      ATDTDDA                     17840000
178500                                      ATDTCYA                     17850000
178600                                                                  17860000
178700     MOVE DP015-GREEN              TO AOPERC                      17870000
178800                                      ADOORC                      17880000
178900                                      ADRTP1C                     17890000
179000                                      ADRTP2C                     17900000
179100                                      ADRTP3C                     17910000
179200                                      ADRTP4C                     17920000
179300                                      ADRTP5C                     17930000
179400                                      ADRTP6C                     17940000
179500                                      ATRLRC                      17950000
179600                                      ASCACC                      17960000
179700                                      ATRLIDC                     17970000
179800                                      ATRST1C                     17980000
179900                                      ATRST2C                     17990000
180000                                      ATRST3C                     18000000
180100                                      ATRST4C                     18010000
180200                                      ATRST5C                     18020000
180300                                      ATRST6C                     18030000
180400                                      AFDTMMC                     18040000
180500                                      AFDTDDC                     18050000
180600                                      AFDTCYC                     18060000
180700                                      ATDTMMC                     18070000
180800                                      ATDTDDC                     18080000
180900                                      ATDTCYC                     18090000
181000                                      ACRTNSC                     18100000
181100                                      ASTDSTC                     18110000
181200                                      AOTRIPC                     18120000
181210*ROOPA START                                                      18121041
181220                                      ASHIPC                      18122041
181230*ROOPA END                                                        18123041
181300                                      ATRSELC                     18130000
181400                                                                  18140000
181500     MOVE DP015-BLUE               TO ACROPRC                     18150000
181600                                      ACRNMEC                     18160000
181700                                      AOPRNMEC                    18170000
181800                                      ADRLOCC                     18180000
181900                                      ASTDSCC                     18190000
182000                                                                  18200000
182100     MOVE DP015-UNDERLINE          TO AOPERH                      18210000
182200                                      ADOORH                      18220000
182300                                      ADRTP1H                     18230000
182400                                      ADRTP2H                     18240000
182500                                      ADRTP3H                     18250000
182600                                      ADRTP4H                     18260000
182700                                      ADRTP5H                     18270000
182800                                      ADRTP6H                     18280000
182900                                      ATRLRH                      18290000
183000                                      ASCACH                      18300000
183100                                      ATRLIDH                     18310000
183200                                      ATRST1H                     18320000
183300                                      ATRST2H                     18330000
183400                                      ATRST3H                     18340000
183500                                      ATRST4H                     18350000
183600                                      ATRST5H                     18360000
183700                                      ATRST6H                     18370000
183800                                      AFDTMMH                     18380000
183900                                      AFDTDDH                     18390000
184000                                      AFDTCYH                     18400000
184100                                      ATDTMMH                     18410000
184200                                      ATDTDDH                     18420000
184300                                      ATDTCYH                     18430000
184400                                      ACRTNSH                     18440000
184500                                      ASTDSTH                     18450000
184600                                      AOTRIPH                     18460000
184610*ROOPA START                                                      18461041
184620                                      ASHIPH                      18462041
184630*ROOPA END                                                        18463041
184700                                      ATRSELH.                    18470000
184800                                                                  18480000
184900*----------------------------------------------------------------*18490000
185000*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *18500000
185100*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *18510000
185200*  IT HERE.                                                      *18520000
185300*----------------------------------------------------------------*18530000
185400 4000-BUILD-INITIAL-PANEL.                                        18540000
185500     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        18550000
185600     MOVE -1                       TO AOPERL.                     18560000
185700                                                                  18570000
185800     INITIALIZE PV-USER-LOCATION.                                 18580000
185900     MOVE DP020-LOCATION-NBR       TO DK-CURR-OPER-UNT-ID         18590011
186000                                      ASC-CURR-OPER-UNT-ID-N.     18600000
186100     MOVE ASC-CURR-OPER-UNT-ID-N   TO DK-STORE-NBR.               18610000
186200     PERFORM 4100-GET-DFLT-ST-NAME.                               18620000
186300                                                                  18630000
186400     MOVE XL071-LOCATION-NUMBER    TO ACROPRO                     18640011
186500                                      AOPERO                      18650000
186600                                      ASC-OPER-UNT-ID-N           18660000
186700                                                                  18670000
186800     MOVE XL071-LOC-NM             TO ACRNMEO                     18680011
186900                                      AOPRNMEO                    18690000
187000                                      ASC-CURR-OPER-NAME          18700000
187100                                      ASC-OPER-NAME               18710000
187200                                                                  18720000
187300     PERFORM 4200-GET-DFLT-FROM-DATE.                             18730000
187400     MOVE PV-DFLT-MM               TO AFDTMMO                     18740000
187500                                      ASC-FROM-MM                 18750000
187600     MOVE PV-DFLT-DD               TO AFDTDDO                     18760000
187700                                      ASC-FROM-DD                 18770000
187800     MOVE PV-DFLT-YY               TO AFDTCYO                     18780000
187900                                      ASC-FROM-YY                 18790000
188000     MOVE PV-CURR-MM               TO ATDTMMO                     18800011
188100                                      ASC-TO-MM                   18810011
188200     MOVE PV-CURR-DD               TO ATDTDDO                     18820011
188300                                      ASC-TO-DD                   18830011
188400     MOVE PV-CURR-YY               TO ATDTCYO                     18840011
188500                                      ASC-TO-YY                   18850011
188600                                                                  18860000
188700     MOVE ZEROES                   TO ATRLRO                      18870000
188800     MOVE SPACES                   TO ADOORO                      18880000
188900                                      ADRLOCO                     18890000
189000                                      ASCACO                      18900000
189100                                      ATRLIDO.                    18910000
189200*----------------------------------------------------------------*18920000
189300*       GET STORE NAME                                            18930000
189400*----------------------------------------------------------------*18940000
189500 4100-GET-DFLT-ST-NAME.                                           18950000
189800                                                                  18980011
189900     INITIALIZE XL071-COMMAREA-REC                                18990011
190000     MOVE ASC-CURR-OPER-UNT-ID-N   TO XL071-LOCATION-NUMBER.      19000013
190100                                                                  19010011
190200     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      19020011
190300                                    XL071-COMMAREA                19030011
190400                                    XL071-COMMAREA-REC.           19040011
190500                                                                  19050011
190600     IF XL071-NO-ERRORS                                           19060011
190700         CONTINUE                                                 19070011
190800     ELSE                                                         19080011
190900         IF XL071-LOC-NOT-FOUND                                   19090011
191000             SET PS-ERROR                TO TRUE                  19100011
191100         ELSE                                                     19110011
191200             IF XL071-BAD-DB2-RETURN                              19120011
191300                 MOVE '4100-GET-DFLT-ST-NAME' TO DP013-PARAGRAPH  19130011
191400                 MOVE 'GET DEFAULT STORE NAME  ' TO               19140011
191500                                         DP013-MESSAGE-TEXT (1)   19150011
191600                 MOVE XL071-SQLCA    TO SQLCA                     19160011
191700                 MOVE SQLCA          TO DP013-SQLCA               19170011
191800                 MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)      19180011
191900                 SET DP013-DB2-ABEND TO TRUE                      19190011
192000                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           19200011
192100                 SET DP013-NO-ROLLBACK TO TRUE                    19210011
192200                 PERFORM DP013-0000-PROCESS-ABEND                 19220011
192300            END-IF                                                19230011
192400         END-IF                                                   19240011
192500      END-IF.                                                     19250012
192600                                                                  19260000
192700*----------------------------------------------------------------*19270000
192800*       GET DEFAULT FROM DATE                                     19280000
192900*----------------------------------------------------------------*19290000
193000 4200-GET-DFLT-FROM-DATE.                                         19300000
193100     EXEC SQL                                                     19310000
193200         SELECT CURRENT DATE - FUNC_QTY DAYS                      19320000
193300              , CURRENT DATE                                      19330011
193400           INTO   :PV-DEFAULT-FROM-DATE                           19340000
193500                , :PV-CURRENT-DATE                                19350011
193600           FROM  TKRPRPM                                          19360000
193700          WHERE LOC_ID            = :DK-CURR-OPER-UNT-ID          19370000
193800            AND INTFC_SYS_CDE     = 'KHL'                         19380000
193900            AND SYS_PRC_FUNC_CDE  = 'DVTDAY'                      19390000
194000            AND FUNC_PRC_STAT_CDE = 'AC'                          19400000
194100      END-EXEC.                                                   19410000
194200                                                                  19420000
194300       EVALUATE TRUE                                              19430000
194400          WHEN SQLCODE = +0                                       19440000
194500              CONTINUE                                            19450000
194600          WHEN SQLCODE = +100                                     19460015
194700              SET PS-ERROR                                        19470016
194800                  DP020-MSG-FATAL         TO TRUE                 19480016
194900              MOVE PC-TSYMSG-03363    TO DP020-MSG-NUMBER         19490021
195000              MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA               19500017
195100              MOVE DP015-RED              TO AOPERC               19510017
195200              MOVE DP015-REVERSE          TO AOPERH               19520017
195300              MOVE -1                     TO AOPERL               19530017
195400              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 19540016
195500          WHEN OTHER                                              19550000
195600              SET PS-ERROR    TO TRUE                             19560000
195700              MOVE '4200-GET-DFLT-FROM-DATE ' TO DP013-PARAGRAPH  19570000
195800              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)19580000
195900              MOVE SQLCA   TO DP013-SQLCA                         19590000
196000              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         19600000
196100              SET DP013-DB2-ABEND                                 19610000
196200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              19620000
196300              PERFORM DP013-0000-PROCESS-ABEND                    19630000
196400      END-EVALUATE.                                               19640000
196500/                                                                 19650000
196600 7000-DOOR-DESC.                                                  19660000
196700     EXEC SQL                                                     19670000
196800         SELECT DOOR_LOC_DESC                                     19680000
196900             INTO :CNDCDR-DOOR-LOC-DESC                           19690000
197000             FROM TCNDCDR                                         19700000
197100             WHERE OPER_UNT_ID =  :DK-STORE-NBR                   19710000
197200                   AND DOOR_ID     =  :ASC-DOOR-ID                19720000
197300     END-EXEC                                                     19730000
197400                                                                  19740000
197500     EVALUATE TRUE                                                19750000
197600         WHEN SQLCODE = +0                                        19760000
197700             MOVE CNDCDR-DOOR-LOC-DESC TO ASC-DOOR-DESC           19770000
197800         WHEN SQLCODE = +100                                      19780000
197900             MOVE SPACES               TO ASC-DOOR-DESC           19790000
198000             SET PS-ERROR                                         19800000
198100                 DP020-MSG-FATAL         TO TRUE                  19810000
198200             MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER          19820000
198300             MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORA                19830000
198400             MOVE DP015-RED              TO ADOORC                19840000
198500             MOVE DP015-REVERSE          TO ADOORH                19850000
198600             MOVE -1                     TO ADOORL                19860000
198700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  19870000
198800         WHEN OTHER                                               19880000
198900             MOVE '7000-DOOR-DESC   '                             19890011
199000                                               TO DP013-PARAGRAPH 19900000
199100             MOVE 'VALIDATE DOOR ID '                             19910000
199200                                       TO DP013-MESSAGE-TEXT (1)  19920000
199300             MOVE SQLCA   TO DP013-SQLCA                          19930000
199400             MOVE 'TCNDCDR ' TO DP013-DB2-TABLE-NAME (1)          19940000
199500             SET DP013-DB2-ABEND                                  19950000
199600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               19960000
199700             PERFORM DP013-0000-PROCESS-ABEND                     19970000
199800     END-EVALUATE.                                                19980000
199900                                                                  19990000
200000 7010-STORE.                                                      20000000
200100                                                                  20010000
200500     INITIALIZE XL071-COMMAREA-REC                                20050011
200600     MOVE ASC-OPER-UNT-ID-N        TO XL071-LOCATION-NUMBER.      20060011
200700                                                                  20070011
200800     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      20080011
200900                                    XL071-COMMAREA                20090011
201000                                    XL071-COMMAREA-REC.           20100011
201100                                                                  20110011
201200     IF XL071-NO-ERRORS                                           20120011
201300         MOVE XL071-LOC-NM       TO ASC-OPER-NAME                 20130011
201400     ELSE                                                         20140011
201500         IF XL071-LOC-NOT-FOUND                                   20150011
201600             SET PS-ERROR                TO TRUE                  20160011
201700         ELSE                                                     20170011
201800             IF XL071-BAD-DB2-RETURN                              20180011
201900                 MOVE '7010-STORE  ' TO DP013-PARAGRAPH           20190011
202000                 MOVE 'VALIDATE OPER UNIT ID  ' TO                20200011
202100                                         DP013-MESSAGE-TEXT (1)   20210011
202200                 MOVE XL071-SQLCA    TO SQLCA                     20220011
202300                 MOVE SQLCA          TO DP013-SQLCA               20230011
202400                 MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)      20240011
202500                 SET DP013-DB2-ABEND TO TRUE                      20250011
202600                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           20260011
202700                 SET DP013-NO-ROLLBACK TO TRUE                    20270011
202800                 PERFORM DP013-0000-PROCESS-ABEND                 20280011
202900            END-IF                                                20290011
203000         END-IF                                                   20300011
203100      END-IF.                                                     20310012
203200                                                                  20320000
203300 7020-SCAC-BY-TRLR.                                               20330000
203400     EXEC SQL                                                     20340000
203500         SELECT SCAC_CDE                                          20350000
203600               ,TRLR_ID                                           20360000
203700          INTO :CNTRID-SCAC-CDE                                   20370000
203800              ,:CNTRID-TRLR-ID                                    20380000
203900          FROM TCNTRID                                            20390000
204000          WHERE TRLR_SRL_NBR  =  :DK-TRLR-SRL-NBR                 20400000
204100     END-EXEC.                                                    20410000
204200                                                                  20420000
204300     EVALUATE TRUE                                                20430000
204400         WHEN SQLCODE = ZERO                                      20440000
204500             CONTINUE                                             20450000
204600         WHEN SQLCODE = +100                                      20460000
204700             MOVE SPACES          TO ASC-SCAC-CODE                20470000
204800                                     ASC-TRLR-ID                  20480000
204900             SET PS-ERROR                                         20490000
205000             DP020-MSG-FATAL         TO TRUE                      20500000
205100             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           20510000
205200             MOVE DP015-UNP-ALP-BRT-OFF  TO ATRLRA                20520000
205300             MOVE DP015-RED              TO ATRLRC                20530000
205400             MOVE DP015-REVERSE          TO ATRLRH                20540000
205500             MOVE -1                     TO ATRLRL                20550000
205600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  20560000
205700         WHEN OTHER                                               20570000
205800             MOVE '7020-SCAC-BY-TRLR '     TO DP013-PARAGRAPH     20580025
205900             MOVE 'GET SCAC USING SRL NBR      '                  20590025
206000                                TO DP013-MESSAGE-TEXT (1)         20600000
206100             MOVE SQLCA   TO DP013-SQLCA                          20610000
206200             MOVE 'TCNTRID ' TO DP013-DB2-TABLE-NAME (1)          20620025
206300             SET DP013-DB2-ABEND                                  20630000
206400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20640000
206500             PERFORM DP013-0000-PROCESS-ABEND                     20650000
206600     END-EVALUATE.                                                20660000
206700                                                                  20670000
206800 7030-GET-SRL-NBR.                                                20680000
206900                                                                  20690000
207000     EXEC SQL                                                     20700000
207100         SELECT TRLR_SRL_NBR                                      20710000
207200         INTO :CNTRID-TRLR-SRL-NBR                                20720000
207300         FROM TCNTRID                                             20730000
207400         WHERE SCAC_CDE    =  :DK-SCAC-CDE                        20740000
207500         AND TRLR_ID     =  :DK-TRLR-ID                           20750000
207600     END-EXEC                                                     20760000
207700                                                                  20770000
207800     EVALUATE TRUE                                                20780000
207900         WHEN SQLCODE = ZERO                                      20790000
208000             CONTINUE                                             20800000
208100         WHEN SQLCODE = +100                                      20810000
208200             MOVE ZEROES         TO ASC-TRLR-SRL-NBR              20820000
208300             SET PS-ERROR                                         20830000
208400                 DP020-MSG-FATAL                                  20840000
208500                 DP030-SET-CURSOR-APPL-1 TO TRUE                  20850000
208600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             20860000
208700             MOVE DP015-UNP-ALP-BRT-OFF  TO ATRLRA                20870000
208800             MOVE DP015-RED              TO ATRLRC                20880000
208900             MOVE DP015-REVERSE          TO ATRLRH                20890000
209000             MOVE -1                     TO ATRLRL                20900000
209100         WHEN OTHER                                               20910000
209200             MOVE '7030-GET-SRL-NBR'           TO DP013-PARAGRAPH 20920000
209300             MOVE 'GET SRL NBR USING SCAC & TRLR'                 20930000
209400                                        TO DP013-MESSAGE-TEXT (1) 20940000
209500             MOVE SQLCA   TO DP013-SQLCA                          20950000
209600             MOVE 'TCNTRID ' TO DP013-DB2-TABLE-NAME (1)          20960000
209700             SET DP013-DB2-ABEND                                  20970000
209800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20980000
209900             PERFORM DP013-0000-PROCESS-ABEND                     20990000
210000     END-EVALUATE.                                                21000000
210100                                                                  21010000
210101                                                                  21010125
210102******************************************************************21010225
210103* DMH 1/29/13 ADDED                                              *21010325
210104* CHECK TO SEE IF THE BEGIN DIVERT HAS BEEN SET FOR THE DOOR BUT *21010425
210105* NOT THE END DIVERT.  ALSO GET THE CARTON DIVERT INFO TO BE     *21010525
210106* DISPLAYED IN THE ERROR MESSAGE ON THE SCREEN.                  *21010625
210107******************************************************************21010725
210110 7040-CHECK-BEGIN-DIVERT.                                         21011025
210120                                                                  21012025
210121     MOVE ASC-OPER-UNT-ID-N  TO  DK-OPER-UNT-ID.                  21012130
210125                                                                  21012530
210130     EXEC SQL                                                     21013025
210140          SELECT                                                  21014025
210150                 DATE(B.DIVERT_TMST)                              21015025
210151               , TIME(B.DIVERT_TMST)                              21015137
210160               , B.DIVERT_TMST                                    21016025
210170               , B.SHIPT_UNT_ID                                   21017025
210171            INTO :PV-DIVERT-DATE                                  21017125
210172               , :PV-DIVERT-TIME                                  21017237
210173               , :SUCRDV-DIVERT-TMST                              21017337
210174               , :SUCRDV-SHIPT-UNT-ID                             21017437
210180            FROM TSUCDOT A                                        21018025
210181               , TSUCRDV B                                        21018125
210182           WHERE A.OPER_UNT_ID          = :DK-OPER-UNT-ID         21018231
210183             AND A.DOOR_ID              = :ASC-DOOR-ID            21018325
210184             AND NOT A.STRT_DIVERT_TMST = :PC-DFLT-TMST           21018425
210185             AND A.END_DIVERT_TMST      = :PC-DFLT-TMST           21018525
210186             AND A.OPER_UNT_ID          =  B.OPER_UNT_ID          21018625
210187             AND A.DOOR_ID              =  B.DOOR_ID              21018725
210188             AND A.STRT_DIVERT_TMST     =  B.DIVERT_TMST          21018825
210189            WITH UR                                               21018925
210190     END-EXEC                                                     21019025
210191                                                                  21019125
210192     EVALUATE TRUE                                                21019225
210193         WHEN SQLCODE = ZERO                                      21019325
210194         WHEN SQLCODE = -811                                      21019425
210196             SET PS-ERROR                                         21019625
210197                 DP020-MSG-FATAL                                  21019725
210198                 DP030-SET-CURSOR-APPL-1 TO TRUE                  21019825
210199             MOVE SPACES TO PV-ERROR-INFO                         21019925
210200             MOVE SUCRDV-SHIPT-UNT-ID    TO PV-ERROR-SML          21020025
210201             MOVE ' DVRT ON '            TO PV-ERROR-FUNCTION     21020135
210202             MOVE PV-DIVERT-DATE         TO PV-ERROR-DATE         21020225
210203             MOVE '@'                    TO PV-ERROR-AT           21020339
210204             MOVE PV-DIVERT-TIME         TO PV-ERROR-TIME         21020439
210205             MOVE PC-TSYMSG-03728        TO DP020-MSG-NUMBER      21020539
210206             MOVE PV-ERROR-INFO          TO DP020-MSG-TEXT        21020639
210207             MOVE DP015-UNP-ALP-BRT-OFF  TO ADOORA                21020739
210208             MOVE DP015-RED              TO ADOORC                21020839
210209             MOVE DP015-REVERSE          TO ADOORH                21020939
210210             MOVE -1                     TO ADOORL                21021039
210211         WHEN SQLCODE = +100                                      21021139
210212             CONTINUE                                             21021239
210213         WHEN OTHER                                               21021339
210214             MOVE '7040-CHECK-BEGIN-DIVERT'    TO DP013-PARAGRAPH 21021439
210215             MOVE 'HAS BEGIN DIVERT BEEN SET    '                 21021539
210216                                        TO DP013-MESSAGE-TEXT (1) 21021639
210217             MOVE SQLCA   TO DP013-SQLCA                          21021739
210218             MOVE 'TSUCDOT ' TO DP013-DB2-TABLE-NAME (1)          21021839
210219             MOVE 'TSUCRDV ' TO DP013-DB2-TABLE-NAME (2)          21021939
210220             SET DP013-DB2-ABEND                                  21022039
210221                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21022139
210222             PERFORM DP013-0000-PROCESS-ABEND                     21022239
210223     END-EVALUATE.                                                21022339
210224                                                                  21022439
210230*----------------------------------------------------------------*21023025
210300*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *21030000
210400*----------------------------------------------------------------*21040000
210500 8000-MOVE-COMMAREA-TO-SCREEN.                                    21050000
210600     MOVE ASC-CURR-OPER-UNT-ID-N   TO ACROPRO.                    21060000
210700     MOVE ASC-CURR-OPER-NAME       TO ACRNMEO.                    21070000
210800     MOVE ASC-OPER-UNT-ID-N        TO AOPERO.                     21080000
210900     MOVE ASC-OPER-NAME            TO AOPRNMEO.                   21090000
211000     MOVE ASC-DOOR-ID              TO ADOORO.                     21100000
211100     MOVE ASC-DOOR-DESC            TO ADRLOCO.                    21110000
211200                                                                  21120000
211300     IF ASC-SHUTTLE > SPACES                                      21130000
211400         MOVE 'X'                  TO ADRTP1O                     21140000
211500     ELSE                                                         21150000
211600         MOVE SPACES               TO ADRTP1O                     21160000
211700     END-IF                                                       21170000
211800                                                                  21180000
211900     IF ASC-SHIPPING > SPACES                                     21190000
212000         MOVE 'X'                  TO ADRTP2O                     21200000
212100     ELSE                                                         21210000
212200         MOVE SPACES               TO ADRTP2O                     21220000
212300     END-IF                                                       21230000
212400                                                                  21240000
212500     IF ASC-RECEIVING > SPACES                                    21250000
212600         MOVE 'X'                  TO ADRTP3O                     21260000
212700     ELSE                                                         21270000
212800         MOVE SPACES               TO ADRTP3O                     21280000
212900     END-IF                                                       21290000
213000                                                                  21300000
213100     IF ASC-STORAGE > SPACES                                      21310000
213200         MOVE 'X'                  TO ADRTP4O                     21320000
213300     ELSE                                                         21330000
213400         MOVE SPACES               TO ADRTP4O                     21340000
213500     END-IF                                                       21350000
213600                                                                  21360000
213700     IF ASC-STRIPPING > SPACES                                    21370000
213800         MOVE 'X'                  TO ADRTP5O                     21380000
213900     ELSE                                                         21390000
214000         MOVE SPACES               TO ADRTP5O                     21400000
214100     END-IF                                                       21410000
214200                                                                  21420000
214300     IF ASC-YARD > SPACES                                         21430000
214400         MOVE 'X'                  TO ADRTP6O                     21440000
214500     ELSE                                                         21450000
214600         MOVE SPACES               TO ADRTP6O                     21460000
214700     END-IF                                                       21470000
214800                                                                  21480000
214900     IF ASC-DCOPEN > SPACES                                       21490000
215000         MOVE 'X'                  TO ATRST1O                     21500000
215100     ELSE                                                         21510000
215200         MOVE SPACES               TO ATRST1O                     21520000
215300     END-IF                                                       21530000
215400                                                                  21540000
215500     IF ASC-DCCLOSED > SPACES                                     21550000
215600         MOVE 'X'                  TO ATRST2O                     21560000
215700     ELSE                                                         21570000
215800         MOVE SPACES               TO ATRST2O                     21580000
215900     END-IF                                                       21590000
216000                                                                  21600000
216100     IF ASC-SHIPPED > SPACES                                      21610000
216200         MOVE 'X'                  TO ATRST3O                     21620000
216300     ELSE                                                         21630000
216400         MOVE SPACES               TO ATRST3O                     21640000
216500     END-IF                                                       21650000
216600                                                                  21660000
216700     IF ASC-AUDIT > SPACES                                        21670000
216800         MOVE 'X'                  TO ATRST4O                     21680000
216900     ELSE                                                         21690000
217000         MOVE SPACES               TO ATRST4O                     21700000
217100     END-IF                                                       21710000
217200                                                                  21720000
217300     IF ASC-STOREOPEN > SPACES                                    21730000
217400         MOVE 'X'                  TO ATRST5O                     21740000
217500     ELSE                                                         21750000
217600         MOVE SPACES               TO ATRST5O                     21760000
217700     END-IF                                                       21770000
217800                                                                  21780000
217900     IF ASC-STOREUNLOADED > SPACES                                21790000
218000         MOVE 'X'                  TO ATRST6O                     21800000
218100     ELSE                                                         21810000
218200         MOVE SPACES               TO ATRST6O                     21820000
218300     END-IF                                                       21830000
218400                                                                  21840000
218500     IF ASC-TRLR-SRL-NBR-X > SPACES                               21850000
218600        PERFORM 3000C-TRLR-SRL-NBR                                21860000
218700     END-IF.                                                      21870000
218800                                                                  21880000
218900     MOVE ASC-TRLR-SRL-NBR         TO ATRLRO                      21890000
219000     MOVE ASC-SCAC-CODE            TO ASCACO.                     21900000
219100     MOVE ASC-TRLR-ID              TO ATRLIDO.                    21910000
219200                                                                  21920000
219300     MOVE ASC-STATUS-DAYS          TO ADAYSO                      21930000
219400     MOVE ASC-FROM-MM              TO AFDTMMO.                    21940000
219500     MOVE ASC-FROM-DD              TO AFDTDDO.                    21950000
219600     MOVE ASC-FROM-YY              TO AFDTCYO.                    21960000
219700     MOVE ASC-TO-MM                TO ATDTMMO.                    21970000
219800     MOVE ASC-TO-DD                TO ATDTDDO.                    21980000
219900     MOVE ASC-TO-YY                TO ATDTCYO.                    21990000
220000     MOVE ASC-CARTONS              TO ACRTNSO.                    22000000
220100                                                                  22010000
220200     IF  ASC-STORE-NBR  > ZEROES                                  22020000
220300         MOVE ASC-STORE-NBR        TO ASTDSTO                     22030000
220400         MOVE ASC-STORE-NAME       TO ASTDSCO                     22040000
220410         MOVE ASC-STR-DC-X         TO ASTRDCO                     22041062
220500     ELSE                                                         22050000
220600         MOVE SPACES               TO ASTDSTO                     22060000
220700                                      ASTDSCO                     22070000
220800     END-IF.                                                      22080000
220900                                                                  22090000
221000     MOVE ASC-OTBND-TRIP-ID        TO AOTRIPO                     22100000
221100                                                                  22110000
221110*ROOPA START                                                      22111054
221120     MOVE ASC-SCR-SHIP-N           TO ASHIPO                      22112054
221130*ROOPA END                                                        22113054
221200     MOVE ASC-TRLR-SEAL            TO ATRSELO.                    22120000
221300                                                                  22130000
221400*----------------------------------------------------------------*22140000
221500*    ABEND PROCESSOR MODULE                                      *22150000
221600*----------------------------------------------------------------*22160000
221700                                                                  22170000
221800     COPY DPPD013.                                                22180000
221900                                                                  22190000
