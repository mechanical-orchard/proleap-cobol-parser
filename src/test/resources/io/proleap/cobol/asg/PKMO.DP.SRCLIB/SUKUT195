       IDENTIFICATION DIVISION.                                         00010001
       PROGRAM-ID.    SUKUT195.                                         00020001
       AUTHOR.        JIM ARENDT.                                       00030001
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040001
       DATE-WRITTEN.  SEPTEMBER, 2017.                                  00050001
       DATE-COMPILED.                                                   00060001
      ******************************************************************00070001
      *  DB2                                                            00080001
      * EXTRACT  OF TRAILER CONTENT EXTRACT                             00090001
      ******************************************************************00100001
      * DATE: 09/2017 MADE BY:JIM ARENDT  INITIAL IMPLEMENTATION        00110001
      ******************************************************************00120001
       ENVIRONMENT DIVISION.                                            00130001
       CONFIGURATION SECTION.                                           00140001
       SOURCE-COMPUTER.    IBM-3090.                                    00150001
       OBJECT-COMPUTER.    IBM-3090.                                    00160001
       INPUT-OUTPUT SECTION.                                            00170001
       FILE-CONTROL.                                                    00180001
                                                                        00190001
           SELECT INPUT-TRAILER-FILE                                    00200001
                  ASSIGN TO INP01.                                      00210001
                                                                        00220001
           SELECT OUTPUT-DELIM-FILE                                     00230002
                  ASSIGN TO OUT01.                                      00240001
                                                                        00250001
                                                                        00260001
                                                                        00270001
       DATA DIVISION.                                                   00280001
       FILE SECTION.                                                    00290001
                                                                        00300001
       FD  INPUT-TRAILER-FILE                                           00310001
           RECORDING MODE IS F                                          00320001
           LABEL RECORDS OMITTED                                        00330001
           BLOCK CONTAINS 0 RECORDS                                     00340001
           DATA RECORD IS INPUT-TRAILER-REC.                            00350001
       01  INPUT-TRAILER-REC                   PIC  X(250).             00360004
                                                                        00370001
       FD  OUTPUT-DELIM-FILE                                            00380002
           RECORDING MODE IS F                                          00390001
           LABEL RECORDS OMITTED                                        00400001
           BLOCK CONTAINS 0 RECORDS                                     00410001
           DATA RECORD IS OUTPUT-DELIM-REC.                             00420002
       01  OUTPUT-DELIM-REC                    PIC  X(340).             00430002
                                                                        00440001
       WORKING-STORAGE SECTION.                                         00450001
                                                                        00460001
      ******************************************************************00470001
      * PROGRAM CONSTANTS                                               00480001
      ******************************************************************00490001
       01  PC-CONSTANTS-FIELDS.                                         00500001
           05  PC-PGM-NAME                     PIC  X(08) VALUE         00510001
                                                          'SUKUT195'.   00520001
           05  PC-MAX-RETRIES                  PIC S9(03) VALUE +3      00530001
                                                          COMP-3.       00540001
                                                                        00550001
      ******************************************************************00560001
      * PROGRAM VARIABLES                                               00570001
      ******************************************************************00580001
       01  PV-VARIABLE-FIELDS.                                          00590001
           05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  00600001
           05  PV-DB2-OPERATION                PIC  X(30) VALUE SPACE.  00610001
           05  PV-RETRY-COUNTER                PIC S9(04) VALUE ZEROS   00620001
                                                          COMP SYNC.    00630001
           05  PV-EDIT-FIELD                   PIC  ZZZ,ZZZ,ZZ9.        00640006
           05  PV-TIMESTAMP-DATE               PIC  X(10) VALUE SPACES. 00650001
           05  PV-TIMESTAMP-TIME               PIC  X(08) VALUE SPACES. 00660001
           05  PV-TIME  REDEFINES PV-TIMESTAMP-TIME.                    00670001
               10 PV-TIME-HH                   PIC  X(02).              00680001
               10 PV-TIME-COLON1               PIC  X(01).              00690001
               10 PV-TIME-MM                   PIC  X(02).              00700001
               10 PV-TIME-COLON2               PIC  X(01).              00710001
               10 PV-TIME-MM                   PIC  X(02).              00720001
                                                                        00730001
      ******************************************************************00740001
      * PROGRAM ACCUMULATORS                                            00750001
      ******************************************************************00760001
       01  PA-PROGRAM-ACCUMULATORS.                                     00770001
           05  PA-INPUT-RECORDS-READ           PIC  9(09) VALUE ZEROS.  00780002
           05  PA-OUTPUT-RECORDS-WROTE         PIC  9(09) VALUE ZEROS.  00790002
                                                                        00800001
      ******************************************************************00810001
      * PROGRAM SWITCHES                                                00820001
      ******************************************************************00830001
       01  PS-SWITCH-AREAS.                                             00840001
           05  PS-END-OF-INPUT-FILE-SW         PIC  X(01) VALUE 'N'.    00850001
               88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.    00860001
               88  PS-NOT-END-OF-FILE                     VALUE 'N'.    00870001
           05  PS-FIRST-TIME-SW                PIC  X(01) VALUE 'N'.    00880002
               88  PS-FIRST-TIME-Y                        VALUE 'Y'.    00890002
               88  PS-FIRST-TIME-N                        VALUE 'N'.    00900002
                                                                        00910001
      ******************************************************************00920001
      * ABEND INFORMATION                                               00930001
      ******************************************************************00940001
       01  ABEND-CODE                          PIC S9(04) VALUE ZEROS   00950001
                                                          COMP SYNC.    00960001
           88  ABEND-4001-WRITE-ERROR                     VALUE +4001.  00970001
           88  ABEND-4002-READ-ERROR                      VALUE +4002.  00980001
           88  ABEND-4003-CTRL-CARD-ERROR                 VALUE +4003.  00990001
           88  ABEND-4004-TABLE-ERROR                     VALUE +4004.  01000001
           88  ABEND-4005-OPEN-ERROR                      VALUE +4005.  01010001
           88  ABEND-4006-CLOSE-ERROR                     VALUE +4006.  01020001
           88  ABEND-4007-SEQUENCE-ERROR                  VALUE +4007.  01030001
           88  ABEND-4008-DATA-ERROR                      VALUE +4008.  01040001
           88  ABEND-4009-KEY-DATA-ERROR                  VALUE +4009.  01050001
           88  ABEND-4013-DB2-ERROR                       VALUE +4013.  01060001
           88  ABEND-4019-CAL-SUB-ERROR                   VALUE +4019.  01070001
           88  ABEND-4020-MQ-ERROR                        VALUE +4020.  01080001
           88  ABEND-4444-FORCED-ABEND                    VALUE +4444.  01090001
                                                                        01100001
      ******************************************************************01110001
                                                                        01120001
      ****ABEND ROUTINE INFORMATION                                     01130001
           COPY DPWS004.                                                01140001
                                                                        01150001
      ****INPUT COPYBOOK                                                01160002
           COPY SURD163.                                                01170001
                                                                        01180001
      ****OUTPUT COPYBOOK                                               01190002
           COPY SURD164.                                                01200002
                                                                        01210001
       PROCEDURE DIVISION.                                              01220001
      ******************************************************************01230001
       0000-MAINLINE-PROCESSING.                                        01240001
                                                                        01250001
           PERFORM 1000-INITIALIZATION.                                 01260001
                                                                        01270001
           PERFORM 2000-CREATE-EXTRACT-DATA                             01280001
             UNTIL PS-END-OF-INPUT-FILE.                                01290002
                                                                        01300001
           PERFORM 9000-WRAPUP.                                         01310001
           GOBACK.                                                      01320001
                                                                        01330001
      ******************************************************************01340001
      * INITIALIZATION ROUTINE                                          01350001
      ******************************************************************01360001
       1000-INITIALIZATION.                                             01370001
                                                                        01380001
           DISPLAY ' '.                                                 01390001
           DISPLAY '*******************************************'.       01400001
           DISPLAY '***  PROGRAM NAME:  '  PC-PGM-NAME.                 01410001
           DISPLAY ' '.                                                 01420001
                                                                        01430001
           OPEN INPUT  INPUT-TRAILER-FILE                               01440001
                OUTPUT OUTPUT-DELIM-FILE.                               01450002
                                                                        01460001
           PERFORM 1100-READ-INPUT-FILE.                                01470002
                                                                        01480001
      ******************************************************************01490001
      * READ A RECORD FROM THE INPUT TRAILER EXTRACT FILE               01500002
      ******************************************************************01510001
       1100-READ-INPUT-FILE.                                            01520002
                                                                        01530001
           READ INPUT-TRAILER-FILE INTO SU163-EXTRACT-RECORD            01540002
              AT END                                                    01550001
                 SET PS-END-OF-INPUT-FILE TO TRUE.                      01560001
                                                                        01570001
           IF PS-END-OF-INPUT-FILE                                      01580001
              IF PS-FIRST-TIME-Y                                        01590002
                 DISPLAY ' '                                            01600002
                 DISPLAY 'INPUT FILE IS EMPTY'                          01610002
                 DISPLAY ' '                                            01620002
              END-IF                                                    01630002
           ELSE                                                         01640005
              SET PS-FIRST-TIME-N          TO TRUE                      01650005
              ADD 1                        TO PA-INPUT-RECORDS-READ     01660005
           END-IF.                                                      01670002
                                                                        01680001
      ******************************************************************01690001
      * PROCESS THE INPUT RECORD                                        01700006
      ******************************************************************01710001
       2000-CREATE-EXTRACT-DATA.                                        01720001
                                                                        01730001
           PERFORM 2300-PROCESS-RECORDS.                                01740001
                                                                        01750001
           PERFORM 1100-READ-INPUT-FILE.                                01760002
                                                                        01770001
      ******************************************************************01780001
      * POPULATE THE OUTPUT RECORD                                      01790001
      ******************************************************************01800001
       2300-PROCESS-RECORDS.                                            01810001
                                                                        01820001
           INITIALIZE SU164-EXTRACT-RECORD.                             01830002
           MOVE SU163-ORGN-OPER-UNT-ID   TO SU164-ORGN-OPER-UNT-ID.     01840002
           MOVE SU163-DEST-OPER-UNT-ID   TO SU164-DEST-OPER-UNT-ID.     01850002
           MOVE SU163-OTBND-TRIP-ID      TO SU164-OTBND-TRIP-ID.        01860002
           MOVE SU163-TRIP-STAT-CDE      TO SU164-TRIP-STAT-CDE.        01870002
           MOVE SU163-E-BUS              TO SU164-E-BUS.                01880002
           MOVE SU163-SCAC-CDE           TO SU164-SCAC-CDE.             01890002
           MOVE SU163-TRLR-ID            TO SU164-TRLR-ID.              01900002
           MOVE SU163-TRLR-SRL-NBR       TO SU164-TRLR-SRL-NBR.         01910002
           MOVE SU163-TRIP-STAT-DATE     TO SU164-TRIP-STAT-DATE.       01920002
           MOVE SU163-TRIP-STAT-TIME     TO SU164-TRIP-STAT-TIME.       01930002
           MOVE SU163-WM-SHIPMT-ID       TO SU164-WM-SHIPMT-ID.         01940002
           MOVE SU163-SHIPT-UNIT-ID      TO SU164-SHIPT-UNIT-ID.        01950002
           MOVE SU163-SML-ORGN-LOC-NBR   TO SU164-SML-ORGN-LOC-NBR.     01960002
           MOVE SU163-SML-DEST-LOC-NBR   TO SU164-SML-DEST-LOC-NBR.     01970002
           MOVE SU163-CART-SRC-CDE       TO SU164-CART-SRC-CDE.         01980002
           MOVE SU163-SML-CRE-DTE        TO SU164-SML-CRE-DTE.          01990002
           MOVE SU163-SML-CRE-TM         TO SU164-SML-CRE-TM.           02000002
           MOVE SU163-ORIG-CART-ID       TO SU164-ORIG-CART-ID.         02010002
           MOVE SU163-ACTV-IND           TO SU164-ACTV-IND.             02020002
           MOVE SU163-MFST-TO-TRLR-TYPE  TO SU164-MFST-TO-TRLR-TYPE.    02030002
           MOVE SU163-MFST-DATE          TO SU164-MFST-DATE.            02040002
           MOVE SU163-MFST-TIME          TO SU164-MFST-TIME.            02050002
           MOVE SU163-STR-SCAN-DATE      TO SU164-STR-SCAN-DATE.        02060002
           MOVE SU163-STR-SCAN-TIME      TO SU164-STR-SCAN-TIME.        02070002
           MOVE SU163-STR-SCAN-LOC       TO SU164-STR-SCAN-LOC.         02080002
           MOVE SU163-STR-SCAN-TYPE-CDE  TO SU164-STR-SCAN-TYPE-CDE.    02090002
           MOVE SU163-STR-SCAN-ORIG-TRIP-ID                             02100002
                                         TO SU164-STR-SCAN-ORIG-TRIP-ID.02110002
           MOVE SU163-STR-SCAN-FR-MSTR-IND                              02120002
                                         TO SU164-STR-SCAN-FR-MSTR-IND. 02130002
           MOVE SU163-TRN-NBR            TO SU164-TRN-NBR.              02140002
           MOVE SU163-RCVR-SEQ-NBR       TO SU164-RCVR-SEQ-NBR.         02150002
           MOVE SU163-TRN-LNE-NBR        TO SU164-TRN-LNE-NBR.          02160002
           MOVE SU163-TRN-TYP-CDE        TO SU164-TRN-TYP-CDE.          02170002
           MOVE SU163-SHPD-UNT-QTY       TO SU164-SHPD-UNT-QTY.         02180002
           MOVE SU163-SKU-NBR            TO SU164-SKU-NBR.              02190002
           MOVE SU163-SEASET-YR          TO SU164-SEASET-YR.            02200002
           MOVE SU163-SEASET-SHRT-NM     TO SU164-SEASET-SHRT-NM.       02210002
           MOVE ','                      TO SU164-COMMA-01              02220003
                                            SU164-COMMA-02              02230003
                                            SU164-COMMA-03              02240003
                                            SU164-COMMA-04              02250003
                                            SU164-COMMA-05              02260003
                                            SU164-COMMA-06              02270003
                                            SU164-COMMA-07              02280003
                                            SU164-COMMA-08              02290003
                                            SU164-COMMA-09              02300003
                                            SU164-COMMA-10              02310003
                                            SU164-COMMA-11              02320003
                                            SU164-COMMA-12              02330003
                                            SU164-COMMA-13              02340003
                                            SU164-COMMA-14              02350003
                                            SU164-COMMA-15              02360003
                                            SU164-COMMA-16              02370003
                                            SU164-COMMA-17              02380003
                                            SU164-COMMA-18              02390003
                                            SU164-COMMA-19              02400003
                                            SU164-COMMA-20              02410003
                                            SU164-COMMA-21              02420003
                                            SU164-COMMA-22              02430003
                                            SU164-COMMA-23              02440003
                                            SU164-COMMA-24              02450003
                                            SU164-COMMA-25              02460003
                                            SU164-COMMA-26              02470003
                                            SU164-COMMA-27              02480003
                                            SU164-COMMA-28              02490003
                                            SU164-COMMA-29              02500003
                                            SU164-COMMA-30              02510003
                                            SU164-COMMA-31              02520003
                                            SU164-COMMA-32              02530003
                                            SU164-COMMA-33              02540003
                                            SU164-COMMA-34              02550003
                                            SU164-COMMA-35              02560003
                                            SU164-COMMA-36.             02570003
                                                                        02580002
           PERFORM 4000-WRITE-OUTPUT-DELIM-REC.                         02590002
                                                                        02600001
      ******************************************************************02610001
      * WRITE OUTPUT COMMA DELIMITED FILE                               02620002
      ******************************************************************02630001
       4000-WRITE-OUTPUT-DELIM-REC.                                     02640002
                                                                        02650001
           WRITE OUTPUT-DELIM-REC FROM SU164-EXTRACT-RECORD.            02660002
                                                                        02670001
           ADD +1              TO PA-OUTPUT-RECORDS-WROTE.              02680003
                                                                        02690001
      ******************************************************************02700001
      * CLOSE INPUT/OUTPUT FILES AND DISPLAY PROGRAM COUNTS             02710001
      ******************************************************************02720001
       9000-WRAPUP.                                                     02730001
                                                                        02740001
           CLOSE INPUT-TRAILER-FILE                                     02750001
                 OUTPUT-DELIM-FILE.                                     02760002
                                                                        02770001
           PERFORM 9100-DISPLAY-COUNTS.                                 02780001
                                                                        02790001
      ******************************************************************02800001
      * DISPLAY PROGRAM COUNTS                                          02810001
      ******************************************************************02820001
       9100-DISPLAY-COUNTS.                                             02830001
                                                                        02840001
           MOVE PA-INPUT-RECORDS-READ             TO PV-EDIT-FIELD.     02850002
           DISPLAY ' INPUT RECORDS READ.....: '      PV-EDIT-FIELD.     02860005
                                                                        02870001
           MOVE PA-OUTPUT-RECORDS-WROTE           TO PV-EDIT-FIELD.     02880002
           DISPLAY ' OUTPUT RECORDS WROTE...: '      PV-EDIT-FIELD.     02890002
                                                                        02900001
           DISPLAY ' '.                                                 02910001
           DISPLAY '*******************************************'.       02920001
           DISPLAY ' '.                                                 02930001
