000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.             PMKRP120.                                00030000
000400 AUTHOR.                 AMANDA NEWHART                           00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN.           FEBRUARY 2003.                           00060000
000700 DATE-COMPILED.                                                   00070000
000800******************************************************************00080000
000900*                                                                *00090000
001000*    PMKRP120 - SALES REPORTING AD EVENT SUMMARY EXTRACT.        *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM PRINTS AD EVENT SUMMARY - BUYER DEPT TOTALS.   *00120000
001300*    OPEN THE TWO INPUT FILES AND ONE OUTPUT FILE.  READ BOTH    *00130000
001400*    CONTROL CARDS AND MOVE THE DATE TO VARIABLES AND THE STORE  *00140000
001500*    COUNT TO A HEADER LINE.  LOG ON TO ORACLE.  IF UNSUCCESSFUL *00150000
001600*    ABEND OTHERWISE, FIND THE CURRENT SYS DATE AND THE END      *00160000
001700*    DATE.  THE END DATE IS FOUND BY TAKING THE RUN DATE FROM    *00170000
001800*    THE CC AND SUBTRACTING THE NUMBER OF DAYS PASSED IN THROUGH *00180000
001900*    THE CC.  ONCE THE END DATE IS FOUND CONCATENATE A           *00190000
002000*    BEGINING AND END TIMESTAMP.  NEXT TAKE THE END TIMESTAMP    *00200000
002100*    AND FIND THE AD EVENTS THAT END ON THAT DAY.  IF THERE ARE  *00210000
002200*    NONE THEN A REPORT WILL NOT BE PRINTED.  ALTHOUGH IF ONE    *00220000
002300*    FOUND THEN FIND THE ACTUAL AND FORECASTED ADEVENT TOTALS.   *00230000
002400*    THEN RETRIEVE A LIST OF GMA'S, DMA'S BUYERS AND DPTS.  FIND *00240000
002500*    THE GMA'S ACTUAL AND FORECASTED TOTALS.  IF THIS IS THE     *00250000
002600*    FIRST BUYER IN THE LIST THEN FIND ALL THE PROMOS TIED TO AN *00260000
002700*    ADEVENT AND STORE THEM ON A TEMP TABLE.  NEXT FIND THE      *00270000
002800*    ACTUAL AND FORECASTED TOTALS OF THE DMA FOR EACH PROMO.     *00280000
002900*    ONCE THAT IS DONE DO THE SAME THING FOR THE DPT.  WHEN DONE *00290000
003000*    FIND THE NEXT BUYER DPT COMBO FROM THE LIST.  SINCE THIS    *00300000
003100*    IS NOT THE FIRST BUYER IN THE AD EVENT AND THE NEXT BUYER   *00310000
003200*    EQUALS THE PREVIOUS BUYER DO THE DPT SEARCHED AGAIN.  IF    *00320000
003300*    THE NEXT BUYER IS NOT EQUAL TO THE PREVIOUS BUYER THEN      *00330000
003400*    PROCESS THE PREVIOUS BUYER TOTALS AND ADVANCE A PAGE TO     *00340000
003500*    START THE PROCESS WITH THE NEW BUYER.  WHEN THE LAST GMA,   *00350000
003600*    DMA, BUYER, DEPARTMENT HAS BEEN PROCESSED CHECK TO SEE IF   *00360000
003700*    THERE IS ANOTHER AD EVENT.  IF SO THEN REPEAT PROCESS       *00370000
003800*    AGAIN ANDCREATE ANOTHER REPORT.  ONCE ALL THE AD EVENTS     *00380000
003900*    HAVE BEEN DONE CLOSE THE TWO INPUT FILES AND THE REPORT.    *00390000
004000*                                                                *00400000
004100******************************************************************00410000
004200**   CHANGE LOG:                                                 *00420000
004300******************************************************************00430000
004400*    MM/DD/YYYY - NAME HERE - WR NO. HERE                        *00440000
004500*                                                                *00450000
004600*    06/25/2003 - AMANDA NEWHART - INITIAL VERSION               *00460000
004700*                                                                *00470000
004800*    08/10/2003 - COLLEEN CUMMINGS - P000573968                  *00480000
004900*    ORA-01457: CONVERTING COLUMN OVERFLOWS DECIMAL DATATYPE -   *00490000
005000*    IN C105-.  CHANGED PV-ACT-ADEVNT-PREP-UNIT FROM             *00500000
005100*    PIC S9(08)V9(02) COMP-3 TO BE S9(09)V9(02) COMP-3.          *00510000
005200*                                                                *00520000
005300*    08/10/2003 - COLLEEN CUMMINGS - P000573968                  *00530000
005400*    ORA-01457: CONVERTING COLUMN OVERFLOWS DECIMAL DATATYPE -   *00540000
005500*    IN C105-.  CHANGED ALL OTHER PV-ACT-ADEVNT UP TO ALLOW MORE *00550000
005600*    SPACES.                                                     *00560000
005700*                                                                *00570000
005800*    08/10/2003 - COLLEEN CUMMINGS - P000573968                  *00580000
005900*    ORA-01457: CONVERTING COLUMN OVERFLOWS DECIMAL DATATYPE -   *00590000
006000*    IN C105-.  INCREASED THEM ALL TO S9(16)V9(02) BECAUSE THESE *00600000
006100*    ALL TOTAL WERE TOO LARGE.                                   *00610000
006200*    (FINALLY FIGURED THIS OUT AFTER I CAME IN AND ACTUALLY RAN  *00620000
006300*     THE QUERY!)                                                *00630000
006400*                                                                *00640000
006500*    08/11/2003 - AMANDA NEWHART   - P000573961                  *00650000
006600*    NEEDED TO ADD A MOVE 0 TO THE LINE COUNT WHEN IN W300.      *00660000
006700*    THE DATA WAS LOOPING AND EXCEEDIN THE FILE LENGTH.          *00670000
006800*                                                                *00680000
006900*    08/19/2003 - COLLEEN CUMMINGS - WR21770                     *00690000
007000*    CHANGED 'UNADVERTISED ITEM' TO READ 'UNADVERTISED ITEMS',   *00700000
007100*    PER WAYNE.                                                  *00710000
007200*                                                                *00720008
007300*    05/30/2004 - COLLEEN CUMMINGS - P000660139                  *00730003
007400*    ADDED ACT-ADEVNT NULL FIELDS TO C105- CURSOR STATEMENT -    *00740002
007500*    DUE TO ABEND 'ORA 1405 -FETCHED COLUMN VALUE IS NULL'.      *00750005
007600*                                                                *00760005
007700*    07/19/2004 - COLLEEN CUMMINGS - P000673045                  *00770007
007800*    ADDED STATEMENT TO TURN CURSOR SHARING ON.                  *00780005
007900*    DO A FIND ON 'EXACT' DUE TO ORACLE 3113.                    *00790005
598092*                                                                *00791017
598092*    11/16/2008 - DARYL STEWART - INC000000598092                *00792017
598092*    INCREASED TALBES FROM 20 TO 100                             *00793019
598092*    PV-ALL-PROMO-TABLE AND PV-ALL-DMA-PROMO-TABLE               *00794017
070941*                                                                *00794124
070941*    07/30/2018 - COGNIZANT - CHG0204126                         *00794224
070941*    ORACLE LOGON STANDARDS PROGRAM CHANGE                       *00794324
070941******************************************************************00800024
008100 ENVIRONMENT DIVISION.                                            00810000
008200 CONFIGURATION SECTION.                                           00820000
008300 SOURCE-COMPUTER. IBM-3090.                                       00830000
008400 OBJECT-COMPUTER. IBM-3090.                                       00840000
008500                                                                  00850000
008600 INPUT-OUTPUT SECTION.                                            00860000
008700 FILE-CONTROL.                                                    00870000
008800                                                                  00880000
008900     SELECT CONTROL-CARD-1                                        00890000
009000         ASSIGN                       TO INP01.                   00900000
009100                                                                  00910000
070941     SELECT ORACLE-LOGON-FILE                                     00911020
070941         ASSIGN                       TO ORALOGON.                00912020
070941                                                                  00919220
009200     SELECT AD-EVNT-SUMM-REPORT                                   00929000
009300         ASSIGN                       TO RPT01.                   00930000
009400                                                                  00940000
009500 DATA DIVISION.                                                   00950000
009600                                                                  00960000
009700 FILE SECTION.                                                    00970000
009800                                                                  00980000
009900 FD  CONTROL-CARD-1                                               00990000
010000     RECORDING MODE F                                             01000000
010100     BLOCK CONTAINS 0 RECORDS                                     01010000
010200     LABEL RECORDS ARE OMITTED.                                   01020000
010300 01  CONTROL-CARD-LINE-1              PIC  X(80).                 01030000
010400                                                                  01040000
070941 FD  ORACLE-LOGON-FILE                                            01041020
070941     RECORDING MODE IS F                                          01042020
070941     LABEL RECORDS ARE STANDARD                                   01043020
070941     BLOCK CONTAINS 0 RECORDS                                     01044020
070941     RECORD CONTAINS 80 CHARACTERS                                01045020
070941     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      01046020
070941 01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       01047020
070941                                                                  01048021
010500 FD  AD-EVNT-SUMM-REPORT                                          01050000
010600     RECORDING MODE F                                             01060000
010700     BLOCK CONTAINS 0 RECORDS                                     01070000
010800     LABEL RECORDS ARE OMITTED.                                   01080000
010900 01  AD-EVNT-SUMM-RPT-LINE            PIC X(200).                 01090000
011000                                                                  01100000
011100 WORKING-STORAGE SECTION.                                         01110000
011200                                                                  01120000
011300 01  ABEND-CODE                       PIC S9(04)   COMP VALUE +0. 01130000
011400     88  ABEND-4001-WRITE-ERROR                    VALUE +4001.   01140000
011500     88  ABEND-4002-READ-ERROR                     VALUE +4002.   01150000
011600     88  ABEND-4003-CTRL-CARD-ERROR                VALUE +4003.   01160000
011700     88  ABEND-4004-TABLE-ERROR                    VALUE +4004.   01170000
011800     88  ABEND-4005-OPEN-ERROR                     VALUE +4005.   01180000
011900     88  ABEND-4006-CLOSE-ERROR                    VALUE +4006.   01190000
012000     88  ABEND-4007-SEQUENCE-ERROR                 VALUE +4007.   01200000
012100     88  ABEND-4008-DATA-ERROR                     VALUE +4008.   01210000
012200     88  ABEND-4009-KEY-DATA-ERROR                 VALUE +4009.   01220000
012300     88  ABEND-4013-DB2-ERROR                      VALUE +4013.   01230000
012400     88  ABEND-4014-ORACLE-LOGON-ERROR             VALUE +4014.   01240000
012500     88  ABEND-4019-DATE-ROUTINE-ERROR             VALUE +4019.   01250000
012600     88  ABEND-4444-FORCED-ABEND                   VALUE +4444.   01260000
012700                                                                  01270000
012800 01  CC-CONTROL-CARD.                                             01280000
012900     05  CC-RUN-DATE                  PIC X(08).                  01290000
013000     05  FILLER                       PIC X(01).                  01300000
013100     05  CC-SUB-DAYS                  PIC 9(04).                  01310000
013200                                                                  01320000
013300 01  PS-PROGRAM-SWITCHES.                                         01330000
013400     05  PS-CONTROL-CARD-SW           PIC  X(01)  VALUE 'N'.      01340000
013500         88  PS-CONTROL-CARD-END                  VALUE 'Y'.      01350000
013600         88  PS-CONTROL-CARD-START                VALUE 'N'.      01360000
013700     05  PS-END-OF-ADEVNT-CSR-SWITCH  PIC  X(01)  VALUE 'N'.      01370000
013800         88  PS-END-OF-ADEVNT-CSR                 VALUE 'Y'.      01380000
013900         88  PS-NOT-END-OF-ADEVNT-CSR             VALUE 'N'.      01390000
014000     05  PS-END-OF-BUYER-CSR-SWITCH   PIC  X(01)  VALUE 'N'.      01400000
014100         88  PS-END-OF-BUYER-CSR                  VALUE 'Y'.      01410000
014200         88  PS-NOT-END-OF-BUYER-CSR              VALUE 'N'.      01420000
014300     05  PS-END-OF-PROMO-CSR-SWITCH   PIC  X(01)  VALUE 'N'.      01430000
014400         88  PS-END-OF-PROMO-CSR                  VALUE 'Y'.      01440000
014500         88  PS-NOT-END-OF-PROMO-CSR              VALUE 'N'.      01450000
014600     05  PS-END-OF-ACT-DMA-CSR-SWITCH PIC  X(01)  VALUE 'N'.      01460000
014700         88  PS-END-OF-ACT-DMA-CSR                VALUE 'Y'.      01470000
014800         88  PS-NOT-END-OF-ACT-DMA-CSR            VALUE 'N'.      01480000
014900     05  PS-END-OF-ACT-DPT-CSR-SWITCH PIC  X(01)  VALUE 'N'.      01490000
015000         88  PS-END-OF-ACT-DPT-CSR                VALUE 'Y'.      01500000
015100         88  PS-NOT-END-OF-ACT-DPT-CSR            VALUE 'N'.      01510000
015200     05  PS-END-OF-ACT-BYR-CSR-SWITCH PIC  X(01)  VALUE 'N'.      01520000
015300         88  PS-END-OF-ACT-BYR-CSR                VALUE 'Y'.      01530000
015400         88  PS-NOT-END-OF-ACT-BYR-CSR            VALUE 'N'.      01540000
015500     05  PS-DMA-PROMO-TOT-EXIST-SWITCH PIC  X(01) VALUE 'N'.      01550000
015600         88  PS-DMA-PROMO-TOT-EXIST               VALUE 'Y'.      01560000
015700         88  PS-DMA-PROMO-TOT-NOT-EXIST           VALUE 'N'.      01570000
015800     05  PS-DPT-PROMO-TOT-EXIST-SWITCH PIC  X(01) VALUE 'N'.      01580000
015900         88  PS-DPT-PROMO-TOT-EXIST               VALUE 'Y'.      01590000
016000         88  PS-DPT-PROMO-TOT-NOT-EXIST           VALUE 'N'.      01600000
016100     05  PS-DPT-TOT-COMPUTE-SWITCH     PIC  X(01) VALUE 'N'.      01610000
016200         88  PS-DPT-TOT-COMPUTE                   VALUE 'Y'.      01620000
016300         88  PS-DPT-TOT-NOT-COMPUTE               VALUE 'N'.      01630000
016400     05  PS-BYR-PROMO-TOT-EXIST-SWITCH PIC  X(01) VALUE 'N'.      01640000
016500         88  PS-BYR-PROMO-TOT-EXIST               VALUE 'Y'.      01650000
016600         88  PS-BYR-PROMO-TOT-NOT-EXIST           VALUE 'N'.      01660000
016700     05  PS-BYR-TOT-EXIST-SWITCH       PIC  X(01) VALUE 'N'.      01670000
016800         88  PS-BYR-TOT-EXIST                     VALUE 'Y'.      01680000
016900         88  PS-BYR-TOT-NOT-EXIST                 VALUE 'N'.      01690000
017000     05  PS-TYPE                       PIC X(01).                 01700000
017100         88  PS-CLRNC-TYP                         VALUE 'C'.      01710000
017200         88  PS-REG-TYP                           VALUE 'R'.      01720000
070941     05  PS-END-OF-LOGON-FILE-SW       PIC X(1)   VALUE 'N'.      01721021
070941         88  PS-END-OF-LOGON-FILE                 VALUE 'Y'.      01722020
070941     05  PS-ORA-SRC-CTL-DONE-SW        PIC X(1)   VALUE 'N'.      01723021
070941         88  PS-ORA-SRC-EMPTY                     VALUE 'Y'.      01724020
070941                                                                  01725020
070941 01  CC-ORACLE-CONNECTION.                                        01726020
070941     05  CC-ORACLE-USERID              PIC X(40).                 01727021
070941         88 CC-AUTO-LOGON                         VALUE '/'.      01728020
070941     05  CC-ORACLE-PASSWORD            PIC X(40).                 01729021
070941                                                                  01729120
017300                                                                  01730000
017400 01  PC-PROGRAM-CONSTANTS.                                        01740000
017500     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)  VALUE           01750000
017600                                                     'PMKRP120'.  01760000
017700     05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  01770000
017800     05  PC-SPACE                     PIC  X(01)  VALUE ' '.      01780000
017900     05  PC-BEG-TMST                  PIC  X(08)  VALUE           01790000
018000                                                    '00:00:00'.   01800000
018100     05  PC-END-TMST                  PIC  X(08)  VALUE           01810000
018200                                                    '23:59:59'.   01820000
018300                                                                  01830000
018400 01  PV-PROGRAM-VARIABLES.                                        01840000
070941     05  PV-ORACLE-USERID-LEN         PIC S9(4) VALUE ZEROS       01841021
070941                                              COMP SYNC.          01842020
070941     05  PV-ORACLE-PASSWORD-LEN       PIC S9(4) VALUE ZEROS       01843021
070941                                              COMP SYNC.          01844020
018500     05  PV-ADVANCE-LINES             PIC S9(04) VALUE +1 COMP.   01850000
018600     05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   01860000
018700     05  PV-FUTURE-LINE-CNT           PIC S9(04) VALUE +0 COMP.   01870000
018800     05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         01880000
018900     05  PV-SQL                       PIC S9(04)  VALUE ZEROS.    01890000
019000     05  PV-TABLE-NAME                PIC  X(12)  VALUE SPACES.   01900000
019100     05  PV-OPERATION-MSG             PIC  X(60)  VALUE SPACES.   01910000
019200     05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACES.   01920000
019300     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACES.   01930000
019400     05  PV-RPT-LINE                  PIC  X(200) VALUE SPACES.   01940000
019500     05  PV-PROMO-IDX                 PIC  9(04)  VALUE ZEROS.    01950000
019600     05  PV-DMA-PROMO-IDX             PIC  9(04)  VALUE ZEROS.    01960000
019700     05  PV-INDEX                     PIC  9(04)  VALUE ZEROS.    01970000
019800     05  PV-DMM-HEADER-INDEX          PIC  9(04)  VALUE ZEROS.    01980000
019900     05  PV-SRCH-INDX                 PIC  9(04)  VALUE ZEROS.    01990000
020000     05  PV-DPT-INDEX                 PIC  9(04)  VALUE ZEROS.    02000000
020100     05  PV-PREV-BYR-NBR              PIC  9(04)  VALUE ZEROS.    02010000
020200     05  PV-END-DATE                  PIC  X(10)  VALUE SPACES.   02020000
020300     05  PV-END-DATE-STRT-TMST        PIC  X(20)  VALUE SPACES.   02030000
020400     05  PV-END-DATE-END-TMST         PIC  X(20)  VALUE SPACES.   02040000
020500     05  PV-ORIG-SYS-DATE             PIC  X(26)  VALUE SPACES.   02050000
020600     05  PV-SYS-DATE.                                             02060000
020700         10  PV-SYS-CC                PIC  9(02)  VALUE ZERO.     02070000
020800         10  PV-SYS-YR                PIC  9(02)  VALUE ZERO.     02080000
020900         10  FILLER                   PIC  X(01)  VALUE SPACE.    02090000
021000         10  PV-SYS-MO                PIC  9(02)  VALUE ZERO.     02100000
021100         10  FILLER                   PIC  X(01)  VALUE SPACE.    02110000
021200         10  PV-SYS-DY                PIC  9(02)  VALUE ZERO.     02120000
021300         10  FILLER                   PIC  X(01)  VALUE SPACE.    02130000
021400         10  PV-SYS-HR                PIC  9(02)  VALUE ZERO.     02140000
021500         10  FILLER                   PIC  X(01)  VALUE SPACE.    02150000
021600         10  PV-SYS-MIN               PIC  9(02)  VALUE ZERO.     02160000
021700         10  FILLER                   PIC  X(01)  VALUE SPACE.    02170000
021800         10  PV-SYS-SEC               PIC  9(02)  VALUE ZEROES.   02180000
021900         10  FILLER                   PIC  X(01)  VALUE SPACE.    02190000
022000         10  PV-SYS-TIME              PIC  9(02)  VALUE ZEROS.    02200000
022100                                                                  02210000
022200     05  PV-SYS-DATE-GREG.                                        02220000
022300         10  PV-SYS-MM-GREG           PIC 9(02)  VALUE ZEROES.    02230000
022400         10  PV-SYS-DD-GREG           PIC 9(02)  VALUE ZEROES.    02240000
022500         10  PV-SYS-YY-GREG           PIC 9(02)  VALUE ZEROES.    02250000
022600                                                                  02260000
022700     05  PV-SYS-DATE-ISO              PIC X(10)  VALUE SPACES.    02270000
022800                                                                  02280000
022900 01  PV-AD-EVNT-VARIABLES.                                        02290000
023000     05  PV-AD-EVNT-ID                PIC  9(10)  VALUE ZEROS.    02300000
023100     05  PV-AD-EVNT-NBR-TXT           PIC  X(15)  VALUE SPACES.   02310000
023200     05  PV-CPLT-NM                   PIC  X(40)  VALUE SPACES.   02320000
023300                                                                  02330000
023400 01  PV-AD-EVNT-TOTALS.                                           02340000
023500     05  PV-ACT-ADEVNT-SLS-VOL        PIC S9(16)V9(02) COMP-3.    02350000
023600     05  PV-FCST-ADEVNT-SLS-VOL       PIC S9(16)V9(02) COMP-3.    02360000
023700     05  PV-ACT-ADEVNT-MKDN-DOL       PIC S9(16)V9(02) COMP-3.    02370000
023800     05  PV-FCST-ADEVNT-MKDN-DOL      PIC S9(16)V9(02) COMP-3.    02380000
023900     05  PV-ACT-ADEVNT-UNIT-SOLD      PIC S9(16)V9(02) COMP-3.    02390000
024000     05  PV-FCST-ADEVNT-UNIT-SOLD     PIC S9(16)V9(02) COMP-3.    02400000
024100     05  PV-ACT-ADEVNT-PREP-UNITS     PIC S9(16)V9(02) COMP-3.    02410000
024200     05  PV-FCST-ADEVNT-PREP-UNITS    PIC S9(16)V9(02) COMP-3.    02420000
024300     05  PV-ACT-ADEVNT-SLS-COST       PIC S9(16)V9(02) COMP-3.    02430000
024400     05  PV-FCST-ADEVNT-SLS-COST      PIC S9(16)V9(02) COMP-3.    02440000
024500     05  PV-ACT-ADEVNT-MKUP-PCT       PIC S9(16)V9(02) COMP-3.    02450000
024600     05  PV-FCST-ADEVNT-MKUP-PCT      PIC S9(16)V9(02) COMP-3.    02460000
024700     05  PV-FCST-ADEVNT-SLS-VOL-NULL   PIC S9(04)     VALUE ZERO  02470000
024800                                                       COMP.      02480000
024900     05  PV-FCST-ADEVNT-MKDN-DOL-NULL  PIC S9(04)     VALUE ZERO  02490000
025000                                                       COMP.      02500000
025100     05  PV-FCST-ADEVNT-UNIT-SOLD-NULL PIC S9(04)     VALUE ZERO  02510000
025200                                                       COMP.      02520000
025300     05  PV-FCST-ADEVNT-PREP-UNITS-NULL PIC S9(04)     VALUE ZERO 02530000
025400                                                       COMP.      02540000
025500     05  PV-FCST-ADEVNT-SLS-COST-NULL PIC S9(04)     VALUE ZERO   02550000
025600                                                       COMP.      02560000
025700     05  PV-FCST-ADEVNT-MKUP-PCT-NULL PIC S9(04)     VALUE ZERO   02570000
025800                                                       COMP.      02580000
025900     05  PV-ACT-ADEVNT-SLS-VOL-NULL   PIC S9(04)     VALUE ZERO   02590002
026000                                                       COMP.      02600002
026100     05  PV-ACT-ADEVNT-MKDN-DOL-NULL  PIC S9(04)     VALUE ZERO   02610002
026200                                                       COMP.      02620002
026300     05  PV-ACT-ADEVNT-UNIT-SOLD-NULL PIC S9(04)     VALUE ZERO   02630002
026400                                                       COMP.      02640002
026500     05  PV-ACT-ADEVNT-PREP-UNITS-NULL PIC S9(04)     VALUE ZERO  02650002
026600                                                       COMP.      02660002
026700     05  PV-ACT-ADEVNT-SLS-COST-NULL PIC S9(04)     VALUE ZERO    02670002
026800                                                       COMP.      02680002
026900     05  PV-ACT-ADEVNT-MKUP-PCT-NULL PIC S9(04)     VALUE ZERO    02690002
027000                                                       COMP.      02700002
027100                                                                  02710000
027200 01  PV-GMA-TOTALS.                                               02720000
027300     05  PV-ACT-GMA-SLS-VOL           PIC S9(16)V9(02) VALUE ZERO 02730000
027400                                                       COMP-3.    02740000
027500     05  PV-FCST-GMA-SLS-VOL          PIC S9(16)V9(02) VALUE ZERO 02750000
027600                                                       COMP-3.    02760000
027700     05  PV-ACT-GMA-MKDN-DOL          PIC S9(16)V9(02) VALUE ZERO 02770000
027800                                                       COMP-3.    02780000
027900     05  PV-FCST-GMA-MKDN-DOL         PIC S9(16)V9(02) VALUE ZERO 02790000
028000                                                       COMP-3.    02800000
028100     05  PV-ACT-GMA-UNIT-SOLD         PIC S9(16)V9(02) VALUE ZERO 02810000
028200                                                       COMP-3.    02820000
028300     05  PV-FCST-GMA-UNIT-SOLD        PIC S9(16)V9(02) VALUE ZERO 02830000
028400                                                       COMP-3.    02840000
028500     05  PV-ACT-GMA-PREP-UNITS        PIC S9(16)V9(02) VALUE ZERO 02850000
028600                                                       COMP-3.    02860000
028700     05  PV-FCST-GMA-PREP-UNITS       PIC S9(16)V9(02) VALUE ZERO 02870000
028800                                                       COMP-3.    02880000
028900     05  PV-ACT-GMA-SLS-COST          PIC S9(16)V9(02) VALUE ZERO 02890000
029000                                                       COMP-3.    02900000
029100     05  PV-FCST-GMA-SLS-COST         PIC S9(16)V9(02) VALUE ZERO 02910000
029200                                                       COMP-3.    02920000
029300     05  PV-ACT-GMA-MKUP-PCT          PIC S9(16)V9(02) VALUE ZERO 02930000
029400                                                       COMP-3.    02940000
029500     05  PV-FCST-GMA-MKUP-PCT         PIC S9(16)V9(02) VALUE ZERO 02950000
029600                                                       COMP-3.    02960000
029700     05  PV-ACT-GMA-SLS-VOL-NULL      PIC S9(04)       VALUE ZERO 02970000
029800                                                       COMP.      02980000
029900     05  PV-FCST-GMA-SLS-VOL-NULL     PIC S9(04)       VALUE ZERO 02990000
030000                                                       COMP.      03000000
030100     05  PV-ACT-GMA-MKDN-DOL-NULL     PIC S9(04)       VALUE ZERO 03010000
030200                                                       COMP.      03020000
030300     05  PV-FCST-GMA-MKDN-DOL-NULL    PIC S9(04)       VALUE ZERO 03030000
030400                                                       COMP.      03040000
030500     05  PV-ACT-GMA-UNIT-SOLD-NULL    PIC S9(04)       VALUE ZERO 03050000
030600                                                       COMP.      03060000
030700     05  PV-FCST-GMA-UNIT-SOLD-NULL   PIC S9(04)       VALUE ZERO 03070000
030800                                                       COMP.      03080000
030900     05  PV-ACT-GMA-PREP-UNITS-NULL   PIC S9(04)       VALUE ZERO 03090000
031000                                                       COMP.      03100000
031100     05  PV-FCST-GMA-PREP-UNITS-NULL  PIC S9(04)       VALUE ZERO 03110000
031200                                                       COMP.      03120000
031300     05  PV-ACT-GMA-SLS-COST-NULL     PIC S9(04)       VALUE ZERO 03130000
031400                                                       COMP.      03140000
031500     05  PV-FCST-GMA-SLS-COST-NULL    PIC S9(04)       VALUE ZERO 03150000
031600                                                       COMP.      03160000
031700     05  PV-ACT-GMA-MKUP-PCT-NULL     PIC S9(04)       VALUE ZERO 03170000
031800                                                       COMP.      03180000
031900     05  PV-FCST-GMA-MKUP-PCT-NULL    PIC S9(04)       VALUE ZERO 03190000
032000                                                       COMP.      03200000
032100                                                                  03210000
032200 01  PV-DMA-TOTALS.                                               03220000
032300     05  PV-DMA-PROMO-ID              PIC  9(10)  VALUE ZEROS.    03230000
032400     05  PV-DMA-PROMO-NM              PIC  X(40)  VALUE SPACES.   03240000
032500     05  PV-ACT-DMA-SLS-VOL           PIC S9(16)V9(02) VALUE ZERO 03250000
032600                                                       COMP-3.    03260000
032700     05  PV-FCST-DMA-SLS-VOL          PIC S9(16)V9(02) VALUE ZERO 03270000
032800                                                       COMP-3.    03280000
032900     05  PV-DMA-VOL-PCT-CHG           PIC S9(16)V9(02) VALUE ZERO 03290000
033000                                                       COMP-3.    03300000
033100     05  PV-ACT-DMA-MKDN-DOL          PIC S9(16)V9(02) VALUE ZERO 03310000
033200                                                       COMP-3.    03320000
033300     05  PV-FCST-DMA-MKDN-DOL         PIC S9(16)V9(02) VALUE ZERO 03330000
033400                                                       COMP-3.    03340000
033500     05  PV-ACT-DMA-UNIT-SOLD         PIC S9(16)V9(02) VALUE ZERO 03350000
033600                                                       COMP-3.    03360000
033700     05  PV-FCST-DMA-UNIT-SOLD        PIC S9(16)V9(02) VALUE ZERO 03370000
033800                                                       COMP-3.    03380000
033900     05  PV-ACT-DMA-PREP-UNITS        PIC S9(16)V9(02) VALUE ZERO 03390000
034000                                                       COMP-3.    03400000
034100     05  PV-FCST-DMA-PREP-UNITS       PIC S9(16)V9(02) VALUE ZERO 03410000
034200                                                       COMP-3.    03420000
034300     05  PV-ACT-DMA-SLS-COST          PIC S9(16)V9(02) VALUE ZERO 03430000
034400                                                       COMP-3.    03440000
034500     05  PV-FCST-DMA-SLS-COST         PIC S9(16)V9(02) VALUE ZERO 03450000
034600                                                       COMP-3.    03460000
034700     05  PV-ACT-DMA-MKUP-PCT          PIC S9(16)V9(02) VALUE ZERO 03470000
034800                                                       COMP-3.    03480000
034900     05  PV-FCST-DMA-MKUP-PCT         PIC S9(16)V9(02) VALUE ZERO 03490000
035000                                                       COMP-3.    03500000
035100     05  PV-ACT-DMA-SLS-VOL-NULL      PIC S9(04)  COMP            03510000
035200                                                  VALUE ZEROS.    03520000
035300     05  PV-FCST-DMA-SLS-VOL-NULL     PIC S9(04)  COMP            03530000
035400                                                  VALUE ZEROS.    03540000
035500     05  PV-ACT-DMA-MKDN-DOL-NULL     PIC S9(04)  COMP            03550000
035600                                                  VALUE ZEROS.    03560000
035700     05  PV-FCST-DMA-MKDN-DOL-NULL    PIC S9(04)  COMP            03570000
035800                                                  VALUE ZEROS.    03580000
035900     05  PV-ACT-DMA-UNIT-SOLD-NULL    PIC S9(04)  COMP            03590000
036000                                                  VALUE ZEROS.    03600000
036100     05  PV-FCST-DMA-UNIT-SOLD-NULL   PIC S9(04)  COMP            03610000
036200                                                  VALUE ZEROS.    03620000
036300     05  PV-ACT-DMA-PREP-UNITS-NULL   PIC S9(04)  COMP            03630000
036400                                                  VALUE ZEROS.    03640000
036500     05  PV-FCST-DMA-PREP-UNITS-NULL  PIC S9(04)  COMP            03650000
036600                                                  VALUE ZEROS.    03660000
036700     05  PV-ACT-DMA-SLS-COST-NULL     PIC S9(04)  COMP            03670000
036800                                                  VALUE ZEROS.    03680000
036900     05  PV-FCST-DMA-SLS-COST-NULL    PIC S9(04)  COMP            03690000
037000                                                  VALUE ZEROS.    03700000
037100     05  PV-ACT-DMA-MKUP-PCT-NULL     PIC S9(04)  COMP            03710000
037200                                                  VALUE ZEROS.    03720000
037300     05  PV-FCST-DMA-MKUP-PCT-NULL    PIC S9(04)  COMP            03730000
037400                                                  VALUE ZEROS.    03740000
037500                                                                  03750000
037600 01  PV-DPT-TOTALS.                                               03760000
037700     05  PV-DPT-PROMO-ID              PIC  9(10)  VALUE ZEROS.    03770000
037800     05  PV-ACT-DPT-SLS-VOL           PIC S9(16)V9(02) VALUE ZERO 03780000
037900                                                       COMP-3.    03790000
038000     05  PV-FCST-DPT-SLS-VOL          PIC S9(16)V9(02) VALUE ZERO 03800000
038100                                                       COMP-3.    03810000
038200     05  PV-DPT-VOL-PCT-CHG           PIC S9(16)V9(02) VALUE ZERO 03820000
038300                                                       COMP-3.    03830000
038400     05  PV-ACT-DPT-MKDN-DOL          PIC S9(16)V9(02) VALUE ZERO 03840000
038500                                                       COMP-3.    03850000
038600     05  PV-FCST-DPT-MKDN-DOL         PIC S9(16)V9(02) VALUE ZERO 03860000
038700                                                       COMP-3.    03870000
038800     05  PV-ACT-DPT-UNIT-SOLD         PIC S9(16)V9(02) VALUE ZERO 03880000
038900                                                       COMP-3.    03890000
039000     05  PV-FCST-DPT-UNIT-SOLD        PIC S9(16)V9(02) VALUE ZERO 03900000
039100                                                       COMP-3.    03910000
039200     05  PV-ACT-DPT-PREP-UNITS        PIC S9(16)V9(02) VALUE ZERO 03920000
039300                                                       COMP-3.    03930000
039400     05  PV-FCST-DPT-PREP-UNITS       PIC S9(16)V9(02) VALUE ZERO 03940000
039500                                                       COMP-3.    03950000
039600     05  PV-ACT-DPT-SLS-COST          PIC S9(16)V9(02) VALUE ZERO 03960000
039700                                                       COMP-3.    03970000
039800     05  PV-FCST-DPT-SLS-COST         PIC S9(16)V9(02) VALUE ZERO 03980000
039900                                                       COMP-3.    03990000
040000     05  PV-ACT-DPT-MKUP-PCT          PIC S9(16)V9(02) VALUE ZERO 04000000
040100                                                       COMP-3.    04010000
040200     05  PV-FCST-DPT-MKUP-PCT         PIC S9(16)V9(02) VALUE ZERO 04020000
040300                                                       COMP-3.    04030000
040400     05  PV-ACT-DPT-SLS-VOL-NULL      PIC S9(04)  COMP            04040000
040500                                                  VALUE ZEROS.    04050000
040600     05  PV-FCST-DPT-SLS-VOL-NULL     PIC S9(04)  COMP            04060000
040700                                                  VALUE ZEROS.    04070000
040800     05  PV-ACT-DPT-MKDN-DOL-NULL     PIC S9(04)  COMP            04080000
040900                                                  VALUE ZEROS.    04090000
041000     05  PV-FCST-DPT-MKDN-DOL-NULL    PIC S9(04) COMP             04100000
041100                                                  VALUE ZEROS.    04110000
041200     05  PV-ACT-DPT-UNIT-SOLD-NULL    PIC S9(04) COMP             04120000
041300                                                  VALUE ZEROS.    04130000
041400     05  PV-FCST-DPT-UNIT-SOLD-NULL   PIC S9(04) COMP             04140000
041500                                                  VALUE ZEROS.    04150000
041600     05  PV-ACT-DPT-PREP-UNITS-NULL   PIC S9(04) COMP             04160000
041700                                                  VALUE ZEROS.    04170000
041800     05  PV-FCST-DPT-PREP-UNITS-NULL  PIC S9(04) COMP             04180000
041900                                                  VALUE ZEROS.    04190000
042000     05  PV-ACT-DPT-SLS-COST-NULL     PIC S9(04) COMP             04200000
042100                                                  VALUE ZEROS.    04210000
042200     05  PV-FCST-DPT-SLS-COST-NULL    PIC S9(04) COMP             04220000
042300                                                  VALUE ZEROS.    04230000
042400     05  PV-ACT-DPT-MKUP-PCT-NULL     PIC S9(04)  COMP            04240000
042500                                                  VALUE ZEROS.    04250000
042600     05  PV-FCST-DPT-MKUP-PCT-NULL    PIC S9(04) COMP             04260000
042700                                                  VALUE ZEROS.    04270000
042800                                                                  04280000
042900 01  PV-BYR-TOTALS.                                               04290000
043000     05  PV-BYR-PROMO-ID              PIC  9(10)  VALUE ZEROS.    04300000
043100     05  PV-BYR-PROMO-NM              PIC  X(40)  VALUE SPACES.   04310000
043200     05  PV-ACT-BYR-SLS-VOL           PIC S9(16)V9(02) VALUE ZERO 04320000
043300                                                       COMP-3.    04330000
043400     05  PV-FCST-BYR-SLS-VOL          PIC S9(16)V9(02) VALUE ZERO 04340000
043500                                                       COMP-3.    04350000
043600     05  PV-BYR-VOL-PCT-CHG           PIC S9(16)V9(02) VALUE ZERO 04360000
043700                                                       COMP-3.    04370000
043800     05  PV-ACT-BYR-MKDN-DOL          PIC S9(16)V9(02) VALUE ZERO 04380000
043900                                                       COMP-3.    04390000
044000     05  PV-FCST-BYR-MKDN-DOL         PIC S9(16)V9(02) VALUE ZERO 04400000
044100                                                       COMP-3.    04410000
044200     05  PV-ACT-BYR-UNIT-SOLD         PIC S9(16)V9(02) VALUE ZERO 04420000
044300                                                       COMP-3.    04430000
044400     05  PV-FCST-BYR-UNIT-SOLD        PIC S9(16)V9(02) VALUE ZERO 04440000
044500                                                       COMP-3.    04450000
044600     05  PV-ACT-BYR-PREP-UNITS        PIC S9(16)V9(02) VALUE ZERO 04460000
044700                                                       COMP-3.    04470000
044800     05  PV-FCST-BYR-PREP-UNITS       PIC S9(16)V9(02) VALUE ZERO 04480000
044900                                                       COMP-3.    04490000
045000     05  PV-ACT-BYR-SLS-COST          PIC S9(16)V9(02) VALUE ZERO 04500000
045100                                                       COMP-3.    04510000
045200     05  PV-FCST-BYR-SLS-COST         PIC S9(16)V9(02) VALUE ZERO 04520000
045300                                                       COMP-3.    04530000
045400     05  PV-ACT-BYR-MKUP-PCT          PIC S9(16)V9(02) VALUE ZERO 04540000
045500                                                       COMP-3.    04550000
045600     05  PV-FCST-BYR-MKUP-PCT         PIC S9(16)V9(02) VALUE ZERO 04560000
045700                                                       COMP-3.    04570000
045800     05  PV-ACT-BYR-SLS-VOL-NULL      PIC S9(04)  COMP            04580000
045900                                                  VALUE ZEROS.    04590000
046000     05  PV-FCST-BYR-SLS-VOL-NULL     PIC S9(04)  COMP            04600000
046100                                                  VALUE ZEROS.    04610000
046200     05  PV-ACT-BYR-MKDN-DOL-NULL     PIC S9(04)  COMP            04620000
046300                                                  VALUE ZEROS.    04630000
046400     05  PV-FCST-BYR-MKDN-DOL-NULL    PIC S9(04) COMP             04640000
046500                                                  VALUE ZEROS.    04650000
046600     05  PV-ACT-BYR-UNIT-SOLD-NULL    PIC S9(04) COMP             04660000
046700                                                  VALUE ZEROS.    04670000
046800     05  PV-FCST-BYR-UNIT-SOLD-NULL   PIC S9(04) COMP             04680000
046900                                                  VALUE ZEROS.    04690000
047000     05  PV-ACT-BYR-PREP-UNITS-NULL   PIC S9(04) COMP             04700000
047100                                                  VALUE ZEROS.    04710000
047200     05  PV-FCST-BYR-PREP-UNITS-NULL  PIC S9(04) COMP             04720000
047300                                                  VALUE ZEROS.    04730000
047400     05  PV-ACT-BYR-SLS-COST-NULL     PIC S9(04) COMP             04740000
047500                                                  VALUE ZEROS.    04750000
047600     05  PV-FCST-BYR-SLS-COST-NULL    PIC S9(04) COMP             04760000
047700                                                  VALUE ZEROS.    04770000
047800     05  PV-ACT-BYR-MKUP-PCT-NULL     PIC S9(04)  COMP            04780000
047900                                                  VALUE ZEROS.    04790000
048000     05  PV-FCST-BYR-MKUP-PCT-NULL    PIC S9(04) COMP             04800000
048100                                                  VALUE ZEROS.    04810000
048200 01  PV-BYR-DMM-TOTALS.                                           04820000
048300     05  PV-BYR-DMM-ACT-SLS-VOL       PIC S9(16)V9(02) VALUE ZERO 04830000
048400                                                       COMP-3.    04840000
048500     05  PV-BYR-DMM-FCST-SLS-VOL      PIC S9(16)V9(02) VALUE ZERO 04850000
048600                                                       COMP-3.    04860000
048700     05  PV-BYR-DMM-ACT-MKDN-DOL      PIC S9(16)V9(02) VALUE ZERO 04870000
048800                                                       COMP-3.    04880000
048900     05  PV-BYR-DMM-FCST-MKDN-DOL     PIC S9(16)V9(02) VALUE ZERO 04890000
049000                                                       COMP-3.    04900000
049100     05  PV-BYR-DMM-ACT-UNIT-SOLD     PIC S9(16)V9(02) VALUE ZERO 04910000
049200                                                       COMP-3.    04920000
049300     05  PV-BYR-DMM-FCST-UNIT-SOLD    PIC S9(16)V9(02) VALUE ZERO 04930000
049400                                                       COMP-3.    04940000
049500     05  PV-BYR-DMM-ACT-PREP-UNITS    PIC S9(16)V9(02) VALUE ZERO 04950000
049600                                                       COMP-3.    04960000
049700     05  PV-BYR-DMM-FCST-PREP-UNITS   PIC S9(16)V9(02) VALUE ZERO 04970000
049800                                                       COMP-3.    04980000
049900                                                                  04990000
050000 01  PV-TOTAL-BYR-DMM.                                            05000000
050100     05  PV-TOT-BYR-DMM-ACT-SLS-VOL   PIC  9(06)V99    VALUE ZERO 05010000
050200                                                       COMP-3.    05020000
050300     05  PV-TOT-BYR-DMM-FCST-SLS-VOL  PIC  9(06)V99    VALUE ZERO 05030000
050400                                                       COMP-3.    05040000
050500     05  PV-TOT-BYR-DMM-ACT-MKDN-DOL  PIC  9(06)V99    VALUE ZERO 05050000
050600                                                       COMP-3.    05060000
050700     05  PV-TOT-BYR-DMM-FCST-MKDN-DOL PIC  9(06)V99    VALUE ZERO 05070000
050800                                                       COMP-3.    05080000
050900                                                                  05090000
051000 01  PV-TOTAL-BYR.                                                05100000
051100     05  PV-TOT-ACT-BYR-SLS-VOL       PIC  9(06)V99    VALUE ZERO 05110000
051200                                                       COMP-3.    05120000
051300     05  PV-TOT-FCST-BYR-SLS-VOL      PIC  9(06)V99    VALUE ZERO 05130000
051400                                                       COMP-3.    05140000
051500     05  PV-TOT-BYR-VOL-CHG           PIC S9(06)V99    VALUE ZERO 05150000
051600                                                       COMP-3.    05160000
051700     05  PV-TOT-ACT-BYR-MKDN-DOL      PIC  9(06)V99    VALUE ZERO 05170000
051800                                                       COMP-3.    05180000
051900     05  PV-TOT-FCST-BYR-MKDN-DOL     PIC  9(06)V99    VALUE ZERO 05190000
052000                                                       COMP-3.    05200000
052100     05  PV-TOT-ACT-BYR-UNIT-SOLD     PIC  9(06)V99    VALUE ZERO 05210000
052200                                                       COMP-3.    05220000
052300     05  PV-TOT-FCST-BYR-UNIT-SOLD    PIC  9(06)V99    VALUE ZERO 05230000
052400                                                       COMP-3.    05240000
052500     05  PV-TOT-ACT-BYR-PREP-UNITS    PIC  9(06)V99    VALUE ZERO 05250000
052600                                                       COMP-3.    05260000
052700     05  PV-TOT-FCST-BYR-PREP-UNITS   PIC  9(06)V99    VALUE ZERO 05270000
052800                                                       COMP-3.    05280000
052900     05  PV-TOT-ACT-BYR-SLS-COST      PIC  9(06)V99    VALUE ZERO 05290000
053000                                                       COMP-3.    05300000
053100     05  PV-TOT-FCST-BYR-SLS-COST     PIC  9(06)V99    VALUE ZERO 05310000
053200                                                       COMP-3.    05320000
053300     05  PV-TOT-ACT-BYR-MKUP-PCT      PIC  9(06)V99    VALUE ZERO 05330000
053400                                                       COMP-3.    05340000
053500     05  PV-TOT-FCST-BYR-MKUP-PCT     PIC  9(06)V99    VALUE ZERO 05350000
053600                                                       COMP-3.    05360000
053700                                                                  05370000
053800 01  PV-TOTAL-DMA.                                                05380000
053900     05  PV-TOT-ACT-DMA-SLS-VOL       PIC  9(06)V99    VALUE ZERO 05390000
054000                                                       COMP-3.    05400000
054100     05  PV-TOT-FCST-DMA-SLS-VOL      PIC  9(06)V99    VALUE ZERO 05410000
054200                                                       COMP-3.    05420000
054300     05  PV-TOT-DMA-VOL-CHG           PIC S9(06)V99    VALUE ZERO 05430000
054400                                                       COMP-3.    05440000
054500     05  PV-TOT-ACT-DMA-MKDN-DOL      PIC  9(06)V99    VALUE ZERO 05450000
054600                                                       COMP-3.    05460000
054700     05  PV-TOT-FCST-DMA-MKDN-DOL     PIC  9(06)V99    VALUE ZERO 05470000
054800                                                       COMP-3.    05480000
054900     05  PV-TOT-ACT-DMA-UNIT-SOLD     PIC  9(06)V99    VALUE ZERO 05490000
055000                                                       COMP-3.    05500000
055100     05  PV-TOT-FCST-DMA-UNIT-SOLD    PIC  9(06)V99    VALUE ZERO 05510000
055200                                                       COMP-3.    05520000
055300     05  PV-TOT-ACT-DMA-PREP-UNITS    PIC  9(06)V99    VALUE ZERO 05530000
055400                                                       COMP-3.    05540000
055500     05  PV-TOT-FCST-DMA-PREP-UNITS   PIC  9(06)V99    VALUE ZERO 05550000
055600                                                       COMP-3.    05560000
055700     05  PV-TOT-ACT-DMA-SLS-COST      PIC  9(06)V99    VALUE ZERO 05570000
055800                                                       COMP-3.    05580000
055900     05  PV-TOT-FCST-DMA-SLS-COST     PIC  9(06)V99    VALUE ZERO 05590000
056000                                                       COMP-3.    05600000
056100     05  PV-TOT-ACT-DMA-MKUP-PCT      PIC  9(06)V99    VALUE ZERO 05610000
056200                                                       COMP-3.    05620000
056300     05  PV-TOT-FCST-DMA-MKUP-PCT     PIC  9(06)V99    VALUE ZERO 05630000
056400                                                       COMP-3.    05640000
056500                                                                  05650000
056600 01  PV-TOTAL-DPT.                                                05660000
056700     05  PV-TOT-ACT-DPT-SLS-VOL       PIC  9(06)V99    VALUE ZERO 05670000
056800                                                       COMP-3.    05680000
056900     05  PV-TOT-FCST-DPT-SLS-VOL      PIC  9(06)V99    VALUE ZERO 05690000
057000                                                       COMP-3.    05700000
057100     05  PV-TOT-DPT-VOL-CHG           PIC S9(06)V99    VALUE ZERO 05710000
057200                                                       COMP-3.    05720000
057300     05  PV-TOT-ACT-DPT-MKDN-DOL      PIC  9(06)V99    VALUE ZERO 05730000
057400                                                       COMP-3.    05740000
057500     05  PV-TOT-FCST-DPT-MKDN-DOL     PIC  9(06)V99    VALUE ZERO 05750000
057600                                                       COMP-3.    05760000
057700     05  PV-TOT-ACT-DPT-UNIT-SOLD     PIC  9(06)V99    VALUE ZERO 05770000
057800                                                       COMP-3.    05780000
057900     05  PV-TOT-FCST-DPT-UNIT-SOLD    PIC  9(06)V99    VALUE ZERO 05790000
058000                                                       COMP-3.    05800000
058100     05  PV-TOT-ACT-DPT-PREP-UNITS    PIC  9(06)V99    VALUE ZERO 05810000
058200                                                       COMP-3.    05820000
058300     05  PV-TOT-FCST-DPT-PREP-UNITS   PIC  9(06)V99    VALUE ZERO 05830000
058400                                                       COMP-3.    05840000
058500     05  PV-TOT-ACT-DPT-MKUP-PCT      PIC  9(06)V99    VALUE ZERO 05850000
058600                                                       COMP-3.    05860000
058700     05  PV-TOT-FCST-DPT-MKUP-PCT     PIC  9(06)V99    VALUE ZERO 05870000
058800                                                       COMP-3.    05880000
058900     05  PV-TOT-ACT-DPT-SLS-COST      PIC  9(06)V99    VALUE ZERO 05890000
059000                                                       COMP-3.    05900000
059100     05  PV-TOT-FCST-DPT-SLS-COST     PIC  9(06)V99    VALUE ZERO 05910000
059200                                                       COMP-3.    05920000
059300                                                                  05930000
059400 01  PV-TOTAL-BYR-GMM.                                            05940000
059500     05  PV-TOT-BYR-GMM-ACT-SLS-VOL   PIC  9(06)V99    VALUE ZERO 05950000
059600                                                       COMP-3.    05960000
059700     05  PV-TOT-BYR-GMM-FCST-SLS-VOL  PIC  9(06)V99    VALUE ZERO 05970000
059800                                                       COMP-3.    05980000
059900     05  PV-TOT-BYR-GMM-ACT-MKDN-DOL  PIC  9(06)V99    VALUE ZERO 05990000
060000                                                       COMP-3.    06000000
060100     05  PV-TOT-BYR-GMM-FCST-MKDN-DOL PIC  9(06)V99    VALUE ZERO 06010000
060200                                                       COMP-3.    06020000
060300                                                                  06030000
060400 01  PV-TOTAL-BYR-AD.                                             06040000
060500     05  PV-TOT-BYR-AD-ACT-SLS-VOL    PIC  9(06)V99    VALUE ZERO 06050000
060600                                                       COMP-3.    06060000
060700     05  PV-TOT-BYR-AD-FCST-SLS-VOL   PIC  9(06)V99    VALUE ZERO 06070000
060800                                                       COMP-3.    06080000
060900     05  PV-TOT-BYR-AD-ACT-MKDN-DOL   PIC  9(06)V99    VALUE ZERO 06090000
061000                                                       COMP-3.    06100000
061100     05  PV-TOT-BYR-AD-FCST-MKDN-DOL  PIC  9(06)V99    VALUE ZERO 06110000
061200                                                       COMP-3.    06120000
061300                                                                  06130000
061400 01  PV-BUYER-VARIABLES.                                          06140000
061500     05  PV-GMA-NBR                   PIC  9(04)  VALUE ZEROS.    06150000
061600     05  PV-GMA-NM                    PIC  X(30)  VALUE SPACES.   06160000
061700     05  PV-GMM-FRST-NM               PIC  X(40)  VALUE SPACES.   06170000
061800     05  PV-GMM-LAST-NM               PIC  X(40)  VALUE SPACES.   06180000
061900     05  PV-DMA-NBR                   PIC  9(04)  VALUE ZEROS.    06190000
062000     05  PV-DMA-NM                    PIC  X(30)  VALUE SPACES.   06200000
062100     05  PV-DMM-FRST-NM               PIC  X(40)  VALUE SPACES.   06210000
062200     05  PV-DMM-LAST-NM               PIC  X(40)  VALUE SPACES.   06220000
062300     05  PV-DPT-NBR                   PIC  9(04)  VALUE ZEROS.    06230000
062400     05  PV-DPT-NM                    PIC  X(20)  VALUE SPACES.   06240000
062500     05  PV-BYR-NBR                   PIC  9(04)  VALUE ZEROS.    06250000
062600     05  PV-BYR-FRST-NM               PIC  X(40)  VALUE SPACES.   06260000
062700     05  PV-BYR-LAST-NM               PIC  X(40)  VALUE SPACES.   06270000
062800     05  PV-GMM-FRST-NM-NULL          PIC S9(04)  COMP            06280000
062900                                                  VALUE ZEROS.    06290000
063000     05  PV-DMM-FRST-NM-NULL          PIC S9(04)  COMP            06300000
063100                                                  VALUE ZEROS.    06310000
063200     05  PV-BYR-FRST-NM-NULL          PIC S9(04)  COMP            06320000
063300                                                  VALUE ZEROS.    06330000
063400                                                                  06340000
063500 01  PV-PROMO-VARIABLES.                                          06350000
063600     05  PV-PROMO-ID                  PIC  9(10)  VALUE ZEROS.    06360000
063700     05  PV-PROMO-NM                  PIC  X(40)  VALUE SPACES.   06370000
063800     05  PV-PROMO-STRT-DTE            PIC  X(10)  VALUE SPACES.   06380000
063900     05  PV-PROMO-END-DTE             PIC  X(10)  VALUE SPACES.   06390000
064000     05  PV-DAYS-ON-SALE              PIC  9(02)  VALUE ZEROS.    06400000
064100                                                                  06410000
064200 01  PV-UNAD-VARIABLES.                                           06420000
064300     05  PV-UNAD-STRT-DTE             PIC  X(10)  VALUE SPACES.   06430000
064400     05  PV-UNAD-END-DTE              PIC  X(10)  VALUE SPACES.   06440000
064500     05  PV-UNAD-DAY-ON-SALE          PIC  9(02)  VALUE ZEROS.    06450000
064600                                                                  06460000
064700 01  PV-ALL-PROMO-TBL.                                            06470000
598092     05  PV-ALL-PROMO-TABLE OCCURS 100 TIMES                      06480019
064900        INDEXED BY PV-ALL-PROMO-IDX.                              06490000
065000         10  PV-ALL-PROMO-ID            PIC  X(10)  VALUE SPACES. 06500000
065100         10  PV-ALL-PROMO-NM            PIC  X(40)  VALUE SPACES. 06510000
065200         10  PV-ALL-PROMO-STRT-DTE      PIC  X(10)  VALUE SPACES. 06520000
065300         10  PV-ALL-PROMO-END-DTE       PIC  X(10)  VALUE SPACES. 06530000
065400         10  PV-ALL-DAYS-ON-SALE        PIC  9(02)  VALUE ZEROS.  06540000
065500                                                                  06550000
065600 01  PV-ALL-DMA-PROMO-TBL.                                        06560000
598092     05  PV-ALL-DMA-PROMO-TABLE OCCURS 100 TIMES                  06570019
065800        INDEXED BY PV-ALL-DMA-PROMO-IDX.                          06580000
065900         10  PV-ALL-DMA-PROMO-ID       PIC  X(10)  VALUE SPACES.  06590000
066000         10  PV-ALL-DMA-PROMO-NM       PIC  X(40)  VALUE SPACES.  06600000
066100         10  PV-ALL-ACT-DMA-SLS-VOL    PIC  9(06)V99    VALUE ZERO06610000
066200                                                        COMP-3.   06620000
066300         10  PV-ALL-FCST-DMA-SLS-VOL   PIC  9(06)V99    VALUE ZERO06630000
066400                                                        COMP-3.   06640000
066500         10  PV-ALL-DMA-VOL-PCT-CHG    PIC S9(09)V9(04) VALUE ZERO06650000
066600                                                        COMP-3.   06660000
066700         10  PV-ALL-ACT-DMA-MKDN-DOL   PIC  9(06)V99    VALUE ZERO06670000
066800                                                        COMP-3.   06680000
066900         10  PV-ALL-FCST-DMA-MKDN-DOL  PIC  9(06)V99    VALUE ZERO06690000
067000                                                        COMP-3.   06700000
067100         10  PV-ALL-ACT-DMA-UNIT-SOLD  PIC  9(06)V99    VALUE ZERO06710000
067200                                                        COMP-3.   06720000
067300         10  PV-ALL-FCST-DMA-UNIT-SOLD PIC  9(06)V99    VALUE ZERO06730000
067400                                                        COMP-3.   06740000
067500         10  PV-ALL-ACT-DMA-PREP-UNITS PIC  9(06)V99    VALUE ZERO06750000
067600                                                        COMP-3.   06760000
067700         10  PV-ALL-FCST-DMA-PREP-UNITS PIC  9(06)V99   VALUE ZERO06770000
067800                                                         COMP-3.  06780000
067900         10  PV-ALL-ACT-DMA-SLS-COST   PIC  9(06)V99    VALUE ZERO06790000
068000                                                        COMP-3.   06800000
068100         10  PV-ALL-FCST-DMA-SLS-COST  PIC  9(06)V99   VALUE ZERO 06810000
068200                                                         COMP-3.  06820000
068300         10  PV-ALL-ACT-DMA-MKUP-PCT   PIC S9(09)V9(04) VALUE ZERO06830000
068400                                                        COMP-3.   06840000
068500         10  PV-ALL-FCST-DMA-MKUP-PCT  PIC S9(09)V9(04) VALUE ZERO06850000
068600                                                        COMP-3.   06860000
068700                                                                  06870000
068800 01  PA-PROGRAM-ACCUMULATORS.                                     06880000
068900     05  PA-AD-EVNT-CNT               PIC  9(11)  VALUE ZEROS.    06890000
069000     05  PA-BUYER-CNT                 PIC  9(11)  VALUE ZEROS.    06900000
069100     05  PA-PROMO-CNT                 PIC  9(11)  VALUE ZEROS.    06910000
069200     05  PA-DMA-PROMO-CNT             PIC  9(11)  VALUE ZEROS.    06920000
069300     05  PA-DPT-PROMO-CNT             PIC  9(11)  VALUE ZEROS.    06930000
069400     05  PA-BYR-PROMO-TOT-CNT         PIC  9(11)  VALUE ZEROS.    06940000
069500     05  PA-RECS-WRITTEN              PIC  9(11)  VALUE ZEROS.    06950000
069600     05  PA-PROMO-REG-CNT             PIC  9(11)  VALUE ZEROS.    06960000
069700     05  PA-PROMO-CLR-CNT             PIC  9(11)  VALUE ZEROS.    06970000
069800                                                                  06980000
069900 01 HEADER-01.                                                    06990000
070000     05  FILLER                       PIC  X(12)  VALUE           07000000
070100                                           ' DIVISION : '.        07010000
070200     05  FILLER                       PIC  X(05)  VALUE SPACES.   07020000
070300     05  HDR-01-DMM-NAME              PIC  X(46)  VALUE SPACES.   07030000
070400     05  FILLER                       PIC  X(08)  VALUE SPACES.   07040000
070500     05  FILLER                       PIC  X(44)  VALUE           07050000
070600                     'AD EVENT SUMMARY - BUYER/DEPARTMENT TOTALS'.07060000
070700     05  FILLER                       PIC  X(31)  VALUE           07070000
070800                     '- ACTUAL RESULTS (IN THOUSANDS)'.           07080000
070900     05  FILLER                       PIC  X(54)  VALUE SPACES.   07090000
071000                                                                  07100000
071100 01 HEADER-02.                                                    07110000
071200     05  FILLER                       PIC  X(12)     VALUE        07120000
071300                                           ' BUYER    : '.        07130000
071400     05  FILLER                       PIC  X(05)     VALUE SPACES.07140000
071500     05  HDR-02-BYR-NAME              PIC  X(46)     VALUE SPACES.07150000
071600     05  FILLER                       PIC  X(137)    VALUE SPACES.07160000
071700                                                                  07170000
071800 01 HEADER-03.                                                    07180000
071900     05  FILLER                       PIC  X(12)     VALUE        07190000
072000                                           ' AD EVENT : '.        07200000
072100     05  FILLER                       PIC  X(05)     VALUE SPACES.07210000
072200     05  HDR-03-AD-EVNT-NAME          PIC  X(55)     VALUE SPACES.07220000
072300     05  FILLER                       PIC  X(128)    VALUE SPACES.07230000
072400                                                                  07240000
072500 01 HEADER-04.                                                    07250000
072600     05  FILLER                       PIC  X(17)     VALUE SPACES.07260000
072700     05  HDR-04-PROMO-NAME            PIC  X(40)     VALUE SPACES.07270000
072800     05  FILLER                       PIC  X(01)     VALUE SPACES.07280000
072900     05  HDR-04-PROMO-BEG-DTE         PIC  X(10)     VALUE SPACES.07290000
073000     05  FILLER                       PIC  X(03)     VALUE ' - '. 07300000
073100     05  HDR-04-PROMO-END-DTE         PIC  X(10)     VALUE SPACES.07310000
073200     05  FILLER                       PIC  X(05)     VALUE SPACES.07320000
073300     05  HDR-04-PROMO-NUM-DAYS        PIC  X(02)     VALUE SPACES.07330000
073400     05  FILLER                       PIC  X(02)     VALUE SPACES.07340000
073500     05  HDR-04-PROMO-DAYS            PIC  X(04)     VALUE SPACES.07350000
073600     05  FILLER                       PIC  X(106)    VALUE SPACES.07360000
073700                                                                  07370000
073800 01 HEADER-05.                                                    07380000
073900     05  FILLER                       PIC  X(68)     VALUE SPACES.07390000
074000     05  FILLER                       PIC  X(12)     VALUE        07400000
074100                                           'SALES VOLUME'.        07410000
074200     05  FILLER                       PIC  X(09)     VALUE SPACES.07420000
074300     05  FILLER                       PIC  X(05)     VALUE        07430000
074400                                           'VOL %'.               07440000
074500     05  FILLER                       PIC  X(14)     VALUE SPACES.07450000
074600     05  FILLER                       PIC  X(10)     VALUE        07460000
074700                                           'MARKDOWN $'.          07470000
074800     05  FILLER                       PIC  X(14)     VALUE SPACES.07480000
074900     05  FILLER                       PIC  X(10)     VALUE        07490000
075000                                           'UNITS SOLD'.          07500000
075100     05  FILLER                       PIC  X(14)     VALUE SPACES.07510000
075200     05  FILLER                       PIC  X(10)     VALUE        07520000
075300                                           'PREP UNITS'.          07530000
075400     05  FILLER                       PIC  X(10)     VALUE SPACES.07540000
075500     05  FILLER                       PIC  X(08)     VALUE        07550000
075600                                           'MARKUP %'.            07560000
075700                                                                  07570000
075800 01 HEADER-06.                                                    07580000
075900     05  FILLER                       PIC  X(67)     VALUE SPACES.07590000
076000     05  FILLER                       PIC  X(14)     VALUE        07600000
076100                                               'ACT       FCST'.  07610000
076200     05  FILLER                       PIC  X(08)     VALUE SPACES.07620000
076300     05  FILLER                       PIC  X(06)     VALUE        07630000
076400                                                         'CHANGE'.07640000
076500     05  FILLER                       PIC  X(12)     VALUE SPACES.07650000
076600     05  FILLER                       PIC  X(14)     VALUE        07660000
076700                                                 'ACT       FCST'.07670000
076800     05  FILLER                       PIC  X(10)     VALUE SPACES.07680000
076900     05  FILLER                       PIC  X(14)     VALUE        07690000
077000                                                 'ACT       FCST'.07700000
077100     05  FILLER                       PIC  X(10)     VALUE SPACES.07710000
077200     05  FILLER                       PIC  X(14)     VALUE        07720000
077300                                                 'ACT       FCST'.07730000
077400     05  FILLER                       PIC  X(07)     VALUE SPACES.07740000
077500     05  FILLER                       PIC  X(11)     VALUE        07750000
077600                                                    'ACT    FCST'.07760000
077700                                                                  07770000
077800 01 DTL-DIVISION-01.                                              07780000
077900     05  FILLER                       PIC  X(01)     VALUE SPACES.07790000
078000     05  DTL-DIVISION-01-NM           PIC  X(62)     VALUE SPACES.07800000
078100     05  FILLER                       PIC  X(137)    VALUE SPACES.07810000
078200                                                                  07820000
078300 01 DTL-DIVISION-02.                                              07830000
078400     05  FILLER                       PIC  X(15)     VALUE        07840000
078500                                                ' DIVISION TOTAL'.07850000
078600     05  FILLER                       PIC  X(185)    VALUE SPACES.07860000
078700                                                                  07870000
078800 01 DTL-DIVISION-03.                                              07880000
078900     05  FILLER                       PIC  X(16)     VALUE SPACES.07890000
079000     05  DTL-DVSN-03-PROMO            PIC  X(40)     VALUE SPACES.07900000
079100     05  FILLER                       PIC  X(04)     VALUE SPACES.07910000
079200     05  DTL-DVSN-03-ACT-SLS          PIC  ZZZ,ZZ9.99.            07920000
079300     05  FILLER                       PIC  X(01)     VALUE SPACES.07930000
079400     05  DTL-DVSN-03-FCST-SLS         PIC  ZZZ,ZZ9.99.            07940000
079500     05  FILLER                       PIC  X(04)     VALUE SPACES.07950000
079600     05  DTL-DVSN-03-LEFT-PARA        PIC  X(01)     VALUE SPACES.07960000
079700     05  DTL-DVSN-03-VOL-CHG          PIC  ZZZZZZ.Z.              07970000
079800     05  DTL-DVSN-03-VOL-CHG-PCT      PIC  X(01)     VALUE SPACES.07980000
079900     05  DTL-DVSN-03-RIGHT-PARA       PIC  X(01)     VALUE SPACES.07990000
080000     05  FILLER                       PIC  X(04)     VALUE SPACES.08000000
080100     05  DTL-DVSN-03-ACT-MKDN         PIC  ZZZ,ZZ9.99.            08010000
080200     05  FILLER                       PIC  X(01)     VALUE SPACES.08020000
080300     05  DTL-DVSN-03-FCST-MKDN        PIC  ZZZ,ZZ9.99.            08030000
080400     05  FILLER                       PIC  X(03)     VALUE SPACES.08040000
080500     05  DTL-DVSN-03-ACT-UNT-SLD      PIC  ZZZ,ZZ9.99.            08050000
080600     05  FILLER                       PIC  X(01)     VALUE SPACES.08060000
080700     05  DTL-DVSN-03-FCST-UNT-SLD     PIC  ZZZ,ZZ9.99.            08070000
080800     05  FILLER                       PIC  X(03)     VALUE SPACES.08080000
080900     05  DTL-DVSN-03-ACT-PREP-UNT     PIC  ZZZ,ZZ9.99.            08090000
081000     05  FILLER                       PIC  X(01)     VALUE SPACES.08100000
081100     05  DTL-DVSN-03-FCST-PREP-UNT    PIC  ZZZ,ZZ9.99.            08110000
081200     05  FILLER                       PIC  X(05)     VALUE SPACES.08120000
081300     05  DTL-DVSN-03-ACT-MKUP-PCT     PIC  Z9.9.                  08130000
081400     05  DTL-DVSN-03-ACT-MKUP-PCT-SN  PIC  X(01)     VALUE SPACES.08140000
081500     05  FILLER                       PIC  X(03)     VALUE SPACES.08150000
081600     05  DTL-DVSN-03-FCST-MKUP-PCT    PIC  Z9.9.                  08160000
081700     05  DTL-DVSN-03-FCST-MKUP-PCT-SN PIC  X(01)     VALUE SPACES.08170000
081800                                                                  08180000
081900 01 DTL-DEPT-01.                                                  08190000
082000     05  FILLER                       PIC  X(06)   VALUE ' DEPT:'.08200000
082100     05  FILLER                       PIC  X(07)   VALUE SPACES.  08210000
082200     05  DTL-DPT-01-DPT-NBR           PIC  9(04)   VALUE ZEROS.   08220000
082300     05  FILLER                       PIC  X(10)   VALUE SPACES.  08230000
082400     05  DTL-DPT-01-DPT-NM            PIC  X(20)   VALUE SPACES.  08240000
082500     05  FILLER                       PIC  X(153)  VALUE SPACES.  08250000
082600                                                                  08260000
082700 01 DTL-DEPT-02.                                                  08270000
082800     05  FILLER                       PIC  X(16)     VALUE SPACES.08280000
082900     05  DTL-DEPT-02-PROMO            PIC  X(40)     VALUE SPACES.08290000
083000     05  FILLER                       PIC  X(04)     VALUE SPACES.08300000
083100     05  DTL-DEPT-02-ACT-SLS          PIC  ZZZ,ZZ9.99.            08310000
083200     05  FILLER                       PIC  X(01)     VALUE SPACES.08320000
083300     05  DTL-DEPT-02-FCST-SLS         PIC  ZZZ,ZZ9.99.            08330000
083400     05  FILLER                       PIC  X(04)     VALUE SPACES.08340000
083500     05  DTL-DEPT-02-LEFT-PARA        PIC  X(01)     VALUE SPACES.08350000
083600     05  DTL-DEPT-02-VOL-CHG          PIC  ZZZZZZ.Z.              08360000
083700     05  DTL-DEPT-02-VOL-CHG-PCT      PIC  X(01)     VALUE SPACES.08370000
083800     05  DTL-DEPT-02-RIGHT-PARA       PIC  X(01)     VALUE SPACES.08380000
083900     05  FILLER                       PIC  X(04)     VALUE SPACES.08390000
084000     05  DTL-DEPT-02-ACT-MKDN         PIC  ZZZ,ZZ9.99.            08400000
084100     05  FILLER                       PIC  X(01)     VALUE SPACES.08410000
084200     05  DTL-DEPT-02-FCST-MKDN        PIC  ZZZ,ZZ9.99.            08420000
084300     05  FILLER                       PIC  X(03)     VALUE SPACES.08430000
084400     05  DTL-DEPT-02-ACT-UNT-SLD      PIC  ZZZ,ZZ9.99.            08440000
084500     05  FILLER                       PIC  X(01)     VALUE SPACES.08450000
084600     05  DTL-DEPT-02-FCST-UNT-SLD     PIC  ZZZ,ZZ9.99.            08460000
084700     05  FILLER                       PIC  X(03)     VALUE SPACES.08470000
084800     05  DTL-DEPT-02-ACT-PREP-UNT     PIC  ZZZ,ZZ9.99.            08480000
084900     05  FILLER                       PIC  X(01)     VALUE SPACES.08490000
085000     05  DTL-DEPT-02-FCST-PREP-UNT    PIC  ZZZ,ZZ9.99.            08500000
085100     05  FILLER                       PIC  X(05)     VALUE SPACES.08510000
085200     05  DTL-DEPT-02-ACT-MKUP-PCT     PIC  Z9.9.                  08520000
085300     05  DTL-DEPT-02-ACT-MKUP-PCT-SN  PIC  X(01)     VALUE SPACES.08530000
085400     05  FILLER                       PIC  X(03)     VALUE SPACES.08540000
085500     05  DTL-DEPT-02-FCST-MKUP-PCT    PIC  Z9.9.                  08550000
085600     05  DTL-DEPT-02-FCST-MKUP-PCT-SN PIC  X(01)     VALUE SPACES.08560000
085700                                                                  08570000
085800 01 DTL-DEPT-03.                                                  08580000
085900     05  FILLER                       PIC  X(16)     VALUE SPACES.08590000
086000     05  FILLER                       PIC  X(40)     VALUE        08600000
086100                                            'DEPT AS % OF ADEVNT'.08610000
086200     05  FILLER                       PIC  X(09)     VALUE SPACES.08620000
086300     05  DTL-DEPT-03-ACT-SLS          PIC  Z9.9.                  08630000
086400     05  DTL-DEPT-03-ACT-SLS-PCT      PIC  X(01)     VALUE SPACES.08640000
086500     05  FILLER                       PIC  X(06)     VALUE SPACES.08650000
086600     05  DTL-DEPT-03-FCST-SLS         PIC  Z9.9.                  08660000
086700     05  DTL-DEPT-03-FCST-SLS-PCT     PIC  X(01)     VALUE SPACES.08670000
086800     05  FILLER                       PIC  X(24)     VALUE SPACES.08680000
086900     05  DTL-DEPT-03-ACT-MKDN         PIC  Z9.9.                  08690000
087000     05  DTL-DEPT-03-ACT-MKDN-PCT     PIC  X(01)     VALUE SPACES.08700000
087100     05  FILLER                       PIC  X(06)     VALUE SPACES.08710000
087200     05  DTL-DEPT-03-FCST-MKDN        PIC  Z9.9.                  08720000
087300     05  DTL-DEPT-03-FCST-MKDN-PCT    PIC  X(01)     VALUE SPACES.08730000
087400     05  FILLER                       PIC  X(74)     VALUE SPACES.08740000
087500                                                                  08750000
087600 01 DTL-BYR-TOTAL-01.                                             08760000
087700     05  DTL-BYR-01-TITLE             PIC  X(16)     VALUE SPACES.08770000
087800     05  DTL-BYR-01-PROMO-NM          PIC  X(40)     VALUE SPACES.08780000
087900     05  FILLER                       PIC  X(04)     VALUE SPACES.08790000
088000     05  DTL-BYR-01-ACT-SLS           PIC  ZZZ,ZZ9.99.            08800000
088100     05  FILLER                       PIC  X(01)     VALUE SPACES.08810000
088200     05  DTL-BYR-01-FCST-SLS          PIC  ZZZ,ZZ9.99.            08820000
088300     05  FILLER                       PIC  X(04)     VALUE SPACES.08830000
088400     05  DTL-BYR-01-LEFT-PARA         PIC  X(01)     VALUE SPACES.08840000
088500     05  DTL-BYR-01-VOL-CHG           PIC  ZZZZZZ.Z.              08850000
088600     05  DTL-BYR-01-VOL-CHG-PCT       PIC  X(01)     VALUE SPACES.08860000
088700     05  DTL-BYR-01-RIGHT-PARA        PIC  X(01)     VALUE SPACES.08870000
088800     05  FILLER                       PIC  X(04)     VALUE SPACES.08880000
088900     05  DTL-BYR-01-ACT-MKDN          PIC  ZZZ,ZZ9.99.            08890000
089000     05  FILLER                       PIC  X(01)     VALUE SPACES.08900000
089100     05  DTL-BYR-01-FCST-MKDN         PIC  ZZZ,ZZ9.99.            08910000
089200     05  FILLER                       PIC  X(03)     VALUE SPACES.08920000
089300     05  DTL-BYR-01-ACT-UNT-SLD       PIC  ZZZ,ZZ9.99.            08930000
089400     05  FILLER                       PIC  X(01)     VALUE SPACES.08940000
089500     05  DTL-BYR-01-FCST-UNT-SLD      PIC  ZZZ,ZZ9.99.            08950000
089600     05  FILLER                       PIC  X(03)     VALUE SPACES.08960000
089700     05  DTL-BYR-01-ACT-PREP-UNT      PIC  ZZZ,ZZ9.99.            08970000
089800     05  FILLER                       PIC  X(01)     VALUE SPACES.08980000
089900     05  DTL-BYR-01-FCST-PREP-UNT     PIC  ZZZ,ZZ9.99.            08990000
090000     05  FILLER                       PIC  X(05)     VALUE SPACES.09000000
090100     05  DTL-BYR-01-ACT-MKUP-PCT      PIC  Z9.9.                  09010000
090200     05  DTL-BYR-01-ACT-MKUP-PCT-SN   PIC  X(01)     VALUE SPACES.09020000
090300     05  FILLER                       PIC  X(03)     VALUE SPACES.09030000
090400     05  DTL-BYR-01-FCST-MKUP-PCT     PIC  Z9.9.                  09040000
090500     05  DTL-BYR-01-FCST-MKUP-PCT-SN  PIC  X(01)     VALUE SPACES.09050000
090600                                                                  09060000
090700 01 DTL-BYR-TOTAL-02.                                             09070000
090800     05  FILLER                       PIC  X(16)     VALUE SPACES.09080000
090900     05  FILLER                       PIC  X(40)     VALUE        09090000
091000                                                      '% TO DMM'. 09100000
091100     05  FILLER                       PIC  X(09)     VALUE SPACES.09110000
091200     05  DTL-BYR-02-ACT-SLS           PIC  Z9.9.                  09120000
091300     05  DTL-BYR-02-ACT-SLS-PCT       PIC  X(01)     VALUE SPACES.09130000
091400     05  FILLER                       PIC  X(06)     VALUE SPACES.09140000
091500     05  DTL-BYR-02-FCST-SLS          PIC  Z9.9.                  09150000
091600     05  DTL-BYR-02-FCST-SLS-PCT      PIC  X(01)     VALUE SPACES.09160000
091700     05  FILLER                       PIC  X(24)     VALUE SPACES.09170000
091800     05  DTL-BYR-02-ACT-MKDN          PIC  Z9.9.                  09180000
091900     05  DTL-BYR-02-ACT-MKDN-PCT      PIC  X(01)     VALUE SPACES.09190000
092000     05  FILLER                       PIC  X(06)     VALUE SPACES.09200000
092100     05  DTL-BYR-02-FCST-MKDN         PIC  Z9.9.                  09210000
092200     05  DTL-BYR-02-FCST-MKDN-PCT     PIC  X(01)     VALUE SPACES.09220000
092300     05  FILLER                       PIC  X(08)     VALUE SPACES.09230000
092400     05  DTL-BYR-02-ACT-UNT-SLD       PIC  Z9.9.                  09240000
092500     05  DTL-BYR-02-ACT-UNT-SLD-PCT   PIC  X(01)     VALUE SPACES.09250000
092600     05  FILLER                       PIC  X(06)     VALUE SPACES.09260000
092700     05  DTL-BYR-02-FCST-UNT-SLD      PIC  Z9.9.                  09270000
092800     05  DTL-BYR-02-FCST-UNT-SLD-PCT  PIC  X(01)     VALUE SPACES.09280000
092900     05  FILLER                       PIC  X(08)     VALUE SPACES.09290000
093000     05  DTL-BYR-02-ACT-PREP-UNT      PIC  Z9.9.                  09300000
093100     05  DTL-BYR-02-ACT-PREP-UNT-PCT  PIC  X(01)     VALUE SPACES.09310000
093200     05  FILLER                       PIC  X(06)     VALUE SPACES.09320000
093300     05  DTL-BYR-02-FCST-PREP-UNT     PIC  Z9.9.                  09330000
093400     05  DTL-BYR-02-FCST-PREP-UNT-PCT PIC  X(01)     VALUE SPACES.09340000
093500     05  FILLER                       PIC  X(07)     VALUE SPACES.09350000
093600                                                                  09360000
093700 01 DTL-BYR-TOTAL-03.                                             09370000
093800     05  FILLER                       PIC  X(21)      VALUE       09380000
093900                                          ' BUYER AD EVENT TOTAL'.09390000
094000     05  FILLER                       PIC  X(39)     VALUE SPACES.09400000
094100     05  DTL-BYR-03-ACT-SLS           PIC  ZZZ,ZZ9.99.            09410000
094200     05  FILLER                       PIC  X(01)     VALUE SPACES.09420000
094300     05  DTL-BYR-03-FCST-SLS          PIC  ZZZ,ZZ9.99.            09430000
094400     05  FILLER                       PIC  X(04)     VALUE SPACES.09440000
094500     05  DTL-BYR-03-LEFT-PARA         PIC  X(01)     VALUE SPACES.09450000
094600     05  DTL-BYR-03-VOL-CHG           PIC  ZZZZZZ.Z.              09460000
094700     05  DTL-BYR-03-VOL-CHG-PCT       PIC  X(01)     VALUE SPACES.09470000
094800     05  DTL-BYR-03-RIGHT-PARA        PIC  X(01)     VALUE SPACES.09480000
094900     05  FILLER                       PIC  X(04)     VALUE SPACES.09490000
095000     05  DTL-BYR-03-ACT-MKDN          PIC  ZZZ,ZZ9.99.            09500000
095100     05  FILLER                       PIC  X(01)     VALUE SPACES.09510000
095200     05  DTL-BYR-03-FCST-MKDN         PIC  ZZZ,ZZ9.99.            09520000
095300     05  FILLER                       PIC  X(03)     VALUE SPACES.09530000
095400     05  DTL-BYR-03-ACT-UNT-SLD       PIC  ZZZ,ZZ9.99.            09540000
095500     05  FILLER                       PIC  X(01)     VALUE SPACES.09550000
095600     05  DTL-BYR-03-FCST-UNT-SLD      PIC  ZZZ,ZZ9.99.            09560000
095700     05  FILLER                       PIC  X(03)     VALUE SPACES.09570000
095800     05  DTL-BYR-03-ACT-PREP-UNT      PIC  ZZZ,ZZ9.99.            09580000
095900     05  FILLER                       PIC  X(01)     VALUE SPACES.09590000
096000     05  DTL-BYR-03-FCST-PREP-UNT     PIC  ZZZ,ZZ9.99.            09600000
096100     05  FILLER                       PIC  X(05)     VALUE SPACES.09610000
096200     05  DTL-BYR-03-ACT-MKUP-PCT      PIC  Z9.9.                  09620000
096300     05  DTL-BYR-03-ACT-MKUP-PCT-SN   PIC  X(01)     VALUE SPACES.09630000
096400     05  FILLER                       PIC  X(03)     VALUE SPACES.09640000
096500     05  DTL-BYR-03-FCST-MKUP-PCT     PIC  Z9.9.                  09650000
096600     05  DTL-BYR-03-FCST-MKUP-PCT-SN  PIC  X(01)     VALUE SPACES.09660000
096700                                                                  09670000
096800 01 DTL-BYR-TOTAL-04.                                             09680000
096900     05  DTL-BYR-04-TITLE             PIC  X(30)     VALUE SPACES.09690000
097000     05  FILLER                       PIC  X(35)     VALUE SPACES.09700000
097100     05  DTL-BYR-04-ACT-SLS           PIC  Z9.9.                  09710000
097200     05  DTL-BYR-04-ACT-SLS-PCT       PIC  X(01)     VALUE SPACES.09720000
097300     05  FILLER                       PIC  X(06)     VALUE SPACES.09730000
097400     05  DTL-BYR-04-FCST-SLS          PIC  Z9.9.                  09740000
097500     05  DTL-BYR-04-FCST-SLS-PCT      PIC  X(01)     VALUE SPACES.09750000
097600     05  FILLER                       PIC  X(24)     VALUE SPACES.09760000
097700     05  DTL-BYR-04-ACT-MKDN          PIC  Z9.9.                  09770000
097800     05  DTL-BYR-04-ACT-MKDN-PCT      PIC  X(01)     VALUE SPACES.09780000
097900     05  FILLER                       PIC  X(06)     VALUE SPACES.09790000
098000     05  DTL-BYR-04-FCST-MKDN         PIC  Z9.9.                  09800000
098100     05  DTL-BYR-04-FCST-MKDN-PCT     PIC  X(01)     VALUE SPACES.09810000
098200                                                                  09820000
098300 01 DTL-DIVISION-LINE.                                            09830000
098400     05  FILLER                       PIC X(57)  VALUE            09840000
098500     '---------------------------------------------------------'. 09850000
098600     05  FILLER                       PIC X(57)  VALUE            09860000
098700     '---------------------------------------------------------'. 09870000
098800     05  FILLER                       PIC X(57)  VALUE            09880000
098900     '---------------------------------------------------------'. 09890000
099000     05  FILLER                       PIC X(29)  VALUE            09900000
099100                                 '-----------------------------'. 09910000
099200                                                                  09920000
099300 01 END-OF-REPORT-LINE.                                           09930000
099400     05  FILLER                       PIC X(88)  VALUE SPACES.    09940000
099500     05  FILLER                       PIC X(24)  VALUE            09950000
099600                                      '***** END OF REPORT ****'. 09960000
099700     05  FILLER                       PIC X(88)  VALUE SPACES.    09970000
099800                                                                  09980000
099900***************************************************************** 09990000
100000*  STANDARD HEADER LINE - KOHLS 200 COL                         * 10000000
100100***************************************************************** 10010000
100200     COPY DPWS200O.                                               10020000
100300                                                                  10030000
100400***************************************************************** 10040000
100500*  DATE VALIDATION CALLING PARAMETER LIST                         10050000
100600***************************************************************** 10060000
100700     COPY DPWS500.                                                10070000
100800                                                                  10080000
100900***************************************************************** 10090000
101000*                      O  R  A  C  L  E                           10100000
101100*================================================================ 10110000
101200* ORACLE DECLARE SECTION                                          10120000
101300* ORACLE USED AND RETURNED VARIABLES                              10130000
101400***************************************************************** 10140000
101500     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     10150000
101600                                                                  10160000
101700***************************************************************** 10170000
101800* ORACLE LOGON WORKING STORAGE COPYBOOK                           10180000
101900***************************************************************** 10190000
102000 01      PC-ENT01-TYPE-CDE          PIC X(02)      VALUE '01'.    10200000
102100 01      PV-ORACLE-ID               PIC X(1)       VALUE '/'.     10210000
102200                                                                  10220000
102300 01      USERNAME                   PIC X(10)      VARYING.       10230000
102400 01      PASSWD                     PIC X(10)      VARYING.       10240000
102500                                                                  10250000
102600 01      ORACLE-RETURN              PIC X(200)     VALUE SPACES.  10260000
102700                                                                  10270000
102800     EXEC SQL END DECLARE SECTION END-EXEC.                       10280000
102900     EXEC SQL INCLUDE SQLCACOB    END-EXEC.                       10290000
103000                                                                  10300000
103100********************                                              10310000
103200 EJECT                                                            10320000
103300********************                                              10330000
103400 PROCEDURE DIVISION.                                              10340000
103500********************                                              10350000
103600***************************************************************** 10360000
103700* A100-MAINLINE.                                                * 10370000
103800* ==> PROCESSES:                                                * 10380000
103900* ==> PERFORMED FROM: START                                     * 10390000
104000***************************************************************** 10400000
104100 A100-MAINLINE.                                                   10410000
104200                                                                  10420000
104300     SET PS-CONTROL-CARD-START TO TRUE.                           10430000
104400                                                                  10440000
104500     PERFORM B100-OPEN-FILES.                                     10450000
104600     PERFORM B200-READ-CONTROL-CARD.                              10460000
104700                                                                  10470000
070941*    PERFORM PM700-A000-ORACLE-SETUP.                             10480022
070941     PERFORM B110-ORACLE-SETUP.                                   10481020
104900                                                                  10490000
105000     PERFORM C100-FIND-DATES.                                     10500000
105100                                                                  10510000
105200     PERFORM C200-DECLARE-AD-EVNT-CSR.                            10520000
105300     PERFORM C300-OPEN-AD-EVNT-CSR.                               10530000
105400     PERFORM C400-FETCH-AD-EVNT-CSR.                              10540000
105500     PERFORM C500-PROCESS-AD-EVNT-CSR                             10550000
105600         UNTIL PS-END-OF-ADEVNT-CSR.                              10560000
105700     PERFORM C600-CLOSE-AD-EVNT-CSR.                              10570000
105800                                                                  10580000
105900     PERFORM B900-CLOSE-FILES.                                    10590000
106000                                                                  10600000
106100     STOP RUN.                                                    10610000
106200                                                                  10620000
106300***************************************************************** 10630000
106400* B100-OPEN-FILES.                                              * 10640000
106500* ==> PROCESSES:                                                * 10650000
106600*  - OPEN THE CONTROL CARD AND REPORT FILE                      * 10660000
106700* ==> PERFORMED FROM: A100-MAINLINE                             * 10670000
106800***************************************************************** 10680000
106900 B100-OPEN-FILES.                                                 10690000
107000                                                                  10700000
107100     OPEN INPUT  CONTROL-CARD-1                                   10710000
107200          OUTPUT AD-EVNT-SUMM-REPORT.                             10720000
107300                                                                  10730000
070941                                                                  10732020
070941 B110-ORACLE-SETUP.                                               10733020
070941                                                                  10734020
070941     OPEN INPUT ORACLE-LOGON-FILE.                                10735020
070941                                                                  10736020
070941     PERFORM B120-READ-ORACLE-LOGON.                              10737020
070941                                                                  10738020
070941     CLOSE ORACLE-LOGON-FILE.                                     10739020
070941                                                                  10739120
070941     IF ((PS-END-OF-LOGON-FILE)                                   10739220
070941             OR (CC-ORACLE-CONNECTION = SPACES))                  10739320
070941         DISPLAY '** ABEND **'                                    10739420
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          10739520
070941                 ' - ORACLE LOGON CONTROL CARD '                  10739620
070941                   'NOT PROVIDED'                                 10739720
070941         SET PS-ORA-SRC-EMPTY TO TRUE                             10739820
070941         CALL 'ILBOABN0' USING ABEND-CODE                         10739920
070941     END-IF.                                                      10740020
070941                                                                  10740120
070941     IF CC-AUTO-LOGON                                             10740220
070941         DISPLAY PC-CURRENT-PROGRAM-NAME ' - AUTO LOGON TO ORACLE'10740320
070941         EXEC SQL                                                 10740420
070941              CONNECT :USERNAME                                   10740520
070941         END-EXEC                                                 10740620
070941     ELSE                                                         10740720
070941         INITIALIZE PV-ORACLE-USERID-LEN                          10740820
070941                    PV-ORACLE-PASSWORD-LEN                        10740920
070941         INSPECT CC-ORACLE-USERID                                 10741020
070941             TALLYING PV-ORACLE-USERID-LEN                        10741120
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     10741220
070941      INSPECT CC-ORACLE-PASSWORD                                  10741320
070941          TALLYING PV-ORACLE-PASSWORD-LEN                         10741420
070941          FOR CHARACTERS BEFORE INITIAL SPACE                     10741520
070941      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           10741620
070941                USERNAME-ARR                                      10741720
070941      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   10741820
070941      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       10741920
070941                PASSWD-ARR                                        10742020
070941      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   10742120
070941      DISPLAY PC-CURRENT-PROGRAM-NAME                             10742220
070941              ' - LOGON TO ORACLE AS USER '                       10742320
070941                USERNAME-ARR                                      10742420
070941      EXEC SQL                                                    10742520
070941        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   10742620
070941      END-EXEC                                                    10742720
070941      INITIALIZE CC-ORACLE-PASSWORD                               10742820
070941                 PASSWD                                           10742920
070941      END-IF.                                                     10743020
070941                                                                  10743120
070941     IF (SQLCODE NOT = 0)                                         10743220
070941         DISPLAY PV-PARAGRAPH-NAME                                10743320
070941         DISPLAY PC-CURRENT-PROGRAM-NAME                          10743420
070941                 ' - ERROR LOGGING ON TO ORACLE'                  10743520
070941         PERFORM Z100-ABEND                                       10743620
070941     END-IF.                                                      10743720
070941                                                                  10743820
070941******************************************************************10743920
070941* NEEDS TO BE IN FOR NOW TIL KURT FIXES CURSOR SHARING BUG        10744020
070941* OTHERWISE GET AN ORACLE ERROR (IE: 3113).                       10744120
070941******************************************************************10744220
070941     EXEC SQL                                                     10744320
070941      ALTER SESSION                                               10744420
070941            SET CURSOR_SHARING = 'EXACT'                          10744520
070941     END-EXEC.                                                    10744620
070941                                                                  10744720
070941                                                                  10744820
070941***************************************************************** 10744920
070941*  B120-READ-ORACLE-LOGON.                                      * 10745020
070941* ==> PROCESSES:                                                * 10745120
070941*   - READ ORCALE CONTROL CARD                                  * 10745220
070941* ==> PERFORMED FROM:  B110-ORACLE-SETUP                        * 10745320
070941***************************************************************** 10745420
070941 B120-READ-ORACLE-LOGON.                                          10745520
070941                                                                  10745620
070941     READ ORACLE-LOGON-FILE                                       10745720
070941         INTO CC-ORACLE-CONNECTION                                10745820
070941         AT END                                                   10745920
070941             SET PS-END-OF-LOGON-FILE TO TRUE                     10746020
070941     END-READ.                                                    10746120
070941                                                                  10746221
107400***************************************************************** 10747000
107500* B200-READ-CONTROL-CARD.                                       * 10750000
107600* ==> PROCESSES:                                                * 10760000
107700*  - READ IN THE CONTROL CARD                                   * 10770000
107800* ==> PERFORMED FROM: A100-MAINLINE                             * 10780000
107900***************************************************************** 10790000
108000 B200-READ-CONTROL-CARD.                                          10800000
108100                                                                  10810000
108200     READ CONTROL-CARD-1 INTO CC-CONTROL-CARD                     10820000
108300        AT END                                                    10830000
108400           SET PS-CONTROL-CARD-END TO TRUE                        10840000
108500     END-READ.                                                    10850000
108600                                                                  10860000
108700     IF PS-CONTROL-CARD-END                                       10870000
108800         MOVE 'NO CONTROL CARD TO PROCESS'                        10880000
108900                                           TO PV-OPERATION-MSG-1  10890000
109000         SET ABEND-4003-CTRL-CARD-ERROR    TO TRUE                10900000
109100         PERFORM Z910-ABEND                                       10910000
109200     ELSE                                                         10920000
109300         DISPLAY 'CC-RUN-DATE  = ' CC-RUN-DATE                    10930000
109400         DISPLAY 'CC-SUB-DAYS  = ' CC-SUB-DAYS                    10940000
109500     END-IF.                                                      10950000
109600                                                                  10960000
109700***************************************************************** 10970000
109800* B900-CLOSE-FILES                                              * 10980000
109900* ==> PROCESSES:                                                * 10990000
110000*  - CLOSE THE CONTROL CARD                                     * 11000000
110100* ==> PERFORMED FROM: A100-MAINLINE                             * 11010000
110200***************************************************************** 11020000
110300 B900-CLOSE-FILES.                                                11030000
110400                                                                  11040000
110500     CLOSE  CONTROL-CARD-1                                        11050000
110600            AD-EVNT-SUMM-REPORT.                                  11060000
110700                                                                  11070000
110800***************************************************************** 11080000
110900* C100-FIND-DATES                                               * 11090000
111000* ==> PROCESSES:                                                * 11100000
111100*  - SINCE NO TABLE IS ACTUALLY USED WE USE THE DUAL TABLE      * 11110000
111200*  - FIND THE END DATE THAT IS TO BE USED AND THE SYSDATE       * 11120000
111300* ==> SQLCODE:                                                  * 11130000
111400*  - 0 = A ROW WAS FOUND.                                       * 11140000
111500* ==> PERFORMED FROM: A100-MAINLINE                             * 11150000
111600***************************************************************** 11160000
111700 C100-FIND-DATES.                                                 11170000
111800                                                                  11180000
111900     EXEC SQL                                                     11190000
112000         SELECT                                                   11200000
112100             TO_CHAR((TO_DATE(:CC-RUN-DATE, 'YYYYMMDD')           11210000
112200                       - :CC-SUB-DAYS), 'MM/DD/YYYY')             11220000
112300             ,SYSDATE                                             11230000
112400         INTO                                                     11240000
112500             :PV-END-DATE                                         11250000
112600            ,:PV-ORIG-SYS-DATE                                    11260000
112700         FROM                                                     11270000
112800             DUAL                                                 11280000
112900     END-EXEC.                                                    11290000
113000                                                                  11300000
113100     EVALUATE TRUE                                                11310000
113200       WHEN SQLCODE = ZERO                                        11320000
113300         MOVE PV-ORIG-SYS-DATE       TO PV-SYS-DATE               11330000
113400                                                                  11340000
113500         STRING PV-END-DATE DELIMITED BY SPACE                    11350000
113600            PC-SPACE DELIMITED BY SIZE                            11360000
113700            PC-BEG-TMST   DELIMITED BY SIZE                       11370000
113800            INTO PV-END-DATE-STRT-TMST                            11380000
113900                                                                  11390000
114000         STRING PV-END-DATE DELIMITED BY SPACE                    11400000
114100            PC-SPACE DELIMITED BY SIZE                            11410000
114200            PC-END-TMST   DELIMITED BY SIZE                       11420000
114300            INTO PV-END-DATE-END-TMST                             11430000
114400                                                                  11440000
114500         PERFORM Z025-FORMAT-HEADER-DATE                          11450000
114600                                                                  11460000
114700         DISPLAY 'PV-END-DATE-STRT-TMST = ' PV-END-DATE-STRT-TMST 11470000
114800         DISPLAY 'PV-END-DATE-END-TMST = ' PV-END-DATE-END-TMST   11480000
114900                                                                  11490000
115000       WHEN OTHER                                                 11500000
115100         MOVE SQLCODE               TO PV-SQL                     11510000
115200         MOVE 'DUAL'                TO PV-TABLE-NAME              11520000
115300         MOVE 'C100-FIND-DATES'     TO PV-PARAGRAPH-NAME          11530000
115400         PERFORM Z100-ABEND                                       11540000
115500     END-EVALUATE.                                                11550000
115600                                                                  11560000
115700***************************************************************** 11570000
115800* C105-FIND-ACT-ADEVNT-TOTALS                                   * 11580000
115900* ==> PROCESSES:                                                * 11590000
116000*  - FIND THE ACTUAL AD EVENT TOTALS.  WILL BE USED LATER FOR   * 11600000
116100*    CALCULATIONS.                                              * 11610000
116200* ==> SQLCODE:                                                  * 11620000
116300*  - 0 = A ROW WAS FOUND.                                       * 11630000
116400* ==> PERFORMED FROM: C500-PROCESS-AD-EVNT-CSR.                 * 11640000
116500***************************************************************** 11650000
116600 C105-FIND-ACT-ADEVNT-TOTALS.                                     11660000
116700                                                                  11670000
116800     EXEC SQL                                                     11680000
116900         SELECT                                                   11690000
117000              ROUND(SUM(C.SLS_RTL_AMT) / 1000, 2)                 11700000
117100             ,ROUND(SUM(C.MKDN_RTL_AMT) / 1000, 2)                11710000
117200             ,ROUND(SUM(C.SLS_UNT_QTY) / 1000, 2)                 11720000
117300             ,ROUND(SUM(B.ACTL_PREP_UNT_QTY),2)                   11730000
117400             ,ROUND(SUM(C.SLS_COST_AMT) / 1000, 2)                11740000
117500             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   11750000
117600                 ROUND(((SUM(C.SLS_RTL_AMT) - SUM(C.SLS_COST_AMT))11760000
117700                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 11770000
117800         INTO                                                     11780000
117900              :PV-ACT-ADEVNT-SLS-VOL                              11790000
118000                                   :PV-ACT-ADEVNT-SLS-VOL-NULL    11800002
118100             ,:PV-ACT-ADEVNT-MKDN-DOL                             11810000
118200                                   :PV-ACT-ADEVNT-MKDN-DOL-NULL   11820002
118300             ,:PV-ACT-ADEVNT-UNIT-SOLD                            11830000
118400                                   :PV-ACT-ADEVNT-UNIT-SOLD-NULL  11840002
118500             ,:PV-ACT-ADEVNT-PREP-UNITS                           11850000
118600                                   :PV-ACT-ADEVNT-PREP-UNITS-NULL 11860000
118700             ,:PV-ACT-ADEVNT-SLS-COST                             11870000
118800                                   :PV-ACT-ADEVNT-SLS-COST-NULL   11880002
118900             ,:PV-ACT-ADEVNT-MKUP-PCT                             11890000
119000                                   :PV-ACT-ADEVNT-MKUP-PCT-NULL   11900002
119100         FROM                                                     11910000
119200              PMV_PROMO_DIM A                                     11920000
119300             ,PMT_PROMO_ITM B                                     11930000
119400             ,PMT_PROMO_ITM_FCT C                                 11940000
119500         WHERE                                                    11950000
119600              A.PROMO_ID = B.PROMO_ID                             11960000
119700          AND B.PROMO_ID = C.PROMO_ID                             11970000
119800          AND B.PROMO_ITM_ID = C.PROMO_ITM_ID                     11980000
119900          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       11990000
120000     END-EXEC.                                                    12000000
120100                                                                  12010000
120200     EVALUATE TRUE                                                12020000
120300         WHEN SQLCODE = ZERO                                      12030000
120400             IF PV-ACT-ADEVNT-PREP-UNITS-NULL < 0                 12040000
120500                MOVE ZEROES TO PV-ACT-ADEVNT-PREP-UNITS           12050000
120600             END-IF                                               12060000
120700         WHEN OTHER                                               12070000
120800             DISPLAY PV-ACT-ADEVNT-SLS-VOL                        12080001
120900             DISPLAY PV-ACT-ADEVNT-MKDN-DOL                       12090001
121000             DISPLAY PV-ACT-ADEVNT-UNIT-SOLD                      12100001
121100             DISPLAY PV-ACT-ADEVNT-PREP-UNITS                     12110001
121200             DISPLAY PV-ACT-ADEVNT-SLS-COST                       12120001
121300             DISPLAY PV-ACT-ADEVNT-MKUP-PCT                       12130001
121400             DISPLAY 'ADEVENT ID = ' PV-AD-EVNT-ID                12140000
121500             MOVE 'C105-FIND-ACT-ADEVNT-TOTALS    '               12150000
121600                               TO PV-PARAGRAPH-NAME               12160000
121700             PERFORM Z100-ABEND                                   12170000
121800     END-EVALUATE.                                                12180000
121900                                                                  12190000
122000***************************************************************** 12200000
122100* C110-FIND-FCST-ADEVNT-TOTALS                                  * 12210000
122200* ==> PROCESSES:                                                * 12220000
122300*  - FIND THE FORECAST AD EVENT TOTALS.  WILL BE USE LATER FOR  * 12230000
122400*    CALCULATIONS.                                              * 12240000
122500* ==> SQLCODE:                                                  * 12250000
122600*  - 0 = A ROW WAS FOUND.                                       * 12260000
122700* ==> PERFORMED FROM: C500-PROCESS-AD-EVNT-CSR.                 * 12270000
122800***************************************************************** 12280000
122900 C110-FIND-FCST-ADEVNT-TOTALS.                                    12290000
123000                                                                  12300000
123100     EXEC SQL                                                     12310000
123200         SELECT                                                   12320000
123300              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       12330000
123400             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      12340000
123500             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       12350000
123600             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  12360000
123700             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      12370000
123800             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   12380000
123900                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  12390000
124000                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 12400000
124100         INTO                                                     12410000
124200              :PV-FCST-ADEVNT-SLS-VOL                             12420000
124300                                  :PV-FCST-ADEVNT-SLS-VOL-NULL    12430000
124400             ,:PV-FCST-ADEVNT-MKDN-DOL                            12440000
124500                                  :PV-FCST-ADEVNT-MKDN-DOL-NULL   12450000
124600             ,:PV-FCST-ADEVNT-UNIT-SOLD                           12460000
124700                                  :PV-FCST-ADEVNT-UNIT-SOLD-NULL  12470000
124800             ,:PV-FCST-ADEVNT-PREP-UNITS                          12480000
124900                                  :PV-FCST-ADEVNT-PREP-UNITS-NULL 12490000
125000             ,:PV-FCST-ADEVNT-SLS-COST                            12500000
125100                                  :PV-FCST-ADEVNT-SLS-COST-NULL   12510000
125200             ,:PV-FCST-ADEVNT-MKUP-PCT                            12520000
125300                                  :PV-FCST-ADEVNT-MKUP-PCT-NULL   12530000
125400         FROM                                                     12540000
125500              PMV_PROMO_DIM A                                     12550000
125600             ,PMT_PROMO_ITM B                                     12560000
125700             ,PMT_PROMO_ITM_FCST C                                12570000
125800         WHERE                                                    12580000
125900              A.PROMO_ID = B.PROMO_ID                             12590000
126000          AND B.PROMO_ITM_ID = C.PROMO_ITM_ID                     12600000
126100          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       12610000
126200     END-EXEC.                                                    12620000
126300                                                                  12630000
126400     EVALUATE TRUE                                                12640000
126500         WHEN SQLCODE = ZERO                                      12650000
126600             CONTINUE                                             12660000
126700                                                                  12670000
126800         WHEN OTHER                                               12680000
126900             MOVE 'C110-FIND-FCST-ADEVNT-TOTALS '                 12690000
127000                               TO PV-PARAGRAPH-NAME               12700000
127100             PERFORM Z100-ABEND                                   12710000
127200     END-EVALUATE.                                                12720000
127300                                                                  12730000
127400***************************************************************** 12740000
127500* C115-FIND-ACT-GMA-TOTALS                                      * 12750000
127600* ==> PROCESSES:                                                * 12760000
127700*  - FIND THE ACTUAL GMA TOTALS.  WILL BE USED LATER FOR        * 12770000
127800*    CALCULATIONS.                                              * 12780000
127900* ==> SQLCODE:                                                  * 12790000
128000*  - 0 = A ROW WAS FOUND.                                       * 12800000
128100* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 12810000
128200***************************************************************** 12820000
128300 C115-FIND-ACT-GMA-TOTALS.                                        12830000
128400                                                                  12840000
128500     EXEC SQL                                                     12850000
128600         SELECT                                                   12860000
128700              ROUND(SUM(C.SLS_RTL_AMT) / 1000, 2)                 12870000
128800             ,ROUND(SUM(C.MKDN_RTL_AMT) / 1000, 2)                12880000
128900             ,ROUND(SUM(C.SLS_UNT_QTY) / 1000, 2)                 12890000
129000             ,ROUND(SUM(B.ACTL_PREP_UNT_QTY),2)                   12900000
129100             ,ROUND(SUM(C.SLS_COST_AMT) / 1000, 2)                12910000
129200             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   12920000
129300                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  12930000
129400                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 12940000
129500         INTO                                                     12950000
129600              :PV-ACT-GMA-SLS-VOL    :PV-ACT-GMA-SLS-VOL-NULL     12960000
129700             ,:PV-ACT-GMA-MKDN-DOL   :PV-ACT-GMA-MKDN-DOL-NULL    12970000
129800             ,:PV-ACT-GMA-UNIT-SOLD  :PV-ACT-GMA-UNIT-SOLD-NULL   12980000
129900             ,:PV-ACT-GMA-PREP-UNITS :PV-ACT-GMA-PREP-UNITS-NULL  12990000
130000             ,:PV-ACT-GMA-SLS-COST   :PV-ACT-GMA-SLS-COST-NULL    13000000
130100             ,:PV-ACT-GMA-MKUP-PCT   :PV-ACT-GMA-MKUP-PCT-NULL    13010000
130200         FROM                                                     13020000
130300              PMV_PROMO_DIM A                                     13030000
130400             ,PMT_PROMO_ITM B                                     13040000
130500             ,PMT_PROMO_ITM_FCT C                                 13050000
130600             ,PMV_PRSN_MDSE_HIER D                                13060000
130700         WHERE                                                    13070000
130800              A.PROMO_ID = B.PROMO_ID                             13080000
130900          AND B.PROMO_ID = C.PROMO_ID                             13090000
131000          AND B.PROMO_ITM_ID = C.PROMO_ITM_ID                     13100000
131100          AND D.DEPT_NBR = B.DEPT_NBR                             13110000
131200          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       13120000
131300          AND D.GMA_NBR = :PV-GMA-NBR                             13130000
131400     END-EXEC.                                                    13140000
131500                                                                  13150000
131600     EVALUATE TRUE                                                13160000
131700         WHEN SQLCODE = ZERO                                      13170000
131800             CONTINUE                                             13180000
131900                                                                  13190000
132000         WHEN OTHER                                               13200000
132100             DISPLAY 'AD EVENT = ' PV-AD-EVNT-ID                  13210000
132200             DISPLAY 'GMA NBR = ' PV-GMA-NBR                      13220000
132300             MOVE 'C115-FIND-ACT-GMA-TOTALS'                      13230000
132400                               TO PV-PARAGRAPH-NAME               13240000
132500             PERFORM Z100-ABEND                                   13250000
132600     END-EVALUATE.                                                13260000
132700                                                                  13270000
132800***************************************************************** 13280000
132900* C120-FIND-FCST-GMA-TOTALS                                     * 13290000
133000* ==> PROCESSES:                                                * 13300000
133100*  - FIND THE FORECAST GMA TOTALS.  WILL BE USED LATER FOR      * 13310000
133200*    CALCULATIONS.                                              * 13320000
133300* ==> SQLCODE:                                                  * 13330000
133400*  - 0 = A ROW WAS FOUND.                                       * 13340000
133500* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 13350000
133600***************************************************************** 13360000
133700 C120-FIND-FCST-GMA-TOTALS.                                       13370000
133800                                                                  13380000
133900     EXEC SQL                                                     13390000
134000         SELECT                                                   13400000
134100              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       13410000
134200             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      13420000
134300             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       13430000
134400             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  13440000
134500             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      13450000
134600             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   13460000
134700                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  13470000
134800                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 13480000
134900         INTO                                                     13490000
135000              :PV-FCST-GMA-SLS-VOL    :PV-FCST-GMA-SLS-VOL-NULL   13500000
135100             ,:PV-FCST-GMA-MKDN-DOL   :PV-FCST-GMA-MKDN-DOL-NULL  13510000
135200             ,:PV-FCST-GMA-UNIT-SOLD  :PV-FCST-GMA-UNIT-SOLD-NULL 13520000
135300             ,:PV-FCST-GMA-PREP-UNITS :PV-FCST-GMA-PREP-UNITS-NULL13530000
135400             ,:PV-FCST-GMA-SLS-COST   :PV-FCST-GMA-SLS-COST-NULL  13540000
135500             ,:PV-FCST-GMA-MKUP-PCT   :PV-FCST-GMA-MKUP-PCT-NULL  13550000
135600         FROM                                                     13560000
135700              PMV_PROMO_DIM A                                     13570000
135800             ,PMT_PROMO_ITM B                                     13580000
135900             ,PMT_PROMO_ITM_FCST C                                13590000
136000             ,PMV_PRSN_MDSE_HIER D                                13600000
136100         WHERE                                                    13610000
136200              A.PROMO_ID = B.PROMO_ID                             13620000
136300          AND B.PROMO_ITM_ID = C.PROMO_ITM_ID                     13630000
136400          AND D.DEPT_NBR = B.DEPT_NBR                             13640000
136500          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       13650000
136600          AND D.GMA_NBR = :PV-GMA-NBR                             13660000
136700     END-EXEC.                                                    13670000
136800                                                                  13680000
136900     EVALUATE TRUE                                                13690000
137000         WHEN SQLCODE = ZERO                                      13700000
137100             CONTINUE                                             13710000
137200                                                                  13720000
137300         WHEN OTHER                                               13730000
137400             DISPLAY 'AD EVENT ID = ' PV-AD-EVNT-ID               13740000
137500             DISPLAY 'GMA NBR     = ' PV-GMA-NBR                  13750000
137600             MOVE 'C120-FIND-FCST-GMA-TOTALS'                     13760000
137700                               TO PV-PARAGRAPH-NAME               13770000
137800             PERFORM Z100-ABEND                                   13780000
137900     END-EVALUATE.                                                13790000
138000                                                                  13800000
138100***************************************************************** 13810000
138200* C125-FIND-ACT-ADV-DMA-PROMO                                   * 13820000
138300* ==> PROCESSES:                                                * 13830000
138400*  - FIND THE ACT DMA TOTALS.                                   * 13840000
138500* ==> PERFORMED FROM: D100-PROCESS-DMA-PROMO-TOT                * 13850000
138600***************************************************************** 13860000
138700 C125-FIND-ACT-ADV-DMA-PROMO.                                     13870000
138800                                                                  13880000
138900     EXEC SQL                                                     13890000
139000         SELECT                                                   13900000
139100              A.SLS_RTL_AMT                                       13910000
139200             ,A.MKDN_RTL_AMT                                      13920000
139300             ,A.SLS_UNT_QTY                                       13930000
139400             ,A.ACTL_PREP_UNT_QTY                                 13940000
139500             ,A.SLS_COST_AMT                                      13950000
139600             ,A.TOT_MKUP_PCT                                      13960000
139700         INTO                                                     13970000
139800              :PV-ACT-DMA-SLS-VOL     :PV-ACT-DMA-SLS-VOL-NULL    13980000
139900             ,:PV-ACT-DMA-MKDN-DOL    :PV-ACT-DMA-MKDN-DOL-NULL   13990000
140000             ,:PV-ACT-DMA-UNIT-SOLD   :PV-ACT-DMA-UNIT-SOLD-NULL  14000000
140100             ,:PV-ACT-DMA-PREP-UNITS  :PV-ACT-DMA-PREP-UNITS-NULL 14010000
140200             ,:PV-ACT-DMA-SLS-COST    :PV-ACT-DMA-SLS-COST-NULL   14020000
140300             ,:PV-ACT-DMA-MKUP-PCT    :PV-ACT-DMA-MKUP-PCT-NULL   14030000
140400         FROM                                                     14040000
140500              PMV_PROMO_DMA_SUM_ADV A                             14050000
140600         WHERE                                                    14060000
140700              A.DMA_NBR = :PV-DMA-NBR                             14070000
140800          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       14080000
140900          AND A.PROMO_ID = :PV-DMA-PROMO-ID                       14090000
141000     END-EXEC.                                                    14100000
141100                                                                  14110000
141200     EVALUATE TRUE                                                14120000
141300         WHEN SQLCODE = ZERO                                      14130000
141400             IF (PV-ACT-DMA-SLS-VOL = 0) AND                      14140000
141500                (PV-ACT-DMA-MKDN-DOL = 0) AND                     14150000
141600                (PV-ACT-DMA-UNIT-SOLD = 0) AND                    14160000
141700                (PV-ACT-DMA-PREP-UNITS = 0) AND                   14170000
141800                (PV-ACT-DMA-SLS-COST = 0) AND                     14180000
141900                (PV-ACT-DMA-MKUP-PCT = 0)                         14190000
142000                 SET PS-DMA-PROMO-TOT-NOT-EXIST TO TRUE           14200000
142100             ELSE                                                 14210000
142200                 SET PS-DMA-PROMO-TOT-EXIST TO TRUE               14220000
142300                 ADD 1 TO PA-DMA-PROMO-CNT                        14230000
142400             END-IF                                               14240000
142500                                                                  14250000
142600         WHEN SQLCODE = 1403                                      14260000
142700             SET PS-DMA-PROMO-TOT-NOT-EXIST TO TRUE               14270000
142800             MOVE ZEROS TO PV-ACT-DMA-SLS-VOL                     14280000
142900             MOVE ZEROS TO PV-ACT-DMA-MKDN-DOL                    14290000
143000             MOVE ZEROS TO PV-ACT-DMA-UNIT-SOLD                   14300000
143100             MOVE ZEROS TO PV-ACT-DMA-PREP-UNITS                  14310000
143200             MOVE ZEROS TO PV-ACT-DMA-SLS-COST                    14320000
143300             MOVE ZEROS TO PV-ACT-DMA-MKUP-PCT                    14330000
143400                                                                  14340000
143500         WHEN OTHER                                               14350000
143600             DISPLAY 'AD EVENT ID = ' PV-AD-EVNT-ID               14360000
143700             DISPLAY 'PROMO ID    = ' PV-DMA-PROMO-ID             14370000
143800             DISPLAY 'DMA NBR     = ' PV-DMA-NBR                  14380000
143900             MOVE 'C125-FIND-ACT-ADV-DMA-PROMO'                   14390000
144000                               TO PV-PARAGRAPH-NAME               14400000
144100             PERFORM Z100-ABEND                                   14410000
144200     END-EVALUATE.                                                14420000
144300                                                                  14430000
144400***************************************************************** 14440000
144500* C126-FIND-ACT-UNADV-DMA-PROMO                                 * 14450000
144600* ==> PROCESSES:                                                * 14460000
144700*  - FIND THE ACT DMA TOTALS.                                   * 14470000
144800* ==> PERFORMED FROM: D100-PROCESS-DMA-PROMO-TOT                * 14480000
144900***************************************************************** 14490000
145000 C126-FIND-ACT-UNADV-DMA-PROMO.                                   14500000
145100                                                                  14510000
145200     EXEC SQL                                                     14520000
145300         SELECT                                                   14530000
145400              A.SLS_RTL_AMT                                       14540000
145500             ,A.MKDN_RTL_AMT                                      14550000
145600             ,A.SLS_UNT_QTY                                       14560000
145700             ,A.ACTL_PREP_UNT_QTY                                 14570000
145800             ,A.SLS_COST_AMT                                      14580000
145900             ,A.TOT_MKUP_PCT                                      14590000
146000         INTO                                                     14600000
146100              :PV-ACT-DMA-SLS-VOL     :PV-ACT-DMA-SLS-VOL-NULL    14610000
146200             ,:PV-ACT-DMA-MKDN-DOL    :PV-ACT-DMA-MKDN-DOL-NULL   14620000
146300             ,:PV-ACT-DMA-UNIT-SOLD   :PV-ACT-DMA-UNIT-SOLD-NULL  14630000
146400             ,:PV-ACT-DMA-PREP-UNITS  :PV-ACT-DMA-PREP-UNITS-NULL 14640000
146500             ,:PV-ACT-DMA-SLS-COST    :PV-ACT-DMA-SLS-COST-NULL   14650000
146600             ,:PV-ACT-DMA-MKUP-PCT    :PV-ACT-DMA-MKUP-PCT-NULL   14660000
146700         FROM                                                     14670000
146800              PMV_PROMO_DMA_SUM_UNADV A                           14680000
146900         WHERE                                                    14690000
147000              A.DMA_NBR = :PV-DMA-NBR                             14700000
147100          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       14710000
147200     END-EXEC.                                                    14720000
147300                                                                  14730000
147400     EVALUATE TRUE                                                14740000
147500         WHEN SQLCODE = ZERO                                      14750000
147600             IF (PV-ACT-DMA-SLS-VOL = 0) AND                      14760000
147700                (PV-ACT-DMA-MKDN-DOL = 0) AND                     14770000
147800                (PV-ACT-DMA-UNIT-SOLD = 0) AND                    14780000
147900                (PV-ACT-DMA-PREP-UNITS = 0) AND                   14790000
148000                (PV-ACT-DMA-SLS-COST = 0) AND                     14800000
148100                (PV-ACT-DMA-MKUP-PCT = 0)                         14810000
148200                 SET PS-DMA-PROMO-TOT-NOT-EXIST TO TRUE           14820000
148300             ELSE                                                 14830000
148400                 SET PS-DMA-PROMO-TOT-EXIST TO TRUE               14840000
148500                 ADD 1 TO PA-DMA-PROMO-CNT                        14850000
148600             END-IF                                               14860000
148700                                                                  14870000
148800         WHEN SQLCODE = 1403                                      14880000
148900             SET PS-DMA-PROMO-TOT-NOT-EXIST TO TRUE               14890000
149000             MOVE ZEROS TO PV-ACT-DMA-SLS-VOL                     14900000
149100             MOVE ZEROS TO PV-ACT-DMA-MKDN-DOL                    14910000
149200             MOVE ZEROS TO PV-ACT-DMA-UNIT-SOLD                   14920000
149300             MOVE ZEROS TO PV-ACT-DMA-PREP-UNITS                  14930000
149400             MOVE ZEROS TO PV-ACT-DMA-SLS-COST                    14940000
149500             MOVE ZEROS TO PV-ACT-DMA-MKUP-PCT                    14950000
149600                                                                  14960000
149700         WHEN OTHER                                               14970000
149800             DISPLAY 'AD EVENT ID = ' PV-AD-EVNT-ID               14980000
149900             DISPLAY 'PROMO ID    = ' PV-DMA-PROMO-ID             14990000
150000             DISPLAY 'DMA NBR     = ' PV-DMA-NBR                  15000000
150100             MOVE 'C126-FIND-ACT-UNADV-DMA-PROMO'                 15010000
150200                               TO PV-PARAGRAPH-NAME               15020000
150300             PERFORM Z100-ABEND                                   15030000
150400     END-EVALUATE.                                                15040000
150500                                                                  15050000
150600***************************************************************** 15060000
150700* C130-FIND-FCST-ADV-DMA-PROMO                                  * 15070000
150800* ==> PROCESSES:                                                * 15080000
150900*  - FIND THE FCST DMA TOTALS.                                  * 15090000
151000* ==> SQLCODE:                                                  * 15100000
151100*  - 0 = A ROW WAS FOUND.                                       * 15110000
151200* ==> PERFORMED FROM: D100-PROCESS-DMA-PROMO-TOT                * 15120000
151300***************************************************************** 15130000
151400 C130-FIND-FCST-ADV-DMA-PROMO.                                    15140000
151500                                                                  15150000
151600     EXEC SQL                                                     15160000
151700         SELECT                                                   15170000
151800              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       15180000
151900             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      15190000
152000             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       15200000
152100             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  15210000
152200             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      15220000
152300             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   15230000
152400                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  15240000
152500                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 15250000
152600         INTO                                                     15260000
152700              :PV-FCST-DMA-SLS-VOL    :PV-FCST-DMA-SLS-VOL-NULL   15270000
152800             ,:PV-FCST-DMA-MKDN-DOL   :PV-FCST-DMA-MKDN-DOL-NULL  15280000
152900             ,:PV-FCST-DMA-UNIT-SOLD  :PV-FCST-DMA-UNIT-SOLD-NULL 15290000
153000             ,:PV-FCST-DMA-PREP-UNITS :PV-FCST-DMA-PREP-UNITS-NULL15300000
153100             ,:PV-FCST-DMA-SLS-COST   :PV-FCST-DMA-SLS-COST-NULL  15310000
153200             ,:PV-FCST-DMA-MKUP-PCT   :PV-FCST-DMA-MKUP-PCT-NULL  15320000
153300         FROM                                                     15330000
153400              PMV_PROMO_DIM A                                     15340000
153500             ,PMV_PRSN_MDSE_HIER B                                15350000
153600             ,PMT_PROMO_ITM_FCST C                                15360000
153700             ,PMT_PROMO_ITM D                                     15370000
153800         WHERE                                                    15380000
153900              A.PROMO_ID = D.PROMO_ID                             15390000
154000          AND D.PROMO_ITM_ID = C.PROMO_ITM_ID                     15400000
154100          AND B.DEPT_NBR = D.DEPT_NBR                             15410000
154200          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       15420000
154300          AND A.PROMO_ID = :PV-DMA-PROMO-ID                       15430000
154400          AND B.DMA_NBR = :PV-DMA-NBR                             15440000
154500          AND D.PROMO_ITM_ID IN                                   15450000
154600                   (SELECT E.PROMO_ITM_ID                         15460000
154700                      FROM PMT_AD_SP_ASGMT E                      15470000
154800                     WHERE                                        15480000
154900                           E.PROMO_ITM_ID = D.PROMO_ITM_ID        15490000
155000                       AND E.STAT_CDE = 'S')                      15500000
155100     END-EXEC.                                                    15510000
155200                                                                  15520000
155300     EVALUATE TRUE                                                15530000
155400         WHEN SQLCODE = ZERO                                      15540000
155500             IF (PV-FCST-DMA-SLS-VOL = 0) AND                     15550000
155600                (PV-FCST-DMA-MKDN-DOL = 0) AND                    15560000
155700                (PV-FCST-DMA-UNIT-SOLD = 0) AND                   15570000
155800                (PV-FCST-DMA-PREP-UNITS = 0) AND                  15580000
155900                (PV-FCST-DMA-SLS-COST = 0) AND                    15590000
156000                (PV-FCST-DMA-MKUP-PCT = 0)                        15600000
156100                 CONTINUE                                         15610000
156200             ELSE                                                 15620000
156300                 IF PS-DMA-PROMO-TOT-NOT-EXIST                    15630000
156400                     ADD 1 TO PA-DMA-PROMO-CNT                    15640000
156500                 END-IF                                           15650000
156600                 SET PS-DMA-PROMO-TOT-EXIST TO TRUE               15660000
156700             END-IF                                               15670000
156800                                                                  15680000
156900         WHEN SQLCODE = 1403                                      15690000
157000             MOVE ZEROS TO PV-FCST-DMA-SLS-VOL                    15700000
157100             MOVE ZEROS TO PV-FCST-DMA-MKDN-DOL                   15710000
157200             MOVE ZEROS TO PV-FCST-DMA-UNIT-SOLD                  15720000
157300             MOVE ZEROS TO PV-FCST-DMA-PREP-UNITS                 15730000
157400             MOVE ZEROS TO PV-FCST-DMA-SLS-COST                   15740000
157500             MOVE ZEROS TO PV-FCST-DMA-MKUP-PCT                   15750000
157600                                                                  15760000
157700         WHEN OTHER                                               15770000
157800             DISPLAY 'AD EVENT ID = ' PV-AD-EVNT-ID               15780000
157900             DISPLAY 'PROMO ID    = ' PV-DMA-PROMO-ID             15790000
158000             DISPLAY 'DMA NBR     = ' PV-DMA-NBR                  15800000
158100             MOVE 'C130-FIND-FCST-ADV-DMA-PROMO'                  15810000
158200                               TO PV-PARAGRAPH-NAME               15820000
158300             PERFORM Z100-ABEND                                   15830000
158400     END-EVALUATE.                                                15840000
158500                                                                  15850000
158600***************************************************************** 15860000
158700* C131-FIND-FCST-UNADV-DMA-PROMO                                * 15870000
158800* ==> PROCESSES:                                                * 15880000
158900*  - FIND THE FCST DMA TOTALS.                                  * 15890000
159000* ==> SQLCODE:                                                  * 15900000
159100*  - 0 = A ROW WAS FOUND.                                       * 15910000
159200* ==> PERFORMED FROM: D100-PROCESS-DMA-PROMO-TOT                * 15920000
159300***************************************************************** 15930000
159400 C131-FIND-FCST-UNADV-DMA-PROMO.                                  15940000
159500                                                                  15950000
159600     EXEC SQL                                                     15960000
159700         SELECT                                                   15970000
159800              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       15980000
159900             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      15990000
160000             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       16000000
160100             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  16010000
160200             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      16020000
160300             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   16030000
160400                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  16040000
160500                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 16050000
160600         INTO                                                     16060000
160700              :PV-FCST-DMA-SLS-VOL    :PV-FCST-DMA-SLS-VOL-NULL   16070000
160800             ,:PV-FCST-DMA-MKDN-DOL   :PV-FCST-DMA-MKDN-DOL-NULL  16080000
160900             ,:PV-FCST-DMA-UNIT-SOLD  :PV-FCST-DMA-UNIT-SOLD-NULL 16090000
161000             ,:PV-FCST-DMA-PREP-UNITS :PV-FCST-DMA-PREP-UNITS-NULL16100000
161100             ,:PV-FCST-DMA-SLS-COST   :PV-FCST-DMA-SLS-COST-NULL  16110000
161200             ,:PV-FCST-DMA-MKUP-PCT   :PV-FCST-DMA-MKUP-PCT-NULL  16120000
161300         FROM                                                     16130000
161400              PMV_PROMO_DIM A                                     16140000
161500             ,PMV_PRSN_MDSE_HIER B                                16150000
161600             ,PMT_PROMO_ITM_FCST C                                16160000
161700             ,PMT_PROMO_ITM D                                     16170000
161800         WHERE                                                    16180000
161900              A.PROMO_ID = D.PROMO_ID                             16190000
162000          AND D.PROMO_ITM_ID = C.PROMO_ITM_ID                     16200000
162100          AND B.DEPT_NBR = D.DEPT_NBR                             16210000
162200          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       16220000
162300          AND B.DMA_NBR = :PV-DMA-NBR                             16230000
162400          AND (D.ADV_IND = 'N'                                    16240000
162500              OR  D.PROMO_ITM_ID NOT IN                           16250000
162600                   (SELECT E.PROMO_ITM_ID                         16260000
162700                      FROM PMT_AD_SP_ASGMT E                      16270000
162800                     WHERE                                        16280000
162900                           E.PROMO_ITM_ID = D.PROMO_ITM_ID        16290000
163000                       AND E.STAT_CDE = 'S'))                     16300000
163100     END-EXEC.                                                    16310000
163200                                                                  16320000
163300     EVALUATE TRUE                                                16330000
163400         WHEN SQLCODE = ZERO                                      16340000
163500             IF (PV-FCST-DMA-SLS-VOL = 0) AND                     16350000
163600                (PV-FCST-DMA-MKDN-DOL = 0) AND                    16360000
163700                (PV-FCST-DMA-UNIT-SOLD = 0) AND                   16370000
163800                (PV-FCST-DMA-PREP-UNITS = 0) AND                  16380000
163900                (PV-FCST-DMA-SLS-COST = 0) AND                    16390000
164000                (PV-FCST-DMA-MKUP-PCT = 0)                        16400000
164100                 CONTINUE                                         16410000
164200             ELSE                                                 16420000
164300                 IF PS-DMA-PROMO-TOT-NOT-EXIST                    16430000
164400                     ADD 1 TO PA-DMA-PROMO-CNT                    16440000
164500                 END-IF                                           16450000
164600                 SET PS-DMA-PROMO-TOT-EXIST TO TRUE               16460000
164700             END-IF                                               16470000
164800                                                                  16480000
164900         WHEN SQLCODE = 1403                                      16490000
165000             MOVE ZEROS TO PV-FCST-DMA-SLS-VOL                    16500000
165100             MOVE ZEROS TO PV-FCST-DMA-MKDN-DOL                   16510000
165200             MOVE ZEROS TO PV-FCST-DMA-UNIT-SOLD                  16520000
165300             MOVE ZEROS TO PV-FCST-DMA-PREP-UNITS                 16530000
165400             MOVE ZEROS TO PV-FCST-DMA-SLS-COST                   16540000
165500             MOVE ZEROS TO PV-FCST-DMA-MKUP-PCT                   16550000
165600                                                                  16560000
165700         WHEN OTHER                                               16570000
165800             DISPLAY 'AD EVENT ID = ' PV-AD-EVNT-ID               16580000
165900             DISPLAY 'PROMO ID    = ' PV-DMA-PROMO-ID             16590000
166000             DISPLAY 'DMA NBR     = ' PV-DMA-NBR                  16600000
166100             MOVE 'C131-FIND-FCST-UNADV-DMA-PROMO'                16610000
166200                               TO PV-PARAGRAPH-NAME               16620000
166300             PERFORM Z100-ABEND                                   16630000
166400     END-EVALUATE.                                                16640000
166500                                                                  16650000
166600***************************************************************** 16660000
166700* C135-FIND-ACT-ADV-DPT-PROMO                                   * 16670000
166800* ==> PROCESSES:                                                * 16680000
166900*  - FIND THE ACTUAL DPT TOTALS.                                * 16690000
167000* ==> SQLCODE:                                                  * 16700000
167100*  - 0 = A ROW WAS FOUND.                                       * 16710000
167200* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 16720000
167300***************************************************************** 16730000
167400 C135-FIND-ACT-ADV-DPT-PROMO.                                     16740000
167500                                                                  16750000
167600     EXEC SQL                                                     16760000
167700         SELECT                                                   16770000
167800              A.SLS_RTL_AMT                                       16780000
167900             ,A.MKDN_RTL_AMT                                      16790000
168000             ,A.SLS_UNT_QTY                                       16800000
168100             ,A.ACTL_PREP_UNT_QTY                                 16810000
168200             ,A.SLS_COST_AMT                                      16820000
168300             ,A.TOT_MKUP_PCT                                      16830000
168400         INTO                                                     16840000
168500              :PV-ACT-DPT-SLS-VOL    :PV-ACT-DPT-SLS-VOL-NULL     16850000
168600             ,:PV-ACT-DPT-MKDN-DOL   :PV-ACT-DPT-MKDN-DOL-NULL    16860000
168700             ,:PV-ACT-DPT-UNIT-SOLD  :PV-ACT-DPT-UNIT-SOLD-NULL   16870000
168800             ,:PV-ACT-DPT-PREP-UNITS :PV-ACT-DPT-PREP-UNITS-NULL  16880000
168900             ,:PV-ACT-DPT-SLS-COST   :PV-ACT-DPT-SLS-COST-NULL    16890000
169000             ,:PV-ACT-DPT-MKUP-PCT   :PV-ACT-DPT-MKUP-PCT-NULL    16900000
169100         FROM                                                     16910000
169200              PMV_PROMO_DEPT_SUM_ADV A                            16920000
169300         WHERE                                                    16930000
169400              A.DEPT_NBR = :PV-DPT-NBR                            16940000
169500          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       16950000
169600          AND A.PROMO_ID = :PV-DPT-PROMO-ID                       16960000
169700     END-EXEC.                                                    16970000
169800                                                                  16980000
169900     EVALUATE TRUE                                                16990000
170000         WHEN SQLCODE = ZERO                                      17000000
170100             IF (PV-ACT-DPT-SLS-VOL = 0) AND                      17010000
170200                (PV-ACT-DPT-MKDN-DOL = 0) AND                     17020000
170300                (PV-ACT-DPT-UNIT-SOLD = 0) AND                    17030000
170400                (PV-ACT-DPT-PREP-UNITS = 0) AND                   17040000
170500                (PV-ACT-DPT-SLS-COST = 0) AND                     17050000
170600                (PV-ACT-DPT-MKUP-PCT = 0)                         17060000
170700                 SET PS-DPT-PROMO-TOT-NOT-EXIST TO TRUE           17070000
170800             ELSE                                                 17080000
170900                 SET PS-DPT-PROMO-TOT-EXIST TO TRUE               17090000
171000                 SET PS-DPT-TOT-COMPUTE TO TRUE                   17100000
171100                 ADD 1 TO PA-DPT-PROMO-CNT                        17110000
171200             END-IF                                               17120000
171300                                                                  17130000
171400         WHEN SQLCODE = 1403                                      17140000
171500             SET PS-DPT-PROMO-TOT-NOT-EXIST TO TRUE               17150000
171600             MOVE ZEROS TO PV-ACT-DPT-SLS-VOL                     17160000
171700             MOVE ZEROS TO PV-ACT-DPT-MKDN-DOL                    17170000
171800             MOVE ZEROS TO PV-ACT-DPT-UNIT-SOLD                   17180000
171900             MOVE ZEROS TO PV-ACT-DPT-PREP-UNITS                  17190000
172000             MOVE ZEROS TO PV-ACT-GMA-SLS-COST                    17200000
172100             MOVE ZEROS TO PV-ACT-DPT-MKUP-PCT                    17210000
172200                                                                  17220000
172300         WHEN OTHER                                               17230000
172400             MOVE 'C135-FIND-ACT-ADV-DPT-PROMO'                   17240000
172500                               TO PV-PARAGRAPH-NAME               17250000
172600             PERFORM Z100-ABEND                                   17260000
172700     END-EVALUATE.                                                17270000
172800                                                                  17280000
172900***************************************************************** 17290000
173000* C136-FIND-ACT-UNADV-DPT-PROMO                                 * 17300000
173100* ==> PROCESSES:                                                * 17310000
173200*  - FIND THE ACTUAL DPT TOTALS.                                * 17320000
173300* ==> SQLCODE:                                                  * 17330000
173400*  - 0 = A ROW WAS FOUND.                                       * 17340000
173500* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 17350000
173600***************************************************************** 17360000
173700 C136-FIND-ACT-UNADV-DPT-PROMO.                                   17370000
173800                                                                  17380000
173900     EXEC SQL                                                     17390000
174000         SELECT                                                   17400000
174100              A.SLS_RTL_AMT                                       17410000
174200             ,A.MKDN_RTL_AMT                                      17420000
174300             ,A.SLS_UNT_QTY                                       17430000
174400             ,A.ACTL_PREP_UNT_QTY                                 17440000
174500             ,A.SLS_COST_AMT                                      17450000
174600             ,A.TOT_MKUP_PCT                                      17460000
174700         INTO                                                     17470000
174800              :PV-ACT-DPT-SLS-VOL    :PV-ACT-DPT-SLS-VOL-NULL     17480000
174900             ,:PV-ACT-DPT-MKDN-DOL   :PV-ACT-DPT-MKDN-DOL-NULL    17490000
175000             ,:PV-ACT-DPT-UNIT-SOLD  :PV-ACT-DPT-UNIT-SOLD-NULL   17500000
175100             ,:PV-ACT-DPT-PREP-UNITS :PV-ACT-DPT-PREP-UNITS-NULL  17510000
175200             ,:PV-ACT-DPT-SLS-COST   :PV-ACT-DPT-SLS-COST-NULL    17520000
175300             ,:PV-ACT-DPT-MKUP-PCT   :PV-ACT-DPT-MKUP-PCT-NULL    17530000
175400         FROM                                                     17540000
175500              PMV_PROMO_DEPT_SUM_UNADV A                          17550000
175600         WHERE                                                    17560000
175700              A.DEPT_NBR = :PV-DPT-NBR                            17570000
175800          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       17580000
175900     END-EXEC.                                                    17590000
176000                                                                  17600000
176100     EVALUATE TRUE                                                17610000
176200         WHEN SQLCODE = ZERO                                      17620000
176300             IF (PV-ACT-DPT-SLS-VOL = 0) AND                      17630000
176400                (PV-ACT-DPT-MKDN-DOL = 0) AND                     17640000
176500                (PV-ACT-DPT-UNIT-SOLD = 0) AND                    17650000
176600                (PV-ACT-DPT-PREP-UNITS = 0) AND                   17660000
176700                (PV-ACT-DPT-SLS-COST = 0) AND                     17670000
176800                (PV-ACT-DPT-MKUP-PCT = 0)                         17680000
176900                 SET PS-DPT-PROMO-TOT-NOT-EXIST TO TRUE           17690000
177000             ELSE                                                 17700000
177100                 SET PS-DPT-PROMO-TOT-EXIST TO TRUE               17710000
177200                 SET PS-DPT-TOT-COMPUTE TO TRUE                   17720000
177300                 ADD 1 TO PA-DPT-PROMO-CNT                        17730000
177400             END-IF                                               17740000
177500                                                                  17750000
177600         WHEN SQLCODE = 1403                                      17760000
177700             SET PS-DPT-PROMO-TOT-NOT-EXIST TO TRUE               17770000
177800             MOVE ZEROS TO PV-ACT-DPT-SLS-VOL                     17780000
177900             MOVE ZEROS TO PV-ACT-DPT-MKDN-DOL                    17790000
178000             MOVE ZEROS TO PV-ACT-DPT-UNIT-SOLD                   17800000
178100             MOVE ZEROS TO PV-ACT-DPT-PREP-UNITS                  17810000
178200             MOVE ZEROS TO PV-ACT-DPT-SLS-COST                    17820000
178300             MOVE ZEROS TO PV-ACT-DPT-MKUP-PCT                    17830000
178400                                                                  17840000
178500         WHEN OTHER                                               17850000
178600             MOVE 'C136-FIND-ACT-UNADV-DPT-PROMO'                 17860000
178700                               TO PV-PARAGRAPH-NAME               17870000
178800             PERFORM Z100-ABEND                                   17880000
178900     END-EVALUATE.                                                17890000
179000                                                                  17900000
179100***************************************************************** 17910000
179200* C140-FIND-FCST-ADV-DPT-PROMO                                  * 17920000
179300* ==> PROCESSES:                                                * 17930000
179400*  - FIND THE FORECAST DPT TOTALS.                              * 17940000
179500* ==> SQLCODE:                                                  * 17950000
179600*  - 0 = A ROW WAS FOUND.                                       * 17960000
179700* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 17970000
179800***************************************************************** 17980000
179900 C140-FIND-FCST-ADV-DPT-PROMO.                                    17990000
180000                                                                  18000000
180100     EXEC SQL                                                     18010000
180200         SELECT                                                   18020000
180300              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       18030000
180400             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      18040000
180500             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       18050000
180600             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  18060000
180700             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      18070000
180800             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   18080000
180900                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  18090000
181000                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 18100000
181100         INTO                                                     18110000
181200              :PV-FCST-DPT-SLS-VOL    :PV-FCST-DPT-SLS-VOL-NULL   18120000
181300             ,:PV-FCST-DPT-MKDN-DOL   :PV-FCST-DPT-MKDN-DOL-NULL  18130000
181400             ,:PV-FCST-DPT-UNIT-SOLD  :PV-FCST-DPT-UNIT-SOLD-NULL 18140000
181500             ,:PV-FCST-DPT-PREP-UNITS :PV-FCST-DPT-PREP-UNITS-NULL18150000
181600             ,:PV-FCST-DPT-SLS-COST   :PV-FCST-DPT-SLS-COST-NULL  18160000
181700             ,:PV-FCST-DPT-MKUP-PCT   :PV-FCST-DPT-MKUP-PCT-NULL  18170000
181800         FROM                                                     18180000
181900              PMV_PROMO_DIM A                                     18190000
182000             ,PMV_PRSN_MDSE_HIER B                                18200000
182100             ,PMT_PROMO_ITM_FCST C                                18210000
182200             ,PMT_PROMO_ITM D                                     18220000
182300         WHERE                                                    18230000
182400              A.PROMO_ID = D.PROMO_ID                             18240000
182500          AND D.PROMO_ITM_ID = C.PROMO_ITM_ID                     18250000
182600          AND B.DEPT_NBR = D.DEPT_NBR                             18260000
182700          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       18270000
182800          AND A.PROMO_ID = :PV-DPT-PROMO-ID                       18280000
182900          AND B.DEPT_NBR = :PV-DPT-NBR                            18290000
183000          AND D.ADV_IND = 'Y'                                     18300000
183100             AND D.PROMO_ITM_ID IN                                18310000
183200                   (SELECT E.PROMO_ITM_ID                         18320000
183300                      FROM PMT_AD_SP_ASGMT E                      18330000
183400                     WHERE                                        18340000
183500                           E.PROMO_ITM_ID = D.PROMO_ITM_ID        18350000
183600                       AND E.STAT_CDE = 'S')                      18360000
183700     END-EXEC.                                                    18370000
183800                                                                  18380000
183900     EVALUATE TRUE                                                18390000
184000         WHEN SQLCODE = ZERO                                      18400000
184100             IF (PV-FCST-DPT-SLS-VOL = 0) AND                     18410000
184200                (PV-FCST-DPT-MKDN-DOL = 0) AND                    18420000
184300                (PV-FCST-DPT-UNIT-SOLD = 0) AND                   18430000
184400                (PV-FCST-DPT-PREP-UNITS = 0) AND                  18440000
184500                (PV-FCST-DPT-SLS-COST = 0) AND                    18450000
184600                (PV-FCST-DPT-MKUP-PCT = 0)                        18460000
184700                 CONTINUE                                         18470000
184800             ELSE                                                 18480000
184900                 IF PS-DPT-PROMO-TOT-NOT-EXIST                    18490000
185000                     ADD 1 TO PA-DPT-PROMO-CNT                    18500000
185100                 END-IF                                           18510000
185200                 SET PS-DPT-TOT-COMPUTE TO TRUE                   18520000
185300                 SET PS-DPT-PROMO-TOT-EXIST TO TRUE               18530000
185400             END-IF                                               18540000
185500                                                                  18550000
185600         WHEN SQLCODE = 1403                                      18560000
185700             MOVE ZEROS TO PV-FCST-DPT-SLS-VOL                    18570000
185800             MOVE ZEROS TO PV-FCST-DPT-MKDN-DOL                   18580000
185900             MOVE ZEROS TO PV-FCST-DPT-UNIT-SOLD                  18590000
186000             MOVE ZEROS TO PV-FCST-DPT-PREP-UNITS                 18600000
186100             MOVE ZEROS TO PV-FCST-DPT-SLS-COST                   18610000
186200             MOVE ZEROS TO PV-FCST-DPT-MKUP-PCT                   18620000
186300                                                                  18630000
186400         WHEN OTHER                                               18640000
186500             DISPLAY 'PV-AD-EVNT-ID   = ' PV-AD-EVNT-ID           18650000
186600             DISPLAY 'PV-DPT-PROMO-ID = ' PV-DPT-PROMO-ID         18660000
186700             DISPLAY 'PV-DPT-NBR      = ' PV-DPT-NBR              18670000
186800             MOVE 'C140-FIND-FCST-ADV-DPT-PROMO'                  18680000
186900                               TO PV-PARAGRAPH-NAME               18690000
187000             PERFORM Z100-ABEND                                   18700000
187100     END-EVALUATE.                                                18710000
187200                                                                  18720000
187300***************************************************************** 18730000
187400* C141-FIND-FCST-UNADV-DPT-PROMO                                * 18740000
187500* ==> PROCESSES:                                                * 18750000
187600*  - FIND THE FORECAST DPT TOTALS.                              * 18760000
187700* ==> SQLCODE:                                                  * 18770000
187800*  - 0 = A ROW WAS FOUND.                                       * 18780000
187900* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 18790000
188000***************************************************************** 18800000
188100 C141-FIND-FCST-UNADV-DPT-PROMO.                                  18810000
188200                                                                  18820000
188300     EXEC SQL                                                     18830000
188400         SELECT                                                   18840000
188500              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       18850000
188600             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      18860000
188700             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       18870000
188800             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  18880000
188900             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      18890000
189000             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   18900000
189100                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  18910000
189200                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 18920000
189300         INTO                                                     18930000
189400              :PV-FCST-DPT-SLS-VOL    :PV-FCST-DPT-SLS-VOL-NULL   18940000
189500             ,:PV-FCST-DPT-MKDN-DOL   :PV-FCST-DPT-MKDN-DOL-NULL  18950000
189600             ,:PV-FCST-DPT-UNIT-SOLD  :PV-FCST-DPT-UNIT-SOLD-NULL 18960000
189700             ,:PV-FCST-DPT-PREP-UNITS :PV-FCST-DPT-PREP-UNITS-NULL18970000
189800             ,:PV-FCST-DPT-SLS-COST   :PV-FCST-DPT-SLS-COST-NULL  18980000
189900             ,:PV-FCST-DPT-MKUP-PCT   :PV-FCST-DPT-MKUP-PCT-NULL  18990000
190000         FROM                                                     19000000
190100              PMV_PROMO_DIM A                                     19010000
190200             ,PMV_PRSN_MDSE_HIER B                                19020000
190300             ,PMT_PROMO_ITM_FCST C                                19030000
190400             ,PMT_PROMO_ITM D                                     19040000
190500         WHERE                                                    19050000
190600              A.PROMO_ID = D.PROMO_ID                             19060000
190700          AND D.PROMO_ITM_ID = C.PROMO_ITM_ID                     19070000
190800          AND B.DEPT_NBR = D.DEPT_NBR                             19080000
190900          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       19090000
191000          AND B.DEPT_NBR = :PV-DPT-NBR                            19100000
191100          AND (D.ADV_IND = 'N'                                    19110000
191200              OR  D.PROMO_ITM_ID NOT IN                           19120000
191300                   (SELECT E.PROMO_ITM_ID                         19130000
191400                      FROM PMT_AD_SP_ASGMT E                      19140000
191500                     WHERE                                        19150000
191600                           E.PROMO_ITM_ID = D.PROMO_ITM_ID        19160000
191700                       AND E.STAT_CDE = 'S'))                     19170000
191800     END-EXEC.                                                    19180000
191900                                                                  19190000
192000     EVALUATE TRUE                                                19200000
192100         WHEN SQLCODE = ZERO                                      19210000
192200             IF (PV-FCST-DPT-SLS-VOL = 0) AND                     19220000
192300                (PV-FCST-DPT-MKDN-DOL = 0) AND                    19230000
192400                (PV-FCST-DPT-UNIT-SOLD = 0) AND                   19240000
192500                (PV-FCST-DPT-PREP-UNITS = 0) AND                  19250000
192600                (PV-FCST-DPT-SLS-COST = 0) AND                    19260000
192700                (PV-FCST-DPT-MKUP-PCT = 0)                        19270000
192800                 CONTINUE                                         19280000
192900             ELSE                                                 19290000
193000                 IF PS-DPT-PROMO-TOT-NOT-EXIST                    19300000
193100                     ADD 1 TO PA-DPT-PROMO-CNT                    19310000
193200                 END-IF                                           19320000
193300                 SET PS-DPT-PROMO-TOT-EXIST TO TRUE               19330000
193400                 SET PS-DPT-TOT-COMPUTE TO TRUE                   19340000
193500             END-IF                                               19350000
193600                                                                  19360000
193700         WHEN SQLCODE = 1403                                      19370000
193800             MOVE ZEROS TO PV-FCST-DPT-SLS-VOL                    19380000
193900             MOVE ZEROS TO PV-FCST-DPT-MKDN-DOL                   19390000
194000             MOVE ZEROS TO PV-FCST-DPT-UNIT-SOLD                  19400000
194100             MOVE ZEROS TO PV-FCST-DPT-PREP-UNITS                 19410000
194200             MOVE ZEROS TO PV-FCST-DPT-SLS-COST                   19420000
194300             MOVE ZEROS TO PV-FCST-DPT-MKUP-PCT                   19430000
194400                                                                  19440000
194500         WHEN OTHER                                               19450000
194600             DISPLAY 'PV-AD-EVNT-ID   = ' PV-AD-EVNT-ID           19460000
194700             DISPLAY 'PV-DPT-PROMO-ID = ' PV-DPT-PROMO-ID         19470000
194800             DISPLAY 'PV-DPT-NBR      = ' PV-DPT-NBR              19480000
194900             MOVE 'C141-FIND-FCST-UNADV-DPT-PROMO'                19490000
195000                               TO PV-PARAGRAPH-NAME               19500000
195100             PERFORM Z100-ABEND                                   19510000
195200     END-EVALUATE.                                                19520000
195300                                                                  19530000
195400***************************************************************** 19540000
195500* C145-FIND-ACT-ADV-BYR-PROMO                                   * 19550000
195600* ==> PROCESSES:                                                * 19560000
195700*  - FIND THE ACTUAL BUYER TOTALS.                              * 19570000
195800* ==> SQLCODE:                                                  * 19580000
195900*  - 0 = A ROW WAS FOUND.                                       * 19590000
196000* ==> PERFORMED FROM: C425-FETCH-ACT-BYR-PROMO                  * 19600000
196100***************************************************************** 19610000
196200 C145-FIND-ACT-ADV-BYR-PROMO.                                     19620000
196300                                                                  19630000
196400     EXEC SQL                                                     19640000
196500         SELECT                                                   19650000
196510              ROUND(SUM(A.SLS_RTL_AMT) , 2)                       19651008
196520             ,ROUND(SUM(A.MKDN_RTL_AMT) , 2)                      19652008
196530             ,ROUND(SUM(A.SLS_UNT_QTY) , 2)                       19653008
196540             ,ROUND(SUM(A.ACTL_PREP_UNT_QTY),2)                   19654008
196550             ,ROUND(SUM(A.SLS_COST_AMT) , 2)                      19655008
196551             ,DECODE (COUNT(*),1,SUM(A.TOT_MKUP_PCT),             19655115
196570                 ROUND(((SUM(A.SLS_RTL_AMT)-SUM(A.SLS_COST_AMT))  19657008
196580                 / SUM(A.SLS_RTL_AMT)) * 100, 2))                 19658008
197200         INTO                                                     19720000
197300              :PV-ACT-BYR-SLS-VOL     :PV-ACT-BYR-SLS-VOL-NULL    19730000
197400             ,:PV-ACT-BYR-MKDN-DOL    :PV-ACT-BYR-MKDN-DOL-NULL   19740000
197500             ,:PV-ACT-BYR-UNIT-SOLD   :PV-ACT-BYR-UNIT-SOLD-NULL  19750000
197600             ,:PV-ACT-BYR-PREP-UNITS  :PV-ACT-BYR-PREP-UNITS-NULL 19760000
197700             ,:PV-ACT-BYR-SLS-COST    :PV-ACT-BYR-SLS-COST-NULL   19770000
197800             ,:PV-ACT-BYR-MKUP-PCT    :PV-ACT-BYR-MKUP-PCT-NULL   19780000
197900         FROM                                                     19790000
198000              PMV_PROMO_BYR_SUM_ADV A                             19800000
198100         WHERE                                                    19810000
198200              A.BYR_NBR = :PV-PREV-BYR-NBR                        19820000
198300          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       19830000
198400          AND A.PROMO_ID = :PV-BYR-PROMO-ID                       19840000
               GROUP BY A.AD_EVNT_ID, A.PROMO_ID, A.BYR_NBR             19841013
198500     END-EXEC.                                                    19850000
198600                                                                  19860000
198700     EVALUATE TRUE                                                19870000
198800         WHEN SQLCODE = ZERO                                      19880000
198900             IF (PV-ACT-BYR-SLS-VOL = 0) AND                      19890000
199000                (PV-ACT-BYR-MKDN-DOL = 0) AND                     19900000
199100                (PV-ACT-BYR-UNIT-SOLD = 0) AND                    19910000
199200                (PV-ACT-BYR-PREP-UNITS = 0) AND                   19920000
199300                (PV-ACT-BYR-SLS-COST = 0) AND                     19930000
199400                (PV-ACT-BYR-MKUP-PCT = 0)                         19940000
199500                 SET PS-BYR-PROMO-TOT-NOT-EXIST TO TRUE           19950000
199600             ELSE                                                 19960000
199700                 SET PS-BYR-PROMO-TOT-EXIST TO TRUE               19970000
199800                 ADD 1 TO PA-BYR-PROMO-TOT-CNT                    19980000
199900             END-IF                                               19990000
200000                                                                  20000000
200100         WHEN SQLCODE = 1403                                      20010000
200200             SET PS-BYR-PROMO-TOT-NOT-EXIST TO TRUE               20020000
200300             MOVE ZEROS TO PV-ACT-BYR-SLS-VOL                     20030000
200400             MOVE ZEROS TO PV-ACT-BYR-MKDN-DOL                    20040000
200500             MOVE ZEROS TO PV-ACT-BYR-UNIT-SOLD                   20050000
200600             MOVE ZEROS TO PV-ACT-BYR-PREP-UNITS                  20060000
200700             MOVE ZEROS TO PV-ACT-BYR-SLS-COST                    20070000
200800             MOVE ZEROS TO PV-ACT-BYR-MKUP-PCT                    20080000
200900                                                                  20090000
201000         WHEN OTHER                                               20100000
201100             MOVE 'C145-FIND-ACT-ADV-BYR-PROMO'                   20110000
201200                               TO PV-PARAGRAPH-NAME               20120000
201300             PERFORM Z100-ABEND                                   20130000
201400     END-EVALUATE.                                                20140000
201500                                                                  20150000
201600***************************************************************** 20160000
201700* C146-FIND-ACT-UNADV-BYR-PROMO                                 * 20170000
201800* ==> PROCESSES:                                                * 20180000
201900*  - FIND THE ACTUAL BUYER TOTALS.                              * 20190000
202000* ==> SQLCODE:                                                  * 20200000
202100*  - 0 = A ROW WAS FOUND.                                       * 20210000
202200* ==> PERFORMED FROM: C425-FETCH-ACT-BYR-PROMO-TOT              * 20220000
202300***************************************************************** 20230000
202400 C146-FIND-ACT-UNADV-BYR-PROMO.                                   20240000
202500                                                                  20250000
202600     EXEC SQL                                                     20260000
202700         SELECT                                                   20270000
202710              ROUND(SUM(A.SLS_RTL_AMT) , 2)                       20271009
202720             ,ROUND(SUM(A.MKDN_RTL_AMT) , 2)                      20272009
202730             ,ROUND(SUM(A.SLS_UNT_QTY) , 2)                       20273009
202740             ,ROUND(SUM(A.ACTL_PREP_UNT_QTY),2)                   20274009
202750             ,ROUND(SUM(A.SLS_COST_AMT) , 2)                      20275009
202760             ,DECODE (COUNT(*),1,SUM(A.TOT_MKUP_PCT),             20276015
202770                 ROUND(((SUM(A.SLS_RTL_AMT)-SUM(A.SLS_COST_AMT))  20277009
202780                 / SUM(A.SLS_RTL_AMT)) * 100, 2))                 20278009
203400         INTO                                                     20340000
203500              :PV-ACT-BYR-SLS-VOL     :PV-ACT-BYR-SLS-VOL-NULL    20350000
203600             ,:PV-ACT-BYR-MKDN-DOL    :PV-ACT-BYR-MKDN-DOL-NULL   20360000
203700             ,:PV-ACT-BYR-UNIT-SOLD   :PV-ACT-BYR-UNIT-SOLD-NULL  20370000
203800             ,:PV-ACT-BYR-PREP-UNITS  :PV-ACT-BYR-PREP-UNITS-NULL 20380000
203900             ,:PV-ACT-BYR-SLS-COST    :PV-ACT-BYR-SLS-COST-NULL   20390000
204000             ,:PV-ACT-BYR-MKUP-PCT    :PV-ACT-BYR-MKUP-PCT-NULL   20400000
204100         FROM                                                     20410000
204200              PMV_PROMO_BYR_SUM_UNADV A                           20420000
204300         WHERE                                                    20430000
204400              A.BYR_NBR = :PV-PREV-BYR-NBR                        20440000
204500          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       20450000
               GROUP BY A.AD_EVNT_ID, A.BYR_NBR                         20451013
204600     END-EXEC.                                                    20460000
204700                                                                  20470000
204800     EVALUATE TRUE                                                20480000
204900         WHEN SQLCODE = ZERO                                      20490000
205000             IF (PV-ACT-BYR-SLS-VOL = 0) AND                      20500000
205100                (PV-ACT-BYR-MKDN-DOL = 0) AND                     20510000
205200                (PV-ACT-BYR-UNIT-SOLD = 0) AND                    20520000
205300                (PV-ACT-BYR-PREP-UNITS = 0) AND                   20530000
205400                (PV-ACT-BYR-SLS-COST = 0) AND                     20540000
205500                (PV-ACT-BYR-MKUP-PCT = 0)                         20550000
205600                 SET PS-BYR-PROMO-TOT-NOT-EXIST TO TRUE           20560000
205700             ELSE                                                 20570000
205800                 SET PS-BYR-PROMO-TOT-EXIST TO TRUE               20580000
205900                 ADD 1 TO PA-BYR-PROMO-TOT-CNT                    20590000
206000             END-IF                                               20600000
206100                                                                  20610000
206200         WHEN SQLCODE = 1403                                      20620000
206300             SET PS-BYR-PROMO-TOT-NOT-EXIST TO TRUE               20630000
206400             MOVE ZEROS TO PV-ACT-BYR-SLS-VOL                     20640000
206500             MOVE ZEROS TO PV-ACT-BYR-MKDN-DOL                    20650000
206600             MOVE ZEROS TO PV-ACT-BYR-UNIT-SOLD                   20660000
206700             MOVE ZEROS TO PV-ACT-BYR-PREP-UNITS                  20670000
206800             MOVE ZEROS TO PV-ACT-BYR-SLS-COST                    20680000
206900             MOVE ZEROS TO PV-ACT-BYR-MKUP-PCT                    20690000
207000                                                                  20700000
207100         WHEN OTHER                                               20710000
207200             MOVE 'C146-FIND-ACT-UNADV-BYR-PROMO'                 20720000
207300                               TO PV-PARAGRAPH-NAME               20730000
207400             PERFORM Z100-ABEND                                   20740000
207500     END-EVALUATE.                                                20750000
207600                                                                  20760000
207700***************************************************************** 20770000
207800* C150-FIND-FCST-ADV-BYR-PROMO                                 *  20780000
207900* ==> PROCESSES:                                                * 20790000
208000*  - FIND THE FORECAST BUYER TOTALS.                            * 20800000
208100* ==> SQLCODE:                                                  * 20810000
208200*  - 0 = A ROW WAS FOUND.                                       * 20820000
208300* ==> PERFORMED FROM: C425-FETCH-ACT-BYR-PROMO-TOT              * 20830000
208400***************************************************************** 20840000
208500 C150-FIND-FCST-ADV-BYR-PROMO.                                    20850000
208600                                                                  20860000
208700     EXEC SQL                                                     20870000
208800         SELECT                                                   20880000
208900              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       20890000
209000             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      20900000
209100             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       20910000
209200             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  20920000
209300             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      20930000
209400             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   20940000
209500                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  20950000
209600                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 20960000
209700         INTO                                                     20970000
209800              :PV-FCST-BYR-SLS-VOL    :PV-FCST-BYR-SLS-VOL-NULL   20980000
209900             ,:PV-FCST-BYR-MKDN-DOL   :PV-FCST-BYR-MKDN-DOL-NULL  20990000
210000             ,:PV-FCST-BYR-UNIT-SOLD  :PV-FCST-BYR-UNIT-SOLD-NULL 21000000
210100             ,:PV-FCST-BYR-PREP-UNITS :PV-FCST-BYR-PREP-UNITS-NULL21010000
210200             ,:PV-FCST-BYR-SLS-COST   :PV-FCST-BYR-SLS-COST-NULL  21020000
210300             ,:PV-FCST-BYR-MKUP-PCT   :PV-FCST-BYR-MKUP-PCT-NULL  21030000
210400         FROM                                                     21040000
210500              PMV_PROMO_DIM A                                     21050000
210600             ,PMV_PRSN_MDSE_HIER B                                21060000
210700             ,PMT_PROMO_ITM_FCST C                                21070000
210800             ,PMT_PROMO_ITM D                                     21080000
210900         WHERE                                                    21090000
211000              A.PROMO_ID = D.PROMO_ID                             21100000
211100          AND D.PROMO_ITM_ID = C.PROMO_ITM_ID                     21110000
211200          AND B.DEPT_NBR = D.DEPT_NBR                             21120000
211300          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       21130000
211400          AND A.PROMO_ID = :PV-BYR-PROMO-ID                       21140000
211500          AND B.BYR_NBR = :PV-PREV-BYR-NBR                        21150000
211600          AND D.PROMO_ITM_ID IN                                   21160000
211700                   (SELECT E.PROMO_ITM_ID                         21170000
211800                      FROM PMT_AD_SP_ASGMT E                      21180000
211900                     WHERE                                        21190000
212000                           E.PROMO_ITM_ID = D.PROMO_ITM_ID        21200000
212100                       AND E.STAT_CDE = 'S')                      21210000
212200     END-EXEC.                                                    21220000
212300                                                                  21230000
212400     EVALUATE TRUE                                                21240000
212500         WHEN SQLCODE = ZERO                                      21250000
212600             IF (PV-FCST-BYR-SLS-VOL = 0) AND                     21260000
212700                (PV-FCST-BYR-MKDN-DOL = 0) AND                    21270000
212800                (PV-FCST-BYR-UNIT-SOLD = 0) AND                   21280000
212900                (PV-FCST-BYR-PREP-UNITS = 0) AND                  21290000
213000                (PV-FCST-BYR-SLS-COST = 0) AND                    21300000
213100                (PV-FCST-BYR-MKUP-PCT = 0)                        21310000
213200                 CONTINUE                                         21320000
213300             ELSE                                                 21330000
213400                 IF PS-BYR-PROMO-TOT-NOT-EXIST                    21340000
213500                     ADD 1 TO PA-BYR-PROMO-TOT-CNT                21350000
213600                 END-IF                                           21360000
213700                 SET PS-BYR-PROMO-TOT-EXIST TO TRUE               21370000
213800             END-IF                                               21380000
213900                                                                  21390000
214000         WHEN SQLCODE = 1403                                      21400000
214100             SET PS-BYR-PROMO-TOT-NOT-EXIST TO TRUE               21410000
214200             MOVE ZEROS TO PV-FCST-BYR-SLS-VOL                    21420000
214300             MOVE ZEROS TO PV-FCST-BYR-MKDN-DOL                   21430000
214400             MOVE ZEROS TO PV-FCST-BYR-UNIT-SOLD                  21440000
214500             MOVE ZEROS TO PV-FCST-BYR-PREP-UNITS                 21450000
214600             MOVE ZEROS TO PV-FCST-BYR-SLS-COST                   21460000
214700             MOVE ZEROS TO PV-FCST-BYR-MKUP-PCT                   21470000
214800                                                                  21480000
214900         WHEN OTHER                                               21490000
215000             MOVE 'C150-FIND-FCST-ADV-BYR-PROMO'                  21500000
215100                               TO PV-PARAGRAPH-NAME               21510000
215200             PERFORM Z100-ABEND                                   21520000
215300     END-EVALUATE.                                                21530000
215400                                                                  21540000
215500***************************************************************** 21550000
215600* C151-FIND-FCST-UNADV-BYR-PROMO                                * 21560000
215700* ==> PROCESSES:                                                * 21570000
215800*  - FIND THE FORECAST BUYER TOTALS.                            * 21580000
215900* ==> SQLCODE:                                                  * 21590000
216000*  - 0 = A ROW WAS FOUND.                                       * 21600000
216100* ==> PERFORMED FROM: C425-FETCH-ACT-BYR-PROMO-TOT              * 21610000
216200***************************************************************** 21620000
216300 C151-FIND-FCST-UNADV-BYR-PROMO.                                  21630000
216400                                                                  21640000
216500     EXEC SQL                                                     21650000
216600         SELECT                                                   21660000
216700              ROUND(SUM(C.SLS_RTL_AMT) , 2)                       21670000
216800             ,ROUND(SUM(C.MKDN_RTL_AMT) , 2)                      21680000
216900             ,ROUND(SUM(C.SLS_UNT_QTY) , 2)                       21690000
217000             ,ROUND(SUM(C.PROJD_PREP_UNT_QTY),2)                  21700000
217100             ,ROUND(SUM(C.SLS_COST_AMT) , 2)                      21710000
217200             ,DECODE (SUM(C.SLS_RTL_AMT), 0, 0,                   21720000
217300                 ROUND(((SUM(C.SLS_RTL_AMT)-SUM(C.SLS_COST_AMT))  21730000
217400                 / SUM(C.SLS_RTL_AMT)) * 100, 2))                 21740000
217500         INTO                                                     21750000
217600              :PV-FCST-BYR-SLS-VOL    :PV-FCST-BYR-SLS-VOL-NULL   21760000
217700             ,:PV-FCST-BYR-MKDN-DOL   :PV-FCST-BYR-MKDN-DOL-NULL  21770000
217800             ,:PV-FCST-BYR-UNIT-SOLD  :PV-FCST-BYR-UNIT-SOLD-NULL 21780000
217900             ,:PV-FCST-BYR-PREP-UNITS :PV-FCST-BYR-PREP-UNITS-NULL21790000
218000             ,:PV-FCST-BYR-SLS-COST   :PV-FCST-BYR-SLS-COST-NULL  21800000
218100             ,:PV-FCST-BYR-MKUP-PCT   :PV-FCST-BYR-MKUP-PCT-NULL  21810000
218200         FROM                                                     21820000
218300              PMV_PROMO_DIM A                                     21830000
218400             ,PMV_PRSN_MDSE_HIER B                                21840000
218500             ,PMT_PROMO_ITM_FCST C                                21850000
218600             ,PMT_PROMO_ITM D                                     21860000
218700         WHERE                                                    21870000
218800              A.PROMO_ID = D.PROMO_ID                             21880000
218900          AND D.PROMO_ITM_ID = C.PROMO_ITM_ID                     21890000
219000          AND B.DEPT_NBR = D.DEPT_NBR                             21900000
219100          AND A.AD_EVNT_ID = :PV-AD-EVNT-ID                       21910000
219200          AND B.BYR_NBR = :PV-PREV-BYR-NBR                        21920000
219300          AND (D.ADV_IND = 'N'                                    21930000
219400              OR  D.PROMO_ITM_ID NOT IN                           21940000
219500                   (SELECT E.PROMO_ITM_ID                         21950000
219600                      FROM PMT_AD_SP_ASGMT E                      21960000
219700                     WHERE                                        21970000
219800                           E.PROMO_ITM_ID = D.PROMO_ITM_ID        21980000
219900                       AND E.STAT_CDE = 'S'))                     21990000
220000     END-EXEC.                                                    22000000
220100                                                                  22010000
220200     EVALUATE TRUE                                                22020000
220300         WHEN SQLCODE = ZERO                                      22030000
220400             IF (PV-FCST-BYR-SLS-VOL = 0) AND                     22040000
220500                (PV-FCST-BYR-MKDN-DOL = 0) AND                    22050000
220600                (PV-FCST-BYR-UNIT-SOLD = 0) AND                   22060000
220700                (PV-FCST-BYR-PREP-UNITS = 0) AND                  22070000
220800                (PV-FCST-BYR-SLS-COST = 0) AND                    22080000
220900                (PV-FCST-BYR-MKUP-PCT = 0)                        22090000
221000                 CONTINUE                                         22100000
221100             ELSE                                                 22110000
221200                 IF PS-BYR-PROMO-TOT-NOT-EXIST                    22120000
221300                     ADD 1 TO PA-BYR-PROMO-TOT-CNT                22130000
221400                 END-IF                                           22140000
221500                 SET PS-BYR-PROMO-TOT-EXIST TO TRUE               22150000
221600             END-IF                                               22160000
221700                                                                  22170000
221800         WHEN SQLCODE = 1403                                      22180000
221900             SET PS-BYR-PROMO-TOT-NOT-EXIST TO TRUE               22190000
222000             MOVE ZEROS TO PV-FCST-BYR-SLS-VOL                    22200000
222100             MOVE ZEROS TO PV-FCST-BYR-MKDN-DOL                   22210000
222200             MOVE ZEROS TO PV-FCST-BYR-UNIT-SOLD                  22220000
222300             MOVE ZEROS TO PV-FCST-BYR-PREP-UNITS                 22230000
222400             MOVE ZEROS TO PV-FCST-BYR-SLS-COST                   22240000
222500             MOVE ZEROS TO PV-FCST-BYR-MKUP-PCT                   22250000
222600                                                                  22260000
222700         WHEN OTHER                                               22270000
222800             MOVE 'C151-FIND-FCST-UNADV-BYR-PROMO'                22280000
222900                               TO PV-PARAGRAPH-NAME               22290000
223000             PERFORM Z100-ABEND                                   22300000
223100     END-EVALUATE.                                                22310000
223200                                                                  22320000
223300***************************************************************** 22330000
223400* C200-DECLARE-AD-EVNT-CSR                                      * 22340000
223500* ==> PROCESSES:                                                * 22350000
223600*  - DECLARE CSR THAT RETRIEVES AD EVENTS BASED ON THE END DATE * 22360000
223700* ==> PERFORMED FROM: A100-MAINLINE                             * 22370000
223800***************************************************************** 22380000
223900 C200-DECLARE-AD-EVNT-CSR.                                        22390000
224000                                                                  22400000
224100     EXEC SQL                                                     22410000
224200          DECLARE ADEVNTCSR                                       22420000
224300          CURSOR FOR                                              22430000
224400              SELECT DISTINCT                                     22440000
224500                   A.AD_EVNT_ID                                   22450000
224600                  ,UPPER(A.AD_EVNT_NBR_TXT)                       22460000
224700                  ,UPPER(A.CPLT_NM)                               22470000
224800              FROM                                                22480000
224900                   PMV_AD_EVNT A                                  22490000
225000              WHERE (A.END_DTE BETWEEN                            22500000
225100                   TO_DATE(:PV-END-DATE-STRT-TMST,                22510000
225200                                      'MM/DD/YYYY HH24:MI:SS')    22520000
225300                   AND TO_DATE(:PV-END-DATE-END-TMST,             22530000
225400                                      'MM/DD/YYYY HH24:MI:SS'))   22540000
225500     END-EXEC.                                                    22550000
225600                                                                  22560000
225700***************************************************************** 22570000
225800* C205-DECLARE-BUYER-CSR                                        * 22580000
225900* ==> PROCESSES:                                                * 22590000
226000*  - DECLARE CURSOR THAT RETREIVES GMA, DMA, AND BUYER INFO     * 22600000
226100*    FOR THE AD EVENT(S).                                       * 22610000
226200* ==> PERFORMED FROM: C500-PROCESS-AD-EVNT-CSR                  * 22620000
226300***************************************************************** 22630000
226400 C205-DECLARE-BUYER-CSR.                                          22640000
226500                                                                  22650000
226600     EXEC SQL                                                     22660000
226700          DECLARE BUYERCSR                                        22670000
226800          CURSOR FOR                                              22680000
226900              SELECT                                              22690000
227000                  GMA_NBR                                         22700000
227100                 ,UPPER(GMA_NM)                                   22710000
227200                 ,UPPER(GMM_FRST_NM)                              22720000
227300                 ,UPPER(GMM_LAST_NM)                              22730000
227400                 ,DMA_NBR                                         22740000
227500                 ,UPPER(DMA_NM)                                   22750000
227600                 ,UPPER(DMM_FRST_NM)                              22760000
227700                 ,UPPER(DMM_LAST_NM)                              22770000
227800                 ,DEPT_NBR                                        22780000
227900                 ,UPPER(DEPT_NM)                                  22790000
228000                 ,BYR_NBR                                         22800000
228100                 ,UPPER(BYR_FRST_NM)                              22810000
228200                 ,UPPER(BYR_LAST_NM)                              22820000
228300              FROM                                                22830000
228400                  PMV_PRSN_MDSE_HIER                              22840000
228500              ORDER BY                                            22850000
228600                  BYR_NBR                                         22860000
228700                 ,DEPT_NBR                                        22870000
228800     END-EXEC.                                                    22880000
228900                                                                  22890000
229000***************************************************************** 22900000
229100* C210-DECLARE-PROMO-CSR                                        * 22910000
229200* ==> PROCESSES:                                                * 22920000
229300*  - DECLARE CURSOR TO FIND ALL THE PROMO'S TIED TO THE AD EVENT* 22930000
229400* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 22940000
229500***************************************************************** 22950000
229600 C210-DECLARE-PROMO-CSR.                                          22960000
229700                                                                  22970000
229800     EXEC SQL                                                     22980000
229900          DECLARE PROMOCSR                                        22990000
230000          CURSOR FOR                                              23000000
230100              SELECT                                              23010000
230200                  PROMO_ID                                        23020000
230300                 ,UPPER(PROMO_NM)                                 23030000
230400                 ,TO_CHAR(PROMO_DFLT_STRT_TMST, 'MM/DD/YYYY')     23040000
230500                 ,TO_CHAR(PROMO_DFLT_END_TMST, 'MM/DD/YYYY')      23050000
230600                 ,ROUND(PROMO_DFLT_END_TMST- PROMO_DFLT_STRT_TMST)23060000
230700              FROM                                                23070000
230800                  PMV_PROMO_DIM                                   23080000
230900              WHERE                                               23090000
231000                  AD_EVNT_ID = :PV-AD-EVNT-ID                     23100000
231100              ORDER BY                                            23110000
231200                  REG_PROMO_TYP_CDE                               23120000
231300                 ,ADV_PROMO_TYP_CDE                               23130000
231400                 ,PROMO_DFLT_STRT_TMST                            23140000
231500                 ,PROMO_DFLT_END_TMST                             23150000
231600     END-EXEC.                                                    23160000
231700                                                                  23170000
231800***************************************************************** 23180000
231900* C300-OPEN-AD-EVNT-CSR                                         * 23190000
232000* ==> PROCESSES:                                                * 23200000
232100*  - OPEN ADEVNTCSR                                             * 23210000
232200* ==> SQLCODE:                                                  * 23220000
232300*  - 0 = SUCCESSFULL OPEN                                       * 23230000
232400* ==> PERFORMED FROM: A100-MAINLINE                             * 23240000
232500***************************************************************** 23250000
232600 C300-OPEN-AD-EVNT-CSR.                                           23260000
232700                                                                  23270000
232800     EXEC SQL                                                     23280000
232900           OPEN ADEVNTCSR                                         23290000
233000     END-EXEC.                                                    23300000
233100                                                                  23310000
233200     EVALUATE TRUE                                                23320000
233300         WHEN SQLCODE = ZERO                                      23330000
233400             CONTINUE                                             23340000
233500         WHEN OTHER                                               23350000
233600             MOVE 'C300-OPEN-AD-EVNT-CSR   '                      23360000
233700                               TO PV-PARAGRAPH-NAME               23370000
233800             MOVE 'OPEN ERROR ON ADEVNTCSR '                      23380000
233900                               TO PV-OPERATION-MSG-1              23390000
234000             PERFORM Z100-ABEND                                   23400000
234100     END-EVALUATE.                                                23410000
234200                                                                  23420000
234300***************************************************************** 23430000
234400* C305-OPEN-BUYER-CSR                                           * 23440000
234500* ==> PROCESSES:                                                * 23450000
234600*  - OPEN BUYERCSR                                              * 23460000
234700* ==> SQLCODE:                                                  * 23470000
234800*  - 0 = SUCCESSFULL OPEN                                       * 23480000
234900* ==> PERFORMED FROM: C500-PROCESS-AD-EVNT-CSR                  * 23490000
235000***************************************************************** 23500000
235100 C305-OPEN-BUYER-CSR.                                             23510000
235200                                                                  23520000
235300     EXEC SQL                                                     23530000
235400           OPEN BUYERCSR                                          23540000
235500     END-EXEC.                                                    23550000
235600                                                                  23560000
235700     EVALUATE TRUE                                                23570000
235800         WHEN SQLCODE = ZERO                                      23580000
235900             CONTINUE                                             23590000
236000         WHEN OTHER                                               23600000
236100             MOVE 'C305-OPEN-BUYER-CSR   '                        23610000
236200                               TO PV-PARAGRAPH-NAME               23620000
236300             MOVE 'OPEN ERROR ON BUYERCSR '                       23630000
236400                               TO PV-OPERATION-MSG-1              23640000
236500             PERFORM Z100-ABEND                                   23650000
236600     END-EVALUATE.                                                23660000
236700                                                                  23670000
236800***************************************************************** 23680000
236900* C310-OPEN-PROMO-CSR                                           * 23690000
237000* ==> PROCESSES:                                                * 23700000
237100*  - OPEN PROMOCSR                                              * 23710000
237200* ==> SQLCODE:                                                  * 23720000
237300*  - 0 = SUCCESSFULL OPEN                                       * 23730000
237400* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 23740000
237500***************************************************************** 23750000
237600 C310-OPEN-PROMO-CSR.                                             23760000
237700                                                                  23770000
237800     EXEC SQL                                                     23780000
237900           OPEN PROMOCSR                                          23790000
238000     END-EXEC.                                                    23800000
238100                                                                  23810000
238200     EVALUATE TRUE                                                23820000
238300         WHEN SQLCODE = ZERO                                      23830000
238400             CONTINUE                                             23840000
238500         WHEN OTHER                                               23850000
238600             MOVE 'C310-OPEN-PROMO-CSR   '                        23860000
238700                               TO PV-PARAGRAPH-NAME               23870000
238800             MOVE 'OPEN ERROR ON PROMOCSR '                       23880000
238900                               TO PV-OPERATION-MSG-1              23890000
239000             PERFORM Z100-ABEND                                   23900000
239100     END-EVALUATE.                                                23910000
239200                                                                  23920000
239300***************************************************************** 23930000
239400* C400-FETCH-AD-EVNT-CSR.                                       * 23940000
239500* ==> PROCESSES:                                                * 23950000
239600*  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 23960000
239700*    VARIABLES LISTED.                                          * 23970000
239800*  - CONCAT SOME VARIABLES TOGETHER AND MOVE TO HEADER LINES    * 23980000
239900* ==> SQLCODE:                                                  * 23990000
240000*  - 0    = A ROW WAS FOUND                                     * 24000000
240100*  - 1403 = WHEN NO DATA WAS FOUND                              * 24010000
240200* ==> PERFORMED FROM: A100-MAINLINE, C500-PROCESS-AD-EVNT-CSR   * 24020000
240300***************************************************************** 24030000
240400 C400-FETCH-AD-EVNT-CSR.                                          24040000
240500                                                                  24050000
240600     EXEC SQL                                                     24060000
240700         FETCH ADEVNTCSR                                          24070000
240800          INTO  :PV-AD-EVNT-ID                                    24080000
240900               ,:PV-AD-EVNT-NBR-TXT                               24090000
241000               ,:PV-CPLT-NM                                       24100000
241100     END-EXEC.                                                    24110000
241200                                                                  24120000
241300     EVALUATE TRUE                                                24130000
241400         WHEN SQLCODE = ZERO                                      24140000
241500             STRING PV-AD-EVNT-NBR-TXT                            24150000
241600                         DELIMITED BY PC-SPACE                    24160000
241700                    PC-SPACE                                      24170000
241800                         DELIMITED BY SIZE                        24180000
241900                    PV-CPLT-NM                                    24190000
242000                         DELIMITED BY SIZE                        24200000
242100             INTO  HDR-03-AD-EVNT-NAME                            24210000
242200             ADD 1 TO PA-AD-EVNT-CNT                              24220000
242300         WHEN SQLCODE = 1403                                      24230000
242400             IF PA-AD-EVNT-CNT = 0                                24240000
242500                 DISPLAY 'NO AD EVENT ENDED YESTERDAY - '         24250000
242600                 DISPLAY 'NOTHING TO REPORT.'                     24260000
242700             ELSE                                                 24270000
242800                 DISPLAY 'AD EVNT COUNT FROM FETCH = '            24280000
242900                                              PA-AD-EVNT-CNT      24290000
243000                 DISPLAY 'END OF AD EVNT CSR '                    24300000
243100             END-IF                                               24310000
243200             SET PS-END-OF-ADEVNT-CSR TO TRUE                     24320000
243300         WHEN OTHER                                               24330000
243400             MOVE 'C400-FETCH-AD-EVNT-CSR   '                     24340000
243500                               TO PV-PARAGRAPH-NAME               24350000
243600             MOVE 'FETCH ERROR ON ADEVNTCSR '                     24360000
243700                               TO PV-OPERATION-MSG-1              24370000
243800             PERFORM Z100-ABEND                                   24380000
243900     END-EVALUATE.                                                24390000
244000                                                                  24400000
244100***************************************************************** 24410000
244200* C405-FETCH-BUYER-CSR.                                         * 24420000
244300* ==> PROCESSES:                                                * 24430000
244400*  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 24440000
244500*    VARIABLES LISTED.                                          * 24450000
244600*  - CONCAT SOME VARIABLES TOGETHER AND MOVE TO HEADER LINES    * 24460000
244700* ==> SQLCODE:                                                  * 24470000
244800*  - 0    = A ROW WAS FOUND                                     * 24480000
244900*  - 1403 = WHEN NO DATA WAS FOUND                              * 24490000
245000* ==> PERFORMED FROM: C500-PROCESS-AD-EVNT-CSR,                 * 24500000
245100*          C505-PROCESS-BUYER-CSR                               * 24510000
245200***************************************************************** 24520000
245300 C405-FETCH-BUYER-CSR.                                            24530000
245400                                                                  24540000
245500     EXEC SQL                                                     24550000
245600         FETCH BUYERCSR                                           24560000
245700          INTO                                                    24570000
245800              :PV-GMA-NBR                                         24580000
245900             ,:PV-GMA-NM                                          24590000
246000             ,:PV-GMM-FRST-NM          :PV-GMM-FRST-NM-NULL       24600000
246100             ,:PV-GMM-LAST-NM                                     24610000
246200             ,:PV-DMA-NBR                                         24620000
246300             ,:PV-DMA-NM                                          24630000
246400             ,:PV-DMM-FRST-NM          :PV-DMM-FRST-NM-NULL       24640000
246500             ,:PV-DMM-LAST-NM                                     24650000
246600             ,:PV-DPT-NBR                                         24660000
246700             ,:PV-DPT-NM                                          24670000
246800             ,:PV-BYR-NBR                                         24680000
246900             ,:PV-BYR-FRST-NM          :PV-BYR-FRST-NM-NULL       24690000
247000             ,:PV-BYR-LAST-NM                                     24700000
247100     END-EXEC.                                                    24710000
247200                                                                  24720000
247300     EVALUATE TRUE                                                24730000
247400         WHEN SQLCODE = ZERO                                      24740000
247500             ADD 1 TO PA-BUYER-CNT                                24750000
247600             MOVE PV-DPT-NBR   TO DTL-DPT-01-DPT-NBR              24760000
247700             MOVE PV-DPT-NM    TO DTL-DPT-01-DPT-NM               24770000
247800                                                                  24780000
247900         WHEN SQLCODE = 1403                                      24790000
248000             DISPLAY 'BUYER COUNT FROM FETCH = ' PA-BUYER-CNT     24800000
248100             DISPLAY 'END OF BUYERCSR '                           24810000
248200             SET PS-END-OF-BUYER-CSR TO TRUE                      24820000
248300                                                                  24830000
248400         WHEN OTHER                                               24840000
248500             MOVE 'C405-FETCH-BUYER-CSR   '                       24850000
248600                               TO PV-PARAGRAPH-NAME               24860000
248700             MOVE 'FETCH ERROR ON BUYERCSR '                      24870000
248800                               TO PV-OPERATION-MSG-1              24880000
248900             PERFORM Z100-ABEND                                   24890000
249000     END-EVALUATE.                                                24900000
249100                                                                  24910000
249200***************************************************************** 24920000
249300* C410-FETCH-PROMO-CSR.                                         * 24930000
249400* ==> PROCESSES:                                                * 24940000
249500*  - WHEN DATA IS BROUGHT BACK FROM THE CURSOR FETCH IT TO THE  * 24950000
249600*    VARIABLES LISTED.                                          * 24960000
249700* ==> SQLCODE:                                                  * 24970000
249800*  - 0    = A ROW WAS FOUND                                     * 24980000
249900*  - 1403 = WHEN NO DATA WAS FOUND                              * 24990000
250000* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR,                   * 25000000
250100*      C510-PROCESS-PROMO-CSR                                   * 25010000
250200***************************************************************** 25020000
250300 C410-FETCH-PROMO-CSR.                                            25030000
250400                                                                  25040000
250500     EXEC SQL                                                     25050000
250600         FETCH PROMOCSR                                           25060000
250700          INTO                                                    25070000
250800              :PV-PROMO-ID                                        25080000
250900             ,:PV-PROMO-NM                                        25090000
251000             ,:PV-PROMO-STRT-DTE                                  25100000
251100             ,:PV-PROMO-END-DTE                                   25110000
251200             ,:PV-DAYS-ON-SALE                                    25120000
251300     END-EXEC.                                                    25130000
251400                                                                  25140000
251500     EVALUATE TRUE                                                25150000
251600         WHEN SQLCODE = ZERO                                      25160000
251700             ADD 1 TO PA-PROMO-CNT                                25170000
251800             ADD 1 TO PV-PROMO-IDX                                25180000
251900                                                                  25190000
252000         WHEN SQLCODE = 1403                                      25200000
252100             DISPLAY 'PROMO COUNT FETCH FOR ' PV-CPLT-NM  ' = '   25210000
252200                                              PA-PROMO-CNT        25220000
252300             DISPLAY 'END OF PROMOCSR '                           25230000
252400             SET PS-END-OF-PROMO-CSR TO TRUE                      25240000
252500                                                                  25250000
252600         WHEN OTHER                                               25260000
252700             MOVE 'C410-FETCH-PROMO-CSR   '                       25270000
252800                               TO PV-PARAGRAPH-NAME               25280000
252900             MOVE 'FETCH ERROR ON PROMOCSR '                      25290000
253000                               TO PV-OPERATION-MSG-1              25300000
253100             PERFORM Z100-ABEND                                   25310000
253200     END-EVALUATE.                                                25320000
253300                                                                  25330000
253400***************************************************************** 25340000
253500* C500-PROCESS-AD-EVNT-CSR.                                     * 25350000
253600* ==> PROCESSES:                                                * 25360000
253700*  - CLEAR OUT VARIABLES                                        * 25370000
253800*  - FIND AD EVENT TOTALS FOR THE AD EVENT                      * 25380000
253900*  - FIND ALL THE BUYERS AND THERE DPTS                         * 25390000
254000*  - FETCH THE NEXT AD EVENT                                    * 25400000
254100* ==> PERFORMED FROM: A100-MAINLINE                             * 25410000
254200***************************************************************** 25420000
254300 C500-PROCESS-AD-EVNT-CSR.                                        25430000
254400                                                                  25440000
254500     INITIALIZE PV-AD-EVNT-TOTALS.                                25450000
254600     PERFORM C105-FIND-ACT-ADEVNT-TOTALS.                         25460000
254700     PERFORM C110-FIND-FCST-ADEVNT-TOTALS.                        25470000
254800                                                                  25480000
254900     MOVE 0 TO PA-BUYER-CNT.                                      25490000
255000     PERFORM C205-DECLARE-BUYER-CSR.                              25500000
255100     PERFORM C305-OPEN-BUYER-CSR.                                 25510000
255200     PERFORM C405-FETCH-BUYER-CSR                                 25520000
255300     PERFORM C505-PROCESS-BUYER-CSR                               25530000
255400         UNTIL PS-END-OF-BUYER-CSR.                               25540000
255500     PERFORM C605-CLOSE-BUYER-CSR.                                25550000
255600                                                                  25560000
255700     IF PS-BYR-TOT-EXIST                                          25570000
255800         PERFORM E100-PROCESS-BUYER-ENDING                        25580000
255900     END-IF.                                                      25590000
256000                                                                  25600000
256100     MOVE PV-LINE-CNT  TO PV-FUTURE-LINE-CNT.                     25610000
256200     ADD 1             TO PV-FUTURE-LINE-CNT.                     25620000
256300     IF PV-FUTURE-LINE-CNT > PC-MAX-LINE-CNT                      25630000
256400         PERFORM W300-PROCESS-PAGE-HEADER                         25640000
256500     END-IF.                                                      25650000
256600     MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE.                   25660000
256700     PERFORM W200-WRITE-RPT-LINE.                                 25670000
256800                                                                  25680000
256900     INITIALIZE PV-AD-EVNT-VARIABLES.                             25690000
257000     PERFORM C400-FETCH-AD-EVNT-CSR.                              25700000
257100                                                                  25710000
257200***************************************************************** 25720000
257300* C505-PROCESS-BUYER-CSR.                                       * 25730000
257400* ==> PROCESSES:                                                * 25740000
257500*  - INITIALIZE VARIABLES                                       * 25750000
257600*  - FIND GMA TOTALS FOR THE AD EVENT                           * 25760000
257700*  - IF THIS IS THE FIRST BUYER                                 * 25770000
257800*    - FIND ALL PROMOS TIED TO THE AD EVENT                     * 25780000
257900*    - GET DMM TOTALS FOR EACH PROMOTION TIED TO THE AD EVENT   * 25790000
258000*    - WRITE THE HEADER TO THE PAGE                             * 25800000
258100*  - IF A NEW BUYER HAS BEEN SELECTED                           * 25810000
258200*    - FIND THE PREVIOUS BUYERS PROMO TOTALS                    * 25820000
258300*    - COMPUTE THE BUYER TOTALS                                 * 25830000
258400* ==> PERFORMED FROM: C500-PROCESS-AD-EVNT-CSR.                 * 25840000
258500***************************************************************** 25850000
258600 C505-PROCESS-BUYER-CSR.                                          25860000
258700                                                                  25870000
258800     MOVE 0 TO PV-DMA-PROMO-IDX.                                  25880000
258900     INITIALIZE PV-GMA-TOTALS                                     25890000
259000                PV-TOTAL-DPT                                      25900000
259100                PV-UNAD-VARIABLES.                                25910000
259200     PERFORM C115-FIND-ACT-GMA-TOTALS.                            25920000
259300     PERFORM C120-FIND-FCST-GMA-TOTALS.                           25930000
259400                                                                  25940000
259500     IF PA-BUYER-CNT = 1                                          25950000
259600         MOVE 0             TO PV-LINE-CNT                        25960000
259700         MOVE 0             TO PV-PROMO-IDX                       25970000
259800         INITIALIZE PV-ALL-PROMO-TBL                              25980000
259900         INITIALIZE PV-TOTAL-DMA                                  25990000
260000         PERFORM M050-MOVE-HEADER                                 26000000
260100                                                                  26010000
260200         PERFORM C210-DECLARE-PROMO-CSR                           26020000
260300         PERFORM C310-OPEN-PROMO-CSR                              26030000
260400         PERFORM C410-FETCH-PROMO-CSR                             26040000
260500         PERFORM C510-PROCESS-PROMO-CSR                           26050000
260600             UNTIL PS-END-OF-PROMO-CSR                            26060000
260700         PERFORM C610-CLOSE-PROMO-CSR                             26070000
260800                                                                  26080000
260900         MOVE 1             TO PV-INDEX                           26090000
261000         MOVE 1             TO PV-DMA-PROMO-IDX                   26100000
261100         INITIALIZE PV-ALL-DMA-PROMO-TBL                          26110000
261200         PERFORM D100-PROCESS-DMA-PROMO-TOT                       26120000
261300             UNTIL PV-INDEX > PV-PROMO-IDX                        26130000
261400                                                                  26140000
261500     ELSE                                                         26150000
261600         IF NOT(PV-BYR-NBR = PV-PREV-BYR-NBR)                     26160000
261700             IF PS-BYR-TOT-EXIST                                  26170000
261800                 PERFORM E100-PROCESS-BUYER-ENDING                26180000
261900             END-IF                                               26190000
262000                                                                  26200000
262100             INITIALIZE PV-TOTAL-DMA                              26210000
262200             INITIALIZE PV-BYR-TOTALS                             26220000
262300             INITIALIZE PV-TOTAL-BYR                              26230000
262400             SET PS-BYR-TOT-NOT-EXIST TO TRUE                     26240000
262500             MOVE 0             TO PV-LINE-CNT                    26250000
262600             MOVE 1             TO PV-INDEX                       26260000
262700             MOVE 1             TO PV-DMA-PROMO-IDX               26270000
262800             PERFORM M050-MOVE-HEADER                             26280000
262900                                                                  26290000
263000             INITIALIZE PV-ALL-DMA-PROMO-TBL                      26300000
263100             PERFORM D100-PROCESS-DMA-PROMO-TOT                   26310000
263200                 UNTIL PV-INDEX > PV-PROMO-IDX                    26320000
263300         END-IF                                                   26330000
263400     END-IF.                                                      26340000
263500                                                                  26350000
263600     MOVE 0 TO PA-DPT-PROMO-CNT.                                  26360000
263700     MOVE 1 TO PV-DPT-INDEX.                                      26370000
263800     SET PS-DPT-TOT-NOT-COMPUTE TO TRUE.                          26380000
263900     PERFORM D120-PROCESS-DPT-PROMO-TOT                           26390000
264000         UNTIL PV-DPT-INDEX > PV-PROMO-IDX.                       26400000
264100                                                                  26410000
264200     IF PS-DPT-TOT-COMPUTE                                        26420000
264300         PERFORM M115-COMPUTE-DPT-TOT-LINE                        26430000
264400     END-IF.                                                      26440000
264500                                                                  26450000
264600     MOVE PV-BYR-NBR TO PV-PREV-BYR-NBR                           26460000
264700                                                                  26470000
264800     PERFORM C405-FETCH-BUYER-CSR.                                26480000
264900                                                                  26490000
265000***************************************************************** 26500000
265100* C510-PROCESS-PROMO-CSR.                                       * 26510000
265200* ==> PROCESSES:                                                * 26520000
265300*  - MOVE VARIABLES TO A TEMP TABLE                             * 26530000
265400*  - CLEAR OUT THE VARIABLES FOR A CLEAN SLATE                  * 26540000
265500*  - FETCH NEXT PROMO                                           * 26550000
265600* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 26560000
265700***************************************************************** 26570000
265800 C510-PROCESS-PROMO-CSR.                                          26580000
265900                                                                  26590000
266000     IF PV-PROMO-NM = 'MAIN PROMOTION'                            26600000
266100         MOVE PV-PROMO-STRT-DTE TO PV-UNAD-STRT-DTE               26610000
266200         MOVE PV-PROMO-END-DTE  TO PV-UNAD-END-DTE                26620000
266300         MOVE PV-DAYS-ON-SALE   TO PV-UNAD-DAY-ON-SALE            26630000
266400     END-IF.                                                      26640000
266500     IF PV-PROMO-NM = 'UNADVERTISED'                              26650000
266600         MOVE '9999999999' TO PV-ALL-PROMO-ID(PV-PROMO-IDX)       26660000
266700         MOVE 'UNADVERTISED ITEMS'                                26670000
266800                           TO PV-ALL-PROMO-NM(PV-PROMO-IDX)       26680000
266900         MOVE PV-UNAD-STRT-DTE                                    26690000
267000                           TO PV-ALL-PROMO-STRT-DTE(PV-PROMO-IDX) 26700000
267100         MOVE PV-UNAD-END-DTE                                     26710000
267200                           TO PV-ALL-PROMO-END-DTE(PV-PROMO-IDX)  26720000
267300         MOVE PV-UNAD-DAY-ON-SALE                                 26730000
267400                           TO PV-ALL-DAYS-ON-SALE(PV-PROMO-IDX)   26740000
267500         ADD 1 TO PV-PROMO-IDX                                    26750000
267600         MOVE 'UNADVERTISED PROMOTION' TO PV-PROMO-NM             26760000
267700     END-IF.                                                      26770000
267800     MOVE PV-PROMO-ID      TO PV-ALL-PROMO-ID(PV-PROMO-IDX).      26780000
267900     MOVE PV-PROMO-NM      TO PV-ALL-PROMO-NM(PV-PROMO-IDX).      26790000
268000     MOVE PV-PROMO-STRT-DTE                                       26800000
268100                           TO PV-ALL-PROMO-STRT-DTE(PV-PROMO-IDX).26810000
268200     MOVE PV-PROMO-END-DTE TO PV-ALL-PROMO-END-DTE(PV-PROMO-IDX). 26820000
268300     MOVE PV-DAYS-ON-SALE  TO PV-ALL-DAYS-ON-SALE(PV-PROMO-IDX).  26830000
268400                                                                  26840000
268500     INITIALIZE PV-PROMO-VARIABLES.                               26850000
268600     PERFORM C410-FETCH-PROMO-CSR.                                26860000
268700                                                                  26870000
268800****************************************************************  26880000
268900* C600-CLOSE-AD-EVNT-CSR                                       *  26890000
269000* ==> PROCESSES:                                                * 26900000
269100*  - CLOSE THE ADEVNTCSR                                        * 26910000
269200* ==> SQLCODE:                                                  * 26920000
269300*  - 0    = CLOSE WAS SUCCESSFULL                               * 26930000
269400* ==> PERFORMED FROM: A100-MAINLINE                             * 26940000
269500****************************************************************  26950000
269600 C600-CLOSE-AD-EVNT-CSR.                                          26960000
269700                                                                  26970000
269800     EXEC SQL                                                     26980000
269900          CLOSE ADEVNTCSR                                         26990000
270000     END-EXEC.                                                    27000000
270100                                                                  27010000
270200     EVALUATE TRUE                                                27020000
270300         WHEN SQLCODE = ZERO                                      27030000
270400             CONTINUE                                             27040000
270500         WHEN OTHER                                               27050000
270600            MOVE 'C600-CLOSE-AD-EVT-CSR      '                    27060000
270700                              TO PV-PARAGRAPH-NAME                27070000
270800            MOVE 'CLOSE ERROR ON ADEVNT-CSR  '                    27080000
270900                              TO PV-OPERATION-MSG-1               27090000
271000             DISPLAY PV-PARAGRAPH-NAME                            27100000
271100             PERFORM Z100-ABEND                                   27110000
271200     END-EVALUATE.                                                27120000
271300                                                                  27130000
271400***************************************************************** 27140000
271500* C605-CLOSE-BUYER-CSR                                          * 27150000
271600* ==> PROCESSES:                                                * 27160000
271700*  - CLOSE THE BUYERCSR                                         * 27170000
271800* ==> SQLCODE:                                                  * 27180000
271900*  - 0    = CLOSE WAS SUCCESSFULL                               * 27190000
272000* ==> PERFORMED FROM: C500-PROCESS-AD-EVNT-CSR                  * 27200000
272100***************************************************************** 27210000
272200 C605-CLOSE-BUYER-CSR.                                            27220000
272300                                                                  27230000
272400     EXEC SQL                                                     27240000
272500          CLOSE BUYERCSR                                          27250000
272600     END-EXEC.                                                    27260000
272700                                                                  27270000
272800     EVALUATE TRUE                                                27280000
272900         WHEN SQLCODE = ZERO                                      27290000
273000             CONTINUE                                             27300000
273100         WHEN OTHER                                               27310000
273200            MOVE 'C605-CLOSE-BUYER-CSR      '                     27320000
273300                              TO PV-PARAGRAPH-NAME                27330000
273400            MOVE 'CLOSE ERROR ON BUYER-CSR  '                     27340000
273500                              TO PV-OPERATION-MSG-1               27350000
273600             DISPLAY PV-PARAGRAPH-NAME                            27360000
273700             PERFORM Z100-ABEND                                   27370000
273800     END-EVALUATE.                                                27380000
273900                                                                  27390000
274000***************************************************************** 27400000
274100* C610-CLOSE-PROMO-CSR                                          * 27410000
274200* ==> PROCESSES:                                                * 27420000
274300*  - CLOSE THE PROMOCSR                                         * 27430000
274400* ==> SQLCODE:                                                  * 27440000
274500*  - 0    = CLOSE WAS SUCCESSFULL                               * 27450000
274600* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 27460000
274700***************************************************************** 27470000
274800 C610-CLOSE-PROMO-CSR.                                            27480000
274900                                                                  27490000
275000     EXEC SQL                                                     27500000
275100          CLOSE PROMOCSR                                          27510000
275200     END-EXEC.                                                    27520000
275300                                                                  27530000
275400     EVALUATE TRUE                                                27540000
275500         WHEN SQLCODE = ZERO                                      27550000
275600             CONTINUE                                             27560000
275700         WHEN OTHER                                               27570000
275800            MOVE 'C610-CLOSE-PROMO-CSR      '                     27580000
275900                              TO PV-PARAGRAPH-NAME                27590000
276000            MOVE 'CLOSE ERROR ON PROMO-CSR  '                     27600000
276100                              TO PV-OPERATION-MSG-1               27610000
276200             DISPLAY PV-PARAGRAPH-NAME                            27620000
276300             PERFORM Z100-ABEND                                   27630000
276400     END-EVALUATE.                                                27640000
276500                                                                  27650000
276600***************************************************************** 27660000
276700* D100-PROCESS-DMA-PROMO-TOT                                    * 27670000
276800* ==> PROCESSES:                                                * 27680000
276900* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 27690000
277000***************************************************************** 27700000
277100 D100-PROCESS-DMA-PROMO-TOT.                                      27710000
277200                                                                  27720000
277300     SET PS-DMA-PROMO-TOT-NOT-EXIST TO TRUE.                      27730000
277400     MOVE PV-ALL-PROMO-ID(PV-INDEX) TO PV-DMA-PROMO-ID.           27740000
277500     MOVE PV-ALL-PROMO-NM(PV-INDEX) TO PV-DMA-PROMO-NM.           27750000
277600     IF PV-DMA-PROMO-ID = '9999999999'                            27760000
277700         PERFORM C126-FIND-ACT-UNADV-DMA-PROMO                    27770000
277800         PERFORM C131-FIND-FCST-UNADV-DMA-PROMO                   27780000
277900     ELSE                                                         27790000
278000         PERFORM C125-FIND-ACT-ADV-DMA-PROMO                      27800000
278100         PERFORM C130-FIND-FCST-ADV-DMA-PROMO                     27810000
278200     END-IF.                                                      27820000
278300                                                                  27830000
278400     IF PS-DMA-PROMO-TOT-EXIST                                    27840000
278500         PERFORM M100-MOVE-COMPUTE-DMM-TOT                        27850000
278600     END-IF.                                                      27860000
278700                                                                  27870000
278800     ADD 1 TO PV-INDEX.                                           27880000
278900     ADD 1 TO PV-DMA-PROMO-IDX.                                   27890000
279000     INITIALIZE PV-DMA-TOTALS.                                    27900000
279100                                                                  27910000
279200***************************************************************** 27920000
279300* D110-PROCESS-BYR-PROMO-TOT                                    * 27930000
279400* ==> PROCESSES:                                                * 27940000
279500* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 27950000
279600***************************************************************** 27960000
279700 D110-PROCESS-BYR-PROMO-TOT.                                      27970000
279800                                                                  27980000
279900     MOVE PV-ALL-PROMO-ID(PV-INDEX) TO PV-BYR-PROMO-ID.           27990000
280000     MOVE PV-ALL-PROMO-NM(PV-INDEX) TO PV-BYR-PROMO-NM.           28000000
280100     IF PV-BYR-PROMO-ID = '9999999999'                            28010000
280200         PERFORM C146-FIND-ACT-UNADV-BYR-PROMO                    28020000
280300         PERFORM C151-FIND-FCST-UNADV-BYR-PROMO                   28030000
280400     ELSE                                                         28040000
280500         PERFORM C145-FIND-ACT-ADV-BYR-PROMO                      28050000
280600         PERFORM C150-FIND-FCST-ADV-BYR-PROMO                     28060000
280700     END-IF.                                                      28070000
280800                                                                  28080000
280900     IF PS-BYR-PROMO-TOT-EXIST                                    28090000
281000         SET PV-ALL-DMA-PROMO-IDX TO 1                            28100000
281100         SEARCH PV-ALL-DMA-PROMO-TABLE                            28110000
281200             AT END CONTINUE                                      28120000
281300            WHEN PV-ALL-DMA-PROMO-ID(PV-ALL-DMA-PROMO-IDX) =      28130000
281400                PV-BYR-PROMO-ID                                   28140000
281500                 PERFORM M120-MOVE-COMPUTE-BYR-TOT                28150000
281600         END-SEARCH                                               28160000
281700                                                                  28170000
281800         MOVE DTL-BYR-TOTAL-01       TO PV-RPT-LINE               28180000
281900         MOVE 1                      TO PV-ADVANCE-LINES          28190000
282000         ADD PV-ADVANCE-LINES        TO PV-LINE-CNT               28200000
282100         PERFORM W200-WRITE-RPT-LINE                              28210000
282200                                                                  28220000
282300         MOVE DTL-BYR-TOTAL-02       TO PV-RPT-LINE               28230000
282400         MOVE 1                      TO PV-ADVANCE-LINES          28240000
282500         ADD PV-ADVANCE-LINES        TO PV-LINE-CNT               28250000
282600         PERFORM W200-WRITE-RPT-LINE                              28260000
282700     END-IF.                                                      28270000
282800                                                                  28280000
282900     ADD 1 TO PV-INDEX.                                           28290000
283000     INITIALIZE PV-BYR-TOTALS.                                    28300000
283100                                                                  28310000
283200***************************************************************** 28320000
283300* D120-PROCESS-DPT-PROMO-TOT                                    * 28330000
283400* ==> PROCESSES:                                                * 28340000
283500* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 28350000
283600***************************************************************** 28360000
283700 D120-PROCESS-DPT-PROMO-TOT.                                      28370000
283800                                                                  28380000
283900     MOVE PV-ALL-PROMO-ID(PV-DPT-INDEX) TO PV-DPT-PROMO-ID.       28390000
284000     IF PV-DPT-PROMO-ID = '9999999999'                            28400000
284100         PERFORM C136-FIND-ACT-UNADV-DPT-PROMO                    28410000
284200         PERFORM C141-FIND-FCST-UNADV-DPT-PROMO                   28420000
284300     ELSE                                                         28430000
284400         PERFORM C135-FIND-ACT-ADV-DPT-PROMO                      28440000
284500         PERFORM C140-FIND-FCST-ADV-DPT-PROMO                     28450000
284600     END-IF.                                                      28460000
284700                                                                  28470000
284800     IF PS-DPT-PROMO-TOT-EXIST                                    28480000
284900         SET PS-BYR-TOT-EXIST TO TRUE                             28490000
285000         IF PV-LINE-CNT = 0                                       28500000
285100             PERFORM W300-PROCESS-PAGE-HEADER                     28510000
285200         END-IF                                                   28520000
285300                                                                  28530000
285400         PERFORM M110-MOVE-COMPUTE-DPT-TOT                        28540000
285500                                                                  28550000
285600         MOVE PV-LINE-CNT  TO PV-FUTURE-LINE-CNT                  28560000
285700         ADD PV-PROMO-IDX  TO PV-FUTURE-LINE-CNT                  28570000
285800         ADD 4             TO PV-FUTURE-LINE-CNT                  28580000
285900         IF PV-FUTURE-LINE-CNT > PC-MAX-LINE-CNT                  28590000
286000             PERFORM W300-PROCESS-PAGE-HEADER                     28600000
286100         END-IF                                                   28610000
286200                                                                  28620000
286300         IF PA-DPT-PROMO-CNT = 1                                  28630000
286400             MOVE DTL-DEPT-01            TO PV-RPT-LINE           28640000
286500             MOVE 2                      TO PV-ADVANCE-LINES      28650000
286600             ADD PV-ADVANCE-LINES        TO PV-LINE-CNT           28660000
286700             PERFORM W200-WRITE-RPT-LINE                          28670000
286800         END-IF                                                   28680000
286900                                                                  28690000
287000         MOVE DTL-DEPT-02            TO PV-RPT-LINE               28700000
287100         MOVE 1                      TO PV-ADVANCE-LINES          28710000
287200         ADD PV-ADVANCE-LINES        TO PV-LINE-CNT               28720000
287300         PERFORM W200-WRITE-RPT-LINE                              28730000
287400         INITIALIZE DTL-DEPT-02                                   28740000
287500     END-IF.                                                      28750000
287600                                                                  28760000
287700     ADD 1 TO PV-DPT-INDEX.                                       28770000
287800     INITIALIZE PV-DPT-TOTALS.                                    28780000
287900                                                                  28790000
288000***************************************************************** 28800000
288100* E100-PROCESS-BUYER-ENDING.                                    * 28810000
288200* ==> PROCESSES:                                                * 28820000
288300* ==> PERFORMED FROM:                                           * 28830000
288400***************************************************************** 28840000
288500 E100-PROCESS-BUYER-ENDING.                                       28850000
288600                                                                  28860000
288700     MOVE DTL-DIVISION-LINE      TO PV-RPT-LINE.                  28870000
288800     MOVE 2                      TO PV-ADVANCE-LINES.             28880000
288900     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  28890000
289000     PERFORM W200-WRITE-RPT-LINE                                  28900000
289100                                                                  28910000
289200     MOVE SPACES                 TO PV-RPT-LINE.                  28920000
289300     MOVE 1                      TO PV-ADVANCE-LINES.             28930000
289400     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  28940000
289500     PERFORM W200-WRITE-RPT-LINE.                                 28950000
289600                                                                  28960000
289700     MOVE PV-LINE-CNT  TO PV-FUTURE-LINE-CNT.                     28970000
289800     ADD PV-PROMO-IDX  TO PV-FUTURE-LINE-CNT.                     28980000
289900     ADD PV-PROMO-IDX  TO PV-FUTURE-LINE-CNT.                     28990000
290000     ADD 2             TO PV-FUTURE-LINE-CNT.                     29000000
290100     IF PV-FUTURE-LINE-CNT > PC-MAX-LINE-CNT                      29010000
290200         PERFORM W300-PROCESS-PAGE-HEADER                         29020000
290300     END-IF.                                                      29030000
290400                                                                  29040000
290500     MOVE 0 TO PA-BYR-PROMO-TOT-CNT.                              29050000
290600     MOVE 1 TO PV-INDEX.                                          29060000
290700     PERFORM D110-PROCESS-BYR-PROMO-TOT                           29070000
290800       UNTIL PV-INDEX > PV-PROMO-IDX.                             29080000
290900                                                                  29090000
291000     PERFORM M125-COMPUTE-BYR-TOT-LINE.                           29100000
291100                                                                  29110000
291200     MOVE PV-LINE-CNT  TO PV-FUTURE-LINE-CNT.                     29120000
291300     ADD 4             TO PV-FUTURE-LINE-CNT.                     29130000
291400     IF PV-FUTURE-LINE-CNT > PC-MAX-LINE-CNT                      29140000
291500         PERFORM W300-PROCESS-PAGE-HEADER                         29150000
291600     END-IF.                                                      29160000
291700                                                                  29170000
291800     INITIALIZE PV-TOTAL-BYR-DMM.                                 29180000
291900     INITIALIZE PV-TOTAL-BYR-GMM.                                 29190000
292000     INITIALIZE PV-TOTAL-BYR-AD.                                  29200000
292100     PERFORM M130-COMPUTE-BYR-DMM-TOT-LINE.                       29210000
292200     PERFORM M135-COMPUTE-BYR-GMM-TOT-LINE.                       29220000
292300     PERFORM M140-COMPUTE-BYR-AD-TOT-LINE.                        29230000
292400                                                                  29240000
292500***************************************************************** 29250000
292600* M050-MOVE-HEADER.                                             * 29260000
292700* ==> PROCESSES:                                                * 29270000
292800* ==> PERFORMED FROM:                                           * 29280000
292900***************************************************************** 29290000
293000 M050-MOVE-HEADER.                                                29300000
293100                                                                  29310000
293200     MOVE PV-DMA-NM    TO DTL-DIVISION-01-NM.                     29320000
293300     STRING PV-DMA-NBR                                            29330000
293400                 DELIMITED BY PC-SPACE                            29340000
293500            PC-SPACE                                              29350000
293600                 DELIMITED BY SIZE                                29360000
293700            PV-DMM-FRST-NM                                        29370000
293800                 DELIMITED BY PC-SPACE                            29380000
293900            PC-SPACE                                              29390000
294000                 DELIMITED BY SIZE                                29400000
294100            PV-DMM-LAST-NM                                        29410000
294200                 DELIMITED BY SIZE                                29420000
294300     INTO  HDR-01-DMM-NAME.                                       29430000
294400     STRING PV-BYR-NBR                                            29440000
294500                DELIMITED BY PC-SPACE                             29450000
294600            PC-SPACE                                              29460000
294700                DELIMITED BY SIZE                                 29470000
294800            PV-BYR-FRST-NM                                        29480000
294900                 DELIMITED BY PC-SPACE                            29490000
295000            PC-SPACE                                              29500000
295100                 DELIMITED BY SIZE                                29510000
295200            PV-BYR-LAST-NM                                        29520000
295300                 DELIMITED BY SIZE                                29530000
295400     INTO  HDR-02-BYR-NAME.                                       29540000
295500                                                                  29550000
295600***************************************************************** 29560000
295700* M100-MOVE-COMPUTE-DMM-TOT.                                    * 29570000
295800* ==> PROCESSES:                                                * 29580000
295900*  - COMPUTE DMM TOTALS                                         * 29590000
296000*  - MOVE SINGLE VALUES TO A TEMP TABLE                         * 29600000
296100* ==> PERFORMED FROM: D100-PROCESS-DMA-PROMO-TOT                * 29610000
296200***************************************************************** 29620000
296300 M100-MOVE-COMPUTE-DMM-TOT.                                       29630000
296400                                                                  29640000
296500     COMPUTE PV-DMA-VOL-PCT-CHG ROUNDED =                         29650000
296600       (((PV-FCST-DMA-SLS-VOL - PV-ACT-DMA-SLS-VOL) /             29660000
296700          PV-FCST-DMA-SLS-VOL) * -100)                            29670000
296800       ON SIZE ERROR MOVE 0 TO PV-DMA-VOL-PCT-CHG                 29680000
296900     END-COMPUTE.                                                 29690000
297000                                                                  29700000
297100     COMPUTE PV-TOT-ACT-DMA-SLS-VOL =                             29710000
297200       (PV-TOT-ACT-DMA-SLS-VOL + PV-ACT-DMA-SLS-VOL).             29720000
297300     COMPUTE PV-TOT-FCST-DMA-SLS-VOL =                            29730000
297400       (PV-TOT-FCST-DMA-SLS-VOL + PV-FCST-DMA-SLS-VOL).           29740000
297500     COMPUTE PV-TOT-ACT-DMA-MKDN-DOL =                            29750000
297600       (PV-TOT-ACT-DMA-MKDN-DOL + PV-ACT-DMA-MKDN-DOL).           29760000
297700     COMPUTE PV-TOT-FCST-DMA-MKDN-DOL =                           29770000
297800       (PV-TOT-FCST-DMA-MKDN-DOL + PV-FCST-DMA-MKDN-DOL).         29780000
297900     COMPUTE PV-TOT-ACT-DMA-UNIT-SOLD =                           29790000
298000       (PV-TOT-ACT-DMA-UNIT-SOLD + PV-ACT-DMA-UNIT-SOLD).         29800000
298100     COMPUTE PV-TOT-FCST-DMA-UNIT-SOLD =                          29810000
298200       (PV-TOT-FCST-DMA-UNIT-SOLD + PV-FCST-DMA-UNIT-SOLD).       29820000
298300     COMPUTE PV-TOT-ACT-DMA-PREP-UNITS =                          29830000
298400       (PV-TOT-ACT-DMA-PREP-UNITS + PV-ACT-DMA-PREP-UNITS).       29840000
298500     COMPUTE PV-TOT-FCST-DMA-PREP-UNITS =                         29850000
298600      (PV-TOT-FCST-DMA-PREP-UNITS + PV-FCST-DMA-PREP-UNITS).      29860000
298700     COMPUTE PV-TOT-ACT-DMA-SLS-COST =                            29870000
298800       (PV-TOT-ACT-DMA-SLS-COST + PV-ACT-DMA-SLS-COST).           29880000
298900     COMPUTE PV-TOT-FCST-DMA-SLS-COST =                           29890000
299000       (PV-TOT-FCST-DMA-SLS-COST + PV-FCST-DMA-SLS-COST).         29900000
299100                                                                  29910000
299200     MOVE PV-DMA-PROMO-ID                                         29920000
299300         TO PV-ALL-DMA-PROMO-ID(PV-DMA-PROMO-IDX).                29930000
299400     MOVE PV-DMA-PROMO-NM                                         29940000
299500         TO PV-ALL-DMA-PROMO-NM(PV-DMA-PROMO-IDX).                29950000
299600     MOVE PV-ACT-DMA-SLS-VOL                                      29960000
299700         TO PV-ALL-ACT-DMA-SLS-VOL(PV-DMA-PROMO-IDX).             29970000
299800     MOVE PV-FCST-DMA-SLS-VOL                                     29980000
299900         TO PV-ALL-FCST-DMA-SLS-VOL(PV-DMA-PROMO-IDX).            29990000
300000     MOVE PV-DMA-VOL-PCT-CHG                                      30000000
300100         TO PV-ALL-DMA-VOL-PCT-CHG(PV-DMA-PROMO-IDX).             30010000
300200     MOVE PV-ACT-DMA-MKDN-DOL                                     30020000
300300         TO PV-ALL-ACT-DMA-MKDN-DOL(PV-DMA-PROMO-IDX).            30030000
300400     MOVE PV-FCST-DMA-MKDN-DOL                                    30040000
300500         TO PV-ALL-FCST-DMA-MKDN-DOL(PV-DMA-PROMO-IDX).           30050000
300600     MOVE PV-ACT-DMA-UNIT-SOLD                                    30060000
300700         TO PV-ALL-ACT-DMA-UNIT-SOLD(PV-DMA-PROMO-IDX).           30070000
300800     MOVE PV-FCST-DMA-UNIT-SOLD                                   30080000
300900         TO PV-ALL-FCST-DMA-UNIT-SOLD(PV-DMA-PROMO-IDX).          30090000
301000     MOVE PV-ACT-DMA-PREP-UNITS                                   30100000
301100         TO PV-ALL-ACT-DMA-PREP-UNITS(PV-DMA-PROMO-IDX).          30110000
301200     MOVE PV-FCST-DMA-PREP-UNITS                                  30120000
301300         TO PV-ALL-FCST-DMA-PREP-UNITS(PV-DMA-PROMO-IDX).         30130000
301400     MOVE PV-ACT-DMA-SLS-COST                                     30140000
301500         TO PV-ALL-ACT-DMA-SLS-COST(PV-DMA-PROMO-IDX).            30150000
301600     MOVE PV-FCST-DMA-SLS-COST                                    30160000
301700         TO PV-ALL-FCST-DMA-SLS-COST(PV-DMA-PROMO-IDX).           30170000
301800     MOVE PV-ACT-DMA-MKUP-PCT                                     30180000
301900         TO PV-ALL-ACT-DMA-MKUP-PCT(PV-DMA-PROMO-IDX).            30190000
302000     MOVE PV-FCST-DMA-MKUP-PCT                                    30200000
302100         TO PV-ALL-FCST-DMA-MKUP-PCT(PV-DMA-PROMO-IDX).           30210000
302200                                                                  30220000
302300***************************************************************** 30230000
302400* M105-COMPUTE-DMM-TOT-LINE.                                    * 30240000
302500* ==> PROCESSES:                                                * 30250000
302600*  - MOVE VALUES TO THE DETAIL LINE                             * 30260000
302700*  - WRITE TO REPORT                                            * 30270000
302800* ==> PERFORMED FROM: W300-PROCESS-PAGE-HEADER                  * 30280000
302900***************************************************************** 30290000
303000 M105-COMPUTE-DMM-TOT-LINE.                                       30300000
303100                                                                  30310000
303200     IF NOT(PV-TOT-FCST-DMA-SLS-VOL = ZEROS)                      30320000
303300         COMPUTE PV-TOT-DMA-VOL-CHG ROUNDED =                     30330000
303400           (((PV-TOT-FCST-DMA-SLS-VOL - PV-TOT-ACT-DMA-SLS-VOL)/  30340000
303500           PV-TOT-FCST-DMA-SLS-VOL) * -100)                       30350000
303600           ON SIZE ERROR MOVE 0 TO PV-TOT-DMA-VOL-CHG             30360000
303700         END-COMPUTE                                              30370000
303800     END-IF.                                                      30380000
303900                                                                  30390000
304000     COMPUTE PV-TOT-ACT-DMA-MKUP-PCT ROUNDED =                    30400000
304100       (((PV-TOT-ACT-DMA-SLS-VOL - PV-TOT-ACT-DMA-SLS-COST)/      30410000
304200         PV-TOT-ACT-DMA-SLS-VOL) * 100)                           30420000
304300       ON SIZE ERROR MOVE 0 TO PV-TOT-ACT-DMA-MKUP-PCT            30430000
304400     END-COMPUTE.                                                 30440000
304500                                                                  30450000
304600     COMPUTE PV-TOT-FCST-DMA-MKUP-PCT ROUNDED =                   30460000
304700       (((PV-TOT-FCST-DMA-SLS-VOL - PV-TOT-FCST-DMA-SLS-COST)/    30470000
304800         PV-TOT-FCST-DMA-SLS-VOL) * 100)                          30480000
304900       ON SIZE ERROR MOVE 0 TO PV-TOT-FCST-DMA-MKUP-PCT           30490000
305000     END-COMPUTE.                                                 30500000
305100                                                                  30510000
305200     MOVE 'DMM AD EVENT TOTAL'       TO DTL-DVSN-03-PROMO.        30520000
305300     MOVE PV-TOT-ACT-DMA-SLS-VOL     TO DTL-DVSN-03-ACT-SLS.      30530000
305400     MOVE PV-TOT-FCST-DMA-SLS-VOL    TO DTL-DVSN-03-FCST-SLS.     30540000
305500     MOVE PV-TOT-DMA-VOL-CHG         TO DTL-DVSN-03-VOL-CHG.      30550000
305600     IF DTL-DVSN-03-VOL-CHG = SPACES                              30560000
305700         MOVE SPACES                 TO DTL-DVSN-03-LEFT-PARA     30570000
305800         MOVE SPACES                 TO DTL-DVSN-03-VOL-CHG-PCT   30580000
305900         MOVE SPACES                 TO DTL-DVSN-03-RIGHT-PARA    30590000
306000     ELSE                                                         30600000
306100         IF PV-TOT-DMA-VOL-CHG < ZERO                             30610000
306200             MOVE "("                TO DTL-DVSN-03-LEFT-PARA     30620000
306300             MOVE "%"                TO DTL-DVSN-03-VOL-CHG-PCT   30630000
306400             MOVE ")"                TO DTL-DVSN-03-RIGHT-PARA    30640000
306500         ELSE                                                     30650000
306600             MOVE SPACES             TO DTL-DVSN-03-LEFT-PARA     30660000
306700             MOVE "%"                TO DTL-DVSN-03-VOL-CHG-PCT   30670000
306800             MOVE SPACES             TO DTL-DVSN-03-RIGHT-PARA    30680000
306900         END-IF                                                   30690000
307000     END-IF.                                                      30700000
307100     MOVE PV-TOT-FCST-DMA-MKDN-DOL   TO DTL-DVSN-03-FCST-MKDN.    30710000
307200     MOVE PV-TOT-ACT-DMA-UNIT-SOLD   TO DTL-DVSN-03-ACT-UNT-SLD.  30720000
307300     MOVE PV-TOT-FCST-DMA-UNIT-SOLD  TO DTL-DVSN-03-FCST-UNT-SLD. 30730000
307400     MOVE PV-TOT-ACT-DMA-PREP-UNITS  TO DTL-DVSN-03-ACT-PREP-UNT. 30740000
307500     MOVE PV-TOT-FCST-DMA-PREP-UNITS TO DTL-DVSN-03-FCST-PREP-UNT.30750000
307600     MOVE PV-TOT-ACT-DMA-MKUP-PCT    TO DTL-DVSN-03-ACT-MKUP-PCT. 30760000
307700     IF DTL-DVSN-03-ACT-MKUP-PCT = SPACES                         30770000
307800         MOVE SPACES               TO DTL-DVSN-03-ACT-MKUP-PCT-SN 30780000
307900     ELSE                                                         30790000
308000         MOVE "%"                  TO DTL-DVSN-03-ACT-MKUP-PCT-SN 30800000
308100     END-IF.                                                      30810000
308200     MOVE PV-TOT-FCST-DMA-MKUP-PCT  TO DTL-DVSN-03-FCST-MKUP-PCT. 30820000
308300     IF DTL-DVSN-03-FCST-MKUP-PCT = SPACES                        30830000
308400         MOVE SPACES               TO DTL-DVSN-03-FCST-MKUP-PCT-SN30840000
308500     ELSE                                                         30850000
308600         MOVE "%"                  TO DTL-DVSN-03-FCST-MKUP-PCT-SN30860000
308700     END-IF.                                                      30870000
308800                                                                  30880000
308900     MOVE DTL-DIVISION-03        TO PV-RPT-LINE.                  30890000
309000     MOVE 1                      TO PV-ADVANCE-LINES.             30900000
309100     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  30910000
309200     PERFORM W200-WRITE-RPT-LINE.                                 30920000
309300                                                                  30930000
309400***************************************************************** 30940000
309500* M110-MOVE-COMPUTE-DPT-TOT.                                    * 30950000
309600* ==> PROCESSES:                                                * 30960000
309700*  - COMPUTE DPT TOTALS                                         * 30970000
309800*  - MOVE SINGLE VALUES TO THE DETAIL LINE                      * 30980000
309900* ==> PERFORMED FROM: D120-PROCESS-DPT-PROMO-TOT                * 30990000
310000***************************************************************** 31000000
310100 M110-MOVE-COMPUTE-DPT-TOT.                                       31010000
310200                                                                  31020000
310300     COMPUTE PV-DPT-VOL-PCT-CHG ROUNDED =                         31030000
310400     (((PV-FCST-DPT-SLS-VOL - PV-ACT-DPT-SLS-VOL)/                31040000
310500        PV-FCST-DPT-SLS-VOL) * -100)                              31050000
310600       ON SIZE ERROR MOVE 0 TO PV-DPT-VOL-PCT-CHG                 31060000
310700     END-COMPUTE.                                                 31070000
310800     ADD 0 TO PV-DPT-VOL-PCT-CHG.                                 31080000
310900                                                                  31090000
311000     COMPUTE PV-TOT-ACT-DPT-SLS-VOL =                             31100000
311100       (PV-TOT-ACT-DPT-SLS-VOL + PV-ACT-DPT-SLS-VOL).             31110000
311200     COMPUTE PV-TOT-FCST-DPT-SLS-VOL =                            31120000
311300       (PV-TOT-FCST-DPT-SLS-VOL + PV-FCST-DPT-SLS-VOL).           31130000
311400     COMPUTE PV-TOT-ACT-DPT-MKDN-DOL =                            31140000
311500       (PV-TOT-ACT-DPT-MKDN-DOL + PV-ACT-DPT-MKDN-DOL).           31150000
311600     COMPUTE PV-TOT-FCST-DPT-MKDN-DOL =                           31160000
311700       (PV-TOT-FCST-DPT-MKDN-DOL + PV-FCST-DPT-MKDN-DOL).         31170000
311800     COMPUTE PV-TOT-ACT-DPT-UNIT-SOLD =                           31180000
311900       (PV-TOT-ACT-DPT-UNIT-SOLD + PV-ACT-DPT-UNIT-SOLD).         31190000
312000     COMPUTE PV-TOT-FCST-DPT-UNIT-SOLD =                          31200000
312100       (PV-TOT-FCST-DPT-UNIT-SOLD + PV-FCST-DPT-UNIT-SOLD).       31210000
312200     COMPUTE PV-TOT-ACT-DPT-PREP-UNITS =                          31220000
312300       (PV-TOT-ACT-DPT-PREP-UNITS + PV-ACT-DPT-PREP-UNITS).       31230000
312400     COMPUTE PV-TOT-FCST-DPT-PREP-UNITS =                         31240000
312500        (PV-TOT-FCST-DPT-PREP-UNITS + PV-FCST-DPT-PREP-UNITS).    31250000
312600     COMPUTE PV-TOT-ACT-DPT-SLS-COST =                            31260000
312700       (PV-TOT-ACT-DPT-SLS-COST + PV-ACT-DPT-SLS-COST).           31270000
312800     COMPUTE PV-TOT-FCST-DPT-SLS-COST =                           31280000
312900       (PV-TOT-FCST-DPT-SLS-COST + PV-FCST-DPT-SLS-COST).         31290000
313000                                                                  31300000
313100     MOVE PV-ALL-PROMO-NM(PV-DPT-INDEX) TO DTL-DEPT-02-PROMO.     31310000
313200     MOVE PV-ACT-DPT-SLS-VOL            TO DTL-DEPT-02-ACT-SLS.   31320000
313300     MOVE PV-FCST-DPT-SLS-VOL           TO DTL-DEPT-02-FCST-SLS.  31330000
313400     MOVE PV-DPT-VOL-PCT-CHG            TO DTL-DEPT-02-VOL-CHG.   31340000
313500     IF DTL-DEPT-02-VOL-CHG = SPACES                              31350000
313600         MOVE SPACES                 TO DTL-DEPT-02-LEFT-PARA     31360000
313700         MOVE SPACES                 TO DTL-DEPT-02-VOL-CHG-PCT   31370000
313800         MOVE SPACES                 TO DTL-DEPT-02-RIGHT-PARA    31380000
313900     ELSE                                                         31390000
314000         IF PV-DPT-VOL-PCT-CHG < ZERO                             31400000
314100             MOVE "("                   TO DTL-DEPT-02-LEFT-PARA  31410000
314200             MOVE "%"                   TO DTL-DEPT-02-VOL-CHG-PCT31420000
314300             MOVE ")"                   TO DTL-DEPT-02-RIGHT-PARA 31430000
314400         ELSE                                                     31440000
314500            MOVE SPACES                 TO DTL-DEPT-02-LEFT-PARA  31450000
314600            MOVE "%"                    TO DTL-DEPT-02-VOL-CHG-PCT31460000
314700            MOVE SPACES                 TO DTL-DEPT-02-RIGHT-PARA 31470000
314800         END-IF                                                   31480000
314900     END-IF.                                                      31490000
315000     MOVE PV-ACT-DPT-MKDN-DOL      TO DTL-DEPT-02-ACT-MKDN.       31500000
315100     MOVE PV-FCST-DPT-MKDN-DOL     TO DTL-DEPT-02-FCST-MKDN.      31510000
315200     MOVE PV-ACT-DPT-UNIT-SOLD     TO DTL-DEPT-02-ACT-UNT-SLD.    31520000
315300     MOVE PV-FCST-DPT-UNIT-SOLD    TO DTL-DEPT-02-FCST-UNT-SLD.   31530000
315400     MOVE PV-ACT-DPT-PREP-UNITS    TO DTL-DEPT-02-ACT-PREP-UNT.   31540000
315500     MOVE PV-FCST-DPT-PREP-UNITS   TO DTL-DEPT-02-FCST-PREP-UNT.  31550000
315600     MOVE PV-ACT-DPT-MKUP-PCT      TO DTL-DEPT-02-ACT-MKUP-PCT.   31560000
315700     IF DTL-DEPT-02-ACT-MKUP-PCT = SPACES                         31570000
315800         MOVE SPACES               TO DTL-DEPT-02-ACT-MKUP-PCT-SN 31580000
315900     ELSE                                                         31590000
316000         MOVE "%"                  TO DTL-DEPT-02-ACT-MKUP-PCT-SN 31600000
316100     END-IF.                                                      31610000
316200     MOVE PV-FCST-DPT-MKUP-PCT  TO DTL-DEPT-02-FCST-MKUP-PCT.     31620000
316300     IF DTL-DEPT-02-FCST-MKUP-PCT = SPACES                        31630000
316400         MOVE SPACES               TO DTL-DEPT-02-FCST-MKUP-PCT-SN31640000
316500     ELSE                                                         31650000
316600         MOVE "%"                  TO DTL-DEPT-02-FCST-MKUP-PCT-SN31660000
316700     END-IF.                                                      31670000
316800                                                                  31680000
316900***************************************************************** 31690000
317000* M115-COMPUTE-DPT-TOT-LINE.                                    * 31700000
317100* ==> PROCESSES:                                                * 31710000
317200*  - MOVE TOTAL VALUES TO THE DETAIL LINE AND WRITE TO REPORT   * 31720000
317300*  - COMPUTE % OF AD EVENT TOTALS AND WRITE TO REPORT           * 31730000
317400* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 31740000
317500***************************************************************** 31750000
317600 M115-COMPUTE-DPT-TOT-LINE.                                       31760000
317700                                                                  31770000
317800     IF NOT(PV-TOT-FCST-DPT-SLS-VOL = 0)                          31780000
317900         COMPUTE PV-TOT-DPT-VOL-CHG ROUNDED =                     31790000
318000         (((PV-TOT-FCST-DPT-SLS-VOL - PV-TOT-ACT-DPT-SLS-VOL)/    31800000
318100            PV-TOT-FCST-DPT-SLS-VOL) * -100)                      31810000
318200           ON SIZE ERROR MOVE 0 TO PV-TOT-DPT-VOL-CHG             31820000
318300         END-COMPUTE                                              31830000
318400     END-IF.                                                      31840000
318500                                                                  31850000
318600     COMPUTE PV-TOT-ACT-DPT-MKUP-PCT ROUNDED =                    31860000
318700       (((PV-TOT-ACT-DPT-SLS-VOL - PV-TOT-ACT-DPT-SLS-COST)/      31870000
318800          PV-TOT-ACT-DPT-SLS-VOL) * 100)                          31880000
318900         ON SIZE ERROR MOVE 0 TO PV-TOT-ACT-DPT-MKUP-PCT          31890000
319000     END-COMPUTE.                                                 31900000
319100                                                                  31910000
319200     COMPUTE PV-TOT-FCST-DPT-MKUP-PCT ROUNDED =                   31920000
319300       (((PV-TOT-FCST-DPT-SLS-VOL - PV-TOT-FCST-DPT-SLS-COST)/    31930000
319400         PV-TOT-FCST-DPT-SLS-VOL) * 100)                          31940000
319500       ON SIZE ERROR MOVE 0 TO PV-TOT-FCST-DPT-MKUP-PCT           31950000
319600     END-COMPUTE.                                                 31960000
319700                                                                  31970000
319800     MOVE 'DEPT AD EVENT TOTAL'      TO DTL-DEPT-02-PROMO.        31980000
319900     MOVE PV-TOT-ACT-DPT-SLS-VOL     TO DTL-DEPT-02-ACT-SLS.      31990000
320000     MOVE PV-TOT-FCST-DPT-SLS-VOL    TO DTL-DEPT-02-FCST-SLS.     32000000
320100     MOVE PV-TOT-DPT-VOL-CHG         TO DTL-DEPT-02-VOL-CHG.      32010000
320200     IF DTL-DEPT-02-VOL-CHG = SPACES                              32020000
320300         MOVE SPACES                 TO DTL-DEPT-02-LEFT-PARA     32030000
320400         MOVE SPACES                 TO DTL-DEPT-02-VOL-CHG-PCT   32040000
320500         MOVE SPACES                 TO DTL-DEPT-02-RIGHT-PARA    32050000
320600     ELSE                                                         32060000
320700         IF PV-TOT-DPT-VOL-CHG < ZERO                             32070000
320800             MOVE "("                TO DTL-DEPT-02-LEFT-PARA     32080000
320900             MOVE "%"                TO DTL-DEPT-02-VOL-CHG-PCT   32090000
321000             MOVE ")"                TO DTL-DEPT-02-RIGHT-PARA    32100000
321100         ELSE                                                     32110000
321200            MOVE SPACES              TO DTL-DEPT-02-LEFT-PARA     32120000
321300            MOVE "%"                 TO DTL-DEPT-02-VOL-CHG-PCT   32130000
321400            MOVE SPACES              TO DTL-DEPT-02-RIGHT-PARA    32140000
321500         END-IF                                                   32150000
321600     END-IF.                                                      32160000
321700     MOVE PV-TOT-ACT-DPT-MKDN-DOL    TO DTL-DEPT-02-ACT-MKDN.     32170000
321800     MOVE PV-TOT-FCST-DPT-MKDN-DOL   TO DTL-DEPT-02-FCST-MKDN.    32180000
321900     MOVE PV-TOT-ACT-DPT-UNIT-SOLD   TO DTL-DEPT-02-ACT-UNT-SLD.  32190000
322000     MOVE PV-TOT-FCST-DPT-UNIT-SOLD  TO DTL-DEPT-02-FCST-UNT-SLD. 32200000
322100     MOVE PV-TOT-ACT-DPT-PREP-UNITS  TO DTL-DEPT-02-ACT-PREP-UNT. 32210000
322200     MOVE PV-TOT-FCST-DPT-PREP-UNITS TO DTL-DEPT-02-FCST-PREP-UNT.32220000
322300     MOVE PV-TOT-ACT-DPT-MKUP-PCT    TO DTL-DEPT-02-ACT-MKUP-PCT. 32230000
322400     IF DTL-DEPT-02-ACT-MKUP-PCT = SPACES                         32240000
322500         MOVE SPACES             TO DTL-DEPT-02-ACT-MKUP-PCT-SN   32250000
322600     ELSE                                                         32260000
322700         MOVE "%"                TO DTL-DEPT-02-ACT-MKUP-PCT-SN   32270000
322800     END-IF.                                                      32280000
322900     MOVE PV-TOT-FCST-DPT-MKUP-PCT   TO DTL-DEPT-02-FCST-MKUP-PCT.32290000
323000     IF DTL-DEPT-02-FCST-MKUP-PCT = SPACES                        32300000
323100         MOVE SPACES             TO DTL-DEPT-02-FCST-MKUP-PCT-SN  32310000
323200     ELSE                                                         32320000
323300         MOVE "%"                TO DTL-DEPT-02-FCST-MKUP-PCT-SN  32330000
323400     END-IF.                                                      32340000
323500                                                                  32350000
323600     MOVE DTL-DEPT-02            TO PV-RPT-LINE.                  32360000
323700     MOVE 1                      TO PV-ADVANCE-LINES.             32370000
323800     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  32380000
323900     PERFORM W200-WRITE-RPT-LINE.                                 32390000
324000     INITIALIZE DTL-DEPT-02.                                      32400000
324100                                                                  32410000
324200     COMPUTE DTL-DEPT-03-ACT-SLS ROUNDED =                        32420000
324300       (PV-TOT-ACT-DPT-SLS-VOL / PV-ACT-ADEVNT-SLS-VOL) * 100     32430000
324400       ON SIZE ERROR MOVE 0 TO DTL-DEPT-03-ACT-SLS                32440000
324500     END-COMPUTE.                                                 32450000
324600     IF DTL-DEPT-03-ACT-SLS = SPACES                              32460000
324700         MOVE SPACES             TO DTL-DEPT-03-ACT-SLS-PCT       32470000
324800     ELSE                                                         32480000
324900         MOVE '%'                TO DTL-DEPT-03-ACT-SLS-PCT       32490000
325000     END-IF.                                                      32500000
325100                                                                  32510000
325200     COMPUTE DTL-DEPT-03-FCST-SLS ROUNDED =                       32520000
325300       (PV-TOT-FCST-DPT-SLS-VOL / PV-FCST-ADEVNT-SLS-VOL) * 100   32530000
325400       ON SIZE ERROR MOVE 0 TO DTL-DEPT-03-FCST-SLS               32540000
325500     END-COMPUTE.                                                 32550000
325600     IF DTL-DEPT-03-FCST-SLS = SPACES                             32560000
325700         MOVE SPACES             TO DTL-DEPT-03-FCST-SLS-PCT      32570000
325800     ELSE                                                         32580000
325900         MOVE '%'                TO DTL-DEPT-03-FCST-SLS-PCT      32590000
326000     END-IF.                                                      32600000
326100                                                                  32610000
326200     COMPUTE DTL-DEPT-03-ACT-MKDN ROUNDED =                       32620000
326300       (PV-TOT-ACT-DPT-MKDN-DOL / PV-ACT-ADEVNT-MKDN-DOL) * 100   32630000
326400       ON SIZE ERROR MOVE 0 TO DTL-DEPT-03-ACT-MKDN               32640000
326500     END-COMPUTE.                                                 32650000
326600     IF DTL-DEPT-03-ACT-MKDN = SPACES                             32660000
326700         MOVE SPACES             TO DTL-DEPT-03-ACT-MKDN-PCT      32670000
326800     ELSE                                                         32680000
326900         MOVE '%'                TO DTL-DEPT-03-ACT-MKDN-PCT      32690000
327000     END-IF.                                                      32700000
327100                                                                  32710000
327200     COMPUTE DTL-DEPT-03-FCST-MKDN ROUNDED =                      32720000
327300       (PV-TOT-FCST-DPT-MKDN-DOL / PV-FCST-ADEVNT-MKDN-DOL) * 100 32730000
327400       ON SIZE ERROR MOVE 0 TO DTL-DEPT-03-FCST-MKDN              32740000
327500     END-COMPUTE.                                                 32750000
327600     IF DTL-DEPT-03-FCST-MKDN = SPACES                            32760000
327700         MOVE SPACES             TO DTL-DEPT-03-FCST-MKDN-PCT     32770000
327800     ELSE                                                         32780000
327900         MOVE '%'                TO DTL-DEPT-03-FCST-MKDN-PCT     32790000
328000     END-IF.                                                      32800000
328100                                                                  32810000
328200     MOVE DTL-DEPT-03            TO PV-RPT-LINE.                  32820000
328300     MOVE 1                      TO PV-ADVANCE-LINES.             32830000
328400     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  32840000
328500     PERFORM W200-WRITE-RPT-LINE.                                 32850000
328600                                                                  32860000
328700***************************************************************** 32870000
328800* M120-MOVE-COMPUTE-BYR-TOT.                                    * 32880000
328900* ==> PROCESSES:                                                * 32890000
329000*  - COMPUTE BUYER TOTALS                                       * 32900000
329100*  - COMPUTE BUYER % TO DMM PROMO TOTALS                        * 32910000
329200*  - MOVE BOTH TO DETAIL LINE AND WRITE TO REPORT               * 32920000
329300* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 32930000
329400***************************************************************** 32940000
329500 M120-MOVE-COMPUTE-BYR-TOT.                                       32950000
329600                                                                  32960000
329700     COMPUTE PV-BYR-VOL-PCT-CHG ROUNDED =                         32970000
329800       (((PV-FCST-BYR-SLS-VOL - PV-ACT-BYR-SLS-VOL)/              32980000
329900          PV-FCST-BYR-SLS-VOL) * -100)                            32990000
330000       ON SIZE ERROR MOVE 0 TO PV-BYR-VOL-PCT-CHG                 33000000
330100     END-COMPUTE.                                                 33010000
330200                                                                  33020000
330300     COMPUTE PV-TOT-ACT-BYR-SLS-VOL =                             33030000
330400       (PV-TOT-ACT-BYR-SLS-VOL + PV-ACT-BYR-SLS-VOL).             33040000
330500     COMPUTE PV-TOT-FCST-BYR-SLS-VOL =                            33050000
330600       (PV-TOT-FCST-BYR-SLS-VOL + PV-FCST-BYR-SLS-VOL).           33060000
330700     COMPUTE PV-TOT-ACT-BYR-MKDN-DOL =                            33070000
330800       (PV-TOT-ACT-BYR-MKDN-DOL + PV-ACT-BYR-MKDN-DOL).           33080000
330900     COMPUTE PV-TOT-FCST-BYR-MKDN-DOL =                           33090000
331000       (PV-TOT-FCST-BYR-MKDN-DOL + PV-FCST-BYR-MKDN-DOL).         33100000
331100     COMPUTE PV-TOT-ACT-BYR-UNIT-SOLD =                           33110000
331200       (PV-TOT-ACT-BYR-UNIT-SOLD + PV-ACT-BYR-UNIT-SOLD).         33120000
331300     COMPUTE PV-TOT-FCST-BYR-UNIT-SOLD =                          33130000
331400       (PV-TOT-FCST-BYR-UNIT-SOLD + PV-FCST-BYR-UNIT-SOLD).       33140000
331500     COMPUTE PV-TOT-ACT-BYR-PREP-UNITS =                          33150000
331600       (PV-TOT-ACT-BYR-PREP-UNITS + PV-ACT-BYR-PREP-UNITS).       33160000
331700     COMPUTE PV-TOT-FCST-BYR-PREP-UNITS =                         33170000
331800        (PV-TOT-FCST-BYR-PREP-UNITS + PV-FCST-BYR-PREP-UNITS).    33180000
331900     COMPUTE PV-TOT-ACT-BYR-SLS-COST =                            33190000
332000       (PV-TOT-ACT-BYR-SLS-COST + PV-ACT-BYR-SLS-COST).           33200000
332100     COMPUTE PV-TOT-FCST-BYR-SLS-COST =                           33210000
332200       (PV-TOT-FCST-BYR-SLS-COST + PV-FCST-BYR-SLS-COST).         33220000
332300                                                                  33230000
332400     COMPUTE PV-BYR-DMM-ACT-SLS-VOL ROUNDED =                     33240000
332500         ((PV-ACT-BYR-SLS-VOL /                                   33250000
332600          PV-ALL-ACT-DMA-SLS-VOL(PV-ALL-DMA-PROMO-IDX)) * 100)    33260000
332700       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-ACT-SLS-VOL             33270000
332800     END-COMPUTE.                                                 33280000
332900                                                                  33290000
333000     COMPUTE PV-BYR-DMM-FCST-SLS-VOL ROUNDED =                    33300000
333100         ((PV-FCST-BYR-SLS-VOL /                                  33310000
333200          PV-ALL-FCST-DMA-SLS-VOL(PV-ALL-DMA-PROMO-IDX)) * 100)   33320000
333300       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-FCST-SLS-VOL            33330000
333400     END-COMPUTE.                                                 33340000
333500                                                                  33350000
333600     COMPUTE PV-BYR-DMM-ACT-MKDN-DOL ROUNDED =                    33360000
333700         ((PV-ACT-BYR-MKDN-DOL /                                  33370000
333800          PV-ALL-ACT-DMA-MKDN-DOL(PV-ALL-DMA-PROMO-IDX)) * 100)   33380000
333900       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-ACT-MKDN-DOL            33390000
334000     END-COMPUTE.                                                 33400000
334100                                                                  33410000
334200     COMPUTE PV-BYR-DMM-FCST-MKDN-DOL ROUNDED =                   33420000
334300         ((PV-FCST-BYR-MKDN-DOL /                                 33430000
334400          PV-ALL-FCST-DMA-MKDN-DOL(PV-ALL-DMA-PROMO-IDX)) * 100)  33440000
334500       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-FCST-MKDN-DOL           33450000
334600     END-COMPUTE.                                                 33460000
334700                                                                  33470000
334800     COMPUTE PV-BYR-DMM-ACT-UNIT-SOLD ROUNDED =                   33480000
334900         ((PV-ACT-BYR-UNIT-SOLD /                                 33490000
335000          PV-ALL-ACT-DMA-UNIT-SOLD(PV-ALL-DMA-PROMO-IDX)) * 100)  33500000
335100       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-ACT-UNIT-SOLD           33510000
335200     END-COMPUTE.                                                 33520000
335300                                                                  33530000
335400     COMPUTE PV-BYR-DMM-FCST-UNIT-SOLD ROUNDED =                  33540000
335500         ((PV-FCST-BYR-UNIT-SOLD /                                33550000
335600          PV-ALL-FCST-DMA-UNIT-SOLD(PV-ALL-DMA-PROMO-IDX)) * 100) 33560000
335700       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-FCST-UNIT-SOLD          33570000
335800     END-COMPUTE.                                                 33580000
335900                                                                  33590000
336000     COMPUTE PV-BYR-DMM-ACT-PREP-UNITS ROUNDED =                  33600000
336100         ((PV-ACT-BYR-PREP-UNITS /                                33610000
336200          PV-ALL-ACT-DMA-PREP-UNITS(PV-ALL-DMA-PROMO-IDX)) * 100) 33620000
336300       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-ACT-PREP-UNITS          33630000
336400     END-COMPUTE.                                                 33640000
336500                                                                  33650000
336600     COMPUTE PV-BYR-DMM-FCST-PREP-UNITS ROUNDED =                 33660000
336700         ((PV-FCST-BYR-PREP-UNITS /                               33670000
336800          PV-ALL-FCST-DMA-PREP-UNITS(PV-ALL-DMA-PROMO-IDX)) * 100)33680000
336900       ON SIZE ERROR MOVE 0 TO PV-BYR-DMM-FCST-PREP-UNITS         33690000
337000     END-COMPUTE.                                                 33700000
337100                                                                  33710000
337200     IF PA-BYR-PROMO-TOT-CNT = 1                                  33720000
337300         MOVE ' BUYER TOTAL -'    TO DTL-BYR-01-TITLE             33730000
337400     ELSE                                                         33740000
337500         MOVE SPACES              TO DTL-BYR-01-TITLE             33750000
337600     END-IF.                                                      33760000
337700     MOVE PV-BYR-PROMO-NM         TO DTL-BYR-01-PROMO-NM.         33770000
337800     MOVE PV-ACT-BYR-SLS-VOL      TO DTL-BYR-01-ACT-SLS.          33780000
337900     MOVE PV-FCST-BYR-SLS-VOL     TO DTL-BYR-01-FCST-SLS.         33790000
338000     MOVE PV-BYR-VOL-PCT-CHG      TO DTL-BYR-01-VOL-CHG.          33800000
338100     IF DTL-BYR-01-VOL-CHG = SPACES                               33810000
338200         MOVE SPACES              TO DTL-BYR-01-LEFT-PARA         33820000
338300         MOVE SPACES              TO DTL-BYR-01-VOL-CHG-PCT       33830000
338400         MOVE SPACES              TO DTL-BYR-01-RIGHT-PARA        33840000
338500     ELSE                                                         33850000
338600         IF PV-BYR-VOL-PCT-CHG < ZERO                             33860000
338700             MOVE "("             TO DTL-BYR-01-LEFT-PARA         33870000
338800             MOVE "%"             TO DTL-BYR-01-VOL-CHG-PCT       33880000
338900             MOVE ")"             TO DTL-BYR-01-RIGHT-PARA        33890000
339000         ELSE                                                     33900000
339100             MOVE SPACES          TO DTL-BYR-01-LEFT-PARA         33910000
339200             MOVE "%"             TO DTL-BYR-01-VOL-CHG-PCT       33920000
339300             MOVE SPACES          TO DTL-BYR-01-RIGHT-PARA        33930000
339400         END-IF                                                   33940000
339500     END-IF.                                                      33950000
339600     MOVE PV-ACT-BYR-MKDN-DOL     TO DTL-BYR-01-ACT-MKDN.         33960000
339700     MOVE PV-FCST-BYR-MKDN-DOL    TO DTL-BYR-01-FCST-MKDN.        33970000
339800     MOVE PV-ACT-BYR-UNIT-SOLD    TO DTL-BYR-01-ACT-UNT-SLD.      33980000
339900     MOVE PV-FCST-BYR-UNIT-SOLD   TO DTL-BYR-01-FCST-UNT-SLD.     33990000
340000     MOVE PV-ACT-BYR-PREP-UNITS   TO DTL-BYR-01-ACT-PREP-UNT.     34000000
340100     MOVE PV-FCST-BYR-PREP-UNITS  TO DTL-BYR-01-FCST-PREP-UNT.    34010000
340200     MOVE PV-ACT-BYR-MKUP-PCT     TO DTL-BYR-01-ACT-MKUP-PCT.     34020000
340300     IF DTL-BYR-01-ACT-MKDN = SPACES                              34030000
340400         MOVE SPACES             TO DTL-BYR-01-ACT-MKUP-PCT-SN    34040000
340500     ELSE                                                         34050000
340600         MOVE "%"                TO DTL-BYR-01-ACT-MKUP-PCT-SN    34060000
340700     END-IF.                                                      34070000
340800     MOVE PV-FCST-BYR-MKUP-PCT    TO DTL-BYR-01-FCST-MKUP-PCT.    34080000
340900     IF DTL-BYR-01-FCST-MKDN = SPACES                             34090000
341000         MOVE SPACES            TO DTL-BYR-01-FCST-MKUP-PCT-SN    34100000
341100     ELSE                                                         34110000
341200         MOVE "%"               TO DTL-BYR-01-FCST-MKUP-PCT-SN    34120000
341300     END-IF.                                                      34130000
341400                                                                  34140000
341500     MOVE PV-BYR-DMM-ACT-SLS-VOL  TO DTL-BYR-02-ACT-SLS.          34150000
341600     IF DTL-BYR-02-ACT-SLS = SPACES                               34160000
341700         MOVE SPACES              TO DTL-BYR-02-ACT-SLS-PCT       34170000
341800     ELSE                                                         34180000
341900         MOVE '%'                 TO DTL-BYR-02-ACT-SLS-PCT       34190000
342000     END-IF.                                                      34200000
342100                                                                  34210000
342200     MOVE PV-BYR-DMM-FCST-SLS-VOL TO DTL-BYR-02-FCST-SLS.         34220000
342300     IF DTL-BYR-02-FCST-SLS = SPACES                              34230000
342400         MOVE SPACES              TO DTL-BYR-02-FCST-SLS-PCT      34240000
342500     ELSE                                                         34250000
342600         MOVE '%'                 TO DTL-BYR-02-FCST-SLS-PCT      34260000
342700     END-IF.                                                      34270000
342800                                                                  34280000
342900     MOVE PV-BYR-DMM-ACT-MKDN-DOL TO DTL-BYR-02-ACT-MKDN.         34290000
343000     IF DTL-BYR-02-ACT-MKDN = SPACES                              34300000
343100         MOVE SPACES              TO DTL-BYR-02-ACT-MKDN-PCT      34310000
343200     ELSE                                                         34320000
343300         MOVE '%'                 TO DTL-BYR-02-ACT-MKDN-PCT      34330000
343400     END-IF.                                                      34340000
343500                                                                  34350000
343600     MOVE PV-BYR-DMM-FCST-MKDN-DOL TO DTL-BYR-02-FCST-MKDN.       34360000
343700     IF DTL-BYR-02-FCST-MKDN = SPACES                             34370000
343800         MOVE SPACES              TO DTL-BYR-02-FCST-MKDN-PCT     34380000
343900     ELSE                                                         34390000
344000         MOVE '%'                 TO DTL-BYR-02-FCST-MKDN-PCT     34400000
344100     END-IF.                                                      34410000
344200                                                                  34420000
344300     MOVE PV-BYR-DMM-ACT-UNIT-SOLD TO DTL-BYR-02-ACT-UNT-SLD.     34430000
344400     IF DTL-BYR-02-ACT-UNT-SLD = SPACES                           34440000
344500         MOVE SPACES             TO DTL-BYR-02-ACT-UNT-SLD-PCT    34450000
344600     ELSE                                                         34460000
344700         MOVE '%'                TO DTL-BYR-02-ACT-UNT-SLD-PCT    34470000
344800     END-IF.                                                      34480000
344900                                                                  34490000
345000     MOVE PV-BYR-DMM-FCST-UNIT-SOLD TO DTL-BYR-02-FCST-UNT-SLD.   34500000
345100     IF DTL-BYR-02-FCST-UNT-SLD = SPACES                          34510000
345200         MOVE SPACES            TO DTL-BYR-02-FCST-UNT-SLD-PCT    34520000
345300     ELSE                                                         34530000
345400         MOVE '%'               TO DTL-BYR-02-FCST-UNT-SLD-PCT    34540000
345500     END-IF.                                                      34550000
345600                                                                  34560000
345700     MOVE PV-BYR-DMM-ACT-PREP-UNITS TO DTL-BYR-02-ACT-PREP-UNT.   34570000
345800     IF DTL-BYR-02-ACT-PREP-UNT = SPACES                          34580000
345900         MOVE SPACES              TO DTL-BYR-02-ACT-PREP-UNT-PCT  34590000
346000     ELSE                                                         34600000
346100         MOVE '%'                 TO DTL-BYR-02-ACT-PREP-UNT-PCT  34610000
346200     END-IF.                                                      34620000
346300                                                                  34630000
346400     MOVE PV-BYR-DMM-FCST-PREP-UNITS TO DTL-BYR-02-FCST-PREP-UNT. 34640000
346500                                                                  34650000
346600     IF DTL-BYR-02-FCST-PREP-UNT = SPACES                         34660000
346700         MOVE SPACES              TO DTL-BYR-02-FCST-PREP-UNT-PCT 34670000
346800     ELSE                                                         34680000
346900         MOVE '%'                 TO DTL-BYR-02-FCST-PREP-UNT-PCT 34690000
347000     END-IF.                                                      34700000
347100                                                                  34710000
347200***************************************************************** 34720000
347300* M125-COMPUTE-BYR-TOT-LINE.                                    * 34730000
347400* ==> PROCESSES:                                                * 34740000
347500*  - MOVE TOTALS TO DETIAL LINE AND WRITE TO REPORT             * 34750000
347600* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 34760000
347700***************************************************************** 34770000
347800 M125-COMPUTE-BYR-TOT-LINE.                                       34780000
347900                                                                  34790000
348000     IF NOT(PV-TOT-FCST-BYR-SLS-VOL = 0)                          34800000
348100         COMPUTE PV-TOT-BYR-VOL-CHG ROUNDED =                     34810000
348200           (((PV-TOT-FCST-BYR-SLS-VOL - PV-TOT-ACT-BYR-SLS-VOL)/  34820000
348300              PV-TOT-FCST-BYR-SLS-VOL) * -100)                    34830000
348400           ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-VOL-CHG             34840000
348500         END-COMPUTE                                              34850000
348600     END-IF.                                                      34860000
348700                                                                  34870000
348800     COMPUTE PV-TOT-ACT-BYR-MKUP-PCT ROUNDED =                    34880000
348900       (((PV-TOT-ACT-BYR-SLS-VOL - PV-TOT-ACT-BYR-SLS-COST)/      34890000
349000         PV-TOT-ACT-BYR-SLS-VOL) * 100)                           34900000
349100       ON SIZE ERROR MOVE 0 TO PV-TOT-ACT-BYR-MKUP-PCT            34910000
349200     END-COMPUTE.                                                 34920000
349300                                                                  34930000
349400     COMPUTE PV-TOT-FCST-BYR-MKUP-PCT ROUNDED =                   34940000
349500       (((PV-TOT-FCST-BYR-SLS-VOL - PV-TOT-FCST-BYR-SLS-COST)/    34950000
349600         PV-TOT-FCST-BYR-SLS-VOL) * 100)                          34960000
349700       ON SIZE ERROR MOVE 0 TO PV-TOT-FCST-BYR-MKUP-PCT           34970000
349800     END-COMPUTE.                                                 34980000
349900                                                                  34990000
350000     MOVE PV-TOT-ACT-BYR-SLS-VOL     TO DTL-BYR-03-ACT-SLS.       35000000
350100     MOVE PV-TOT-FCST-BYR-SLS-VOL    TO DTL-BYR-03-FCST-SLS.      35010000
350200     MOVE PV-TOT-BYR-VOL-CHG         TO DTL-BYR-03-VOL-CHG.       35020000
350300     IF DTL-BYR-03-VOL-CHG = SPACES                               35030000
350400        MOVE SPACES                  TO DTL-BYR-03-LEFT-PARA      35040000
350500        MOVE SPACES                  TO DTL-BYR-03-VOL-CHG-PCT    35050000
350600        MOVE SPACES                  TO DTL-BYR-03-RIGHT-PARA     35060000
350700     ELSE                                                         35070000
350800        IF PV-TOT-BYR-VOL-CHG < ZERO                              35080000
350900            MOVE "("                 TO DTL-BYR-03-LEFT-PARA      35090000
351000            MOVE "%"                 TO DTL-BYR-03-VOL-CHG-PCT    35100000
351100            MOVE ")"                 TO DTL-BYR-03-RIGHT-PARA     35110000
351200        ELSE                                                      35120000
351300            MOVE SPACES              TO DTL-BYR-03-LEFT-PARA      35130000
351400            MOVE "%"                 TO DTL-BYR-03-VOL-CHG-PCT    35140000
351500            MOVE SPACES              TO DTL-BYR-03-RIGHT-PARA     35150000
351600        END-IF                                                    35160000
351700     END-IF.                                                      35170000
351800     MOVE PV-TOT-ACT-BYR-MKDN-DOL    TO DTL-BYR-03-ACT-MKDN.      35180000
351900     MOVE PV-TOT-FCST-BYR-MKDN-DOL   TO DTL-BYR-03-FCST-MKDN.     35190000
352000     MOVE PV-TOT-ACT-BYR-UNIT-SOLD   TO DTL-BYR-03-ACT-UNT-SLD.   35200000
352100     MOVE PV-TOT-FCST-BYR-UNIT-SOLD  TO DTL-BYR-03-FCST-UNT-SLD.  35210000
352200     MOVE PV-TOT-ACT-BYR-PREP-UNITS  TO DTL-BYR-03-ACT-PREP-UNT.  35220000
352300     MOVE PV-TOT-FCST-BYR-PREP-UNITS TO DTL-BYR-03-FCST-PREP-UNT. 35230000
352400     MOVE PV-TOT-ACT-BYR-MKUP-PCT    TO DTL-BYR-03-ACT-MKUP-PCT.  35240000
352500     IF DTL-BYR-03-ACT-MKUP-PCT = SPACES                          35250000
352600         MOVE SPACES               TO DTL-BYR-03-ACT-MKUP-PCT-SN  35260000
352700     ELSE                                                         35270000
352800         MOVE "%"                  TO DTL-BYR-03-ACT-MKUP-PCT-SN  35280000
352900     END-IF.                                                      35290000
353000     MOVE PV-TOT-FCST-BYR-MKUP-PCT   TO DTL-BYR-03-FCST-MKUP-PCT. 35300000
353100     IF DTL-BYR-03-FCST-MKUP-PCT = SPACES                         35310000
353200         MOVE SPACES               TO DTL-BYR-03-FCST-MKUP-PCT-SN 35320000
353300     ELSE                                                         35330000
353400         MOVE "%"                  TO DTL-BYR-03-FCST-MKUP-PCT-SN 35340000
353500     END-IF.                                                      35350000
353600                                                                  35360000
353700     MOVE DTL-BYR-TOTAL-03           TO PV-RPT-LINE.              35370000
353800     MOVE 1                          TO PV-ADVANCE-LINES.         35380000
353900     ADD PV-ADVANCE-LINES            TO PV-LINE-CNT.              35390000
354000     PERFORM W200-WRITE-RPT-LINE.                                 35400000
354100                                                                  35410000
354200     MOVE DTL-DIVISION-LINE          TO PV-RPT-LINE.              35420000
354300     MOVE 1                          TO PV-ADVANCE-LINES.         35430000
354400     ADD PV-ADVANCE-LINES            TO PV-LINE-CNT.              35440000
354500     PERFORM W200-WRITE-RPT-LINE.                                 35450000
354600                                                                  35460000
354700***************************************************************** 35470000
354800* M130-COMPUTE-BYR-DMM-TOT-LINE.                                * 35480000
354900* ==> PROCESSES:                                                * 35490000
355000*  - COMPUTE BUYER % OF DMM TOTAL                               * 35500000
355100*  - MOVE TOTALS TO DETIAL LINE AND WRITE TO REPORT             * 35510000
355200* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 35520000
355300***************************************************************** 35530000
355400 M130-COMPUTE-BYR-DMM-TOT-LINE.                                   35540000
355500                                                                  35550000
355600     COMPUTE PV-TOT-BYR-DMM-ACT-SLS-VOL ROUNDED =                 35560000
355700       (PV-TOT-ACT-BYR-SLS-VOL / PV-TOT-ACT-DMA-SLS-VOL) * 100    35570000
355800       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-DMM-ACT-SLS-VOL         35580000
355900     END-COMPUTE.                                                 35590000
356000     COMPUTE PV-TOT-BYR-DMM-FCST-SLS-VOL ROUNDED =                35600000
356100       (PV-TOT-FCST-BYR-SLS-VOL / PV-TOT-FCST-DMA-SLS-VOL) * 100  35610000
356200       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-DMM-FCST-SLS-VOL        35620000
356300     END-COMPUTE.                                                 35630000
356400     COMPUTE PV-TOT-BYR-DMM-ACT-MKDN-DOL ROUNDED =                35640000
356500       (PV-TOT-ACT-BYR-MKDN-DOL / PV-TOT-ACT-DMA-MKDN-DOL) * 100  35650000
356600       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-DMM-ACT-MKDN-DOL        35660000
356700     END-COMPUTE.                                                 35670000
356800     COMPUTE PV-TOT-BYR-DMM-FCST-MKDN-DOL ROUNDED =               35680000
356900      (PV-TOT-FCST-BYR-MKDN-DOL / PV-TOT-FCST-DMA-MKDN-DOL) * 100 35690000
357000       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-DMM-FCST-MKDN-DOL       35700000
357100     END-COMPUTE.                                                 35710000
357200                                                                  35720000
357300     MOVE ' BUYER AS % OF DMM EVENT TOTAL' TO DTL-BYR-04-TITLE.   35730000
357400     MOVE PV-TOT-BYR-DMM-ACT-SLS-VOL  TO DTL-BYR-04-ACT-SLS.      35740000
357500     IF DTL-BYR-04-ACT-SLS = SPACES                               35750000
357600         MOVE SPACES                  TO DTL-BYR-04-ACT-SLS-PCT   35760000
357700     ELSE                                                         35770000
357800         MOVE '%'                     TO DTL-BYR-04-ACT-SLS-PCT   35780000
357900     END-IF.                                                      35790000
358000                                                                  35800000
358100     MOVE PV-TOT-BYR-DMM-FCST-SLS-VOL TO DTL-BYR-04-FCST-SLS.     35810000
358200     IF DTL-BYR-04-FCST-SLS = SPACES                              35820000
358300         MOVE SPACES                  TO DTL-BYR-04-FCST-SLS-PCT  35830000
358400     ELSE                                                         35840000
358500         MOVE '%'                     TO DTL-BYR-04-FCST-SLS-PCT  35850000
358600     END-IF.                                                      35860000
358700                                                                  35870000
358800     MOVE PV-TOT-BYR-DMM-ACT-MKDN-DOL     TO DTL-BYR-04-ACT-MKDN. 35880000
358900     IF DTL-BYR-04-ACT-MKDN = SPACES                              35890000
359000         MOVE SPACES              TO DTL-BYR-04-ACT-MKDN-PCT      35900000
359100     ELSE                                                         35910000
359200         MOVE '%'                 TO DTL-BYR-04-ACT-MKDN-PCT      35920000
359300     END-IF.                                                      35930000
359400                                                                  35940000
359500     MOVE PV-TOT-BYR-DMM-FCST-MKDN-DOL    TO DTL-BYR-04-FCST-MKDN.35950000
359600     IF DTL-BYR-04-FCST-MKDN = SPACES                             35960000
359700         MOVE SPACES              TO DTL-BYR-04-FCST-MKDN-PCT     35970000
359800     ELSE                                                         35980000
359900         MOVE '%'                 TO DTL-BYR-04-FCST-MKDN-PCT     35990000
360000     END-IF.                                                      36000000
360100                                                                  36010000
360200     MOVE DTL-BYR-TOTAL-04       TO PV-RPT-LINE.                  36020000
360300     MOVE 1                      TO PV-ADVANCE-LINES.             36030000
360400     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  36040000
360500     PERFORM W200-WRITE-RPT-LINE.                                 36050000
360600                                                                  36060000
360700***************************************************************** 36070000
360800* M135-COMPUTE-BYR-GMM-TOT-LINE.                                * 36080000
360900* ==> PROCESSES:                                                * 36090000
361000*  - COMPUTE BUYER % OF GMM TOTAL                               * 36100000
361100*  - MOVE TOTALS TO DETIAL LINE AND WRITE TO REPORT             * 36110000
361200* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 36120000
361300***************************************************************** 36130000
361400 M135-COMPUTE-BYR-GMM-TOT-LINE.                                   36140000
361500                                                                  36150000
361600     COMPUTE PV-TOT-BYR-GMM-ACT-SLS-VOL ROUNDED =                 36160000
361700         (PV-TOT-ACT-BYR-SLS-VOL / PV-ACT-GMA-SLS-VOL) * 100      36170000
361800       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-GMM-ACT-SLS-VOL         36180000
361900     END-COMPUTE.                                                 36190000
362000     COMPUTE PV-TOT-BYR-GMM-FCST-SLS-VOL ROUNDED =                36200000
362100         (PV-TOT-FCST-BYR-SLS-VOL / PV-FCST-GMA-SLS-VOL) * 100    36210000
362200       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-GMM-FCST-SLS-VOL        36220000
362300     END-COMPUTE.                                                 36230000
362400     COMPUTE PV-TOT-BYR-GMM-ACT-MKDN-DOL ROUNDED =                36240000
362500         (PV-TOT-ACT-BYR-MKDN-DOL / PV-ACT-GMA-MKDN-DOL) * 100    36250000
362600       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-GMM-ACT-MKDN-DOL        36260000
362700     END-COMPUTE.                                                 36270000
362800     COMPUTE PV-TOT-BYR-GMM-FCST-MKDN-DOL ROUNDED =               36280000
362900         (PV-TOT-FCST-BYR-MKDN-DOL / PV-FCST-GMA-MKDN-DOL) * 100  36290000
363000       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-GMM-FCST-MKDN-DOL       36300000
363100     END-COMPUTE.                                                 36310000
363200                                                                  36320000
363300     MOVE ' BUYER AS % OF GMM EVENT TOTAL' TO DTL-BYR-04-TITLE.   36330000
363400     MOVE PV-TOT-BYR-GMM-ACT-SLS-VOL      TO DTL-BYR-04-ACT-SLS.  36340000
363500     IF DTL-BYR-04-ACT-SLS = SPACES                               36350000
363600         MOVE SPACES              TO DTL-BYR-04-ACT-SLS-PCT       36360000
363700     ELSE                                                         36370000
363800         MOVE '%'                 TO DTL-BYR-04-ACT-SLS-PCT       36380000
363900     END-IF.                                                      36390000
364000                                                                  36400000
364100     MOVE PV-TOT-BYR-GMM-FCST-SLS-VOL     TO DTL-BYR-04-FCST-SLS. 36410000
364200     IF DTL-BYR-04-FCST-SLS = SPACES                              36420000
364300         MOVE SPACES              TO DTL-BYR-04-FCST-SLS-PCT      36430000
364400     ELSE                                                         36440000
364500         MOVE '%'                 TO DTL-BYR-04-FCST-SLS-PCT      36450000
364600     END-IF.                                                      36460000
364700                                                                  36470000
364800     MOVE PV-TOT-BYR-GMM-ACT-MKDN-DOL     TO DTL-BYR-04-ACT-MKDN. 36480000
364900     IF DTL-BYR-04-ACT-MKDN = SPACES                              36490000
365000         MOVE SPACES              TO DTL-BYR-04-ACT-MKDN-PCT      36500000
365100     ELSE                                                         36510000
365200         MOVE '%'                 TO DTL-BYR-04-ACT-MKDN-PCT      36520000
365300     END-IF.                                                      36530000
365400                                                                  36540000
365500     MOVE PV-TOT-BYR-GMM-FCST-MKDN-DOL    TO DTL-BYR-04-FCST-MKDN.36550000
365600     IF DTL-BYR-04-FCST-MKDN = SPACES                             36560000
365700         MOVE SPACES              TO DTL-BYR-04-FCST-MKDN-PCT     36570000
365800     ELSE                                                         36580000
365900         MOVE '%'                 TO DTL-BYR-04-FCST-MKDN-PCT     36590000
366000     END-IF.                                                      36600000
366100                                                                  36610000
366200     MOVE DTL-BYR-TOTAL-04       TO PV-RPT-LINE.                  36620000
366300     MOVE 1                      TO PV-ADVANCE-LINES.             36630000
366400     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  36640000
366500     PERFORM W200-WRITE-RPT-LINE.                                 36650000
366600                                                                  36660000
366700***************************************************************** 36670000
366800* M140-COMPUTE-BYR-AD-TOT-LINE.                                 * 36680000
366900* ==> PROCESSES:                                                * 36690000
367000*  - COMPUTE BUYER % OF AD TOTAL                                * 36700000
367100*  - MOVE TOTALS TO DETIAL LINE AND WRITE TO REPORT             * 36710000
367200* ==> PERFORMED FROM: C505-PROCESS-BUYER-CSR                    * 36720000
367300***************************************************************** 36730000
367400 M140-COMPUTE-BYR-AD-TOT-LINE.                                    36740000
367500                                                                  36750000
367600     COMPUTE PV-TOT-BYR-AD-ACT-SLS-VOL ROUNDED =                  36760000
367700         (PV-TOT-ACT-BYR-SLS-VOL  / PV-ACT-ADEVNT-SLS-VOL) * 100  36770000
367800       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-GMM-ACT-SLS-VOL         36780000
367900     END-COMPUTE.                                                 36790000
368000     COMPUTE PV-TOT-BYR-AD-FCST-SLS-VOL ROUNDED =                 36800000
368100         (PV-TOT-FCST-BYR-SLS-VOL / PV-FCST-ADEVNT-SLS-VOL) * 100 36810000
368200       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-GMM-ACT-SLS-VOL         36820000
368300     END-COMPUTE.                                                 36830000
368400     COMPUTE PV-TOT-BYR-AD-ACT-MKDN-DOL ROUNDED =                 36840000
368500         (PV-TOT-ACT-BYR-MKDN-DOL / PV-ACT-ADEVNT-MKDN-DOL) * 100 36850000
368600       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-AD-ACT-MKDN-DOL         36860000
368700     END-COMPUTE.                                                 36870000
368800     COMPUTE PV-TOT-BYR-AD-FCST-MKDN-DOL ROUNDED =                36880000
368900       (PV-TOT-FCST-BYR-MKDN-DOL / PV-FCST-ADEVNT-MKDN-DOL) * 100 36890000
369000       ON SIZE ERROR MOVE 0 TO PV-TOT-BYR-AD-FCST-MKDN-DOL        36900000
369100     END-COMPUTE.                                                 36910000
369200                                                                  36920000
369300     MOVE ' BUYER AS % OF AD EVENT TOTAL' TO DTL-BYR-04-TITLE.    36930000
369400     MOVE PV-TOT-BYR-AD-ACT-SLS-VOL      TO DTL-BYR-04-ACT-SLS.   36940000
369500     IF DTL-BYR-04-ACT-SLS = SPACES                               36950000
369600         MOVE SPACES              TO DTL-BYR-04-ACT-SLS-PCT       36960000
369700     ELSE                                                         36970000
369800         MOVE '%'                 TO DTL-BYR-04-ACT-SLS-PCT       36980000
369900     END-IF.                                                      36990000
370000                                                                  37000000
370100     MOVE PV-TOT-BYR-AD-FCST-SLS-VOL     TO DTL-BYR-04-FCST-SLS.  37010000
370200     IF DTL-BYR-04-FCST-SLS = SPACES                              37020000
370300         MOVE SPACES              TO DTL-BYR-04-FCST-SLS-PCT      37030000
370400     ELSE                                                         37040000
370500         MOVE '%'                 TO DTL-BYR-04-FCST-SLS-PCT      37050000
370600     END-IF.                                                      37060000
370700                                                                  37070000
370800     MOVE PV-TOT-BYR-AD-ACT-MKDN-DOL     TO DTL-BYR-04-ACT-MKDN.  37080000
370900     IF DTL-BYR-04-ACT-MKDN = SPACES                              37090000
371000         MOVE SPACES              TO DTL-BYR-04-ACT-MKDN-PCT      37100000
371100     ELSE                                                         37110000
371200         MOVE '%'                 TO DTL-BYR-04-ACT-MKDN-PCT      37120000
371300     END-IF.                                                      37130000
371400                                                                  37140000
371500     MOVE PV-TOT-BYR-AD-FCST-MKDN-DOL    TO DTL-BYR-04-FCST-MKDN. 37150000
371600     IF DTL-BYR-04-FCST-MKDN = SPACES                             37160000
371700         MOVE SPACES              TO DTL-BYR-04-FCST-MKDN-PCT     37170000
371800     ELSE                                                         37180000
371900         MOVE '%'                 TO DTL-BYR-04-FCST-MKDN-PCT     37190000
372000     END-IF.                                                      37200000
372100                                                                  37210000
372200     MOVE DTL-BYR-TOTAL-04       TO PV-RPT-LINE.                  37220000
372300     MOVE 1                      TO PV-ADVANCE-LINES.             37230000
372400     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  37240000
372500     PERFORM W200-WRITE-RPT-LINE.                                 37250000
372600                                                                  37260000
372700***************************************************************** 37270000
372800* W100-WRITE-NEW-PAGE.                                          * 37280000
372900* ==> PROCESSES:                                                * 37290000
373000*  - WRITE THE LINE TO A NEW PAGE                               * 37300000
373100* ==> PERFORMED FROM:W300-PROCESS-PAGE-HEADER                   * 37310000
373200***************************************************************** 37320000
373300 W100-WRITE-NEW-PAGE.                                             37330000
373400                                                                  37340000
373500     WRITE AD-EVNT-SUMM-RPT-LINE                                  37350000
373600           FROM PV-RPT-LINE                                       37360000
373700           AFTER ADVANCING PAGE.                                  37370000
373800                                                                  37380000
373900     ADD 2            TO PV-LINE-CNT.                             37390000
374000                                                                  37400000
374100***************************************************************** 37410000
374200* W200-WRITE-RPT-LINE.                                          * 37420000
374300* ==> PROCESSES:                                                * 37430000
374400*  - WRITE OUT A LINE ON THE REPORT                             * 37440000
374500* ==> PERFORMED FROM:                                           * 37450000
374600***************************************************************** 37460000
374700 W200-WRITE-RPT-LINE.                                             37470000
374800                                                                  37480000
374900     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             37490000
375000         PERFORM W300-PROCESS-PAGE-HEADER                         37500000
375100         MOVE 1                  TO PV-ADVANCE-LINES              37510000
375200         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   37520000
375300     END-IF.                                                      37530000
375400                                                                  37540000
375500     WRITE AD-EVNT-SUMM-RPT-LINE                                  37550000
375600           FROM PV-RPT-LINE                                       37560000
375700           AFTER ADVANCING PV-ADVANCE-LINES.                      37570000
375800                                                                  37580000
375900***************************************************************** 37590000
376000* W300-PROCESS-PAGE-HEADER.                                     * 37600000
376100* ==> PROCESSES:                                                * 37610000
376200*  - WRITE OUT THE HEADER ON THE REPORT                         * 37620000
376300*  - THIS WILL APPEAR ON EVERY PAGE                             * 37630000
376400* ==> PERFORMED FROM:                                           * 37640000
376500***************************************************************** 37650000
376600 W300-PROCESS-PAGE-HEADER.                                        37660000
376700                                                                  37670000
376800     MOVE 0                      TO PV-LINE-CNT.                  37680000
376900     ADD 1                       TO PV-PAGE-CNT.                  37690000
377000     MOVE PV-PAGE-CNT            TO DP200O-PAGE-NUMBER.           37700000
377100     MOVE 1                      TO DP200O-REPORT-NUMBER.         37710000
377200                                                                  37720000
377300     MOVE DP200O-STANDRD-HEADER-200-COLS                          37730000
377400                                 TO PV-RPT-LINE.                  37740000
377500     PERFORM W100-WRITE-NEW-PAGE.                                 37750000
377600                                                                  37760000
377700     MOVE HEADER-01              TO PV-RPT-LINE.                  37770000
377800     MOVE 2                      TO PV-ADVANCE-LINES.             37780000
377900     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  37790000
378000     PERFORM W200-WRITE-RPT-LINE.                                 37800000
378100                                                                  37810000
378200     MOVE HEADER-02               TO PV-RPT-LINE.                 37820000
378300     MOVE 1                       TO PV-ADVANCE-LINES.            37830000
378400     ADD PV-ADVANCE-LINES         TO PV-LINE-CNT.                 37840000
378500     PERFORM W200-WRITE-RPT-LINE.                                 37850000
378600                                                                  37860000
378700     MOVE HEADER-03               TO PV-RPT-LINE.                 37870000
378800     MOVE 2                       TO PV-ADVANCE-LINES.            37880000
378900     ADD PV-ADVANCE-LINES         TO PV-LINE-CNT.                 37890000
379000     PERFORM W200-WRITE-RPT-LINE.                                 37900000
379100                                                                  37910000
379200     MOVE 1 TO PV-INDEX.                                          37920000
379300     PERFORM W400-PROCESS-PROMO-HEADER                            37930000
379400         UNTIL PV-INDEX > PV-PROMO-IDX.                           37940000
379500                                                                  37950000
379600     MOVE HEADER-05              TO PV-RPT-LINE.                  37960000
379700     MOVE 2                      TO PV-ADVANCE-LINES.             37970000
379800     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  37980000
379900     PERFORM W200-WRITE-RPT-LINE.                                 37990000
380000                                                                  38000000
380100     MOVE HEADER-06              TO PV-RPT-LINE.                  38010000
380200     MOVE 1                      TO PV-ADVANCE-LINES.             38020000
380300     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  38030000
380400     PERFORM W200-WRITE-RPT-LINE.                                 38040000
380500                                                                  38050000
380600     MOVE DTL-DIVISION-01        TO PV-RPT-LINE                   38060000
380700     MOVE 1                      TO PV-ADVANCE-LINES              38070000
380800     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT                   38080000
380900     PERFORM W200-WRITE-RPT-LINE                                  38090000
381000                                                                  38100000
381100     MOVE DTL-DIVISION-02        TO PV-RPT-LINE                   38110000
381200     MOVE 1                      TO PV-ADVANCE-LINES              38120000
381300     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT                   38130000
381400     PERFORM W200-WRITE-RPT-LINE                                  38140000
381500                                                                  38150000
381600     MOVE 1 TO PV-DMM-HEADER-INDEX.                               38160000
381700     PERFORM W410-PROCESS-DIVISION-HEADER                         38170000
381800         UNTIL PV-DMM-HEADER-INDEX > PV-PROMO-IDX.                38180000
381900                                                                  38190000
382000     PERFORM M105-COMPUTE-DMM-TOT-LINE.                           38200000
382100                                                                  38210000
382200     MOVE DTL-DIVISION-LINE      TO PV-RPT-LINE.                  38220000
382300     MOVE 1                      TO PV-ADVANCE-LINES.             38230000
382400     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  38240000
382500     PERFORM W200-WRITE-RPT-LINE.                                 38250000
382600                                                                  38260000
382700***************************************************************** 38270000
382800* W400-PROCESS-PROMO-HEADER.                                    * 38280000
382900* ==> PROCESSES:                                                * 38290000
383000*  - LOOP THROUGH THE PROMO TEMP TABLE                          * 38300000
383100* ==> PERFORMED FROM:                                           * 38310000
383200***************************************************************** 38320000
383300 W400-PROCESS-PROMO-HEADER.                                       38330000
383400                                                                  38340000
383500     MOVE PV-ALL-PROMO-NM(PV-INDEX)      TO HDR-04-PROMO-NAME.    38350000
383600     MOVE PV-ALL-PROMO-STRT-DTE(PV-INDEX) TO HDR-04-PROMO-BEG-DTE.38360000
383700     MOVE PV-ALL-PROMO-END-DTE(PV-INDEX) TO HDR-04-PROMO-END-DTE. 38370000
383800     MOVE PV-ALL-DAYS-ON-SALE(PV-INDEX)  TO HDR-04-PROMO-NUM-DAYS.38380000
383900     IF PV-ALL-DAYS-ON-SALE(PV-INDEX) = 1                         38390000
384000         MOVE 'DAY' TO HDR-04-PROMO-DAYS                          38400000
384100     ELSE                                                         38410000
384200         MOVE 'DAYS' TO HDR-04-PROMO-DAYS                         38420000
384300     END-IF.                                                      38430000
384400                                                                  38440000
384500     MOVE HEADER-04              TO PV-RPT-LINE.                  38450000
384600     MOVE 1                      TO PV-ADVANCE-LINES.             38460000
384700     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  38470000
384800     PERFORM W200-WRITE-RPT-LINE.                                 38480000
384900     ADD 1 TO PV-INDEX.                                           38490000
385000                                                                  38500000
385100***************************************************************** 38510000
385200* W410-PROCESS-DIVISION-HEADER.                                 * 38520000
385300* ==> PROCESSES:                                                * 38530000
385400*  - LOOP THROUGH THE DIVISION TEMP TABLE                       * 38540000
385500* ==> PERFORMED FROM:                                           * 38550000
385600***************************************************************** 38560000
385700 W410-PROCESS-DIVISION-HEADER.                                    38570000
385800                                                                  38580000
385900     IF ((PV-ALL-ACT-DMA-SLS-VOL(PV-DMM-HEADER-INDEX) = 0)        38590000
386000      AND (PV-ALL-FCST-DMA-SLS-VOL(PV-DMM-HEADER-INDEX) = 0)      38600000
386100      AND (PV-ALL-DMA-VOL-PCT-CHG(PV-DMM-HEADER-INDEX) = 0)       38610000
386200      AND (PV-ALL-ACT-DMA-MKDN-DOL(PV-DMM-HEADER-INDEX) = 0)      38620000
386300      AND (PV-ALL-FCST-DMA-MKDN-DOL(PV-DMM-HEADER-INDEX) = 0)     38630000
386400      AND (PV-ALL-ACT-DMA-UNIT-SOLD(PV-DMM-HEADER-INDEX) = 0)     38640000
386500      AND (PV-ALL-FCST-DMA-UNIT-SOLD(PV-DMM-HEADER-INDEX) = 0)    38650000
386600      AND (PV-ALL-ACT-DMA-PREP-UNITS(PV-DMM-HEADER-INDEX) = 0)    38660000
386700      AND (PV-ALL-FCST-DMA-PREP-UNITS(PV-DMM-HEADER-INDEX) = 0)   38670000
386800      AND (PV-ALL-ACT-DMA-MKUP-PCT(PV-DMM-HEADER-INDEX) = 0)      38680000
386900      AND (PV-ALL-FCST-DMA-MKUP-PCT(PV-DMM-HEADER-INDEX) = 0))    38690000
387000         CONTINUE                                                 38700000
387100     ELSE                                                         38710000
387200         MOVE PV-ALL-DMA-PROMO-NM(PV-DMM-HEADER-INDEX)            38720000
387300                                      TO DTL-DVSN-03-PROMO        38730000
387400         MOVE PV-ALL-ACT-DMA-SLS-VOL(PV-DMM-HEADER-INDEX)         38740000
387500                                      TO DTL-DVSN-03-ACT-SLS      38750000
387600         MOVE PV-ALL-FCST-DMA-SLS-VOL(PV-DMM-HEADER-INDEX)        38760000
387700                                      TO DTL-DVSN-03-FCST-SLS     38770000
387800         MOVE PV-ALL-DMA-VOL-PCT-CHG(PV-DMM-HEADER-INDEX)         38780000
387900                                      TO DTL-DVSN-03-VOL-CHG      38790000
388000         IF DTL-DVSN-03-VOL-CHG = SPACES                          38800000
388100             MOVE SPACES              TO DTL-DVSN-03-LEFT-PARA    38810000
388200             MOVE SPACES              TO DTL-DVSN-03-VOL-CHG-PCT  38820000
388300             MOVE SPACES              TO DTL-DVSN-03-RIGHT-PARA   38830000
388400         ELSE                                                     38840000
388500             IF PV-ALL-DMA-VOL-PCT-CHG(PV-DMM-HEADER-INDEX) < ZERO38850000
388600                 MOVE "("             TO DTL-DVSN-03-LEFT-PARA    38860000
388700                 MOVE "%"             TO DTL-DVSN-03-VOL-CHG-PCT  38870000
388800                 MOVE ")"             TO DTL-DVSN-03-RIGHT-PARA   38880000
388900             ELSE                                                 38890000
389000                 MOVE SPACES          TO DTL-DVSN-03-LEFT-PARA    38900000
389100                 MOVE "%"             TO DTL-DVSN-03-VOL-CHG-PCT  38910000
389200                 MOVE SPACES          TO DTL-DVSN-03-RIGHT-PARA   38920000
389300            END-IF                                                38930000
389400         END-IF                                                   38940000
389500         MOVE PV-ALL-ACT-DMA-MKDN-DOL(PV-DMM-HEADER-INDEX)        38950000
389600                                      TO DTL-DVSN-03-ACT-MKDN     38960000
389700         MOVE PV-ALL-FCST-DMA-MKDN-DOL(PV-DMM-HEADER-INDEX)       38970000
389800                                      TO DTL-DVSN-03-FCST-MKDN    38980000
389900         MOVE PV-ALL-ACT-DMA-UNIT-SOLD(PV-DMM-HEADER-INDEX)       38990000
390000                                      TO DTL-DVSN-03-ACT-UNT-SLD  39000000
390100         MOVE PV-ALL-FCST-DMA-UNIT-SOLD(PV-DMM-HEADER-INDEX)      39010000
390200                                      TO DTL-DVSN-03-FCST-UNT-SLD 39020000
390300         MOVE PV-ALL-ACT-DMA-PREP-UNITS(PV-DMM-HEADER-INDEX)      39030000
390400                                      TO DTL-DVSN-03-ACT-PREP-UNT 39040000
390500         MOVE PV-ALL-FCST-DMA-PREP-UNITS(PV-DMM-HEADER-INDEX)     39050000
390600                                      TO DTL-DVSN-03-FCST-PREP-UNT39060000
390700         MOVE PV-ALL-ACT-DMA-MKUP-PCT(PV-DMM-HEADER-INDEX)        39070000
390800                                      TO DTL-DVSN-03-ACT-MKUP-PCT 39080000
390900         IF DTL-DVSN-03-ACT-MKUP-PCT = SPACES                     39090000
391000             MOVE SPACES           TO DTL-DVSN-03-ACT-MKUP-PCT-SN 39100000
391100         ELSE                                                     39110000
391200             MOVE "%"              TO DTL-DVSN-03-ACT-MKUP-PCT-SN 39120000
391300         END-IF                                                   39130000
391400         MOVE PV-ALL-FCST-DMA-MKUP-PCT(PV-DMM-HEADER-INDEX)       39140000
391500                                   TO DTL-DVSN-03-FCST-MKUP-PCT   39150000
391600         IF DTL-DVSN-03-FCST-MKUP-PCT = SPACES                    39160000
391700             MOVE SPACES           TO DTL-DVSN-03-FCST-MKUP-PCT-SN39170000
391800         ELSE                                                     39180000
391900             MOVE "%"              TO DTL-DVSN-03-FCST-MKUP-PCT-SN39190000
392000         END-IF                                                   39200000
392100                                                                  39210000
392200         MOVE DTL-DIVISION-03        TO PV-RPT-LINE               39220000
392300         MOVE 1                      TO PV-ADVANCE-LINES          39230000
392400         ADD PV-ADVANCE-LINES        TO PV-LINE-CNT               39240000
392500         PERFORM W200-WRITE-RPT-LINE                              39250000
392600     END-IF.                                                      39260000
392700                                                                  39270000
392800     ADD 1 TO PV-DMM-HEADER-INDEX.                                39280000
392900                                                                  39290000
393000***************************************************************** 39300000
393100* Z025-FORMAT-HEADER-DATE                                       * 39310000
393200* ==> PROCESSES:                                                * 39320000
393300*  -                                                              39330000
393400* ==> PERFORMED FROM:                                             39340000
393500***************************************************************** 39350000
393600 Z025-FORMAT-HEADER-DATE.                                         39360000
393700                                                                  39370000
393800     MOVE PV-SYS-MO TO PV-SYS-MM-GREG.                            39380000
393900     MOVE PV-SYS-DY TO PV-SYS-DD-GREG.                            39390000
394000     MOVE PV-SYS-YR TO PV-SYS-YY-GREG.                            39400000
394100                                                                  39410000
394200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              39420000
394300     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     39430000
394400     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     39440000
394500     SET DPG52-LK-DTE-GREG           TO TRUE.                     39450000
394600     MOVE PV-SYS-DATE-GREG           TO DPG52-LK-DATE-INPUT.      39460000
394700     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              39470000
394800                                     TO PV-OPERATION-MSG-1.       39480000
394900                                                                  39490000
395000     PERFORM Z050-CALENDAR-ROUTINE.                               39500000
395100                                                                  39510000
395200     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-SYS-DATE-ISO.          39520000
395300                                                                  39530000
395400     MOVE PV-SYS-HR                  TO DP200O-RUN-HOUR.          39540000
395500     MOVE PV-SYS-MIN                 TO DP200O-RUN-MINUTE.        39550000
395600     MOVE PV-SYS-MM-GREG             TO DP200O-RUN-MONTH.         39560000
395700     MOVE PV-SYS-DD-GREG             TO DP200O-RUN-DAY.           39570000
395800     MOVE PV-SYS-YY-GREG             TO DP200O-RUN-YEAR.          39580000
395900     MOVE PC-CURRENT-PROGRAM-NAME    TO DP200O-PROGRAM-NAME.      39590000
396000                                                                  39600000
396100***************************************************************** 39610000
396200* Z050-CALENDAR-ROUTINE.                                        * 39620000
396300* ==> PROCESSES:                                                * 39630000
396400*  - CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.          * 39640000
396500* ==> PERFORMED FROM:                                           * 39650000
396600***************************************************************** 39660000
396700 Z050-CALENDAR-ROUTINE.                                           39670000
396800                                                                  39680000
396900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          39690000
397000                                             DPG53 DPG54          39700000
397100                                             DPG55 DPG56.         39710000
397200     EVALUATE TRUE                                                39720000
397300         WHEN DPG54-NO-ERROR                                      39730000
397400             CONTINUE                                             39740000
397500         WHEN DPG54-WARNING-ERROR                                 39750000
397600             DISPLAY '** WARNING - PROGRAM '                      39760000
397700                      PC-CURRENT-PROGRAM-NAME ' **'               39770000
397800             DISPLAY '** Z050-CALENDAR-ROUTINE'                   39780000
397900             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 39790000
398000             DISPLAY '** DPG54-ERROR-MESSAGE: '                   39800000
398100             DISPLAY '** ' DPG54-ERROR-MESSAGE                    39810000
398200             DISPLAY '** DPG51: ' DPG51                           39820000
398300             DISPLAY '** DPG52: ' DPG52                           39830000
398400             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           39840000
398500         WHEN DPG54-SEVERE-ERROR                                  39850000
398600             DISPLAY '** ABEND - PROGRAM '                        39860000
398700                      PC-CURRENT-PROGRAM-NAME ' **'               39870000
398800             DISPLAY '** Z050-CALENDAR-ROUTINE'                   39880000
398900             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  39890000
399000             IF DPG54-CALENDAR-TYPE-INVALID                       39900000
399100                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          39910000
399200                DISPLAY '** DPG51-CALENDAR-TYPE: '                39920000
399300                         DPG51-CALENDAR-TYPE                      39930000
399400             END-IF                                               39940000
399500             IF DPG54-DATE-INVALID                                39950000
399600                DISPLAY '** DPG54-DATE-INVALID'                   39960000
399700                DISPLAY '** DPG52-LK-DATE-INPUT: '                39970000
399800                         DPG52-LK-DATE-INPUT                      39980000
399900             END-IF                                               39990000
400000             IF DPG54-INCR-DECR-INVALID                           40000000
400100                DISPLAY '** DPG54-INCR-DECR-INVALID'              40010000
400200                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     40020000
400300                         DPG51-INCREMENT-DECREMENT-FLAG           40030000
400400             END-IF                                               40040000
400500             MOVE DPG54-ERROR-MESSAGE                             40050000
400600                                 TO PV-OPERATION-MSG-1            40060000
400700             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            40070000
400800             PERFORM Z910-ABEND                                   40080000
400900     END-EVALUATE.                                                40090000
401000                                                                  40100000
401100******************************************************************40110000
401200* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION THAT     *40120000
401300* LOGONS TO ORACLE.                                              *40130000
401400******************************************************************40140000
070941*    COPY PMPD700.                                                40150022
070941*                                                                 40160023
070941******************************************************************40170023
070941* FIX TO ORACLE 3113 TO TURN CURSOR SHARING OFF.                  40180023
070941******************************************************************40190023
070941*    EXEC SQL                                                     40200023
070941*     ALTER SESSION                                               40210023
070941*           SET CURSOR_SHARING = 'EXACT'                          40220023
070941*    END-EXEC.                                                    40230023
070941*                                                                 40240023
402500***************************************************************** 40250000
402600* Z100-ABEND.                                                   * 40260000
402700*  - PERFORM AN ABEND THAT OCCURED RELATED TO ORACLE            * 40270000
402800***************************************************************** 40280000
402900 Z100-ABEND.                                                      40290000
403000                                                                  40300000
403100     DISPLAY '                       '.                           40310000
403200     DISPLAY '** ABEND **       ** = SQLERROR'.                   40320000
403300     DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.   40330000
403400     DISPLAY '** SQLCODE        ** = ' SQLCODE.                   40340000
403500     DISPLAY '** ABEND CODE     ** = ' ABEND-CODE.                40350000
403600     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   40360000
403700     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  40370000
403800     DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                40380000
403900     DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         40390000
404000     DISPLAY '** TABLE          ** = ' PV-TABLE-NAME.             40400000
404100     DISPLAY '** OPERATION      ** = ' PV-OPERATION-MSG.          40410000
404200     DISPLAY '                       '.                           40420000
404300                                                                  40430000
404400                                                                  40440000
404500     CALL 'ILBOABN0' USING ABEND-CODE.                            40450000
404600                                                                  40460000
404700******************************************************************40470000
404800* Z910-ABEND - PERFORMS A NON-SQL-ABEND                          *40480000
404900******************************************************************40490000
405000 Z910-ABEND.                                                      40500000
405100                                                                  40510000
405200     DISPLAY '** ABEND           **'.                             40520000
405300     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  40530000
405400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        40540000
405500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         40550000
405600     DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.       40560000
405700                                                                  40570000
405800     CALL 'ILBOABN0' USING ABEND-CODE.                            40580000
