000100*-----------------------*                                         00010028
000200 IDENTIFICATION DIVISION.                                         00020028
000300*-----------------------*                                         00030028
000400 PROGRAM-ID.    TRKCS120.                                         00040028
000500 AUTHOR.        DAN HINTZ.                                        00050028
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060028
000700 DATE-WRITTEN.  01-06-94.                                         00070028
000800 DATE-COMPILED.                                                   00080028
000900                                                                  00090028
001000*---------------------------------------------------------------* 00100028
001100*    Y120 - OPEN SHIPMENT LIST PROGRAM                          * 00110028
001200*                                                               * 00120028
001300*    THIS PROGRAM GENERATES A LIST OF OPEN SHIPMENTS.  THE      * 00130028
001400*    DELIVERY SCAC, ETA DATE, SHIPMENT STATUS, MANIFEST,        * 00140028
001500*    FREIGHT BILL SCAC, FREIGHT BILL, AND BILL OF LADING ARE ALL* 00150028
001600*    DISPLAYED ON THE SCREEN.  WHEN THE OPERATOR SELECTS        * 00160028
001700*    ONE OR MORE ITEMS AND PRESSES A FUNCTION KEY, THE SELECTED * 00170028
001800*    SHIPMENTS ARE ASSIGNED TO TRIP BY THIS PROGRAM AND CONTROL * 00180028
001900*    IS THEN PASSED TO TRLSHIP (TRKCS114), THE TRAFFIC SHIPMENT * 00190028
002000*    LIST SCREEN.                                               * 00200028
002100*                                                               * 00210028
002200*---------------------------------------------------------------* 00220028
002210* CHANGED 12-02-2011 CHRSITINE TWIEHAUS      WR40574              00221029
002220*         ADDED CARR-AUTH-ID                                      00222029
002230*---------------------------------------------------------------* 00223029
263697* CHANGED 11/08/2021    BY JIM HUNTER      WR: CHG0263697         00225099
263697* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00226099
263697* MAKING THE CALL DYNAMIC VS STATIC.                              00227099
263697*---------------------------------------------------------------* 00228099
CICS  * CHANGED 11/21/2022    BY JIM HUNTER      WR: CHG0278495         00229099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00229199
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00229299
CICS  *-----------------------------------------------------------------00229399
002300 EJECT                                                            00230028
002400 ENVIRONMENT DIVISION.                                            00240028
002500                                                                  00250028
002600 DATA DIVISION.                                                   00260028
002700                                                                  00270028
002800 WORKING-STORAGE SECTION.                                         00280028
002900                                                                  00290028
003000 01  DK-DB2-KEYS.                                                 00300028
003100     15  DK-ETA-FROM-DATE-ISO           PIC  X(10)  VALUE SPACE.  00310028
003200     15  DK-ETA-TO-DATE-ISO             PIC  X(10)  VALUE SPACE.  00320028
003300     15  DK-SHIPT-ID                    PIC S9(09)  VALUE ZEROS   00330028
003400                                                    COMP SYNC.    00340028
003500     15  DK-TRIP-ID                     PIC S9(09)  VALUE ZEROS   00350028
003600                                                    COMP SYNC.    00360028
003700     15  DK-PO-NBR-B                    PIC S9(09)  VALUE ZEROS   00370028
003800                                                    COMP.         00380028
003900     15  DK-PO-NBR-E                    PIC S9(09)  VALUE ZEROS   00390028
004000                                                    COMP.         00400028
004100     15  DK-PRO-NBR-B                   PIC  X(22)  VALUE SPACE.  00410028
004200     15  DK-PRO-NBR-E                   PIC  X(22)  VALUE SPACE.  00420028
004300     15  DK-BOL-NBR-B                   PIC  X(30)  VALUE SPACE.  00430028
004400     15  DK-BOL-NBR-E                   PIC  X(30)  VALUE SPACE.  00440028
004500     15  DK-OWNER-SCAC-ID-B             PIC  X(04)  VALUE SPACE.  00450028
004600     15  DK-OWNER-SCAC-ID-E             PIC  X(04)  VALUE SPACE.  00460028
004700                                                                  00470028
004800 01  PC-PROGRAM-CONSTANTS.                                        00480028
004900     05  PC-1                           PIC S9(03)  VALUE +1      00490028
005000                                                    COMP-3.       00500028
005100     05  PC-7D                          PIC  X(01)  VALUE X'7D'.  00510028
005200     05  PC-EN                          PIC  X(02)  VALUE 'EN'.   00520028
005300     05  PC-49                          PIC  X(02)  VALUE '49'.   00530028
005400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00540028
005500                                                    'TR120A  '.   00550028
005600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00560028
005700                                                    'TRKM120 '.   00570028
005800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00580028
005900                                                    'TRKCS120'.   00590028
005910     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00591028
005920     05  PC-WMS-CONTROL-MOD-LENGTH    PIC S9(4) VALUE +125        00592028
005930                                                COMP SYNC.        00593028
005940     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00594028
005950     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00595028
005960     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00596028
005970     05  PC-59                          PIC S9(04)  VALUE 59      00597028
005980                                                    COMP SYNC.    00598028
005990     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +14     00599028
006000                                                    COMP SYNC.    00600028
006100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00610028
006200                                                    COMP SYNC.    00620028
006300     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00630028
006400                                                    +1000000      00640028
006500                                                    COMP-3.       00650028
006600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00660028
006700                                                    COMP SYNC.    00670028
006800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00680028
006900                                                    COMP-3.       00690028
007000     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00700028
007100     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00710028
007200     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00720028
007300     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00730028
007400     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00740028
007500     05  PC-DELETED-STATUS-CDE          PIC  X(02)  VALUE 'DE'.   00750028
007600     05  PC-DEFAULT-LOW-DATE-ISO        PIC  X(10)  VALUE         00760028
007700                                                    '1980-01-01'. 00770028
007800     05  PC-DEFAULT-HIGH-DATE-ISO       PIC  X(10)  VALUE         00780028
007900                                                    '9999-09-09'. 00790028
008000*                                                                 00800028
008100     05  PC-TSYMSG-NUMBERS.                                       00810028
008200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00820028
008300         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00830028
008400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00840028
008500         10  PC-TSYMSG-00047            PIC  9(05)  VALUE 00047.  00850028
008600         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00860028
008700         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00870028
008800         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00880028
008900         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00890028
009000         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00900028
009100         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00910028
009200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00920028
009300         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00930028
009400         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00940028
009500         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00950028
009600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00960028
009700         10  PC-TSYMSG-00743            PIC  9(05)  VALUE 00743.  00970028
009800         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  00980028
009810*2636 - TRANSCRIBED PACKSLIPS DO NOT EXIST FOR PO/RCVR            00981080
009900         10  PC-TSYMSG-02636            PIC  9(05)  VALUE 02636.  00990080
009910         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  00991080
010000         10  PC-TSYMSG-03533            PIC  9(05)  VALUE 03533.  01000028
010100         10  PC-TSYMSG-03534            PIC  9(05)  VALUE 03534.  01010028
010200         10  PC-TSYMSG-03546            PIC  9(05)  VALUE 03546.  01020028
010300         10  PC-TSYMSG-03548            PIC  9(05)  VALUE 03548.  01030028
010310         10  PC-TSYMSG-03811            PIC  9(05)  VALUE 03811.  01031048
010400         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01040028
010500*                                                                 01050028
010600 01  PS-PROGRAM-SWITCHES.                                         01060028
010700     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01070028
010800         88  PS-NO-ERROR                            VALUE 'Y'.    01080028
010900         88  PS-ERROR                               VALUE 'N'.    01090028
011000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01100028
011100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01110028
011200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01120028
011300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01130028
011400         88  PS-DONE                                VALUE 'Y'.    01140028
011500         88  PS-NOT-DONE                            VALUE 'N'.    01150028
011600     05  PS-END-OF-CURSOR-SW            PIC  X(01)  VALUE 'N'.    01160028
011700         88  PS-END-OF-CURSOR                       VALUE 'Y'.    01170028
011800         88  PS-NOT-END-OF-CURSOR                   VALUE 'N'.    01180028
011810     05  PS-ASNS-TO-WMS-SW                PIC X(01) VALUE 'N'.    01181028
011820         88  PS-ASNS-TO-WMS-YES                     VALUE 'Y'.    01182028
011830         88  PS-ASNS-TO-WMS-NO                      VALUE 'N'.    01183028
011840     05  PS-TRANS-REC-SW                  PIC X(01) VALUE 'N'.    01184028
011850         88  PS-TRANS-REC-YES                       VALUE 'Y'.    01185028
011860         88  PS-TRANS-REC-NO                        VALUE 'N'.    01186028
011861     05  PS-EOF-EFC-RCVR-CSR-SW           PIC X(01) VALUE 'N'.    01186160
011862         88  PS-EOF-EFC-RCVR-CSR                    VALUE 'Y'.    01186260
011863         88  PS-EOF-EFC-RCVR-CSR-NO                 VALUE 'N'.    01186360
011864     05  PS-EOF-TOSOPFA-CSR-SW            PIC X(01) VALUE 'N'.    01186468
011865         88  PS-EOF-TOSOPFA-CSR                     VALUE 'Y'.    01186568
011866         88  PS-EOF-TOSOPFA-CSR-NO                  VALUE 'N'.    01186668
011867     05  PS-FIRST-INSTRUCTION-SW          PIC X(01) VALUE 'N'.    01186771
011868         88  PS-FIRST-INSTRUCTION                   VALUE 'Y'.    01186871
011869         88  PS-FIRST-INSTRUCTION-NO                VALUE 'N'.    01186971
011870*                                                                 01187028
011880 01  PV-PROGRAM-VARIABLES.                                        01188028
011890     05  PV-SUB                         PIC S9(04)  VALUE +0      01189028
011900                                                    COMP SYNC.    01190028
012000     05  PV-SUBSCRIPT                   PIC S9(03)  VALUE +0      01200028
012100                                                    COMP-3.       01210028
012200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01220028
012300                                                    COMP SYNC.    01230028
012400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01240028
012500                                                    COMP-3.       01250028
012600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01260028
012700                                                    COMP-3.       01270028
012800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01280028
012900                                                    COMP-3.       01290028
013000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01300028
013100                                                    COMP-3.       01310028
013200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01320028
013300                                                    COMP-3.       01330028
013400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01340028
013500                                                    COMP-3.       01350028
013600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01360028
013700                                                    COMP-3.       01370028
013800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01380028
013900                                                    COMP SYNC.    01390028
014000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01400028
014100                                                    COMP SYNC.    01410028
014200     05  PV-ITEM                        PIC S9(04)  VALUE +0      01420028
014300                                                    COMP SYNC.    01430028
014400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01440028
014500                                                    COMP SYNC.    01450028
014600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01460028
014700                                                    COMP SYNC.    01470028
014800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01480028
014900                                                    COMP SYNC.    01490028
015000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01500028
015100                                                    COMP SYNC.    01510028
015200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01520028
015300                                                    COMP SYNC.    01530028
015400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01540028
015500                                                    COMP SYNC.    01550028
015600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01560028
015700                                                    COMP SYNC.    01570028
015800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01580028
015900                                                    COMP SYNC.    01590028
016000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01600028
016100                                                    COMP SYNC.    01610028
016200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01620028
016300                                                    COMP SYNC.    01630028
016400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01640028
016500                                                    COMP SYNC.    01650028
016600     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01660028
016700                                                    COMP SYNC.    01670028
016800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01680028
016900                                                    COMP SYNC.    01690028
017000     05  PV-NULL-TRIP-ID-IND            PIC S9(04)  VALUE +0      01700028
017100                                                    COMP.         01710028
017200     05  PV-NULL-EST-AR-TMST            PIC S9(04)  VALUE +0      01720028
017300                                                    COMP.         01730028
017400     05  PV-SHIPMENT-COUNT              PIC S9(09)  VALUE +0      01740028
017500                                                    COMP-3.       01750028
017600     05  PV-SAVE-TRIP-ID                PIC S9(09)  VALUE +0      01760028
017700                                                    COMP SYNC.    01770028
017800     05  PV-DB2-COUNT-REC-TRLR          PIC S9(04)  VALUE +0      01780028
017900                                                    COMP.         01790028
018000     05  PV-CICS-MSG-AREA               PIC X(75)  VALUE SPACE.   01800028
018010     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01801028
018020                                                     COMP SYNC.   01802028
018030                                                                  01803028
018040     05  PV-DATE-IN-CCYY-MM-DD.                                   01804028
018050         10  PV-DATE-IN-CC              PIC  9(02)  VALUE ZEROS.  01805028
018060         10  PV-DATE-IN-YY              PIC  9(02)  VALUE ZEROS.  01806028
018070         10  FILLER                     PIC  X(01)  VALUE '-'.    01807028
018080         10  PV-DATE-IN-MM              PIC  9(02)  VALUE ZEROS.  01808028
018090         10  FILLER                     PIC  X(01)  VALUE '-'.    01809028
018100         10  PV-DATE-IN-DD              PIC  9(02)  VALUE ZEROS.  01810028
018200         10  FILLER                     PIC  X(16)  VALUE SPACES. 01820028
018300     05  PV-DATE-OUT-MM-DD-YY.                                    01830028
018400         10  PV-DATE-OUT-MM             PIC  9(02)  VALUE ZEROS.  01840028
018500         10  FILLER                     PIC  X(01)  VALUE '/'.    01850028
018600         10  PV-DATE-OUT-DD             PIC  9(02)  VALUE ZEROS.  01860028
018700         10  FILLER                     PIC  X(01)  VALUE '/'.    01870028
018800         10  PV-DATE-OUT-YY             PIC  9(02)  VALUE ZEROS.  01880028
018900     05  PV-SYSTEM-ID.                                            01890028
019000         10  FILLER                     PIC  X(04)  VALUE SPACE.  01900028
019100         10  PV-REGION-IND              PIC  X(01).               01910028
019200             88  PV-TEST-CICS                 VALUE 'T'.          01920028
019300             88  PV-QA-CICS                   VALUE 'Q'.          01930028
019400             88  PV-PROD-CICS                 VALUE 'P'.          01940028
019500             88  PV-LEARN-CICS                VALUE 'L'.          01950028
019600         10  FILLER                     PIC X(01)    VALUE SPACES.01960028
019610                                                                  01961064
019620     05  PV-DISP-SHIPT-ID               PIC 9(09) VALUE ZEROES.   01962064
019630     05  PV-DISP-PO                     PIC Z(09) VALUE ZEROES.   01963099
019640     05  PV-DISP-RCVR                   PIC 9(04) VALUE ZEROES.   01964064
019641     05  PV-DISP-SQLCODE                PIC -999  VALUE ZEROES.   01964183
019642     05  PV-DISP-TRIP                   PIC 9(09) VALUE ZEROES.   01964296
019650     05  PV-NEW-OPERSET                 PIC S9(9) COMP.           01965067
019660     05  PV-WO-INSTR-SEQ-NBR            PIC S9(04) VALUE +0       01966071
019670                                                   COMP.          01967071
019680     05  PV-DEPT-NUMERIC                PIC  9(4) VALUE ZEROES.   01968093
019681     05  PV-DEPT-NUMERIC-R REDEFINES  PV-DEPT-NUMERIC.            01968178
019682         10  FILLER                     PIC  X(1).                01968293
019683         10  PV-DEPT-CHAR               PIC  X(3).                01968393
019690     05  PV-SUBCL-NUMERIC               PIC  9(4) VALUE ZEROES.   01969093
019691     05  PV-SUBCL-NUMERIC-R REDEFINES PV-SUBCL-NUMERIC.           01969178
019692         10  FILLER                     PIC  X(2).                01969293
019693         10  PV-SUBCL-CHAR              PIC  X(2).                01969393
019694     05  PV-TRANS-SCAC                  PIC   X(4).               01969493
019695     05  PV-TRANS-PRO                   PIC   X(22).              01969593
019696     05  PV-TRANS-BOL                   PIC   X(30).              01969693
019697     05  PV-PO-HOLD                     PIC  S9(9) COMP.          01969793
019698     05  PV-RCVR-HOLD                   PIC  S9(9) COMP.          01969893
019699     05  PV-TRANSCRIBE-COUNT            PIC S9(09)  COMP.         01969993
019700                                                                  01970028
019800*---------------------------------------------------------------* 01980028
019900*  WORKING STORAGE AREA USED TO BUILD SQL STATEMENTS            * 01990028
020000*---------------------------------------------------------------* 02000028
020100                                                                  02010028
020200 01  PV-SQL-STMT.                                                 02020028
020300     49  PV-SQL-STMT-LEN                PIC S9(04)  COMP  VALUE 0.02030028
020400*  SELECT 185 LENGTH PLUS WHERE LENGTH 92X5 PLUS 77 JOIN LENGTH   02040028
020500     49  PV-SQL-STMT-TEXT               PIC X(722)  VALUE SPACES. 02050028
020600                                                                  02060028
020700 01  PV-BUILD-SELECT-REC.                                         02070028
020800                                                                  02080028
020900                                                                  02090028
021000     05  PV-BUILD-SELECT-LEN            PIC S9(04)  COMP  VALUE 0.02100028
021100*        WHERE NOT INCLUDED IN LENGTH                             02110028
021200     05  PV-BUILD-SELECT-STMT.                                    02120028
021300         10  FILLER                     PIC  X(16)                02130028
021400                         VALUE 'SELECT DISTINCT '.                02140028
021700         10  FILLER                     PIC  X(15)                02170028
021800                         VALUE ' B.EST_AR_TMST '.                 02180028
021900         10  FILLER                     PIC  X(16)                02190028
022000                         VALUE ',C.MANIFEST_NBR '.                02200028
022100         10  FILLER                     PIC  X(12)                02210028
022200                         VALUE ',B.SHIPT_ID '.                    02220028
022300         10  FILLER                     PIC  X(15)                02230028
022400                         VALUE ',B.PRO_SCAC_ID '.                 02240028
022500         10  FILLER                     PIC  X(11)                02250028
022600                         VALUE ',B.PRO_NBR '.                     02260031
022700         10  FILLER                     PIC  X(11)                02270028
022800                         VALUE ',B.BOL_NBR '.                     02280028
022900         10  FILLER                     PIC  X(16)                02290028
023000                         VALUE ',B.ORIG_SCAC_ID '.                02300028
023010         10  FILLER                     PIC  X(11)                02301035
023020                         VALUE ',C.TRIP_ID '.                     02302036
023040*     CLT 01-05-2012 WR40574 START                                02304033
023100         10  FILLER                     PIC  X(16)                02310034
023200                         VALUE ',B.CARR_AUTH_ID '.                02320034
023210*     CLT 01-05-2012 WR40574 END                                  02321033
023300         10  FILLER                     PIC  X(06)                02330028
023400                                   VALUE 'FROM  '.                02340028
024200         10  FILLER                     PIC  X(03)                02420028
024300                                   VALUE 'DB2'.                   02430028
024400         10  PV-BUILD-QUAL-2            PIC  X(01).               02440028
024500         10  FILLER                     PIC  X(03)                02450028
024600                                   VALUE 'DBA'.                   02460028
024700         10  FILLER                     PIC  X(11)                02470028
024800                                   VALUE '.TSHIPMT B '.           02480028
024900         10  FILLER                     PIC  X(04)                02490028
025000                                   VALUE ',DB2'.                  02500028
025100         10  PV-BUILD-QUAL-3            PIC  X(01).               02510028
025200         10  FILLER                     PIC  X(03)                02520028
025300                                   VALUE 'DBA'.                   02530028
025400         10  FILLER                     PIC  X(11)                02540028
025500                                   VALUE '.TVHTRIP C '.           02550028
026300         10  FILLER                     PIC  X(04)                02630028
026400                                   VALUE ',DB2'.                  02640028
026500         10  PV-BUILD-QUAL-5            PIC  X(01).               02650028
026600         10  FILLER                     PIC  X(03)                02660028
026700                                   VALUE 'DBA'.                   02670028
026800         10  FILLER                     PIC  X(11)                02680028
026900                                   VALUE '.TSHPTPO E '.           02690028
027000                                                                  02700028
027100         10  PVBLDSQL-WHERE             PIC  X(295) VALUE SPACES. 02710028
027200                                                                  02720028
027300 01  PV-WHERE-BYTES                     PIC S9(04)  COMP VALUE 0. 02730028
027400 01  PV-WHERE-SIZE                      PIC S9(04)  COMP VALUE 92.02740028
027500 01  PV-SELECT-BYTES                    PIC S9(04) COMP VALUE 185.02750028
027600 01  PV-JOIN-BYTES                      PIC S9(04) COMP VALUE  77.02760028
027700                                                                  02770028
027800 01  PV-WHERE-LITERALS.                                           02780028
027900     05  PV-BLD-WHERE                   PIC  X(07)                02790028
028000                                             VALUE ' WHERE '.     02800028
028100     05  PV-BLD-AND                     PIC  X(07)                02810028
028200                                             VALUE '  AND  '.     02820028
028300     05  PV-BLD-DATE.                                             02830028
028400         10  FILLER                     PIC  X(22)                02840028
028500                               VALUE 'B.EST_AR_TMST BETWEEN '.    02850028
028600         10  FILLER                     PIC  X(01)  VALUE X'7D'.  02860028
028700         10  PV-ETA-FROM-DATE-ISO       PIC  X(10).               02870028
028800         10  PV-ETA-FROM-TIME           PIC  X(16)                02880028
028900                                        VALUE '-00.00.00.000000'. 02890028
029000         10  FILLER                     PIC  X(01)  VALUE X'7D'.  02900028
029100         10  FILLER                     PIC  X(07)                02910028
029200                                             VALUE '  AND  '.     02920028
029300         10  FILLER                     PIC  X(01)  VALUE X'7D'.  02930028
029400         10  PV-ETA-TO-DATE-ISO         PIC  X(10).               02940028
029500         10  PV-ETA-TO-TIME             PIC  X(16)                02950028
029600                                        VALUE '-23.59.00.000000'. 02960028
029700         10  FILLER                     PIC  X(01)  VALUE X'7D'.  02970028
029800     05  PV-BLD-PRO.                                              02980028
029900         10  FILLER                     PIC  X(12)                02990028
030000                               VALUE 'B.PRO_NBR = '.              03000028
030100         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03010028
030200         10  PV-BLD-PRO-NBR             PIC  X(16).               03020028
030300     05  PV-BLD-BOL.                                              03030028
030400         10  FILLER                     PIC  X(12)                03040028
030500                               VALUE 'B.BOL_NBR = '.              03050028
030600         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03060028
030700         10  PV-BLD-BOL-NBR             PIC X(16).                03070028
030800     05  PV-BLD-PO.                                               03080028
030900         10  FILLER                     PIC  X(11)                03090028
031000                               VALUE 'E.PO_NBR = '.               03100028
031010*CLP 10/28/14                                                     03101035
031100         10  PV-BLD-PO-NBR              PIC  9(08).               03110035
031200     05  PV-OWNER-SCAC.                                           03120028
031300         10  FILLER                     PIC  X(16)                03130028
031400                               VALUE 'B.PRO_SCAC_ID = '.          03140028
031500         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03150028
031600         10  PV-OWNER-SCAC-ID           PIC  X(04).               03160028
031700         10  FILLER                     PIC  X(01)  VALUE X'7D'.  03170028
031800 01  PV-JOIN-LITERALS.                                            03180028
031900     05  PV-VEH-NBR.                                              03190028
032000         10  FILLER                     PIC  X(22)                03200028
032100                          VALUE ' AND C.VEH_NBR IS NULL'.         03210028
032500     05  PV-JOIN-2.                                               03250028
032600         10  FILLER                     PIC  X(28)                03260028
032700                          VALUE ' AND B.SHIPT_ID = E.SHIPT_ID'.   03270028
032800     05  PV-JOIN-3.                                               03280028
032900         10  FILLER                     PIC  X(27)                03290028
033000                          VALUE ' AND B.TRIP_ID  = C.TRIP_ID'.    03300028
033100 01  PV-ORDER-BY-LITERALS.                                        03310099
033200     05  PV-ORDER-BY-1.                                           03320099
033300         10  FILLER                     PIC  X(19)                03330099
033400                          VALUE ' ORDER BY B.BOL_NBR'.            03340099
035400                                                                  03540028
035500 01  PV-BUILD-STATEMENT.                                          03550028
035600     05  PV-BUILD-COMMAND               PIC  X(07)  VALUE SPACES. 03560028
035700     05  PV-BUILD-LITERAL               PIC  X(85)  VALUE SPACES. 03570028
035800                                                                  03580028
035900 01  PV-WHERE-TABLE.                                              03590028
036000     05  PV-WHERE-LINE                  PIC  X(92) OCCURS 7 TIMES.03600028
036100                                                                  03610028
036200******************************************************************03620028
036300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03630028
036400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03640028
036500**  APPLICATION-SPECIFIC COMMAREA.                              **03650028
036600******************************************************************03660028
036700 01  LQW-LIST-QUEUE-WORK-AREA.                                    03670028
036800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03680028
036900     05  LQW-ITEM-ENTRIES               OCCURS 14 TIMES           03690028
037000                                        INDEXED BY LQW-IDX.       03700028
037100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03710028
037200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03720028
037300         10  LQW-SELECTED-SW            PIC  X(01).               03730028
037400             88  LQW-SELECT                         VALUE 'S'.    03740028
037500             88  LQW-DESELECT                       VALUE ' '.    03750028
037600         10  LQW-ACTION                 PIC  X(01).               03760099
037700         10  LQW-SHIPT-ID               PIC S9(09)  COMP.         03770028
037800         10  LQW-DELIVERY-SCAC          PIC  X(04).               03780028
037900         10  LQW-ETA-DATE               PIC  X(08).               03790028
038000         10  LQW-STATUS                 PIC  X(02).               03800028
038100         10  LQW-MANIFEST               PIC  X(10).               03810028
038200         10  LQW-FB-SCAC                PIC  X(04).               03820028
038300         10  LQW-FREIGHT-BILL           PIC  X(14).               03830028
038400         10  LQW-BILL-OF-LADING         PIC  X(20).               03840099
038500         10  LQW-TRIP-ID                PIC S9(09)  COMP.         03850028
038510         10  LQW-TRIP-OPER              PIC S9(04)  COMP.         03851039
038520         10  LQW-TRIP-OPER-E-BUS        PIC  X(01).               03852042
038521             88  LQW-TRIP-E-BUS-Y            VALUE 'Y'.           03852164
038522             88  LQW-TRIP-E-BUS-N            VALUE 'N'.           03852264
038530         10  LQW-TRIP-OPER-SW           PIC  X(01).               03853058
038550         10  LQW-RCVRS-TRANSCRIBED-SW   PIC X(01).                03855099
038551             88  LQW-RCVRS-TRANSCRIBED-YES   VALUE 'Y'.           03855199
038570             88  LQW-RCVRS-TRANSCRIBED-NO    VALUE 'N'.           03857099
038600                                                                  03860028
038700     EJECT                                                        03870028
038800*---------------------------------------------------------------* 03880028
038900*  RECORD LAYOUT FOR THE OPEN SHIPMENT SELECT TEMP STRG QUEUE.  * 03890028
039000*---------------------------------------------------------------* 03900028
039100                                                                  03910028
039200     COPY TRWS006.                                                03920028
039300                                                                  03930028
039400     EJECT                                                        03940028
039500*---------------------------------------------------------------* 03950028
039600*    MAP LAYOUT                                                 * 03960028
039700*---------------------------------------------------------------* 03970028
039800                                                                  03980028
039900     COPY TRKM120.                                                03990028
040000*                                                                 04000028
040100 01  MR-OCCURS-LAYOUT                   REDEFINES  TR120AO.       04010028
040200     05  FILLER                         PIC  X(89).               04020099
040300     05  MR-SCROLL-AREA                 OCCURS 14 TIMES.          04030028
040400         10  MR-SELECTL                 PIC S9(04) COMP.          04040028
040500         10  MR-SELECTA                 PIC  X(01).               04050028
040600         10  MR-SELECTC                 PIC  X(01).               04060028
040700         10  MR-SELECTH                 PIC  X(01).               04070028
040800         10  MR-SELECTI                 PIC  X(01).               04080028
040900                                                                  04090028
041000         10  MR-ACTIONL                 PIC S9(04) COMP.          04100028
041100         10  MR-ACTIONA                 PIC  X(01).               04110028
041200         10  MR-ACTIONC                 PIC  X(01).               04120028
041300         10  MR-ACTIONH                 PIC  X(01).               04130028
041400         10  MR-ACTION                  PIC  X(01).               04140099
041500                                                                  04150028
041600         10  MR-DELIVERY-SCACL          PIC S9(04) COMP.          04160028
041700         10  MR-DELIVERY-SCACA          PIC  X(01).               04170028
041800         10  MR-DELIVERY-SCACC          PIC  X(01).               04180028
041900         10  MR-DELIVERY-SCACH          PIC  X(01).               04190028
042000         10  MR-DELIVERY-SCAC           PIC  X(04).               04200028
042100                                                                  04210028
042200         10  MR-ETA-DATEL               PIC S9(04) COMP.          04220028
042300         10  MR-ETA-DATEA               PIC  X(01).               04230028
042400         10  MR-ETA-DATEC               PIC  X(01).               04240028
042500         10  MR-ETA-DATEH               PIC  X(01).               04250028
042600         10  MR-ETA-DATE                PIC  X(08).               04260028
042700                                                                  04270028
042800         10  MR-STATUSL                 PIC S9(04) COMP.          04280028
042900         10  MR-STATUSA                 PIC  X(01).               04290028
043000         10  MR-STATUSC                 PIC  X(01).               04300028
043100         10  MR-STATUSH                 PIC  X(01).               04310028
043200         10  MR-STATUS                  PIC  X(02).               04320028
043300                                                                  04330028
043310         10  MR-OPERL                   PIC S9(04) COMP.          04331038
043320         10  MR-OPERA                   PIC  X(01).               04332038
043330         10  MR-OPERC                   PIC  X(01).               04333038
043340         10  MR-OPERH                   PIC  X(01).               04334038
043350         10  MR-OPER                    PIC  X(04).               04335038
043360                                                                  04336038
043400         10  MR-MANIFESTL               PIC S9(04) COMP.          04340028
043500         10  MR-MANIFESTA               PIC  X(01).               04350028
043600         10  MR-MANIFESTC               PIC  X(01).               04360028
043700         10  MR-MANIFESTH               PIC  X(01).               04370028
043800         10  MR-MANIFEST                PIC  X(10).               04380028
043900                                                                  04390028
044000         10  MR-FB-SCACL                PIC S9(04) COMP.          04400028
044100         10  MR-FB-SCACA                PIC  X(01).               04410028
044200         10  MR-FB-SCACC                PIC  X(01).               04420028
044300         10  MR-FB-SCACH                PIC  X(01).               04430028
044400         10  MR-FB-SCAC                 PIC  X(04).               04440028
044500                                                                  04450028
044600         10  MR-FREIGHT-BILLL           PIC S9(04) COMP.          04460028
044700         10  MR-FREIGHT-BILLA           PIC  X(01).               04470028
044800         10  MR-FREIGHT-BILLC           PIC  X(01).               04480028
044900         10  MR-FREIGHT-BILLH           PIC  X(01).               04490028
045000         10  MR-FREIGHT-BILL            PIC  X(14).               04500028
045100                                                                  04510028
045200         10  MR-BILL-OF-LADINGL         PIC S9(04) COMP.          04520028
045300         10  MR-BILL-OF-LADINGA         PIC  X(01).               04530028
045400         10  MR-BILL-OF-LADINGC         PIC  X(01).               04540028
045500         10  MR-BILL-OF-LADINGH         PIC  X(01).               04550028
045600         10  MR-BILL-OF-LADING          PIC  X(20).               04560099
045610     05  FILLER                         PIC  X(12).               04561038
045700                                                                  04570028
045800     EJECT                                                        04580028
045900*---------------------------------------------------------------* 04590028
046000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04600028
046100*---------------------------------------------------------------* 04610028
046200                                                                  04620028
046300     COPY DPWS015.                                                04630028
046400                                                                  04640028
046500*---------------------------------------------------------------* 04650028
046600*    FUNCTION KEYS COPYBOOK.                                    * 04660028
046700*---------------------------------------------------------------* 04670028
046800                                                                  04680028
046900     COPY DPWS016.                                                04690028
047000                                                                  04700028
047100*---------------------------------------------------------------* 04710028
047200*    NUMERIC EDIT LAYOUT.                                       * 04720028
047300*---------------------------------------------------------------* 04730028
047400                                                                  04740028
047500     COPY DPWS010I.                                               04750028
047600 EJECT                                                            04760028
047700***************************************************************** 04770028
047800* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 04780028
047900***************************************************************** 04790028
048000     COPY WSWS001.                                                04800028
048100/                                                                 04810028
048200*---------------------------------------------------------------* 04820028
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04830099
048400*---------------------------------------------------------------* 04840028
048500                                                                  04850028
048600     COPY DPWS030.                                                04860028
CICS       COPY DPWS930.                                                04861099
048700 EJECT                                                            04870028
048800*---------------------------------------------------------------* 04880028
048900*    STANDARD COMMAREA.                                         * 04890028
049000*---------------------------------------------------------------* 04900028
049100                                                                  04910028
049200     COPY DPWS020.                                                04920028
049300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04930028
049400                                                                  04940028
049500*---------------------------------------------------------------* 04950028
049600* INTER-APPLICATION COMMAREA.                                   * 04960028
049700*---------------------------------------------------------------* 04970028
049800                                                                  04980028
049900         10  INTER-APPL-COMM-AREA       PIC X(200).               04990028
050000     COPY TRWS009.                                                05000028
050100     COPY TRWS007.                                                05010028
050200*---------------------------------------------------------------* 05020028
050300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05030028
050400*---------------------------------------------------------------* 05040028
050500         10  ASC-SPECIFIC-COMMAREA.                               05050028
050600             15  ASC-LIST-KEYS.                                   05060028
050700                 20  ASC-KEY-DELIVERY-SCAC-CDE   PIC  X(04).      05070028
050800                 20  ASC-KEY-TRLR-NBR            PIC  X(10).      05080028
050900                 20  ASC-KEY-TRIP-ID             PIC S9(09) COMP. 05090028
051000                 20  ASC-KEY-ETA-FROM-DATE.                       05100028
051100                     25  ASC-ETA-FROM-DATE-MM    PIC  X(02).      05110028
051200                     25  ASC-ETA-FROM-DATE-DD    PIC  X(02).      05120028
051300                     25  ASC-ETA-FROM-DATE-CCYY  PIC  X(04).      05130028
051400                 20  ASC-KEY-ETA-FROM-DATE-ISO   PIC  X(10).      05140028
051500                 20  ASC-KEY-ETA-TO-DATE.                         05150028
051600                     25  ASC-ETA-TO-DATE-MM      PIC  X(02).      05160028
051700                     25  ASC-ETA-TO-DATE-DD      PIC  X(02).      05170028
051800                     25  ASC-ETA-TO-DATE-CCYY    PIC  X(04).      05180028
051900                 20  ASC-KEY-ETA-TO-DATE-ISO     PIC  X(10).      05190028
052000                 20  ASC-KEY-PO-NBR              PIC S9(09) COMP. 05200028
052100                 20  ASC-KEY-PRO-NBR             PIC X(22).       05210028
052200                 20  ASC-KEY-BOL-NBR             PIC X(30).       05220028
052300                 20  ASC-KEY-OPER-UNT-ID         PIC S9(04) COMP. 05230028
052400                 20  ASC-KEY-FCLTY-ID            PIC S9(04) COMP. 05240028
052500                 20  ASC-KEY-ORIGINAL-SCAC-CDE   PIC  X(04).      05250028
052600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05260028
052700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05270028
052800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05280028
052900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05290028
053000                                                                  05300028
053100                 20  ASC-ITEM-ARRAY.                              05310028
053200                     25  ASC-ITEM-ENTRIES OCCURS 14 TIMES.        05320028
053300                         30  ASC-LIST-ITEM-NUMBER                 05330028
053400                                                     PIC S9(09)   05340028
053500                                                     COMP-3.      05350028
053600                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05360028
053700                             88  ASC-VALID-SELECT    VALUE ' '    05370028
053800                                                           'S'    05380028
053900                                                           'B'    05390028
054000                                                           'E'.   05400028
054100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05410028
054200                             88  ASC-TEMP-SELECT     VALUE 'S'.   05420028
054300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05430028
054400                             88  ASC-TEMP-END        VALUE 'E'.   05440028
054500                         30  ASC-SELECTED-SW         PIC  X(01).  05450028
054600                             88  ASC-NO-SELECT       VALUE ' '.   05460028
054700                             88  ASC-SELECT          VALUE 'S'.   05470028
054800                             88  ASC-BEGIN           VALUE 'B'.   05480028
054900                             88  ASC-END             VALUE 'E'.   05490028
055000                         30  ASC-ACTION              PIC  X(01).  05500099
055100                         30  ASC-SHIPT-ID            PIC S9(09)   05510028
055200                                                     COMP.        05520028
055300                         30  ASC-DELIVERY-SCAC       PIC  X(04).  05530028
055400                         30  ASC-ETA-DATE            PIC  X(08).  05540028
055500                         30  ASC-STATUS              PIC  X(02).  05550028
055600                         30  ASC-MANIFEST            PIC  X(10).  05560028
055700                         30  ASC-FB-SCAC             PIC  X(04).  05570028
055800                         30  ASC-FREIGHT-BILL        PIC  X(14).  05580028
055900                         30  ASC-BILL-OF-LADING      PIC  X(20).  05590099
056000                         30  ASC-TRIP-ID             PIC S9(09)   05600028
056100                                                     COMP.        05610028
056110                         30  ASC-TRIP-OPER           PIC S9(04)   05611039
056120                                                     COMP.        05612039
056130                         30  ASC-TRIP-OPER-E-BUS-SW  PIC  X(01).  05613099
056131                             88  ASC-TRIP-E-BUS      VALUE 'Y'.   05613199
056132                             88  ASC-TRIP-E-BUS-N    VALUE 'N'.   05613242
056133                         30  ASC-TRIP-OPER-SW        PIC  X(01).  05613354
056134                             88  ASC-SINGLE-OPER     VALUE 'S'.   05613454
056135                             88  ASC-MULT-OPER       VALUE 'M'.   05613554
056136                         30  ASC-RCVRS-TRANSCRIBD-SW PIC  X(01).  05613699
056137                             88  ASC-RCVRS-TRANSCRIBED-YES        05613799
056138                                                     VALUE 'Y'.   05613899
056139                             88  ASC-RCVRS-TRANSCRIBED-NO         05613999
056140                                                     VALUE 'N'.   05614099
056200                                                                  05620028
056300             15  ASC-BLK-SUB                         PIC S9(04)   05630028
056400                                                          COMP    05640028
056500                                                          SYNC.   05650028
056600             15  ASC-ITEM-SUB                        PIC S9(04)   05660028
056700                                                          COMP    05670028
056800                                                          SYNC.   05680028
056900             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05690028
057000                                                          COMP-3. 05700028
057100             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05710028
057200                                                          COMP-3. 05720028
057300             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05730028
057400                                                          COMP-3. 05740028
057500             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05750028
057600                                                          COMP-3. 05760028
057700             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05770028
057800                                                          COMP-3. 05780028
057900             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05790028
058000                                                          COMP    05800028
058100                                                          SYNC.   05810028
058200             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05820028
058300                                                          COMP-3. 05830028
058400             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05840028
058500                                                          COMP-3. 05850028
058600             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05860028
058700                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05870028
058800                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05880028
058900             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05890028
059000                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05900028
059100                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05910028
059200             15  ASC-LIST-QUEUE-NAME.                             05920028
059300                 20  ASC-LIST-TERM-ID                PIC  X(04).  05930028
059400                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05940028
059500                                                          COMP-3. 05950028
059600                 20  ASC-LIST-SEQ                    PIC  9(01).  05960028
059700             15  ASC-SEL-QUEUE-NAME.                              05970028
059800                 20  ASC-SEL-TERM-ID                 PIC  X(04).  05980028
059900                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   05990028
060000                                                          COMP-3. 06000028
060100                 20  ASC-SEL-SEQ                     PIC  9(01).  06010028
060200                                                                  06020028
060300             15  ASC-CURSOR-SW                       PIC  X(01).  06030028
060400                 88  ASC-NO-CURSOR                   VALUE 'Z'.   06040028
060500                 88  ASC-SYSTEM-ID-CURSOR            VALUE 'S'.   06050028
060600                 88  ASC-MESSAGE-NUMBER-CURSOR       VALUE 'N'.   06060028
060700                 88  ASC-MESSAGE-TEXT-CURSOR         VALUE 'T'.   06070028
060800             15  ASC-START-ITEM-REQUEST.                          06080028
060900                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  06090028
060910             15  ASC-OPER-NAME                       PIC  X(25).  06091099
060920             15  ASC-E-BUS-IND                       PIC  X.      06092039
060930                 88  ASC-E-BUS-Y                     VALUE 'Y'.   06093042
060940                 88  ASC-E-BUS-N                     VALUE 'N'.   06094042
061000     EJECT                                                        06100028
061100*---------------------------------------------------------------* 06110028
061200*    ABEND PROCESSING COPYBOOK.                                 * 06120028
061300*---------------------------------------------------------------* 06130028
061400                                                                  06140028
061500     COPY DPWS013.                                                06150028
061600                                                                  06160028
061700 EJECT                                                            06170028
061800*---------------------------------------------------------------* 06180028
061900*    DB2 AREA FOR RECEIVER TABLE                                * 06190028
062000*---------------------------------------------------------------* 06200028
062100     EXEC SQL                                                     06210028
062200          INCLUDE TRECEIV                                         06220028
062300     END-EXEC.                                                    06230028
062301                                                                  06230176
062310*---------------------------------------------------------------* 06231076
062320*    DB2 AREA FOR RECEIVER ITEM                                 * 06232076
062330*---------------------------------------------------------------* 06233076
062340     EXEC SQL                                                     06234076
062350          INCLUDE TRECITM                                         06235076
062360     END-EXEC.                                                    06236076
062370                                                                  06237076
062380*---------------------------------------------------------------* 06238099
062390*    TPURCHS                                                    * 06239099
062391*---------------------------------------------------------------* 06239199
062392     EXEC SQL                                                     06239299
062393          INCLUDE TPURCHS                                         06239399
062394     END-EXEC.                                                    06239499
062395                                                                  06239599
062396*---------------------------------------------------------------* 06239699
062397*    TPURITM                                                    * 06239799
062398*---------------------------------------------------------------* 06239899
062399     EXEC SQL                                                     06239999
062400          INCLUDE TPURITM                                         06240099
062401     END-EXEC.                                                    06240199
062402                                                                  06240299
062410*---------------------------------------------------------------* 06241028
062500*    DB2 AREA FOR TSHIPMT                                       * 06250028
062600*---------------------------------------------------------------* 06260028
062700     EXEC SQL                                                     06270028
062800          INCLUDE TSHIPMT                                         06280028
062900     END-EXEC.                                                    06290028
063000                                                                  06300028
063100*---------------------------------------------------------------* 06310028
063200*    DB2 AREA FOR THE SHIPMENT AUDIT TABLE                      * 06320028
063300*---------------------------------------------------------------* 06330028
063400     EXEC SQL                                                     06340028
063500          INCLUDE TAUSHIP                                         06350028
063600     END-EXEC.                                                    06360028
063700                                                                  06370028
063800*---------------------------------------------------------------* 06380028
063900*    DB2 AREA FOR TSHIPST                                       * 06390028
064000*---------------------------------------------------------------* 06400028
064100     EXEC SQL                                                     06410028
064200          INCLUDE TSHIPST                                         06420028
064300     END-EXEC.                                                    06430028
064400                                                                  06440028
064500*---------------------------------------------------------------* 06450028
064600*    DB2 AREA FOR TSHSTYP                                       * 06460028
064700*---------------------------------------------------------------* 06470028
064800     EXEC SQL                                                     06480028
064900          INCLUDE TSHSTYP                                         06490028
065000     END-EXEC.                                                    06500028
065100                                                                  06510028
065200*---------------------------------------------------------------* 06520028
065300*    DB2 AREA FOR TVHTRIP                                       * 06530028
065400*---------------------------------------------------------------* 06540028
065500     EXEC SQL                                                     06550028
065600          INCLUDE TVHTRIP                                         06560028
065700     END-EXEC.                                                    06570028
065800                                                                  06580028
065900*---------------------------------------------------------------* 06590028
066000*    DB2 AREA FOR THE VEHICLE TABLE                             * 06600028
066100*---------------------------------------------------------------* 06610028
066200     EXEC SQL                                                     06620028
066300          INCLUDE TVEHICL                                         06630028
066400     END-EXEC.                                                    06640028
066500                                                                  06650028
066600*---------------------------------------------------------------* 06660028
066700*    DB2 AREA FOR TTRIPST                                       * 06670028
066800*---------------------------------------------------------------* 06680028
066900     EXEC SQL                                                     06690028
067000          INCLUDE TTRIPST                                         06700028
067100     END-EXEC.                                                    06710028
067200                                                                  06720028
067300*---------------------------------------------------------------* 06730028
067400*    DB2 AREA FOR TTRSTYP                                       * 06740028
067500*---------------------------------------------------------------* 06750028
067600     EXEC SQL                                                     06760028
067700          INCLUDE TTRSTYP                                         06770028
067800     END-EXEC.                                                    06780028
067900                                                                  06790028
068000*---------------------------------------------------------------* 06800028
068100*    DB2 AREA FOR TSHPTPO                                       * 06810028
068200*---------------------------------------------------------------* 06820028
068300     EXEC SQL                                                     06830028
068400          INCLUDE TSHPTPO                                         06840028
068500     END-EXEC.                                                    06850028
068600                                                                  06860028
068700*---------------------------------------------------------------* 06870028
068701*    DB2 AREA FOR TPKSLIP                                       * 06870128
068702*---------------------------------------------------------------* 06870228
068703     EXEC SQL                                                     06870328
068704          INCLUDE TPKSLIP                                         06870428
068705     END-EXEC.                                                    06870528
068706                                                                  06870628
068707***************************************************************** 06870728
068708*    DB2 AREA FOR THE PARM TABLE                                * 06870828
068709***************************************************************** 06870928
068710     EXEC SQL                                                     06871028
068720          INCLUDE TKRPRPM                                         06872028
068730     END-EXEC.                                                    06873028
068740                                                                  06874028
068741*---------------------------------------------------------------* 06874140
068742*    XLT_LOC                                                    * 06874240
068743*---------------------------------------------------------------* 06874340
068744     EXEC SQL                                                     06874440
068745          INCLUDE XLT00010                                        06874540
068746     END-EXEC.                                                    06874640
068747                                                                  06874740
068748*---------------------------------------------------------------* 06874867
068749*    TWRKORD                                                    * 06874967
068750*---------------------------------------------------------------* 06875067
068751     EXEC SQL                                                     06875167
068752          INCLUDE TWRKORD                                         06875267
068753     END-EXEC.                                                    06875367
068754                                                                  06875467
068755*---------------------------------------------------------------* 06875567
068756*    TWKORIN                                                    * 06875667
068757*---------------------------------------------------------------* 06875767
068758     EXEC SQL                                                     06875867
068759          INCLUDE TWKORIN                                         06875967
068760     END-EXEC.                                                    06876067
068761                                                                  06876167
068762*---------------------------------------------------------------* 06876269
068763*    TOSOPFA                                                    * 06876369
068764*---------------------------------------------------------------* 06876469
068765     EXEC SQL                                                     06876569
068766          INCLUDE TOSOPFA                                         06876669
068767     END-EXEC.                                                    06876769
068768                                                                  06876869
068769*---------------------------------------------------------------* 06876974
068770*    TDCFAAS                                                    * 06877074
068771*---------------------------------------------------------------* 06877174
068772     EXEC SQL                                                     06877274
068773          INCLUDE TDCFAAS                                         06877374
068774     END-EXEC.                                                    06877474
068775                                                                  06877574
068776*---------------------------------------------------------------* 06877674
068777*    TOPRSET                                                    * 06877774
068778*---------------------------------------------------------------* 06877874
068779     EXEC SQL                                                     06877974
068780          INCLUDE TOPRSET                                         06878074
068781     END-EXEC.                                                    06878174
068782                                                                  06878274
068784*---------------------------------------------------------------* 06878474
068785*    TCOCNTL                                                    * 06878574
068786*---------------------------------------------------------------* 06878674
068787     EXEC SQL                                                     06878774
068788          INCLUDE TCOCNTL                                         06878874
068789     END-EXEC.                                                    06878974
068790                                                                  06879074
068791*---------------------------------------------------------------* 06879175
068792*    XLT-SKU                                                    * 06879275
068793*---------------------------------------------------------------* 06879375
068794     EXEC SQL                                                     06879475
068795          INCLUDE XLT00003                                        06879575
068796     END-EXEC.                                                    06879675
068797                                                                  06879775
068798*---------------------------------------------------------------* 06879875
068799*    XLT_VND_STYL                                               * 06879975
068800*---------------------------------------------------------------* 06880075
068801     EXEC SQL                                                     06880175
068802          INCLUDE XLT00004                                        06880275
068803     END-EXEC.                                                    06880375
068804                                                                  06880475
068805*---------------------------------------------------------------* 06880575
068806*    DB2 AREA FOR COMMUNICATIONS                                * 06880675
068807*---------------------------------------------------------------* 06880775
068808     EXEC SQL                                                     06880875
068809          INCLUDE SQLCA                                           06880975
068810     END-EXEC.                                                    06881075
068900                                                                  06890028
073600                                                                  07360028
073700     EXEC SQL                                                     07370028
073800          DECLARE SHPTPO-CSR CURSOR FOR                           07380028
073900          SELECT PO_NBR                                           07390028
074000               , REC_SEQ_NBR                                      07400028
074100               , EXPTED_CART_CNT                                  07410028
074200               , ACTL_CART_CNT                                    07420028
074300               , VEND_CART_CT                                     07430028
074400            FROM TSHPTPO                                          07440028
074500           WHERE SHIPT_ID = :DK-SHIPT-ID                          07450028
074600     END-EXEC                                                     07460028
074700                                                                  07470028
074710     EXEC SQL                                                     07471060
074720          DECLARE SHPMT-EFC-RCVR-CSR CURSOR FOR                   07472060
074730          SELECT B.PO_NBR                                         07473060
074740               , B.REC_SEQ_NBR                                    07474060
074741               , C.EXPTED_CART_CNT                                07474171
074742               , C.ACTL_CART_CNT                                  07474271
074750            FROM TSHIPMT A                                        07475060
074760               , TSHPTPO B                                        07476060
074761               , TRECEIV C                                        07476160
074762               , XLT_LOC D                                        07476260
074763          WHERE A.SHIPT_ID          = :DK-SHIPT-ID                07476360
074764            AND A.SHIPT_ID          =  B.SHIPT_ID                 07476460
074765            AND B.PO_NBR            =  C.ORD_NBR                  07476560
074766            AND B.REC_SEQ_NBR       =  C.REC_SEQ_NBR              07476660
074767            AND C.STATUS_CDE       <> 'VE'                        07476760
074770            AND C.CURR_OPER_UNT_ID  =  D.LOC_NBR                  07477060
074780            AND D.E_BUS_IND         = 'Y'                         07478060
074791     END-EXEC                                                     07479160
074792                                                                  07479260
074793*---------------------------------------------------------------* 07479368
074794*  CURSOR TO LIST COLUMNS FOR A OPERATION SET                   * 07479468
074795*---------------------------------------------------------------* 07479568
074796                                                                  07479668
074797     EXEC SQL                                                     07479768
074798          DECLARE TOSOPFA-CSR CURSOR FOR                          07479868
074799           SELECT OPER_SET_ID                                     07479968
074800                 ,OPER_ID                                         07480068
074801                 ,OPER_UNT_ID                                     07480168
074802                 ,FCLTY_ID                                        07480268
074803                 ,FCLTY_AREA_ID                                   07480368
074804                 ,PRC_FCLTY_AREA_ID                               07480468
074805                 ,SCRN_SEQ_NBR                                    07480568
074806           FROM   TOSOPFA                                         07480668
074807           WHERE  OPER_SET_ID    = :OSOPFA-OPER-SET-ID            07480768
074808             AND  OPER_UNT_ID    = :OSOPFA-OPER-UNT-ID            07480868
074809             AND  FCLTY_ID       = :OSOPFA-FCLTY-ID               07480968
074810             AND  VER_STATUS_CDE = 'A'                            07481068
074811           ORDER BY SCRN_SEQ_NBR                                  07481168
074812     END-EXEC.                                                    07481268
074813                                                                  07481368
074814                                                                  07481468
074820 EJECT                                                            07482028
074900 LINKAGE SECTION.                                                 07490028
075000                                                                  07500028
075100 01  DFHCOMMAREA.                                                 07510028
075200     05  FILLER                         OCCURS  1 TO 4072 TIMES   07520028
075300                                        DEPENDING ON EIBCALEN.    07530028
075400         10  FILLER                     PIC X.                    07540028
075500                                                                  07550028
075600 EJECT                                                            07560028
075700 PROCEDURE DIVISION.                                              07570028
075800******************************************************************07580028
075900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07590028
076000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07600028
076100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07610028
076200******************************************************************07620028
076300 0000-MAIN-MODULE.                                                07630028
076400     INITIALIZE DP030-CICS-API-FIELDS.                            07640028
076500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07650028
076600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07660028
076700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07670028
076800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07680028
076900     MOVE LENGTH OF TR120AI        TO DP030-MAP-LENGTH (1).       07690028
077000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07700028
077100     PERFORM 0001-CALL-CICS-ARCH-API.                             07710028
077200*                                                                 07720028
077300     PERFORM 1000-CONTROL-PROCESSING                              07730028
077400*                                                                 07740028
077500     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07750028
077600     PERFORM 0001-CALL-CICS-ARCH-API.                             07760028
077700                                                                  07770028
077800******************************************************************07780028
077900**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07790028
078000**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07800028
078100******************************************************************07810028
078200 0001-CALL-CICS-ARCH-API.                                         07820028
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07830099
078400                                    DFHCOMMAREA                   07840099
078500                                    DP030-CICS-API-FIELDS         07850099
078600                                    DP020-STANDARD-COMMAREA       07860099
078700                                    TR120AI.                      07870099
078800*                                                                 07880028
078900     IF  DP030-RC-CALL-SUCCESSFUL                                 07890028
079000         CONTINUE                                                 07900028
079100     ELSE                                                         07910028
079200         SET DP013-NO-ROLLBACK                                    07920028
079300             DP013-XCTL-DISPLAY-RESTART                           07930028
079400             DP013-CICS-ABEND      TO TRUE                        07940028
079500         MOVE '0001-CALL-CICS-ARCH-API'                           07950028
079600                                   TO DP013-PARAGRAPH             07960028
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07970099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07980099
079900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07990028
080000         PERFORM DP013-0000-PROCESS-ABEND                         08000028
080100     END-IF.                                                      08010028
080200*----------------------------------------------------------------*08020028
080300* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *08030028
080400* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *08040028
080500*                                                                *08050028
080600* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *08060028
080700*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *08070028
080800*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *08080028
080900*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *08090028
081000*----------------------------------------------------------------*08100028
081100                                                                  08110028
081200 1000-CONTROL-PROCESSING.                                         08120028
081300                                                                  08130028
081400     EVALUATE TRUE                                                08140028
081500         WHEN DP020-NEXT-ACT-INITIAL                              08150028
081600             INITIALIZE ASC-SPECIFIC-COMMAREA                     08160028
081700             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            08170028
081800                                      ASC-SEL-TERM-ID             08180028
081900             MOVE DP020-SRC-TASK-NUMBER                           08190028
082000                                   TO ASC-LIST-TASK-NUMBER        08200028
082100                                      ASC-SEL-TASK-NUMBER         08210028
082200             MOVE PC-LIST-QUEUE-SEQ                               08220028
082300                                   TO ASC-LIST-SEQ                08230028
082400             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 08240028
082500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 08250028
082600***-----$TEMPLATE NOTE$-------------------------------------------08260028
082700*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,08270028
082800*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  08280028
082900*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08290028
083000***---------------------------------------------------------------08300028
083100             IF  PS-COMMAREA-NOT-VALID                            08310028
083200                 SET DP020-NEXT-ACT-APPL-ERROR                    08320028
083300                                   TO TRUE                        08330028
083400             ELSE                                                 08340028
083500                 PERFORM 4000-BUILD-INITIAL-PANEL                 08350028
083600             END-IF                                               08360028
083700                                                                  08370028
083800         WHEN DP020-NEXT-ACT-READ-MAP                             08380028
083900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08390028
084000                                   TO PV-TOP-ITEM                 08400028
084100             PERFORM 2000-PROCESS-PANEL                           08410028
084200                                                                  08420028
084300         WHEN DP020-NEXT-ACT-RETURN                               08430099
084400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08440028
084500                                   TO PV-TOP-ITEM                 08450028
084600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08460028
084700             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08470028
084800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08480028
084900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08490028
085000                                                                  08500028
085100         WHEN OTHER                                               08510028
085200             SET DP013-LOGIC-ABEND TO TRUE                        08520028
085300             SET DP013-NO-ROLLBACK TO TRUE                        08530028
085400             MOVE '1000-CONTROL-PROCESSING'                       08540028
085500                                   TO DP013-PARAGRAPH             08550028
085600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08560028
085700                                   TO DP013-MESSAGE-TEXT(1)       08570028
085800             PERFORM DP013-0000-PROCESS-ABEND                     08580028
085900     END-EVALUATE.                                                08590028
086000                                                                  08600028
086100 EJECT                                                            08610028
086200*----------------------------------------------------------------*08620028
086300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08630028
086400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08640028
086500*----------------------------------------------------------------*08650028
086600                                                                  08660028
086700 1100-PROCESS-INTER-APPL-COMM.                                    08670028
086800                                                                  08680028
086900     SET PS-COMMAREA-VALID         TO TRUE.                       08690028
087000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08700028
087100                                                                  08710028
087200     IF TR009-DELIVERY-SCAC-CDE = SPACES AND                      08720028
087300        TR009-ETA-FROM-DATE-ISO = SPACES AND                      08730028
087400        TR009-PO-NBR            = ZERO AND                        08740028
087500        TR009-PRO-NBR           = SPACES AND                      08750028
087600        TR009-BOL-NBR           = SPACES                          08760028
087700         MOVE PC-TSYMSG-00007                                     08770028
087800                           TO DP020-MSG-NUMBER                    08780028
087900         SET DP020-MSG-FATAL                                      08790028
088000             PS-COMMAREA-NOT-VALID                                08800028
088100             PS-ERROR                                             08810028
088200                           TO TRUE                                08820028
088300     ELSE                                                         08830028
088400                                                                  08840028
088500         MOVE TR009-DELIVERY-SCAC-CDE                             08850028
088600                                   TO ASC-KEY-DELIVERY-SCAC-CDE   08860028
088700         MOVE TR009-TRLR-NBR       TO ASC-KEY-TRLR-NBR            08870028
088800         MOVE TR009-TRIP-ID        TO ASC-KEY-TRIP-ID             08880028
088900         MOVE TR009-OPER-UNIT-ID   TO ASC-KEY-OPER-UNT-ID         08890028
089000         MOVE TR009-FCLTY-ID       TO ASC-KEY-FCLTY-ID            08900028
089100         MOVE TR009-ORIGINAL-SCAC-CDE                             08910028
089200                                   TO ASC-KEY-ORIGINAL-SCAC-CDE   08920028
089300                                                                  08930028
089400         IF  TR009-ETA-FROM-DATE-ISO = SPACES                     08940028
089500             MOVE PC-DEFAULT-LOW-DATE-ISO                         08950028
089600                                   TO  ASC-KEY-ETA-FROM-DATE-ISO  08960028
089700                                                                  08970028
089800         ELSE                                                     08980028
089900             MOVE TR009-ETA-FROM-DATE-ISO                         08990028
090000                                   TO  ASC-KEY-ETA-FROM-DATE-ISO  09000028
090100                                                                  09010028
090200         END-IF                                                   09020028
090300                                                                  09030028
090400         IF  TR009-ETA-TO-DATE-ISO = SPACES                       09040028
090500             MOVE PC-DEFAULT-HIGH-DATE-ISO                        09050028
090600                                   TO  ASC-KEY-ETA-TO-DATE-ISO    09060028
090700                                                                  09070028
090800         ELSE                                                     09080028
090900             MOVE TR009-ETA-TO-DATE-ISO                           09090028
091000                                   TO  ASC-KEY-ETA-TO-DATE-ISO    09100028
091100                                                                  09110028
091200         END-IF                                                   09120028
091300                                                                  09130028
091400         MOVE TR009-PO-NBR         TO ASC-KEY-PO-NBR              09140028
091500         MOVE TR009-PRO-NBR        TO ASC-KEY-PRO-NBR             09150028
091600         MOVE TR009-BOL-NBR        TO ASC-KEY-BOL-NBR             09160028
091700     END-IF.                                                      09170028
091800                                                                  09180028
091900 EJECT                                                            09190028
092000*----------------------------------------------------------------*09200028
092100* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09210028
092200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09220028
092300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09230028
092400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09240028
092500* FUNCTION KEYS CAN GET THIS FAR.                                *09250028
092600*----------------------------------------------------------------*09260028
092700                                                                  09270028
092800 2000-PROCESS-PANEL.                                              09280028
092900     EVALUATE TRUE                                                09290028
093000         WHEN DP020-SRC-AID = DP016-CLEAR                         09300028
093100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09310028
093200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09320028
093300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09330028
093400                                                                  09340028
093500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09350028
093600             PERFORM 2050-DELETE-LIST-QUEUE                       09360028
093700             PERFORM 4000-BUILD-INITIAL-PANEL                     09370028
093800                                                                  09380028
093900         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09390028
094000             PERFORM 2140-DESELECT-ALL-ITEMS                      09400028
094100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09410028
094200                                                                  09420028
094300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09430028
094400             PERFORM 2150-SELECT-ALL-ITEMS                        09440028
094500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09450028
094600                                                                  09460028
094700         WHEN OTHER                                               09470028
094800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09480028
094900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09490028
095000             IF  PS-NO-ERROR                                      09500028
095100                 SET DP030-CONTINUE-GO                            09510028
095200                                 TO TRUE                          09520028
095300                 PERFORM 2100-CHECK-FUNCTION-KEY                  09530028
095400             ELSE                                                 09540028
095500                 SET DP030-OVERRIDE-GO                            09550028
095600                                 TO TRUE                          09560028
095700             END-IF                                               09570028
095800     END-EVALUATE.                                                09580028
095900 EJECT                                                            09590028
096000*----------------------------------------------------------------*09600028
096100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09610028
096200*----------------------------------------------------------------*09620028
096300 2050-DELETE-LIST-QUEUE.                                          09630028
096400                                                                  09640028
096500     EXEC CICS                                                    09650028
096600         DELETEQ TS                                               09660028
096700             QUEUE (ASC-LIST-QUEUE-NAME)                          09670028
096800             RESP  (PV-CICS-RESP)                                 09680028
096900     END-EXEC.                                                    09690028
097000                                                                  09700028
097100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09710028
097200        (PV-CICS-RESP = DFHRESP(QIDERR))                          09720028
097300         CONTINUE                                                 09730028
097400     ELSE                                                         09740028
097500         SET DP013-CICS-ABEND      TO TRUE                        09750028
097600         SET DP013-NO-ROLLBACK     TO TRUE                        09760028
097700                                                                  09770028
097800         MOVE '2050-DELETE-LIST-QUEUE'                            09780028
097900                                   TO DP013-PARAGRAPH             09790028
098000         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    09800028
098100                                   TO DP013-MESSAGE-TEXT (1)      09810028
098200         PERFORM DP013-0000-PROCESS-ABEND                         09820028
098300     END-IF.                                                      09830028
098400                                                                  09840028
098500     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  09850028
098600 EJECT                                                            09860028
098700*----------------------------------------------------------------*09870028
098800* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*09880028
098900* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *09890028
099000* CICS ARCHITECTURE API.                                         *09900028
099100*----------------------------------------------------------------*09910028
099200 2100-CHECK-FUNCTION-KEY.                                         09920028
099300     EVALUATE TRUE                                                09930028
099400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 09940028
099500             IF  ASC-NUMBER-OF-SELECTED-ITEMS = +1                09950028
099600                 INITIALIZE TR007-INTER-APPL-COMMAREA             09960028
099700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                09970028
099800                             TO TR007-NUMBER-OF-SELECTED-ITEMS    09980028
099900                 PERFORM 5000-PREPARE-SEL-QUEUE                   09990028
100000             ELSE                                                 10000028
100100             IF  ASC-NUMBER-OF-SELECTED-ITEMS = +0                10010028
100200                 SET DP030-OVERRIDE-GO                            10020028
100300                                   TO TRUE                        10030028
100400                 MOVE PC-TSYMSG-00057                             10040028
100500                                   TO DP020-MSG-NUMBER            10050028
100600                 SET DP020-MSG-WARNING                            10060028
100700                                   TO TRUE                        10070028
100800             ELSE                                                 10080028
100900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > +1                10090028
101000                 SET DP030-OVERRIDE-GO                            10100028
101100                                   TO TRUE                        10110028
101200                 MOVE PC-TSYMSG-00047                             10120028
101300                                   TO DP020-MSG-NUMBER            10130028
101400                 SET DP020-MSG-WARNING                            10140028
101500                                   TO TRUE                        10150028
101600             END-IF                                               10160028
101700             END-IF                                               10170028
101800             END-IF                                               10180028
101900                                                                  10190028
102000         WHEN DP020-FK-LOCAL-RETURN(DP020-SRC-AID)                10200028
102100             PERFORM 5800-SELECT-TVEHICL                          10210028
102200             IF SQLCODE = +100                                    10220028
102300                 SET DP030-OVERRIDE-GO                            10230028
102400                                   TO TRUE                        10240028
102500                 MOVE PC-TSYMSG-00743                             10250028
102600                                   TO DP020-MSG-NUMBER            10260028
102700                 SET DP020-MSG-WARNING                            10270028
102800                                   TO TRUE                        10280028
102900             ELSE                                                 10290028
103000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10300028
103100                 INITIALIZE TR007-INTER-APPL-COMMAREA             10310028
103200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10320028
103300                                TO TR007-NUMBER-OF-SELECTED-ITEMS 10330028
103400                 PERFORM 5000-PREPARE-SEL-QUEUE                   10340028
103500             ELSE                                                 10350028
103600                 SET DP030-OVERRIDE-GO                            10360028
103700                                   TO TRUE                        10370028
103800                 MOVE PC-TSYMSG-00057                             10380028
103900                                   TO DP020-MSG-NUMBER            10390028
104000                 SET DP020-MSG-WARNING                            10400028
104100                                   TO TRUE                        10410028
104200             END-IF                                               10420028
104300             END-IF                                               10430028
104400                                                                  10440028
104500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  10450028
104600             MOVE +1               TO PV-TOP-ITEM                 10460028
104700             PERFORM 3200-RESET-ATTRIBUTES                        10470099
104710             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10471099
104720             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10472099
104800                                                                  10480028
104900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   10490028
104910             PERFORM 3200-RESET-ATTRIBUTES                        10491099
104920             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10492099
105000             PERFORM 2110-BROWSE-BACKWARD                         10500028
105100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10510028
105200                                                                  10520028
105300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   10530028
105310             PERFORM 3200-RESET-ATTRIBUTES                        10531099
105320             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10532099
105400             PERFORM 2120-BROWSE-FORWARD                          10540028
105500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10550028
105600                                                                  10560028
105700         WHEN DP020-SRC-AID = DP016-ENTER                         10570028
105800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   10580028
105900             IF  PS-ERROR                                         10590028
106000                 CONTINUE                                         10600028
106100             ELSE                                                 10610028
106110             PERFORM 3200-RESET-ATTRIBUTES                        10611099
106120             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10612099
106200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10620028
106300             END-IF                                               10630028
106400                                                                  10640028
106500         WHEN OTHER                                               10650028
106600             SET DP013-NO-ROLLBACK                                10660028
106700                 DP013-XCTL-DISPLAY-RESTART                       10670028
106800                 DP013-CICS-ABEND  TO TRUE                        10680028
106900             MOVE '2100-CHECK-FUNCTION-KEY'                       10690028
107000                                   TO DP013-PARAGRAPH             10700028
107100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      10710028
107200                                   TO DP013-MESSAGE-TEXT (1)      10720028
107300             PERFORM DP013-0000-PROCESS-ABEND                     10730028
107400     END-EVALUATE.                                                10740028
107500*                                                                 10750028
107600*----------------------------------------------------------------*10760028
107700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10770028
107800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10780028
107900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10790028
108000*    MESSAGE.                                                    *10800028
108100*----------------------------------------------------------------*10810028
108200                                                                  10820028
108300 2110-BROWSE-BACKWARD.                                            10830028
108400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10840028
108500         GIVING PV-TOP-ITEM.                                      10850028
108600*                                                                 10860028
108700     IF  ((PV-TOP-ITEM < +1)                                      10870028
108800       OR (PV-TOP-ITEM = +1))                                     10880028
108900         MOVE +1                   TO PV-TOP-ITEM                 10890028
109000*        -- TOP OF LIST --                                        10900028
109100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10910028
109200         SET DP020-MSG-INFORMATIONAL TO TRUE                      10920028
109300     END-IF.                                                      10930028
109400                                                                  10940028
109500 EJECT                                                            10950028
109600*----------------------------------------------------------------*10960028
109700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10970028
109800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *10980028
109900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *10990028
110000*----------------------------------------------------------------*11000028
110100                                                                  11010028
110200 2120-BROWSE-FORWARD.                                             11020028
110300                                                                  11030028
110400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11040028
110500         GIVING PV-TOP-ITEM.                                      11050028
110600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11060028
110700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11070028
110800                                   TO PV-TOP-ITEM                 11080028
110900*        -- BOTTOM OF LIST --                                     11090028
111000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11100028
111100         SET DP020-MSG-INFORMATIONAL                              11110028
111200                                   TO TRUE                        11120028
111300     ELSE                                                         11130028
111400         COMPUTE PV-BOTTOM-ITEM =                                 11140028
111500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11150028
111600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11160028
111700*            -- BOTTOM OF LIST --                                 11170028
111800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11180028
111900             SET DP020-MSG-INFORMATIONAL                          11190028
112000                                   TO TRUE                        11200028
112100         END-IF                                                   11210028
112200     END-IF.                                                      11220028
112300 EJECT                                                            11230028
112400*----------------------------------------------------------------*11240028
112500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11250028
112600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11260028
112700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11270028
112800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11280028
112900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11290028
113000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11300028
113100*----------------------------------------------------------------*11310028
113200                                                                  11320028
113300 2130-CHECK-FOR-JUMP-BROWSE.                                      11330028
113400     SET PS-NO-ERROR               TO TRUE.                       11340028
113500     IF (ASC-START-ITEM-REQUEST = SPACE)                          11350028
113600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11360028
113700                                   TO PV-TOP-ITEM                 11370028
113800     ELSE                                                         11380028
113900         MOVE ASC-START-ITEM-REQUEST                              11390028
114000                                   TO DP010I-UNEDITED-FIELD       11400028
114100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11410028
114200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11420028
114300         SET DP010I-NEGATIVE-NOT-ALLOWED                          11430028
114400                                   TO TRUE                        11440028
263697         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11451099
263697              USING DP010I-NUMERIC-EDIT-AREA                      11452099
114600                                                                  11460028
114700         IF  NOT DP010I-ERROR-DETECTED                            11470028
114800             MOVE DP010I-NUMERIC-FIELD                            11480028
114900                                   TO  ASC-START-ITEM-REQUEST-N   11490028
115000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11500028
115100                 IF  ASC-START-ITEM-REQUEST-N >                   11510028
115200                                          ASC-NUMBER-OF-ITEMS-READ11520028
115300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11530028
115400                     COMPUTE PV-TOP-ITEM =                        11540028
115500                             ASC-NUMBER-OF-ITEMS-READ             11550028
115600                             - PC-ITEMS-PER-PANEL + 1             11560028
115700                     IF  PV-TOP-ITEM < +1                         11570028
115800                         MOVE +1   TO PV-TOP-ITEM                 11580028
115900                         MOVE PC-TSYMSG-00070                     11590028
116000                                   TO DP020-MSG-NUMBER            11600028
116100                         SET DP020-MSG-INFORMATIONAL              11610028
116200                                   TO TRUE                        11620028
116300                     END-IF                                       11630028
116400                 ELSE                                             11640028
116500                     MOVE ASC-START-ITEM-REQUEST-N                11650028
116600                                   TO PV-TOP-ITEM                 11660028
116700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11670028
116800                     COMPUTE PV-BOTTOM-ITEM =                     11680028
116900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11690028
117000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11700028
117100*                        -- BOTTOM OF LIST --                     11710028
117200                         MOVE PC-TSYMSG-00070                     11720028
117300                                   TO DP020-MSG-NUMBER            11730028
117400                         SET DP020-MSG-INFORMATIONAL              11740028
117500                                   TO TRUE                        11750028
117600                     END-IF                                       11760028
117700                 END-IF                                           11770028
117800             ELSE                                                 11780028
117900*                --- VALUE OUT OF RANGE ----                      11790028
118000                 MOVE PC-TSYMSG-00101                             11800028
118100                                   TO DP020-MSG-NUMBER            11810028
118200                 MOVE -1           TO ASTRTITL                    11820028
118300                 SET DP030-SET-CURSOR-APPL-1                      11830028
118400                                   TO TRUE                        11840028
118500                 MOVE DP015-REVERSE                               11850028
118600                                   TO ASTRTITH                    11860028
118700                 MOVE DP015-RED    TO ASTRTITC                    11870028
118800                 MOVE DP015-UNP-NUM-BRT-MDT                       11880028
118900                                   TO ASTRTITA                    11890028
119000                 SET DP020-MSG-FATAL                              11900028
119100                                   TO TRUE                        11910028
119200                 SET PS-ERROR      TO TRUE                        11920028
119300             END-IF                                               11930028
119400                                                                  11940028
119500         ELSE                                                     11950028
119600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11960028
119700             MOVE -1               TO ASTRTITL                    11970028
119800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  11980028
119900             MOVE DP015-REVERSE    TO ASTRTITH                    11990028
120000             MOVE DP015-RED        TO ASTRTITC                    12000028
120100             MOVE DP015-UNP-NUM-BRT-MDT                           12010028
120200                                   TO ASTRTITA                    12020028
120300             SET DP020-MSG-FATAL   TO TRUE                        12030028
120400             SET PS-ERROR          TO TRUE                        12040028
120500         END-IF                                                   12050028
120600     END-IF.                                                      12060028
120700 EJECT                                                            12070028
120800*----------------------------------------------------------------*12080028
120900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12090028
121000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12100028
121100*----------------------------------------------------------------*12110028
121200 2140-DESELECT-ALL-ITEMS.                                         12120028
121300     MOVE +1                       TO ASC-BLK-SUB.                12130028
121400                                                                  12140028
121500     PERFORM 2141-CLEAR-SELECTED-INDS                             12150028
121600         VARYING ASC-ITEM-SUB                                     12160028
121700         FROM 1 BY 1                                              12170028
121800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12180028
121900                                                                  12190028
122000     ADD +1                        TO ASC-BLK-SUB.                12200028
122100                                                                  12210028
122200     PERFORM 2141-CLEAR-SELECTED-INDS                             12220028
122300         VARYING ASC-ITEM-SUB                                     12230028
122400         FROM 1 BY 1                                              12240028
122500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12250028
122600                                                                  12260028
122700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               12270028
122800                                   TO PV-LIST-ITEM-NUMBER.        12280028
122900                                                                  12290028
123000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            12300028
123100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    12310028
123200                                                                  12320028
123300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     12330028
123400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      12340028
123500         MOVE +1                   TO ASC-BLK-SUB                 12350028
123600                                                                  12360028
123700         PERFORM 5100-WRITE-TEMP-STORAGE                          12370028
123800                                                                  12380028
123900         MOVE +1                   TO PV-BLOCK-NUMBER             12390028
124000                                                                  12400028
124100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         12410028
124200             PV-FIRST-BLOCK-IN-ARRAY - 1                          12420028
124300                                                                  12430028
124400         PERFORM                                                  12440028
124500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       12450028
124600                                                                  12460028
124700             PERFORM 4410-READ-TEMP-STORAGE                       12470028
124800                                                                  12480028
124900             PERFORM 2141-CLEAR-SELECTED-INDS                     12490028
125000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 12500028
125100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12510028
125200                                                                  12520028
125300             PERFORM 5100-WRITE-TEMP-STORAGE                      12530028
125400                                                                  12540028
125500             ADD +1                TO PV-BLOCK-NUMBER             12550028
125600                                                                  12560028
125700         END-PERFORM                                              12570028
125800                                                                  12580028
125900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         12590028
126000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     12600028
126100                                                                  12610028
126200         PERFORM                                                  12620028
126300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       12630028
126400                   ASC-HIGHEST-BLOCK-WRITTEN                      12640028
126500                                                                  12650028
126600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          12660028
126700                                   TO PV-BLOCK-NUMBER             12670028
126800                                                                  12680028
126900             PERFORM 4410-READ-TEMP-STORAGE                       12690028
127000                                                                  12700028
127100             PERFORM 2141-CLEAR-SELECTED-INDS                     12710028
127200                 VARYING ASC-ITEM-SUB                             12720028
127300                 FROM 1 BY 1                                      12730028
127400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          12740028
127500                                                                  12750028
127600             PERFORM 5100-WRITE-TEMP-STORAGE                      12760028
127700                                                                  12770028
127800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      12780028
127900                                                                  12790028
128000         END-PERFORM                                              12800028
128100                                                                  12810028
128200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             12820028
128300                                   TO PV-BLOCK-NUMBER             12830028
128400                                                                  12840028
128500         PERFORM 4410-READ-TEMP-STORAGE                           12850028
128600     END-IF.                                                      12860028
128700                                                                  12870028
128800                                                                  12880028
128900     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 12890028
129000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.12900028
129100     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  12910028
129200                                                                  12920028
129300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        12930028
129400                                                                  12940028
129500 EJECT                                                            12950028
129600*----------------------------------------------------------------*12960028
129700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *12970028
129800*----------------------------------------------------------------*12980028
129900                                                                  12990028
130000 2141-CLEAR-SELECTED-INDS.                                        13000028
130100                                                                  13010028
130200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13020028
130300             NOT EQUAL ZERO                                       13030028
130400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13040028
130500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13050028
130600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13060028
130700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13070028
130800                                   TO TRUE                        13080028
130900         END-IF                                                   13090028
131000     END-IF.                                                      13100028
131100                                                                  13110028
131200 EJECT                                                            13120028
131300*----------------------------------------------------------------*13130028
131400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13140028
131500*  FOR ALL ITEMS.                                                *13150028
131600*----------------------------------------------------------------*13160028
131700                                                                  13170028
131800 2150-SELECT-ALL-ITEMS.                                           13180028
131900                                                                  13190028
132000     MOVE +1                       TO ASC-BLK-SUB.                13200028
132100                                                                  13210028
132200     PERFORM 2151-SET-SELECTED-INDS                               13220028
132300         VARYING ASC-ITEM-SUB                                     13230028
132400         FROM 1 BY 1                                              13240028
132500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13250028
132600                                                                  13260028
132700     ADD +1                        TO ASC-BLK-SUB.                13270028
132800                                                                  13280028
132900     PERFORM 2151-SET-SELECTED-INDS                               13290028
133000         VARYING ASC-ITEM-SUB                                     13300028
133100         FROM 1 BY 1                                              13310028
133200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13320028
133300                                                                  13330028
133400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13340028
133500                                   TO PV-LIST-ITEM-NUMBER.        13350028
133600                                                                  13360028
133700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13370028
133800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13380028
133900                                                                  13390028
134000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13400028
134100        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    13410028
134200         MOVE +1                   TO ASC-BLK-SUB                 13420028
134300                                                                  13430028
134400         PERFORM 5100-WRITE-TEMP-STORAGE                          13440028
134500                                                                  13450028
134600         MOVE +1                   TO PV-BLOCK-NUMBER             13460028
134700                                                                  13470028
134800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13480028
134900             PV-FIRST-BLOCK-IN-ARRAY - 1                          13490028
135000                                                                  13500028
135100         PERFORM                                                  13510028
135200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13520028
135300                                                                  13530028
135400             PERFORM 4410-READ-TEMP-STORAGE                       13540028
135500                                                                  13550028
135600             PERFORM 2151-SET-SELECTED-INDS                       13560028
135700                 VARYING ASC-ITEM-SUB                             13570028
135800                 FROM 1 BY 1                                      13580028
135900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13590028
136000                                                                  13600028
136100             PERFORM 5100-WRITE-TEMP-STORAGE                      13610028
136200                                                                  13620028
136300             ADD +1                TO PV-BLOCK-NUMBER             13630028
136400                                                                  13640028
136500         END-PERFORM                                              13650028
136600                                                                  13660028
136700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13670028
136800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13680028
136900                                                                  13690028
137000         PERFORM                                                  13700028
137100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13710028
137200                   ASC-HIGHEST-BLOCK-WRITTEN                      13720028
137300                                                                  13730028
137400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13740028
137500                                   TO PV-BLOCK-NUMBER             13750028
137600                                                                  13760028
137700             PERFORM 4410-READ-TEMP-STORAGE                       13770028
137800                                                                  13780028
137900             PERFORM 2151-SET-SELECTED-INDS                       13790028
138000                 VARYING ASC-ITEM-SUB                             13800028
138100                 FROM 1 BY 1                                      13810028
138200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13820028
138300                                                                  13830028
138400             PERFORM 5100-WRITE-TEMP-STORAGE                      13840028
138500                                                                  13850028
138600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13860028
138700                                                                  13870028
138800         END-PERFORM                                              13880028
138900                                                                  13890028
139000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13900028
139100                                   TO PV-BLOCK-NUMBER             13910028
139200                                                                  13920028
139300         PERFORM 4410-READ-TEMP-STORAGE                           13930028
139400     END-IF.                                                      13940028
139500                                                                  13950028
139600                                                                  13960028
139700     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             13970028
139800                       ASC-NUMBER-OF-SELECTED-ITEMS.              13980028
139900                                                                  13990028
140000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14000028
140100                                                                  14010028
140200 EJECT                                                            14020028
140300*----------------------------------------------------------------*14030028
140400*    MARK EACH ITEM AS BEING SELECTED.                           *14040028
140500*----------------------------------------------------------------*14050028
140600                                                                  14060028
140700 2151-SET-SELECTED-INDS.                                          14070028
140800                                                                  14080028
140900     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14090028
141000             NOT EQUAL ZERO                                       14100028
141100         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14110028
141200             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14120028
141300                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14130028
141400                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14140028
141500                               TO  TRUE                           14150028
141600         END-IF                                                   14160028
141700     END-IF.                                                      14170028
141800******************************************************************14180028
141900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **14190028
142000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **14200028
142100******************************************************************14210028
142200 2200-MOVE-SCREEN-TO-COMMAREA.                                    14220028
142300                                                                  14230028
142400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             14240028
142500     MOVE +1                       TO PV-SUB.                     14250028
142600*                                                                 14260028
142700     PERFORM 3100-SET-SUBSCRIPTS.                                 14270028
142800     IF  ASTRTITL > ZERO                                          14280028
142900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          14290028
143000     ELSE                                                         14300028
143100         IF  ASTRTITF = DP015-ERASE-EOF                           14310028
143200             INITIALIZE ASC-START-ITEM-REQUEST                    14320028
143300         END-IF                                                   14330028
143400     END-IF.                                                      14340028
143500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          14350028
143600         VARYING PV-SUB                                           14360028
143700         FROM 1 BY 1                                              14370028
143800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      14380028
143900******************************************************************14390028
144000** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**14400028
144100******************************************************************14410028
144200 2210-MOVE-LINES-TO-COMMAREA.                                     14420028
144300     IF  MR-SELECTL (PV-SUB) > ZERO                               14430028
144400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             14440028
144500         MOVE MR-SELECTI (PV-SUB)                                 14450028
144600                                   TO ASC-TEMP-SELECTED-SW        14460028
144700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14470028
144800     ELSE                                                         14480028
144900         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                14490028
145000                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     14500028
145100                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        14510028
145200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      14520028
145300         END-IF                                                   14530028
145400     END-IF.                                                      14540028
145500     ADD +1                        TO ASC-ITEM-SUB.               14550028
145600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        14560028
145700         ADD +1                    TO ASC-BLK-SUB                 14570028
145800         MOVE +1                   TO ASC-ITEM-SUB                14580028
145900     END-IF.                                                      14590028
146000                                                                  14600028
146100******************************************************************14610028
146200*  WMS MODULE PROCESS                                             14620028
146300******************************************************************14630028
146400 2400-WMS-MODULE-PROCESS.                                         14640028
146401                                                                  14640128
146402     PERFORM 2450-CHECK-TKRPRPM                                   14640228
146403       IF PS-ASNS-TO-WMS-YES                                      14640328
146404          PERFORM 2500-TRANSCRIBED-RECIEVERS                      14640428
146405          IF PS-ASNS-TO-WMS-YES                                   14640528
146406             SET WS001-INSERT    TO TRUE                          14640628
146407             PERFORM 2800-CALL-WMS-MODULE                         14640728
146408             MOVE PC-TSYMSG-03533                                 14640828
146409                                 TO DP020-MSG-NUMBER              14640928
146410             SET DP020-MSG-WARNING                                14641028
146411                                 TO TRUE                          14641128
146412           ELSE                                                   14641228
146413             MOVE PC-TSYMSG-03534                                 14641328
146414                                 TO DP020-MSG-NUMBER              14641428
146415             SET DP020-MSG-WARNING                                14641528
146416                                 TO TRUE                          14641628
146417          END-IF                                                  14641728
146418     END-IF.                                                      14641828
146419                                                                  14641928
146420******************************************************************14642028
146430*  CHECK PARM TABLE TO SEE IF DC IS TURNED ON TO DOWNLOAD ASN'S   14643028
146431*  TO WMS.                                                        14643128
146432******************************************************************14643228
146433 2450-CHECK-TKRPRPM.                                              14643328
146434                                                                  14643428
146435     EXEC SQL                                                     14643528
146436          SELECT   FUNC_TXT                                       14643628
146437            INTO  :KRPRPM-FUNC-TXT                                14643728
146438            FROM                                                  14643828
146439                  TKRPRPM A                                       14643928
146440            WHERE                                                 14644028
146450                  LOC_ID            = :ASC-KEY-OPER-UNT-ID        14645028
146460              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    14646028
146470              AND FUNC_PRC_STAT_CDE = 'AC'                        14647028
146480              AND INTFC_SYS_CDE     = 'KHL'                       14648028
146490              AND FUNC_TXT          = 'Y'                         14649028
146491              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            14649128
146492     END-EXEC.                                                    14649228
146493                                                                  14649328
146494     EVALUATE TRUE                                                14649428
146495         WHEN SQLCODE = ZERO                                      14649528
146496              SET PS-ASNS-TO-WMS-YES    TO TRUE                   14649628
146497         WHEN SQLCODE = +100                                      14649728
146498              SET PS-ASNS-TO-WMS-NO  TO TRUE                      14649828
146499         WHEN SQLWARN0 NOT = SPACES                               14649928
146500         WHEN SQLCODE  NOT = ZERO                                 14650028
146501             MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)      14650128
146502             SET DP013-DB2-ABEND                                  14650228
146503                                 TO TRUE                          14650328
146504             SET DP013-XCTL-DISPLAY-RESTART                       14650428
146505                                 TO TRUE                          14650528
146506             PERFORM DP013-0000-PROCESS-ABEND                     14650628
146507     END-EVALUATE.                                                14650728
146508                                                                  14650828
146509******************************************************************14650928
146510*  CHECK AT COMPLETION OF ATTACHING THE SHIPMENT TO THE TRAILER   14651028
146511*  IF THERE ARE TRANSCRIBED RECEIVERS ON THE SHIPMENT.            14651128
146512******************************************************************14651228
146513 2500-TRANSCRIBED-RECIEVERS.                                      14651328
146514                                                                  14651428
146515     INITIALIZE        PV-DB2-COUNT-REC-TRLR.                     14651528
146516                                                                  14651628
146517     EXEC SQL                                                     14651728
146518          SELECT  COUNT(*)                                        14651828
146519            INTO  :PV-DB2-COUNT-REC-TRLR                          14651928
146520            FROM  TSHIPMT A                                       14652028
146521                 ,TSHPTPO B                                       14652128
146522                 ,TPKSLIP C                                       14652228
146523            WHERE A.TRIP_ID         = :DK-TRIP-ID                 14652328
146524              AND A.SHIPT_ID        = :DK-SHIPT-ID                14652428
146525              AND A.SHIPT_ID        = B.SHIPT_ID                  14652528
146526              AND B.PO_NBR          = C.PO_NBR                    14652628
146527              AND C.VER_STAT_CDE    = 'A'                         14652728
146528              AND C.PKSL_STAT_CDE   = 'AC'                        14652828
146529     END-EXEC.                                                    14652928
146530                                                                  14653028
146531     EVALUATE TRUE                                                14653128
146532         WHEN SQLCODE = ZERO                                      14653228
146533              IF PV-DB2-COUNT-REC-TRLR > 0                        14653328
146534                  SET PS-ASNS-TO-WMS-YES    TO TRUE               14653428
146535              ELSE                                                14653528
146536                  SET PS-ASNS-TO-WMS-NO  TO TRUE                  14653628
146537              END-IF                                              14653728
146538         WHEN SQLCODE = +100                                      14653828
146539              SET PS-ASNS-TO-WMS-NO  TO TRUE                      14653928
146540         WHEN SQLWARN0 NOT = SPACES                               14654028
146541         WHEN SQLCODE  NOT = ZERO                                 14654128
146542             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (1)      14654228
146543             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (2)      14654328
146544             SET DP013-DB2-ABEND                                  14654428
146545                                 TO TRUE                          14654528
146546             SET DP013-XCTL-DISPLAY-RESTART                       14654628
146547                                 TO TRUE                          14654728
146548             PERFORM DP013-0000-PROCESS-ABEND                     14654828
146549     END-EVALUATE.                                                14654928
146550                                                                  14655028
146551*----------------------------------------------------------------*14655128
146552* CALL TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKCS305) USING     14655228
146553*  COPYBOOK WSWS001.                                              14655328
146554*----------------------------------------------------------------*14655428
146555 2800-CALL-WMS-MODULE.                                            14655528
146556                                                                  14655628
146557     MOVE SHIPMT-TRIP-ID       TO WS001-TRIP-ID.                  14655728
146558     MOVE SHIPMT-SHIPT-ID      TO WS001-KOHLS-SHIPT-ID.           14655828
146559     MOVE ASC-KEY-OPER-UNT-ID  TO WS001-OPER-UNT-ID.              14655928
146560     MOVE DP020-USERID         TO WS001-USER-ID.                  14656028
146561     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         14656128
146562     MOVE ZEROS                TO WS001-PO-NBR.                   14656228
146563     MOVE ZEROS                TO WS001-RCVR-NBR.                 14656328
146564     MOVE ZEROS                TO WS001-PO-LNE-NBR.               14656428
146565     MOVE ZEROS                TO WS001-PREPK-ID.                 14656528
146566     MOVE ZEROS                TO WS001-SKU-NBR.                  14656628
146567     MOVE ZEROS                TO WS001-DTL-ASN-LEVEL-IND.        14656728
146568     MOVE 'TRKCS120'           TO WS001-CALLING-PROGRAM-NAME.     14656828
146569                                                                  14656928
146570     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         14657028
146580                                                                  14658028
146581     EXEC CICS                                                    14658128
146582         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       14658228
146583              COMMAREA (WS001-FIELDS)                             14658328
146584              LENGTH   (PV-COMMAREA-LENGTH)                       14658428
146585     END-EXEC.                                                    14658528
146586     EVALUATE TRUE                                                14658628
146587         WHEN WS001-SUCCESSFUL                                    14658728
146588              CONTINUE                                            14658828
146589         WHEN WS001-DATABASE-BUSY                                 14658928
146590         WHEN WS001-INVALID-SQL                                   14659028
146591              MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER           14659128
146592              SET DP020-MSG-FATAL   TO TRUE                       14659228
146593              SET DP030-OVERRIDE-GO TO TRUE                       14659328
146594              SET PS-ERROR          TO TRUE                       14659428
146595                                                                  14659528
146596              INITIALIZE PV-CICS-MSG-AREA                         14659628
146597              STRING 'TRKCS120-'                                  14659728
146598                     '2800-CALL-WMS-MODULE - '                    14659828
146599                                           DELIMITED BY SIZE      14659928
146600                                      INTO PV-CICS-MSG-AREA       14660028
146601              PERFORM 9903-WRITE-CICS-LOG                         14660128
146602                                                                  14660228
146603              INITIALIZE PV-CICS-MSG-AREA                         14660328
146604              STRING 'TRKCS120-'                                  14660428
146605                     WS001-CRA-RET-MSG                            14660528
146606                                           DELIMITED BY SIZE      14660628
146607                                      INTO PV-CICS-MSG-AREA       14660728
146608              PERFORM 9903-WRITE-CICS-LOG                         14660828
146609                                                                  14660928
146610                                                                  14661028
146611         WHEN OTHER                                               14661128
146612              MOVE PC-TSYMSG-03548  TO DP020-MSG-NUMBER           14661228
146613              SET DP020-MSG-FATAL   TO TRUE                       14661328
146614              SET DP030-OVERRIDE-GO TO TRUE                       14661428
146615              SET PS-ERROR          TO TRUE                       14661528
146616                                                                  14661628
146617              INITIALIZE PV-CICS-MSG-AREA                         14661728
146618              STRING 'TRKCS120-'                                  14661828
146619                     '2800-CALL-WMS-MODULE - '                    14661928
146620                                           DELIMITED BY SIZE      14662028
146621                                      INTO PV-CICS-MSG-AREA       14662128
146622              PERFORM 9903-WRITE-CICS-LOG                         14662228
146623                                                                  14662328
146624              INITIALIZE PV-CICS-MSG-AREA                         14662428
146625              STRING 'TRKCS120-'                                  14662528
146626                     WS001-CRA-RET-MSG                            14662628
146627                                           DELIMITED BY SIZE      14662728
146628                                      INTO PV-CICS-MSG-AREA       14662828
146629              PERFORM 9903-WRITE-CICS-LOG                         14662928
146630                                                                  14663028
146640             MOVE '2300-CALL-WMS-MODULE' TO DP013-PARAGRAPH       14664028
146650             MOVE 'UNSUCCESSFUL CALL TO WMS MOD'                  14665028
146651                                         TO DP013-MESSAGE-TEXT (1)14665128
146652             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)14665228
146653             SET DP013-DB2-ABEND                                  14665328
146654                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              14665428
146655             SET PS-ERROR                    TO TRUE              14665528
146656             PERFORM DP013-0000-PROCESS-ABEND                     14665628
146657                                                                  14665728
146658     END-EVALUATE.                                                14665828
146659/                                                                 14665928
146660******************************************************************14666028
146670** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **14667028
146680** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **14668028
146690******************************************************************14669028
146700 3000-EDIT-DATA-IN-COMMAREA.                                      14670028
146800     SET PS-NO-ERROR               TO TRUE.                       14680028
146900     PERFORM 3200-RESET-ATTRIBUTES.                               14690028
147000     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     14700028
147100**                                                                14710028
147200* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              14720028
147300* EDITTING IS DONE FROM THE BOTTOM UP.                            14730028
147400**                                                                14740028
147500     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       14750028
147600         ASC-ITEMS-DISPLAYED - 1.                                 14760028
147700     PERFORM 3100-SET-SUBSCRIPTS.                                 14770028
147800     PERFORM 3300-EDIT-SELECTIONS                                 14780028
147900         VARYING PV-SUB                                           14790028
148000         FROM PV-SUB BY -1                                        14800028
148100         UNTIL PV-SUB < +1                                        14810028
148200*                                                                 14820028
148300     IF  PS-NO-ERROR                                              14830028
148400         PERFORM 3400-CHECK-RANGE-SEQUENCE                        14840028
148500     END-IF.                                                      14850028
148600*                                                                 14860028
148700     IF  ((PS-NO-ERROR)                                           14870028
148800       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   14880028
148900       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    14890028
149000             PERFORM 3500-MARK-RANGE-AS-SELECTED                  14900028
149100     END-IF.                                                      14910028
149200 EJECT                                                            14920028
149300*----------------------------------------------------------------*14930028
149400*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *14940028
149500*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*14950028
149600*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *14960028
149700*                                                                *14970028
149800*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *14980028
149900*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *14990028
150000*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15000028
150100*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15010028
150200*----------------------------------------------------------------*15020028
150300                                                                  15030028
150400 3100-SET-SUBSCRIPTS.                                             15040028
150500                                                                  15050028
150600     COMPUTE ASC-ITEM-SUB =                                       15060028
150700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15070028
150800                                                                  15080028
150900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15090028
151000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15100028
151100                                                                  15110028
151200         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               15120028
151300     ELSE                                                         15130028
151400         MOVE +1                     TO ASC-BLK-SUB               15140028
151500     END-IF.                                                      15150028
151600******************************************************************15160028
151700** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **15170028
151800******************************************************************15180028
151900                                                                  15190028
152000 3200-RESET-ATTRIBUTES.                                           15200028
152100     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   15210028
152200     MOVE DP015-GREEN              TO ASTRTITC.                   15220028
152300     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15230028
152400*                                                                 15240028
152500     PERFORM                                                      15250028
152600         VARYING PV-SUB                                           15260028
152700         FROM 1 BY 1                                              15270028
152800         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        15280028
152900         MOVE DP015-UNP-ALP-NOR-OFF                               15290028
153000                                   TO MR-SELECTA (PV-SUB)         15300028
153100         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         15310028
153110                                      MR-DELIVERY-SCACC(PV-SUB)   15311099
153120                                      MR-OPERC(PV-SUB)            15312099
153200         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         15320028
153210         MOVE DP015-BLUE           TO MR-OPERC   (PV-SUB)         15321049
153220         MOVE DP015-HL-OFF         TO MR-OPERH   (PV-SUB)         15322050
153230                                      MR-DELIVERY-SCACH(PV-SUB)   15323099
153240                                      MR-OPERH(PV-SUB)            15324099
153300     END-PERFORM.                                                 15330028
153400******************************************************************15340028
153500** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **15350028
153600** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **15360028
153700** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **15370028
153800** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **15380028
153900******************************************************************15390028
154000 3300-EDIT-SELECTIONS.                                            15400028
154100     EVALUATE TRUE                                                15410028
154200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     15420028
154300             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         15430028
154400                 CONTINUE                                         15440028
154500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         15450028
154600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        15460028
154700                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   15470028
154800                 MOVE ASC-TEMP-SELECTED-SW                        15480028
154900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15490028
155000                                TO ASC-SELECTED-SW                15500028
155100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15510028
155200             END-IF                                               15520028
155300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     15530028
155400                 = SPACE                                          15540028
155500             EVALUATE TRUE                                        15550028
155600                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       15560028
155700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS15570028
155800                     MOVE SPACE TO ASC-SELECTED-SW                15580028
155900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15590028
156000                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        15600028
156100                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    15610028
156200                     MOVE SPACE TO ASC-SELECTED-SW                15620028
156300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15630028
156400                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          15640028
156500                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      15650028
156600                     MOVE SPACE TO ASC-SELECTED-SW                15660028
156700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  15670028
156800             END-EVALUATE                                         15680028
156900         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           15690028
157000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15700028
157100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    15710028
157200             END-IF                                               15720028
157300             PERFORM 3310-EDIT-RANGE                              15730028
157400         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             15740028
157500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15750028
157600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    15760028
157700             END-IF                                               15770028
157800             PERFORM 3310-EDIT-RANGE                              15780028
157900         WHEN OTHER                                               15790028
158000             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           15800028
158100             SET DP020-MSG-FATAL    TO TRUE                       15810028
158200             MOVE -1                TO MR-SELECTL (PV-SUB)        15820028
158300             SET DP030-SET-CURSOR-APPL-1                          15830028
158400                                    TO TRUE                       15840028
158500             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        15850028
158600             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        15860028
158700             SET PS-ERROR TO TRUE                                 15870028
158800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            15880028
158900                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     15890028
159000                 MOVE SPACE         TO ASC-SELECTED-SW            15900028
159100                                        (ASC-BLK-SUB ASC-ITEM-SUB)15910028
159200             END-IF                                               15920028
159300     END-EVALUATE.                                                15930028
159400                                                                  15940028
159500* DMH - 10/26/18 BEGIN                                            15950089
159501** F17-INCLUDE SHIPMENT -                                         15950189
159502*    IF  DP020-FK-LOCAL-RETURN(DP020-SRC-AID)                     15950299
159503*        IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                 15950399
159504*           PERFORM 3305-CHECK-TRANSCRIBED                        15950499
159505*        END-IF                                                   15950599
159506*    END-IF                                                       15950699
159507*                                                                 15950799
159508                                                                  15950889
159509* DMH - 10/26/18 END                                              15950989
159510                                                                  15951089
159520     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 15952028
159600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               15960028
159700     IF  ASC-ITEM-SUB < 1                                         15970028
159800         SUBTRACT +1 FROM ASC-BLK-SUB                             15980028
159900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                15990028
160000     END-IF.                                                      16000028
160001                                                                  16000189
160002                                                                  16000289
160003******************************************************************16000389
160004*CHECK TO MAKE SURE THAT ALL RECEIVERS ON SHIPMENT ARE TRANSCRIB *16000489
160005* DMH - 10/26/18                                                 *16000589
160007******************************************************************16000789
160010*3305-CHECK-TRANSCRIBED.                                          16001099
160011*                                                                 16001199
160012*    MOVE ASC-FB-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)                  16001299
160013*                              TO  PV-TRANS-SCAC.                 16001399
160014*    MOVE ASC-FREIGHT-BILL (ASC-BLK-SUB ASC-ITEM-SUB)             16001499
160015*                              TO  PV-TRANS-PRO.                  16001599
160016*    MOVE ASC-BILL-OF-LADING (ASC-BLK-SUB ASC-ITEM-SUB)           16001699
160017*                              TO  PV-TRANS-BOL.                  16001799
160020*                                                                 16002099
160021*    EXEC SQL                                                     16002199
160022*         SELECT T1.PO_NBR                                        16002299
160023*              , T1.REC_SEQ_NBR                                   16002399
160024*              , TRECITM_COUNT                                    16002499
160025*                                                                 16002599
160026*           INTO :PV-PO-HOLD                                      16002699
160027*              , :PV-RCVR-HOLD                                    16002799
160028*              , :PV-TRANSCRIBE-COUNT                             16002899
160029*           FROM                                                  16002999
160030*               (SELECT B.PO_NBR                                  16003099
160031*                     , B.REC_SEQ_NBR                             16003199
160032*                  FROM TSHIPMT A                                 16003299
160033*                     , TSHPTPO B                                 16003399
160034*                 WHERE A.PRO_SCAC_ID = :PV-TRANS-SCAC            16003499
160035*                   AND A.PRO_NBR     = :PV-TRANS-PRO             16003599
160036*                   AND A.BOL_NBR     = :PV-TRANS-BOL             16003699
160037*                   AND A.SHIPT_ID    =  B.SHIPT_ID               16003799
160038*               ) AS T1                                           16003899
160039*                 LEFT OUTER JOIN                                 16003999
160040*               (SELECT D.PO_NBR                                  16004099
160041*                     , D.REC_SEQ_NBR                             16004199
160042*                     , COUNT(F.ORD_LNE_NBR) AS TRECITM_COUNT     16004299
160043*                  FROM TSHIPMT C                                 16004399
160044*                     , TSHPTPO D                                 16004499
160045*                     , TRECEIV E                                 16004599
160046*                     , TRECITM F                                 16004699
160047*                 WHERE C.PRO_SCAC_ID = :PV-TRANS-SCAC            16004799
160048*                   AND C.PRO_NBR     = :PV-TRANS-PRO             16004899
160049*                   AND C.BOL_NBR     = :PV-TRANS-BOL             16004999
160050*                   AND C.SHIPT_ID    =  D.SHIPT_ID               16005099
160051*                   AND D.PO_NBR    = E.ORD_NBR                   16005199
160052*                   AND D.REC_SEQ_NBR  =  E.REC_SEQ_NBR           16005299
160053*                   AND E.ORD_NBR      = F.ORD_NBR                16005399
160054*                   AND E.REC_SEQ_NBR  = F.REC_SEQ_NBR            16005499
160055*                 GROUP BY D.PO_NBR                               16005599
160056*                     , D.REC_SEQ_NBR                             16005699
160057*               ) AS T2                                           16005799
160058*                 ON T1.PO_NBR  =  T2.PO_NBR    AND               16005899
160059*                    T1.REC_SEQ_NBR =  T2.REC_SEQ_NBR             16005999
160095*         ORDER BY 3 DESC                                         16009599
160096*         FETCH FIRST 1 ROW ONLY                                  16009699
160097*          WITH UR                                                16009799
160098*    END-EXEC.                                                    16009899
160099*                                                                 16009999
160100*    EVALUATE TRUE                                                16010099
160101*        WHEN SQLCODE = ZERO                                      16010199
160102*        WHEN SQLCODE = -811                                      16010299
160103*            CONTINUE                                             16010399
160104*        WHEN SQLCODE = +100                                      16010499
160105*        WHEN SQLCODE = -305                                      16010599
160106*            SET DP013-ROLLBACK    TO TRUE                        16010699
160107*            MOVE PC-TSYMSG-02636  TO DP020-MSG-NUMBER            16010799
160108*            MOVE -1               TO ASTRTITL                    16010899
160109*            SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16010999
160110*            MOVE DP015-REVERSE    TO ASTRTITH                    16011099
160111*            MOVE DP015-RED        TO ASTRTITC                    16011199
160112*            MOVE DP015-UNP-NUM-BRT-MDT                           16011299
160113*                                  TO ASTRTITA                    16011399
160114*            SET DP020-MSG-FATAL   TO TRUE                        16011499
160115*            SET PS-ERROR          TO TRUE                        16011599
160116*        WHEN SQLWARN0 NOT = SPACES                               16011699
160117*        WHEN SQLCODE  NOT = ZERO                                 16011799
160118*            MOVE SQLCODE            TO PV-DISP-SQLCODE           16011899
160121*            MOVE '3305-CHECK-TRANSCRIBED  '                      16012199
160122*                                TO DP013-PARAGRAPH               16012299
160123*            MOVE 'CHECK RCVRS ON SHPMT ARE TRANSCRIBED'          16012399
160124*                                TO DP013-MESSAGE-TEXT (1)        16012499
160125*            STRING PV-TRANS-SCAC '-'                             16012599
160126*                   PV-TRANS-PRO  '-'                             16012699
160127*                   PV-TRANS-BOL  '  -SQLCODE:'                   16012799
160130*                   PV-DISP-SQLCODE DELIMITED BY SIZE             16013099
160131*                              INTO DP013-MESSAGE-TEXT(2)         16013199
160132*            MOVE 'TSHIPMT     ' TO DP013-DB2-TABLE-NAME (1)      16013299
160133*            MOVE 'TSHPTPO     ' TO DP013-DB2-TABLE-NAME (2)      16013399
160134*            MOVE 'TRECEIV     ' TO DP013-DB2-TABLE-NAME (3)      16013499
160135*            MOVE 'TRECITM     ' TO DP013-DB2-TABLE-NAME (4)      16013599
160136*            SET DP013-DB2-ABEND                                  16013699
160137*                                TO TRUE                          16013799
160138*            SET DP013-XCTL-DISPLAY-RESTART                       16013899
160139*                                TO TRUE                          16013999
160140*            PERFORM DP013-0000-PROCESS-ABEND                     16014099
160141*    END-EVALUATE.                                                16014199
160144                                                                  16014489
160145                                                                  16014589
160150******************************************************************16015089
160200** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **16020028
160300** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **16030028
160400** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**16040028
160500** THE ENDING.                                                  **16050028
160600******************************************************************16060028
160700 3310-EDIT-RANGE.                                                 16070028
160800     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                16080028
160900         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   16090028
161000             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)16100028
161100                                   TO ASC-SELECTED-SW             16110028
161200                                        (ASC-BLK-SUB ASC-ITEM-SUB)16120028
161300             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 16130028
161400         ELSE                                                     16140028
161500             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     16150028
161600                 CONTINUE                                         16160028
161700             ELSE                                                 16170028
161800*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        16180028
161900                 MOVE PC-TSYMSG-00054                             16190028
162000                                   TO DP020-MSG-NUMBER            16200028
162100                 SET DP020-MSG-FATAL                              16210028
162200                                   TO TRUE                        16220028
162300                 MOVE -1           TO MR-SELECTL (PV-SUB)         16230028
162400                 SET DP030-SET-CURSOR-APPL-1                      16240028
162500                                   TO TRUE                        16250028
162600                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         16260028
162700                 MOVE DP015-UNDERLINE                             16270028
162800                                   TO MR-SELECTH (PV-SUB)         16280028
162900                 SET PS-ERROR      TO TRUE                        16290028
163000             END-IF                                               16300028
163100         END-IF                                                   16310028
163200     ELSE                                                         16320028
163300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     16330028
163400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 16340028
163500                                   TO ASC-SELECTED-SW             16350028
163600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   16360028
163700             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   16370028
163800         ELSE                                                     16380028
163900             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       16390028
164000                 CONTINUE                                         16400028
164100             ELSE                                                 16410028
164200*                -- ONLY ONE END-OF-RANGE ALLOWED --              16420028
164300                 MOVE PC-TSYMSG-00055                             16430028
164400                                   TO DP020-MSG-NUMBER            16440028
164500                 SET DP020-MSG-FATAL                              16450028
164600                                   TO TRUE                        16460028
164700                 MOVE -1           TO MR-SELECTL (PV-SUB)         16470028
164800                 SET DP030-SET-CURSOR-APPL-1                      16480028
164900                                   TO TRUE                        16490028
165000                 SET PS-ERROR      TO TRUE                        16500028
165100             END-IF                                               16510028
165200         END-IF                                                   16520028
165300     END-IF.                                                      16530028
165400*                                                                 16540028
165500******************************************************************16550028
165600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **16560028
165700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **16570028
165800******************************************************************16580028
165900 3400-CHECK-RANGE-SEQUENCE.                                       16590028
166000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       16600028
166100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      16610028
166200       AND  ASC-START-OF-SELECTED-RANGE >                         16620028
166300                                         ASC-END-OF-SELECTED-RANGE16630028
166400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                16640028
166500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 16650028
166600         SET DP020-MSG-FATAL TO TRUE                              16660028
166700         SET PS-ERROR TO TRUE                                     16670028
166800         PERFORM 3410-POSITION-AT-ERROR                           16680028
166900     END-IF.                                                      16690028
167000******************************************************************16700028
167100** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **16710028
167200** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **16720028
167300** SHOULD BE POSITIONED ON A RANGE ERROR.                       **16730028
167400******************************************************************16740028
167500 3410-POSITION-AT-ERROR.                                          16750028
167600     SET DP030-SET-CURSOR-APPL-1                                  16760028
167700                                   TO TRUE.                       16770028
167800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 16780028
167900                    - PV-TOP-ITEM + 1.                            16790028
168000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16800028
168100         CONTINUE                                                 16810028
168200     ELSE                                                         16820028
168300         MOVE -1                   TO MR-SELECTL (PV-SUB)         16830028
168400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         16840028
168500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         16850028
168600     END-IF.                                                      16860028
168700*                                                                 16870028
168800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   16880028
168900                    - PV-TOP-ITEM + 1.                            16890028
169000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      16900028
169100         CONTINUE                                                 16910028
169200     ELSE                                                         16920028
169300         MOVE -1                   TO MR-SELECTL (PV-SUB)         16930028
169400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         16940028
169500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         16950028
169600     END-IF.                                                      16960028
169700 EJECT                                                            16970028
169800*----------------------------------------------------------------*16980028
169900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *16990028
170000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *17000028
170100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *17010028
170200*----------------------------------------------------------------*17020028
170300                                                                  17030028
170400 3500-MARK-RANGE-AS-SELECTED.                                     17040028
170500     MOVE +1                       TO  ASC-BLK-SUB.               17050028
170600     PERFORM 3510-MARK-SELECTED-INDS                              17060028
170700         VARYING ASC-ITEM-SUB                                     17070028
170800         FROM 1 BY 1                                              17080028
170900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17090028
171000                                                                  17100028
171100     ADD +1                        TO ASC-BLK-SUB.                17110028
171200     PERFORM 3510-MARK-SELECTED-INDS                              17120028
171300         VARYING ASC-ITEM-SUB                                     17130028
171400         FROM 1 BY 1                                              17140028
171500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17150028
171600                                                                  17160028
171700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17170028
171800                                   TO  PV-LIST-ITEM-NUMBER.       17180028
171900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17190028
172000         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17200028
172100               PC-ITEMS-PER-PANEL).                               17210028
172200                                                                  17220028
172300     MOVE ASC-START-OF-SELECTED-RANGE                             17230028
172400                                   TO PV-START-OF-SELECTED-RANGE. 17240028
172500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17250028
172600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17260028
172700               PC-ITEMS-PER-PANEL).                               17270028
172800                                                                  17280028
172900     MOVE ASC-END-OF-SELECTED-RANGE                               17290028
173000                                   TO  PV-END-OF-SELECTED-RANGE.  17300028
173100     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17310028
173200         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17320028
173300               PC-ITEMS-PER-PANEL).                               17330028
173400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17340028
173500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17350028
173600                                                                  17360028
173700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    17370028
173800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        17380028
173900         MOVE +1                   TO ASC-BLK-SUB                 17390028
174000         PERFORM 5100-WRITE-TEMP-STORAGE                          17400028
174100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17410028
174200             PV-FIRST-BLOCK-IN-ARRAY - 1                          17420028
174300                                                                  17430028
174400         PERFORM                                                  17440028
174500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      17450028
174600                   PV-PREV-BLOCK-IN-ARRAY                         17460028
174700             MOVE PV-FIRST-BLOCK-IN-RANGE                         17470028
174800                                   TO PV-BLOCK-NUMBER             17480028
174900             PERFORM 4410-READ-TEMP-STORAGE                       17490028
175000             PERFORM 3510-MARK-SELECTED-INDS                      17500028
175100                 VARYING ASC-ITEM-SUB                             17510028
175200                 FROM 1 BY 1                                      17520028
175300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17530028
175400             PERFORM 5100-WRITE-TEMP-STORAGE                      17540028
175500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     17550028
175600         END-PERFORM                                              17560028
175700                                                                  17570028
175800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17580028
175900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17590028
176000         PERFORM                                                  17600028
176100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17610028
176200                   PV-LAST-BLOCK-IN-RANGE                         17620028
176300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17630028
176400                                   TO PV-BLOCK-NUMBER             17640028
176500             PERFORM 4410-READ-TEMP-STORAGE                       17650028
176600             PERFORM 3510-MARK-SELECTED-INDS                      17660028
176700                 VARYING ASC-ITEM-SUB                             17670028
176800                 FROM 1 BY 1                                      17680028
176900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17690028
177000             PERFORM 5100-WRITE-TEMP-STORAGE                      17700028
177100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17710028
177200         END-PERFORM                                              17720028
177300                                                                  17730028
177400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17740028
177500                                   TO PV-BLOCK-NUMBER             17750028
177600         PERFORM 4410-READ-TEMP-STORAGE                           17760028
177700     END-IF.                                                      17770028
177800                                                                  17780028
177900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 17790028
178000                                      ASC-END-OF-SELECTED-RANGE.  17800028
178100                                                                  17810028
178200 EJECT                                                            17820028
178300*----------------------------------------------------------------*17830028
178400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *17840028
178500*----------------------------------------------------------------*17850028
178600                                                                  17860028
178700 3510-MARK-SELECTED-INDS.                                         17870028
178800                                                                  17880028
178900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17890028
179000                                ASC-ITEM-SUB) >                   17900028
179100         ASC-START-OF-SELECTED-RANGE)                             17910028
179200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         17920028
179300                                ASC-ITEM-SUB) =                   17930028
179400         ASC-START-OF-SELECTED-RANGE)                             17940028
179500                                                                  17950028
179600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17960028
179700                                    ASC-ITEM-SUB) <               17970028
179800             ASC-END-OF-SELECTED-RANGE)                           17980028
179900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     17990028
180000                                    ASC-ITEM-SUB) =               18000028
180100             ASC-END-OF-SELECTED-RANGE)                           18010028
180200                                                                  18020028
180300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18030028
180400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   18040028
180500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   18050028
180600                               TO TRUE                            18060028
180700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              18070028
180800                               TO TRUE                            18080028
180900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    18090028
181000             END-IF                                               18100028
181100         END-IF                                                   18110028
181200     END-IF.                                                      18120028
181300                                                                  18130028
181400 EJECT                                                            18140028
181500*----------------------------------------------------------------*18150028
181600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *18160028
181700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *18170028
181800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *18180028
181900*    DISPLAY THE PANEL TO USER.                                  *18190028
182000*----------------------------------------------------------------*18200028
182100                                                                  18210028
182200 4000-BUILD-INITIAL-PANEL.                                        18220028
182300                                                                  18230028
182400     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18240028
182500                                 ASC-BLOCK-ENTRIES (2).           18250028
182600     MOVE +1                 TO ASC-BLK-SUB.                      18260028
182700     SET ASC-ITEMS-LEFT-ON-DB                                     18270028
182800                             TO TRUE.                             18280028
182900                                                                  18290028
183000     MOVE +0                 TO ASC-ITEM-SUB                      18300028
183100                                ASC-NUMBER-OF-ITEMS-READ          18310028
183200                                ASC-NUMBER-OF-SELECTED-ITEMS      18320028
183300                                ASC-HIGHEST-BLOCK-WRITTEN         18330028
183400                                ASC-START-OF-SELECTED-RANGE       18340028
183500                                ASC-END-OF-SELECTED-RANGE         18350028
183600                                ASC-ITEM-AT-TOP-OF-PANEL.         18360028
183610* DMH - 10/11/18 BEGIN                                            18361039
183620     PERFORM 5810-SELECT-OPER-NAME.                               18362039
183630                                                                  18363039
183700     PERFORM 4100-PREPARE-CURSOR                                  18370028
183800                                                                  18380028
183900     PERFORM 4210-COMBINE-SQL.                                    18390028
184000     PERFORM 4220-DECLARE-CURSOR.                                 18400028
184100     PERFORM 4230-PREPARE-CURSOR.                                 18410028
184200                                                                  18420028
184300     PERFORM 4010-OPEN-CURSOR.                                    18430028
184400                                                                  18440028
184500     PERFORM 4300-READ-ITEMS-FROM-DB.                             18450028
184600                                                                  18460028
184700     PERFORM 4020-CLOSE-CURSOR.                                   18470028
184800                                                                  18480028
184900     MOVE +1                   TO  PV-TOP-ITEM.                   18490028
185000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          18500028
185100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    18510028
185200         SET DP020-MSG-FATAL   TO  TRUE                           18520028
185300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               18530028
185400     ELSE                                                         18540028
185500         MOVE -1               TO MR-SELECTL (1)                  18550028
185600         SET DP030-SET-CURSOR-APPL-1                              18560028
185700                               TO TRUE                            18570028
185800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     18580028
185900     END-IF.                                                      18590028
186000 EJECT                                                            18600028
186100/                                                                 18610028
186200*----------------------------------------------------------------*18620028
186300*    DECLARE THE CURSOR FOR DYNAMIC SQL CALL                     *18630028
186400*----------------------------------------------------------------*18640028
186500                                                                  18650028
186600 4220-DECLARE-CURSOR.                                             18660028
186700                                                                  18670028
186800     EXEC SQL                                                     18680028
186900         DECLARE OPEN-SHIPMENT-CSR CURSOR FOR                     18690028
187000                 SHIPMENT-SELECT                                  18700028
187100     END-EXEC.                                                    18710028
187200                                                                  18720028
187300                                                                  18730028
187400     EVALUATE TRUE                                                18740028
187500         WHEN SQLCODE = +0                                        18750028
187600              CONTINUE                                            18760028
187700         WHEN SQLWARN0 NOT = SPACE                                18770028
187800         WHEN SQLCODE  NOT = +0                                   18780028
187900              MOVE '4220-DECLARE-CURSOR'                          18790028
188000                               TO DP013-PARAGRAPH                 18800028
188100              MOVE 'DECLARE CURSOR'                               18810028
188200                               TO DP013-MESSAGE-TEXT (1)          18820028
188300              MOVE SQLCA       TO DP013-SQLCA                     18830028
188400              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        18840028
188500              MOVE 'TSHIPST'   TO DP013-DB2-TABLE-NAME (2)        18850028
188600              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (3)        18860028
188700              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (4)        18870028
188800              SET DP013-DB2-ABEND                                 18880028
188900                               TO TRUE                            18890028
189000              PERFORM DP013-0000-PROCESS-ABEND                    18900028
189100     END-EVALUATE.                                                18910028
189200                                                                  18920028
189300/                                                                 18930028
189400*----------------------------------------------------------------*18940028
189500*    PREPARE THE CURSOR FOR DYNAMIC SQL CALL                     *18950028
189600*----------------------------------------------------------------*18960028
189700                                                                  18970028
189800 4230-PREPARE-CURSOR.                                             18980028
189900                                                                  18990028
190000     EXEC SQL                                                     19000028
190100         PREPARE SHIPMENT-SELECT FROM :PV-SQL-STMT                19010028
190200     END-EXEC.                                                    19020028
190300                                                                  19030028
190400                                                                  19040028
190500     EVALUATE TRUE                                                19050028
190600         WHEN SQLCODE = +0                                        19060028
190700              CONTINUE                                            19070028
190800         WHEN SQLWARN0 NOT = SPACE                                19080028
190900         WHEN SQLCODE  NOT = +0                                   19090028
191000              MOVE '4230-PREPARE-CURSOR'                          19100028
191100                               TO DP013-PARAGRAPH                 19110028
191200              MOVE 'PREPARE CURSOR'                               19120028
191300                               TO DP013-MESSAGE-TEXT (1)          19130028
191400              MOVE SQLCA       TO DP013-SQLCA                     19140028
191500              MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)        19150028
191600              MOVE 'TSHIPST'   TO DP013-DB2-TABLE-NAME (2)        19160028
191700              MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (3)        19170028
191800              MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (4)        19180028
191900              SET DP013-DB2-ABEND                                 19190028
192000                               TO TRUE                            19200028
192100              PERFORM DP013-0000-PROCESS-ABEND                    19210028
192200     END-EVALUATE.                                                19220028
192300                                                                  19230028
192400*----------------------------------------------------------------*19240028
192500* OPEN THE OPEN SHIPMENT CURSOR.                                 *19250028
192600*----------------------------------------------------------------*19260028
192700                                                                  19270028
192800 4010-OPEN-CURSOR.                                                19280028
192900     PERFORM                                                      19290028
193000         WITH TEST AFTER                                          19300028
193100         VARYING PV-RETRY-COUNTER                                 19310028
193200         FROM 1 BY 1                                              19320028
193300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19330028
193400                   OR (SQLCODE = ZERO))                           19340028
193500         EXEC SQL                                                 19350028
193600              OPEN OPEN-SHIPMENT-CSR                              19360028
193700         END-EXEC                                                 19370028
193800                                                                  19380028
193900                                                                  19390028
194000         EVALUATE TRUE                                            19400028
194100             WHEN SQLCODE = ZERO                                  19410028
194200             WHEN SQLCODE = -904                                  19420028
194300             WHEN SQLCODE = -913                                  19430028
194400                 CONTINUE                                         19440028
194500             WHEN SQLWARN0 NOT = SPACES                           19450028
194600             WHEN SQLCODE < ZERO                                  19460028
194700             WHEN SQLCODE > ZERO                                  19470028
194800                 MOVE '4010-OPEN-CURSOR'                          19480028
194900                                   TO DP013-PARAGRAPH             19490028
195000                 MOVE 'ERROR OPENING THE OPEN SHIPMENT CURSOR '   19500028
195100                                   TO DP013-MESSAGE-TEXT (1)      19510028
195200                 MOVE SQLCA        TO DP013-SQLCA                 19520028
195300                 MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)     19530028
195400                 MOVE 'TSHIPST'   TO DP013-DB2-TABLE-NAME (2)     19540028
195500                 MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (3)     19550028
195600                 MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (4)     19560028
195700                 SET DP013-DB2-ABEND                              19570028
195800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19580028
195900                 PERFORM DP013-0000-PROCESS-ABEND                 19590028
196000         END-EVALUATE                                             19600028
196100     END-PERFORM.                                                 19610028
196200                                                                  19620028
196300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19630028
196400         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             19640028
196500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO '           19650028
196600                                   TO DP013-MESSAGE-TEXT (1)      19660028
196700         MOVE 'OPEN THE OPEN SHIPMENT CURSOR          '           19670028
196800                                   TO DP013-MESSAGE-TEXT (2)      19680028
196900         MOVE SQLCA                TO DP013-SQLCA                 19690028
197000         MOVE 'TSHIPMT'             TO DP013-DB2-TABLE-NAME (1)   19700028
197100         MOVE 'TSHIPST'             TO DP013-DB2-TABLE-NAME (2)   19710028
197200         MOVE 'TVHTRIP'             TO DP013-DB2-TABLE-NAME (3)   19720028
197300         MOVE 'TSHPTPO'             TO DP013-DB2-TABLE-NAME (4)   19730028
197400         SET DP013-DB2-ABEND                                      19740028
197500             DP013-XCTL-DISPLAY-RESTART                           19750028
197600                                   TO TRUE                        19760028
197700         PERFORM DP013-0000-PROCESS-ABEND                         19770028
197800     END-IF.                                                      19780028
197900                                                                  19790028
198000 EJECT                                                            19800028
198100*----------------------------------------------------------------*19810028
198200* CLOSE THE OPEN SHIPMENT CURSOR.                                *19820028
198300*----------------------------------------------------------------*19830028
198400*                                                                 19840028
198500 4020-CLOSE-CURSOR.                                               19850028
198600     EXEC SQL                                                     19860028
198700         CLOSE OPEN-SHIPMENT-CSR                                  19870028
198800     END-EXEC.                                                    19880028
198900                                                                  19890028
199000                                                                  19900028
199100     EVALUATE TRUE                                                19910028
199200         WHEN SQLCODE = ZERO                                      19920028
199300             CONTINUE                                             19930028
199400         WHEN SQLWARN0 NOT = SPACES                               19940028
199500         WHEN SQLCODE < ZERO                                      19950028
199600         WHEN SQLCODE > ZERO                                      19960028
199700             MOVE '4020-CLOSE-CURSOR'                             19970028
199800                               TO DP013-PARAGRAPH                 19980028
199900             MOVE 'ERROR CLOSING THE OPEN SHIPMENT CURSOR '       19990028
200000                               TO DP013-MESSAGE-TEXT (1)          20000028
200100             MOVE SQLCA        TO DP013-SQLCA                     20010028
200200             MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)        20020028
200300             MOVE 'TSHIPST '   TO DP013-DB2-TABLE-NAME (2)        20030028
200400             MOVE 'TVHTRIP '   TO DP013-DB2-TABLE-NAME (3)        20040028
200500             MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (3)        20050028
200600             SET DP013-DB2-ABEND                                  20060028
200700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20070028
200800             PERFORM DP013-0000-PROCESS-ABEND                     20080028
200900     END-EVALUATE.                                                20090028
201000                                                                  20100028
201100 EJECT                                                            20110028
201200*----------------------------------------------------------------*20120028
201300*    SET UP THE HOST VARIABLES.                                  *20130028
201400*----------------------------------------------------------------*20140028
201500                                                                  20150028
201600 4100-PREPARE-CURSOR.                                             20160028
201700                                                                  20170028
201800     MOVE ZERO                         TO PV-WHERE-BYTES          20180028
201900                                          PV-SUBSCRIPT.           20190028
202000     INITIALIZE PV-WHERE-TABLE                                    20200028
202100                PV-SQL-STMT.                                      20210028
202200     EXEC CICS ASSIGN                                             20220028
202300               APPLID(PV-SYSTEM-ID)                               20230028
202400     END-EXEC.                                                    20240028
202500                                                                  20250028
202700     MOVE PV-REGION-IND             TO PV-BUILD-QUAL-2            20270028
202800                                       PV-BUILD-QUAL-3            20280028
203000                                       PV-BUILD-QUAL-5.           20300028
203300                                                                  20330028
203400     IF ASC-KEY-ETA-FROM-DATE-ISO NOT = PC-DEFAULT-LOW-DATE-ISO   20340028
203500         MOVE ASC-KEY-ETA-FROM-DATE-ISO                           20350028
203600                                   TO  DK-ETA-FROM-DATE-ISO       20360028
203700                                       PV-ETA-FROM-DATE-ISO       20370028
203800         MOVE ASC-KEY-ETA-TO-DATE-ISO                             20380028
203900                                   TO  DK-ETA-TO-DATE-ISO         20390028
204000                                       PV-ETA-TO-DATE-ISO         20400028
204100         MOVE PV-BLD-DATE              TO PV-BUILD-LITERAL        20410028
204200         PERFORM 4200-INSERT-WHERE                                20420028
204300         MOVE PV-BUILD-STATEMENT TO PV-WHERE-LINE (PV-SUBSCRIPT)  20430028
204400     END-IF.                                                      20440028
204500                                                                  20450028
204600     IF  ASC-KEY-DELIVERY-SCAC-CDE > SPACES                       20460028
204700         MOVE ASC-KEY-DELIVERY-SCAC-CDE                           20470028
204800                                   TO DK-OWNER-SCAC-ID-B          20480028
204900                                      DK-OWNER-SCAC-ID-E          20490028
205000                                      PV-OWNER-SCAC-ID            20500028
205100         MOVE PV-OWNER-SCAC            TO PV-BUILD-LITERAL        20510028
205200         PERFORM 4200-INSERT-WHERE                                20520028
205300         MOVE PV-BUILD-STATEMENT TO PV-WHERE-LINE (PV-SUBSCRIPT)  20530028
205400     ELSE                                                         20540028
205500         MOVE SPACES               TO DK-OWNER-SCAC-ID-B          20550028
205600         MOVE '9999'               TO DK-OWNER-SCAC-ID-E          20560028
205700     END-IF.                                                      20570028
205800                                                                  20580028
205900     IF  ASC-KEY-PO-NBR > ZEROES                                  20590028
206000         MOVE ASC-KEY-PO-NBR       TO DK-PO-NBR-B                 20600028
206100                                      DK-PO-NBR-E                 20610028
206200                                      PV-BLD-PO-NBR               20620028
206300         MOVE PV-BLD-PO            TO PV-BUILD-LITERAL            20630028
206400         PERFORM 4200-INSERT-WHERE                                20640028
206500         MOVE PV-BUILD-STATEMENT TO PV-WHERE-LINE (PV-SUBSCRIPT)  20650028
206600     ELSE                                                         20660028
206700         MOVE ZEROES               TO DK-PO-NBR-B                 20670028
206800         MOVE 9999999              TO DK-PO-NBR-E                 20680028
206900     END-IF.                                                      20690028
207000                                                                  20700028
207100     IF  ASC-KEY-PRO-NBR > SPACES                                 20710028
207200         MOVE ASC-KEY-PRO-NBR      TO DK-PRO-NBR-B                20720028
207300                                      DK-PRO-NBR-E                20730028
207400                                      PV-BLD-PRO-NBR              20740028
207500         MOVE PV-BLD-PRO           TO PV-BUILD-LITERAL            20750028
207600         PERFORM 4200-INSERT-WHERE                                20760028
207700         STRING PV-BUILD-STATEMENT DELIMITED BY '    '            20770028
207800                PC-7D              DELIMITED BY SIZE              20780028
207900           INTO PV-WHERE-LINE (PV-SUBSCRIPT)                      20790028
208000     ELSE                                                         20800028
208100         MOVE SPACES               TO DK-PRO-NBR-B                20810028
208200         MOVE '9999999999999999'   TO DK-PRO-NBR-E                20820028
208300     END-IF.                                                      20830028
208400                                                                  20840028
208500     IF  ASC-KEY-BOL-NBR > SPACES                                 20850028
208600         MOVE ASC-KEY-BOL-NBR      TO DK-BOL-NBR-B                20860028
208700                                      DK-BOL-NBR-E                20870028
208800                                      PV-BLD-BOL-NBR              20880028
208900         MOVE PV-BLD-BOL           TO PV-BUILD-LITERAL            20890028
209000         PERFORM 4200-INSERT-WHERE                                20900028
209100         STRING PV-BUILD-STATEMENT DELIMITED BY '    '            20910028
209200                PC-7D              DELIMITED BY SIZE              20920028
209300           INTO PV-WHERE-LINE (PV-SUBSCRIPT)                      20930028
209400     ELSE                                                         20940028
209500         MOVE SPACES               TO DK-BOL-NBR-B                20950028
209600         MOVE '9999999999999999'   TO DK-BOL-NBR-E                20960028
209700     END-IF.                                                      20970028
209800                                                                  20980028
209900                                                                  20990028
210000/                                                                 21000028
210100*----------------------------------------------------------------*21010028
210200*    PLACE A 'WHERE' OR 'AND' IN FRONT OF EACH STATEMENT AND     *21020028
210300*    PUT THE ENTIRE STATEMENT INTO THE TABLE.                    *21030028
210400*----------------------------------------------------------------*21040028
210500                                                                  21050028
210600 4200-INSERT-WHERE.                                               21060028
210700                                                                  21070028
210800     ADD PC-1 TO PV-SUBSCRIPT.                                    21080028
210900     IF PV-SUBSCRIPT = +1                                         21090028
211000         MOVE PV-BLD-WHERE TO PV-BUILD-COMMAND                    21100028
211100     ELSE                                                         21110028
211200         MOVE PV-BLD-AND   TO PV-BUILD-COMMAND                    21120028
211300     END-IF.                                                      21130028
211400     ADD PV-WHERE-SIZE TO PV-WHERE-BYTES.                         21140028
211500                                                                  21150028
211600/                                                                 21160028
211700*----------------------------------------------------------------*21170028
211800*    PLACE A 'WHERE' OR 'AND' IN FRONT OF EACH STATEMENT AND     *21180028
211900*    PUT THE ENTIRE STATEMENT INTO THE TABLE.                    *21190028
212000*----------------------------------------------------------------*21200028
212100                                                                  21210028
212200 4210-COMBINE-SQL.                                                21220028
212300                                                                  21230028
212400     STRING PV-WHERE-LINE (1) DELIMITED BY '   '                  21240028
212500            PV-WHERE-LINE (2) DELIMITED BY '   '                  21250028
212600            PV-WHERE-LINE (3) DELIMITED BY '   '                  21260028
212700            PV-WHERE-LINE (4) DELIMITED BY '   '                  21270028
212800            PV-WHERE-LINE (5) DELIMITED BY '   '                  21280028
212900            PV-WHERE-LINE (6) DELIMITED BY '   '                  21290028
213000            PV-WHERE-LINE (7) DELIMITED BY '   '                  21300028
213100            PV-VEH-NBR        DELIMITED BY SIZE                   21310028
213300            PV-JOIN-2         DELIMITED BY SIZE                   21330028
213400            PV-JOIN-3         DELIMITED BY SIZE                   21340028
213500            PV-ORDER-BY-1     DELIMITED BY SIZE                   21350099
213600       INTO PVBLDSQL-WHERE.                                       21360028
213700     ADD PV-WHERE-BYTES PV-SELECT-BYTES PV-JOIN-BYTES             21370028
213800                             GIVING PV-BUILD-SELECT-LEN.          21380028
213900     MOVE PV-BUILD-SELECT-LEN TO PV-SQL-STMT-LEN.                 21390028
214000     MOVE PV-BUILD-SELECT-STMT TO PV-SQL-STMT-TEXT.               21400028
214100                                                                  21410028
214200                                                                  21420028
214300 EJECT                                                            21430028
214400*----------------------------------------------------------------*21440028
214500*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21450028
214600*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *21460028
214700*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21470028
214800*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21480028
214900*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21490028
215000*                                                                *21500028
215100*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21510028
215200*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21520028
215300*    UPON INITIALIZATION.                                        *21530028
215400*----------------------------------------------------------------*21540028
215500*                                                                 21550028
215600 4300-READ-ITEMS-FROM-DB.                                         21560028
215700                                                                  21570028
215800     PERFORM                                                      21580028
215900         VARYING PV-READ-COUNT                                    21590028
216000         FROM 1 BY 1                                              21600028
216100         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21610028
216200            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21620028
216300                                                                  21630028
216400         PERFORM 4310-FETCH                                       21640028
216500                                                                  21650028
216600         IF  ASC-ITEMS-LEFT-ON-DB                                 21660028
216700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                21670028
216800                 ADD +1            TO ASC-ITEM-SUB                21680028
216900             ELSE                                                 21690028
217000                 ADD +1            TO ASC-BLK-SUB                 21700028
217100                 MOVE +1           TO ASC-ITEM-SUB                21710028
217200                                                                  21720028
217300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21730028
217400                     MOVE +1       TO ASC-BLK-SUB                 21740028
217500                     SET ASC-BLOCK-MODIFIED (1)                   21750028
217600                                   TO TRUE                        21760028
217700                     PERFORM 5100-WRITE-TEMP-STORAGE              21770028
217800                     MOVE ASC-BLOCK-ENTRIES                       21780028
217900                               (PC-MAX-BLOCKS-IN-ARRAY)           21790028
218000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21800028
218100                     ADD +1        TO ASC-BLK-SUB                 21810028
218200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21820028
218300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      21830028
218400                                   TO TRUE                        21840028
218500                 END-IF                                           21850028
218600             END-IF                                               21860028
218700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    21870028
218800             MOVE ASC-NUMBER-OF-ITEMS-READ                        21880028
218900                                   TO ASC-LIST-ITEM-NUMBER        21890028
219000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21900028
219100             MOVE SHIPMT-SHIPT-ID  TO ASC-SHIPT-ID                21910028
219200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21920028
219300             MOVE SHIPMT-PRO-SCAC-ID                              21930028
219400                                   TO ASC-DELIVERY-SCAC           21940028
219500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21950028
219600             MOVE PC-EN            TO  ASC-STATUS                 21960028
219700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21970028
219800             IF PV-NULL-EST-AR-TMST = -1                          21980028
219900                 MOVE SPACES       TO  ASC-ETA-DATE               21990028
220000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22000028
220100             ELSE                                                 22010028
220200                 MOVE SHIPMT-EST-AR-TMST                          22020028
220300                                       TO  PV-DATE-IN-CCYY-MM-DD  22030028
220400                 MOVE PV-DATE-IN-YY    TO  PV-DATE-OUT-YY         22040028
220500                 MOVE PV-DATE-IN-MM    TO  PV-DATE-OUT-MM         22050028
220600                 MOVE PV-DATE-IN-DD    TO  PV-DATE-OUT-DD         22060028
220700                 MOVE PV-DATE-OUT-MM-DD-YY                        22070028
220800                                   TO  ASC-ETA-DATE               22080028
220900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22090028
221000             END-IF                                               22100028
221100             MOVE VHTRIP-MANIFEST-NBR                             22110028
221200                                   TO  ASC-MANIFEST               22120028
221300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22130028
221400             MOVE SHIPMT-ORIG-SCAC-ID                             22140028
221500                                   TO  ASC-FB-SCAC                22150028
221600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22160028
221700             MOVE SHIPMT-PRO-NBR   TO  ASC-FREIGHT-BILL           22170028
221800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22180028
221900             MOVE SHIPMT-BOL-NBR   TO  ASC-BILL-OF-LADING         22190028
222000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22200028
222100             MOVE VHTRIP-TRIP-ID   TO  ASC-TRIP-ID                22210028
222200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22220028
222201*                                                                 22220154
222202* DMH - BEGIN                                                     22220254
222210             PERFORM 5820-GET-SHPMT-OPER                          22221042
222211             PERFORM 5830-GET-SHPMT-PO-CURR-OPER                  22221153
222217                                                                  22221760
222218             IF  ASC-SINGLE-OPER (ASC-BLK-SUB ASC-ITEM-SUB) AND   22221855
222219                 TRIPST-OPER-UNT-ID  =  RECEIV-CURR-OPER-UNT-ID   22221954
222220                 MOVE TRIPST-OPER-UNT-ID TO ASC-TRIP-OPER         22222054
222221                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22222154
222222                 MOVE XLT00010-E-BUS-IND                          22222260
222223                    TO ASC-TRIP-OPER-E-BUS-SW                     22222399
222224                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22222460
222225             ELSE                                                 22222554
222226                 SET  ASC-MULT-OPER (ASC-BLK-SUB ASC-ITEM-SUB)    22222654
222227                      TO  TRUE                                    22222754
222228             END-IF                                               22222854
222229                                                                  22222999
222230             PERFORM 5835-CHECK-TRANSCRIBED                       22223099
222231* DMH - BEGIN                                                     22223154
222232*                                                                 22223254
222233                                                                  22223354
222234             MOVE TRIPST-OPER-UNT-ID TO ASC-TRIP-OPER             22223442
222235                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22223542
222236             MOVE XLT00010-E-BUS-IND TO ASC-TRIP-OPER-E-BUS-SW    22223699
222240                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22224042
222300         END-IF                                                   22230028
222400     END-PERFORM.                                                 22240028
222500*                                                                 22250028
222600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          22260028
222700         MOVE +1               TO ASC-BLK-SUB                     22270028
222800         PERFORM 5100-WRITE-TEMP-STORAGE                          22280028
222900         ADD +1                TO ASC-BLK-SUB                     22290028
223000         PERFORM 5100-WRITE-TEMP-STORAGE                          22300028
223100                                                                  22310028
223200         MOVE 1                TO ASC-BLK-SUB                     22320028
223300                                  PV-BLOCK-NUMBER                 22330028
223400         PERFORM 4410-READ-TEMP-STORAGE                           22340028
223500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22350028
223600             MOVE 2            TO ASC-BLK-SUB                     22360028
223700                                  PV-BLOCK-NUMBER                 22370028
223800             PERFORM 4410-READ-TEMP-STORAGE                       22380028
223900         END-IF                                                   22390028
224000     END-IF.                                                      22400028
224100*EJECT                                                            22410028
224200*----------------------------------------------------------------*22420028
224300*    FETCH THE OPEN SHIPMENT CURSOR.                             *22430028
224400*----------------------------------------------------------------*22440028
224500*                                                                 22450028
224600 4310-FETCH.                                                      22460028
224700**                                                                22470028
224710*     CLT 01-05-2012 WR40574 ADD CARR_AUTH_ID BELOW               22471031
224800      EXEC SQL                                                    22480028
224900           FETCH OPEN-SHIPMENT-CSR                                22490028
225100           INTO  :SHIPMT-EST-AR-TMST                              22510028
225200                    :PV-NULL-EST-AR-TMST,                         22520028
225300                 :VHTRIP-MANIFEST-NBR,                            22530028
225400                 :SHIPMT-SHIPT-ID,                                22540028
225500                 :SHIPMT-PRO-SCAC-ID,                             22550028
225600                 :SHIPMT-PRO-NBR,                                 22560028
225700                 :SHIPMT-BOL-NBR,                                 22570028
225800                 :SHIPMT-ORIG-SCAC-ID,                            22580028
225900                 :VHTRIP-TRIP-ID,                                 22590031
225910                 :SHIPMT-CARR-AUTH-ID                             22591031
226000      END-EXEC.                                                   22600028
226100*                                                                 22610028
226200                                                                  22620028
226300     EVALUATE TRUE                                                22630028
226400         WHEN SQLCODE = ZERO                                      22640028
226500         WHEN SQLCODE = +100                                      22650028
226600              CONTINUE                                            22660028
226700         WHEN SQLWARN0 NOT = SPACE                                22670028
226800         WHEN SQLCODE NOT = ZERO                                  22680028
226900              MOVE '4310-FETCH-CURSOR'                            22690028
227000                               TO DP013-PARAGRAPH                 22700028
227100              MOVE 'ERROR ON FETCH OF THE OPEN SHIPMENT CURSOR'   22710028
227200                               TO DP013-MESSAGE-TEXT (1)          22720028
227300              MOVE SQLCA       TO DP013-SQLCA                     22730028
227400              MOVE 'TSHIPMT '  TO DP013-DB2-TABLE-NAME (1)        22740028
227500              MOVE 'TSHIPST '  TO DP013-DB2-TABLE-NAME (2)        22750028
227600              MOVE 'TVHTRIP '  TO DP013-DB2-TABLE-NAME (3)        22760028
227700              SET DP013-DB2-ABEND                                 22770028
227800                               TO TRUE                            22780028
227900              PERFORM DP013-0000-PROCESS-ABEND                    22790028
228000     END-EVALUATE.                                                22800028
228100*                                                                 22810028
228200     IF  SQLCODE EQUAL +100                                       22820028
228300         SET ASC-NO-ITEMS-LEFT-ON-DB                              22830028
228400                                   TO TRUE                        22840028
228500     END-IF.                                                      22850028
228600*                                                                 22860028
228700 EJECT                                                            22870028
228800*----------------------------------------------------------------*22880028
228900* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *22890028
229000*----------------------------------------------------------------*22900028
229100                                                                  22910028
229200 4400-MOVE-COMMAREA-TO-SCREEN.                                    22920028
229300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             22930028
229400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          22940028
229500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          22950028
229600             MOVE +1    TO ASC-BLK-SUB                            22960028
229700             PERFORM 5100-WRITE-TEMP-STORAGE                      22970028
229800             ADD +1     TO ASC-BLK-SUB                            22980028
229900             PERFORM 5100-WRITE-TEMP-STORAGE                      22990028
230000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             23000028
230100                 GIVING PV-BLOCK-NUMBER                           23010028
230200                 REMAINDER PV-REMAINDER                           23020028
230300             IF  PV-REMAINDER > ZERO                              23030028
230400                 ADD +1 TO PV-BLOCK-NUMBER                        23040028
230500             END-IF                                               23050028
230600             MOVE +1    TO ASC-BLK-SUB                            23060028
230700             PERFORM 4410-READ-TEMP-STORAGE                       23070028
230800             ADD +1     TO ASC-BLK-SUB                            23080028
230900                           PV-BLOCK-NUMBER                        23090028
231000             PERFORM 4410-READ-TEMP-STORAGE                       23100028
231100     END-IF.                                                      23110028
231200     MOVE +1            TO ASC-BLK-SUB.                           23120028
231300     COMPUTE ASC-ITEM-SUB =                                       23130028
231400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23140028
231500         + PC-ITEMS-PER-PANEL).                                   23150028
231600*                                                                 23160028
231700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23170028
231800         ADD +1         TO ASC-BLK-SUB                            23180028
231900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23190028
232000     END-IF.                                                      23200028
232100*                                                                 23210028
232200     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23220028
232300         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23230028
232400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23240028
232410     MOVE  ASC-KEY-OPER-UNT-ID TO AOPRNBRO.                       23241041
232420     MOVE  ASC-OPER-NAME       TO AOPRNMEO.                       23242039
232430     MOVE  ASC-KEY-PO-NBR      TO PV-DISP-PO.                     23243099
232440     MOVE  PV-DISP-PO          TO APONBRO.                        23244099
232500     PERFORM 4420-FORMAT-LIST-LINES                               23250028
232600         VARYING PV-SUB                                           23260028
232700         FROM PC-ITEMS-PER-PANEL BY -1                            23270028
232800         UNTIL PV-SUB < +1.                                       23280028
232900*                                                                 23290028
233000     COMPUTE ASC-ITEMS-DISPLAYED =                                23300028
233100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23310028
233200     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23320028
233300                                      ASTRTITO.                   23330028
233400     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23340028
233500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23350028
233600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            23360028
233700                                   TO ASELITO.                    23370028
233800*                                                                 23380028
233900     IF  DP020-MSG-NUMBER-X = SPACE                               23390028
234000         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23400028
234100*            --- MORE ITEMS TO DISPLAY ----                       23410028
234200             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23420028
234300             SET DP020-MSG-INFORMATIONAL TO TRUE                  23430028
234400         END-IF                                                   23440028
234500     END-IF.                                                      23450028
234600*----------------------------------------------------------------*23460028
234700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23470028
234800*----------------------------------------------------------------*23480028
234900                                                                  23490028
235000 4410-READ-TEMP-STORAGE.                                          23500028
235100                                                                  23510028
235200     EXEC CICS                                                    23520028
235300         READQ TS                                                 23530028
235400             QUEUE (ASC-LIST-QUEUE-NAME)                          23540028
235500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23550028
235600             ITEM  (PV-BLOCK-NUMBER)                              23560028
235700             RESP  (PV-CICS-RESP)                                 23570028
235800     END-EXEC.                                                    23580028
235900                                                                  23590028
236000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23600028
236100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23610028
236200         CONTINUE                                                 23620028
236300     ELSE                                                         23630028
236400         SET DP013-CICS-ABEND     TO TRUE                         23640028
236500         SET DP013-NO-ROLLBACK    TO TRUE                         23650028
236600         MOVE '4410-READ-TEMP-STORAGE'                            23660028
236700                                  TO DP013-PARAGRAPH              23670028
236800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      23680028
236900                                  TO DP013-MESSAGE-TEXT(1)        23690028
237000         PERFORM DP013-0000-PROCESS-ABEND                         23700028
237100     END-IF.                                                      23710028
237200                                                                  23720028
237300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             23730028
237400*                                                                 23740028
237500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         23750028
237600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               23760028
237700     END-IF.                                                      23770028
237800 EJECT                                                            23780028
237900*----------------------------------------------------------------*23790028
238000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *23800028
238100*----------------------------------------------------------------*23810028
238200                                                                  23820028
238300 4420-FORMAT-LIST-LINES.                                          23830028
238400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      23840028
238500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                23850028
238600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           23860028
238700         MOVE SPACE              TO MR-SELECTI (PV-SUB)           23870028
238800                                    MR-ACTION (PV-SUB)            23880028
238900                                    MR-DELIVERY-SCAC (PV-SUB)     23890028
239000                                    MR-ETA-DATE (PV-SUB)          23900028
239100                                    MR-STATUS (PV-SUB)            23910028
239110                                    MR-OPER   (PV-SUB)            23911039
239200                                    MR-MANIFEST (PV-SUB)          23920028
239300                                    MR-FB-SCAC (PV-SUB)           23930028
239400                                    MR-FREIGHT-BILL (PV-SUB)      23940028
239500                                    MR-BILL-OF-LADING (PV-SUB)    23950028
239600     ELSE                                                         23960028
239700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      23970028
239800                                                   > SPACE        23980028
239900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23990028
240000                                 TO MR-SELECTI (PV-SUB)           24000028
240100         ELSE                                                     24010028
240200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      24020028
240300                                 TO MR-SELECTI (PV-SUB)           24030028
240400         END-IF                                                   24040028
240500*                                                                 24050028
240600         IF  DP030-SET-CURSOR-TRAILER                             24060028
240700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24070028
240800                 > SPACE)                                         24080028
240900               OR (PV-SUB = 1))                                   24090028
241000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24100028
241100                MOVE -1          TO MR-SELECTL (PV-SUB)           24110028
241200             END-IF                                               24120028
241300         END-IF                                                   24130028
241400*                                                                 24140028
241500         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           24150028
241600             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           24160028
241700                                 TO MR-ACTION (PV-SUB)            24170028
241800             MOVE ASC-DELIVERY-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)    24180028
241900                                 TO MR-DELIVERY-SCAC (PV-SUB)     24190028
242000             MOVE ASC-ETA-DATE (ASC-BLK-SUB ASC-ITEM-SUB)         24200028
242100                                 TO MR-ETA-DATE (PV-SUB)          24210028
242200             MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           24220028
242300                                 TO MR-STATUS (PV-SUB)            24230028
242301                                                                  24230156
242302             IF  ASC-MULT-OPER (ASC-BLK-SUB ASC-ITEM-SUB)         24230256
242303                 MOVE 'MULT'     TO MR-OPER   (PV-SUB)            24230356
242304             ELSE                                                 24230456
242305                 MOVE ASC-TRIP-OPER (ASC-BLK-SUB ASC-ITEM-SUB)    24230556
242306                                 TO MR-OPER   (PV-SUB)            24230642
242307             END-IF                                               24230756
242308                                                                  24230856
242400             MOVE ASC-MANIFEST (ASC-BLK-SUB ASC-ITEM-SUB)         24240028
242500                                 TO MR-MANIFEST (PV-SUB)          24250028
242600             MOVE ASC-FB-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)          24260028
242700                                 TO MR-FB-SCAC (PV-SUB)           24270028
242800             MOVE ASC-FREIGHT-BILL (ASC-BLK-SUB ASC-ITEM-SUB)     24280028
242900                                 TO MR-FREIGHT-BILL (PV-SUB)      24290028
243000             MOVE ASC-BILL-OF-LADING (ASC-BLK-SUB ASC-ITEM-SUB)   24300028
243100                                 TO MR-BILL-OF-LADING (PV-SUB)    24310028
243101* DMH - BEGIN                                                     24310199
243110             IF  ASC-RCVRS-TRANSCRIBED-NO                         24311099
243120                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24312099
243140                 MOVE DP015-YELLOW TO MR-DELIVERY-SCACC(PV-SUB)   24314099
243141                                      MR-OPERC(PV-SUB)            24314199
243150                 MOVE DP015-REVERSE                               24315099
243151                                   TO MR-DELIVERY-SCACH(PV-SUB)   24315199
243152                                      MR-OPERH(PV-SUB)            24315299
243153             ELSE                                                 24315399
243155                 MOVE DP015-GREEN  TO MR-DELIVERY-SCACC(PV-SUB)   24315599
243156                                      MR-OPERC(PV-SUB)            24315699
243157                 MOVE DP015-HL-OFF TO MR-DELIVERY-SCACH(PV-SUB)   24315799
243158                                      MR-OPERH(PV-SUB)            24315899
243159             END-IF                                               24315999
243160* DMH - END                                                       24316099
243200         END-IF                                                   24320028
243300     END-IF.                                                      24330028
243400     SUBTRACT +1 FROM ASC-ITEM-SUB                                24340028
243500     IF  ASC-ITEM-SUB < + 1                                       24350028
243600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24360028
243700         MOVE +1                 TO ASC-BLK-SUB                   24370028
243800     END-IF.                                                      24380028
243900******************************************************************24390028
244000** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24400028
244100** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24410028
244200** ISSUE A WARNING.                                             **24420028
244300******************************************************************24430028
244400 4430-CHECK-FOR-BEGIN-AND-END.                                    24440028
244500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24450028
244600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24460028
244700*            -- NO END-OF-RANGE SPECFIED ---                      24470028
244800             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24480028
244900             SET DP020-MSG-WARNING TO TRUE                        24490028
245000             PERFORM 4431-POSITION-AT-WARNING                     24500028
245100         END-IF                                                   24510028
245200     ELSE                                                         24520028
245300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24530028
245400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                24540028
245500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            24550028
245600             SET DP020-MSG-WARNING TO TRUE                        24560028
245700             PERFORM 4431-POSITION-AT-WARNING                     24570028
245800         END-IF                                                   24580028
245900     END-IF.                                                      24590028
246000******************************************************************24600028
246100** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **24610028
246200** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **24620028
246300** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **24630028
246400** POSITION THE CURSOR THERE.                                   **24640028
246500******************************************************************24650028
246600 4431-POSITION-AT-WARNING.                                        24660028
246700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24670028
246800                    - PV-TOP-ITEM + 1.                            24680028
246900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24690028
247000         CONTINUE                                                 24700028
247100     ELSE                                                         24710028
247200         SET DP030-SET-CURSOR-APPL-1                              24720028
247300                                   TO TRUE                        24730028
247400         MOVE -1                   TO MR-SELECTL (PV-SUB)         24740028
247500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24750028
247600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         24760028
247700     END-IF.                                                      24770028
247800*                                                                 24780028
247900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24790028
248000                    - PV-TOP-ITEM + 1.                            24800028
248100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24810028
248200         CONTINUE                                                 24820028
248300     ELSE                                                         24830028
248400         SET DP030-SET-CURSOR-APPL-1                              24840028
248500                                   TO TRUE                        24850028
248600         MOVE -1                   TO MR-SELECTL (PV-SUB)         24860028
248700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24870028
248800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         24880028
248900     END-IF.                                                      24890028
249000 EJECT                                                            24900028
249100*----------------------------------------------------------------*24910028
249200* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *24920028
249300* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *24930028
249400* FOR THE SELECTED ITEMS QUEUE.                                  *24940028
249500*                                                                *24950028
249600* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *24960028
249700* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *24970028
249800* THE ARRAY IS FULL.                                             *24980028
249900*----------------------------------------------------------------*24990028
250000                                                                  25000028
250100 5000-PREPARE-SEL-QUEUE.                                          25010028
250200                                                                  25020028
250300     MOVE +1                   TO  ASC-BLK-SUB.                   25030028
250400     PERFORM 5100-WRITE-TEMP-STORAGE.                             25040028
250500     ADD +1                    TO  ASC-BLK-SUB.                   25050028
250600     PERFORM 5100-WRITE-TEMP-STORAGE.                             25060028
250700                                                                  25070028
250800     MOVE ASC-SEL-QUEUE-NAME   TO  TR007-SEL-QUEUE-NAME.          25080028
250900     PERFORM 6010-DELETE-SEL-QUEUE.                               25090028
251000                                                                  25100028
251100     SET ASC-UPDATE-TSQ        TO  TRUE.                          25110028
251200                                                                  25120028
251300     SET TR006-IDX             TO  1.                             25130028
251400     MOVE ZERO                 TO TR007-NUMBER-OF-TS-ITEMS.       25140028
251500     INITIALIZE TR006-SELECTED-ITEM-ARRAY.                        25150028
251600                                                                  25160028
251700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25170028
251800             VARYING PV-ITEM                                      25180028
251900             FROM 1 BY 1                                          25190028
252000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     25200028
252100                                                                  25210028
252200     IF  TR006-IDX > 1                                            25220028
252300         PERFORM 5205-WRITE-SEL-QUEUE                             25230028
252400         ADD +1                TO TR007-NUMBER-OF-TS-ITEMS        25240028
252500     END-IF.                                                      25250028
252600 EJECT                                                            25260028
252700*----------------------------------------------------------------*25270028
252800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25280028
252900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25290028
253000*----------------------------------------------------------------*25300028
253100                                                                  25310028
253200 5100-WRITE-TEMP-STORAGE.                                         25320028
253300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25330028
253400                                   TO PV-LIST-ITEM-NUMBER.        25340028
253500     COMPUTE PV-BLOCK-NUMBER =                                    25350028
253600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25360028
253700                                                                  25370028
253800     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25380028
253900     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25390028
254000         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25400028
254100             PERFORM 5105-REWRITE-ASC-LISTQ                       25410028
254200         END-IF                                                   25420028
254300     ELSE                                                         25430028
254400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25440028
254500         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25450028
254600         PERFORM 5110-WRITE-ASC-LISTQ                             25460028
254700         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25470028
254800     END-IF.                                                      25480028
254900                                                                  25490028
255000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25500028
255100******************************************************************25510028
255200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **25520028
255300** SPECIFIC COMMAREA.                                           **25530028
255400******************************************************************25540028
255500 5105-REWRITE-ASC-LISTQ.                                          25550028
255600     EXEC CICS                                                    25560028
255700         WRITEQ TS                                                25570028
255800             QUEUE (ASC-LIST-QUEUE-NAME)                          25580028
255900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25590028
256000             ITEM  (PV-BLOCK-NUMBER)                              25600028
256100             REWRITE                                              25610028
256200             RESP  (PV-CICS-RESP)                                 25620028
256300     END-EXEC.                                                    25630028
256400                                                                  25640028
256500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           25650028
256600         CONTINUE                                                 25660028
256700     ELSE                                                         25670028
256800         SET DP013-CICS-ABEND            TO TRUE                  25680028
256900         SET DP013-NO-ROLLBACK           TO TRUE                  25690028
257000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       25700028
257100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     25710028
257200                                         TO DP013-MESSAGE-TEXT(1) 25720028
257300         PERFORM DP013-0000-PROCESS-ABEND                         25730028
257400     END-IF.                                                      25740028
257500                                                                  25750028
257600******************************************************************25760028
257700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **25770028
257800** SPECIFIC COMMAREA.                                           **25780028
257900******************************************************************25790028
258000 5110-WRITE-ASC-LISTQ.                                            25800028
258100     EXEC CICS                                                    25810028
258200         WRITEQ TS                                                25820028
258300             QUEUE (ASC-LIST-QUEUE-NAME)                          25830028
258400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25840028
258500             ITEM  (PV-BLOCK-NUMBER)                              25850028
258600             RESP  (PV-CICS-RESP)                                 25860028
258700     END-EXEC.                                                    25870028
258800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      25880028
258900         SET DP013-CICS-ABEND      TO TRUE                        25890028
259000         SET DP013-NO-ROLLBACK     TO TRUE                        25900028
259100         MOVE '5110-WRITE-ASC-LISTQ'                              25910028
259200                                   TO DP013-PARAGRAPH             25920028
259300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           25930028
259400                                   TO DP013-MESSAGE-TEXT(1)       25940028
259500         PERFORM DP013-0000-PROCESS-ABEND                         25950028
259600     END-IF.                                                      25960028
259700 EJECT                                                            25970028
259800*----------------------------------------------------------------*25980028
259900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *25990028
260000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26000028
260100*----------------------------------------------------------------*26010028
260200                                                                  26020028
260300 5200-FILL-SEL-QUEUE-RECORD.                                      26030028
260400                                                                  26040028
260500     PERFORM 6112-READ-LIST-QUEUE.                                26050028
260600                                                                  26060028
260700     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       26070028
260800         PERFORM                                                  26080028
260900         VARYING LQW-IDX                                          26090028
261000         FROM 1 BY 1                                              26100028
261100         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            26110028
261200           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          26120028
261210           OR  PS-ERROR                                           26121088
261300                                                                  26130028
261400             IF  LQW-SELECT (LQW-IDX)                             26140028
261500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              26150028
261600                                   TO TR006-ITEM (TR006-IDX)      26160028
261700                 MOVE ASC-KEY-OPER-UNT-ID                         26170028
261800                                  TO TR006-OPER-UNT-ID (TR006-IDX)26180028
261900                 MOVE ASC-KEY-FCLTY-ID                            26190028
262000                                   TO TR006-FCLTY-ID (TR006-IDX)  26200028
262100                 MOVE LQW-SHIPT-ID (LQW-IDX)                      26210028
262200                                   TO DK-SHIPT-ID                 26220028
262300                                      TR006-SHIPT-ID              26230028
262400                                        (TR006-IDX)               26240028
262500                 MOVE LQW-DELIVERY-SCAC (LQW-IDX)                 26250028
262600                                   TO TR006-OWNER-SCAC-ID         26260028
262700                                        (TR006-IDX)               26270028
262800                 MOVE LQW-ETA-DATE (LQW-IDX)                      26280028
262900                                   TO TR006-CALL-IN-DATE          26290028
263000                                        (TR006-IDX)               26300028
263100                 MOVE LQW-STATUS (LQW-IDX)                        26310028
263200                                   TO TR006-STATUS-CDE            26320028
263300                                        (TR006-IDX)               26330028
263400                 MOVE LQW-MANIFEST (LQW-IDX)                      26340028
263500                                   TO TR006-MANIFEST-NBR          26350028
263600                                        (TR006-IDX)               26360028
263700                 MOVE LQW-FB-SCAC (LQW-IDX)                       26370028
263800                                   TO TR006-PRO-SCAC-ID           26380028
263900                                        (TR006-IDX)               26390028
264000                 MOVE LQW-FREIGHT-BILL (LQW-IDX)                  26400028
264100                                   TO TR006-PRO-NBR               26410028
264200                                        (TR006-IDX)               26420028
264300                 MOVE LQW-BILL-OF-LADING (LQW-IDX)                26430028
264400                                   TO TR006-BOL-NBR               26440028
264500                                        (TR006-IDX)               26450028
264600                 MOVE LQW-TRIP-ID (LQW-IDX)                       26460028
264700                                   TO PV-SAVE-TRIP-ID             26470028
264800                                      TR006-TRIP-ID               26480028
264900                                        (TR006-IDX)               26490028
265000                 MOVE SPACE        TO TR006-ACTION-SW (TR006-IDX) 26500028
265100                 MOVE +1           TO PV-NULL-TRIP-ID-IND         26510028
265200                 IF DP020-FK-LOCAL-RETURN(DP020-SRC-AID)          26520028
265300                     PERFORM 5300-ASSIGN-SHIPMENT-TO-TRIP         26530028
265400                     IF  PS-ERROR                                 26540088
265410                         CONTINUE                                 26541088
265411                     ELSE                                         26541188
265420                         PERFORM 2400-WMS-MODULE-PROCESS          26542088
265430                     END-IF                                       26543088
265500                 END-IF                                           26550028
265600                 SET TR006-IDX UP BY 1                            26560028
265700                 IF  TR006-IDX > TR006-MAX-ITEMS                  26570028
265800                     PERFORM 5205-WRITE-SEL-QUEUE                 26580028
265900                     ADD +1        TO TR007-NUMBER-OF-TS-ITEMS    26590028
266000                     INITIALIZE TR006-SELECTED-ITEM-ARRAY         26600028
266100                     SET TR006-IDX TO  1                          26610028
266200                 END-IF                                           26620028
266300             END-IF                                               26630028
266400         END-PERFORM                                              26640028
266500     END-IF.                                                      26650028
266600                                                                  26660028
266700*----------------------------------------------------------------*26670028
266800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *26680028
266900*----------------------------------------------------------------*26690028
267000                                                                  26700028
267100 5205-WRITE-SEL-QUEUE.                                            26710028
267200                                                                  26720028
267300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            26730028
267400                                   TO TR006-SELECTED-ITEMS.       26740028
267500                                                                  26750028
267600     EXEC CICS                                                    26760028
267700          WRITEQ TS                                               26770028
267800              QUEUE (ASC-SEL-QUEUE-NAME)                          26780028
267900              FROM  (TR006-DOCK-SCHEDULE-REC)                     26790028
268000              ITEM  (PV-SEL-QUEUE-ITEM)                           26800028
268100              RESP  (PV-CICS-RESP)                                26810028
268200     END-EXEC.                                                    26820028
268300                                                                  26830028
268400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          26840028
268500         CONTINUE                                                 26850028
268600     ELSE                                                         26860028
268700         SET DP013-CICS-ABEND      TO TRUE                        26870028
268800         SET DP013-NO-ROLLBACK     TO TRUE                        26880028
268900         MOVE '5205-WRITE-SEL-QUEUE'                              26890028
269000                                   TO DP013-PARAGRAPH             26900028
269100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          26910028
269200                                   TO DP013-MESSAGE-TEXT(1)       26920028
269300         PERFORM DP013-0000-PROCESS-ABEND                         26930028
269400     END-IF.                                                      26940028
269500 EJECT                                                            26950028
269600******************************************************************26960028
269700** THIS PARAGRAPH WILL ASSIGN THE SELECTED OPEN SHIPMENTS TO    **26970028
269800** A SPECIFIC TRIP.                                             **26980028
269900******************************************************************26990028
270000 5300-ASSIGN-SHIPMENT-TO-TRIP.                                    27000028
270100                                                                  27010028
270200     PERFORM                                                      27020028
270300         WITH TEST AFTER                                          27030028
270400         VARYING PV-RETRY-COUNTER                                 27040028
270500         FROM 1 BY 1                                              27050028
270600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27060028
270700             OR (SQLCODE = +0))                                   27070028
270800                                                                  27080028
270900         EXEC SQL                                                 27090028
271000           UPDATE TSHIPMT                                         27100028
271100              SET LAST_UPD_DTE     = CURRENT DATE,                27110028
271200                  LAST_UPD_TME     = CURRENT TIME,                27120028
271300                  LAST_UPD_UID     = :DP020-USERID,               27130028
271400                  LAST_UPD_PGM_ID  = :PC-CURRENT-PROGRAM-NAME,    27140028
271500                  TRIP_ID          = :ASC-KEY-TRIP-ID             27150028
271600                                       :PV-NULL-TRIP-ID-IND,      27160028
271700                  PRO_SCAC_ID      = :ASC-KEY-ORIGINAL-SCAC-CDE   27170028
271800           WHERE  SHIPT_ID = :DK-SHIPT-ID                         27180028
271900         END-EXEC                                                 27190028
272000                                                                  27200028
272100         EVALUATE TRUE                                            27210028
272200             WHEN SQLCODE = +0                                    27220028
272300             WHEN SQLCODE = -904                                  27230028
272400             WHEN SQLCODE = -913                                  27240028
272500                 CONTINUE                                         27250028
272600                                                                  27260028
272700             WHEN SQLWARN0 NOT = SPACES                           27270028
272800             WHEN SQLCODE < +0                                    27280028
272900             WHEN SQLCODE > +0                                    27290028
273000                 MOVE '5300-ASSIGN-SHIPMENT-TO-TRIP'              27300028
273100                                   TO DP013-PARAGRAPH             27310028
273200                 MOVE 'UPDATE INFO ON TSHIPMT     '               27320028
273300                                   TO DP013-MESSAGE-TEXT(1)       27330028
273400                 MOVE SQLCA        TO DP013-SQLCA                 27340028
273500                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    27350028
273600                 SET DP013-DB2-ABEND                              27360028
273700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           27370028
273800                 PERFORM DP013-0000-PROCESS-ABEND                 27380028
273900         END-EVALUATE                                             27390028
274000     END-PERFORM.                                                 27400028
274100                                                                  27410028
274200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27420028
274300         MOVE '5300-ASSIGN-SHIPMENT-TO-TRIP'                      27430028
274400                                   TO DP013-PARAGRAPH             27440028
274500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              27450028
274600                                   TO DP013-MESSAGE-TEXT (1)      27460028
274700         MOVE 'TO UPDATE A TSHIPMT ROW'                           27470028
274800                                   TO DP013-MESSAGE-TEXT (2)      27480028
274900         MOVE SQLCA                TO DP013-SQLCA                 27490028
275000         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    27500028
275100         SET DP013-DB2-ABEND                                      27510028
275200             DP013-XCTL-DISPLAY-RESTART                           27520028
275300                                   TO TRUE                        27530028
275400         PERFORM DP013-0000-PROCESS-ABEND                         27540028
275500     END-IF.                                                      27550028
275600                                                                  27560028
275610*                                                                 27561087
275620**DMH - BEGIN - 10/11/18                                          27562087
275630*                                                                 27563087
275640** F17-INCLUDE SHIPMENT -                                         27564087
275650*    IF  SIGN-ON OPER IS A DC                                     27565087
275660*        CHECK IF ANY OF THE RECEIVERS ARE FOR AN EFC             27566087
275670*            IF THEY ARE FOR AN EFC - UPDATE THE CURR OPER        27567087
275680*               ON THE RECEIVER TO BE THE SIGN-ON OPER            27568087
275690*                                                                 27569087
275691     IF  ASC-E-BUS-N  AND                                         27569187
275692         LQW-TRIP-E-BUS-Y (LQW-IDX)                               27569287
275693         PERFORM 5840-UPDATE-EFC-CURR-TO-DC                       27569387
275694     END-IF.                                                      27569487
275695*                                                                 27569587
275696**DMH - BEGIN - 10/11/18                                          27569687
275697*                                                                 27569787
275698     IF  PS-ERROR                                                 27569887
275699         CONTINUE                                                 27569987
275700     ELSE                                                         27570087
275710         PERFORM 5350-INSERT-TSHIPST                              27571087
275800         PERFORM 5370-AUDIT-TSHIPMT                               27580087
275900         PERFORM 5400-COUNT-REMAINING-SHIPMENTS                   27590087
276000         PERFORM 5450-UPDATE-SHPTPO-RECS                          27600087
276010     END-IF.                                                      27601087
276100                                                                  27610028
276200/                                                                 27620028
276300*----------------------------------------------------------------*27630028
276400*  INSERT A SHIPMENT STATUS ROW                                  *27640028
276500*----------------------------------------------------------------*27650028
276600 5350-INSERT-TSHIPST.                                             27660028
276700     MOVE DK-SHIPT-ID TO SHIPST-SHIPT-ID.                         27670028
276800     MOVE VEHICL-CURR-STATUS-CDE TO SHIPST-SHIPT-STATUS-CDE.      27680028
276900                                                                  27690028
277000     PERFORM                                                      27700028
277100         WITH TEST AFTER                                          27710028
277200         VARYING PV-RETRY-COUNTER                                 27720028
277300         FROM 1 BY 1                                              27730028
277400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27740028
277500             OR (SQLCODE = +0)                                    27750028
277600             OR (SQLCODE = -803))                                 27760028
277700                                                                  27770028
277800         EXEC SQL                                                 27780028
277900             INSERT  INTO TSHIPST                                 27790028
278000                    (SHIPT_ID                                     27800028
278100                    ,SHIPT_STATUS_CDE                             27810028
278200                    ,STATUS_DTE                                   27820028
278300                    ,STATUS_TME                                   27830028
278400                    ,STATUS_UID)                                  27840028
278500            VALUES  (:SHIPST-SHIPT-ID                             27850028
278600                    ,:SHIPST-SHIPT-STATUS-CDE                     27860028
278700                    ,CURRENT DATE                                 27870028
278800                    ,CURRENT TIME                                 27880028
278900                    ,:DP020-USERID)                               27890028
279000         END-EXEC                                                 27900028
279100                                                                  27910028
279200         EVALUATE TRUE                                            27920028
279300             WHEN SQLCODE = +0                                    27930028
279400             WHEN SQLCODE = -803                                  27940028
279500             WHEN SQLCODE = -904                                  27950028
279600             WHEN SQLCODE = -913                                  27960028
279700                 CONTINUE                                         27970028
279800                                                                  27980028
279900             WHEN SQLWARN0 NOT = SPACES                           27990028
280000             WHEN SQLCODE < +0                                    28000028
280100             WHEN SQLCODE > +0                                    28010028
280200                 MOVE '5350-INSERT-TSHIPST'                       28020028
280300                                   TO DP013-PARAGRAPH             28030028
280400                 MOVE 'INSERT A ROW ON TSHIPST'                   28040028
280500                                   TO DP013-MESSAGE-TEXT(1)       28050028
280600                 MOVE SQLCA        TO DP013-SQLCA                 28060028
280700                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    28070028
280800                 SET DP013-DB2-ABEND                              28080028
280900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           28090028
281000                 PERFORM DP013-0000-PROCESS-ABEND                 28100028
281100         END-EVALUATE                                             28110028
281200     END-PERFORM.                                                 28120028
281300                                                                  28130028
281400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28140028
281500         MOVE '5350-INSERT-TSHIPST'                               28150028
281600                                   TO DP013-PARAGRAPH             28160028
281700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              28170028
281800                                   TO DP013-MESSAGE-TEXT (1)      28180028
281900         MOVE 'TO INSERT A TSHIPST ROW'                           28190028
282000                                   TO DP013-MESSAGE-TEXT (2)      28200028
282100         MOVE SQLCA                TO DP013-SQLCA                 28210028
282200         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    28220028
282300         SET DP013-DB2-ABEND                                      28230028
282400             DP013-XCTL-DISPLAY-RESTART                           28240028
282500                                   TO TRUE                        28250028
282600         PERFORM DP013-0000-PROCESS-ABEND                         28260028
282700     END-IF.                                                      28270028
282800                                                                  28280028
282900*----------------------------------------------------------------*28290028
283000*  TAKE A SNAPSHOT OF THE AFTER IMAGE OF TSHIPMT AND WRITE       *28300028
283100*  TO THE AUDIT TABLE.                                           *28310028
283200*----------------------------------------------------------------*28320028
283300 5370-AUDIT-TSHIPMT.                                              28330028
283400                                                                  28340028
283500     INITIALIZE DCLTAUSHIP.                                       28350028
283600                                                                  28360028
283610* CLT 12-08-2011 WR40574 ADDED CARR-AUTH-ID (CAN) BELOW           28361029
283700     PERFORM                                                      28370028
283800         WITH TEST AFTER                                          28380028
283900         VARYING PV-RETRY-COUNTER                                 28390028
284000         FROM 1 BY 1                                              28400028
284100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28410028
284200             OR (SQLCODE = +0))                                   28420028
284300                                                                  28430028
284400         EXEC SQL                                                 28440028
284500             SELECT  TRIP_ID                                      28450028
284600                    ,SHIPT_ID                                     28460028
284700                    ,CRT_SRC_CDE                                  28470028
284800                    ,LAST_UPD_DTE                                 28480028
284900                    ,LAST_UPD_TME                                 28490028
285000                    ,LAST_UPD_UID                                 28500028
285100                    ,PRO_SCAC_ID                                  28510028
285200                    ,PRO_NBR                                      28520028
285300                    ,BOL_NBR                                      28530028
285400                    ,SHIPPER_NME                                  28540028
285500                    ,SHIPT_TYP_CDE                                28550028
285600                    ,EXPTED_GRO_WGHT                              28560028
285700                    ,PKG_TYP_CDE                                  28570028
285800                    ,EXPTED_PKG_QTY                               28580028
285900                    ,FRGT_CHG_AMT                                 28590028
286000                    ,FRGT_TERMS_CDE                               28600028
286100                    ,EXPTED_PLT_QTY                               28610028
286200                    ,VEND_SHIP_DTE                                28620028
286300                    ,EST_AR_TMST                                  28630028
286400                    ,ORIG_SCAC_ID                                 28640028
286500                    ,LAST_UPD_PGM_ID                              28650028
286600                    ,CRE_USER_ID                                  28660028
286700                    ,CARR_CART_CT                                 28670028
286800                    ,CARR_LAST_UPD_DTE                            28680028
286900                    ,CARR_LAST_UPD_TIME                           28690028
287000                    ,VEND_CART_CT                                 28700028
287100                    ,VEND_LAST_UPD_DTE                            28710028
287200                    ,VEND_LAST_UPD_TIME                           28720028
287300                    ,VEH_NBR                                      28730028
287400                    ,AUTH_NBR                                     28740028
287500                    ,AUTH_DTE                                     28750028
287600                    ,CONFIRM_DTE                                  28760028
287700                    ,CONFIRM_TIME                                 28770028
287800                    ,COMPLETE_PRO_NBR                             28780028
287900                    ,COMPLETE_BOL_NBR                             28790028
288000                    ,PROCESSED_DTE                                28800028
288100                    ,INVC_NBR                                     28810028
288110                    ,CARR_AUTH_ID                                 28811029
288200            INTO     :SHIPMT-TRIP-ID                              28820028
288300                       :PV-NULL-TRIP-ID-IND                       28830028
288400                    ,:SHIPMT-SHIPT-ID                             28840028
288500                    ,:SHIPMT-CRT-SRC-CDE                          28850028
288600                    ,:SHIPMT-LAST-UPD-DTE                         28860028
288700                    ,:SHIPMT-LAST-UPD-TME                         28870028
288800                    ,:SHIPMT-LAST-UPD-UID                         28880028
288900                    ,:SHIPMT-PRO-SCAC-ID                          28890028
289000                    ,:SHIPMT-PRO-NBR                              28900028
289100                    ,:SHIPMT-BOL-NBR                              28910028
289200                    ,:SHIPMT-SHIPPER-NME                          28920028
289300                    ,:SHIPMT-SHIPT-TYP-CDE                        28930028
289400                    ,:SHIPMT-EXPTED-GRO-WGHT                      28940028
289500                    ,:SHIPMT-PKG-TYP-CDE                          28950028
289600                    ,:SHIPMT-EXPTED-PKG-QTY                       28960028
289700                    ,:SHIPMT-FRGT-CHG-AMT                         28970028
289800                    ,:SHIPMT-FRGT-TERMS-CDE                       28980028
289900                    ,:SHIPMT-EXPTED-PLT-QTY                       28990028
290000                    ,:SHIPMT-VEND-SHIP-DTE                        29000028
290100                    ,:SHIPMT-EST-AR-TMST                          29010028
290200                       :PV-NULL-EST-AR-TMST                       29020028
290300                    ,:SHIPMT-ORIG-SCAC-ID                         29030028
290400                    ,:SHIPMT-LAST-UPD-PGM-ID                      29040028
290500                    ,:SHIPMT-CRE-USER-ID                          29050028
290600                    ,:SHIPMT-CARR-CART-CT                         29060028
290700                    ,:SHIPMT-CARR-LAST-UPD-DTE                    29070028
290800                    ,:SHIPMT-CARR-LAST-UPD-TIME                   29080028
290900                    ,:SHIPMT-VEND-CART-CT                         29090028
291000                    ,:SHIPMT-VEND-LAST-UPD-DTE                    29100028
291100                    ,:SHIPMT-VEND-LAST-UPD-TIME                   29110028
291200                    ,:SHIPMT-VEH-NBR                              29120028
291300                    ,:SHIPMT-AUTH-NBR                             29130028
291400                    ,:SHIPMT-AUTH-DTE                             29140028
291500                    ,:SHIPMT-CONFIRM-DTE                          29150028
291600                    ,:SHIPMT-CONFIRM-TIME                         29160028
291700                    ,:SHIPMT-COMPLETE-PRO-NBR                     29170028
291800                    ,:SHIPMT-COMPLETE-BOL-NBR                     29180028
291900                    ,:SHIPMT-PROCESSED-DTE                        29190028
292000                    ,:SHIPMT-INVC-NBR                             29200029
292010                    ,:SHIPMT-CARR-AUTH-ID                         29201029
292100           FROM   TSHIPMT                                         29210028
292200           WHERE  SHIPT_ID = :DK-SHIPT-ID                         29220028
292300         END-EXEC                                                 29230028
292400                                                                  29240028
292500         EVALUATE TRUE                                            29250028
292600             WHEN SQLCODE = +0                                    29260028
292700             WHEN SQLCODE = -904                                  29270028
292800             WHEN SQLCODE = -913                                  29280028
292900                 CONTINUE                                         29290028
293000                                                                  29300028
293100             WHEN SQLWARN0 NOT = SPACES                           29310028
293200             WHEN SQLCODE < +0                                    29320028
293300             WHEN SQLCODE > +0                                    29330028
293400                 MOVE '5370-AUDIT-TSHIPMT'                        29340028
293500                                   TO DP013-PARAGRAPH             29350028
293600                 MOVE 'SELECT A TSHIPMT ROW   '                   29360028
293700                                   TO DP013-MESSAGE-TEXT(1)       29370028
293800                 MOVE SQLCA        TO DP013-SQLCA                 29380028
293900                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    29390028
294000                 SET DP013-DB2-ABEND                              29400028
294100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           29410028
294200                 PERFORM DP013-0000-PROCESS-ABEND                 29420028
294300         END-EVALUATE                                             29430028
294400     END-PERFORM.                                                 29440028
294500                                                                  29450028
294600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29460028
294700         MOVE '5370-AUDIT-TSHIPMT '                               29470028
294800                                   TO DP013-PARAGRAPH             29480028
294900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              29490028
295000                                   TO DP013-MESSAGE-TEXT (1)      29500028
295100         MOVE 'TO SELECT A TSHIPMT ROW'                           29510028
295200                                   TO DP013-MESSAGE-TEXT (2)      29520028
295300         MOVE SQLCA                TO DP013-SQLCA                 29530028
295400         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    29540028
295500         SET DP013-DB2-ABEND                                      29550028
295600             DP013-XCTL-DISPLAY-RESTART                           29560028
295700                                   TO TRUE                        29570028
295800         PERFORM DP013-0000-PROCESS-ABEND                         29580028
295900     END-IF.                                                      29590028
296000                                                                  29600028
296001* CLT 12-08-2011 WR40574 ADDED CARR-AUTH-ID (CAN) BELOW           29600129
296100     PERFORM                                                      29610028
296200         WITH TEST AFTER                                          29620028
296300         VARYING PV-RETRY-COUNTER                                 29630028
296400         FROM 1 BY 1                                              29640028
296500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               29650028
296600             OR (SQLCODE = +0))                                   29660028
296700                                                                  29670028
296800         EXEC SQL                                                 29680028
296900             INSERT  INTO TAUSHIP                                 29690028
297000                    (TRIP_ID                                      29700028
297100                    ,SHIPT_ID                                     29710028
297200                    ,CRT_SRC_CDE                                  29720028
297300                    ,LAST_UPD_DTE                                 29730028
297400                    ,LAST_UPD_TME                                 29740028
297500                    ,LAST_UPD_UID                                 29750028
297600                    ,PRO_SCAC_ID                                  29760028
297700                    ,PRO_NBR                                      29770028
297800                    ,BOL_NBR                                      29780028
297900                    ,SHIPPER_NME                                  29790028
298000                    ,SHIPT_TYP_CDE                                29800028
298100                    ,EXPTED_GRO_WGHT                              29810028
298200                    ,PKG_TYP_CDE                                  29820028
298300                    ,EXPTED_PKG_QTY                               29830028
298400                    ,FRGT_CHG_AMT                                 29840028
298500                    ,FRGT_TERMS_CDE                               29850028
298600                    ,EST_AR_TMST                                  29860028
298700                    ,VEND_SHIP_DTE                                29870028
298800                    ,EXPTED_PLT_QTY                               29880028
298900                    ,ORIG_SCAC_ID                                 29890028
299000                    ,LAST_UPD_PGM_ID                              29900028
299100                    ,CRE_USER_ID                                  29910028
299200                    ,CARR_CART_CT                                 29920028
299300                    ,CARR_LAST_UPD_DTE                            29930028
299400                    ,CARR_LAST_UPD_TIME                           29940028
299500                    ,VEND_CART_CT                                 29950028
299600                    ,VEND_LAST_UPD_DTE                            29960028
299700                    ,VEND_LAST_UPD_TIME                           29970028
299800                    ,VEH_NBR                                      29980028
299900                    ,AUTH_NBR                                     29990028
300000                    ,AUTH_DTE                                     30000028
300100                    ,CONFIRM_DTE                                  30010028
300200                    ,CONFIRM_TIME                                 30020028
300300                    ,PROCESSED_DTE                                30030028
300400                    ,INVC_NBR                                     30040028
300500                    ,AUD_STATUS_CDE                               30050029
300510                    ,CARR_AUTH_ID  )                              30051029
300600            VALUES  (:SHIPMT-TRIP-ID                              30060028
300700                       :PV-NULL-TRIP-ID-IND                       30070028
300800                    ,:SHIPMT-SHIPT-ID                             30080028
300900                    ,:SHIPMT-CRT-SRC-CDE                          30090028
301000                    ,:SHIPMT-LAST-UPD-DTE                         30100028
301100                    ,:SHIPMT-LAST-UPD-TME                         30110028
301200                    ,:SHIPMT-LAST-UPD-UID                         30120028
301300                    ,:SHIPMT-PRO-SCAC-ID                          30130028
301400                    ,:SHIPMT-COMPLETE-PRO-NBR                     30140028
301500                    ,:SHIPMT-COMPLETE-BOL-NBR                     30150028
301600                    ,:SHIPMT-SHIPPER-NME                          30160028
301700                    ,:SHIPMT-SHIPT-TYP-CDE                        30170028
301800                    ,:SHIPMT-EXPTED-GRO-WGHT                      30180028
301900                    ,:SHIPMT-PKG-TYP-CDE                          30190028
302000                    ,:SHIPMT-EXPTED-PKG-QTY                       30200028
302100                    ,:SHIPMT-FRGT-CHG-AMT                         30210028
302200                    ,:SHIPMT-FRGT-TERMS-CDE                       30220028
302300                    ,:SHIPMT-EST-AR-TMST                          30230028
302400                       :PV-NULL-EST-AR-TMST                       30240028
302500                    ,:SHIPMT-VEND-SHIP-DTE                        30250028
302600                    ,:SHIPMT-EXPTED-PLT-QTY                       30260028
302700                    ,:SHIPMT-ORIG-SCAC-ID                         30270028
302800                    ,:SHIPMT-LAST-UPD-PGM-ID                      30280028
302900                    ,:SHIPMT-CRE-USER-ID                          30290028
303000                    ,:SHIPMT-CARR-CART-CT                         30300028
303100                    ,:SHIPMT-CARR-LAST-UPD-DTE                    30310028
303200                    ,:SHIPMT-CARR-LAST-UPD-TIME                   30320028
303300                    ,:SHIPMT-VEND-CART-CT                         30330028
303400                    ,:SHIPMT-VEND-LAST-UPD-DTE                    30340028
303500                    ,:SHIPMT-VEND-LAST-UPD-TIME                   30350028
303600                    ,:SHIPMT-VEH-NBR                              30360028
303700                    ,:SHIPMT-AUTH-NBR                             30370028
303800                    ,:SHIPMT-AUTH-DTE                             30380028
303900                    ,:SHIPMT-CONFIRM-DTE                          30390028
304000                    ,:SHIPMT-CONFIRM-TIME                         30400028
304100                    ,:SHIPMT-PROCESSED-DTE                        30410028
304200                    ,:SHIPMT-INVC-NBR                             30420028
304300                    ,:SHIPST-SHIPT-STATUS-CDE                     30430029
304310                    ,:SHIPMT-CARR-AUTH-ID     )                   30431030
304400         END-EXEC                                                 30440028
304500                                                                  30450028
304600         EVALUATE TRUE                                            30460028
304700             WHEN SQLCODE = +0                                    30470028
304800             WHEN SQLCODE = -904                                  30480028
304900             WHEN SQLCODE = -913                                  30490028
305000                 CONTINUE                                         30500028
305100                                                                  30510028
305200             WHEN SQLWARN0 NOT = SPACES                           30520028
305300             WHEN SQLCODE < +0                                    30530028
305400             WHEN SQLCODE > +0                                    30540028
305500                 MOVE '5370-AUDIT-TSHIPMT '                       30550028
305600                                   TO DP013-PARAGRAPH             30560028
305700                 MOVE 'INSERT A ROW ON TAUSHIP'                   30570028
305800                                   TO DP013-MESSAGE-TEXT(1)       30580028
305900                 MOVE SQLCA        TO DP013-SQLCA                 30590028
306000                 MOVE 'TAUSHIP'    TO DP013-DB2-TABLE-NAME (1)    30600028
306100                 SET DP013-DB2-ABEND                              30610028
306200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           30620028
306300                 PERFORM DP013-0000-PROCESS-ABEND                 30630028
306400         END-EVALUATE                                             30640028
306500     END-PERFORM.                                                 30650028
306600                                                                  30660028
306700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30670028
306800         MOVE '5370-AUDIT-TSHIPMT'                                30680028
306900                                   TO DP013-PARAGRAPH             30690028
307000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              30700028
307100                                   TO DP013-MESSAGE-TEXT (1)      30710028
307200         MOVE 'TO INSERT A TAUSHIP ROW'                           30720028
307300                                   TO DP013-MESSAGE-TEXT (2)      30730028
307400         MOVE SQLCA                TO DP013-SQLCA                 30740028
307500         MOVE 'TAUSHIP'            TO DP013-DB2-TABLE-NAME (1)    30750028
307600         SET DP013-DB2-ABEND                                      30760028
307700             DP013-XCTL-DISPLAY-RESTART                           30770028
307800                                   TO TRUE                        30780028
307900         PERFORM DP013-0000-PROCESS-ABEND                         30790028
308000     END-IF.                                                      30800028
308100                                                                  30810028
308200 EJECT                                                            30820028
308300******************************************************************30830028
308400** COUNT THE NUMBER OF REMAINING SHIPMENTS ASSIGNED TO THIS     **30840028
308500** SPECIFIC TRIP ID.  IF THERE ARE NO MORE SHIPMENTS ASSIGNED,  **30850028
308600** STATUS THE TRIP "DELETED".                                   **30860028
308700******************************************************************30870028
308800 5400-COUNT-REMAINING-SHIPMENTS.                                  30880028
308900                                                                  30890028
309000     PERFORM                                                      30900028
309100         WITH TEST AFTER                                          30910028
309200         VARYING PV-RETRY-COUNTER                                 30920028
309300         FROM 1 BY 1                                              30930028
309400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               30940028
309500             OR (SQLCODE = +0))                                   30950028
309600                                                                  30960028
309700         EXEC SQL                                                 30970028
309800           SELECT                                                 30980028
309900                COUNT(*)                                          30990028
310000           INTO                                                   31000028
310100                :PV-SHIPMENT-COUNT                                31010028
310200          FROM                                                    31020028
310300                TSHIPST A,                                        31030028
310400                TSHIPMT B,                                        31040028
310500                TVHTRIP C                                         31050028
310600          WHERE                                                   31060028
310700                B.TRIP_ID = :DK-TRIP-ID                           31070028
310800            AND C.VEH_NBR IS NULL                                 31080028
310900            AND A.SHIPT_ID = B.SHIPT_ID                           31090028
311000            AND B.TRIP_ID = C.TRIP_ID                             31100028
311100         END-EXEC                                                 31110028
311200                                                                  31120028
311300         EVALUATE TRUE                                            31130028
311400             WHEN SQLCODE = +0                                    31140028
311500             WHEN SQLCODE = -904                                  31150028
311600             WHEN SQLCODE = -913                                  31160028
311700                 CONTINUE                                         31170028
311800                                                                  31180028
311900             WHEN SQLWARN0 NOT = SPACES                           31190028
312000             WHEN SQLCODE < +0                                    31200028
312100             WHEN SQLCODE > +0                                    31210028
312200                 MOVE '5400-COUNT-REMAINING-SHIPMENTS'            31220028
312300                                   TO DP013-PARAGRAPH             31230028
312400                 MOVE 'COUNTING OPEN SHIPMENTS FOR A TRIP'        31240028
312500                                   TO DP013-MESSAGE-TEXT(1)       31250028
312600                 MOVE SQLCA        TO DP013-SQLCA                 31260028
312700                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    31270028
312800                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (2)    31280028
312900                 MOVE 'TVHTRIP'    TO DP013-DB2-TABLE-NAME (3)    31290028
313000                 SET DP013-DB2-ABEND                              31300028
313100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           31310028
313200                 PERFORM DP013-0000-PROCESS-ABEND                 31320028
313300         END-EVALUATE                                             31330028
313400     END-PERFORM.                                                 31340028
313500                                                                  31350028
313600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        31360028
313700         MOVE '5400-COUNT-REMAINING-SHIPMENTS'                    31370028
313800                                   TO DP013-PARAGRAPH             31380028
313900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              31390028
314000                                   TO DP013-MESSAGE-TEXT (1)      31400028
314100         MOVE 'TO COUNT OPEN SHIPMENTS FOR A TRIP'                31410028
314200                                   TO DP013-MESSAGE-TEXT (2)      31420028
314300         MOVE SQLCA                TO DP013-SQLCA                 31430028
314400         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    31440028
314500         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (2)    31450028
314600         MOVE 'TVHTRIP'            TO DP013-DB2-TABLE-NAME (3)    31460028
314700         SET DP013-DB2-ABEND                                      31470028
314800             DP013-XCTL-DISPLAY-RESTART                           31480028
314900                                   TO TRUE                        31490028
315000         PERFORM DP013-0000-PROCESS-ABEND                         31500028
315100     END-IF.                                                      31510028
315200                                                                  31520028
315300     IF  PV-SHIPMENT-COUNT = +0                                   31530028
315400         PERFORM 5500-STATUS-TRIP-DELETED                         31540028
315500     END-IF.                                                      31550028
315600                                                                  31560028
315700                                                                  31570028
315800 5450-UPDATE-SHPTPO-RECS.                                         31580028
315900     PERFORM 5460-OPEN-CURSOR.                                    31590028
316000     SET PS-NOT-END-OF-CURSOR TO TRUE.                            31600028
316100     PERFORM 5480-FETCH-CURSOR                                    31610028
316200         UNTIL PS-END-OF-CURSOR.                                  31620028
316300     PERFORM 5470-CLOSE-CURSOR.                                   31630028
316400*----------------------------------------------------------------*31640028
316500* OPEN THE SHIPMT CURSOR.                                        *31650028
316600*----------------------------------------------------------------*31660028
316700                                                                  31670028
316800 5460-OPEN-CURSOR.                                                31680028
316900     PERFORM                                                      31690028
317000         WITH TEST AFTER                                          31700028
317100         VARYING PV-RETRY-COUNTER                                 31710028
317200         FROM 1 BY 1                                              31720028
317300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               31730028
317400                   OR (SQLCODE = ZERO))                           31740028
317500                                                                  31750028
317600             EXEC SQL                                             31760028
317700                  OPEN SHPTPO-CSR                                 31770028
317800             END-EXEC                                             31780028
317900                                                                  31790028
318000                                                                  31800028
318100         EVALUATE TRUE                                            31810028
318200             WHEN SQLCODE = ZERO                                  31820028
318300             WHEN SQLCODE = -904                                  31830028
318400             WHEN SQLCODE = -913                                  31840028
318500                 CONTINUE                                         31850028
318600             WHEN SQLWARN0 NOT = SPACES                           31860028
318700             WHEN SQLCODE < ZERO                                  31870028
318800             WHEN SQLCODE > ZERO                                  31880028
318900                 MOVE '5460-OPEN-CURSOR'                          31890028
319000                                   TO DP013-PARAGRAPH             31900028
319100                 MOVE 'OPEN SHPTPO CURSOR - '                     31910028
319200                                   TO DP013-MESSAGE-TEXT (1)      31920028
319300                 MOVE SQLCA        TO DP013-SQLCA                 31930028
319400                 MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (1)    31940028
319500                 SET DP013-DB2-ABEND                              31950028
319600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           31960028
319700                 PERFORM DP013-0000-PROCESS-ABEND                 31970028
319800         END-EVALUATE                                             31980028
319900     END-PERFORM.                                                 31990028
320000                                                                  32000028
320100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32010028
320200         MOVE '5460-OPEN-CURSOR'   TO DP013-PARAGRAPH             32020028
320300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   32030028
320400                                   TO DP013-MESSAGE-TEXT (1)      32040028
320500         MOVE SQLCA                TO DP013-SQLCA                 32050028
320600         MOVE 'TSHPTPO '           TO DP013-DB2-TABLE-NAME (1)    32060028
320700         SET DP013-DB2-ABEND                                      32070028
320800             DP013-XCTL-DISPLAY-RESTART                           32080028
320900                                   TO TRUE                        32090028
321000         PERFORM DP013-0000-PROCESS-ABEND                         32100028
321100     END-IF.                                                      32110028
321200                                                                  32120028
321300 EJECT                                                            32130028
321400*----------------------------------------------------------------*32140028
321500* CLOSE THE TMESSAGE CURSOR.                                     *32150028
321600*----------------------------------------------------------------*32160028
321700                                                                  32170028
321800 5470-CLOSE-CURSOR.                                               32180028
321900     EXEC SQL                                                     32190028
322000         CLOSE SHPTPO-CSR                                         32200028
322100     END-EXEC.                                                    32210028
322200                                                                  32220028
322300                                                                  32230028
322400     EVALUATE TRUE                                                32240028
322500         WHEN SQLCODE = ZERO                                      32250028
322600             CONTINUE                                             32260028
322700         WHEN SQLWARN0 NOT = SPACES                               32270028
322800         WHEN SQLCODE < ZERO                                      32280028
322900         WHEN SQLCODE > ZERO                                      32290028
323000             MOVE '5470-CLOSE-CURSOR'                             32300028
323100                               TO DP013-PARAGRAPH                 32310028
323200             MOVE 'CLOSE SHPTPO CURSOR '                          32320028
323300                               TO DP013-MESSAGE-TEXT (1)          32330028
323400             MOVE SQLCA        TO DP013-SQLCA                     32340028
323500             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        32350028
323600             SET DP013-DB2-ABEND                                  32360028
323700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32370028
323800             PERFORM DP013-0000-PROCESS-ABEND                     32380028
323900     END-EVALUATE.                                                32390028
324000                                                                  32400028
324100 EJECT                                                            32410028
324200 5480-FETCH-CURSOR.                                               32420028
324300     PERFORM                                                      32430028
324400         WITH TEST AFTER                                          32440028
324500         VARYING PV-RETRY-COUNTER                                 32450028
324600         FROM 1 BY 1                                              32460028
324700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               32470028
324800             OR (SQLCODE = +0)                                    32480028
324900             OR (SQLCODE = +100))                                 32490028
325000                                                                  32500028
325100         EXEC SQL                                                 32510028
325200              FETCH SHPTPO-CSR                                    32520028
325300              INTO  :SHPTPO-PO-NBR                                32530028
325400                 ,  :SHPTPO-REC-SEQ-NBR                           32540028
325500                 ,  :SHPTPO-EXPTED-CART-CNT                       32550028
325600                 ,  :SHPTPO-ACTL-CART-CNT                         32560028
325700                 ,  :SHPTPO-VEND-CART-CT                          32570028
325800         END-EXEC                                                 32580028
325900                                                                  32590028
326000         EVALUATE TRUE                                            32600028
326100             WHEN SQLCODE = +0                                    32610028
326200             WHEN SQLCODE = -904                                  32620028
326300             WHEN SQLCODE = -913                                  32630028
326400                  CONTINUE                                        32640028
326500                                                                  32650028
326600             WHEN SQLCODE = +100                                  32660028
326700                 SET PS-END-OF-CURSOR TO TRUE                     32670028
326800                                                                  32680028
326900             WHEN SQLWARN0 NOT = SPACES                           32690028
327000             WHEN SQLCODE < +0                                    32700028
327100             WHEN SQLCODE > +0                                    32710028
327200                  MOVE '5480-FETCH-CURSOR'                        32720028
327300                                  TO DP013-PARAGRAPH              32730028
327400                  MOVE 'UNSUCCESSFUL FETCH ON TSHPTPO CURSOR'     32740028
327500                                  TO DP013-MESSAGE-TEXT (1)       32750028
327600                  MOVE SQLCA      TO DP013-SQLCA                  32760028
327700                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     32770028
327800                  SET DP013-DB2-ABEND                             32780028
327900                      DP013-XCTL-DISPLAY-RESTART                  32790028
328000                                  TO TRUE                         32800028
328100                  PERFORM DP013-0000-PROCESS-ABEND                32810028
328200         END-EVALUATE                                             32820028
328300     END-PERFORM.                                                 32830028
328400                                                                  32840028
328500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        32850028
328600         MOVE '5480-FETCH-CURSOR' TO DP013-PARAGRAPH              32860028
328700         MOVE 'MAX RETRIES EXCEEDED ON FETCH TSHPTPO CURSOR'      32870028
328800                                  TO DP013-MESSAGE-TEXT (1)       32880028
328900         MOVE SQLCA               TO DP013-SQLCA                  32890028
329000         MOVE 'TSHPTPO'           TO DP013-DB2-TABLE-NAME (1)     32900028
329100         SET DP013-DB2-ABEND                                      32910028
329200             DP013-XCTL-DISPLAY-RESTART                           32920028
329300                                  TO TRUE                         32930028
329400         PERFORM DP013-0000-PROCESS-ABEND                         32940028
329500     END-IF.                                                      32950028
329600                                                                  32960028
329700     IF SQLCODE = +0                                              32970028
329800         IF SHPTPO-REC-SEQ-NBR = 0                                32980028
329900             CONTINUE                                             32990028
330000         ELSE                                                     33000028
330100             MOVE ASC-KEY-TRIP-ID        TO DK-TRIP-ID            33010028
330200             PERFORM 5600-SELECT-TTRIPST                          33020028
330300             IF TRSTYP-PRTY-CDE > PC-49                           33030028
330400                 STRING TRIPST-STATUS-DTE DELIMITED BY SIZE,      33040028
330500                        '-' DELIMITED BY SIZE,                    33050028
330600                        TRIPST-STATUS-TME DELIMITED BY SIZE,      33060028
330700                        '.000000' DELIMITED BY SIZE               33070028
330800                        INTO                RECEIV-REC-TMST       33080028
330900                 PERFORM 5530-UPDATE-RECEIVER                     33090028
331000             END-IF                                               33100028
331100         END-IF                                                   33110028
331200                                                                  33120028
331300     END-IF.                                                      33130028
331400                                                                  33140028
331500******************************************************************33150028
331600** WHEN THERE ARE NO MORE SHIPMENTS ASSIGNED TO THIS TRIP,      **33160028
331700** STATUS THE TRIP DELETED.                                     **33170028
331800******************************************************************33180028
331900 5500-STATUS-TRIP-DELETED.                                        33190028
332000                                                                  33200028
332100     MOVE PV-SAVE-TRIP-ID        TO DK-TRIP-ID.                   33210028
332200     PERFORM 5600-SELECT-TTRIPST.                                 33220028
332300                                                                  33230028
332400     MOVE PC-DELETED-STATUS-CDE  TO TRIPST-TRIP-STATUS-CDE.       33240028
332500                                                                  33250028
332600     PERFORM 5700-INSERT-TTRIPST.                                 33260028
332700                                                                  33270028
332800                                                                  33280028
332900 5530-UPDATE-RECEIVER.                                            33290028
333000                                                                  33300028
333100     PERFORM                                                      33310028
333200         WITH TEST AFTER                                          33320028
333300         VARYING PV-RETRY-COUNTER                                 33330028
333400         FROM 1 BY 1                                              33340028
333500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33350028
333600             OR (SQLCODE = +0))                                   33360028
333700                                                                  33370028
333800         EXEC SQL                                                 33380028
333900           UPDATE TRECEIV                                         33390028
334000              SET REC_TMST         = :RECEIV-REC-TMST,            33400028
334100                  UPD_TMST         = CURRENT TIMESTAMP,           33410028
334200                  UPD_UID          = :DP020-USERID,               33420028
334300                  UPD_PGM_ID       = :PC-CURRENT-PROGRAM-NAME     33430028
334400           WHERE  ORD_NBR      = :SHPTPO-PO-NBR                   33440028
334500             AND  REC_SEQ_NBR  = :SHPTPO-REC-SEQ-NBR              33450028
334600         END-EXEC                                                 33460028
334700                                                                  33470028
334800         EVALUATE TRUE                                            33480028
334900             WHEN SQLCODE = +0                                    33490028
335000             WHEN SQLCODE = -904                                  33500028
335100             WHEN SQLCODE = -913                                  33510028
335200                 CONTINUE                                         33520028
335300                                                                  33530028
335400             WHEN SQLWARN0 NOT = SPACE                            33540028
335500             WHEN SQLCODE < +0                                    33550028
335600             WHEN SQLCODE > +0                                    33560028
335700                 MOVE '5530-UPDATE-RECEIVER'                      33570028
335800                                 TO DP013-PARAGRAPH               33580028
335900                 MOVE 'UPDATE ON RECEIPTS TABLE'                  33590028
336000                                 TO DP013-MESSAGE-TEXT (1)        33600028
336100                 MOVE SQLCA      TO DP013-SQLCA                   33610028
336200                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      33620028
336300                     SET DP013-DB2-ABEND                          33630028
336400                         DP013-XCTL-DISPLAY-RESTART               33640028
336500                                     TO TRUE                      33650028
336600                 PERFORM DP013-0000-PROCESS-ABEND                 33660028
336700         END-EVALUATE                                             33670028
336800     END-PERFORM.                                                 33680028
336900                                                                  33690028
337000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        33700028
337100         MOVE '5530-UPDATE-RECEIVER'                              33710028
337200                                  TO DP013-PARAGRAPH              33720028
337300         MOVE 'MAX RETRIES EXCEEDED ON INSERT ON TRECEIV'         33730028
337400                                  TO DP013-MESSAGE-TEXT (1)       33740028
337500         MOVE SQLCA               TO DP013-SQLCA                  33750028
337600         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     33760028
337700         SET DP013-DB2-ABEND                                      33770028
337800             DP013-XCTL-DISPLAY-RESTART                           33780028
337900                                  TO TRUE                         33790028
338000         PERFORM DP013-0000-PROCESS-ABEND                         33800028
338100     END-IF.                                                      33810028
338200                                                                  33820028
338300*----------------------------------------------------------------*33830028
338400*  SELECT CURRENT TRIP STATUS ROW                                *33840028
338500*----------------------------------------------------------------*33850028
338600 5600-SELECT-TTRIPST.                                             33860028
338700                                                                  33870028
338800     PERFORM                                                      33880028
338900         WITH TEST AFTER                                          33890028
339000         VARYING PV-RETRY-COUNTER                                 33900028
339100         FROM 1 BY 1                                              33910028
339200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33920028
339300             OR (SQLCODE = +0))                                   33930028
339400                                                                  33940028
339500         EXEC SQL                                                 33950028
339600             SELECT  A.TRIP_ID,                                   33960028
339700                     A.TRIP_STATUS_CDE,                           33970028
339800                     A.STATUS_DTE,                                33980028
339900                     A.STATUS_TME,                                33990028
340000                     A.STATUS_UID,                                34000028
340100                     A.OPER_UNT_ID,                               34010028
340200                     A.FCLTY_ID,                                  34020028
340300                     A.FCLTY_AREA_ID,                             34030028
340400                     B.PRTY_CDE                                   34040028
340500              INTO   :TRIPST-TRIP-ID,                             34050028
340600                     :TRIPST-TRIP-STATUS-CDE,                     34060028
340700                     :TRIPST-STATUS-DTE,                          34070028
340800                     :TRIPST-STATUS-TME,                          34080028
340900                     :TRIPST-STATUS-UID,                          34090028
341000                     :TRIPST-OPER-UNT-ID,                         34100028
341100                     :TRIPST-FCLTY-ID,                            34110028
341200                     :TRIPST-FCLTY-AREA-ID,                       34120028
341300                     :TRSTYP-PRTY-CDE                             34130028
341400              FROM  TTRIPST A,                                    34140028
341500                    TTRSTYP B                                     34150028
341600             WHERE  A.TRIP_ID          = :DK-TRIP-ID              34160028
341700               AND  B.PRTY_CDE =                                  34170028
341800                  (SELECT MAX(D.PRTY_CDE)                         34180028
341900                     FROM TTRIPST C,                              34190028
342000                          TTRSTYP D                               34200028
342100                    WHERE C.TRIP_ID         = A.TRIP_ID           34210028
342200                      AND C.TRIP_STATUS_CDE ^= 'DE'               34220028
342300                      AND C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  34230028
342400               AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE         34240028
342500         END-EXEC                                                 34250028
342600                                                                  34260028
342700         EVALUATE TRUE                                            34270028
342800             WHEN SQLCODE = +0                                    34280028
342900             WHEN SQLCODE = -904                                  34290028
343000             WHEN SQLCODE = -913                                  34300028
343100                 CONTINUE                                         34310028
343200                                                                  34320028
343300             WHEN SQLWARN0 NOT = SPACES                           34330028
343400             WHEN SQLCODE < +0                                    34340028
343500             WHEN SQLCODE > +0                                    34350028
343600                 MOVE '5600-SELECT-TTRIPST'                       34360028
343700                                   TO DP013-PARAGRAPH             34370028
343800                 MOVE 'SELECT A ROW ON TTRIPST'                   34380028
343900                                   TO DP013-MESSAGE-TEXT(1)       34390028
344000                 MOVE SQLCA        TO DP013-SQLCA                 34400028
344100                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    34410028
344200                 MOVE 'TTRSTYP'    TO DP013-DB2-TABLE-NAME (2)    34420028
344300                 SET DP013-DB2-ABEND                              34430028
344400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           34440028
344500                 PERFORM DP013-0000-PROCESS-ABEND                 34450028
344600         END-EVALUATE                                             34460028
344700     END-PERFORM.                                                 34470028
344800                                                                  34480028
344900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        34490028
345000         MOVE '5600-INSERT-TTRIPST'                               34500028
345100                                   TO DP013-PARAGRAPH             34510028
345200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              34520028
345300                                   TO DP013-MESSAGE-TEXT (1)      34530028
345400         MOVE 'TO SELECT A TTRIPST ROW'                           34540028
345500                                   TO DP013-MESSAGE-TEXT (2)      34550028
345600         MOVE SQLCA                TO DP013-SQLCA                 34560028
345700         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    34570028
345800         MOVE 'TTRSTYP'            TO DP013-DB2-TABLE-NAME (2)    34580028
345900         SET DP013-DB2-ABEND                                      34590028
346000             DP013-XCTL-DISPLAY-RESTART                           34600028
346100                                   TO TRUE                        34610028
346200         PERFORM DP013-0000-PROCESS-ABEND                         34620028
346300     END-IF.                                                      34630028
346400                                                                  34640028
346500*----------------------------------------------------------------*34650028
346600*  INSERT A ROW ON THE VEHICLE TRIP STATUS TABLE                 *34660028
346700*----------------------------------------------------------------*34670028
346800 5700-INSERT-TTRIPST.                                             34680028
346900                                                                  34690028
347000         EXEC SQL                                                 34700028
347100             INSERT  INTO TTRIPST                                 34710028
347200                    (TRIP_ID,                                     34720028
347300                     TRIP_STATUS_CDE,                             34730028
347400                     STATUS_DTE,                                  34740028
347500                     STATUS_TME,                                  34750028
347600                     STATUS_UID,                                  34760028
347700                     OPER_UNT_ID,                                 34770028
347800                     FCLTY_ID,                                    34780028
347900                     FCLTY_AREA_ID)                               34790028
348000            VALUES  (:TRIPST-TRIP-ID,                             34800028
348100                     :TRIPST-TRIP-STATUS-CDE,                     34810028
348200                     CURRENT DATE,                                34820028
348300                     CURRENT TIME,                                34830028
348400                     :DP020-USERID,                               34840028
348500                     :TRIPST-OPER-UNT-ID,                         34850028
348600                     :TRIPST-FCLTY-ID,                            34860028
348700                     :TRIPST-FCLTY-AREA-ID)                       34870028
348800         END-EXEC.                                                34880028
348900                                                                  34890028
349000         EVALUATE TRUE                                            34900028
349100             WHEN SQLCODE = +0                                    34910028
349200             WHEN SQLCODE = -803                                  34920028
349300             WHEN SQLCODE = -904                                  34930028
349400             WHEN SQLCODE = -913                                  34940028
349500                 CONTINUE                                         34950028
349600                                                                  34960028
349700             WHEN SQLWARN0 NOT = SPACES                           34970028
349800             WHEN SQLCODE < +0                                    34980028
349900             WHEN SQLCODE > +0                                    34990028
350000                 MOVE '5700-INSERT-TTRIPST'                       35000028
350100                                   TO DP013-PARAGRAPH             35010028
350200                 MOVE 'INSERT A ROW ON TTRIPST'                   35020028
350300                                   TO DP013-MESSAGE-TEXT(1)       35030028
350400                 MOVE SQLCA        TO DP013-SQLCA                 35040028
350500                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    35050028
350600                 SET DP013-DB2-ABEND                              35060028
350700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35070028
350800                 PERFORM DP013-0000-PROCESS-ABEND                 35080028
350900         END-EVALUATE.                                            35090028
351000                                                                  35100028
351100                                                                  35110028
351200/                                                                 35120028
351300*----------------------------------------------------------------*35130028
351400* SELECT A VEHICLE                                               *35140028
351500*----------------------------------------------------------------*35150028
351600 5800-SELECT-TVEHICL.                                             35160028
351700                                                                  35170028
351800     PERFORM                                                      35180028
351900         WITH TEST AFTER                                          35190028
352000         VARYING PV-RETRY-COUNTER                                 35200028
352100         FROM 1 BY 1                                              35210028
352200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35220028
352300            OR (SQLCODE = +0)                                     35230028
352400            OR (SQLCODE = +100))                                  35240028
352500                                                                  35250028
352600         EXEC SQL                                                 35260028
352700          SELECT CURR_STATUS_CDE                                  35270028
352800           INTO  :VEHICL-CURR-STATUS-CDE                          35280028
352900           FROM   TVEHICL A                                       35290028
353000           WHERE  A.VEH_NBR       = :ASC-KEY-TRLR-NBR             35300028
353100             AND  A.OWNER_SCAC_ID = :ASC-KEY-ORIGINAL-SCAC-CDE    35310028
353200         END-EXEC                                                 35320028
353300                                                                  35330028
353400         EVALUATE TRUE                                            35340028
353500             WHEN SQLCODE = +0                                    35350028
353600             WHEN SQLCODE = +100                                  35360028
353700             WHEN SQLCODE = -904                                  35370028
353800             WHEN SQLCODE = -913                                  35380028
353900                 CONTINUE                                         35390028
354000                                                                  35400028
354100             WHEN SQLWARN0 NOT = SPACES                           35410028
354200             WHEN SQLCODE < ZERO                                  35420028
354300             WHEN SQLCODE > ZERO                                  35430028
354400                 MOVE '5800-SELECT-TVEHICL'                       35440028
354500                                   TO DP013-PARAGRAPH             35450028
354600                 MOVE 'SELECT ON TVEHICL'                         35460028
354700                                   TO DP013-MESSAGE-TEXT (1)      35470028
354800                 MOVE SQLCA        TO DP013-SQLCA                 35480028
354900                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    35490028
355000                 SET DP013-DB2-ABEND                              35500028
355100                     DP013-XCTL-DISPLAY-RESTART                   35510028
355200                                   TO TRUE                        35520028
355300                 PERFORM DP013-0000-PROCESS-ABEND                 35530028
355400         END-EVALUATE                                             35540028
355500     END-PERFORM.                                                 35550028
355600                                                                  35560028
355700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35570028
355800         MOVE '5800-SELECT-TVEHICL'                               35580028
355900                                   TO DP013-PARAGRAPH             35590028
356000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35600028
356100                                   TO DP013-MESSAGE-TEXT (1)      35610028
356200         MOVE 'A VEHICLE ROW   '   TO DP013-MESSAGE-TEXT (2)      35620028
356300         MOVE SQLCA                TO DP013-SQLCA                 35630028
356400         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    35640028
356500         SET DP013-DB2-ABEND                                      35650028
356600             DP013-XCTL-DISPLAY-RESTART                           35660028
356700                                   TO TRUE                        35670028
356800         PERFORM DP013-0000-PROCESS-ABEND                         35680028
356900     END-IF.                                                      35690028
357000                                                                  35700028
357100/                                                                 35710028
357200                                                                  35720028
357210*----------------------------------------------------------------*35721039
357220* OPER NAME BASED ON OPER FROM COMMAREA                          *35722039
357221* DMH - ADDED 10/11/18                                           *35722140
357230*----------------------------------------------------------------*35723039
357240 5810-SELECT-OPER-NAME.                                           35724039
357250                                                                  35725039
357251     MOVE ASC-KEY-OPER-UNT-ID TO XLT00010-LOC-NBR                 35725139
357252                                                                  35725239
357260     PERFORM                                                      35726039
357270         WITH TEST AFTER                                          35727039
357280         VARYING PV-RETRY-COUNTER                                 35728039
357290         FROM 1 BY 1                                              35729039
357291         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35729139
357292            OR (SQLCODE = +0)                                     35729239
357293            OR (SQLCODE = +100))                                  35729339
357294                                                                  35729439
357295         EXEC SQL                                                 35729539
357296          SELECT LOC_NM                                           35729639
357297               , E_BUS_IND                                        35729739
357298           INTO  :XLT00010-LOC-NM                                 35729839
357299               , :XLT00010-E-BUS-IND                              35729939
357300           FROM   XLT_LOC                                         35730039
357301           WHERE  LOC_NBR         = :XLT00010-LOC-NBR             35730139
357303         END-EXEC                                                 35730339
357304                                                                  35730439
357305         EVALUATE TRUE                                            35730539
357306             WHEN SQLCODE = +0                                    35730639
357307                  MOVE XLT00010-LOC-NM    TO ASC-OPER-NAME        35730739
357308                  MOVE XLT00010-E-BUS-IND TO ASC-E-BUS-IND        35730839
357309                                                                  35730939
357311             WHEN SQLCODE = -904                                  35731139
357312             WHEN SQLCODE = -913                                  35731239
357313                  MOVE SPACES             TO XLT00010-LOC-NM      35731339
357314                  MOVE SPACES             TO XLT00010-E-BUS-IND   35731439
357315                  MOVE XLT00010-LOC-NM    TO ASC-OPER-NAME        35731539
357316                  MOVE XLT00010-E-BUS-IND TO ASC-E-BUS-IND        35731639
357318                                                                  35731839
357319             WHEN SQLCODE = +100                                  35731939
357320                  MOVE 'UNKNOWN'          TO XLT00010-LOC-NM      35732039
357321                  MOVE SPACES             TO XLT00010-E-BUS-IND   35732139
357322                  MOVE XLT00010-LOC-NM    TO ASC-OPER-NAME        35732239
357323                  MOVE XLT00010-E-BUS-IND TO ASC-E-BUS-IND        35732339
357324                                                                  35732439
357325             WHEN SQLWARN0 NOT = SPACES                           35732539
357326             WHEN SQLCODE < ZERO                                  35732639
357327             WHEN SQLCODE > ZERO                                  35732739
357328                 MOVE '5810-SELECT-OPER-NAME'                     35732839
357329                                   TO DP013-PARAGRAPH             35732939
357330                 MOVE 'SELECT ON XLT_LOC'                         35733039
357331                                   TO DP013-MESSAGE-TEXT (1)      35733139
357332                 MOVE SQLCA        TO DP013-SQLCA                 35733239
357333                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)    35733339
357334                 SET DP013-DB2-ABEND                              35733439
357335                     DP013-XCTL-DISPLAY-RESTART                   35733539
357336                                   TO TRUE                        35733639
357337                 PERFORM DP013-0000-PROCESS-ABEND                 35733739
357338         END-EVALUATE                                             35733839
357339     END-PERFORM.                                                 35733939
357340                                                                  35734039
357341     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35734139
357342         MOVE '5810-SELECT-OPER-NAME'                             35734240
357343                                   TO DP013-PARAGRAPH             35734339
357344         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35734439
357345                                   TO DP013-MESSAGE-TEXT (1)      35734539
357346         MOVE 'A XLT_LOC       '   TO DP013-MESSAGE-TEXT (2)      35734639
357347         MOVE SQLCA                TO DP013-SQLCA                 35734739
357348         MOVE 'XLT_LOC'            TO DP013-DB2-TABLE-NAME (1)    35734839
357349         SET DP013-DB2-ABEND                                      35734939
357350             DP013-XCTL-DISPLAY-RESTART                           35735039
357351                                   TO TRUE                        35735139
357352         PERFORM DP013-0000-PROCESS-ABEND                         35735239
357353     END-IF.                                                      35735339
357354                                                                  35735439
357355                                                                  35735542
357357*----------------------------------------------------------------*35735742
357358* OPER NUMBER BASED ON THE TRIP THE SHIPMENT IS ASSIGNED TO      *35735842
357359* DMH - ADDED 10/11/18                                           *35735942
357360*----------------------------------------------------------------*35736042
357361 5820-GET-SHPMT-OPER.                                             35736142
357363                                                                  35736342
357364     MOVE ASC-TRIP-ID  (ASC-BLK-SUB ASC-ITEM-SUB)                 35736447
357365                              TO TRIPST-TRIP-ID                   35736547
357366                                                                  35736647
357367     PERFORM                                                      35736747
357368         WITH TEST AFTER                                          35736847
357369         VARYING PV-RETRY-COUNTER                                 35736947
357370         FROM 1 BY 1                                              35737047
357371         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35737147
357372            OR (SQLCODE = +0)                                     35737247
357373            OR (SQLCODE = -305)                                   35737399
357374            OR (SQLCODE = +100))                                  35737499
357375                                                                  35737599
357376         EXEC SQL                                                 35737699
357377          SELECT DISTINCT                                         35737799
357378                 A.OPER_UNT_ID                                    35737899
357379               , B.E_BUS_IND                                      35737999
357380           INTO  :TRIPST-OPER-UNT-ID                              35738099
357381               , :XLT00010-E-BUS-IND                              35738199
357382           FROM   TTRIPST A                                       35738299
357383                , XLT_LOC B                                       35738399
357384           WHERE  A.TRIP_ID       = :TRIPST-TRIP-ID               35738499
357385             AND  A.OPER_UNT_ID   = B.LOC_NBR                     35738599
357386         END-EXEC                                                 35738699
357387                                                                  35738799
357388         EVALUATE TRUE                                            35738899
357389             WHEN SQLCODE = +0                                    35738999
357390                  MOVE TRIPST-OPER-UNT-ID                         35739099
357391                    TO ASC-TRIP-OPER (ASC-BLK-SUB ASC-ITEM-SUB)   35739199
357392                  MOVE XLT00010-E-BUS-IND                         35739299
357393                    TO ASC-TRIP-OPER-E-BUS-SW                     35739399
357394                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35739460
357395                                                                  35739560
357396             WHEN SQLCODE = +100                                  35739699
357397             WHEN SQLCODE = -305                                  35739799
357398                  MOVE  ZEROES  TO  TRIPST-OPER-UNT-ID            35739899
357399                  MOVE  SPACES  TO  XLT00010-E-BUS-IND            35739999
357400                                                                  35740099
357402             WHEN SQLCODE = -904                                  35740299
357403             WHEN SQLCODE = -913                                  35740399
357404                  CONTINUE                                        35740499
357405                                                                  35740542
357406             WHEN SQLWARN0 NOT = SPACES                           35740642
357407             WHEN SQLCODE < ZERO                                  35740742
357408             WHEN SQLCODE > ZERO                                  35740842
357409                  MOVE TRIPST-TRIP-ID  TO  PV-DISP-TRIP           35740998
357410                 MOVE '5820-GET-SHPMT-OPER'                       35741042
357411                                   TO DP013-PARAGRAPH             35741142
357412                 MOVE 'SELECT ON XLT_LOC'                         35741242
357413                                   TO DP013-MESSAGE-TEXT (1)      35741342
357414                 STRING 'TRIP: ' PV-DISP-TRIP                     35741497
357415                                      DELIMITED BY SIZE           35741597
357416                                 INTO DP013-MESSAGE-TEXT (2)      35741697
357417                 MOVE SQLCA        TO DP013-SQLCA                 35741797
357418                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)    35741897
357419                 SET DP013-DB2-ABEND                              35741997
357420                     DP013-XCTL-DISPLAY-RESTART                   35742097
357421                                   TO TRUE                        35742197
357422                 PERFORM DP013-0000-PROCESS-ABEND                 35742297
357423         END-EVALUATE                                             35742397
357424     END-PERFORM.                                                 35742497
357425                                                                  35742597
357426     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35742697
357427         MOVE '5820-GET-SHPMT-OPER'                               35742797
357428                                   TO DP013-PARAGRAPH             35742897
357429         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35742997
357430                                   TO DP013-MESSAGE-TEXT (1)      35743097
357431         MOVE 'A XLT_LOC       '   TO DP013-MESSAGE-TEXT (2)      35743197
357432         MOVE SQLCA                TO DP013-SQLCA                 35743297
357433         MOVE 'XLT_LOC'            TO DP013-DB2-TABLE-NAME (1)    35743397
357434         SET DP013-DB2-ABEND                                      35743497
357435             DP013-XCTL-DISPLAY-RESTART                           35743597
357436                                   TO TRUE                        35743697
357437         PERFORM DP013-0000-PROCESS-ABEND                         35743797
357438     END-IF.                                                      35743897
357439                                                                  35743997
357440                                                                  35744097
357441*----------------------------------------------------------------*35744197
357442* FOR PO'S ON THE SHIPMENT THAT HAVE RECEIVER NUMBERS GET THE    *35744297
357443* CURRENT OPER FOR THE RECEIVERS                                 *35744397
357444* DMH - ADDED 10/11/18                                           *35744497
357445*----------------------------------------------------------------*35744597
357446 5830-GET-SHPMT-PO-CURR-OPER.                                     35744697
357447                                                                  35744797
357448     MOVE ASC-SHIPT-ID (ASC-BLK-SUB ASC-ITEM-SUB)                 35744897
357449                              TO SHPTPO-SHIPT-ID                  35744997
357450                                                                  35745097
357451     PERFORM                                                      35745197
357452         WITH TEST AFTER                                          35745297
357453         VARYING PV-RETRY-COUNTER                                 35745397
357454         FROM 1 BY 1                                              35745497
357455         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               35745597
357456            OR (SQLCODE = +0)                                     35745697
357457            OR (SQLCODE = -811)                                   35745797
357458            OR (SQLCODE = +100))                                  35745897
357459                                                                  35745997
357460         EXEC SQL                                                 35746097
357461          SELECT DISTINCT                                         35746197
357462                 B.CURR_OPER_UNT_ID                               35746297
357463                ,C.E_BUS_IND                                      35746397
357464           INTO  :RECEIV-CURR-OPER-UNT-ID                         35746497
357465                ,:XLT00010-E-BUS-IND                              35746597
357466           FROM   TSHPTPO A                                       35746697
357467                , TRECEIV B                                       35746797
357468                , XLT_LOC C                                       35746897
357469           WHERE  A.SHIPT_ID         = :SHPTPO-SHIPT-ID           35746997
357470             AND  A.PO_NBR           = B.ORD_NBR                  35747097
357471             AND  A.REC_SEQ_NBR      = B.REC_SEQ_NBR              35747197
357472             AND  B.CURR_OPER_UNT_ID = C.LOC_NBR                  35747297
357473           ORDER BY C.E_BUS_IND DESC                              35747397
357474         END-EXEC                                                 35747497
357475                                                                  35747597
357476         EVALUATE TRUE                                            35747697
357477             WHEN SQLCODE = +0                                    35747797
357478             WHEN SQLCODE = -904                                  35747897
357479             WHEN SQLCODE = -913                                  35747997
357480                  SET  ASC-SINGLE-OPER(ASC-BLK-SUB ASC-ITEM-SUB)  35748097
357481                       TO TRUE                                    35748197
357482                  MOVE XLT00010-E-BUS-IND                         35748297
357483                    TO ASC-TRIP-OPER-E-BUS-SW                     35748399
357484                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35748497
357485                                                                  35748597
357486             WHEN SQLCODE = +100                                  35748697
357487                  MOVE  TRIPST-OPER-UNT-ID                        35748797
357488                    TO  RECEIV-CURR-OPER-UNT-ID                   35748897
357489                  SET  ASC-SINGLE-OPER(ASC-BLK-SUB ASC-ITEM-SUB)  35748997
357490                       TO TRUE                                    35749097
357491                  MOVE XLT00010-E-BUS-IND                         35749197
357492                    TO ASC-TRIP-OPER-E-BUS-SW                     35749299
357493                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35749397
357494                                                                  35749497
357495             WHEN SQLCODE = -811                                  35749597
357496                  SET  ASC-MULT-OPER(ASC-BLK-SUB ASC-ITEM-SUB)    35749697
357497                       TO TRUE                                    35749797
357498                  MOVE XLT00010-E-BUS-IND                         35749897
357499                    TO ASC-TRIP-OPER-E-BUS-SW                     35749999
357500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   35750097
357501                                                                  35750197
357502             WHEN SQLWARN0 NOT = SPACES                           35750297
357503             WHEN SQLCODE < ZERO                                  35750397
357504             WHEN SQLCODE > ZERO                                  35750497
357505                 MOVE '5830-GET-SHPMT-PO-CURR-OPER'               35750597
357506                                   TO DP013-PARAGRAPH             35750697
357507                 MOVE 'SELECT ON XLT_LOC'                         35750797
357508                                   TO DP013-MESSAGE-TEXT (1)      35750897
357509                 MOVE SQLCA        TO DP013-SQLCA                 35750997
357510                 MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)    35751097
357511                 SET DP013-DB2-ABEND                              35751197
357512                     DP013-XCTL-DISPLAY-RESTART                   35751297
357513                                   TO TRUE                        35751397
357514                 PERFORM DP013-0000-PROCESS-ABEND                 35751497
357515         END-EVALUATE                                             35751597
357516     END-PERFORM.                                                 35751697
357517                                                                  35751797
357518     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35751897
357519         MOVE '5830-GET-SHPMT-PO-CURR-OPER'                       35751997
357520                                   TO DP013-PARAGRAPH             35752097
357521         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     35752197
357522                                   TO DP013-MESSAGE-TEXT (1)      35752297
357523         MOVE 'A XLT_LOC       '   TO DP013-MESSAGE-TEXT (2)      35752397
357524         MOVE SQLCA                TO DP013-SQLCA                 35752497
357525         MOVE 'XLT_LOC'            TO DP013-DB2-TABLE-NAME (1)    35752597
357526         SET DP013-DB2-ABEND                                      35752697
357527             DP013-XCTL-DISPLAY-RESTART                           35752797
357528                                   TO TRUE                        35752897
357529         PERFORM DP013-0000-PROCESS-ABEND                         35752997
357530     END-IF.                                                      35753097
357531                                                                  35753197
357532                                                                  35753297
357533******************************************************************35753399
357534*CHECK TO MAKE SURE THAT ALL RECEIVERS ON SHIPMENT ARE TRANSCRIB *35753499
357535*LINE WILL DISPLAY IN YELLOW IF NOT TRANSCRIBED                  *35753599
357536* DMH - 10/26/18                                                 *35753699
357537******************************************************************35753799
357538 5835-CHECK-TRANSCRIBED.                                          35753899
357539                                                                  35753999
357540     MOVE ASC-FB-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)                  35754099
357541                               TO  PV-TRANS-SCAC.                 35754199
357542     MOVE ASC-FREIGHT-BILL (ASC-BLK-SUB ASC-ITEM-SUB)             35754299
357543                               TO  PV-TRANS-PRO.                  35754399
357544     MOVE ASC-BILL-OF-LADING (ASC-BLK-SUB ASC-ITEM-SUB)           35754499
357545                               TO  PV-TRANS-BOL.                  35754599
357546                                                                  35754699
357547     EXEC SQL                                                     35754799
357548          SELECT T1.PO_NBR                                        35754899
357549               , T1.REC_SEQ_NBR                                   35754999
357550               , TRECITM_COUNT                                    35755099
357551                                                                  35755199
357552            INTO :PV-PO-HOLD                                      35755299
357553               , :PV-RCVR-HOLD                                    35755399
357554               , :PV-TRANSCRIBE-COUNT                             35755499
357555            FROM                                                  35755599
357556                (SELECT B.PO_NBR                                  35755699
357557                      , B.REC_SEQ_NBR                             35755799
357558                   FROM TSHIPMT A                                 35755899
357559                      , TSHPTPO B                                 35755999
357560                  WHERE A.PRO_SCAC_ID = :PV-TRANS-SCAC            35756099
357561                    AND A.PRO_NBR     = :PV-TRANS-PRO             35756199
357562                    AND A.BOL_NBR     = :PV-TRANS-BOL             35756299
357563                    AND A.SHIPT_ID    =  B.SHIPT_ID               35756399
357564                ) AS T1                                           35756499
357565                  LEFT OUTER JOIN                                 35756599
357566                (SELECT D.PO_NBR                                  35756699
357567                      , D.REC_SEQ_NBR                             35756799
357568                      , COUNT(F.ORD_LNE_NBR) AS TRECITM_COUNT     35756899
357569                   FROM TSHIPMT C                                 35756999
357570                      , TSHPTPO D                                 35757099
357571                      , TRECEIV E                                 35757199
357572                      , TRECITM F                                 35757299
357573                  WHERE C.PRO_SCAC_ID = :PV-TRANS-SCAC            35757399
357574                    AND C.PRO_NBR     = :PV-TRANS-PRO             35757499
357575                    AND C.BOL_NBR     = :PV-TRANS-BOL             35757599
357576                    AND C.SHIPT_ID    =  D.SHIPT_ID               35757699
357577                    AND D.PO_NBR    = E.ORD_NBR                   35757799
357578                    AND D.REC_SEQ_NBR  =  E.REC_SEQ_NBR           35757899
357579                    AND E.ORD_NBR      = F.ORD_NBR                35757999
357580                    AND E.REC_SEQ_NBR  = F.REC_SEQ_NBR            35758099
357581                  GROUP BY D.PO_NBR                               35758199
357582                      , D.REC_SEQ_NBR                             35758299
357583                ) AS T2                                           35758399
357584                  ON T1.PO_NBR  =  T2.PO_NBR    AND               35758499
357585                     T1.REC_SEQ_NBR =  T2.REC_SEQ_NBR             35758599
357586          ORDER BY 3 DESC                                         35758699
357587          FETCH FIRST 1 ROW ONLY                                  35758799
357588           WITH UR                                                35758899
357589     END-EXEC.                                                    35758999
357590                                                                  35759099
357591     EVALUATE TRUE                                                35759199
357592         WHEN SQLCODE = ZERO                                      35759299
357593         WHEN SQLCODE = -811                                      35759399
357594              SET ASC-RCVRS-TRANSCRIBED-YES                       35759499
357595                                   (ASC-BLK-SUB ASC-ITEM-SUB)     35759599
357596                               TO  TRUE                           35759699
357597             CONTINUE                                             35759799
357598         WHEN SQLCODE = +100                                      35759899
357599         WHEN SQLCODE = -305                                      35759999
357600              SET ASC-RCVRS-TRANSCRIBED-NO                        35760099
357601                                   (ASC-BLK-SUB ASC-ITEM-SUB)     35760199
357602                               TO  TRUE                           35760299
357613         WHEN SQLWARN0 NOT = SPACES                               35761399
357614         WHEN SQLCODE  NOT = ZERO                                 35761499
357615             MOVE SQLCODE            TO PV-DISP-SQLCODE           35761599
357616             MOVE '5835-CHECK-TRANSCRIBED  '                      35761699
357617                                 TO DP013-PARAGRAPH               35761799
357618             MOVE 'CHECK RCVRS ON SHPMT ARE TRANSCRIBED'          35761899
357619                                 TO DP013-MESSAGE-TEXT (1)        35761999
357620             STRING PV-TRANS-SCAC '-'                             35762099
357621                    PV-TRANS-PRO  '-'                             35762199
357622                    PV-TRANS-BOL  '  -SQLCODE:'                   35762299
357623                    PV-DISP-SQLCODE DELIMITED BY SIZE             35762399
357624                               INTO DP013-MESSAGE-TEXT(2)         35762499
357625             MOVE 'TSHIPMT     ' TO DP013-DB2-TABLE-NAME (1)      35762599
357626             MOVE 'TSHPTPO     ' TO DP013-DB2-TABLE-NAME (2)      35762699
357627             MOVE 'TRECEIV     ' TO DP013-DB2-TABLE-NAME (3)      35762799
357628             MOVE 'TRECITM     ' TO DP013-DB2-TABLE-NAME (4)      35762899
357629             SET DP013-DB2-ABEND                                  35762999
357630                                 TO TRUE                          35763099
357631             SET DP013-XCTL-DISPLAY-RESTART                       35763199
357632                                 TO TRUE                          35763299
357633             PERFORM DP013-0000-PROCESS-ABEND                     35763399
357634     END-EVALUATE.                                                35763499
357635                                                                  35763599
357636                                                                  35763699
357637******************************************************************35763799
357638* IF SIGN-ON OPER IS A DC - AND THE SHIPMENT THAT IS SELECTED HAS*35763899
357639* EFC RECEIVERS - UPDATE THE CURR OPER ON THE RECEIVERS TO BE THE*35763999
357640* DC NUMBER                                                      *35764099
357641******************************************************************35764199
357642 5840-UPDATE-EFC-CURR-TO-DC.                                      35764299
357643                                                                  35764399
357644     PERFORM 5900-OPEN-EFC-RCVR-CSR.                              35764499
357645     PERFORM 5910-FETCH-EFC-RCVR-CSR                              35764599
357646       UNTIL PS-EOF-EFC-RCVR-CSR                                  35764699
357647          OR PS-ERROR.                                            35764799
357648     PERFORM 5920-CLOSE-EFC-RCVR-CSR.                             35764899
357649                                                                  35764999
357650                                                                  35765099
357651***************************************************************   35765199
357652* DETERMINE THE DEFAULT OPERSET THAT WILL BE ASSIGNED TO THE  *   35765299
357653* RECEIVER                                                    *   35765399
357654* DMH - ADDED 10/24/18                                        *   35765499
357655***************************************************************   35765599
357656 5850-DETERMINE-NEW-OPERSET.                                      35765699
357657                                                                  35765799
357658     PERFORM 5855-GET-RCVR-DEPT-SUBCL.                            35765899
357659     MOVE XLT00004-DEPT-NBR   TO PV-DEPT-NUMERIC                  35765999
357660     MOVE XLT00004-SUB-CL-NBR TO PV-SUBCL-NUMERIC                 35766099
357661     PERFORM 5857-CHECK-OPERSET-DEPT-SUBCL                        35766199
357662                                                                  35766299
357663     IF  PV-NEW-OPERSET = 0                                       35766399
357664         PERFORM 5860-GET-DC-DEFAULT-OPERSET                      35766499
357665     END-IF.                                                      35766599
357666                                                                  35766699
357667                                                                  35766799
357668***************************************************************   35766899
357669* DETERMINE THE DEPT & SUBCLASS FOR THE RECEIVER              *   35766999
357670* DMH - ADDED 10/24/18                                        *   35767099
357671***************************************************************   35767199
357672 5855-GET-RCVR-DEPT-SUBCL.                                        35767299
357673                                                                  35767399
357674     EXEC SQL                                                     35767499
357675          SELECT DISTINCT                                         35767599
357676                 D.DEPT_NBR                                       35767699
357677               , D.SUB_CL_NBR                                     35767799
357678            INTO :XLT00004-DEPT-NBR                               35767899
357679               , :XLT00004-SUB-CL-NBR                             35767999
357680            FROM TRECEIV A                                        35768099
357681               , TRECITM B                                        35768199
357682               , XLT_SKU C                                        35768299
357683               , XLT_VND_STYL D                                   35768399
357684          WHERE A.ORD_NBR           = :RECEIV-ORD-NBR             35768499
357685            AND A.REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         35768599
357686            AND A.VER_STATUS_CDE    = 'A'                         35768699
357687            AND A.ORD_NBR           =  B.ORD_NBR                  35768799
357688            AND A.REC_SEQ_NBR       =  B.REC_SEQ_NBR              35768899
357689            AND B.VER_STATUS_CDE    = 'A'                         35768999
357690            AND B.ITM_NBR           =  C.ITM_NBR                  35769099
357691            AND C.STYL_ID           =  D.STYL_ID                  35769199
357692          ORDER BY D.DEPT_NBR                                     35769299
357693                 , D.SUB_CL_NBR                                   35769399
357694          FETCH FIRST 1 ROW ONLY                                  35769499
357695           WITH UR                                                35769599
357696     END-EXEC.                                                    35769699
357697                                                                  35769799
357698     EVALUATE TRUE                                                35769899
357699         WHEN SQLCODE = ZERO                                      35769999
357700         WHEN SQLCODE = -811                                      35770099
357701              CONTINUE                                            35770199
357702         WHEN SQLCODE = +100                                      35770299
357703              PERFORM 5856-GET-PO-DEPT-SUBCL                      35770399
357704         WHEN SQLWARN0 NOT = SPACES                               35770499
357705         WHEN SQLCODE  NOT = ZERO                                 35770599
357706             MOVE SQLCODE            TO PV-DISP-SQLCODE           35770699
357707             MOVE RECEIV-ORD-NBR     TO PV-DISP-PO                35770799
357708             MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-RCVR              35770899
357709             MOVE '5855-GET-RCVR-DEPT-SUBCL'                      35770999
357710                                 TO DP013-PARAGRAPH               35771099
357711             MOVE 'GET DEPT/SUBCLS FOR RECEIVER'                  35771199
357712                                 TO DP013-MESSAGE-TEXT (1)        35771299
357713             STRING PV-DISP-PO '-'                                35771399
357714                    PV-DISP-RCVR '  -SQLCODE:'                    35771499
357715                    PV-DISP-SQLCODE DELIMITED BY SIZE             35771599
357716                               INTO DP013-MESSAGE-TEXT(2)         35771699
357717             MOVE 'TRECEIV     ' TO DP013-DB2-TABLE-NAME (1)      35771799
357718             MOVE 'TRECITM     ' TO DP013-DB2-TABLE-NAME (2)      35771899
357719             MOVE 'XLT_SKU     ' TO DP013-DB2-TABLE-NAME (3)      35771999
357720             MOVE 'XLT_VND_STYL' TO DP013-DB2-TABLE-NAME (4)      35772099
357721             SET DP013-DB2-ABEND                                  35772199
357722                                 TO TRUE                          35772299
357723             SET DP013-XCTL-DISPLAY-RESTART                       35772399
357724                                 TO TRUE                          35772499
357725             PERFORM DP013-0000-PROCESS-ABEND                     35772599
357726     END-EVALUATE.                                                35772699
357727                                                                  35772799
357728                                                                  35772899
357729***************************************************************   35772999
357730* DETERMINE THE DEPT & SUBCLASS FOR THE RECEIVER BY PO        *   35773099
357731* THIS PARAGRAPH IS ONLY USED WHEN THE RECEIVER HAS NOT BEEN  *   35773199
357732* TRANSCRIBED  (NO TRECITM ROWS)                              *   35773299
357733* DMH - ADDED 10/24/18                                        *   35773399
357734***************************************************************   35773499
357735 5856-GET-PO-DEPT-SUBCL.                                          35773599
357736                                                                  35773699
357737     EXEC SQL                                                     35773799
357738          SELECT DISTINCT                                         35773899
357739                 E.DEPT_NBR                                       35773999
357740               , E.SUB_CL_NBR                                     35774099
357741            INTO :XLT00004-DEPT-NBR                               35774199
357742               , :XLT00004-SUB-CL-NBR                             35774299
357743            FROM TRECEIV A                                        35774399
357744               , TPURCHS B                                        35774499
357745               , TPURITM C                                        35774599
357746               , XLT_SKU D                                        35774699
357747               , XLT_VND_STYL E                                   35774799
357748          WHERE A.ORD_NBR           = :RECEIV-ORD-NBR             35774899
357749            AND A.REC_SEQ_NBR       = :RECEIV-REC-SEQ-NBR         35774999
357750            AND A.VER_STATUS_CDE    = 'A'                         35775099
357751            AND A.ORD_NBR           =  B.PO_NBR                   35775199
357753            AND B.VER_STATUS_CDE    = 'A'                         35775399
357754            AND B.PO_NBR            =  C.PO_NBR                   35775499
357755            AND C.VER_STATUS_CDE    = 'A'                         35775599
357756            AND C.ITM_NBR           =  D.ITM_NBR                  35775699
357757            AND D.STYL_ID           =  E.STYL_ID                  35775799
357758          ORDER BY E.DEPT_NBR                                     35775899
357759                 , E.SUB_CL_NBR                                   35775999
357760          FETCH FIRST 1 ROW ONLY                                  35776099
357761           WITH UR                                                35776199
357762     END-EXEC.                                                    35776299
357763                                                                  35776399
357764     EVALUATE TRUE                                                35776499
357765         WHEN SQLCODE = ZERO                                      35776599
357766         WHEN SQLCODE = -811                                      35776699
357767              CONTINUE                                            35776799
357768         WHEN SQLWARN0 NOT = SPACES                               35776899
357769         WHEN SQLCODE  NOT = ZERO                                 35776999
357770             MOVE SQLCODE            TO PV-DISP-SQLCODE           35777099
357771             MOVE RECEIV-ORD-NBR     TO PV-DISP-PO                35777199
357772             MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-RCVR              35777299
357773             MOVE '5856-GET-PO-DEPT-SUBCL  '                      35777399
357774                                 TO DP013-PARAGRAPH               35777499
357775             MOVE 'GET DEPT/SUBCLS FOR RECEIVER BY PO'            35777599
357776                                 TO DP013-MESSAGE-TEXT (1)        35777699
357777             STRING PV-DISP-PO '-'                                35777799
357778                    PV-DISP-RCVR '  -SQLCODE:'                    35777899
357779                    PV-DISP-SQLCODE DELIMITED BY SIZE             35777999
357780                               INTO DP013-MESSAGE-TEXT(2)         35778099
357781             MOVE 'TRECEIV     ' TO DP013-DB2-TABLE-NAME (1)      35778199
357782             MOVE 'TPURCHS     ' TO DP013-DB2-TABLE-NAME (2)      35778299
357783             MOVE 'TPURITM     ' TO DP013-DB2-TABLE-NAME (3)      35778399
357784             MOVE 'XLT_SKU     ' TO DP013-DB2-TABLE-NAME (4)      35778499
357785             MOVE 'XLT_VND_STYL' TO DP013-DB2-TABLE-NAME (5)      35778599
357786             SET DP013-DB2-ABEND                                  35778699
357787                                 TO TRUE                          35778799
357788             SET DP013-XCTL-DISPLAY-RESTART                       35778899
357789                                 TO TRUE                          35778999
357790             PERFORM DP013-0000-PROCESS-ABEND                     35779099
357791     END-EVALUATE.                                                35779199
357792                                                                  35779299
357793                                                                  35779399
357794***************************************************************   35779499
357795* CHECK IF OPER SET IS SETUP FOR THE DEPT-SUB CLASS           *   35779599
357796* DMH - ADDED 10/24/18                                        *   35779699
357797***************************************************************   35779799
357798 5857-CHECK-OPERSET-DEPT-SUBCL.                                   35779899
357799                                                                  35779999
357800     MOVE ASC-KEY-OPER-UNT-ID      TO DCFAAS-OPER-UNT-ID.         35780099
357810     MOVE PV-DEPT-CHAR             TO DCFAAS-DEPT-NBR.            35781099
357900     MOVE PV-SUBCL-CHAR            TO DCFAAS-CL-NBR.              35790078
365126                                                                  36512677
365127     EXEC SQL                                                     36512777
365128          SELECT DISTINCT                                         36512877
365129                 E.OPER_SET_ID                                    36512977
365130            INTO :PV-NEW-OPERSET                                  36513077
365135            FROM TDCFAAS E                                        36513578
365136               , TOPRSET F                                        36513677
365137          WHERE E.DEPT_NBR          = :DCFAAS-DEPT-NBR            36513778
365138            AND E.CL_NBR            = :DCFAAS-CL-NBR              36513878
365146            AND E.OPER_UNT_ID       = :DCFAAS-OPER-UNT-ID         36514677
365147            AND E.FCLTY_ID          =  1                          36514777
365148            AND E.FCLTY_LOC_TYP_CDE = 'PA'                        36514877
365149            AND E.RANK_NBR          =  1                          36514977
365150            AND F.VER_STATUS_CDE    = 'A'                         36515077
365152            AND E.OPER_SET_ID       =  F.OPER_SET_ID              36515277
365153            AND E.OPER_UNT_ID       =  F.OPER_UNT_ID              36515377
365154          ORDER BY E.OPER_SET_ID                                  36515477
365155           WITH UR                                                36515577
365156     END-EXEC.                                                    36515677
365157                                                                  36515777
365158     EVALUATE TRUE                                                36515877
365159         WHEN SQLCODE = ZERO                                      36515977
365160              CONTINUE                                            36516077
365161         WHEN SQLCODE = +100                                      36516177
365162              MOVE ZEROES  TO  PV-NEW-OPERSET                     36516277
365163         WHEN SQLWARN0 NOT = SPACES                               36516377
365164         WHEN SQLCODE  NOT = ZERO                                 36516477
365165             MOVE RECEIV-ORD-NBR     TO PV-DISP-PO                36516578
365166             MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-RCVR              36516678
365167             MOVE '5857-CHECK-OPERSET-DEPT-SUBCL'                 36516778
365168                                 TO DP013-PARAGRAPH               36516877
365169             MOVE 'GET OPERSET BASED ON DEPT SUBCLASS'            36516977
365170                                 TO DP013-MESSAGE-TEXT (1)        36517077
365171             STRING PV-DISP-PO '-'                                36517178
365172                    PV-DISP-RCVR  DELIMITED BY SIZE               36517278
365173                               INTO DP013-MESSAGE-TEXT(2)         36517378
365174             MOVE 'TDCFAAS     ' TO DP013-DB2-TABLE-NAME (1)      36517477
365175             MOVE 'TOPRSET     ' TO DP013-DB2-TABLE-NAME (2)      36517577
365176             SET DP013-DB2-ABEND                                  36517677
365177                                 TO TRUE                          36517777
365178             SET DP013-XCTL-DISPLAY-RESTART                       36517877
365179                                 TO TRUE                          36517977
365180             PERFORM DP013-0000-PROCESS-ABEND                     36518077
365181     END-EVALUATE.                                                36518177
365182                                                                  36518277
365183                                                                  36518377
365184***************************************************************   36518477
365185* CHECK IF OPER SET IS SETUP FOR THE DEPT-MAJOR CLASS         *   36518577
365186* DMH - ADDED 10/24/18                                        *   36518677
365187***************************************************************   36518777
365188 5860-GET-DC-DEFAULT-OPERSET.                                     36518877
365189                                                                  36518977
365190     EXEC SQL                                                     36519077
365191          SELECT DFLT_OPER_SET_ID                                 36519177
365192            INTO :PV-NEW-OPERSET                                  36519277
365193            FROM TCOCNTL                                          36519377
365194           WHERE OPER_UNT_ID       = :ASC-KEY-OPER-UNT-ID         36519494
365195            WITH UR                                               36519577
365196     END-EXEC.                                                    36519677
365197                                                                  36519777
365198     EVALUATE TRUE                                                36519877
365199         WHEN SQLCODE = ZERO                                      36519977
365200              CONTINUE                                            36520077
365201         WHEN SQLCODE = +100                                      36520177
365202              MOVE ZEROES  TO  PV-NEW-OPERSET                     36520277
365203         WHEN SQLWARN0 NOT = SPACES                               36520377
365204         WHEN SQLCODE  NOT = ZERO                                 36520477
365205             MOVE '5860-GET-DC-DEFAULT-OPERSET'                   36520577
365206                                 TO DP013-PARAGRAPH               36520677
365207             MOVE 'GET DC DEFAULT OPERSET '                       36520777
365208                                 TO DP013-MESSAGE-TEXT (1)        36520877
365209             MOVE 'TCOCNTL     ' TO DP013-DB2-TABLE-NAME (1)      36520977
365210             SET DP013-DB2-ABEND                                  36521077
365211                                 TO TRUE                          36521177
365212             SET DP013-XCTL-DISPLAY-RESTART                       36521277
365213                                 TO TRUE                          36521377
365214             PERFORM DP013-0000-PROCESS-ABEND                     36521477
365215     END-EVALUATE.                                                36521577
365216                                                                  36521677
365217                                                                  36521777
365218***************************************************************   36521877
365219* OPEN EFC-RCVR-CSR                                           *   36521977
365220***************************************************************   36522077
365221 5900-OPEN-EFC-RCVR-CSR.                                          36522177
365222     SET  PS-EOF-EFC-RCVR-CSR-NO  TO TRUE.                        36522277
365223                                                                  36522377
365224     PERFORM                                                      36522477
365225         WITH TEST AFTER                                          36522577
365226         VARYING PV-RETRY-COUNTER                                 36522677
365227         FROM 1 BY 1                                              36522777
365228         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36522877
365229                   OR (SQLCODE = ZERO))                           36522977
365230                                                                  36523077
365231             EXEC SQL                                             36523177
365232                  OPEN SHPMT-EFC-RCVR-CSR                         36523277
365233             END-EXEC                                             36523377
365234                                                                  36523477
365235         EVALUATE TRUE                                            36523577
365236             WHEN SQLCODE = ZERO                                  36523677
365237             WHEN SQLCODE = -904                                  36523777
365238             WHEN SQLCODE = -913                                  36523877
365239                 CONTINUE                                         36523977
365240             WHEN SQLWARN0 NOT = SPACES                           36524077
365241             WHEN SQLCODE < ZERO                                  36524177
365242             WHEN SQLCODE > ZERO                                  36524277
365243                 MOVE  DK-SHIPT-ID TO PV-DISP-SHIPT-ID            36524377
365244                 MOVE '5900-OPEN-EFC-RCVR-CSR'                    36524477
365245                                   TO DP013-PARAGRAPH             36524577
365246                 MOVE 'OPEN SHPMT-EFC-RCVR-CSR'                   36524677
365247                                   TO DP013-MESSAGE-TEXT (1)      36524777
365248                 STRING 'SHIPMT ID:'                              36524877
365249                        PV-DISP-SHIPT-ID DELIMITED BY SIZE        36524977
365250                                 INTO DP013-MESSAGE-TEXT (2)      36525077
365251                 MOVE SQLCA        TO DP013-SQLCA                 36525177
365252                 MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)    36525277
365253                 MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (2)    36525377
365254                 MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (3)    36525477
365255                 MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (4)    36525577
365256                 SET DP013-DB2-ABEND                              36525677
365257                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36525777
365258                 PERFORM DP013-0000-PROCESS-ABEND                 36525877
365259         END-EVALUATE                                             36525977
365260     END-PERFORM.                                                 36526077
365261                                                                  36526177
365262     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36526277
365263         MOVE  DK-SHIPT-ID TO PV-DISP-SHIPT-ID                    36526377
365264         MOVE '5900-OPEN-EFC-RCVR-CSR' TO DP013-PARAGRAPH         36526477
365265         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   36526577
365266                                   TO DP013-MESSAGE-TEXT (1)      36526677
365267         STRING 'SHIPMT ID:'                                      36526777
365268                 PV-DISP-SHIPT-ID DELIMITED BY SIZE               36526877
365269                                 INTO DP013-MESSAGE-TEXT (2)      36526977
365270         MOVE SQLCA                TO DP013-SQLCA                 36527077
365271         MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)            36527177
365272         MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (2)            36527277
365273         MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (3)            36527377
365274         MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (4)            36527477
365275         SET DP013-DB2-ABEND                                      36527577
365276             DP013-XCTL-DISPLAY-RESTART                           36527677
365277                                   TO TRUE                        36527777
365278         PERFORM DP013-0000-PROCESS-ABEND                         36527877
365279     END-IF.                                                      36527977
365280                                                                  36528077
365281                                                                  36528177
365282***************************************************************   36528277
365283* FETCH EFC-RCVR-CSR - THEN UPDATE OPER ON THE ROWS FETCHED   *   36528377
365284***************************************************************   36528477
365285 5910-FETCH-EFC-RCVR-CSR.                                         36528577
365286                                                                  36528677
365287      EXEC SQL                                                    36528777
365288           FETCH SHPMT-EFC-RCVR-CSR                               36528877
365289           INTO  :RECEIV-ORD-NBR                                  36528977
365290              ,  :RECEIV-REC-SEQ-NBR                              36529077
365291              ,  :RECEIV-EXPTED-CART-CNT                          36529177
365292              ,  :RECEIV-ACTL-CART-CNT                            36529277
365293      END-EXEC.                                                   36529377
365294*                                                                 36529477
365295                                                                  36529577
365296     EVALUATE TRUE                                                36529677
365297         WHEN SQLCODE = ZERO                                      36529777
365298              PERFORM 5850-DETERMINE-NEW-OPERSET                  36529886
365302              PERFORM 5940-UPDATE-EFC-RCVR                        36530292
365304              PERFORM 5950-OPERSET-PROCESS                        36530492
365306                                                                  36530677
365307         WHEN SQLCODE = +100                                      36530777
365308              SET PS-EOF-EFC-RCVR-CSR  TO  TRUE                   36530877
365309                                                                  36530977
365310         WHEN SQLWARN0 NOT = SPACE                                36531077
365311         WHEN SQLCODE NOT = ZERO                                  36531177
365312              SET  PS-ERROR  TO  TRUE                             36531277
365313              MOVE  DK-SHIPT-ID TO PV-DISP-SHIPT-ID               36531377
365314              MOVE '5910-FETCH-EFC-RCVR-CSR'                      36531477
365315                                   TO DP013-PARAGRAPH             36531577
365316              MOVE 'FETCH SHPMT-EFC-RCVR-CSR'                     36531677
365317                                   TO DP013-MESSAGE-TEXT (1)      36531777
365318              STRING 'SHIPMT ID:'                                 36531877
365319                     PV-DISP-SHIPT-ID DELIMITED BY SIZE           36531977
365320                                 INTO DP013-MESSAGE-TEXT (2)      36532077
365321              MOVE SQLCA        TO DP013-SQLCA                    36532177
365322              MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)       36532277
365323              MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (2)       36532377
365324              MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (3)       36532477
365325              MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (4)       36532577
365326              SET DP013-DB2-ABEND                                 36532677
365327                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36532777
365328              PERFORM DP013-0000-PROCESS-ABEND                    36532877
365329     END-EVALUATE.                                                36532977
365330*                                                                 36533077
365331                                                                  36533177
365332                                                                  36533277
365333***************************************************************   36533377
365334* FETCH EFC-RCVR-CSR - THEN UPDATE OPER ON THE ROWS FETCHED   *   36533477
365335***************************************************************   36533577
365336 5920-CLOSE-EFC-RCVR-CSR.                                         36533677
365337                                                                  36533777
365338     PERFORM                                                      36533877
365339         WITH TEST AFTER                                          36533977
365340         VARYING PV-RETRY-COUNTER                                 36534077
365341         FROM 1 BY 1                                              36534177
365342         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36534277
365343                   OR (SQLCODE = ZERO))                           36534377
365344                                                                  36534477
365345             EXEC SQL                                             36534577
365346                  CLOSE SHPMT-EFC-RCVR-CSR                        36534677
365347             END-EXEC                                             36534777
365348                                                                  36534877
365349         EVALUATE TRUE                                            36534977
365350             WHEN SQLCODE = ZERO                                  36535077
365351             WHEN SQLCODE = -904                                  36535177
365352             WHEN SQLCODE = -913                                  36535277
365353                 CONTINUE                                         36535377
365354             WHEN SQLWARN0 NOT = SPACES                           36535477
365355             WHEN SQLCODE < ZERO                                  36535577
365356             WHEN SQLCODE > ZERO                                  36535677
365357                 MOVE  DK-SHIPT-ID TO PV-DISP-SHIPT-ID            36535777
365358                 MOVE '5920-CLOSE-EFC-RCVR-CSR'                   36535877
365359                                   TO DP013-PARAGRAPH             36535977
365360                 MOVE 'CLOSE SHPMT-EFC-RCVR-CSR'                  36536077
365361                                   TO DP013-MESSAGE-TEXT (1)      36536177
365362                 STRING 'SHIPMT ID:'                              36536277
365363                        PV-DISP-SHIPT-ID DELIMITED BY SIZE        36536377
365364                                 INTO DP013-MESSAGE-TEXT (2)      36536477
365365                 MOVE SQLCA        TO DP013-SQLCA                 36536577
365366                 MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)    36536677
365367                 MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (2)    36536777
365368                 MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (3)    36536877
365369                 MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (4)    36536977
365370                 SET DP013-DB2-ABEND                              36537077
365371                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36537177
365372                 PERFORM DP013-0000-PROCESS-ABEND                 36537277
365373         END-EVALUATE                                             36537377
365374     END-PERFORM.                                                 36537477
365375                                                                  36537577
365376     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        36537677
365377         MOVE  DK-SHIPT-ID TO PV-DISP-SHIPT-ID                    36537777
365378         MOVE '5920-CLOSE-EFC-RCVR-CSR' TO DP013-PARAGRAPH        36537877
365379         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   36537977
365380                                   TO DP013-MESSAGE-TEXT (1)      36538077
365381         STRING 'SHIPMT ID:'                                      36538177
365382                 PV-DISP-SHIPT-ID DELIMITED BY SIZE               36538277
365383                                 INTO DP013-MESSAGE-TEXT (2)      36538377
365384         MOVE SQLCA                TO DP013-SQLCA                 36538477
365385         MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)            36538577
365386         MOVE 'TSHPTPO '   TO DP013-DB2-TABLE-NAME (2)            36538677
365387         MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (3)            36538777
365388         MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (4)            36538877
365389         SET DP013-DB2-ABEND                                      36538977
365390             DP013-XCTL-DISPLAY-RESTART                           36539077
365391                                   TO TRUE                        36539177
365392         PERFORM DP013-0000-PROCESS-ABEND                         36539277
365393     END-IF.                                                      36539377
365394                                                                  36539477
365395                                                                  36539577
365396***************************************************************   36539677
365397* FETCH EFC-RCVR-CSR - THEN UPDATE OPER ON THE ROWS FETCHED   *   36539777
365398***************************************************************   36539877
365399 5940-UPDATE-EFC-RCVR.                                            36539977
365400                                                                  36540077
365401     PERFORM                                                      36540177
365402         WITH TEST AFTER                                          36540277
365403         VARYING PV-RETRY-COUNTER                                 36540377
365404         FROM 1 BY 1                                              36540477
365405         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               36540577
365406             OR (SQLCODE = +0))                                   36540677
365407                                                                  36540777
365408         MOVE  ASC-KEY-OPER-UNT-ID                                36540877
365409           TO  RECEIV-CURR-OPER-UNT-ID                            36540977
365410                                                                  36541077
365411         EXEC SQL                                                 36541177
365412           UPDATE TRECEIV                                         36541277
365413              SET CURR_OPER_UNT_ID = :RECEIV-CURR-OPER-UNT-ID     36541377
365414                , UPD_TMST         = CURRENT TIMESTAMP            36541477
365415                , UPD_UID          = :DP020-USERID                36541577
365416                , UPD_PGM_ID       = :PC-CURRENT-PROGRAM-NAME     36541677
365417           WHERE  ORD_NBR          = :RECEIV-ORD-NBR              36541777
365418             AND  REC_SEQ_NBR      = :RECEIV-REC-SEQ-NBR          36541877
365419         END-EXEC                                                 36541977
365420                                                                  36542077
365421         EVALUATE TRUE                                            36542177
365422             WHEN SQLCODE = +0                                    36542277
365423                 CONTINUE                                         36542377
365424                                                                  36542477
365425             WHEN SQLWARN0 NOT = SPACES                           36542577
365426             WHEN SQLCODE < +0                                    36542677
365427             WHEN SQLCODE > +0                                    36542777
365428                  MOVE RECEIV-ORD-NBR     TO PV-DISP-PO           36542877
365429                  MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-RCVR         36542977
365430                 MOVE '5940-UPDATE-EFC-RCVR'                      36543077
365431                                   TO DP013-PARAGRAPH             36543177
365432                 MOVE 'UPDATE CURR OPER ON EFC RCVR TO DC'        36543277
365433                                   TO DP013-MESSAGE-TEXT(1)       36543377
365434                 STRING PV-DISP-PO '-'                            36543477
365435                        PV-DISP-RCVR  DELIMITED BY SIZE           36543577
365436                                 INTO DP013-MESSAGE-TEXT(2)       36543677
365437                 MOVE SQLCA        TO DP013-SQLCA                 36543777
365438                 MOVE 'TRECEIV'    TO DP013-DB2-TABLE-NAME (1)    36543877
365439                 SET DP013-DB2-ABEND                              36543977
365440                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36544077
365441                 PERFORM DP013-0000-PROCESS-ABEND                 36544177
365442         END-EVALUATE                                             36544277
365443     END-PERFORM.                                                 36544377
365444                                                                  36544477
365445                                                                  36544577
365446******************************************************************36544677
365447* PROCESS TO UPDATE THE OPERSET ON EFC RECEIVER THAT IS BEING    *36544777
365448* ATTACHED TO A DC TRAILER                                       *36544877
365449* DMH - ADDED 10/24/18                                           *36544977
365450******************************************************************36545077
365451 5950-OPERSET-PROCESS.                                            36545177
365452                                                                  36545277
365453     PERFORM 5952-DELETE-CURRENT-TWKORIN.                         36545377
365454     PERFORM 5953-DELETE-CURRENT-TWRKORD.                         36545477
365455                                                                  36545577
365456     PERFORM 5955-BUILD-ZERO-LINE-WORK-ORD.                       36545677
365457                                                                  36545777
365458                                                                  36545877
365459******************************************************************36545977
365460* DELETE CURRENT WORK ORDER INSTRUCTIONS FOR RECEIVER BEING      *36546077
365461* UPDATED                                                        *36546177
365462* DMH - ADDED 10/24/18                                           *36546277
365463******************************************************************36546377
365464 5952-DELETE-CURRENT-TWKORIN.                                     36546477
365465                                                                  36546577
365466     EXEC SQL                                                     36546677
365467          DELETE FROM TWKORIN                                     36546777
365468           WHERE ORD_NBR         = :RECEIV-ORD-NBR                36546877
365469             AND RCVR_SEQ_NBR    = :RECEIV-REC-SEQ-NBR            36546977
365470     END-EXEC.                                                    36547077
365471                                                                  36547177
365472     EVALUATE TRUE                                                36547277
365473         WHEN SQLCODE = +0                                        36547377
365474         WHEN SQLCODE = +100                                      36547477
365475             CONTINUE                                             36547577
365476                                                                  36547677
365477         WHEN SQLWARN0 NOT = SPACES                               36547777
365478         WHEN SQLCODE < +0                                        36547877
365479         WHEN SQLCODE > +0                                        36547977
365480              MOVE RECEIV-ORD-NBR     TO PV-DISP-PO               36548077
365481              MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-RCVR             36548177
365482             MOVE '5952-DELETE-CURRENT-TWKORIN'                   36548277
365483                               TO DP013-PARAGRAPH                 36548377
365484             MOVE 'DELETING CURRENT WORK ORDER INSTRUCTIONS'      36548477
365485                               TO DP013-MESSAGE-TEXT(1)           36548577
365486             STRING PV-DISP-PO '-'                                36548677
365487                    PV-DISP-RCVR  DELIMITED BY SIZE               36548777
365488                             INTO DP013-MESSAGE-TEXT(2)           36548877
365489             MOVE SQLCA        TO DP013-SQLCA                     36548977
365490             MOVE 'TWKORIN'    TO DP013-DB2-TABLE-NAME (1)        36549077
365491             SET DP013-DB2-ABEND                                  36549177
365492                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36549277
365493             PERFORM DP013-0000-PROCESS-ABEND                     36549377
365494     END-EVALUATE.                                                36549477
365495                                                                  36549577
365496                                                                  36549677
365497******************************************************************36549777
365498* DELETE CURRENT WORK ORDER FOR RECEIVER BEING UPDATED           *36549877
365499* DMH - ADDED 10/24/18                                           *36549977
365500******************************************************************36550077
365501 5953-DELETE-CURRENT-TWRKORD.                                     36550177
365502                                                                  36550277
365503     EXEC SQL                                                     36550377
365504          DELETE FROM TWRKORD                                     36550477
365505           WHERE ORD_NBR         = :RECEIV-ORD-NBR                36550577
365506             AND RCVR_SEQ_NBR    = :RECEIV-REC-SEQ-NBR            36550677
365507     END-EXEC.                                                    36550777
365508                                                                  36550877
365509     EVALUATE TRUE                                                36550977
365510         WHEN SQLCODE = +0                                        36551077
365511         WHEN SQLCODE = +100                                      36551177
365512             CONTINUE                                             36551277
365513                                                                  36551377
365514         WHEN SQLWARN0 NOT = SPACES                               36551477
365515         WHEN SQLCODE < +0                                        36551577
365516         WHEN SQLCODE > +0                                        36551677
365517              MOVE RECEIV-ORD-NBR     TO PV-DISP-PO               36551777
365518              MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-RCVR             36551877
365519             MOVE '5953-DELETE-CURRENT-TWRKORD'                   36551977
365520                               TO DP013-PARAGRAPH                 36552077
365521             MOVE 'DELETING CURRENT WORK ORDER '                  36552177
365522                               TO DP013-MESSAGE-TEXT(1)           36552277
365523             STRING PV-DISP-PO '-'                                36552377
365524                    PV-DISP-RCVR  DELIMITED BY SIZE               36552477
365525                             INTO DP013-MESSAGE-TEXT(2)           36552577
365526             MOVE SQLCA        TO DP013-SQLCA                     36552677
365527             MOVE 'TWRKORD'    TO DP013-DB2-TABLE-NAME (1)        36552777
365528             SET DP013-DB2-ABEND                                  36552877
365529                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36552977
365530             PERFORM DP013-0000-PROCESS-ABEND                     36553077
365531     END-EVALUATE.                                                36553177
365532                                                                  36553277
365533                                                                  36553377
365534******************************************************************36553477
365535* BUILD ZERO LINE WORK ORDER FOR RCVR BEING UPDATED              *36553577
365536* DMH - ADDED 10/24/18                                           *36553677
365537******************************************************************36553777
365538 5955-BUILD-ZERO-LINE-WORK-ORD.                                   36553877
365539                                                                  36553977
365540     INITIALIZE DCLTWRKORD.                                       36554077
365541                                                                  36554177
365542     MOVE RECEIV-ORD-NBR          TO WRKORD-ORD-NBR.              36554277
365543     MOVE RECEIV-REC-SEQ-NBR      TO WRKORD-RCVR-SEQ-NBR.         36554377
365544     MOVE RECEIV-CURR-OPER-UNT-ID TO WRKORD-OPER-UNT-ID.          36554477
365545     MOVE 1                       TO WRKORD-FCLTY-ID.             36554577
365546     MOVE +1                      TO WRKORD-WORK-ORD-SEQ-NBR.     36554677
365547     MOVE RECEIV-ACTL-CART-CNT    TO WRKORD-ACTL-CART-CNT.        36554777
365548     MOVE RECEIV-EXPTED-CART-CNT  TO WRKORD-EXPTED-CART-CNT.      36554877
365549     MOVE 'A'                     TO WRKORD-VER-STATUS-CDE.       36554977
365550     MOVE 'IP'                    TO WRKORD-STAT-CDE.             36555077
365551     MOVE 'N'                     TO WRKORD-WORK-ORD-DISTR-IND.   36555177
365552     MOVE PV-NEW-OPERSET          TO WRKORD-OPER-SET-ID.          36555277
365553                                                                  36555377
365554     PERFORM 5960-INSERT-TWRKORD.                                 36555477
365555                                                                  36555577
365556     MOVE +0                     TO PV-WO-INSTR-SEQ-NBR.          36555677
365557                                                                  36555777
365558     SET  PS-EOF-TOSOPFA-CSR-NO                                   36555877
365559          PS-FIRST-INSTRUCTION  TO TRUE.                          36555977
365560                                                                  36556077
365561     MOVE PV-NEW-OPERSET      TO  OSOPFA-OPER-SET-ID.             36556177
365562     MOVE ASC-KEY-OPER-UNT-ID TO  OSOPFA-OPER-UNT-ID.             36556277
365563     MOVE 1                   TO  OSOPFA-FCLTY-ID.                36556377
365564                                                                  36556477
365565     PERFORM 5965-OPEN-TOSOPFA-CSR.                               36556577
365566     PERFORM 5970-FETCH-TOSOPFA-CSR.                              36556677
365567                                                                  36556777
365568     PERFORM UNTIL PS-EOF-TOSOPFA-CSR                             36556877
365569        PERFORM 5980-BUILD-WORK-ORDER-INSTR                       36556977
365570        PERFORM 5970-FETCH-TOSOPFA-CSR                            36557077
365571     END-PERFORM.                                                 36557177
365572                                                                  36557277
365573     PERFORM 5975-CLOSE-TOSOPFA-CSR.                              36557377
365574                                                                  36557477
365575                                                                  36557577
365576******************************************************************36557677
365577* INSERT NEW WORK ORDER                                          *36557777
365578* DMH - ADDED 10/24/18                                           *36557877
365579******************************************************************36557977
365580 5960-INSERT-TWRKORD.                                             36558077
365581                                                                  36558177
365582     EXEC SQL                                                     36558277
365583          INSERT INTO TWRKORD                                     36558377
365584                 ( ORD_NBR                                        36558477
365585                  ,RCVR_SEQ_NBR                                   36558577
365586                  ,ORD_LNE_NBR                                    36558677
365587                  ,WORK_ORD_SEQ_NBR                               36558777
365588                  ,OPER_UNT_ID                                    36558877
365589                  ,FCLTY_ID                                       36558977
365590                  ,CRE_TMST                                       36559077
365591                  ,VER_STATUS_CDE                                 36559177
365592                  ,CRE_UID_ID                                     36559277
365593                  ,EXPTED_CART_CNT                                36559377
365594                  ,ACTL_CART_CNT                                  36559477
365595                  ,EXPTED_ITM_CNT                                 36559577
365596                  ,ACTL_ITM_CNT                                   36559677
365597                  ,STAT_CDE                                       36559777
365598                  ,WORK_ORD_DISTR_IND                             36559877
365599                  ,OPER_SET_ID )                                  36559977
365600          VALUES ( :WRKORD-ORD-NBR                                36560077
365601                  ,:WRKORD-RCVR-SEQ-NBR                           36560177
365602                  ,:WRKORD-ORD-LNE-NBR                            36560277
365603                  ,:WRKORD-WORK-ORD-SEQ-NBR                       36560377
365604                  ,:WRKORD-OPER-UNT-ID                            36560477
365605                  ,:WRKORD-FCLTY-ID                               36560577
365606                  ,CURRENT TIMESTAMP                              36560677
365607                  ,:WRKORD-VER-STATUS-CDE                         36560777
365608                  ,:DP020-USERID                                  36560877
365609                  ,:WRKORD-EXPTED-CART-CNT                        36560977
365610                  ,:WRKORD-ACTL-CART-CNT                          36561077
365611                  ,:WRKORD-EXPTED-ITM-CNT                         36561177
365612                  ,:WRKORD-ACTL-ITM-CNT                           36561277
365613                  ,:WRKORD-STAT-CDE                               36561377
365614                  ,:WRKORD-WORK-ORD-DISTR-IND                     36561477
365615                  ,:WRKORD-OPER-SET-ID )                          36561577
365616     END-EXEC                                                     36561677
365617                                                                  36561777
365618     EVALUATE TRUE                                                36561877
365619         WHEN SQLCODE = +0                                        36561977
365620             CONTINUE                                             36562077
365621                                                                  36562177
365622         WHEN SQLWARN0 NOT = SPACE                                36562277
365623         WHEN SQLCODE < +0                                        36562377
365624         WHEN SQLCODE > +0                                        36562477
365625             MOVE WRKORD-ORD-NBR       TO PV-DISP-PO              36562577
365626             MOVE WRKORD-RCVR-SEQ-NBR  TO PV-DISP-RCVR            36562677
365627             MOVE '5960-INSERT-TWRKORD '                          36562777
365628                             TO DP013-PARAGRAPH                   36562877
365629             MOVE 'INSERT ON WORK ORDER TABLE'                    36562977
365630                             TO DP013-MESSAGE-TEXT (1)            36563077
365631             STRING PV-DISP-PO '-'                                36563177
365632                    PV-DISP-RCVR  DELIMITED BY SIZE               36563277
365633                             INTO DP013-MESSAGE-TEXT(2)           36563377
365634             MOVE SQLCA      TO DP013-SQLCA                       36563477
365635             MOVE 'TWRKORD'  TO DP013-DB2-TABLE-NAME (1)          36563577
365636                 SET DP013-DB2-ABEND                              36563677
365637                     DP013-XCTL-DISPLAY-RESTART                   36563777
365638                                 TO TRUE                          36563877
365639             PERFORM DP013-0000-PROCESS-ABEND                     36563977
365640     END-EVALUATE.                                                36564077
365641                                                                  36564177
365642                                                                  36564277
365643******************************************************************36564377
365644* OPEN WORK ORDER INSTRUCTION CURSOR                             *36564477
365645* DMH - ADDED 10/24/18                                           *36564577
365646******************************************************************36564677
365647 5965-OPEN-TOSOPFA-CSR.                                           36564777
365648                                                                  36564877
365649     EXEC SQL                                                     36564977
365650          OPEN TOSOPFA-CSR                                        36565077
365651     END-EXEC                                                     36565177
365652                                                                  36565277
365653     EVALUATE TRUE                                                36565377
365654         WHEN SQLCODE = +0                                        36565477
365655              CONTINUE                                            36565577
365656         WHEN SQLWARN0 NOT = SPACE                                36565677
365657         WHEN SQLCODE  NOT = +0                                   36565777
365658              MOVE WRKORD-ORD-NBR       TO PV-DISP-PO             36565877
365659              MOVE WRKORD-RCVR-SEQ-NBR  TO PV-DISP-RCVR           36565977
365660              MOVE '5965-OPEN-TOSOPFA-CSR'                        36566077
365661                               TO DP013-PARAGRAPH                 36566177
365662              MOVE 'OPEN TOSOPFA CURSOR'                          36566277
365663                               TO DP013-MESSAGE-TEXT (1)          36566377
365664              STRING PV-DISP-PO '-'                               36566477
365665                     PV-DISP-RCVR  DELIMITED BY SIZE              36566577
365666                             INTO DP013-MESSAGE-TEXT(2)           36566677
365667              MOVE SQLCA       TO DP013-SQLCA                     36566777
365668              MOVE 'TOSOPFA'   TO DP013-DB2-TABLE-NAME (1)        36566877
365669              SET DP013-DB2-ABEND                                 36566977
365670                               TO TRUE                            36567077
365671              PERFORM DP013-0000-PROCESS-ABEND                    36567177
365672     END-EVALUATE.                                                36567277
365673                                                                  36567377
365674                                                                  36567477
365675******************************************************************36567577
365676* FETCH WORK ORDER INSTRUCTION CURSOR                            *36567677
365677* DMH - ADDED 10/24/18                                           *36567777
365678******************************************************************36567877
365679 5970-FETCH-TOSOPFA-CSR.                                          36567977
365680                                                                  36568077
365681     EXEC SQL                                                     36568177
365682          FETCH TOSOPFA-CSR                                       36568277
365683          INTO :OSOPFA-OPER-SET-ID                                36568377
365684              ,:OSOPFA-OPER-ID                                    36568477
365685              ,:OSOPFA-OPER-UNT-ID                                36568577
365686              ,:OSOPFA-FCLTY-ID                                   36568677
365687              ,:OSOPFA-FCLTY-AREA-ID                              36568777
365688              ,:OSOPFA-PRC-FCLTY-AREA-ID                          36568877
365689              ,:OSOPFA-SCRN-SEQ-NBR                               36568977
365690     END-EXEC                                                     36569077
365691                                                                  36569177
365692     EVALUATE TRUE                                                36569277
365693         WHEN SQLCODE = +0                                        36569377
365694              CONTINUE                                            36569477
365695                                                                  36569577
365696         WHEN SQLCODE = +100                                      36569677
365697              SET PS-EOF-TOSOPFA-CSR TO TRUE                      36569777
365698                                                                  36569877
365699         WHEN SQLWARN0 NOT = SPACE                                36569977
365700         WHEN SQLCODE < +0                                        36570077
365701         WHEN SQLCODE > +0                                        36570177
365702              MOVE WRKORD-ORD-NBR       TO PV-DISP-PO             36570277
365703              MOVE WRKORD-RCVR-SEQ-NBR  TO PV-DISP-RCVR           36570377
365704              MOVE '5970-FETCH-TOSOPFA-CSR'                       36570477
365705                                   TO DP013-PARAGRAPH             36570577
365706              MOVE 'FETCH TOSOPFA CURSOR'                         36570677
365707                                   TO DP013-MESSAGE-TEXT (1)      36570777
365708              STRING PV-DISP-PO '-'                               36570877
365709                     PV-DISP-RCVR  DELIMITED BY SIZE              36570977
365710                             INTO DP013-MESSAGE-TEXT(2)           36571077
365711              MOVE SQLCA           TO DP013-SQLCA                 36571177
365712              MOVE 'TOSOPFA'       TO DP013-DB2-TABLE-NAME (1)    36571277
365713              SET DP013-DB2-ABEND  TO TRUE                        36571377
365714              PERFORM DP013-0000-PROCESS-ABEND                    36571477
365715     END-EVALUATE.                                                36571577
365716                                                                  36571677
365717                                                                  36571777
365718******************************************************************36571877
365719* CLOSE WORK ORDER INSTRUCTION CURSOR                            *36571977
365720* DMH - ADDED 10/24/18                                           *36572077
365721******************************************************************36572177
365722 5975-CLOSE-TOSOPFA-CSR.                                          36572277
365723                                                                  36572377
365724     EXEC SQL                                                     36572477
365725          CLOSE TOSOPFA-CSR                                       36572577
365726     END-EXEC                                                     36572677
365727                                                                  36572777
365728     EVALUATE TRUE                                                36572877
365729         WHEN SQLCODE = +0                                        36572977
365730              CONTINUE                                            36573077
365731         WHEN SQLWARN0 NOT = SPACE                                36573177
365732         WHEN SQLCODE  NOT = +0                                   36573277
365733              MOVE WRKORD-ORD-NBR       TO PV-DISP-PO             36573377
365734              MOVE WRKORD-RCVR-SEQ-NBR  TO PV-DISP-RCVR           36573477
365735              MOVE '5975-CLOSE-TOSOPFA-CSR'                       36573577
365736                               TO DP013-PARAGRAPH                 36573677
365737              MOVE 'CLOSE TOSOPFA CURSOR'                         36573777
365738                               TO DP013-MESSAGE-TEXT (1)          36573877
365739              STRING PV-DISP-PO '-'                               36573977
365740                     PV-DISP-RCVR  DELIMITED BY SIZE              36574077
365741                             INTO DP013-MESSAGE-TEXT(2)           36574177
365742              MOVE SQLCA       TO DP013-SQLCA                     36574277
365743              MOVE 'TOSOPFA'   TO DP013-DB2-TABLE-NAME (1)        36574377
365744              SET DP013-DB2-ABEND                                 36574477
365745                               TO TRUE                            36574577
365746              PERFORM DP013-0000-PROCESS-ABEND                    36574677
365747     END-EVALUATE.                                                36574777
365748                                                                  36574877
365749                                                                  36574977
365750******************************************************************36575077
365751* BUILD NEW WORK ORDER INSTRUCTION                               *36575177
365752* DMH - ADDED 10/24/18                                           *36575277
365753******************************************************************36575377
365754 5980-BUILD-WORK-ORDER-INSTR.                                     36575477
365755                                                                  36575577
365756     INITIALIZE DCLTWKORIN.                                       36575677
365757                                                                  36575777
365758     MOVE RECEIV-ORD-NBR          TO WKORIN-ORD-NBR.              36575877
365759     MOVE RECEIV-REC-SEQ-NBR      TO WKORIN-RCVR-SEQ-NBR.         36575977
365760     MOVE +1                      TO WKORIN-WORK-ORD-SEQ-NBR.     36576077
365761     ADD +1                       TO PV-WO-INSTR-SEQ-NBR.         36576177
365762     MOVE PV-WO-INSTR-SEQ-NBR     TO WKORIN-WO-INSTR-SEQ-NBR.     36576277
365763     MOVE 'A'                     TO WKORIN-VER-STATUS-CDE.       36576377
365764     MOVE RECEIV-CURR-OPER-UNT-ID TO WKORIN-OPER-UNT-ID.          36576477
365765     MOVE 1                       TO WKORIN-FCLTY-ID.             36576577
365766     MOVE OSOPFA-OPER-ID          TO WKORIN-OPER-ID.              36576677
365767     MOVE OSOPFA-FCLTY-AREA-ID    TO WKORIN-FCLTY-AREA-ID.        36576777
365768     MOVE OSOPFA-PRC-FCLTY-AREA-ID                                36576877
365769                                  TO WKORIN-PRC-FCLTY-AREA-ID.    36576977
365770     MOVE OSOPFA-SCRN-SEQ-NBR     TO WKORIN-SCREEN-SEQ-NBR.       36577077
365771     IF  PS-FIRST-INSTRUCTION                                     36577177
365772         SET  PS-FIRST-INSTRUCTION-NO  TO  TRUE                   36577277
365773         MOVE RECEIV-EXPTED-CART-CNT                              36577377
365774                                  TO WKORIN-EXPTED-CART-CNT       36577477
365775         MOVE RECEIV-ACTL-CART-CNT                                36577577
365776                                  TO WKORIN-ACTL-CART-CNT         36577677
365777     END-IF.                                                      36577777
365778     MOVE 'N'                     TO WKORIN-ALLOC-IND             36577877
365779                                     WKORIN-REPACK-IND.           36577977
365780     MOVE '9999-09-09-09.09.09.999999'                            36578077
365781                                  TO WKORIN-STRT-TMST             36578177
365782                                     WKORIN-STOP-TMST.            36578277
365783                                                                  36578377
365784     PERFORM 5985-INSERT-TWKORIN.                                 36578477
365785                                                                  36578577
365786                                                                  36578677
365787******************************************************************36578777
365788* INSERT NEW WORK ORDER INSTRUCTION                              *36578877
365789* DMH - ADDED 10/24/18                                           *36578977
365790******************************************************************36579077
365791 5985-INSERT-TWKORIN.                                             36579177
365792                                                                  36579277
365793     EXEC SQL                                                     36579377
365794          INSERT INTO TWKORIN                                     36579477
365795                 ( ORD_NBR                                        36579577
365796                  ,RCVR_SEQ_NBR                                   36579677
365797                  ,ORD_LNE_NBR                                    36579777
365798                  ,WORK_ORD_SEQ_NBR                               36579877
365799                  ,OPER_UNT_ID                                    36579977
365800                  ,FCLTY_ID                                       36580077
365801                  ,WO_INSTR_SEQ_NBR                               36580177
365802                  ,CRE_TMST                                       36580277
365803                  ,VER_STATUS_CDE                                 36580377
365804                  ,CRE_UID_ID                                     36580477
365805                  ,OPER_ID                                        36580577
365806                  ,FCLTY_AREA_ID                                  36580677
365807                  ,PRC_FCLTY_AREA_ID                              36580777
365808                  ,EXPTED_CART_CNT                                36580877
365809                  ,ACTL_CART_CNT                                  36580977
365810                  ,ALLOC_IND                                      36581077
365811                  ,REPACK_IND                                     36581177
365812                  ,STRT_TMST                                      36581277
365813                  ,STOP_TMST                                      36581377
365814                  ,SCREEN_SEQ_NBR                                 36581477
365815                  ,LNE_LOC_CDE                                    36581577
365816                  ,REC_SEL_IND )                                  36581677
365817          VALUES ( :WKORIN-ORD-NBR                                36581777
365818                  ,:WKORIN-RCVR-SEQ-NBR                           36581877
365819                  ,:WKORIN-ORD-LNE-NBR                            36581977
365820                  ,:WKORIN-WORK-ORD-SEQ-NBR                       36582077
365821                  ,:WKORIN-OPER-UNT-ID                            36582177
365822                  ,:WKORIN-FCLTY-ID                               36582277
365823                  ,:WKORIN-WO-INSTR-SEQ-NBR                       36582377
365824                  ,CURRENT TIMESTAMP                              36582477
365825                  ,:WKORIN-VER-STATUS-CDE                         36582577
365826                  ,:DP020-USERID                                  36582677
365827                  ,:WKORIN-OPER-ID                                36582777
365828                  ,:WKORIN-FCLTY-AREA-ID                          36582877
365829                  ,:WKORIN-PRC-FCLTY-AREA-ID                      36582977
365830                  ,:WKORIN-EXPTED-CART-CNT                        36583077
365831                  ,:WKORIN-ACTL-CART-CNT                          36583177
365832                  ,:WKORIN-ALLOC-IND                              36583277
365833                  ,:WKORIN-REPACK-IND                             36583377
365834                  ,:WKORIN-STRT-TMST                              36583477
365835                  ,:WKORIN-STOP-TMST                              36583577
365836                  ,:WKORIN-SCREEN-SEQ-NBR                         36583677
365837                  ,:WKORIN-LNE-LOC-CDE                            36583777
365838                  ,:WKORIN-REC-SEL-IND )                          36583877
365839     END-EXEC.                                                    36583977
365840                                                                  36584077
365841     EVALUATE TRUE                                                36584177
365842         WHEN SQLCODE = +0                                        36584277
365843             CONTINUE                                             36584377
365844                                                                  36584477
365845         WHEN SQLWARN0 NOT = SPACE                                36584577
365846         WHEN SQLCODE < +0                                        36584677
365847         WHEN SQLCODE > +0                                        36584777
365848              MOVE WKORIN-ORD-NBR       TO PV-DISP-PO             36584877
365849              MOVE WKORIN-RCVR-SEQ-NBR  TO PV-DISP-RCVR           36584977
365850              MOVE '5985-INSERT-TWKORIN'                          36585077
365851                              TO DP013-PARAGRAPH                  36585177
365852              MOVE 'INSERT ON WORK ORDER INSTRUCTION TABLE'       36585277
365853                              TO DP013-MESSAGE-TEXT (1)           36585377
365854              MOVE SQLCA      TO DP013-SQLCA                      36585477
365855              STRING PV-DISP-PO '-'                               36585577
365856                     PV-DISP-RCVR  DELIMITED BY SIZE              36585677
365857                             INTO DP013-MESSAGE-TEXT(2)           36585777
365858              MOVE 'TWKORIN'  TO DP013-DB2-TABLE-NAME (1)         36585877
365859                  SET DP013-DB2-ABEND                             36585977
365860                      DP013-XCTL-DISPLAY-RESTART                  36586077
365861                                 TO TRUE                          36586177
365862              PERFORM DP013-0000-PROCESS-ABEND                    36586277
365863     END-EVALUATE.                                                36586377
365864                                                                  36586477
365865                                                                  36586577
365866******************************************************************36586677
365867** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **36586777
365868** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **36586877
365869** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **36586977
365870** THE USER.                                                    **36587077
365871******************************************************************36587177
365872 6000-REFRESH-PANEL-FROM-TEMP.                                    36587277
365873     IF  ASC-UPDATE-TSQ                                           36587377
365874         SET ASC-NO-TSQ-UPDATE TO TRUE                            36587477
365875         MOVE ZERO                 TO PV-SAVE-ITEM                36587577
365876                                      PV-SEL-QUEUE-ITEM           36587677
365877         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        36587777
365878                                   TO PV-HOLD-SELECTED-ITEMS      36587877
365879         PERFORM 6100-UPDATE-TSQ                                  36587977
365880             UNTIL PV-ITEMS-PROCESSED >                           36588077
365881                                     ASC-NUMBER-OF-SELECTED-ITEMS 36588177
365882         PERFORM 6010-DELETE-SEL-QUEUE                            36588277
365883         INITIALIZE ASC-BLOCK-ENTRIES (1)                         36588377
365884                    ASC-BLOCK-ENTRIES (2)                         36588477
365885     END-IF.                                                      36588577
365886                                                                  36588677
365887*----------------------------------------------------------------*36588777
365888*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *36588877
365889*----------------------------------------------------------------*36588977
365890 6010-DELETE-SEL-QUEUE.                                           36589077
365891                                                                  36589177
365892     EXEC CICS                                                    36589277
365893         DELETEQ TS                                               36589377
365894             QUEUE (ASC-SEL-QUEUE-NAME)                           36589477
365895             RESP  (PV-CICS-RESP)                                 36589577
365896     END-EXEC.                                                    36589677
365897*                                                                 36589777
365898     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      36589877
365899        (PV-CICS-RESP = DFHRESP(QIDERR)))                         36589977
365900         CONTINUE                                                 36590077
365901     ELSE                                                         36590177
365902         SET DP013-CICS-ABEND TO TRUE                             36590277
365903         SET DP013-NO-ROLLBACK TO TRUE                            36590377
365904         MOVE '6010-DELETE-SEL-QUEUE'                             36590477
365905                        TO DP013-PARAGRAPH                        36590577
365906         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         36590677
365907                        TO DP013-MESSAGE-TEXT (1)                 36590777
365908         PERFORM DP013-0000-PROCESS-ABEND                         36590877
365909     END-IF.                                                      36590977
365910                                                                  36591077
365911*----------------------------------------------------------------*36591177
365912*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *36591277
365913*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *36591377
365914*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *36591477
365915*    THE TEMP QUEUE.                                             *36591577
365916*----------------------------------------------------------------*36591677
365917                                                                  36591777
365918 6100-UPDATE-TSQ.                                                 36591877
365919                                                                  36591977
365920     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             36592077
365921     PERFORM 6105-READ-SEL-QUEUE.                                 36592177
365922     PERFORM                                                      36592277
365923         VARYING TR006-IDX                                        36592377
365924         FROM 1 BY 1                                              36592477
365925         UNTIL ((PV-ITEMS-PROCESSED >                             36592577
365926                              PV-HOLD-SELECTED-ITEMS)             36592677
365927         OR (TR006-IDX GREATER THAN TR006-MAX-ITEMS))             36592777
365928         IF  TR006-ACTION-SW (TR006-IDX) > SPACE                  36592877
365929             PERFORM 6110-PROCESS-ITEMS                           36592977
365930         END-IF                                                   36593077
365931         ADD +1                TO PV-ITEMS-PROCESSED              36593177
365932     END-PERFORM.                                                 36593277
365933     PERFORM 6111-WRITE-LIST-QUEUE.                               36593377
365934*----------------------------------------------------------------*36593477
365935*    READ THE LIST QUEUE RECORD.                                 *36593577
365936*----------------------------------------------------------------*36593677
365937                                                                  36593777
365938 6105-READ-SEL-QUEUE.                                             36593877
365939                                                                  36593977
365940     EXEC CICS                                                    36594077
365941          READQ TS                                                36594177
365942              QUEUE (ASC-SEL-QUEUE-NAME)                          36594277
365943              INTO  (TR006-DOCK-SCHEDULE-REC)                     36594377
365944              ITEM  (PV-SEL-QUEUE-ITEM)                           36594477
365945              RESP  (PV-CICS-RESP)                                36594577
365946     END-EXEC.                                                    36594677
365947*                                                                 36594777
365948     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36594877
365949         CONTINUE                                                 36594977
365950     ELSE                                                         36595077
365951         SET DP013-CICS-ABEND      TO  TRUE                       36595177
365960         SET DP013-NO-ROLLBACK     TO  TRUE                       36596077
366000         MOVE '6105-READ-SEL-QUEUE'                               36600028
366100                                   TO  DP013-PARAGRAPH            36610028
366200         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           36620028
366300                                   TO  DP013-MESSAGE-TEXT(1)      36630028
366400         PERFORM DP013-0000-PROCESS-ABEND                         36640028
366500     END-IF.                                                      36650028
366600 EJECT                                                            36660028
366700*----------------------------------------------------------------*36670028
366800*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*36680028
366900*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*36690028
367000*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *36700028
367100*----------------------------------------------------------------*36710028
367200                                                                  36720028
367300 6110-PROCESS-ITEMS.                                              36730028
367400                                                                  36740028
367500     COMPUTE PV-ITEM = 1 + ((TR006-ITEM (TR006-IDX) - 1)          36750028
367600                     / PC-ITEMS-PER-PANEL).                       36760028
367700                                                                  36770028
367800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           36780028
367900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          36790028
368000             PERFORM 6111-WRITE-LIST-QUEUE                        36800028
368100         END-IF                                                   36810028
368200         MOVE PV-ITEM          TO PV-SAVE-ITEM                    36820028
368300                                                                  36830028
368400         PERFORM 6112-READ-LIST-QUEUE                             36840028
368500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               36850028
368600             CONTINUE                                             36860028
368700         END-IF                                                   36870028
368800     END-IF.                                                      36880028
368900                                                                  36890028
369000     COMPUTE PV-SUB = (TR006-ITEM (TR006-IDX)                     36900028
369100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              36910028
369200     SET LQW-DESELECT (PV-SUB) TO    TRUE                         36920028
369300     MOVE LQW-SELECTED-SW (PV-SUB)                                36930028
369400                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  36940028
369500     EVALUATE TRUE                                                36950028
369600         WHEN TR006-INQ (TR006-IDX)                               36960028
369700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             36970028
369800                                                                  36980028
369900         WHEN TR006-UPD (TR006-IDX)                               36990028
370000              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             37000028
370100                                                                  37010028
370200         WHEN TR006-DEL (TR006-IDX)                               37020028
370300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             37030028
370400                                                                  37040028
370500         WHEN TR006-ERR (TR006-IDX)                               37050028
370600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             37060028
370700     END-EVALUATE.                                                37070028
370800                                                                  37080028
370900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                37090028
371000                                                                  37100028
371100*----------------------------------------------------------------*37110028
371200*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *37120028
371300*----------------------------------------------------------------*37130028
371400                                                                  37140028
371500 6111-WRITE-LIST-QUEUE.                                           37150028
371600                                                                  37160028
371700     EXEC CICS                                                    37170028
371800         WRITEQ TS                                                37180028
371900             QUEUE (ASC-LIST-QUEUE-NAME)                          37190028
372000             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     37200028
372100             ITEM  (PV-SAVE-ITEM)                                 37210028
372200             REWRITE                                              37220028
372300             RESP  (PV-CICS-RESP)                                 37230028
372400     END-EXEC.                                                    37240028
372500*                                                                 37250028
372600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37260028
372700         CONTINUE                                                 37270028
372800     ELSE                                                         37280028
372900         SET DP013-CICS-ABEND  TO  TRUE                           37290028
373000         SET DP013-NO-ROLLBACK TO  TRUE                           37300028
373100         MOVE '6111-WRITE-LIST-QUEUE'                             37310028
373200                               TO  DP013-PARAGRAPH                37320028
373300         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  37330028
373400                               TO  DP013-MESSAGE-TEXT(1)          37340028
373500         PERFORM DP013-0000-PROCESS-ABEND                         37350028
373600     END-IF.                                                      37360028
373700                                                                  37370028
373800 EJECT                                                            37380028
373900*----------------------------------------------------------------*37390028
374000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*37400028
374100*----------------------------------------------------------------*37410028
374200                                                                  37420028
374300 6112-READ-LIST-QUEUE.                                            37430028
374400                                                                  37440028
374500     EXEC CICS                                                    37450028
374600         READQ TS                                                 37460028
374700             QUEUE (ASC-LIST-QUEUE-NAME)                          37470028
374800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     37480028
374900             ITEM  (PV-ITEM)                                      37490028
375000             RESP  (PV-CICS-RESP)                                 37500028
375100     END-EXEC.                                                    37510028
375200*                                                                 37520028
375300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37530028
375400         CONTINUE                                                 37540028
375500     ELSE                                                         37550028
375600         SET DP013-CICS-ABEND        TO TRUE                      37560028
375700         SET DP013-NO-ROLLBACK       TO TRUE                      37570028
375800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           37580028
375900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    37590028
376000                                     TO DP013-MESSAGE-TEXT(1)     37600028
376100         PERFORM DP013-0000-PROCESS-ABEND                         37610028
376200     END-IF.                                                      37620028
376300                                                                  37630028
376400 9903-WRITE-CICS-LOG.                                             37640028
376500                                                                  37650028
376600     EXEC CICS                                                    37660028
376700         WRITEQ TD                                                37670028
376800             QUEUE  ('CSSL')                                      37680028
376900             FROM   (PV-CICS-MSG-AREA)                            37690028
377000             RESP   (PV-CICS-RESP)                                37700028
377100     END-EXEC.                                                    37710028
377200     MOVE SPACES                  TO PV-CICS-MSG-AREA.            37720028
377300                                                                  37730028
377400 EJECT                                                            37740028
377500*----------------------------------------------------------------*37750028
377600*    ABEND PROCESSOR MODULE                                      *37760028
377700*----------------------------------------------------------------*37770028
377800                                                                  37780028
377900     COPY DPPD013.                                                37790028
