000100*-----------------------*                                         00010081
000200 IDENTIFICATION DIVISION.                                         00020081
000300*-----------------------*                                         00030081
000400 PROGRAM-ID.    RCKCS819.                                         00040081
000500 AUTHOR.        LARRY SCHLEICHER                                  00050081
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060081
000700 DATE-WRITTEN.  04-21-2003.                                       00070081
000800 DATE-COMPILED.                                                   00080081
000900                                                                  00090081
001000*---------------------------------------------------------------* 00100081
001100*    E819 - STORE PACK ITEM LIST VERIFY                         * 00110081
001200*                                                               * 00120081
001300*    THIS PROGRAM GENERATES A LIST OF ALL THE LINES THAT ARE    * 00130081
001400*    ASSOCIATED TO A PACK.  BY SELECTING ANY OF THESE           * 00140081
001500*    LINES, THEY CAN BE 'UPDATED'.                              * 00150081
001600*                                                               * 00160081
001700*---------------------------------------------------------------* 00170081
001710* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00171090
001720* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00172091
001730* MAKING THE CALL DYNAMIC VS STATIC.                              00173091
001740*---------------------------------------------------------------* 00174091
001800 EJECT                                                            00180081
001900 ENVIRONMENT DIVISION.                                            00190081
002000                                                                  00200081
002100 DATA DIVISION.                                                   00210081
002200                                                                  00220081
002300 WORKING-STORAGE SECTION.                                         00230081
002400                                                                  00240081
002500 01  DK-DB2-KEYS.                                                 00250081
002600     05  DK-OPER-UNT-ID                  PIC S9(04)  COMP SYNC.   00260081
002700     05  DK-FCLTY-ID                     PIC S9(04)  COMP SYNC.   00270081
002800     05  DK-LNE-NBR                      PIC S9(09)  COMP SYNC.   00280081
002900     05  DK-PO-NBR                       PIC S9(09)  COMP SYNC.   00290081
003000     05  DK-REC-SEQ-NBR                  PIC S9(09)  COMP SYNC.   00300081
003100     05  DK-PO-DRIVER-LNE                PIC S9(09)  COMP SYNC.   00310081
003200     05  DK-HOLD-LNE-NBR                 PIC S9(09)  COMP SYNC.   00320081
003300     05  DK-ODD-LNE-NBR                  PIC S9(09)  COMP SYNC.   00330081
003400     05  DK-PREPK-ID                     PIC S9(04)  COMP SYNC.   00340081
003500     05  DK-STR-NBR                      PIC S9(04)  COMP SYNC.   00350081
003600     05  DK-DRIVER-LNE-NBR               PIC S9(09)  COMP SYNC.   00360081
003700                                                                  00370081
003800 01  PC-PROGRAM-CONSTANTS.                                        00380081
003900     05  PC-RCKCS806                  PIC X(8)  VALUE  'RCKCS806'.00390081
004000     05  PC-TMKCS520                  PIC X(8)  VALUE  'TMKCS520'.00400081
004100     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE  'RC819A  '.00410081
004200     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE  'RCKM819 '.00420081
004300     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE  'RCKCS819'.00430081
004400     05  PC-POST-VERIFY-PGM-NAME      PIC X(8)  VALUE  'RCKPV819'.00440081
004500     05  PC-PCKCS756                  PIC X(8)  VALUE  'PCKCS756'.00450081
004600     05  PC-AUDIT-RTN                 PIC X(8)  VALUE  'RCKCS290'.00460081
004700     05  PC-AUDIT-RTN-LENGTH          PIC S9(4) VALUE  +300       00470081
004800                                                        COMP SYNC.00480081
004900                                                                  00490081
005000     05  PC-01-COMP                     PIC S9(4) COMP VALUE 1.   00500081
005100     05  PC-VRFY-ADJ-QUEUE-SEQ          PIC  9      VALUE 6.      00510081
005200     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00520081
005300     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00530081
005400     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00540081
005500     05  PC-INTER-APPL-LIST             PIC  X(01)  VALUE '2'.    00550081
005600     05  PC-POST-VERFY-INTER-LIST-FMT   PIC  X(01)  VALUE '3'.    00560081
005700     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +7      00570081
005800                                                    COMP SYNC.    00580081
005900     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00590081
006000                                                    COMP SYNC.    00600081
006100     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00610081
006200                                                    +1000000      00620081
006300                                                    COMP-3.       00630081
006400     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00640081
006500                                                    COMP SYNC.    00650081
006600     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00660081
006700                                                    COMP-3.       00670081
006800     05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00680081
006900     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00690081
007000     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00700081
007100     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00710081
007200     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00720081
007300     05  PC-DB2-DEFAULT-TMST            PIC  X(26)  VALUE         00730081
007400         '9999-09-09-09.09.09.999999'.                            00740081
007500     05  PC-TRBL-ALREADY-EXISTS-MSG     PIC  X(56)  VALUE         00750081
007600       'NNNNN-I-REQUESTED TRBL ALREADY EXISTS FOR PO OR PO LINE'. 00760081
007700     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00770081
007800     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00780081
007900                                                    COMP SYNC.    00790081
008000*                                                                 00800081
008100     05  PC-TSYMSG-NUMBERS.                                       00810081
008200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00820081
008300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00830081
008400         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  00840081
008500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00850081
008600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00860081
008700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00870081
008800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00880081
008900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00890081
009000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00900081
009100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00910081
009200         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  00920081
009300         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00930081
009400         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00940081
009500         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00950081
009600         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  00960081
009700         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00970081
009800         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  00980081
009900         10  PC-TSYMSG-01817            PIC  9(05)  VALUE 01817.  00990081
010000* 01817 - F2 TO CONFIRM THE UPDATE OF A STORE WITH A SOURCE OTHER 01000081
010100         10  PC-TSYMSG-02875            PIC  9(05)  VALUE 02875.  01010081
010200         10  PC-TSYMSG-02780            PIC  9(05)  VALUE 02780.  01020081
010300         10  PC-TSYMSG-03075            PIC  9(05)  VALUE 03075.  01030081
010400         10  PC-TSYMSG-03077            PIC  9(05)  VALUE 03077.  01040081
010500         10  PC-TSYMSG-03078            PIC  9(05)  VALUE 03078.  01050081
010600         10  PC-TSYMSG-03083            PIC  9(05)  VALUE 03083.  01060081
010700         10  PC-TSYMSG-03087            PIC  9(05)  VALUE 03087.  01070081
010800         10  PC-TSYMSG-03135            PIC  9(05)  VALUE 03135.  01080081
010900         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01090081
011000         10  PC-TSYMSG-03180            PIC  9(05)  VALUE 03180.  01100081
011100         10  PC-TSYMSG-03233            PIC  9(05)  VALUE 03233.  01110081
011110         10  PC-TSYMSG-03706            PIC  9(05)  VALUE 03706.  01111081
011111* UNABLE TO DISOLVE PREPACK - NO PACKS VERIFIED                   01111189
011112         10  PC-TSYMSG-03802            PIC  9(05)  VALUE 03802.  01111289
011120         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01112081
011130*                                                                 01113081
011140 01  PS-PROGRAM-SWITCHES.                                         01114081
011150     05  PS-CHECK-FOR-RMS-PO-SW       PIC X(01) VALUE 'N'.        01115081
011160         88  PS-CHECKED-FOR-RMS-PO              VALUE 'Y'.        01116081
011170     05  PS-LOG-RCKDP819-SW           PIC X(01) VALUE 'N'.        01117081
011180         88  PS-LOG-RCKDP819                    VALUE 'Y'.        01118081
011190         88  PS-NO-LOG-RCKDP819                 VALUE 'N'.        01119081
011200     05  PS-RMS-PO-SW                 PIC X(01) VALUE 'N'.        01120081
011300         88  PS-RMS-PO                          VALUE 'Y'.        01130081
011400         88  PS-NO-RMS-PO                       VALUE 'N'.        01140081
011500     05  PS-ODD-UNITS-FOUND-SW        PIC X(01) VALUE 'N'.        01150081
011600         88  PS-ODD-UNITS-FOUND                 VALUE 'Y'.        01160081
011700         88  PS-NO-ODD-UNITS-FOUND              VALUE 'N'.        01170081
011800     05  PS-ZERO-ODD-UNITS-SW         PIC X.                      01180081
011900         88  PS-ZERO-ODD-UNITS                  VALUE 'Y'.        01190081
012000         88  PS-NO-ZERO-ODD-UNITS               VALUE 'N'.        01200081
012100     05  PS-NO-UPDATE-SW              PIC X.                      01210081
012200         88  PS-UPDATE                          VALUE 'Y'.        01220081
012300         88  PS-NO-UPDATE                       VALUE 'N'.        01230081
012400     05  PS-RECDIS-FOUND-SW           PIC X.                      01240081
012500         88  PS-RECDIS-FOUND                    VALUE 'Y'.        01250081
012600         88  PS-RECDIS-NOT-FOUND                VALUE 'N'.        01260081
012700     05  PS-TABLE-LOADED-SW           PIC X.                      01270081
012800         88  PS-TABLE-LOADED                    VALUE 'Y'.        01280081
012900         88  PS-TABLE-NOT-LOADED                VALUE 'N'.        01290081
013000     05  PS-EOT-TRB-SW                PIC X.                      01300081
013100         88  PS-EOT-TRB-TABLE                   VALUE 'Y'.        01310081
013200         88  PS-NOT-EOT-TRB-TABLE               VALUE 'N'.        01320081
013300     05  PS-TRECDIS-UPDATE-SW         PIC X(01) VALUE 'N'.        01330081
013400         88  PS-TRECDIS-UPDATE-DONE             VALUE 'Y'.        01340081
013500         88  PS-TRECDIS-UPDATE-NOT-DONE         VALUE 'N'.        01350081
013600     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01) VALUE 'N'.        01360081
013700         88  PS-UNITS-WORKED-ERROR              VALUE 'Y'.        01370081
013800         88  PS-NO-UNITS-WORKED-ERROR           VALUE 'N'.        01380081
013900     05  PS-RCT00009-UPDATE-SW        PIC X(01) VALUE 'N'.        01390081
014000         88  PS-RCT00009-UPDATE-DONE            VALUE 'Y'.        01400081
014100         88  PS-RCT00009-UPDATE-NOT-DONE        VALUE 'N'.        01410081
014200     05  PS-UPDATE-SW                   PIC  X(01)  VALUE 'N'.    01420081
014300         88  PS-NO-UPDATES-DONE                     VALUE 'N'.    01430081
014400         88  PS-UPDATES-DONE                        VALUE 'Y'.    01440081
014500     05  PS-SELECTED-ITEM-FOUND-SW      PIC  X(01)  VALUE 'N'.    01450081
014600         88  PS-NO-SELECTED-ITEM-FOUND              VALUE 'N'.    01460081
014700         88  PS-SELECTED-ITEM-FOUND                 VALUE 'Y'.    01470081
014800     05  PS-ODD-UPDATE-DONE-SW          PIC  X(01)  VALUE 'N'.    01480081
014900         88  PS-NO-ODD-UPDATE-DONE                  VALUE 'N'.    01490081
015000         88  PS-ODD-UPDATE-DONE                     VALUE 'Y'.    01500081
015100     05  PS-NO-TDISTHD-FOUND-SW         PIC  X(01)  VALUE 'Y'.    01510081
015200         88  PS-TDISTHD-FOUND                       VALUE 'Y'.    01520081
015300         88  PS-NO-TDISTHD-FOUND                    VALUE 'N'.    01530081
015400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01540081
015500         88  PS-NO-ERROR                            VALUE 'Y'.    01550081
015600         88  PS-ERROR                               VALUE 'N'.    01560081
015700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01570081
015800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01580081
015900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01590081
016000     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01600081
016100         88  PS-DONE                                VALUE 'Y'.    01610081
016200         88  PS-NOT-DONE                            VALUE 'N'.    01620081
016300     05  PS-REMOVE-PACK-SW              PIC  X(01)  VALUE 'N'.    01630081
016400         88  PS-REMOVE-PACK                         VALUE 'Y'.    01640081
016500         88  PS-NOT-REMOVE-PACK                     VALUE 'N'.    01650081
016600 01  PV-PROGRAM-VARIABLES.                                        01660081
016700     05  PV-NUMBER-OF-LINES              PIC  S9(5) COMP-3.       01670081
016800     05  PV-PURCHS-STATUS-CDE         PIC X(02).                  01680081
016900     05  PV-PURITM-STATUS-CDE         PIC X(02).                  01690081
017000     05  PV-PURITM-UNT-QTY            PIC S9(9)  COMP.            01700081
017100     05  PV-SAVE-ODD-LNE-NBR          PIC S9(9)  COMP.            01710081
017200     05  PV-DEPT-NBR-X.                                           01720081
017300         10  PV-DEPT-NBR              PIC  9(4).                  01730081
017400     05  PV-DEPT-NBR-KEY              PIC S9(4) VALUE +0          01740081
017500                                                COMP-3.           01750081
017600     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        01760081
017700                                                COMP-3.           01770081
017800     05  PV-RECDIS-AP-VERIFY-ITM-QTY  PIC S9(9) COMP SYNC.        01780081
017900     05  PV-NOTIF-NBR                 PIC S9(9) VALUE ZERO        01790081
018000                                                COMP SYNC.        01800081
018100     05  PV-CYC-ADJ-NBR               PIC S9(9) VALUE ZERO        01810081
018200                                                COMP SYNC.        01820081
018300     05  PV-NOTIF-BEF                 PIC S9(9) VALUE ZERO        01830081
018400                                                COMP SYNC.        01840081
018500     05  PV-CYC-ADJ-BEF               PIC S9(9) VALUE ZERO        01850081
018600                                                COMP SYNC.        01860081
018700     05  PV-CICS-MSG-AREA             PIC  X(100) VALUE SPACE.    01870081
018800     05  PV-CICS-MSG-AREA2            PIC  X(100) VALUE SPACE.    01880081
018900     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        01890081
019000                                                COMP SYNC.        01900081
019100     05  PV-VRFY-ITEM                 PIC S9(4) VALUE ZERO        01910081
019200                                                COMP SYNC.        01920081
019300     05  PV-SAVE-ITM-QTY                PIC S9(9) VALUE ZERO      01930081
019400                                                COMP.             01940081
019500     05  PV-SUM-ITM-QTY                 PIC S9(9) VALUE ZERO      01950081
019600                                                COMP.             01960081
019700     05  PV-DISP-AP-VE-ODU              PIC  ZZZ,ZZZ,ZZ9-.        01970084
019710     05  PV-DISP-AP-VE-ITM              PIC  ZZZ,ZZZ,ZZ9-.        01971084
019720     05  PV-DISP-DC-VE-ODU              PIC  ZZZ,ZZZ,ZZ9-.        01972084
019730     05  PV-DISP-DS-VE-ITM              PIC  ZZZ,ZZZ,ZZ9-.        01973084
019740     05  PV-DISPLAY-NO-ZERO             PIC  Z(5).                01974084
019800     05  PV-DISPLAY-ZERO                PIC  Z(4)9.               01980081
019900     05  PV-STATUS-CDE                  PIC  X(02).               01990081
020000     05  PV-SKU                         PIC S9(08)  COMP-3.       02000081
020100     05  PV-DISOLVE-PACK-COUNT          PIC S9(07) COMP.          02010081
020200     05  PV-LINE-QTY                    PIC  9(09).               02020081
020300     05  PV-UPDATE-ODD-AMT              PIC  9(05).               02030081
020400     05  PV-UPDATE-RATIO                PIC  S9(09) VALUE ZERO    02040081
020500                                                    COMP.         02050081
020600     05  PV-UPDATE-ODD-ACT              PIC  S9(09) VALUE ZERO    02060081
020700                                                    COMP.         02070081
020800     05  PV-UPDATE-ODD-VRF              PIC  S9(09) VALUE ZERO    02080081
020900                                                    COMP.         02090081
021000     05  PV-ORIG-ODD-ACT                PIC  S9(09) VALUE ZERO    02100081
021100                                                    COMP.         02110081
021200     05  PV-ORIG-ODD-VRF                PIC  S9(09) VALUE ZERO    02120081
021300                                                    COMP.         02130081
021400     05  PV-UPDATE-DIF-ACT              PIC  S9(09) VALUE ZERO    02140081
021500                                                    COMP.         02150081
021600     05  PV-UPDATE-DIF-VRF              PIC  S9(09) VALUE ZERO    02160081
021700                                                    COMP.         02170081
021800     05  PV-DC-VRFY-ODU-QTY             PIC  S9(09) VALUE ZERO    02180081
021900                                                    COMP.         02190081
022000     05  PV-AP-VRFY-ODU-QTY             PIC  S9(09) VALUE ZERO    02200081
022100                                                    COMP.         02210081
022200     05  PV-TOT-ODD-ADJ                 PIC S9(05)  VALUE ZERO.   02220081
022300     05  PV-LINE-ODD-ADJ                PIC S9(05)  VALUE ZERO.   02230081
022400     05  PV-NEW-ODD-AMT                 PIC  9(05).               02240081
022500     05  PV-UPDATE-PACK-AMT             PIC  9(05).               02250081
022600     05  PV-ACTL-ODD-UNTS               PIC  9(05).               02260081
022700     05  PV-PACK-RATIO                  PIC  9(04).               02270081
022800     05  PV-LINE-PACK-RATIO             PIC  9(04).               02280081
022900     05  PV-NULL-IND                    PIC S9(04)  VALUE +0      02290081
023000                                                    COMP SYNC.    02300081
023100     05  PV-RECDVS-COUNT                PIC S9(09)  VALUE ZERO    02310081
023200                                                    COMP-3.       02320081
023300     05  PV-CASE-PKSLP                  PIC S9(09)  VALUE ZERO    02330081
023400                                                    COMP-3.       02340081
023500     05  PV-LNE-AP-VERIFY-ITM-QTY       PIC S9(09)  VALUE +0      02350081
023600                                                    COMP SYNC.    02360081
023700     05  PV-LNE-VERIFY-ITM-QTY          PIC S9(09)  VALUE +0      02370081
023800                                                    COMP SYNC.    02380081
023900     05  PV-LNE-EXPTED-ITM-QTY          PIC S9(09)  VALUE +0      02390081
024000                                                    COMP SYNC.    02400081
024100     05  PV-ODD-DC-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02410081
024200                                                    COMP SYNC.    02420081
024300     05  PV-ODD-AP-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02430081
024400                                                    COMP SYNC.    02440081
024500     05  PV-ODD-DC-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      02450081
024600                                                    COMP SYNC.    02460081
024700     05  PV-ODD-AP-VERIFY-ODU-PK-QTY    PIC S9(09)  VALUE +0      02470081
024800                                                    COMP SYNC.    02480081
024900     05  PV-TOT-DC-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02490081
025000                                                    COMP SYNC.    02500081
025100     05  PV-TOT-AP-VERIFY-ODU-QTY       PIC S9(09)  VALUE +0      02510081
025200                                                    COMP SYNC.    02520081
025300     05  PV-PKSLIP-PACKS                PIC  9(06).               02530081
025400     05  PV-ACTUAL-PACKS                PIC  9(06).               02540081
025500     05  PV-VERFYD-PACKS                PIC  9(06).               02550081
025600     05  PV-ODD-UNITS                   PIC  9(06).               02560081
025700     05  PV-DRIVER-RATIO                PIC  9(06).               02570081
025800     05  PV-DISP-PO-NBR                 PIC  9(09).               02580081
025900     05  PV-DISP-OPER-UNT-ID            PIC  9(04).               02590081
026000     05  PV-DISP-FCLTY-ID               PIC  9(04).               02600081
026100     05  PV-DISP-REC-SEQ-NBR            PIC  9(04).               02610088
026200     05  PV-DISP-PREPK-ID               PIC  9(04).               02620081
026300     05  PV-DISP-STR-NBR                PIC  9(04).               02630081
026400     05  PV-DISP-LNE-NBR                PIC  9(04).               02640088
026500     05  PV-DISP-SQL-CODE               PIC +9(04).               02650081
026600     05  PV-DISP-CICS-RESP              PIC +9(04).               02660081
026700     05  PV-SUB                         PIC S9(04)  VALUE +0      02670081
026800                                                    COMP SYNC.    02680081
026900     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02690081
027000                                                    COMP SYNC.    02700081
027100     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02710081
027200                                                    COMP-3.       02720081
027300     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02730081
027400                                                    COMP-3.       02740081
027500     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02750081
027600                                                    COMP-3.       02760081
027700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02770081
027800                                                    COMP-3.       02780081
027900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02790081
028000                                                    COMP-3.       02800081
028100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02810081
028200                                                    COMP-3.       02820081
028300     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02830081
028400                                                    COMP-3.       02840081
028500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02850081
028600                                                    COMP SYNC.    02860081
028700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02870081
028800                                                    COMP SYNC.    02880081
028900     05  PV-ITEM                        PIC S9(04)  VALUE +0      02890081
029000                                                    COMP SYNC.    02900081
029100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02910081
029200                                                    COMP SYNC.    02920081
029300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02930081
029400                                                    COMP SYNC.    02940081
029500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02950081
029600                                                    COMP SYNC.    02960081
029700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02970081
029800                                                    COMP SYNC.    02980081
029900     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02990081
030000                                                    COMP SYNC.    03000081
030100     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03010081
030200                                                    COMP SYNC.    03020081
030300     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03030081
030400                                                    COMP SYNC.    03040081
030500     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03050081
030600                                                    COMP SYNC.    03060081
030700     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03070081
030800                                                    COMP SYNC.    03080081
030900     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03090081
031000                                                    COMP SYNC.    03100081
031100     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03110081
031200                                                    COMP SYNC.    03120081
031300     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03130081
031400                                                    COMP SYNC.    03140081
031500     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03150081
031600                                                    COMP SYNC.    03160081
031700     05  PV-WORK-TIMESTAMP.                                       03170081
031800         10  PV-WORK-YEAR               PIC X(04).                03180081
031900         10  FILLER                     PIC X(01).                03190081
032000         10  PV-WORK-MONTH              PIC X(02).                03200081
032100         10  FILLER                     PIC X(01).                03210081
032200         10  PV-WORK-DAY                PIC X(02).                03220081
032300         10  FILLER                     PIC X(01).                03230081
032400         10  PV-WORK-HH                 PIC X(02).                03240081
032500         10  FILLER                     PIC X(01).                03250081
032600         10  PV-WORK-MIN                PIC X(02).                03260081
032700         10  FILLER                     PIC X(10).                03270081
032800     05  PV-DISPLAY-DATE.                                         03280081
032900         10  PV-DISPLAY-MONTH           PIC X(02).                03290081
033000         10  PV-SLASH-1                 PIC X(01).                03300081
033100         10  PV-DISPLAY-DAY             PIC X(02).                03310081
033200         10  PV-SLASH-2                 PIC X(01).                03320081
033300         10  PV-DISPLAY-YEAR            PIC X(04).                03330081
033400     05  PV-DISPLAY-TIME.                                         03340081
033500         10  PV-DISPLAY-HH              PIC X(02).                03350081
033600         10  PV-COLON-1                 PIC X(01).                03360081
033700         10  PV-DISPLAY-MM              PIC X(02).                03370081
033800     05  PV-RECEIV-VRFY-INFO.                                     03380081
033900         10  PV-LEFT-PAREN              PIC X(01).                03390081
034000         10  PV-VRFY-DATE               PIC X(10).                03400081
034100         10  FILLER                     PIC X(01).                03410081
034200         10  PV-VRFY-TIME               PIC X(05).                03420081
034300         10  PV-SEPARATOR               PIC X(03).                03430081
034400         10  PV-VRFY-USERID             PIC X(07).                03440081
034500         10  PV-RIGHT-PAREN             PIC X(01).                03450081
034600     05  PV-CURR-OPER-UNT-ID          PIC S9(4)  COMP             03460081
034700                                                 VALUE ZERO.      03470081
034800     05  PV-XLT00010-TYPE-CODE        PIC X(2)   VALUE SPACES.    03480081
034900         88  PV-XLT00010-TYPE-DC                 VALUE 'DC'.      03490081
035000     05  PV-TMST                      PIC X(26).                  03500081
035100     05  PV-CURRENT-TIMESTAMP         PIC X(26) VALUE SPACE.      03510081
035200*                                                                 03520081
035300* DMH ADDED 1/19/16 - BEGIN                                       03530081
035400     05  PV-WORK-ORDER-INSTR-COUNT      PIC S9(9)   VALUE +0      03540081
035500                                                    COMP-3.       03550081
035600     05  PV-WO-INSTR-SEQ-NBR             PIC S9(04) VALUE +0      03560081
035700                                                    COMP.         03570081
035800     05  PV-DISP-WO-SEQ-NBR              PIC  9(04).              03580081
035900     05  PV-DISP-WO-INSTR-SEQ-NBR        PIC  9(04).              03590081
036000     05  PV-DISP-SQLCODE                 PIC -9(03) VALUE ZEROES. 03600081
036010     05  PV-DISP-OPER-SET                PIC  9(04).              03601081
036020* DMH ADDED 1/19/16 - END                                         03602081
036030*                                                                 03603081
036040                                                                  03604081
036050 01  PV-PACK-TABLE.                                               03605081
036060     05  PV-PACK-ITEM OCCURS 500 TIMES INDEXED BY LINE-IDX.       03606081
036070         10  PACK-LINE                   PIC  S9(9) COMP.         03607081
036080         10  PACK-RATIO                  PIC  S9(4) COMP.         03608081
036090         10  PACK-EXPTED-ITM-QTY         PIC  S9(09) COMP-3.      03609081
036100         10  PACK-VERIFY-ITM-QTY         PIC  S9(09) COMP-3.      03610081
036200         10  PACK-AP-VERIFY-ITM-QTY      PIC  S9(09) COMP-3.      03620081
036300         10  PACK-BEST-CASE-UNITS        PIC  S9(07) COMP-3.      03630081
036400         10  PACK-ODD-UNITS              PIC  S9(05) COMP-3.      03640081
036500                                                                  03650081
036600******************************************************************03660081
036700**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03670081
036800**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03680081
036900**  APPLICATION-SPECIFIC COMMAREA.                              **03690081
037000******************************************************************03700081
037100 01  LQW-LIST-QUEUE-WORK-AREA.                                    03710081
037200     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03720081
037300     05  LQW-ITEM-ENTRIES               OCCURS 8 TIMES            03730081
037400                                        INDEXED BY LQW-IDX.       03740081
037500         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03750081
037600         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03760081
037700         10  LQW-SELECTED-SW            PIC  X(01).               03770081
037800             88  LQW-SELECT                         VALUE 'S'.    03780081
037900             88  LQW-DESELECT                       VALUE ' '.    03790081
038000         10  LQW-ACTION                 PIC  X(03).               03800081
038100         10  LQW-UPDATE-ODDS            PIC  9(05).               03810081
038200         10  LQW-LINE-NBR               PIC  9(04).               03820081
038300         10  LQW-STATUS-CDE             PIC  X(02).               03830081
038400         10  LQW-SKU                    PIC  9(08).               03840081
038500         10  LQW-PACK-RATIO             PIC  9(04).               03850081
038600         10  LQW-ACTL-ODD-UNTS          PIC  9(05).               03860081
038700         10  LQW-VRFD-ODD-UNTS          PIC  9(05).               03870081
038800         10  LQW-PKSLP-TOT-UNTS         PIC  9(05).               03880081
038900         10  LQW-ACTUAL-TOT-UNTS        PIC  9(05).               03890081
039000         10  LQW-VRFD-TOTAL-UNTS        PIC  9(05).               03900081
039100         10  LQW-SEL-ZERO-SW            PIC X(01).                03910081
039200         10  LQW-EXPTD-ITM-QTY          PIC  9(09).               03920081
039300         10  LQW-TTL-ACTL-ITM-QTY       PIC  9(09).               03930081
039400         10  LQW-VERIFY-ITM-QTY         PIC  9(09).               03940081
039500                                                                  03950081
039600     EJECT                                                        03960081
039700*---------------------------------------------------------------* 03970081
039800*    MAP LAYOUT                                                 * 03980081
039900*---------------------------------------------------------------* 03990081
040000                                                                  04000081
040100     COPY RCKM819.                                                04010081
040200*                                                                 04020081
040300 01  MR-OCCURS-LAYOUT                   REDEFINES  RC819AO.       04030081
040400     05  FILLER                         PIC X(266).               04040081
040500     05  MR-SCROLL-AREA                 OCCURS  7 TIMES.          04050081
040600         10  MR-SELECTL                 PIC S9(04) COMP.          04060081
040700         10  MR-SELECTA                 PIC  X(01).               04070081
040800         10  MR-SELECTC                 PIC  X(01).               04080081
040900         10  MR-SELECTH                 PIC  X(01).               04090081
041000         10  MR-SELECTI                 PIC  X(01).               04100081
041100                                                                  04110081
041200         10  MR-ACTIONL                 PIC S9(04) COMP.          04120081
041300         10  MR-ACTIONA                 PIC  X(01).               04130081
041400         10  MR-ACTIONC                 PIC  X(01).               04140081
041500         10  MR-ACTIONH                 PIC  X(01).               04150081
041600         10  MR-ACTION                  PIC  X(03).               04160081
041700                                                                  04170081
041800         10  MR-UPDATE-ODDSL            PIC S9(04) COMP.          04180081
041900         10  MR-UPDATE-ODDSA            PIC  X(01).               04190081
042000         10  MR-UPDATE-ODDSC            PIC  X(01).               04200081
042100         10  MR-UPDATE-ODDSH            PIC  X(01).               04210081
042200         10  MR-UPDATE-ODDS-X.                                    04220081
042300             15  MR-UPDATE-ODDS             PIC  ZZZZZ.           04230081
042400                                                                  04240081
042500         10  MR-LINE-NBRL               PIC S9(04) COMP.          04250081
042600         10  MR-LINE-NBRA               PIC  X(01).               04260081
042700         10  MR-LINE-NBRC               PIC  X(01).               04270081
042800         10  MR-LINE-NBRH               PIC  X(01).               04280081
042900         10  MR-LINE-NBR-X.                                       04290081
043000             15  MR-LINE-NBR            PIC  9(04).               04300081
043100                                                                  04310081
043200         10  MR-SKUL                    PIC S9(04) COMP.          04320081
043300         10  MR-SKUA                    PIC  X(01).               04330081
043400         10  MR-SKUC                    PIC  X(01).               04340081
043500         10  MR-SKUH                    PIC  X(01).               04350081
043600         10  MR-SKU-X.                                            04360081
043700             15  MR-SKU                 PIC  ZZZZZZZ9.            04370081
043800                                                                  04380081
043900         10  MR-PACK-RATIOL             PIC S9(04) COMP.          04390081
044000         10  MR-PACK-RATIOA             PIC  X(01).               04400081
044100         10  MR-PACK-RATIOC             PIC  X(01).               04410081
044200         10  MR-PACK-RATIOH             PIC  X(01).               04420081
044300         10  MR-PACK-RATIO-X.                                     04430081
044400             15  MR-PACK-RATIO          PIC  ZZZ9.                04440081
044500                                                                  04450081
044600         10  MR-ACTL-ODD-UNTSL          PIC S9(04) COMP.          04460081
044700         10  MR-ACTL-ODD-UNTSA          PIC  X(01).               04470081
044800         10  MR-ACTL-ODD-UNTSC          PIC  X(01).               04480081
044900         10  MR-ACTL-ODD-UNTSH          PIC  X(01).               04490081
045000         10  MR-ACTL-ODD-UNTS-X.                                  04500081
045100             15  MR-ACTL-ODD-UNTS       PIC  ZZZZ9.               04510081
045200                                                                  04520081
045300         10  MR-VRFD-ODD-UNTSL          PIC S9(04) COMP.          04530081
045400         10  MR-VRFD-ODD-UNTSA          PIC  X(01).               04540081
045500         10  MR-VRFD-ODD-UNTSC          PIC  X(01).               04550081
045600         10  MR-VRFD-ODD-UNTSH          PIC  X(01).               04560081
045700         10  MR-VRFD-ODD-UNTS-X.                                  04570081
045800             15  MR-VRFD-ODD-UNTS       PIC  ZZZZ9.               04580081
045900                                                                  04590081
046000         10  MR-PKSLP-TOT-UNTSL         PIC S9(04) COMP.          04600081
046100         10  MR-PKSLP-TOT-UNTSA         PIC  X(01).               04610081
046200         10  MR-PKSLP-TOT-UNTSC         PIC  X(01).               04620081
046300         10  MR-PKSLP-TOT-UNTSH         PIC  X(01).               04630081
046400         10  MR-PKSLP-TOT-UNTS-X.                                 04640081
046500             15  MR-PKSLP-TOT-UNTS      PIC  ZZZZ9.               04650081
046600                                                                  04660081
046700         10  MR-ACTUAL-TOT-UNTSL        PIC S9(04) COMP.          04670081
046800         10  MR-ACTUAL-TOT-UNTSA        PIC  X(01).               04680081
046900         10  MR-ACTUAL-TOT-UNTSC        PIC  X(01).               04690081
047000         10  MR-ACTUAL-TOT-UNTSH        PIC  X(01).               04700081
047100         10  MR-ACTUAL-TOT-UNTS-X.                                04710081
047200             15  MR-ACTUAL-TOT-UNTS     PIC  ZZZZ9.               04720081
047300                                                                  04730081
047400         10  MR-VRFD-TOTAL-UNTSL        PIC S9(04) COMP.          04740081
047500         10  MR-VRFD-TOTAL-UNTSA        PIC  X(01).               04750081
047600         10  MR-VRFD-TOTAL-UNTSC        PIC  X(01).               04760081
047700         10  MR-VRFD-TOTAL-UNTSH        PIC  X(01).               04770081
047800         10  MR-VRFD-TOTAL-UNTS-X.                                04780081
047900             15  MR-VRFD-TOTAL-UNTS     PIC  ZZZZ9.               04790081
048000                                                                  04800081
048100                                                                  04810081
048200******************************************************************04820081
048300*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *04830081
048400******************************************************************04840081
048500     COPY PCWS238.                                                04850081
048600                                                                  04860081
048700*---------------------------------------------------------------* 04870081
048800*    RECORD LAYOUT FOR CALCULATING UNITS FOR AN ORDER.          * 04880081
048900*---------------------------------------------------------------* 04890081
049000     COPY RCWS074.                                                04900081
049100                                                                  04910081
049200******************************************************************04920081
049300*    PREPACK VERIFICATION                                         04930081
049400******************************************************************04940081
049500     COPY RCWS806.                                                04950081
049600                                                                  04960081
049700******************************************************************04970081
049800*  COMMAREA LAYOUT FOR THE RECEIVING TABLE AUDIT MODULE          *04980081
049900*  (RCKCS290)                                                    *04990081
050000******************************************************************05000081
050100     COPY RCWS031.                                                05010081
050200                                                                  05020081
050300******************************************************************05030081
050400*  TEMPORARY STORAGE QUEUE - STORE UNIT ADJUSTMENTS TO BE SENT   *05040081
050500*  TO RMS PO BY PCKCS759.                                        *05050081
050600******************************************************************05060081
050700     COPY PCWS241.                                                05070081
050800                                                                  05080081
050900*---------------------------------------------------------------* 05090081
051000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05100081
051100*---------------------------------------------------------------* 05110081
051200                                                                  05120081
051300     COPY DPWS015.                                                05130081
051400                                                                  05140081
051500*---------------------------------------------------------------* 05150081
051600*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE        * 05160081
051700*---------------------------------------------------------------* 05170081
051800     COPY XLWS001.                                                05180081
051900                                                                  05190081
052000***************************************************************** 05200081
052100*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 05210081
052200*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 05220081
052300***************************************************************** 05230081
052400     COPY RCWS040.                                                05240081
052500/                                                                 05250081
052600*---------------------------------------------------------------* 05260081
052700*    FUNCTION KEYS COPYBOOK.                                    * 05270081
052800*---------------------------------------------------------------* 05280081
052900                                                                  05290081
053000     COPY DPWS016.                                                05300081
053100                                                                  05310081
053200*---------------------------------------------------------------* 05320081
053300*    NUMERIC EDIT LAYOUT.                                       * 05330081
053400*---------------------------------------------------------------* 05340081
053500                                                                  05350081
053600     COPY DPWS010I.                                               05360081
053700 EJECT                                                            05370081
053800******************************************************************05380091
053900** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **05390091
053910** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **05391091
054000******************************************************************05400091
054100                                                                  05410081
054200     COPY DPWS030.                                                05420081
054210     COPY DPWS930.                                                05421091
054300                                                                  05430081
054400*----------------------------------------------------------------*05440081
054500**  SECURITY SUBROUTINE PARAMETERS                                05450081
054600**  DNG ADDED 1/19/16                                             05460081
054700*----------------------------------------------------------------*05470081
054800     COPY DPWS008.                                                05480081
054810                                                                  05481081
054820*---------------------------------------------------------------* 05482081
054830*    RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE.        * 05483081
054840*---------------------------------------------------------------* 05484081
054850     COPY RCWS037.                                                05485081
054860                                                                  05486081
054870*---------------------------------------------------------------* 05487081
054880*    RECORD LAYOUT FOR THE SELECTION TEMP STORAGE QUEUE.        * 05488081
054890*---------------------------------------------------------------* 05489081
054900     COPY RCWS801.                                                05490081
055000                                                                  05500081
055100                                                                  05510081
055200 EJECT                                                            05520081
055300*---------------------------------------------------------------* 05530081
055400*    STANDARD COMMAREA.                                         * 05540081
055500*---------------------------------------------------------------* 05550081
055600                                                                  05560081
055700     COPY DPWS020.                                                05570081
055800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05580081
055900                                                                  05590081
056000*---------------------------------------------------------------* 05600081
056100* INTER-APPLICATION COMMAREA.                                   * 05610081
056200*   RCWS012 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05620081
056300*             SPEC SCREEN.                                      * 05630081
056400*   RCWS036 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05640081
056500*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05650081
056600*---------------------------------------------------------------* 05660081
056700                                                                  05670081
056800         10  INTER-APPL-COMM-AREA       PIC X(200).               05680081
056900     COPY RCWS012.                                                05690081
057000     COPY RCWS800.                                                05700081
057100     COPY RCWS036.                                                05710081
057200                                                                  05720081
057300*---------------------------------------------------------------* 05730081
057400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05740081
057500*---------------------------------------------------------------* 05750081
057600         10  ASC-SPECIFIC-COMMAREA.                               05760081
057700             15  ASC-USE-SELECTION-QUEUE-IND                      05770081
057800                                           PIC X(01).             05780081
057900                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        05790081
058000             15  ASC-SEL-QUEUE-NAME-IN     PIC X(08).             05800081
058100             15  ASC-TRB-QUEUE-NAME-IN               PIC X(8).    05810081
058200             15  ASC-VRFY-ADJ-QUEUE-NAME.                         05820081
058300                 20  ASC-VRFY-ADJ-TERM-ID            PIC X(4).    05830081
058400                 20  ASC-VRFY-ADJ-TASK-NUMBER        PIC S9(5)    05840081
058500                                                     COMP-3.      05850081
058600                 20  ASC-VRFY-ADJ-SEQ                PIC 9.       05860081
058700             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     05870081
058800             15  ASC-SEL-SUB               PIC S9(04) COMP.       05880081
058900             15  ASC-SEL-ITEM              PIC S9(04) COMP.       05890081
059000             15  ASC-LIST-KEYS.                                   05900081
059100                 20  ASC-OPER-UNT-ID                 PIC S9(04)   05910081
059200                                                     COMP.        05920081
059300                 20  ASC-FCLTY-ID                    PIC S9(04)   05930081
059400                                                     COMP.        05940081
059500                 20  ASC-FCLTY-NME                   PIC  X(25).  05950081
059600                 20  ASC-PACK-ID                     PIC  9(04).  05960081
059700                 20  ASC-STR-NBR                     PIC  9(04).  05970081
059800                 20  ASC-SOURCE                      PIC  X(08).  05980081
059900                 20  ASC-RECEIV-VRFY-INFO            PIC  X(28).  05990081
060000                 20  ASC-PO-NBR                      PIC S9(09)   06000081
060100                                                     COMP.        06010081
060200                 20  ASC-PO-LNE-NBR                  PIC S9(09)   06020081
060300                                                     COMP.        06030081
060400                 20  ASC-REC-SEQ-NBR                 PIC S9(09)   06040081
060500                                                     COMP.        06050081
060600                 20  ASC-DRIVER-LNE-NBR              PIC S9(09)   06060081
060700                                                     COMP.        06070081
060800                 20  ASC-TOT-PKSLIP-PACKS            PIC S9(07)   06080081
060900                                                     COMP.        06090081
061000                 20  ASC-TOT-ACTUAL-PACKS            PIC S9(07)   06100081
061100                                                     COMP.        06110081
061200                 20  ASC-TOT-VERFYD-PACKS            PIC S9(07)   06120081
061300                                                     COMP.        06130081
061400                 20  ASC-TOT-ODD-UNITS               PIC S9(07)   06140081
061500                                                     COMP.        06150081
061600                 20  ASC-HDR-TOT-PKSL-UNTS           PIC S9(07)   06160081
061700                                                     COMP.        06170081
061800                 20  ASC-HDR-TOT-ACT-UNTS            PIC S9(07)   06180081
061900                                                     COMP.        06190081
062000                 20  ASC-HDR-TOT-VERFYD-UNTS         PIC S9(07)   06200081
062100                                                     COMP.        06210081
062200                 20  ASC-DEPT-NBR                    PIC  9(04).  06220081
062300                                                                  06230081
062400             15 ASC-TRBL-FOUND-SW                    PIC  X.      06240081
062500                 88 ASC-TRBL-EXISTS             VALUE 'Y'.        06250081
062600                 88 ASC-NO-TRBL-EXISTS          VALUE 'N'.        06260081
062700             15  ASC-TRBL-LVL-IND                PIC X(01).       06270081
062800                 88  ASC-PO-LEVEL-TRBL           VALUE 'P'.       06280081
062900                 88  ASC-LINE-LEVEL-TRBL         VALUE 'L'        06290081
063000                                                       'S'        06300081
063100                                                       'X'        06310081
063200                                                       'M'.       06320081
063300             15  ASC-RECEIV-STATUS-CDE               PIC  X(02).  06330081
063400             15  ASC-RECITM-STATUS-CDE               PIC  X(02).  06340081
063500             15  ASC-RECEIV-ML-POST-TMST             PIC  X(26).  06350081
063600             15  ASC-PACK-BY-ST-SW                   PIC X(01).   06360081
063700                 88  ASC-PACK-BY-STORE        VALUE 'Y'.          06370081
063800                 88  ASC-NOT-PACK-BY-STORE    VALUE 'N'.          06380081
063900*                                                                 06390081
064000* DMH ADDED 1/19/16 BEGIN                                         06400081
064100             15  ASC-RACF-OVERRIDE-SW       PIC  X(01).           06410081
064200                 88  ASC-RACF-OVERRIDE-YES      VALUE  'Y'.       06420081
064300                 88  ASC-RACF-OVERRIDE-NO       VALUE  'N'.       06430081
064400             15  ASC-CURR-OPER-EFC-SW       PIC  X(01).           06440081
064500                 88  ASC-CURR-OPER-EFC-YES      VALUE  'Y'.       06450081
064510                 88  ASC-CURR-OPER-EFC-NO       VALUE  'N'.       06451081
064520             15  ASC-HAS-WORK-ORDER-INST-SW PIC  X(01).           06452081
064530                 88  ASC-HAS-WORK-ORDER-INST    VALUE  'Y'.       06453081
064540                 88  ASC-HAS-WORK-ORDER-INST-NO VALUE  'N'.       06454081
064550             15  ASC-TOSOPFA-CURSOR-SW      PIC  X(01).           06455081
064560                 88  ASC-EOF-TOSOPFA-CSR        VALUE  'Y'.       06456081
064570             15  ASC-INSTRUCTION-SW         PIC  X(01).           06457081
064580                 88  ASC-FIRST-INSTRUCTION      VALUE  'Y'.       06458081
064590* DMH ADDED 1/19/16 END                                           06459081
064591*                                                                 06459181
064592             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06459281
064593                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06459381
064594                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06459481
064595                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06459581
064596                                                                  06459681
064597                 20  ASC-ITEM-ARRAY.                              06459781
064598                     25  ASC-ITEM-ENTRIES OCCURS  8 TIMES.        06459881
064599                         30  ASC-LIST-ITEM-NUMBER                 06459981
064600                                                     PIC S9(09)   06460081
064700                                                     COMP-3.      06470081
064800                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06480081
064900                             88  ASC-VALID-SELECT    VALUE ' '    06490081
065000                                                           'S'    06500081
065100                                                           'B'    06510081
065200                                                           'E'.   06520081
065300                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06530081
065400                             88  ASC-TEMP-SELECT     VALUE 'S'.   06540081
065500                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06550081
065600                             88  ASC-TEMP-END        VALUE 'E'.   06560081
065700                         30  ASC-SELECTED-SW         PIC  X(01).  06570081
065800                             88  ASC-NO-SELECT       VALUE ' '.   06580081
065900                             88  ASC-SELECT          VALUE 'S'.   06590081
066000                             88  ASC-BEGIN           VALUE 'B'.   06600081
066100                             88  ASC-END             VALUE 'E'.   06610081
066200                         30  ASC-ACTION              PIC  X(03).  06620081
066300                         30  ASC-UPDATE-ODDS         PIC  X(05).  06630081
066400                         30  ASC-UPDATE-ODDS-N REDEFINES          06640081
066500                                   ASC-UPDATE-ODDS   PIC  9(05).  06650081
066600                         30  ASC-LINE-NBR            PIC  9(04).  06660081
066700                         30  ASC-STATUS-CDE          PIC  X(02).  06670081
066800                         30  ASC-SKU                 PIC  9(08).  06680081
066900                         30  ASC-PACK-RATIO          PIC  9(04).  06690081
067000                         30  ASC-ACTL-ODD-UNTS       PIC  9(05).  06700081
067100                         30  ASC-VRFD-ODD-UNTS       PIC  9(05).  06710081
067200                         30  ASC-PKSLP-TOT-UNTS      PIC  9(05).  06720081
067300                         30  ASC-ACTUAL-TOT-UNTS     PIC  9(05).  06730081
067400                         30  ASC-VRFD-TOTAL-UNTS     PIC  9(05).  06740081
067500                         30  ASC-SEL-ZERO-SW         PIC X(01).   06750081
067600                             88  ASC-SEL-ZERO-YES    VALUE 'Y'.   06760081
067700                             88  ASC-SEL-ZERO-NO     VALUE 'N'.   06770081
067800                         30 ASC-EXPTD-ITM-QTY        PIC  9(09).  06780081
067900                         30 ASC-TTL-ACTL-ITM-QTY     PIC  9(09).  06790081
068000                         30 ASC-VERIFY-ITM-QTY       PIC  9(09).  06800081
068100                                                                  06810081
068200             15  ASC-BLK-SUB                         PIC S9(04)   06820081
068300                                                          COMP    06830081
068400                                                          SYNC.   06840081
068500             15  ASC-ITEM-SUB                        PIC S9(04)   06850081
068600                                                          COMP    06860081
068700                                                          SYNC.   06870081
068800             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   06880081
068900                                                          COMP-3. 06890081
069000             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   06900081
069100                                                          COMP-3. 06910081
069200             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   06920081
069300                                                          COMP-3. 06930081
069400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   06940081
069500                                                          COMP-3. 06950081
069600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   06960081
069700                                                          COMP-3. 06970081
069800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   06980081
069900                                                          COMP    06990081
070000                                                          SYNC.   07000081
070100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   07010081
070200                                                          COMP-3. 07020081
070300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   07030081
070400                                                          COMP-3. 07040081
070500             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07050081
070600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07060081
070700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07070081
070800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  07080081
070900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07090081
071000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07100081
071100             15  ASC-LIST-QUEUE-NAME.                             07110081
071200                 20  ASC-LIST-TERM-ID                PIC  X(04).  07120081
071300                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07130081
071400                                                          COMP-3. 07140081
071500                 20  ASC-LIST-SEQ                    PIC  9(01).  07150081
071600             15  ASC-SEL-QUEUE-NAME.                              07160081
071700                 20  ASC-SEL-TERM-ID                 PIC  X(04).  07170081
071800                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   07180081
071900                                                          COMP-3. 07190081
072000                 20  ASC-SEL-SEQ                     PIC  9(01).  07200081
072100                                                                  07210081
072200             15  ASC-START-ITEM-REQUEST.                          07220081
072300                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  07230081
072400                                                                  07240081
072500             15  ASC-VERIFY-SW                       PIC  X(01).  07250081
072600                 88  ASC-CAN-VERIFY                  VALUE 'Y'.   07260081
072700                 88  ASC-CANT-VERIFY                 VALUE 'N'.   07270081
072800             15  ASC-UNVERIFY-SW                     PIC  X(01).  07280081
072900                 88  ASC-CAN-UNVERIFY                VALUE 'Y'.   07290081
073000                 88  ASC-CANT-UNVERIFY-FS            VALUE 'F'.   07300081
073100                 88  ASC-CANT-UNVERIFY-ST            VALUE 'S'.   07310081
073200                 88  ASC-CANT-UNVERIFY               VALUE 'N'.   07320081
073300                                                                  07330081
073400             15  ASC-CONFIRM-SWITCH                  PIC X.       07340081
073500                 88  ASC-CONFIRM                     VALUE 'Y'.   07350081
073600                 88  ASC-NOT-CONFIRM                 VALUE 'N'.   07360081
073700                                                                  07370081
073800             15  ASC-CONFIRM-ZERO-SW                 PIC X.       07380081
073900                 88  ASC-CONFIRM-ZERO                VALUE 'Y'.   07390081
074000                 88  ASC-NOT-CONFIRM-ZERO            VALUE 'N'.   07400081
074100                                                                  07410081
074200             15  ASC-CONFIRM-VERIFY-SW               PIC X.       07420081
074300                 88  ASC-CONFIRM-VERIFY              VALUE 'V'.   07430081
074400                 88  ASC-CONFIRM-UNVERIFY            VALUE 'U'.   07440081
074500                                                                  07450081
074600             15  ASC-RECDVS-SW                       PIC X.       07460081
074700                 88  ASC-MORE-RECDVS                 VALUE 'Y'.   07470081
074800                 88  ASC-NO-MORE-RECDVS              VALUE 'N'.   07480081
074900             15  ASC-ACTL-CONFIRMED-SW               PIC X.       07490081
075000                 88  ASC-ACTL-CONFIRMED              VALUE 'Y'.   07500081
075100                 88  ASC-ACTL-NOT-CONFIRMED          VALUE 'N'.   07510081
075200             15  ASC-RANGE-CHECK-SW          PIC X.               07520081
075300                 88  ASC-RANGE-ON                    VALUE 'Y'.   07530081
075400                 88  ASC-RANGE-OFF                   VALUE 'N'.   07540081
075500             15  ASC-POST-VERIFIED-RECEIPT-SW        PIC  X(01).  07550081
075600                 88  ASC-POST-VERIFIED-RECEIPT       VALUE 'Y'.   07560081
075700                 88  ASC-NOT-POST-VERIFIED-RECEIPT   VALUE 'N'.   07570081
075800             15  ASC-CONFIRM-SWITCH                  PIC X.       07580081
075900                 88  ASC-CONFIRMED                   VALUE 'Y'.   07590081
076000                 88  ASC-NOT-CONFIRMED               VALUE 'N'.   07600081
076100             15  ASC-UPDATE-ALLOWED-SW               PIC X.       07610081
076200                 88  ASC-UPDATE-NOT-ALLOWED          VALUE 'N'.   07620081
076300                 88  ASC-UPDATE-ALLOWED              VALUE 'Y'.   07630081
076400             15  ASC-AUTO-VE-SW              PIC X(01).           07640081
076500                 88  ASC-AUTO-VE-YES                 VALUE 'Y'.   07650081
076600                 88  ASC-AUTO-VE-NO                  VALUE 'N'.   07660081
076700             15  ASC-FILLER                          PIC X(1227). 07670081
076800                                                                  07680081
076900                                                                  07690081
077000     EJECT                                                        07700081
077100*----------------------------------------------------------------*07710081
077200*    COMMAREA FOR TMKCS520.                                      *07720081
077300*----------------------------------------------------------------*07730081
077400                                                                  07740081
077500     COPY TMWS500.                                                07750081
077600******************************************************************07760081
077700*    HELD TROUBLE SCREEN                                          07770081
077800******************************************************************07780081
077900     COPY TMWS003.                                                07790081
078000                                                                  07800081
078100*---------------------------------------------------------------* 07810081
078200*    ABEND PROCESSING COPYBOOK.                                 * 07820081
078300*---------------------------------------------------------------* 07830081
078400                                                                  07840081
078500     COPY DPWS013.                                                07850081
078600                                                                  07860081
078700 EJECT                                                            07870081
078800***************************************************************** 07880081
078900*    DB2 AREA FOR THE PO/RMS ROLLOUT CONTROL TABLE              * 07890081
079000*    (POT_RMS_RLOUT_CTL)                                        * 07900081
079100***************************************************************** 07910081
079200     EXEC SQL                                                     07920081
079300          INCLUDE POT00006                                        07930081
079400     END-EXEC.                                                    07940081
079500*---------------------------------------------------------------* 07950081
079600*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 07960081
079700*---------------------------------------------------------------* 07970081
079800     EXEC SQL                                                     07980081
079900          INCLUDE TPURCHS                                         07990081
080000     END-EXEC.                                                    08000081
080100*---------------------------------------------------------------* 08010081
080200*    DB2 AREA FOR PURCHASE ORDER ITEM TABLE                     * 08020081
080300*---------------------------------------------------------------* 08030081
080400     EXEC SQL                                                     08040081
080500          INCLUDE TPURITM                                         08050081
080600     END-EXEC.                                                    08060081
080700*---------------------------------------------------------------* 08070081
080800*    DB2 AREA FOR PURCHASE ORDER PRE PACK TABLE                 * 08080081
080900*---------------------------------------------------------------* 08090081
081000     EXEC SQL                                                     08100081
081100          INCLUDE TPOPRPK                                         08110081
081200     END-EXEC.                                                    08120081
081300/                                                                 08130081
081400*---------------------------------------------------------------* 08140081
081500*    DB2 AREA FOR RECEIPT HEADER TABLE                          * 08150081
081600*---------------------------------------------------------------* 08160081
081700     EXEC SQL                                                     08170081
081800          INCLUDE TRECEIV                                         08180081
081900     END-EXEC.                                                    08190081
082000*---------------------------------------------------------------* 08200081
082100*    DB2 AREA FOR RECEIPT ITEM TABLE                            * 08210081
082200*---------------------------------------------------------------* 08220081
082300     EXEC SQL                                                     08230081
082400          INCLUDE TRECITM                                         08240081
082500     END-EXEC.                                                    08250081
082600*---------------------------------------------------------------* 08260081
082700*    DB2 AREA FOR RECEIPT DISTRIBUTION TABLE                    * 08270081
082800*---------------------------------------------------------------* 08280081
082900     EXEC SQL                                                     08290081
083000          INCLUDE TRECDIS                                         08300081
083100     END-EXEC.                                                    08310081
083200*---------------------------------------------------------------* 08320081
083300*    DB2 AREA FOR RECEIPT VERIFIED ODD UNITS TABLE              * 08330081
083400*    (RCT_VRFD_ODD_UNT)                                         * 08340081
083500*---------------------------------------------------------------* 08350081
083600     EXEC SQL                                                     08360081
083700          INCLUDE RCT00009                                        08370081
083800     END-EXEC.                                                    08380081
083900*---------------------------------------------------------------* 08390081
084000*    DB2 AREA FOR DIST HEADER                                   * 08400081
084100*---------------------------------------------------------------* 08410081
084200     EXEC SQL                                                     08420081
084300          INCLUDE TDISTHD                                         08430081
084400     END-EXEC.                                                    08440081
084500*---------------------------------------------------------------* 08450081
084600*    DB2 AREA FOR DIST DETAIL                                   * 08460081
084700*---------------------------------------------------------------* 08470081
084800     EXEC SQL                                                     08480081
084900          INCLUDE TDISTDT                                         08490081
085000     END-EXEC.                                                    08500081
085100******************************************************************08510081
085200*    DB2 DCLGEN FOR TRECDVS TABLE                                 08520081
085300******************************************************************08530081
085400     EXEC SQL                                                     08540081
085500          INCLUDE TRECDVS                                         08550081
085600     END-EXEC.                                                    08560081
085700*----------------------------------------------------------------*08570081
085800*    DB2 DCLGEN FOR THE XLT_LOC DATABASE                          08580081
085900*----------------------------------------------------------------*08590081
086000     EXEC SQL                                                     08600081
086100          INCLUDE XLT00010                                        08610081
086200     END-EXEC.                                                    08620081
086300*----------------------------------------------------------------*08630081
086400*    DB2 DCLGEN FOR THE TKRPRPM DATABASE                          08640081
086500* ADDED 1/19/16                                                   08650081
086600*----------------------------------------------------------------*08660081
086700     EXEC SQL                                                     08670081
086800          INCLUDE TKRPRPM                                         08680081
086900     END-EXEC.                                                    08690081
087000*----------------------------------------------------------------*08700081
087010*    DB2 DCLGEN FOR THE TCOCNTL DATABASE                          08701081
087020* ADDED 1/19/16                                                   08702081
087030*----------------------------------------------------------------*08703081
087040     EXEC SQL                                                     08704081
087050          INCLUDE TCOCNTL                                         08705081
087060     END-EXEC.                                                    08706081
087070*----------------------------------------------------------------*08707081
087080*    DB2 DCLGEN FOR THE TWRKORD DATABASE                          08708081
087090* ADDED 1/19/16                                                   08709081
087091*----------------------------------------------------------------*08709181
087092     EXEC SQL                                                     08709281
087093          INCLUDE TWRKORD                                         08709381
087094     END-EXEC.                                                    08709481
087095*----------------------------------------------------------------*08709581
087096*    DB2 DCLGEN FOR THE TWKORIN DATABASE                          08709681
087097* ADDED 1/19/16                                                   08709781
087098*----------------------------------------------------------------*08709881
087099     EXEC SQL                                                     08709981
087100          INCLUDE TWKORIN                                         08710081
087101     END-EXEC.                                                    08710181
087102*----------------------------------------------------------------*08710281
087103*    DB2 DCLGEN FOR THE TOSOPFA DATABASE                          08710381
087104* ADDED 1/19/16                                                   08710481
087105*----------------------------------------------------------------*08710581
087106     EXEC SQL                                                     08710681
087107          INCLUDE TOSOPFA                                         08710781
087108     END-EXEC.                                                    08710881
087109*---------------------------------------------------------------* 08710981
087110*    DB2 AREA FOR COMMUNICATIONS                                * 08711081
087120*---------------------------------------------------------------* 08712081
087130     EXEC SQL                                                     08713081
087140          INCLUDE SQLCA                                           08714081
087150     END-EXEC.                                                    08715081
087160                                                                  08716081
087170*---------------------------------------------------------------* 08717081
087180                                                                  08718081
087190     EXEC SQL                                                     08719081
087200          DECLARE STORE-LINE-CSR CURSOR                           08720081
087300          FOR SELECT DISTINCT                                     08730081
087400                B.STATUS_CDE                                      08740081
087500              , B.VRFD_USR_ID                                     08750081
087600              , B.PREPK_RATO_QTY                                  08760081
087700              , B.PREPK_DRV_LNE_CDE                               08770081
087800              , C.CL_NBR                                          08780081
087900              , C.ITM_NBR                                         08790081
088000              , D.STR_NBR                                         08800081
088100              , D.ORD_LNE_NBR                                     08810081
088200              , E.DEPT_NBR                                        08820081
088300          FROM    TRECEIV  A                                      08830081
088400              ,   TRECITM  B                                      08840081
088500              ,   TPURITM  C                                      08850081
088600              ,   TRECDIS  D                                      08860081
088700              ,   TPURCHS  E                                      08870081
088800          WHERE A.ORD_NBR          =  :DK-PO-NBR                  08880081
088900           AND  A.ORD_NBR          =  B.ORD_NBR                   08890081
089000           AND  A.ORD_NBR          =  D.ORD_NBR                   08900081
089100           AND  A.ORD_NBR          =  C.PO_NBR                    08910081
089200           AND  A.ORD_NBR          =  E.PO_NBR                    08920081
089300           AND  A.VER_STATUS_CDE   =  'A'                         08930081
089400           AND  B.VER_STATUS_CDE   =  'A'                         08940081
089500           AND  E.VER_STATUS_CDE   =  'A'                         08950081
089600           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             08960081
089700           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               08970081
089800           AND  A.OPER_UNT_ID      =  D.OPER_UNT_ID               08980081
089900           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                08990081
090000           AND  A.FCLTY_ID         =  B.FCLTY_ID                  09000081
090100           AND  B.FCLTY_ID         =  D.FCLTY_ID                  09010081
090200           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             09020081
090300           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               09030081
090400           AND  A.REC_SEQ_NBR      =  D.REC_SEQ_NBR               09040081
090500           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            09050081
090600           AND  B.ORD_LNE_NBR      =  D.ORD_LNE_NBR               09060081
090700           AND  B.PO_VER_NBR       =  C.VER_NBR                   09070081
090800           AND  B.PREPK_ID         =  :DK-PREPK-ID                09080081
090900           AND  D.STR_NBR          =  :DK-STR-NBR                 09090081
091000       UNION                                                      09100081
091100           SELECT DISTINCT                                        09110081
091200                B.STATUS_CDE                                      09120081
091300              , B.VRFD_USR_ID                                     09130081
091400              , B.PREPK_RATO_QTY                                  09140081
091500              , B.PREPK_DRV_LNE_CDE                               09150081
091600              , C.CL_NBR                                          09160081
091700              , C.ITM_NBR                                         09170081
091800              , 0                                                 09180081
091900              , B.ORD_LNE_NBR                                     09190081
092000              , E.DEPT_NBR                                        09200081
092100          FROM    TRECEIV  A                                      09210081
092200              ,   TRECITM  B                                      09220081
092300              ,   TPURITM  C                                      09230081
092400              ,   TPURCHS  E                                      09240081
092500          WHERE A.ORD_NBR          =  :DK-PO-NBR                  09250081
092600           AND  A.ORD_NBR          =  B.ORD_NBR                   09260081
092700           AND  A.ORD_NBR          =  C.PO_NBR                    09270081
092800           AND  A.ORD_NBR          =  E.PO_NBR                    09280081
092900           AND  A.VER_STATUS_CDE   =  'A'                         09290081
093000           AND  B.VER_STATUS_CDE   =  'A'                         09300081
093100           AND  E.VER_STATUS_CDE   =  'A'                         09310081
093200           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             09320081
093300           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               09330081
093400           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                09340081
093500           AND  A.FCLTY_ID         =  B.FCLTY_ID                  09350081
093600           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             09360081
093700           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               09370081
093800           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            09380081
093900           AND  B.PO_VER_NBR       =  C.VER_NBR                   09390081
094000           AND  B.PREPK_ID         =  :DK-PREPK-ID                09400081
094100           AND NOT EXISTS                                         09410081
094200               (SELECT *                                          09420081
094300               FROM                                               09430081
094400                  TRECDIS  D                                      09440081
094500         WHERE  A.ORD_NBR          =  D.ORD_NBR                   09450081
094600           AND  A.OPER_UNT_ID      =  D.OPER_UNT_ID               09460081
094700           AND  B.FCLTY_ID         =  D.FCLTY_ID                  09470081
094800           AND  A.REC_SEQ_NBR      =  D.REC_SEQ_NBR               09480081
094900           AND  B.ORD_LNE_NBR      =  D.ORD_LNE_NBR               09490081
095000           AND  D.STR_NBR          =  :DK-STR-NBR)                09500081
095100          ORDER BY                                                09510081
095200                8                                                 09520081
095300     END-EXEC.                                                    09530081
095400                                                                  09540081
095500******************************************************************09550081
095600*    DB2 CURSOR DEFINITION FOR RETRIEVAL RECDVS ROWS              09560081
095700******************************************************************09570081
095800     EXEC SQL                                                     09580081
095900          DECLARE RECDVS-CURSOR CURSOR FOR                        09590081
096000          SELECT                                                  09600081
096100                  VRFY_SRC_CDE                                    09610081
096200                , EXPTED_ITM_QTY                                  09620081
096300                , VRFY_ITM_QTY                                    09630081
096400            FROM                                                  09640081
096500                  TRECDVS                                         09650081
096600            WHERE                                                 09660081
096700                  ORD_NBR          = :DK-PO-NBR                   09670081
096800              AND REC_SEQ_NBR      = :DK-REC-SEQ-NBR              09680081
096900              AND ORD_LNE_NBR      = :DK-HOLD-LNE-NBR             09690081
097000              AND STR_NBR          = :DK-STR-NBR                  09700081
097100              AND VER_STAT_CDE     = 'A'                          09710081
097200              AND VRFY_SRC_CDE     IN ('P2','CP')                 09720081
097300     END-EXEC.                                                    09730081
097400                                                                  09740081
097500 EJECT                                                            09750081
097600 LINKAGE SECTION.                                                 09760081
097700                                                                  09770081
097800 01  DFHCOMMAREA.                                                 09780081
097900     05  FILLER                         OCCURS  1 TO 4072 TIMES   09790081
098000                                        DEPENDING ON EIBCALEN.    09800081
098100         10  FILLER                     PIC X.                    09810081
098200                                                                  09820081
098300 EJECT                                                            09830081
098400 PROCEDURE DIVISION.                                              09840081
098500******************************************************************09850081
098600**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09860081
098700**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09870081
098800**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09880081
098900******************************************************************09890081
099000 0000-MAIN-MODULE.                                                09900081
099100     INITIALIZE DP030-CICS-API-FIELDS.                            09910081
099200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09920081
099300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09930081
099400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09940081
099500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09950081
099600     MOVE LENGTH OF RC819AI        TO DP030-MAP-LENGTH (1).       09960081
099700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09970081
099800     PERFORM 0001-CALL-CICS-ARCH-API.                             09980081
099900*                                                                 09990081
100000     PERFORM 1000-CONTROL-PROCESSING                              10000081
100100*                                                                 10010081
100200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     10020081
100300     PERFORM 0001-CALL-CICS-ARCH-API.                             10030081
100400                                                                  10040081
100500******************************************************************10050081
100600**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **10060081
100700**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **10070081
100800******************************************************************10080081
100900 0001-CALL-CICS-ARCH-API.                                         10090081
101010     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      10101091
101100                                    DFHCOMMAREA                   10110091
101200                                    DP030-CICS-API-FIELDS         10120091
101300                                    DP020-STANDARD-COMMAREA       10130091
101400                                    RC819AI.                      10140091
101500*                                                                 10150081
101600     IF  DP030-RC-CALL-SUCCESSFUL                                 10160081
101700         CONTINUE                                                 10170081
101800     ELSE                                                         10180081
101900         SET DP013-NO-ROLLBACK                                    10190081
102000             DP013-XCTL-DISPLAY-RESTART                           10200081
102100             DP013-CICS-ABEND      TO TRUE                        10210081
102200         MOVE '0001-CALL-CICS-ARCH-API'                           10220081
102300                                   TO DP013-PARAGRAPH             10230081
102320         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O10232091
102330-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10233091
102600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10260081
102700         PERFORM DP013-0000-PROCESS-ABEND                         10270081
102800     END-IF.                                                      10280081
102900*----------------------------------------------------------------*10290081
103000* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10300081
103100* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10310081
103200*                                                                *10320081
103300* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10330081
103400*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10340081
103500*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10350081
103600*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10360081
103700*----------------------------------------------------------------*10370081
103800                                                                  10380081
103900 1000-CONTROL-PROCESSING.                                         10390081
104000                                                                  10400081
104100     EVALUATE TRUE                                                10410081
104200         WHEN DP020-NEXT-ACT-INITIAL                              10420081
104300             INITIALIZE ASC-SPECIFIC-COMMAREA                     10430081
104400             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10440081
104500                                      ASC-SEL-TERM-ID             10450081
104600                                      ASC-VRFY-ADJ-TERM-ID        10460081
104700             MOVE DP020-SRC-TASK-NUMBER                           10470081
104800                                   TO ASC-LIST-TASK-NUMBER        10480081
104900                                      ASC-SEL-TASK-NUMBER         10490081
105000                                      ASC-VRFY-ADJ-TASK-NUMBER    10500081
105100             MOVE PC-LIST-QUEUE-SEQ                               10510081
105200                                   TO ASC-LIST-SEQ                10520081
105300             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 10530081
105400             MOVE PC-VRFY-ADJ-QUEUE-SEQ                           10540081
105500                                   TO ASC-VRFY-ADJ-SEQ            10550081
105600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10560081
105700***-----$TEMPLATE NOTE$-------------------------------------------10570081
105800*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,10580081
105900*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  10590081
106000*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.10600081
106100***---------------------------------------------------------------10610081
106200             IF  PS-COMMAREA-NOT-VALID                            10620081
106300                 SET DP020-NEXT-ACT-APPL-ERROR                    10630081
106400                                   TO TRUE                        10640081
106500             ELSE                                                 10650081
106600                 PERFORM 4000-BUILD-INITIAL-PANEL                 10660081
106700             END-IF                                               10670081
106800                                                                  10680081
106900         WHEN DP020-NEXT-ACT-READ-MAP                             10690081
107000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10700081
107100                                   TO PV-TOP-ITEM                 10710081
107200             PERFORM 2000-PROCESS-PANEL                           10720081
107300                                                                  10730081
107400         WHEN DP020-NEXT-ACT-RETURN                               10740081
107500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10750081
107600                                   TO PV-TOP-ITEM                 10760081
107700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10770081
107800             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 10780081
107900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10790081
108000                                                                  10800081
108100         WHEN OTHER                                               10810081
108200             SET DP013-LOGIC-ABEND TO TRUE                        10820081
108300             SET DP013-NO-ROLLBACK TO TRUE                        10830081
108400             MOVE '1000-CONTROL-PROCESSING'                       10840081
108500                                   TO DP013-PARAGRAPH             10850081
108600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10860081
108700                                   TO DP013-MESSAGE-TEXT(1)       10870081
108800             PERFORM DP013-0000-PROCESS-ABEND                     10880081
108900     END-EVALUATE.                                                10890081
109000                                                                  10900081
109100 EJECT                                                            10910081
109200*----------------------------------------------------------------*10920081
109300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10930081
109400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10940081
109500*----------------------------------------------------------------*10950081
109600                                                                  10960081
109700 1100-PROCESS-INTER-APPL-COMM.                                    10970081
109800                                                                  10980081
109900     SET PS-COMMAREA-VALID         TO TRUE.                       10990081
110000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     11000081
110100                                                                  11010081
110200                                                                  11020081
110300     IF  DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-LIST OR        11030081
110400         DP020-INT-APPL-FORMAT-IND = PC-POST-VERFY-INTER-LIST-FMT 11040081
110500         IF  DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-LIST       11050081
110600             SET ASC-NOT-POST-VERIFIED-RECEIPT  TO TRUE           11060081
110700         ELSE                                                     11070081
110800             SET ASC-POST-VERIFIED-RECEIPT      TO TRUE           11080081
110900         END-IF                                                   11090081
111000         SET ASC-USE-SELECTION-QUEUE     TO TRUE                  11100081
111100         MOVE RC036-NUMBER-OF-TS-ITEMS                            11110081
111200                     TO ASC-NUMBER-OF-TS-ITEMS                    11120081
111300         MOVE RC036-SEL-QUEUE-NAME                                11130081
111400                     TO ASC-SEL-QUEUE-NAME-IN                     11140081
111500         MOVE RC036-TRB-QUEUE-NAME                                11150081
111600                     TO ASC-TRB-QUEUE-NAME-IN                     11160081
111700         MOVE RC036-OPER-UNT-ID       TO DK-OPER-UNT-ID           11170081
111800         MOVE RC036-FCLTY-ID          TO DK-FCLTY-ID              11180081
111900         MOVE RC036-FCLTY-NME         TO ASC-FCLTY-NME            11190081
112000         MOVE RC036-PO-NBR            TO DK-PO-NBR                11200081
112100         MOVE RC036-REC-SEQ-NBR       TO DK-REC-SEQ-NBR           11210081
112200         MOVE RC036-PO-PACK-ID        TO DK-PREPK-ID              11220081
112300         PERFORM 1120-PREPARE-LIST-ENTRY                          11230081
112400     END-IF.                                                      11240081
112500                                                                  11250081
112600*----------------------------------------------------------------*11260081
112700*    ENTRY IS FROM A LIST.  GET THE KEY INFORMATION FROM THE     *11270081
112800*    TEMP STORAGE QUEUE PASSED FROM THE LIST.                    *11280081
112900*----------------------------------------------------------------*11290081
113000 1120-PREPARE-LIST-ENTRY.                                         11300081
113100                                                                  11310081
113200     MOVE RC037-MAX-ITEMS          TO ASC-SEL-SUB.                11320081
113300     MOVE ZERO                     TO ASC-SEL-ITEM.               11330081
113400     PERFORM 1200-GET-NEXT-RECORD.                                11340081
113500                                                                  11350081
113600*----------------------------------------------------------------*11360081
113700*    GET THE DATA (KEY) OF THE NEXT SELECTED OBJECT              *11370081
113800*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *11380081
113900*----------------------------------------------------------------*11390081
114000 1200-GET-NEXT-RECORD.                                            11400081
114100                                                                  11410081
114200     ADD +1                        TO ASC-SEL-SUB.                11420081
114300     IF  ASC-SEL-SUB > RC037-MAX-ITEMS                            11430081
114400         ADD +1                    TO ASC-SEL-ITEM                11440081
114500         MOVE +1                   TO ASC-SEL-SUB                 11450081
114600     END-IF.                                                      11460081
114700                                                                  11470081
114800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                11480081
114900         PERFORM 9100-READ-SEL-QUEUE                              11490081
115000         IF  RC037-ITEM (ASC-SEL-SUB) > ZERO                      11500081
115100             MOVE RC037-OPER-UNT-ID (ASC-SEL-SUB)                 11510081
115200                                   TO ASC-OPER-UNT-ID             11520081
115300             MOVE RC037-FCLTY-ID (ASC-SEL-SUB)                    11530081
115400                                   TO ASC-FCLTY-ID                11540081
115500             MOVE RC037-PO-NBR (ASC-SEL-SUB)                      11550081
115600                                   TO ASC-PO-NBR                  11560081
115700             MOVE RC037-REC-SEQ-NBR (ASC-SEL-SUB)                 11570081
115800                                   TO ASC-REC-SEQ-NBR             11580081
115900             MOVE RC037-PACK-ID (ASC-SEL-SUB)                     11590081
116000                                   TO ASC-PACK-ID                 11600081
116100             MOVE RC037-STR-NBR (ASC-SEL-SUB)                     11610081
116200                                   TO ASC-STR-NBR                 11620081
116300             MOVE RC037-SOURCE (ASC-SEL-SUB)                      11630081
116400                                   TO ASC-SOURCE                  11640081
116500             SET RC037-INQ (ASC-SEL-SUB)                          11650081
116600                                   TO TRUE                        11660081
116700             PERFORM 9200-REWRITE-SEL-QUEUE                       11670081
116800         ELSE                                                     11680081
116900             SUBTRACT +1 FROM ASC-SEL-SUB                         11690081
117000*            --- BOTTOM OF LIST ---                               11700081
117100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11710081
117200             SET DP020-MSG-INFORMATIONAL                          11720081
117300                                   TO TRUE                        11730081
117400         END-IF                                                   11740081
117500     ELSE                                                         11750081
117600         SUBTRACT +1 FROM ASC-SEL-ITEM                            11760081
117700         MOVE RC037-MAX-ITEMS      TO ASC-SEL-SUB                 11770081
117800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11780081
117900         SET DP020-MSG-INFORMATIONAL                              11790081
118000                                   TO TRUE                        11800081
118100     END-IF.                                                      11810081
118200                                                                  11820081
118300/                                                                 11830081
118400*----------------------------------------------------------------*11840081
118500*    GET THE DATA (KEY) OF THE PREVIOUS SELECTED OBJECT          *11850081
118600*    FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.                *11860081
118700*----------------------------------------------------------------*11870081
118800 1300-GET-PREV-RECORD.                                            11880081
118900                                                                  11890081
119000     SUBTRACT +1 FROM ASC-SEL-SUB.                                11900081
119100     IF  ASC-SEL-SUB < +1                                         11910081
119200         SUBTRACT +1 FROM ASC-SEL-ITEM                            11920081
119300         MOVE RC037-MAX-ITEMS      TO ASC-SEL-SUB                 11930081
119400     END-IF.                                                      11940081
119500                                                                  11950081
119600     IF  ASC-SEL-ITEM > ZERO                                      11960081
119700         PERFORM 9100-READ-SEL-QUEUE                              11970081
119800             MOVE RC037-OPER-UNT-ID (ASC-SEL-SUB)                 11980081
119900                                   TO ASC-OPER-UNT-ID             11990081
120000             MOVE RC037-FCLTY-ID (ASC-SEL-SUB)                    12000081
120100                                   TO ASC-FCLTY-ID                12010081
120200             MOVE RC037-PO-NBR (ASC-SEL-SUB)                      12020081
120300                                   TO ASC-PO-NBR                  12030081
120400             MOVE RC037-REC-SEQ-NBR (ASC-SEL-SUB)                 12040081
120500                                   TO ASC-REC-SEQ-NBR             12050081
120600             MOVE RC037-PACK-ID (ASC-SEL-SUB)                     12060081
120700                                   TO ASC-PACK-ID                 12070081
120800             MOVE RC037-STR-NBR (ASC-SEL-SUB)                     12080081
120900                                   TO ASC-STR-NBR                 12090081
121000     ELSE                                                         12100081
121100         MOVE +1                   TO ASC-SEL-ITEM                12110081
121200                                      ASC-SEL-SUB                 12120081
121300*        --- TOP OF LIST ---                                      12130081
121400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12140081
121500         SET DP020-MSG-INFORMATIONAL                              12150081
121600                                   TO TRUE                        12160081
121700     END-IF.                                                      12170081
121800                                                                  12180081
121900*----------------------------------------------------------------*12190081
122000* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *12200081
122100* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *12210081
122200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *12220081
122300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12230081
122400* FUNCTION KEYS CAN GET THIS FAR.                                *12240081
122500*----------------------------------------------------------------*12250081
122600                                                                  12260081
122700 2000-PROCESS-PANEL.                                              12270081
122800     EVALUATE TRUE                                                12280081
122900         WHEN DP020-SRC-AID = DP016-CLEAR                         12290081
123000             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12300081
123100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12310081
123200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12320081
123300                                                                  12330081
123400         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12340081
123500             PERFORM 2050-DELETE-LIST-QUEUE                       12350081
123600             PERFORM 4000-BUILD-INITIAL-PANEL                     12360081
123700                                                                  12370081
123800         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12380081
123900             PERFORM 2140-DESELECT-ALL-ITEMS                      12390081
124000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12400081
124100                                                                  12410081
124200         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  12420081
124300             PERFORM 2150-SELECT-ALL-ITEMS                        12430081
124400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12440081
124500                                                                  12450081
124600                                                                  12460081
124700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12470081
124800              IF ASC-USE-SELECTION-QUEUE                          12480081
124900                 PERFORM 1200-GET-NEXT-RECORD                     12490081
125000                 MOVE ASC-OPER-UNT-ID     TO DK-OPER-UNT-ID       12500081
125100                 MOVE ASC-FCLTY-ID        TO DK-FCLTY-ID          12510081
125200                 MOVE ASC-PO-NBR          TO DK-PO-NBR            12520081
125300                 MOVE ASC-REC-SEQ-NBR TO DK-REC-SEQ-NBR           12530081
125400                 IF  PS-ERROR                                     12540081
125500                     SET RC037-ERR (ASC-SEL-SUB)                  12550081
125600                                              TO TRUE             12560081
125700                     PERFORM 9200-REWRITE-SEL-QUEUE               12570081
125800                 ELSE                                             12580081
125900                     PERFORM 2050-DELETE-LIST-QUEUE               12590081
126000                     PERFORM 4000-BUILD-INITIAL-PANEL             12600081
126100                     PERFORM 3200-RESET-ATTRIBUTES                12610081
126200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12620081
126300                 END-IF                                           12630081
126400              ELSE                                                12640081
126500*                --- BOTTOM OF LIST ---                           12650081
126600                 MOVE PC-TSYMSG-00070                             12660081
126700                                   TO DP020-MSG-NUMBER            12670081
126800                 SET DP020-MSG-INFORMATIONAL                      12680081
126900                                   TO TRUE                        12690081
127000              END-IF                                              12700081
127100                                                                  12710081
127200         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12720081
127300              IF ASC-USE-SELECTION-QUEUE                          12730081
127400                 PERFORM 1300-GET-PREV-RECORD                     12740081
127500                 MOVE ASC-OPER-UNT-ID     TO DK-OPER-UNT-ID       12750081
127600                 MOVE ASC-FCLTY-ID        TO DK-FCLTY-ID          12760081
127700                 MOVE ASC-PO-NBR          TO DK-PO-NBR            12770081
127800                 MOVE ASC-REC-SEQ-NBR TO DK-REC-SEQ-NBR           12780081
127900                 IF  PS-ERROR                                     12790081
128000                     SET RC037-ERR (ASC-SEL-SUB)                  12800081
128100                                              TO TRUE             12810081
128200                     PERFORM 9200-REWRITE-SEL-QUEUE               12820081
128300                 ELSE                                             12830081
128400                     PERFORM 2050-DELETE-LIST-QUEUE               12840081
128500                     PERFORM 4000-BUILD-INITIAL-PANEL             12850081
128600                     PERFORM 3200-RESET-ATTRIBUTES                12860081
128700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12870081
128800                 END-IF                                           12880081
128900              ELSE                                                12890081
129000*                --- TOP OF LIST ---                              12900081
129100                 MOVE PC-TSYMSG-00069                             12910081
129200                                   TO DP020-MSG-NUMBER            12920081
129300                 SET DP020-MSG-INFORMATIONAL                      12930081
129400                                   TO TRUE                        12940081
129500              END-IF                                              12950081
129600                                                                  12960081
129700         WHEN OTHER                                               12970081
129800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12980081
129900* DMH - 1/28/16 -  BEGIN                                          12990081
130000             PERFORM 3200-RESET-ATTRIBUTES                        13000081
130100* DMH - 1/28/16 -  BEGIN                                          13010081
130200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13020081
130300             IF  PS-NO-ERROR                                      13030081
130400                 SET DP030-CONTINUE-GO                            13040081
130500                                 TO TRUE                          13050081
130600                 PERFORM 2100-CHECK-FUNCTION-KEY                  13060081
130700             ELSE                                                 13070081
130800                 SET DP030-OVERRIDE-GO                            13080081
130900                                 TO TRUE                          13090081
131000             END-IF                                               13100081
131100     END-EVALUATE.                                                13110081
131200 EJECT                                                            13120081
131300*----------------------------------------------------------------*13130081
131400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *13140081
131500*----------------------------------------------------------------*13150081
131600 2050-DELETE-LIST-QUEUE.                                          13160081
131700                                                                  13170081
131800     EXEC CICS                                                    13180081
131900         DELETEQ TS                                               13190081
132000             QUEUE (ASC-LIST-QUEUE-NAME)                          13200081
132100             RESP  (PV-CICS-RESP)                                 13210081
132200     END-EXEC.                                                    13220081
132300                                                                  13230081
132400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       13240081
132500        (PV-CICS-RESP = DFHRESP(QIDERR))                          13250081
132600         CONTINUE                                                 13260081
132700     ELSE                                                         13270081
132800         SET DP013-CICS-ABEND      TO TRUE                        13280081
132900         SET DP013-NO-ROLLBACK     TO TRUE                        13290081
133000                                                                  13300081
133100         MOVE '2050-DELETE-LIST-QUEUE'                            13310081
133200                                   TO DP013-PARAGRAPH             13320081
133300         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13330081
133400                                   TO DP013-MESSAGE-TEXT (1)      13340081
133500         PERFORM DP013-0000-PROCESS-ABEND                         13350081
133600     END-IF.                                                      13360081
133700                                                                  13370081
133800     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13380081
133900 EJECT                                                            13390081
134000*----------------------------------------------------------------*13400081
134100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13410081
134200* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13420081
134300* CICS ARCHITECTURE API.                                         *13430081
134400*----------------------------------------------------------------*13440081
134500 2100-CHECK-FUNCTION-KEY.                                         13450081
134600     EVALUATE TRUE                                                13460081
134700****    PF14  GO TO RECEIVER PACK LIST                            13470081
134800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13480081
134900             INITIALIZE RC800-INTER-APPL-COMMAREA                 13490081
135000             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    13500081
135100                                 TO RC800-NUMBER-OF-SELECTED-ITEMS13510081
135200             MOVE ASC-PO-NBR     TO RC800-REC-NBR-N               13520081
135300             MOVE ASC-REC-SEQ-NBR                                 13530081
135400                                 TO RC800-REC-SEQ-NBR-N           13540081
135500             MOVE ASC-OPER-UNT-ID                                 13550081
135600                                 TO RC800-OPER-UNIT-ID            13560081
135700             MOVE ASC-FCLTY-ID   TO RC800-FACILITY-ID             13570081
135800             MOVE ASC-SEL-QUEUE-NAME TO RC800-SEL-QUEUE-NAME      13580081
135900                                                                  13590081
136000             SET ASC-UPDATE-TSQ        TO  TRUE                   13600081
136100                                                                  13610081
136200             SET RC801-IDX             TO  1                      13620081
136300             MOVE 1                    TO RC800-NUMBER-OF-TS-ITEMS13630081
136400                                                                  13640081
136500             INITIALIZE RC801-SELECTED-ITEM-ARRAY                 13650081
136600             MOVE ASC-PACK-ID  TO RC801-PACK-ID  (RC801-IDX)      13660081
136700                                                                  13670081
136800             PERFORM 5205-WRITE-SEL-QUEUE                         13680081
136900             ADD +1                TO RC800-NUMBER-OF-TS-ITEMS    13690081
137000                                                                  13700081
137100****    PF15  UPDATE                                              13710081
137200         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13720081
137300             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13730081
137400                 IF ASC-UPDATE-NOT-ALLOWED                        13740081
137500                     SET ASC-CONFIRMED TO TRUE                    13750081
137600                     MOVE PC-TSYMSG-03233                         13760081
137700                             TO  DP020-MSG-NUMBER                 13770081
137800                     SET PS-ERROR                                 13780081
137900                         DP030-OVERRIDE-GO                        13790081
138000                         DP020-MSG-WARNING TO TRUE                13800081
138100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13810081
138200                 ELSE                                             13820081
138300                     INITIALIZE RC036-INTER-APPL-COMMAREA         13830081
138400                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            13840081
138500                                TO RC036-NUMBER-OF-SELECTED-ITEMS 13850081
138600                     PERFORM 5000-PREPARE-SEL-QUEUE               13860081
138700                 END-IF                                           13870081
138800             ELSE                                                 13880081
138900                 SET DP030-OVERRIDE-GO                            13890081
139000                                   TO TRUE                        13900081
139100                 MOVE PC-TSYMSG-00057                             13910081
139200                                   TO DP020-MSG-NUMBER            13920081
139300                 SET DP020-MSG-WARNING                            13930081
139400                                   TO TRUE                        13940081
139500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13950081
139600             END-IF                                               13960081
139700                                                                  13970081
139800****    PF24 - DISSOLVE PACK                                      13980081
139900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              13990081
140000             IF ASC-UPDATE-NOT-ALLOWED                            14000081
140100                SET ASC-CONFIRMED TO TRUE                         14010081
140200                MOVE PC-TSYMSG-03233                              14020081
140300                        TO  DP020-MSG-NUMBER                      14030081
140400                SET PS-ERROR                                      14040081
140500                     DP030-OVERRIDE-GO                            14050081
140600                     DP020-MSG-WARNING TO TRUE                    14060081
140700                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14070081
140800             ELSE                                                 14080081
140900                                                                  14090081
141000             IF ASC-RECEIV-STATUS-CDE = 'VE' AND                  14100081
141100                ASC-RECEIV-ML-POST-TMST                           14110081
141200                               NOT = PC-DB2-DEFAULT-TMST AND      14120081
141300                 ASC-NOT-POST-VERIFIED-RECEIPT                    14130081
141400                 SET DP030-OVERRIDE-GO                            14140081
141500                                   TO TRUE                        14150081
141600                 MOVE PC-TSYMSG-03083                             14160081
141700                                   TO DP020-MSG-NUMBER            14170081
141800                 SET DP020-MSG-WARNING                            14180081
141900                                   TO TRUE                        14190081
142000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14200081
142100             ELSE                                                 14210081
142200                 IF (ASC-POST-VERIFIED-RECEIPT AND                14220081
142300                    ASC-TOT-VERFYD-PACKS < 1) OR                  14230081
142400                    (ASC-NOT-POST-VERIFIED-RECEIPT AND            14240081
142500                    ASC-TOT-ACTUAL-PACKS < 1)                     14250081
142600                         MOVE PC-TSYMSG-03077                     14260081
142700                                    TO  DP020-MSG-NUMBER          14270081
142800                         SET PS-ERROR                             14280081
142900                             DP030-OVERRIDE-GO                    14290081
143000                             DP020-MSG-WARNING TO TRUE            14300081
143100                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     14310081
143200                 ELSE                                             14320081
143300                     IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO      14330081
143400                         MOVE PC-TSYMSG-03078                     14340081
143500                                    TO  DP020-MSG-NUMBER          14350081
143600                         SET PS-ERROR                             14360081
143700                             DP030-OVERRIDE-GO                    14370081
143800                             DP020-MSG-WARNING TO TRUE            14380081
143900                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     14390081
144000                     ELSE                                         14400081
144100                         SET ASC-CONFIRM TO TRUE                  14410081
144200                         MOVE PC-TSYMSG-03075                     14420081
144300                                    TO  DP020-MSG-NUMBER          14430081
144400                         SET PS-ERROR                             14440081
144500                             DP030-OVERRIDE-GO                    14450081
144600                             DP020-MSG-WARNING TO TRUE            14460081
144700                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     14470081
144800                     END-IF                                       14480081
144900                 END-IF                                           14490081
145000             END-IF                                               14500081
145100             END-IF                                               14510081
145200                                                                  14520081
145300         WHEN  DP020-FK-CONFIRM (DP020-SRC-AID)                   14530081
145400*** CONFIRM FOR UPDATE                                            14540081
145500             IF ASC-CONFIRMED                                     14550081
145600                 INITIALIZE RC036-INTER-APPL-COMMAREA             14560081
145700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14570081
145800                            TO RC036-NUMBER-OF-SELECTED-ITEMS     14580081
145900                 PERFORM 5000-PREPARE-SEL-QUEUE                   14590081
146000                 SET ASC-NOT-CONFIRMED TO TRUE                    14600081
146100             ELSE                                                 14610081
146200*** CONFIRM TO DISSOLVE A PACK                                    14620081
146300                 IF ASC-CONFIRM                                   14630081
146400                     PERFORM 5000-PREPARE-SEL-QUEUE               14640081
146500                     SET ASC-NOT-CONFIRM TO TRUE                  14650081
146600                 ELSE                                             14660081
146700                     MOVE PC-TSYMSG-00045                         14670081
146800                                TO  DP020-MSG-NUMBER              14680081
146900                     SET PS-ERROR                                 14690081
147000                         DP030-OVERRIDE-GO                        14700081
147100                         DP020-MSG-WARNING TO TRUE                14710081
147200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14720081
147300                 END-IF                                           14730081
147400             END-IF                                               14740081
147500                                                                  14750081
147600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14760081
147700             MOVE +1               TO PV-TOP-ITEM                 14770081
147800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14780081
147900                                                                  14790081
148000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14800081
148100             PERFORM 2110-BROWSE-BACKWARD                         14810081
148200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14820081
148300                                                                  14830081
148400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   14840081
148500             PERFORM 2120-BROWSE-FORWARD                          14850081
148600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14860081
148700                                                                  14870081
148800         WHEN DP020-SRC-AID = DP016-ENTER                         14880081
148900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   14890081
149000             IF  PS-ERROR                                         14900081
149100                 CONTINUE                                         14910081
149200             ELSE                                                 14920081
149300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14930081
149400             END-IF                                               14940081
149500                                                                  14950081
149600********                                                          14960081
149700         WHEN OTHER                                               14970081
149800             SET DP013-NO-ROLLBACK                                14980081
149900                 DP013-XCTL-DISPLAY-RESTART                       14990081
150000                 DP013-CICS-ABEND  TO TRUE                        15000081
150100             MOVE '2100-CHECK-FUNCTION-KEY'                       15010081
150200                                   TO DP013-PARAGRAPH             15020081
150300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      15030081
150400                                   TO DP013-MESSAGE-TEXT (1)      15040081
150500             PERFORM DP013-0000-PROCESS-ABEND                     15050081
150600     END-EVALUATE.                                                15060081
150700                                                                  15070081
150800                                                                  15080081
150900*                                                                 15090081
151000*----------------------------------------------------------------*15100081
151100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *15110081
151200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *15120081
151300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *15130081
151400*    MESSAGE.                                                    *15140081
151500*----------------------------------------------------------------*15150081
151600                                                                  15160081
151700 2110-BROWSE-BACKWARD.                                            15170081
151800     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15180081
151900         GIVING PV-TOP-ITEM.                                      15190081
152000*                                                                 15200081
152100     IF  ((PV-TOP-ITEM < +1)                                      15210081
152200       OR (PV-TOP-ITEM = +1))                                     15220081
152300         MOVE +1                   TO PV-TOP-ITEM                 15230081
152400*        -- TOP OF LIST --                                        15240081
152500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15250081
152600         SET DP020-MSG-INFORMATIONAL TO TRUE                      15260081
152700     END-IF.                                                      15270081
152800                                                                  15280081
152900 EJECT                                                            15290081
153000*----------------------------------------------------------------*15300081
153100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *15310081
153200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *15320081
153300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *15330081
153400*----------------------------------------------------------------*15340081
153500                                                                  15350081
153600 2120-BROWSE-FORWARD.                                             15360081
153700                                                                  15370081
153800     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15380081
153900         GIVING PV-TOP-ITEM.                                      15390081
154000     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15400081
154100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15410081
154200                                   TO PV-TOP-ITEM                 15420081
154300*        -- BOTTOM OF LIST --                                     15430081
154400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15440081
154500         SET DP020-MSG-INFORMATIONAL                              15450081
154600                                   TO TRUE                        15460081
154700     ELSE                                                         15470081
154800         COMPUTE PV-BOTTOM-ITEM =                                 15480081
154900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15490081
155000         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            15500081
155100*            -- BOTTOM OF LIST --                                 15510081
155200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15520081
155300             SET DP020-MSG-INFORMATIONAL                          15530081
155400                                   TO TRUE                        15540081
155500         END-IF                                                   15550081
155600     END-IF.                                                      15560081
155700 EJECT                                                            15570081
155800*----------------------------------------------------------------*15580081
155900*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *15590081
156000*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *15600081
156100*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *15610081
156200*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *15620081
156300*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *15630081
156400*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *15640081
156500*----------------------------------------------------------------*15650081
156600                                                                  15660081
156700 2130-CHECK-FOR-JUMP-BROWSE.                                      15670081
156800     SET PS-NO-ERROR               TO TRUE.                       15680081
156900     IF (ASC-START-ITEM-REQUEST = SPACE)                          15690081
157000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15700081
157100                                   TO PV-TOP-ITEM                 15710081
157200     ELSE                                                         15720081
157300         MOVE ASC-START-ITEM-REQUEST                              15730081
157400                                   TO DP010I-UNEDITED-FIELD       15740081
157500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15750081
157600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15760081
157700         SET DP010I-NEGATIVE-NOT-ALLOWED                          15770081
157800                                   TO TRUE                        15780081
157900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15790091
157910              USING DP010I-NUMERIC-EDIT-AREA                      15791091
158000                                                                  15800081
158100         IF  NOT DP010I-ERROR-DETECTED                            15810081
158200             MOVE DP010I-NUMERIC-FIELD                            15820081
158300                                   TO  ASC-START-ITEM-REQUEST-N   15830081
158400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  15840081
158500                 IF  ASC-START-ITEM-REQUEST-N >                   15850081
158600                                          ASC-NUMBER-OF-ITEMS-READ15860081
158700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         15870081
158800                     COMPUTE PV-TOP-ITEM =                        15880081
158900                             ASC-NUMBER-OF-ITEMS-READ             15890081
159000                             - PC-ITEMS-PER-PANEL + 1             15900081
159100                     IF  PV-TOP-ITEM < +1                         15910081
159200                         MOVE +1   TO PV-TOP-ITEM                 15920081
159300                         MOVE PC-TSYMSG-00070                     15930081
159400                                   TO DP020-MSG-NUMBER            15940081
159500                         SET DP020-MSG-INFORMATIONAL              15950081
159600                                   TO TRUE                        15960081
159700                     END-IF                                       15970081
159800                 ELSE                                             15980081
159900                     MOVE ASC-START-ITEM-REQUEST-N                15990081
160000                                   TO PV-TOP-ITEM                 16000081
160100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      16010081
160200                     COMPUTE PV-BOTTOM-ITEM =                     16020081
160300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16030081
160400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16040081
160500*                        -- BOTTOM OF LIST --                     16050081
160600                         MOVE PC-TSYMSG-00070                     16060081
160700                                   TO DP020-MSG-NUMBER            16070081
160800                         SET DP020-MSG-INFORMATIONAL              16080081
160900                                   TO TRUE                        16090081
161000                     END-IF                                       16100081
161100                 END-IF                                           16110081
161200             ELSE                                                 16120081
161300*                --- VALUE OUT OF RANGE ----                      16130081
161400                 MOVE PC-TSYMSG-00101                             16140081
161500                                   TO DP020-MSG-NUMBER            16150081
161600                 MOVE -1           TO ASTRTITL                    16160081
161700                 SET DP030-SET-CURSOR-APPL-1                      16170081
161800                                   TO TRUE                        16180081
161900                 MOVE DP015-REVERSE                               16190081
162000                                   TO ASTRTITH                    16200081
162100                 MOVE DP015-RED    TO ASTRTITC                    16210081
162200                 MOVE DP015-UNP-NUM-BRT-MDT                       16220081
162300                                   TO ASTRTITA                    16230081
162400                 SET DP020-MSG-FATAL                              16240081
162500                                   TO TRUE                        16250081
162600                 SET PS-ERROR      TO TRUE                        16260081
162700             END-IF                                               16270081
162800                                                                  16280081
162900         ELSE                                                     16290081
163000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16300081
163100             MOVE -1               TO ASTRTITL                    16310081
163200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16320081
163300             MOVE DP015-REVERSE    TO ASTRTITH                    16330081
163400             MOVE DP015-RED        TO ASTRTITC                    16340081
163500             MOVE DP015-UNP-NUM-BRT-MDT                           16350081
163600                                   TO ASTRTITA                    16360081
163700             SET DP020-MSG-FATAL   TO TRUE                        16370081
163800             SET PS-ERROR          TO TRUE                        16380081
163900         END-IF                                                   16390081
164000     END-IF.                                                      16400081
164100 EJECT                                                            16410081
164200*----------------------------------------------------------------*16420081
164300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *16430081
164400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *16440081
164500*----------------------------------------------------------------*16450081
164600 2140-DESELECT-ALL-ITEMS.                                         16460081
164700     MOVE +1                       TO ASC-BLK-SUB.                16470081
164800                                                                  16480081
164900     PERFORM 2141-CLEAR-SELECTED-INDS                             16490081
165000         VARYING ASC-ITEM-SUB                                     16500081
165100         FROM 1 BY 1                                              16510081
165200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16520081
165300                                                                  16530081
165400     ADD +1                        TO ASC-BLK-SUB.                16540081
165500                                                                  16550081
165600     PERFORM 2141-CLEAR-SELECTED-INDS                             16560081
165700         VARYING ASC-ITEM-SUB                                     16570081
165800         FROM 1 BY 1                                              16580081
165900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16590081
166000                                                                  16600081
166100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16610081
166200                                   TO PV-LIST-ITEM-NUMBER.        16620081
166300                                                                  16630081
166400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16640081
166500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16650081
166600                                                                  16660081
166700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16670081
166800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16680081
166900         MOVE +1                   TO ASC-BLK-SUB                 16690081
167000                                                                  16700081
167100         PERFORM 5100-WRITE-TEMP-STORAGE                          16710081
167200                                                                  16720081
167300         MOVE +1                   TO PV-BLOCK-NUMBER             16730081
167400                                                                  16740081
167500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16750081
167600             PV-FIRST-BLOCK-IN-ARRAY - 1                          16760081
167700                                                                  16770081
167800         PERFORM                                                  16780081
167900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16790081
168000                                                                  16800081
168100             PERFORM 4410-READ-TEMP-STORAGE                       16810081
168200                                                                  16820081
168300             PERFORM 2141-CLEAR-SELECTED-INDS                     16830081
168400                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16840081
168500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16850081
168600                                                                  16860081
168700             PERFORM 5100-WRITE-TEMP-STORAGE                      16870081
168800                                                                  16880081
168900             ADD +1                TO PV-BLOCK-NUMBER             16890081
169000                                                                  16900081
169100         END-PERFORM                                              16910081
169200                                                                  16920081
169300         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16930081
169400             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16940081
169500                                                                  16950081
169600         PERFORM                                                  16960081
169700             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16970081
169800                   ASC-HIGHEST-BLOCK-WRITTEN                      16980081
169900                                                                  16990081
170000             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17000081
170100                                   TO PV-BLOCK-NUMBER             17010081
170200                                                                  17020081
170300             PERFORM 4410-READ-TEMP-STORAGE                       17030081
170400                                                                  17040081
170500             PERFORM 2141-CLEAR-SELECTED-INDS                     17050081
170600                 VARYING ASC-ITEM-SUB                             17060081
170700                 FROM 1 BY 1                                      17070081
170800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17080081
170900                                                                  17090081
171000             PERFORM 5100-WRITE-TEMP-STORAGE                      17100081
171100                                                                  17110081
171200             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17120081
171300                                                                  17130081
171400         END-PERFORM                                              17140081
171500                                                                  17150081
171600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17160081
171700                                   TO PV-BLOCK-NUMBER             17170081
171800                                                                  17180081
171900         PERFORM 4410-READ-TEMP-STORAGE                           17190081
172000     END-IF.                                                      17200081
172100                                                                  17210081
172200                                                                  17220081
172300     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 17230081
172400     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.17240081
172500     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  17250081
172600                                                                  17260081
172700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17270081
172800                                                                  17280081
172900 EJECT                                                            17290081
173000*----------------------------------------------------------------*17300081
173100*    MARK EACH ITEM AS BEING NOT SELECTED.                       *17310081
173200*----------------------------------------------------------------*17320081
173300                                                                  17330081
173400 2141-CLEAR-SELECTED-INDS.                                        17340081
173500                                                                  17350081
173600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17360081
173700             NOT EQUAL ZERO                                       17370081
173800         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17380081
173900             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17390081
174000                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17400081
174100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17410081
174200                                   TO TRUE                        17420081
174300         END-IF                                                   17430081
174400     END-IF.                                                      17440081
174500                                                                  17450081
174600 EJECT                                                            17460081
174700*----------------------------------------------------------------*17470081
174800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *17480081
174900*  FOR ALL ITEMS.                                                *17490081
175000*----------------------------------------------------------------*17500081
175100                                                                  17510081
175200 2150-SELECT-ALL-ITEMS.                                           17520081
175300                                                                  17530081
175400     MOVE +1                       TO ASC-BLK-SUB.                17540081
175500                                                                  17550081
175600     PERFORM 2151-SET-SELECTED-INDS                               17560081
175700         VARYING ASC-ITEM-SUB                                     17570081
175800         FROM 1 BY 1                                              17580081
175900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17590081
176000                                                                  17600081
176100     ADD +1                        TO ASC-BLK-SUB.                17610081
176200                                                                  17620081
176300     PERFORM 2151-SET-SELECTED-INDS                               17630081
176400         VARYING ASC-ITEM-SUB                                     17640081
176500         FROM 1 BY 1                                              17650081
176600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17660081
176700                                                                  17670081
176800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17680081
176900                                   TO PV-LIST-ITEM-NUMBER.        17690081
177000                                                                  17700081
177100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17710081
177200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17720081
177300                                                                  17730081
177400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17740081
177500        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    17750081
177600         MOVE +1                   TO ASC-BLK-SUB                 17760081
177700                                                                  17770081
177800         PERFORM 5100-WRITE-TEMP-STORAGE                          17780081
177900                                                                  17790081
178000         MOVE +1                   TO PV-BLOCK-NUMBER             17800081
178100                                                                  17810081
178200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17820081
178300             PV-FIRST-BLOCK-IN-ARRAY - 1                          17830081
178400                                                                  17840081
178500         PERFORM                                                  17850081
178600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17860081
178700                                                                  17870081
178800             PERFORM 4410-READ-TEMP-STORAGE                       17880081
178900                                                                  17890081
179000             PERFORM 2151-SET-SELECTED-INDS                       17900081
179100                 VARYING ASC-ITEM-SUB                             17910081
179200                 FROM 1 BY 1                                      17920081
179300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17930081
179400                                                                  17940081
179500             PERFORM 5100-WRITE-TEMP-STORAGE                      17950081
179600                                                                  17960081
179700             ADD +1                TO PV-BLOCK-NUMBER             17970081
179800                                                                  17980081
179900         END-PERFORM                                              17990081
180000                                                                  18000081
180100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18010081
180200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18020081
180300                                                                  18030081
180400         PERFORM                                                  18040081
180500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18050081
180600                   ASC-HIGHEST-BLOCK-WRITTEN                      18060081
180700                                                                  18070081
180800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18080081
180900                                   TO PV-BLOCK-NUMBER             18090081
181000                                                                  18100081
181100             PERFORM 4410-READ-TEMP-STORAGE                       18110081
181200                                                                  18120081
181300             PERFORM 2151-SET-SELECTED-INDS                       18130081
181400                 VARYING ASC-ITEM-SUB                             18140081
181500                 FROM 1 BY 1                                      18150081
181600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18160081
181700                                                                  18170081
181800             PERFORM 5100-WRITE-TEMP-STORAGE                      18180081
181900                                                                  18190081
182000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18200081
182100                                                                  18210081
182200         END-PERFORM                                              18220081
182300                                                                  18230081
182400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18240081
182500                                   TO PV-BLOCK-NUMBER             18250081
182600                                                                  18260081
182700         PERFORM 4410-READ-TEMP-STORAGE                           18270081
182800     END-IF.                                                      18280081
182900                                                                  18290081
183000                                                                  18300081
183100     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18310081
183200                       ASC-NUMBER-OF-SELECTED-ITEMS.              18320081
183300                                                                  18330081
183400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18340081
183500                                                                  18350081
183600 EJECT                                                            18360081
183700*----------------------------------------------------------------*18370081
183800*    MARK EACH ITEM AS BEING SELECTED.                           *18380081
183900*----------------------------------------------------------------*18390081
184000                                                                  18400081
184100 2151-SET-SELECTED-INDS.                                          18410081
184200                                                                  18420081
184300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18430081
184400             NOT EQUAL ZERO                                       18440081
184500         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18450081
184600             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18460081
184700                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18470081
184800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18480081
184900                               TO  TRUE                           18490081
185000         END-IF                                                   18500081
185100     END-IF.                                                      18510081
185200                                                                  18520081
185300                                                                  18530081
185400******************************************************************18540081
185500** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **18550081
185600** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **18560081
185700******************************************************************18570081
185800 2200-MOVE-SCREEN-TO-COMMAREA.                                    18580081
185900                                                                  18590081
186000     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18600081
186100     MOVE +1                       TO PV-SUB.                     18610081
186200*                                                                 18620081
186300     PERFORM 3100-SET-SUBSCRIPTS.                                 18630081
186400     IF  ASTRTITL > ZERO                                          18640081
186500         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          18650081
186600     ELSE                                                         18660081
186700         IF  ASTRTITF = DP015-ERASE-EOF                           18670081
186800             INITIALIZE ASC-START-ITEM-REQUEST                    18680081
186900         END-IF                                                   18690081
187000     END-IF.                                                      18700081
187100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18710081
187200         VARYING PV-SUB                                           18720081
187300         FROM 1 BY 1                                              18730081
187400         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      18740081
187500******************************************************************18750081
187600** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**18760081
187700******************************************************************18770081
187800 2210-MOVE-LINES-TO-COMMAREA.                                     18780081
187900     IF  MR-SELECTL (PV-SUB) > ZERO                               18790081
188000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18800081
188100         MOVE MR-SELECTI (PV-SUB)                                 18810081
188200                                   TO ASC-TEMP-SELECTED-SW        18820081
188300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18830081
188400     ELSE                                                         18840081
188500         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                18850081
188600                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     18860081
188700                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        18870081
188800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18880081
188900         END-IF                                                   18890081
189000     END-IF.                                                      18900081
189100                                                                  18910081
189200     IF MR-UPDATE-ODDSL (PV-SUB) > ZERO                           18920081
189300         MOVE MR-UPDATE-ODDS (PV-SUB)                             18930081
189400                                 TO ASC-UPDATE-ODDS               18940081
189500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18950081
189600     ELSE                                                         18960081
189700         IF MR-UPDATE-ODDSA (PV-SUB) = DP015-ERASE-EOF            18970081
189800             MOVE SPACES         TO ASC-UPDATE-ODDS               18980081
189900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     18990081
190000         END-IF                                                   19000081
190100     END-IF.                                                      19010081
190200                                                                  19020081
190300     ADD +1                        TO ASC-ITEM-SUB.               19030081
190400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19040081
190500         ADD +1                    TO ASC-BLK-SUB                 19050081
190600         MOVE +1                   TO ASC-ITEM-SUB                19060081
190700     END-IF.                                                      19070081
190800******************************************************************19080081
190900** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **19090081
191000** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **19100081
191100******************************************************************19110081
191200 3000-EDIT-DATA-IN-COMMAREA.                                      19120081
191300     SET PS-NO-ERROR               TO TRUE.                       19130081
191400     IF ASC-AUTO-VE-YES                                           19140081
191500        CONTINUE                                                  19150081
191600     ELSE                                                         19160081
191700        PERFORM 3200-RESET-ATTRIBUTES                             19170081
191800     END-IF.                                                      19180081
191900     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     19190081
192000                                                                  19200081
192100*                                                                 19210081
192200**                                                                19220081
192300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              19230081
192400* EDITTING IS DONE FROM THE BOTTOM UP.                            19240081
192500**                                                                19250081
192600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19260081
192700         ASC-ITEMS-DISPLAYED - 1.                                 19270081
192800     PERFORM 3100-SET-SUBSCRIPTS.                                 19280081
192900     PERFORM 3300-EDIT-SELECTIONS                                 19290081
193000         VARYING PV-SUB                                           19300081
193100         FROM PV-SUB BY -1                                        19310081
193200         UNTIL PV-SUB < +1                                        19320081
193300*                                                                 19330081
193400     IF  PS-NO-ERROR                                              19340081
193500         PERFORM 3400-CHECK-RANGE-SEQUENCE                        19350081
193600     END-IF.                                                      19360081
193700*                                                                 19370081
193800     IF  ((PS-NO-ERROR)                                           19380081
193900       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   19390081
194000       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    19400081
194100             PERFORM 3500-MARK-RANGE-AS-SELECTED                  19410081
194200     END-IF.                                                      19420081
194300 EJECT                                                            19430081
194400*----------------------------------------------------------------*19440081
194500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *19450081
194600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*19460081
194700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *19470081
194800*                                                                *19480081
194900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *19490081
195000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *19500081
195100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *19510081
195200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *19520081
195300*----------------------------------------------------------------*19530081
195400                                                                  19540081
195500 3100-SET-SUBSCRIPTS.                                             19550081
195600                                                                  19560081
195700     COMPUTE ASC-ITEM-SUB =                                       19570081
195800         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        19580081
195900                                                                  19590081
196000     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19600081
196100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19610081
196200                                                                  19620081
196300         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               19630081
196400     ELSE                                                         19640081
196500         MOVE +1                     TO ASC-BLK-SUB               19650081
196600     END-IF.                                                      19660081
196700******************************************************************19670081
196800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **19680081
196900******************************************************************19690081
197000                                                                  19700081
197100 3200-RESET-ATTRIBUTES.                                           19710081
197200     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   19720081
197300     MOVE DP015-GREEN              TO ASTRTITC.                   19730081
197400     MOVE DP015-UNDERLINE          TO ASTRTITH.                   19740081
197500*                                                                 19750081
197600     PERFORM                                                      19760081
197700         VARYING PV-SUB                                           19770081
197800         FROM 1 BY 1                                              19780081
197900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        19790081
198000         IF ASC-RECEIV-STATUS-CDE = 'VE' AND                      19800081
198100            ASC-RECEIV-ML-POST-TMST NOT = PC-DB2-DEFAULT-TMST AND 19810081
198200            ASC-NOT-POST-VERIFIED-RECEIPT                         19820081
198300                 MOVE DP015-ASK-DRK-OFF                           19830081
198400                                       TO MR-UPDATE-ODDSA (PV-SUB)19840081
198500                                          MR-SELECTA (PV-SUB)     19850081
198600                 MOVE DP015-HL-OFF                                19860081
198700                                       TO MR-UPDATE-ODDSH (PV-SUB)19870081
198800                                          MR-SELECTH (PV-SUB)     19880081
198900         ELSE                                                     19890081
199000             MOVE DP015-UNP-ALP-NOR-OFF                           19900081
199100                                   TO MR-SELECTA (PV-SUB)         19910081
199200                                      MR-UPDATE-ODDSA (PV-SUB)    19920081
199300             MOVE DP015-GREEN      TO MR-SELECTC (PV-SUB)         19930081
199400                                      MR-UPDATE-ODDSC (PV-SUB)    19940081
199500             MOVE DP015-UNDERLINE  TO MR-SELECTH (PV-SUB)         19950081
199600                                      MR-UPDATE-ODDSH (PV-SUB)    19960081
199700         END-IF                                                   19970081
199800     END-PERFORM.                                                 19980081
199900******************************************************************19990081
200000** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **20000081
200100** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **20010081
200200** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **20020081
200300** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **20030081
200400******************************************************************20040081
200500 3300-EDIT-SELECTIONS.                                            20050081
200600     EVALUATE TRUE                                                20060081
200700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20070081
200800             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         20080081
200900                 IF (DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) OR     20090081
201000                     DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)) AND   20100081
201100                       ASC-AUTO-VE-YES                            20110081
201200* DMH 1/19/16 BEGIN                                               20120081
201300                       IF  ASC-RACF-OVERRIDE-YES  AND             20130081
201400                           ASC-CURR-OPER-EFC-YES                  20140081
201500                           IF  ASC-HAS-WORK-ORDER-INST            20150081
201600                               CONTINUE                           20160081
201700                           ELSE                                   20170081
201800                               SET PS-ERROR                       20180081
201900                               DP020-MSG-FATAL   TO TRUE          20190081
202000                               MOVE PC-TSYMSG-03706               20200081
202100                                           TO DP020-MSG-NUMBER    20210081
202110                               SET DP030-SET-CURSOR-APPL-1        20211081
202120                                               TO TRUE            20212081
202130                               MOVE -1     TO MR-SELECTL (PV-SUB) 20213081
202131                               MOVE DP015-RED                     20213181
202132                                           TO MR-SELECTC (PV-SUB) 20213281
202133                               MOVE DP015-REVERSE                 20213381
202134                                           TO MR-SELECTH (PV-SUB) 20213481
202135                           END-IF                                 20213581
202136                       ELSE                                       20213681
202137* DMH 1/19/16 END                                                 20213781
202138                           SET PS-ERROR           TO TRUE         20213881
202139                           MOVE PC-TSYMSG-03180                   20213981
202140                                TO DP020-MSG-NUMBER               20214081
202150                           SET PS-ERROR                           20215081
202160                               DP020-MSG-FATAL                    20216081
202170                               DP030-SET-CURSOR-APPL-1            20217081
202180                                            TO TRUE               20218081
202190                           MOVE -1        TO MR-SELECTL (PV-SUB)  20219081
202200                           MOVE DP015-RED TO MR-SELECTC (PV-SUB)  20220081
202300                           MOVE DP015-REVERSE                     20230081
202400                                          TO MR-SELECTH (PV-SUB)  20240081
202500                       END-IF                                     20250081
202600                 END-IF                                           20260081
202700         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         20270081
202800                 IF (DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID) OR     20280081
202900                     DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)) AND   20290081
203000                       ASC-AUTO-VE-YES                            20300081
203100* DMH 1/19/16 BEGIN                                               20310081
203200                       IF  ASC-RACF-OVERRIDE-YES  AND             20320081
203300                           ASC-CURR-OPER-EFC-YES                  20330081
203400                           IF  ASC-HAS-WORK-ORDER-INST            20340081
203500                               CONTINUE                           20350081
203600                           ELSE                                   20360081
203610                               SET PS-ERROR                       20361081
203620                               DP020-MSG-FATAL   TO TRUE          20362081
203630                               MOVE PC-TSYMSG-03706               20363081
203631                                           TO DP020-MSG-NUMBER    20363181
203632                               SET DP030-SET-CURSOR-APPL-1        20363281
203633                                               TO TRUE            20363381
203634                               MOVE -1     TO MR-SELECTL (PV-SUB) 20363481
203635                               MOVE DP015-RED                     20363581
203636                                           TO MR-SELECTC (PV-SUB) 20363681
203637                               MOVE DP015-REVERSE                 20363781
203638                                           TO MR-SELECTH (PV-SUB) 20363881
203639                           END-IF                                 20363981
203640                       ELSE                                       20364081
203650* DMH 1/19/16 END                                                 20365081
203660                           SET PS-ERROR           TO TRUE         20366081
203670                           MOVE PC-TSYMSG-03180                   20367081
203680                                    TO DP020-MSG-NUMBER           20368081
203690                           SET PS-ERROR                           20369081
203700                               DP020-MSG-FATAL                    20370081
203800                               DP030-SET-CURSOR-APPL-1            20380081
203900                                               TO TRUE            20390081
204000                               MOVE -1     TO MR-SELECTL (PV-SUB) 20400081
204100                               MOVE DP015-RED                     20410081
204200                                           TO MR-SELECTC (PV-SUB) 20420081
204300                              MOVE DP015-REVERSE                  20430081
204400                                           TO MR-SELECTH (PV-SUB) 20440081
204500                       END-IF                                     20450081
204600                 END-IF                                           20460081
204700             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        20470081
204800                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   20480081
204900                 MOVE ASC-TEMP-SELECTED-SW                        20490081
205000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20500081
205100                                TO ASC-SELECTED-SW                20510081
205200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20520081
205300             END-IF                                               20530081
205400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     20540081
205500                 = SPACE                                          20550081
205600             EVALUATE TRUE                                        20560081
205700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       20570081
205800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS20580081
205900                     MOVE SPACE TO ASC-SELECTED-SW                20590081
206000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20600081
206100                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        20610081
206200                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    20620081
206300                     MOVE SPACE TO ASC-SELECTED-SW                20630081
206400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20640081
206500                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          20650081
206600                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      20660081
206700                     MOVE SPACE TO ASC-SELECTED-SW                20670081
206800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20680081
206900             END-EVALUATE                                         20690081
207000         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           20700081
207100             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20710081
207200                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20720081
207300             END-IF                                               20730081
207400             PERFORM 3310-EDIT-RANGE                              20740081
207500         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             20750081
207600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20760081
207700                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    20770081
207800             END-IF                                               20780081
207900             PERFORM 3310-EDIT-RANGE                              20790081
208000         WHEN OTHER                                               20800081
208100             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           20810081
208200             SET DP020-MSG-FATAL    TO TRUE                       20820081
208300             MOVE -1                TO MR-SELECTL (PV-SUB)        20830081
208400             SET DP030-SET-CURSOR-APPL-1                          20840081
208500                                    TO TRUE                       20850081
208600             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        20860081
208700             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        20870081
208800             SET PS-ERROR TO TRUE                                 20880081
208900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            20890081
209000                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     20900081
209100                 MOVE SPACE         TO ASC-SELECTED-SW            20910081
209200                                        (ASC-BLK-SUB ASC-ITEM-SUB)20920081
209300             END-IF                                               20930081
209400     END-EVALUATE.                                                20940081
209500                                                                  20950081
209600     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     20960081
209700        OR ASC-RANGE-ON                                           20970081
209800        OR ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                   20980081
209900         IF ASC-UPDATE-ODDS (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES   20990081
210000             MOVE ASC-UPDATE-ODDS (ASC-BLK-SUB ASC-ITEM-SUB)      21000081
210100                                 TO DP010I-UNEDITED-FIELD         21010081
210200             MOVE LENGTH OF ASC-UPDATE-ODDS                       21020081
210300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21030081
210400                                 TO DP010I-MAXIMUM-DIGITS         21040081
210500             MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS       21050081
210600             SET DP010I-NEGATIVE-NOT-ALLOWED                      21060081
210700                                 TO TRUE                          21070081
210800             CALL DP010I-NUMERIC-EDIT-ROUTINE                     21080091
210810                  USING DP010I-NUMERIC-EDIT-AREA                  21081091
210900                                                                  21090081
211000             IF  DP010I-ERROR-DETECTED                            21100081
211100                 SET PS-ERROR                                     21110081
211200                     DP020-MSG-FATAL                              21120081
211300                     DP030-SET-CURSOR-APPL-1                      21130081
211400                                 TO TRUE                          21140081
211500                 MOVE PC-TSYMSG-00005                             21150081
211600                                 TO DP020-MSG-NUMBER              21160081
211700                 MOVE DP015-UNP-NUM-BRT-OFF                       21170081
211800                                 TO MR-UPDATE-ODDSA (PV-SUB)      21180081
211900                 MOVE -1         TO MR-UPDATE-ODDSL (PV-SUB)      21190081
212000                 MOVE DP015-RED  TO MR-UPDATE-ODDSC (PV-SUB)      21200081
212100                 MOVE DP015-REVERSE                               21210081
212200                                 TO MR-UPDATE-ODDSH (PV-SUB)      21220081
212300                 SET DP030-SET-CURSOR-APPL-1                      21230081
212400                                 TO TRUE                          21240081
212500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     21250081
212600             ELSE                                                 21260081
212700                 MOVE DP010I-NUMERIC-FIELD                        21270081
212800                                 TO ASC-UPDATE-ODDS-N             21280081
212900                                    (ASC-BLK-SUB ASC-ITEM-SUB)    21290081
213000                 MOVE ASC-UPDATE-ODDS (ASC-BLK-SUB ASC-ITEM-SUB)  21300081
213100                                 TO MR-UPDATE-ODDS (PV-SUB)       21310081
213200             END-IF                                               21320081
213300         END-IF                                                   21330081
213400     END-IF.                                                      21340081
213500                                                                  21350081
213600     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 21360081
213700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               21370081
213800     IF  ASC-ITEM-SUB < 1                                         21380081
213900         SUBTRACT +1 FROM ASC-BLK-SUB                             21390081
214000         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                21400081
214100     END-IF.                                                      21410081
214200******************************************************************21420081
214300** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **21430081
214400** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **21440081
214500** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**21450081
214600** THE ENDING.                                                  **21460081
214700******************************************************************21470081
214800 3310-EDIT-RANGE.                                                 21480081
214900     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                21490081
215000         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   21500081
215100             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)21510081
215200                                   TO ASC-SELECTED-SW             21520081
215300                                        (ASC-BLK-SUB ASC-ITEM-SUB)21530081
215400             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 21540081
215500         ELSE                                                     21550081
215600             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     21560081
215700                 CONTINUE                                         21570081
215800             ELSE                                                 21580081
215900*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        21590081
216000                 MOVE PC-TSYMSG-00054                             21600081
216100                                   TO DP020-MSG-NUMBER            21610081
216200                 SET DP020-MSG-FATAL                              21620081
216300                                   TO TRUE                        21630081
216400                 MOVE -1           TO MR-SELECTL (PV-SUB)         21640081
216500                 SET DP030-SET-CURSOR-APPL-1                      21650081
216600                                   TO TRUE                        21660081
216700                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         21670081
216800                 MOVE DP015-UNDERLINE                             21680081
216900                                   TO MR-SELECTH (PV-SUB)         21690081
217000                 SET PS-ERROR      TO TRUE                        21700081
217100             END-IF                                               21710081
217200         END-IF                                                   21720081
217300     ELSE                                                         21730081
217400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     21740081
217500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 21750081
217600                                   TO ASC-SELECTED-SW             21760081
217700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   21770081
217800             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   21780081
217900         ELSE                                                     21790081
218000             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       21800081
218100                 CONTINUE                                         21810081
218200             ELSE                                                 21820081
218300*                -- ONLY ONE END-OF-RANGE ALLOWED --              21830081
218400                 MOVE PC-TSYMSG-00055                             21840081
218500                                   TO DP020-MSG-NUMBER            21850081
218600                 SET DP020-MSG-FATAL                              21860081
218700                                   TO TRUE                        21870081
218800                 MOVE -1           TO MR-SELECTL (PV-SUB)         21880081
218900                 SET DP030-SET-CURSOR-APPL-1                      21890081
219000                                   TO TRUE                        21900081
219100                 SET PS-ERROR      TO TRUE                        21910081
219200             END-IF                                               21920081
219300         END-IF                                                   21930081
219400     END-IF.                                                      21940081
219500*                                                                 21950081
219600******************************************************************21960081
219601*  CHECK IF THE ASSOCIATE HAS RACF ACCESS TO BE ABLE TO MAKE     *21960181
219602*  POST VERIFICATION ADJUSTMENTS FOR EEFC RECEIVERS              *21960281
219603*  DMH ADDED 1/19/16                                              21960381
219604******************************************************************21960481
219605 3330-CHECK-EFCVEADJ.                                             21960581
219606     PERFORM 3335-RACF-OVERRIDE                                   21960681
219607     SET  ASC-HAS-WORK-ORDER-INST-NO TO TRUE                      21960781
219608     IF  ASC-RACF-OVERRIDE-YES                                    21960881
219609         PERFORM 3340-CHECK-EFC-CURR-OPER                         21960981
219610     END-IF.                                                      21961081
219620                                                                  21962081
219630                                                                  21963081
219631*----------------------------------------------------------------*21963181
219632* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR EFC POST VE    *21963281
219633*  DMH ADDED 1/19/16                                              21963381
219634*----------------------------------------------------------------*21963481
219635 3335-RACF-OVERRIDE.                                              21963581
219636                                                                  21963681
219637      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  21963781
219638      MOVE 'EFCVEADJ'                    TO DP008-FUNCTION-NAME   21963881
219639      SET DP008-ACCESS-TYPE-USE          TO TRUE                  21963981
219640                                                                  21964081
219641      EXEC CICS                                                   21964181
219642         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 21964281
219643              COMMAREA (DP008-SECURITY-COMMAREA)                  21964381
219644              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             21964481
219645      END-EXEC                                                    21964581
219646                                                                  21964681
219647      IF DP008-CALL-SUCCESSFUL                                    21964781
219648         IF DP008-ACCESS-ALLOWED                                  21964881
219649             SET ASC-RACF-OVERRIDE-YES  TO  TRUE                  21964981
219650         ELSE                                                     21965081
219651             SET ASC-RACF-OVERRIDE-NO   TO TRUE                   21965181
219652         END-IF                                                   21965281
219653     ELSE                                                         21965381
219654             SET ASC-RACF-OVERRIDE-NO   TO TRUE                   21965481
219655      END-IF.                                                     21965581
219656                                                                  21965681
219657                                                                  21965781
219658*----------------------------------------------------------------*21965881
219659* CHECK TO SEE CURR OPER ON RECEIVER IS FOR EFC                  *21965981
219660* DMH ADDED 1/19/16                                              *21966081
219661*----------------------------------------------------------------*21966181
219662 3340-CHECK-EFC-CURR-OPER.                                        21966281
219663                                                                  21966381
219664     MOVE ASC-PO-NBR      TO DK-PO-NBR.                           21966481
219665     MOVE ASC-REC-SEQ-NBR TO DK-REC-SEQ-NBR.                      21966581
219666                                                                  21966681
219667         EXEC SQL                                                 21966781
219668              SELECT  B.E_BUS_IND                                 21966881
219669                    , A.CURR_OPER_UNT_ID                          21966981
219670                INTO :XLT00010-E-BUS-IND                          21967081
219671                    ,:RECEIV-CURR-OPER-UNT-ID                     21967181
219672                FROM  TRECEIV A                                   21967281
219673                    , XLT_LOC B                                   21967381
219674               WHERE  A.ORD_NBR           =  :DK-PO-NBR           21967481
219675                 AND  A.REC_SEQ_NBR       =  :DK-REC-SEQ-NBR      21967581
219676                 AND  A.VER_STATUS_CDE    =  'A'                  21967681
219677                 AND  A.CURR_OPER_UNT_ID  =   B.LOC_NBR           21967781
219678                 AND  B.LOC_TYP_CDE       =  'DC'                 21967881
219679                 AND  B.E_BUS_IND         =  'Y'                  21967981
219680         END-EXEC.                                                21968081
219681                                                                  21968181
219682         EVALUATE TRUE                                            21968281
219683             WHEN SQLCODE = +0                                    21968381
219684                  SET  ASC-CURR-OPER-EFC-YES  TO  TRUE            21968481
219685                  PERFORM 3345-CHECK-WORK-ORDER-INST              21968581
219686             WHEN SQLCODE = +100                                  21968681
219687                  SET  ASC-CURR-OPER-EFC-NO   TO  TRUE            21968781
219688             WHEN SQLCODE = -904                                  21968881
219689             WHEN SQLCODE = -911                                  21968981
219690             WHEN SQLCODE = -913                                  21969081
219691                  PERFORM 9900-SOFT-ABORT                         21969181
219692                                                                  21969281
219693             WHEN SQLWARN0 NOT = SPACES                           21969381
219694             WHEN SQLCODE < +0                                    21969481
219695             WHEN SQLCODE > +0                                    21969581
219696                  MOVE '3030-CHECK-EFC-CURR-OPER'                 21969681
219697                                  TO DP013-PARAGRAPH              21969781
219698                  MOVE 'CHECK CURR OPER FOR E-BUS-IND   '         21969881
219699                                  TO DP013-MESSAGE-TEXT (1)       21969981
219700                  MOVE SQLCA      TO DP013-SQLCA                  21970081
219701                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     21970181
219702                  MOVE 'XLT00010' TO DP013-DB2-TABLE-NAME (2)     21970281
219703                  SET DP013-DB2-ABEND                             21970381
219704                      DP013-XCTL-DISPLAY-RESTART                  21970481
219705                                  TO TRUE                         21970581
219706                  PERFORM DP013-0000-PROCESS-ABEND                21970681
219707         END-EVALUATE.                                            21970781
219708                                                                  21970881
219709                                                                  21970981
219710*----------------------------------------------------------------*21971081
219711* CHECK TO SEE IF THERE ARE WORK ORDER INSTRUCTIONS              *21971181
219712* DMH ADDED 1/19/16                                              *21971281
219713*----------------------------------------------------------------*21971381
219714 3345-CHECK-WORK-ORDER-INST.                                      21971481
219715                                                                  21971581
219716         EXEC SQL                                                 21971681
219717              SELECT  COUNT(*)                                    21971781
219718                INTO :PV-WORK-ORDER-INSTR-COUNT                   21971881
219719                FROM  TWKORIN                                     21971981
219720               WHERE  ORD_NBR         = :DK-PO-NBR                21972081
219721                 AND  RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR           21972181
219722                 AND  VER_STATUS_CDE  =  'A'                      21972281
219723                                                                  21972381
219724         END-EXEC.                                                21972481
219725                                                                  21972581
219726         EVALUATE TRUE                                            21972681
219727             WHEN SQLCODE = +0                                    21972781
219728                  IF  PV-WORK-ORDER-INSTR-COUNT  > 0              21972881
219729                      SET  ASC-HAS-WORK-ORDER-INST TO  TRUE       21972981
219730                  ELSE                                            21973081
219731                      PERFORM 3350-CHECK-WORK-ORDER               21973181
219732                  END-IF                                          21973281
219733                                                                  21973381
219734             WHEN SQLCODE = +100                                  21973481
219735                  PERFORM 3350-CHECK-WORK-ORDER                   21973581
219736                                                                  21973681
219737             WHEN SQLCODE = -904                                  21973781
219738             WHEN SQLCODE = -911                                  21973881
219739             WHEN SQLCODE = -913                                  21973981
219740                  PERFORM 9900-SOFT-ABORT                         21974081
219741                                                                  21974181
219742             WHEN SQLWARN0 NOT = SPACES                           21974281
219743             WHEN SQLCODE < +0                                    21974381
219744             WHEN SQLCODE > +0                                    21974481
219745                  MOVE '3035-CHECK-WORK-ORDER-INST'               21974581
219746                                  TO DP013-PARAGRAPH              21974681
219747                  MOVE 'CHECK FOR WORK ORDER INSTRUCTION'         21974781
219748                                  TO DP013-MESSAGE-TEXT (1)       21974881
219749                  MOVE SQLCA      TO DP013-SQLCA                  21974981
219750                  MOVE 'TWKORIN ' TO DP013-DB2-TABLE-NAME (1)     21975081
219751                  SET DP013-DB2-ABEND                             21975181
219752                      DP013-XCTL-DISPLAY-RESTART                  21975281
219753                                  TO TRUE                         21975381
219754                  PERFORM DP013-0000-PROCESS-ABEND                21975481
219755         END-EVALUATE.                                            21975581
219756                                                                  21975681
219757                                                                  21975781
219758*----------------------------------------------------------------*21975881
219759* CHECK TO SEE IF THERE IS A WORK ORDER                          *21975981
219760* DMH ADDED 1/19/16                                              *21976081
219761*----------------------------------------------------------------*21976181
219762 3350-CHECK-WORK-ORDER.                                           21976281
219763                                                                  21976381
219764         EXEC SQL                                                 21976481
219765              SELECT  A.OPER_SET_ID                               21976581
219766                    , DFLT_OPER_SET_ID                            21976681
219767                INTO :WRKORD-OPER-SET-ID                          21976781
219768                    ,:COCNTL-DFLT-OPER-SET-ID                     21976881
219769                FROM  TWRKORD A                                   21976981
219770                    , TCOCNTL B                                   21977081
219771               WHERE  A.ORD_NBR        = :DK-PO-NBR               21977181
219772                 AND  A.RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR          21977281
219773                 AND  A.VER_STATUS_CDE =  'A'                     21977381
219774                 AND  B.OPER_UNT_ID    = :RECEIV-CURR-OPER-UNT-ID 21977481
219775                                                                  21977581
219776         END-EXEC.                                                21977681
219777                                                                  21977781
219778         EVALUATE TRUE                                            21977881
219779             WHEN SQLCODE = +0                                    21977981
219780                  IF  WRKORD-OPER-SET-ID  >  0                    21978081
219781                      PERFORM 3355-INSERT-WORK-ORD-INST           21978181
219782                  ELSE                                            21978281
219783                      PERFORM 3352-INACTIVATE-0-WRKORD            21978381
219784                      PERFORM 3353-INSERT-TWRKORD                 21978481
219785                      PERFORM 3355-INSERT-WORK-ORD-INST           21978581
219786                  END-IF                                          21978681
219787                                                                  21978781
219788             WHEN SQLCODE = +100                                  21978881
219789                      PERFORM 3351-GET-DEFAULT-OP-SET             21978981
219790                      PERFORM 3353-INSERT-TWRKORD                 21979081
219791                      PERFORM 3355-INSERT-WORK-ORD-INST           21979181
219792                                                                  21979281
219793             WHEN SQLCODE = -904                                  21979381
219794             WHEN SQLCODE = -911                                  21979481
219795             WHEN SQLCODE = -913                                  21979581
219796                  PERFORM 9900-SOFT-ABORT                         21979681
219797                                                                  21979781
219798             WHEN SQLWARN0 NOT = SPACES                           21979881
219799             WHEN SQLCODE < +0                                    21979981
219800             WHEN SQLCODE > +0                                    21980081
219801                  MOVE '3040-CHECK-WORK-ORDER'                    21980181
219802                                  TO DP013-PARAGRAPH              21980281
219803                  MOVE 'CHECK FOR WORK ORDER '                    21980381
219804                                  TO DP013-MESSAGE-TEXT (1)       21980481
219805                  MOVE SQLCA      TO DP013-SQLCA                  21980581
219806                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (1)     21980681
219807                  SET DP013-DB2-ABEND                             21980781
219808                      DP013-XCTL-DISPLAY-RESTART                  21980881
219809                                  TO TRUE                         21980981
219810                  PERFORM DP013-0000-PROCESS-ABEND                21981081
219811         END-EVALUATE.                                            21981181
219812                                                                  21981281
219813                                                                  21981381
219814*----------------------------------------------------------------*21981481
219815* GET THE DEFAULT OP SET FROM TCOCNTL FOR WORK ORDER             *21981581
219816* ADDED DMH 01/16/19                                             *21981681
219817*----------------------------------------------------------------*21981781
219818 3351-GET-DEFAULT-OP-SET.                                         21981881
219819                                                                  21981981
219820         EXEC SQL                                                 21982081
219821              SELECT                                              21982181
219822                      DFLT_OPER_SET_ID                            21982281
219823                INTO                                              21982381
219824                     :COCNTL-DFLT-OPER-SET-ID                     21982481
219825                FROM                                              21982581
219826                      TCOCNTL B                                   21982681
219827               WHERE                                              21982781
219828                      B.OPER_UNT_ID    = :RECEIV-CURR-OPER-UNT-ID 21982881
219829         END-EXEC.                                                21982981
219830                                                                  21983081
219831         EVALUATE TRUE                                            21983181
219832             WHEN SQLCODE = +0                                    21983281
219833                  CONTINUE                                        21983381
219834                                                                  21983481
219835             WHEN SQLCODE = -904                                  21983581
219836             WHEN SQLCODE = -911                                  21983681
219837             WHEN SQLCODE = -913                                  21983781
219838                  PERFORM 9900-SOFT-ABORT                         21983881
219839                                                                  21983981
219840             WHEN SQLWARN0 NOT = SPACES                           21984081
219841             WHEN SQLCODE < +0                                    21984181
219842             WHEN SQLCODE > +0                                    21984281
219843                  MOVE '3041-GET-DEFAULT-OP-SET'                  21984381
219844                                  TO DP013-PARAGRAPH              21984481
219845                  MOVE 'DEFAULT OP SET FROM TCOCNTL'              21984581
219846                                  TO DP013-MESSAGE-TEXT (1)       21984681
219847                  MOVE SQLCA      TO DP013-SQLCA                  21984781
219848                  MOVE 'TCOCNTL ' TO DP013-DB2-TABLE-NAME (1)     21984881
219849                  SET DP013-DB2-ABEND                             21984981
219850                      DP013-XCTL-DISPLAY-RESTART                  21985081
219851                                  TO TRUE                         21985181
219852                  PERFORM DP013-0000-PROCESS-ABEND                21985281
219853         END-EVALUATE.                                            21985381
219854                                                                  21985481
219855                                                                  21985581
219856*----------------------------------------------------------------*21985681
219857* INACTIVATE - WORK ORDER                                        *21985781
219858* ADDED DMH 01/16/19                                             *21985881
219859*----------------------------------------------------------------*21985981
219860 3352-INACTIVATE-0-WRKORD.                                        21986081
219861                                                                  21986181
219862         EXEC SQL                                                 21986281
219863              UPDATE  TWRKORD                                     21986381
219864                 SET  VER_STATUS_CDE  =  'I'                      21986481
219865               WHERE  ORD_NBR         = :DK-PO-NBR                21986581
219866                 AND  RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR           21986681
219867                 AND  OPER_SET_ID     = :WRKORD-OPER-SET-ID       21986781
219868                 AND  OPER_UNT_ID     = :RECEIV-CURR-OPER-UNT-ID  21986881
219869                 AND  FCLTY_ID        =  1                        21986981
219870         END-EXEC.                                                21987081
219871                                                                  21987181
219872         EVALUATE TRUE                                            21987281
219873             WHEN SQLCODE = +0                                    21987381
219874             WHEN SQLCODE = +100                                  21987481
219875                  CONTINUE                                        21987581
219876                                                                  21987681
219877             WHEN SQLCODE = -904                                  21987781
219878             WHEN SQLCODE = -911                                  21987881
219879             WHEN SQLCODE = -913                                  21987981
219880                  PERFORM 9900-SOFT-ABORT                         21988081
219881                                                                  21988181
219882             WHEN SQLWARN0 NOT = SPACES                           21988281
219883             WHEN SQLCODE < +0                                    21988381
219884             WHEN SQLCODE > +0                                    21988481
219885                  MOVE '3042-INACTIVATE-0-WRKORD'                 21988581
219886                                  TO DP013-PARAGRAPH              21988681
219887                  MOVE 'INACTIVATE - WORKORDER'                   21988781
219888                                  TO DP013-MESSAGE-TEXT (1)       21988881
219889                  MOVE SQLCA      TO DP013-SQLCA                  21988981
219890                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (1)     21989081
219891                  SET DP013-DB2-ABEND                             21989181
219892                      DP013-XCTL-DISPLAY-RESTART                  21989281
219893                                  TO TRUE                         21989381
219894                  PERFORM DP013-0000-PROCESS-ABEND                21989481
219895         END-EVALUATE.                                            21989581
219896                                                                  21989681
219897                                                                  21989781
219898 3353-INSERT-TWRKORD.                                             21989881
219899                                                                  21989981
219900     INITIALIZE DCLTWRKORD.                                       21990081
219901                                                                  21990181
219902     MOVE RECEIV-CURR-OPER-UNT-ID  TO WRKORD-OPER-UNT-ID.         21990281
219903     MOVE COCNTL-DFLT-OPER-SET-ID  TO WRKORD-OPER-SET-ID.         21990381
219904                                                                  21990481
219905     MOVE DK-PO-NBR              TO WRKORD-ORD-NBR.               21990581
219906     MOVE DK-REC-SEQ-NBR         TO WRKORD-RCVR-SEQ-NBR.          21990681
219907                                                                  21990781
219908     MOVE 1                      TO WRKORD-FCLTY-ID.              21990881
219909     MOVE +1                     TO WRKORD-WORK-ORD-SEQ-NBR.      21990981
219910     MOVE ZERO                   TO WRKORD-ACTL-CART-CNT.         21991081
219911     MOVE +1                     TO WRKORD-EXPTED-CART-CNT.       21991181
219912     MOVE 'A'                    TO WRKORD-VER-STATUS-CDE.        21991281
219913     MOVE 'IP'                   TO WRKORD-STAT-CDE.              21991381
219914     MOVE 'N'                    TO WRKORD-WORK-ORD-DISTR-IND.    21991481
219915                                                                  21991581
219916     PERFORM 5900-INSERT-TWRKORD.                                 21991681
219917                                                                  21991781
219918                                                                  21991881
219919*----------------------------------------------------------------*21991981
219920* GET THE DEFAULT OP SET FROM TCOCNTL FOR WORK ORDER             *21992081
219921* DMH ADDED 1/19/16                                              *21992181
219922*----------------------------------------------------------------*21992281
219923 3355-INSERT-WORK-ORD-INST.                                       21992381
219924                                                                  21992481
219925     MOVE +0                     TO PV-WO-INSTR-SEQ-NBR.          21992581
219926     MOVE 'N'                    TO ASC-TOSOPFA-CURSOR-SW.        21992681
219927     MOVE 'Y'                    TO ASC-INSTRUCTION-SW.           21992781
219928                                                                  21992881
219929     PERFORM 5910-OPEN-TOSOPFA-CSR.                               21992981
219930     PERFORM 5930-FETCH-TOSOPFA-CSR.                              21993081
219931                                                                  21993181
219932     PERFORM UNTIL ASC-EOF-TOSOPFA-CSR                            21993281
219933        PERFORM 5950-BUILD-WORK-ORDER-INSTR                       21993381
219934        PERFORM 5930-FETCH-TOSOPFA-CSR                            21993481
219935     END-PERFORM.                                                 21993581
219936                                                                  21993681
219937     PERFORM 5940-CLOSE-TOSOPFA-CSR.                              21993781
219938                                                                  21993881
219939                                                                  21993981
219940******************************************************************21994081
219941** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **21994181
219942** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **21994281
219943******************************************************************21994381
219944 3400-CHECK-RANGE-SEQUENCE.                                       21994481
219945     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       21994581
219946       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      21994681
219947       AND  ASC-START-OF-SELECTED-RANGE >                         21994781
219948                                         ASC-END-OF-SELECTED-RANGE21994881
219949*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                21994981
219950         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 21995081
219960         SET DP020-MSG-FATAL TO TRUE                              21996081
219970         SET PS-ERROR TO TRUE                                     21997081
219980         PERFORM 3410-POSITION-AT-ERROR                           21998081
219990     END-IF.                                                      21999081
220000******************************************************************22000081
220100** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **22010081
220200** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **22020081
220300** SHOULD BE POSITIONED ON A RANGE ERROR.                       **22030081
220400******************************************************************22040081
220500 3410-POSITION-AT-ERROR.                                          22050081
220600     SET DP030-SET-CURSOR-APPL-1                                  22060081
220700                                   TO TRUE.                       22070081
220800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22080081
220900                    - PV-TOP-ITEM + 1.                            22090081
221000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22100081
221100         CONTINUE                                                 22110081
221200     ELSE                                                         22120081
221300         MOVE -1                   TO MR-SELECTL (PV-SUB)         22130081
221400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22140081
221500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22150081
221600     END-IF.                                                      22160081
221700*                                                                 22170081
221800     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22180081
221900                    - PV-TOP-ITEM + 1.                            22190081
222000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22200081
222100         CONTINUE                                                 22210081
222200     ELSE                                                         22220081
222300         MOVE -1                   TO MR-SELECTL (PV-SUB)         22230081
222400         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         22240081
222500         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         22250081
222600     END-IF.                                                      22260081
222700 EJECT                                                            22270081
222800*----------------------------------------------------------------*22280081
222900*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *22290081
223000*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *22300081
223100*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *22310081
223200*----------------------------------------------------------------*22320081
223300                                                                  22330081
223400 3500-MARK-RANGE-AS-SELECTED.                                     22340081
223500     MOVE +1                       TO  ASC-BLK-SUB.               22350081
223600     PERFORM 3510-MARK-SELECTED-INDS                              22360081
223700         VARYING ASC-ITEM-SUB                                     22370081
223800         FROM 1 BY 1                                              22380081
223900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22390081
224000                                                                  22400081
224100     ADD +1                        TO ASC-BLK-SUB.                22410081
224200     PERFORM 3510-MARK-SELECTED-INDS                              22420081
224300         VARYING ASC-ITEM-SUB                                     22430081
224400         FROM 1 BY 1                                              22440081
224500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 22450081
224600                                                                  22460081
224700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               22470081
224800                                   TO  PV-LIST-ITEM-NUMBER.       22480081
224900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            22490081
225000         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         22500081
225100               PC-ITEMS-PER-PANEL).                               22510081
225200                                                                  22520081
225300     MOVE ASC-START-OF-SELECTED-RANGE                             22530081
225400                                   TO PV-START-OF-SELECTED-RANGE. 22540081
225500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            22550081
225600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  22560081
225700               PC-ITEMS-PER-PANEL).                               22570081
225800                                                                  22580081
225900     MOVE ASC-END-OF-SELECTED-RANGE                               22590081
226000                                   TO  PV-END-OF-SELECTED-RANGE.  22600081
226100     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             22610081
226200         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    22620081
226300               PC-ITEMS-PER-PANEL).                               22630081
226400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             22640081
226500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             22650081
226600                                                                  22660081
226700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    22670081
226800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        22680081
226900         MOVE +1                   TO ASC-BLK-SUB                 22690081
227000         PERFORM 5100-WRITE-TEMP-STORAGE                          22700081
227100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         22710081
227200             PV-FIRST-BLOCK-IN-ARRAY - 1                          22720081
227300                                                                  22730081
227400         PERFORM                                                  22740081
227500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      22750081
227600                   PV-PREV-BLOCK-IN-ARRAY                         22760081
227700             MOVE PV-FIRST-BLOCK-IN-RANGE                         22770081
227800                                   TO PV-BLOCK-NUMBER             22780081
227900             PERFORM 4410-READ-TEMP-STORAGE                       22790081
228000             PERFORM 3510-MARK-SELECTED-INDS                      22800081
228100                 VARYING ASC-ITEM-SUB                             22810081
228200                 FROM 1 BY 1                                      22820081
228300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22830081
228400             PERFORM 5100-WRITE-TEMP-STORAGE                      22840081
228500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     22850081
228600         END-PERFORM                                              22860081
228700                                                                  22870081
228800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         22880081
228900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     22890081
229000         PERFORM                                                  22900081
229100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       22910081
229200                   PV-LAST-BLOCK-IN-RANGE                         22920081
229300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          22930081
229400                                   TO PV-BLOCK-NUMBER             22940081
229500             PERFORM 4410-READ-TEMP-STORAGE                       22950081
229600             PERFORM 3510-MARK-SELECTED-INDS                      22960081
229700                 VARYING ASC-ITEM-SUB                             22970081
229800                 FROM 1 BY 1                                      22980081
229900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          22990081
230000             PERFORM 5100-WRITE-TEMP-STORAGE                      23000081
230100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      23010081
230200         END-PERFORM                                              23020081
230300                                                                  23030081
230400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             23040081
230500                                   TO PV-BLOCK-NUMBER             23050081
230600         PERFORM 4410-READ-TEMP-STORAGE                           23060081
230700     END-IF.                                                      23070081
230800                                                                  23080081
230900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 23090081
231000                                      ASC-END-OF-SELECTED-RANGE.  23100081
231100                                                                  23110081
231200 EJECT                                                            23120081
231300*----------------------------------------------------------------*23130081
231400* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *23140081
231500*----------------------------------------------------------------*23150081
231600                                                                  23160081
231700 3510-MARK-SELECTED-INDS.                                         23170081
231800                                                                  23180081
231900     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23190081
232000                                ASC-ITEM-SUB) >                   23200081
232100         ASC-START-OF-SELECTED-RANGE)                             23210081
232200     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         23220081
232300                                ASC-ITEM-SUB) =                   23230081
232400         ASC-START-OF-SELECTED-RANGE)                             23240081
232500                                                                  23250081
232600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23260081
232700                                    ASC-ITEM-SUB) <               23270081
232800             ASC-END-OF-SELECTED-RANGE)                           23280081
232900         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     23290081
233000                                    ASC-ITEM-SUB) =               23300081
233100             ASC-END-OF-SELECTED-RANGE)                           23310081
233200                                                                  23320081
233300             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          23330081
233400                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   23340081
233500                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   23350081
233600                               TO TRUE                            23360081
233700                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              23370081
233800                               TO TRUE                            23380081
233900                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    23390081
234000             END-IF                                               23400081
234100         END-IF                                                   23410081
234200     END-IF.                                                      23420081
234300                                                                  23430081
234400 EJECT                                                            23440081
234500*----------------------------------------------------------------*23450081
234600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *23460081
234700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *23470081
234800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *23480081
234900*    DISPLAY THE PANEL TO USER.                                  *23490081
235000*----------------------------------------------------------------*23500081
235100                                                                  23510081
235200 4000-BUILD-INITIAL-PANEL.                                        23520081
235300                                                                  23530081
235400     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            23540081
235500                                 ASC-BLOCK-ENTRIES (2).           23550081
235600     MOVE +1                 TO ASC-BLK-SUB.                      23560081
235700     SET ASC-ITEMS-LEFT-ON-DB                                     23570081
235800         ASC-CAN-VERIFY                                           23580081
235900         ASC-CAN-UNVERIFY    TO TRUE.                             23590081
236000                                                                  23600081
236100     MOVE +0                 TO ASC-ITEM-SUB                      23610081
236200                                ASC-NUMBER-OF-ITEMS-READ          23620081
236300                                ASC-NUMBER-OF-SELECTED-ITEMS      23630081
236400                                ASC-HIGHEST-BLOCK-WRITTEN         23640081
236500                                ASC-START-OF-SELECTED-RANGE       23650081
236600                                ASC-END-OF-SELECTED-RANGE         23660081
236700                                ASC-ITEM-AT-TOP-OF-PANEL          23670081
236800                                ASC-TOT-ODD-UNITS.                23680081
236900     PERFORM 4100-PREPARE-CURSOR.                                 23690081
237000                                                                  23700081
237100     PERFORM 5300-GET-TRECEIV-STATUS.                             23710081
237200                                                                  23720081
237300                                                                  23730081
237400     PERFORM 4150-CALL-AUTOVE-MODULE.                             23740081
237500     MOVE RC040-AUTO-VE-SW          TO ASC-AUTO-VE-SW.            23750081
237600*                                                                 23760081
237700*** DMH - 1/28/16 BEGIN                                           23770081
237800* IF AUTOVE RECEIVER - CHECK IF ASSOCIATE HAS RACF ACCESS TO      23780081
237900* TO EFC RECEIVERS                                                23790081
238000*                                                                 23800081
238100     IF  ASC-AUTO-VE-YES                                          23810081
238200         PERFORM 3330-CHECK-EFCVEADJ                              23820081
238300     END-IF.                                                      23830081
238400*                                                                 23840081
238500*** DMH - 1/28/16 BEGIN                                           23850081
238600*                                                                 23860081
238700                                                                  23870081
238800     PERFORM 4010-OPEN-CURSOR.                                    23880081
238900                                                                  23890081
239000     PERFORM 4300-READ-ITEMS-FROM-DB.                             23900081
239100                                                                  23910081
239200     PERFORM 4020-CLOSE-CURSOR.                                   23920081
239300                                                                  23930081
239400     PERFORM 7055-GET-TDISTHD.                                    23940081
239500                                                                  23950081
239600                                                                  23960081
239700     MOVE +1                   TO  PV-TOP-ITEM.                   23970081
239800     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          23980081
239900         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    23990081
240000         SET DP020-MSG-FATAL   TO  TRUE                           24000081
240100         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               24010081
240200     ELSE                                                         24020081
240300         MOVE -1               TO MR-SELECTL (1)                  24030081
240400         SET DP030-SET-CURSOR-APPL-1                              24040081
240500                               TO TRUE                            24050081
240600         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     24060081
240700     END-IF.                                                      24070081
240800 EJECT                                                            24080081
240900                                                                  24090081
241000 4010-OPEN-CURSOR.                                                24100081
241100     PERFORM                                                      24110081
241200         WITH TEST AFTER                                          24120081
241300         VARYING PV-RETRY-COUNTER                                 24130081
241400         FROM 1 BY 1                                              24140081
241500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24150081
241600                   OR (SQLCODE = ZERO))                           24160081
241700                                                                  24170081
241800             EXEC SQL                                             24180081
241900                  OPEN STORE-LINE-CSR                             24190081
242000             END-EXEC                                             24200081
242100                                                                  24210081
242200         EVALUATE TRUE                                            24220081
242300             WHEN SQLCODE = ZERO                                  24230081
242400             WHEN SQLCODE = -904                                  24240081
242500             WHEN SQLCODE = -913                                  24250081
242600                 CONTINUE                                         24260081
242700             WHEN SQLWARN0 NOT = SPACES                           24270081
242800             WHEN SQLCODE < ZERO                                  24280081
242900             WHEN SQLCODE > ZERO                                  24290081
243000                 MOVE '4010-OPEN-CURSOR'                          24300081
243100                                   TO DP013-PARAGRAPH             24310081
243200                 MOVE 'OPEN PACK SLIP CURSOR - '                  24320081
243300                                   TO DP013-MESSAGE-TEXT (1)      24330081
243400                 MOVE DK-PO-NBR        TO PV-DISP-PO-NBR          24340081
243500                 MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID     24350081
243600                 MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID        24360081
243700                 MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR     24370081
243800                 MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID        24380081
243900                 MOVE DK-STR-NBR       TO PV-DISP-STR-NBR         24390081
244000                 STRING ' PO = '                                  24400081
244100                        PV-DISP-PO-NBR                            24410081
244200                        ' RECV ='                                 24420081
244300                        PV-DISP-REC-SEQ-NBR                       24430081
244400                        ' OPER = '                                24440081
244500                        PV-DISP-OPER-UNT-ID                       24450081
244600                        ' FCLTY = '                               24460081
244700                        PV-DISP-FCLTY-ID    DELIMITED BY SIZE     24470081
244800                                 INTO DP013-MESSAGE-TEXT (2)      24480081
244900                 STRING ' PACK = '                                24490081
245000                        PV-DISP-PREPK-ID                          24500081
245100                        ' STORE = '                               24510081
245200                        PV-DISP-STR-NBR                           24520081
245300                                            DELIMITED BY SIZE     24530081
245400                                 INTO DP013-MESSAGE-TEXT (3)      24540081
245500                 MOVE SQLCA        TO DP013-SQLCA                 24550081
245600                 MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)    24560081
245700                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)    24570081
245800                 MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)    24580081
245900                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (4)    24590081
246000                 SET DP013-DB2-ABEND                              24600081
246100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           24610081
246200                 PERFORM DP013-0000-PROCESS-ABEND                 24620081
246300         END-EVALUATE                                             24630081
246400     END-PERFORM.                                                 24640081
246500*                                                                 24650081
246600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24660081
246700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             24670081
246800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   24680081
246900                                   TO DP013-MESSAGE-TEXT (1)      24690081
247000         MOVE DK-PO-NBR        TO PV-DISP-PO-NBR                  24700081
247100         MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID             24710081
247200         MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID                24720081
247300         MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR             24730081
247400         MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID                24740081
247500         MOVE DK-STR-NBR       TO PV-DISP-STR-NBR                 24750081
247600         STRING ' PO = '                                          24760081
247700                PV-DISP-PO-NBR                                    24770081
247800                ' RECV ='                                         24780081
247900                PV-DISP-REC-SEQ-NBR                               24790081
248000                ' OPER = '                                        24800081
248100                PV-DISP-OPER-UNT-ID                               24810081
248200                ' FCLTY = '                                       24820081
248300                PV-DISP-FCLTY-ID    DELIMITED BY SIZE             24830081
248400                         INTO DP013-MESSAGE-TEXT (2)              24840081
248500         STRING ' PACK = '                                        24850081
248600                PV-DISP-PREPK-ID                                  24860081
248700                ' STORE = '                                       24870081
248800                PV-DISP-STR-NBR                                   24880081
248900                                    DELIMITED BY SIZE             24890081
249000                         INTO DP013-MESSAGE-TEXT (3)              24900081
249100         MOVE SQLCA        TO DP013-SQLCA                         24910081
249200         MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)            24920081
249300         MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)            24930081
249400         MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)            24940081
249500         MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (4)            24950081
249600         SET DP013-DB2-ABEND                                      24960081
249700             DP013-XCTL-DISPLAY-RESTART                           24970081
249800                                   TO TRUE                        24980081
249900         PERFORM DP013-0000-PROCESS-ABEND                         24990081
250000     END-IF.                                                      25000081
250100                                                                  25010081
250200 EJECT                                                            25020081
250300                                                                  25030081
250400 4020-CLOSE-CURSOR.                                               25040081
250500     EXEC SQL                                                     25050081
250600         CLOSE STORE-LINE-CSR                                     25060081
250700     END-EXEC.                                                    25070081
250800*                                                                 25080081
250900     EVALUATE TRUE                                                25090081
251000         WHEN SQLCODE = ZERO                                      25100081
251100             CONTINUE                                             25110081
251200         WHEN SQLWARN0 NOT = SPACES                               25120081
251300         WHEN SQLCODE < ZERO                                      25130081
251400         WHEN SQLCODE > ZERO                                      25140081
251500             MOVE '4020-CLOSE-CURSOR'                             25150081
251600                               TO DP013-PARAGRAPH                 25160081
251700             MOVE 'CLOSE PACK SLIP CURSOR '                       25170081
251800                               TO DP013-MESSAGE-TEXT (1)          25180081
251900             MOVE SQLCA        TO DP013-SQLCA                     25190081
252000             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              25200081
252100             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         25210081
252200             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            25220081
252300             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         25230081
252400             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            25240081
252500             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             25250081
252600             STRING ' PO = '                                      25260081
252700                    PV-DISP-PO-NBR                                25270081
252800                    ' RECV ='                                     25280081
252900                    PV-DISP-REC-SEQ-NBR                           25290081
253000                    ' OPER = '                                    25300081
253100                    PV-DISP-OPER-UNT-ID                           25310081
253200                    ' FCLTY = '                                   25320081
253300                    PV-DISP-FCLTY-ID    DELIMITED BY SIZE         25330081
253400                             INTO DP013-MESSAGE-TEXT (2)          25340081
253500             STRING ' PACK = '                                    25350081
253600                    PV-DISP-PREPK-ID                              25360081
253700                    ' STORE = '                                   25370081
253800                    PV-DISP-STR-NBR                               25380081
253900                                        DELIMITED BY SIZE         25390081
254000                             INTO DP013-MESSAGE-TEXT (3)          25400081
254100             MOVE SQLCA        TO DP013-SQLCA                     25410081
254200             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        25420081
254300             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        25430081
254400             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)        25440081
254500             MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (4)        25450081
254600             SET DP013-DB2-ABEND                                  25460081
254700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25470081
254800             PERFORM DP013-0000-PROCESS-ABEND                     25480081
254900     END-EVALUATE.                                                25490081
255000                                                                  25500081
255100 EJECT                                                            25510081
255200*----------------------------------------------------------------*25520081
255300*    SET UP THE HOST VARIABLES.                                  *25530081
255400*----------------------------------------------------------------*25540081
255500                                                                  25550081
255600 4100-PREPARE-CURSOR.                                             25560081
255700                                                                  25570081
255800     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 25580081
255900     MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID.                    25590081
256000     MOVE ASC-PO-NBR           TO DK-PO-NBR.                      25600081
256100     MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.                 25610081
256200     MOVE ASC-PACK-ID          TO DK-PREPK-ID.                    25620081
256300     MOVE ASC-STR-NBR          TO DK-STR-NBR.                     25630081
256400                                                                  25640081
256500                                                                  25650081
256600 EJECT                                                            25660081
256700*----------------------------------------------------------------*25670081
256800*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          25680081
256900*----------------------------------------------------------------*25690081
257000 4150-CALL-AUTOVE-MODULE.                                         25700081
257100                                                                  25710081
257200     INITIALIZE RC040-FIELDS.                                     25720081
257300     MOVE DK-OPER-UNT-ID      TO RC040-SIGNON-LOCATION.           25730081
257400     MOVE DK-PO-NBR           TO RC040-PO-NBR                     25740081
257500     MOVE DK-REC-SEQ-NBR      TO RC040-PO-RCVR                    25750081
257600     MOVE DP020-USERID        TO RC040-USER-ID.                   25760081
257700     MOVE 'RCKCS819'          TO RC040-CALLING-PROGRAM.           25770081
257800                                                                  25780081
257900     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  25790081
258000                                        RC040-COMMAREA            25800081
258100                                        RC040-FIELDS.             25810081
258200                                                                  25820081
258300     EVALUATE TRUE                                                25830081
258400         WHEN RC040-SUCCESSFUL                                    25840081
258500              CONTINUE                                            25850081
258600         WHEN RC040-DATABASE-BUSY OR                              25860081
258700              RC040-INVALID-SQL                                   25870081
258800                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       25880081
258900                  SET DP020-MSG-WARNING TO TRUE                   25890081
259000                  SET DP030-OVERRIDE-GO TO TRUE                   25900081
259100                  SET PS-ERROR          TO TRUE                   25910081
259200         WHEN RC040-NOT-SUCCESSFUL                                25920081
259300                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       25930081
259400                  SET DP020-MSG-WARNING TO TRUE                   25940081
259500                  SET DP030-OVERRIDE-GO TO TRUE                   25950081
259600                  SET PS-ERROR          TO TRUE                   25960081
259700         WHEN OTHER                                               25970081
259800             MOVE '4150-CHECK-AUTOVE ' TO DP013-PARAGRAPH         25980081
259900             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              25990081
260000                                         TO DP013-MESSAGE-TEXT (1)26000081
260100             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)26010081
260200             MOVE RC040-SQLCA            TO DP013-SQLCA           26020081
260300             SET DP013-DB2-ABEND                                  26030081
260400                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              26040081
260500             SET PS-ERROR                    TO TRUE              26050081
260600             PERFORM DP013-0000-PROCESS-ABEND                     26060081
260700                                                                  26070081
260800     END-EVALUATE.                                                26080081
260900                                                                  26090081
261000*----------------------------------------------------------------*26100081
261100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *26110081
261200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *26120081
261300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *26130081
261400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *26140081
261500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *26150081
261600*                                                                *26160081
261700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *26170081
261800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *26180081
261900*    UPON INITIALIZATION.                                        *26190081
262000*----------------------------------------------------------------*26200081
262100                                                                  26210081
262200 4300-READ-ITEMS-FROM-DB.                                         26220081
262300                                                                  26230081
262400     INITIALIZE PV-PACK-TABLE.                                    26240081
262500     MOVE 0     TO PV-NUMBER-OF-LINES.                            26250081
262600     SET LINE-IDX TO 1.                                           26260081
262700                                                                  26270081
262800     PERFORM                                                      26280081
262900         VARYING PV-READ-COUNT                                    26290081
263000         FROM 1 BY 1                                              26300081
263100         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    26310081
263200            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         26320081
263300                                                                  26330081
263400         PERFORM 4310-FETCH                                       26340081
263500                                                                  26350081
263600         IF  ASC-ITEMS-LEFT-ON-DB                                 26360081
263700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                26370081
263800                 ADD +1            TO ASC-ITEM-SUB                26380081
263900             ELSE                                                 26390081
264000                 ADD +1            TO ASC-BLK-SUB                 26400081
264100                 MOVE +1           TO ASC-ITEM-SUB                26410081
264200                                                                  26420081
264300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         26430081
264400                     MOVE +1       TO ASC-BLK-SUB                 26440081
264500                     SET ASC-BLOCK-MODIFIED (1)                   26450081
264600                                   TO TRUE                        26460081
264700                     PERFORM 5100-WRITE-TEMP-STORAGE              26470081
264800                     MOVE ASC-BLOCK-ENTRIES                       26480081
264900                               (PC-MAX-BLOCKS-IN-ARRAY)           26490081
265000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 26500081
265100                     ADD +1        TO ASC-BLK-SUB                 26510081
265200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   26520081
265300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      26530081
265400                                   TO TRUE                        26540081
265500                 END-IF                                           26550081
265600             END-IF                                               26560081
265700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    26570081
265800             ADD 1  TO PV-NUMBER-OF-LINES                         26580081
265900             MOVE ASC-NUMBER-OF-ITEMS-READ                        26590081
266000                                   TO ASC-LIST-ITEM-NUMBER        26600081
266100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26610081
266200             MOVE RECEIV-STATUS-CDE TO ASC-RECEIV-STATUS-CDE      26620081
266300             MOVE RECEIV-ML-POST-TMST                             26630081
266400                                    TO ASC-RECEIV-ML-POST-TMST    26640081
266500             MOVE RECDIS-ORD-LNE-NBR                              26650081
266600                                   TO ASC-LINE-NBR                26660081
266700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26670081
266800             MOVE RECITM-STATUS-CDE                               26680081
266900                                   TO ASC-STATUS-CDE              26690081
267000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26700081
267100                                       ASC-RECITM-STATUS-CDE      26710081
267200             MOVE DK-PREPK-ID      TO ASC-PACK-ID                 26720081
267300             IF  RECEIV-FS-POST-TMST NOT EQUAL TO                 26730081
267400                 PC-DB2-DEFAULT-TMST                              26740081
267500                    SET ASC-CANT-UNVERIFY-FS                      26750081
267600                               TO  TRUE                           26760081
267700             END-IF                                               26770081
267800             IF  RECITM-STATUS-CDE NOT EQUAL 'VE'                 26780081
267900                 SET ASC-CANT-UNVERIFY-ST                         26790081
268000                               TO  TRUE                           26800081
268100             END-IF                                               26810081
268200                                                                  26820081
268300             MOVE RECDIS-ORD-LNE-NBR  TO DK-HOLD-LNE-NBR          26830081
268400                                                                  26840081
268500             INITIALIZE RC074-FIELDS                              26850081
268600             MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         26860081
268700                                   TO RC074-LINE-NBR              26870081
268800             PERFORM 4390-CALL-RCKUT128                           26880081
268900             MOVE RC074-INVCED-ITM-QTY                            26890081
269000                                   TO ASC-PKSLP-TOT-UNTS          26900081
269100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26910081
269200             MOVE RC074-TOTAL-ACTL-ITM-QTY                        26920081
269300                                   TO ASC-ACTUAL-TOT-UNTS         26930081
269400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26940081
269500             MOVE RC074-VERIFY-ITM-QTY                            26950081
269600                                   TO ASC-VRFD-TOTAL-UNTS         26960081
269700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 26970081
269800             MOVE RECITM-PREPK-RATO-QTY                           26980081
269900                                   TO  ASC-PACK-RATIO             26990081
270000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27000081
270100                                       PV-LINE-PACK-RATIO         27010081
270200                                                                  27020081
270300             PERFORM 4350-GET-ITEM-SKU                            27030081
270400             MOVE PV-SKU                TO  ASC-SKU               27040081
270500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27050081
270600                                                                  27060081
270700             MOVE RC074-ACTUAL-ODD-QTY                            27070081
270800                                   TO  ASC-ACTL-ODD-UNTS          27080081
270900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27090081
271000             MOVE RC074-VERIFY-ODD-QTY                            27100081
271100                                   TO  ASC-VRFD-ODD-UNTS          27110081
271200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27120081
271300             IF ASC-RECEIV-ML-POST-TMST                           27130081
271400                               NOT = PC-DB2-DEFAULT-TMST          27140081
271500                 ADD RC074-VERIFY-ODD-QTY                         27150081
271600                                       TO  ASC-TOT-ODD-UNITS      27160081
271700             ELSE                                                 27170081
271800                 ADD RC074-ACTUAL-ODD-QTY                         27180081
271900                                       TO  ASC-TOT-ODD-UNITS      27190081
272000             END-IF                                               27200081
272100             MOVE PURCHS-DEPT-NBR                                 27210081
272200                               TO ASC-DEPT-NBR                    27220081
272300             MOVE RC074-INVCED-ITM-QTY                            27230081
272400                                         TO ASC-PKSLP-TOT-UNTS    27240081
272500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27250081
272600             MOVE RC074-TOTAL-ACTL-ITM-QTY                        27260081
272700                                         TO ASC-ACTUAL-TOT-UNTS   27270081
272800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27280081
272900             MOVE RC074-VERIFY-ITM-QTY   TO ASC-VRFD-TOTAL-UNTS   27290081
273000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27300081
273100             MOVE RC074-INVCED-ITM-QTY                            27310081
273200                                        TO ASC-EXPTD-ITM-QTY      27320081
273300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27330081
273400             ADD RC074-INVCED-ITM-QTY                             27340081
273500                                        TO ASC-HDR-TOT-PKSL-UNTS  27350081
273600             MOVE RC074-TOTAL-ACTL-ITM-QTY                        27360081
273700                                         TO ASC-TTL-ACTL-ITM-QTY  27370081
273800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27380081
273900             ADD RC074-TOTAL-ACTL-ITM-QTY                         27390081
274000                                        TO ASC-HDR-TOT-ACT-UNTS   27400081
274100             MOVE RC074-VERIFY-ITM-QTY                            27410081
274200                                         TO ASC-VERIFY-ITM-QTY    27420081
274300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 27430081
274400             ADD RC074-VERIFY-ITM-QTY   TO ASC-HDR-TOT-VERFYD-UNTS27440081
274500             SET LINE-IDX UP BY 1                                 27450081
274600         END-IF                                                   27460081
274700     END-PERFORM.                                                 27470081
274800                                                                  27480081
274900     MOVE RC074-TOTAL-INVC-PACK-QTY  TO  ASC-TOT-PKSLIP-PACKS.    27490081
275000     MOVE RC074-TOTAL-ACTL-PACK-QTY  TO  ASC-TOT-ACTUAL-PACKS.    27500081
275100     MOVE RC074-VERIFY-PACK-QTY      TO  ASC-TOT-VERFYD-PACKS.    27510081
275200                                                                  27520081
275300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          27530081
275400         MOVE +1               TO ASC-BLK-SUB                     27540081
275500         PERFORM 5100-WRITE-TEMP-STORAGE                          27550081
275600         ADD +1                TO ASC-BLK-SUB                     27560081
275700         PERFORM 5100-WRITE-TEMP-STORAGE                          27570081
275800                                                                  27580081
275900         MOVE 1                TO ASC-BLK-SUB                     27590081
276000                                  PV-BLOCK-NUMBER                 27600081
276100         PERFORM 4410-READ-TEMP-STORAGE                           27610081
276200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             27620081
276300             MOVE 2            TO ASC-BLK-SUB                     27630081
276400                                  PV-BLOCK-NUMBER                 27640081
276500             PERFORM 4410-READ-TEMP-STORAGE                       27650081
276600         END-IF                                                   27660081
276700     END-IF.                                                      27670081
276800 EJECT                                                            27680081
276900                                                                  27690081
277000 4310-FETCH.                                                      27700081
277100                                                                  27710081
277200     EXEC SQL                                                     27720081
277300          FETCH STORE-LINE-CSR                                    27730081
277400          INTO  :RECITM-STATUS-CDE                                27740081
277500              , :RECITM-VRFD-USR-ID                               27750081
277600              , :RECITM-PREPK-RATO-QTY                            27760081
277700              , :RECITM-PREPK-DRV-LNE-CDE                         27770081
277800              , :PURITM-CL-NBR                                    27780081
277900              , :PURITM-ITM-NBR                                   27790081
278000              , :RECDIS-STR-NBR                                   27800081
278100              , :RECDIS-ORD-LNE-NBR                               27810081
278200              , :PURCHS-DEPT-NBR                                  27820081
278300                                                                  27830081
278400     END-EXEC.                                                    27840081
278500                                                                  27850081
278600     EVALUATE TRUE                                                27860081
278700         WHEN SQLCODE = ZERO                                      27870081
278800             IF RECITM-PREPK-DRV-LNE-CDE = 'A'                    27880081
278900                 MOVE RECDIS-ORD-LNE-NBR TO DK-DRIVER-LNE-NBR     27890081
279000                                            ASC-DRIVER-LNE-NBR    27900081
279010* DMH 10/27/17 BEGIN                                              27901089
279011             ELSE                                                 27901189
279012             IF  ASC-DRIVER-LNE-NBR  =  0                         27901289
279013                 MOVE RECDIS-ORD-LNE-NBR TO DK-DRIVER-LNE-NBR     27901389
279014                                            ASC-DRIVER-LNE-NBR    27901489
279015             END-IF                                               27901589
279020* DMH 10/27/17 END                                                27902089
279100             END-IF                                               27910081
279200         WHEN SQLCODE = +100                                      27920081
279300              CONTINUE                                            27930081
279400         WHEN SQLWARN0 NOT = SPACE                                27940081
279500         WHEN SQLCODE NOT = ZERO                                  27950081
279600              MOVE '4310-FETCH-CURSOR'                            27960081
279700                               TO DP013-PARAGRAPH                 27970081
279800              MOVE 'FETCH PACK SLIP CURSOR'                       27980081
279900                               TO DP013-MESSAGE-TEXT (1)          27990081
280000              MOVE SQLCA       TO DP013-SQLCA                     28000081
280100              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             28010081
280200              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        28020081
280300              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           28030081
280400              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        28040081
280500              MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID           28050081
280600              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            28060081
280700              STRING ' PO = '                                     28070081
280800                     PV-DISP-PO-NBR                               28080081
280900                     ' RECV ='                                    28090081
281000                     PV-DISP-REC-SEQ-NBR                          28100081
281100                     ' OPER = '                                   28110081
281200                     PV-DISP-OPER-UNT-ID                          28120081
281300                     ' FCLTY = '                                  28130081
281400                     PV-DISP-FCLTY-ID    DELIMITED BY SIZE        28140081
281500                              INTO DP013-MESSAGE-TEXT (2)         28150081
281600              STRING ' PACK = '                                   28160081
281700                     PV-DISP-PREPK-ID                             28170081
281800                     ' STORE = '                                  28180081
281900                     PV-DISP-STR-NBR                              28190081
282000                                         DELIMITED BY SIZE        28200081
282100                              INTO DP013-MESSAGE-TEXT (3)         28210081
282200              MOVE SQLCA        TO DP013-SQLCA                    28220081
282300              MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)       28230081
282400              MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)       28240081
282500              MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)       28250081
282600              MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (4)       28260081
282700              SET DP013-DB2-ABEND                                 28270081
282800                               TO TRUE                            28280081
282900              PERFORM DP013-0000-PROCESS-ABEND                    28290081
283000     END-EVALUATE.                                                28300081
283100                                                                  28310081
283200     IF  SQLCODE EQUAL +100                                       28320081
283300         SET ASC-NO-ITEMS-LEFT-ON-DB                              28330081
283400                                   TO TRUE                        28340081
283500     END-IF.                                                      28350081
283600                                                                  28360081
283700                                                                  28370081
283800 4330-SUM-TRECDIS-DRIVER.                                         28380081
283900                                                                  28390081
284000     MOVE ZERO                 TO  PV-LNE-AP-VERIFY-ITM-QTY.      28400081
284100     MOVE ZERO                 TO  PV-LNE-VERIFY-ITM-QTY.         28410081
284200     MOVE ZERO                 TO  PV-LNE-EXPTED-ITM-QTY.         28420081
284300                                                                  28430081
284400     EXEC SQL                                                     28440081
284500          SELECT                                                  28450081
284600                 SUM(AP_VERIFY_ITM_QTY)                           28460081
284700                ,SUM(VERIFY_ITM_QTY)                              28470081
284800                ,SUM(EXPTED_ITM_QTY)                              28480081
284900          INTO                                                    28490081
285000                :PV-LNE-AP-VERIFY-ITM-QTY :PV-NULL-IND            28500081
285100               ,:PV-LNE-VERIFY-ITM-QTY :PV-NULL-IND               28510081
285200               ,:PV-LNE-EXPTED-ITM-QTY :PV-NULL-IND               28520081
285300          FROM                                                    28530081
285400                 TRECDIS                                          28540081
285500          WHERE                                                   28550081
285600                ORD_NBR          =  :DK-PO-NBR                    28560081
285700           AND  ORD_LNE_NBR      =  :DK-PO-DRIVER-LNE             28570081
285800           AND  REC_SEQ_NBR      =  :DK-REC-SEQ-NBR               28580081
285900           AND  FCLTY_ID         =  :DK-FCLTY-ID                  28590081
286000           AND  OPER_UNT_ID      =  :DK-OPER-UNT-ID               28600081
286100           AND  STR_NBR          =  :DK-STR-NBR                   28610081
286300     END-EXEC.                                                    28630081
286400                                                                  28640081
286500     EVALUATE TRUE                                                28650081
286600         WHEN SQLCODE = ZERO                                      28660081
286700         WHEN SQLCODE = +100                                      28670081
286800              CONTINUE                                            28680081
286900         WHEN SQLCODE = -904                                      28690081
287000         WHEN SQLCODE = -911                                      28700081
287100         WHEN SQLCODE = -913                                      28710081
287200             PERFORM 9900-SOFT-ABORT                              28720081
287300         WHEN SQLCODE = -305                                      28730081
287400              CONTINUE                                            28740081
287500         WHEN SQLWARN0 NOT = SPACE                                28750081
287600         WHEN SQLCODE NOT = ZERO                                  28760081
287700              MOVE '4330-SUM-TRECDIS'                             28770081
287800                               TO DP013-PARAGRAPH                 28780081
287900              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  28790081
288000                               TO DP013-MESSAGE-TEXT (1)          28800081
288100              MOVE SQLCA       TO DP013-SQLCA                     28810081
288200                                                                  28820081
288300              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             28830081
288400              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        28840081
288500              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           28850081
288600              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        28860081
288700              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            28870081
288800              STRING ' PO = '                                     28880081
288900                     PV-DISP-PO-NBR                               28890081
289000                     ' OPER = '                                   28900081
289100                     PV-DISP-OPER-UNT-ID                          28910081
289200                     ' FCLTY = '                                  28920081
289300                     PV-DISP-FCLTY-ID                             28930081
289400                     ' RECV ='                                    28940081
289500                     PV-DISP-REC-SEQ-NBR                          28950081
289600                     ' PACK ='                                    28960081
289700                     PV-DISP-PREPK-ID    DELIMITED BY SIZE        28970081
289800                              INTO DP013-MESSAGE-TEXT (2)         28980081
289900              MOVE SQLCA        TO DP013-SQLCA                    28990081
290000              MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (1)       29000081
290100                                                                  29010081
290200                                                                  29020081
290300              SET DP013-DB2-ABEND                                 29030081
290400                               TO TRUE                            29040081
290500              PERFORM DP013-0000-PROCESS-ABEND                    29050081
290600     END-EVALUATE.                                                29060081
290700/                                                                 29070081
290800 4340-SELECT-DRIVER-RATIO.                                        29080081
290900                                                                  29090081
291000     EXEC SQL                                                     29100081
291100          SELECT                                                  29110081
291200                B.PREPK_RATO_QTY                                  29120081
291300             ,  B.VERFYD_TMST                                     29130081
291400             ,  B.VRFD_USR_ID                                     29140081
291500             ,  B.STATUS_CDE                                      29150081
291600             ,  D.PK_SKU_NBR                                      29160081
291700          INTO                                                    29170081
291800                :RECITM-PREPK-RATO-QTY                            29180081
291900             ,  :RECITM-VERFYD-TMST                               29190081
292000             ,  :RECITM-VRFD-USR-ID                               29200081
292100             ,  :RECITM-STATUS-CDE                                29210081
292200             ,  :POPRPK-PK-SKU-NBR                                29220081
292300          FROM    TRECEIV  A                                      29230081
292400              ,   TRECITM  B                                      29240081
292500              ,   TPURITM  C                                      29250081
292600              ,   TPOPRPK  D                                      29260081
292700              ,   TRECDIS  E                                      29270081
292800          WHERE A.ORD_NBR          =  :DK-PO-NBR                  29280081
292900           AND  A.ORD_NBR          =  B.ORD_NBR                   29290081
293000           AND  A.ORD_NBR          =  C.PO_NBR                    29300081
293100           AND  A.ORD_NBR          =  D.PO_NBR                    29310081
293200           AND  A.ORD_NBR          =  E.ORD_NBR                   29320081
293300           AND  A.VER_STATUS_CDE   =  'A'                         29330081
293400           AND  B.VER_STATUS_CDE   =  'A'                         29340081
293500           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             29350081
293600           AND  A.OPER_UNT_ID      =  B.OPER_UNT_ID               29360081
293700           AND  A.OPER_UNT_ID      =  E.OPER_UNT_ID               29370081
293800           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                29380081
293900           AND  A.FCLTY_ID         =  B.FCLTY_ID                  29390081
294000           AND  A.FCLTY_ID         =  E.FCLTY_ID                  29400081
294100           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             29410081
294200           AND  A.REC_SEQ_NBR      =  B.REC_SEQ_NBR               29420081
294300           AND  A.REC_SEQ_NBR      =  E.REC_SEQ_NBR               29430081
294400           AND  B.ORD_LNE_NBR      =  C.APP_PO_LNE_NBR            29440081
294500           AND  B.ORD_LNE_NBR      =  E.ORD_LNE_NBR               29450081
294600           AND  B.PO_VER_NBR       =  C.VER_NBR                   29460081
294700           AND  B.PREPK_DRV_LNE_CDE = 'A'                         29470081
294800           AND  B.PREPK_ID         = :DK-PREPK-ID                 29480081
294900           AND  B.PREPK_ID         =  D.PO_PREPK_ID               29490081
295000           AND  E.STR_NBR          = :DK-STR-NBR                  29500081
295100     END-EXEC.                                                    29510081
295200                                                                  29520081
295300     EVALUATE TRUE                                                29530081
295400         WHEN SQLCODE = ZERO                                      29540081
295500           IF RECITM-STATUS-CDE = 'VE'                            29550081
295600              MOVE  RECITM-VERFYD-TMST TO PV-WORK-TIMESTAMP       29560081
295700              MOVE  PV-WORK-YEAR       TO PV-DISPLAY-YEAR         29570081
295800              MOVE  PV-WORK-MONTH      TO PV-DISPLAY-MONTH        29580081
295900              MOVE  PV-WORK-DAY        TO PV-DISPLAY-DAY          29590081
296000              MOVE  '/'                TO PV-SLASH-1              29600081
296100              MOVE  '/'                TO PV-SLASH-2              29610081
296200              MOVE  PV-WORK-HH         TO PV-DISPLAY-HH           29620081
296300              MOVE  PV-WORK-MIN        TO PV-DISPLAY-MM           29630081
296400              MOVE  ':'                TO PV-COLON-1              29640081
296500              MOVE  '('                TO PV-LEFT-PAREN           29650081
296600              MOVE  PV-DISPLAY-DATE    TO PV-VRFY-DATE            29660081
296700              MOVE  PV-DISPLAY-TIME    TO PV-VRFY-TIME            29670081
296800              MOVE  ' - '              TO PV-SEPARATOR            29680081
296900              MOVE  RECITM-VRFD-USR-ID TO PV-VRFY-USERID          29690081
297000              MOVE  ')'                TO PV-RIGHT-PAREN          29700081
297100              MOVE  PV-RECEIV-VRFY-INFO                           29710081
297200                                       TO ASC-RECEIV-VRFY-INFO    29720081
297300           ELSE                                                   29730081
297400                 MOVE SPACES       TO ASC-RECEIV-VRFY-INFO        29740081
297500           END-IF                                                 29750081
297600         WHEN SQLCODE = -904                                      29760081
297700         WHEN SQLCODE = -913                                      29770081
297800             CONTINUE                                             29780081
297900         WHEN SQLWARN0 NOT = SPACES                               29790081
298000         WHEN SQLCODE < ZERO                                      29800081
298100         WHEN SQLCODE > ZERO                                      29810081
298200             MOVE '4340-SELECT-DRIVER-RATIO'                      29820081
298300                               TO DP013-PARAGRAPH                 29830081
298400             MOVE 'SELECT DRIVER RATIO '                          29840081
298500                               TO DP013-MESSAGE-TEXT (1)          29850081
298600             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              29860081
298700             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         29870081
298800             MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         29880081
298900             MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID            29890081
299000             MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID            29900081
299100             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             29910081
299200             STRING ' PO = '                                      29920081
299300                    PV-DISP-PO-NBR                                29930081
299400                    ' RECV ='                                     29940081
299500                    PV-DISP-REC-SEQ-NBR                           29950081
299600                    ' OPER = '                                    29960081
299700                    PV-DISP-OPER-UNT-ID                           29970081
299800                    ' FCLTY = '                                   29980081
299900                    PV-DISP-FCLTY-ID    DELIMITED BY SIZE         29990081
300000                             INTO DP013-MESSAGE-TEXT (2)          30000081
300100             STRING ' PACK = '                                    30010081
300200                    PV-DISP-PREPK-ID                              30020081
300300                    ' STORE = '                                   30030081
300400                    PV-DISP-STR-NBR                               30040081
300500                                        DELIMITED BY SIZE         30050081
300600                             INTO DP013-MESSAGE-TEXT (3)          30060081
300700             MOVE SQLCA        TO DP013-SQLCA                     30070081
300800             MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)        30080081
300900             MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)        30090081
301000             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)        30100081
301100             MOVE 'TPOPRPK '   TO DP013-DB2-TABLE-NAME (4)        30110081
301200             SET DP013-DB2-ABEND                                  30120081
301300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30130081
301400             PERFORM DP013-0000-PROCESS-ABEND                     30140081
301500     END-EVALUATE.                                                30150081
301600*                                                                 30160081
301700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        30170081
301800         MOVE '4340-SELECT-DRIVER-RATIO' TO DP013-PARAGRAPH       30180081
301900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING ON SELECT'     30190081
302000                                   TO DP013-MESSAGE-TEXT (1)      30200081
302100         MOVE DK-PO-NBR        TO PV-DISP-PO-NBR                  30210081
302200         MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR             30220081
302300         MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID             30230081
302400         MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID                30240081
302500         MOVE DK-PREPK-ID      TO PV-DISP-PREPK-ID                30250081
302600         MOVE DK-STR-NBR       TO PV-DISP-STR-NBR                 30260081
302700         STRING ' PO = '                                          30270081
302800                PV-DISP-PO-NBR                                    30280081
302900                ' RECV ='                                         30290081
303000                PV-DISP-REC-SEQ-NBR                               30300081
303100                ' OPER = '                                        30310081
303200                PV-DISP-OPER-UNT-ID                               30320081
303300                ' FCLTY = '                                       30330081
303400                PV-DISP-FCLTY-ID    DELIMITED BY SIZE             30340081
303500                         INTO DP013-MESSAGE-TEXT (2)              30350081
303600         STRING ' PACK = '                                        30360081
303700                PV-DISP-PREPK-ID                                  30370081
303800                ' STORE = '                                       30380081
303900                PV-DISP-STR-NBR                                   30390081
304000                                    DELIMITED BY SIZE             30400081
304100                         INTO DP013-MESSAGE-TEXT (3)              30410081
304200         MOVE SQLCA        TO DP013-SQLCA                         30420081
304300         MOVE 'TRECEIV '   TO DP013-DB2-TABLE-NAME (1)            30430081
304400         MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (2)            30440081
304500         MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (3)            30450081
304600         MOVE 'TPOPRPK '   TO DP013-DB2-TABLE-NAME (4)            30460081
304700         SET DP013-DB2-ABEND                                      30470081
304800             DP013-XCTL-DISPLAY-RESTART                           30480081
304900                                   TO TRUE                        30490081
305000         PERFORM DP013-0000-PROCESS-ABEND                         30500081
305100     END-IF.                                                      30510081
305200                                                                  30520081
305300                                                                  30530081
305400 4350-GET-ITEM-SKU.                                               30540081
305500                                                                  30550081
305600     INITIALIZE XL001-ITEM-COMMAREA.                              30560081
305700     MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.                  30570081
305800                                                                  30580081
305900     SET  XL001-BY-ITEM                                           30590081
306000          XL001-SELECT-SKU TO TRUE.                               30600081
306100                                                                  30610081
306200     CALL XL001-VSM-PGM USING  DFHEIBLK                           30620081
306300                               XL001-COMMAREA                     30630081
306400                               XL001-ITEM-COMMAREA.               30640081
306500                                                                  30650081
306600     EVALUATE TRUE                                                30660081
306700                                                                  30670081
306800         WHEN XL001-SKU-SQLCODE = +0                              30680081
306900               MOVE XL001-SKU-NBR                                 30690081
307000                                TO  PV-SKU                        30700081
307100                                                                  30710081
307200         WHEN XL001-SKU-SQLCODE = +100                            30720081
307300               MOVE ZERO        TO  PV-SKU                        30730081
307400                                                                  30740081
307500         WHEN XL001-SKU-CONTENTION                                30750081
307600               MOVE '7020-SELECT-SKU-BY-ITM'                      30760081
307700                            TO DP013-PARAGRAPH                    30770081
307800               MOVE 'SKU CONTENTION'                              30780081
307900                            TO DP013-MESSAGE-TEXT (1)             30790081
308000               MOVE 'XLV_SKU '                                    30800081
308100                            TO DP013-DB2-TABLE-NAME (1)           30810081
308200               MOVE XL001-SQLCA TO DP013-SQLCA                    30820081
308300               SET DP013-DB2-ABEND                                30830081
308400                                TO TRUE                           30840081
308500               PERFORM DP013-0000-PROCESS-ABEND                   30850081
308600                                                                  30860081
308700         WHEN OTHER                                               30870081
308800               MOVE '7020-SELECT-SKU-BY-ITM'                      30880081
308900                            TO DP013-PARAGRAPH                    30890081
309000               MOVE 'INVALID RETURN'                              30900081
309100                            TO DP013-MESSAGE-TEXT (1)             30910081
309200               MOVE 'XLV_SKU '                                    30920081
309300                            TO DP013-DB2-TABLE-NAME (1)           30930081
309400               MOVE XL001-SQLCA TO DP013-SQLCA                    30940081
309500               SET DP013-DB2-ABEND                                30950081
309600                                TO TRUE                           30960081
309700               PERFORM DP013-0000-PROCESS-ABEND                   30970081
309800     END-EVALUATE.                                                30980081
309900                                                                  30990081
310000 4380-SELECT-ODD-UNITS.                                           31000081
310100                                                                  31010081
310200     MOVE 0               TO PV-ODD-DC-VERIFY-ODU-QTY             31020081
310300                             PV-ODD-AP-VERIFY-ODU-QTY.            31030081
310400     EXEC SQL                                                     31040081
310500          SELECT                                                  31050081
310600                 SUM(DC_VRFY_ODU_QTY)                             31060081
310700             ,   SUM(AP_VRFY_ODU_QTY)                             31070081
310800          INTO                                                    31080081
310900                :PV-ODD-DC-VERIFY-ODU-QTY :PV-NULL-IND            31090081
311000             ,  :PV-ODD-AP-VERIFY-ODU-QTY :PV-NULL-IND            31100081
311100          FROM                                                    31110081
311200                 RCT_VRFD_ODD_UNT                                 31120081
311300          WHERE                                                   31130081
311400                PO_NBR           =  :DK-PO-NBR                    31140081
311500           AND  PO_LNE_NBR       =  :DK-PO-DRIVER-LNE             31150081
311600           AND  RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               31160081
311700           AND  STR_NBR          =  :DK-STR-NBR                   31170081
311800     END-EXEC.                                                    31180081
311900                                                                  31190081
312000     EVALUATE TRUE                                                31200081
312100         WHEN SQLCODE = ZERO                                      31210081
312200         WHEN SQLCODE = +100                                      31220081
312300              CONTINUE                                            31230081
312400         WHEN SQLCODE = -904                                      31240081
312500         WHEN SQLCODE = -911                                      31250081
312600         WHEN SQLCODE = -913                                      31260081
312700             PERFORM 9900-SOFT-ABORT                              31270081
312800         WHEN SQLCODE = -305                                      31280081
312900              CONTINUE                                            31290081
313000         WHEN SQLWARN0 NOT = SPACE                                31300081
313100         WHEN SQLCODE NOT = ZERO                                  31310081
313200              MOVE '4380-SELECT-ODD-UNITS'                        31320081
313300                               TO DP013-PARAGRAPH                 31330081
313400              MOVE 'SUMMARIZE AP VERIFIED COUNT'                  31340081
313500                               TO DP013-MESSAGE-TEXT (1)          31350081
313600              MOVE SQLCA       TO DP013-SQLCA                     31360081
313700              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             31370081
313800              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        31380081
313900              MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR            31390081
314000              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            31400081
314100              STRING ' PO = '                                     31410081
314200                     PV-DISP-PO-NBR                               31420081
314300                     ' RECV ='                                    31430081
314400                     PV-DISP-REC-SEQ-NBR                          31440081
314500                     ' LINE ='                                    31450081
314600                     PV-DISP-LNE-NBR                              31460081
314700                     ' STORE = '                                  31470081
314800                     PV-DISP-STR-NBR                              31480081
314900                                         DELIMITED BY SIZE        31490081
315000                              INTO DP013-MESSAGE-TEXT (2)         31500081
315100              MOVE SQLCA        TO DP013-SQLCA                    31510081
315200              MOVE 'RCT00009'   TO DP013-DB2-TABLE-NAME (1)       31520081
315300              SET DP013-DB2-ABEND                                 31530081
315400                               TO TRUE                            31540081
315500              PERFORM DP013-0000-PROCESS-ABEND                    31550081
315600     END-EVALUATE.                                                31560081
315700                                                                  31570081
315800                                                                  31580081
315900 4390-CALL-RCKUT128.                                              31590081
316000     MOVE ASC-OPER-UNT-ID     TO RC074-OPER-UNT-ID.               31600081
316100     MOVE ASC-FCLTY-ID        TO RC074-FCLTY-ID.                  31610081
316200     MOVE ASC-PO-NBR          TO RC074-PO-NBR.                    31620081
316300     MOVE ASC-REC-SEQ-NBR     TO RC074-RCVR-SEQ-NBR.              31630081
316400     MOVE ASC-PACK-ID         TO RC074-PACK-ID.                   31640081
316500     MOVE ASC-STR-NBR         TO RC074-STR-NBR.                   31650081
316600     MOVE ASC-AUTO-VE-SW      TO RC074-AUTO-VE-SW.                31660081
316700     SET RC074-PACK-QTY-YES   TO TRUE.                            31670081
316800                                                                  31680081
316900     CALL RC074-UNIT-CRTN-CNT-PGM USING  DFHEIBLK                 31690081
317000                                         RC074-COMMAREA           31700081
317100                                         RC074-FIELDS.            31710081
317200                                                                  31720081
317300     EVALUATE TRUE                                                31730081
317400         WHEN RC074-SUCCESSFUL                                    31740081
317500             CONTINUE                                             31750081
317600         WHEN OTHER                                               31760081
317700             MOVE '4390-CALL-RCKUT128'                            31770081
317800                                 TO DP013-PARAGRAPH               31780081
317900             STRING                                               31790081
318000                  'UNSUCCESSFUL CALL TO RCKUT128 '                31800081
318100                  'SUCCESS-IND = '                                31810081
318200                  RC074-SUCCESS-IND                               31820081
318300                               DELIMITED BY SIZE                  31830081
318400                               INTO DP013-MESSAGE-TEXT (1)        31840081
318500             MOVE RC074-CRA-RET-MSG                               31850081
318600                                 TO DP013-MESSAGE-TEXT (2)        31860081
318700             MOVE RC074-SQLCA    TO DP013-SQLCA                   31870081
318800             SET DP013-DB2-ABEND                                  31880081
318900                 DP013-XCTL-DISPLAY-RESTART                       31890081
319000                                 TO TRUE                          31900081
319100             PERFORM DP013-0000-PROCESS-ABEND                     31910081
319200     END-EVALUATE.                                                31920081
319300                                                                  31930081
319400*----------------------------------------------------------------*31940081
319500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31950081
319600*----------------------------------------------------------------*31960081
319700                                                                  31970081
319800 4400-MOVE-COMMAREA-TO-SCREEN.                                    31980081
319900     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             31990081
320000         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          32000081
320100         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          32010081
320200             MOVE +1    TO ASC-BLK-SUB                            32020081
320300             PERFORM 5100-WRITE-TEMP-STORAGE                      32030081
320400             ADD +1     TO ASC-BLK-SUB                            32040081
320500             PERFORM 5100-WRITE-TEMP-STORAGE                      32050081
320600             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             32060081
320700                 GIVING PV-BLOCK-NUMBER                           32070081
320800                 REMAINDER PV-REMAINDER                           32080081
320900             IF  PV-REMAINDER > ZERO                              32090081
321000                 ADD +1 TO PV-BLOCK-NUMBER                        32100081
321100             END-IF                                               32110081
321200             MOVE +1    TO ASC-BLK-SUB                            32120081
321300             PERFORM 4410-READ-TEMP-STORAGE                       32130081
321400             ADD +1     TO ASC-BLK-SUB                            32140081
321500                           PV-BLOCK-NUMBER                        32150081
321600             PERFORM 4410-READ-TEMP-STORAGE                       32160081
321700     END-IF.                                                      32170081
321800     MOVE +1            TO ASC-BLK-SUB.                           32180081
321900     COMPUTE ASC-ITEM-SUB =                                       32190081
322000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              32200081
322100         + PC-ITEMS-PER-PANEL).                                   32210081
322200*                                                                 32220081
322300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        32230081
322400         ADD +1         TO ASC-BLK-SUB                            32240081
322500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            32250081
322600     END-IF.                                                      32260081
322700*                                                                 32270081
322800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           32280081
322900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                32290081
323000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        32300081
323100     PERFORM 4420-FORMAT-LIST-LINES                               32310081
323200         VARYING PV-SUB                                           32320081
323300         FROM PC-ITEMS-PER-PANEL BY -1                            32330081
323400         UNTIL PV-SUB < +1.                                       32340081
323500*                                                                 32350081
323600     COMPUTE ASC-ITEMS-DISPLAYED =                                32360081
323700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          32370081
323800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    32380081
323900                                      ASTRTITO.                   32390081
324000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    32400081
324100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    32410081
324200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            32420081
324300                                   TO ASELITO.                    32430081
324400*                                                                 32440081
324500     IF  DP020-MSG-NUMBER-X = SPACE                               32450081
324600         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  32460081
324700*            --- MORE ITEMS TO DISPLAY ----                       32470081
324800             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            32480081
324900             SET DP020-MSG-INFORMATIONAL TO TRUE                  32490081
325000         END-IF                                                   32500081
325100     END-IF.                                                      32510081
325200                                                                  32520081
325300                                                                  32530081
325400     MOVE ASC-PO-NBR               TO APOO.                       32540081
325500     MOVE ASC-REC-SEQ-NBR          TO ARCVRO.                     32550081
325600     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     32560081
325700     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    32570081
325800     MOVE ASC-FCLTY-NME            TO ANAMEO.                     32580081
325900     MOVE ASC-PACK-ID              TO APACKO.                     32590081
326000     MOVE ASC-RECITM-STATUS-CDE    TO ASTATO.                     32600081
326100     MOVE ASC-RECEIV-VRFY-INFO     TO ADTETKO.                    32610081
326200     MOVE ASC-STR-NBR              TO ASTOREO.                    32620081
326300     MOVE ASC-TOT-PKSLIP-PACKS     TO APCKSLPO.                   32630081
326400     MOVE ASC-TOT-ACTUAL-PACKS     TO AACTUALO.                   32640081
326500     MOVE ASC-TOT-VERFYD-PACKS     TO AVERFYDO.                   32650081
326600     MOVE ASC-HDR-TOT-PKSL-UNTS    TO ATPKSLPO.                   32660081
326700     MOVE ASC-TOT-ODD-UNITS        TO AODDO.                      32670081
326800     MOVE ASC-HDR-TOT-ACT-UNTS     TO ATACTUALO.                  32680081
326900     MOVE ASC-HDR-TOT-VERFYD-UNTS  TO ATVERFYDO.                  32690081
327000*----------------------------------------------------------------*32700081
327100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *32710081
327200*----------------------------------------------------------------*32720081
327300                                                                  32730081
327400 4410-READ-TEMP-STORAGE.                                          32740081
327500                                                                  32750081
327600     EXEC CICS                                                    32760081
327700         READQ TS                                                 32770081
327800             QUEUE (ASC-LIST-QUEUE-NAME)                          32780081
327900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32790081
328000             ITEM  (PV-BLOCK-NUMBER)                              32800081
328100             RESP  (PV-CICS-RESP)                                 32810081
328200     END-EXEC.                                                    32820081
328300                                                                  32830081
328400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       32840081
328500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     32850081
328600         CONTINUE                                                 32860081
328700     ELSE                                                         32870081
328800         SET DP013-CICS-ABEND     TO TRUE                         32880081
328900         SET DP013-NO-ROLLBACK    TO TRUE                         32890081
329000         MOVE '4410-READ-TEMP-STORAGE'                            32900081
329100                                  TO DP013-PARAGRAPH              32910081
329200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      32920081
329300                                  TO DP013-MESSAGE-TEXT(1)        32930081
329400         PERFORM DP013-0000-PROCESS-ABEND                         32940081
329500     END-IF.                                                      32950081
329600                                                                  32960081
329700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             32970081
329800*                                                                 32980081
329900     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         32990081
330000         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               33000081
330100     END-IF.                                                      33010081
330200 EJECT                                                            33020081
330300*----------------------------------------------------------------*33030081
330400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *33040081
330500*----------------------------------------------------------------*33050081
330600                                                                  33060081
330700 4420-FORMAT-LIST-LINES.                                          33070081
330800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      33080081
330900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                33090081
331000         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           33100081
331100                                    MR-UPDATE-ODDSA (PV-SUB)      33110081
331200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           33120081
331300                                    MR-UPDATE-ODDSH (PV-SUB)      33130081
331400         MOVE SPACE              TO MR-SELECTI (PV-SUB)           33140081
331500                                    MR-ACTION (PV-SUB)            33150081
331600                                    MR-UPDATE-ODDS-X (PV-SUB)     33160081
331700                                    MR-LINE-NBR-X (PV-SUB)        33170081
331800                                    MR-SKU-X (PV-SUB)             33180081
331900                                    MR-PACK-RATIO-X (PV-SUB)      33190081
332000                                    MR-ACTL-ODD-UNTS-X (PV-SUB)   33200081
332100                                    MR-VRFD-ODD-UNTS-X (PV-SUB)   33210081
332200                                    MR-PKSLP-TOT-UNTS-X (PV-SUB)  33220081
332300                                    MR-ACTUAL-TOT-UNTS-X (PV-SUB) 33230081
332400                                    MR-VRFD-TOTAL-UNTS-X (PV-SUB) 33240081
332500     ELSE                                                         33250081
332600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33260081
332700                                                   > SPACE        33270081
332800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 33280081
332900                                 TO MR-SELECTI (PV-SUB)           33290081
333000         ELSE                                                     33300081
333100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      33310081
333200                                 TO MR-SELECTI (PV-SUB)           33320081
333300         END-IF                                                   33330081
333400*                                                                 33340081
333500         IF  DP030-SET-CURSOR-TRAILER                             33350081
333600             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)33360081
333700                 > SPACE)                                         33370081
333800               OR (PV-SUB = 1))                                   33380081
333900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               33390081
334000                MOVE -1          TO MR-SELECTL (PV-SUB)           33400081
334100             END-IF                                               33410081
334200         END-IF                                                   33420081
334300*                                                                 33430081
334400         IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)          33440081
334500             MOVE ASC-UPDATE-ODDS-N (ASC-BLK-SUB ASC-ITEM-SUB)    33450081
334600                                   TO PV-DISPLAY-ZERO             33460081
334700             MOVE PV-DISPLAY-ZERO  TO MR-UPDATE-ODDS-X (PV-SUB)   33470081
334800             MOVE DP015-UNP-ALP-NOR-MDT                           33480081
334900                                   TO MR-UPDATE-ODDSA (PV-SUB)    33490081
335000         ELSE                                                     33500081
335100             MOVE ASC-UPDATE-ODDS-N (ASC-BLK-SUB ASC-ITEM-SUB)    33510081
335200                                   TO PV-DISPLAY-NO-ZERO          33520081
335300             MOVE PV-DISPLAY-NO-ZERO                              33530081
335400                                   TO MR-UPDATE-ODDS-X (PV-SUB)   33540081
335500         END-IF                                                   33550081
335600*                                                                 33560081
335700         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           33570081
335800             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           33580081
335900                                 TO MR-ACTION (PV-SUB)            33590081
336000             IF ASC-RECEIV-STATUS-CDE = 'VE' AND                  33600081
336100                ASC-RECEIV-ML-POST-TMST NOT = PC-DB2-DEFAULT-TMST 33610081
336200                AND                                               33620081
336300                ASC-NOT-POST-VERIFIED-RECEIPT                     33630081
336400                     MOVE DP015-ASK-DRK-OFF                       33640081
336500                                       TO MR-UPDATE-ODDSA (PV-SUB)33650081
336600                                          MR-SELECTA (PV-SUB)     33660081
336700                     MOVE DP015-HL-OFF                            33670081
336800                                       TO MR-UPDATE-ODDSH (PV-SUB)33680081
336900                                          MR-SELECTH (PV-SUB)     33690081
337000             END-IF                                               33700081
337100                                                                  33710081
337200*** DMH 1/19/16 - BEGIN                                           33720081
337300             IF  ASC-RECEIV-STATUS-CDE = 'VE' AND                 33730081
337400                 ASC-RACF-OVERRIDE-YES        AND                 33740081
337500                 ASC-CURR-OPER-EFC-YES                            33750081
337600                    MOVE DP015-UNP-ALP-NOR-OFF                    33760081
337700                                   TO MR-SELECTA (PV-SUB)         33770081
337800                                      MR-UPDATE-ODDSA (PV-SUB)    33780081
337900                    MOVE DP015-GREEN                              33790081
338000                                   TO MR-SELECTC (PV-SUB)         33800081
338100                                      MR-UPDATE-ODDSC (PV-SUB)    33810081
338200                    MOVE DP015-UNDERLINE                          33820081
338300                                   TO MR-SELECTH (PV-SUB)         33830081
338400                                      MR-UPDATE-ODDSH (PV-SUB)    33840081
338500             END-IF                                               33850081
338600*** DMH 1/19/16 - END                                             33860081
338700                                                                  33870081
338800             MOVE ASC-LINE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         33880081
338900                                 TO MR-LINE-NBR (PV-SUB)          33890081
339000             MOVE ASC-SKU (ASC-BLK-SUB ASC-ITEM-SUB)              33900081
339100                                 TO MR-SKU (PV-SUB)               33910081
339200             MOVE ASC-PACK-RATIO (ASC-BLK-SUB ASC-ITEM-SUB)       33920081
339300                                 TO MR-PACK-RATIO (PV-SUB)        33930081
339400             MOVE ASC-ACTL-ODD-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)    33940081
339500                                 TO MR-ACTL-ODD-UNTS (PV-SUB)     33950081
339600             MOVE ASC-VRFD-ODD-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)    33960081
339700                                 TO MR-VRFD-ODD-UNTS (PV-SUB)     33970081
339800             MOVE ASC-PKSLP-TOT-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)   33980081
339900                                 TO MR-PKSLP-TOT-UNTS (PV-SUB)    33990081
340000             MOVE ASC-ACTUAL-TOT-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)  34000081
340100                                 TO MR-ACTUAL-TOT-UNTS (PV-SUB)   34010081
340200             MOVE ASC-VRFD-TOTAL-UNTS (ASC-BLK-SUB ASC-ITEM-SUB)  34020081
340300                                 TO MR-VRFD-TOTAL-UNTS (PV-SUB)   34030081
340400         END-IF                                                   34040081
340500         IF ASC-AUTO-VE-YES                                       34050081
340600*** DMH 1/19/16 - BEGIN                                           34060081
340700            IF  ASC-RACF-OVERRIDE-YES     AND                     34070081
340800                ASC-CURR-OPER-EFC-YES     AND                     34080081
340900                ASC-RECEIV-STATUS-CDE = 'VE' AND                  34090081
341000                ASC-RECEIV-ML-POST-TMST NOT =                     34100081
341100                                          PC-DB2-DEFAULT-TMST AND 34110081
341200                ASC-NOT-POST-VERIFIED-RECEIPT                     34120081
341300                 MOVE DP015-UNP-ALP-NOR-OFF                       34130081
341400                                   TO MR-SELECTA (PV-SUB)         34140081
341500                                      MR-UPDATE-ODDSA (PV-SUB)    34150081
341600                 MOVE DP015-GREEN                                 34160081
341700                                   TO MR-SELECTC (PV-SUB)         34170081
341800                                      MR-UPDATE-ODDSC (PV-SUB)    34180081
341900                 MOVE DP015-UNDERLINE                             34190081
342000                                   TO MR-SELECTH (PV-SUB)         34200081
342100                                      MR-UPDATE-ODDSH (PV-SUB)    34210081
342200*** DMH 1/19/16 - END                                             34220081
342300            ELSE                                                  34230081
342400*** DMH 1/19/16 - BEGIN                                           34240081
342500                IF  ASC-RECEIV-STATUS-CDE = 'VE' AND              34250081
342600                    ASC-RACF-OVERRIDE-YES        AND              34260081
342700                    ASC-CURR-OPER-EFC-YES                         34270081
342800                    CONTINUE                                      34280081
342900                ELSE                                              34290081
343000*** DMH 1/19/16 - END                                             34300081
343100                    MOVE DP015-ASK-DRK-OFF                        34310081
343200                                    TO  MR-UPDATE-ODDSA (PV-SUB)  34320081
343300                END-IF                                            34330081
343400            END-IF                                                34340081
343500         END-IF                                                   34350081
343600     END-IF.                                                      34360081
343700     SUBTRACT +1 FROM ASC-ITEM-SUB                                34370081
343800     IF  ASC-ITEM-SUB < + 1                                       34380081
343900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  34390081
344000         MOVE +1                 TO ASC-BLK-SUB                   34400081
344100     END-IF.                                                      34410081
344200                                                                  34420081
344300                                                                  34430081
344400******************************************************************34440081
344500** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **34450081
344600** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **34460081
344700** ISSUE A WARNING.                                             **34470081
344800******************************************************************34480081
344900 4430-CHECK-FOR-BEGIN-AND-END.                                    34490081
345000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       34500081
345100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     34510081
345200*            -- NO END-OF-RANGE SPECFIED ---                      34520081
345300             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            34530081
345400             SET DP020-MSG-WARNING TO TRUE                        34540081
345500             PERFORM 4431-POSITION-AT-WARNING                     34550081
345600         END-IF                                                   34560081
345700     ELSE                                                         34570081
345800         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     34580081
345900*            -- NO BEGINNING-OF-RANGE SPECFIED ---                34590081
346000             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            34600081
346100             SET DP020-MSG-WARNING TO TRUE                        34610081
346200             PERFORM 4431-POSITION-AT-WARNING                     34620081
346300         END-IF                                                   34630081
346400     END-IF.                                                      34640081
346500******************************************************************34650081
346600** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **34660081
346700** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **34670081
346800** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **34680081
346900** POSITION THE CURSOR THERE.                                   **34690081
347000******************************************************************34700081
347100 4431-POSITION-AT-WARNING.                                        34710081
347200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 34720081
347300                    - PV-TOP-ITEM + 1.                            34730081
347400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34740081
347500         CONTINUE                                                 34750081
347600     ELSE                                                         34760081
347700         SET DP030-SET-CURSOR-APPL-1                              34770081
347800                                   TO TRUE                        34780081
347900         MOVE -1                   TO MR-SELECTL (PV-SUB)         34790081
348000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34800081
348100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34810081
348200     END-IF.                                                      34820081
348300*                                                                 34830081
348400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   34840081
348500                    - PV-TOP-ITEM + 1.                            34850081
348600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      34860081
348700         CONTINUE                                                 34870081
348800     ELSE                                                         34880081
348900         SET DP030-SET-CURSOR-APPL-1                              34890081
349000                                   TO TRUE                        34900081
349100         MOVE -1                   TO MR-SELECTL (PV-SUB)         34910081
349200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         34920081
349300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         34930081
349400     END-IF.                                                      34940081
349500                                                                  34950081
349600 EJECT                                                            34960081
349700*----------------------------------------------------------------*34970081
349800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *34980081
349900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *34990081
350000* FOR THE SELECTED ITEMS QUEUE.                                  *35000081
350100*                                                                *35010081
350200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *35020081
350300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *35030081
350400* THE ARRAY IS FULL.                                             *35040081
350500*----------------------------------------------------------------*35050081
350600                                                                  35060081
350700 5000-PREPARE-SEL-QUEUE.                                          35070081
350800                                                                  35080081
350900     MOVE +1                   TO  ASC-BLK-SUB.                   35090081
351000     PERFORM 5100-WRITE-TEMP-STORAGE.                             35100081
351100     ADD +1                    TO  ASC-BLK-SUB.                   35110081
351200     PERFORM 5100-WRITE-TEMP-STORAGE.                             35120081
351300                                                                  35130081
351400     MOVE ASC-SEL-QUEUE-NAME   TO  RC800-SEL-QUEUE-NAME.          35140081
351500     PERFORM 6010-DELETE-SEL-QUEUE.                               35150081
351600                                                                  35160081
351700     SET PS-NO-UPDATE TO TRUE.                                    35170081
351800     EVALUATE TRUE                                                35180081
351900****    F15 - UPDATE                                              35190081
352000         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              35200081
352100****    PF2  CONFIRM UPDATE                                       35210081
352200         WHEN DP020-FK-CONFIRM (DP020-SRC-AID) AND                35220081
352300             ASC-CONFIRMED                                        35230081
352400             SET PS-NO-ZERO-ODD-UNITS TO TRUE                     35240081
352500             PERFORM 5050-CHECK-FOR-UPDATES                       35250081
352600                     VARYING PV-ITEM                              35260081
352700                     FROM 1 BY 1                                  35270081
352800                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 35280081
352900             IF PS-UPDATE                                         35290081
353000                 SET DP030-OVERRIDE-GO     TO TRUE                35300081
353100                 MOVE PC-TSYMSG-02780      TO DP020-MSG-NUMBER    35310081
353200                 SET DP020-MSG-WARNING     TO TRUE                35320081
353300             ELSE                                                 35330081
353400               IF PS-ZERO-ODD-UNITS                               35340081
353500                 SET DP030-OVERRIDE-GO     TO TRUE                35350081
353600                 MOVE PC-TSYMSG-03087      TO DP020-MSG-NUMBER    35360081
353700                 SET DP020-MSG-WARNING     TO TRUE                35370081
353800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             35380081
353900               ELSE                                               35390081
354000                 INITIALIZE PV-PACK-TABLE                         35400081
354100                 MOVE 0     TO PV-NUMBER-OF-LINES                 35410081
354200                 SET LINE-IDX TO 1                                35420081
354300                 PERFORM 5230-PROCESS-UPDATES                     35430081
354400                         VARYING PV-ITEM                          35440081
354500                         FROM 1 BY 1                              35450081
354600                  UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN 35460081
354700                                                                  35470081
354800                 MOVE PC-TSYMSG-00059                             35480081
354900                                     TO DP020-MSG-NUMBER          35490081
355000                 SET DP020-MSG-INFORMATIONAL                      35500081
355100                                     TO TRUE                      35510081
355200                 PERFORM 9000-UPDATE-SELECTION-QUEUE              35520081
355300                                                                  35530081
355400                 INITIALIZE ASC-BLOCK-ENTRIES (1)                 35540081
355500                            ASC-BLOCK-ENTRIES (2)                 35550081
355600                 MOVE +1             TO ASC-BLK-SUB               35560081
355700                                                                  35570081
355800                 MOVE ZERO       TO ASC-ITEM-SUB                  35580081
355900                                    ASC-NUMBER-OF-SELECTED-ITEMS  35590081
356000                                    ASC-START-OF-SELECTED-RANGE   35600081
356100                                    ASC-END-OF-SELECTED-RANGE     35610081
356200                                    ASC-ITEM-AT-TOP-OF-PANEL      35620081
356300                                                                  35630081
356400                 PERFORM 4410-READ-TEMP-STORAGE                   35640081
356500                                                                  35650081
356600                 MOVE ASC-PACK-ID          TO DK-PREPK-ID         35660081
356700                 PERFORM 4340-SELECT-DRIVER-RATIO                 35670081
356800                 MOVE RECITM-PREPK-RATO-QTY TO PV-DRIVER-RATIO    35680081
356900                 MOVE ASC-DRIVER-LNE-NBR    TO DK-PO-DRIVER-LNE   35690081
357000                 PERFORM 4330-SUM-TRECDIS-DRIVER                  35700081
357100                 PERFORM 4380-SELECT-ODD-UNITS                    35710081
357200                 COMPUTE ASC-TOT-ODD-UNITS =                      35720081
357300                   (ASC-TOT-ODD-UNITS + PV-TOT-ODD-ADJ)           35730081
357400                 IF PV-DRIVER-RATIO > 0                           35740081
357500                     IF (PV-ODD-DC-VERIFY-ODU-QTY >               35750081
357600                         PV-LNE-VERIFY-ITM-QTY) OR                35760081
357700                        (PV-ODD-AP-VERIFY-ODU-QTY >               35770081
357800                         PV-LNE-AP-VERIFY-ITM-QTY)                35780081
357900                         MOVE '5000-PREPARE-SEL-QUEUE'            35790081
358000                                              TO DP013-PARAGRAPH  35800081
358100                         MOVE                                     35810081
358200                          'CONTACT HELP DESK AT X1515 IMMEDIATELY'35820081
358300                                  TO DP013-MESSAGE-TEXT (1)       35830081
358400                         MOVE 'RECDIS QUANTITY LESS THAN ODD UNIT'35840081
358500                                  TO DP013-MESSAGE-TEXT (2)       35850081
358600                         MOVE DK-PO-NBR        TO PV-DISP-PO-NBR  35860081
358700                         MOVE DK-OPER-UNT-ID                      35870081
358800                                          TO PV-DISP-OPER-UNT-ID  35880081
358900                         MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID35890081
359000                         MOVE DK-REC-SEQ-NBR                      35900081
359100                                            TO PV-DISP-REC-SEQ-NBR35910081
359200                         MOVE RECDIS-ORD-LNE-NBR                  35920081
359300                                               TO PV-DISP-LNE-NBR 35930081
359400                         STRING ' PO = '                          35940081
359500                                PV-DISP-PO-NBR                    35950081
359600                                ' RECV ='                         35960081
359700                                PV-DISP-REC-SEQ-NBR               35970081
359800                                ' OPER = '                        35980081
359900                                PV-DISP-OPER-UNT-ID               35990081
360000                                ' FCLTY = '                       36000081
360100                                PV-DISP-FCLTY-ID                  36010081
360200                                ' LINE = '                        36020081
360300                                PV-DISP-LNE-NBR                   36030081
360400                                    DELIMITED BY SIZE             36040081
360500                                       INTO DP013-MESSAGE-TEXT (3)36050081
360600                         SET DP013-DB2-ABEND                      36060081
360700                                          TO TRUE                 36070081
360800                         PERFORM DP013-0000-PROCESS-ABEND         36080081
360900                                                                  36090081
361000                     END-IF                                       36100081
361100                 ELSE                                             36110081
361200                     MOVE 0        TO PV-PKSLIP-PACKS             36120081
361300                                      PV-ACTUAL-PACKS             36130081
361400                                      PV-VERFYD-PACKS             36140081
361500                 END-IF                                           36150081
361600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             36160081
361700               END-IF                                             36170081
361800             END-IF                                               36180081
361900                                                                  36190081
362000****    PF2 - DISSOLVE PACK - CONFIRM                             36200081
362100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    36210081
362200             PERFORM 5230-PROCESS-UPDATES                         36220081
362300                 VARYING PV-ITEM                                  36230081
362400                 FROM 1 BY 1                                      36240081
362500              UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN     36250081
362600                                                                  36260081
362700             PERFORM 9000-UPDATE-SELECTION-QUEUE                  36270081
362800             MOVE PC-TSYMSG-00059                                 36280081
362900                                 TO DP020-MSG-NUMBER              36290081
363000             SET DP020-MSG-INFORMATIONAL                          36300081
363100                                 TO TRUE                          36310081
363200             PERFORM 2050-DELETE-LIST-QUEUE                       36320081
363300             PERFORM 4000-BUILD-INITIAL-PANEL                     36330081
363400     END-EVALUATE.                                                36340081
363500                                                                  36350081
363600 5050-CHECK-FOR-UPDATES.                                          36360081
363700                                                                  36370081
363800     MOVE ASC-PO-NBR           TO DK-PO-NBR.                      36380081
363900     MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.                 36390081
364000     MOVE ASC-STR-NBR          TO DK-STR-NBR.                     36400081
364100     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 36410081
364200     MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID.                    36420081
364300                                                                  36430081
364400     PERFORM 6112-READ-LIST-QUEUE.                                36440081
364500                                                                  36450081
364600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       36460081
364700         PERFORM                                                  36470081
364800         VARYING LQW-IDX                                          36480081
364900         FROM 1 BY 1                                              36490081
365000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            36500081
365100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          36510081
365200                                                                  36520081
365300             IF  LQW-SELECT (LQW-IDX)                             36530081
365400                 MOVE LQW-LINE-NBR (LQW-IDX)   TO                 36540081
365500                                     DK-ODD-LNE-NBR               36550081
365600                 PERFORM 5400-SELECT-TRECDIS                      36560081
365700                 IF RECDIS-VERIFY-ITM-QTY NOT =                   36570081
365800                                   LQW-ACTUAL-TOT-UNTS (LQW-IDX)  36580081
365900                          OR                                      36590081
366000                    RECDIS-AP-VERIFY-ITM-QTY NOT =                36600081
366100                                   LQW-VRFD-TOTAL-UNTS (LQW-IDX)  36610081
366200                                                                  36620081
366300                     SET PS-UPDATE             TO TRUE            36630081
366400                 ELSE                                             36640081
366500                     IF LQW-UPDATE-ODDS (LQW-IDX) = 0 AND         36650081
366600                       ((LQW-STATUS-CDE (LQW-IDX) NOT = 'VE' AND  36660081
366700                        LQW-ACTL-ODD-UNTS (LQW-IDX) = 0) OR       36670081
366800                        (LQW-STATUS-CDE (LQW-IDX) = 'VE' AND      36680081
366900                        LQW-VRFD-ODD-UNTS (LQW-IDX) = 0))         36690081
367000                         SET PS-ZERO-ODD-UNITS TO TRUE            36700081
367100                     END-IF                                       36710081
367200                 END-IF                                           36720081
367300             END-IF                                               36730081
367400         END-PERFORM                                              36740081
367500     END-IF.                                                      36750081
367600                                                                  36760081
367700 EJECT                                                            36770081
367800*----------------------------------------------------------------*36780081
367900*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *36790081
368000*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *36800081
368100*----------------------------------------------------------------*36810081
368200                                                                  36820081
368300 5100-WRITE-TEMP-STORAGE.                                         36830081
368400     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     36840081
368500                                   TO PV-LIST-ITEM-NUMBER.        36850081
368600     COMPUTE PV-BLOCK-NUMBER =                                    36860081
368700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    36870081
368800                                                                  36880081
368900     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             36890081
369000     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             36900081
369100         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      36910081
369200             PERFORM 5105-REWRITE-ASC-LISTQ                       36920081
369300         END-IF                                                   36930081
369400     ELSE                                                         36940081
369500         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       36950081
369600         ASC-HIGHEST-BLOCK-WRITTEN + 1                            36960081
369700         PERFORM 5110-WRITE-ASC-LISTQ                             36970081
369800         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   36980081
369900     END-IF.                                                      36990081
370000                                                                  37000081
370100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             37010081
370200******************************************************************37020081
370300** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **37030081
370400** SPECIFIC COMMAREA.                                           **37040081
370500******************************************************************37050081
370600 5105-REWRITE-ASC-LISTQ.                                          37060081
370700     EXEC CICS                                                    37070081
370800         WRITEQ TS                                                37080081
370900             QUEUE (ASC-LIST-QUEUE-NAME)                          37090081
371000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37100081
371100             ITEM  (PV-BLOCK-NUMBER)                              37110081
371200             REWRITE                                              37120081
371300             RESP  (PV-CICS-RESP)                                 37130081
371400     END-EXEC.                                                    37140081
371500                                                                  37150081
371600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           37160081
371700         CONTINUE                                                 37170081
371800     ELSE                                                         37180081
371900         SET DP013-CICS-ABEND            TO TRUE                  37190081
372000         SET DP013-NO-ROLLBACK           TO TRUE                  37200081
372100         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       37210081
372200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     37220081
372300                                         TO DP013-MESSAGE-TEXT(1) 37230081
372400         PERFORM DP013-0000-PROCESS-ABEND                         37240081
372500     END-IF.                                                      37250081
372600                                                                  37260081
372700******************************************************************37270081
372800** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **37280081
372900** SPECIFIC COMMAREA.                                           **37290081
373000******************************************************************37300081
373100 5110-WRITE-ASC-LISTQ.                                            37310081
373200     EXEC CICS                                                    37320081
373300         WRITEQ TS                                                37330081
373400             QUEUE (ASC-LIST-QUEUE-NAME)                          37340081
373500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               37350081
373600             ITEM  (PV-BLOCK-NUMBER)                              37360081
373700             RESP  (PV-CICS-RESP)                                 37370081
373800     END-EXEC.                                                    37380081
373900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      37390081
374000         SET DP013-CICS-ABEND      TO TRUE                        37400081
374100         SET DP013-NO-ROLLBACK     TO TRUE                        37410081
374200         MOVE '5110-WRITE-ASC-LISTQ'                              37420081
374300                                   TO DP013-PARAGRAPH             37430081
374400         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           37440081
374500                                   TO DP013-MESSAGE-TEXT(1)       37450081
374600         PERFORM DP013-0000-PROCESS-ABEND                         37460081
374700     END-IF.                                                      37470081
374800 EJECT                                                            37480081
374900*----------------------------------------------------------------*37490081
375000* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *37500081
375100* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *37510081
375200*----------------------------------------------------------------*37520081
375300                                                                  37530081
375400                                                                  37540081
375500*----------------------------------------------------------------*37550081
375600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *37560081
375700*----------------------------------------------------------------*37570081
375800                                                                  37580081
375900 5205-WRITE-SEL-QUEUE.                                            37590081
376000                                                                  37600081
376100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37610081
376200                                   TO RC037-SELECTED-ITEMS.       37620081
376300                                                                  37630081
376400     EXEC CICS                                                    37640081
376500          WRITEQ TS                                               37650081
376600              QUEUE (ASC-SEL-QUEUE-NAME)                          37660081
376700              FROM  (RC801-PREPACK-SELECT-RECORD)                 37670081
376800              ITEM  (PV-SEL-QUEUE-ITEM)                           37680081
376900              RESP  (PV-CICS-RESP)                                37690081
377000     END-EXEC.                                                    37700081
377100                                                                  37710081
377200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          37720081
377300         CONTINUE                                                 37730081
377400     ELSE                                                         37740081
377500         SET DP013-CICS-ABEND      TO TRUE                        37750081
377600         SET DP013-NO-ROLLBACK     TO TRUE                        37760081
377700         MOVE '5205-WRITE-SEL-QUEUE'                              37770081
377800                                   TO DP013-PARAGRAPH             37780081
377900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          37790081
378000                                   TO DP013-MESSAGE-TEXT(1)       37800081
378100         PERFORM DP013-0000-PROCESS-ABEND                         37810081
378200     END-IF.                                                      37820081
378300                                                                  37830081
378400 5300-GET-TRECEIV-STATUS.                                         37840081
378500                                                                  37850081
378600     EXEC SQL                                                     37860081
378700          SELECT                                                  37870081
378800             ML_POST_TMST                                         37880081
378900           , FS_POST_TMST                                         37890081
379000           , STATUS_CDE                                           37900081
379100           , VERFYD_TMST                                          37910081
379200           , VRFD_USR_ID                                          37920081
379300        INTO                                                      37930081
379400             :RECEIV-ML-POST-TMST                                 37940081
379500           , :RECEIV-FS-POST-TMST                                 37950081
379600           , :RECEIV-STATUS-CDE                                   37960081
379700           , :RECEIV-VERFYD-TMST                                  37970081
379800           , :RECEIV-VRFD-USR-ID                                  37980081
379900          FROM  TRECEIV                                           37990081
380000          WHERE                                                   38000081
380100                 ORD_NBR          =  :DK-PO-NBR                   38010081
380200          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              38020081
380300          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              38030081
380400          AND    FCLTY_ID         =  :DK-FCLTY-ID                 38040081
380500          AND    VER_STATUS_CDE   =  'A'                          38050081
380600     END-EXEC.                                                    38060081
380700                                                                  38070081
380800     EVALUATE TRUE                                                38080081
380900         WHEN SQLCODE = ZERO                                      38090081
381000             CONTINUE                                             38100081
381100                                                                  38110081
381200         WHEN SQLCODE = -904                                      38120081
381300         WHEN SQLCODE = -911                                      38130081
381400         WHEN SQLCODE = -913                                      38140081
381500              PERFORM 9900-SOFT-ABORT                             38150081
381600         WHEN SQLWARN0 NOT = SPACE                                38160081
381700         WHEN SQLCODE NOT = ZERO                                  38170081
381800              MOVE '5300-GET-TRECEIV-STATUS'                      38180081
381900                               TO DP013-PARAGRAPH                 38190081
382000              MOVE 'SELECT TRECEIV'                               38200081
382100                               TO DP013-MESSAGE-TEXT (1)          38210081
382200              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             38220081
382300              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        38230081
382400              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        38240081
382500              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           38250081
382600              STRING ' PO = '                                     38260081
382700                     PV-DISP-PO-NBR                               38270081
382800                     ' RECV ='                                    38280081
382900                     PV-DISP-REC-SEQ-NBR                          38290081
383000                     ' OPER ='                                    38300081
383100                     PV-DISP-OPER-UNT-ID                          38310081
383200                     ' FCLTY = '                                  38320081
383300                     PV-DISP-FCLTY-ID                             38330081
383400                                         DELIMITED BY SIZE        38340081
383500                              INTO DP013-MESSAGE-TEXT (2)         38350081
383600              MOVE SQLCA        TO DP013-SQLCA                    38360081
383700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        38370081
383800              MOVE SQLCA       TO DP013-SQLCA                     38380081
383900              SET DP013-DB2-ABEND                                 38390081
384000                               TO TRUE                            38400081
384100              PERFORM DP013-0000-PROCESS-ABEND                    38410081
384200     END-EVALUATE.                                                38420081
384300                                                                  38430081
384400 5230-PROCESS-UPDATES.                                            38440081
384500                                                                  38450081
384600     PERFORM 6112-READ-LIST-QUEUE.                                38460081
384700                                                                  38470081
384800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       38480081
384900         PERFORM                                                  38490081
385000         VARYING LQW-IDX                                          38500081
385100         FROM 1 BY 1                                              38510081
385200         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            38520081
385300           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          38530081
385400                                                                  38540081
385500**          DISOLVE A PACK                                        38550081
385600             IF DP020-FK-CONFIRM (DP020-SRC-AID) AND              38560081
385700                ASC-CONFIRM                                       38570081
385800                 MOVE LQW-LINE-NBR (LQW-IDX)   TO                 38580081
385900                                     DK-ODD-LNE-NBR               38590081
386000                 MOVE LQW-PACK-RATIO (LQW-IDX) TO                 38600081
386100                                     PV-PACK-RATIO                38610081
386200                                     PV-UPDATE-RATIO              38620081
386300                 MOVE LQW-PKSLP-TOT-UNTS (LQW-IDX) TO             38630081
386400                                     PV-UPDATE-PACK-AMT           38640081
386500                 MOVE LQW-STATUS-CDE (LQW-IDX) TO                 38650081
386600                                     PV-STATUS-CDE                38660081
386700                 MOVE LQW-ACTL-ODD-UNTS (LQW-IDX) TO              38670081
386800                                     PV-ACTL-ODD-UNTS             38680081
386900                                     PV-ORIG-ODD-ACT              38690081
387000                 MOVE LQW-VRFD-ODD-UNTS (LQW-IDX) TO              38700081
387100                                     PV-ORIG-ODD-VRF              38710081
387200                 COMPUTE PV-UPDATE-ODD-ACT =                      38720081
387300                         PV-ORIG-ODD-ACT +                        38730081
387400                         PV-UPDATE-RATIO                          38740081
387500                 COMPUTE PV-UPDATE-ODD-VRF =                      38750081
387600                         PV-ORIG-ODD-VRF +                        38760081
387700                         PV-UPDATE-RATIO                          38770081
387800                 PERFORM 5240-UPDATE-PACK                         38780081
387900                 MOVE 0       TO LQW-UPDATE-ODDS (LQW-IDX)        38790081
388000                 SET PS-ODD-UPDATE-DONE TO TRUE                   38800081
388100             ELSE                                                 38810081
388200                 IF  LQW-SELECT (LQW-IDX)                         38820081
388300                     MOVE LQW-UPDATE-ODDS (LQW-IDX)   TO          38830081
388400                                         PV-UPDATE-ODD-AMT        38840081
388500                                         PV-UPDATE-ODD-ACT        38850081
388600                                         PV-UPDATE-ODD-VRF        38860081
388700                     MOVE LQW-LINE-NBR (LQW-IDX)   TO             38870081
388800                                         DK-ODD-LNE-NBR           38880081
388900                     MOVE LQW-PACK-RATIO (LQW-IDX) TO             38890081
389000                                         PV-PACK-RATIO            38900081
389100                     MOVE LQW-PKSLP-TOT-UNTS (LQW-IDX) TO         38910081
389200                                         PV-UPDATE-PACK-AMT       38920081
389300                     MOVE LQW-STATUS-CDE (LQW-IDX) TO             38930081
389400                                         PV-STATUS-CDE            38940081
389500                     MOVE LQW-ACTL-ODD-UNTS (LQW-IDX) TO          38950081
389600                                 PV-ORIG-ODD-ACT                  38960081
389700                     MOVE LQW-VRFD-ODD-UNTS (LQW-IDX) TO          38970081
389800                                 PV-ORIG-ODD-VRF                  38980081
389900                     PERFORM 5240-UPDATE-PACK                     38990081
390000                     MOVE PC-UPD  TO LQW-ACTION (LQW-IDX)         39000081
390100                     MOVE SPACES                                  39010081
390200                            TO LQW-TEMP-SELECTED-SW (LQW-IDX)     39020081
390300                     SET LQW-DESELECT (LQW-IDX)  TO TRUE          39030081
390400                     IF ASC-POST-VERIFIED-RECEIPT                 39040081
390500                         CONTINUE                                 39050081
390600                     ELSE                                         39060081
390700                         MOVE LQW-UPDATE-ODDS (LQW-IDX)   TO      39070081
390800                              LQW-ACTL-ODD-UNTS (LQW-IDX)         39080081
390900                     END-IF                                       39090081
391000                     IF PV-STATUS-CDE     = 'VE'                  39100081
391100                         MOVE LQW-UPDATE-ODDS (LQW-IDX)   TO      39110081
391200                              LQW-VRFD-ODD-UNTS (LQW-IDX)         39120081
391300                     END-IF                                       39130081
391400                     MOVE LQW-LINE-NBR (LQW-IDX)                  39140081
391500                                           TO DK-LNE-NBR          39150081
391600                     PERFORM 7020-SELECT-PURITM-DATA              39160081
391700                     IF PV-PURITM-UNT-QTY GREATER THAN ZERO       39170081
391800                         IF LQW-STATUS-CDE (LQW-IDX) = 'VE'       39180081
391900                             PERFORM 5800-CHECK-PO-STATUS         39190081
392000                         END-IF                                   39200081
392100                     END-IF                                       39210081
392200                     MOVE 0       TO LQW-UPDATE-ODDS (LQW-IDX)    39220081
392300                     SET PS-ODD-UPDATE-DONE TO TRUE               39230081
392400                 END-IF                                           39240081
392500                 INITIALIZE RC074-FIELDS                          39250081
392600                 MOVE LQW-LINE-NBR (LQW-IDX)                      39260081
392700                                   TO RC074-LINE-NBR              39270081
392800                 PERFORM 4390-CALL-RCKUT128                       39280081
392900                 SUBTRACT LQW-EXPTD-ITM-QTY (LQW-IDX)             39290081
393000                                      FROM ASC-HDR-TOT-PKSL-UNTS  39300081
393100                 SUBTRACT LQW-TTL-ACTL-ITM-QTY (LQW-IDX)          39310081
393200                                      FROM ASC-HDR-TOT-ACT-UNTS   39320081
393300                 SUBTRACT LQW-VERIFY-ITM-QTY (LQW-IDX)            39330081
393400                                      FROM ASC-HDR-TOT-VERFYD-UNTS39340081
393500                 ADD RC074-INVCED-ITM-QTY                         39350081
393600                                        TO ASC-HDR-TOT-PKSL-UNTS  39360081
393700                 ADD RC074-TOTAL-ACTL-ITM-QTY                     39370081
393800                                        TO ASC-HDR-TOT-ACT-UNTS   39380081
393900                 ADD RC074-VERIFY-ITM-QTY                         39390081
394000                                        TO ASC-HDR-TOT-VERFYD-UNTS39400081
394100                 MOVE RC074-INVCED-ITM-QTY                        39410081
394200                       TO LQW-EXPTD-ITM-QTY (LQW-IDX)             39420081
394300                 MOVE RC074-TOTAL-ACTL-ITM-QTY                    39430081
394400                       TO LQW-TTL-ACTL-ITM-QTY (LQW-IDX)          39440081
394500                 MOVE RC074-VERIFY-ITM-QTY                        39450081
394600                       TO LQW-VERIFY-ITM-QTY (LQW-IDX)            39460081
394700                 MOVE LQW-PACK-RATIO (LQW-IDX)                    39470081
394800                                   TO PACK-RATIO                  39480081
394900                                       (LINE-IDX)                 39490081
395000                 MOVE LQW-LINE-NBR (LQW-IDX)                      39500081
395100                                   TO PACK-LINE                   39510081
395200                                       (LINE-IDX)                 39520081
395300                 MOVE LQW-PKSLP-TOT-UNTS (LQW-IDX)                39530081
395400                                   TO PACK-EXPTED-ITM-QTY         39540081
395500                                       (LINE-IDX)                 39550081
395600                 COMPUTE PACK-VERIFY-ITM-QTY (LINE-IDX) =         39560081
395700                     LQW-ACTUAL-TOT-UNTS (LQW-IDX) -              39570081
395800                            LQW-ACTL-ODD-UNTS (LQW-IDX)           39580081
395900                 COMPUTE PACK-AP-VERIFY-ITM-QTY (LINE-IDX) =      39590081
396000                     LQW-VRFD-TOTAL-UNTS (LQW-IDX) -              39600081
396100                            LQW-VRFD-ODD-UNTS (LQW-IDX)           39610081
396200                 ADD 1  TO PV-NUMBER-OF-LINES                     39620081
396300                 SET LINE-IDX UP BY 1                             39630081
396400             END-IF                                               39640081
396500         END-PERFORM                                              39650081
396600     END-IF.                                                      39660081
396700                                                                  39670081
396800     IF PS-ODD-UPDATE-DONE                                        39680081
396900         MOVE PV-ITEM          TO PV-SAVE-ITEM                    39690081
397000         PERFORM 6111-WRITE-LIST-QUEUE                            39700081
397100         SET PS-NO-ODD-UPDATE-DONE TO TRUE                        39710081
397200     END-IF.                                                      39720081
397300                                                                  39730081
397400                                                                  39740081
397500 5240-UPDATE-PACK.                                                39750081
397600     MOVE ASC-PO-NBR           TO DK-PO-NBR.                      39760081
397700     MOVE ASC-REC-SEQ-NBR      TO DK-REC-SEQ-NBR.                 39770081
397800     MOVE ASC-STR-NBR          TO DK-STR-NBR.                     39780081
397900     MOVE ASC-OPER-UNT-ID      TO DK-OPER-UNT-ID.                 39790081
398000     MOVE ASC-FCLTY-ID         TO DK-FCLTY-ID.                    39800081
398100                                                                  39810081
398200     SET PS-NOT-REMOVE-PACK    TO TRUE.                           39820081
398300     IF  DP020-FK-CONFIRM (DP020-SRC-AID)                         39830081
398400     AND ASC-DRIVER-LNE-NBR = LQW-LINE-NBR (LQW-IDX)              39840081
398500     AND PV-STATUS-CDE = 'VE'                                     39850081
398600     AND ASC-CONFIRM                                              39860081
398700         SET PS-REMOVE-PACK    TO TRUE                            39870081
398800         PERFORM 5320-DISOLVE-PACK                                39880081
398900         SET PS-NOT-REMOVE-PACK    TO TRUE                        39890081
399000     END-IF.                                                      39900081
399100                                                                  39910081
399200     PERFORM 5280-UPDATE-ODD-REC.                                 39920081
399300     SET PS-RECDIS-FOUND TO TRUE.                                 39930081
399400                                                                  39940081
399500     PERFORM 5400-SELECT-TRECDIS.                                 39950081
399600     IF PS-RECDIS-NOT-FOUND                                       39960081
399700         MOVE 0     TO RECDIS-VERIFY-ITM-QTY                      39970081
399800                       RECDIS-AP-VERIFY-ITM-QTY                   39980081
399900     END-IF.                                                      39990081
400000                                                                  40000081
400100     IF ASC-POST-VERIFIED-RECEIPT                                 40010081
400200         CONTINUE                                                 40020081
400300     ELSE                                                         40030081
400400         COMPUTE RECDIS-VERIFY-ITM-QTY =                          40040081
400500                 RECDIS-VERIFY-ITM-QTY + PV-UPDATE-DIF-ACT        40050081
400600     END-IF.                                                      40060081
400700     COMPUTE RECDIS-AP-VERIFY-ITM-QTY =                           40070081
400800             RECDIS-AP-VERIFY-ITM-QTY + PV-UPDATE-DIF-VRF.        40080081
400900     IF PV-AP-VRFY-ODU-QTY > RECDIS-AP-VERIFY-ITM-QTY OR          40090081
401000        PV-DC-VRFY-ODU-QTY > RECDIS-VERIFY-ITM-QTY                40100081
401001                                                                  40100189
401002* DMH 10/27/17 - BEGIN                                            40100289
401010             MOVE PC-TSYMSG-03802  TO DP020-MSG-NUMBER            40101089
401030             SET DP030-SET-CURSOR-APPL-1                          40103089
401080                 DP020-MSG-FATAL                                  40108089
401090                 PS-ERROR                                         40109089
401091                 ASC-NOT-CONFIRM   TO TRUE                        40109189
401100             PERFORM 9901-BACKUP                                  40110089
401101             MOVE 'PROGRAM EXIT CALL'                             40110189
401102                                   TO DP013-MESSAGE-TEXT (1)      40110289
401103             PERFORM 0001-CALL-CICS-ARCH-API                      40110389
401104* DMH 10/27/17 - BEGIN                                            40110489
401105                                                                  40110589
403800     END-IF.                                                      40380081
403900                                                                  40390081
404000                                                                  40400081
404010     IF  PS-NO-ERROR                                              40401089
404100         IF  DP020-FK-CONFIRM (DP020-SRC-AID)                     40410089
404200         AND ASC-CONFIRM                                          40420089
404300***  IF TRECDIS DOES NOT EXIST FOR THIS STORE, PERFORM THE 5400-  40430081
404400***  PARA WHICH WILL INSERT A NEW ROW                             40440081
404500             IF  PS-RECDIS-NOT-FOUND                              40450089
404600                 PERFORM 5260-UPDATE-RECDIS                       40460089
404700             ELSE                                                 40470089
404800                 SET PS-LOG-RCKDP819 TO TRUE                      40480089
404900                 PERFORM 5300-UPD-RECDIS-AUDIT-BEFORE             40490089
405000                 SET PS-NO-LOG-RCKDP819 TO TRUE                   40500089
405100             END-IF                                               40510089
405200         ELSE                                                     40520089
405300             PERFORM 5260-UPDATE-RECDIS                           40530089
405400         END-IF                                                   40540089
405410     END-IF.                                                      40541089
405500                                                                  40550081
405510     IF  PS-NO-ERROR                                              40551089
405600         IF  PS-RCT00009-UPDATE-DONE                              40560089
405700         AND PV-STATUS-CDE = 'VE'                                 40570089
405800             MOVE  ASC-PO-NBR              TO PC241-PO-NBR        40580089
405900             MOVE  DK-ODD-LNE-NBR          TO PC241-PO-LNE-NBR    40590089
406000             MOVE  ASC-REC-SEQ-NBR         TO PC241-REC-SEQ-NBR   40600089
406100             MOVE  ASC-OPER-UNT-ID         TO PC241-OPER-UNT-ID   40610089
406200             MOVE  ASC-FCLTY-ID            TO PC241-FCLTY-ID      40620089
406300             MOVE  ASC-STR-NBR             TO PC241-STR-NBR       40630089
406400             MOVE  PV-SAVE-ITM-QTY         TO PC241-STR-ADJ-QTY   40640089
406500             ADD   1                       TO PV-VRFY-ITEM        40650089
406600             PERFORM 6150-WRITE-VRFY-ADJ-QUEUE                    40660089
406700             PERFORM 8500-PROCESS-UNITS-WORK                      40670089
406800         END-IF                                                   40680089
406810     END-IF.                                                      40681089
406900                                                                  40690081
407000                                                                  40700081
407100 5260-UPDATE-RECDIS.                                              40710081
407200                                                                  40720081
407300     IF ASC-POST-VERIFIED-RECEIPT                                 40730081
407400         PERFORM 5350-PROCESS-TROUBLE                             40740081
407500     END-IF.                                                      40750081
407600                                                                  40760081
407700     COMPUTE PV-UPDATE-DIF-ACT =                                  40770081
407800             PV-UPDATE-ODD-ACT -                                  40780081
407900             PV-ORIG-ODD-ACT.                                     40790081
408000     COMPUTE PV-UPDATE-DIF-VRF =                                  40800081
408100             PV-UPDATE-ODD-VRF -                                  40810081
408200             PV-ORIG-ODD-VRF.                                     40820081
408300                                                                  40830081
408400     IF  PV-STATUS-CDE     = 'VE'                                 40840081
408500         COMPUTE PV-TOT-ODD-ADJ =                                 40850081
408600                 PV-TOT-ODD-ADJ +                                 40860081
408700                 PV-UPDATE-DIF-VRF                                40870081
408800     ELSE                                                         40880081
408900         MOVE ZERO TO PV-UPDATE-DIF-VRF                           40890081
409000         COMPUTE PV-TOT-ODD-ADJ =                                 40900081
409100                 PV-TOT-ODD-ADJ +                                 40910081
409200                 PV-UPDATE-DIF-ACT                                40920081
409300     END-IF.                                                      40930081
409400                                                                  40940081
409500     SET PS-RECDIS-FOUND TO TRUE.                                 40950081
409600                                                                  40960081
409700     PERFORM 5400-SELECT-TRECDIS.                                 40970081
409800                                                                  40980081
409900     IF PS-RECDIS-NOT-FOUND                                       40990081
410000         PERFORM 5270-INSERT-RECDIS                               41000081
410100         MOVE 0     TO RECDIS-VERIFY-ITM-QTY                      41010081
410200                       RECDIS-AP-VERIFY-ITM-QTY                   41020081
410300     END-IF.                                                      41030081
410400                                                                  41040081
410500     PERFORM 5300-UPD-RECDIS-AUDIT-BEFORE.                        41050081
410600                                                                  41060081
410700     IF ASC-POST-VERIFIED-RECEIPT                                 41070081
410800         CONTINUE                                                 41080081
410900     ELSE                                                         41090081
411000         COMPUTE RECDIS-VERIFY-ITM-QTY =                          41100081
411100                 RECDIS-VERIFY-ITM-QTY + PV-UPDATE-DIF-ACT        41110081
411200     END-IF.                                                      41120081
411300     COMPUTE RECDIS-AP-VERIFY-ITM-QTY =                           41130081
411400             RECDIS-AP-VERIFY-ITM-QTY + PV-UPDATE-DIF-VRF.        41140081
411500                                                                  41150081
411600     EXEC SQL                                                     41160081
411700          UPDATE TRECDIS                                          41170081
411800          SET    VERIFY_ITM_QTY    = :RECDIS-VERIFY-ITM-QTY       41180081
411900             ,   AP_VERIFY_ITM_QTY = :RECDIS-AP-VERIFY-ITM-QTY    41190081
412000          WHERE                                                   41200081
412100                 ORD_NBR          =  :DK-PO-NBR                   41210081
412200          AND    ORD_LNE_NBR      =  :DK-ODD-LNE-NBR              41220081
412300          AND    REC_SEQ_NBR      =  :DK-REC-SEQ-NBR              41230081
412400          AND    OPER_UNT_ID      =  :DK-OPER-UNT-ID              41240081
412500          AND    FCLTY_ID         =  :DK-FCLTY-ID                 41250081
412600          AND    STR_NBR          =  :DK-STR-NBR                  41260081
412700     END-EXEC.                                                    41270081
412800                                                                  41280081
412900     EVALUATE TRUE                                                41290081
413000         WHEN SQLCODE = ZERO                                      41300081
413100             SET PS-TRECDIS-UPDATE-DONE TO TRUE                   41310081
413200         WHEN SQLCODE = +100                                      41320081
413300              CONTINUE                                            41330081
413400         WHEN SQLCODE = -904                                      41340081
413500         WHEN SQLCODE = -911                                      41350081
413600         WHEN SQLCODE = -913                                      41360081
413700              SET PS-UPDATES-DONE TO TRUE                         41370081
413800              PERFORM 9900-SOFT-ABORT                             41380081
413900         WHEN SQLWARN0 NOT = SPACE                                41390081
414000         WHEN SQLCODE NOT = ZERO                                  41400081
414100              MOVE '5260-UPDATE-RECDIS'                           41410081
414200                               TO DP013-PARAGRAPH                 41420081
414300              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            41430081
414400                               TO DP013-MESSAGE-TEXT (1)          41440081
414500              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             41450081
414600              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        41460081
414700              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           41470081
414800              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        41480081
414900              MOVE RECDIS-ORD-LNE-NBR                             41490081
415000                                    TO PV-DISP-LNE-NBR            41500081
415100              STRING ' PO = '                                     41510081
415200                     PV-DISP-PO-NBR                               41520081
415300                     ' RECV ='                                    41530081
415400                     PV-DISP-REC-SEQ-NBR                          41540081
415500                     ' OPER = '                                   41550081
415600                     PV-DISP-OPER-UNT-ID                          41560081
415700                     ' FCLTY = '                                  41570081
415800                     PV-DISP-FCLTY-ID                             41580081
415900                     ' LINE = '                                   41590081
416000                     PV-DISP-LNE-NBR                              41600081
416100                                         DELIMITED BY SIZE        41610081
416200                              INTO DP013-MESSAGE-TEXT (2)         41620081
416300              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        41630081
416400              MOVE SQLCA       TO DP013-SQLCA                     41640081
416500              SET DP013-DB2-ABEND                                 41650081
416600                               TO TRUE                            41660081
416700              PERFORM DP013-0000-PROCESS-ABEND                    41670081
416800     END-EVALUATE.                                                41680081
416900                                                                  41690081
417000     IF ASC-POST-VERIFIED-RECEIPT AND                             41700081
417100        PS-TRECDIS-UPDATE-DONE                                    41710081
417200         PERFORM 5515-ADD-TO-RECD-AUDIT-AFTER                     41720081
417300     END-IF.                                                      41730081
417400                                                                  41740081
417500 5270-INSERT-RECDIS.                                              41750081
417600     EXEC SQL INSERT                                              41760081
417700          INTO TRECDIS                                            41770081
417800                (ORD_NBR                                          41780081
417900            ,    ORD_LNE_NBR                                      41790081
418000            ,    REC_SEQ_NBR                                      41800081
418100            ,    OPER_UNT_ID                                      41810081
418200            ,    FCLTY_ID                                         41820081
418300            ,    CRE_TMST                                         41830081
418400            ,    CRE_UID                                          41840081
418500            ,    VER_STATUS_CDE                                   41850081
418600            ,    EXPTED_ITM_QTY                                   41860081
418700            ,    VERIFY_ITM_QTY                                   41870081
418800            ,    AP_VERIFY_ITM_QTY                                41880081
418900            ,    PLAN_ITM_QTY                                     41890081
419000            ,    AP_PRC_DTE                                       41900081
419100            ,    STR_NBR                                          41910081
419200            ,    STR_FCLTY_ID)                                    41920081
419300          VALUES                                                  41930081
419400                (:DK-PO-NBR                                       41940081
419500            ,    :DK-ODD-LNE-NBR                                  41950081
419600            ,    :DK-REC-SEQ-NBR                                  41960081
419700            ,    :DK-OPER-UNT-ID                                  41970081
419800            ,    :DK-FCLTY-ID                                     41980081
419900            ,    CURRENT TIMESTAMP                                41990081
420000            ,    'RCKCS819'                                       42000081
420100            ,    'A'                                              42010081
420200            ,    0                                                42020081
420300            ,    0                                                42030081
420400            ,    0                                                42040081
420500            ,    0                                                42050081
420600            ,    '9999-09-09'                                     42060081
420700            ,    :DK-STR-NBR                                      42070081
420800            ,    1  )                                             42080081
420900     END-EXEC.                                                    42090081
421000                                                                  42100081
421100     EVALUATE TRUE                                                42110081
421200         WHEN SQLCODE = ZERO                                      42120081
421300             CONTINUE                                             42130081
421400         WHEN SQLCODE = +100                                      42140081
421500              CONTINUE                                            42150081
421600         WHEN SQLCODE = -904                                      42160081
421700         WHEN SQLCODE = -911                                      42170081
421800         WHEN SQLCODE = -913                                      42180081
421900              SET PS-UPDATES-DONE TO TRUE                         42190081
422000              PERFORM 9900-SOFT-ABORT                             42200081
422100         WHEN SQLWARN0 NOT = SPACE                                42210081
422200         WHEN SQLCODE NOT = ZERO                                  42220081
422300              MOVE '5270-INSERT-RECDIS'                           42230081
422400                               TO DP013-PARAGRAPH                 42240081
422500              MOVE 'INSERT RECEIPT DISTRIBUTION TABLE'            42250081
422600                               TO DP013-MESSAGE-TEXT (1)          42260081
422700              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             42270081
422800              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        42280081
422900              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           42290081
423000              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        42300081
423100              MOVE RECDIS-ORD-LNE-NBR                             42310081
423200                                    TO PV-DISP-LNE-NBR            42320081
423300              STRING ' PO = '                                     42330081
423400                     PV-DISP-PO-NBR                               42340081
423500                     ' RECV ='                                    42350081
423600                     PV-DISP-REC-SEQ-NBR                          42360081
423700                     ' OPER = '                                   42370081
423800                     PV-DISP-OPER-UNT-ID                          42380081
423900                     ' FCLTY = '                                  42390081
424000                     PV-DISP-FCLTY-ID                             42400081
424100                     ' LINE = '                                   42410081
424200                     PV-DISP-LNE-NBR                              42420081
424300                                         DELIMITED BY SIZE        42430081
424400                              INTO DP013-MESSAGE-TEXT (2)         42440081
424500              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        42450081
424600              MOVE SQLCA       TO DP013-SQLCA                     42460081
424700              SET DP013-DB2-ABEND                                 42470081
424800                               TO TRUE                            42480081
424900              PERFORM DP013-0000-PROCESS-ABEND                    42490081
425000     END-EVALUATE.                                                42500081
425100                                                                  42510081
425200 5280-UPDATE-ODD-REC.                                             42520081
425300                                                                  42530081
425400     COMPUTE PV-UPDATE-DIF-ACT =                                  42540081
425500             PV-UPDATE-ODD-ACT -                                  42550081
425600             PV-ORIG-ODD-ACT.                                     42560081
425700     COMPUTE PV-UPDATE-DIF-VRF =                                  42570081
425800             PV-UPDATE-ODD-VRF -                                  42580081
425900             PV-ORIG-ODD-VRF.                                     42590081
426000                                                                  42600081
426100     IF ASC-NOT-POST-VERIFIED-RECEIPT                             42610081
426200         COMPUTE LQW-ACTUAL-TOT-UNTS (LQW-IDX) =                  42620081
426300                 LQW-ACTUAL-TOT-UNTS (LQW-IDX) +                  42630081
426400                 PV-UPDATE-DIF-ACT                                42640081
426500     END-IF.                                                      42650081
426600     COMPUTE LQW-VRFD-TOTAL-UNTS (LQW-IDX) =                      42660081
426700             LQW-VRFD-TOTAL-UNTS (LQW-IDX) +                      42670081
426800             PV-UPDATE-DIF-VRF.                                   42680081
426900                                                                  42690081
427000     MOVE PV-UPDATE-DIF-VRF TO PV-SAVE-ITM-QTY                    42700081
427100                               PV-SUM-ITM-QTY.                    42710081
427200                                                                  42720081
427300     IF  PV-STATUS-CDE     = 'VE'                                 42730081
427400         CONTINUE                                                 42740081
427500     ELSE                                                         42750081
427600         MOVE ZERO TO PV-UPDATE-DIF-VRF                           42760081
427700                      LQW-VRFD-TOTAL-UNTS (LQW-IDX)               42770081
427800     END-IF.                                                      42780081
427900                                                                  42790081
427910                                                                  42791086
427920*** IF STATEMENT COMMENTED OUT.  THIS WOULD NOT ALLOW TO BRING    42792086
427930*** QUANTITY LOWER                                                42793086
427940*** DMH 05/2/16                                                   42794086
428000***  IF ASC-POST-VERIFIED-RECEIPT                                 42800086
428100***      MOVE 0             TO PV-UPDATE-DIF-ACT                  42810086
428200***  END-IF.                                                      42820086
428210                                                                  42821086
428300     PERFORM 5285-SELECT-ODD-REC.                                 42830081
428400     COMPUTE PV-DC-VRFY-ODU-QTY =                                 42840081
428500             RCT00009-DC-VRFY-ODU-QTY + PV-UPDATE-DIF-ACT.        42850081
428600     COMPUTE PV-AP-VRFY-ODU-QTY =                                 42860081
428700             RCT00009-AP-VRFY-ODU-QTY + PV-UPDATE-DIF-VRF.        42870081
428800                                                                  42880081
428900     EXEC SQL                                                     42890081
429000          UPDATE RCT_VRFD_ODD_UNT                                 42900081
429100          SET    DC_VRFY_ODU_QTY     = :PV-DC-VRFY-ODU-QTY        42910081
429200             ,   AP_VRFY_ODU_QTY     = :PV-AP-VRFY-ODU-QTY        42920081
429300          WHERE                                                   42930081
429400                PO_NBR           =  :DK-PO-NBR                    42940081
429500           AND  PO_LNE_NBR       =  :DK-ODD-LNE-NBR               42950081
429600           AND  RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               42960081
429700           AND  STR_NBR          =  :DK-STR-NBR                   42970081
429800     END-EXEC.                                                    42980081
429900                                                                  42990081
430000     EVALUATE TRUE                                                43000081
430100         WHEN SQLCODE = ZERO                                      43010081
430200              SET PS-RCT00009-UPDATE-DONE TO TRUE                 43020081
430300              SET PS-UPDATES-DONE TO TRUE                         43030081
430400         WHEN SQLCODE = +100                                      43040081
430500              PERFORM 5290-INSERT-ODD-REC                         43050081
430600         WHEN SQLCODE = -904                                      43060081
430700         WHEN SQLCODE = -911                                      43070081
430800         WHEN SQLCODE = -913                                      43080081
430900             PERFORM 9900-SOFT-ABORT                              43090081
431000         WHEN SQLWARN0 NOT = SPACE                                43100081
431100         WHEN SQLCODE NOT = ZERO                                  43110081
431200              MOVE '5280-UPDATE-ODD-REC'                          43120081
431300                               TO DP013-PARAGRAPH                 43130081
431400              MOVE 'UPDATE RECEIPT DISTRIBUTION TABLE'            43140081
431500                               TO DP013-MESSAGE-TEXT (1)          43150081
431600              MOVE SQLCA       TO DP013-SQLCA                     43160081
431700              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             43170081
431800              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        43180081
431900              MOVE DK-ODD-LNE-NBR   TO PV-DISP-LNE-NBR            43190081
432000              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            43200081
432100              STRING ' PO = '                                     43210081
432200                     PV-DISP-PO-NBR                               43220081
432300                     ' RECV ='                                    43230081
432400                     PV-DISP-REC-SEQ-NBR                          43240081
432500                     ' LINE ='                                    43250081
432600                     PV-DISP-LNE-NBR                              43260081
432700                     ' STORE = '                                  43270081
432800                     PV-DISP-STR-NBR                              43280081
432900                                         DELIMITED BY SIZE        43290081
433000                              INTO DP013-MESSAGE-TEXT (2)         43300081
433100              MOVE SQLCA        TO DP013-SQLCA                    43310081
433200              MOVE 'RCT00009'   TO DP013-DB2-TABLE-NAME (1)       43320081
433300              SET DP013-DB2-ABEND                                 43330081
433400                               TO TRUE                            43340081
433500              PERFORM DP013-0000-PROCESS-ABEND                    43350081
433600     END-EVALUATE.                                                43360081
433700                                                                  43370081
433800 5285-SELECT-ODD-REC.                                             43380081
433900     EXEC SQL                                                     43390081
434000          SELECT DC_VRFY_ODU_QTY                                  43400081
434100             ,   AP_VRFY_ODU_QTY                                  43410081
434200          INTO   :RCT00009-DC-VRFY-ODU-QTY                        43420081
434300             ,   :RCT00009-AP-VRFY-ODU-QTY                        43430081
434400          FROM   RCT_VRFD_ODD_UNT                                 43440081
434500          WHERE                                                   43450081
434600                PO_NBR           =  :DK-PO-NBR                    43460081
434700           AND  PO_LNE_NBR       =  :DK-ODD-LNE-NBR               43470081
434800           AND  RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               43480081
434900           AND  STR_NBR          =  :DK-STR-NBR                   43490081
435000     END-EXEC.                                                    43500081
435100                                                                  43510081
435200     EVALUATE TRUE                                                43520081
435300         WHEN SQLCODE = ZERO                                      43530081
435400              CONTINUE                                            43540081
435500         WHEN SQLCODE = +100                                      43550081
435600              MOVE 0      TO RCT00009-DC-VRFY-ODU-QTY             43560081
435700                             RCT00009-AP-VRFY-ODU-QTY             43570081
435800              CONTINUE                                            43580081
435900         WHEN SQLWARN0 NOT = SPACE                                43590081
436000         WHEN SQLCODE NOT = ZERO                                  43600081
436100              MOVE '5285-SELECT-ODD-REC'                          43610081
436200                               TO DP013-PARAGRAPH                 43620081
436300              MOVE 'SELECT RECEIPT DISTRIBUTION TABLE'            43630081
436400                               TO DP013-MESSAGE-TEXT (1)          43640081
436500              MOVE SQLCA       TO DP013-SQLCA                     43650081
436600              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             43660081
436700              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        43670081
436800              MOVE DK-ODD-LNE-NBR   TO PV-DISP-LNE-NBR            43680081
436900              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            43690081
437000              STRING ' PO = '                                     43700081
437100                     PV-DISP-PO-NBR                               43710081
437200                     ' RECV ='                                    43720081
437300                     PV-DISP-REC-SEQ-NBR                          43730081
437400                     ' LINE ='                                    43740081
437500                     PV-DISP-LNE-NBR                              43750081
437600                     ' STORE = '                                  43760081
437700                     PV-DISP-STR-NBR                              43770081
437800                                         DELIMITED BY SIZE        43780081
437900                              INTO DP013-MESSAGE-TEXT (2)         43790081
438000              MOVE SQLCA        TO DP013-SQLCA                    43800081
438100              MOVE 'RCT00009'   TO DP013-DB2-TABLE-NAME (1)       43810081
438200              SET DP013-DB2-ABEND                                 43820081
438300                               TO TRUE                            43830081
438400              PERFORM DP013-0000-PROCESS-ABEND                    43840081
438500     END-EVALUATE.                                                43850081
438600                                                                  43860081
438700                                                                  43870081
438800 5290-INSERT-ODD-REC.                                             43880081
438900     EXEC SQL INSERT                                              43890081
439000          INTO  RCT_VRFD_ODD_UNT                                  43900081
439100               (PO_NBR                                            43910081
439200             ,  PO_LNE_NBR                                        43920081
439300             ,  RCVR_SEQ_NBR                                      43930081
439400             ,  STR_NBR                                           43940081
439500             ,  DC_VRFY_ODU_QTY                                   43950081
439600             ,  AP_VRFY_ODU_QTY)                                  43960081
439700          VALUES                                                  43970081
439800               (:DK-PO-NBR                                        43980081
439900             ,  :DK-ODD-LNE-NBR                                   43990081
440000             ,  :DK-REC-SEQ-NBR                                   44000081
440100             ,  :DK-STR-NBR                                       44010081
440200             ,  :PV-UPDATE-DIF-ACT                                44020081
440300             ,  :PV-UPDATE-DIF-VRF)                               44030081
440400     END-EXEC.                                                    44040081
440500                                                                  44050081
440600     EVALUATE TRUE                                                44060081
440700         WHEN SQLCODE = ZERO                                      44070081
440800              SET PS-RCT00009-UPDATE-DONE TO TRUE                 44080081
440900              SET PS-UPDATES-DONE TO TRUE                         44090081
441000         WHEN SQLCODE = -904                                      44100081
441100         WHEN SQLCODE = -911                                      44110081
441200         WHEN SQLCODE = -913                                      44120081
441300             PERFORM 9900-SOFT-ABORT                              44130081
441400         WHEN SQLWARN0 NOT = SPACE                                44140081
441500         WHEN SQLCODE NOT = ZERO                                  44150081
441600              MOVE '5290-INSERT-ODD-REC'                          44160081
441700                               TO DP013-PARAGRAPH                 44170081
441800              MOVE 'INSERT RECEIPT DISTRIBUTION TABLE'            44180081
441900                               TO DP013-MESSAGE-TEXT (1)          44190081
442000              MOVE SQLCA       TO DP013-SQLCA                     44200081
442100              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             44210081
442200              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        44220081
442300              MOVE DK-ODD-LNE-NBR   TO PV-DISP-LNE-NBR            44230081
442400              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            44240081
442500              STRING ' PO = '                                     44250081
442600                     PV-DISP-PO-NBR                               44260081
442700                     ' RECV ='                                    44270081
442800                     PV-DISP-REC-SEQ-NBR                          44280081
442900                     ' LINE ='                                    44290081
443000                     PV-DISP-LNE-NBR                              44300081
443100                     ' STORE = '                                  44310081
443200                     PV-DISP-STR-NBR                              44320081
443300                                         DELIMITED BY SIZE        44330081
443400                              INTO DP013-MESSAGE-TEXT (2)         44340081
443500              MOVE SQLCA        TO DP013-SQLCA                    44350081
443600              MOVE 'RCT00009'   TO DP013-DB2-TABLE-NAME (1)       44360081
443700              SET DP013-DB2-ABEND                                 44370081
443800                               TO TRUE                            44380081
443900              PERFORM DP013-0000-PROCESS-ABEND                    44390081
444000     END-EVALUATE.                                                44400081
444100                                                                  44410081
444200 5300-UPD-RECDIS-AUDIT-BEFORE.                                    44420081
444300                                                                  44430081
444400     EXEC SQL                                                     44440081
444500          SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           44450081
444600     END-EXEC.                                                    44460081
444700     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       44470081
444800     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          44480081
444900     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         44490081
445000     MOVE DK-PO-NBR                TO RC031-PO-NBR.               44500081
445100     MOVE DK-ODD-LNE-NBR           TO RC031-PO-LNE-NBR.           44510081
445200     MOVE DK-REC-SEQ-NBR           TO RC031-REC-SEQ-NBR.          44520081
445300     MOVE DK-OPER-UNT-ID           TO RC031-OPER-UNT-ID.          44530081
445400     MOVE DK-FCLTY-ID              TO RC031-FCLTY-ID.             44540081
445500     MOVE DK-STR-NBR               TO RC031-STR-NBR.              44550081
445600     MOVE DP020-USERID             TO RC031-UPD-UID.              44560081
445700     IF PS-LOG-RCKDP819                                           44570081
445800         MOVE 'RCKDP819'               TO RC031-UPD-PGM-ID        44580081
445900     ELSE                                                         44590081
446000         IF ASC-POST-VERIFIED-RECEIPT                             44600081
446100             MOVE PC-POST-VERIFY-PGM-NAME  TO RC031-UPD-PGM-ID    44610081
446200         ELSE                                                     44620081
446300             MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID    44630081
446400         END-IF                                                   44640081
446500     END-IF.                                                      44650081
446600     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             44660081
446700     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            44670081
446800     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          44680081
446900     EXEC CICS                                                    44690081
447000         LINK PROGRAM  (PC-AUDIT-RTN)                             44700081
447100              COMMAREA (RC031-FIELDS)                             44710081
447200              LENGTH   (PC-AUDIT-RTN-LENGTH)                      44720081
447300     END-EXEC.                                                    44730081
447400     EVALUATE TRUE                                                44740081
447500         WHEN RC031-CALL-SUCCESSFUL                               44750081
447600             CONTINUE                                             44760081
447700                                                                  44770081
447800         WHEN OTHER                                               44780081
447900              MOVE '5300-UPD-RECDIS-AUDIT-BEFORE'                 44790081
448000                                    TO DP013-PARAGRAPH            44800081
448100              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               44810081
448200                                TO DP013-MESSAGE-TEXT (1)         44820081
448300              MOVE RC031-RETURN-DESC                              44830081
448400                                TO DP013-MESSAGE-TEXT (2)         44840081
448500              MOVE RC031-SQLCA      TO DP013-SQLCA                44850081
448600              SET DP013-DB2-ABEND                                 44860081
448700                  DP013-XCTL-DISPLAY-RESTART                      44870081
448800                                    TO TRUE                       44880081
448900              PERFORM DP013-0000-PROCESS-ABEND                    44890081
449000     END-EVALUATE.                                                44900081
449100                                                                  44910081
449200                                                                  44920081
449300 5320-DISOLVE-PACK.                                               44930081
449400                                                                  44940081
449500     MOVE  ASC-PO-NBR              TO PC241-PO-NBR.               44950081
449600     MOVE  DK-ODD-LNE-NBR          TO PC241-PO-LNE-NBR.           44960081
449700     MOVE  ASC-REC-SEQ-NBR         TO PC241-REC-SEQ-NBR.          44970081
449800     MOVE  ASC-OPER-UNT-ID         TO PC241-OPER-UNT-ID.          44980081
449900     MOVE  ASC-FCLTY-ID            TO PC241-FCLTY-ID.             44990081
450000     MOVE  ASC-STR-NBR             TO PC241-STR-NBR.              45000081
450100     MOVE  -1                      TO PC241-STR-ADJ-QTY.          45010081
450200     ADD   1                       TO PV-VRFY-ITEM.               45020081
450300                                                                  45030081
450400     PERFORM 6150-WRITE-VRFY-ADJ-QUEUE.                           45040081
450500                                                                  45050081
450600     PERFORM 8500-PROCESS-UNITS-WORK.                             45060081
450700                                                                  45070081
450800 5350-PROCESS-TROUBLE.                                            45080081
450900     PERFORM 5360-LOOK-FOR-TROUBLE.                               45090081
451000     IF ASC-NO-TRBL-EXISTS                                        45100081
451100          PERFORM 5380-CREATE-TROUBLE-ROW                         45110081
451200          PERFORM 5390-UPDATE-TRB-QUEUE                           45120081
451300     END-IF.                                                      45130081
451400     PERFORM 9600-WRITE-TRB-QUEUE.                                45140081
451500     SET ASC-NO-TSQ-UPDATE                                        45150081
451600         TO TRUE.                                                 45160081
451700                                                                  45170081
451800                                                                  45180081
451900 5360-LOOK-FOR-TROUBLE.                                           45190081
452000      PERFORM 9500-READ-TRB-QUEUE.                                45200081
452100      IF TM003-CYC-ADJ-NBR = 0                                    45210081
452200           SET ASC-NO-TRBL-EXISTS TO TRUE                         45220081
452300      ELSE                                                        45230081
452400          SET LINE-INDEX TO 1                                     45240081
452500          SET PS-NOT-EOT-TRB-TABLE TO TRUE                        45250081
452600          PERFORM 5370-SEARCH-TRB-TABLE                           45260081
452700             UNTIL PS-EOT-TRB-TABLE                               45270081
452800      END-IF.                                                     45280081
452900                                                                  45290081
453000                                                                  45300081
453100 5370-SEARCH-TRB-TABLE.                                           45310081
453200      IF TM003-TBL-LNE-NBR (LINE-INDEX) = DK-ODD-LNE-NBR          45320081
453300           AND TM003-TBL-LNE-UPDATED (LINE-INDEX)                 45330081
453400                 SET ASC-TRBL-EXISTS TO TRUE                      45340081
453500                 MOVE TM003-CYC-ADJ-NBR TO PV-CYC-ADJ-NBR         45350081
453600                                           PV-CYC-ADJ-BEF         45360081
453700                 MOVE TM003-TBL-NOTIF-NBR (LINE-INDEX) TO         45370081
453800                                     PV-NOTIF-NBR                 45380081
453900                                     PV-NOTIF-BEF                 45390081
454000                 SET PS-EOT-TRB-TABLE TO TRUE                     45400081
454100       ELSE                                                       45410081
454200           IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                  45420081
454300               SET ASC-NO-TRBL-EXISTS TO TRUE                     45430081
454400               SET PS-EOT-TRB-TABLE TO TRUE                       45440081
454500     END-IF.                                                      45450081
454600     SET LINE-INDEX UP BY 1.                                      45460081
454700                                                                  45470081
454800                                                                  45480081
454900                                                                  45490081
455000 5380-CREATE-TROUBLE-ROW.                                         45500081
455100     INITIALIZE TM500-FIELDS.                                     45510081
455200     SET TM500-ADD-DETAILS                                        45520081
455300         TM500-CREATE-MANUAL       TO  TRUE.                      45530081
455400                                                                  45540081
455500     MOVE 0                        TO  TM500-NOTIF-NBR.           45550081
455600     MOVE ASC-OPER-UNT-ID          TO  TM500-OPER-UNT-ID.         45560081
455700     MOVE ASC-FCLTY-ID             TO  TM500-FCLTY-ID.            45570081
455800                                                                  45580081
455900     MOVE ASC-PO-NBR               TO  TM500-PO-NBR.              45590081
456000                                                                  45600081
456100     SET TM500-LINE-LEVEL          TO  TRUE.                      45610081
456200     MOVE DK-ODD-LNE-NBR           TO  TM500-PO-LNE-NBR.          45620081
456300                                                                  45630081
456400     MOVE ASC-REC-SEQ-NBR          TO  TM500-REC-SEQ-NBR.         45640081
456500     MOVE TM003-TRBL-RSN-CDE       TO  TM500-TRBL-RSN-CDE.        45650081
456600                                                                  45660081
456700     MOVE DP020-USERID             TO  TM500-CRE-UID              45670081
456800                                       TM500-NOTIF-UID.           45680081
456900                                                                  45690081
457000     IF  TM003-FREEFORM-TEXT = SPACES                             45700081
457100         MOVE '.' TO TM500-FREEFORM-TEXT                          45710081
457200     ELSE                                                         45720081
457300         MOVE TM003-FREEFORM-TEXT  TO  TM500-FREEFORM-TEXT.       45730081
457400                                                                  45740081
457500     PERFORM 5410-LINK-TO-UPDATE.                                 45750081
457600     IF TM500-CALL-SUCCESSFUL         OR                          45760081
457700         TM500-TPURCHS-SELECT-NOT-FND OR                          45770081
457800         TM500-TTRBNTF-UPDATE-NOT-FND OR                          45780081
457900         TM500-DIDNT-ALLOC-DUE-TO-TRBL                            45790081
458000             CONTINUE                                             45800081
458100     ELSE                                                         45810081
458200         IF  TM500-DUPLICATE-TROUBLE                              45820081
458300             SET DP020-MSG-FATAL                                  45830081
458400                 PS-ERROR          TO  TRUE                       45840081
458500             MOVE PC-TRBL-ALREADY-EXISTS-MSG                      45850081
458600                                   TO  DP020-MSG-MESSAGE          45860081
458700         ELSE                                                     45870081
458800             SET PS-ERROR                                         45880081
458900                 DP020-MSG-FATAL           TO  TRUE               45890081
459000             STRING 'NNNNN-E-'                                    45900081
459100                    TM500-RETURN-MSG                              45910081
459200                    '-'                                           45920081
459300                    TM500-RETURN-CODE                             45930081
459400                    ', SQLCODE='                                  45940081
459500                    TM500-SQLCODE DELIMITED BY SIZE               45950081
459600                                 INTO  DP020-MSG-MESSAGE          45960081
459700         END-IF                                                   45970081
459800     END-IF.                                                      45980081
459900                                                                  45990081
460000 5390-UPDATE-TRB-QUEUE.                                           46000081
460100     SET TM003-UPDATE TO TRUE.                                    46010081
460200     IF TM003-CYC-ADJ-NBR = 0                                     46020081
460300         MOVE TM500-NOTIF-NBR TO TM003-CYC-ADJ-NBR                46030081
460400                                     PV-CYC-ADJ-NBR               46040081
460500         MOVE  0                 TO PV-CYC-ADJ-BEF                46050081
460600         MOVE  0                 TO PV-NOTIF-BEF                  46060081
460700     ELSE                                                         46070081
460800         MOVE TM003-CYC-ADJ-NBR TO                                46080081
460900                                     PV-CYC-ADJ-NBR               46090081
461000     END-IF.                                                      46100081
461100     SET LINE-INDEX TO 1.                                         46110081
461200     SET PS-TABLE-NOT-LOADED TO TRUE.                             46120081
461300     PERFORM 5400-LOAD-QUEUE-TBL                                  46130081
461400        UNTIL PS-TABLE-LOADED.                                    46140081
461500                                                                  46150081
461600 5400-LOAD-QUEUE-TBL.                                             46160081
461700     IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                        46170081
461800        MOVE TM500-PO-LNE-NBR TO TM003-TBL-LNE-NBR (LINE-INDEX)   46180081
461900        MOVE TM500-NOTIF-NBR TO TM003-TBL-NOTIF-NBR (LINE-INDEX)  46190081
462000                                PV-NOTIF-NBR                      46200081
462100        SET TM003-TBL-LNE-UPDATED (LINE-INDEX) TO TRUE            46210081
462200        SET PS-TABLE-LOADED TO TRUE                               46220081
462300     ELSE                                                         46230081
462400        SET LINE-INDEX UP BY 1                                    46240081
462500     END-IF.                                                      46250081
462600                                                                  46260081
462700 5410-LINK-TO-UPDATE.                                             46270081
462800                                                                  46280081
462900     EXEC CICS LINK                                               46290081
463000          PROGRAM (PC-TMKCS520)                                   46300081
463100          COMMAREA(TM500-FIELDS)                                  46310081
463200          RESP    (PV-CICS-RESP)                                  46320081
463300     END-EXEC.                                                    46330081
463400                                                                  46340081
463500     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   46350081
463600         SET DP013-LOGIC-ABEND                                    46360081
463700             DP013-NO-ROLLBACK     TO TRUE                        46370081
463800         MOVE '5410-LINK-TO-UPDATE'                               46380081
463900                                   TO DP013-PARAGRAPH             46390081
464000         MOVE 'ATTEMPTING TO LINK TO CENTRAL PROCESSING'          46400081
464100                                   TO DP013-MESSAGE-TEXT (1)      46410081
464200         PERFORM DP013-0000-PROCESS-ABEND                         46420081
464300     END-IF.                                                      46430081
464400                                                                  46440081
464500                                                                  46450081
464600 5400-SELECT-TRECDIS.                                             46460081
464700     MOVE 0   TO RECDIS-VERIFY-ITM-QTY                            46470081
464800                 RECDIS-AP-VERIFY-ITM-QTY.                        46480081
464900                                                                  46490081
465000     EXEC SQL                                                     46500081
465100          SELECT                                                  46510081
465200                 A.VERIFY_ITM_QTY                                 46520081
465300              ,  A.AP_VERIFY_ITM_QTY                              46530081
465400          INTO                                                    46540081
465500                :RECDIS-VERIFY-ITM-QTY                            46550081
465600              , :RECDIS-AP-VERIFY-ITM-QTY                         46560081
465700          FROM                                                    46570081
465800                 TRECDIS A                                        46580081
465900          WHERE                                                   46590081
466000                A.ORD_NBR          =  :DK-PO-NBR                  46600081
466100           AND  A.ORD_LNE_NBR      =  :DK-ODD-LNE-NBR             46610081
466200           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             46620081
466300           AND  A.FCLTY_ID         =  :DK-FCLTY-ID                46630081
466400           AND  A.OPER_UNT_ID      =  :DK-OPER-UNT-ID             46640081
466600           AND  A.STR_NBR          =  :DK-STR-NBR                 46660081
466700     END-EXEC.                                                    46670081
466800                                                                  46680081
466900     EVALUATE TRUE                                                46690081
467000         WHEN SQLCODE = ZERO                                      46700081
467100              CONTINUE                                            46710081
467200         WHEN SQLCODE = +100                                      46720081
467300             SET PS-RECDIS-NOT-FOUND TO TRUE                      46730081
467400         WHEN SQLCODE = -904                                      46740081
467500         WHEN SQLCODE = -911                                      46750081
467600         WHEN SQLCODE = -913                                      46760081
467700             PERFORM 9900-SOFT-ABORT                              46770081
467800         WHEN SQLWARN0 NOT = SPACE                                46780081
467900         WHEN SQLCODE NOT = ZERO                                  46790081
468000              MOVE '5400-SELECT-TRECDIS'                          46800081
468100                               TO DP013-PARAGRAPH                 46810081
468200              MOVE 'GET TRECDIS ROW'                              46820081
468300                               TO DP013-MESSAGE-TEXT (1)          46830081
468400              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             46840081
468500              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        46850081
468600              MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID        46860081
468700              MOVE DK-FCLTY-ID      TO PV-DISP-FCLTY-ID           46870081
468800              MOVE DK-STR-NBR       TO PV-DISP-STR-NBR            46880081
468900              STRING ' PO = '                                     46890081
469000                     PV-DISP-PO-NBR                               46900081
469100                     ' RECV ='                                    46910081
469200                     PV-DISP-REC-SEQ-NBR                          46920081
469300                     ' STR = '                                    46930081
469400                     PV-DISP-STR-NBR                              46940081
469500                     ' OPER ='                                    46950081
469600                     PV-DISP-OPER-UNT-ID                          46960081
469700                     ' FCLTY ='                                   46970081
469800                     PV-DISP-OPER-UNT-ID                          46980081
469900                                         DELIMITED BY SIZE        46990081
470000                              INTO DP013-MESSAGE-TEXT (2)         47000081
470100              MOVE SQLCA        TO DP013-SQLCA                    47010081
470200              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        47020081
470300              MOVE SQLCA       TO DP013-SQLCA                     47030081
470400              SET DP013-DB2-ABEND                                 47040081
470500                               TO TRUE                            47050081
470600              PERFORM DP013-0000-PROCESS-ABEND                    47060081
470700     END-EVALUATE.                                                47070081
470800                                                                  47080081
470900 5460-SELECT-TDISTHD.                                             47090081
471000                                                                  47100081
471100                                                                  47110081
471200     EXEC SQL                                                     47120081
471300          SELECT                                                  47130081
471400                TOT_CART_CNT,                                     47140081
471500                FCSE_CART_CNT,                                    47150081
471600                P2L_CART_CNT,                                     47160081
471700                INPK_CART_CNT                                     47170081
471800          INTO                                                    47180081
471900                :DISTHD-TOT-CART-CNT,                             47190081
472000                :DISTHD-FCSE-CART-CNT,                            47200081
472100                :DISTHD-P2L-CART-CNT,                             47210081
472200                :DISTHD-INPK-CART-CNT                             47220081
472300          FROM                                                    47230081
472400                TDISTHD                                           47240081
472500          WHERE                                                   47250081
472600                ORD_NBR          =  :DK-PO-NBR                    47260081
472700          AND   ORD_LNE_NBR      =  :DK-HOLD-LNE-NBR              47270081
472800          AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               47280081
472900     END-EXEC.                                                    47290081
473000                                                                  47300081
473100     EVALUATE TRUE                                                47310081
473200         WHEN SQLCODE = ZERO                                      47320081
473300              SET PS-TDISTHD-FOUND TO TRUE                        47330081
473400         WHEN SQLCODE = +100                                      47340081
473500              SET PS-NO-TDISTHD-FOUND TO TRUE                     47350081
473600         WHEN SQLCODE = -904                                      47360081
473700         WHEN SQLCODE = -911                                      47370081
473800         WHEN SQLCODE = -913                                      47380081
473900             PERFORM 9900-SOFT-ABORT                              47390081
474000         WHEN SQLWARN0 NOT = SPACE                                47400081
474100         WHEN SQLCODE NOT = ZERO                                  47410081
474200              MOVE '5460-SELECT-TDISTHD'                          47420081
474300                               TO DP013-PARAGRAPH                 47430081
474400              MOVE 'GET TDISTHD ROW'                              47440081
474500                               TO DP013-MESSAGE-TEXT (1)          47450081
474600              MOVE DK-PO-NBR        TO PV-DISP-PO-NBR             47460081
474700              MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR        47470081
474800              MOVE DK-HOLD-LNE-NBR  TO PV-DISP-LNE-NBR            47480081
474900              STRING ' PO = '                                     47490081
475000                     PV-DISP-PO-NBR                               47500081
475100                     ' RECV ='                                    47510081
475200                     PV-DISP-REC-SEQ-NBR                          47520081
475300                     ' LINE ='                                    47530081
475400                     PV-DISP-LNE-NBR                              47540081
475500                                         DELIMITED BY SIZE        47550081
475600                              INTO DP013-MESSAGE-TEXT (2)         47560081
475700              MOVE SQLCA        TO DP013-SQLCA                    47570081
475800              MOVE 'TDISTHD '  TO DP013-DB2-TABLE-NAME (1)        47580081
475900              MOVE SQLCA       TO DP013-SQLCA                     47590081
476000              SET DP013-DB2-ABEND                                 47600081
476100                               TO TRUE                            47610081
476200              PERFORM DP013-0000-PROCESS-ABEND                    47620081
476300     END-EVALUATE.                                                47630081
476400 EJECT                                                            47640081
476500                                                                  47650081
476600 5515-ADD-TO-RECD-AUDIT-AFTER.                                    47660081
476700                                                                  47670081
476800     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       47680081
476900     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          47690081
477000     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         47700081
477100     MOVE DK-PO-NBR                TO RC031-PO-NBR.               47710081
477200     MOVE DK-ODD-LNE-NBR           TO RC031-PO-LNE-NBR.           47720081
477300     MOVE DK-REC-SEQ-NBR           TO RC031-REC-SEQ-NBR.          47730081
477400     MOVE DK-OPER-UNT-ID           TO RC031-OPER-UNT-ID.          47740081
477500     MOVE DK-FCLTY-ID              TO RC031-FCLTY-ID.             47750081
477600     MOVE DK-STR-NBR               TO RC031-STR-NBR.              47760081
477700     MOVE DP020-USERID             TO RC031-UPD-UID.              47770081
477800     IF ASC-POST-VERIFIED-RECEIPT                                 47780081
477900         MOVE PC-POST-VERIFY-PGM-NAME  TO RC031-UPD-PGM-ID        47790081
478000     ELSE                                                         47800081
478100         MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID        47810081
478200     END-IF.                                                      47820081
478300     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             47830081
478400     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            47840081
478500     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          47850081
478600     EXEC CICS                                                    47860081
478700         LINK PROGRAM  (PC-AUDIT-RTN)                             47870081
478800              COMMAREA (RC031-FIELDS)                             47880081
478900              LENGTH   (PC-AUDIT-RTN-LENGTH)                      47890081
479000     END-EXEC.                                                    47900081
479100     EVALUATE TRUE                                                47910081
479200         WHEN RC031-CALL-SUCCESSFUL                               47920081
479300             CONTINUE                                             47930081
479400                                                                  47940081
479500         WHEN OTHER                                               47950081
479600              MOVE '5515-ADD-TO-RECD-AUDIT-AFTER'                 47960081
479700                                    TO DP013-PARAGRAPH            47970081
479800              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               47980081
479900                                TO DP013-MESSAGE-TEXT (1)         47990081
480000              MOVE RC031-RETURN-DESC                              48000081
480100                                TO DP013-MESSAGE-TEXT (2)         48010081
480200              MOVE RC031-SQLCA      TO DP013-SQLCA                48020081
480300              SET DP013-DB2-ABEND                                 48030081
480400                  DP013-XCTL-DISPLAY-RESTART                      48040081
480500                                    TO TRUE                       48050081
480600              PERFORM DP013-0000-PROCESS-ABEND                    48060081
480700     END-EVALUATE.                                                48070081
480800                                                                  48080081
480900 5800-CHECK-PO-STATUS.                                            48090081
481000                                                                  48100081
481100     PERFORM 7000-GET-PO-INFO.                                    48110081
481200     PERFORM 7220-GET-RECDIS-QTY.                                 48120081
481300                                                                  48130081
481400     IF (PV-PURITM-UNT-QTY GREATER PV-RECDIS-AP-VERIFY-ITM-QTY    48140081
481500     AND PV-PURITM-STATUS-CDE EQUAL 'CM')                         48150081
481600         MOVE 'AC'                TO  PV-PURITM-STATUS-CDE        48160081
481700         PERFORM 5830-UPDATE-PURITM-STATUS                        48170081
481800         IF  PV-PURCHS-STATUS-CDE EQUAL 'CM'                      48180081
481900             MOVE 'AC'            TO  PV-PURCHS-STATUS-CDE        48190081
482000         END-IF                                                   48200081
482100     ELSE                                                         48210081
482200         IF (PV-PURITM-UNT-QTY NOT > PV-RECDIS-AP-VERIFY-ITM-QTY  48220081
482300         AND PV-PURITM-STATUS-CDE NOT EQUAL 'CM')                 48230081
482400             MOVE 'CM'            TO  PV-PURITM-STATUS-CDE        48240081
482500             PERFORM 5830-UPDATE-PURITM-STATUS                    48250081
482600             IF  PV-PURCHS-STATUS-CDE NOT EQUAL 'CM'              48260081
482700                 MOVE 'CM'        TO  PV-PURCHS-STATUS-CDE        48270081
482800             END-IF                                               48280081
482900         END-IF                                                   48290081
483000     END-IF.                                                      48300081
483100                                                                  48310081
483200 5830-UPDATE-PURITM-STATUS.                                       48320081
483300                                                                  48330081
483400     PERFORM 7500-GET-PURITM.                                     48340081
483500     IF  SQLCODE EQUAL ZERO                                       48350081
483600     AND PURITM-STATUS-CDE NOT = 'RV'                             48360081
483700         IF PV-PURITM-STATUS-CDE = 'AC'                           48370081
483800             MOVE ASC-DEPT-NBR      TO PV-DEPT-NBR-X              48380081
483900             MOVE PV-DEPT-NBR       TO PV-DEPT-NBR-KEY            48390081
484000             SET PS-NO-RMS-PO       TO TRUE                       48400081
484100*** CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO      48410081
484200*** VERSION THE TPURITM ROWS; WE JUST WANT TO UPDATE THE ROW.     48420081
484300             PERFORM 7650-CHECK-FOR-RMS-PO                        48430081
484400             IF PV-DB2-COUNT > ZERO                               48440081
484500                 SET PS-RMS-PO      TO TRUE                       48450081
484600                 PERFORM 7530-ONLY-UPDATE-PURITM                  48460081
484700             ELSE                                                 48470081
484800                 PERFORM 7510-UPDATE-PURITM                       48480081
484900                 ADD 1              TO  PURITM-VER-NBR            48490081
485000                 PERFORM 7520-INSERT-PURITM                       48500081
485100             END-IF                                               48510081
485200          ELSE                                                    48520081
485300             PERFORM 7530-ONLY-UPDATE-PURITM                      48530081
485400          END-IF                                                  48540081
485500     END-IF.                                                      48550081
485600                                                                  48560081
485700                                                                  48570081
485800                                                                  48580081
485900*----------------------------------------------------------------*48590081
486000* INSERT WORK ORDER                                              *48600081
486100* ADDED DMH 01/19/16                                             *48610081
486200*----------------------------------------------------------------*48620081
486300 5900-INSERT-TWRKORD.                                             48630081
486400                                                                  48640081
486500     PERFORM                                                      48650081
486600         WITH TEST AFTER                                          48660081
486700         VARYING PV-RETRY-COUNTER                                 48670081
486800         FROM 1 BY 1                                              48680081
486900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48690081
487000             OR (SQLCODE = +0))                                   48700081
487100                                                                  48710081
487200         EXEC SQL                                                 48720081
487300              INSERT INTO TWRKORD                                 48730081
487400                     ( ORD_NBR                                    48740081
487500                      ,RCVR_SEQ_NBR                               48750081
487600                      ,ORD_LNE_NBR                                48760081
487700                      ,WORK_ORD_SEQ_NBR                           48770081
487800                      ,OPER_UNT_ID                                48780081
487900                      ,FCLTY_ID                                   48790081
488000                      ,CRE_TMST                                   48800081
488100                      ,VER_STATUS_CDE                             48810081
488200                      ,CRE_UID_ID                                 48820081
488300                      ,EXPTED_CART_CNT                            48830081
488400                      ,ACTL_CART_CNT                              48840081
488500                      ,EXPTED_ITM_CNT                             48850081
488600                      ,ACTL_ITM_CNT                               48860081
488700                      ,STAT_CDE                                   48870081
488800                      ,WORK_ORD_DISTR_IND                         48880081
488900                      ,OPER_SET_ID )                              48890081
489000              VALUES ( :WRKORD-ORD-NBR                            48900081
489100                      ,:WRKORD-RCVR-SEQ-NBR                       48910081
489200                      ,:WRKORD-ORD-LNE-NBR                        48920081
489300                      ,:WRKORD-WORK-ORD-SEQ-NBR                   48930081
489400                      ,:WRKORD-OPER-UNT-ID                        48940081
489500                      ,:WRKORD-FCLTY-ID                           48950081
489600                      ,CURRENT TIMESTAMP                          48960081
489700                      ,:WRKORD-VER-STATUS-CDE                     48970081
489800                      ,:DP020-USERID                              48980081
489900                      ,:WRKORD-EXPTED-CART-CNT                    48990081
490000                      ,:WRKORD-ACTL-CART-CNT                      49000081
490100                      ,:WRKORD-EXPTED-ITM-CNT                     49010081
490200                      ,:WRKORD-ACTL-ITM-CNT                       49020081
490300                      ,:WRKORD-STAT-CDE                           49030081
490400                      ,:WRKORD-WORK-ORD-DISTR-IND                 49040081
490500                      ,:WRKORD-OPER-SET-ID )                      49050081
490600         END-EXEC                                                 49060081
490700                                                                  49070081
490800         EVALUATE TRUE                                            49080081
490900             WHEN SQLCODE = +0                                    49090081
491000             WHEN SQLCODE = -904                                  49100081
491100             WHEN SQLCODE = -913                                  49110081
491200                 CONTINUE                                         49120081
491300                                                                  49130081
491400             WHEN SQLWARN0 NOT = SPACE                            49140081
491500             WHEN SQLCODE < +0                                    49150081
491600             WHEN SQLCODE > +0                                    49160081
491700                 MOVE WRKORD-ORD-NBR  TO PV-DISP-PO-NBR           49170081
491800                 MOVE WRKORD-RCVR-SEQ-NBR                         49180081
491900                                      TO PV-DISP-REC-SEQ-NBR      49190081
492000                 MOVE WRKORD-ORD-LNE-NBR                          49200081
492100                                      TO PV-DISP-LNE-NBR          49210081
492200                 MOVE WRKORD-OPER-UNT-ID                          49220081
492300                                      TO PV-DISP-OPER-UNT-ID      49230081
492400                 MOVE WRKORD-FCLTY-ID TO PV-DISP-FCLTY-ID         49240081
492500                 MOVE SQLCODE TO PV-DISP-SQLCODE                  49250081
492600                 STRING                                           49260081
492700                      ' 5900- SQL = '                             49270081
492800                      PV-DISP-SQLCODE                             49280081
492900                      ' PO= '                                     49290081
493000                      PV-DISP-PO-NBR                              49300081
493100                      ' SEQ= '                                    49310081
493200                      PV-DISP-REC-SEQ-NBR                         49320081
493300                      ' LINE= '                                   49330081
493400                      PV-DISP-LNE-NBR                             49340081
493500                      ' OPER= '                                   49350081
493600                      PV-DISP-OPER-UNT-ID                         49360081
493700                      ' FCLTY= '                                  49370081
493800                      PV-DISP-FCLTY-ID                            49380081
493900                                 DELIMITED BY SIZE                49390081
494000                               INTO DP013-MESSAGE-TEXT (1)        49400081
494100                 MOVE ' 5900-INSERT-TWRKORD  '                    49410081
494200                                  TO DP013-PARAGRAPH              49420081
494300                 MOVE SQLCA       TO DP013-SQLCA                  49430081
494400                 SET DP013-DB2-ABEND                              49440081
494500                     DP013-XCTL-DISPLAY-RESTART                   49450081
494600                                  TO TRUE                         49460081
494700                 PERFORM DP013-0000-PROCESS-ABEND                 49470081
494800         END-EVALUATE                                             49480081
494900     END-PERFORM.                                                 49490081
495000                                                                  49500081
495100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49510081
495200             AND (SQLCODE NOT = +0)                               49520081
495300         MOVE WRKORD-ORD-NBR  TO PV-DISP-PO-NBR                   49530081
495400         MOVE WRKORD-RCVR-SEQ-NBR                                 49540081
495500                              TO PV-DISP-REC-SEQ-NBR              49550081
495600         MOVE WRKORD-ORD-LNE-NBR                                  49560081
495700                              TO PV-DISP-LNE-NBR                  49570081
495800         MOVE WRKORD-OPER-UNT-ID                                  49580081
495900                              TO PV-DISP-OPER-UNT-ID              49590081
496000         MOVE WRKORD-FCLTY-ID TO PV-DISP-FCLTY-ID                 49600081
496100         MOVE SQLCODE TO PV-DISP-SQLCODE                          49610081
496200         STRING                                                   49620081
496300              ' 5900- SQL = '                                     49630081
496400              PV-DISP-SQLCODE                                     49640081
496500              ' PO= '                                             49650081
496600              PV-DISP-PO-NBR                                      49660081
496700              ' SEQ= '                                            49670081
496800              PV-DISP-REC-SEQ-NBR                                 49680081
496900              ' LINE= '                                           49690081
497000              PV-DISP-LNE-NBR                                     49700081
497100              ' OPER= '                                           49710081
497200              PV-DISP-OPER-UNT-ID                                 49720081
497300              ' FCLTY= '                                          49730081
497400              PV-DISP-FCLTY-ID                                    49740081
497500                         DELIMITED BY SIZE                        49750081
497600                               INTO DP013-MESSAGE-TEXT (1)        49760081
497700                 MOVE ' 5900-INSERT-TWRKORD  '                    49770081
497800                                  TO DP013-PARAGRAPH              49780081
497900                 MOVE SQLCA       TO DP013-SQLCA                  49790081
498000                 SET DP013-DB2-ABEND                              49800081
498100                     DP013-XCTL-DISPLAY-RESTART                   49810081
498200                                  TO TRUE                         49820081
498300                 PERFORM DP013-0000-PROCESS-ABEND                 49830081
498400     END-IF.                                                      49840081
498500                                                                  49850081
498600                                                                  49860081
498700*----------------------------------------------------------------*49870081
498800* OPEN WORK ORDER INSTRUCTION CURSOR                             *49880081
498900* ADDED DMH 01/19/16                                             *49890081
499000*----------------------------------------------------------------*49900081
499100 5910-OPEN-TOSOPFA-CSR.                                           49910081
499200                                                                  49920081
499300     EXEC SQL                                                     49930081
499400          DECLARE TOSOPFA-CSR CURSOR FOR                          49940081
499500           SELECT OPER_SET_ID                                     49950081
499600                 ,OPER_ID                                         49960081
499700                 ,OPER_UNT_ID                                     49970081
499800                 ,FCLTY_ID                                        49980081
499900                 ,FCLTY_AREA_ID                                   49990081
500000                 ,PRC_FCLTY_AREA_ID                               50000081
500100                 ,SCRN_SEQ_NBR                                    50010081
500200           FROM   TOSOPFA                                         50020081
500300           WHERE  OPER_SET_ID    = :WRKORD-OPER-SET-ID            50030081
500400             AND  OPER_UNT_ID    = :RECEIV-CURR-OPER-UNT-ID       50040081
500500             AND  FCLTY_ID       =  1                             50050081
500600             AND  VER_STATUS_CDE = 'A'                            50060081
500700           ORDER BY SCRN_SEQ_NBR                                  50070081
500800     END-EXEC.                                                    50080081
500900                                                                  50090081
501000     PERFORM                                                      50100081
501100         WITH TEST AFTER                                          50110081
501200         VARYING PV-RETRY-COUNTER                                 50120081
501300         FROM 1 BY 1                                              50130081
501400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50140081
501500            OR (SQLCODE = +0))                                    50150081
501600                                                                  50160081
501700         EXEC SQL                                                 50170081
501800              OPEN TOSOPFA-CSR                                    50180081
501900         END-EXEC                                                 50190081
502000                                                                  50200081
502100         EVALUATE TRUE                                            50210081
502200             WHEN SQLCODE = +0                                    50220081
502300                  CONTINUE                                        50230081
502400             WHEN SQLCODE = -904                                  50240081
502500             WHEN SQLCODE = -913                                  50250081
502600                  CONTINUE                                        50260081
502700             WHEN SQLWARN0 NOT = SPACE                            50270081
502800             WHEN SQLCODE  NOT = +0                               50280081
502900                 MOVE WRKORD-OPER-SET-ID TO PV-DISP-OPER-SET      50290081
503000                 MOVE SQLCODE TO PV-DISP-SQLCODE                  50300081
503100                 STRING                                           50310081
503200                      ' 5910- SQL = '                             50320081
503300                      PV-DISP-SQLCODE                             50330081
503400                      ' OPER SET = '                              50340081
503500                      PV-DISP-OPER-SET                            50350081
503600                                 DELIMITED BY SIZE                50360081
503700                               INTO DP013-MESSAGE-TEXT (1)        50370081
503800                 MOVE ' 5910-OPEN-TOSOPFA-CSR'                    50380081
503900                                  TO DP013-PARAGRAPH              50390081
504000                 MOVE SQLCA       TO DP013-SQLCA                  50400081
504100                 SET DP013-DB2-ABEND                              50410081
504200                     DP013-XCTL-DISPLAY-RESTART                   50420081
504210                                  TO TRUE                         50421081
504220                 PERFORM DP013-0000-PROCESS-ABEND                 50422081
504230         END-EVALUATE                                             50423081
504240     END-PERFORM.                                                 50424081
504250                                                                  50425081
504260     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50426081
504270             AND (SQLCODE NOT = +0)                               50427081
504271         MOVE WRKORD-OPER-SET-ID TO PV-DISP-OPER-SET              50427181
504272         MOVE SQLCODE TO PV-DISP-SQLCODE                          50427281
504273         STRING                                                   50427381
504274              ' 5910- SQL = '                                     50427481
504275              PV-DISP-SQLCODE                                     50427581
504276              ' OPER SET = '                                      50427681
504277              PV-DISP-OPER-SET                                    50427781
504278                         DELIMITED BY SIZE                        50427881
504279                               INTO DP013-MESSAGE-TEXT (1)        50427981
504280                 MOVE ' 5910-OPEN-TOSOPFA-CSR'                    50428081
504281                                  TO DP013-PARAGRAPH              50428181
504282                 MOVE SQLCA       TO DP013-SQLCA                  50428281
504283                 SET DP013-DB2-ABEND                              50428381
504284                     DP013-XCTL-DISPLAY-RESTART                   50428481
504285                                  TO TRUE                         50428581
504286                 PERFORM DP013-0000-PROCESS-ABEND                 50428681
504287     END-IF.                                                      50428781
504288                                                                  50428881
504289                                                                  50428981
504290*----------------------------------------------------------------*50429081
504291*    FETCH A TOSOPFA ROW                                         *50429181
504292* DMH ADDED 1/19/16                                              *50429281
504293*----------------------------------------------------------------*50429381
504294 5930-FETCH-TOSOPFA-CSR.                                          50429481
504295                                                                  50429581
504296     EXEC SQL                                                     50429681
504297          FETCH TOSOPFA-CSR                                       50429781
504298          INTO :OSOPFA-OPER-SET-ID                                50429881
504299              ,:OSOPFA-OPER-ID                                    50429981
504300              ,:OSOPFA-OPER-UNT-ID                                50430081
504301              ,:OSOPFA-FCLTY-ID                                   50430181
504302              ,:OSOPFA-FCLTY-AREA-ID                              50430281
504303              ,:OSOPFA-PRC-FCLTY-AREA-ID                          50430381
504304              ,:OSOPFA-SCRN-SEQ-NBR                               50430481
504305     END-EXEC                                                     50430581
504306                                                                  50430681
504307     EVALUATE TRUE                                                50430781
504308         WHEN SQLCODE = +0                                        50430881
504309              CONTINUE                                            50430981
504310                                                                  50431081
504311         WHEN SQLCODE = +100                                      50431181
504312              SET ASC-EOF-TOSOPFA-CSR TO TRUE                     50431281
504313                                                                  50431381
504314         WHEN SQLWARN0 NOT = SPACE                                50431481
504315         WHEN SQLCODE < +0                                        50431581
504316         WHEN SQLCODE > +0                                        50431681
504317             MOVE WRKORD-OPER-SET-ID TO PV-DISP-OPER-SET          50431781
504318             MOVE SQLCODE TO PV-DISP-SQLCODE                      50431881
504319             STRING                                               50431981
504320                  ' 5930- SQL = '                                 50432081
504321                  PV-DISP-SQLCODE                                 50432181
504322                  ' OPER SET = '                                  50432281
504323                  PV-DISP-OPER-SET                                50432381
504324                             DELIMITED BY SIZE                    50432481
504325                               INTO DP013-MESSAGE-TEXT (1)        50432581
504326                 MOVE ' 5930-FETCH-TOSOPFA-CSR'                   50432681
504327                                  TO DP013-PARAGRAPH              50432781
504328                 MOVE SQLCA       TO DP013-SQLCA                  50432881
504329                 SET DP013-DB2-ABEND                              50432981
504330                     DP013-XCTL-DISPLAY-RESTART                   50433081
504331                                  TO TRUE                         50433181
504332                 PERFORM DP013-0000-PROCESS-ABEND                 50433281
504333     END-EVALUATE.                                                50433381
504334                                                                  50433481
504335                                                                  50433581
504336*----------------------------------------------------------------*50433681
504337* CLOSE THE TOSOPFA CURSOR                                       *50433781
504338* DMH ADDED 1/19/16                                              *50433881
504339*----------------------------------------------------------------*50433981
504340 5940-CLOSE-TOSOPFA-CSR.                                          50434081
504341                                                                  50434181
504342     EXEC SQL                                                     50434281
504343          CLOSE TOSOPFA-CSR                                       50434381
504344     END-EXEC                                                     50434481
504345                                                                  50434581
504346     EVALUATE TRUE                                                50434681
504347         WHEN SQLCODE = +0                                        50434781
504348              CONTINUE                                            50434881
504349         WHEN SQLWARN0 NOT = SPACE                                50434981
504350         WHEN SQLCODE  NOT = +0                                   50435081
504351             MOVE WRKORD-OPER-SET-ID  TO PV-DISP-OPER-SET         50435181
504352             MOVE SQLCODE TO PV-DISP-SQLCODE                      50435281
504353             STRING                                               50435381
504354                  ' 5940- SQL = '                                 50435481
504355                  PV-DISP-SQLCODE                                 50435581
504356                  ' OPER SET = '                                  50435681
504357                  PV-DISP-OPER-SET                                50435781
504358                             DELIMITED BY SIZE                    50435881
504359                               INTO DP013-MESSAGE-TEXT (1)        50435981
504360                 MOVE ' 5940-CLOSE-TOSOPFA-CSR'                   50436081
504361                                  TO DP013-PARAGRAPH              50436181
504362                 MOVE SQLCA       TO DP013-SQLCA                  50436281
504363                 SET DP013-DB2-ABEND                              50436381
504364                     DP013-XCTL-DISPLAY-RESTART                   50436481
504365                                  TO TRUE                         50436581
504366                 PERFORM DP013-0000-PROCESS-ABEND                 50436681
504367     END-EVALUATE.                                                50436781
504368                                                                  50436881
504369                                                                  50436981
504370*----------------------------------------------------------------*50437081
504371* BUILD WORK ORDER INSTRUCTION                                   *50437181
504372* DMH ADDED 1/19/16                                              *50437281
504373*----------------------------------------------------------------*50437381
504374 5950-BUILD-WORK-ORDER-INSTR.                                     50437481
504375                                                                  50437581
504376     INITIALIZE DCLTWKORIN.                                       50437681
504377                                                                  50437781
504378     MOVE DK-PO-NBR              TO WKORIN-ORD-NBR.               50437881
504379     MOVE DK-REC-SEQ-NBR         TO WKORIN-RCVR-SEQ-NBR.          50437981
504380     MOVE +1                     TO WKORIN-WORK-ORD-SEQ-NBR.      50438081
504381     ADD +1                      TO PV-WO-INSTR-SEQ-NBR.          50438181
504382     MOVE PV-WO-INSTR-SEQ-NBR    TO WKORIN-WO-INSTR-SEQ-NBR.      50438281
504383     MOVE 'A'                    TO WKORIN-VER-STATUS-CDE.        50438381
504384     MOVE WRKORD-OPER-UNT-ID     TO WKORIN-OPER-UNT-ID.           50438481
504385     MOVE 1                      TO WKORIN-FCLTY-ID.              50438581
504386     MOVE OSOPFA-OPER-ID         TO WKORIN-OPER-ID.               50438681
504387     MOVE OSOPFA-FCLTY-AREA-ID   TO WKORIN-FCLTY-AREA-ID.         50438781
504388     MOVE OSOPFA-PRC-FCLTY-AREA-ID                                50438881
504389                                 TO WKORIN-PRC-FCLTY-AREA-ID.     50438981
504390     MOVE OSOPFA-SCRN-SEQ-NBR    TO WKORIN-SCREEN-SEQ-NBR.        50439081
504391     MOVE 'N'                    TO ASC-INSTRUCTION-SW.           50439181
504392     MOVE 1                      TO WKORIN-EXPTED-CART-CNT.       50439281
504393     MOVE ZERO                   TO WKORIN-ACTL-CART-CNT.         50439381
504394     MOVE 'N'                    TO WKORIN-ALLOC-IND              50439481
504395                                    WKORIN-REPACK-IND.            50439581
504396     MOVE '9999-09-09-09.09.09.000000'                            50439681
504397                                 TO WKORIN-STRT-TMST              50439781
504398                                    WKORIN-STOP-TMST.             50439881
504399                                                                  50439981
504400     PERFORM 5960-INSERT-TWKORIN.                                 50440081
504401                                                                  50440181
504402                                                                  50440281
504403*----------------------------------------------------------------*50440381
504404* INSERT WORK ORDER INSTRUCTION                                  *50440481
504405* DMH ADDED 1/19/16                                              *50440581
504406*----------------------------------------------------------------*50440681
504407 5960-INSERT-TWKORIN.                                             50440781
504408                                                                  50440881
504409     PERFORM                                                      50440981
504410         WITH TEST AFTER                                          50441081
504411         VARYING PV-RETRY-COUNTER                                 50441181
504412         FROM 1 BY 1                                              50441281
504413         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50441381
504414             OR (SQLCODE = +0))                                   50441481
504415                                                                  50441581
504416         EXEC SQL                                                 50441681
504417              INSERT INTO TWKORIN                                 50441781
504418                     ( ORD_NBR                                    50441881
504419                      ,RCVR_SEQ_NBR                               50441981
504420                      ,ORD_LNE_NBR                                50442081
504421                      ,WORK_ORD_SEQ_NBR                           50442181
504422                      ,OPER_UNT_ID                                50442281
504423                      ,FCLTY_ID                                   50442381
504424                      ,WO_INSTR_SEQ_NBR                           50442481
504425                      ,CRE_TMST                                   50442581
504426                      ,VER_STATUS_CDE                             50442681
504427                      ,CRE_UID_ID                                 50442781
504428                      ,OPER_ID                                    50442881
504429                      ,FCLTY_AREA_ID                              50442981
504430                      ,PRC_FCLTY_AREA_ID                          50443081
504431                      ,EXPTED_CART_CNT                            50443181
504432                      ,ACTL_CART_CNT                              50443281
504433                      ,ALLOC_IND                                  50443381
504434                      ,REPACK_IND                                 50443481
504435                      ,STRT_TMST                                  50443581
504436                      ,STOP_TMST                                  50443681
504437                      ,SCREEN_SEQ_NBR                             50443781
504438                      ,LNE_LOC_CDE                                50443881
504439                      ,REC_SEL_IND )                              50443981
504440              VALUES ( :WKORIN-ORD-NBR                            50444081
504441                      ,:WKORIN-RCVR-SEQ-NBR                       50444181
504442                      ,:WKORIN-ORD-LNE-NBR                        50444281
504443                      ,:WKORIN-WORK-ORD-SEQ-NBR                   50444381
504444                      ,:WKORIN-OPER-UNT-ID                        50444481
504445                      ,:WKORIN-FCLTY-ID                           50444581
504446                      ,:WKORIN-WO-INSTR-SEQ-NBR                   50444681
504447                      ,CURRENT TIMESTAMP                          50444781
504448                      ,:WKORIN-VER-STATUS-CDE                     50444881
504449                      ,:DP020-USERID                              50444981
504450                      ,:WKORIN-OPER-ID                            50445081
504451                      ,:WKORIN-FCLTY-AREA-ID                      50445181
504452                      ,:WKORIN-PRC-FCLTY-AREA-ID                  50445281
504453                      ,:WKORIN-EXPTED-CART-CNT                    50445381
504454                      ,:WKORIN-ACTL-CART-CNT                      50445481
504455                      ,:WKORIN-ALLOC-IND                          50445581
504456                      ,:WKORIN-REPACK-IND                         50445681
504457                      ,:WKORIN-STRT-TMST                          50445781
504458                      ,:WKORIN-STOP-TMST                          50445881
504459                      ,:WKORIN-SCREEN-SEQ-NBR                     50445981
504460                      ,:WKORIN-LNE-LOC-CDE                        50446081
504461                      ,:WKORIN-REC-SEL-IND )                      50446181
504462         END-EXEC                                                 50446281
504463                                                                  50446381
504464         EVALUATE TRUE                                            50446481
504465             WHEN SQLCODE = +0                                    50446581
504466                  SET  ASC-HAS-WORK-ORDER-INST TO  TRUE           50446681
504467                                                                  50446781
504468             WHEN SQLCODE = -904                                  50446881
504469             WHEN SQLCODE = -913                                  50446981
504470                 CONTINUE                                         50447081
504471                                                                  50447181
504472             WHEN SQLWARN0 NOT = SPACE                            50447281
504473             WHEN SQLCODE < +0                                    50447381
504474             WHEN SQLCODE > +0                                    50447481
504475                 MOVE WKORIN-ORD-NBR      TO PV-DISP-PO-NBR       50447581
504476                 MOVE WKORIN-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ-NBR  50447681
504477                 MOVE WKORIN-ORD-LNE-NBR  TO PV-DISP-LNE-NBR      50447781
504478                 MOVE WKORIN-WORK-ORD-SEQ-NBR                     50447881
504479                                      TO PV-DISP-WO-SEQ-NBR       50447981
504480                 MOVE WKORIN-WO-INSTR-SEQ-NBR                     50448081
504481                                      TO PV-DISP-WO-INSTR-SEQ-NBR 50448181
504482                 MOVE SQLCODE TO PV-DISP-SQLCODE                  50448281
504483                 STRING                                           50448381
504484                      ' 5940- SQL = '                             50448481
504485                      PV-DISP-SQLCODE                             50448581
504486                      ' PO= '                                     50448681
504487                      PV-DISP-PO-NBR                              50448781
504488                      ' '                                         50448881
504489                      PV-DISP-REC-SEQ-NBR                         50448981
504490                      ' '                                         50449081
504491                      PV-DISP-LNE-NBR                             50449181
504492                      ' '                                         50449281
504493                      PV-DISP-WO-SEQ-NBR                          50449381
504494                      ' '                                         50449481
504495                      PV-DISP-WO-INSTR-SEQ-NBR                    50449581
504496                                 DELIMITED BY SIZE                50449681
504497                               INTO DP013-MESSAGE-TEXT (1)        50449781
504498                 MOVE ' 5960-INSERT-TWKORIN'                      50449881
504499                                  TO DP013-PARAGRAPH              50449981
504500                 MOVE SQLCA       TO DP013-SQLCA                  50450081
504501                 SET DP013-DB2-ABEND                              50450181
504502                     DP013-XCTL-DISPLAY-RESTART                   50450281
504503                                  TO TRUE                         50450381
504504                 PERFORM DP013-0000-PROCESS-ABEND                 50450481
504505         END-EVALUATE                                             50450581
504506     END-PERFORM.                                                 50450681
504507                                                                  50450781
504508     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50450881
504509             AND (SQLCODE NOT = +0)                               50450981
504510         STRING                                                   50451081
504511              '5940-INSERT-TWKORIN '                              50451181
504512              'MAX RETRIES EXCEEDED ON INSERT ON TWKORIN'         50451281
504513                                 DELIMITED BY SIZE                50451381
504514                               INTO DP013-MESSAGE-TEXT (1)        50451481
504515                 MOVE ' 5960-INSERT-TWKORIN'                      50451581
504516                                  TO DP013-PARAGRAPH              50451681
504517                 MOVE SQLCA       TO DP013-SQLCA                  50451781
504518                 SET DP013-DB2-ABEND                              50451881
504519                     DP013-XCTL-DISPLAY-RESTART                   50451981
504520                                  TO TRUE                         50452081
504521                 PERFORM DP013-0000-PROCESS-ABEND                 50452181
504522     END-IF.                                                      50452281
504523                                                                  50452381
504524                                                                  50452481
504525******************************************************************50452581
504526** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **50452681
504527** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **50452781
504528** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **50452881
504529** THE USER.                                                    **50452981
504530******************************************************************50453081
504540 6000-REFRESH-PANEL-FROM-TEMP.                                    50454081
504550     IF  ASC-UPDATE-TSQ                                           50455081
504560         SET ASC-NO-TSQ-UPDATE TO TRUE                            50456081
504570         MOVE ZERO                 TO PV-SAVE-ITEM                50457081
504580                                      PV-SEL-QUEUE-ITEM           50458081
504590         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        50459081
504600                                   TO PV-HOLD-SELECTED-ITEMS      50460081
504700         MOVE +1                   TO PV-ITEMS-PROCESSED          50470081
504800         PERFORM 6100-UPDATE-TSQ                                  50480081
504900             UNTIL PV-ITEMS-PROCESSED >                           50490081
505000                                     PV-HOLD-SELECTED-ITEMS       50500081
505100         PERFORM 6010-DELETE-SEL-QUEUE                            50510081
505200         INITIALIZE ASC-BLOCK-ENTRIES (1)                         50520081
505300                    ASC-BLOCK-ENTRIES (2)                         50530081
505400     END-IF.                                                      50540081
505500                                                                  50550081
505600*----------------------------------------------------------------*50560081
505700*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *50570081
505800*----------------------------------------------------------------*50580081
505900 6010-DELETE-SEL-QUEUE.                                           50590081
506000                                                                  50600081
506100     EXEC CICS                                                    50610081
506200         DELETEQ TS                                               50620081
506300             QUEUE (ASC-SEL-QUEUE-NAME)                           50630081
506400             RESP  (PV-CICS-RESP)                                 50640081
506500     END-EXEC.                                                    50650081
506600*                                                                 50660081
506700     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      50670081
506800        (PV-CICS-RESP = DFHRESP(QIDERR)))                         50680081
506900         CONTINUE                                                 50690081
507000     ELSE                                                         50700081
507100         SET DP013-CICS-ABEND TO TRUE                             50710081
507200         SET DP013-NO-ROLLBACK TO TRUE                            50720081
507300         MOVE '6010-DELETE-SEL-QUEUE'                             50730081
507400                        TO DP013-PARAGRAPH                        50740081
507500         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         50750081
507600                        TO DP013-MESSAGE-TEXT (1)                 50760081
507700         PERFORM DP013-0000-PROCESS-ABEND                         50770081
507800     END-IF.                                                      50780081
507900                                                                  50790081
508000*----------------------------------------------------------------*50800081
508100*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *50810081
508200*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *50820081
508300*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *50830081
508400*    THE TEMP QUEUE.                                             *50840081
508500*----------------------------------------------------------------*50850081
508600                                                                  50860081
508700 6100-UPDATE-TSQ.                                                 50870081
508800                                                                  50880081
508900     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             50890081
509000     PERFORM 6105-READ-SEL-QUEUE.                                 50900081
509100     PERFORM                                                      50910081
509200         VARYING RC801-IDX                                        50920081
509300         FROM 1 BY 1                                              50930081
509400         UNTIL ((PV-ITEMS-PROCESSED >                             50940081
509500                              PV-HOLD-SELECTED-ITEMS)             50950081
509600         OR (RC801-IDX GREATER THAN RC801-MAX-ITEMS))             50960081
509700         IF  RC801-ACTION-SW (RC801-IDX) > SPACE                  50970081
509800             PERFORM 6110-PROCESS-ITEMS                           50980081
509900         END-IF                                                   50990081
510000         ADD +1                TO PV-ITEMS-PROCESSED              51000081
510100     END-PERFORM.                                                 51010081
510200     PERFORM 6111-WRITE-LIST-QUEUE.                               51020081
510300*----------------------------------------------------------------*51030081
510400*    READ THE LIST QUEUE RECORD.                                 *51040081
510500*----------------------------------------------------------------*51050081
510600                                                                  51060081
510700 6105-READ-SEL-QUEUE.                                             51070081
510800                                                                  51080081
510900     EXEC CICS                                                    51090081
511000          READQ TS                                                51100081
511100              QUEUE (ASC-SEL-QUEUE-NAME)                          51110081
511200              INTO  (RC801-PREPACK-SELECT-RECORD)                 51120081
511300              ITEM  (PV-SEL-QUEUE-ITEM)                           51130081
511400              RESP  (PV-CICS-RESP)                                51140081
511500     END-EXEC.                                                    51150081
511600*                                                                 51160081
511700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51170081
511800         CONTINUE                                                 51180081
511900     ELSE                                                         51190081
512000         SET DP013-CICS-ABEND      TO  TRUE                       51200081
512100         SET DP013-NO-ROLLBACK     TO  TRUE                       51210081
512200         MOVE '6105-READ-SEL-QUEUE'                               51220081
512300                                   TO  DP013-PARAGRAPH            51230081
512400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           51240081
512500                                   TO  DP013-MESSAGE-TEXT(1)      51250081
512600         PERFORM DP013-0000-PROCESS-ABEND                         51260081
512700     END-IF.                                                      51270081
512800 EJECT                                                            51280081
512900*----------------------------------------------------------------*51290081
513000*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*51300081
513100*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*51310081
513200*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *51320081
513300*----------------------------------------------------------------*51330081
513400                                                                  51340081
513500 6110-PROCESS-ITEMS.                                              51350081
513600                                                                  51360081
513700     COMPUTE PV-ITEM = 1 + ((RC801-ITEM (RC801-IDX) - 1)          51370081
513800                     / PC-ITEMS-PER-PANEL).                       51380081
513900                                                                  51390081
514000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           51400081
514100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          51410081
514200             PERFORM 6111-WRITE-LIST-QUEUE                        51420081
514300         END-IF                                                   51430081
514400         MOVE PV-ITEM          TO PV-SAVE-ITEM                    51440081
514500                                                                  51450081
514600         PERFORM 6112-READ-LIST-QUEUE                             51460081
514700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               51470081
514800             CONTINUE                                             51480081
514900         END-IF                                                   51490081
515000     END-IF.                                                      51500081
515100                                                                  51510081
515200     COMPUTE PV-SUB = (RC801-ITEM (RC801-IDX)                     51520081
515300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              51530081
515400     SET LQW-DESELECT (PV-SUB) TO    TRUE                         51540081
515500     MOVE LQW-SELECTED-SW (PV-SUB)                                51550081
515600                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  51560081
515700     EVALUATE TRUE                                                51570081
515800         WHEN RC801-INQ (RC801-IDX)                               51580081
515900              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             51590081
516000                                                                  51600081
516100         WHEN RC801-UPD (RC801-IDX)                               51610081
516200              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             51620081
516300                                                                  51630081
516400         WHEN RC801-DEL (RC801-IDX)                               51640081
516500              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             51650081
516600                                                                  51660081
516700         WHEN RC801-ERR (RC801-IDX)                               51670081
516800              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             51680081
516900     END-EVALUATE.                                                51690081
517000                                                                  51700081
517100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                51710081
517200                                                                  51720081
517300*----------------------------------------------------------------*51730081
517400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *51740081
517500*----------------------------------------------------------------*51750081
517600                                                                  51760081
517700 6111-WRITE-LIST-QUEUE.                                           51770081
517800                                                                  51780081
517900     EXEC CICS                                                    51790081
518000         WRITEQ TS                                                51800081
518100             QUEUE (ASC-LIST-QUEUE-NAME)                          51810081
518200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     51820081
518300             ITEM  (PV-SAVE-ITEM)                                 51830081
518400             REWRITE                                              51840081
518500             RESP  (PV-CICS-RESP)                                 51850081
518600     END-EXEC.                                                    51860081
518700*                                                                 51870081
518800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51880081
518900         CONTINUE                                                 51890081
519000     ELSE                                                         51900081
519100         SET DP013-CICS-ABEND  TO  TRUE                           51910081
519200         SET DP013-NO-ROLLBACK TO  TRUE                           51920081
519300         MOVE '6111-WRITE-LIST-QUEUE'                             51930081
519400                               TO  DP013-PARAGRAPH                51940081
519500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  51950081
519600                               TO  DP013-MESSAGE-TEXT(1)          51960081
519700         PERFORM DP013-0000-PROCESS-ABEND                         51970081
519800     END-IF.                                                      51980081
519900                                                                  51990081
520000 EJECT                                                            52000081
520100*----------------------------------------------------------------*52010081
520200*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*52020081
520300*----------------------------------------------------------------*52030081
520400                                                                  52040081
520500 6112-READ-LIST-QUEUE.                                            52050081
520600                                                                  52060081
520700     EXEC CICS                                                    52070081
520800         READQ TS                                                 52080081
520900             QUEUE (ASC-LIST-QUEUE-NAME)                          52090081
521000             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     52100081
521100             ITEM  (PV-ITEM)                                      52110081
521200             RESP  (PV-CICS-RESP)                                 52120081
521300     END-EXEC.                                                    52130081
521400*                                                                 52140081
521500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          52150081
521600         CONTINUE                                                 52160081
521700     ELSE                                                         52170081
521800         SET DP013-CICS-ABEND        TO TRUE                      52180081
521900         SET DP013-NO-ROLLBACK       TO TRUE                      52190081
522000         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           52200081
522100         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    52210081
522200                                     TO DP013-MESSAGE-TEXT(1)     52220081
522300         PERFORM DP013-0000-PROCESS-ABEND                         52230081
522400     END-IF.                                                      52240081
522500                                                                  52250081
522600******************************************************************52260081
522700* WRITE ENTRIES TO VERIFY ADJUSTMENT QUEUE                       *52270081
522800******************************************************************52280081
522900 6150-WRITE-VRFY-ADJ-QUEUE.                                       52290081
523000                                                                  52300081
523100     EXEC CICS WRITEQ TS                                          52310081
523200               QUEUE (ASC-VRFY-ADJ-QUEUE-NAME)                    52320081
523300               FROM  (PC241-FIELDS)                               52330081
523400               ITEM  (PV-VRFY-ITEM)                               52340081
523500               RESP  (PV-CICS-RESP)                               52350081
523600     END-EXEC.                                                    52360081
523700                                                                  52370081
523800     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       52380081
523900         SET DP013-CICS-ABEND                                     52390081
524000             DP013-NO-ROLLBACK   TO TRUE                          52400081
524100         MOVE '6150-WRITE-VRFY-ADJ-QUEUE'                         52410081
524200                                 TO DP013-PARAGRAPH               52420081
524300         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE'        52430081
524400                                 TO DP013-MESSAGE-TEXT(1)         52440081
524500         PERFORM DP013-0000-PROCESS-ABEND                         52450081
524600     END-IF.                                                      52460081
524700                                                                  52470081
524800 7000-GET-PO-INFO.                                                52480081
524900                                                                  52490081
525000     EXEC SQL                                                     52500081
525100          SELECT A.DEPT_NBR                                       52510081
525200               , A.STATUS_CDE                                     52520081
525300            INTO :PURCHS-DEPT-NBR                                 52530081
525400               , :PV-PURCHS-STATUS-CDE                            52540081
525500            FROM TPURCHS A                                        52550081
525600           WHERE A.VER_STATUS_CDE     = 'A'                       52560081
525700             AND A.PO_NBR             = :DK-PO-NBR                52570081
525800     END-EXEC                                                     52580081
525900                                                                  52590081
526000     EVALUATE TRUE                                                52600081
526100         WHEN SQLCODE = ZERO                                      52610081
526200             CONTINUE                                             52620081
526300         WHEN SQLCODE = +100                                      52630081
526400            MOVE  SPACES TO PURCHS-DEPT-NBR                       52640081
526500                            PV-PURCHS-STATUS-CDE                  52650081
526600         WHEN SQLCODE = -904                                      52660081
526700         WHEN SQLCODE = -911                                      52670081
526800         WHEN SQLCODE = -913                                      52680081
526900             PERFORM 9900-SOFT-ABORT                              52690081
527000         WHEN SQLWARN0 NOT = SPACES                               52700081
527100         WHEN SQLCODE      NOT = ZERO                             52710081
527200             MOVE '7000-GET-PO-INFO'                              52720081
527300                             TO DP013-PARAGRAPH                   52730081
527400             MOVE 'UNSUCCESSFUL SELECT OF DEPT, STATUS'           52740081
527500                             TO DP013-MESSAGE-TEXT (1)            52750081
527600             MOVE SQLCA         TO DP013-SQLCA                    52760081
527700             MOVE 'TPURCHS' TO DP013-DB2-TABLE-NAME (1)           52770081
527800             MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                   52780081
527900             MOVE SQLCA       TO DP013-SQLCA                      52790081
528000             STRING ' PO = '                                      52800081
528100                    PV-DISP-PO-NBR                                52810081
528200                                        DELIMITED BY SIZE         52820081
528300                             INTO DP013-MESSAGE-TEXT (2)          52830081
528400             SET DP013-DB2-ABEND                                  52840081
528500                  DP013-XCTL-DISPLAY-RESTART                      52850081
528600                             TO TRUE                              52860081
528700             PERFORM DP013-0000-PROCESS-ABEND                     52870081
528800     END-EVALUATE.                                                52880081
528900                                                                  52890081
529000                                                                  52900081
529100 7020-SELECT-PURITM-DATA.                                         52910081
529200                                                                  52920081
529300     EXEC SQL                                                     52930081
529400           SELECT PO_LNE_NBR                                      52940081
529500                , STATUS_CDE                                      52950081
529600                , UNT_QTY                                         52960081
529700             INTO :PURITM-PO-LNE-NBR                              52970081
529800                , :PV-PURITM-STATUS-CDE                           52980081
529900                , :PV-PURITM-UNT-QTY                              52990081
530000             FROM TPURITM                                         53000081
530100            WHERE PO_NBR         = :DK-PO-NBR                     53010081
530200              AND APP_PO_LNE_NBR = :DK-LNE-NBR                    53020081
530300              AND VER_STATUS_CDE = 'A'                            53030081
530400     END-EXEC.                                                    53040081
530500                                                                  53050081
530600     EVALUATE TRUE                                                53060081
530700         WHEN SQLCODE = ZERO                                      53070081
530800              CONTINUE                                            53080081
530900         WHEN SQLCODE = -904                                      53090081
531000         WHEN SQLCODE = -911                                      53100081
531100         WHEN SQLCODE = -913                                      53110081
531200             PERFORM 9900-SOFT-ABORT                              53120081
531300         WHEN SQLWARN0 NOT = SPACE                                53130081
531400         WHEN SQLCODE NOT = ZERO                                  53140081
531500              MOVE '7020-SELECT-PURITM-DATA'                      53150081
531600                               TO DP013-PARAGRAPH                 53160081
531700              MOVE 'SELECT TPURITM DATA'                          53170081
531800                               TO DP013-MESSAGE-TEXT (1)          53180081
531900              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        53190081
532000              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  53200081
532100              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 53210081
532200              MOVE SQLCA       TO DP013-SQLCA                     53220081
532300              STRING ' PO = '                                     53230081
532400                     PV-DISP-PO-NBR                               53240081
532500                     ' LINE ='                                    53250081
532600                     PV-DISP-LNE-NBR                              53260081
532700                                         DELIMITED BY SIZE        53270081
532800                              INTO DP013-MESSAGE-TEXT (2)         53280081
532900              SET DP013-DB2-ABEND                                 53290081
533000                               TO TRUE                            53300081
533100              PERFORM DP013-0000-PROCESS-ABEND                    53310081
533200     END-EVALUATE.                                                53320081
533300                                                                  53330081
533400 7220-GET-RECDIS-QTY.                                             53340081
533500                                                                  53350081
533600     EXEC SQL                                                     53360081
533700          SELECT                                                  53370081
533800                 SUM(C.AP_VERIFY_ITM_QTY)                         53380081
533900           INTO                                                   53390081
534000                 :PV-RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND        53400081
534100           FROM                                                   53410081
534200                 TRECEIV A                                        53420081
534300               , TRECITM B                                        53430081
534400               , TRECDIS C                                        53440081
534500           WHERE                                                  53450081
534600                 A.ORD_NBR         =  :DK-PO-NBR                  53460081
534700            AND  A.ORD_NBR         =  B.ORD_NBR                   53470081
534800            AND  A.ORD_NBR         =  C.ORD_NBR                   53480081
534900            AND  B.ORD_LNE_NBR     =  :DK-LNE-NBR                 53490081
535000            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               53500081
535100            AND  A.VER_STATUS_CDE  =  'A'                         53510081
535200            AND  B.VER_STATUS_CDE  =  'A'                         53520081
535400            AND  B.STATUS_CDE      =  'VE'                        53540081
535500            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               53550081
535600            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               53560081
535700     END-EXEC.                                                    53570081
535800                                                                  53580081
535900     EVALUATE TRUE                                                53590081
536000         WHEN SQLCODE = ZERO                                      53600081
536100         WHEN SQLCODE = +100                                      53610081
536200              CONTINUE                                            53620081
536300         WHEN SQLCODE = -904                                      53630081
536400         WHEN SQLCODE = -911                                      53640081
536500         WHEN SQLCODE = -913                                      53650081
536600             PERFORM 9900-SOFT-ABORT                              53660081
536700         WHEN SQLWARN0 NOT = SPACE                                53670081
536800         WHEN SQLCODE NOT = ZERO                                  53680081
536900              MOVE '7220-GET-RECDIS-QTY'                          53690081
537000                               TO DP013-PARAGRAPH                 53700081
537100              MOVE 'SUM RECDIS VERIFY QUANTITY'                   53710081
537200                               TO DP013-MESSAGE-TEXT (1)          53720081
537300              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        53730081
537400              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  53740081
537500              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 53750081
537600              MOVE SQLCA       TO DP013-SQLCA                     53760081
537700              STRING ' PO = '                                     53770081
537800                     PV-DISP-PO-NBR                               53780081
537900                     ' LINE ='                                    53790081
538000                     PV-DISP-LNE-NBR                              53800081
538100                                         DELIMITED BY SIZE        53810081
538200                              INTO DP013-MESSAGE-TEXT (2)         53820081
538300              SET DP013-DB2-ABEND                                 53830081
538400                               TO TRUE                            53840081
538500              PERFORM DP013-0000-PROCESS-ABEND                    53850081
538600     END-EVALUATE.                                                53860081
538700                                                                  53870081
538800                                                                  53880081
538900 7055-GET-TDISTHD.                                                53890081
539000                                                                  53900081
539100     SET ASC-ACTL-NOT-CONFIRMED TO TRUE.                          53910081
539200                                                                  53920081
539300     MOVE ASC-PO-NBR                TO DK-PO-NBR.                 53930081
539400     MOVE ASC-REC-SEQ-NBR           TO DK-REC-SEQ-NBR.            53940081
539500     MOVE ASC-DRIVER-LNE-NBR        TO DK-PO-DRIVER-LNE.          53950081
539600                                                                  53960081
539700     EXEC SQL                                                     53970081
539800          SELECT                                                  53980081
539900                   FCSE_CNFRMN_TMST                               53990081
540000                ,  TOT_CART_CNT                                   54000081
540100                ,  VRFD_TMST                                      54010081
540200            INTO                                                  54020081
540300                  :DISTHD-FCSE-CNFRMN-TMST                        54030081
540400                , :DISTHD-TOT-CART-CNT                            54040081
540500                , :DISTHD-VRFD-TMST                               54050081
540600            FROM                                                  54060081
540700                  TDISTHD                                         54070081
540800            WHERE                                                 54080081
540900                  ORD_NBR          = :DK-PO-NBR                   54090081
541000              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              54100081
541100              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            54110081
541200     END-EXEC.                                                    54120081
541300                                                                  54130081
541400     EVALUATE TRUE                                                54140081
541500         WHEN SQLCODE = ZERO                                      54150081
541600              IF  DISTHD-FCSE-CNFRMN-TMST = PC-DB2-DEFAULT-TMST   54160081
541700                  CONTINUE                                        54170081
541800              ELSE                                                54180081
541900                  SET ASC-ACTL-CONFIRMED TO TRUE                  54190081
542000              END-IF                                              54200081
542100              IF DISTHD-VRFD-TMST = PC-DB2-DEFAULT-TMST AND       54210081
542200                 DISTHD-TOT-CART-CNT > 0                          54220081
542300                  SET ASC-UPDATE-NOT-ALLOWED  TO TRUE             54230081
542400              END-IF                                              54240081
542500         WHEN SQLCODE = +100                                      54250081
542600              CONTINUE                                            54260081
542700         WHEN SQLCODE = -904                                      54270081
542800         WHEN SQLCODE = -911                                      54280081
542900         WHEN SQLCODE = -913                                      54290081
543000             PERFORM 9900-SOFT-ABORT                              54300081
543100         WHEN SQLWARN0 NOT = SPACES                               54310081
543200         WHEN SQLCODE  NOT = ZERO                                 54320081
543300             MOVE '7055-GET-TDISTHD'                              54330081
543400                                 TO DP013-PARAGRAPH               54340081
543500             MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'                54350081
543600                                 TO DP013-MESSAGE-TEXT (1)        54360081
543700             MOVE SQLCA         TO DP013-SQLCA                    54370081
543800             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              54380081
543900             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         54390081
544000             MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR             54400081
544100             STRING ' PO = '                                      54410081
544200                    PV-DISP-PO-NBR                                54420081
544300                    ' RECV ='                                     54430081
544400                    PV-DISP-REC-SEQ-NBR                           54440081
544500                    ' LINE = '                                    54450081
544600                    PV-DISP-LNE-NBR                               54460081
544700                                        DELIMITED BY SIZE         54470081
544800                             INTO DP013-MESSAGE-TEXT (2)          54480081
544900             MOVE SQLCA        TO DP013-SQLCA                     54490081
545000             MOVE 'TDISTHD'     TO DP013-DB2-TABLE-NAME (1)       54500081
545100             SET DP013-DB2-ABEND                                  54510081
545200                 DP013-XCTL-DISPLAY-RESTART                       54520081
545300                                 TO TRUE                          54530081
545400                                                                  54540081
545500             PERFORM DP013-0000-PROCESS-ABEND                     54550081
545600     END-EVALUATE.                                                54560081
545700                                                                  54570081
545800 7060-GET-TDISTDT.                                                54580081
545900                                                                  54590081
546000                                                                  54600081
546100     MOVE ASC-PO-NBR             TO  DK-PO-NBR.                   54610081
546200     MOVE ASC-REC-SEQ-NBR        TO  DK-REC-SEQ-NBR.              54620081
546300                                                                  54630081
546400     EXEC SQL                                                     54640081
546500          SELECT                                                  54650081
546600                  ACTL_ALLOC_QTY                                  54660081
546700                , P2L_SPLT_UNT_QTY                                54670081
546800                , FCSE_SPLT_UNT_QTY                               54680081
546900                , INPK_SPLT_UNT_QTY                               54690081
547000                , FCSE_ACTL_UNT_QTY                               54700081
547100            INTO                                                  54710081
547200                  :DISTDT-ACTL-ALLOC-QTY                          54720081
547300                , :DISTDT-P2L-SPLT-UNT-QTY                        54730081
547400                , :DISTDT-FCSE-SPLT-UNT-QTY                       54740081
547500                , :DISTDT-INPK-SPLT-UNT-QTY                       54750081
547600                , :DISTDT-FCSE-ACTL-UNT-QTY                       54760081
547700            FROM                                                  54770081
547800                  TDISTDT                                         54780081
547900            WHERE                                                 54790081
548000                  ORD_NBR          = :DK-PO-NBR                   54800081
548100              AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR              54810081
548200              AND ORD_LNE_NBR      = :DK-PO-DRIVER-LNE            54820081
548300              AND STR_NBR          = :DK-STR-NBR                  54830081
548400     END-EXEC.                                                    54840081
548500                                                                  54850081
548600     EVALUATE TRUE                                                54860081
548700         WHEN SQLCODE = ZERO                                      54870081
548800         WHEN SQLCODE = +100                                      54880081
548900              CONTINUE                                            54890081
549000         WHEN SQLCODE = -904                                      54900081
549100         WHEN SQLCODE = -911                                      54910081
549200         WHEN SQLCODE = -913                                      54920081
549300             PERFORM 9900-SOFT-ABORT                              54930081
549400         WHEN SQLWARN0 NOT = SPACES                               54940081
549500         WHEN SQLCODE  NOT = ZERO                                 54950081
549600             MOVE '7060-GET-TDISTDT'                              54960081
549700                                 TO DP013-PARAGRAPH               54970081
549800             MOVE 'UNSUCCESSFUL SELECT OF TDISTDT'                54980081
549900                                 TO DP013-MESSAGE-TEXT (1)        54990081
550000             MOVE SQLCA         TO DP013-SQLCA                    55000081
550100             MOVE DK-PO-NBR        TO PV-DISP-PO-NBR              55010081
550200             MOVE DK-REC-SEQ-NBR   TO PV-DISP-REC-SEQ-NBR         55020081
550300             MOVE DK-PO-DRIVER-LNE TO PV-DISP-LNE-NBR             55030081
550400             MOVE DK-STR-NBR       TO PV-DISP-STR-NBR             55040081
550500             STRING ' PO = '                                      55050081
550600                    PV-DISP-PO-NBR                                55060081
550700                    ' RECV ='                                     55070081
550800                    PV-DISP-REC-SEQ-NBR                           55080081
550900                    ' LINE = '                                    55090081
551000                    PV-DISP-LNE-NBR                               55100081
551100                    ' STR = '                                     55110081
551200                    PV-DISP-STR-NBR                               55120081
551300                                        DELIMITED BY SIZE         55130081
551400                             INTO DP013-MESSAGE-TEXT (2)          55140081
551500             MOVE SQLCA        TO DP013-SQLCA                     55150081
551600             MOVE 'TDISTDT'     TO DP013-DB2-TABLE-NAME (1)       55160081
551700             SET DP013-DB2-ABEND                                  55170081
551800                 DP013-XCTL-DISPLAY-RESTART                       55180081
551900                                 TO TRUE                          55190081
552000                                                                  55200081
552100             PERFORM DP013-0000-PROCESS-ABEND                     55210081
552200     END-EVALUATE.                                                55220081
552300                                                                  55230081
552400 7500-GET-PURITM.                                                 55240081
552500                                                                  55250081
552600     EXEC SQL                                                     55260081
552700          SELECT                                                  55270081
552800                  PO_NBR                                          55280081
552900                , VER_NBR                                         55290081
553000                , PO_LNE_NBR                                      55300081
553100                , VER_STATUS_CDE                                  55310081
553200                , SKU_SEQ_NBR                                     55320081
553300                , CL_NBR                                          55330081
553400                , VEND_STYL_NAME                                  55340081
553500                , COLOR_DESC                                      55350081
553600                , SIZE_DESC                                       55360081
553700                , UM_IND                                          55370081
553800                , UNT_QTY                                         55380081
553900                , UNT_RTL_PR_AMT                                  55390081
554000                , UNT_COST_AMT                                    55400081
554100                , TOT_VAL_COST_AMT                                55410081
554200                , TOT_VAL_RTL_AMT                                 55420081
554300                , MU_PCT                                          55430081
554400                , CRE_TMST                                        55440081
554500                , LAST_UPD_TMST                                   55450081
554600                , ITM_NBR                                         55460081
554700                , SKU_DESC                                        55470081
554800                , COLOR_CDE                                       55480081
554900                , SIZE_CDE                                        55490081
555000                , AD_EVNT_DTE                                     55500081
555100                , STATUS_CDE                                      55510081
555200                , CRE_BY_UID                                      55520081
555300                , LAST_UPD_BY_UID                                 55530081
555400                , GP_RTL_AMT                                      55540081
555500                , GP_QTY                                          55550081
555600                , APP_PO_LNE_NBR                                  55560081
555700                , PIC_ITM_IND                                     55570081
555800                , PIC_PG_NBR                                      55580081
555900                , PRD_1ST_COST_AMT                                55590081
556000                , PO_PREPK_ID                                     55600081
556100                , PREPK_RATO_QTY                                  55610081
556200                , SHIP_TO_TMP_DC_IND                              55620081
556300                , RMS_PO_SKU_NBR                                  55630081
556400                , CNCLD_UNT_QTY                                   55640081
556500           INTO                                                   55650081
556600                  :PURITM-PO-NBR                                  55660081
556700                , :PURITM-VER-NBR                                 55670081
556800                , :PURITM-PO-LNE-NBR                              55680081
556900                , :PURITM-VER-STATUS-CDE                          55690081
557000                , :PURITM-SKU-SEQ-NBR                             55700081
557100                , :PURITM-CL-NBR                                  55710081
557200                , :PURITM-VEND-STYL-NAME                          55720081
557300                , :PURITM-COLOR-DESC                              55730081
557400                , :PURITM-SIZE-DESC                               55740081
557500                , :PURITM-UM-IND                                  55750081
557600                , :PURITM-UNT-QTY                                 55760081
557700                , :PURITM-UNT-RTL-PR-AMT                          55770081
557800                , :PURITM-UNT-COST-AMT                            55780081
557900                , :PURITM-TOT-VAL-COST-AMT                        55790081
558000                , :PURITM-TOT-VAL-RTL-AMT                         55800081
558100                , :PURITM-MU-PCT                                  55810081
558200                , :PURITM-CRE-TMST                                55820081
558300                , :PURITM-LAST-UPD-TMST                           55830081
558400                , :PURITM-ITM-NBR                                 55840081
558500                , :PURITM-SKU-DESC                                55850081
558600                , :PURITM-COLOR-CDE                               55860081
558700                , :PURITM-SIZE-CDE                                55870081
558800                , :PURITM-AD-EVNT-DTE                             55880081
558900                , :PURITM-STATUS-CDE                              55890081
559000                , :PURITM-CRE-BY-UID                              55900081
559100                , :PURITM-LAST-UPD-BY-UID                         55910081
559200                , :PURITM-GP-RTL-AMT                              55920081
559300                , :PURITM-GP-QTY                                  55930081
559400                , :PURITM-APP-PO-LNE-NBR                          55940081
559500                , :PURITM-PIC-ITM-IND                             55950081
559600                , :PURITM-PIC-PG-NBR                              55960081
559700                , :PURITM-PRD-1ST-COST-AMT                        55970081
559800                , :PURITM-PO-PREPK-ID                             55980081
559900                , :PURITM-PREPK-RATO-QTY                          55990081
560000                , :PURITM-SHIP-TO-TMP-DC-IND                      56000081
560100                , :PURITM-RMS-PO-SKU-NBR                          56010081
560200                , :PURITM-CNCLD-UNT-QTY                           56020081
560300           FROM                                                   56030081
560400                  TPURITM                                         56040081
560500          WHERE                                                   56050081
560600                  PO_NBR             =  :DK-PO-NBR                56060081
560700           AND    APP_PO_LNE_NBR     =  :DK-LNE-NBR               56070081
560800           AND    VER_STATUS_CDE     =  'A'                       56080081
560900     END-EXEC.                                                    56090081
561000                                                                  56100081
561100     EVALUATE TRUE                                                56110081
561200         WHEN SQLCODE = ZERO                                      56120081
561300         WHEN SQLCODE = +100                                      56130081
561400              CONTINUE                                            56140081
561500         WHEN SQLCODE = -904                                      56150081
561600         WHEN SQLCODE = -911                                      56160081
561700         WHEN SQLCODE = -913                                      56170081
561800             PERFORM 9900-SOFT-ABORT                              56180081
561900         WHEN SQLWARN0 NOT = SPACE                                56190081
562000         WHEN SQLCODE NOT = ZERO                                  56200081
562100              MOVE '7500-GET-PURITM'                              56210081
562200                               TO DP013-PARAGRAPH                 56220081
562300              MOVE 'SUM RECDIS VERIFY QUANTITY'                   56230081
562400                               TO DP013-MESSAGE-TEXT (1)          56240081
562500              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        56250081
562600              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  56260081
562700              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 56270081
562800              STRING ' PO = '                                     56280081
562900                     PV-DISP-PO-NBR                               56290081
563000                     ' LINE ='                                    56300081
563100                     PV-DISP-LNE-NBR                              56310081
563200                                         DELIMITED BY SIZE        56320081
563300                              INTO DP013-MESSAGE-TEXT (2)         56330081
563400              MOVE SQLCA       TO DP013-SQLCA                     56340081
563500              SET DP013-DB2-ABEND                                 56350081
563600                               TO TRUE                            56360081
563700              PERFORM DP013-0000-PROCESS-ABEND                    56370081
563800     END-EVALUATE.                                                56380081
563900/                                                                 56390081
564000 7510-UPDATE-PURITM.                                              56400081
564100                                                                  56410081
564200     EXEC SQL                                                     56420081
564300          UPDATE                                                  56430081
564400                 TPURITM                                          56440081
564500          SET    VER_STATUS_CDE   =  'I'                          56450081
564600          WHERE                                                   56460081
564700                 PO_NBR           =  :DK-PO-NBR                   56470081
564800          AND    APP_PO_LNE_NBR   =  :DK-LNE-NBR                  56480081
564900          AND    VER_STATUS_CDE   =  'A'                          56490081
565000     END-EXEC.                                                    56500081
565100                                                                  56510081
565200     EVALUATE TRUE                                                56520081
565300         WHEN SQLCODE = ZERO                                      56530081
565400              CONTINUE                                            56540081
565500         WHEN SQLCODE = -904                                      56550081
565600         WHEN SQLCODE = -911                                      56560081
565700         WHEN SQLCODE = -913                                      56570081
565800             SET PS-UPDATES-DONE TO TRUE                          56580081
565900             PERFORM 9900-SOFT-ABORT                              56590081
566000         WHEN SQLWARN0 NOT = SPACE                                56600081
566100         WHEN SQLCODE NOT = ZERO                                  56610081
566200              MOVE '7510-UPDATE-PURITM'                           56620081
566300                               TO DP013-PARAGRAPH                 56630081
566400              MOVE 'SET CURRENT ROW TO INACTIVE'                  56640081
566500                               TO DP013-MESSAGE-TEXT (1)          56650081
566600              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        56660081
566700              MOVE SQLCA       TO DP013-SQLCA                     56670081
566800              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  56680081
566900              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 56690081
567000              STRING ' PO = '                                     56700081
567100                     PV-DISP-PO-NBR                               56710081
567200                     ' LINE ='                                    56720081
567300                     PV-DISP-LNE-NBR                              56730081
567400                                         DELIMITED BY SIZE        56740081
567500                              INTO DP013-MESSAGE-TEXT (2)         56750081
567600              SET DP013-DB2-ABEND                                 56760081
567700                               TO TRUE                            56770081
567800              PERFORM DP013-0000-PROCESS-ABEND                    56780081
567900     END-EVALUATE.                                                56790081
568000/                                                                 56800081
568100 7520-INSERT-PURITM.                                              56810081
568200                                                                  56820081
568300     EXEC SQL                                                     56830081
568400          INSERT                                                  56840081
568500           INTO   TPURITM                                         56850081
568600                 (PO_NBR                                          56860081
568700                , VER_NBR                                         56870081
568800                , PO_LNE_NBR                                      56880081
568900                , VER_STATUS_CDE                                  56890081
569000                , SKU_SEQ_NBR                                     56900081
569100                , CL_NBR                                          56910081
569200                , VEND_STYL_NAME                                  56920081
569300                , COLOR_DESC                                      56930081
569400                , SIZE_DESC                                       56940081
569500                , UM_IND                                          56950081
569600                , UNT_QTY                                         56960081
569700                , UNT_RTL_PR_AMT                                  56970081
569800                , UNT_COST_AMT                                    56980081
569900                , TOT_VAL_COST_AMT                                56990081
570000                , TOT_VAL_RTL_AMT                                 57000081
570100                , MU_PCT                                          57010081
570200                , CRE_TMST                                        57020081
570300                , LAST_UPD_TMST                                   57030081
570400                , ITM_NBR                                         57040081
570500                , SKU_DESC                                        57050081
570600                , COLOR_CDE                                       57060081
570700                , SIZE_CDE                                        57070081
570800                , AD_EVNT_DTE                                     57080081
570900                , STATUS_CDE                                      57090081
571000                , CRE_BY_UID                                      57100081
571100                , LAST_UPD_BY_UID                                 57110081
571200                , GP_RTL_AMT                                      57120081
571300                , GP_QTY                                          57130081
571400                , APP_PO_LNE_NBR                                  57140081
571500                , PIC_ITM_IND                                     57150081
571600                , PIC_PG_NBR                                      57160081
571700                , PRD_1ST_COST_AMT                                57170081
571800                , STAT_TMST                                       57180081
571900                , PO_PREPK_ID                                     57190081
572000                , PREPK_RATO_QTY                                  57200081
572100                , SHIP_TO_TMP_DC_IND                              57210081
572200                , RMS_PO_SKU_NBR                                  57220081
572300                , CNCLD_UNT_QTY                                   57230081
572400                  )                                               57240081
572500          VALUES                                                  57250081
572600                 (:PURITM-PO-NBR                                  57260081
572700                , :PURITM-VER-NBR                                 57270081
572800                , :PURITM-PO-LNE-NBR                              57280081
572900                , 'A'                                             57290081
573000                , :PURITM-SKU-SEQ-NBR                             57300081
573100                , :PURITM-CL-NBR                                  57310081
573200                , :PURITM-VEND-STYL-NAME                          57320081
573300                , :PURITM-COLOR-DESC                              57330081
573400                , :PURITM-SIZE-DESC                               57340081
573500                , :PURITM-UM-IND                                  57350081
573600                , :PURITM-UNT-QTY                                 57360081
573700                , :PURITM-UNT-RTL-PR-AMT                          57370081
573800                , :PURITM-UNT-COST-AMT                            57380081
573900                , :PURITM-TOT-VAL-COST-AMT                        57390081
574000                , :PURITM-TOT-VAL-RTL-AMT                         57400081
574100                , :PURITM-MU-PCT                                  57410081
574200                , :PURITM-CRE-TMST                                57420081
574300                ,  CURRENT TIMESTAMP                              57430081
574400                , :PURITM-ITM-NBR                                 57440081
574500                , :PURITM-SKU-DESC                                57450081
574600                , :PURITM-COLOR-CDE                               57460081
574700                , :PURITM-SIZE-CDE                                57470081
574800                , :PURITM-AD-EVNT-DTE                             57480081
574900                , :PV-PURITM-STATUS-CDE                           57490081
575000                , :PURITM-CRE-BY-UID                              57500081
575100                , :DP020-USERID                                   57510081
575200                , :PURITM-GP-RTL-AMT                              57520081
575300                , :PURITM-GP-QTY                                  57530081
575400                , :PURITM-APP-PO-LNE-NBR                          57540081
575500                , :PURITM-PIC-ITM-IND                             57550081
575600                , :PURITM-PIC-PG-NBR                              57560081
575700                , :PURITM-PRD-1ST-COST-AMT                        57570081
575800                , CURRENT TIMESTAMP                               57580081
575900                , :PURITM-PO-PREPK-ID                             57590081
576000                , :PURITM-PREPK-RATO-QTY                          57600081
576100                , :PURITM-SHIP-TO-TMP-DC-IND                      57610081
576200                , :PURITM-RMS-PO-SKU-NBR                          57620081
576300                , :PURITM-CNCLD-UNT-QTY                           57630081
576400                  )                                               57640081
576500     END-EXEC.                                                    57650081
576600                                                                  57660081
576700     EVALUATE TRUE                                                57670081
576800         WHEN SQLCODE = ZERO                                      57680081
576900              CONTINUE                                            57690081
577000         WHEN SQLCODE = -904                                      57700081
577100         WHEN SQLCODE = -911                                      57710081
577200         WHEN SQLCODE = -913                                      57720081
577300             SET PS-UPDATES-DONE TO TRUE                          57730081
577400             PERFORM 9900-SOFT-ABORT                              57740081
577500         WHEN SQLWARN0 NOT = SPACE                                57750081
577600         WHEN SQLCODE NOT = ZERO                                  57760081
577700              MOVE '7520-INSERT-PURITM'                           57770081
577800                               TO DP013-PARAGRAPH                 57780081
577900              MOVE 'INSERT NEW ROW IN TPURITM TABLE'              57790081
578000                               TO DP013-MESSAGE-TEXT (1)          57800081
578100              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        57810081
578200              MOVE SQLCA       TO DP013-SQLCA                     57820081
578300              MOVE PURITM-PO-NBR     TO PV-DISP-PO-NBR            57830081
578400              MOVE PURITM-PO-LNE-NBR TO PV-DISP-LNE-NBR           57840081
578500              STRING ' PO = '                                     57850081
578600                     PV-DISP-PO-NBR                               57860081
578700                     ' LINE ='                                    57870081
578800                     PV-DISP-LNE-NBR                              57880081
578900                                         DELIMITED BY SIZE        57890081
579000                              INTO DP013-MESSAGE-TEXT (2)         57900081
579100              SET DP013-DB2-ABEND                                 57910081
579200                               TO TRUE                            57920081
579300              PERFORM DP013-0000-PROCESS-ABEND                    57930081
579400     END-EVALUATE.                                                57940081
579500/                                                                 57950081
579600 7530-ONLY-UPDATE-PURITM.                                         57960081
579700                                                                  57970081
579800     EXEC SQL                                                     57980081
579900          UPDATE                                                  57990081
580000                 TPURITM                                          58000081
580100          SET    STATUS_CDE       =  :PV-PURITM-STATUS-CDE        58010081
580200               , STAT_TMST        =  CURRENT TIMESTAMP            58020081
580300          WHERE                                                   58030081
580400                 PO_NBR           =  :DK-PO-NBR                   58040081
580500          AND    APP_PO_LNE_NBR   =  :DK-LNE-NBR                  58050081
580600          AND    VER_STATUS_CDE   =  'A'                          58060081
580700     END-EXEC.                                                    58070081
580800                                                                  58080081
580900     EVALUATE TRUE                                                58090081
581000         WHEN SQLCODE = ZERO                                      58100081
581100              CONTINUE                                            58110081
581200         WHEN SQLCODE = -904                                      58120081
581300         WHEN SQLCODE = -911                                      58130081
581400         WHEN SQLCODE = -913                                      58140081
581500             SET PS-UPDATES-DONE TO TRUE                          58150081
581600             PERFORM 9900-SOFT-ABORT                              58160081
581700         WHEN SQLWARN0 NOT = SPACE                                58170081
581800         WHEN SQLCODE NOT = ZERO                                  58180081
581900              MOVE '7530-ONLY-UPDATE-PURITM'                      58190081
582000                               TO DP013-PARAGRAPH                 58200081
582100              MOVE 'SET CURRENT ROW TO INACTIVE'                  58210081
582200                               TO DP013-MESSAGE-TEXT (1)          58220081
582300              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        58230081
582400              MOVE SQLCA       TO DP013-SQLCA                     58240081
582500              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  58250081
582600              MOVE DK-LNE-NBR  TO PV-DISP-LNE-NBR                 58260081
582700              STRING ' PO = '                                     58270081
582800                     PV-DISP-PO-NBR                               58280081
582900                     ' LINE ='                                    58290081
583000                     PV-DISP-LNE-NBR                              58300081
583100                                         DELIMITED BY SIZE        58310081
583200                              INTO DP013-MESSAGE-TEXT (2)         58320081
583300              SET DP013-DB2-ABEND                                 58330081
583400                               TO TRUE                            58340081
583500              PERFORM DP013-0000-PROCESS-ABEND                    58350081
583600     END-EVALUATE.                                                58360081
583700                                                                  58370081
583800 7600-COUNT-PO-LINE-ROWS.                                         58380081
583900                                                                  58390081
584000     MOVE ZERO            TO  PV-DB2-COUNT.                       58400081
584100     EXEC SQL                                                     58410081
584200          SELECT                                                  58420081
584300                COUNT(*)                                          58430081
584400          INTO                                                    58440081
584500                :PV-DB2-COUNT :PV-NULL-IND                        58450081
584600          FROM                                                    58460081
584700                TPURITM                                           58470081
584800          WHERE                                                   58480081
584900                PO_NBR             =  :DK-PO-NBR                  58490081
585000          AND   VER_STATUS_CDE     =  'A'                         58500081
585100          AND  (STATUS_CDE        ^=  'CM'                        58510081
585200           AND  STATUS_CDE        ^=  'CB'                        58520081
585300           AND  STATUS_CDE        ^=  'CA')                       58530081
585400     END-EXEC.                                                    58540081
585500                                                                  58550081
585600     EVALUATE TRUE                                                58560081
585700         WHEN SQLCODE = ZERO                                      58570081
585800         WHEN SQLCODE = +100                                      58580081
585900              CONTINUE                                            58590081
586000         WHEN SQLCODE = -904                                      58600081
586100         WHEN SQLCODE = -911                                      58610081
586200         WHEN SQLCODE = -913                                      58620081
586300             PERFORM 9900-SOFT-ABORT                              58630081
586400         WHEN SQLWARN0 NOT = SPACE                                58640081
586500         WHEN SQLCODE NOT = ZERO                                  58650081
586600              MOVE '7600-COUNT-PO-LINE-ROWS'                      58660081
586700                               TO DP013-PARAGRAPH                 58670081
586800              MOVE 'COUNT NUMBER OF "CM", "CB", "CA" STATUS ROWS' 58680081
586900                               TO DP013-MESSAGE-TEXT (1)          58690081
587000              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        58700081
587100              MOVE SQLCA       TO DP013-SQLCA                     58710081
587200              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  58720081
587300              STRING ' PO = '                                     58730081
587400                     PV-DISP-PO-NBR                               58740081
587500                                         DELIMITED BY SIZE        58750081
587600                              INTO DP013-MESSAGE-TEXT (2)         58760081
587700              SET DP013-DB2-ABEND                                 58770081
587800                               TO TRUE                            58780081
587900              PERFORM DP013-0000-PROCESS-ABEND                    58790081
588000     END-EVALUATE.                                                58800081
588100/                                                                 58810081
588200 7610-GET-TPURCHS-STATUS.                                         58820081
588300                                                                  58830081
588400     EXEC SQL                                                     58840081
588500          SELECT                                                  58850081
588600                  PO_NBR                                          58860081
588700                , VER_NBR                                         58870081
588800                , VER_STATUS_CDE                                  58880081
588900                , PO_TYP_CDE                                      58890081
589000                , PO_CATEG_CDE                                    58900081
589100                , EDI_IND                                         58910081
589200                , TOT_UNT_QTY                                     58920081
589300                , TOT_VAL_COST_AMT                                58930081
589400                , TOT_VAL_RTL_AMT                                 58940081
589500                , TOT_MU_PCT                                      58950081
589600                , TOT_SKUS_QTY                                    58960081
589700                , IMPRT_AGNT_PO_NBR                               58970081
589800                , IMPRT_ORD_OFF_NAME                              58980081
589900                , IMPRT_VEND_NAME                                 58990081
590000                , IMPRT_FCTRY_NAME                                59000081
590100                , IMPRT_CNTRY_NAME                                59010081
590200                , VEND_CNTRY_NAME                                 59020081
590300                , NEW_STR_PO_IND                                  59030081
590400                , IMPRT_PO_IND                                    59040081
590500                , IMPRT_AGNT_PO_IND                               59050081
590600                , STATUS_TMST                                     59060081
590700                , LAST_UPD_TMST                                   59070081
590800                , EDI_REXMIT_IND                                  59080081
590900                , EDI_REXMIT_TMST                                 59090081
591000                , DIR_STR_IND                                     59100081
591100                , LAST_UPD_BY_UID                                 59110081
591200                , APP_BY_UID                                      59120081
591300                , OTB_PER_NBR                                     59130081
591400                , DEPT_NBR                                        59140081
591500                , ENT_ID                                          59150081
591600                , STATUS_CDE                                      59160081
591700                , CRE_BY_UID                                      59170081
591800                , REJ_CT                                          59180081
591900                , REJ_UID                                         59190081
592000                , ORD_DTE                                         59200081
592100                , REVISION_CT                                     59210081
592200                , ADR_SEQ_NBR                                     59220081
592300                , DEST_KNOWN_IND                                  59230081
592400                , RLSE_IND                                        59240081
592500                , RLSE_DTE                                        59250081
592600                , PLCMNT_CNTRY_CDE                                59260081
592700                , PROD_CNTRY_CDE                                  59270081
592800                , UNT_PER_CBMT_QTY                                59280081
592900                , CRE_TMST                                        59290081
593000                , PRG_LAST_ACTVY_DTE                              59300081
593100                , PKGNG_CDE                                       59310081
593200                , SEASET_YR                                       59320081
593300                , SEASET_SHRT_NM                                  59330081
593400                , QTA_CTG_CDE                                     59340081
593500                , PO_IN_RMS_IND                                   59350081
593600                , RMS_PO_UPD_TMST                                 59360081
593700                , DUP_SKU_IND                                     59370081
593800                , ORIG_PKGNG_CDE                                  59380081
593900           INTO                                                   59390081
594000                 :PURCHS-PO-NBR                                   59400081
594100                ,:PURCHS-VER-NBR                                  59410081
594200                ,:PURCHS-VER-STATUS-CDE                           59420081
594300                ,:PURCHS-PO-TYP-CDE                               59430081
594400                ,:PURCHS-PO-CATEG-CDE                             59440081
594500                ,:PURCHS-EDI-IND                                  59450081
594600                ,:PURCHS-TOT-UNT-QTY                              59460081
594700                ,:PURCHS-TOT-VAL-COST-AMT                         59470081
594800                ,:PURCHS-TOT-VAL-RTL-AMT                          59480081
594900                ,:PURCHS-TOT-MU-PCT                               59490081
595000                ,:PURCHS-TOT-SKUS-QTY                             59500081
595100                ,:PURCHS-IMPRT-AGNT-PO-NBR                        59510081
595200                ,:PURCHS-IMPRT-ORD-OFF-NAME                       59520081
595300                ,:PURCHS-IMPRT-VEND-NAME                          59530081
595400                ,:PURCHS-IMPRT-FCTRY-NAME                         59540081
595500                ,:PURCHS-IMPRT-CNTRY-NAME                         59550081
595600                ,:PURCHS-VEND-CNTRY-NAME                          59560081
595700                ,:PURCHS-NEW-STR-PO-IND                           59570081
595800                ,:PURCHS-IMPRT-PO-IND                             59580081
595900                ,:PURCHS-IMPRT-AGNT-PO-IND                        59590081
596000                ,:PURCHS-STATUS-TMST                              59600081
596100                ,:PURCHS-LAST-UPD-TMST                            59610081
596200                ,:PURCHS-EDI-REXMIT-IND                           59620081
596300                ,:PURCHS-EDI-REXMIT-TMST                          59630081
596400                ,:PURCHS-DIR-STR-IND                              59640081
596500                ,:PURCHS-LAST-UPD-BY-UID                          59650081
596600                ,:PURCHS-APP-BY-UID                               59660081
596700                ,:PURCHS-OTB-PER-NBR                              59670081
596800                ,:PURCHS-DEPT-NBR                                 59680081
596900                ,:PURCHS-ENT-ID                                   59690081
597000                ,:PURCHS-STATUS-CDE                               59700081
597100                ,:PURCHS-CRE-BY-UID                               59710081
597200                ,:PURCHS-REJ-CT                                   59720081
597300                ,:PURCHS-REJ-UID                                  59730081
597400                ,:PURCHS-ORD-DTE                                  59740081
597500                ,:PURCHS-REVISION-CT                              59750081
597600                ,:PURCHS-ADR-SEQ-NBR                              59760081
597700                ,:PURCHS-DEST-KNOWN-IND                           59770081
597800                ,:PURCHS-RLSE-IND                                 59780081
597900                ,:PURCHS-RLSE-DTE                                 59790081
598000                ,:PURCHS-PLCMNT-CNTRY-CDE                         59800081
598100                ,:PURCHS-PROD-CNTRY-CDE                           59810081
598200                ,:PURCHS-UNT-PER-CBMT-QTY                         59820081
598300                ,:PURCHS-CRE-TMST                                 59830081
598400                ,:PURCHS-PRG-LAST-ACTVY-DTE                       59840081
598500                ,:PURCHS-PKGNG-CDE                                59850081
598600                ,:PURCHS-SEASET-YR                                59860081
598700                ,:PURCHS-SEASET-SHRT-NM                           59870081
598800                ,:PURCHS-QTA-CTG-CDE                              59880081
598900                ,:PURCHS-PO-IN-RMS-IND                            59890081
599000                ,:PURCHS-RMS-PO-UPD-TMST                          59900081
599100                ,:PURCHS-DUP-SKU-IND                              59910081
599200                ,:PURCHS-ORIG-PKGNG-CDE                           59920081
599300          FROM                                                    59930081
599400                 TPURCHS                                          59940081
599500          WHERE                                                   59950081
599600                PO_NBR             =  :DK-PO-NBR                  59960081
599700          AND   VER_STATUS_CDE     =  'A'                         59970081
599800     END-EXEC.                                                    59980081
599900                                                                  59990081
600000     EVALUATE TRUE                                                60000081
600100         WHEN SQLCODE = ZERO                                      60010081
600200         WHEN SQLCODE = +100                                      60020081
600300              CONTINUE                                            60030081
600400         WHEN SQLCODE = -904                                      60040081
600500         WHEN SQLCODE = -911                                      60050081
600600         WHEN SQLCODE = -913                                      60060081
600700             PERFORM 9900-SOFT-ABORT                              60070081
600800         WHEN SQLWARN0 NOT = SPACE                                60080081
600900         WHEN SQLCODE NOT = ZERO                                  60090081
601000              MOVE '7610-GET-TPURCHS-STATUS'                      60100081
601100                               TO DP013-PARAGRAPH                 60110081
601200              MOVE 'GET THE PURCHASE HEADER'                      60120081
601300                               TO DP013-MESSAGE-TEXT (1)          60130081
601400              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        60140081
601500              MOVE SQLCA       TO DP013-SQLCA                     60150081
601600              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  60160081
601700              STRING ' PO = '                                     60170081
601800                     PV-DISP-PO-NBR                               60180081
601900                                         DELIMITED BY SIZE        60190081
602000                              INTO DP013-MESSAGE-TEXT (2)         60200081
602100              SET DP013-DB2-ABEND                                 60210081
602200                               TO TRUE                            60220081
602300              PERFORM DP013-0000-PROCESS-ABEND                    60230081
602400     END-EVALUATE.                                                60240081
602500/                                                                 60250081
602600 7620-ONLY-UPDATE-PURCHS-STATUS.                                  60260081
602700                                                                  60270081
602800     EXEC SQL                                                     60280081
602900          UPDATE                                                  60290081
603000                TPURCHS                                           60300081
603100           SET                                                    60310081
603200                VER_STATUS_CDE     =  'A'                         60320081
603300              , STATUS_TMST        =  (CURRENT TIMESTAMP)         60330081
603400              , LAST_UPD_TMST      =  (CURRENT TIMESTAMP)         60340081
603500              , STATUS_CDE         =  :PV-PURCHS-STATUS-CDE       60350081
603600          WHERE                                                   60360081
603700                PO_NBR             =  :DK-PO-NBR                  60370081
603800          AND   VER_STATUS_CDE     =  'A'                         60380081
603900     END-EXEC.                                                    60390081
604000                                                                  60400081
604100     EVALUATE TRUE                                                60410081
604200         WHEN SQLCODE = ZERO                                      60420081
604300         WHEN SQLCODE = +100                                      60430081
604400              CONTINUE                                            60440081
604500         WHEN SQLCODE = -904                                      60450081
604600         WHEN SQLCODE = -911                                      60460081
604700         WHEN SQLCODE = -913                                      60470081
604800             SET PS-UPDATES-DONE TO TRUE                          60480081
604900             PERFORM 9900-SOFT-ABORT                              60490081
605000         WHEN SQLWARN0 NOT = SPACE                                60500081
605100         WHEN SQLCODE NOT = ZERO                                  60510081
605200              MOVE '7620-ONLY-UPDATE-PURCHS-STATUS'               60520081
605300                               TO DP013-PARAGRAPH                 60530081
605400              MOVE 'UPDATE THE PURCHASE HEADER'                   60540081
605500                               TO DP013-MESSAGE-TEXT (1)          60550081
605600              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        60560081
605700              MOVE SQLCA       TO DP013-SQLCA                     60570081
605800              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  60580081
605900              STRING ' PO = '                                     60590081
606000                     PV-DISP-PO-NBR                               60600081
606100                                         DELIMITED BY SIZE        60610081
606200                              INTO DP013-MESSAGE-TEXT (2)         60620081
606300              SET DP013-DB2-ABEND                                 60630081
606400                               TO TRUE                            60640081
606500              PERFORM DP013-0000-PROCESS-ABEND                    60650081
606600     END-EVALUATE.                                                60660081
606700/                                                                 60670081
606800 7630-UPDATE-PURCHS-STATUS.                                       60680081
606900                                                                  60690081
607000     EXEC SQL                                                     60700081
607100          UPDATE                                                  60710081
607200                TPURCHS                                           60720081
607300           SET                                                    60730081
607400                VER_STATUS_CDE     =  'I'                         60740081
607500          WHERE                                                   60750081
607600                PO_NBR             =  :DK-PO-NBR                  60760081
607700          AND   VER_STATUS_CDE     =  'A'                         60770081
607800     END-EXEC.                                                    60780081
607900                                                                  60790081
608000     EVALUATE TRUE                                                60800081
608100         WHEN SQLCODE = ZERO                                      60810081
608200         WHEN SQLCODE = +100                                      60820081
608300              CONTINUE                                            60830081
608400         WHEN SQLCODE = -904                                      60840081
608500         WHEN SQLCODE = -911                                      60850081
608600         WHEN SQLCODE = -913                                      60860081
608700             SET PS-UPDATES-DONE TO TRUE                          60870081
608800             PERFORM 9900-SOFT-ABORT                              60880081
608900         WHEN SQLWARN0 NOT = SPACE                                60890081
609000         WHEN SQLCODE NOT = ZERO                                  60900081
609100              MOVE '7630-UPDATE-PURCHS-STATUS'                    60910081
609200                               TO DP013-PARAGRAPH                 60920081
609300              MOVE 'UPDATE PURCHS STATUS'                         60930081
609400                               TO DP013-MESSAGE-TEXT (1)          60940081
609500              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        60950081
609600              MOVE SQLCA       TO DP013-SQLCA                     60960081
609700              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  60970081
609800              STRING ' PO = '                                     60980081
609900                     PV-DISP-PO-NBR                               60990081
610000                                         DELIMITED BY SIZE        61000081
610100                              INTO DP013-MESSAGE-TEXT (2)         61010081
610200              SET DP013-DB2-ABEND                                 61020081
610300                               TO TRUE                            61030081
610400              PERFORM DP013-0000-PROCESS-ABEND                    61040081
610500     END-EVALUATE.                                                61050081
610600/                                                                 61060081
610700 7640-INSERT-PURCHS.                                              61070081
610800                                                                  61080081
610900     EXEC SQL                                                     61090081
611000          INSERT                                                  61100081
611100           INTO   TPURCHS                                         61110081
611200                 (PO_NBR                                          61120081
611300                , VER_NBR                                         61130081
611400                , VER_STATUS_CDE                                  61140081
611500                , PO_TYP_CDE                                      61150081
611600                , PO_CATEG_CDE                                    61160081
611700                , EDI_IND                                         61170081
611800                , TOT_UNT_QTY                                     61180081
611900                , TOT_VAL_COST_AMT                                61190081
612000                , TOT_VAL_RTL_AMT                                 61200081
612100                , TOT_MU_PCT                                      61210081
612200                , TOT_SKUS_QTY                                    61220081
612300                , IMPRT_AGNT_PO_NBR                               61230081
612400                , IMPRT_ORD_OFF_NAME                              61240081
612500                , IMPRT_VEND_NAME                                 61250081
612600                , IMPRT_FCTRY_NAME                                61260081
612700                , IMPRT_CNTRY_NAME                                61270081
612800                , VEND_CNTRY_NAME                                 61280081
612900                , NEW_STR_PO_IND                                  61290081
613000                , IMPRT_PO_IND                                    61300081
613100                , IMPRT_AGNT_PO_IND                               61310081
613200                , STATUS_TMST                                     61320081
613300                , LAST_UPD_TMST                                   61330081
613400                , EDI_REXMIT_IND                                  61340081
613500                , EDI_REXMIT_TMST                                 61350081
613600                , DIR_STR_IND                                     61360081
613700                , LAST_UPD_BY_UID                                 61370081
613800                , APP_BY_UID                                      61380081
613900                , OTB_PER_NBR                                     61390081
614000                , DEPT_NBR                                        61400081
614100                , ENT_ID                                          61410081
614200                , STATUS_CDE                                      61420081
614300                , CRE_BY_UID                                      61430081
614400                , REJ_CT                                          61440081
614500                , REJ_UID                                         61450081
614600                , ORD_DTE                                         61460081
614700                , REVISION_CT                                     61470081
614800                , ADR_SEQ_NBR                                     61480081
614900                , DEST_KNOWN_IND                                  61490081
615000                , RLSE_IND                                        61500081
615100                , RLSE_DTE                                        61510081
615200                , PLCMNT_CNTRY_CDE                                61520081
615300                , PROD_CNTRY_CDE                                  61530081
615400                , UNT_PER_CBMT_QTY                                61540081
615500                , CRE_TMST                                        61550081
615600                , PRG_LAST_ACTVY_DTE                              61560081
615700                , PKGNG_CDE                                       61570081
615800                , SEASET_YR                                       61580081
615900                , SEASET_SHRT_NM                                  61590081
616000                , QTA_CTG_CDE                                     61600081
616100                , PO_IN_RMS_IND                                   61610081
616200                , RMS_PO_UPD_TMST                                 61620081
616300                , DUP_SKU_IND                                     61630081
616400                , ORIG_PKGNG_CDE                                  61640081
616500                 )                                                61650081
616600         VALUES                                                   61660081
616700                (:PURCHS-PO-NBR                                   61670081
616800                ,:PURCHS-VER-NBR                                  61680081
616900                ,'A'                                              61690081
617000                ,:PURCHS-PO-TYP-CDE                               61700081
617100                ,:PURCHS-PO-CATEG-CDE                             61710081
617200                ,:PURCHS-EDI-IND                                  61720081
617300                ,:PURCHS-TOT-UNT-QTY                              61730081
617400                ,:PURCHS-TOT-VAL-COST-AMT                         61740081
617500                ,:PURCHS-TOT-VAL-RTL-AMT                          61750081
617600                ,:PURCHS-TOT-MU-PCT                               61760081
617700                ,:PURCHS-TOT-SKUS-QTY                             61770081
617800                ,:PURCHS-IMPRT-AGNT-PO-NBR                        61780081
617900                ,:PURCHS-IMPRT-ORD-OFF-NAME                       61790081
618000                ,:PURCHS-IMPRT-VEND-NAME                          61800081
618100                ,:PURCHS-IMPRT-FCTRY-NAME                         61810081
618200                ,:PURCHS-IMPRT-CNTRY-NAME                         61820081
618300                ,:PURCHS-VEND-CNTRY-NAME                          61830081
618400                ,:PURCHS-NEW-STR-PO-IND                           61840081
618500                ,:PURCHS-IMPRT-PO-IND                             61850081
618600                ,:PURCHS-IMPRT-AGNT-PO-IND                        61860081
618700                , CURRENT TIMESTAMP                               61870081
618800                , CURRENT TIMESTAMP                               61880081
618900                ,:PURCHS-EDI-REXMIT-IND                           61890081
619000                ,:PURCHS-EDI-REXMIT-TMST                          61900081
619100                ,:PURCHS-DIR-STR-IND                              61910081
619200                ,:DP020-USERID                                    61920081
619300                ,:PURCHS-APP-BY-UID                               61930081
619400                ,:PURCHS-OTB-PER-NBR                              61940081
619500                ,:PURCHS-DEPT-NBR                                 61950081
619600                ,:PURCHS-ENT-ID                                   61960081
619700                ,:PV-PURCHS-STATUS-CDE                            61970081
619800                ,:PURCHS-CRE-BY-UID                               61980081
619900                ,:PURCHS-REJ-CT                                   61990081
620000                ,:PURCHS-REJ-UID                                  62000081
620100                ,:PURCHS-ORD-DTE                                  62010081
620200                ,:PURCHS-REVISION-CT                              62020081
620300                ,:PURCHS-ADR-SEQ-NBR                              62030081
620400                ,:PURCHS-DEST-KNOWN-IND                           62040081
620500                ,:PURCHS-RLSE-IND                                 62050081
620600                ,:PURCHS-RLSE-DTE                                 62060081
620700                ,:PURCHS-PLCMNT-CNTRY-CDE                         62070081
620800                ,:PURCHS-PROD-CNTRY-CDE                           62080081
620900                ,:PURCHS-UNT-PER-CBMT-QTY                         62090081
621000                ,:PURCHS-CRE-TMST                                 62100081
621100                ,:PURCHS-PRG-LAST-ACTVY-DTE                       62110081
621200                ,:PURCHS-PKGNG-CDE                                62120081
621300                ,:PURCHS-SEASET-YR                                62130081
621400                ,:PURCHS-SEASET-SHRT-NM                           62140081
621500                ,:PURCHS-QTA-CTG-CDE                              62150081
621600                ,:PURCHS-PO-IN-RMS-IND                            62160081
621700                ,:PURCHS-RMS-PO-UPD-TMST                          62170081
621800                ,:PURCHS-DUP-SKU-IND                              62180081
621900                ,:PURCHS-ORIG-PKGNG-CDE                           62190081
622000                 )                                                62200081
622100     END-EXEC.                                                    62210081
622200                                                                  62220081
622300     EVALUATE TRUE                                                62230081
622400         WHEN SQLCODE = ZERO                                      62240081
622500              CONTINUE                                            62250081
622600         WHEN SQLCODE = -904                                      62260081
622700         WHEN SQLCODE = -911                                      62270081
622800         WHEN SQLCODE = -913                                      62280081
622900             SET PS-UPDATES-DONE TO TRUE                          62290081
623000             PERFORM 9900-SOFT-ABORT                              62300081
623100         WHEN SQLWARN0 NOT = SPACE                                62310081
623200         WHEN SQLCODE NOT = ZERO                                  62320081
623300              MOVE '7640-INSERT-PURCHS'                           62330081
623400                               TO DP013-PARAGRAPH                 62340081
623500              MOVE 'INSERT PURCHASE HEADER'                       62350081
623600                               TO DP013-MESSAGE-TEXT (1)          62360081
623700              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        62370081
623800              MOVE SQLCA       TO DP013-SQLCA                     62380081
623900              MOVE DK-PO-NBR   TO PV-DISP-PO-NBR                  62390081
624000              STRING ' PO = '                                     62400081
624100                     PV-DISP-PO-NBR                               62410081
624200                                         DELIMITED BY SIZE        62420081
624300                              INTO DP013-MESSAGE-TEXT (2)         62430081
624400              SET DP013-DB2-ABEND                                 62440081
624500                               TO TRUE                            62450081
624600              PERFORM DP013-0000-PROCESS-ABEND                    62460081
624700     END-EVALUATE.                                                62470081
624800                                                                  62480081
624900*----------------------------------------------------------------*62490081
625000*    CHECK TO SEE IF THIS DEPARTMENT HAS BEEN CONVERTED TO RMS.  *62500081
625100*    IF IT HAS, THE COUNT RETURNED FROM THIS FUNCTION WILL BE    *62510081
625200*    GREATER THAN ZERO AND WE CAN UPDATE TPURITM AND TPURCHS     *62520081
625300*    CORRECTLY.                                                  *62530081
625400*----------------------------------------------------------------*62540081
625500 7650-CHECK-FOR-RMS-PO.                                           62550081
625600                                                                  62560081
625700     INITIALIZE PV-DB2-COUNT.                                     62570081
625800                                                                  62580081
625900     EXEC SQL                                                     62590081
626000          SELECT                                                  62600081
626100                  COUNT(*)                                        62610081
626200           INTO                                                   62620081
626300                  :PV-DB2-COUNT :PV-NULL-IND                      62630081
626400           FROM                                                   62640081
626500                  POT_RMS_RLOUT_CTL                               62650081
626600          WHERE                                                   62660081
626700                  DEPT_NBR            = :PV-DEPT-NBR-KEY          62670081
626800           AND    PO_ENTR_IN_RMS_DTE <=  CURRENT_DATE             62680081
626900     END-EXEC.                                                    62690081
627000                                                                  62700081
627100     EVALUATE TRUE                                                62710081
627200         WHEN SQLCODE = ZERO                                      62720081
627300         WHEN SQLCODE = +100                                      62730081
627400              SET PS-CHECKED-FOR-RMS-PO                           62740081
627500                               TO TRUE                            62750081
627600         WHEN SQLWARN0 NOT = SPACE                                62760081
627700         WHEN SQLCODE = -904                                      62770081
627800         WHEN SQLCODE = -911                                      62780081
627900         WHEN SQLCODE = -913                                      62790081
628000              PERFORM 9900-SOFT-ABORT                             62800081
628100         WHEN SQLCODE NOT = ZERO                                  62810081
628200              MOVE '7650-CHECK-FOR-RMS-PO'                        62820081
628300                               TO DP013-PARAGRAPH                 62830081
628400              MOVE 'CHECK IF DEPT NBR CONVERTED FOR RMS'          62840081
628500                               TO DP013-MESSAGE-TEXT (1)          62850081
628600              STRING 'DEPARTMENT NUMBER: ' DELIMITED BY SIZE      62860081
628700                     PV-DEPT-NBR-X         DELIMITED BY SIZE      62870081
628800                             INTO DP013-MESSAGE-TEXT (2)          62880081
628900              MOVE 'POT_RMS_RLOUT_CTL'                            62890081
629000                               TO DP013-DB2-TABLE-NAME (1)        62900081
629100              MOVE SQLCA       TO DP013-SQLCA                     62910081
629200              SET DP013-DB2-ABEND                                 62920081
629300                               TO TRUE                            62930081
629400              PERFORM DP013-0000-PROCESS-ABEND                    62940081
629500     END-EVALUATE.                                                62950081
629600******************************************************************62960081
629700* THIS PARAGRAPH WILL CONTROL THE PROCESSING ASSOCIATED TO THE   *62970081
629800* UNITS WORKED ROUTINE.                                           62980081
629900******************************************************************62990081
630000 8500-PROCESS-UNITS-WORK.                                         63000081
630100                                                                  63010081
630200     PERFORM 8600-RECEIV-PURITM-JOIN.                             63020081
630300                                                                  63030081
630400     PERFORM 8800-UNITS-WORK-ROUTINE.                             63040081
630500                                                                  63050081
630600/                                                                 63060081
630700******************************************************************63070081
630800*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *63080081
630900*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *63090081
631000*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *63100081
631100*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *63110081
631200*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *63120081
631300*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *63130081
631400*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *63140081
631500*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *63150081
631600******************************************************************63160081
631700 8600-RECEIV-PURITM-JOIN.                                         63170081
631800                                                                  63180081
631900     MOVE ASC-DRIVER-LNE-NBR      TO DK-DRIVER-LNE-NBR.           63190081
632000                                                                  63200081
632100     EXEC SQL                                                     63210081
632200     SELECT A.CURR_OPER_UNT_ID,                                   63220081
632300            C.UNT_RTL_PR_AMT,                                     63230081
632400            D.LOC_TYP_CDE                                         63240081
632500         INTO :PV-CURR-OPER-UNT-ID                                63250081
632600         ,    :PURITM-UNT-RTL-PR-AMT                              63260081
632700         ,    :PV-XLT00010-TYPE-CODE                              63270081
632800         FROM                                                     63280081
632900             TRECEIV A                                            63290081
633000         ,   TRECITM B                                            63300081
633100         ,   TPURITM C                                            63310081
633200         ,   XLT_LOC D                                            63320081
633300         WHERE A.ORD_NBR          = :DK-PO-NBR                    63330081
633400           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               63340081
633500           AND B.ORD_NBR          = A.ORD_NBR                     63350081
633600           AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                 63360081
633700           AND B.ORD_LNE_NBR      = :DK-DRIVER-LNE-NBR            63370081
633800           AND C.PO_NBR           = B.ORD_NBR                     63380081
633900           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 63390081
634000           AND C.VER_NBR          = B.PO_VER_NBR                  63400081
634100           AND D.LOC_NBR          = A.CURR_OPER_UNT_ID            63410081
634200     END-EXEC.                                                    63420081
634300*                                                                 63430081
634400     EVALUATE TRUE                                                63440081
634500         WHEN SQLCODE = ZERO                                      63450081
634600             CONTINUE                                             63460081
634700         WHEN SQLCODE = -904                                      63470081
634800         WHEN SQLCODE = -911                                      63480081
634900         WHEN SQLCODE = -913                                      63490081
635000             PERFORM 9900-SOFT-ABORT                              63500081
635100                                                                  63510081
635200         WHEN SQLWARN0 NOT = SPACES                               63520081
635300         WHEN SQLCODE < ZERO                                      63530081
635400         WHEN SQLCODE > ZERO                                      63540081
635500             MOVE '8600-RECEIV-PURITM-JOIN'                       63550081
635600                                  TO DP013-PARAGRAPH              63560081
635700             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 63570081
635800                                  TO DP013-MESSAGE-TEXT (1)       63580081
635900             MOVE DK-PO-NBR              TO PV-DISP-PO-NBR        63590081
636000             MOVE DK-REC-SEQ-NBR         TO PV-DISP-REC-SEQ-NBR   63600081
636100             MOVE DK-DRIVER-LNE-NBR      TO PV-DISP-LNE-NBR       63610081
636200             STRING 'PO '                                         63620081
636300                    PV-DISP-PO-NBR                                63630081
636400                    ' REC '                                       63640081
636500                    PV-DISP-REC-SEQ-NBR                           63650081
636600                    ' LINE '                                      63660081
636700                    PV-DISP-LNE-NBR     DELIMITED BY SIZE         63670081
636800                             INTO DP013-MESSAGE-TEXT (2)          63680081
636900             MOVE SQLCA      TO DP013-SQLCA                       63690081
637000             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          63700081
637100             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (2)          63710081
637200             MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (3)          63720081
637300             SET DP013-DB2-ABEND                                  63730081
637400                 DP013-NO-ROLLBACK                                63740081
637500                                  TO TRUE                         63750081
637600             PERFORM DP013-0000-PROCESS-ABEND                     63760081
637700     END-EVALUATE.                                                63770081
637800                                                                  63780081
637900******************************************************************63790081
638000* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *63800081
638100* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *63810081
638200* THE RESULTS RETURNED FROM THE ROUTINE.                         *63820081
638300******************************************************************63830081
638400 8800-UNITS-WORK-ROUTINE.                                         63840081
638500                                                                  63850081
638600     INITIALIZE PC238-COMM-AREA.                                  63860081
638700                                                                  63870081
638800     EXEC SQL                                                     63880081
638900         SET :PV-TMST =  CURRENT_TIMESTAMP                        63890081
639000     END-EXEC                                                     63900081
639100                                                                  63910081
639200     MOVE PV-TMST                 TO PC238-WRKD-TMST.             63920081
639300                                                                  63930081
639400     MOVE PV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.      63940081
639500     MOVE DK-PO-NBR               TO PC238-PO-NBR.                63950081
639600     MOVE DK-REC-SEQ-NBR          TO PC238-RCVR-SEQ-NBR.          63960081
639700     MOVE DK-ODD-LNE-NBR          TO PC238-PO-LNE-NBR.            63970081
639800                                                                  63980081
639900     IF  PS-REMOVE-PACK                                           63990081
640000         MOVE 'A'                 TO PC238-VRFY-ADJ-DRIVE-LNE     64000081
640100         SET PC238-ODD-UNIT-NO    TO TRUE                         64010081
640200     ELSE                                                         64020081
640300         MOVE SPACE               TO PC238-VRFY-ADJ-DRIVE-LNE     64030081
640400         SET  PC238-ODD-UNIT-YES  TO TRUE                         64040081
640500     END-IF.                                                      64050081
640600                                                                  64060081
640700     IF  PV-XLT00010-TYPE-DC                                      64070081
640800         SET PC238-DIRECT-STORE-NO TO TRUE                        64080081
640900     ELSE                                                         64090081
641000         SET PC238-DIRECT-STORE-YES TO TRUE                       64100081
641100     END-IF.                                                      64110081
641200                                                                  64120081
641300     IF  DP020-FK-CONFIRM (DP020-SRC-AID)                         64130081
641400     AND ASC-CONFIRM                                              64140081
641500         MOVE ZEROS                TO PC238-WRKD-UNT-QTY          64150081
641600     ELSE                                                         64160081
641700         MOVE PV-SUM-ITM-QTY       TO PC238-WRKD-UNT-QTY          64170081
641800     END-IF.                                                      64180081
641900                                                                  64190081
642000     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        64200081
642100     IF ASC-POST-VERIFIED-RECEIPT                                 64210081
642200         SET  PC238-TRANS-POST-VRFY-ADJ TO TRUE                   64220081
642300     ELSE                                                         64230081
642400         SET  PC238-TRANS-VERIFY-ADJ  TO TRUE                     64240081
642500     END-IF.                                                      64250081
642600                                                                  64260081
642700     SET  PC238-MANUAL-VERIFY     TO TRUE.                        64270081
642800     MOVE ASC-VRFY-ADJ-QUEUE-NAME TO PC238-VRFY-ADJ-QUEUE-NAME.   64280081
642900     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       64290081
643000                                                                  64300081
643100     MOVE LENGTH OF PC238-COMM-AREA                               64310081
643200                                  TO PV-COMMAREA-LENGTH.          64320081
643300                                                                  64330081
643400     EXEC CICS                                                    64340081
643500         LINK PROGRAM  (PC-PCKCS756)                              64350081
643600              COMMAREA (PC238-COMM-AREA)                          64360081
643700              LENGTH   (PV-COMMAREA-LENGTH)                       64370081
643800              RESP     (PV-CICS-RESP)                             64380081
643900     END-EXEC.                                                    64390081
644000                                                                  64400081
644100     EVALUATE TRUE                                                64410081
644200         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     64420081
644300              IF  PC238-MOD-UNSUCCESSFUL                          64430081
644400                  PERFORM 8810-MOD-UNSUCCESSFUL                   64440081
644500              END-IF                                              64450081
644600         WHEN OTHER                                               64460081
644700              MOVE PC238-PO-NBR       TO PV-DISP-PO-NBR           64470081
644800              MOVE PC238-RCVR-SEQ-NBR TO PV-DISP-REC-SEQ-NBR      64480081
644900              MOVE PC238-PO-LNE-NBR   TO PV-DISP-LNE-NBR          64490081
645000              MOVE PC238-WRKD-OPER-UNT-ID                         64500081
645100                                      TO PV-DISP-OPER-UNT-ID      64510081
645200              MOVE PC238-BAD-SQL-CDE  TO PV-DISP-SQL-CODE         64520081
645300              MOVE PV-CICS-RESP       TO PV-DISP-CICS-RESP        64530081
645400              SET PS-UNITS-WORKED-ERROR  TO TRUE                  64540081
645500              STRING ' RCKCS819 - '      DELIMITED BY SIZE        64550081
645600                     ' 8800-UNITS-WORK-ROUTINE '                  64560081
645700                                         DELIMITED BY SIZE        64570081
645800                     ' BAD CALL TO UNITS WORKED MODULE '          64580081
645900                                         DELIMITED BY SIZE        64590081
646000                     ' - CICS RESP '                              64600081
646100                                         DELIMITED BY SIZE        64610081
646200                     PV-DISP-CICS-RESP                            64620081
646300                                         DELIMITED BY SIZE        64630081
646400                                      INTO PV-CICS-MSG-AREA       64640081
646500              MOVE LENGTH OF PV-CICS-MSG-AREA                     64650081
646600                                        TO PV-COMMAREA-LENGTH     64660081
646700              PERFORM 9700-WRITE-TO-CICS-LOG                      64670081
646800              MOVE SPACES TO PV-CICS-MSG-AREA                     64680081
646900              STRING ' RCKCS819 - '      DELIMITED BY SIZE        64690081
647000                     ' 8800-UNITS-WORK-ROUTINE '                  64700081
647100                                         DELIMITED BY SIZE        64710081
647200                     ' KEY INFO - '      DELIMITED BY SIZE        64720081
647300                     PV-DISP-PO-NBR      DELIMITED BY SIZE        64730081
647400                     ' - '               DELIMITED BY SIZE        64740081
647500                     PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE        64750081
647600                     ' - '               DELIMITED BY SIZE        64760081
647700                     PV-DISP-LNE-NBR     DELIMITED BY SIZE        64770081
647800                                  INTO PV-CICS-MSG-AREA           64780081
647900              MOVE LENGTH OF PV-CICS-MSG-AREA                     64790081
648000                                    TO PV-COMMAREA-LENGTH         64800081
648100              PERFORM 9700-WRITE-TO-CICS-LOG                      64810081
648200              PERFORM 9900-SOFT-ABORT                             64820081
648300     END-EVALUATE.                                                64830081
648400                                                                  64840081
648500******************************************************************64850081
648600* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *64860081
648700* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *64870081
648800* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *64880081
648900* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *64890081
649000******************************************************************64900081
649100 8810-MOD-UNSUCCESSFUL.                                           64910081
649200                                                                  64920081
649300     MOVE PC238-PO-NBR              TO PV-DISP-PO-NBR.            64930081
649400     MOVE PC238-RCVR-SEQ-NBR        TO PV-DISP-REC-SEQ-NBR.       64940081
649500     MOVE PC238-PO-LNE-NBR          TO PV-DISP-LNE-NBR.           64950081
649600     MOVE PC238-WRKD-OPER-UNT-ID    TO PV-DISP-OPER-UNT-ID.       64960081
649700     MOVE PC238-BAD-SQL-CDE         TO PV-DISP-SQL-CODE.          64970081
649800     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      64980081
649900     SET  PS-UPDATES-DONE           TO TRUE.                      64990081
650000                                                                  65000081
650100     IF  PC238-MOD-BAD-TMST                                       65010081
650200         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65020081
650300                ' 8800-UNITS-WORK-ROUTINE '                       65030081
650400                                    DELIMITED BY SIZE             65040081
650500                ' BAD TIMESTAMP '   DELIMITED BY SIZE             65050081
650600                PC238-WRKD-TMST     DELIMITED BY SIZE             65060081
650700                             INTO PV-CICS-MSG-AREA                65070081
650800         MOVE LENGTH OF PV-CICS-MSG-AREA                          65080081
650900                               TO PV-COMMAREA-LENGTH              65090081
651000         PERFORM 9700-WRITE-TO-CICS-LOG                           65100081
651100         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65110081
651200                ' 8800-UNITS-WORK-ROUTINE '                       65120081
651300                                    DELIMITED BY SIZE             65130081
651400                ' KEY INFO - '      DELIMITED BY SIZE             65140081
651500                PV-DISP-PO-NBR      DELIMITED BY SIZE             65150081
651600                ' - '               DELIMITED BY SIZE             65160081
651700                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             65170081
651800                ' - '               DELIMITED BY SIZE             65180081
651900                PV-DISP-LNE-NBR     DELIMITED BY SIZE             65190081
652000                             INTO PV-CICS-MSG-AREA                65200081
652100         MOVE LENGTH OF PV-CICS-MSG-AREA                          65210081
652200                               TO PV-COMMAREA-LENGTH              65220081
652300         PERFORM 9700-WRITE-TO-CICS-LOG                           65230081
652400         PERFORM 9900-SOFT-ABORT                                  65240081
652500     ELSE                                                         65250081
652600     IF  PC238-MOD-BAD-OPER                                       65260081
652700         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65270081
652800                ' 8800-UNITS-WORK-ROUTINE '                       65280081
652900                                    DELIMITED BY SIZE             65290081
653000                ' BAD OPER UNIT '   DELIMITED BY SIZE             65300081
653100                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             65310081
653200                             INTO PV-CICS-MSG-AREA                65320081
653300         MOVE LENGTH OF PV-CICS-MSG-AREA                          65330081
653400                               TO PV-COMMAREA-LENGTH              65340081
653500         PERFORM 9700-WRITE-TO-CICS-LOG                           65350081
653600         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65360081
653700                ' 8800-UNITS-WORK-ROUTINE '                       65370081
653800                                    DELIMITED BY SIZE             65380081
653900                ' KEY INFO - '      DELIMITED BY SIZE             65390081
654000                PV-DISP-PO-NBR      DELIMITED BY SIZE             65400081
654100                ' - '               DELIMITED BY SIZE             65410081
654200                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             65420081
654300                ' - '               DELIMITED BY SIZE             65430081
654400                PV-DISP-LNE-NBR     DELIMITED BY SIZE             65440081
654500                             INTO PV-CICS-MSG-AREA                65450081
654600         MOVE LENGTH OF PV-CICS-MSG-AREA                          65460081
654700                               TO PV-COMMAREA-LENGTH              65470081
654800         PERFORM 9700-WRITE-TO-CICS-LOG                           65480081
654900         PERFORM 9900-SOFT-ABORT                                  65490081
655000     ELSE                                                         65500081
655100     IF  PC238-MOD-BAD-TRANS-TYPE                                 65510081
655200         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65520081
655300                ' 8800-UNITS-WORK-ROUTINE '                       65530081
655400                                    DELIMITED BY SIZE             65540081
655500                ' BAD TRAN TYPE '   DELIMITED BY SIZE             65550081
655600                PC238-TRANS-TYPE-CDE                              65560081
655700                                    DELIMITED BY SIZE             65570081
655800                             INTO PV-CICS-MSG-AREA                65580081
655900         MOVE LENGTH OF PV-CICS-MSG-AREA                          65590081
656000                               TO PV-COMMAREA-LENGTH              65600081
656100         PERFORM 9700-WRITE-TO-CICS-LOG                           65610081
656200         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65620081
656300                ' 8800-UNITS-WORK-ROUTINE '                       65630081
656400                                    DELIMITED BY SIZE             65640081
656500                ' KEY INFO - '      DELIMITED BY SIZE             65650081
656600                PV-DISP-PO-NBR      DELIMITED BY SIZE             65660081
656700                ' - '               DELIMITED BY SIZE             65670081
656800                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             65680081
656900                ' - '               DELIMITED BY SIZE             65690081
657000                PV-DISP-LNE-NBR     DELIMITED BY SIZE             65700081
657100                             INTO PV-CICS-MSG-AREA                65710081
657200         MOVE LENGTH OF PV-CICS-MSG-AREA                          65720081
657300                               TO PV-COMMAREA-LENGTH              65730081
657400         PERFORM 9700-WRITE-TO-CICS-LOG                           65740081
657500         PERFORM 9900-SOFT-ABORT                                  65750081
657600     ELSE                                                         65760081
657700     IF  PC238-MOD-BAD-PO                                         65770081
657800         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65780081
657900                ' 8800-UNITS-WORK-ROUTINE '                       65790081
658000                                    DELIMITED BY SIZE             65800081
658100                ' BAD PO NUMBER '   DELIMITED BY SIZE             65810081
658200                PV-DISP-PO-NBR      DELIMITED BY SIZE             65820081
658300                             INTO PV-CICS-MSG-AREA                65830081
658400         MOVE LENGTH OF PV-CICS-MSG-AREA                          65840081
658500                               TO PV-COMMAREA-LENGTH              65850081
658600         PERFORM 9700-WRITE-TO-CICS-LOG                           65860081
658700         STRING ' RCKCS819 - '      DELIMITED BY SIZE             65870081
658800                ' 8800-UNITS-WORK-ROUTINE '                       65880081
658900                                    DELIMITED BY SIZE             65890081
659000                ' KEY INFO - '      DELIMITED BY SIZE             65900081
659100                PV-DISP-PO-NBR      DELIMITED BY SIZE             65910081
659200                ' - '               DELIMITED BY SIZE             65920081
659300                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             65930081
659400                ' - '               DELIMITED BY SIZE             65940081
659500                PV-DISP-LNE-NBR     DELIMITED BY SIZE             65950081
659600                             INTO PV-CICS-MSG-AREA                65960081
659700         MOVE LENGTH OF PV-CICS-MSG-AREA                          65970081
659800                               TO PV-COMMAREA-LENGTH              65980081
659900         PERFORM 9700-WRITE-TO-CICS-LOG                           65990081
660000         PERFORM 9900-SOFT-ABORT                                  66000081
660100     ELSE                                                         66010081
660200     IF  PC238-MOD-BAD-RCVR                                       66020081
660300         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66030081
660400                ' 8800-UNITS-WORK-ROUTINE '                       66040081
660500                                    DELIMITED BY SIZE             66050081
660600                ' BAD RCVR NBR  '   DELIMITED BY SIZE             66060081
660700                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             66070081
660800                             INTO PV-CICS-MSG-AREA                66080081
660900         MOVE LENGTH OF PV-CICS-MSG-AREA                          66090081
661000                               TO PV-COMMAREA-LENGTH              66100081
661100         PERFORM 9700-WRITE-TO-CICS-LOG                           66110081
661200         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66120081
661300                ' 8800-UNITS-WORK-ROUTINE '                       66130081
661400                                    DELIMITED BY SIZE             66140081
661500                ' KEY INFO - '      DELIMITED BY SIZE             66150081
661600                PV-DISP-PO-NBR      DELIMITED BY SIZE             66160081
661700                ' - '               DELIMITED BY SIZE             66170081
661800                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             66180081
661900                ' - '               DELIMITED BY SIZE             66190081
662000                PV-DISP-LNE-NBR     DELIMITED BY SIZE             66200081
662100                             INTO PV-CICS-MSG-AREA                66210081
662200         MOVE LENGTH OF PV-CICS-MSG-AREA                          66220081
662300                               TO PV-COMMAREA-LENGTH              66230081
662400         PERFORM 9700-WRITE-TO-CICS-LOG                           66240081
662500         PERFORM 9900-SOFT-ABORT                                  66250081
662600     ELSE                                                         66260081
662700     IF  PC238-MOD-BAD-LINE                                       66270081
662800         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66280081
662900                ' 8800-UNITS-WORK-ROUTINE '                       66290081
663000                                    DELIMITED BY SIZE             66300081
663100                ' BAD LINE NBR  '   DELIMITED BY SIZE             66310081
663200                PV-DISP-LNE-NBR     DELIMITED BY SIZE             66320081
663300                             INTO PV-CICS-MSG-AREA                66330081
663400         MOVE LENGTH OF PV-CICS-MSG-AREA                          66340081
663500                               TO PV-COMMAREA-LENGTH              66350081
663600         PERFORM 9700-WRITE-TO-CICS-LOG                           66360081
663700         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66370081
663800                ' 8800-UNITS-WORK-ROUTINE '                       66380081
663900                                    DELIMITED BY SIZE             66390081
664000                ' KEY INFO - '      DELIMITED BY SIZE             66400081
664100                PV-DISP-PO-NBR      DELIMITED BY SIZE             66410081
664200                ' - '               DELIMITED BY SIZE             66420081
664300                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             66430081
664400                ' - '               DELIMITED BY SIZE             66440081
664500                PV-DISP-LNE-NBR     DELIMITED BY SIZE             66450081
664600                             INTO PV-CICS-MSG-AREA                66460081
664700         MOVE LENGTH OF PV-CICS-MSG-AREA                          66470081
664800                               TO PV-COMMAREA-LENGTH              66480081
664900         PERFORM 9700-WRITE-TO-CICS-LOG                           66490081
665000         PERFORM 9900-SOFT-ABORT                                  66500081
665100     ELSE                                                         66510081
665200     IF  PC238-MOD-BAD-NO-SHIFT                                   66520081
665300         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66530081
665400                ' 8800-UNITS-WORK-ROUTINE '                       66540081
665500                                    DELIMITED BY SIZE             66550081
665600                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             66560081
665700                PC238-WRKD-TMST     DELIMITED BY SIZE             66570081
665800                ' FOR OPER '        DELIMITED BY SIZE             66580081
665900                PV-DISP-OPER-UNT-ID DELIMITED BY SIZE             66590081
666000                             INTO PV-CICS-MSG-AREA                66600081
666100         MOVE LENGTH OF PV-CICS-MSG-AREA                          66610081
666200                               TO PV-COMMAREA-LENGTH              66620081
666300         PERFORM 9700-WRITE-TO-CICS-LOG                           66630081
666400         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66640081
666500                ' 8800-UNITS-WORK-ROUTINE '                       66650081
666600                                    DELIMITED BY SIZE             66660081
666700                ' KEY INFO - '      DELIMITED BY SIZE             66670081
666800                PV-DISP-PO-NBR      DELIMITED BY SIZE             66680081
666900                ' - '               DELIMITED BY SIZE             66690081
667000                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             66700081
667100                ' - '               DELIMITED BY SIZE             66710081
667200                PV-DISP-LNE-NBR     DELIMITED BY SIZE             66720081
667300                             INTO PV-CICS-MSG-AREA                66730081
667400         MOVE LENGTH OF PV-CICS-MSG-AREA                          66740081
667500                               TO PV-COMMAREA-LENGTH              66750081
667600         PERFORM 9700-WRITE-TO-CICS-LOG                           66760081
667700         PERFORM 9900-SOFT-ABORT                                  66770081
667800     ELSE                                                         66780081
667900         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66790081
668000                ' 8800-UNITS-WORK-ROUTINE '                       66800081
668100                                    DELIMITED BY SIZE             66810081
668200                ' DB ERROR - SQL CODE '                           66820081
668300                                    DELIMITED BY SIZE             66830081
668400                PV-DISP-SQL-CODE DELIMITED BY SIZE                66840081
668500                ' FUNC: '           DELIMITED BY SIZE             66850081
668600                PC238-BAD-TABLE-FUNCTION                          66860081
668700                                    DELIMITED BY SIZE             66870081
668800                ' TABLE: '          DELIMITED BY SIZE             66880081
668900                PC238-BAD-TABLE-NAME                              66890081
669000                                    DELIMITED BY SIZE             66900081
669100                             INTO PV-CICS-MSG-AREA                66910081
669200         MOVE LENGTH OF PV-CICS-MSG-AREA                          66920081
669300                               TO PV-COMMAREA-LENGTH              66930081
669400         PERFORM 9700-WRITE-TO-CICS-LOG                           66940081
669500         STRING ' RCKCS819 - '      DELIMITED BY SIZE             66950081
669600                ' 8800-UNITS-WORK-ROUTINE '                       66960081
669700                                    DELIMITED BY SIZE             66970081
669800                ' KEY INFO - '      DELIMITED BY SIZE             66980081
669900                PV-DISP-PO-NBR      DELIMITED BY SIZE             66990081
670000                ' - '               DELIMITED BY SIZE             67000081
670100                PV-DISP-REC-SEQ-NBR DELIMITED BY SIZE             67010081
670200                ' - '               DELIMITED BY SIZE             67020081
670300                PV-DISP-LNE-NBR     DELIMITED BY SIZE             67030081
670400                             INTO PV-CICS-MSG-AREA                67040081
670500         MOVE LENGTH OF PV-CICS-MSG-AREA                          67050081
670600                               TO PV-COMMAREA-LENGTH              67060081
670700         PERFORM 9700-WRITE-TO-CICS-LOG                           67070081
670800         PERFORM 9900-SOFT-ABORT                                  67080081
670900     END-IF                                                       67090081
671000     END-IF                                                       67100081
671100     END-IF                                                       67110081
671200     END-IF                                                       67120081
671300     END-IF                                                       67130081
671400     END-IF                                                       67140081
671500     END-IF.                                                      67150081
671600                                                                  67160081
671700                                                                  67170081
671800******************************************************************67180081
671900* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *67190081
672000* OBJECT WAS UPDATED.                                            *67200081
672100******************************************************************67210081
672200 9000-UPDATE-SELECTION-QUEUE.                                     67220081
672300                                                                  67230081
672400     PERFORM 9100-READ-SEL-QUEUE                                  67240081
672500                                                                  67250081
672600     SET RC037-UPD (ASC-SEL-SUB) TO TRUE                          67260081
672700     PERFORM 9200-REWRITE-SEL-QUEUE.                              67270081
672800                                                                  67280081
672900*----------------------------------------------------------------*67290081
673000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *67300081
673100*----------------------------------------------------------------*67310081
673200 9100-READ-SEL-QUEUE.                                             67320081
673300     EXEC CICS                                                    67330081
673400         READQ TS                                                 67340081
673500             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        67350081
673600             INTO  (RC037-DC-SELECT-RECORD)                       67360081
673700             ITEM  (ASC-SEL-ITEM)                                 67370081
673800             RESP  (PV-CICS-RESP)                                 67380081
673900     END-EXEC.                                                    67390081
674000                                                                  67400081
674100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       67410081
674200         CONTINUE                                                 67420081
674300     ELSE                                                         67430081
674400         SET DP013-LOGIC-ABEND                                    67440081
674500             DP013-NO-ROLLBACK     TO TRUE                        67450081
674600         MOVE '9100-READ-SEL-QUEUE'                               67460081
674700                                   TO DP013-PARAGRAPH             67470081
674800         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   67480081
674900                                   TO DP013-MESSAGE-TEXT (1)      67490081
675000         PERFORM DP013-0000-PROCESS-ABEND                         67500081
675100     END-IF.                                                      67510081
675200                                                                  67520081
675300                                                                  67530081
675400*----------------------------------------------------------------*67540081
675500* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *67550081
675600*----------------------------------------------------------------*67560081
675700 9200-REWRITE-SEL-QUEUE.                                          67570081
675800     EXEC CICS                                                    67580081
675900          WRITEQ TS                                               67590081
676000              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      67600081
676100              FROM   (RC037-DC-SELECT-RECORD)                     67610081
676200              ITEM   (ASC-SEL-ITEM)                               67620081
676300              RESP   (PV-CICS-RESP)                               67630081
676400              REWRITE                                             67640081
676500     END-EXEC.                                                    67650081
676600                                                                  67660081
676700     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           67670081
676800         CONTINUE                                                 67680081
676900     ELSE                                                         67690081
677000         SET DP013-CICS-ABEND                                     67700081
677100             DP013-NO-ROLLBACK     TO TRUE                        67710081
677200         MOVE '9200-REWRITE-SEL-QUEUE'                            67720081
677300                                   TO DP013-PARAGRAPH             67730081
677400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   67740081
677500                                   TO DP013-MESSAGE-TEXT (1)      67750081
677600         PERFORM DP013-0000-PROCESS-ABEND                         67760081
677700     END-IF.                                                      67770081
677800                                                                  67780081
677900******************************************************************67790081
678000* READ AN ITEM FROM THE INPUT TROUBLE RECORD                     *67800081
678100* TEMP STORAGE QUEUE.                                            *67810081
678200******************************************************************67820081
678300 9500-READ-TRB-QUEUE.                                             67830081
678400                                                                  67840081
678500     EXEC CICS                                                    67850081
678600         READQ TS                                                 67860081
678700             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        67870081
678800             INTO  (TM003-TRB-QUEUE-WORK-AREA)                    67880081
678900             ITEM  (PC-01-COMP)                                   67890081
679000             RESP  (PV-CICS-RESP)                                 67900081
679100     END-EXEC.                                                    67910081
679200                                                                  67920081
679300     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        67930081
679400         CONTINUE                                                 67940081
679500     ELSE                                                         67950081
679600         SET DP013-LOGIC-ABEND                                    67960081
679700             DP013-NO-ROLLBACK   TO TRUE                          67970081
679800         MOVE '9500-READ-TRB-QUEUE'                               67980081
679900                                 TO DP013-PARAGRAPH               67990081
680000         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    68000081
680100                                 TO DP013-MESSAGE-TEXT (1)        68010081
680200         MOVE ASC-TRB-QUEUE-NAME-IN                               68020081
680300                                 TO DP013-MESSAGE-TEXT (2)        68030081
680400         PERFORM DP013-0000-PROCESS-ABEND                         68040081
680500     END-IF.                                                      68050081
680600                                                                  68060081
680700 9600-WRITE-TRB-QUEUE.                                            68070081
680800                                                                  68080081
680900*  RCKCS277 WRITES ONLY 1 QUEUE RECORD SO THE ITEM NUMBER         68090081
681000*  WILL ALWAYS EQUAL 1.                                           68100081
681100     EXEC CICS WRITEQ TS                                          68110081
681200             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        68120081
681300             FROM  (TM003-TRB-QUEUE-WORK-AREA)                    68130081
681400             ITEM  (PC-01-COMP)                                   68140081
681500             RESP  (PV-CICS-RESP)                                 68150081
681600             REWRITE                                              68160081
681700     END-EXEC.                                                    68170081
681800                                                                  68180081
681900     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       68190081
682000         SET DP013-CICS-ABEND                                     68200081
682100             DP013-NO-ROLLBACK   TO TRUE                          68210081
682200         MOVE '9600-WRITE-TRB-QUEUE'                              68220081
682300                                 TO DP013-PARAGRAPH               68230081
682400         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'68240081
682500                                 TO DP013-MESSAGE-TEXT(1)         68250081
682600         PERFORM DP013-0000-PROCESS-ABEND                         68260081
682700     END-IF.                                                      68270081
682800                                                                  68280081
682900                                                                  68290081
683000 9700-WRITE-TO-CICS-LOG.                                          68300081
683100                                                                  68310081
683200     EXEC CICS                                                    68320081
683300          WRITEQ TD                                               68330081
683400          QUEUE  ('CSSL')                                         68340081
683500          FROM  (PV-CICS-MSG-AREA)                                68350081
683600          LENGTH  (PV-COMMAREA-LENGTH)                            68360081
683700          RESP  (PV-CICS-RESP)                                    68370081
683800     END-EXEC.                                                    68380081
683900                                                                  68390081
684000     MOVE SPACES TO PV-CICS-MSG-AREA.                             68400081
684100                                                                  68410081
684200                                                                  68420081
684300******************************************************************68430081
684400*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *68440081
684500*    AND THE ERROR SWITCHES.                                     *68450081
684600******************************************************************68460081
684700 9900-SOFT-ABORT.                                                 68470081
684800     SET PS-ERROR         TO TRUE.                                68480081
684900     SET DP020-MSG-FATAL  TO TRUE.                                68490081
685000     IF SQLCODE = -913                                            68500081
685100         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 68510081
685200     END-IF.                                                      68520081
685300     IF  PS-UNITS-WORKED-ERROR                                    68530081
685400         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 68540081
685500     END-IF.                                                      68550081
685600     PERFORM 9901-BACKUP.                                         68560081
685700     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          68570081
685800     PERFORM 0001-CALL-CICS-ARCH-API.                             68580081
685900                                                                  68590081
686000 9901-BACKUP.                                                     68600081
686100     EXEC CICS SYNCPOINT                                          68610081
686200          ROLLBACK                                                68620081
686300     END-EXEC.                                                    68630081
686400                                                                  68640081
686500*----------------------------------------------------------------*68650081
686600*    ABEND PROCESSOR MODULE                                      *68660081
686700*----------------------------------------------------------------*68670081
686800                                                                  68680081
686900     COPY DPPD013.                                                68690081
