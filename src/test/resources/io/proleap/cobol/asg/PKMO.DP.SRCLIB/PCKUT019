000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.        PCKUT019.                                     00050000
000600 AUTHOR.            PATRICK BURKE.                                00060000
000700 INSTALLATION.      KOHLS.                                        00070000
000800 DATE-WRITTEN       DECEMBER 2001.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  PROGRAM WILL BE USED TO EXTRACT INFORMATION FROM THE UNITS     00120000
001300*  WORKED DATABASES TO PASS ONTO REPORTING PROGRAMS.              00130000
001400******************************************************************00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600******************************************************************00160000
001700 CONFIGURATION SECTION.                                           00170000
001800 SOURCE-COMPUTER.   IBM-3090.                                     00180000
001900 OBJECT-COMPUTER.   IBM-3090.                                     00190000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100                                                                  00210000
002200 FILE-CONTROL.                                                    00220000
002300     SELECT EXTRACT-FILE                                          00230000
002400         ASSIGN TO OUT01.                                         00240000
002500                                                                  00250000
002600***************************************************************** 00260000
002700 DATA DIVISION.                                                   00270000
002800***************************************************************** 00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  EXTRACT-FILE                                                 00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS.                                    00340000
003500 01  EXTRACT-RECORD               PIC X(170).                     00350000
003600                                                                  00360000
003700***************************************************************** 00370000
003800 WORKING-STORAGE SECTION.                                         00380000
003900***************************************************************** 00390000
004000/                                                                 00400000
004100 01  ABEND-CODE                       PIC S9(04)  COMP SYNC       00410000
004200                                                    VALUE ZERO.   00420000
004300 01  DK-DB2-KEYS.                                                 00430000
004400     05  DK-OPER-UNT-ID               PIC S9(04) COMP SYNC        00440000
004500                                                    VALUE ZERO.   00450000
004600                                                                  00460000
004700 01  PS-PROGRAM-SWITCHES.                                         00470000
004800     05  PS-WRITE-EXTRACT-SW          PIC X(01) VALUE 'N'.        00480000
004900         88  PS-WRITE-EXTRACT                   VALUE 'Y'.        00490000
005000         88  PS-WRITE-EXTRACT-NO                VALUE 'N'.        00500000
005100     05  PS-WRITE-PREV-SW             PIC X(01) VALUE 'N'.        00510000
005200         88  PS-WRITE-PREV                      VALUE 'Y'.        00520000
005300         88  PS-WRITE-PREV-NO                   VALUE 'N'.        00530000
005400     05  PS-CURSOR-OPENED-SW          PIC X(01) VALUE 'N'.        00540000
005500         88  PS-CURSOR-OPENED-YES               VALUE 'Y'.        00550000
005600         88  PS-CURSOR-OPENED-NO                VALUE 'Y'.        00560000
005700     05  PS-TABLE-CONTENTION-SW       PIC X(01) VALUE 'N'.        00570000
005800         88  PS-NOT-TABLE-CONTENTION            VALUE 'N'.        00580000
005900         88  PS-TABLE-CONTENTION                VALUE 'Y'.        00590000
006000     05  PS-EOF-CSR-SW                PIC X(01) VALUE 'N'.        00600000
006100         88  PS-EOF-CSR                         VALUE 'Y'.        00610000
006200         88  PS-NOT-EOF-CSR                     VALUE 'N'.        00620000
006300     05  PS-ERROR-SW                  PIC X(01) VALUE 'N'.        00630000
006400         88  PS-ERROR                           VALUE 'Y'.        00640000
006500         88  PS-ERROR-NO                        VALUE 'N'.        00650000
006600                                                                  00660000
006700 01  PC-PROGRAM-CONSTANTS.                                        00670000
006800     05  PC-DEFAULT-DATE              PIC  X(10)  VALUE           00680000
006900         '9999-09-09'.                                            00690000
007000     05  PC-DEFAULT-TM                PIC  X(08)  VALUE           00700000
007100         '00.00.00'.                                              00710000
007200     05  PC-1                         PIC S9(3) COMP-3            00720000
007300                                                     VALUE +1.    00730000
007400                                                                  00740000
007500 01  PV-PROGRAM-VARIABLES.                                        00750000
007600     05  PV-SHIFT                     PIC S9(04) COMP VALUE ZERO. 00760000
007700     05  PV-SHFT-NBR                  PIC S9(04) COMP VALUE ZERO. 00770000
007800     05  PV-PREV-SHFT-NBR             PIC S9(04) COMP VALUE ZERO. 00780000
007900     05  PV-OPER-NBR                  PIC S9(04) COMP VALUE ZERO. 00790000
008000     05  PV-PREV-OPER-NBR             PIC S9(04) COMP VALUE ZERO. 00800000
008100     05  PV-PREV-ORD-NBR              PIC S9(09) COMP VALUE ZERO. 00810000
008200     05  PV-PREV-RCVR-SEQ-NBR         PIC S9(09) COMP VALUE ZERO. 00820000
008300     05  PV-DUMMY-TMST                PIC X(26)  VALUE            00830000
008400         '9998-09-09-09.09.09.999999'.                            00840000
008500     05  PV-DISP-NUM                  PIC ZZZ,ZZ9.                00850000
008600     05  PV-START-RPT-DATE            PIC X(10) VALUE SPACES.     00860000
008700     05  PV-END-RPT-DATE              PIC X(10) VALUE SPACES.     00870000
008800     05  PV-KEY-DATE                  PIC X(10) VALUE SPACES.     00870103
008900     05  PV-PREV-OPER-UNIT-ID         PIC 9(04) VALUE ZEROS.      00871000
009000     05  PV-PREV-PROCESS-AREA         PIC X(06) VALUE SPACES.     00872000
009100     05  PV-PREV-PROCESS-GROUP        PIC X(06) VALUE SPACES.     00873000
009200     05  PV-DATA-PERIOD-IND           PIC X(01).                  00874003
009300         88  PV-DATA-TYPE-CURRENT               VALUE 'A'.        00875003
009400         88  PV-DATA-TYPE-PREVIOUS              VALUE 'B'.        00876003
009500                                                                  00880000
009600******************************************************************00890000
009700 01  PV-DC-SHFT-SUM.                                              00900000
009800     05  PV-OPER-UNT-WRKD-SUM        PIC S9(13) VALUE ZERO.       00910000
009900     05  PV-OPER-CART-WRKD-SUM       PIC S9(13) VALUE ZERO.       00920000
010000     05  PV-OPER-PO-RCVR-WRKD-SUM    PIC S9(13) VALUE ZERO.       00930000
010100     05  PV-OPER-EXTD-RTL-WRKD-SUM   PIC S9(13)V9(2)              00940000
010200                                                  VALUE ZERO.     00950000
010300                                                                  00960000
010400 01  PV-DC-TOT-SUM.                                               00970000
010500     05  PV-DC-UNT-WRKD-SUM          PIC S9(13) VALUE ZERO.       00980000
010600     05  PV-DC-CART-WRKD-SUM         PIC S9(13) VALUE ZERO.       00990000
010700     05  PV-DC-PO-RCVR-WRKD-SUM      PIC S9(13) VALUE ZERO.       01000000
010800     05  PV-DC-EXTD-RTL-WRKD-SUM     PIC S9(13)V9(2)              01010000
010900                                                  VALUE ZERO.     01020000
011000                                                                  01030000
011010 01  PV-FETCH-BUCKETS.                                                    
011020     05  PV-PCT00005-UNT-WRKD-QTY     PIC S9(13) VALUE ZERO       13670000
011021                                                 COMP-3.                  
011030     05  PV-PCT00005-CART-WRKD-QTY    PIC S9(13) VALUE ZERO       13680000
011031                                                 COMP-3.                  
011040     05  PV-PCT00005-PO-RCVR-WRKD-QTY PIC S9(13) VALUE ZERO       13690000
011050                                                 COMP-3.                  
011100     05  PV-PCT00005-EXTD-RTL-WRKD-AMT PIC S9(13)V9(2) VALUE ZERO 01031011
011101                                                 COMP-3.                  
011102 01  PV-SELECT-BUCKETS.                                                   
011103     05  PV-PCT00006-UNT-VRFD-QTY     PIC S9(13) VALUE ZERO       13670000
011104                                                 COMP-3.                  
011105     05  PV-PCT00006-CART-VRFD-QTY    PIC S9(13) VALUE ZERO       13680000
011106                                                 COMP-3.                  
011107     05  PV-PCT00006-PO-RCVR-VRFD-QTY PIC S9(13) VALUE ZERO       13690000
011108                                                 COMP-3.                  
011109     05  PV-PCT00006-EXTD-RTL-VRFD-AMT PIC S9(13)V9(2) VALUE ZERO 01031011
011110                                                 COMP-3.                  
011120                                                                          
011200 01  PV-COMP-SUM.                                                 01040000
011300     05  PV-COMP-UNT-WRKD-SUM        PIC S9(13) VALUE ZERO.       01050000
011400     05  PV-COMP-CART-WRKD-SUM       PIC S9(13) VALUE ZERO.       01060000
011500     05  PV-COMP-PO-RCVR-WRKD-SUM    PIC S9(13) VALUE ZERO.       01070000
011600     05  PV-COMP-EXTD-RTL-WRKD-SUM   PIC S9(13)V9(2)              01080000
011700                                                  VALUE ZERO.     01090000
011800                                                                  01100000
011900 01  PV-COMP-TOT.                                                 01110000
012000     05  PV-COMP-UNT-WRKD-TOT        PIC S9(13) VALUE ZERO.       01120000
012100     05  PV-COMP-CART-WRKD-TOT       PIC S9(13) VALUE ZERO.       01130000
012200     05  PV-COMP-PO-RCVR-WRKD-TOT    PIC S9(13) VALUE ZERO.       01140000
012300     05  PV-COMP-EXTD-RTL-WRKD-TOT   PIC S9(13)V9(2)              01150000
012400                                                  VALUE ZERO.     01160000
012500                                                                  01170000
012600 01  PV-SHFT-VRFD-SUM.                                            01180000
012700     05  PV-SHFT-VRFD-UNT-SUM        PIC S9(13) VALUE ZERO.       01190000
012800     05  PV-SHFT-VRFD-CART-SUM       PIC S9(13) VALUE ZERO.       01200000
012900     05  PV-SHFT-VRFD-PO-RCVR-SUM    PIC S9(13) VALUE ZERO.       01210000
013000     05  PV-SHFT-VRFD-EXTD-RTL-SUM   PIC S9(13)V9(2)              01220000
013100                                                  VALUE ZERO.     01230000
013200                                                                  01240000
013300******************************************************************01250000
013400*   TOTALS FOR SHIFT LEVEL.                                       01260000
013500******************************************************************01270000
013600 01  PV-SHFT-SUM.                                                 01280000
013700     05  PV-SHFT-UNT-WRKD-SUM         PIC S9(13) VALUE ZERO.      01290000
013800     05  PV-SHFT-CART-WRKD-SUM        PIC S9(13) VALUE ZERO.      01300000
013900     05  PV-SHFT-PO-RCVR-WRKD-SUM     PIC S9(13) VALUE ZERO.      01310000
014000     05  PV-SHFT-EXTD-RTL-WRKD-SUM    PIC S9(13)V9(2)             01320000
014100                                                  VALUE ZERO.     01330000
014200                                                                  01340000
014300******************************************************************01350000
014400*    OPER, COMPANY AND VERIFIED LEVELS FOR ALL THREE SHIFTS.      01360000
014500******************************************************************01370000
014600 01  PV-OPER1-SUM.                                                01380000
014700     05  PV-OPER1-UNT-WRKD-SUM         PIC S9(13) VALUE ZERO.     01390000
014800     05  PV-OPER1-CART-WRKD-SUM        PIC S9(13) VALUE ZERO.     01400000
014900     05  PV-OPER1-PO-RCVR-WRKD-SUM     PIC S9(13) VALUE ZERO.     01410000
015000     05  PV-OPER1-EXTD-RTL-WRKD-SUM    PIC S9(13)V9(2)            01420000
015100                                                  VALUE ZERO.     01430000
015200                                                                  01440000
015300 01  PV-OPER2-SUM.                                                01450000
015400     05  PV-OPER2-UNT-WRKD-SUM         PIC S9(13) VALUE ZERO.     01460000
015500     05  PV-OPER2-CART-WRKD-SUM        PIC S9(13) VALUE ZERO.     01470000
015600     05  PV-OPER2-PO-RCVR-WRKD-SUM     PIC S9(13) VALUE ZERO.     01480000
015700     05  PV-OPER2-EXTD-RTL-WRKD-SUM    PIC S9(13)V9(2)            01490000
015800                                                  VALUE ZERO.     01500000
015900 01  PV-OPER3-SUM.                                                01510000
016000     05  PV-OPER3-UNT-WRKD-SUM         PIC S9(13) VALUE ZERO.     01520000
016100     05  PV-OPER3-CART-WRKD-SUM        PIC S9(13) VALUE ZERO.     01530000
016200     05  PV-OPER3-PO-RCVR-WRKD-SUM     PIC S9(13) VALUE ZERO.     01540000
016300     05  PV-OPER3-EXTD-RTL-WRKD-SUM    PIC S9(13)V9(2)            01550000
016400                                                  VALUE ZERO.     01560000
016500                                                                  01570000
016600******************************************************************01580000
016700 01  PV-COMP1-SUM.                                                01590000
016800     05  PV-COMP1-UNT-WRKD-SUM         PIC S9(13) VALUE ZERO.     01600000
016900     05  PV-COMP1-CART-WRKD-SUM        PIC S9(13) VALUE ZERO.     01610000
017000     05  PV-COMP1-PO-RCVR-WRKD-SUM     PIC S9(13) VALUE ZERO.     01620000
017100     05  PV-COMP1-EXTD-RTL-WRKD-SUM    PIC S9(13)V9(2)            01630000
017200                                                 VALUE ZERO.      01640000
017300 01  PV-COMP2-SUM.                                                01650000
017400     05  PV-COMP2-UNT-WRKD-SUM         PIC S9(13) VALUE ZERO.     01660000
017500     05  PV-COMP2-CART-WRKD-SUM        PIC S9(13) VALUE ZERO.     01670000
017600     05  PV-COMP2-PO-RCVR-WRKD-SUM     PIC S9(13) VALUE ZERO.     01680000
017700     05  PV-COMP2-EXTD-RTL-WRKD-SUM    PIC S9(13)V9(2)            01690000
017800                                                 VALUE ZERO.      01700000
017900 01  PV-COMP3-SUM.                                                01710000
018000     05  PV-COMP3-UNT-WRKD-SUM         PIC S9(13) VALUE ZERO.     01720000
018100     05  PV-COMP3-CART-WRKD-SUM        PIC S9(13) VALUE ZERO.     01730000
018200     05  PV-COMP3-PO-RCVR-WRKD-SUM     PIC S9(13) VALUE ZERO.     01740000
018300     05  PV-COMP3-EXTD-RTL-WRKD-SUM    PIC S9(13)V9(2)            01750000
018400                                                 VALUE ZERO.      01760000
018500                                                                  01770000
018600******************************************************************01780000
018700 01  PV-VRFD1-SUM.                                                01790000
018800     05  PV-VRFD1-UNT-SUM              PIC S9(13) VALUE ZERO.     01800000
018900     05  PV-VRFD1-CART-SUM             PIC S9(13) VALUE ZERO.     01810000
019000     05  PV-VRFD1-PO-RCVR-SUM          PIC S9(13) VALUE ZERO.     01820000
019100     05  PV-VRFD1-EXTD-RTL-SUM         PIC S9(13)V9(2)            01830000
019200                                                 VALUE ZERO.      01840000
019300 01  PV-VRFD2-SUM.                                                01850000
019400     05  PV-VRFD2-UNT-SUM              PIC S9(13) VALUE ZERO.     01860000
019500     05  PV-VRFD2-CART-SUM             PIC S9(13) VALUE ZERO.     01870000
019600     05  PV-VRFD2-PO-RCVR-SUM          PIC S9(13) VALUE ZERO.     01880000
019700     05  PV-VRFD2-EXTD-RTL-SUM         PIC S9(13)V9(2)            01890000
019800                                                 VALUE ZERO.      01900000
019900 01  PV-VRFD3-SUM.                                                01910000
020000     05  PV-VRFD3-UNT-SUM              PIC S9(13) VALUE ZERO.     01920000
020100     05  PV-VRFD3-CART-SUM             PIC S9(13) VALUE ZERO.     01930000
020200     05  PV-VRFD3-PO-RCVR-SUM          PIC S9(13) VALUE ZERO.     01940000
020300     05  PV-VRFD3-EXTD-RTL-SUM         PIC S9(13)V9(2)            01950000
020400                                                 VALUE ZERO.      01960000
020500/                                                                 01970000
020600******************************************************************01980000
020700 01  PV-VRFD1-OPER-SUM.                                           01990000
020800     05  PV-VRFD1-OPER-UNT-SUM        PIC S9(13) VALUE ZERO.      02000000
020900     05  PV-VRFD1-OPER-CART-SUM       PIC S9(13) VALUE ZERO.      02010000
021000     05  PV-VRFD1-OPER-PO-RCVR-SUM    PIC S9(13) VALUE ZERO.      02020000
021100     05  PV-VRFD1-OPER-EXTD-RTL-SUM   PIC S9(13)V9(2)             02030000
021200                                                 VALUE ZERO.      02040000
021300 01  PV-VRFD2-OPER-SUM.                                           02050000
021400     05  PV-VRFD2-OPER-UNT-SUM        PIC S9(13) VALUE ZERO.      02060000
021500     05  PV-VRFD2-OPER-CART-SUM       PIC S9(13) VALUE ZERO.      02070000
021600     05  PV-VRFD2-OPER-PO-RCVR-SUM    PIC S9(13) VALUE ZERO.      02080000
021700     05  PV-VRFD2-OPER-EXTD-RTL-SUM   PIC S9(13)V9(2)             02090000
021800                                                 VALUE ZERO.      02100000
021900 01  PV-VRFD3-OPER-SUM.                                           02110000
022000     05  PV-VRFD3-OPER-UNT-SUM        PIC S9(13) VALUE ZERO.      02120000
022100     05  PV-VRFD3-OPER-CART-SUM       PIC S9(13) VALUE ZERO.      02130000
022200     05  PV-VRFD3-OPER-PO-RCVR-SUM    PIC S9(13) VALUE ZERO.      02140000
022300     05  PV-VRFD3-OPER-EXTD-RTL-SUM   PIC S9(13)V9(2)             02150000
022400                                                 VALUE ZERO.      02160000
022500/                                                                 02170000
022600******************************************************************02180000
022700 01  PV-VRFD1-COMP-SUM.                                           02190000
022800     05  PV-VRFD1-COMP-UNT-SUM        PIC S9(13) VALUE ZERO.      02200000
022900     05  PV-VRFD1-COMP-CART-SUM       PIC S9(13) VALUE ZERO.      02210000
023000     05  PV-VRFD1-COMP-PO-RCVR-SUM    PIC S9(13) VALUE ZERO.      02220000
023100     05  PV-VRFD1-COMP-EXTD-RTL-SUM   PIC S9(13)V9(2)             02230000
023200                                                 VALUE ZERO.      02240000
023300 01  PV-VRFD2-COMP-SUM.                                           02250000
023400     05  PV-VRFD2-COMP-UNT-SUM        PIC S9(13) VALUE ZERO.      02260000
023500     05  PV-VRFD2-COMP-CART-SUM       PIC S9(13) VALUE ZERO.      02270000
023600     05  PV-VRFD2-COMP-PO-RCVR-SUM    PIC S9(13) VALUE ZERO.      02280000
023700     05  PV-VRFD2-COMP-EXTD-RTL-SUM   PIC S9(13)V9(2)             02290000
023800                                                 VALUE ZERO.      02300000
023900 01  PV-VRFD3-COMP-SUM.                                           02310000
024000     05  PV-VRFD3-COMP-UNT-SUM        PIC S9(13) VALUE ZERO.      02320000
024100     05  PV-VRFD3-COMP-CART-SUM       PIC S9(13) VALUE ZERO.      02330000
024200     05  PV-VRFD3-COMP-PO-RCVR-SUM    PIC S9(13) VALUE ZERO.      02340000
024300     05  PV-VRFD3-COMP-EXTD-RTL-SUM   PIC S9(13)V9(2)             02350000
024400                                                 VALUE ZERO.      02360000
024500/                                                                 02370000
024600******************************************************************02380000
024700 01  PV-OPER-VRFD-SUM.                                            02390000
024800     05  PV-OPER-VRFD-UNT-SUM            PIC S9(13) VALUE ZERO.   02400000
024900     05  PV-OPER-VRFD-CART-SUM           PIC S9(13) VALUE ZERO.   02410000
025000     05  PV-OPER-VRFD-PO-RCVR-SUM        PIC S9(13) VALUE ZERO.   02420000
025100     05  PV-OPER-VRFD-EXTD-RTL-SUM       PIC S9(13)V9(2)          02430000
025200                                                 VALUE ZERO.      02440000
025300 01  PV-COMP-VRFD-SUM.                                            02450000
025400     05  PV-COMP-VRFD-UNT-SUM            PIC S9(13) VALUE ZERO.   02460000
025500     05  PV-COMP-VRFD-CART-SUM           PIC S9(13) VALUE ZERO.   02470000
025600     05  PV-COMP-VRFD-PO-RCVR-SUM        PIC S9(13) VALUE ZERO.   02480000
025700     05  PV-COMP-VRFD-EXTD-RTL-SUM       PIC S9(13)V9(2)          02490000
025800                                                 VALUE ZERO.      02500000
025900/                                                                 02510000
026000******************************************************************02520000
026100 01  PV-COUNTERS.                                                 02530000
026200     05  PV-FIRST-CSR-FETCHED         PIC S9(7) COMP-3            02540000
026300                                                VALUE ZERO.       02550000
026400     05  PV-SECOND-CSR-FETCHED        PIC S9(7) COMP-3            02560000
026500                                                VALUE ZERO.       02570000
026600     05  PV-THIRD-CSR-FETCHED         PIC S9(7) COMP-3            02580000
026700                                                VALUE ZERO.       02590000
026800     05  PV-EXTRACTS-COUNTER          PIC S9(7) COMP-3            02600000
026900                                                VALUE ZERO.       02610000
027000/                                                                 02620000
027100****************************************************************  02630000
027200*  EXTRACT-RECORD                                                 02640000
027300****************************************************************  02650000
027400     COPY PCRD012.                                                02660000
027500/                                                                 02670000
027600****************************************************************  02680000
027700     COPY PCWS239.                                                02690000
027800/                                                                 02700000
027900****************************************************************  02710000
028000*  AREA ASSIGNED TABLE.                                           02720000
028100****************************************************************  02730000
028200     EXEC SQL                                                     02740000
028300         INCLUDE PCT00003                                         02750000
028400     END-EXEC.                                                    02760000
028500/                                                                 02770000
028600****************************************************************  02780000
028700*  UNITS WORKED TABLE.                                            02790000
028800****************************************************************  02800000
028900     EXEC SQL                                                     02810000
029000         INCLUDE PCT00005                                         02820000
029100     END-EXEC.                                                    02830000
029200/                                                                 02840000
029300****************************************************************  02850000
029400*  VERIFIED TABLE.                                                02860000
029500****************************************************************  02870000
029600     EXEC SQL                                                     02880000
029700         INCLUDE PCT00006                                         02890000
029800     END-EXEC.                                                    02900000
029900/                                                                 02910000
030000****************************************************************  02911003
030100*  DATE TABLE.                                                    02912003
030200****************************************************************  02913003
030300     EXEC SQL                                                     02914003
030400         INCLUDE TDTATTR                                          02915003
030500     END-EXEC.                                                    02916003
030600/                                                                 02917003
030700***************************************************************** 02920000
030800*    FIRST CURSOR (PROCESS AREA LEVEL)                          * 02930000
030900***************************************************************** 02940000
031000     EXEC SQL                                                     02950000
031100          DECLARE FIRST-CSR CURSOR FOR                            02960000
031200             SELECT OPER_UNT_ID                                   02970000
031300                  , SHFT_NBR                                      02980000
031400                  , PRCG_AREA_CDE                                 02990000
031500                  , SUM(UNT_WRKD_QTY)                             03000000
031600                  , SUM(CART_WRKD_QTY)                            03010000
031700                  , SUM(PO_RCVR_WRKD_QTY)                         03020000
031800                  , SUM(EXTD_RTL_WRKD_AMT)                        03030000
031900              FROM  PCT_SUM_WRKD                                  03040000
032000              WHERE BUS_DTE BETWEEN :PV-START-RPT-DATE            03050000
032100                                AND :PV-END-RPT-DATE              03060000
032200              GROUP BY OPER_UNT_ID, SHFT_NBR, PRCG_AREA_CDE       03070000
032300              ORDER BY OPER_UNT_ID, SHFT_NBR                      03080000
032400     END-EXEC.                                                    03090000
032500/                                                                 03100000
032600***************************************************************** 03110000
032700*    SECOND CURSOR (PROCESS GROUP LEVEL)                        * 03120000
032800***************************************************************** 03130000
032900*                                                                 03140000
033000     EXEC SQL                                                     03150000
033100          DECLARE SECOND-CSR CURSOR FOR                           03160000
033200             SELECT  A.OPER_UNT_ID                                03170000
033300                   , A.SHFT_NBR                                   03180000
033400                   , B.PRC_AREA_GP_CDE                            03190000
033500                   , SUM(A.UNT_WRKD_QTY)                          03200000
033600                   , SUM(A.CART_WRKD_QTY)                         03210000
033700                   , SUM(A.PO_RCVR_WRKD_QTY)                      03220000
033800                   , SUM(A.EXTD_RTL_WRKD_AMT)                     03230000
033900              FROM   PCT_SUM_WRKD A                               03240000
034000                   , PCT_PRC_AREA_ASSN B                          03250000
034100            WHERE A.BUS_DTE BETWEEN :PV-START-RPT-DATE            03260000
034200                                AND :PV-END-RPT-DATE              03270000
034300              AND B.OPER_UNT_ID   =  A.OPER_UNT_ID                03280000
034400              AND B.PRCG_AREA_CDE =  A.PRCG_AREA_CDE              03290000
034500            GROUP BY A.OPER_UNT_ID, A.SHFT_NBR, B.PRC_AREA_GP_CDE 03300000
034600            UNION                                                 03310000
034700            SELECT  A.OPER_UNT_ID                                 03320000
034800                   , A.SHFT_NBR                                   03330000
034900                   , 'MISC'                                       03340000
035000                   , SUM(A.UNT_WRKD_QTY)                          03350000
035100                   , SUM(A.CART_WRKD_QTY)                         03360000
035200                   , SUM(A.PO_RCVR_WRKD_QTY)                      03370000
035300                   , SUM(A.EXTD_RTL_WRKD_AMT)                     03380000
035400              FROM   PCT_SUM_WRKD A                               03390000
035500            WHERE A.BUS_DTE BETWEEN :PV-START-RPT-DATE            03400000
035600                                AND :PV-END-RPT-DATE              03410000
035700              AND NOT EXISTS                                      03420000
035800                  (SELECT *                                       03430000
035900                     FROM PCT_PRC_AREA_ASSN B                     03440000
036000                    WHERE B.OPER_UNT_ID = A.OPER_UNT_ID           03450000
036100                      AND B.PRCG_AREA_CDE = A.PRCG_AREA_CDE)      03460000
036200            GROUP BY A.OPER_UNT_ID, A.SHFT_NBR                    03470000
036300            ORDER BY 1, 2                                         03480000
036400     END-EXEC.                                                    03490000
036500*                                                                 03500000
036600***************************************************************** 03510000
036700*    THIRD CURSOR (OPER UNIT OR DC LEVEL)                       * 03520000
036800***************************************************************** 03530000
036900*                                                                 03540000
037000     EXEC SQL                                                     03550000
037100          DECLARE THIRD-CSR CURSOR FOR                            03560000
037200             SELECT OPER_UNT_ID                                   03570000
037300                   , SHFT_NBR                                     03580000
037400                   , SUM(A.UNT_WRKD_QTY)                          03590000
037500                   , SUM(A.CART_WRKD_QTY)                         03600000
037600                   , SUM(A.PO_RCVR_WRKD_QTY)                      03610000
037700                   , SUM(A.EXTD_RTL_WRKD_AMT)                     03620000
037800              FROM   PCT_SUM_WRKD A                               03630000
037900            WHERE A.BUS_DTE BETWEEN :PV-START-RPT-DATE            03640000
038000                                AND :PV-END-RPT-DATE              03650000
038100            GROUP BY A.OPER_UNT_ID, A.SHFT_NBR                    03660000
038200            ORDER BY OPER_UNT_ID, SHFT_NBR                        03670000
038300     END-EXEC.                                                    03680000
038400*                                                                 03690000
038500***************************************************************** 03700000
038600*    DB2 AREA FOR COMMUNICATIONS                                * 03710000
038700***************************************************************** 03720000
038800     EXEC SQL                                                     03730000
038900         INCLUDE SQLCA                                            03740000
039000     END-EXEC.                                                    03750000
039100                                                                  03760000
039200     COPY SQLCA2.                                                 03770000
039300/                                                                 03780000
039400***************************************************************** 03790000
039500 PROCEDURE DIVISION.                                              03800000
039600***************************************************************** 03810000
039700 0000-PROGRAM-MAINLINE.                                           03820000
039800                                                                  03830000
039900     ACCEPT PC239-CONTROL-CARD FROM SYSIN.                        03840000
040000     DISPLAY 'CONTROL CARD '                                      03850000
040100     DISPLAY PC239-CONTROL-CARD                                   03860000
040200                                                                  03870000
040300     MOVE CC-START-RPT-DATE-RANGE    TO PV-START-RPT-DATE.        03880000
040400     MOVE CC-END-RPT-DATE-RANGE      TO PV-END-RPT-DATE.          03890000
040500                                                                  03900000
040600     PERFORM 1000-INITIALIZE.                                     03910000
040700                                                                  03920000
040800     SET PV-DATA-TYPE-CURRENT    TO TRUE.                         03921003
040900     PERFORM 2000-PROCESS.                                        03930000
041000                                                                  03940000
041100     IF PS-ERROR                                                  03941008
041200         CONTINUE                                                 03941108
041300     ELSE                                                         03941208
041400         IF CC-RPT-NEEDS-PREV-DATA                                03941308
041500             SET PV-DATA-TYPE-PREVIOUS   TO TRUE                  03941408
041600             PERFORM 1140-PREV-DATE-RANGE                         03941508
041700             PERFORM 1050-INITIALIZE-PREV                         03941608
041800             PERFORM 2000-PROCESS                                 03943208
041900         END-IF                                                   03943308
042000     END-IF.                                                      03943408
042100                                                                  03944003
042200     PERFORM 9000-EOJ-ROUTINE.                                    03950000
042300                                                                  03960000
042400     GOBACK.                                                      03970000
042500/                                                                 03980000
042600***************************************************************** 03990000
042700* DO FIRST TIME INITIALIZATION TASKS.                             04000000
042800***************************************************************** 04010000
042900 1000-INITIALIZE.                                                 04020000
043000                                                                  04030000
043100     OPEN OUTPUT EXTRACT-FILE.                                    04040000
043200                                                                  04050000
043300     PERFORM 1100-CHECK-CC-OPER.                                  04060000
043400/                                                                 04070000
043500***************************************************************** 04071004
043600* INITIALIZE BEFORE PROCESS FOR PREVIOUS DATA.                    04072004
043700***************************************************************** 04073004
043800 1050-INITIALIZE-PREV.                                            04074004
043900                                                                  04075004
044000     INITIALIZE PS-EOF-CSR-SW.                                    04075104
044100     INITIALIZE PC012-RECORD-LAYOUT.                              04075204
044200                                                                  04075504
044300     INITIALIZE PV-DC-SHFT-SUM                                    04075604
044400                PV-DC-SHFT-SUM                                    04075704
044500                PV-DC-TOT-SUM                                     04075804
044600                PV-COMP-SUM                                       04075904
044700                PV-COMP-TOT                                       04076004
044800                PV-SHFT-VRFD-SUM                                  04076104
044900                PV-SHFT-SUM                                       04076204
045000                PV-OPER1-SUM                                      04076304
045100                PV-OPER2-SUM                                      04076404
045200                PV-OPER3-SUM                                      04076504
045300                PV-COMP1-SUM                                      04076604
045400                PV-COMP2-SUM                                      04076704
045500                PV-COMP3-SUM                                      04076804
045600                PV-VRFD1-SUM                                      04076904
045700                PV-VRFD2-SUM                                      04077004
045800                PV-VRFD3-SUM                                      04077104
045900                PV-VRFD1-OPER-SUM                                 04077204
046000                PV-VRFD2-OPER-SUM                                 04077304
046100                PV-VRFD3-OPER-SUM                                 04077404
046200                PV-VRFD1-COMP-SUM                                 04077504
046300                PV-VRFD2-COMP-SUM                                 04077604
046400                PV-VRFD3-COMP-SUM                                 04077704
046500                PV-OPER-VRFD-SUM                                  04077804
046600                PV-COMP-VRFD-SUM.                                 04077904
046700                                                                  04078004
046800/                                                                 04079304
046900***************************************************************** 04080000
047000* CHECK IF CC OPER UNIT ID IS NUMERIC.                            04090000
047100***************************************************************** 04100000
047200 1100-CHECK-CC-OPER.                                              04110000
047300                                                                  04120000
047400     IF CC-OPER-UNIT-ID  NUMERIC                                  04130000
047500         CONTINUE                                                 04140000
047600     ELSE                                                         04150000
047700         DISPLAY '** PARA 1000-INITIALIZE **'                     04160000
047800         DISPLAY '** INVALID CONTROL CARD **'                     04170000
047900         DISPLAY '** DC NOT NUMERIC       **'                     04180000
048000         MOVE +4001                   TO ABEND-CODE               04190000
048100         CALL 'ILBOABN0' USING ABEND-CODE                         04200000
048200     END-IF.                                                      04210000
048300/                                                                 04220000
048400***************************************************************** 04220103
048500* GET LAST YEARS DATE RANGE.                                      04220203
048600***************************************************************** 04220303
048700 1140-PREV-DATE-RANGE.                                            04221003
048800                                                                  04222003
048900     MOVE CC-START-RPT-DATE-RANGE    TO PV-KEY-DATE.              04222103
049000     PERFORM 1150-SELECT-PREV-DATE.                               04222203
049100     MOVE DTATTR-LY-THIS-DAY-KY-DTE  TO PV-START-RPT-DATE.        04222303
049200                                                                  04222403
049300     MOVE CC-END-RPT-DATE-RANGE      TO PV-KEY-DATE.              04222503
049400     PERFORM 1150-SELECT-PREV-DATE.                               04222603
049500     MOVE DTATTR-LY-THIS-DAY-KY-DTE  TO PV-END-RPT-DATE.          04222703
049600/                                                                 04222803
049700***************************************************************** 04222903
049800* SELECT LAST YEARS DATE FROM TDTATTR.                            04223003
049900***************************************************************** 04223103
050000 1150-SELECT-PREV-DATE.                                           04223203
050100                                                                  04223303
050200         EXEC SQL                                                 04223403
050300           SELECT LY_THIS_DAY_KY_DTE                              04223503
050400             INTO :DTATTR-LY-THIS-DAY-KY-DTE                      04223603
050500           FROM TDTATTR                                           04223703
050600             WHERE KY_DTE  = :PV-KEY-DATE                         04223803
050700         END-EXEC                                                 04223903
050800                                                                  04224003
050900     EVALUATE TRUE                                                04224103
051000         WHEN SQLCODE = ZERO                                      04224203
051100*        WHEN SQLCODE = +100                                      04224403
051200             CONTINUE                                             04224503
051300         WHEN SQLCODE = -904                                      04224903
051400         WHEN SQLCODE = -911                                      04225003
051500         WHEN SQLCODE = -913                                      04225103
051600              PERFORM 8000-CREATE-ERROR-RECORD                    04225203
051700         WHEN SQLCODE < ZERO                                      04225303
051800             DISPLAY '** ABEND - PCKUT019 **'                     04225403
051900             DISPLAY '** 1150-SELECT-PREV-DATE **'                04225503
052000             PERFORM 9200-SQL-ERROR                               04225603
052100         WHEN SQLCODE > ZERO                                      04225703
052200         WHEN SQLWARN0 NOT = SPACES                               04225803
052300             DISPLAY '** ABEND - PCKUT019 **'                     04225903
052400             DISPLAY '** 1150-SELECT-PREV-DATE **'                04226003
052500             PERFORM 9300-SQL-WARNING                             04226103
052600     END-EVALUATE.                                                04226203
052700/                                                                 04228003
052800***************************************************************** 04230000
052900* CHECK NUMBER OF ROWS TO BE WRITTEN TO OUTPUT.                   04240000
053000***************************************************************** 04250000
053100 1200-CHECK-WRITE-EXTRACT.                                        04260000
053200                                                                  04270000
053300     IF CC-OPER-ALL   OR  CC-OPER-EXTRACT-ALL                     04280002
053400        SET PS-WRITE-EXTRACT   TO TRUE                            04290000
053500     ELSE                                                         04300000
053600         IF PV-PREV-OPER-NBR = CC-OPER-UNIT-ID                    04310000
053700            SET PS-WRITE-EXTRACT    TO TRUE                       04320000
053800         ELSE                                                     04330000
053900            SET PS-WRITE-EXTRACT-NO TO TRUE                       04340000
054000         END-IF                                                   04350000
054100     END-IF.                                                      04360000
054200/                                                                 04370000
054300***************************************************************** 04380000
054400* ADD TO SHIFT TOTALS.                                            04390000
054500***************************************************************** 04400000
054600 1310-ADD-TO-SHFT-TOTAL.                                          04410000
054700                                                                  04420000
054800     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-SHFT-UNT-WRKD-SUM.      04430000
054900     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-SHFT-CART-WRKD-SUM.     04440000
055000     ADD PV-PCT00005-PO-RCVR-WRKD-QTY TO PV-SHFT-PO-RCVR-WRKD-SUM.04450000
055100     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT TO                         04460000
055110                                       PV-SHFT-PO-RCVR-WRKD-SUM.          
055200/                                                                 04470000
055300***************************************************************** 04480000
055400* ADD TO DC TOTALS.                                               04490000
055500***************************************************************** 04500000
055600 1320-ADD-TO-DC-TOTAL.                                            04510000
055700*                                                                 04520000
055800     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-DC-UNT-WRKD-SUM.        04530000
055900     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-DC-CART-WRKD-SUM.       04540000
056000     ADD PV-PCT00005-PO-RCVR-WRKD-QTY TO PV-DC-PO-RCVR-WRKD-SUM.  04550000
056100     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT TO                         04560000
056110                                       PV-DC-EXTD-RTL-WRKD-SUM.           
056200/                                                                 04570000
056300***************************************************************** 04580000
056400* ADD TO COMPANY TOTALS.                                          04590000
056500***************************************************************** 04600000
056600 1330-COMP-TOT-SUM.                                               04610000
056700*                                                                 04620000
056800     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-COMP-UNT-WRKD-TOT.      04630000
056900     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-COMP-CART-WRKD-TOT.     04640000
057000     ADD PV-PCT00005-PO-RCVR-WRKD-QTY TO PV-COMP-PO-RCVR-WRKD-TOT.04650000
057100     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT                            04660000
057200                                   TO PV-COMP-EXTD-RTL-WRKD-TOT.  04670000
057300/                                                                 04680000
057400***************************************************************** 04690000
057500* ADD TO SHIFT1 DC LEVEL TOTALS.                                  04700000
057600***************************************************************** 04710000
057700 1340-SHFT1-DC-TOTALS.                                            04720000
057800                                                                  04730000
057900     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-OPER1-UNT-WRKD-SUM.     04740000
058000     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-OPER1-CART-WRKD-SUM.    04750000
058100     ADD PV-PCT00005-PO-RCVR-WRKD-QTY TO                          04760000
058110                                 PV-OPER1-PO-RCVR-WRKD-SUM.               
058200     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT                            04770000
058300                                   TO PV-OPER1-EXTD-RTL-WRKD-SUM. 04780000
058400/                                                                 04790000
058500***************************************************************** 04800000
058600* ADD TO SHIFT2 DC LEVEL TOTALS.                                  04810000
058700***************************************************************** 04820000
058800 1350-SHFT2-DC-TOTALS.                                            04830000
058900                                                                  04840000
059000     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-OPER2-UNT-WRKD-SUM.     04850000
059100     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-OPER2-CART-WRKD-SUM.    04860000
059200     ADD PV-PCT00005-PO-RCVR-WRKD-QTY                             04870000
059210                                 TO PV-OPER2-PO-RCVR-WRKD-SUM.            
059300     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT                            04880000
059400                                   TO PV-OPER2-EXTD-RTL-WRKD-SUM. 04890000
059500/                                                                 04900000
059600***************************************************************** 04910000
059700* ADD TO SHIFT3 DC LEVEL TOTALS.                                  04920000
059800***************************************************************** 04930000
059900 1360-SHFT3-DC-TOTALS.                                            04940000
060000                                                                  04950000
060100     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-OPER3-UNT-WRKD-SUM.     04960000
060200     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-OPER3-CART-WRKD-SUM.    04970000
060300     ADD PV-PCT00005-PO-RCVR-WRKD-QTY                             04980000
060310                                TO PV-OPER3-PO-RCVR-WRKD-SUM.             
060400     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT                            04990000
060500                                   TO PV-OPER3-EXTD-RTL-WRKD-SUM. 05000000
060600/                                                                 05010000
060700***************************************************************** 05020000
060800* ADD TO SHIFT1 COMPANY LEVEL TOTALS.                             05030000
060900***************************************************************** 05040000
061000 1370-SHFT1-COMP-TOTALS.                                          05050000
061100                                                                  05060000
061200     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-COMP1-UNT-WRKD-SUM.     05070000
061300     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-COMP1-CART-WRKD-SUM.    05080000
061400     ADD PV-PCT00005-PO-RCVR-WRKD-QTY                             05090000
061410                            TO PV-COMP1-PO-RCVR-WRKD-SUM.                 
061500     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT                            05100000
061600                                   TO PV-COMP1-EXTD-RTL-WRKD-SUM. 05110000
061700/                                                                 05120000
061800***************************************************************** 05130000
061900* ADD TO SHIFT2 COMPANY LEVEL TOTALS.                             05140000
062000***************************************************************** 05150000
062100 1380-SHFT2-COMP-TOTALS.                                          05160000
062200                                                                  05170000
062300     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-COMP2-UNT-WRKD-SUM.     05180000
062400     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-COMP2-CART-WRKD-SUM.    05190000
062500     ADD PV-PCT00005-PO-RCVR-WRKD-QTY                             05200000
062510                             TO PV-COMP2-PO-RCVR-WRKD-SUM.                
062600     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT                            05210000
062700                                   TO PV-COMP2-EXTD-RTL-WRKD-SUM. 05220000
062800/                                                                 05230000
062900***************************************************************** 05240000
063000* ADD TO SHIFT3 COMPANY LEVEL TOTALS.                             05250000
063100***************************************************************** 05260000
063200 1390-SHFT3-COMP-TOTALS.                                          05270000
063300                                                                  05280000
063400     ADD PV-PCT00005-UNT-WRKD-QTY   TO PV-COMP3-UNT-WRKD-SUM.     05290000
063500     ADD PV-PCT00005-CART-WRKD-QTY  TO PV-COMP3-CART-WRKD-SUM.    05300000
063600     ADD PV-PCT00005-PO-RCVR-WRKD-QTY                             05310000
063610                            TO PV-COMP3-PO-RCVR-WRKD-SUM.                 
063700     ADD PV-PCT00005-EXTD-RTL-WRKD-AMT                            05320000
063800                                   TO PV-COMP3-EXTD-RTL-WRKD-SUM. 05330000
063900/                                                                 05340000
064000***************************************************************** 05350000
064100* ADD TO SHIFT1 VERIFED TOTALS (SHIFT, OPER AND COMP LEVELS).     05360000
064200***************************************************************** 05370000
064300 1400-SHFT1-VRFD-TOTALS.                                          05380000
064400                                                                  05390000
064500     ADD PV-PCT00006-UNT-VRFD-QTY   TO PV-VRFD1-UNT-SUM           05400000
064600                                       PV-VRFD1-OPER-UNT-SUM      05410000
064700                                       PV-VRFD1-COMP-UNT-SUM.     05420000
064800     ADD PV-PCT00006-CART-VRFD-QTY  TO PV-VRFD1-CART-SUM          05430000
064900                                       PV-VRFD1-OPER-CART-SUM     05440000
065000                                       PV-VRFD1-COMP-CART-SUM.    05450000
065100     ADD PV-PCT00006-PO-RCVR-VRFD-QTY TO PV-VRFD1-PO-RCVR-SUM     05460000
065200                                       PV-VRFD1-OPER-PO-RCVR-SUM  05470000
065300                                       PV-VRFD1-COMP-PO-RCVR-SUM. 05480000
065400     ADD PV-PCT00006-EXTD-RTL-VRFD-AMT TO PV-VRFD1-EXTD-RTL-SUM   05490000
065500                                      PV-VRFD1-OPER-EXTD-RTL-SUM  05500000
065600                                      PV-VRFD1-COMP-EXTD-RTL-SUM. 05510000
065700/                                                                 05520000
065800***************************************************************** 05530000
065900* ADD TO SHIFT2 VERIFED TOTALS.                                   05540000
066000***************************************************************** 05550000
066100 1410-SHFT2-VRFD-TOTALS.                                          05560000
066200                                                                  05570000
066300     ADD PV-PCT00006-UNT-VRFD-QTY   TO PV-VRFD2-UNT-SUM           05580000
066400                                       PV-VRFD2-OPER-UNT-SUM      05590000
066500                                       PV-VRFD2-COMP-UNT-SUM.     05600000
066600     ADD PV-PCT00006-CART-VRFD-QTY  TO PV-VRFD2-CART-SUM          05610000
066700                                       PV-VRFD2-OPER-CART-SUM     05620000
066800                                       PV-VRFD2-COMP-CART-SUM.    05630000
066900     ADD PV-PCT00006-PO-RCVR-VRFD-QTY TO PV-VRFD2-PO-RCVR-SUM     05640000
067000                                       PV-VRFD2-OPER-PO-RCVR-SUM  05650000
067100                                       PV-VRFD2-COMP-PO-RCVR-SUM. 05660000
067200     ADD PV-PCT00006-EXTD-RTL-VRFD-AMT TO PV-VRFD2-EXTD-RTL-SUM   05670000
067300                                      PV-VRFD2-OPER-EXTD-RTL-SUM  05680000
067400                                      PV-VRFD2-COMP-EXTD-RTL-SUM. 05690000
067500/                                                                 05700000
067600***************************************************************** 05710000
067700* ADD TO SHIFT3 VERIFED TOTALS.                                   05720000
067800***************************************************************** 05730000
067900 1420-SHFT3-VRFD-TOTALS.                                          05740000
068000                                                                  05750000
068100     ADD PV-PCT00006-UNT-VRFD-QTY   TO PV-VRFD3-UNT-SUM           05760000
068200                                       PV-VRFD3-OPER-UNT-SUM      05770000
068300                                       PV-VRFD3-COMP-UNT-SUM.     05780000
068400     ADD PV-PCT00006-CART-VRFD-QTY  TO PV-VRFD3-CART-SUM          05790000
068500                                       PV-VRFD3-OPER-CART-SUM     05800000
068600                                       PV-VRFD3-COMP-CART-SUM.    05810000
068700     ADD PV-PCT00006-PO-RCVR-VRFD-QTY TO PV-VRFD3-PO-RCVR-SUM     05820000
068800                                       PV-VRFD3-OPER-PO-RCVR-SUM  05830000
068900                                       PV-VRFD3-COMP-PO-RCVR-SUM. 05840000
069000     ADD PV-PCT00006-EXTD-RTL-VRFD-AMT TO PV-VRFD3-EXTD-RTL-SUM   05850000
069100                                      PV-VRFD3-OPER-EXTD-RTL-SUM  05860000
069200                                      PV-VRFD3-COMP-EXTD-RTL-SUM. 05870000
069300/                                                                 05880000
069400***************************************************************** 05890000
069500* ADD TO COMPANY VERIFIED TOTALS.                                 05900000
069600***************************************************************** 05910000
069700 1430-OPER-VRFD-SUM.                                              05920000
069800                                                                  05930000
069900     ADD PV-PCT00006-UNT-VRFD-QTY  TO PV-OPER-VRFD-UNT-SUM.       05940000
070000     ADD PV-PCT00006-CART-VRFD-QTY TO PV-OPER-VRFD-CART-SUM.      05950000
070100     ADD PV-PCT00006-PO-RCVR-VRFD-QTY TO PV-OPER-VRFD-PO-RCVR-SUM.05960000
070200     ADD PV-PCT00006-EXTD-RTL-VRFD-AMT                            05970000
070300                                   TO PV-OPER-VRFD-EXTD-RTL-SUM.  05980000
070400/                                                                 05990000
070500***************************************************************** 06000000
070600* ADD TO COMPANY VERIFIED TOTALS.                                 06010000
070700***************************************************************** 06020000
070800 1440-COMP-VRFD-SUM.                                              06030000
070900                                                                  06040000
071000     ADD PV-PCT00006-UNT-VRFD-QTY  TO PV-COMP-VRFD-UNT-SUM.       06050000
071100     ADD PV-PCT00006-CART-VRFD-QTY TO PV-COMP-VRFD-CART-SUM.      06060000
071200     ADD PV-PCT00006-PO-RCVR-VRFD-QTY TO PV-COMP-VRFD-PO-RCVR-SUM.06070000
071300     ADD PV-PCT00006-EXTD-RTL-VRFD-AMT                            06080000
071400                                   TO PV-COMP-VRFD-EXTD-RTL-SUM.  06090000
071500/                                                                 06100000
071600***************************************************************** 06110000
071700* CHECK UNITS WORKED SHIFT NUMBER AND ADD TO DC SHIFT TOTALS.     06120000
071800***************************************************************** 06130000
071900 1510-ADD-TO-OPER-TOTAL.                                          06140000
072000*                                                                 06150000
072100     EVALUATE TRUE                                                06160000
072200        WHEN PCT00005-SHFT-NBR = 1                                06170000
072300            PERFORM 1340-SHFT1-DC-TOTALS                          06180000
072400                                                                  06190000
072500        WHEN PCT00005-SHFT-NBR = 2                                06200000
072600            PERFORM 1350-SHFT2-DC-TOTALS                          06210000
072700                                                                  06220000
072800        WHEN PCT00005-SHFT-NBR = 3                                06230000
072900            PERFORM 1360-SHFT3-DC-TOTALS                          06240000
073000                                                                  06250000
073100     END-EVALUATE.                                                06260000
073200/                                                                 06270000
073300***************************************************************** 06280000
073400* ADD TO COMPANY TOTAL.                                           06290000
073500* CHECK SHIFT NUMBER AND ADD TO COMPANY SHIFT TOTAL.              06300000
073600***************************************************************** 06310000
073700 1520-ADD-TO-COMPANY-TOTALS.                                      06320000
073800*                                                                 06330000
073900*    PERFORM 1330-COMP-TOT-SUM.                                   06340000
074000                                                                  06350000
074100     EVALUATE TRUE                                                06360000
074200        WHEN PCT00005-SHFT-NBR = 1                                06370000
074300            PERFORM 1370-SHFT1-COMP-TOTALS                        06380000
074400                                                                  06390000
074500        WHEN PCT00005-SHFT-NBR = 2                                06400000
074600            PERFORM 1380-SHFT2-COMP-TOTALS                        06410000
074700                                                                  06420000
074800        WHEN PCT00005-SHFT-NBR = 3                                06430000
074900            PERFORM 1390-SHFT3-COMP-TOTALS                        06440000
075000                                                                  06450000
075100     END-EVALUATE.                                                06460000
075200/                                                                 06470000
075300***************************************************************** 06480000
075400* CHECK VERIFIED SHIFT NUMBER AND ADD TO TOTAL.                   06490000
075500***************************************************************** 06500000
075600 1530-ADD-TO-VRFD-TOTAL.                                          06510000
075700*                                                                 06520000
075800     PERFORM 1430-OPER-VRFD-SUM.                                  06530000
075900     PERFORM 1440-COMP-VRFD-SUM.                                  06540000
076000                                                                  06550000
076100     EVALUATE TRUE                                                06560000
076200        WHEN PCT00006-SHFT-NBR = 1                                06570000
076300            PERFORM 1400-SHFT1-VRFD-TOTALS                        06580000
076400                                                                  06590000
076500        WHEN PCT00006-SHFT-NBR = 2                                06600000
076600            PERFORM 1410-SHFT2-VRFD-TOTALS                        06610000
076700                                                                  06620000
076800        WHEN PCT00006-SHFT-NBR = 3                                06630000
076900            PERFORM 1420-SHFT3-VRFD-TOTALS                        06640000
077000                                                                  06650000
077100     END-EVALUATE.                                                06660000
077200/                                                                 06670000
077300***************************************************************** 06680000
077400* INITIALIZE DC SHIFT TOTALS AND SHIFT TOTAL AFTER CHANGE IN      06690000
077500* OPER NBR.                                                       06700000
077600***************************************************************** 06710000
077700 1600-INITIALIZE-OPER-TOTALS.                                     06720000
077800*                                                                 06730000
077900     INITIALIZE     PV-OPER1-SUM                                  06740000
078000                    PV-OPER2-SUM                                  06750000
078100                    PV-OPER3-SUM                                  06760000
078200                    PV-DC-TOT-SUM                                 06770000
078300                    PV-VRFD1-OPER-SUM                             06780000
078400                    PV-VRFD2-OPER-SUM                             06790000
078500                    PV-VRFD3-OPER-SUM                             06800000
078600                    PV-OPER-VRFD-SUM.                             06810000
078700                                                                  06820000
078800     INITIALIZE     PV-SHFT-SUM.                                  06830000
078900/                                                                 06840000
079000***************************************************************** 06850000
079100* DETERMINE WHAT CURSOR TO USE BY CHECKING CC-REPORT-CONTENT-CDE  06860000
079200* IN CONTROL CARD.                                                06870000
079300***************************************************************** 06880000
079400 2000-PROCESS.                                                    06890000
079500                                                                  06900000
079600     EVALUATE TRUE                                                06910000
079700        WHEN CC-RPT-BY-PRCS-AREA                                  06920000
079800            PERFORM 7000-OPEN-FIRST-CSR                           06930000
079900            IF PS-ERROR                                           06931009
080000               CONTINUE                                           06932008
080100            ELSE                                                  06933008
080200               PERFORM 7010-FETCH-FIRST-CSR                       06940008
080300               MOVE PV-OPER-NBR      TO PV-PREV-OPER-NBR          06950008
080400               MOVE PV-SHFT-NBR      TO PV-PREV-SHFT-NBR          06960008
080500               PERFORM 1200-CHECK-WRITE-EXTRACT                   06970008
080600               PERFORM 2500-PROCESS-FIRST-CSR                     06980008
080700                  UNTIL PS-EOF-CSR                                06990008
080800               PERFORM 7020-CLOSE-FIRST-CSR                       07000008
080900               IF PS-ERROR-NO                                     07010008
081000                   PERFORM 2100-DC-SHFT-TOTALS                    07020008
081100                   IF PS-WRITE-EXTRACT                            07030008
081200                       PERFORM 3200-BUILD-D-RECORD                07040008
081300                   END-IF                                         07050008
081400                   PERFORM 2200-COMP-SHFT-TOTALS                  07060008
081500                   PERFORM 3400-BUILD-B-RECORD                    07070008
081600               END-IF                                             07080008
081700            END-IF                                                07081008
081800                                                                  07090000
081900        WHEN CC-RPT-BY-PRCS-GROUP                                 07100000
082000            PERFORM 7030-OPEN-SECOND-CSR                          07110000
082100            IF PS-ERROR                                           07111008
082200               CONTINUE                                           07112008
082300            ELSE                                                  07113008
082400               PERFORM 7040-FETCH-SECOND-CSR                      07120008
082500               MOVE PV-OPER-NBR      TO PV-PREV-OPER-NBR          07130008
082600               MOVE PV-SHFT-NBR      TO PV-PREV-SHFT-NBR          07140008
082700               PERFORM 1200-CHECK-WRITE-EXTRACT                   07150008
082800               PERFORM 2600-PROCESS-SECOND-CSR                    07160008
082900                  UNTIL PS-EOF-CSR                                07170008
083000               PERFORM 7050-CLOSE-SECOND-CSR                      07180008
083100               IF PS-ERROR-NO                                     07190008
083200                   PERFORM 2100-DC-SHFT-TOTALS                    07200008
083300                   IF PS-WRITE-EXTRACT                            07210008
083400                       PERFORM 3200-BUILD-D-RECORD                07220008
083500                   END-IF                                         07230008
083600                   PERFORM 2200-COMP-SHFT-TOTALS                  07240008
083700                   PERFORM 3400-BUILD-B-RECORD                    07250008
083800               END-IF                                             07260008
083900            END-IF                                                07261008
084000                                                                  07270000
084100        WHEN CC-RPT-BY-DC                                         07280000
084200            PERFORM 7060-OPEN-THIRD-CSR                           07290000
084300            IF PS-ERROR                                           07291008
084400               CONTINUE                                           07292008
084500            ELSE                                                  07293008
084600               PERFORM 7070-FETCH-THIRD-CSR                       07300008
084700               MOVE PV-OPER-NBR      TO PV-PREV-OPER-NBR          07310008
084800               MOVE PV-SHFT-NBR      TO PV-PREV-SHFT-NBR          07320008
084900               PERFORM 2700-PROCESS-THIRD-CSR                     07330008
085000                  UNTIL PS-EOF-CSR                                07340008
085100               PERFORM 7080-CLOSE-THIRD-CSR                       07350008
085200               IF PS-ERROR-NO                                     07360008
085300                   MOVE PV-OPER-NBR      TO PV-PREV-OPER-NBR      07370008
085400                   PERFORM 1200-CHECK-WRITE-EXTRACT               07380008
085500                   PERFORM 2100-DC-SHFT-TOTALS                    07390008
085600                   IF PS-WRITE-EXTRACT                            07400008
085700                      PERFORM 3200-BUILD-D-RECORD                 07410008
085800                   END-IF                                         07420008
085900                   PERFORM 2200-COMP-SHFT-TOTALS                  07430008
086000                   PERFORM 3400-BUILD-B-RECORD                    07440008
086100               END-IF                                             07450008
086200            END-IF                                                07451008
086300                                                                  07460000
086400     END-EVALUATE.                                                07470000
086500/                                                                 07480000
086600***************************************************************** 07490000
086700* BUILD DC SUMMARY RECORDS FOR 3 SHIFTS.                          07500000
086800***************************************************************** 07510000
086900 2100-DC-SHFT-TOTALS.                                             07520000
087000*                                                                 07530000
087100     MOVE 1                          TO PV-SHIFT.                 07540000
087200     MOVE PV-OPER1-UNT-WRKD-SUM      TO PV-OPER-UNT-WRKD-SUM.     07550000
087300     MOVE PV-OPER1-CART-WRKD-SUM     TO PV-OPER-CART-WRKD-SUM.    07560000
087400     MOVE PV-OPER1-PO-RCVR-WRKD-SUM  TO PV-OPER-PO-RCVR-WRKD-SUM. 07570000
087500     MOVE PV-OPER1-EXTD-RTL-WRKD-SUM                              07580000
087600                                    TO PV-OPER-EXTD-RTL-WRKD-SUM. 07590000
087700     PERFORM 7100-SELECT-VERIFIED.                                07600000
087800     PERFORM 1530-ADD-TO-VRFD-TOTAL.                              07610000
087900     IF PS-WRITE-EXTRACT                                          07620000
088000          PERFORM 3300-BUILD-E-RECORD                             07630000
088100     END-IF.                                                      07640000
088200                                                                  07650000
088300     MOVE 2                          TO PV-SHIFT.                 07660000
088400     MOVE PV-OPER2-UNT-WRKD-SUM      TO PV-OPER-UNT-WRKD-SUM.     07670000
088500     MOVE PV-OPER2-CART-WRKD-SUM     TO PV-OPER-CART-WRKD-SUM.    07680000
088600     MOVE PV-OPER2-PO-RCVR-WRKD-SUM  TO PV-OPER-PO-RCVR-WRKD-SUM. 07690000
088700     MOVE PV-OPER2-EXTD-RTL-WRKD-SUM                              07700000
088800                                    TO PV-OPER-EXTD-RTL-WRKD-SUM. 07710000
088900     PERFORM 7100-SELECT-VERIFIED.                                07720000
089000     PERFORM 1530-ADD-TO-VRFD-TOTAL.                              07730000
089100     IF PS-WRITE-EXTRACT                                          07740000
089200         PERFORM 3300-BUILD-E-RECORD                              07750000
089300     END-IF.                                                      07760000
089400                                                                  07770000
089500     MOVE 3                          TO PV-SHIFT.                 07780000
089600     MOVE PV-OPER3-UNT-WRKD-SUM      TO PV-OPER-UNT-WRKD-SUM.     07790000
089700     MOVE PV-OPER3-CART-WRKD-SUM     TO PV-OPER-CART-WRKD-SUM.    07800000
089800     MOVE PV-OPER3-PO-RCVR-WRKD-SUM  TO PV-OPER-PO-RCVR-WRKD-SUM. 07810000
089900     MOVE PV-OPER3-EXTD-RTL-WRKD-SUM                              07820000
090000                                    TO PV-OPER-EXTD-RTL-WRKD-SUM. 07830000
090100     PERFORM 7100-SELECT-VERIFIED.                                07840000
090200     PERFORM 1530-ADD-TO-VRFD-TOTAL.                              07850000
090300     IF PS-WRITE-EXTRACT                                          07860000
090400          PERFORM 3300-BUILD-E-RECORD                             07870000
090500     END-IF.                                                      07880000
090600/                                                                 07890000
090700***************************************************************** 07900000
090800* PROCESS COMPANY SHIFT SUMMARY TOTALS.                           07910000
090900***************************************************************** 07920000
091000 2200-COMP-SHFT-TOTALS.                                           07930000
091100*                                                                 07940000
091200     MOVE 1                       TO PV-SHIFT.                    07950000
091300     MOVE PV-COMP1-UNT-WRKD-SUM   TO PV-COMP-UNT-WRKD-SUM.        07960000
091400     MOVE PV-COMP1-CART-WRKD-SUM  TO PV-COMP-CART-WRKD-SUM.       07970000
091500     MOVE PV-COMP1-PO-RCVR-WRKD-SUM                               07980000
091600                                 TO PV-COMP-PO-RCVR-WRKD-SUM.     07990000
091700     MOVE PV-COMP1-EXTD-RTL-WRKD-SUM                              08000000
091800                                 TO PV-COMP-EXTD-RTL-WRKD-SUM.    08010000
091900                                                                  08020000
092000     MOVE PV-VRFD1-COMP-UNT-SUM   TO PV-SHFT-VRFD-UNT-SUM         08030000
092100     MOVE PV-VRFD1-COMP-CART-SUM  TO PV-SHFT-VRFD-CART-SUM        08040000
092200     MOVE PV-VRFD1-COMP-PO-RCVR-SUM                               08050000
092300                                  TO PV-SHFT-VRFD-PO-RCVR-SUM     08060000
092400     MOVE PV-VRFD1-COMP-EXTD-RTL-SUM                              08070000
092500                                 TO PV-SHFT-VRFD-EXTD-RTL-SUM.    08080000
092600     PERFORM 3500-BUILD-C-RECORD.                                 08090000
092700                                                                  08100000
092800     MOVE 2                       TO PV-SHIFT.                    08110000
092900     MOVE PV-COMP2-UNT-WRKD-SUM   TO PV-COMP-UNT-WRKD-SUM.        08120000
093000     MOVE PV-COMP2-CART-WRKD-SUM  TO PV-COMP-CART-WRKD-SUM.       08130000
093100     MOVE PV-COMP2-PO-RCVR-WRKD-SUM                               08140000
093200                                 TO PV-COMP-PO-RCVR-WRKD-SUM.     08150000
093300     MOVE PV-COMP2-EXTD-RTL-WRKD-SUM                              08160000
093400                                 TO PV-COMP-EXTD-RTL-WRKD-SUM.    08170000
093500                                                                  08180000
093600     MOVE PV-VRFD2-COMP-UNT-SUM   TO PV-SHFT-VRFD-UNT-SUM         08190000
093700     MOVE PV-VRFD2-COMP-CART-SUM  TO PV-SHFT-VRFD-CART-SUM        08200000
093800     MOVE PV-VRFD2-COMP-PO-RCVR-SUM                               08210000
093900                                  TO PV-SHFT-VRFD-PO-RCVR-SUM     08220000
094000     MOVE PV-VRFD2-COMP-EXTD-RTL-SUM                              08230000
094100                                 TO PV-SHFT-VRFD-EXTD-RTL-SUM.    08240000
094200     PERFORM 3500-BUILD-C-RECORD.                                 08250000
094300                                                                  08260000
094400     MOVE 3                       TO PV-SHIFT.                    08270000
094500     MOVE PV-COMP3-UNT-WRKD-SUM   TO PV-COMP-UNT-WRKD-SUM.        08280000
094600     MOVE PV-COMP3-CART-WRKD-SUM  TO PV-COMP-CART-WRKD-SUM.       08290000
094700     MOVE PV-COMP3-PO-RCVR-WRKD-SUM                               08300000
094800                                 TO PV-COMP-PO-RCVR-WRKD-SUM.     08310000
094900     MOVE PV-COMP3-EXTD-RTL-WRKD-SUM                              08320000
095000                                 TO PV-COMP-EXTD-RTL-WRKD-SUM.    08330000
095100                                                                  08340000
095200     MOVE PV-VRFD3-COMP-UNT-SUM   TO PV-SHFT-VRFD-UNT-SUM         08350000
095300     MOVE PV-VRFD3-COMP-CART-SUM  TO PV-SHFT-VRFD-CART-SUM        08360000
095400     MOVE PV-VRFD3-COMP-PO-RCVR-SUM                               08370000
095500                                  TO PV-SHFT-VRFD-PO-RCVR-SUM     08380000
095600     MOVE PV-VRFD3-COMP-EXTD-RTL-SUM                              08390000
095700                                 TO PV-SHFT-VRFD-EXTD-RTL-SUM.    08400000
095800     PERFORM 3500-BUILD-C-RECORD.                                 08410000
095900/                                                                 08420000
096000***************************************************************** 08430000
096100* PROCESS FIRST CURSOR.                                           08440000
096200***************************************************************** 08450000
096300 2500-PROCESS-FIRST-CSR.                                          08460000
096400*                                                                 08470000
096500     IF PV-OPER-NBR   =    PV-PREV-OPER-NBR                       08480000
096600         PERFORM 1310-ADD-TO-SHFT-TOTAL                           08490000
096700         PERFORM 1320-ADD-TO-DC-TOTAL                             08500000
096800         PERFORM 1330-COMP-TOT-SUM                                08510000
096900         PERFORM 1510-ADD-TO-OPER-TOTAL                           08520000
097000         PERFORM 1520-ADD-TO-COMPANY-TOTALS                       08530000
097100         IF PS-WRITE-EXTRACT                                      08540000
097200             PERFORM 3000-BUILD-CSR1-RECORD                       08550000
097300         END-IF                                                   08560000
097400     ELSE                                                         08570000
097500         PERFORM 1200-CHECK-WRITE-EXTRACT                         08580000
097600         PERFORM 2100-DC-SHFT-TOTALS                              08590000
097700         PERFORM 7100-SELECT-VERIFIED                             08600000
097800         PERFORM 1530-ADD-TO-VRFD-TOTAL                           08610000
097900         IF PS-WRITE-EXTRACT                                      08620000
098000             PERFORM 3200-BUILD-D-RECORD                          08630000
098100         END-IF                                                   08640000
098200         PERFORM 1600-INITIALIZE-OPER-TOTALS                      08650000
098300         MOVE PV-OPER-NBR   TO PV-PREV-OPER-NBR                   08660000
098400         MOVE PV-SHFT-NBR   TO PV-PREV-SHFT-NBR                   08670000
098500                                                                  08680000
098600         PERFORM 1200-CHECK-WRITE-EXTRACT                         08690000
098700         IF PS-WRITE-EXTRACT                                      08700000
098800            PERFORM 3000-BUILD-CSR1-RECORD                        08710000
098900         END-IF                                                   08720000
099000         PERFORM 1320-ADD-TO-DC-TOTAL                             08730000
099100         PERFORM 1330-COMP-TOT-SUM                                08740000
099200         PERFORM 1310-ADD-TO-SHFT-TOTAL                           08750000
099300         PERFORM 1510-ADD-TO-OPER-TOTAL                           08760000
099400         PERFORM 1520-ADD-TO-COMPANY-TOTALS                       08770000
099500     END-IF.                                                      08780000
099600                                                                  08790000
099700     PERFORM 7010-FETCH-FIRST-CSR.                                08800008
099800/                                                                 08810000
099900***************************************************************** 08820000
100000* PROCESS SECOND CURSOR.                                          08830000
100100***************************************************************** 08840000
100200 2600-PROCESS-SECOND-CSR.                                         08850000
100300*                                                                 08860000
100400     IF PV-OPER-NBR   =    PV-PREV-OPER-NBR                       08870000
100500         PERFORM 1310-ADD-TO-SHFT-TOTAL                           08880000
100600         PERFORM 1320-ADD-TO-DC-TOTAL                             08890000
100700         PERFORM 1330-COMP-TOT-SUM                                08900000
100800         PERFORM 1510-ADD-TO-OPER-TOTAL                           08910000
100900         PERFORM 1520-ADD-TO-COMPANY-TOTALS                       08920000
101000         IF PS-WRITE-EXTRACT                                      08930000
101100              PERFORM 3100-BUILD-CSR2-RECORD                      08940000
101200         END-IF                                                   08950000
101300     ELSE                                                         08960000
101400         PERFORM 1200-CHECK-WRITE-EXTRACT                         08970000
101500         PERFORM 2100-DC-SHFT-TOTALS                              08980000
101600         PERFORM 7100-SELECT-VERIFIED                             08990000
101700         PERFORM 1530-ADD-TO-VRFD-TOTAL                           09000000
101800         IF PS-WRITE-EXTRACT                                      09010000
101900             PERFORM 3200-BUILD-D-RECORD                          09020000
102000         END-IF                                                   09030000
102100         PERFORM 1600-INITIALIZE-OPER-TOTALS                      09040000
102200         MOVE PV-OPER-NBR   TO PV-PREV-OPER-NBR                   09050000
102300         MOVE PV-SHFT-NBR   TO PV-PREV-SHFT-NBR                   09060000
102400                                                                  09070000
102500         PERFORM 1200-CHECK-WRITE-EXTRACT                         09080000
102600         IF PS-WRITE-EXTRACT                                      09090000
102700              PERFORM 3100-BUILD-CSR2-RECORD                      09100000
102800         END-IF                                                   09110000
102900         PERFORM 1320-ADD-TO-DC-TOTAL                             09120000
103000         PERFORM 1330-COMP-TOT-SUM                                09130000
103100         PERFORM 1310-ADD-TO-SHFT-TOTAL                           09140000
103200         PERFORM 1510-ADD-TO-OPER-TOTAL                           09150000
103300         PERFORM 1520-ADD-TO-COMPANY-TOTALS                       09160000
103400     END-IF.                                                      09170000
103500                                                                  09180000
103600     PERFORM 7040-FETCH-SECOND-CSR.                               09190000
103700/                                                                 09200000
103800***************************************************************** 09210000
103900* PROCESS THIRD CURSOR.                                           09220000
104000***************************************************************** 09230000
104100 2700-PROCESS-THIRD-CSR.                                          09240000
104200*                                                                 09250000
104300         IF PV-OPER-NBR   =    PV-PREV-OPER-NBR                   09260000
104400            PERFORM 1510-ADD-TO-OPER-TOTAL                        09270000
104500            PERFORM 1320-ADD-TO-DC-TOTAL                          09280000
104600            PERFORM 1330-COMP-TOT-SUM                             09290000
104700            PERFORM 1520-ADD-TO-COMPANY-TOTALS                    09300000
104800         ELSE                                                     09310000
104900            PERFORM 1200-CHECK-WRITE-EXTRACT                      09320000
105000            PERFORM 2100-DC-SHFT-TOTALS                           09330000
105100            IF PS-WRITE-EXTRACT                                   09340000
105200                PERFORM 3200-BUILD-D-RECORD                       09350000
105300            END-IF                                                09360000
105400            PERFORM 1600-INITIALIZE-OPER-TOTALS                   09370000
105500            MOVE PV-OPER-NBR   TO PV-PREV-OPER-NBR                09380000
105600                                                                  09390000
105700            PERFORM 1510-ADD-TO-OPER-TOTAL                        09400000
105800            PERFORM 1320-ADD-TO-DC-TOTAL                          09410000
105900            PERFORM 1330-COMP-TOT-SUM                             09420000
106000            PERFORM 1520-ADD-TO-COMPANY-TOTALS                    09430000
106100     END-IF.                                                      09440000
106200                                                                  09450000
106300     PERFORM 7070-FETCH-THIRD-CSR.                                09460000
106400/                                                                 09470000
106500***************************************************************** 09480000
106600* PROCESS THIRD CURSOR.                                           09490000
106700***************************************************************** 09500000
106800 2800-BUILD-THIRD-CSR.                                            09510000
106900*                                                                 09520000
107000     MOVE PV-OPER-NBR               TO  PV-PREV-OPER-NBR.         09530000
107100     MOVE PV-SHFT-NBR               TO  PV-SHIFT.                 09540000
107200     MOVE PV-PCT00005-UNT-WRKD-QTY  TO  PV-OPER-UNT-WRKD-SUM.     09550000
107300     MOVE PV-PCT00005-CART-WRKD-QTY TO  PV-OPER-CART-WRKD-SUM.    09560000
107400     MOVE PV-PCT00005-PO-RCVR-WRKD-QTY                            09570000
107410                                    TO  PV-OPER-PO-RCVR-WRKD-SUM.         
107500     MOVE PV-PCT00005-EXTD-RTL-WRKD-AMT                           09580000
107600                                    TO PV-OPER-EXTD-RTL-WRKD-SUM. 09590000
107700/                                                                 09600000
107800***************************************************************** 09610000
107900* BUILD EXTRACT RECORD FOR FIRST CURSOR (PROCESS AREA LEVEL).     09620000
108000* THIS IS A DETAIL RECORD; VALUE 'F' IN  PC012-RECORD-TYPE-CDE.   09630000
108100***************************************************************** 09640000
108200 3000-BUILD-CSR1-RECORD.                                          09650000
108300                                                                  09660000
108400     INITIALIZE PC012-RECORD-LAYOUT.                              09670000
108500                                                                  09680000
108600     MOVE  'F'                        TO PC012-RECORD-TYPE-CDE.   09690000
108700     MOVE CC-START-RPT-DATE-RANGE     TO PC012-BUSINESS-DATE.     09700000
108800     IF PV-DATA-TYPE-PREVIOUS                                     09701003
108900        SET PC012-DATA-TYPE-PREVIOUS  TO TRUE                     09702003
109000     ELSE                                                         09703003
109100        SET PC012-DATA-TYPE-CURRENT   TO TRUE.                    09703103
109200     MOVE CC-FISCAL-YYYY              TO PC012-FISCAL-YYYY.       09710000
109300     MOVE CC-FISCAL-MONTH             TO PC012-FISCAL-MONTH.      09720000
109400     MOVE CC-FISCAL-WEEK              TO PC012-FISCAL-WEEK.       09730000
109500*    MOVE PCT00005-OPER-UNT-ID        TO PC012-OPER-UNT-ID.       09740000
109600     IF CC-OPER-ALL                                               09750000
109700        MOVE CC-OPER-UNIT-ID          TO PC012-OPER-UNT-ID        09760000
109800     ELSE                                                         09770000
109900        MOVE PCT00005-OPER-UNT-ID     TO PC012-OPER-UNT-ID.       09780000
110000     MOVE PCT00005-SHFT-NBR           TO PC012-SHIFT-NBR.         09790000
110100     MOVE PCT00005-PRCG-AREA-CDE      TO PC012-PROCESS-AREA.      09800000
110200     IF CC-RPT-PCKRP014                                           09800110
110300         PERFORM 7200-SELECT-GROUP.                               09801010
110400     MOVE PCT00003-PRC-AREA-GP-CDE    TO PC012-PROCESS-GROUP.     09802006
110500     MOVE PV-PCT00005-UNT-WRKD-QTY    TO PC012-UNT-WRKD-QTY.      09810000
110600     MOVE PV-PCT00005-CART-WRKD-QTY   TO PC012-CART-WRKD-QTY.     09820000
110700     MOVE PV-PCT00005-PO-RCVR-WRKD-QTY                            09830000
110710                                      TO PC012-PO-RCVR-WRKD-QTY.          
110800     MOVE PV-PCT00005-EXTD-RTL-WRKD-AMT                           09840000
110810                                      TO PC012-EXTD-RTL-WRKD-AMT.         
110900                                                                  09850000
111000     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               09860000
111100     ADD PC-1                         TO PV-EXTRACTS-COUNTER.     09870000
111200                                                                  09871000
111300     IF  PV-PREV-OPER-UNIT-ID IS EQUAL TO                         09872000
111400         PC012-OPER-UNT-ID                                        09872100
111500     AND PV-PREV-PROCESS-AREA IS EQUAL TO                         09872200
111600         PC012-PROCESS-AREA                                       09872300
111700         CONTINUE                                                 09872400
111800     ELSE                                                         09872500
111900         PERFORM 3050-BUILD-ZERO-RECORDS                          09872600
112000         MOVE PC012-OPER-UNT-ID TO                                09872701
112100              PV-PREV-OPER-UNIT-ID                                09872800
112200         MOVE PC012-PROCESS-AREA TO                               09872900
112300              PV-PREV-PROCESS-AREA                                09873000
112400     END-IF.                                                      09874000
112500/                                                                 09880000
112600***************************************************************** 09890000
112700* THE FOLLOWING PARAGRAPH WILL BE USED TO PUT OUT A RECORD FOR    09900000
112800* EACH SHIFT FOR THE PROCESS AREA/GROUP F RECORD BEING WRITTEN.   09910000
112900* THIS IS BEING DONE TO ENSURE THAT FOR EVERY PROCESS AREA/       09911000
113000* GROUP BEING WRITTEN WILL HAVE A RECORD ON THE FILE FOR EVERY    09912000
113100* SHIFT.  THE DATA FROM THIS PROGRAM IS SORT SUMMED WITHIN THE    09913000
113200* JOBS WHICH WILL ELIMINATE ANY UNNEEDED ZERO QUANTITY RECORDS.   09914000
113300* THIS WAS DONE BECAUSE THE PROGRAMS CREATING THE VARIOUS         09915000
113400* REPORTS AT SHIFT LEVEL ARE EXPECTING A RECORD FOR EACH SHIFT    09916000
113500* EVEN IF THERE WERE NO UNITS WORKED WITHIN THE SHIFT.            09917000
113600***************************************************************** 09920000
113700 3050-BUILD-ZERO-RECORDS.                                         09930000
113800                                                                  09930100
113900     MOVE 1                           TO PC012-SHIFT-NBR.         09930200
114000     MOVE ZEROS                       TO PC012-UNT-WRKD-QTY       09930400
114100                                         PC012-CART-WRKD-QTY      09930500
114200                                         PC012-PO-RCVR-WRKD-QTY   09930600
114300                                         PC012-EXTD-RTL-WRKD-AMT. 09930700
114400     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               09930900
114500                                                                  09931000
114600     MOVE 2                           TO PC012-SHIFT-NBR.         09931100
114700     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               09931700
114800                                                                  09931800
114900     MOVE 3                           TO PC012-SHIFT-NBR.         09931900
115000     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               09932500
115100/                                                                 09932600
115200***************************************************************** 09932700
115300* BUILD EXTRACT RECORD FOR SECOND CURSOR (PROCESS GROUP LEVEL).   09933000
115400* THIS IS A DETAIL RECORD; VALUE 'F' IN  PC012-RECORD-TYPE-CDE.   09934000
115500***************************************************************** 09935000
115600 3100-BUILD-CSR2-RECORD.                                          09936000
115700                                                                  09940000
115800     INITIALIZE PC012-RECORD-LAYOUT.                              09950000
115900                                                                  09960000
116000     MOVE  'F'                        TO PC012-RECORD-TYPE-CDE.   09970000
116100     MOVE CC-START-RPT-DATE-RANGE     TO PC012-BUSINESS-DATE.     09980000
116200     IF PV-DATA-TYPE-PREVIOUS                                     09981003
116300        SET PC012-DATA-TYPE-PREVIOUS  TO TRUE                     09982003
116400     ELSE                                                         09983003
116500        SET PC012-DATA-TYPE-CURRENT   TO TRUE.                    09984003
116600     MOVE CC-FISCAL-YYYY              TO PC012-FISCAL-YYYY.       09990000
116700     MOVE CC-FISCAL-MONTH             TO PC012-FISCAL-MONTH.      10000000
116800     MOVE CC-FISCAL-WEEK              TO PC012-FISCAL-WEEK.       10010000
116900*    MOVE PCT00005-OPER-UNT-ID        TO PC012-OPER-UNT-ID.       10020000
117000     IF CC-OPER-ALL                                               10030000
117100        MOVE CC-OPER-UNIT-ID          TO PC012-OPER-UNT-ID        10040000
117200     ELSE                                                         10050000
117300        MOVE PCT00005-OPER-UNT-ID     TO PC012-OPER-UNT-ID.       10060000
117400     MOVE PCT00005-SHFT-NBR           TO PC012-SHIFT-NBR.         10070000
117500     MOVE PCT00003-PRC-AREA-GP-CDE    TO PC012-PROCESS-GROUP.     10080000
117600     MOVE PV-PCT00005-UNT-WRKD-QTY    TO PC012-UNT-WRKD-QTY.      10090000
117700     MOVE PV-PCT00005-CART-WRKD-QTY   TO PC012-CART-WRKD-QTY.     10100000
117800     MOVE PV-PCT00005-PO-RCVR-WRKD-QTY                            10110000
117810                                      TO PC012-PO-RCVR-WRKD-QTY.          
117900     MOVE PV-PCT00005-EXTD-RTL-WRKD-AMT TO                        10120000
117910                                      PC012-EXTD-RTL-WRKD-AMT.            
118000                                                                  10130000
118100     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               10140000
118200     ADD PC-1                         TO PV-EXTRACTS-COUNTER.     10150000
118300                                                                  10150100
118400     IF  PV-PREV-OPER-UNIT-ID IS EQUAL TO                         10151000
118500         PC012-OPER-UNT-ID                                        10152000
118600     AND PV-PREV-PROCESS-GROUP IS EQUAL TO                        10153000
118700         PC012-PROCESS-GROUP                                      10154000
118800         CONTINUE                                                 10155000
118900     ELSE                                                         10156000
119000         PERFORM 3050-BUILD-ZERO-RECORDS                          10157000
119100         MOVE PC012-OPER-UNT-ID TO                                10158001
119200              PV-PREV-OPER-UNIT-ID                                10159000
119300         MOVE PC012-PROCESS-GROUP TO                              10159100
119400              PV-PREV-PROCESS-GROUP                               10159200
119500     END-IF.                                                      10159300
119600/                                                                 10160000
119700***************************************************************** 10170000
119800* BUILD EXTRACT RECORD FOR THIRD CURSOR.                          10180000
119900* THIS IS A DC SUM RECORD; VALUE 'D' IN  PC012-RECORD-TYPE-CDE.   10190000
120000***************************************************************** 10200000
120100 3200-BUILD-D-RECORD.                                             10210000
120200                                                                  10220000
120300     INITIALIZE PC012-RECORD-LAYOUT.                              10230000
120400                                                                  10240000
120500     MOVE  'D'                        TO PC012-RECORD-TYPE-CDE.   10250000
120600     MOVE CC-START-RPT-DATE-RANGE     TO PC012-BUSINESS-DATE.     10260000
120700     IF PV-DATA-TYPE-PREVIOUS                                     10261003
120800        SET PC012-DATA-TYPE-PREVIOUS  TO TRUE                     10262003
120900     ELSE                                                         10263003
121000        SET PC012-DATA-TYPE-CURRENT   TO TRUE.                    10264003
121100     MOVE CC-FISCAL-YYYY              TO PC012-FISCAL-YYYY.       10270000
121200     MOVE CC-FISCAL-MONTH             TO PC012-FISCAL-MONTH.      10280000
121300     MOVE CC-FISCAL-WEEK              TO PC012-FISCAL-WEEK.       10290000
121400*    MOVE PV-PREV-OPER-NBR            TO PC012-OPER-UNT-ID.       10300000
121500     IF CC-OPER-ALL AND CC-RPT-PCKRP011                           10310000
121600        MOVE CC-OPER-UNIT-ID          TO PC012-OPER-UNT-ID        10320000
121700     ELSE                                                         10330000
121800        MOVE PV-PREV-OPER-NBR         TO PC012-OPER-UNT-ID.       10340000
121900*    MOVE PV-PREV-SHFT-NBR            TO PC012-SHIFT-NBR.         10350000
122000                                                                  10360000
122100     MOVE PV-DC-UNT-WRKD-SUM          TO PC012-UNT-WRKD-QTY.      10370000
122200     MOVE PV-DC-CART-WRKD-SUM         TO PC012-CART-WRKD-QTY.     10380000
122300     MOVE PV-DC-PO-RCVR-WRKD-SUM      TO PC012-PO-RCVR-WRKD-QTY.  10390000
122400     MOVE PV-DC-EXTD-RTL-WRKD-SUM     TO PC012-EXTD-RTL-WRKD-AMT. 10400000
122500                                                                  10410000
122600     MOVE PV-OPER-VRFD-UNT-SUM        TO PC012-UNT-VRFD-QTY.      10420000
122700     MOVE PV-OPER-VRFD-CART-SUM       TO PC012-CART-VRFD-QTY.     10430000
122800     MOVE PV-OPER-VRFD-PO-RCVR-SUM    TO PC012-PO-RCVR-VRFD-QTY.  10440000
122900     MOVE PV-OPER-VRFD-EXTD-RTL-SUM   TO PC012-EXTD-RTL-VRFD-AMT. 10450000
123000                                                                  10460000
123100     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               10470000
123200     ADD PC-1                         TO PV-EXTRACTS-COUNTER.     10480000
123300/                                                                 10490000
123400***************************************************************** 10500000
123500* BUILD SUMMARY RECORD                                            10510000
123600* THIS IS A DC SHIFT SUM RECORD; VALUE 'E' IN                     10520000
123700* PC012-RECORD-TYPE-CDE.                                          10530000
123800***************************************************************** 10540000
123900 3300-BUILD-E-RECORD.                                             10550000
124000                                                                  10560000
124100     INITIALIZE PC012-RECORD-LAYOUT.                              10570000
124200                                                                  10580000
124300     MOVE  'E'                        TO PC012-RECORD-TYPE-CDE.   10590000
124400     MOVE CC-START-RPT-DATE-RANGE     TO PC012-BUSINESS-DATE.     10600000
124500     IF PV-DATA-TYPE-PREVIOUS                                     10601003
124600        SET PC012-DATA-TYPE-PREVIOUS  TO TRUE                     10602003
124700     ELSE                                                         10603003
124800        SET PC012-DATA-TYPE-CURRENT   TO TRUE.                    10604003
124900     MOVE CC-FISCAL-YYYY              TO PC012-FISCAL-YYYY.       10610000
125000     MOVE CC-FISCAL-MONTH             TO PC012-FISCAL-MONTH.      10620000
125100     MOVE CC-FISCAL-WEEK              TO PC012-FISCAL-WEEK.       10630000
125200*    MOVE PV-PREV-OPER-NBR            TO PC012-OPER-UNT-ID.       10640000
125300     IF CC-OPER-ALL AND CC-RPT-PCKRP011                           10650000
125400        MOVE CC-OPER-UNIT-ID          TO PC012-OPER-UNT-ID        10660000
125500     ELSE                                                         10670000
125600        MOVE PV-PREV-OPER-NBR         TO PC012-OPER-UNT-ID.       10680000
125700     MOVE PV-SHIFT                    TO PC012-SHIFT-NBR.         10690000
125800                                                                  10700000
125900     MOVE PV-OPER-UNT-WRKD-SUM        TO PC012-UNT-WRKD-QTY.      10710000
126000     MOVE PV-OPER-CART-WRKD-SUM       TO PC012-CART-WRKD-QTY.     10720000
126100     MOVE PV-OPER-PO-RCVR-WRKD-SUM    TO PC012-PO-RCVR-WRKD-QTY.  10730000
126200     MOVE PV-OPER-EXTD-RTL-WRKD-SUM   TO PC012-EXTD-RTL-WRKD-AMT. 10740000
126300                                                                  10750000
126400     MOVE PV-PCT00006-UNT-VRFD-QTY    TO PC012-UNT-VRFD-QTY.      10760000
126500     MOVE PV-PCT00006-CART-VRFD-QTY   TO PC012-CART-VRFD-QTY.     10770000
126600     MOVE PV-PCT00006-PO-RCVR-VRFD-QTY TO PC012-PO-RCVR-VRFD-QTY. 10780000
126700     MOVE PV-PCT00006-EXTD-RTL-VRFD-AMT                           10790000
126710                                       TO PC012-EXTD-RTL-VRFD-AMT.        
126800                                                                  10800000
126900     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               10810000
127000     ADD PC-1                         TO PV-EXTRACTS-COUNTER.     10820000
127100                                                                  10820100
127200/                                                                 10830000
127300***************************************************************** 10840000
127400* BUILD SUMMARY RECORD.                                           10850000
127500* THIS IS A COMPANY TOTAL SUM RECORD; VALUE 'B' IN                10860000
127600* PC012-RECORD-TYPE-CDE.                                          10870000
127700***************************************************************** 10880000
127800 3400-BUILD-B-RECORD.                                             10890000
127900                                                                  10900000
128000     INITIALIZE PC012-RECORD-LAYOUT.                              10910000
128100                                                                  10920000
128200     MOVE  'B'                        TO PC012-RECORD-TYPE-CDE.   10930000
128300     MOVE CC-START-RPT-DATE-RANGE     TO PC012-BUSINESS-DATE.     10940000
128400     IF PV-DATA-TYPE-PREVIOUS                                     10941003
128500        SET PC012-DATA-TYPE-PREVIOUS  TO TRUE                     10942003
128600     ELSE                                                         10943003
128700        SET PC012-DATA-TYPE-CURRENT   TO TRUE.                    10944003
128800     MOVE CC-FISCAL-YYYY              TO PC012-FISCAL-YYYY.       10950000
128900     MOVE CC-FISCAL-MONTH             TO PC012-FISCAL-MONTH.      10960000
129000     MOVE CC-FISCAL-WEEK              TO PC012-FISCAL-WEEK.       10970000
129100                                                                  10980000
129200     MOVE PV-COMP-UNT-WRKD-TOT        TO PC012-UNT-WRKD-QTY.      10990000
129300     MOVE PV-COMP-CART-WRKD-TOT       TO PC012-CART-WRKD-QTY.     11000000
129400     MOVE PV-COMP-PO-RCVR-WRKD-TOT    TO PC012-PO-RCVR-WRKD-QTY.  11010000
129500     MOVE PV-COMP-EXTD-RTL-WRKD-TOT   TO PC012-EXTD-RTL-WRKD-AMT. 11020000
129600                                                                  11030000
129700     MOVE PV-COMP-VRFD-UNT-SUM        TO PC012-UNT-VRFD-QTY.      11040000
129800     MOVE PV-COMP-VRFD-CART-SUM       TO PC012-CART-VRFD-QTY.     11050000
129900     MOVE PV-COMP-VRFD-PO-RCVR-SUM    TO PC012-PO-RCVR-VRFD-QTY.  11060000
130000     MOVE PV-COMP-VRFD-EXTD-RTL-SUM   TO PC012-EXTD-RTL-VRFD-AMT. 11070000
130100                                                                  11080000
130200     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               11090000
130300     ADD PC-1                         TO PV-EXTRACTS-COUNTER.     11100000
130400/                                                                 11110000
130500***************************************************************** 11120000
130600* BUILD SUMMARY RECORD.                                           11130000
130700* THIS IS A COMPANY SHIFT SUM RECORD; VALUE 'C' IN                11140000
130800* PC012-RECORD-TYPE-CDE.                                          11150000
130900***************************************************************** 11160000
131000 3500-BUILD-C-RECORD.                                             11170000
131100                                                                  11180000
131200     INITIALIZE PC012-RECORD-LAYOUT.                              11190000
131300                                                                  11200000
131400     MOVE  'C'                        TO PC012-RECORD-TYPE-CDE.   11210000
131500     MOVE CC-START-RPT-DATE-RANGE     TO PC012-BUSINESS-DATE.     11220000
131600     IF PV-DATA-TYPE-PREVIOUS                                     11221003
131700        SET PC012-DATA-TYPE-PREVIOUS  TO TRUE                     11222003
131800     ELSE                                                         11223003
131900        SET PC012-DATA-TYPE-CURRENT   TO TRUE.                    11224003
132000     MOVE CC-FISCAL-YYYY              TO PC012-FISCAL-YYYY.       11230000
132100     MOVE CC-FISCAL-MONTH             TO PC012-FISCAL-MONTH.      11240000
132200     MOVE CC-FISCAL-WEEK              TO PC012-FISCAL-WEEK.       11250000
132300     MOVE PV-SHIFT                    TO PC012-SHIFT-NBR.         11260000
132400                                                                  11270000
132500     MOVE PV-COMP-UNT-WRKD-SUM        TO PC012-UNT-WRKD-QTY.      11280000
132600     MOVE PV-COMP-CART-WRKD-SUM       TO PC012-CART-WRKD-QTY.     11290000
132700     MOVE PV-COMP-PO-RCVR-WRKD-SUM    TO PC012-PO-RCVR-WRKD-QTY.  11300000
132800     MOVE PV-COMP-EXTD-RTL-WRKD-SUM   TO PC012-EXTD-RTL-WRKD-AMT. 11310000
132900                                                                  11320000
133000     MOVE PV-SHFT-VRFD-UNT-SUM        TO PC012-UNT-VRFD-QTY.      11330000
133100     MOVE PV-SHFT-VRFD-CART-SUM       TO PC012-CART-VRFD-QTY.     11340000
133200     MOVE PV-SHFT-VRFD-PO-RCVR-SUM    TO PC012-PO-RCVR-VRFD-QTY.  11350000
133300     MOVE PV-SHFT-VRFD-EXTD-RTL-SUM   TO PC012-EXTD-RTL-VRFD-AMT. 11360000
133400                                                                  11370000
133500     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               11380000
133600     ADD PC-1                         TO PV-EXTRACTS-COUNTER.     11390000
133700/                                                                 11400000
133800***************************************************************** 11410000
133900*    OPEN FIRST CURSOR                                          * 11420000
134000***************************************************************** 11430000
134100 7000-OPEN-FIRST-CSR.                                             11440000
134200                                                                  11450000
134300     EXEC SQL                                                     11460000
134400         OPEN FIRST-CSR                                           11470000
134500     END-EXEC.                                                    11480000
134600                                                                  11490000
134700     EVALUATE TRUE                                                11500000
134800         WHEN SQLCODE = ZERO                                      11510000
134900             SET  PS-CURSOR-OPENED-YES  TO  TRUE                  11520000
135000         WHEN SQLCODE = -904                                      11530000
135100         WHEN SQLCODE = -911                                      11540000
135200         WHEN SQLCODE = -913                                      11550000
135300             DISPLAY '** SQL CONTENTION ERROR **'                 11560000
135400             DISPLAY '** 7000-OPEN-FIRST-CSR'                     11570000
135500              PERFORM 8000-CREATE-ERROR-RECORD                    11580000
135600         WHEN SQLCODE < ZERO                                      11590000
135700             DISPLAY '** ABEND - PCKUT019 **'                     11600007
135800             DISPLAY '** 7000-OPEN-FIRST-CSR'                     11610000
135900             PERFORM 9200-SQL-ERROR                               11620000
136000         WHEN SQLCODE > ZERO                                      11630000
136100         WHEN SQLWARN0 NOT = SPACES                               11640000
136200             DISPLAY '** ABEND - PCKUT019 **'                     11650000
136300             DISPLAY '** 7000-OPEN-FIRST-CSR'                     11660000
136400             PERFORM 9300-SQL-WARNING                             11670000
136500     END-EVALUATE.                                                11680000
136600/                                                                 11690000
136700***************************************************************** 11700000
136800*    FETCH FIRST CURSOR                                         * 11710000
136900***************************************************************** 11720000
137000 7010-FETCH-FIRST-CSR.                                            11730000
137100     EXEC SQL                                                     11740000
137200         FETCH FIRST-CSR                                          11750000
137300         INTO                                                     11760000
137400                 :PCT00005-OPER-UNT-ID                            11770000
137500             ,   :PCT00005-SHFT-NBR                               11780000
137600             ,   :PCT00005-PRCG-AREA-CDE                          11790000
137700             ,   :PV-PCT00005-UNT-WRKD-QTY                        11800000
137800             ,   :PV-PCT00005-CART-WRKD-QTY                       11810000
137900             ,   :PV-PCT00005-PO-RCVR-WRKD-QTY                    11820000
138000             ,   :PV-PCT00005-EXTD-RTL-WRKD-AMT                   11830000
138100     END-EXEC.                                                    11840000
138200                                                                  11850000
138300     EVALUATE TRUE                                                11860000
138400         WHEN SQLCODE = ZERO                                      11870000
138500             ADD PC-1                   TO PV-FIRST-CSR-FETCHED   11880000
138600             MOVE PCT00005-OPER-UNT-ID  TO PV-OPER-NBR            11890000
138700             MOVE PCT00005-SHFT-NBR     TO PV-SHFT-NBR            11900000
138800         WHEN SQLCODE = +100                                      11910000
138900             SET PS-EOF-CSR           TO TRUE                     11920000
139000         WHEN SQLCODE = -904                                      11930000
139100         WHEN SQLCODE = -911                                      11940000
139200         WHEN SQLCODE = -913                                      11950000
139300              PERFORM 8000-CREATE-ERROR-RECORD                    11960000
139400         WHEN SQLCODE < ZERO                                      11970000
139500             DISPLAY '** ABEND - PCKUT019 **'                     11980000
139600             DISPLAY '** 7010-FETCH-FIRST-CSR'                    11990000
139700             PERFORM 9200-SQL-ERROR                               12000000
139800         WHEN SQLCODE > ZERO                                      12010000
139900         WHEN SQLWARN0 NOT = SPACES                               12020000
140000             DISPLAY '** ABEND - PCKUT019 **'                     12030000
140100             DISPLAY '** 7010-FETCH-FIRST-CSR'                    12040000
140200             PERFORM 9300-SQL-WARNING                             12050000
140300     END-EVALUATE.                                                12060000
140400/                                                                 12070000
140500***************************************************************** 12080000
140600*    CLOSE FIRST CURSOR                                         * 12090000
140700***************************************************************** 12100000
140800 7020-CLOSE-FIRST-CSR.                                            12110000
140900                                                                  12120000
141000     EXEC SQL                                                     12130000
141100         CLOSE FIRST-CSR                                          12140000
141200     END-EXEC.                                                    12150000
141300                                                                  12160000
141400     EVALUATE TRUE                                                12170000
141500         WHEN SQLCODE = ZERO                                      12180000
141600             CONTINUE                                             12190000
141700         WHEN SQLCODE = -904                                      12200000
141800         WHEN SQLCODE = -911                                      12210000
141900         WHEN SQLCODE = -913                                      12220000
142000              PERFORM 8000-CREATE-ERROR-RECORD                    12230000
142100         WHEN SQLCODE < ZERO                                      12240000
142200             DISPLAY '** ABEND - PCKUT019 **'                     12250000
142300             DISPLAY '** 7020-CLOSE-FIRST-CSR'                    12260000
142400             PERFORM 9200-SQL-ERROR                               12270000
142500         WHEN SQLCODE > ZERO                                      12280000
142600         WHEN SQLWARN0 NOT = SPACES                               12290000
142700             DISPLAY '** ABEND - PCKUT019 **'                     12300000
142800             DISPLAY '** 7020-CLOSE-FIRST-CSR'                    12310000
142900             PERFORM 9300-SQL-WARNING                             12320000
143000     END-EVALUATE.                                                12330000
143100/                                                                 12340000
143200***************************************************************** 12350000
143300*    OPEN SECOND CURSOR                                         * 12360000
143400***************************************************************** 12370000
143500 7030-OPEN-SECOND-CSR.                                            12380000
143600                                                                  12390000
143700     EXEC SQL                                                     12400000
143800         OPEN SECOND-CSR                                          12410000
143900     END-EXEC.                                                    12420000
144000                                                                  12430000
144100     EVALUATE TRUE                                                12440000
144200         WHEN SQLCODE = ZERO                                      12450000
144300             SET  PS-CURSOR-OPENED-YES  TO  TRUE                  12460000
144400         WHEN SQLCODE = -904                                      12470000
144500         WHEN SQLCODE = -911                                      12480000
144600         WHEN SQLCODE = -913                                      12490000
144700             DISPLAY '** SQL CONTENTION ERROR **'                 12500000
144800             DISPLAY '** 7030-OPEN-SECOND-CSR'                    12510000
144900              PERFORM 8000-CREATE-ERROR-RECORD                    12520000
145000         WHEN SQLCODE < ZERO                                      12530000
145100             DISPLAY '** ABEND - PCKUT019 **'                     12540000
145200             DISPLAY '** 7030-OPEN-SECOND-CSR'                    12550000
145300             PERFORM 9200-SQL-ERROR                               12560000
145400         WHEN SQLCODE > ZERO                                      12570000
145500         WHEN SQLWARN0 NOT = SPACES                               12580000
145600             DISPLAY '** ABEND - PCKUT019 **'                     12590000
145700             DISPLAY '** 7030-OPEN-SECOND-CSR'                    12600000
145800             PERFORM 9300-SQL-WARNING                             12610000
145900     END-EVALUATE.                                                12620000
146000/                                                                 12630000
146100***************************************************************** 12640000
146200*    FETCH SECOND CURSOR                                        * 12650000
146300***************************************************************** 12660000
146400 7040-FETCH-SECOND-CSR.                                           12670000
146500     EXEC SQL                                                     12680000
146600         FETCH SECOND-CSR                                         12690000
146700         INTO                                                     12700000
146800                 :PCT00005-OPER-UNT-ID                            12710000
146900             ,   :PCT00005-SHFT-NBR                               12720000
147000             ,   :PCT00003-PRC-AREA-GP-CDE                        12730000
147100             ,   :PV-PCT00005-UNT-WRKD-QTY                        12740000
147200             ,   :PV-PCT00005-CART-WRKD-QTY                       12750000
147300             ,   :PV-PCT00005-PO-RCVR-WRKD-QTY                    12760000
147400             ,   :PV-PCT00005-EXTD-RTL-WRKD-AMT                   12770000
147500     END-EXEC.                                                    12780000
147600                                                                  12790000
147700                                                                  12800000
147800     EVALUATE TRUE                                                12810000
147900         WHEN SQLCODE = ZERO                                      12820000
148000             ADD PC-1                 TO PV-SECOND-CSR-FETCHED    12830000
148100             MOVE PCT00005-OPER-UNT-ID  TO PV-OPER-NBR            12840000
148200             MOVE PCT00005-SHFT-NBR     TO PV-SHFT-NBR            12850000
148300         WHEN SQLCODE = +100                                      12860000
148400             SET PS-EOF-CSR           TO TRUE                     12870000
148500         WHEN SQLCODE = -904                                      12880000
148600         WHEN SQLCODE = -911                                      12890000
148700         WHEN SQLCODE = -913                                      12900000
148800              PERFORM 8000-CREATE-ERROR-RECORD                    12910000
148900         WHEN SQLCODE < ZERO                                      12920000
149000             DISPLAY '** ABEND - PCKUT019 **'                     12930000
149100             DISPLAY '** 7040-FETCH-SECOND-CSR'                   12940000
149200             PERFORM 9200-SQL-ERROR                               12950000
149300         WHEN SQLCODE > ZERO                                      12960000
149400         WHEN SQLWARN0 NOT = SPACES                               12970000
149500             DISPLAY '** ABEND - PCKUT019 **'                     12980000
149600             DISPLAY '** 7040-FETCH-SECOND-CSR'                   12990000
149700             PERFORM 9300-SQL-WARNING                             13000000
149800     END-EVALUATE.                                                13010000
149900/                                                                 13020000
150000***************************************************************** 13030000
150100*    CLOSE SECOND CURSOR                                        * 13040000
150200***************************************************************** 13050000
150300 7050-CLOSE-SECOND-CSR.                                           13060000
150400     EXEC SQL                                                     13070000
150500         CLOSE SECOND-CSR                                         13080000
150600     END-EXEC.                                                    13090000
150700                                                                  13100000
150800     EVALUATE TRUE                                                13110000
150900         WHEN SQLCODE = ZERO                                      13120000
151000             CONTINUE                                             13130000
151100         WHEN SQLCODE = -904                                      13140000
151200         WHEN SQLCODE = -911                                      13150000
151300         WHEN SQLCODE = -913                                      13160000
151400              PERFORM 8000-CREATE-ERROR-RECORD                    13170000
151500         WHEN SQLCODE < ZERO                                      13180000
151600             DISPLAY '** ABEND - PCKUT019 **'                     13190000
151700             DISPLAY '** 7050-CLOSE-SECOND-CSR'                   13200000
151800             PERFORM 9200-SQL-ERROR                               13210000
151900         WHEN SQLCODE > ZERO                                      13220000
152000         WHEN SQLWARN0 NOT = SPACES                               13230000
152100             DISPLAY '** ABEND - PCKUT019 **'                     13240000
152200             DISPLAY '** 7050-CLOSE-SECOND-CSR'                   13250000
152300             PERFORM 9300-SQL-WARNING                             13260000
152400     END-EVALUATE.                                                13270000
152500/                                                                 13280000
152600***************************************************************** 13290000
152700*    OPEN THIRD CURSOR                                          * 13300000
152800***************************************************************** 13310000
152900 7060-OPEN-THIRD-CSR.                                             13320000
153000                                                                  13330000
153100     EXEC SQL                                                     13340000
153200         OPEN THIRD-CSR                                           13350000
153300     END-EXEC.                                                    13360000
153400                                                                  13370000
153500     EVALUATE TRUE                                                13380000
153600         WHEN SQLCODE = ZERO                                      13390000
153700             SET  PS-CURSOR-OPENED-YES  TO  TRUE                  13400000
153800         WHEN SQLCODE = -904                                      13410000
153900         WHEN SQLCODE = -911                                      13420000
154000         WHEN SQLCODE = -913                                      13430000
154100             DISPLAY '** SQL CONTENTION ERROR **'                 13440000
154200             DISPLAY '** 7060-OPEN-THIRD-CSR'                     13450000
154300              PERFORM 8000-CREATE-ERROR-RECORD                    13460000
154400         WHEN SQLCODE < ZERO                                      13470000
154500             DISPLAY '** ABEND - PCKUT019 **'                     13480000
154600             DISPLAY '** 7060-OPEN-THIRD-CSR'                     13490000
154700             PERFORM 9200-SQL-ERROR                               13500000
154800         WHEN SQLCODE > ZERO                                      13510000
154900         WHEN SQLWARN0 NOT = SPACES                               13520000
155000             DISPLAY '** ABEND - PCKUT019 **'                     13530000
155100             DISPLAY '** 7060-OPEN-THIRD-CSR'                     13540000
155200             PERFORM 9300-SQL-WARNING                             13550000
155300     END-EVALUATE.                                                13560000
155400/                                                                 13570000
155500***************************************************************** 13580000
155600*    FETCH THIRD CURSOR                                         * 13590000
155700***************************************************************** 13600000
155800 7070-FETCH-THIRD-CSR.                                            13610000
155900     EXEC SQL                                                     13620000
156000         FETCH THIRD-CSR                                          13630000
156100         INTO                                                     13640000
156200                 :PCT00005-OPER-UNT-ID                            13650000
156300             ,   :PCT00005-SHFT-NBR                               13660000
156400             ,   :PV-PCT00005-UNT-WRKD-QTY                        13670000
156500             ,   :PV-PCT00005-CART-WRKD-QTY                       13680000
156600             ,   :PV-PCT00005-PO-RCVR-WRKD-QTY                    13690000
156700             ,   :PV-PCT00005-EXTD-RTL-WRKD-AMT                   13700000
156800     END-EXEC.                                                    13710000
156900                                                                  13720000
157000                                                                  13730000
157100     EVALUATE TRUE                                                13740000
157200         WHEN SQLCODE = ZERO                                      13750000
157300             ADD PC-1                 TO PV-THIRD-CSR-FETCHED     13760000
157400             MOVE PCT00005-OPER-UNT-ID  TO PV-OPER-NBR            13770000
157500             MOVE PCT00005-SHFT-NBR     TO PV-SHFT-NBR            13780000
157600*            PERFORM  1200-CHECK-WRITE-EXTRACT                    13790000
157700         WHEN SQLCODE = +100                                      13800000
157800             SET PS-EOF-CSR           TO TRUE                     13810000
157900         WHEN SQLCODE = -904                                      13820000
158000         WHEN SQLCODE = -911                                      13830000
158100         WHEN SQLCODE = -913                                      13840000
158200              PERFORM 8000-CREATE-ERROR-RECORD                    13850000
158300         WHEN SQLCODE < ZERO                                      13860000
158400             DISPLAY '** ABEND - PCKUT019 **'                     13870000
158500             DISPLAY '** 7070-FETCH-THIRD-CSR'                    13880000
158600             PERFORM 9200-SQL-ERROR                               13890000
158700         WHEN SQLCODE > ZERO                                      13900000
158800         WHEN SQLWARN0 NOT = SPACES                               13910000
158900             DISPLAY '** ABEND - PCKUT019 **'                     13920000
159000             DISPLAY '** 7070-FETCH-THIRD-CSR'                    13930000
159100             PERFORM 9300-SQL-WARNING                             13940000
159200     END-EVALUATE.                                                13950000
159300/                                                                 13960000
159400***************************************************************** 13970000
159500*    CLOSE THIRD CURSOR                                         * 13980000
159600***************************************************************** 13990000
159700 7080-CLOSE-THIRD-CSR.                                            14000000
159800     EXEC SQL                                                     14010000
159900         CLOSE THIRD-CSR                                          14020000
160000     END-EXEC.                                                    14030000
160100                                                                  14040000
160200     EVALUATE TRUE                                                14050000
160300         WHEN SQLCODE = ZERO                                      14060000
160400             CONTINUE                                             14070000
160500         WHEN SQLCODE = -904                                      14080000
160600         WHEN SQLCODE = -911                                      14090000
160700         WHEN SQLCODE = -913                                      14100000
160800              PERFORM 8000-CREATE-ERROR-RECORD                    14110000
160900         WHEN SQLCODE < ZERO                                      14120000
161000             DISPLAY '** ABEND - PCKUT019 **'                     14130000
161100             DISPLAY '** 7080-CLOSE-THIRD-CSR'                    14140000
161200             PERFORM 9200-SQL-ERROR                               14150000
161300         WHEN SQLCODE > ZERO                                      14160000
161400         WHEN SQLWARN0 NOT = SPACES                               14170000
161500             DISPLAY '** ABEND - PCKUT019 **'                     14180000
161600             DISPLAY '** 7080-CLOSE-THIRD-CSR'                    14190000
161700             PERFORM 9300-SQL-WARNING                             14200000
161800     END-EVALUATE.                                                14210000
161900/                                                                 14220000
162000******************************************************************14230000
162100* BEFORE WRITING A C RECORD EXECUTE THE FOLLOWING SELECT TO GET   14240000
162200* THE VERIFIED INFORMATION RELATED TO THE OPER ID TO WRITE TO     14250000
162300* OUTPUT RECORD.                                                  14260000
162400******************************************************************14270000
162500 7100-SELECT-VERIFIED.                                            14280000
162600*                                                                 14290000
162700     EXEC SQL                                                     14300000
162800         SELECT   A.OPER_UNT_ID                                   14310000
162900                , A.SHFT_NBR                                      14320000
163000                , SUM(A.UNT_VRFD_QTY)                             14330000
163100                , SUM(A.CART_VRFD_QTY)                            14340000
163200                , SUM(A.PO_RCVR_VRFD_QTY)                         14350000
163300                , SUM(A.EXTD_RTL_VRFD_AMT)                        14360000
163400           INTO :PCT00006-OPER-UNT-ID,                            14370000
163500                :PCT00006-SHFT-NBR,                               14380000
163600                :PV-PCT00006-UNT-VRFD-QTY,                        14390000
163700                :PV-PCT00006-CART-VRFD-QTY,                       14400000
163800                :PV-PCT00006-PO-RCVR-VRFD-QTY,                    14410000
163900                :PV-PCT00006-EXTD-RTL-VRFD-AMT                    14420000
164000         FROM PCT_SUM_VRFD A                                      14430000
164100         WHERE A.BUS_DTE BETWEEN :PV-START-RPT-DATE               14440000
164200                             AND :PV-END-RPT-DATE                 14450000
164300            AND A.OPER_UNT_ID = :PV-PREV-OPER-NBR                 14460000
164400            AND A.SHFT_NBR    = :PV-SHIFT                         14470000
164500         GROUP BY A.OPER_UNT_ID, A.SHFT_NBR                       14480000
164600     END-EXEC                                                     14490000
164700                                                                  14500000
164800     EVALUATE TRUE                                                14510000
164900         WHEN SQLCODE = ZERO                                      14520000
165000             CONTINUE                                             14530000
165100         WHEN SQLCODE = +100                                      14540000
165200             MOVE ZERO  TO PV-PCT00006-UNT-VRFD-QTY               14550000
165300             MOVE ZERO  TO PV-PCT00006-CART-VRFD-QTY              14560000
165400             MOVE ZERO  TO PV-PCT00006-PO-RCVR-VRFD-QTY           14570000
165500             MOVE ZERO  TO PV-PCT00006-EXTD-RTL-VRFD-AMT          14580000
165600         WHEN SQLCODE = -904                                      14590000
165700         WHEN SQLCODE = -911                                      14600000
165800         WHEN SQLCODE = -913                                      14610000
165900              PERFORM 8000-CREATE-ERROR-RECORD                    14620000
166000         WHEN SQLCODE < ZERO                                      14630000
166100             DISPLAY '** ABEND - PCKUT019 **'                     14640000
166200             DISPLAY '** 7100-SELECT-VERIFIED **'                 14650000
166300             PERFORM 9200-SQL-ERROR                               14660000
166400         WHEN SQLCODE > ZERO                                      14670000
166500         WHEN SQLWARN0 NOT = SPACES                               14680000
166600             DISPLAY '** ABEND - PCKUT019 **'                     14690000
166700             DISPLAY '** 7100-SELECT-VERIFIED **'                 14700000
166800             PERFORM 9300-SQL-WARNING                             14710000
166900     END-EVALUATE.                                                14720000
167000/                                                                 14730000
167100******************************************************************14731006
167200* BEFORE WRITING A F RECORD EXECUTE THE FOLLOWING SELECT TO GET   14732006
167300* THE GROUP ASSOCIATED WITH THE AREA FOR A GIVEN OPER.            14733006
167400* THIS SELECT WILL ONLY BE EXCECUTED FOR CSR1.                    14734006
167500******************************************************************14735006
167600 7200-SELECT-GROUP.                                               14736006
167700                                                                  14736106
167800         EXEC SQL                                                 14736206
167900           SELECT PRC_AREA_GP_CDE                                 14736306
168000             INTO :PCT00003-PRC-AREA-GP-CDE                       14736406
168100           FROM PCT_PRC_AREA_ASSN                                 14736506
168200             WHERE OPER_UNT_ID   = :PCT00005-OPER-UNT-ID          14736606
168300               AND PRCG_AREA_CDE = :PCT00005-PRCG-AREA-CDE        14736706
168400         END-EXEC                                                 14736906
168500                                                                  14737006
168600     EVALUATE TRUE                                                14737106
168700         WHEN SQLCODE = ZERO                                      14737206
168800             CONTINUE                                             14737306
168900         WHEN SQLCODE = +100                                      14737406
169000             MOVE 'MISC' TO PCT00003-PRC-AREA-GP-CDE              14737506
169100         WHEN SQLCODE = -904                                      14737906
169200         WHEN SQLCODE = -911                                      14738006
169300         WHEN SQLCODE = -913                                      14738106
169400              PERFORM 8000-CREATE-ERROR-RECORD                    14738206
169500         WHEN SQLCODE < ZERO                                      14738306
169600             DISPLAY '** ABEND - PCKUT019 **'                     14738406
169700             DISPLAY '** 7200-SELECT-GROUP **'                    14738506
169800             PERFORM 9200-SQL-ERROR                               14738606
169900         WHEN SQLCODE > ZERO                                      14738706
170000         WHEN SQLWARN0 NOT = SPACES                               14738806
170100             DISPLAY '** ABEND - PCKUT019 **'                     14738906
170200             DISPLAY '** 7200-SELECT-GROUP **'                    14739006
170300             PERFORM 9300-SQL-WARNING                             14739106
170400     END-EVALUATE.                                                14739206
170500/                                                                 14739306
170600******************************************************************14740000
170700* ERROR RECORD                                                    14750000
170800******************************************************************14760000
170900 8000-CREATE-ERROR-RECORD.                                        14770000
171000                                                                  14780000
171100     INITIALIZE PC012-RECORD-LAYOUT.                              14790000
171200                                                                  14800000
171300     SET  PC012-RCD-TYPE-ERROR        TO TRUE.                    14810000
171400     MOVE CC-START-RPT-DATE-RANGE     TO PC012-BUSINESS-DATE      14820000
171500     MOVE CC-FISCAL-YYYY              TO PC012-FISCAL-YYYY        14830000
171600     MOVE CC-FISCAL-MONTH             TO PC012-FISCAL-MONTH       14840000
171700     MOVE CC-FISCAL-WEEK              TO PC012-FISCAL-WEEK        14850000
171800                                                                  14860000
171900     WRITE EXTRACT-RECORD FROM PC012-RECORD-LAYOUT.               14870000
172000                                                                  14880000
172100     SET PS-ERROR                     TO TRUE.                    14890009
172200     SET PS-EOF-CSR                   TO TRUE.                    14900009
172300/                                                                 14910000
172400******************************************************************14920000
172500* END OF JOB TASKS.                                               14930000
172600******************************************************************14940000
172700 9000-EOJ-ROUTINE.                                                14950000
172800                                                                  14960000
172900     CLOSE EXTRACT-FILE.                                          14970000
173000                                                                  14980000
173100     DISPLAY SPACES.                                              14990000
173200     DISPLAY SPACES.                                              15000000
173300     DISPLAY SPACES.                                              15010000
173400                                                                  15020000
173500*    MOVE PV-ROWS-FETCHED            TO PV-DISP-NUM               15030000
173600*    DISPLAY 'ROWS FETCHED           = '  PV-DISP-NUM             15040000
173700                                                                  15050000
173800     MOVE PV-EXTRACTS-COUNTER         TO PV-DISP-NUM              15060000
173900     DISPLAY 'EXTRACTS WRITTEN       = '  PV-DISP-NUM.            15070000
174000                                                                  15080000
174100 9200-SQL-ERROR.                                                  15090000
174200                                                                  15100000
174300     CLOSE EXTRACT-FILE.                                          15110000
174400                                                                  15120000
174500     MOVE SQLCODE                     TO SQLCODE2.                15130000
174600     MOVE SQLERRD(3)                  TO SQLERRD3.                15140000
174700                                                                  15150000
174800     DISPLAY '** ABEND **         ** = SQLERROR'.                 15160000
174900     DISPLAY '** PROGRAM          ** = PCKUT019'.                 15170007
175000     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                15180000
175100     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                15190000
175200     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 15200000
175300     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                15210000
175400                                                                  15220000
175500                                                                  15230000
175600     MOVE +4013                       TO ABEND-CODE.              15240000
175700     CALL 'ILBOABN0' USING ABEND-CODE.                            15250000
175800                                                                  15260000
175900 9300-SQL-WARNING.                                                15270000
176000                                                                  15280000
176100     CLOSE EXTRACT-FILE.                                          15290000
176200                                                                  15300000
176300     DISPLAY '9300-SQL-WARNING'.                                  15310000
176400     MOVE SQLCODE                     TO SQLCODE2.                15320000
176500     MOVE SQLERRD(3)                  TO SQLERRD3.                15330000
176600     DISPLAY '** ABEND **       ** = SQLWARNING'.                 15340000
176700     DISPLAY '** PROGRAM        ** = PCKUT019'.                   15350007
176800     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  15360000
176900     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  15370000
177000     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  15380000
177100     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  15390000
177200     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  15400000
177300     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  15410000
177400     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  15420000
177500     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  15430000
177600     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  15440000
177700     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  15450000
177800                                                                  15460000
177900     MOVE +4013                       TO ABEND-CODE.              15470000
178000     CALL 'ILBOABN0' USING ABEND-CODE.                            15480000
