000200*-----------------------*                                         00020000
000300 IDENTIFICATION DIVISION.                                         00030000
000400*-----------------------*                                         00040000
000500 PROGRAM-ID.    SUKCS758.                                         00050000
000600 AUTHOR.        PATRICK BURKE.                                    00060000
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070000
000800 DATE-WRITTEN.  SEPTEMBER 2003.                                   00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*---------------------------------------------------------------* 00110000
001200*    S758 - PO ARCHIVE REQUEST LIST SCREEN                      * 00120000
001300*    SULARLST                                                   * 00130000
001400*    THIS PROGRAM DISPLAYS THE STATUS OF REQUESTS THAT EXIST ON * 00140000
001500*    AUDIT EXCEPTIONS                                           * 00150000
001600*---------------------------------------------------------------* 00160000
001500*    CHANGES                                                     *00162025
      *    MADE BY: CHERI PARMLEY                                      *00163025
      *    DATE:    09/24/2014                                         *00164025
      *                                                                *00165025
      *    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00166025
      *    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/24/2014      *00167025
      *                                                                *00168025
001600*----------------------------------------------------------------*00168130
273427*    CHANGES                                                     *00168232
273427*    MADE BY: BARB SCHULTZ              CHG273427                *00168332
273427*    DATE:    08/15/2022                                         *00168432
273427*                                                                *00168532
273427*    CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE *00168632
273427*    MAKING THE CALL DYNAMIC VS STATIC.                          *00168732
001130*                                                                 00168833
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00168933
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00169033
273427*                                                                *00169132
001600*----------------------------------------------------------------*00169225
001700 EJECT                                                            00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900                                                                  00190000
002000 DATA DIVISION.                                                   00200000
002100                                                                  00210000
002200 WORKING-STORAGE SECTION.                                         00220000
002300                                                                  00230000
002400 01  DK-DB2-KEYS.                                                 00240000
002500     05  DK-PO-NBR                    PIC S9(09) COMP VALUE ZERO. 00250000
002800     05  DK-OPER-UNT-ID               PIC S9(04) COMP VALUE ZERO. 00280000
002900     05  DK-FCLTY-ID                  PIC S9(04) COMP VALUE ZERO. 00290000
003000     05  DK-FCLTY-NAME                PIC X(25).                  00300000
003100     05  DK-TK-ID                     PIC X(08).                  00310000
003200     05  DK-SHIP-FROM-DATE            PIC X(10).                  00320000
003300     05  DK-SHIP-TO-DATE              PIC X(10).                  00330000
003400                                                                  00340000
003500                                                                  00350000
003600 01  PC-PROGRAM-CONSTANTS.                                        00360000
003700     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00370000
003800                                                    'SUK758  '.   00380000
003900     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00390000
004000                                                    'SUKM758 '.   00400000
004100     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00410000
004200                                                    'SUKCS758'.   00420000
004500     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00450000
004600     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00460000
004700     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00470000
004800     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00480000
004900     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +10     00490000
005000                                                    COMP SYNC.    00500000
005100     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00510000
005200                                                    COMP SYNC.    00520000
005300     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00530000
005400                                                    +1000000      00540000
005500                                                    COMP-3.       00550000
005600     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00560000
005700                                                    COMP SYNC.    00570000
005800     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00580000
005900                                                    COMP-3.       00590000
006000     05  PC-A                           PIC  X(01)  VALUE  'A'.   00600000
006100     05  PC-X                           PIC  X(01)  VALUE  'X'.   00610000
006200     05  PC-DEFAULT                     PIC  X(06)  VALUE         00620000
006300                                                     'DEFALT'.    00630000
006400     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00640000
006500     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00650000
006600     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00660000
006700     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00670000
006800*MESSAGE DEFINITIONS                                              00680000
006900*----------------------------------------------------------------*00690000
007000*  SYSTEM MESSAGES                                               *00700000
007100*----------------------------------------------------------------*00710000
007200*   00005 - INVALID VALUE                                        *00720000
007300*   00008 - MUST BE NUMERIC                                      *00730000
007400*   00045 - INVALID FUNCTION KEY                                 *00740000
007500*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00750000
007600*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00760000
007700*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00770000
007800*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00780000
007900*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00790000
008000*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00800000
008100*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00810000
008200*   00069 - TOP OF LIST                                          *00820000
008300*   00070 - BOTTOM OF LIST                                       *00830000
008400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00840000
008500*   00115 - DELETE SUCCESSFUL                                    *00850000
008600*   00279 - MORE ITEMS TO DISPLAY                                *00860000
008700*   00954 - PO/RECEIVER SEQUENCE NOT FOUND                       *00870000
008800*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00880000
008900*   02234 - PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S)*00890000
009000*   02238 - PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT HAV*00900000
009100*   02479 - RECEIVER SEQUENCE NUMBER MUST BE GREATER THAN ZERO   *00910000
009200*   02679 - UNABLE TO RE-ACTIVATE, NO INACTIVE SMOOTHING EXISTS F*00920000
009300*   02680 - NUMBER OF CRTNS MUST EQUAL NBR OF CRTNS FROM ORIGINAL*00930000
009400*   02681 - RE-ACTIVATION SUCCESSFUL                             *00940000
009500*   02683 - VEND UCC128 DATA EXISTS - F2 TO CONFIRM SMOOTHING    *00950000
009600*   02684 - SMOOTHING HAS NOT OCCURRED, UNABLE TO PERFORM FUNCTIO*00960000
009700*   02688 - UNABLE TO PERFORM FUNCTION, CARTON INACTIVE          *00970000
009800*   02691 - ONE OR MORE STORE(S) SELECTED HAS NOT BEEN SMOOTHED  *00980000
009900*   02692 - INVALID STATUS FOR FUNCTION REQUESTED                *00990000
010000*   02693 - COMMUNICATION ERROR WHEN CREATING LABELS - CONTACT SU*01000000
010100*   02694 - DATABASE ERROR WHEN CREATING LABELS - CONTACT SUPERVI*01010000
010200*   02848 - UNABLE TO DELETE - RANK IS CURRENTLY ASSIGNED VND/DPT*01020000
010300*   02849 - F2 TP CONFIRM DELETE                                 *01030000
010400*   02855 - DEFAULT AUDIT RANK CANNOT BE DELETED                 *01040000
010410*   03042 - CANNOT DELETE PROCESSED REQUEST(S)                   *01041014
010500                                                                  01050000
010600     05  PC-TSYMSG-NUMBERS.                                       01060000
010700         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01070000
010800         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01080000
010900         10  PC-TSYMSG-00016            PIC  9(05)  VALUE 00016.  01090000
011000         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01100000
011100         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01110000
011200         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01120000
011300         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01130000
011400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01140000
011500         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01150000
011600         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01160000
011700         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01170000
011800         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01180000
011900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01190000
012000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01200000
012100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01210000
012200         10  PC-TSYMSG-00115            PIC  9(05)  VALUE 00115.  01220000
012300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01230000
012400         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01240000
012500         10  PC-TSYMSG-02178            PIC  9(05)  VALUE 02178.  01250000
012600         10  PC-TSYMSG-02816            PIC  9(05)  VALUE 02816.  01260000
012700         10  PC-TSYMSG-02848            PIC  9(05)  VALUE 02848.  01270000
012800         10  PC-TSYMSG-02849            PIC  9(05)  VALUE 02849.  01280000
012900         10  PC-TSYMSG-02855            PIC  9(05)  VALUE 02855.  01290000
013000         10  PC-TSYMSG-02866            PIC  9(05)  VALUE 02866.  01300000
013100         10  PC-TSYMSG-02867            PIC  9(05)  VALUE 02867.  01310000
013200         10  PC-TSYMSG-02892            PIC  9(05)  VALUE 02892.  01320000
013210         10  PC-TSYMSG-03042            PIC  9(05)  VALUE 03042.  01321014
013300*                                                                 01330000
013400 01  PS-PROGRAM-SWITCHES.                                         01340000
013500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01350000
013600         88  PS-NO-ERROR                            VALUE 'Y'.    01360000
013700         88  PS-ERROR                               VALUE 'N'.    01370000
013800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01380000
013900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01390000
014000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01400000
014100     05  PS-LIST-END-SW           PIC  X(01)  VALUE 'N'.          01410000
014200         88  PS-LIST-END                      VALUE 'Y'.          01420000
014300         88  PS-NO-LIST-END                   VALUE 'N'.          01430000
014400     05  PS-BLOCK-ERROR-SW        PIC  X(01)  VALUE 'Y'.          01440000
014500         88  PS-NO-BLOCK-ERROR                VALUE 'Y'.          01450000
014600         88  PS-BLOCK-ERROR                   VALUE 'N'.          01460000
014700     05  PS-ACCESS-SW                   PIC  X(01)  VALUE 'N'.    01470000
014800         88  PS-ACCESS-ALLOWED                      VALUE 'Y'.    01480000
014900         88  PS-ACCESS-NOT-ALLOWED                  VALUE 'N'.    01490000
015000     05  PS-VND-DEPT-RNKG-EXISTS-SW     PIC  X(01)  VALUE 'N'.    01500000
015100         88  PS-VND-DEPT-RNKG-EXISTS                VALUE 'Y'.    01510000
015200         88  PS-NO-VND-DEPT-RNKG-EXISTS             VALUE 'N'.    01520000
015300     05  PS-VND-RNKG-EXISTS-SW          PIC  X(01)  VALUE 'N'.    01530000
015400         88  PS-VND-RNKG-EXISTS                     VALUE 'Y'.    01540000
015500         88  PS-NO-VND-RNKG-EXISTS                  VALUE 'N'.    01550000
015600     05  PS-PO-AUD-REQ-EXISTS-SW        PIC  X(01)  VALUE 'N'.    01560000
015700         88  PS-PO-AUD-REQ-EXISTS                   VALUE 'Y'.    01570000
015800         88  PS-NO-PO-AUD-REQ-EXISTS                VALUE 'N'.    01580000
015900     05  PS-END-OF-PACK-TYP-CSR-SW      PIC  X(01)  VALUE 'N'.    01590000
016000         88  PS-END-OF-PACK-TYP-CSR                 VALUE 'Y'.    01600000
016100         88  PS-NOT-END-OF-PACK-TYP-CSR             VALUE 'N'.    01610000
016200     05  PS-PKGNG-TYP-CDE-BC-SW         PIC  X(01)  VALUE 'N'.    01620000
016300         88  PS-PKGNG-TYP-CDE-BC-YES                VALUE 'Y'.    01630000
016400         88  PS-PKGNG-TYP-CDE-BC-NO                 VALUE 'N'.    01640000
016500     05  PS-PKGNG-TYP-CDE-PP-SW         PIC  X(01)  VALUE 'N'.    01650000
016600         88  PS-PKGNG-TYP-CDE-PP-YES                VALUE 'Y'.    01660000
016700         88  PS-PKGNG-TYP-CDE-PP-NO                 VALUE 'N'.    01670000
016800     05  PS-PKGNG-TYP-CDE-PS-SW         PIC  X(01)  VALUE 'N'.    01680000
016900         88  PS-PKGNG-TYP-CDE-PS-YES                VALUE 'Y'.    01690000
017000         88  PS-PKGNG-TYP-CDE-PS-NO                 VALUE 'N'.    01700000
017010     05  PS-DELETE-SW                   PIC  X(01)  VALUE 'Y'.    01701013
017020         88  PS-DELETE-YES                          VALUE 'Y'.    01702013
017030         88  PS-DELETE-NO                           VALUE 'N'.    01703013
017100*                                                                 01710000
017200 01  DN-DB2-NULL-INDICATORS.                                      01720000
017300     05  DN-CRE-TM                  PIC S9(04) COMP VALUE ZEROES. 01730000
017400*                                                                 01740000
017500 01  PV-PROGRAM-VARIABLES.                                        01750000
017600     05  PV-SEL-TERM-ID                  PIC  X(04).              01760000
017700     05  PV-SEL-TASK-NUMBER              PIC  9(05).              01770000
017800     05  PV-SEL-SEQ                      PIC  9(01).              01780000
017900     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01790000
018000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01800000
018100                                                     COMP SYNC.   01810000
018200     05  PV-SUB                         PIC S9(04)  VALUE +0      01820000
018300                                                    COMP SYNC.    01830000
018400     05  PV-DB2-CURRENT-DATE            PIC X(10).                01840000
018500     05  PV-PLND-INV-DTE-FUNC-QTY       PIC X(10).                01850000
018600     05  PV-DB2-CURRENT-TIMESTAMP       PIC X(26).                01860000
018700     05  PV-CURRENT-DATE                PIC X(10).                01870000
018800     05  PV-CURRENT-TIME                PIC  9(06).               01880000
018900     05  PV-NUMBER-OF-UPDATES           PIC S9(04)  VALUE +0      01890000
019000                                                    COMP-3.       01900000
019100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01910000
019200                                                    COMP SYNC.    01920000
019300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01930000
019400                                                    COMP-3.       01940000
019500     05  PV-COUNT                       PIC S9(09)  VALUE +0      01950000
019600                                                    COMP-3.       01960000
019700     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01970000
019800                                                    COMP-3.       01980000
019900     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01990000
020000                                                    COMP-3.       02000000
020100     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02010000
020200                                                    COMP-3.       02020000
020300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02030000
020400                                                    COMP SYNC.    02040000
020500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02050000
020600                                                    COMP SYNC.    02060000
020700     05  PV-ITEM                        PIC S9(04)  VALUE +0      02070000
020800                                                    COMP SYNC.    02080000
020900     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02090000
021000                                                    COMP SYNC.    02100000
021100     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02110000
021200                                                    COMP SYNC.    02120000
021300     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02130000
021400                                                    COMP SYNC.    02140000
021500     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02150000
021600                                                    COMP SYNC.    02160000
021700     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02170000
021800                                                    COMP SYNC.    02180000
021900     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02190000
022000                                                    COMP SYNC.    02200000
022100     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02210000
022200                                                    COMP SYNC.    02220000
022300     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02230000
022400                                                    COMP SYNC.    02240000
022500     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02250000
022600                                                    COMP SYNC.    02260000
022700     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02270000
022800                                                    COMP SYNC.    02280000
022900     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02290000
023000                                                    COMP SYNC.    02300000
023100     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02310000
023200                                                    COMP-3.       02320000
023300*                                                                 02330000
023400     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02340000
023500                                                    COMP-3.       02350000
023600     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02360000
023700                                                    COMP SYNC.    02370000
023800     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       02380000
023900     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       02390000
024000     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02400000
024100                                                    COMP-3.       02410000
024200     05  PV-AUD-CRE-DATE              PIC X(10).                  02420000
024300     05  PV-AUD-LAST-UPD-DATE         PIC X(10).                  02430000
024400     05  PV-SHP-DONT-SHIP-BEF-DTE     PIC X(10).                  02440000
024500     05  PV-SHP-CAN-IFNOT-SHIP-DTE    PIC X(10).                  02450000
024600     05  PV-NULL-SHIP-IND             PIC S9(4) VALUE ZERO        02460000
024700                                                COMP SYNC.        02470000
024800     05  PV-NULL-CANC-IND             PIC S9(4) VALUE ZERO        02480000
024900                                                COMP SYNC.        02490000
025000     05  PV-DISP-4                    PIC 9(04).                  02500000
025001                                                                  02500100
025010     05  PV-FROM-DATE.                                            02501000
025020         10  PV-FROM-YYYY            PIC X(04).                   02502000
025040         10  PV-FROM-MM              PIC X(02).                   02504000
025060         10  PV-FROM-DD              PIC X(02).                   02506000
025070     05  PV-TO-DATE.                                              02507000
025080         10  PV-TO-YYYY              PIC X(04).                   02508000
025091         10  PV-TO-MM                PIC X(02).                   02509100
025093         10  PV-TO-DD                PIC X(02).                   02509300
025094     05  PV-DB2-TIMESTAMP             PIC  X(26).                 02509400
025095     05  FILLER  REDEFINES PV-DB2-TIMESTAMP.                      02509500
025097         10  PV-DB2-TMST-YYYY         PIC  X(04).                 02509700
025098         10  FILLER                   PIC  X(01).                 02509800
025099         10  PV-DB2-TMST-MM           PIC  X(02).                 02509900
025100         10  FILLER                   PIC  X(01).                 02510000
025101         10  PV-DB2-TMST-DD           PIC  X(02).                 02510100
025102         10  FILLER                   PIC  X(01).                 02510200
025103         10  PV-DB2-TMST-HH           PIC  X(02).                 02510300
025104         10  FILLER                   PIC  X(01).                 02510400
025105         10  PV-DB2-TMST-MIN          PIC  X(02).                 02510500
025106         10  FILLER                   PIC  X(01).                 02510600
025107         10  PV-DB2-TMST-SEC          PIC  X(02).                 02510700
025108         10  FILLER                   PIC  X(01).                 02510800
025109         10  FILLER                   PIC  X(06).                 02510900
025110     05  PV-DB2-DATE                  PIC  X(10).                 02511015
025111     05  FILLER  REDEFINES PV-DB2-DATE.                           02511115
025112         10  PV-DB2-DATE-CC           PIC  X(02).                 02511215
025113         10  PV-DB2-DATE-YY           PIC  X(02).                 02511315
025114         10  FILLER                   PIC  X(01).                 02511415
025115         10  PV-DB2-DATE-MM           PIC  X(02).                 02511515
025116         10  FILLER                   PIC  X(01).                 02511615
025117         10  PV-DB2-DATE-DD           PIC  X(02).                 02511715
025118                                                                  02511800
025120                                                                  02512000
025200******************************************************************02520000
025300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02530000
025400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02540000
025500**  APPLICATION-SPECIFIC COMMAREA.                              **02550000
025600******************************************************************02560000
025700 01  LQW-LIST-QUEUE-WORK-AREA.                                    02570000
025800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02580000
025900     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           02590000
026000                                        INDEXED BY LQW-IDX.       02600000
026100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02610000
026200*                                                                 02620000
026300         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02630000
026400         10  LQW-SELECTED-SW            PIC  X(01).               02640000
026500             88  LQW-SELECT                         VALUE 'S'.    02650000
026600             88  LQW-DESELECT                       VALUE ' '.    02660000
026700             88  LQW-PRT                            VALUE 'P'.    02670000
026800         10  LQW-ACTION                 PIC  X(03).               02680000
026900         10  LQW-REQ-DATE               PIC  X(10).               02690000
027000         10  LQW-REQ-TIME               PIC  X(08).               02700000
      *CLP 09/24/2014 START                                             02701027
027100         10  LQW-USER-ID                PIC  X(07).               02710027
027200         10  LQW-PO-NBR                 PIC  9(08).               02720025
      *CLP 09/24/2014 END                                               02721027
027300         10  LQW-RECEIVER               PIC  9(03).               02730000
027400         10  LQW-OPER-UNT-ID            PIC  9(04).               02740000
027500         10  LQW-STORE                  PIC  9(04).               02750000
027600         10  LQW-PRCD-DATE              PIC  X(10).               02760000
027700         10  LQW-PRCD-TIME              PIC  X(08).               02770000
027800         10  LQW-REQ-TMST               PIC  X(26).               02780015
027900                                                                  02790000
028000                                                                  02800000
028100     EJECT                                                        02810000
028200*---------------------------------------------------------------* 02820000
028300*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 02830000
028400*---------------------------------------------------------------* 02840000
028500                                                                  02850000
028600     COPY SUWS022.                                                02860000
028700                                                                  02870000
029300/                                                                 02930000
029400*----------------------------------------------------------------*02940000
029500*  WORK AREA PASSED IN CALL TO DPKUT500                          *02950000
029600*----------------------------------------------------------------*02960000
029700     COPY DPWS500.                                                02970000
029800                                                                  02980000
029900*----------------------------------------------------------------*02990000
030000*    CURRENT DATE COPYBOOK.                                       03000000
030100*----------------------------------------------------------------*03010000
030200                                                                  03020000
030300     COPY DPWS017.                                                03030000
030400*----------------------------------------------------------------*03040000
030500*  SENDING/RECEIVING AREA FOR THE                                 03050000
030600*  PRINTER VALIDATION ROUTING (DPKCS060)                          03060000
030700*----------------------------------------------------------------*03070000
030800     COPY DPWS072.                                                03080000
030900                                                                  03090000
031000*---------------------------------------------------------------* 03100000
031100*    MAP LAYOUT                                                 * 03110000
031200*---------------------------------------------------------------* 03120000
031300                                                                  03130000
031400     COPY SUKM758.                                                03140000
031500*                                                                 03150000
031600 01  MR-OCCURS-LAYOUT                 REDEFINES  SUK758O.         03160000
031700     05  FILLER                       PIC X(154).                 03170000
031800     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          03180000
031900         10  MR-SELECTL               PIC S9(04) COMP.            03190000
032000         10  MR-SELECTA               PIC  X(01).                 03200000
032100         10  MR-SELECTC               PIC  X(01).                 03210000
032200         10  MR-SELECTH               PIC  X(01).                 03220000
032300         10  MR-SELECTI               PIC  X(01).                 03230000
032400                                                                  03240000
032500         10  MR-ACTIONL               PIC S9(04) COMP.            03250000
032600         10  MR-ACTIONA               PIC  X(01).                 03260000
032700         10  MR-ACTIONC               PIC  X(01).                 03270000
032800         10  MR-ACTIONH               PIC  X(01).                 03280000
032900         10  MR-ACTION                PIC  X(03).                 03290000
033000                                                                  03300000
033010         10  MR-REQ-DATE-L            PIC S9(04) COMP.            03301000
033020         10  MR-REQ-DATE-A            PIC  X(01).                 03302000
033030         10  MR-REQ-DATE-C            PIC  X(01).                 03303000
033040         10  MR-REQ-DATE-H            PIC  X(01).                 03304000
033050         10  MR-REQ-DATE              PIC  X(10).                 03305000
033060                                                                  03306000
033070         10  MR-REQ-TIME-L            PIC S9(04) COMP.            03307000
033080         10  MR-REQ-TIME-A            PIC  X(01).                 03308000
033090         10  MR-REQ-TIME-C            PIC  X(01).                 03309000
033091         10  MR-REQ-TIME-H            PIC  X(01).                 03309100
033092         10  MR-REQ-TIME              PIC  X(08).                 03309200
033093                                                                  03309300
033094         10  MR-USER-L                PIC S9(04) COMP.            03309400
033095         10  MR-USER-A                PIC  X(01).                 03309500
033096         10  MR-USER-C                PIC  X(01).                 03309600
033097         10  MR-USER-H                PIC  X(01).                 03309700
      *CLP 09/24/2014 START                                             03309827
033098         10  MR-USER                  PIC  X(07).                 03309926
033099                                                                  03310000
033110         10  MR-PO-L                  PIC S9(04) COMP.            03311000
033200         10  MR-PO-A                  PIC  X(01).                 03320000
033300         10  MR-PO-C                  PIC  X(01).                 03330000
033400         10  MR-PO-H                  PIC  X(01).                 03340000
      *CLP 09/24/2014 END                                               03341027
033500         10  MR-PO                    PIC  Z(08).                 03350025
033600                                                                  03360000
033700         10  MR-REC-L                 PIC S9(04) COMP.            03370000
033800         10  MR-REC-A                 PIC  X(01).                 03380000
033900         10  MR-REC-C                 PIC  X(01).                 03390000
034000         10  MR-REC-H                 PIC  X(01).                 03400000
034100         10  MR-REC                   PIC  Z(03).                 03410000
034200                                                                  03420000
034300         10  MR-OPER-L                PIC S9(04) COMP.            03430000
034400         10  MR-OPER-A                PIC  X(01).                 03440000
034500         10  MR-OPER-C                PIC  X(01).                 03450000
034600         10  MR-OPER-H                PIC  X(01).                 03460000
034700         10  MR-OPER                  PIC  Z(04).                 03470000
034800                                                                  03480000
034900         10  MR-STORE-L                PIC S9(04) COMP.           03490000
035000         10  MR-STORE-A                PIC  X(01).                03500000
035100         10  MR-STORE-C                PIC  X(01).                03510000
035200         10  MR-STORE-H                PIC  X(01).                03520000
035300         10  MR-STORE                  PIC  Z(04).                03530000
035400                                                                  03540000
036700         10  MR-PRCD-DATE-L           PIC S9(04) COMP.            03670000
036800         10  MR-PRCD-DATE-A           PIC  X(01).                 03680000
036900         10  MR-PRCD-DATE-C           PIC  X(01).                 03690000
037000         10  MR-PRCD-DATE-H           PIC  X(01).                 03700000
037100         10  MR-PRCD-DATE             PIC  X(10).                 03710000
037200                                                                  03720000
037210         10  MR-PRCD-TIME-L           PIC S9(04) COMP.            03721000
037220         10  MR-PRCD-TIME-A           PIC  X(01).                 03722000
037230         10  MR-PRCD-TIME-C           PIC  X(01).                 03723000
037240         10  MR-PRCD-TIME-H           PIC  X(01).                 03724000
037250         10  MR-PRCD-TIME             PIC  X(08).                 03725000
037260                                                                  03726000
038500     05  FILLER                         PIC  X(12).               03850000
038600                                                                  03860000
038700     EJECT                                                        03870000
038800/                                                                 03880000
038900*----------------------------------------------------------------*03890000
039000**  SECURITY SUBROUTINE PARAMETERS                                03900000
039100*----------------------------------------------------------------*03910000
039200     COPY DPWS008.                                                03920000
039300*---------------------------------------------------------------* 03930000
039400*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03940000
039500*---------------------------------------------------------------* 03950000
039600                                                                  03960000
039700     COPY DPWS015.                                                03970000
039800                                                                  03980000
039900*---------------------------------------------------------------* 03990000
040000*    NUMERIC EDIT LAYOUT.                                       * 04000000
040100*---------------------------------------------------------------* 04010000
040200                                                                  04020000
040300     COPY DPWS010I.                                               04030000
040400                                                                  04040000
040500*---------------------------------------------------------------* 04050000
040600*    FUNCTION KEYS COPYBOOK.                                    * 04060000
040700*---------------------------------------------------------------* 04070000
040800                                                                  04080000
040900     COPY DPWS016.                                                04090000
041000                                                                  04100000
041100*---------------------------------------------------------------* 04110000
041200*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04120033
041300*---------------------------------------------------------------* 04130000
041400                                                                  04140000
041500     COPY DPWS030.                                                04150000
041500     COPY DPWS930.                                                04151033
041600 EJECT                                                            04160000
041700*---------------------------------------------------------------* 04170000
041800*    STANDARD COMMAREA.                                         * 04180000
041900*---------------------------------------------------------------* 04190000
042000                                                                  04200000
042100     COPY DPWS020.                                                04210000
042200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04220000
042300                                                                  04230000
042400*---------------------------------------------------------------* 04240000
042500* INTER-APPLICATION COMMAREA.                                   * 04250000
042600*   SUWS040 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04260000
042700*             SPEC SCREEN.                                      * 04270000
042800*   SUWS021 - IS THE INPUT  LAYOUT THAT WILL BE PASSED TO THE   * 04280000
042900*             ADD/UPDATE SCREEN.                                * 04290000
043000*---------------------------------------------------------------* 04300000
043100                                                                  04310000
043200         10  INTER-APPL-COMM-AREA       PIC X(200).               04320000
043300     COPY SUWS040.                                                04330000
043500*---------------------------------------------------------------* 04350000
043600*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04360000
043700*---------------------------------------------------------------* 04370000
043800         10  ASC-SPECIFIC-COMMAREA.                               04380000
043900             15  ASC-LIST-KEYS.                                   04390000
044000                 20  ASC-AUDIT-RANK-KEY              PIC  X(06).  04400000
044100                 20  ASC-AUDIT-DESC-KEY              PIC  X(30).  04410000
044200             15  ASC-BLK-SUB                         PIC S9(04)   04420000
044300                                                          COMP    04430000
044400                                                          SYNC.   04440000
044500             15  ASC-ITEM-SUB                        PIC S9(04)   04450000
044600                                                          COMP    04460000
044700                                                          SYNC.   04470000
044800             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   04480000
044900                                                          COMP-3. 04490000
045000             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   04500000
045100                                                          COMP-3. 04510000
045200             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   04520000
045300                                                          COMP-3. 04530000
045400             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   04540000
045500                                                          COMP-3. 04550000
045600             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   04560000
045700                                                          COMP-3. 04570000
045800             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   04580000
045900                                                          COMP    04590000
046000                                                          SYNC.   04600000
046100             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   04610000
046200                                                          COMP-3. 04620000
046300             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   04630000
046400                                                          COMP-3. 04640000
046500             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  04650000
046600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   04660000
046700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   04670000
046800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  04680000
046900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04690000
047000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04700000
047100             15  ASC-LIST-QUEUE-NAME.                             04710000
047200                 20  ASC-LIST-TERM-ID                PIC  X(04).  04720000
047300                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   04730000
047400                                                          COMP-3. 04740000
047500                 20  ASC-LIST-SEQ                    PIC  9(01).  04750000
047600             15  ASC-SEL-QUEUE-NAME.                              04760000
047700                 20  ASC-SEL-TERM-ID          PIC  X(04).         04770000
047800                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04780000
047900                 20  ASC-SEL-SEQ              PIC  9(01).         04790000
048000             15  ASC-SEL-QUEUE-NAME-IN.                           04800000
048100                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         04810000
048200                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  04820000
048300                 20  ASC-SEL-SEQ-IN           PIC  9(01).         04830000
048400                                                                  04840000
048500             15  ASC-START-ITEM-REQUEST.                          04850000
048600                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  04860000
048700*                                                                 04870000
048800             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04880000
048900             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04890000
049000             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04900000
049100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04910000
049200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04920000
049300                                                                  04930000
049400                                                                  04940000
049500             15  ASC-FUNC01-RETURN-FLAG       PIC  X(1).          04950000
049600                 88  ASC-FUNC01-RETURN-NO   VALUE 'N'.            04960000
049700                 88  ASC-FUNC01-RETURN-YES  VALUE 'Y'.            04970000
049800                                                                  04980000
049900             15  ASC-FUNC02-RETURN-FLAG       PIC  X(1).          04990000
050000                 88  ASC-FUNC02-RETURN-NO   VALUE 'N'.            05000000
050100                 88  ASC-FUNC02-RETURN-YES  VALUE 'Y'.            05010000
050200                                                                  05020000
050300                                                                  05030000
050800             15  ASC-CONFIRM-DELETE-SW        PIC  X(01).         05080000
050900                 88  ASC-CONFIRM-DELETE          VALUE 'I'.       05090000
051000                 88  ASC-NO-CONFIRM-DELETE       VALUE 'N'.       05100000
051100                                                                  05110000
051200                                                                  05120000
051300             15  ASC-CURSOR-SW                       PIC  X(03).  05130000
051400                 88  ASC-USR-CSR                     VALUE 'USR'. 05140000
051500                 88  ASC-USR-DATE-CSR                VALUE 'U+D'. 05150000
051600                 88  ASC-DATE-CSR                    VALUE 'DTE'. 05160000
051700             15  ASC-LIST-KEYS.                                   05170000
052300                 20  ASC-KEY-OPER-UNT-ID                          05230000
052400                                      PIC S9(04) COMP.            05240000
052500                 20  ASC-KEY-FCLTY-ID                             05250000
052510                                      PIC S9(04) COMP.            05251000
052600                 20  ASC-KEY-FCLTY-NAME                           05260000
052610                                      PIC X(25).                  05261000
052700                 20  ASC-KEY-TK-ID                                05270000
052800                                      PIC X(08).                  05280000
053300                 20  ASC-KEY-REQ-FROM-DATE   PIC X(10).           05330000
053310                 20  ASC-KEY-REQ-FROM-DATE-X                      05331000
053311                       REDEFINES ASC-KEY-REQ-FROM-DATE.           05331100
053320                     30  ASC-FROM-YYYY       PIC X(04).           05332000
053321                     30  FILLER              PIC X(01).           05332100
053330                     30  ASC-FROM-MM         PIC X(02).           05333000
053331                     30  FILLER              PIC X(01).           05333100
053340                     30  ASC-FROM-DD         PIC X(02).           05334000
053350                                                                  05335000
053500                 20  ASC-KEY-REQ-TO-DATE     PIC X(10).           05350000
053501                 20  ASC-KEY-REQ-TO-DATE-X                        05350100
053502                       REDEFINES ASC-KEY-REQ-TO-DATE.             05350200
053510                     30  ASC-TO-YYYY         PIC X(04).           05351000
053520                     30  FILLER              PIC X(01).           05352000
053530                     30  ASC-TO-MM           PIC X(02).           05353000
053540                     30  FILLER              PIC X(01).           05354000
053550                     30  ASC-TO-DD           PIC X(02).           05355000
053700                                                                  05370000
053800             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05380000
053900                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05390000
054000                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05400000
054100                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05410000
054200                                                                  05420000
054300                 20  ASC-ITEM-ARRAY.                              05430000
054400                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        05440000
054500                         30  ASC-LIST-ITEM-NUMBER                 05450000
054600                                                     PIC S9(09)   05460000
054700                                                     COMP-3.      05470000
054800                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  05480000
054900                             88  ASC-VALID-SELECT    VALUE ' '    05490000
055000                                                           'S'    05500000
055100                                                           'B'    05510000
055200                                                           'E'.   05520000
055300                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05530000
055400                             88  ASC-TEMP-SELECT     VALUE 'S'.   05540000
055500                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05550000
055600                             88  ASC-TEMP-END        VALUE 'E'.   05560000
055700                         30  ASC-SELECTED-SW         PIC  X(01).  05570000
055800                             88  ASC-NO-SELECT       VALUE ' '.   05580000
055900                             88  ASC-SELECT          VALUE 'S'.   05590000
056000                             88  ASC-BEGIN           VALUE 'B'.   05600000
056100                             88  ASC-END             VALUE 'E'.   05610000
056200                         30  ASC-ACTION              PIC  X(03).  05620000
056210                         30  ASC-REQ-DATE            PIC  X(10).  05621000
056220                         30  ASC-REQ-TIME            PIC  X(08).  05622000
      *CLP 09/24/2014 START                                             05622128
056230                         30  ASC-USER-ID             PIC  X(07).  05623028
056300                         30  ASC-PO-NBR              PIC  9(08).  05630028
      *CLP 09/24/2014 END                                               05631028
056400                         30  ASC-RECEIVER            PIC  9(03).  05640000
056600                         30  ASC-OPER-UNT-ID         PIC  9(04).  05660000
056700                         30  ASC-STORE               PIC  9(04).  05670000
056800                         30  ASC-PRCD-DATE           PIC  X(10).  05680000
056900                         30  ASC-PRCD-TIME           PIC  X(08).  05690000
057000                         30  ASC-REQ-TMST            PIC  X(26).  05700015
057300                                                                  05730000
057400     EJECT                                                        05740000
057500*---------------------------------------------------------------* 05750000
057600*    ABEND PROCESSING COPYBOOK.                                 * 05760000
057700*---------------------------------------------------------------* 05770000
057800                                                                  05780000
057900     COPY DPWS013.                                                05790000
058000                                                                  05800000
058100 EJECT                                                            05810000
058200*----------------------------------------------------------------*05820000
058300*    DB2 DCLGEN FOR THE PO AUDIT REQUEST TABLE                    05830000
058400*----------------------------------------------------------------*05840000
058500     EXEC SQL                                                     05850000
058600          INCLUDE SUT00029                                        05860000
058700     END-EXEC.                                                    05870000
058800                                                                  05880000
058900     EXEC SQL                                                     05890000
059000          INCLUDE TPLNSHP                                         05900000
059100     END-EXEC.                                                    05910000
059200*---------------------------------------------------------------* 05920000
059300*    DB2 AREA FOR COMMUNICATIONS                                * 05930000
059400*---------------------------------------------------------------* 05940000
059500     EXEC SQL                                                     05950000
059600          INCLUDE SQLCA                                           05960000
059700     END-EXEC.                                                    05970000
059800                                                                  05980000
059900******************************************************************05990000
060000*  CURSOR TO BUILD THE AUDIT REQUEST LIST IF TK USER ID AND DATE  06000000
060010*    RANGE IS ENTERED ON CRIT SPEC.                               06001000
060100******************************************************************06010000
060200                                                                  06020000
060300     EXEC SQL                                                     06030000
060400          DECLARE USR-DATE-CSR CURSOR FOR                         06040000
060500          SELECT A.USR_ID                                         06050000
060600               , A.RPT_REQ_TMST                                   06060000
060700               , A.PO_NBR                                         06070000
060800               , A.REC_SEQ_NBR                                    06080000
060900               , A.ORGN_LOC_NBR                                   06090000
061000               , A.DEST_LOC_NBR                                   06100000
061100               , A.RPT_CRE_TMST                                   06110000
061500          FROM   SUT_RPT_REQ A                                    06150000
062000          WHERE  A.USR_ID     =  :ASC-KEY-TK-ID                   06200019
062300            AND  DATE(A.RPT_REQ_TMST)  BETWEEN                    06230000
062400                 :ASC-KEY-REQ-FROM-DATE  AND                      06240000
062500                 :ASC-KEY-REQ-TO-DATE                             06250000
063200                                                                  06320000
063201          ORDER BY A.RPT_CRE_TMST DESC                            06320122
063202                 , A.RPT_REQ_TMST DESC                            06320222
063210                                                                  06321021
063300     END-EXEC.                                                    06330000
063400                                                                  06340000
063510******************************************************************06351000
063520*  CURSOR TO BUILD THE AUDIT REQUEST LIST IF TK USER ID AND NO    06352000
063530*    DATE RANGE IS ENTERED ON CRIT SPEC.                          06353000
063540******************************************************************06354000
063550                                                                  06355000
063560     EXEC SQL                                                     06356000
063570          DECLARE USR-CSR  CURSOR FOR                             06357000
063580          SELECT A.USR_ID                                         06358000
063590               , A.RPT_REQ_TMST                                   06359000
063591               , A.PO_NBR                                         06359100
063592               , A.REC_SEQ_NBR                                    06359200
063593               , A.ORGN_LOC_NBR                                   06359300
063594               , A.DEST_LOC_NBR                                   06359400
063595               , A.RPT_CRE_TMST                                   06359500
063596          FROM   SUT_RPT_REQ A                                    06359600
063597          WHERE  A.USR_ID     =  :ASC-KEY-TK-ID                   06359719
063601                                                                  06360100
063602          ORDER BY A.RPT_CRE_TMST DESC                            06360221
063603                 , A.RPT_REQ_TMST DESC                            06360322
063604                                                                  06360421
063605     END-EXEC.                                                    06360500
063606                                                                  06360600
063607******************************************************************06360700
063608*  CURSOR TO BUILD THE AUDIT REQUEST LIST IF ONLY A DATE          06360800
063609*    RANGE IS ENTERED ON CRIT SPEC.                               06360900
063610******************************************************************06361000
063611                                                                  06361100
063612     EXEC SQL                                                     06361216
063613          DECLARE DATE-CSR CURSOR FOR                             06361300
063614          SELECT A.USR_ID                                         06361400
063615               , A.RPT_REQ_TMST                                   06361500
063616               , A.PO_NBR                                         06361600
063617               , A.REC_SEQ_NBR                                    06361700
063618               , A.ORGN_LOC_NBR                                   06361800
063619               , A.DEST_LOC_NBR                                   06361900
063620               , A.RPT_CRE_TMST                                   06362000
063621          FROM   SUT_RPT_REQ A                                    06362100
063622          WHERE  DATE(A.RPT_REQ_TMST)  BETWEEN                    06362200
063623                 :ASC-KEY-REQ-FROM-DATE  AND                      06362300
063624                 :ASC-KEY-REQ-TO-DATE                             06362400
063625                                                                  06362500
063626          ORDER BY A.RPT_CRE_TMST DESC                            06362623
063627                 , A.RPT_REQ_TMST DESC                            06362722
063628                                                                  06362821
063629     END-EXEC.                                                    06362900
063630                                                                  06363000
071600*---------------------------------------------------------------* 07160000
071800                                                                  07180000
071900 EJECT                                                            07190000
072000 LINKAGE SECTION.                                                 07200000
072100                                                                  07210000
072200 01  DFHCOMMAREA.                                                 07220000
072300     05  FILLER                         OCCURS  1 TO 4072 TIMES   07230000
072400                                        DEPENDING ON EIBCALEN.    07240000
072500         10  FILLER                     PIC X.                    07250000
072600                                                                  07260000
072700 EJECT                                                            07270000
072800 PROCEDURE DIVISION.                                              07280000
072900******************************************************************07290000
073000**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07300000
073100**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07310000
073200**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07320000
073300******************************************************************07330000
073400 0000-MAIN-MODULE.                                                07340000
073500     INITIALIZE DP030-CICS-API-FIELDS.                            07350000
073600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07360000
073700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07370000
073800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07380000
073900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07390000
074000     MOVE LENGTH OF SUK758I        TO DP030-MAP-LENGTH (1).       07400000
074100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07410000
074200     PERFORM 0001-CALL-CICS-ARCH-API.                             07420000
074300                                                                  07430000
074400     PERFORM 1000-CONTROL-PROCESSING                              07440000
074500                                                                  07450000
074600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07460000
074700     PERFORM 0001-CALL-CICS-ARCH-API.                             07470000
074800                                                                  07480000
074900******************************************************************07490000
075000**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07500000
075100**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07510000
075200******************************************************************07520000
075300 0001-CALL-CICS-ARCH-API.                                         07530000
075400*    CALL 'DPKCS030' USING DFHEIBLK                               07540033
075400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07541033
075500                           DFHCOMMAREA                            07550000
075600                           DP030-CICS-API-FIELDS                  07560000
075700                           DP020-STANDARD-COMMAREA                07570000
075800                           SUK758I.                               07580000
075900                                                                  07590000
076000     IF  DP030-RC-CALL-SUCCESSFUL                                 07600000
076100         CONTINUE                                                 07610000
076200     ELSE                                                         07620000
076300         SET DP013-NO-ROLLBACK                                    07630000
076400             DP013-XCTL-DISPLAY-RESTART                           07640000
076500             DP013-CICS-ABEND      TO TRUE                        07650000
076600         MOVE '0001-CALL-CICS-ARCH-API'                           07660000
076700                                   TO DP013-PARAGRAPH             07670000
076800*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07680033
076900*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07690033
076800         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07691033
076900-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07692033
077000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07700000
077100         PERFORM DP013-0000-PROCESS-ABEND                         07710000
077200     END-IF.                                                      07720000
077300*----------------------------------------------------------------*07730000
077400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07740000
077500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07750000
077600*                                                                *07760000
077700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07770000
077800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07780000
077900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07790000
078000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07800000
078100*----------------------------------------------------------------*07810000
078200                                                                  07820000
078300 1000-CONTROL-PROCESSING.                                         07830000
078400                                                                  07840000
078500     EVALUATE TRUE                                                07850000
078600         WHEN DP020-NEXT-ACT-INITIAL                              07860000
078700             INITIALIZE ASC-SPECIFIC-COMMAREA                     07870000
078800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07880000
078900                                      ASC-SEL-TERM-ID             07890000
079000             MOVE DP020-SRC-TASK-NUMBER                           07900000
079100                                   TO ASC-LIST-TASK-NUMBER        07910000
079200                                      ASC-SEL-TASK-NUMBER         07920000
079300             MOVE PC-LIST-QUEUE-SEQ                               07930000
079400                                   TO ASC-LIST-SEQ                07940000
079500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 07950000
079600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07960000
079700***-----$TEMPLATE NOTE$-------------------------------------------07970000
079800*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,07980000
079900*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  07990000
080000*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.08000000
080100***---------------------------------------------------------------08010000
080200             PERFORM 4000-BUILD-INITIAL-PANEL                     08020000
080300                                                                  08030000
080400         WHEN DP020-NEXT-ACT-READ-MAP                             08040000
080500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        08050000
080600                                   TO PV-TOP-ITEM                 08060000
080700             PERFORM 2000-PROCESS-PANEL                           08070000
080800                                                                  08080000
080900         WHEN DP020-NEXT-ACT-RETURN                               08090000
081000            IF ASC-FUNC02-RETURN-YES                              08100000
081100               MOVE ASC-ITEM-AT-TOP-OF-PANEL                      08110000
081200                                     TO PV-TOP-ITEM               08120000
081300               MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL  08130000
081400               PERFORM 6000-REFRESH-PANEL-FROM-TEMP               08140000
081500               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               08150000
081600            ELSE                                                  08160000
081700               PERFORM 2050-DELETE-LIST-QUEUE                     08170000
081800               PERFORM 4000-BUILD-INITIAL-PANEL                   08180000
081900            END-IF                                                08190000
082000         WHEN OTHER                                               08200000
082100             SET DP013-LOGIC-ABEND TO TRUE                        08210000
082200             SET DP013-NO-ROLLBACK TO TRUE                        08220000
082300             MOVE '1000-CONTROL-PROCESSING'                       08230000
082400                                   TO DP013-PARAGRAPH             08240000
082500             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08250000
082600                                   TO DP013-MESSAGE-TEXT(1)       08260000
082700             PERFORM DP013-0000-PROCESS-ABEND                     08270000
082800     END-EVALUATE.                                                08280000
082900                                                                  08290000
083000 EJECT                                                            08300000
083100*----------------------------------------------------------------*08310000
083200* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08320000
083300* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08330000
083400*----------------------------------------------------------------*08340000
083500                                                                  08350000
083600 1100-PROCESS-INTER-APPL-COMM.                                    08360000
083700                                                                  08370000
083800     SET PS-COMMAREA-VALID          TO TRUE.                      08380000
083900     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    08390000
084000                                                                  08400000
084100     EVALUATE DP020-INT-APPL-FORMAT-IND                           08410000
084200     WHEN '1'                                                     08420000
084900     MOVE SU040-OPER-UNT-ID           TO DK-OPER-UNT-ID           08490000
085000                                         ASC-KEY-OPER-UNT-ID      08500000
085100     MOVE SU040-USR-ID                TO DK-TK-ID                 08510020
085200                                         ASC-KEY-TK-ID            08520020
085202                                                                  08520217
085210     MOVE SU040-FCLTY-ID              TO DK-FCLTY-ID              08521000
085220                                         ASC-KEY-FCLTY-ID         08522000
085230     MOVE SU040-FCLTY-NME             TO DK-FCLTY-NAME            08523000
085240                                         ASC-KEY-FCLTY-NAME       08524000
085300                                                                  08530000
085301     MOVE SU040-REQ-FROM-DATE         TO PV-FROM-DATE             08530100
085310     STRING                                                       08531000
085320            PV-FROM-YYYY                                          08532000
085330            '-'                                                   08533000
085340            PV-FROM-MM                                            08534000
085350            '-'                                                   08535000
085360            PV-FROM-DD                                            08536000
085370             DELIMITED BY SIZE      INTO DK-SHIP-FROM-DATE        08537000
085410     MOVE DK-SHIP-FROM-DATE           TO ASC-KEY-REQ-FROM-DATE    08541000
085500                                                                  08550000
085502     MOVE SU040-REQ-TO-DATE           TO PV-TO-DATE               08550200
085510     STRING                                                       08551000
085520            PV-TO-YYYY                                            08552000
085530            '-'                                                   08553000
085540            PV-TO-MM                                              08554000
085550            '-'                                                   08555000
085560            PV-TO-DD                                              08556000
085570             DELIMITED BY SIZE      INTO DK-SHIP-TO-DATE          08557000
085610     MOVE DK-SHIP-TO-DATE             TO ASC-KEY-REQ-TO-DATE      08561000
085710                                                                  08571000
087400     END-EVALUATE.                                                08740000
087500                                                                  08750000
087600                                                                  08760000
087700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08770000
087800*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08780000
087900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08790000
088000 1130-GET-NEXT-RECORD.                                            08800000
088100                                                                  08810000
088200     ADD +1                       TO ASC-SEL-SUB.                 08820000
088300                                                                  08830000
088400     IF  ASC-SEL-SUB > SU022-MAX-ITEMS                            08840000
088500         ADD +1                   TO ASC-SEL-ITEM                 08850000
088600         MOVE +1                  TO ASC-SEL-SUB                  08860000
088700     END-IF.                                                      08870000
088800                                                                  08880000
088900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08890000
089000         PERFORM 9100-READ-SEL-QUEUE                              08900000
089100         IF  SU022-ITEM (ASC-SEL-SUB) > ZERO                      08910000
089200                                                                  08920000
089300             SET SU022-INQ (ASC-SEL-SUB)                          08930000
089400                                  TO TRUE                         08940000
089500             PERFORM 9200-REWRITE-SEL-QUEUE                       08950000
089600         ELSE                                                     08960000
089700             SUBTRACT +1 FROM ASC-SEL-SUB                         08970000
089800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08980000
089900             SET DP020-MSG-INFORMATIONAL                          08990000
090000                 PS-LIST-END             TO TRUE                  09000000
090100         END-IF                                                   09010000
090200     ELSE                                                         09020000
090300         SUBTRACT +1 FROM ASC-SEL-ITEM                            09030000
090400         MOVE SU022-MAX-ITEMS     TO ASC-SEL-SUB                  09040000
090500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09050000
090600             SET DP020-MSG-INFORMATIONAL                          09060000
090700                 PS-LIST-END             TO TRUE                  09070000
090800     END-IF.                                                      09080000
090900                                                                  09090000
091000/                                                                 09100000
091100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09110000
091200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09120000
091300*    PROCESSED.                                                  *09130000
091400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09140000
091500                                                                  09150000
091600 1140-GET-PREV-RECORD.                                            09160000
091700                                                                  09170000
091800     SUBTRACT +1 FROM ASC-SEL-SUB.                                09180000
091900                                                                  09190000
092000     IF  ASC-SEL-SUB < +1                                         09200000
092100         SUBTRACT +1 FROM ASC-SEL-ITEM                            09210000
092200         MOVE SU022-MAX-ITEMS     TO ASC-SEL-SUB                  09220000
092300     END-IF.                                                      09230000
092400                                                                  09240000
092500     IF  ASC-SEL-ITEM > ZERO                                      09250000
092600         PERFORM 9100-READ-SEL-QUEUE                              09260000
092700         SET SU022-INQ (ASC-SEL-SUB)                              09270000
092800                                  TO TRUE                         09280000
092900         PERFORM 9200-REWRITE-SEL-QUEUE                           09290000
093000     ELSE                                                         09300000
093100         MOVE +1                  TO ASC-SEL-ITEM                 09310000
093200                                     ASC-SEL-SUB                  09320000
093300         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09330000
093400             SET DP020-MSG-INFORMATIONAL                          09340000
093500                 PS-LIST-END             TO TRUE                  09350000
093600     END-IF.                                                      09360000
093700                                                                  09370000
093800                                                                  09380000
093900                                                                  09390000
094000*----------------------------------------------------------------*09400000
094100* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09410000
094200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09420000
094300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09430000
094400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09440000
094500* FUNCTION KEYS CAN GET THIS FAR.                                *09450000
094600*----------------------------------------------------------------*09460000
094700                                                                  09470000
094800 2000-PROCESS-PANEL.                                              09480000
094900     EVALUATE TRUE                                                09490000
095000         WHEN DP020-SRC-AID = DP016-CLEAR                         09500000
095100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09510000
095200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09520000
095300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09530000
095400                                                                  09540000
095500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09550000
095600             SET ASC-NO-CONFIRM-DELETE TO TRUE                    09560000
095700             PERFORM 2050-DELETE-LIST-QUEUE                       09570000
095800             PERFORM 4000-BUILD-INITIAL-PANEL                     09580000
095900                                                                  09590000
096000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09600000
096100             PERFORM 2140-DESELECT-ALL-ITEMS                      09610000
096200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09620000
096300                                                                  09630000
096400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09640000
096500             PERFORM 2150-SELECT-ALL-ITEMS                        09650000
096600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09660000
096700                                                                  09670000
096800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09680000
096900           IF  ASC-USE-SELECTION-QUEUE                            09690000
097000               PERFORM 1130-GET-NEXT-RECORD                       09700000
097100               IF PS-LIST-END                                     09710000
097200                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           09720000
097300                   SET PS-NO-LIST-END TO TRUE                     09730000
097400               ELSE                                               09740000
097500                   PERFORM 2050-DELETE-LIST-QUEUE                 09750000
097600                   PERFORM 3200-RESET-ATTRIBUTES                  09760000
097700                   PERFORM 4000-BUILD-INITIAL-PANEL               09770000
097800               END-IF                                             09780000
097900            ELSE                                                  09790000
098000               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               09800000
098100*              --- BOTTOM OF LIST ---                             09810000
098200               MOVE PC-TSYMSG-00070                               09820000
098300                                 TO DP020-MSG-NUMBER              09830000
098400               SET DP020-MSG-INFORMATIONAL                        09840000
098500                                 TO TRUE                          09850000
098600           END-IF                                                 09860000
098700                                                                  09870000
098800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09880000
098900           IF  ASC-USE-SELECTION-QUEUE                            09890000
099000               PERFORM 1140-GET-PREV-RECORD                       09900000
099100               IF PS-LIST-END                                     09910000
099200                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           09920000
099300                   SET PS-NO-LIST-END                             09930000
099400                                 TO TRUE                          09940000
099500               ELSE                                               09950000
099600                   PERFORM 2050-DELETE-LIST-QUEUE                 09960000
099700                   PERFORM 3200-RESET-ATTRIBUTES                  09970000
099800                   PERFORM 4000-BUILD-INITIAL-PANEL               09980000
099900               END-IF                                             09990000
100000           ELSE                                                   10000000
100100               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               10010000
100200               MOVE PC-TSYMSG-00069                               10020000
100300                                 TO DP020-MSG-NUMBER              10030000
100400               SET DP020-MSG-INFORMATIONAL                        10040000
100500                                 TO TRUE                          10050000
100600           END-IF                                                 10060000
100700                                                                  10070000
100800         WHEN OTHER                                               10080000
100900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10090000
101000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10100000
101100             IF  PS-NO-ERROR                                      10110000
101200                 SET DP030-CONTINUE-GO                            10120000
101300                                 TO TRUE                          10130000
101400                 PERFORM 2100-CHECK-FUNCTION-KEY                  10140000
101500             ELSE                                                 10150000
101600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10160000
101700                 SET DP030-OVERRIDE-GO                            10170000
101800                                 TO TRUE                          10180000
101900             END-IF                                               10190000
102000     END-EVALUATE.                                                10200000
102100 EJECT                                                            10210000
102200*----------------------------------------------------------------*10220000
102300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10230000
102400*----------------------------------------------------------------*10240000
102500 2050-DELETE-LIST-QUEUE.                                          10250000
102600                                                                  10260000
102700     EXEC CICS                                                    10270000
102800         DELETEQ TS                                               10280000
102900             QUEUE (ASC-LIST-QUEUE-NAME)                          10290000
103000             RESP  (PV-CICS-RESP)                                 10300000
103100     END-EXEC.                                                    10310000
103200                                                                  10320000
103300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10330000
103400        (PV-CICS-RESP = DFHRESP(QIDERR))                          10340000
103500         CONTINUE                                                 10350000
103600     ELSE                                                         10360000
103700         SET DP013-CICS-ABEND      TO TRUE                        10370000
103800         SET DP013-NO-ROLLBACK     TO TRUE                        10380000
103900                                                                  10390000
104000         MOVE '2050-DELETE-LIST-QUEUE'                            10400000
104100                                   TO DP013-PARAGRAPH             10410000
104200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10420000
104300                                   TO DP013-MESSAGE-TEXT (1)      10430000
104400         PERFORM DP013-0000-PROCESS-ABEND                         10440000
104500     END-IF.                                                      10450000
104600                                                                  10460000
104700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10470000
104800 EJECT                                                            10480000
104900*----------------------------------------------------------------*10490000
105000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10500000
105100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10510000
105200* CICS ARCHITECTURE API.                                         *10520000
105300*----------------------------------------------------------------*10530000
105400***********************************                               10540000
105500* F13 - CTNRCLST    (LOCAL-FUNC-01)                               10550000
105600***********************************                               10560000
105700                                                                  10570000
105800 2100-CHECK-FUNCTION-KEY.                                         10580000
105900*    SET SU021-UPDATE-TSQ TO TRUE.                                10590000
106000     EVALUATE TRUE                                                10600000
108800*F16=DEL RANK                                                     10880000
108900*F2=CONFIRM                                                       10890000
109000         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    10900000
109100              IF ASC-CONFIRM-DELETE                               10910000
109200                 PERFORM 4600-PROCESS-DELETE-FUNCTION             10920000
109300                     VARYING PV-ITEM  FROM 1 BY 1                 10930000
109400                     UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN    10940000
109500                     OR PS-ERROR                                  10950000
109600                   IF PS-NO-ERROR                                 10960000
109700                      PERFORM 2050-DELETE-LIST-QUEUE              10970000
109800                      PERFORM 4000-BUILD-INITIAL-PANEL            10980000
109900                      SET DP020-MSG-INFORMATIONAL  TO  TRUE       10990000
110000                        MOVE PC-TSYMSG-00115  TO DP020-MSG-NUMBER 11000000
110100                   ELSE                                           11010000
110200                        MOVE PC-TSYMSG-02848 TO DP020-MSG-NUMBER  11020000
110300                                                                  11030000
110400                        SET DP030-OVERRIDE-GO TO TRUE             11040000
110500                                                                  11050000
110600                        SET DP020-MSG-WARNING TO TRUE             11060000
110700                   END-IF                                         11070000
110800                   SET ASC-NO-CONFIRM-DELETE  TO TRUE             11080000
110900                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           11090000
111000              ELSE                                                11100000
111100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11110000
111200                 SET ASC-NO-CONFIRM-DELETE  TO TRUE               11120000
111300                 SET DP030-OVERRIDE-GO                            11130000
111400                                   TO TRUE                        11140000
111500                 MOVE PC-TSYMSG-00045                             11150000
111600                                   TO DP020-MSG-NUMBER            11160000
111700                 SET DP020-MSG-WARNING                            11170000
111800                                   TO TRUE                        11180000
111900              END-IF                                              11190000
112000                                                                  11200000
112100*                                                                 11210000
112200* F6 - FIRST PAGE                                                 11220000
112300*                                                                 11230000
112400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11240000
112500             MOVE +1               TO PV-TOP-ITEM                 11250000
112600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11260000
112700*                                                                 11270000
112800* F7 - PREVIOUS PAGE                                              11280000
112900*                                                                 11290000
113000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11300000
113100             PERFORM 2110-BROWSE-BACKWARD                         11310000
113200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11320000
113300*                                                                 11330000
113400* F8 - NEXT PAGE                                                  11340000
113500*                                                                 11350000
113600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11360000
113700             PERFORM 2120-BROWSE-FORWARD                          11370000
113800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11380000
113900*                                                                 11390000
114000* ENTER KEY                                                       11400000
114100*                                                                 11410000
114200         WHEN DP020-SRC-AID = DP016-ENTER                         11420000
114300             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11430000
114400             IF  PS-ERROR                                         11440000
114500                 CONTINUE                                         11450000
114600             ELSE                                                 11460000
114700*                PERFORM 3200-RESET-ATTRIBUTES                    11470000
114800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11480000
114900             END-IF                                               11490000
115000                                                                  11500000
115100         WHEN OTHER                                               11510000
115200             SET DP013-NO-ROLLBACK                                11520000
115300                 DP013-XCTL-DISPLAY-RESTART                       11530000
115400                 DP013-CICS-ABEND  TO TRUE                        11540000
115500             MOVE '2100-CHECK-FUNCTION-KEY'                       11550000
115600                                   TO DP013-PARAGRAPH             11560000
115700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11570000
115800                                   TO DP013-MESSAGE-TEXT (1)      11580000
115900             PERFORM DP013-0000-PROCESS-ABEND                     11590000
116000     END-EVALUATE.                                                11600000
116100*                                                                 11610000
116200*LMM                                                              11620000
116300*----------------------------------------------------------------*11630000
116400* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR FUNTION        *11640000
116500*----------------------------------------------------------------*11650000
116600 2105-RACF-ACCESS.                                                11660000
116700                                                                  11670000
116800      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  11680000
116900      SET DP008-ACCESS-TYPE-USE          TO TRUE                  11690000
117000                                                                  11700000
117100      EXEC CICS                                                   11710000
117200         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 11720000
117300              COMMAREA (DP008-SECURITY-COMMAREA)                  11730000
117400              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             11740000
117500      END-EXEC                                                    11750000
117600                                                                  11760000
117700      IF DP008-CALL-SUCCESSFUL                                    11770000
117800         IF DP008-ACCESS-ALLOWED                                  11780000
117900             SET PS-ACCESS-ALLOWED TO TRUE                        11790000
118000         ELSE                                                     11800000
118100             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    11810000
118200         END-IF                                                   11820000
118300     ELSE                                                         11830000
118400         MOVE '2105-RACF-ACCESS'                                  11840000
118500                               TO DP013-PARAGRAPH                 11850000
118600          MOVE 'UNABLE TO ACCESS CICS'                            11860000
118700                               TO DP013-MESSAGE-TEXT (1)          11870000
118800          MOVE SQLCA                 TO DP013-SQLCA               11880000
118900          SET DP013-DB2-ABEND                                     11890000
119000              DP013-XCTL-DISPLAY-RESTART                          11900000
119100                               TO TRUE                            11910000
119200          PERFORM DP013-0000-PROCESS-ABEND                        11920000
119300      END-IF.                                                     11930000
119400/                                                                 11940012
119510*----------------------------------------------------------------*11951012
119520* CHECK TO SEE IF USER LOGON TK MATCHES THE TK RETURNED FROM THE *11952012
119521* CURSOR FOR THE LINE SELECTED TO BE DELETED. THE ASSOCIATE IS   *11952112
119522* ONLY ALLOWED TO DELETE THE REQUESTS THAT THEY CREATED.         *11952212
119530*----------------------------------------------------------------*11953012
119540 2106-CHECK-DELETE.                                               11954012
119550                                                                  11955012
119560     IF DP020-USERID  = ASC-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB)    11956017
119562        AND ASC-PRCD-DATE (ASC-BLK-SUB ASC-ITEM-SUB)              11956213
119563                                               = 'REQUEST IN'     11956313
119570        SET PS-DELETE-YES      TO TRUE                            11957012
119571     ELSE                                                         11957112
119572        SET PS-DELETE-NO       TO TRUE.                           11957212
119580                                                                  11958012
119600*----------------------------------------------------------------*11960000
119700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11970000
119800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11980000
119900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11990000
120000*    MESSAGE.                                                    *12000000
120100*----------------------------------------------------------------*12010000
120200                                                                  12020000
120300 2110-BROWSE-BACKWARD.                                            12030000
120400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12040000
120500         GIVING PV-TOP-ITEM.                                      12050000
120600                                                                  12060000
120700     IF  ((PV-TOP-ITEM < +1)                                      12070000
120800       OR (PV-TOP-ITEM = +1))                                     12080000
120900         MOVE +1                   TO PV-TOP-ITEM                 12090000
121000*        -- TOP OF LIST --                                        12100000
121100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12110000
121200         SET DP020-MSG-INFORMATIONAL TO TRUE                      12120000
121300     END-IF.                                                      12130000
121400                                                                  12140000
121500 EJECT                                                            12150000
121600*----------------------------------------------------------------*12160000
121700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12170000
121800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12180000
121900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12190000
122000*----------------------------------------------------------------*12200000
122100                                                                  12210000
122200 2120-BROWSE-FORWARD.                                             12220000
122300                                                                  12230000
122400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12240000
122500         GIVING PV-TOP-ITEM.                                      12250000
122600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12260000
122700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12270000
122800                                   TO PV-TOP-ITEM                 12280000
122900*        -- BOTTOM OF LIST --                                     12290000
123000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12300000
123100         SET DP020-MSG-INFORMATIONAL                              12310000
123200                                   TO TRUE                        12320000
123300     ELSE                                                         12330000
123400         COMPUTE PV-BOTTOM-ITEM =                                 12340000
123500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12350000
123600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12360000
123700*            -- BOTTOM OF LIST --                                 12370000
123800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12380000
123900             SET DP020-MSG-INFORMATIONAL                          12390000
124000                                   TO TRUE                        12400000
124100         END-IF                                                   12410000
124200     END-IF.                                                      12420000
124300 EJECT                                                            12430000
124400*----------------------------------------------------------------*12440000
124500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12450000
124600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12460000
124700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12470000
124800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12480000
124900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12490000
125000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12500000
125100*----------------------------------------------------------------*12510000
125200                                                                  12520000
125300 2130-CHECK-FOR-JUMP-BROWSE.                                      12530000
125400     SET PS-NO-ERROR               TO TRUE.                       12540000
125500     IF (ASC-START-ITEM-REQUEST = SPACE)                          12550000
125600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12560000
125700                                   TO PV-TOP-ITEM                 12570000
125800     ELSE                                                         12580000
125900         MOVE ASC-START-ITEM-REQUEST                              12590000
126000                                   TO DP010I-UNEDITED-FIELD       12600000
126100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12610000
126200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12620000
126300         SET DP010I-NEGATIVE-NOT-ALLOWED                          12630000
126400                                   TO TRUE                        12640000
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12660032
273427              USING DP010I-NUMERIC-EDIT-AREA                      12661032
126600                                                                  12662030
126700         IF  NOT DP010I-ERROR-DETECTED                            12670000
126800             MOVE DP010I-NUMERIC-FIELD                            12680000
126900                                   TO  ASC-START-ITEM-REQUEST-N   12690000
127000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12700000
127100                 IF  ASC-START-ITEM-REQUEST-N >                   12710000
127200                                          ASC-NUMBER-OF-ITEMS-READ12720000
127300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12730000
127400                     COMPUTE PV-TOP-ITEM =                        12740000
127500                             ASC-NUMBER-OF-ITEMS-READ             12750000
127600                             - PC-ITEMS-PER-PANEL + 1             12760000
127700                     IF  PV-TOP-ITEM < +1                         12770000
127800                         MOVE +1   TO PV-TOP-ITEM                 12780000
127900                         MOVE PC-TSYMSG-00070                     12790000
128000                                   TO DP020-MSG-NUMBER            12800000
128100                         SET DP020-MSG-INFORMATIONAL              12810000
128200                                   TO TRUE                        12820000
128300                     END-IF                                       12830000
128400                 ELSE                                             12840000
128500                     MOVE ASC-START-ITEM-REQUEST-N                12850000
128600                                   TO PV-TOP-ITEM                 12860000
128700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12870000
128800                     COMPUTE PV-BOTTOM-ITEM =                     12880000
128900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12890000
129000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12900000
129100*                        -- BOTTOM OF LIST --                     12910000
129200                         MOVE PC-TSYMSG-00070                     12920000
129300                                   TO DP020-MSG-NUMBER            12930000
129400                         SET DP020-MSG-INFORMATIONAL              12940000
129500                                   TO TRUE                        12950000
129600                     END-IF                                       12960000
129700                 END-IF                                           12970000
129800             ELSE                                                 12980000
129900*                --- VALUE OUT OF RANGE ----                      12990000
130000                 MOVE PC-TSYMSG-00101                             13000000
130100                                   TO DP020-MSG-NUMBER            13010000
130200                 MOVE -1           TO ASTRTITL                    13020000
130300                 SET DP030-SET-CURSOR-APPL-1                      13030000
130400                                   TO TRUE                        13040000
130500                 MOVE DP015-REVERSE                               13050000
130600                                   TO ASTRTITH                    13060000
130700                 MOVE DP015-RED    TO ASTRTITC                    13070000
130800                 MOVE DP015-UNP-NUM-BRT-MDT                       13080000
130900                                   TO ASTRTITA                    13090000
131000                 SET DP020-MSG-FATAL                              13100000
131100                                   TO TRUE                        13110000
131200                 SET PS-ERROR      TO TRUE                        13120000
131300             END-IF                                               13130000
131400                                                                  13140000
131500         ELSE                                                     13150000
131600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13160000
131700             MOVE -1               TO ASTRTITL                    13170000
131800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13180000
131900             MOVE DP015-REVERSE    TO ASTRTITH                    13190000
132000             MOVE DP015-RED        TO ASTRTITC                    13200000
132100             MOVE DP015-UNP-NUM-BRT-MDT                           13210000
132200                                   TO ASTRTITA                    13220000
132300             SET DP020-MSG-FATAL   TO TRUE                        13230000
132400             SET PS-ERROR          TO TRUE                        13240000
132500         END-IF                                                   13250000
132600     END-IF.                                                      13260000
132700 EJECT                                                            13270000
132800*----------------------------------------------------------------*13280000
132900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13290000
133000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13300000
133100*----------------------------------------------------------------*13310000
133200 2140-DESELECT-ALL-ITEMS.                                         13320000
133300     MOVE +1                       TO ASC-BLK-SUB.                13330000
133400                                                                  13340000
133500     PERFORM 2141-CLEAR-SELECTED-INDS                             13350000
133600         VARYING ASC-ITEM-SUB                                     13360000
133700         FROM 1 BY 1                                              13370000
133800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13380000
133900                                                                  13390000
134000     ADD +1                        TO ASC-BLK-SUB.                13400000
134100                                                                  13410000
134200     PERFORM 2141-CLEAR-SELECTED-INDS                             13420000
134300         VARYING ASC-ITEM-SUB                                     13430000
134400         FROM 1 BY 1                                              13440000
134500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13450000
134600                                                                  13460000
134700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13470000
134800                                   TO PV-LIST-ITEM-NUMBER.        13480000
134900                                                                  13490000
135000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13500000
135100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13510000
135200                                                                  13520000
135300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13530000
135400        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      13540000
135500         MOVE +1                   TO ASC-BLK-SUB                 13550000
135600                                                                  13560000
135700         PERFORM 5100-WRITE-TEMP-STORAGE                          13570000
135800                                                                  13580000
135900         MOVE +1                   TO PV-BLOCK-NUMBER             13590000
136000                                                                  13600000
136100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13610000
136200             PV-FIRST-BLOCK-IN-ARRAY - 1                          13620000
136300                                                                  13630000
136400         PERFORM                                                  13640000
136500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13650000
136600                                                                  13660000
136700             PERFORM 4410-READ-TEMP-STORAGE                       13670000
136800                                                                  13680000
136900             PERFORM 2141-CLEAR-SELECTED-INDS                     13690000
137000                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13700000
137100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13710000
137200                                                                  13720000
137300             PERFORM 5100-WRITE-TEMP-STORAGE                      13730000
137400                                                                  13740000
137500             ADD +1                TO PV-BLOCK-NUMBER             13750000
137600                                                                  13760000
137700         END-PERFORM                                              13770000
137800                                                                  13780000
137900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13790000
138000             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13800000
138100                                                                  13810000
138200         PERFORM                                                  13820000
138300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13830000
138400                   ASC-HIGHEST-BLOCK-WRITTEN                      13840000
138500                                                                  13850000
138600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13860000
138700                                   TO PV-BLOCK-NUMBER             13870000
138800                                                                  13880000
138900             PERFORM 4410-READ-TEMP-STORAGE                       13890000
139000                                                                  13900000
139100             PERFORM 2141-CLEAR-SELECTED-INDS                     13910000
139200                 VARYING ASC-ITEM-SUB                             13920000
139300                 FROM 1 BY 1                                      13930000
139400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13940000
139500                                                                  13950000
139600             PERFORM 5100-WRITE-TEMP-STORAGE                      13960000
139700                                                                  13970000
139800             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13980000
139900                                                                  13990000
140000         END-PERFORM                                              14000000
140100                                                                  14010000
140200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14020000
140300                                   TO PV-BLOCK-NUMBER             14030000
140400                                                                  14040000
140500         PERFORM 4410-READ-TEMP-STORAGE                           14050000
140600     END-IF.                                                      14060000
140700                                                                  14070000
140800                                                                  14080000
140900     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 14090000
141000     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.14100000
141100     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  14110000
141200                                                                  14120000
141300*GB  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14130000
141400*3/23                                                             14140000
141500 EJECT                                                            14150000
141600*----------------------------------------------------------------*14160000
141700*    MARK EACH ITEM AS BEING NOT SELECTED.                       *14170000
141800*----------------------------------------------------------------*14180000
141900                                                                  14190000
142000 2141-CLEAR-SELECTED-INDS.                                        14200000
142100                                                                  14210000
142200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14220000
142300             NOT EQUAL ZERO                                       14230000
142400         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14240000
142500             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14250000
142600                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    14260000
142700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14270000
142800                                   TO TRUE                        14280000
142900         END-IF                                                   14290000
143000     END-IF.                                                      14300000
143100                                                                  14310000
143200 EJECT                                                            14320000
143300*----------------------------------------------------------------*14330000
143400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *14340000
143500*  FOR ALL ITEMS.                                                *14350000
143600*----------------------------------------------------------------*14360000
143700                                                                  14370000
143800 2150-SELECT-ALL-ITEMS.                                           14380000
143900                                                                  14390000
144000     MOVE +1                       TO ASC-BLK-SUB.                14400000
144100                                                                  14410000
144200     PERFORM 2151-SET-SELECTED-INDS                               14420000
144300         VARYING ASC-ITEM-SUB                                     14430000
144400         FROM 1 BY 1                                              14440000
144500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14450000
144600                                                                  14460000
144700     ADD +1                        TO ASC-BLK-SUB.                14470000
144800                                                                  14480000
144900     PERFORM 2151-SET-SELECTED-INDS                               14490000
145000         VARYING ASC-ITEM-SUB                                     14500000
145100         FROM 1 BY 1                                              14510000
145200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14520000
145300                                                                  14530000
145400     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14540000
145500                                   TO PV-LIST-ITEM-NUMBER.        14550000
145600                                                                  14560000
145700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14570000
145800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14580000
145900                                                                  14590000
146000*10/13/00- BEGIN                                                  14600000
146100     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            14610000
146200         MOVE +1                   TO ASC-BLK-SUB                 14620000
146300                                                                  14630000
146400         PERFORM 5100-WRITE-TEMP-STORAGE                          14640000
146500         MOVE +2                   TO ASC-BLK-SUB                 14650000
146600         PERFORM 5100-WRITE-TEMP-STORAGE                          14660000
146700         MOVE +1                   TO ASC-BLK-SUB                 14670000
146800         MOVE +1                   TO PV-BLOCK-NUMBER             14680000
146900     END-IF.                                                      14690000
147000* 10/13/00 END                                                    14700000
147100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14710000
147200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14720000
147300         MOVE +1                   TO ASC-BLK-SUB                 14730000
147400                                                                  14740000
147500         PERFORM 5100-WRITE-TEMP-STORAGE                          14750000
147600                                                                  14760000
147700         MOVE +1                   TO PV-BLOCK-NUMBER             14770000
147800                                                                  14780000
147900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14790000
148000             PV-FIRST-BLOCK-IN-ARRAY - 1                          14800000
148100                                                                  14810000
148200         PERFORM                                                  14820000
148300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14830000
148400                                                                  14840000
148500             PERFORM 4410-READ-TEMP-STORAGE                       14850000
148600                                                                  14860000
148700             PERFORM 2151-SET-SELECTED-INDS                       14870000
148800                 VARYING ASC-ITEM-SUB                             14880000
148900                 FROM 1 BY 1                                      14890000
149000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14900000
149100                                                                  14910000
149200             PERFORM 5100-WRITE-TEMP-STORAGE                      14920000
149300                                                                  14930000
149400             ADD +1                TO PV-BLOCK-NUMBER             14940000
149500                                                                  14950000
149600         END-PERFORM                                              14960000
149700                                                                  14970000
149800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14980000
149900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14990000
150000                                                                  15000000
150100         PERFORM                                                  15010000
150200             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15020000
150300                   ASC-HIGHEST-BLOCK-WRITTEN                      15030000
150400                                                                  15040000
150500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15050000
150600                                   TO PV-BLOCK-NUMBER             15060000
150700                                                                  15070000
150800             PERFORM 4410-READ-TEMP-STORAGE                       15080000
150900                                                                  15090000
151000             PERFORM 2151-SET-SELECTED-INDS                       15100000
151100                 VARYING ASC-ITEM-SUB                             15110000
151200                 FROM 1 BY 1                                      15120000
151300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15130000
151400                                                                  15140000
151500             PERFORM 5100-WRITE-TEMP-STORAGE                      15150000
151600                                                                  15160000
151700             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15170000
151800                                                                  15180000
151900         END-PERFORM                                              15190000
152000                                                                  15200000
152100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15210000
152200                                   TO PV-BLOCK-NUMBER             15220000
152300                                                                  15230000
152400         PERFORM 4410-READ-TEMP-STORAGE                           15240000
152500     END-IF.                                                      15250000
152600                                                                  15260000
152700                                                                  15270000
152800     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             15280000
152900                       ASC-NUMBER-OF-SELECTED-ITEMS.              15290000
153000                                                                  15300000
153100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15310000
153200                                                                  15320000
153300 EJECT                                                            15330000
153400*----------------------------------------------------------------*15340000
153500*    MARK EACH ITEM AS BEING SELECTED.                           *15350000
153600*----------------------------------------------------------------*15360000
153700                                                                  15370000
153800 2151-SET-SELECTED-INDS.                                          15380000
153900                                                                  15390000
154000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15400000
154100             NOT EQUAL ZERO                                       15410000
154200         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15420000
154300             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15430000
154400                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        15440000
154500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15450000
154600                               TO  TRUE                           15460000
154700         END-IF                                                   15470000
154800     END-IF.                                                      15480000
154900                                                                  15490000
155000******************************************************************15500000
155100** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **15510000
155200** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **15520000
155300******************************************************************15530000
155400 2200-MOVE-SCREEN-TO-COMMAREA.                                    15540000
155500                                                                  15550000
155600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15560000
155700     MOVE +1                       TO PV-SUB.                     15570000
155800                                                                  15580000
155900     PERFORM 3100-SET-SUBSCRIPTS.                                 15590000
156000     IF  ASTRTITL > ZERO                                          15600000
156100         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          15610000
156200     ELSE                                                         15620000
156300         IF  ASTRTITF = DP015-ERASE-EOF                           15630000
156400             INITIALIZE ASC-START-ITEM-REQUEST                    15640000
156500         END-IF                                                   15650000
156600     END-IF.                                                      15660000
156700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15670000
156800         VARYING PV-SUB                                           15680000
156900         FROM 1 BY 1                                              15690000
157000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15700000
157100******************************************************************15710000
157200** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**15720000
157300******************************************************************15730000
157400 2210-MOVE-LINES-TO-COMMAREA.                                     15740000
157500     IF  MR-SELECTL (PV-SUB) > ZERO                               15750000
157600         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             15760000
157700         MOVE MR-SELECTI (PV-SUB)                                 15770000
157800                                   TO ASC-TEMP-SELECTED-SW        15780000
157900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15790000
158000     ELSE                                                         15800000
158100         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                15810000
158200                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     15820000
158300                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        15830000
158400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15840000
158500         END-IF                                                   15850000
158600     END-IF.                                                      15860000
158700                                                                  15870000
158800                                                                  15880000
158900     ADD +1                        TO ASC-ITEM-SUB.               15890000
159000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15900000
159100         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15910000
159200             COMPUTE PV-BLOCK-NUMBER  =                           15920000
159300                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         15930000
159400                    PC-ITEMS-PER-PANEL                            15940000
159500             PERFORM 5105-REWRITE-ASC-LISTQ                       15950000
159600         END-IF                                                   15960000
159700         ADD +1                    TO ASC-BLK-SUB                 15970000
159800         MOVE +1                   TO ASC-ITEM-SUB                15980000
159900     ELSE                                                         15990000
160000     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             16000000
160100         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16010000
160200             COMPUTE PV-BLOCK-NUMBER  =                           16020000
160300                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         16030000
160400                    PC-ITEMS-PER-PANEL                            16040000
160500             PERFORM 5105-REWRITE-ASC-LISTQ                       16050000
160600         END-IF                                                   16060000
160700     END-IF.                                                      16070000
160800*----------------------------------------------------------------*16080000
160900*                                                                 16090000
161000******************************************************************16100000
161100** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **16110000
161200** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **16120000
161300******************************************************************16130000
161400 3000-EDIT-DATA-IN-COMMAREA.                                      16140000
161500     SET PS-NO-ERROR               TO TRUE.                       16150000
161600     PERFORM 3200-RESET-ATTRIBUTES.                               16160000
161700     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16170000
161800**                                                                16180000
161900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16190000
162000* EDITTING IS DONE FROM THE BOTTOM UP.                            16200000
162100**                                                                16210000
162200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16220000
162300         ASC-ITEMS-DISPLAYED - 1.                                 16230000
162400     PERFORM 3100-SET-SUBSCRIPTS.                                 16240000
162500                                                                  16250000
162600     IF  PS-NO-ERROR                                              16260000
162700         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        16270000
162800     END-IF.                                                      16280000
162900                                                                  16290000
163000     IF  PS-NO-ERROR                                              16300000
163100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        16310000
163200     END-IF.                                                      16320000
163300                                                                  16330000
163400     IF  ((PS-NO-ERROR)                                           16340000
163500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   16350000
163600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    16360000
163700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  16370000
163800     END-IF.                                                      16380000
163900 EJECT                                                            16390000
164000                                                                  16400000
164100                                                                  16410000
164200*----------------------------------------------------------------*16420000
164300*   3005-EDIT-COMMAREA-BLOCKS                                    *16430000
164400*----------------------------------------------------------------*16440000
164500 3005-EDIT-COMMAREA-BLOCKS.                                       16450000
164600     MOVE +1                       TO PV-BLOCK-NUMBER.            16460000
164700     MOVE +1                       TO ASC-BLK-SUB.                16470000
164800     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               16480000
164900                                                                  16490000
165000     COMPUTE PV-BLOCK-NUMBER  =                                   16500000
165100        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 16510000
165200            PC-ITEMS-PER-PANEL.                                   16520000
165300                                                                  16530000
165400     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          16540000
165500                                                                  16550000
165600     PERFORM                                                      16560000
165700       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          16570000
165800          OR PS-ERROR                                             16580000
165900          OR PS-BLOCK-ERROR                                       16590000
166000                                                                  16600000
166100             COMPUTE PV-ITEMS-HOLD  =                             16610000
166200                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        16620000
166300                     PC-ITEMS-PER-PANEL - 1                       16630000
166400                                                                  16640000
166500             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       16650000
166600                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               16660000
166700                     FROM  PV-ITEMS-HOLD                          16670000
166800                   GIVING  PV-ITEMS-DIFF                          16680000
166900                 SUBTRACT  PV-ITEMS-DIFF                          16690000
167000                     FROM  PC-ITEMS-PER-PANEL                     16700000
167100                   GIVING  PV-ITEMS-HOLD                          16710000
167200                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              16720000
167300                                              ASC-ITEM-SUB        16730000
167400                                              ASC-ITEMS-DISPLAYED 16740000
167500             ELSE                                                 16750000
167600                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              16760000
167700                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        16770000
167800             END-IF                                               16780000
167900                                                                  16790000
168000             PERFORM 3300-EDIT-SELECTIONS                         16800000
168100                     VARYING PV-SUB                               16810000
168200                        FROM PV-SUB BY -1                         16820000
168300                       UNTIL PV-SUB < +1                          16830000
168400                                                                  16840000
168500             MOVE +1               TO ASC-BLK-SUB                 16850000
168600                                                                  16860000
168700             PERFORM 5105-REWRITE-ASC-LISTQ                       16870000
168800                                                                  16880000
168900             MOVE +1                TO ASC-BLK-SUB                16890000
169000                                                                  16900000
169100             IF  PS-BLOCK-ERROR                                   16910000
169200                 SET  PS-ERROR     TO TRUE                        16920000
169300                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        16930000
169400                                   TO PV-TOP-ITEM                 16940000
169500             ELSE                                                 16950000
169600                 ADD  +1           TO PV-BLOCK-NUMBER             16960000
169700                 IF  PV-BLOCK-NUMBER >                            16970000
169800                     ASC-HIGHEST-BLOCK-WRITTEN                    16980000
169900                     MOVE +2       TO ASC-BLK-SUB                 16990000
170000                     PERFORM 4410-READ-TEMP-STORAGE               17000000
170100                     MOVE +1       TO ASC-BLK-SUB                 17010000
170200                 ELSE                                             17020000
170300                     PERFORM 4410-READ-TEMP-STORAGE               17030000
170400                     ADD  +1        TO PV-BLOCK-NUMBER            17040000
170500                     MOVE +2        TO ASC-BLK-SUB                17050000
170600                     PERFORM 4410-READ-TEMP-STORAGE               17060000
170700                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            17070000
170800                     MOVE +1        TO ASC-BLK-SUB                17080000
170900                 END-IF                                           17090000
171000             END-IF                                               17100000
171100     END-PERFORM.                                                 17110000
171200                                                                  17120000
171300     IF  PV-ORIGINAL-BLOCK  = +1    OR                            17130000
171400         PS-ERROR                   OR                            17140000
171500         PS-BLOCK-ERROR                                           17150000
171600         CONTINUE                                                 17160000
171700     ELSE                                                         17170000
171800         MOVE +1                 TO PV-BLOCK-NUMBER               17180000
171900         MOVE +1                 TO ASC-BLK-SUB                   17190000
172000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  17200000
172100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           17210000
172200         PERFORM 4410-READ-TEMP-STORAGE                           17220000
172300                                                                  17230000
172400         PERFORM                                                  17240000
172500           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              17250000
172600              OR PS-ERROR                                         17260000
172700              OR PS-BLOCK-ERROR                                   17270000
172800                                                                  17280000
172900                 COMPUTE PV-ITEMS-HOLD  =                         17290000
173000                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    17300000
173100                         PC-ITEMS-PER-PANEL - 1                   17310000
173200                                                                  17320000
173300                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     17330000
173400                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           17340000
173500                         FROM  PV-ITEMS-HOLD                      17350000
173600                       GIVING  PV-ITEMS-DIFF                      17360000
173700                     SUBTRACT  PV-ITEMS-DIFF                      17370000
173800                         FROM  PC-ITEMS-PER-PANEL                 17380000
173900                       GIVING  PV-ITEMS-HOLD                      17390000
174000                         MOVE  PV-ITEMS-HOLD TO PV-SUB            17400000
174100                                                ASC-ITEM-SUB      17410000
174200                                               ASC-ITEMS-DISPLAYED17420000
174300                 ELSE                                             17430000
174400                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          17440000
174500                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    17450000
174600                 END-IF                                           17460000
174700                                                                  17470000
174800                 PERFORM 3300-EDIT-SELECTIONS                     17480000
174900                         VARYING PV-SUB                           17490000
175000                            FROM PV-SUB BY -1                     17500000
175100                           UNTIL PV-SUB < +1                      17510000
175200                                                                  17520000
175300                 MOVE +1               TO ASC-BLK-SUB             17530000
175400                                                                  17540000
175500                 PERFORM 5105-REWRITE-ASC-LISTQ                   17550000
175600                                                                  17560000
175700                 MOVE +1                TO ASC-BLK-SUB            17570000
175800                                                                  17580000
175900                 IF  PS-BLOCK-ERROR                               17590000
176000                     SET  PS-ERROR     TO TRUE                    17600000
176100                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    17610000
176200                                       TO PV-TOP-ITEM             17620000
176300                 ELSE                                             17630000
176400                     ADD  +1            TO PV-BLOCK-NUMBER        17640000
176500                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      17650000
176600                         MOVE +2        TO ASC-BLK-SUB            17660000
176700                         PERFORM 4410-READ-TEMP-STORAGE           17670000
176800                         MOVE +1        TO ASC-BLK-SUB            17680000
176900                     ELSE                                         17690000
177000                         PERFORM 4410-READ-TEMP-STORAGE           17700000
177100                         ADD  +1        TO PV-BLOCK-NUMBER        17710000
177200                         MOVE +2        TO ASC-BLK-SUB            17720000
177300                         PERFORM 4410-READ-TEMP-STORAGE           17730000
177400                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        17740000
177500                         MOVE +1        TO ASC-BLK-SUB            17750000
177600                     END-IF                                       17760000
177700                 END-IF                                           17770000
177800     END-PERFORM.                                                 17780000
177900*----------------------------------------------------------------*17790000
178000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17800000
178100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17810000
178200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17820000
178300*                                                                *17830000
178400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17840000
178500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17850000
178600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17860000
178700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17870000
178800*----------------------------------------------------------------*17880000
178900                                                                  17890000
179000 3100-SET-SUBSCRIPTS.                                             17900000
179100                                                                  17910000
179200     COMPUTE ASC-ITEM-SUB =                                       17920000
179300         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17930000
179400                                                                  17940000
179500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17950000
179600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17960000
179700                                                                  17970000
179800         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               17980000
179900     ELSE                                                         17990000
180000         MOVE +1                     TO ASC-BLK-SUB               18000000
180100     END-IF.                                                      18010000
180200******************************************************************18020000
180300** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **18030000
180400******************************************************************18040000
180500                                                                  18050000
180600 3200-RESET-ATTRIBUTES.                                           18060000
180700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   18070000
180800     MOVE DP015-GREEN              TO ASTRTITC.                   18080000
180900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18090000
181000                                                                  18100000
181100     PERFORM                                                      18110000
181200         VARYING PV-SUB                                           18120000
181300         FROM 1 BY 1                                              18130000
181400         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18140000
181500           MOVE DP015-UNP-ALP-NOR-OFF                             18150000
181600                                     TO MR-SELECTA (PV-SUB)       18160000
181700           MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)       18170000
181800           MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)       18180000
182100           MOVE DP015-ASK-NOR-OFF    TO MR-REQ-DATE-A (PV-SUB)    18210000
182101                                        MR-REQ-TIME-A (PV-SUB)    18210100
182102                                        MR-USER-A  (PV-SUB)       18210200
182103                                        MR-PO-A  (PV-SUB)         18210300
182110                                        MR-REC-A  (PV-SUB)        18211000
182200                                        MR-OPER-A  (PV-SUB)       18220000
182201                                        MR-STORE-A (PV-SUB)       18220100
182210                                        MR-PRCD-DATE-A (PV-SUB)   18221000
182300                                        MR-PRCD-TIME-A (PV-SUB)   18230000
182800     END-PERFORM.                                                 18280000
182900******************************************************************18290000
183000** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18300000
183100** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18310000
183200** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18320000
183300** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18330000
183400******************************************************************18340000
183500 3300-EDIT-SELECTIONS.                                            18350000
183600     EVALUATE TRUE                                                18360000
183700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18370000
183800             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18380000
183900                 CONTINUE                                         18390000
184000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18400000
184100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18410000
184200                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   18420000
184300                 MOVE ASC-TEMP-SELECTED-SW                        18430000
184400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18440000
184500                                TO ASC-SELECTED-SW                18450000
184600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18460000
184700             END-IF                                               18470000
184800         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18480000
184900                 = SPACE                                          18490000
185000             EVALUATE TRUE                                        18500000
185100                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18510000
185200                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18520000
185300                     MOVE SPACE TO ASC-SELECTED-SW                18530000
185400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18540000
185500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        18550000
185600                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    18560000
185700                     MOVE SPACE TO ASC-SELECTED-SW                18570000
185800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18580000
185900                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18590000
186000                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      18600000
186100                     MOVE SPACE TO ASC-SELECTED-SW                18610000
186200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18620000
186300             END-EVALUATE                                         18630000
186400         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18640000
186500             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18650000
186600                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18660000
186700             END-IF                                               18670000
186800             PERFORM 3310-EDIT-RANGE                              18680000
186900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18690000
187000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18700000
187100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18710000
187200             END-IF                                               18720000
187300             PERFORM 3310-EDIT-RANGE                              18730000
187400         WHEN OTHER                                               18740000
187500             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           18750000
187600             SET DP020-MSG-FATAL    TO TRUE                       18760000
187700             MOVE -1                TO MR-SELECTL (PV-SUB)        18770000
187800             SET DP030-SET-CURSOR-APPL-1                          18780000
187900                                    TO TRUE                       18790000
188000             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        18800000
188100             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        18810000
188200             SET PS-ERROR TO TRUE                                 18820000
188300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18830000
188400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18840000
188500                 MOVE SPACE         TO ASC-SELECTED-SW            18850000
188600                                        (ASC-BLK-SUB ASC-ITEM-SUB)18860000
188700             END-IF                                               18870000
188800     END-EVALUATE.                                                18880000
192300                                                                  19230000
192400* DELETE PO AUDIT EXCEPTION                                       19240000
192500     IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                    19250000
192600       IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  19260012
192700         MOVE 'SULARLST' TO DP008-FUNCTION-NAME                   19270012
192800*        PERFORM 2105-RACF-ACCESS                                 19280012
192810         PERFORM 2106-CHECK-DELETE                                19281012
192900           IF  PS-DELETE-NO                                       19290014
193000                SET  PS-ERROR                                     19300000
193100                     DP020-MSG-FATAL TO TRUE                      19310000
193200                MOVE PC-TSYMSG-03042 TO DP020-MSG-NUMBER          19320014
193300                MOVE -1              TO MR-SELECTL (PV-SUB)       19330000
193400                SET  DP030-SET-CURSOR-APPL-1 TO TRUE              19340000
193500                SET  DP030-OVERRIDE-GO TO TRUE                    19350000
193600                SET PS-BLOCK-ERROR   TO TRUE                      19360000
193700           END-IF                                                 19370000
193800       END-IF                                                     19380000
193900     END-IF                                                       19390000
194000                                                                  19400000
194100     IF PS-NO-ERROR                                               19410000
194200         IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                19420015
194300            IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             19430000
194400                SET ASC-CONFIRM-DELETE TO TRUE                    19440000
194500                SET  PS-ERROR                                     19450000
194600                     DP020-MSG-INFORMATIONAL TO TRUE              19460000
194700                MOVE PC-TSYMSG-02849 TO DP020-MSG-NUMBER          19470000
194800                MOVE -1              TO MR-SELECTL (PV-SUB)       19480000
194900                SET  DP030-SET-CURSOR-APPL-1 TO TRUE              19490000
195000                SET PS-BLOCK-ERROR   TO TRUE                      19500000
195100            END-IF                                                19510000
195200         END-IF                                                   19520000
195300     END-IF                                                       19530000
195400                                                                  19540000
195500                                                                  19550000
195600                                                                  19560000
195700     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 19570000
195800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19580000
195900     IF  ASC-ITEM-SUB < 1                                         19590000
196000         SUBTRACT +1 FROM ASC-BLK-SUB                             19600000
196100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                19610000
196200     END-IF.                                                      19620000
196300******************************************************************19630000
196400** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **19640000
196500** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **19650000
196600** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**19660000
196700** THE ENDING.                                                  **19670000
196800******************************************************************19680000
196900 3310-EDIT-RANGE.                                                 19690000
197000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                19700000
197100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   19710000
197200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)19720000
197300                                   TO ASC-SELECTED-SW             19730000
197400                                        (ASC-BLK-SUB ASC-ITEM-SUB)19740000
197500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 19750000
197600         ELSE                                                     19760000
197700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     19770000
197800                 CONTINUE                                         19780000
197900             ELSE                                                 19790000
198000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        19800000
198100                 MOVE PC-TSYMSG-00054                             19810000
198200                                   TO DP020-MSG-NUMBER            19820000
198300                 SET DP020-MSG-FATAL                              19830000
198400                                   TO TRUE                        19840000
198500                 MOVE -1           TO MR-SELECTL (PV-SUB)         19850000
198600                 SET DP030-SET-CURSOR-APPL-1                      19860000
198700                                   TO TRUE                        19870000
198800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         19880000
198900                 MOVE DP015-UNDERLINE                             19890000
199000                                   TO MR-SELECTH (PV-SUB)         19900000
199100                 SET PS-ERROR      TO TRUE                        19910000
199200             END-IF                                               19920000
199300         END-IF                                                   19930000
199400     ELSE                                                         19940000
199500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     19950000
199600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19960000
199700                                   TO ASC-SELECTED-SW             19970000
199800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19980000
199900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   19990000
200000         ELSE                                                     20000000
200100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       20010000
200200                 CONTINUE                                         20020000
200300             ELSE                                                 20030000
200400*                -- ONLY ONE END-OF-RANGE ALLOWED --              20040000
200500                 MOVE PC-TSYMSG-00055                             20050000
200600                                   TO DP020-MSG-NUMBER            20060000
200700                 SET DP020-MSG-FATAL                              20070000
200800                                   TO TRUE                        20080000
200900                 MOVE -1           TO MR-SELECTL (PV-SUB)         20090000
201000                 SET DP030-SET-CURSOR-APPL-1                      20100000
201100                                   TO TRUE                        20110000
201200                 SET PS-ERROR      TO TRUE                        20120000
201300             END-IF                                               20130000
201400         END-IF                                                   20140000
201500     END-IF.                                                      20150000
201600                                                                  20160000
201700******************************************************************20170000
201800** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20180000
201900** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20190000
202000******************************************************************20200000
202100 3400-CHECK-RANGE-SEQUENCE.                                       20210000
202200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20220000
202300       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20230000
202400       AND  ASC-START-OF-SELECTED-RANGE >                         20240000
202500                                         ASC-END-OF-SELECTED-RANGE20250000
202600*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20260000
202700         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20270000
202800         SET DP020-MSG-FATAL TO TRUE                              20280000
202900         SET PS-ERROR TO TRUE                                     20290000
203000         PERFORM 3410-POSITION-AT-ERROR                           20300000
203100     END-IF.                                                      20310000
203200******************************************************************20320000
203300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20330000
203400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20340000
203500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20350000
203600******************************************************************20360000
203700 3410-POSITION-AT-ERROR.                                          20370000
203800     SET DP030-SET-CURSOR-APPL-1                                  20380000
203900                                   TO TRUE.                       20390000
204000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20400000
204100                    - PV-TOP-ITEM + 1.                            20410000
204200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20420000
204300         CONTINUE                                                 20430000
204400     ELSE                                                         20440000
204500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20450000
204600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20460000
204700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20470000
204800     END-IF.                                                      20480000
204900                                                                  20490000
205000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20500000
205100                    - PV-TOP-ITEM + 1.                            20510000
205200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20520000
205300         CONTINUE                                                 20530000
205400     ELSE                                                         20540000
205500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20550000
205600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20560000
205700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20570000
205800     END-IF.                                                      20580000
205900 EJECT                                                            20590000
206000*----------------------------------------------------------------*20600000
206100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *20610000
206200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *20620000
206300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *20630000
206400*----------------------------------------------------------------*20640000
206500                                                                  20650000
206600 3500-MARK-RANGE-AS-SELECTED.                                     20660000
206700     MOVE +1                       TO  ASC-BLK-SUB.               20670000
206800     PERFORM 3510-MARK-SELECTED-INDS                              20680000
206900         VARYING ASC-ITEM-SUB                                     20690000
207000         FROM 1 BY 1                                              20700000
207100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20710000
207200                                                                  20720000
207300     ADD +1                        TO ASC-BLK-SUB.                20730000
207400     PERFORM 3510-MARK-SELECTED-INDS                              20740000
207500         VARYING ASC-ITEM-SUB                                     20750000
207600         FROM 1 BY 1                                              20760000
207700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20770000
207800                                                                  20780000
207900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20790000
208000                                   TO  PV-LIST-ITEM-NUMBER.       20800000
208100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20810000
208200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         20820000
208300               PC-ITEMS-PER-PANEL).                               20830000
208400                                                                  20840000
208500     MOVE ASC-START-OF-SELECTED-RANGE                             20850000
208600                                   TO PV-START-OF-SELECTED-RANGE. 20860000
208700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            20870000
208800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  20880000
208900               PC-ITEMS-PER-PANEL).                               20890000
209000                                                                  20900000
209100     MOVE ASC-END-OF-SELECTED-RANGE                               20910000
209200                                   TO  PV-END-OF-SELECTED-RANGE.  20920000
209300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             20930000
209400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    20940000
209500               PC-ITEMS-PER-PANEL).                               20950000
209600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             20960000
209700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             20970000
209800                                                                  20980000
209900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    20990000
210000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21000000
210100         MOVE +1                   TO ASC-BLK-SUB                 21010000
210200         PERFORM 5100-WRITE-TEMP-STORAGE                          21020000
210300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21030000
210400             PV-FIRST-BLOCK-IN-ARRAY - 1                          21040000
210500                                                                  21050000
210600         PERFORM                                                  21060000
210700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21070000
210800                   PV-PREV-BLOCK-IN-ARRAY                         21080000
210900             MOVE PV-FIRST-BLOCK-IN-RANGE                         21090000
211000                                   TO PV-BLOCK-NUMBER             21100000
211100             PERFORM 4410-READ-TEMP-STORAGE                       21110000
211200             PERFORM 3510-MARK-SELECTED-INDS                      21120000
211300                 VARYING ASC-ITEM-SUB                             21130000
211400                 FROM 1 BY 1                                      21140000
211500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21150000
211600             PERFORM 5100-WRITE-TEMP-STORAGE                      21160000
211700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21170000
211800         END-PERFORM                                              21180000
211900                                                                  21190000
212000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21200000
212100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21210000
212200         PERFORM                                                  21220000
212300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21230000
212400                   PV-LAST-BLOCK-IN-RANGE                         21240000
212500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21250000
212600                                   TO PV-BLOCK-NUMBER             21260000
212700             PERFORM 4410-READ-TEMP-STORAGE                       21270000
212800             PERFORM 3510-MARK-SELECTED-INDS                      21280000
212900                 VARYING ASC-ITEM-SUB                             21290000
213000                 FROM 1 BY 1                                      21300000
213100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21310000
213200             PERFORM 5100-WRITE-TEMP-STORAGE                      21320000
213300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21330000
213400         END-PERFORM                                              21340000
213500                                                                  21350000
213600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21360000
213700                                   TO PV-BLOCK-NUMBER             21370000
213800         PERFORM 4410-READ-TEMP-STORAGE                           21380000
213900     END-IF.                                                      21390000
214000                                                                  21400000
214100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21410000
214200                                      ASC-END-OF-SELECTED-RANGE.  21420000
214300                                                                  21430000
214400 EJECT                                                            21440000
214500*----------------------------------------------------------------*21450000
214600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21460000
214700*----------------------------------------------------------------*21470000
214800                                                                  21480000
214900 3510-MARK-SELECTED-INDS.                                         21490000
215000                                                                  21500000
215100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21510000
215200                                ASC-ITEM-SUB) >                   21520000
215300         ASC-START-OF-SELECTED-RANGE)                             21530000
215400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21540000
215500                                ASC-ITEM-SUB) =                   21550000
215600         ASC-START-OF-SELECTED-RANGE)                             21560000
215700                                                                  21570000
215800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21580000
215900                                    ASC-ITEM-SUB) <               21590000
216000             ASC-END-OF-SELECTED-RANGE)                           21600000
216100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21610000
216200                                    ASC-ITEM-SUB) =               21620000
216300             ASC-END-OF-SELECTED-RANGE)                           21630000
216400                                                                  21640000
216500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21650000
216600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   21660000
216700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   21670000
216800                               TO TRUE                            21680000
216900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              21690000
217000                               TO TRUE                            21700000
217100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    21710000
217200             END-IF                                               21720000
217300         END-IF                                                   21730000
217400     END-IF.                                                      21740000
217500                                                                  21750000
217600 EJECT                                                            21760000
217700                                                                  21770000
217800*----------------------------------------------------------------*21780000
217900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *21790000
218000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *21800000
218100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *21810000
218200*    DISPLAY THE PANEL TO USER.                                  *21820000
218300*----------------------------------------------------------------*21830000
218400                                                                  21840000
218500 4000-BUILD-INITIAL-PANEL.                                        21850000
218600                                                                  21860000
218700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            21870000
218800                                 ASC-BLOCK-ENTRIES (2).           21880000
218900     MOVE +1                 TO ASC-BLK-SUB.                      21890000
219000     SET ASC-ITEMS-LEFT-ON-DB                                     21900000
219100                             TO TRUE.                             21910000
219200                                                                  21920000
219300     MOVE +0                 TO ASC-ITEM-SUB                      21930000
219400                                ASC-NUMBER-OF-ITEMS-READ          21940000
219500                                ASC-NUMBER-OF-SELECTED-ITEMS      21950000
219600                                ASC-HIGHEST-BLOCK-WRITTEN         21960000
219700                                ASC-START-OF-SELECTED-RANGE       21970000
219800                                ASC-END-OF-SELECTED-RANGE         21980000
219900                                ASC-ITEM-AT-TOP-OF-PANEL.         21990000
220000                                                                  22000000
220100     PERFORM 4100-PREPARE-CURSOR.                                 22010000
220200                                                                  22020000
220300     IF PS-NO-ERROR                                               22030000
220400         PERFORM 7000-OPEN-CURSOR                                 22040000
220500     END-IF.                                                      22050000
220600                                                                  22060000
220700     IF PS-NO-ERROR                                               22070000
220800         PERFORM 4300-READ-ITEMS-FROM-DB                          22080000
220900         PERFORM 7010-FETCH                                       22090000
221000     END-IF                                                       22100000
221100                                                                  22110000
221200                                                                  22120000
221300     MOVE +1                   TO  PV-TOP-ITEM.                   22130000
221400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          22140000
221500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    22150024
221600         SET DP020-MSG-FATAL   TO  TRUE                           22160000
221700         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               22170000
221800         PERFORM VARYING PV-SUB FROM 1 BY 1                       22180024
221900              UNTIL PV-SUB > 13                                   22190024
222000             MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)       22200024
222100             MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)       22210024
222200             MOVE SPACE              TO MR-SELECTI (PV-SUB)       22220024
222300         END-PERFORM                                              22230024
222400     ELSE                                                         22240000
222500         MOVE -1               TO MR-SELECTL (1)                  22250000
222600         SET DP030-SET-CURSOR-APPL-1                              22260000
222700                               TO TRUE                            22270000
222800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     22280000
222900     END-IF.                                                      22290000
223000                                                                  22300000
223100*----------------------------------------------------------------*22310000
223200*    SET UP THE HOST VARIABLES.                                  *22320000
223300*----------------------------------------------------------------*22330000
223400                                                                  22340000
223500 4100-PREPARE-CURSOR.                                             22350000
223600                                                                  22360000
223700     EVALUATE TRUE                                                22370000
223800         WHEN (ASC-KEY-TK-ID            > SPACES                  22380019
223900              AND ASC-KEY-REQ-FROM-DATE > SPACES                  22390019
223910              AND ASC-KEY-REQ-TO-DATE   > SPACES)                 22391019
224000             MOVE ASC-KEY-TK-ID         TO DK-TK-ID               22400011
224010             MOVE ASC-KEY-REQ-FROM-DATE TO DK-SHIP-FROM-DATE      22401000
224020             MOVE ASC-KEY-REQ-TO-DATE   TO DK-SHIP-TO-DATE        22402000
224100             SET ASC-USR-DATE-CSR       TO TRUE                   22410011
224200                                                                  22420000
224300         WHEN (ASC-KEY-TK-ID     > SPACES                         22430019
224310              AND ASC-KEY-REQ-FROM-DATE = SPACES                  22431019
224320              AND ASC-KEY-REQ-TO-DATE   = SPACES)                 22432019
224400             SET ASC-USR-CSR            TO TRUE                   22440011
224500                                                                  22450000
224510         WHEN (ASC-KEY-TK-ID     = SPACES                         22451019
224600             AND ASC-KEY-REQ-FROM-DATE  > SPACES                  22460019
224610             AND ASC-KEY-REQ-TO-DATE    > SPACES)                 22461019
224700             SET ASC-DATE-CSR           TO TRUE                   22470011
224800         WHEN OTHER                                               22480000
224900             SET PS-ERROR                                         22490000
225000                 ASC-NO-ITEMS-LEFT-ON-DB                          22500000
225100                 DP020-NEXT-ACT-APPL-ERROR                        22510000
225200                 DP020-MSG-FATAL      TO TRUE                     22520000
225300             MOVE PC-TSYMSG-02892     TO DP020-MSG-NUMBER         22530000
225400     END-EVALUATE.                                                22540000
225500                                                                  22550000
225600*    MOVE ASC-KEY-PO-NBR              TO DK-PO-NBR.               22560000
225700                                                                  22570000
227300/                                                                 22730000
227600*----------------------------------------------------------------*22760000
227700*  DELETE THE SUT AUDIT REQUEST TABLE SUT_RPT_REQ (SUT00029).     22770013
227800*----------------------------------------------------------------*22780000
227900 4200-DELETE-PO-AUDIT-EXCPT.                                      22790000
228000                                                                  22800000
228100     EXEC SQL                                                     22810000
228200         DELETE                                                   22820000
228300         FROM SUT_RPT_REQ                                         22830000
228400         WHERE                                                    22840000
228500             USR_ID                   = :SUT00029-USR-ID          22850000
228600         AND RPT_REQ_TMST             = :SUT00029-RPT-REQ-TMST    22860000
228700         AND PO_NBR                   = :SUT00029-PO-NBR          22870000
228800         AND REC_SEQ_NBR              = :SUT00029-REC-SEQ-NBR     22880000
228810         AND ORGN_LOC_NBR             = :SUT00029-ORGN-LOC-NBR    22881000
228820         AND DEST_LOC_NBR             = :SUT00029-DEST-LOC-NBR    22882000
228830                                                                  22883000
228900     END-EXEC                                                     22890000
229000                                                                  22900000
229100     EVALUATE TRUE                                                22910000
229200         WHEN SQLCODE = ZERO                                      22920000
229300         WHEN SQLCODE = +100                                      22930000
229400             CONTINUE                                             22940000
229500         WHEN SQLCODE = -904                                      22950000
229600         WHEN SQLCODE = -911                                      22960000
229700         WHEN SQLCODE = -913                                      22970000
229800             PERFORM 9900-SOFT-ABORT                              22980000
229900         WHEN SQLWARN0 NOT = SPACES                               22990000
230000         WHEN SQLCODE < ZERO                                      23000000
230100         WHEN SQLCODE > ZERO                                      23010000
230200             MOVE '7100-DELETE-AUDIT'                             23020000
230300                               TO DP013-PARAGRAPH                 23030000
230400             MOVE 'CLOSE CURSOR '                                 23040000
230500                               TO DP013-MESSAGE-TEXT (1)          23050000
230600             MOVE SQLCA        TO DP013-SQLCA                     23060000
230700             MOVE 'SUT_RPT_REQ  '  TO DP013-DB2-TABLE-NAME (1)    23070013
230800             SET DP013-DB2-ABEND                                  23080000
230900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23090000
231000             PERFORM DP013-0000-PROCESS-ABEND                     23100000
231100     END-EVALUATE.                                                23110000
231200                                                                  23120000
231300                                                                  23130000
231400*----------------------------------------------------------------*23140000
231500*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *23150000
231600*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *23160000
231700*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *23170000
231800*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *23180000
231900*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *23190000
232000*                                                                *23200000
232100*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *23210000
232200*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *23220000
232300*    UPON INITIALIZATION.                                        *23230000
232400*----------------------------------------------------------------*23240000
232500                                                                  23250000
232600 4300-READ-ITEMS-FROM-DB.                                         23260000
232700                                                                  23270000
232800     PERFORM                                                      23280000
232900         VARYING PV-READ-COUNT                                    23290000
233000         FROM 1 BY 1                                              23300000
233100         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    23310000
233200            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         23320000
233300                                                                  23330000
233400         PERFORM 7010-FETCH                                       23340000
233500                                                                  23350000
233600         IF  ASC-ITEMS-LEFT-ON-DB                                 23360000
233700                                                                  23370000
233800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                23380000
233900                 ADD +1            TO ASC-ITEM-SUB                23390000
234000             ELSE                                                 23400000
234100                 ADD +1            TO ASC-BLK-SUB                 23410000
234200                 MOVE +1           TO ASC-ITEM-SUB                23420000
234300                                                                  23430000
234400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         23440000
234500                     MOVE +1       TO ASC-BLK-SUB                 23450000
234600                     SET ASC-BLOCK-MODIFIED (1)                   23460000
234700                                   TO TRUE                        23470000
234800                     PERFORM 5100-WRITE-TEMP-STORAGE              23480000
234900                     MOVE ASC-BLOCK-ENTRIES                       23490000
235000                               (PC-MAX-BLOCKS-IN-ARRAY)           23500000
235100                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 23510000
235200                     ADD +1        TO ASC-BLK-SUB                 23520000
235300                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   23530000
235400                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      23540000
235500                                   TO TRUE                        23550000
235600                 END-IF                                           23560000
235700             END-IF                                               23570000
235800                                                                  23580000
235900                                                                  23590000
236000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    23600000
236100             MOVE ASC-NUMBER-OF-ITEMS-READ                        23610000
236200                                   TO ASC-LIST-ITEM-NUMBER        23620000
236300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23630000
236400             MOVE SPACES                 TO  ASC-ACTION           23640000
236500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23650000
236600                                                                  23660012
236700             MOVE ASC-NUMBER-OF-ITEMS-READ                        23670000
236800                                      TO ASC-LIST-ITEM-NUMBER     23680000
236900                                        (ASC-BLK-SUB ASC-ITEM-SUB)23690000
236901                                                                  23690100
236902             MOVE SUT00029-RPT-REQ-TMST TO ASC-REQ-TMST           23690215
236903                                        (ASC-BLK-SUB ASC-ITEM-SUB)23690315
236910             MOVE SUT00029-RPT-REQ-TMST TO PV-DB2-TIMESTAMP       23691000
236920                 STRING PV-DB2-TMST-MM                            23692000
236930                        '/'                                       23693000
236940                        PV-DB2-TMST-DD                            23694000
236950                        '/'                                       23695000
236960                        PV-DB2-TMST-YYYY                          23696000
236970                                         DELIMITED BY SIZE        23697000
236980                                    INTO ASC-REQ-DATE             23698000
236990                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23699000
236991                                                                  23699100
236992                 STRING PV-DB2-TMST-HH                            23699200
236993                        ':'                                       23699300
236994                        PV-DB2-TMST-MIN                           23699400
236995                        ':'                                       23699500
236996                        PV-DB2-TMST-SEC                           23699600
236997                                         DELIMITED BY SIZE        23699700
236998                                    INTO ASC-REQ-TIME             23699800
236999                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23699900
237000                                                                  23700000
237010             MOVE SUT00029-USR-ID                                 23701000
237100                                      TO ASC-USER-ID              23710000
237200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23720000
237210             MOVE SUT00029-PO-NBR                                 23721000
237220                                      TO ASC-PO-NBR               23722000
237230                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23723000
237300             MOVE SUT00029-REC-SEQ-NBR                            23730000
237400                                      TO ASC-RECEIVER             23740000
237500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23750000
237900             MOVE SUT00029-ORGN-LOC-NBR                           23790000
238000                                      TO ASC-OPER-UNT-ID          23800000
238100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23810000
238110             MOVE SUT00029-DEST-LOC-NBR                           23811000
238120                                      TO ASC-STORE                23812000
238130                                       (ASC-BLK-SUB ASC-ITEM-SUB) 23813000
238131                                                                  23813113
238140             IF SUT00029-RPT-CRE-TMST                             23814013
238141                                    = '9999-09-09-09.09.09.999999'23814113
238150                 MOVE 'REQUEST IN'         TO ASC-PRCD-DATE       23815013
238160                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23816013
238161                 MOVE 'PROCESS '           TO ASC-PRCD-TIME       23816113
238162                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23816213
238170             ELSE                                                 23817013
241100                 MOVE SUT00029-RPT-CRE-TMST TO PV-DB2-TIMESTAMP   24110013
241500                   STRING PV-DB2-TMST-MM                          24150013
241510                        '/'                                       24151000
241600                        PV-DB2-TMST-DD                            24160000
241610                        '/'                                       24161000
241620                        PV-DB2-TMST-YYYY                          24162000
241700                                         DELIMITED BY SIZE        24170000
241800                                    INTO ASC-PRCD-DATE            24180000
241900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24190000
243100                                                                  24310000
243200                 STRING PV-DB2-TMST-HH                            24320000
243300                        ':'                                       24330000
243400                        PV-DB2-TMST-MIN                           24340000
243410                        ':'                                       24341000
243420                        PV-DB2-TMST-SEC                           24342000
243430                                         DELIMITED BY SIZE        24343000
243440                                    INTO ASC-PRCD-TIME            24344000
243450                                       (ASC-BLK-SUB ASC-ITEM-SUB) 24345000
243460             END-IF                                               24346013
243500         END-IF                                                   24350000
243600     END-PERFORM.                                                 24360000
243700                                                                  24370000
243800     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          24380000
243900         MOVE +1               TO ASC-BLK-SUB                     24390000
244000         PERFORM 5100-WRITE-TEMP-STORAGE                          24400000
244100         ADD +1                TO ASC-BLK-SUB                     24410000
244200         PERFORM 5100-WRITE-TEMP-STORAGE                          24420000
244300                                                                  24430000
244400         MOVE 1                TO ASC-BLK-SUB                     24440000
244500                                  PV-BLOCK-NUMBER                 24450000
244600         PERFORM 4410-READ-TEMP-STORAGE                           24460000
244700         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             24470000
244800             MOVE 2            TO ASC-BLK-SUB                     24480000
244900                                  PV-BLOCK-NUMBER                 24490000
245000             PERFORM 4410-READ-TEMP-STORAGE                       24500000
245100         END-IF                                                   24510000
245200     END-IF.                                                      24520000
245300                                                                  24530000
245400                                                                  24540000
245500*----------------------------------------------------------------*24550000
245600* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *24560000
245700*----------------------------------------------------------------*24570000
245800                                                                  24580000
245900 4400-MOVE-COMMAREA-TO-SCREEN.                                    24590000
246000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             24600000
246100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          24610000
246200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          24620000
246300             MOVE +1    TO ASC-BLK-SUB                            24630000
246400             PERFORM 5100-WRITE-TEMP-STORAGE                      24640000
246500             ADD +1     TO ASC-BLK-SUB                            24650000
246600             PERFORM 5100-WRITE-TEMP-STORAGE                      24660000
246700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             24670000
246800                 GIVING PV-BLOCK-NUMBER                           24680000
246900                 REMAINDER PV-REMAINDER                           24690000
247000             IF  PV-REMAINDER > ZERO                              24700000
247100                 ADD +1 TO PV-BLOCK-NUMBER                        24710000
247200             END-IF                                               24720000
247300             MOVE +1    TO ASC-BLK-SUB                            24730000
247400             PERFORM 4410-READ-TEMP-STORAGE                       24740000
247500             ADD +1     TO ASC-BLK-SUB                            24750000
247600                           PV-BLOCK-NUMBER                        24760000
247700             PERFORM 4410-READ-TEMP-STORAGE                       24770000
247800     END-IF.                                                      24780000
247900     MOVE +1            TO ASC-BLK-SUB.                           24790000
248000     COMPUTE ASC-ITEM-SUB =                                       24800000
248100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              24810000
248200         + PC-ITEMS-PER-PANEL).                                   24820000
248300                                                                  24830000
248400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        24840000
248500         ADD +1         TO ASC-BLK-SUB                            24850000
248600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24860000
248700     END-IF.                                                      24870000
248800                                                                  24880000
248900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           24890000
249000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                24900000
249100     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        24910000
249200     PERFORM 4420-FORMAT-LIST-LINES                               24920000
249300         VARYING PV-SUB                                           24930000
249400         FROM PC-ITEMS-PER-PANEL BY -1                            24940000
249500         UNTIL PV-SUB < +1.                                       24950000
249600                                                                  24960000
249700     COMPUTE ASC-ITEMS-DISPLAYED =                                24970000
249800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          24980000
249900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL.   24990024
250000     MOVE ASC-ITEM-AT-TOP-OF-PANEL TO ASTRTITO.                   25000024
250100     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    25010000
250200     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    25020000
250300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            25030000
250400                                   TO ASELITO.                    25040000
250410     MOVE ASC-KEY-OPER-UNT-ID      TO AOPERO.                     25041000
250411     MOVE ASC-KEY-FCLTY-ID         TO AFCLTYO.                    25041100
250420     MOVE ASC-KEY-FCLTY-NAME       TO ANAMEO.                     25042000
250421     MOVE ASC-KEY-TK-ID            TO ATKNOO.                     25042100
250431     MOVE ASC-FROM-MM              TO AFMMO.                      25043100
250432     MOVE ASC-FROM-DD              TO AFDDO.                      25043200
250433     MOVE ASC-FROM-YYYY            TO AFYYO.                      25043300
250450     MOVE ASC-TO-MM                TO ATMMO.                      25045000
250460     MOVE ASC-TO-DD                TO ATDDO.                      25046000
250470     MOVE ASC-TO-YYYY              TO ATYYO.                      25047000
250500                                                                  25050000
250600     IF  DP020-MSG-NUMBER-X = SPACE                               25060000
250700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  25070000
250800*            --- MORE ITEMS TO DISPLAY ----                       25080000
250900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            25090000
251000             SET DP020-MSG-INFORMATIONAL TO TRUE                  25100000
251100         END-IF                                                   25110000
251200     END-IF.                                                      25120000
251300*----------------------------------------------------------------*25130000
251400*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *25140000
251500*----------------------------------------------------------------*25150000
251600                                                                  25160000
251700 4410-READ-TEMP-STORAGE.                                          25170000
251800                                                                  25180000
251900     EXEC CICS                                                    25190000
252000         READQ TS                                                 25200000
252100             QUEUE (ASC-LIST-QUEUE-NAME)                          25210000
252200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               25220000
252300             ITEM  (PV-BLOCK-NUMBER)                              25230000
252400             RESP  (PV-CICS-RESP)                                 25240000
252500     END-EXEC.                                                    25250000
252600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       25260000
252700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     25270000
252800         CONTINUE                                                 25280000
252900     ELSE                                                         25290000
253000         SET DP013-CICS-ABEND     TO TRUE                         25300000
253100         SET DP013-NO-ROLLBACK    TO TRUE                         25310000
253200         MOVE '4410-READ-TEMP-STORAGE'                            25320000
253300                                  TO DP013-PARAGRAPH              25330000
253400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      25340000
253500                                  TO DP013-MESSAGE-TEXT(1)        25350000
253600         PERFORM DP013-0000-PROCESS-ABEND                         25360000
253700     END-IF.                                                      25370000
253800                                                                  25380000
253900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25390000
254000                                                                  25400000
254100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         25410000
254200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               25420000
254300     END-IF.                                                      25430000
254400 EJECT                                                            25440000
254500*----------------------------------------------------------------*25450000
254600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *25460000
254700*----------------------------------------------------------------*25470000
254800                                                                  25480000
254900 4420-FORMAT-LIST-LINES.                                          25490000
255000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      25500000
255100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                25510000
255200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           25520000
255300                                    MR-REQ-DATE-A (PV-SUB)        25530000
255400                                    MR-REQ-TIME-A (PV-SUB)        25540000
255500                                    MR-USER-A  (PV-SUB)           25550000
256100                                    MR-PO-A  (PV-SUB)             25610000
256110                                    MR-REC-A  (PV-SUB)            25611000
256120                                    MR-OPER-A  (PV-SUB)           25612000
256130                                    MR-STORE-A (PV-SUB)           25613000
256140                                    MR-PRCD-DATE-A (PV-SUB)       25614000
256150                                    MR-PRCD-TIME-A (PV-SUB)       25615000
256200         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           25620000
256300         MOVE SPACE              TO MR-SELECTI (PV-SUB)           25630000
256400                                    MR-ACTION (PV-SUB)            25640000
256500     ELSE                                                         25650000
256600         PERFORM 4420A-FILL-SCREEN                                25660000
256700                                                                  25670000
256800*        IF  DP030-SET-CURSOR-TRAILER                             25680000
256900*            IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)25690000
257000*                > SPACE)                                         25700000
257100*              OR (PV-SUB = 1))                                   25710000
257200*               SET DP030-SET-CURSOR-APPL-1 TO TRUE               25720000
257300*               MOVE -1          TO MR-SELECTL (PV-SUB)           25730000
257400*            END-IF                                               25740000
257500*        END-IF                                                   25750000
257600                                                                  25760000
257700         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           25770000
257800             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           25780000
257900                                 TO MR-ACTION (PV-SUB)            25790000
258000         ELSE                                                     25800000
258100             IF ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    25810000
258200                 MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)       25820000
258300                                     TO MR-ACTION (PV-SUB)        25830000
258400             END-IF                                               25840000
258500         END-IF                                                   25850000
258600     END-IF.                                                      25860000
258700     SUBTRACT +1 FROM ASC-ITEM-SUB                                25870000
258800     IF  ASC-ITEM-SUB < + 1                                       25880000
258900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  25890000
259000         MOVE +1                 TO ASC-BLK-SUB                   25900000
259100     END-IF.                                                      25910000
259200                                                                  25920000
259300                                                                  25930000
259400 4420A-FILL-SCREEN.                                               25940000
259500     IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          25950000
259600                                                   > SPACE        25960000
259700         MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     25970000
259800                                 TO MR-SELECTI (PV-SUB)           25980000
259900     ELSE                                                         25990000
260000         MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)          26000000
260100                                 TO MR-SELECTI (PV-SUB)           26010000
260200     END-IF                                                       26020000
260300                                                                  26030000
260400     MOVE ASC-REQ-DATE (ASC-BLK-SUB ASC-ITEM-SUB)                 26040000
260500                                      TO MR-REQ-DATE (PV-SUB)     26050000
262000                                                                  26200000
262001     MOVE ASC-REQ-TIME (ASC-BLK-SUB ASC-ITEM-SUB)                 26200100
262002                                      TO MR-REQ-TIME (PV-SUB)     26200200
262003                                                                  26200300
262004     MOVE ASC-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB)                  26200400
262005                                      TO MR-USER (PV-SUB).        26200500
262007                                                                  26200700
262010     MOVE ASC-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                   26201000
262020                                      TO MR-PO   (PV-SUB)         26202000
262030                                                                  26203000
262040     MOVE ASC-RECEIVER (ASC-BLK-SUB ASC-ITEM-SUB)                 26204000
262050                                      TO MR-REC (PV-SUB)          26205015
262060                                                                  26206000
262100     MOVE ASC-OPER-UNT-ID (ASC-BLK-SUB ASC-ITEM-SUB)              26210000
262200                                      TO MR-OPER (PV-SUB)         26220000
263800                                                                  26380000
263900     MOVE ASC-STORE       (ASC-BLK-SUB ASC-ITEM-SUB)              26390000
264000                                      TO MR-STORE (PV-SUB)        26400000
264100                                                                  26410000
264200     MOVE ASC-PRCD-DATE (ASC-BLK-SUB ASC-ITEM-SUB)                26420000
264210                                      TO MR-PRCD-DATE (PV-SUB)    26421000
264220                                                                  26422000
264230     MOVE ASC-PRCD-TIME (ASC-BLK-SUB ASC-ITEM-SUB)                26423000
264240                                      TO MR-PRCD-TIME (PV-SUB).   26424000
264250                                                                  26425000
264300******************************************************************26430000
264400** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **26440000
264500** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **26450000
264600** ISSUE A WARNING.                                             **26460000
264700******************************************************************26470000
264800 4430-CHECK-FOR-BEGIN-AND-END.                                    26480000
264900     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       26490000
265000         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     26500000
265100*            -- NO END-OF-RANGE SPECFIED ---                      26510000
265200             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            26520000
265300             SET DP020-MSG-WARNING TO TRUE                        26530000
265400             PERFORM 4431-POSITION-AT-WARNING                     26540000
265500         END-IF                                                   26550000
265600     ELSE                                                         26560000
265700         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     26570000
265800*            -- NO BEGINNING-OF-RANGE SPECFIED ---                26580000
265900             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            26590000
266000             SET DP020-MSG-WARNING TO TRUE                        26600000
266100             PERFORM 4431-POSITION-AT-WARNING                     26610000
266200         END-IF                                                   26620000
266300     END-IF.                                                      26630000
266400******************************************************************26640000
266500** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **26650000
266600** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **26660000
266700** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **26670000
266800** POSITION THE CURSOR THERE.                                   **26680000
266900******************************************************************26690000
267000 4431-POSITION-AT-WARNING.                                        26700000
267100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 26710000
267200                    - PV-TOP-ITEM + 1.                            26720000
267300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26730000
267400         CONTINUE                                                 26740000
267500     ELSE                                                         26750000
267600         SET DP030-SET-CURSOR-APPL-1                              26760000
267700                                   TO TRUE                        26770000
267800         MOVE -1                   TO MR-SELECTL (PV-SUB)         26780000
267900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26790000
268000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         26800000
268100     END-IF.                                                      26810000
268200                                                                  26820000
268300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   26830000
268400                    - PV-TOP-ITEM + 1.                            26840000
268500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26850000
268600         CONTINUE                                                 26860000
268700     ELSE                                                         26870000
268800         SET DP030-SET-CURSOR-APPL-1                              26880000
268900                                   TO TRUE                        26890000
269000         MOVE -1                   TO MR-SELECTL (PV-SUB)         26900000
269100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26910000
269200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         26920000
269300     END-IF.                                                      26930000
269400 EJECT                                                            26940000
269500*----------------------------------------------------------------*26950000
269600*  DELETE FUNCTION FUNCTION                                       26960000
269700*----------------------------------------------------------------*26970000
269800 4600-PROCESS-DELETE-FUNCTION.                                    26980000
269900                                                                  26990000
270000                                                                  27000000
270100     MOVE +1                       TO ASC-BLK-SUB.                27010000
270200     PERFORM 5100-WRITE-TEMP-STORAGE.                             27020000
270300     ADD +1                        TO ASC-BLK-SUB.                27030000
270400     PERFORM 5100-WRITE-TEMP-STORAGE.                             27040000
270500                                                                  27050000
270600     PERFORM 6112-READ-LIST-QUEUE.                                27060000
270700                                                                  27070000
270800     SET  LQW-IDX  TO   1.                                        27080000
270900                                                                  27090000
271000       IF PV-CICS-RESP = DFHRESP (NORMAL)                         27100000
271100         PERFORM                                                  27110000
271200         VARYING LQW-IDX  FROM 1 BY 1                             27120000
271300         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL                     27130000
271400            OR   LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            27140000
271500            OR   PS-ERROR                                         27150000
271600             IF  LQW-SELECT (LQW-IDX)                             27160000
271700                 PERFORM 4605-PROCESS-SELECTED-LINES              27170000
271800             END-IF                                               27180000
271900         END-PERFORM                                              27190000
272000       END-IF.                                                    27200000
272100                                                                  27210000
272200     MOVE PV-ITEM      TO PV-SAVE-ITEM.                           27220000
272300     PERFORM 6111-WRITE-LIST-QUEUE.                               27230000
272400                                                                  27240000
272500     MOVE +1                     TO  ASC-BLK-SUB.                 27250000
272600     PERFORM 4410-READ-TEMP-STORAGE.                              27260000
272700                                                                  27270000
272800     ADD +1                      TO  ASC-BLK-SUB                  27280000
272900                                     PV-BLOCK-NUMBER.             27290000
273000                                                                  27300000
273100     PERFORM 4410-READ-TEMP-STORAGE.                              27310000
273200                                                                  27320000
273300*----------------------------------------------------------------*27330000
273400*                                                                 27340000
273500*----------------------------------------------------------------*27350000
273600 4605-PROCESS-SELECTED-LINES.                                     27360000
273700                                                                  27370000
273800     PERFORM 4620-PROCESS-LINES.                                  27380000
273900                                                                  27390000
274000     IF  PS-NO-ERROR                                              27400000
274100         SET  LQW-DESELECT (LQW-IDX) TO TRUE                      27410000
274200         MOVE PC-DEL      TO LQW-ACTION (LQW-IDX)                 27420000
274300                                                                  27430000
274400         SUBTRACT  1                                              27440000
274500             FROM  ASC-NUMBER-OF-SELECTED-ITEMS                   27450000
274600         MOVE LQW-SELECTED-SW (LQW-IDX)                           27460000
274700                              TO LQW-TEMP-SELECTED-SW (LQW-IDX)   27470000
274800     END-IF.                                                      27480000
274900                                                                  27490000
275000                                                                  27500000
275100*----------------------------------------------------------------*27510000
275200*                                                                 27520000
275400*----------------------------------------------------------------*27540000
275500 4620-PROCESS-LINES.                                              27550000
275600                                                                  27560000
275800     IF  PS-NO-ERROR                                              27580013
275810         MOVE LQW-USER-ID (LQW-IDX)     TO SUT00029-USR-ID        27581015
275910         MOVE LQW-REQ-TMST(LQW-IDX)     TO SUT00029-RPT-REQ-TMST  27591015
276000         MOVE LQW-PO-NBR (LQW-IDX)      TO SUT00029-PO-NBR        27600015
276100         MOVE LQW-RECEIVER (LQW-IDX)    TO SUT00029-REC-SEQ-NBR   27610015
276200         MOVE LQW-OPER-UNT-ID (LQW-IDX) TO SUT00029-ORGN-LOC-NBR  27620015
276210         MOVE LQW-STORE (LQW-IDX)       TO SUT00029-DEST-LOC-NBR  27621015
276220     END-IF.                                                      27622013
276300*                                                                 27630000
276400******************************************************************27640000
276500* PROCESS SELECTED LINES BASED ON FUNCTION SELECTED               27650000
276600* FUNC-03 (DELETE)                                                27660000
276700*  --DELETE SELECTED AUDIT RANK, ONLY IF THERE ARE NO             27670000
276800*       VENDORS OR VENDOR/DEPARTMENTS THAT HAVE THE SELECTED      27680000
276900*       AUDIT RANK/PKING TYPE CLASSIFICATION                      27690000
277000*       --OR--                                                    27700000
277100*       IF THERE IS AN ENTRY IN THE AUDIT REQUEST TABLE           27710000
277200******************************************************************27720000
277300                                                                  27730000
277400                                                                  27740000
277500         IF  LQW-SELECT (LQW-IDX)                                 27750000
277600             IF ASC-CONFIRM-DELETE                                27760000
277700                   PERFORM 4200-DELETE-PO-AUDIT-EXCPT             27770000
277800         END-IF                                                   27780000
277900     END-IF.                                                      27790000
278000                                                                  27800000
278100                                                                  27810000
278200*----------------------------------------------------------------*27820000
278300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *27830000
278400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *27840000
278500* FOR THE SELECTED ITEMS QUEUE.                                  *27850000
278600*                                                                *27860000
278700* DETERMINE WHICH COPYBOOK WILL BE USED TO PREPARE THE SELECTION *27870000
278800* QUEUE BASED ON THE FUNCTION SELECTED (FUCN02 AND FUNC03 GO TO  *27880000
278900* RC LISTS WHICH USE A DIFFERENT COPYBOOK                        *27890000
279000*                                                                *27900000
279100* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *27910000
279200* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *27920000
279300* THE ARRAY IS FULL.                                             *27930000
279400*----------------------------------------------------------------*27940000
279500                                                                  27950000
279600 5000-PREPARE-SEL-QUEUE.                                          27960000
279700                                                                  27970000
279800     MOVE +1                   TO  ASC-BLK-SUB.                   27980000
279900     PERFORM 5100-WRITE-TEMP-STORAGE.                             27990000
280000     ADD +1                    TO  ASC-BLK-SUB.                   28000000
280100     PERFORM 5100-WRITE-TEMP-STORAGE.                             28010000
280200*    MOVE ASC-SEL-QUEUE-NAME     TO  SU021-SEL-QUEUE-NAME         28020000
280300                                                                  28030000
280400     PERFORM 6010-DELETE-SEL-QUEUE.                               28040000
280500                                                                  28050000
280600     SET ASC-UPDATE-TSQ        TO  TRUE.                          28060000
280700     SET SU022-IDX         TO  1                                  28070000
280800*    MOVE ZERO             TO SU021-NUMBER-OF-TS-ITEMS            28080000
280900     INITIALIZE SU022-SELECTED-ITEM-ARRAY                         28090000
281000                                                                  28100000
281100     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           28110000
281200       VARYING PV-ITEM FROM 1 BY 1                                28120000
281300         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                28130000
281400                                                                  28140000
281500                                                                  28150000
281600       IF SU022-IDX > 1                                           28160000
281700           PERFORM 5205-WRITE-SEL-QUEUE                           28170000
281800*          ADD +1 TO SU021-NUMBER-OF-TS-ITEMS                     28180000
281900       END-IF.                                                    28190000
282000 EJECT                                                            28200000
282100                                                                  28210000
282200*----------------------------------------------------------------*28220000
282300*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *28230000
282400*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *28240000
282500*----------------------------------------------------------------*28250000
282600                                                                  28260000
282700 5100-WRITE-TEMP-STORAGE.                                         28270000
282800     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     28280000
282900                                   TO PV-LIST-ITEM-NUMBER.        28290000
283000     COMPUTE PV-BLOCK-NUMBER =                                    28300000
283100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    28310000
283200                                                                  28320000
283300     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             28330000
283400     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             28340000
283500         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      28350000
283600             PERFORM 5105-REWRITE-ASC-LISTQ                       28360000
283700         END-IF                                                   28370000
283800     ELSE                                                         28380000
283900         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       28390000
284000         ASC-HIGHEST-BLOCK-WRITTEN + 1                            28400000
284100         PERFORM 5110-WRITE-ASC-LISTQ                             28410000
284200         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   28420000
284300     END-IF.                                                      28430000
284400                                                                  28440000
284500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28450000
284600******************************************************************28460000
284700** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **28470000
284800** SPECIFIC COMMAREA.                                           **28480000
284900******************************************************************28490000
285000 5105-REWRITE-ASC-LISTQ.                                          28500000
285100     EXEC CICS                                                    28510000
285200         WRITEQ TS                                                28520000
285300             QUEUE (ASC-LIST-QUEUE-NAME)                          28530000
285400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28540000
285500             ITEM  (PV-BLOCK-NUMBER)                              28550000
285600             REWRITE                                              28560000
285700             RESP  (PV-CICS-RESP)                                 28570000
285800     END-EXEC.                                                    28580000
285900                                                                  28590000
286000     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           28600000
286100         CONTINUE                                                 28610000
286200     ELSE                                                         28620000
286300         SET DP013-CICS-ABEND            TO TRUE                  28630000
286400         SET DP013-NO-ROLLBACK           TO TRUE                  28640000
286500         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       28650000
286600         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     28660000
286700                                         TO DP013-MESSAGE-TEXT(1) 28670000
286800         PERFORM DP013-0000-PROCESS-ABEND                         28680000
286900     END-IF.                                                      28690000
287000                                                                  28700000
287100******************************************************************28710000
287200** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **28720000
287300** SPECIFIC COMMAREA.                                           **28730000
287400******************************************************************28740000
287500 5110-WRITE-ASC-LISTQ.                                            28750000
287600     EXEC CICS                                                    28760000
287700         WRITEQ TS                                                28770000
287800             QUEUE (ASC-LIST-QUEUE-NAME)                          28780000
287900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28790000
288000             ITEM  (PV-BLOCK-NUMBER)                              28800000
288100             RESP  (PV-CICS-RESP)                                 28810000
288200     END-EXEC.                                                    28820000
288300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      28830000
288400         SET DP013-CICS-ABEND      TO TRUE                        28840000
288500         SET DP013-NO-ROLLBACK     TO TRUE                        28850000
288600         MOVE '5110-WRITE-ASC-LISTQ'                              28860000
288700                                   TO DP013-PARAGRAPH             28870000
288800         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           28880000
288900                                   TO DP013-MESSAGE-TEXT(1)       28890000
289000         PERFORM DP013-0000-PROCESS-ABEND                         28900000
289100     END-IF.                                                      28910000
289200 EJECT                                                            28920000
289300*----------------------------------------------------------------*28930000
289400* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *28940000
289500* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *28950000
289600*----------------------------------------------------------------*28960000
289700                                                                  28970000
289800 5200-FILL-SEL-QUEUE-RECORD.                                      28980000
289900                                                                  28990000
290000     PERFORM 6112-READ-LIST-QUEUE.                                29000000
290100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       29010000
290200         PERFORM                                                  29020000
290300         VARYING LQW-IDX                                          29030000
290400         FROM 1 BY 1                                              29040000
290500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            29050000
290600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          29060000
290700                                                                  29070000
290800             IF  LQW-SELECT (LQW-IDX)                             29080000
290900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              29090000
291000                                   TO SU022-ITEM (SU022-IDX)      29100000
291100                 MOVE SPACE        TO SU022-ACTION-SW (SU022-IDX) 29110000
291200*              LOAD SELECTIONS TO SEL-QUEUE                       29120000
291300                 MOVE LQW-PO-NBR (LQW-IDX)                        29130000
291400                                      TO SU022-PO-NBR             29140000
291500                                         (SU022-IDX)              29150000
291600*                MOVE LQW-PO-LINE (LQW-IDX)                       29160000
291700*                                     TO SU022-PO-LNE-NBR         29170000
291800*                                        (SU022-IDX)              29180000
293400                 SET SU022-IDX UP BY 1                            29340000
293500                 IF  SU022-IDX > SU022-MAX-ITEMS                  29350000
293600                     PERFORM 5205-WRITE-SEL-QUEUE                 29360000
293700*                    ADD +1        TO SU021-NUMBER-OF-TS-ITEMS    29370000
293800                     INITIALIZE SU022-SELECTED-ITEM-ARRAY         29380000
293900                     SET SU022-IDX TO  1                          29390000
294000                 END-IF                                           29400000
294100             END-IF                                               29410000
294200         END-PERFORM                                              29420000
294300     END-IF.                                                      29430000
294400                                                                  29440000
294500*----------------------------------------------------------------*29450000
294600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *29460000
294700*----------------------------------------------------------------*29470000
294800                                                                  29480000
294900 5205-WRITE-SEL-QUEUE.                                            29490000
295000                                                                  29500000
295100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            29510000
295200                                   TO SU022-SELECTED-ITEMS.       29520000
295300                                                                  29530000
295400     EXEC CICS                                                    29540000
295500          WRITEQ TS                                               29550000
295600              QUEUE (ASC-SEL-QUEUE-NAME)                          29560000
295700              FROM  (SU022-SELECT-RECORD)                         29570000
295800              ITEM  (PV-SEL-QUEUE-ITEM)                           29580000
295900              RESP  (PV-CICS-RESP)                                29590000
296000     END-EXEC.                                                    29600000
296100                                                                  29610000
296200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29620000
296300         CONTINUE                                                 29630000
296400     ELSE                                                         29640000
296500         SET DP013-CICS-ABEND      TO TRUE                        29650000
296600         SET DP013-NO-ROLLBACK     TO TRUE                        29660000
296700         MOVE '5205-WRITE-SEL-QUEUE'                              29670000
296800                                   TO DP013-PARAGRAPH             29680000
296900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          29690000
297000                                   TO DP013-MESSAGE-TEXT(1)       29700000
297100         PERFORM DP013-0000-PROCESS-ABEND                         29710000
297200     END-IF.                                                      29720000
297300******************************************************************29730000
297400 6000-REFRESH-PANEL-FROM-TEMP.                                    29740000
297500     IF  ASC-UPDATE-TSQ                                           29750000
297600         SET ASC-NO-TSQ-UPDATE TO TRUE                            29760000
297700         MOVE ZERO                 TO PV-SAVE-ITEM                29770000
297800                                      PV-SEL-QUEUE-ITEM           29780000
297900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        29790000
298000                                   TO PV-HOLD-SELECTED-ITEMS      29800000
298100         MOVE +1                   TO PV-ITEMS-PROCESSED          29810000
298200         PERFORM 6100-UPDATE-TSQ                                  29820000
298300           UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS      29830000
298400                                                                  29840000
298500         SET ASC-FUNC02-RETURN-NO TO TRUE                         29850000
298600                                                                  29860000
298700                                                                  29870000
298800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         29880000
298900                    ASC-BLOCK-ENTRIES (2)                         29890000
299000     END-IF.                                                      29900000
299100                                                                  29910000
299200*----------------------------------------------------------------*29920000
299300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *29930000
299400*----------------------------------------------------------------*29940000
299500 6010-DELETE-SEL-QUEUE.                                           29950000
299600                                                                  29960000
299700     EXEC CICS                                                    29970000
299800         DELETEQ TS                                               29980000
299900             QUEUE (ASC-SEL-QUEUE-NAME)                           29990000
300000             RESP  (PV-CICS-RESP)                                 30000000
300100     END-EXEC.                                                    30010000
300200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      30020000
300300        (PV-CICS-RESP = DFHRESP(QIDERR)))                         30030000
300400         CONTINUE                                                 30040000
300500     ELSE                                                         30050000
300600         SET DP013-CICS-ABEND TO TRUE                             30060000
300700         SET DP013-NO-ROLLBACK TO TRUE                            30070000
300800         MOVE '6010-DELETE-SEL-QUEUE'                             30080000
300900                        TO DP013-PARAGRAPH                        30090000
301000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         30100000
301100                        TO DP013-MESSAGE-TEXT (1)                 30110000
301200         PERFORM DP013-0000-PROCESS-ABEND                         30120000
301300     END-IF.                                                      30130000
301400                                                                  30140000
301500 EJECT                                                            30150000
301600*----------------------------------------------------------------*30160000
301700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *30170000
301800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *30180000
301900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *30190000
302000*    THE TEMP QUEUE.                                             *30200000
302100*----------------------------------------------------------------*30210000
302200                                                                  30220000
302300 6100-UPDATE-TSQ.                                                 30230000
302400                                                                  30240000
302500     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             30250000
302600     PERFORM 6105-READ-SEL-QUEUE.                                 30260000
302700     PERFORM                                                      30270000
302800         VARYING SU022-IDX                                        30280000
302900         FROM 1 BY 1                                              30290000
303000         UNTIL ((PV-ITEMS-PROCESSED >                             30300000
303100                              PV-HOLD-SELECTED-ITEMS)             30310000
303200         OR (SU022-IDX GREATER THAN SU022-MAX-ITEMS))             30320000
303300         IF  SU022-ACTION-SW (SU022-IDX) > SPACE                  30330000
303400             PERFORM 6110-PROCESS-ITEMS                           30340000
303500         END-IF                                                   30350000
303600         ADD +1                TO PV-ITEMS-PROCESSED              30360000
303700     END-PERFORM.                                                 30370000
303800     PERFORM 6111-WRITE-LIST-QUEUE.                               30380000
303900*----------------------------------------------------------------*30390000
304000*    READ THE LIST QUEUE RECORD.                                 *30400000
304100*----------------------------------------------------------------*30410000
304200                                                                  30420000
304300 6105-READ-SEL-QUEUE.                                             30430000
304400                                                                  30440000
304500     EXEC CICS                                                    30450000
304600          READQ TS                                                30460000
304700              QUEUE (ASC-SEL-QUEUE-NAME)                          30470000
304800              INTO  (SU022-SELECT-RECORD)                         30480000
304900              ITEM  (PV-SEL-QUEUE-ITEM)                           30490000
305000              RESP  (PV-CICS-RESP)                                30500000
305100     END-EXEC.                                                    30510000
305200*                                                                 30520000
305300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          30530000
305400         CONTINUE                                                 30540000
305500     ELSE                                                         30550000
305600         SET DP013-CICS-ABEND      TO  TRUE                       30560000
305700         SET DP013-NO-ROLLBACK     TO  TRUE                       30570000
305800         MOVE '6105-READ-SEL-QUEUE'                               30580000
305900                                   TO  DP013-PARAGRAPH            30590000
306000         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           30600000
306100                                   TO  DP013-MESSAGE-TEXT(1)      30610000
306200         PERFORM DP013-0000-PROCESS-ABEND                         30620000
306300     END-IF.                                                      30630000
306400 EJECT                                                            30640000
306500*----------------------------------------------------------------*30650000
306600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*30660000
306700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*30670000
306800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *30680000
306900*----------------------------------------------------------------*30690000
307000                                                                  30700000
307100 6110-PROCESS-ITEMS.                                              30710000
307200                                                                  30720000
307300     COMPUTE PV-ITEM = 1 + ((SU022-ITEM (SU022-IDX) - 1)          30730000
307400                     / PC-ITEMS-PER-PANEL).                       30740000
307500                                                                  30750000
307600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           30760000
307700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          30770000
307800             PERFORM 6111-WRITE-LIST-QUEUE                        30780000
307900         END-IF                                                   30790000
308000         MOVE PV-ITEM          TO PV-SAVE-ITEM                    30800000
308100                                                                  30810000
308200         PERFORM 6112-READ-LIST-QUEUE                             30820000
308300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               30830000
308400             CONTINUE                                             30840000
308500         END-IF                                                   30850000
308600     END-IF.                                                      30860000
308700                                                                  30870000
308800     COMPUTE PV-SUB = (SU022-ITEM (SU022-IDX)                     30880000
308900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              30890000
309000     SET LQW-DESELECT (PV-SUB) TO    TRUE                         30900000
309100     MOVE LQW-SELECTED-SW (PV-SUB)                                30910000
309200                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  30920000
309300     EVALUATE TRUE                                                30930000
309400         WHEN SU022-INQ (SU022-IDX)                               30940000
309500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             30950000
309600                                                                  30960000
309700         WHEN SU022-UPD (SU022-IDX)                               30970000
309800              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             30980000
309900                                                                  30990000
310000         WHEN SU022-DEL (SU022-IDX)                               31000000
310100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             31010000
310200                                                                  31020000
310300         WHEN SU022-ERR (SU022-IDX)                               31030000
310400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             31040000
310500     END-EVALUATE.                                                31050000
310600                                                                  31060000
310800                                                                  31080000
310900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                31090000
311000                                                                  31100000
311100*----------------------------------------------------------------*31110000
311200*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *31120000
311300*----------------------------------------------------------------*31130000
311400                                                                  31140000
311500 6111-WRITE-LIST-QUEUE.                                           31150000
311600                                                                  31160000
311700     EXEC CICS                                                    31170000
311800         WRITEQ TS                                                31180000
311900             QUEUE (ASC-LIST-QUEUE-NAME)                          31190000
312000             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     31200000
312100             ITEM  (PV-SAVE-ITEM)                                 31210000
312200             REWRITE                                              31220000
312300             RESP  (PV-CICS-RESP)                                 31230000
312400     END-EXEC.                                                    31240000
312500*                                                                 31250000
312600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31260000
312700         CONTINUE                                                 31270000
312800     ELSE                                                         31280000
312900         SET DP013-CICS-ABEND  TO  TRUE                           31290000
313000         SET DP013-NO-ROLLBACK TO  TRUE                           31300000
313100         MOVE '6111-WRITE-LIST-QUEUE'                             31310000
313200                               TO  DP013-PARAGRAPH                31320000
313300         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  31330000
313400                               TO  DP013-MESSAGE-TEXT(1)          31340000
313500         PERFORM DP013-0000-PROCESS-ABEND                         31350000
313600     END-IF.                                                      31360000
313700                                                                  31370000
313800 EJECT                                                            31380000
313900*----------------------------------------------------------------*31390000
314000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*31400000
314100*----------------------------------------------------------------*31410000
314200                                                                  31420000
314300 6112-READ-LIST-QUEUE.                                            31430000
314400                                                                  31440000
314500     EXEC CICS                                                    31450000
314600         READQ TS                                                 31460000
314700             QUEUE (ASC-LIST-QUEUE-NAME)                          31470000
314800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     31480000
314900             ITEM  (PV-ITEM)                                      31490000
315000             RESP  (PV-CICS-RESP)                                 31500000
315100     END-EXEC.                                                    31510000
315200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31520000
315300         CONTINUE                                                 31530000
315400     ELSE                                                         31540000
315500         SET DP013-CICS-ABEND        TO TRUE                      31550000
315600         SET DP013-NO-ROLLBACK       TO TRUE                      31560000
315700         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           31570000
315800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    31580000
315900                                     TO DP013-MESSAGE-TEXT(1)     31590000
316000         PERFORM DP013-0000-PROCESS-ABEND                         31600000
316100     END-IF.                                                      31610000
316200                                                                  31620000
316300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 31630000
316400 7000-OPEN-CURSOR.                                                31640000
316500                                                                  31650000
316600     EVALUATE TRUE                                                31660000
316700         WHEN ASC-USR-CSR                                         31670000
316800             MOVE 'CURSOR: USR-CSR'                               31680000
316900                                   TO DP013-MESSAGE-TEXT (2)      31690000
317000             EXEC SQL                                             31700000
317100                 OPEN USR-CSR                                     31710000
317200             END-EXEC                                             31720000
317300                                                                  31730000
317400         WHEN ASC-USR-DATE-CSR                                    31740000
317500             MOVE 'CURSOR:  USR-DATE-CSR'                         31750000
317600                                   TO DP013-MESSAGE-TEXT (2)      31760000
317700             EXEC SQL                                             31770000
317800                 OPEN USR-DATE-CSR                                31780000
317900             END-EXEC                                             31790000
318000                                                                  31800000
318100         WHEN ASC-DATE-CSR                                        31810000
318200             MOVE 'CURSOR:  DATE-CSR'                             31820000
318300                                   TO DP013-MESSAGE-TEXT (2)      31830000
318400             EXEC SQL                                             31840000
318500                 OPEN DATE-CSR                                    31850000
318600             END-EXEC                                             31860000
318700                                                                  31870000
318800     END-EVALUATE.                                                31880000
318900                                                                  31890000
319000     EVALUATE TRUE                                                31900000
319100         WHEN SQLCODE = ZERO                                      31910000
319200             CONTINUE                                             31920000
319300         WHEN SQLCODE = -904                                      31930000
319400         WHEN SQLCODE = -911                                      31940000
319500         WHEN SQLCODE = -913                                      31950000
319600             PERFORM 9900-SOFT-ABORT                              31960000
319700         WHEN SQLWARN0 NOT = SPACES                               31970000
319800         WHEN SQLCODE < ZERO                                      31980000
319900         WHEN SQLCODE > ZERO                                      31990000
320000             MOVE '7000-OPEN-CURSOR'                              32000000
320100                                   TO DP013-PARAGRAPH             32010000
320200             MOVE 'OPEN AUDIT CURSOR - '                          32020000
320300                                   TO DP013-MESSAGE-TEXT (1)      32030000
320400             MOVE SQLCA            TO DP013-SQLCA                 32040000
320500             MOVE 'SUT_RPT_REQ'                                   32050000
320600                                   TO DP013-DB2-TABLE-NAME (1)    32060000
320700             SET DP013-DB2-ABEND                                  32070000
320800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32080000
320900             PERFORM DP013-0000-PROCESS-ABEND                     32090000
321000     END-EVALUATE.                                                32100000
321100                                                                  32110000
327800******************************************************************32780000
327900*                                                                 32790000
328000******************************************************************32800000
328100 7010-FETCH.                                                      32810000
328200                                                                  32820000
328300     EVALUATE TRUE                                                32830000
328400         WHEN ASC-USR-CSR                                         32840000
328500             EXEC SQL                                             32850000
328600                 FETCH USR-CSR                                    32860000
328700                 INTO                                             32870000
328800                    :SUT00029-USR-ID                              32880000
328900                 ,  :SUT00029-RPT-REQ-TMST                        32890000
329000                 ,  :SUT00029-PO-NBR                              32900000
329100                 ,  :SUT00029-REC-SEQ-NBR                         32910000
329200                 ,  :SUT00029-ORGN-LOC-NBR                        32920000
329300                 ,  :SUT00029-DEST-LOC-NBR                        32930000
329400                 ,  :SUT00029-RPT-CRE-TMST                        32940000
329800             END-EXEC                                             32980000
329900                                                                  32990000
330000         WHEN ASC-USR-DATE-CSR                                    33000000
330100             EXEC SQL                                             33010000
330200                 FETCH USR-DATE-CSR                               33020000
330300                 INTO                                             33030000
330400                    :SUT00029-USR-ID                              33040000
330500                 ,  :SUT00029-RPT-REQ-TMST                        33050000
330600                 ,  :SUT00029-PO-NBR                              33060000
330700                 ,  :SUT00029-REC-SEQ-NBR                         33070000
330800                 ,  :SUT00029-ORGN-LOC-NBR                        33080000
330900                 ,  :SUT00029-DEST-LOC-NBR                        33090000
331000                 ,  :SUT00029-RPT-CRE-TMST                        33100000
331400             END-EXEC                                             33140000
331500                                                                  33150000
331600         WHEN ASC-DATE-CSR                                        33160000
331700             EXEC SQL                                             33170000
331800                 FETCH DATE-CSR                                   33180000
331900                 INTO                                             33190000
332000                    :SUT00029-USR-ID                              33200000
332100                 ,  :SUT00029-RPT-REQ-TMST                        33210000
332200                 ,  :SUT00029-PO-NBR                              33220000
332300                 ,  :SUT00029-REC-SEQ-NBR                         33230000
332400                 ,  :SUT00029-ORGN-LOC-NBR                        33240000
332500                 ,  :SUT00029-DEST-LOC-NBR                        33250000
332600                 ,  :SUT00029-RPT-CRE-TMST                        33260000
333000             END-EXEC                                             33300000
333100                                                                  33310000
333200     END-EVALUATE.                                                33320000
333300                                                                  33330000
333400     EVALUATE TRUE                                                33340000
333500         WHEN SQLCODE = ZERO                                      33350000
333600             CONTINUE                                             33360016
334200         WHEN SQLCODE = +100                                      33420000
334300             SET ASC-NO-ITEMS-LEFT-ON-DB                          33430000
334400                                      TO TRUE                     33440000
334500         WHEN SQLCODE = -904                                      33450000
334600         WHEN SQLCODE = -911                                      33460000
334700         WHEN SQLCODE = -913                                      33470000
334800             PERFORM 9900-SOFT-ABORT                              33480000
334900         WHEN SQLWARN0 NOT = SPACE                                33490000
335000         WHEN SQLCODE NOT = ZERO                                  33500000
335100              MOVE '7010-FETCH-CURSOR'                            33510000
335200                               TO DP013-PARAGRAPH                 33520000
335300              MOVE 'FETCH CURSOR'                                 33530000
335400                               TO DP013-MESSAGE-TEXT (1)          33540000
335500              MOVE 'SUT_RPT_REQ'  TO DP013-DB2-TABLE-NAME (2)     33550000
335600              MOVE SQLCA       TO DP013-SQLCA                     33560000
335700              SET DP013-DB2-ABEND                                 33570000
335800                               TO TRUE                            33580000
335900              PERFORM DP013-0000-PROCESS-ABEND                    33590000
336000     END-EVALUATE.                                                33600000
336100                                                                  33610000
336200 7020-CLOSE-CURSOR.                                               33620000
336300     EVALUATE TRUE                                                33630000
336400         WHEN ASC-USR-CSR                                         33640000
336500             EXEC SQL                                             33650000
336600                CLOSE USR-CSR                                     33660000
336700             END-EXEC                                             33670000
336800                                                                  33680000
336900         WHEN ASC-USR-DATE-CSR                                    33690000
337000             EXEC SQL                                             33700000
337100                CLOSE USR-DATE-CSR                                33710000
337200             END-EXEC                                             33720000
337300                                                                  33730000
337400         WHEN ASC-DATE-CSR                                        33740000
337500             EXEC SQL                                             33750000
337600                CLOSE DATE-CSR                                    33760000
337700             END-EXEC                                             33770000
337800     END-EVALUATE.                                                33780000
337900                                                                  33790000
338000     EVALUATE TRUE                                                33800000
338100         WHEN SQLCODE = ZERO                                      33810000
338200             CONTINUE                                             33820000
338300         WHEN SQLCODE = -904                                      33830000
338400         WHEN SQLCODE = -911                                      33840000
338500         WHEN SQLCODE = -913                                      33850000
338600             PERFORM 9900-SOFT-ABORT                              33860000
338700         WHEN SQLWARN0 NOT = SPACES                               33870000
338800         WHEN SQLCODE < ZERO                                      33880000
338900         WHEN SQLCODE > ZERO                                      33890000
339000             MOVE '7020-CLOSE-CURSOR'                             33900000
339100                               TO DP013-PARAGRAPH                 33910000
339200             MOVE 'CLOSE CURSOR '                                 33920000
339300                               TO DP013-MESSAGE-TEXT (1)          33930000
339400             MOVE SQLCA        TO DP013-SQLCA                     33940000
339500             MOVE 'SUT_RPT_REQ'  TO DP013-DB2-TABLE-NAME (1)      33950000
339600             SET DP013-DB2-ABEND                                  33960000
339700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33970000
339800             PERFORM DP013-0000-PROCESS-ABEND                     33980000
339900     END-EVALUATE.                                                33990000
340000                                                                  34000000
340100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 34010000
340200 9100-READ-SEL-QUEUE.                                             34020000
340300     EXEC CICS                                                    34030000
340400         READQ TS                                                 34040000
340500             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        34050000
340600             INTO  (SU022-SELECT-RECORD)                          34060000
340700             ITEM  (ASC-SEL-ITEM)                                 34070000
340800             RESP  (PV-CICS-RESP)                                 34080000
340900     END-EXEC.                                                    34090000
341000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        34100000
341100         CONTINUE                                                 34110000
341200     ELSE                                                         34120000
341300         SET DP013-LOGIC-ABEND                                    34130000
341400             DP013-NO-ROLLBACK   TO   TRUE                        34140000
341500         MOVE '9100-READ-SEL-QUEUE'                               34150000
341600                                 TO   DP013-PARAGRAPH             34160000
341700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   34170000
341800                                 TO   DP013-MESSAGE-TEXT (1)      34180000
341900         PERFORM DP013-0000-PROCESS-ABEND                         34190000
342000     END-IF.                                                      34200000
342100                                                                  34210000
342200                                                                  34220000
342300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*34230000
342400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *34240000
342500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 34250000
342600 9200-REWRITE-SEL-QUEUE.                                          34260000
342700                                                                  34270000
342800     EXEC CICS                                                    34280000
342900          WRITEQ TS                                               34290000
343000              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      34300000
343100              FROM   (SU022-SELECT-RECORD)                        34310000
343200              ITEM   (ASC-SEL-ITEM)                               34320000
343300              RESP   (PV-CICS-RESP)                               34330000
343400              REWRITE                                             34340000
343500     END-EXEC.                                                    34350000
343600                                                                  34360000
343700     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   34370000
343800         SET DP013-CICS-ABEND                                     34380000
343900             DP013-NO-ROLLBACK     TO TRUE                        34390000
344000         MOVE '9200-REWRITE-SEL-QUEUE'                            34400000
344100                                   TO DP013-PARAGRAPH             34410000
344200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   34420000
344300                                   TO DP013-MESSAGE-TEXT (1)      34430000
344400         PERFORM DP013-0000-PROCESS-ABEND                         34440000
344500     END-IF.                                                      34450000
344600                                                                  34460000
344700                                                                  34470000
344800 9900-SOFT-ABORT.                                                 34480000
344900     SET PS-ERROR         TO TRUE.                                34490000
345000     SET DP020-MSG-FATAL  TO TRUE.                                34500000
345100     MOVE 'THROUGH SOFT-ABORT PARA'                               34510000
345200                            TO DP013-MESSAGE-TEXT (1)             34520000
345300     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    34530000
345400                                                                  34540000
345500     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          34550000
345600     PERFORM 0001-CALL-CICS-ARCH-API.                             34560000
345700                                                                  34570000
345800*----------------------------------------------------------------*34580000
345900*    CURRENT SYSTEM DATE/TIME MODULE                              34590000
346000*----------------------------------------------------------------*34600000
346100                                                                  34610000
346200     COPY DPPD017.                                                34620000
346300                                                                  34630000
346400*----------------------------------------------------------------*34640000
346500*    ABEND PROCESSOR MODULE                                      *34650000
346600*----------------------------------------------------------------*34660000
346700                                                                  34670000
346800     COPY DPPD013.                                                34680000
346900                                                                  34690000
