000100 IDENTIFICATION DIVISION.                                         00010033
000200 PROGRAM-ID.     APKRP115.                                        00020033
000300 AUTHOR.         M.WILKINSON.                                     00030033
000400 DATE-WRITTEN.   10/18/1995.                                      00040033
000500 DATE-COMPILED.                                                   00050033
000600*************************************************************     00060033
000700*    COBOL 2                                                *     00070033
000800*                                                           *     00080033
000900*    NON-INVOICED RECEIPT AGING REPORT BY VENDOR            *     00090034
001000*                                                           *     00100033
001100*   PROGRAM OVERVIEW:                                       *     00110033
001200*                                                           *     00120033
001300*     THIS PROGRAM CREATES THE NON-INVOICED RECEIPTS        *     00130033
001400*   AGING BY VENDOR REPORT FROM AN EXTRACT FILE PRODUCED    *     00140033
001500*   IN APKUT100.                                            *     00150033
001600*                                                           *     00160033
001700*   INPUT:                                                  *     00170033
001800*  1) NON-INVC-FILE                    (APRD042)            *     00180034
001900*                                                           *     00190033
002000*   OUTPUT:                                                 *     00200033
002100*  1) RPT01-FILE                       (DPWS150O)           *     00210034
002200*                                                           *     00220033
002300*                                                           *     00230033
002400*************************************************************     00240033
002500*   CHANGES:                                                *     00250033
002600*                                                           *     00260033
002700*   12/05/95  MARY KING                                     *     00270033
002800*    MADE MODIFICATIONS IN THE REPORT FORMAT:               *     00280033
002900*   - REVERSED THE SEQUENCE OF SETS OF COLUMNS SO THAT THE  *     00290033
003000*     NUMBER OF DAYS DESCENDS IN AGE MOVING RIGHT ACROSS    *     00300033
003100*     THE PAGE                                              *     00310033
003200*   - ADDED A VERITCAL LINE BETWEEN EACH CATEGORY TO IMPROVE*     00320033
003300*     READABILITY                                           *     00330033
003400*   - ADDED AN INDICATOR OF '**' IF THE NR IS OVER 360 DAYS *     00340033
003500*     OLD                                                   *     00350033
003600*                                                           *     00360033
003700*   02/06/95  MARY KING                                     *     00370033
003800*   - CORRECTED CALCULATION OF AGING DATES                  *     00380033
003900*                                                           *     00390033
004000*   11/10/97  CHANGE MADE:CHANGED CALL OF DATE MODULE FOR   *     00400033
004100*             Y2K                                           *     00410033
004200*             MADE BY:ROBIN BERNOSKI           WR/IR #:5703 *     00420033
004300*                                                           *     00430033
004400*   06/08/98  CHANGE MADE: Y2K. REMOVE HARDCODING OF        *     00440033
004500*             CENTURY, INCREASE JULIAN DATES TO PIC 9(07)   *     00450033
004600*             TO INCLUDE CENTURY, SEPARATE JULIAN DATES     *     00460033
004700*             INTO CC YY DDD FIELDS. ADD LOGIC TO CALCULATE *     00470033
004800*             CENTURY FOR JULIAN DATES.                     *     00480033
004900*             MADE BY: CAROLYN GIFFORD         WR/IR #:6041 *     00490033
005000*                                                           *     00500033
005100*   06/08/98  CHANGE MADE: Y2K. REPLACED THE INTRANEX       *     00510033
005200*             COPYBOOK WITH APRD042.                        *     00520033
005300*             MADE BY: ROBIN BERNOSKI          WR/IR #:6041 *     00530033
005400*                                                           *     00540034
005500* 12/08/1999 JILL JUEL                       WR/IR #: WR6041*     00550034
005600*            - MODIFIED THE CHECK ON THE DATE ROUTINE TO    *     00560034
005700*              CONFORM WITH Y2K STANDARDS BY ADDING         *     00570034
005800*              DPG54-WARNING-ERROR.                         *     00580034
005900*                                                           *     00590034
006000* 02/04/2003                                                *     00600034
006100*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00610034
006200*    RENAMED APKRP100 TO BE APKRP115. UPDATED THE PGM TITLE *     00620034
006300*    TO MATCH THE SPEC TITLE.                               *     00630034
006400*    UPDATED THE FILES IN THE PROG COMMENT BLOCK.           *     00640034
006500*    INCREASED THE PO PRINT FIELD TO Z(9) AND ADDED         *     00650039
006600*    PV-PO-NBR TO BE USED AS A BREAK FIELD.                 *     00660039
006700* MADE BY:  MIKE BESKE                          WR#: 23500  *     00670034
006800*                                                           *     00680040
006900* 05/21/2004  CHANGED MADE: STORE CONSTRAINTS PROJECT       *     00690040
007000*             RECOMPILED THIS PROGRAM TO PICK UP THE APRD042*     00700040
007100*             COPYBOOK MODIFICATIONS.                       *     00710040
007200*             MADE BY: MIKE BESKE             WR/IR #:25805 *     00720040
007100*                                                           *     00721041
006700* 09/10/2021  CHANGED MADE: RECOMPILE FOR NEW APRD042       *     00722041
007000*             MADE BY: JEAN KURK              CHG0260549    *     00723041
007300*************************************************************     00730033
007400/                                                                 00740033
007500 ENVIRONMENT DIVISION.                                            00750033
007600 CONFIGURATION SECTION.                                           00760033
007700 INPUT-OUTPUT SECTION.                                            00770033
007800 FILE-CONTROL.                                                    00780033
007900                                                                  00790033
008000     SELECT NON-INVC-FILE        ASSIGN TO UT-S-INP01.            00800033
008100     SELECT RPT01-FILE           ASSIGN TO UT-S-RPT01.            00810033
008200                                                                  00820033
008300 DATA DIVISION.                                                   00830033
008400 FILE SECTION.                                                    00840033
008500 FD  NON-INVC-FILE                                                00850033
008600     RECORDING MODE IS F                                          00860033
008700     LABEL RECORDS ARE STANDARD                                   00870033
008800     BLOCK CONTAINS 0 RECORDS                                     00880033
008900     DATA RECORD IS NON-INVC-RECORD.                              00890033
009000 01  NON-INVC-RECORD             PIC  X(120).                     00900033
009100                                                                  00910033
009200 FD  RPT01-FILE                                                   00920033
009300     RECORDING MODE IS F                                          00930033
009400     LABEL RECORDS ARE STANDARD                                   00940033
009500     BLOCK CONTAINS 0 RECORDS                                     00950033
009600     DATA RECORD IS RPT01-RECORD.                                 00960033
009700 01  RPT01-RECORD                PIC  X(150).                     00970033
009800                                                                  00980033
009900 EJECT                                                            00990033
010000 WORKING-STORAGE SECTION.                                         01000033
010100                                                                  01010033
010200 01  PROGRAM-CONSTANTS.                                           01020033
010300     05  PC-MAX-LINES            PIC S9(05)   COMP-3  VALUE +60.  01030033
010400                                                                  01040033
010500 01  PROGRAM-WORKAREA.                                            01050033
010600     05  FILLER                  PIC  X(30)           VALUE       01060033
010700         '** BEGINING OF APKRP115 W/S **'.                        01070033
010800                                                                  01080033
010900     05  PV-CURRENT-PARAGRAPH    PIC  X(30)           VALUE SPACE.01090033
011000     05  PV-PROGRAM-NAME         PIC  X(08)           VALUE       01100033
011100         'APKRP115'.                                              01110033
011200     05  DB2-RETRY-MAX           PIC S9(04)    COMP   VALUE +3.   01120033
011300                                                                  01130033
011400     05  PV-PO-NBR               PIC  9(09)    VALUE ZERO.        01140038
011500                                                                  01150038
011600     05  PV-YYYY-MM-DD.                                           01160033
011700         10  PV-CHECK-DATE       PIC X(10) VALUE SPACES.          01170033
011800                                                                  01180033
011900     05  PV-CURRENT-DATE.                                         01190033
012000         10  PV-CURRENT-YEAR     PIC  9(02)           VALUE 0.    01200033
012100         10  PV-CURRENT-MONTH    PIC  9(02)           VALUE 0.    01210033
012200         10  PV-CURRENT-DAY      PIC  9(02)           VALUE 0.    01220033
012300                                                                  01230033
012400     05  PV-CURRENT-JULIAN.                                       01240033
012500         10 PV-CURRENT-JUL-YY    PIC  9(02) VALUE 0.              01250033
012600         10 PV-CURRENT-JUL-DDD   PIC  9(03) VALUE 0.              01260033
012700     05  PV-CURRENT-JULIAN-CCYYDDD.                               01270033
012800         10 PV-CURRENT-JUL-CC    PIC  9(02) VALUE 0.              01280033
012900         10 PV-CURRENT-JUL-YYDDD PIC  9(05) VALUE 0.              01290033
013000                                                                  01300033
013100     05  PV-CURR-DATE-MINUS-60   PIC 9(07)            VALUE 0.    01310033
013200     05  PV-CURR-DT-MINUS-60-CH REDEFINES                         01320033
013300               PV-CURR-DATE-MINUS-60   PIC X(07).                 01330033
013400     05  PV-CURR-DATE-MINUS-90   PIC 9(07)            VALUE 0.    01340033
013500     05  PV-CURR-DT-MINUS-90-CH REDEFINES                         01350033
013600               PV-CURR-DATE-MINUS-90   PIC X(07).                 01360033
013700     05  PV-CURR-DATE-MINUS-120  PIC 9(07)            VALUE 0.    01370033
013800     05  PV-CURR-DT-MINUS-120-CH REDEFINES                        01380033
013900               PV-CURR-DATE-MINUS-120  PIC X(07).                 01390033
014000     05  PV-CURR-DATE-MINUS-180  PIC 9(07)            VALUE 0.    01400033
014100     05  PV-CURR-DT-MINUS-180-CH REDEFINES                        01410033
014200               PV-CURR-DATE-MINUS-180  PIC X(07).                 01420033
014300     05  PV-CURR-DATE-MINUS-360  PIC 9(07)            VALUE 0.    01430033
014400     05  PV-CURR-DT-MINUS-360-CH REDEFINES                        01440033
014500               PV-CURR-DATE-MINUS-360  PIC X(07).                 01450033
014600                                                                  01460033
014700     05  WS-COMPARE-CCYYDDD            PIC 9(07)      VALUE 0.    01470033
014800                                                                  01480033
014900     05  PV-CURRENT-TIME.                                         01490033
015000         10  PV-CURRENT-HOUR     PIC  9(02)           VALUE 0.    01500033
015100         10  PV-CURRENT-MINUTE   PIC  9(02)           VALUE 0.    01510033
015200         10  FILLER              PIC  9(02)           VALUE 0.    01520033
015300                                                                  01530033
015400 01  ACCUM-FIELDS.                                                01540033
015500     05  DTL-FIELDS.                                              01550033
015600         10  DTL-COST-0          PIC S9(08)V99 COMP-3 VALUE +0.   01560033
015700         10  DTL-COST-61         PIC S9(08)V99 COMP-3 VALUE +0.   01570033
015800         10  DTL-COST-91         PIC S9(08)V99 COMP-3 VALUE +0.   01580033
015900         10  DTL-COST-121        PIC S9(08)V99 COMP-3 VALUE +0.   01590033
016000         10  DTL-COST-181        PIC S9(08)V99 COMP-3 VALUE +0.   01600033
016100         10  DTL-RETAIL-0        PIC S9(08)V99 COMP-3 VALUE +0.   01610033
016200         10  DTL-RETAIL-61       PIC S9(08)V99 COMP-3 VALUE +0.   01620033
016300         10  DTL-RETAIL-91       PIC S9(08)V99 COMP-3 VALUE +0.   01630033
016400         10  DTL-RETAIL-121      PIC S9(08)V99 COMP-3 VALUE +0.   01640033
016500         10  DTL-RETAIL-181      PIC S9(08)V99 COMP-3 VALUE +0.   01650033
016600     05  TOT-FIELDS.                                              01660033
016700         10  TOT-COST-0          PIC S9(09)V99 COMP-3 VALUE +0.   01670033
016800         10  TOT-COST-61         PIC S9(09)V99 COMP-3 VALUE +0.   01680033
016900         10  TOT-COST-91         PIC S9(09)V99 COMP-3 VALUE +0.   01690033
017000         10  TOT-COST-121        PIC S9(09)V99 COMP-3 VALUE +0.   01700033
017100         10  TOT-COST-181        PIC S9(09)V99 COMP-3 VALUE +0.   01710033
017200         10  TOT-RETAIL-0        PIC S9(09)V99 COMP-3 VALUE +0.   01720033
017300         10  TOT-RETAIL-61       PIC S9(09)V99 COMP-3 VALUE +0.   01730033
017400         10  TOT-RETAIL-91       PIC S9(09)V99 COMP-3 VALUE +0.   01740033
017500         10  TOT-RETAIL-121      PIC S9(09)V99 COMP-3 VALUE +0.   01750033
017600         10  TOT-RETAIL-181      PIC S9(09)V99 COMP-3 VALUE +0.   01760033
017700     05  GR-TOT-FIELDS.                                           01770033
017800         10  GR-TOT-COST-0       PIC S9(09)V99 COMP-3 VALUE +0.   01780033
017900         10  GR-TOT-COST-61      PIC S9(09)V99 COMP-3 VALUE +0.   01790033
018000         10  GR-TOT-COST-91      PIC S9(09)V99 COMP-3 VALUE +0.   01800033
018100         10  GR-TOT-COST-121     PIC S9(09)V99 COMP-3 VALUE +0.   01810033
018200         10  GR-TOT-COST-181     PIC S9(09)V99 COMP-3 VALUE +0.   01820033
018300         10  GR-TOT-RETAIL-0     PIC S9(09)V99 COMP-3 VALUE +0.   01830033
018400         10  GR-TOT-RETAIL-61    PIC S9(09)V99 COMP-3 VALUE +0.   01840033
018500         10  GR-TOT-RETAIL-91    PIC S9(09)V99 COMP-3 VALUE +0.   01850033
018600         10  GR-TOT-RETAIL-121   PIC S9(09)V99 COMP-3 VALUE +0.   01860033
018700         10  GR-TOT-RETAIL-181   PIC S9(09)V99 COMP-3 VALUE +0.   01870033
018800                                                                  01880033
018900 01  PRINT-FIELDS.                                                01890033
019000     05  PV-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01900033
019100     05  PV-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   01910033
019200                                                                  01920033
019300 01  PROGRAM-SWITCHES-SUBS.                                       01930033
019400     05  PV-EOF-SW               PIC  X(01)           VALUE 'N'.  01940033
019500         88  EOF                 VALUE 'Y'.                       01950033
019600     05  PV-DATE-SW              PIC  X(01)           VALUE 'N'.  01960033
019700         88  VALID-DATE          VALUE 'Y'.                       01970033
019800         88  NOT-VALID-DATE      VALUE 'N'.                       01980033
019900                                                                  01990033
020000 EJECT                                                            02000033
020100*  INPUT RECORD AREA                                              02010033
020200                                                                  02020033
020300     COPY APRD042.                                                02030033
020400                                                                  02040033
020500 EJECT                                                            02050033
020600*  PRINT AREA                                                     02060033
020700                                                                  02070033
020800     COPY DPWS150O.                                               02080033
020900                                                                  02090033
021000 01  HDR-LINE2.                                                   02100033
021100     05  FILLER                  PIC  X(57)   VALUE SPACES.       02110033
021200     05  HL2-TITLE               PIC  X(37)   VALUE               02120033
021300         'NON-INVOICED RECEIPTS AGING BY VENDOR'.                 02130033
021400     05  FILLER                  PIC  X(56)   VALUE SPACES.       02140033
021500                                                                  02150033
021600 01  HDR-LINE3.                                                   02160033
021700     05  FILLER                  PIC  X(13)    VALUE              02170033
021800         'VENDOR NAME: '.                                         02180033
021900     05  HDR3-VENDOR-NAME        PIC  X(30)    VALUE SPACE.       02190033
022000     05  FILLER                  PIC  X(02)    VALUE SPACE.       02200033
022100     05  FILLER                  PIC  X(15)    VALUE              02210033
022200         'VENDOR NUMBER: '.                                       02220033
022300     05  HDR3-VENDOR-NBR         PIC  X(09)    VALUE SPACE.       02230033
022400     05  FILLER                  PIC  X(86)    VALUE SPACE.       02240033
022500                                                                  02250033
022600 01  HDR-LINE4.                                                   02260033
022700     05  FILLER                  PIC  X(10)    VALUE              02270033
022800         '  PO NBR  '.                                            02280033
022900     05  FILLER                  PIC  X(28)    VALUE              02290033
023000         '           OVER 180 DAYS    '.                          02300033
023100     05  FILLER                  PIC  X(28)    VALUE              02310033
023200         '          121 - 180 DAYS    '.                          02320033
023300     05  FILLER                  PIC  X(28)    VALUE              02330033
023400         '           91 - 120 DAYS    '.                          02340033
023500     05  FILLER                  PIC  X(28)    VALUE              02350033
023600         '           61 - 90 DAYS     '.                          02360033
023700     05  FILLER                  PIC  X(28)    VALUE              02370033
023800         '            0 - 60 DAYS     '.                          02380033
023900                                                                  02390033
024000 01  HDR-LINE5.                                                   02400033
024100     05  FILLER                  PIC  X(10)    VALUE SPACE.       02410033
024200     05  FILLER                  PIC  X(28)    VALUE              02420033
024300         '        COST        RETAIL  '.                          02430033
024400     05  FILLER                  PIC  X(28)    VALUE              02440033
024500         '        COST        RETAIL  '.                          02450033
024600     05  FILLER                  PIC  X(28)    VALUE              02460033
024700         '        COST        RETAIL  '.                          02470033
024800     05  FILLER                  PIC  X(28)    VALUE              02480033
024900         '        COST        RETAIL  '.                          02490033
025000     05  FILLER                  PIC  X(28)    VALUE              02500033
025100         '        COST        RETAIL  '.                          02510033
025200                                                                  02520033
025300 01  DETAIL-LINE.                                                 02530033
025400     05  DL-PO-NBR               PIC  Z(09)    VALUE ZERO.        02540038
025500     05  DL-OLD-IND              PIC  X(02)    VALUE SPACES.      02550033
025600     05  FILLER                  PIC  X(01)    VALUE SPACES.      02560033
025700     05  DL-COST-181             PIC  ZZZZZZZZ.99-                02570033
025800                                               BLANK WHEN ZERO.   02580033
025900     05  FILLER                  PIC  X(02)    VALUE SPACES.      02590033
026000     05  DL-RETAIL-181           PIC  ZZZZZZZZ.99-                02600033
026100                                               BLANK WHEN ZERO.   02610033
026200     05  FILLER                  PIC  X(02)    VALUE '| '.        02620033
026300     05  DL-COST-121             PIC  ZZZZZZZZ.99-                02630033
026400                                               BLANK WHEN ZERO.   02640033
026500     05  FILLER                  PIC  X(02)    VALUE SPACES.      02650033
026600     05  DL-RETAIL-121           PIC  ZZZZZZZZ.99-                02660033
026700                                               BLANK WHEN ZERO.   02670033
026800     05  FILLER                  PIC  X(02)    VALUE '| '.        02680033
026900     05  DL-COST-91              PIC  ZZZZZZZZ.99-                02690033
027000                                               BLANK WHEN ZERO.   02700033
027100     05  FILLER                  PIC  X(02)    VALUE SPACES.      02710033
027200     05  DL-RETAIL-91            PIC  ZZZZZZZZ.99-                02720033
027300                                               BLANK WHEN ZERO.   02730033
027400     05  FILLER                  PIC  X(02)    VALUE '| '.        02740033
027500     05  DL-COST-61              PIC  ZZZZZZZZ.99-                02750033
027600                                               BLANK WHEN ZERO.   02760033
027700     05  FILLER                  PIC  X(02)    VALUE SPACES.      02770033
027800     05  DL-RETAIL-61            PIC  ZZZZZZZZ.99-                02780033
027900                                               BLANK WHEN ZERO.   02790033
028000     05  FILLER                  PIC  X(02)    VALUE '| '.        02800033
028100     05  DL-COST-0               PIC  ZZZZZZZZ.99-                02810033
028200                                               BLANK WHEN ZERO.   02820033
028300     05  FILLER                  PIC  X(02)    VALUE SPACES.      02830033
028400     05  DL-RETAIL-0             PIC  ZZZZZZZZ.99-                02840033
028500                                               BLANK WHEN ZERO.   02850033
028600                                                                  02860033
028700 01  TOTAL-LINE.                                                  02870033
028800     05  FILLER                  PIC  X(03)    VALUE SPACES.      02880033
028900     05  FILLER                  PIC  X(07)    VALUE              02890033
029000         'TOTAL: '.                                               02900033
029100     05  FILLER                  PIC  X(01)    VALUE SPACES.      02910033
029200     05  TL-COST-181             PIC  ZZZZZZZZZ.99-               02920033
029300                                               BLANK WHEN ZERO.   02930033
029400     05  FILLER                  PIC  X(01)    VALUE SPACES.      02940033
029500     05  TL-RETAIL-181           PIC  ZZZZZZZZZ.99-               02950033
029600                                               BLANK WHEN ZERO.   02960033
029700     05  FILLER                  PIC  X(01)    VALUE '|'.         02970033
029800     05  TL-COST-121             PIC  ZZZZZZZZZ.99-               02980033
029900                                               BLANK WHEN ZERO.   02990033
030000     05  FILLER                  PIC  X(01)    VALUE SPACES.      03000033
030100     05  TL-RETAIL-121           PIC  ZZZZZZZZZ.99-               03010033
030200                                               BLANK WHEN ZERO.   03020033
030300     05  FILLER                  PIC  X(01)    VALUE '|'.         03030033
030400     05  TL-COST-91              PIC  ZZZZZZZZZ.99-               03040033
030500                                               BLANK WHEN ZERO.   03050033
030600     05  FILLER                  PIC  X(01)    VALUE SPACES.      03060033
030700     05  TL-RETAIL-91            PIC  ZZZZZZZZZ.99-               03070033
030800                                               BLANK WHEN ZERO.   03080033
030900     05  FILLER                  PIC  X(01)    VALUE '|'.         03090033
031000     05  TL-COST-61              PIC  ZZZZZZZZZ.99-               03100033
031100                                               BLANK WHEN ZERO.   03110033
031200     05  FILLER                  PIC  X(01)    VALUE SPACES.      03120033
031300     05  TL-RETAIL-61            PIC  ZZZZZZZZZ.99-               03130033
031400                                               BLANK WHEN ZERO.   03140033
031500     05  FILLER                  PIC  X(01)    VALUE '|'.         03150033
031600     05  TL-COST-0               PIC  ZZZZZZZZZ.99-               03160033
031700                                               BLANK WHEN ZERO.   03170033
031800     05  FILLER                  PIC  X(01)    VALUE SPACES.      03180033
031900     05  TL-RETAIL-0             PIC  ZZZZZZZZZ.99-               03190033
032000                                               BLANK WHEN ZERO.   03200033
032100                                                                  03210033
032200 01  DASH-LINE.                                                   03220033
032300     05  FILLER                  PIC  X(150)   VALUE ALL '-'.     03230033
032400                                                                  03240033
032500 01  BLANK-LINE.                                                  03250033
032600     05  FILLER                  PIC  X(38)    VALUE SPACES.      03260033
032700     05  FILLER                  PIC  X(01)    VALUE '|'.         03270033
032800     05  FILLER                  PIC  X(27)    VALUE SPACES.      03280033
032900     05  FILLER                  PIC  X(01)    VALUE '|'.         03290033
033000     05  FILLER                  PIC  X(27)    VALUE SPACES.      03300033
033100     05  FILLER                  PIC  X(01)    VALUE '|'.         03310033
033200     05  FILLER                  PIC  X(27)    VALUE SPACES.      03320033
033300     05  FILLER                  PIC  X(01)    VALUE '|'.         03330033
033400     05  FILLER                  PIC  X(27)    VALUE SPACES.      03340033
033500                                                                  03350033
033600 01  EOR-END-OF-REPORT.                                           03360033
033700     05  FILLER                  PIC  X(52)  VALUE SPACES.        03370033
033800     05  FILLER                  PIC  X(80)  VALUE                03380033
033900         '*****  END OF REPORT *****'.                            03390033
034000                                                                  03400033
034100*** GREGORIAN/JULIAN DATE CONVERSION                              03410033
034200     COPY DPWS500.                                                03420033
034300                                                                  03430033
034400 EJECT                                                            03440033
034500*----------------------------------------------------------------*03450033
034600*  ABEND DATA AREAS                                              *03460033
034700*----------------------------------------------------------------*03470033
034800 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          03480033
034900                                             COMP SYNC.           03490033
035000     88  AC-BAD-DATA                         VALUE +4003.         03500033
035100     88  AC-DATE-ERROR                       VALUE +4019.         03510033
035200                                                                  03520033
035300                                                                  03530033
035400 01  ABEND-AREAS.                                                 03540033
035500     05  AA-ABEND-LIT            PIC  X(40)  VALUE                03550033
035600             '*****       ABEND'.                                 03560033
035700     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                03570033
035800             '*****   PROGRAM: APKRP115'.                         03580033
035900     05  AA-PARAGRAPH-LIT.                                        03590033
036000         10  FILLER              PIC  X(17)  VALUE                03600033
036100             '***** PARAGRAPH: '.                                 03610033
036200         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        03620033
036300     05  AA-MESSAGE-LINE.                                         03630033
036400         10  FILLER              PIC  X(06)  VALUE '*****'.       03640033
036500         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        03650033
036600                                                                  03660033
036700 01  FILLER                      PIC  X(25)  VALUE                03670033
036800     '** END OF APKRP115 W/S **'.                                 03680033
036900                                                                  03690033
037000 EJECT                                                            03700033
037100 PROCEDURE DIVISION.                                              03710033
037200                                                                  03720033
037300***************************************************************** 03730033
037400*  MAIN PARAGRAPH                                                 03740033
037500***************************************************************** 03750033
037600 0000-MAIN.                                                       03760033
037700                                                                  03770033
037800     MOVE '0000-MAIN'            TO   PV-CURRENT-PARAGRAPH.       03780033
037900                                                                  03790033
038000     PERFORM 1000-BEGIN-PROGRAM.                                  03800033
038100                                                                  03810033
038200     PERFORM 2000-PROCESS-DATA UNTIL EOF.                         03820033
038300                                                                  03830033
038400     PERFORM 9200-END-PROGRAM.                                    03840033
038500                                                                  03850033
038600     GOBACK.                                                      03860033
038700                                                                  03870033
038800 EJECT                                                            03880033
038900***************************************************************** 03890033
039000*  BEGIN PROGRAM STUFF                                            03900033
039100***************************************************************** 03910033
039200 1000-BEGIN-PROGRAM.                                              03920033
039300                                                                  03930033
039400     MOVE '1000-BEGIN-PROGRAM'   TO   PV-CURRENT-PARAGRAPH.       03940033
039500                                                                  03950033
039600     OPEN INPUT  NON-INVC-FILE                                    03960033
039700          OUTPUT RPT01-FILE.                                      03970033
039800                                                                  03980033
039900     ACCEPT PV-CURRENT-JULIAN    FROM DAY.                        03990033
040000     MOVE PV-CURRENT-JULIAN  TO PV-CURRENT-JUL-YYDDD.             04000033
040100     IF PV-CURRENT-JUL-YY > 80                                    04010033
040200        MOVE 19 TO PV-CURRENT-JUL-CC                              04020033
040300     ELSE                                                         04030033
040400        MOVE 20 TO PV-CURRENT-JUL-CC.                             04040033
040500                                                                  04050033
040600     PERFORM 1100-CALC-OLD-DATES.                                 04060033
040700                                                                  04070033
040800     ACCEPT PV-CURRENT-DATE      FROM DATE.                       04080033
040900     MOVE PV-CURRENT-MONTH       TO   DP150O-RUN-MONTH.           04090033
041000     MOVE PV-CURRENT-DAY         TO   DP150O-RUN-DAY.             04100033
041100     MOVE PV-CURRENT-YEAR        TO   DP150O-RUN-YEAR.            04110033
041200                                                                  04120033
041300     ACCEPT PV-CURRENT-TIME      FROM TIME.                       04130033
041400     MOVE PV-CURRENT-HOUR        TO   DP150O-RUN-HOUR.            04140033
041500     MOVE PV-CURRENT-MINUTE      TO   DP150O-RUN-MINUTE.          04150033
041600                                                                  04160033
041700     MOVE PV-PROGRAM-NAME        TO   DP150O-PROGRAM-NAME.        04170033
041800     MOVE 1                      TO   DP150O-REPORT-NUMBER.       04180033
041900                                                                  04190033
042000     MOVE 99                     TO   PV-LINE-COUNT.              04200033
042100                                                                  04210033
042200     PERFORM 8000-READ-NON-INVC-FILE.                             04220033
042300     MOVE AP042-ENT-NM-DESC      TO   HDR3-VENDOR-NAME.           04230033
042400     MOVE AP042-VND-NBR          TO   HDR3-VENDOR-NBR.            04240033
042500     MOVE AP042-PO-NBR           TO   PV-PO-NBR.                  04250038
042600                                                                  04260033
042700                                                                  04270033
042800***************************************************************** 04280033
042900*  CALCULATES DATES 60, 90, 120, 180, AND 360 DAYS PAST TO BE     04290033
043000*  USED IN DATE COMPARISONS FOR AGING.                            04300033
043100***************************************************************** 04310033
043200 1100-CALC-OLD-DATES.                                             04320033
043300                                                                  04330033
043400* CALCULATE 60 DAYS AGO                                           04340033
043500     MOVE SPACES                    TO PV-DATE-SW.                04350033
043600     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04360033
043700     SET DPG51-ACTUAL-CALENDAR-ONLY                               04370033
043800         DPG51-DECREMENT-DATE                                     04380033
043900                                                                  04390033
044000         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      04400033
044100     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       04410033
044200     MOVE 60                        TO DPG51-INCR-DECR-DAYS-9.    04420033
044300     PERFORM 4000-DATE-ROUTINE.                                   04430033
044400     IF VALID-DATE                                                04440033
044500         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-60-CH 04450033
044600     ELSE                                                         04460033
044700         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        04470033
044800         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          04480033
044900         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 60'     04490033
045000                                    TO AA-MESSAGE                 04500033
045100         SET AC-DATE-ERROR          TO TRUE                       04510033
045200         PERFORM 9999-ABEND                                       04520033
045300     END-IF.                                                      04530033
045400                                                                  04540033
045500* CALCULATE 90 DAYS AGO                                           04550033
045600     MOVE SPACES                    TO PV-DATE-SW.                04560033
045700     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04570033
045800     SET DPG51-ACTUAL-CALENDAR-ONLY                               04580033
045900         DPG51-DECREMENT-DATE                                     04590033
046000**       DPG52-LK-DTE-JULIAN        TO TRUE.                      04600033
046100         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      04610033
046200     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       04620033
046300     MOVE 90                        TO DPG51-INCR-DECR-DAYS-9.    04630033
046400     PERFORM 4000-DATE-ROUTINE.                                   04640033
046500     IF VALID-DATE                                                04650033
046600**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-90      04660033
046700         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-90-CH 04670033
046800     ELSE                                                         04680033
046900         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        04690033
047000         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          04700033
047100         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 90'     04710033
047200                                    TO AA-MESSAGE                 04720033
047300         SET AC-DATE-ERROR          TO TRUE                       04730033
047400         PERFORM 9999-ABEND                                       04740033
047500     END-IF.                                                      04750033
047600                                                                  04760033
047700* CALCULATE 120 DAYS AGO                                          04770033
047800     MOVE SPACES                    TO PV-DATE-SW.                04780033
047900     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         04790033
048000     SET DPG51-ACTUAL-CALENDAR-ONLY                               04800033
048100         DPG51-DECREMENT-DATE                                     04810033
048200**       DPG52-LK-DTE-JULIAN        TO TRUE.                      04820033
048300         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      04830033
048400     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       04840033
048500     MOVE 120                       TO DPG51-INCR-DECR-DAYS-9.    04850033
048600     PERFORM 4000-DATE-ROUTINE.                                   04860033
048700     IF VALID-DATE                                                04870033
048800**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-120     04880033
048900         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-120-CH04890033
049000     ELSE                                                         04900033
049100         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        04910033
049200         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          04920033
049300         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 120'    04930033
049400                                    TO AA-MESSAGE                 04940033
049500         SET AC-DATE-ERROR          TO TRUE                       04950033
049600         PERFORM 9999-ABEND                                       04960033
049700     END-IF.                                                      04970033
049800                                                                  04980033
049900* CALCULATE 180 DAYS AGO                                          04990033
050000     MOVE SPACES                    TO PV-DATE-SW.                05000033
050100     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         05010033
050200     SET DPG51-ACTUAL-CALENDAR-ONLY                               05020033
050300         DPG51-DECREMENT-DATE                                     05030033
050400**       DPG52-LK-DTE-JULIAN        TO TRUE.                      05040033
050500         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      05050033
050600     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       05060033
050700     MOVE 180                       TO DPG51-INCR-DECR-DAYS-9.    05070033
050800     PERFORM 4000-DATE-ROUTINE.                                   05080033
050900     IF VALID-DATE                                                05090033
051000**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-180     05100033
051100         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-180-CH05110033
051200     ELSE                                                         05120033
051300         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        05130033
051400         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          05140033
051500         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 180'    05150033
051600                                    TO AA-MESSAGE                 05160033
051700         SET AC-DATE-ERROR          TO TRUE                       05170033
051800         PERFORM 9999-ABEND                                       05180033
051900     END-IF.                                                      05190033
052000                                                                  05200033
052100* CALCULATE 360 DAYS AGO                                          05210033
052200     MOVE SPACES                    TO PV-DATE-SW.                05220033
052300     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         05230033
052400     SET DPG51-ACTUAL-CALENDAR-ONLY                               05240033
052500         DPG51-DECREMENT-DATE                                     05250033
052600**       DPG52-LK-DTE-JULIAN        TO TRUE.                      05260033
052700         DPG52-LK-DTE-JULIAN-CC     TO TRUE.                      05270033
052800     MOVE PV-CURRENT-JULIAN-CCYYDDD TO DPG52-LK-DATE-INPUT.       05280033
052900     MOVE 360                       TO DPG51-INCR-DECR-DAYS-9.    05290033
053000     PERFORM 4000-DATE-ROUTINE.                                   05300033
053100     IF VALID-DATE                                                05310033
053200**       MOVE DPG55-JULIAN-DATE-N   TO PV-CURR-DATE-MINUS-360     05320033
053300         MOVE DPG55-JULIAN-DATE-CCYYDDD TO PV-CURR-DT-MINUS-360-CH05330033
053400     ELSE                                                         05340033
053500         DISPLAY 'JULIAN DATE '  PV-CURRENT-JULIAN-CCYYDDD        05350033
053600         MOVE '1100-CALC-OLD-DATES' TO AA-PARAGRAPH-NAME          05360033
053700         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE MINUS 360'    05370033
053800                                    TO AA-MESSAGE                 05380033
053900         SET AC-DATE-ERROR          TO TRUE                       05390033
054000         PERFORM 9999-ABEND                                       05400033
054100     END-IF.                                                      05410033
054200                                                                  05420033
054300 EJECT                                                            05430033
054400***************************************************************** 05440033
054500*  MAIN PROGRAM LOOP                                              05450033
054600*                                                                 05460033
054700*  CALLED FROM 0000-MAIN                                          05470033
054800***************************************************************** 05480033
054900 2000-PROCESS-DATA.                                               05490033
055000                                                                  05500033
055100     MOVE '2000-PROCESS-DATA'    TO   PV-CURRENT-PARAGRAPH.       05510033
055200                                                                  05520033
055300*  PROCESS INPUT RECORD                                           05530033
055400                                                                  05540033
055500     IF AP042-ENT-NM-DESC NOT = HDR3-VENDOR-NAME                  05550033
055600        PERFORM 3000-PROCESS-DETAIL                               05560033
055700        PERFORM 3100-PROCESS-VENDOR                               05570033
055800        MOVE AP042-ENT-NM-DESC     TO   HDR3-VENDOR-NAME          05580033
055900        MOVE AP042-VND-NBR          TO   HDR3-VENDOR-NBR          05590033
056000        MOVE AP042-PO-NBR           TO   PV-PO-NBR                05600038
056100                                                                  05610033
056200        IF (PV-LINE-COUNT + 2) > PC-MAX-LINES                     05620033
056300           PERFORM 9000-WRITE-HEADING                             05630033
056400        ELSE                                                      05640033
056500          WRITE RPT01-RECORD FROM DASH-LINE AFTER 1               05650033
056600          WRITE RPT01-RECORD FROM HDR-LINE3 AFTER 1               05660033
056700          ADD +2                    TO PV-LINE-COUNT              05670033
056800        END-IF                                                    05680033
056900     ELSE                                                         05690033
057000        IF AP042-PO-NBR NOT  = PV-PO-NBR                          05700038
057100           PERFORM 3000-PROCESS-DETAIL                            05710033
057200           MOVE AP042-PO-NBR        TO   PV-PO-NBR                05720038
057300        END-IF                                                    05730033
057400     END-IF.                                                      05740033
057500                                                                  05750033
057600     SET NOT-VALID-DATE TO TRUE.                                  05760033
057700     MOVE AP042-REC-DTE                TO PV-CHECK-DATE.          05770033
057800                                                                  05780033
057900     MOVE SPACES                     TO PV-DATE-SW                05790033
058000     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56          05800033
058100     SET DPG51-ACTUAL-CALENDAR-ONLY                               05810033
058200         DPG52-LK-DTE-ISO-FMT                                     05820033
058300         DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      05830033
058400     MOVE PV-YYYY-MM-DD              TO DPG52-LK-DATE-INPUT       05840033
058500     PERFORM 4000-DATE-ROUTINE                                    05850033
058600                                                                  05860033
058700     IF VALID-DATE                                                05870033
058800          MOVE DPG55-JULIAN-DATE-CCYYDDD TO WS-COMPARE-CCYYDDD    05880033
058900        EVALUATE TRUE                                             05890033
059000          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-180        05900033
059100               PERFORM 2500-COST-181                              05910033
059200          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-120        05920033
059300               PERFORM 2400-COST-121                              05930033
059400          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-90         05940033
059500               PERFORM 2300-COST-91                               05950033
059600          WHEN WS-COMPARE-CCYYDDD < PV-CURR-DATE-MINUS-60         05960033
059700               PERFORM 2200-COST-61                               05970033
059800          WHEN OTHER                                              05980033
059900               PERFORM 2100-COST-0                                05990033
060000        END-EVALUATE                                              06000033
060100     END-IF.                                                      06010033
060200                                                                  06020033
060300*  READ NEXT INPUT RECORD                                         06030033
060400                                                                  06040033
060500     PERFORM 8000-READ-NON-INVC-FILE.                             06050033
060600                                                                  06060033
060700 2100-COST-0.                                                     06070033
060800                                                                  06080033
060900     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-0                06090033
061000                                      TOT-RETAIL-0                06100033
061100                                      GR-TOT-RETAIL-0.            06110033
061200     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-0                  06120033
061300                                      TOT-COST-0                  06130033
061400                                      GR-TOT-COST-0.              06140033
061500                                                                  06150033
061600 2200-COST-61.                                                    06160033
061700                                                                  06170033
061800     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-61               06180033
061900                                      TOT-RETAIL-61               06190033
062000                                      GR-TOT-RETAIL-61.           06200033
062100     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-61                 06210033
062200                                      TOT-COST-61                 06220033
062300                                      GR-TOT-COST-61.             06230033
062400                                                                  06240033
062500 2300-COST-91.                                                    06250033
062600                                                                  06260033
062700     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-91               06270033
062800                                      TOT-RETAIL-91               06280033
062900                                      GR-TOT-RETAIL-91.           06290033
063000     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-91                 06300033
063100                                      TOT-COST-91                 06310033
063200                                      GR-TOT-COST-91.             06320033
063300                                                                  06330033
063400 2400-COST-121.                                                   06340033
063500                                                                  06350033
063600     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-121              06360033
063700                                      TOT-RETAIL-121              06370033
063800                                      GR-TOT-RETAIL-121.          06380033
063900     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-121                06390033
064000                                      TOT-COST-121                06400033
064100                                      GR-TOT-COST-121.            06410033
064200                                                                  06420033
064300 2500-COST-181.                                                   06430033
064400                                                                  06440033
064500     ADD AP042-CALCD-VRFD-RTL-AMT TO  DTL-RETAIL-181              06450033
064600                                      TOT-RETAIL-181              06460033
064700                                      GR-TOT-RETAIL-181.          06470033
064800     ADD AP042-CALCD-VRFD-COST-AMT TO DTL-COST-181                06480033
064900                                      TOT-COST-181                06490033
065000                                      GR-TOT-COST-181.            06500033
065100                                                                  06510033
065200     IF DPG55-JULIAN-DATE-CCYYDDD < PV-CURR-DATE-MINUS-360        06520033
065300        MOVE '**'     TO DL-OLD-IND                               06530033
065400     END-IF.                                                      06540033
065500                                                                  06550033
065600 EJECT                                                            06560033
065700 3000-PROCESS-DETAIL.                                             06570033
065800                                                                  06580033
065900     MOVE PV-PO-NBR      TO DL-PO-NBR.                            06590038
066000                                                                  06600038
066100     MOVE DTL-COST-0     TO DL-COST-0.                            06610033
066200     MOVE DTL-COST-61    TO DL-COST-61.                           06620033
066300     MOVE DTL-COST-91    TO DL-COST-91.                           06630033
066400     MOVE DTL-COST-121   TO DL-COST-121.                          06640033
066500     MOVE DTL-COST-181   TO DL-COST-181.                          06650033
066600                                                                  06660033
066700     MOVE DTL-RETAIL-0   TO DL-RETAIL-0.                          06670033
066800     MOVE DTL-RETAIL-61  TO DL-RETAIL-61.                         06680033
066900     MOVE DTL-RETAIL-91  TO DL-RETAIL-91.                         06690033
067000     MOVE DTL-RETAIL-121 TO DL-RETAIL-121.                        06700033
067100     MOVE DTL-RETAIL-181 TO DL-RETAIL-181.                        06710033
067200                                                                  06720033
067300     IF PV-LINE-COUNT > PC-MAX-LINES                              06730033
067400        PERFORM 9000-WRITE-HEADING                                06740033
067500     END-IF.                                                      06750033
067600                                                                  06760033
067700     WRITE RPT01-RECORD FROM DETAIL-LINE                          06770033
067800        AFTER ADVANCING 1 LINES.                                  06780033
067900     ADD +1            TO PV-LINE-COUNT.                          06790033
068000                                                                  06800033
068100     INITIALIZE DTL-FIELDS                                        06810033
068200                DETAIL-LINE.                                      06820033
068300                                                                  06830033
068400 3100-PROCESS-VENDOR.                                             06840033
068500                                                                  06850033
068600     MOVE TOT-COST-0     TO TL-COST-0.                            06860033
068700     MOVE TOT-COST-61    TO TL-COST-61.                           06870033
068800     MOVE TOT-COST-91    TO TL-COST-91.                           06880033
068900     MOVE TOT-COST-121   TO TL-COST-121.                          06890033
069000     MOVE TOT-COST-181   TO TL-COST-181.                          06900033
069100                                                                  06910033
069200     MOVE TOT-RETAIL-0   TO TL-RETAIL-0.                          06920033
069300     MOVE TOT-RETAIL-61  TO TL-RETAIL-61.                         06930033
069400     MOVE TOT-RETAIL-91  TO TL-RETAIL-91.                         06940033
069500     MOVE TOT-RETAIL-121 TO TL-RETAIL-121.                        06950033
069600     MOVE TOT-RETAIL-181 TO TL-RETAIL-181.                        06960033
069700                                                                  06970033
069800     WRITE RPT01-RECORD FROM BLANK-LINE AFTER 1.                  06980033
069900     WRITE RPT01-RECORD FROM TOTAL-LINE AFTER 1.                  06990033
070000     ADD +2            TO PV-LINE-COUNT.                          07000033
070100                                                                  07010033
070200     INITIALIZE TOT-FIELDS.                                       07020033
070300                                                                  07030033
070400 EJECT                                                            07040033
070500*----------------------------------------------------------------*07050033
070600*    CALLS THE DATE ROUTINE MODULE.                              *07060033
070700*----------------------------------------------------------------*07070033
070800 4000-DATE-ROUTINE.                                               07080033
070900                                                                  07090033
071000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            07100033
071100         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               07110033
071200                                                                  07120033
071300     IF (DPG54-SEVERE-ERROR OR                                    07130033
071400         DPG54-WARNING-ERROR)                                     07140033
071500         SET NOT-VALID-DATE TO TRUE                               07150033
071600     ELSE                                                         07160033
071700         SET VALID-DATE TO TRUE                                   07170033
071800     END-IF.                                                      07180033
071900 EJECT                                                            07190033
072000***************************************************************** 07200033
072100*  THIS ROUTINE READS THE REPORT FILE FROM APKUP230               07210033
072200*                                                                 07220033
072300*  CALLED FROM 1000-BEGIN-PROGRAM                                 07230033
072400***************************************************************** 07240033
072500 8000-READ-NON-INVC-FILE.                                         07250033
072600                                                                  07260033
072700     MOVE '8000-READ-NON-INVC-FILE'                               07270033
072800                                 TO   PV-CURRENT-PARAGRAPH.       07280033
072900                                                                  07290033
073000     READ NON-INVC-FILE          INTO AP042-EXTRACT-FILE          07300033
073100         AT END                                                   07310033
073200             SET EOF TO TRUE.                                     07320033
073300                                                                  07330033
073400 EJECT                                                            07340033
073500***************************************************************** 07350033
073600*  REPORT AND COLUMN HEADINGS FOR BOTH REPORTS                    07360033
073700*                                                                 07370033
073800*  CALLED FROM                                                    07380033
073900***************************************************************** 07390033
074000 9000-WRITE-HEADING.                                              07400033
074100                                                                  07410033
074200     MOVE '9000-WRITE-HEADING'   TO   PV-CURRENT-PARAGRAPH.       07420033
074300                                                                  07430033
074400*  BUMP PAGE COUNT                                                07440033
074500                                                                  07450033
074600     ADD 1                       TO   PV-PAGE-COUNT.              07460033
074700     MOVE PV-PAGE-COUNT          TO   DP150O-PAGE-NUMBER.         07470033
074800                                                                  07480033
074900*  CLEAR LINE COUNT                                               07490033
075000                                                                  07500033
075100     MOVE 0                      TO   PV-LINE-COUNT.              07510033
075200                                                                  07520033
075300*  HEADING LINE 1 (STANDARD)                                      07530033
075400                                                                  07540033
075500     WRITE RPT01-RECORD FROM DP150O-STANDRD-HEADER-150-COLS       07550033
075600           AFTER ADVANCING PAGE.                                  07560033
075700                                                                  07570033
075800*  HEADING LINE 2 APPL SPECIFIC                                   07580033
075900                                                                  07590033
076000     WRITE RPT01-RECORD FROM HDR-LINE2                            07600033
076100           AFTER ADVANCING 1 LINES.                               07610033
076200                                                                  07620033
076300*  HEADING LINE 3 APPL SPECIFIC                                   07630033
076400                                                                  07640033
076500     WRITE RPT01-RECORD FROM HDR-LINE3 AFTER 2.                   07650033
076600                                                                  07660033
076700*  HEADING LINE 4 APPL SPECIFIC                                   07670033
076800                                                                  07680033
076900     WRITE RPT01-RECORD FROM HDR-LINE4                            07690033
077000           AFTER ADVANCING 1 LINES.                               07700033
077100                                                                  07710033
077200*  HEADING LINE 5 APPL SPECIFIC                                   07720033
077300                                                                  07730033
077400     WRITE RPT01-RECORD FROM HDR-LINE5                            07740033
077500           AFTER ADVANCING 1 LINES.                               07750033
077600                                                                  07760033
077700     MOVE SPACES TO RPT01-RECORD.                                 07770033
077800     WRITE RPT01-RECORD  AFTER ADVANCING 1 LINES.                 07780033
077900                                                                  07790033
078000     MOVE 7                      TO   PV-LINE-COUNT.              07800033
078100                                                                  07810033
078200 EJECT                                                            07820033
078300***************************************************************** 07830033
078400 9200-END-PROGRAM.                                                07840033
078500                                                                  07850033
078600     MOVE '9200-END-PROGRAM'     TO   PV-CURRENT-PARAGRAPH.       07860033
078700                                                                  07870033
078800     PERFORM 3000-PROCESS-DETAIL.                                 07880033
078900     PERFORM 3100-PROCESS-VENDOR.                                 07890033
079000                                                                  07900033
079100     MOVE GR-TOT-COST-0     TO TL-COST-0.                         07910033
079200     MOVE GR-TOT-COST-61    TO TL-COST-61.                        07920033
079300     MOVE GR-TOT-COST-91    TO TL-COST-91.                        07930033
079400     MOVE GR-TOT-COST-121   TO TL-COST-121.                       07940033
079500     MOVE GR-TOT-COST-181   TO TL-COST-181.                       07950033
079600                                                                  07960033
079700     MOVE GR-TOT-RETAIL-0   TO TL-RETAIL-0.                       07970033
079800     MOVE GR-TOT-RETAIL-61  TO TL-RETAIL-61.                      07980033
079900     MOVE GR-TOT-RETAIL-91  TO TL-RETAIL-91.                      07990033
080000     MOVE GR-TOT-RETAIL-121 TO TL-RETAIL-121.                     08000033
080100     MOVE GR-TOT-RETAIL-181 TO TL-RETAIL-181.                     08010033
080200                                                                  08020033
080300     WRITE RPT01-RECORD FROM BLANK-LINE AFTER 1.                  08030033
080400     WRITE RPT01-RECORD FROM TOTAL-LINE AFTER 1.                  08040033
080500     ADD +2            TO PV-LINE-COUNT.                          08050033
080600                                                                  08060033
080700     WRITE RPT01-RECORD FROM EOR-END-OF-REPORT                    08070033
080800           AFTER ADVANCING 2 LINES.                               08080033
080900                                                                  08090033
081000 EJECT                                                            08100033
081100*----------------------------------------------------------------*08110033
081200*    ABEND ROUTINE                                               *08120033
081300*----------------------------------------------------------------*08130033
081400 9999-ABEND.                                                      08140033
081500                                                                  08150033
081600     CLOSE  NON-INVC-FILE                                         08160033
081700            RPT01-FILE.                                           08170033
081800                                                                  08180033
081900     DISPLAY AA-ABEND-LIT.                                        08190033
082000     DISPLAY AA-PROGRAM-LIT.                                      08200033
082100     DISPLAY AA-PARAGRAPH-LIT.                                    08210033
082200     DISPLAY AA-MESSAGE-LINE.                                     08220033
082300     CALL 'ILBOABN0' USING ABEND-CODE.                            08230033
