000100******************************************************************00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300******************************************************************00030002
000400                                                                  00040002
000500 PROGRAM-ID.             ARKUT109.                                00050050
000600 AUTHOR.                 JAMES ALT.                               00060002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070002
000800 DATE-WRITTEN            06/14/2013.                              00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100******************************************************************00110099
001200*  THIS PROGRAM READS IN THE EVOLVE ACTIVITY FILE RECEIVED FROM   00120099
001300*  FIRST DATA AND SELECTS ALL RECORDS WITH A PAYMENT DATE         00130099
001400*  DURING A GIVEN TIME PERIOD.  FOR EACH RECORD SELECTED, THE     00140099
001500*  CORRESPONDING ACCOUNT RECORD ON THE WORLD FILE IS READ.        00150099
001600*  USING DATA FROM BOTH THE EVOLVE ACTIVITY AND WORLD FILES, A    00160099
001700*  DELIMITED RECORD IS WRITTEN FOR PROCESSING BY A THIRD-PARTY    00170099
001800*  VENDOR. THE RECORD CONTAINS THE PAYMENT DATE, AGENT ID, THE    00180099
001900*  PAYMENT AMOUNT, 30-210 OVERDUE AMOUNTS AND CURRENT BALANCE.    00190099
002000*  THE RECORD ALSO INCLUDES SOME ADDITIONAL STATIC INFORMATION.   00200099
002100******************************************************************00210099
002200*CHANGES:                                                         00220099
002300*06/14/2013  JAMES ALT                                            00230099
002400*            CREATED PROGRAM -- CHG0056702                        00240099
002500*08/09/2013  JAMES ALT                                            00250099
002600*            SET RETURN CODE TO 4095 IF THERE IS NO OUTPUT        00260099
002700*            CHG0059980                                           00270099
002500*08/18/2015  SUSHANTO HALDER - COGNIZANT                          00271099
002600*            CHANGED FTP TO MFT IN PROGRAM                        00272099
002700*            CHG0119022                                           00273099
002800******************************************************************00280002
002900                                                                  00290002
003000******************************************************************00300002
003100 ENVIRONMENT DIVISION.                                            00310002
003200******************************************************************00320002
003300                                                                  00330002
003400 CONFIGURATION SECTION.                                           00340002
003500                                                                  00350002
003600 SOURCE-COMPUTER.        IBM-3090.                                00360002
003700 OBJECT-COMPUTER.        IBM-3090.                                00370002
003800                                                                  00380002
003900 INPUT-OUTPUT SECTION.                                            00390002
004000                                                                  00400002
004100 FILE-CONTROL.                                                    00410002
004200                                                                  00420002
004300      SELECT EVOLVE-ACTIVITY-FILE   ASSIGN TO INP01.              00430057
004400      SELECT WORLD-FILE             ASSIGN TO INP02.              00440050
004500      SELECT CONTROL-DATE-FILE      ASSIGN TO UPD01.              00450099
004600      SELECT BALANCES-MOVED-FILE    ASSIGN TO OUT01.              00460057
004700      SELECT MFT-FILE               ASSIGN TO OUT02.              00470099
004800      SELECT REPORT-FILE            ASSIGN TO RPT01.              00480099
004900                                                                  00490002
005000******************************************************************00500002
005100 DATA DIVISION.                                                   00510002
005200******************************************************************00520002
005300                                                                  00530002
005400 FILE SECTION.                                                    00540002
005500 FD  EVOLVE-ACTIVITY-FILE                                         00550057
005600     LABEL RECORDS ARE STANDARD                                   00560002
005700     RECORDING MODE IS F                                          00570007
005800     BLOCK CONTAINS 0 RECORDS                                     00580002
005900     RECORD CONTAINS 192 CHARACTERS                               00590007
006000     DATA RECORD IS PTP-RECORD.                                   00600058
006100                                                                  00610020
006200 01  PTP-RECORD                      PIC  X(192).                 00620058
006300                                                                  00630002
006400 FD  WORLD-FILE                                                   00640050
006500     LABEL RECORDS ARE STANDARD                                   00650050
006600     RECORDING MODE IS F                                          00660050
006700     BLOCK CONTAINS 0 RECORDS                                     00670050
006800     RECORD CONTAINS 764 CHARACTERS                               00680056
006900     DATA RECORD IS AR091-ACCOUNT-RECORD.                         00690058
007000                                                                  00700050
007100     COPY ARRD091.                                                00710052
007200                                                                  00720050
007300 FD  CONTROL-DATE-FILE                                            00730099
007400     LABEL RECORDS ARE STANDARD                                   00740099
007500     RECORDING MODE IS F                                          00750099
007600     BLOCK CONTAINS 0 RECORDS                                     00760099
007700     RECORD CONTAINS 80 CHARACTERS                                00770099
007800     DATA RECORD IS AR092-RECORD.                                 00780099
007900                                                                  00790099
008000     COPY ARRD092.                                                00800099
008100                                                                  00810099
008200 FD  BALANCES-MOVED-FILE                                          00820057
008300     LABEL RECORDS ARE STANDARD                                   00830002
008400     RECORDING MODE IS F                                          00840007
008500     BLOCK CONTAINS 0 RECORDS                                     00850002
008600     RECORD CONTAINS 233 CHARACTERS                               00860099
008700     DATA RECORD IS BALANCES-MOVED-RECORD.                        00870099
008800                                                                  00880002
008900 01  BALANCES-MOVED-RECORD           PIC  X(233).                 00890099
009000                                                                  00900002
009100 FD  MFT-FILE                                                     00910099
009200     LABEL RECORDS ARE STANDARD                                   00920099
009300     RECORDING MODE IS F                                          00930099
009400     BLOCK CONTAINS 0 RECORDS                                     00940099
009500     RECORD CONTAINS 80 CHARACTERS                                00950099
009600     DATA RECORD IS MFT-RECORD.                                   00960099
009700                                                                  00970099
009800 01  MFT-RECORD                      PIC  X(80).                  00980099
009900                                                                  00990099
010000 FD  REPORT-FILE                                                  01000099
010100     LABEL RECORDS ARE STANDARD                                   01010099
010200     RECORDING MODE IS F                                          01020099
010300     BLOCK CONTAINS 0 RECORDS                                     01030099
010400     RECORD CONTAINS 132 CHARACTERS                               01040099
010500     DATA RECORD IS REPORT-RECORD.                                01050099
010600                                                                  01060099
010700 01  REPORT-RECORD                   PIC  X(132).                 01070099
010800                                                                  01080099
010900*------------------------------------------------------*          01090002
011000 WORKING-STORAGE SECTION.                                         01100002
011100*------------------------------------------------------*          01110002
011200 01  ABEND-CODE                        PIC S9(4)  VALUE ZERO      01120092
011300                                                  COMP.           01130092
011400     88  ABEND-4001                               VALUE +4001.    01140092
011500     88  ABEND-4002                               VALUE +4002.    01150092
011600     88  ABEND-4003                               VALUE +4003.    01160092
011700     88  ABEND-4004                               VALUE +4004.    01170092
011800     88  ABEND-4005                               VALUE +4005.    01180099
011900                                                                  01190092
012000 01 PC-PROGRAM-CONSTANTS.                                         01200003
012100    05 PC-PAGE-SIZE                  PIC  9(04) VALUE 66.         01210099
012200    05 PC-PROGRAM-NAME               PIC  X(08) VALUE 'ARKUT109'. 01220099
012300    05 PC-MAX-ACCT                   PIC  X(16) VALUE ALL '9'.    01230084
012400    05 PV-ACTVTY-FILE-DATE           PIC  X(10) VALUE SPACE.      01240099
012500    05 PV-WORLD-FILE-DATE            PIC  X(10) VALUE SPACE.      01250099
012600    05 PC-BLANK-LINE                 PIC  X(132) VALUE SPACE.     01260099
012700                                                                  01270003
012800 01 PV-PROGRAM-VARIABLES.                                         01280002
012900    05 PV-INPUT-COUNT                PIC  9(09) VALUE ZERO.       01290099
013000    05 PV-BYPASS-COUNT               PIC  9(09) VALUE ZERO.       01300099
013100    05 PV-NOT-FOUND-COUNT            PIC  9(09) VALUE ZERO.       01310099
013200    05 PV-PROCESS-COUNT              PIC  9(09) VALUE ZERO.       01320099
013300    05 PV-TRANSACTION-COUNT          PIC  9(09) VALUE ZERO.       01330099
013400    05 PV-WRITE-COUNT                PIC  9(09) VALUE ZERO.       01340099
013500    05 PV-HEADER-COUNT               PIC  9(09) VALUE ZERO.       01350099
013600    05 PV-DETAIL-COUNT               PIC  9(09) VALUE ZERO.       01360099
013700    05 PV-TRAILER-COUNT              PIC  9(09) VALUE ZERO.       01370099
013800    05 PV-PROMISES-COUNT             PIC  9(04) VALUE ZERO.       01380099
013900    05 PV-PAGE-COUNT                 PIC  9(04) VALUE ZERO.       01390099
014000    05 PV-LINE-COUNT                 PIC  9(04) VALUE ZERO.       01400099
014100    05 PV-HDR-DT                     PIC  9(08) VALUE ZERO.       01410099
014200    05 PV-UPD-DT.                                                 01420099
014300       10 PV-UPD-YEAR                PIC  9(04) VALUE ZERO.       01430099
014400       10 PV-UPD-MONTH               PIC  9(02) VALUE ZERO.       01440099
014500       10 PV-UPD-DAY                 PIC  9(02) VALUE ZERO.       01450099
014600    05 PV-UPD-DT-FMT.                                             01460099
014700       10 PV-UPD-MONTH-FMT           PIC  9(02) VALUE ZERO.       01470099
014800       10 FILLER                     PIC  X(01) VALUE '/'.        01480099
014900       10 PV-UPD-DAY-FMT             PIC  9(02) VALUE ZERO.       01490099
015000       10 FILLER                     PIC  X(01) VALUE '/'.        01500099
015100       10 PV-UPD-YEAR-FMT            PIC  9(04) VALUE ZERO.       01510099
015200    05 PV-ABEND-PARA-NAME            PIC  X(30) VALUE SPACE.      01520099
015300    05 PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.      01530099
015400    05 PV-OPERATION-MSG-1            PIC  X(40) VALUE SPACE.      01540099
015500    05 PV-OPERATION-MSG-2            PIC  X(40) VALUE SPACE.      01550099
015600                                                                  01560066
015700 01 PV-DISPLAY-VARIABLES.                                         01570066
015800    05 PV-DISPLAY-COUNT              PIC  ZZZ,ZZZ,ZZ9.            01580054
015900    05 PV-AMT-PAID                   PIC  ZZZZZZZZZZ9.99-.        01590076
016000    05 PV-DEL-AMT-30-DAYS            PIC  ZZZZZZZZZZ9.99-.        01600076
016100    05 PV-DEL-AMT-60-DAYS            PIC  ZZZZZZZZZZ9.99-.        01610076
016200    05 PV-DEL-AMT-90-DAYS            PIC  ZZZZZZZZZZ9.99-.        01620076
016300    05 PV-DEL-AMT-120-DAYS           PIC  ZZZZZZZZZZ9.99-.        01630076
016400    05 PV-DEL-AMT-150-DAYS           PIC  ZZZZZZZZZZ9.99-.        01640076
016500    05 PV-DEL-AMT-180-DAYS           PIC  ZZZZZZZZZZ9.99-.        01650076
016600    05 PV-DEL-AMT-210-DAYS           PIC  ZZZZZZZZZZ9.99-.        01660076
016700    05 PV-CURRENT-BALANCE            PIC  ZZZZZZZZZZ9.99-.        01670076
016800                                                                  01680002
016900 01 PS-PROGRAM-SWITCHES.                                          01690002
017000    05 PS-END-OF-PTP-FILE-SW         PIC  X(01) VALUE 'N'.        01700099
017100       88 PS-END-OF-PTP-FILE                    VALUE 'Y'.        01710099
017200       88 PS-NOT-END-OF-PTP-FILE                VALUE 'N'.        01720099
017300    05 PS-END-OF-WORLD-FILE-SW       PIC  X(01) VALUE 'N'.        01730099
017400       88 PS-END-OF-WORLD-FILE                  VALUE 'Y'.        01740099
017500       88 PS-NOT-END-OF-WORLD-FILE              VALUE 'N'.        01750099
017600    05 PS-ERROR-FOUND-IND            PIC  X(01) VALUE 'N'.        01760099
017700       88 PS-ERROR-FOUND                        VALUE 'Y'.        01770099
017800       88 PS-ERROR-NOT-FOUND                    VALUE 'N'.        01780024
017900    05 PS-MATCH-FOUND-IND            PIC  X(01) VALUE ' '.        01790099
018000       88 PS-MATCH-UNKNOWN                      VALUE ' '.        01800099
018100       88 PS-MATCH-FOUND                        VALUE 'Y'.        01810063
018200       88 PS-MATCH-NOT-FOUND                    VALUE 'N'.        01820063
018300    05 PS-FIRST-TIME-IND             PIC  X(01) VALUE 'Y'.        01830099
018400       88 PS-FIRST-TIME                         VALUE 'Y'.        01840099
018500       88 PS-NOT-FIRST-TIME                     VALUE 'N'.        01850099
018600    05 PS-WRITE-HEADER-ONLY-IND      PIC  X(01) VALUE 'N'.        01860099
018700       88 PS-WRITE-HEADER-ONLY                  VALUE 'Y'.        01870099
018800       88 PS-DO-NOT-WRITE-HEADER-ONLY           VALUE 'N'.        01880099
018900                                                                  01890002
019000 01 CD-CURRENT-DATE.                                              01900099
019100    05 CD-CURRENT-YEAR               PIC  9(02) VALUE ZERO.       01910099
019200    05 CD-CURRENT-MONTH              PIC  9(02) VALUE ZERO.       01920099
019300    05 CD-CURRENT-DAY                PIC  9(02) VALUE ZERO.       01930099
019400                                                                  01940099
019500 01 CT-CURRENT-TIME.                                              01950099
019600    05 CT-CURRENT-HOUR               PIC  9(02) VALUE ZERO.       01960099
019700    05 CT-CURRENT-MINUTE             PIC  9(02) VALUE ZERO.       01970099
019800    05 CT-CURRENT-SECOND             PIC  9(02) VALUE ZERO.       01980099
019900    05 FILLER                        PIC  X(02).                  01990099
020000                                                                  02000099
020100 01 HL1-HEADING-LINE-1.                                           02010099
020200    05 FILLER                        PIC  X(49) VALUE SPACE.      02020099
020300    05 FILLER                        PIC  X(34) VALUE             02030099
020400       'ACCOUNTS NOT FOUND ON WORLD FILE'.                        02040099
020500    05 FILLER                        PIC  X(49) VALUE SPACE.      02050099
020600                                                                  02060099
020700 01 HL2-HEADING-LINE-2.                                           02070099
020800    05 FILLER                        PIC  X(16) VALUE             02080099
020900                                                ' ACCOUNT NUMBER'.02090099
021000    05 FILLER                        PIC  X(02) VALUE SPACE.      02100099
021100    05 FILLER                        PIC  X(10) VALUE             02110099
021200                                                'PYMNT DATE'.     02120099
021300    05 FILLER                        PIC  X(02) VALUE SPACE.      02130099
021400    05 FILLER                        PIC  X(08) VALUE             02140099
021500                                                'USER ID'.        02150099
021600    05 FILLER                        PIC  X(02) VALUE SPACE.      02160099
021700    05 FILLER                        PIC  X(08) VALUE SPACE.      02170099
021800    05 FILLER                        PIC  X(09) VALUE             02180099
021900                                                'PYMNT AMT'.      02190099
022000                                                                  02200099
022100 01 HL3-HEADING-LINE-3.                                           02210099
022200    05 FILLER                        PIC  X(16) VALUE ALL '-'.    02220099
022300    05 FILLER                        PIC  X(02) VALUE SPACE.      02230099
022400    05 FILLER                        PIC  X(10) VALUE ALL '-'.    02240099
022500    05 FILLER                        PIC  X(02) VALUE SPACE.      02250099
022600    05 FILLER                        PIC  X(08) VALUE ALL '-'.    02260099
022700    05 FILLER                        PIC  X(02) VALUE SPACE.      02270099
022800    05 FILLER                        PIC  X(17) VALUE ALL '-'.    02280099
022900                                                                  02290099
023000 01 DL1-DETAIL-LINE-1.                                            02300099
023100    05 DL1-ACCT                      PIC  X(16).                  02310099
023200    05 FILLER                        PIC  X(02) VALUE SPACE.      02320099
023300    05 DL1-PYMNT-DATE                PIC  X(10).                  02330099
023400    05 FILLER                        PIC  X(02) VALUE SPACE.      02340099
023500    05 DL1-OPER                      PIC  X(08).                  02350099
023600    05 FILLER                        PIC  X(02) VALUE SPACE.      02360099
023700    05 DL1-AMT-PAID                  PIC  ZZ,ZZZ,ZZZ,ZZ9.99.      02370099
023800                                                                  02380099
023900 01 FL1-FOOTER-LINE-1.                                            02390099
024000    05 FILLER                        PIC  X(13) VALUE             02400099
024100       'END OF REPORT'.                                           02410099
024200    05 FILLER                        PIC  X(119) VALUE SPACE.     02420099
024300                                                                  02430099
024400 01 PV-MFT-RECORD.                                                02440099
024500    05 FILLER                        PIC  X(17)                   02450099
024600                                     VALUE 'SET %DIR1 = %DIR1'.   02460099
024700    05 FILLER                        PIC  X(21)                   02470099
024800                             VALUE ' + "BalancesMovedRMO-'.       02480099
024900    05 MFT-DATE-TIME.                                             02490099
025000       10 MFT-DATE.                                               02500099
025100          15 FILLER                  PIC  X(02)  VALUE '20'.      02510099
025200          15 MFT-YEAR                PIC  X(02).                  02520099
025300          15 MFT-MONTH               PIC  X(02).                  02530099
025400          15 MFT-DAY                 PIC  X(02).                  02540099
025500       10 MFT-TIME.                                               02550099
025600          15 MFT-HOUR                PIC  X(02).                  02560099
025700          15 MFT-MINUTE              PIC  X(02).                  02570099
025800          15 MFT-SECOND              PIC  X(02).                  02580099
025900    05 FILLER                        PIC  X(01)  VALUE '-'.       02590099
026000    05 MFT-COUNT                     PIC  9(06)  VALUE ZERO.      02600099
026100    05 FILLER                        PIC  X(05)                   02610099
026200                                     VALUE '.csv"'.               02620099
026300    05 FILLER                        PIC  X(14)  VALUE SPACE.     02630099
026400                                                                  02640099
026500     COPY ARRD090.                                                02650099
026600                                                                  02660020
026700     COPY DPWS500.                                                02670023
026800                                                                  02680023
026900******************************************************************02690099
027000*    STANDARD HEADER FOR 132 COLUMN REPORT                       *02700099
027100******************************************************************02710099
027200     COPY DPWS132O.                                               02720099
027300                                                                  02730099
027400******************************************************************02740099
027500 PROCEDURE DIVISION.                                              02750002
027600******************************************************************02760099
027700 0000-MAIN-LINE.                                                  02770002
027800                                                                  02780002
027900     PERFORM 1000-INITIALIZATION.                                 02790002
028000     PERFORM 2000-PROCESS-INPUT                                   02800005
028100       UNTIL PS-END-OF-PTP-FILE.                                  02810050
028200     PERFORM 4000-UPDATE-CONTROL-DATE.                            02820099
028300     PERFORM 5000-FINISH.                                         02830099
028400                                                                  02840002
028500     STOP RUN.                                                    02850015
028600                                                                  02860015
028700 1000-INITIALIZATION.                                             02870002
028800                                                                  02880003
028900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02890032
029000                                                                  02900025
029100     OPEN INPUT  EVOLVE-ACTIVITY-FILE                             02910057
029200                 WORLD-FILE                                       02920050
029300                 CONTROL-DATE-FILE                                02930099
029400          OUTPUT BALANCES-MOVED-FILE                              02940099
029500                 MFT-FILE                                         02950099
029600                 REPORT-FILE.                                     02960099
029700                                                                  02970002
029800     READ EVOLVE-ACTIVITY-FILE INTO AR090-PTP-RECORD              02980058
029900         AT END                                                   02990002
030000            MOVE '1000-INITIALIZATION'                            03000079
030100                                 TO PV-PARAGRAPH-NAME             03010079
030200            MOVE 'EVOLVE-ACTIVITY-FILE IS EMPTY'                  03020079
030300                                 TO PV-OPERATION-MSG-1            03030079
030400            MOVE SPACES          TO PV-OPERATION-MSG-2            03040079
030500            SET  ABEND-4001      TO TRUE                          03050093
030600            PERFORM 9999-ABEND                                    03060079
030700     END-READ.                                                    03070002
030800                                                                  03080002
030900     READ WORLD-FILE                                              03090053
031000         AT END                                                   03100050
031100            MOVE '1000-INITIALIZATION'                            03110079
031200                                 TO PV-PARAGRAPH-NAME             03120079
031300            MOVE 'WORLD-FILE IS EMPTY'                            03130098
031400                                 TO PV-OPERATION-MSG-1            03140079
031500            MOVE SPACES          TO PV-OPERATION-MSG-2            03150079
031600            SET  ABEND-4002      TO TRUE                          03160093
031700            PERFORM 9999-ABEND                                    03170079
031800     END-READ.                                                    03180050
031900                                                                  03190050
032000     READ CONTROL-DATE-FILE                                       03200099
032100         AT END                                                   03210099
032200            MOVE '1000-INITIALIZATION'                            03220099
032300                                 TO PV-PARAGRAPH-NAME             03230099
032400            MOVE 'CONTROL-DATE-FILE IS EMPTY'                     03240099
032500                                 TO PV-OPERATION-MSG-1            03250099
032600            MOVE SPACES          TO PV-OPERATION-MSG-2            03260099
032700            SET  ABEND-4003      TO TRUE                          03270099
032800            PERFORM 9999-ABEND                                    03280099
032900     END-READ.                                                    03290099
033000                                                                  03300099
033100     MOVE AR092-ACTVTY-DATE      TO PV-ACTVTY-FILE-DATE.          03310099
033200     MOVE AR092-WORLD-DATE       TO PV-WORLD-FILE-DATE.           03320099
033300                                                                  03330099
033400     CLOSE CONTROL-DATE-FILE.                                     03340099
033500                                                                  03350099
033600     ACCEPT CD-CURRENT-DATE      FROM DATE.                       03360099
033700     MOVE   CD-CURRENT-YEAR      TO DP132O-RUN-YEAR.              03370099
033800     MOVE   CD-CURRENT-MONTH     TO DP132O-RUN-MONTH.             03380099
033900     MOVE   CD-CURRENT-DAY       TO DP132O-RUN-DAY.               03390099
034000     ACCEPT CT-CURRENT-TIME      FROM TIME.                       03400099
034100     MOVE   CT-CURRENT-HOUR      TO DP132O-RUN-HOUR.              03410099
034200     MOVE   CT-CURRENT-MINUTE    TO DP132O-RUN-MINUTE.            03420099
034300     MOVE   'ARKUT109'           TO DP132O-PROGRAM-NAME.          03430099
034400     MOVE   1                    TO DP132O-REPORT-NUMBER.         03440099
034500                                                                  03450099
034600     PERFORM 3000-PRINT-PAGE-HEADINGS.                            03460099
034700                                                                  03470099
034800 2000-PROCESS-INPUT.                                              03480002
034900                                                                  03490003
035000     ADD 1 TO PV-INPUT-COUNT.                                     03500008
035100                                                                  03510008
035200     EVALUATE TRUE                                                03520016
035300         WHEN AR090-88-HEADER                                     03530058
035400             MOVE AR090-PTP-RECORD                                03540058
035500                                 TO AR090-PTP-HEADER              03550060
035600             IF AR090-HDR-DT = PV-WORLD-FILE-DATE                 03560099
035700                 SET PS-WRITE-HEADER-ONLY TO TRUE                 03570099
035800                 PERFORM 2500-WRITE-OUTPUT-FILE                   03580099
035900                 SET PS-END-OF-PTP-FILE TO TRUE                   03590099
036000                 MOVE 4095       TO RETURN-CODE                   03600099
036100             ELSE                                                 03610099
036200                 PERFORM 2100-CONVERT-DATE                        03620099
036300             END-IF                                               03630099
036400             ADD 1 TO PV-HEADER-COUNT                             03640010
036500             ADD 1 TO PV-BYPASS-COUNT                             03650011
036600         WHEN AR090-88-TRAILER                                    03660058
036700             MOVE AR090-PTP-RECORD                                03670058
036800                                 TO AR090-PTP-TRAILER             03680060
036900             ADD 1 TO PV-TRAILER-COUNT                            03690010
037000             ADD 1 TO PV-BYPASS-COUNT                             03700011
037100         WHEN OTHER                                               03710003
037200             MOVE AR090-PTP-RECORD                                03720058
037300                                 TO AR090-PTP-DETAIL              03730060
037400             ADD 1 TO PV-DETAIL-COUNT                             03740010
037500             PERFORM 2300-EVALUATE-RECORD                         03750023
037600     END-EVALUATE.                                                03760003
037700                                                                  03770003
037800     PERFORM 2200-READ-PTP-FILE.                                  03780050
037900                                                                  03790003
038000******************************************************************03800023
038100 2100-CONVERT-DATE.                                               03810039
038200******************************************************************03820023
038300                                                                  03830023
038400     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03840023
038500     SET DPG51-DECREMENT-DATE        TO TRUE.                     03850025
038600     SET DPG52-LK-DTE-ISO            TO TRUE.                     03860099
038700                                                                  03870023
038800     MOVE 1                          TO DPG51-INCR-DECR-DAYS-9.   03880030
038900     MOVE AR090-HDR-DT               TO DPG52-LK-DATE-INPUT.      03890099
039000                                                                  03900023
039100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    03910023
039200                                             DPG54 DPG55 DPG56.   03920023
039300                                                                  03930023
039400     IF DPG54-SEVERE-ERROR                                        03940099
039500     OR DPG54-WARNING-ERROR                                       03950099
039600        MOVE '2100-CONVERT-DATE' TO PV-PARAGRAPH-NAME             03960079
039700        MOVE 'ERROR ON DATE CONVERSION'                           03970079
039800                                 TO PV-OPERATION-MSG-1            03980079
039900        MOVE DPG54-ERROR-MESSAGE TO PV-OPERATION-MSG-2            03990079
040000        SET  ABEND-4004          TO TRUE                          04000099
040100        PERFORM 9999-ABEND                                        04010079
040200     END-IF.                                                      04020023
040300                                                                  04030023
040400     MOVE DPG55-DB2-ISO-DATE     TO PV-HDR-DT.                    04040099
040500                                                                  04050099
040600 2200-READ-PTP-FILE.                                              04060050
040700                                                                  04070023
040800     INITIALIZE AR090-PTP-RECORD.                                 04080058
040900                                                                  04090003
041000     READ EVOLVE-ACTIVITY-FILE INTO AR090-PTP-RECORD              04100058
041100         AT END                                                   04110003
041200            SET PS-END-OF-PTP-FILE TO TRUE                        04120050
041300     END-READ.                                                    04130003
041400                                                                  04140003
041500 2300-EVALUATE-RECORD.                                            04150023
041600                                                                  04160003
041700     MOVE AR090-UPD-YEAR         TO PV-UPD-YEAR.                  04170099
041800     MOVE AR090-UPD-MONTH        TO PV-UPD-MONTH.                 04180099
041900     MOVE AR090-UPD-DAY          TO PV-UPD-DAY.                   04190099
042000                                                                  04200099
042100     IF  PV-UPD-DT >= PV-WORLD-FILE-DATE                          04210099
042200     AND PV-UPD-DT <= PV-HDR-DT                                   04220099
042300     AND AR090-STATUS =  2                                        04230099
042400        ADD 1 TO PV-PROCESS-COUNT                                 04240042
042500        SET PS-MATCH-UNKNOWN TO TRUE                              04250064
042600        PERFORM 2400-READ-WORLD-FILE                              04260085
042700            UNTIL PS-MATCH-FOUND                                  04270064
042800               OR PS-MATCH-NOT-FOUND                              04280064
042900               OR PS-END-OF-WORLD-FILE                            04290065
043000        IF PS-MATCH-FOUND                                         04300064
043100            ADD 1 TO PV-TRANSACTION-COUNT                         04310097
043200            PERFORM 2500-WRITE-OUTPUT-FILE                        04320061
043300        END-IF                                                    04330061
043400     ELSE                                                         04340018
043500        ADD 1 TO PV-BYPASS-COUNT                                  04350018
043600     END-IF.                                                      04360014
043700                                                                  04370014
043800 2400-READ-WORLD-FILE.                                            04380050
043900                                                                  04390050
044000     IF AR091-ACCT = AR090-ACCT                                   04400063
044100        SET PS-MATCH-FOUND TO TRUE                                04410064
044200     ELSE                                                         04420063
044300         IF AR091-ACCT > AR090-ACCT                               04430063
044400             SET PS-MATCH-NOT-FOUND TO TRUE                       04440083
044500             ADD 1 TO PV-NOT-FOUND-COUNT                          04450091
044600             PERFORM 2600-WRITE-REPORT-FILE                       04460099
044700         ELSE                                                     04470083
044800             INITIALIZE AR091-ACCOUNT-RECORD                      04480083
044900             READ WORLD-FILE                                      04490083
045000                 AT END                                           04500083
045100                     SET PS-END-OF-WORLD-FILE TO TRUE             04510084
045200                     MOVE PC-MAX-ACCT TO AR091-ACCT               04520084
045300             END-READ                                             04530083
045400         END-IF                                                   04540083
045500     END-IF.                                                      04550083
045600                                                                  04560083
045700 2500-WRITE-OUTPUT-FILE.                                          04570050
045800                                                                  04580082
045900     IF PS-FIRST-TIME OR PS-WRITE-HEADER-ONLY                     04590099
046000         PERFORM 2510-WRITE-HEADER                                04600099
046100         SET PS-NOT-FIRST-TIME TO TRUE                            04610099
046200     END-IF.                                                      04620099
046300                                                                  04630099
046400     IF PS-WRITE-HEADER-ONLY                                      04640099
046500         SET PS-DO-NOT-WRITE-HEADER-ONLY TO TRUE                  04650099
046600     ELSE                                                         04660099
046700         PERFORM 2520-WRITE-DETAIL                                04670099
046800     END-IF.                                                      04680099
046900                                                                  04690099
047000 2510-WRITE-HEADER.                                               04700099
047100                                                                  04710099
047200     INITIALIZE BALANCES-MOVED-RECORD.                            04720099
047300                                                                  04730099
047400     STRING 'Pymnt Date'          DELIMITED BY SIZE               04740099
047500            ','                   DELIMITED BY SIZE               04750099
047600            'Trxn Cnt'            DELIMITED BY SIZE               04760099
047700            ','                   DELIMITED BY SIZE               04770099
047800            'Dun Lvl'             DELIMITED BY SIZE               04780099
047900            ','                   DELIMITED BY SIZE               04790099
048000            'Agent ID'            DELIMITED BY SIZE               04800099
048100            ','                   DELIMITED BY SIZE               04810099
048200            'Pymnt Amt'           DELIMITED BY SIZE               04820099
048300            ','                   DELIMITED BY SIZE               04830099
048400            '30 Days'             DELIMITED BY SIZE               04840099
048500            ','                   DELIMITED BY SIZE               04850099
048600            '60 Days'             DELIMITED BY SIZE               04860099
048700            ','                   DELIMITED BY SIZE               04870099
048800            '90 Days'             DELIMITED BY SIZE               04880099
048900            ','                   DELIMITED BY SIZE               04890099
049000            '120 Days'            DELIMITED BY SIZE               04900099
049100            ','                   DELIMITED BY SIZE               04910099
049200            '150 Days'            DELIMITED BY SIZE               04920099
049300            ','                   DELIMITED BY SIZE               04930099
049400            '180 Days'            DELIMITED BY SIZE               04940099
049500            ','                   DELIMITED BY SIZE               04950099
049600            '210 Days'            DELIMITED BY SIZE               04960099
049700            ','                   DELIMITED BY SIZE               04970099
049800            'Curr Bal'            DELIMITED BY SIZE               04980099
049900            ','                   DELIMITED BY SIZE               04990099
050000            'LOB'                 DELIMITED BY SIZE               05000099
050100            ','                   DELIMITED BY SIZE               05010099
050200            'Source'              DELIMITED BY SIZE               05020099
050300         INTO BALANCES-MOVED-RECORD                               05030099
050400     END-STRING.                                                  05040099
050500                                                                  05050099
050600     WRITE BALANCES-MOVED-RECORD.                                 05060099
050700                                                                  05070099
050800 2520-WRITE-DETAIL.                                               05080099
050900                                                                  05090099
051000     INITIALIZE BALANCES-MOVED-RECORD.                            05100099
051100                                                                  05110099
051200     MOVE AR090-UPD-MONTH             TO PV-UPD-MONTH-FMT.        05120099
051300     MOVE AR090-UPD-DAY               TO PV-UPD-DAY-FMT.          05130099
051400     MOVE AR090-UPD-YEAR              TO PV-UPD-YEAR-FMT.         05140099
051500     MOVE AR090-AMT-PAID              TO PV-AMT-PAID.             05150099
051600     MOVE AR091-CHD-DEL-AMT-30-DAYS-P TO PV-DEL-AMT-30-DAYS.      05160099
051700     MOVE AR091-CHD-DEL-AMT-60-DAYS-P TO PV-DEL-AMT-60-DAYS.      05170099
051800     MOVE AR091-CHD-DEL-AMT-90-DAYS-P TO PV-DEL-AMT-90-DAYS.      05180099
051900     MOVE AR091-CHD-DEL-AMT-120-DAYS-P                            05190099
052000                                      TO PV-DEL-AMT-120-DAYS.     05200099
052100     MOVE AR091-CHD-DEL-AMT-150-DAYS-P                            05210099
052200                                      TO PV-DEL-AMT-150-DAYS.     05220099
052300     MOVE AR091-CHD-DEL-AMT-180-DAYS-P                            05230099
052400                                      TO PV-DEL-AMT-180-DAYS.     05240099
052500     MOVE AR091-CHD-DEL-AMT-210-DAYS-P                            05250099
052600                                      TO PV-DEL-AMT-210-DAYS.     05260099
052700     MOVE AR091-CHD-CURRENT-BALANCE-P TO PV-CURRENT-BALANCE.      05270099
052800                                                                  05280099
052900     STRING PV-UPD-DT-FMT              DELIMITED BY SIZE          05290099
053000            ','                        DELIMITED BY SIZE          05300099
053100            PV-TRANSACTION-COUNT       DELIMITED BY SIZE          05310099
053200            ','                        DELIMITED BY SIZE          05320099
053300**** This is the Dun Level field; is set to 'N/A' for now         05330099
053400            'N/A'                      DELIMITED BY SIZE          05340099
053500            ','                        DELIMITED BY SIZE          05350099
053600            AR090-OPER                 DELIMITED BY SPACE         05360099
053700            ','                        DELIMITED BY SIZE          05370099
053800            PV-AMT-PAID                DELIMITED BY SIZE          05380099
053900            ','                        DELIMITED BY SIZE          05390099
054000            PV-DEL-AMT-30-DAYS         DELIMITED BY SIZE          05400099
054100            ','                        DELIMITED BY SIZE          05410099
054200            PV-DEL-AMT-60-DAYS         DELIMITED BY SIZE          05420099
054300            ','                        DELIMITED BY SIZE          05430099
054400            PV-DEL-AMT-90-DAYS         DELIMITED BY SIZE          05440099
054500            ','                        DELIMITED BY SIZE          05450099
054600            PV-DEL-AMT-120-DAYS        DELIMITED BY SIZE          05460099
054700            ','                        DELIMITED BY SIZE          05470099
054800            PV-DEL-AMT-150-DAYS        DELIMITED BY SIZE          05480099
054900            ','                        DELIMITED BY SIZE          05490099
055000            PV-DEL-AMT-180-DAYS        DELIMITED BY SIZE          05500099
055100            ','                        DELIMITED BY SIZE          05510099
055200            PV-DEL-AMT-210-DAYS        DELIMITED BY SIZE          05520099
055300            ','                        DELIMITED BY SIZE          05530099
055400            PV-CURRENT-BALANCE         DELIMITED BY SIZE          05540099
055500            ','                        DELIMITED BY SIZE          05550099
055600            'RMO'                      DELIMITED BY SIZE          05560099
055700            ','                        DELIMITED BY SIZE          05570099
055800            'FirstData-BalancesMovedRMO'                          05580099
055900                                       DELIMITED BY SIZE          05590099
056000       INTO BALANCES-MOVED-RECORD                                 05600099
056100     END-STRING.                                                  05610099
056200                                                                  05620099
056300     WRITE BALANCES-MOVED-RECORD.                                 05630099
056400                                                                  05640099
056500     ADD 1 TO PV-WRITE-COUNT.                                     05650099
056600                                                                  05660099
056700 2600-WRITE-REPORT-FILE.                                          05670099
056800                                                                  05680099
056900     IF PV-LINE-COUNT >= PC-PAGE-SIZE                             05690099
057000         PERFORM 3000-PRINT-PAGE-HEADINGS                         05700099
057100     END-IF.                                                      05710099
057200                                                                  05720099
057300     MOVE AR090-ACCT             TO DL1-ACCT.                     05730099
057400     MOVE DPG55-GREG-CC-DATE-FMT TO DL1-PYMNT-DATE.               05740099
057500     MOVE AR090-OPER             TO DL1-OPER.                     05750099
057600     MOVE AR090-AMT-PAID         TO DL1-AMT-PAID.                 05760099
057700                                                                  05770099
057800     WRITE REPORT-RECORD                                          05780099
057900         FROM DL1-DETAIL-LINE-1                                   05790099
058000         AFTER ADVANCING 1 LINE.                                  05800099
058100                                                                  05810099
058200     ADD 1 TO PV-LINE-COUNT.                                      05820099
058300                                                                  05830099
058400 3000-PRINT-PAGE-HEADINGS.                                        05840099
058500                                                                  05850099
058600      ADD 1 TO PV-PAGE-COUNT.                                     05860099
058700                                                                  05870099
058800      MOVE PV-PAGE-COUNT         TO DP132O-PAGE-NUMBER.           05880099
058900                                                                  05890099
059000      WRITE REPORT-RECORD                                         05900099
059100          FROM DP132O-STANDRD-HEADER-132-COLS                     05910099
059200          AFTER ADVANCING PAGE.                                   05920099
059300                                                                  05930099
059400      INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                  05940099
059500                                                                  05950099
059600      WRITE REPORT-RECORD                                         05960099
059700          FROM HL1-HEADING-LINE-1                                 05970099
059800          AFTER ADVANCING 1 LINE.                                 05980099
059900      WRITE REPORT-RECORD                                         05990099
060000          FROM HL2-HEADING-LINE-2                                 06000099
060100          AFTER ADVANCING 2 LINE.                                 06010099
060200      WRITE REPORT-RECORD                                         06020099
060300          FROM HL3-HEADING-LINE-3                                 06030099
060400          AFTER ADVANCING 1 LINE.                                 06040099
060500                                                                  06050099
060600      MOVE 5                     TO PV-LINE-COUNT.                06060099
060700                                                                  06070099
060800 4000-UPDATE-CONTROL-DATE.                                        06080099
060900                                                                  06090099
061000     OPEN OUTPUT CONTROL-DATE-FILE.                               06100099
061100                                                                  06110099
061200     MOVE SPACES                 TO AR092-FILLER                  06120099
061300                                    AR092-FUTURE-USE.             06130099
061400     MOVE PV-ACTVTY-FILE-DATE    TO AR092-ACTVTY-DATE.            06140099
061500     MOVE AR090-HDR-DT           TO AR092-WORLD-DATE.             06150099
061600                                                                  06160099
061700     WRITE AR092-RECORD.                                          06170099
061800                                                                  06180099
061900 5000-FINISH.                                                     06190099
062000                                                                  06200099
062100     IF PV-LINE-COUNT >= (PC-PAGE-SIZE - 2)                       06210099
062200         PERFORM 3000-PRINT-PAGE-HEADINGS                         06220099
062300     END-IF.                                                      06230099
062400                                                                  06240099
062500     WRITE REPORT-RECORD                                          06250099
062600         FROM FL1-FOOTER-LINE-1                                   06260099
062700         AFTER ADVANCING 2 LINE.                                  06270099
062800                                                                  06280099
062900     DISPLAY '***********************************'.               06290099
063000     DISPLAY 'FILE HEADER DATE = ' AR090-HDR-DT.                  06300099
063100     DISPLAY ' '.                                                 06310099
063200     MOVE PV-HEADER-COUNT        TO PV-DISPLAY-COUNT.             06320099
063300     DISPLAY '  HEADERS READ:     ' PV-DISPLAY-COUNT.             06330099
063400     MOVE PV-DETAIL-COUNT        TO PV-DISPLAY-COUNT.             06340099
063500     DISPLAY '+ DETAILS READ:     ' PV-DISPLAY-COUNT.             06350099
063600     MOVE PV-TRAILER-COUNT       TO PV-DISPLAY-COUNT.             06360099
063700     DISPLAY '+ TRAILERS READ:    ' PV-DISPLAY-COUNT.             06370099
063800     MOVE PV-INPUT-COUNT         TO PV-DISPLAY-COUNT.             06380099
063900     DISPLAY '= RECORDS READ:     ' PV-DISPLAY-COUNT.             06390099
064000     DISPLAY ' '.                                                 06400099
064100     MOVE PV-BYPASS-COUNT        TO PV-DISPLAY-COUNT.             06410099
064200     DISPLAY '  RECORDS BYPASSED: ' PV-DISPLAY-COUNT.             06420099
064300     MOVE PV-PROCESS-COUNT       TO PV-DISPLAY-COUNT.             06430099
064400     DISPLAY '+ RECORDS PROCESSED:' PV-DISPLAY-COUNT.             06440099
064500     MOVE PV-INPUT-COUNT         TO PV-DISPLAY-COUNT.             06450099
064600     DISPLAY '= RECORDS READ:     ' PV-DISPLAY-COUNT.             06460099
064700     DISPLAY ' '.                                                 06470099
064800     MOVE PV-NOT-FOUND-COUNT     TO PV-DISPLAY-COUNT.             06480099
064900     DISPLAY '  RECORDS NOT FOUND:' PV-DISPLAY-COUNT.             06490099
065000     MOVE PV-WRITE-COUNT         TO PV-DISPLAY-COUNT.             06500099
065100     DISPLAY '+ RECORDS WRITTEN:  ' PV-DISPLAY-COUNT.             06510099
065200     MOVE PV-PROCESS-COUNT       TO PV-DISPLAY-COUNT.             06520099
065300     DISPLAY '= RECORDS PROCESSED:' PV-DISPLAY-COUNT.             06530099
065400     DISPLAY '***********************************'.               06540099
065500                                                                  06550099
065600     MOVE CD-CURRENT-YEAR        TO MFT-YEAR.                     06560099
065700     MOVE CD-CURRENT-MONTH       TO MFT-MONTH.                    06570099
065800     MOVE CD-CURRENT-DAY         TO MFT-DAY.                      06580099
065900     MOVE CT-CURRENT-HOUR        TO MFT-HOUR.                     06590099
066000     MOVE CT-CURRENT-MINUTE      TO MFT-MINUTE.                   06600099
066100     MOVE CT-CURRENT-SECOND      TO MFT-SECOND.                   06610099
066200     MOVE PV-WRITE-COUNT         TO MFT-COUNT.                    06620099
066300                                                                  06630099
066400     WRITE MFT-RECORD FROM PV-MFT-RECORD.                         06640099
066500                                                                  06650099
066600     CLOSE EVOLVE-ACTIVITY-FILE                                   06660099
066700           WORLD-FILE                                             06670099
066800           BALANCES-MOVED-FILE                                    06680099
066900           CONTROL-DATE-FILE                                      06690099
067000           MFT-FILE                                               06700099
067100           REPORT-FILE.                                           06710099
067200                                                                  06720099
067300 9999-ABEND.                                                      06730099
067400                                                                  06740099
067500     DISPLAY '** ABEND OCCURRED  **'.                             06750099
067600     DISPLAY '** PROGRAM NAME    ** = ' PC-PROGRAM-NAME.          06760099
067700     DISPLAY '** PARAGRAPH NAME  ** = ' PV-PARAGRAPH-NAME.        06770099
067800     DISPLAY '** MESSAGE PART-1  ** = ' PV-OPERATION-MSG-1.       06780099
067900     DISPLAY '** MESSAGE PART-2  ** = ' PV-OPERATION-MSG-2.       06790099
068000                                                                  06800099
068100     CALL 'ILBOABN0' USING ABEND-CODE.                            06810099
068200                                                                  06820099
