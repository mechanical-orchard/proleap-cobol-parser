000100 IDENTIFICATION DIVISION.                                                 
000200                                                                          
000300 PROGRAM-ID.    TRKRP242.                                                 
000400 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                          
000500 INSTALLATION.  KOHLS.                                                    
000600 DATE-WRITTEN   DECEMBER 1998.                                            
000700 DATE-COMPILED.                                                           
000800                                                                          
001400 ENVIRONMENT DIVISION.                                                    
001500                                                                          
001600 CONFIGURATION SECTION.                                                   
001700                                                                          
001800 SOURCE-COMPUTER.        IBM-3090.                                        
001900 OBJECT-COMPUTER.        IBM-3090.                                        
002000                                                                          
002100 INPUT-OUTPUT SECTION.                                                    
002200                                                                          
002300 FILE-CONTROL.                                                            
002400                                                                          
002500     SELECT DETAIL-FILE                                                   
002600         ASSIGN TO INP01.                                                 
002700                                                                          
002800     SELECT DETAIL-REPORT-FILE                                            
002900         ASSIGN TO RPT01.                                                 
003000                                                                          
003100******************************************************************        
003200 DATA DIVISION.                                                           
003300******************************************************************        
003400                                                                          
003500 FILE SECTION.                                                            
003600                                                                          
003700 FD  DETAIL-FILE                                                          
003800     RECORDING MODE IS F                                                  
003900     LABEL RECORDS ARE STANDARD                                           
004000     BLOCK CONTAINS 0 RECORDS.                                            
004100                                                                          
004200 01  DETAIL-RECORD                    PIC  X(508).                        
004300                                                                          
004400                                                                          
004500 FD  DETAIL-REPORT-FILE                                                   
004600     RECORDING MODE IS F                                                  
004700     LABEL RECORDS ARE STANDARD                                           
004800     BLOCK CONTAINS 0 RECORDS.                                            
004900                                                                          
005000 01  DETAIL-REPORT-RECORD             PIC  X(132).                        
005100                                                                          
005200                                                                          
005300*----------------------------------------------------------------*        
005400 WORKING-STORAGE SECTION.                                                 
005500*----------------------------------------------------------------*        
005600                                                                          
005700*----------------------------------------------------------------*        
005800***  WORK FIELDS FOR THE DETAIL REPORT                                    
005900*----------------------------------------------------------------*        
006000     COPY TRRD241.                                                        
006100                                                                          
006200 01  PS-PROGRAM-SWITCHES.                                                 
006300     05  PS-EOF-DETAIL-FILE-SW      PIC  X(01)   VALUE SPACES.            
006400         88  PS-EOF-DETAIL-FILE                  VALUE 'Y'.               
006500                                                                          
006600 01 PC-PROGRAM-CONSTANTS.                                                 
006700     05  PC-PAGE-SIZE-054           PIC S9(04)   VALUE +054               
006800                                                  COMP SYNC.              
006900     05  PC-PAGE-SIZE-060           PIC S9(04)   VALUE +060               
007000                                                  COMP SYNC.              
007100     05  PC-HEADING-SIZE            PIC S9(04)   VALUE +6                 
007200                                                  COMP SYNC.              
007300     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)   VALUE                    
007400         'TRKRP242'.                                                      
007500                                                                          
007600 01  PV-PROGRAM-VARIABLES.                                                
007700     05  PV-LINES-USED              PIC S9(04)   VALUE ZERO               
007800                                                  COMP SYNC.              
007900     05  PV-BLANK-LINE              PIC  X(132)  VALUE SPACES.            
008000     05  PV-NO-OF-POS-IN-ERROR      PIC  S9(06)  VALUE ZEROES.            
008100     05  PV-PAGE-COUNT              PIC  9(05)   VALUE ZERO.              
008110     05  PV-PREV-ENTRY              PIC  X(12)                            
008200                                           VALUE 'INITIALVALUE'.          
008300                                                                          
008400 01  SD-SYSTEM-DATE.                                                      
008500     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.              
008600     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.              
008700     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.              
008800                                                                          
008900 01  ST-SYSTEM-TIME.                                                      
009000     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.              
009100     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.              
009200     05  FILLER                     PIC  9(04)   VALUE ZERO.              
009300                                                                          
009400 01  PV-WORK-DATE.                                                        
009500     05  FILLER                     PIC  9(02)   VALUE ZERO.              
009600     05  PV-WORK-YY                 PIC  9(02)   VALUE ZERO.              
009700     05  PV-WORK-MM                 PIC  9(02)   VALUE ZERO.              
009800     05  PV-WORK-DD                 PIC  9(02)   VALUE ZERO.              
009900                                                                          
010000 01  PV-WORK-TIME.                                                        
010100     05  PV-WORK-HOUR               PIC  9(02)   VALUE ZERO.              
010200     05  PV-WORK-MINUTE             PIC  9(02)   VALUE ZERO.              
010300                                                                          
010301 01  PV-DEFAULT-DATE.                                                     
010302     05  PV-DEFAULT-CC              PIC  9(02)   VALUE ZERO.              
010303     05  PV-DEFAULT-YY              PIC  9(02)   VALUE 01.                
010304     05  PV-DEFAULT-MM              PIC  9(02)   VALUE 01.                
010305     05  PV-DEFAULT-DD              PIC  9(02)   VALUE 01.                
010306                                                                          
010307 01  PV-DEFAULT-TIME.                                                     
010308     05  PV-DEFAULT-HOUR            PIC  9(02)   VALUE ZERO.              
010309     05  PV-DEFAULT-MINUTE          PIC  9(02)   VALUE ZERO.              
010310                                                                          
010311 01  PV-EDIT-DATE.                                                        
010312     05  FILLER                     PIC  X(02)   VALUE ZERO.              
010313     05  FILLER                     PIC  X(01)   VALUE '/'.               
010314     05  FILLER                     PIC  X(02)   VALUE ZERO.              
010315     05  FILLER                     PIC  X(01)   VALUE '/'.               
010316     05  FILLER                     PIC  X(02)   VALUE ZERO.              
010317                                                                          
010318 01  PV-EDIT-TIME.                                                        
010319     05  FILLER                     PIC  X(02)   VALUE SPACES.            
010320     05  FILLER                     PIC  X(01)   VALUE ':'.               
010321     05  FILLER                     PIC  X(02)   VALUE SPACES.            
010330                                                                          
010400 01  PV-DISP-DATE.                                                        
010500     05  PV-DISP-MM                 PIC  9(02)   VALUE ZERO.              
010600     05  FILLER                     PIC  X(01)   VALUE '/'.               
010700     05  PV-DISP-DD                 PIC  9(02)   VALUE ZERO.              
010800     05  FILLER                     PIC  X(01)   VALUE '/'.               
010900     05  PV-DISP-YY                 PIC  9(02)   VALUE ZERO.              
011000                                                                          
011100 01  PV-DISP-TIME.                                                        
011200     05  PV-DISP-HOUR               PIC  9(02)   VALUE ZERO.              
011300     05  FILLER                     PIC  X(01)   VALUE ':'.               
011400     05  PV-DISP-MINUTE             PIC  9(02)   VALUE ZERO.              
011500                                                                          
011600*----------------------------------------------------------------*        
011700***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                         
011800*----------------------------------------------------------------*        
011900     COPY DPWS132O.                                                       
012000                                                                          
012100 01  HL1-HEADING-LINE-1.                                                  
012200     05  FILLER                      PIC  X(02)  VALUE SPACES.            
012300     05  HL1-TRANS-DATE.                                                  
012400         10 HL-TRANS-MM              PIC  X(02)  VALUE SPACES.            
012500         10 FILLER                   PIC  X(01)  VALUE '/'.               
012600         10 HL-TRANS-DD              PIC  X(02)  VALUE SPACES.            
012700         10 FILLER                   PIC  X(01)  VALUE '/'.               
012800         10 HL-TRANS-YY              PIC  X(02)  VALUE SPACES.            
012900     05  FILLER                      PIC  X(02)  VALUE SPACES.            
013000     05  HL1-TRANS-TIME.                                                  
013100         10 HL-TRANS-TIME-HH         PIC  X(02)  VALUE SPACES.            
013200         10 FILLER                   PIC  X(01)  VALUE ':'.               
013300         10 HL-TRANS-TIME-MM         PIC  X(02)  VALUE SPACES.            
013400     05  FILLER                      PIC  X(01)  VALUE SPACES.            
013500     05  FILLER                      PIC  X(13)  VALUE                    
013600         'TRANSMIT DATE'.                                                 
013700     05  FILLER                      PIC  X(16)  VALUE SPACES.            
013800     05  FILLER                      PIC  X(38)  VALUE                    
013900         '    EI CUSTOMS BROKER LOAD DETAILS    '.                        
014000     05  FILLER                      PIC  X(16)  VALUE SPACES.            
014100     05  FILLER                      PIC  X(07)  VALUE                    
014200         'FILE ID'.                                                       
014300     05  FILLER                      PIC  X(02)  VALUE SPACES.            
014400     05  HL1-FILE-ID                 PIC  X(09)  VALUE SPACES.            
014500     05  FILLER                      PIC  X(13)  VALUE SPACES.            
014600                                                                          
014700 01  HL2-HEADING-LINE-2.                                                  
014800         10 FILLER                   PIC  X(02)  VALUE SPACES.            
014900     05  HL2-LOAD-DATE.                                                   
015000         10 HL-LOAD-MM               PIC  X(02)  VALUE SPACES.            
015100         10 FILLER                   PIC  X(01)  VALUE '/'.               
015200         10 HL-LOAD-DD               PIC  X(02)  VALUE SPACES.            
015300         10 FILLER                   PIC  X(01)  VALUE '/'.               
015400         10 HL-LOAD-YY               PIC  X(02)  VALUE SPACES.            
015500     05  FILLER                      PIC  X(02)  VALUE SPACES.            
015600     05  HL2-LOAD-TIME.                                                   
015700         10 HL-LOAD-TIME-HH          PIC  X(02)  VALUE SPACES.            
015800         10 FILLER                   PIC  X(01)  VALUE ':'.               
015900         10 HL-LOAD-TIME-MM          PIC  X(02)  VALUE SPACES.            
016000     05  FILLER                      PIC  X(01)  VALUE SPACES.            
016100     05  FILLER                      PIC  X(13)  VALUE                    
016200         'LOAD DATE    '.                                                 
016300     05  FILLER                      PIC  X(16)  VALUE SPACES.            
016400     05  FILLER                      PIC  X(38)  VALUE SPACES.            
016600     05  FILLER                      PIC  X(16)  VALUE SPACES.            
016700     05  HL2-EXPEDITOR               PIC  X(30)  VALUE SPACES.            
016800     05  FILLER                      PIC  X(01)  VALUE SPACES.            
016900                                                                          
017701 01  HL3-HEADING-LINE-3.                                                  
017702     05  FILLER                      PIC  X(02)  VALUE SPACES.            
017703     05  FILLER                      PIC  X(08)  VALUE                    
017704         'ENTRY ID'.                                                      
017705     05  FILLER                      PIC  X(12)  VALUE SPACES.            
017706     05  FILLER                      PIC  X(23)  VALUE                    
017707         'BROKER REFERENCE NUMBER'.                                       
017708     05  FILLER                      PIC  X(10)  VALUE SPACES.            
017709     05  FILLER                      PIC  X(30)  VALUE                    
017710         'PORT OF ENTRY                 '.                                
017711     05  FILLER                      PIC  X(47) VALUE SPACES.             
017800                                                                          
017900 01  HL4-HEADING-LINE-4.                                                  
017901     05  FILLER                      PIC  X(02)  VALUE SPACES.            
017902     05  HL4-HEAD-ENTRY-ID           PIC  X(12)  VALUE SPACES.            
017903     05  FILLER                      PIC  X(08)  VALUE SPACES.            
017904     05  HL4-HEAD-BROKER-REF         PIC  X(15)  VALUE SPACES.            
017905     05  FILLER                      PIC  X(18)  VALUE SPACES.            
017906     05  HL4-HEAD-POE-NM             PIC  X(30)  VALUE SPACES.            
017910     05  FILLER                      PIC  X(47) VALUE SPACES.             
018500                                                                          
018600***************************************************************           
018700*  DETAIL LINES                                                           
018800 01  DL-COMMON-HEADING-1.                                                 
018900     05  FILLER                      PIC  X(02)  VALUE SPACES.            
019000     05  FILLER                      PIC  X(20)  VALUE                    
019100         'RECD   TRN   POE    '.                                          
019200     05  FILLER                      PIC  X(110) VALUE SPACES.            
019300                                                                          
019400 01  DL-COMMON-HEADING-2.                                                 
019500     05  DL-TYPE-LITS.                                                    
019600         10 FILLER                   PIC  X(02)  VALUE SPACES.            
019700         10 FILLER                   PIC  X(20)  VALUE                    
019800         'TYPE   TYPE  CODE   '.                                          
019900         10 DL2-DETAIL-LIT           PIC  X(110) VALUE SPACES.            
020000                                                                          
020100 01  DL-TYPE-HEADINGS.                                                    
020200     05  DL-ENF-HDR.                                                      
020300         10  FILLER                   PIC X(19)   VALUE                   
020400         'CUSTOM ENTRY FILED '.                                           
020401         10  FILLER                   PIC  X(07)  VALUE SPACES.           
020402         10  FILLER                   PIC  X(30)  VALUE                   
020403             'ENTRY TYPE DESCRIPTION        '.                            
020404         10  FILLER                   PIC  X(04)  VALUE SPACES.           
020405         10  FILLER                   PIC  X(09)  VALUE                   
020410             'TRIP TYPE'.                                                 
020500     05  DL-ENFPO-HDR.                                                    
020600         10  FILLER   PIC X(09)  VALUE 'PO NUMBER'.                       
020610         10  FILLER   PIC X(17)  VALUE SPACES.                            
020620         10  FILLER   PIC X(18)  VALUE 'EXTERNAL REFERENCE'.              
020621         10  FILLER   PIC X(05)  VALUE SPACES.                            
020622         10  FILLER   PIC X(06)  VALUE 'PO FOB'.                          
020700     05  DL-ENFCON-HDR                PIC X(110)  VALUE                   
020800         'CONTAINER ID       '.                                           
020801     05  DL-DOP-HDR                   PIC X(110)  VALUE                   
020810        'CONTAINER ID              DELIVERY ORDER CREATED'.               
021001     05  DL-ENFBOL-HDR.                                                   
021002         10 FILLER                    PIC X(21)   VALUE                   
021003           'MASTER BILL OF LADING'.                                       
021004         10 FILLER                    PIC X(12)   VALUE SPACES.           
021005         10 FILLER                    PIC X(20)   VALUE                   
021006           'HOUSE BILL OF LADING'.                                        
021007         10 FILLER                    PIC X(18)   VALUE SPACES.           
021008         10 FILLER                    PIC X(12)   VALUE                   
021009           'CARRIER SCAC'.                                                
021010         10 FILLER                    PIC X(27)   VALUE SPACES.           
021100     05  DL-EXD-HDR                   PIC X(110)  VALUE                   
021200         'CUSTOMS EXAM'.                                                  
021300     05  DL-REJ-HDR                   PIC X(110)  VALUE                   
021400         'CUSTOMS REJECTIONS'.                                            
021500     05  DL-ECR-HDR                   PIC X(110)  VALUE                   
021600         'ESTIMATED CUSTOMS CLEARANCE'.                                   
021700     05  DL-RLS-HDR                   PIC X(110)  VALUE                   
021800         'ACTUAL CUSTOMS CLEARANCE'.                                      
021900     05  DL-LIQ-HDR                   PIC X(110)  VALUE                   
022000         'CUSTOMS LIQUIDATION'.                                           
022100     05  DL-LSU-HDR                   PIC X(110)  VALUE                   
022200         'CUSTOMS LIQUIDATION SUSPENSION'.                                
022300                                                                          
022400 01  DL-DETAIL-LINE-1.                                                    
022500     05  FILLER                       PIC X(02) VALUE SPACES.             
022600     05  DL1-REC-TYPE                 PIC X(06) VALUE SPACES.             
022700     05  FILLER                       PIC X(03) VALUE SPACES.             
022800     05  DL1-TRN-TYPE                 PIC X(01) VALUE SPACES.             
022900     05  FILLER                       PIC X(03) VALUE SPACES.             
022910     05  DL1-POE-CODE                 PIC X(04) VALUE SPACES.             
022920     05  FILLER                       PIC X(03) VALUE SPACES.             
023000     05  DL1-TEXT                     PIC X(110) VALUE SPACES.            
023100                                                                          
023200 01  DL-DETAIL-LINES.                                                     
023300     05  DL-ENF-LINE.                                                     
023400         10  DL-ENF-DATE              PIC X(08) VALUE SPACE.              
023500         10  FILLER                   PIC X(04) VALUE SPACE.              
023600         10  DL-ENF-TIME              PIC X(05) VALUE SPACE.              
023601         10  FILLER                   PIC X(09) VALUE SPACE.              
023602         10  HL4-HEAD-ENTRY-DESC      PIC X(30) VALUE SPACES.             
023603         10  FILLER                   PIC X(08) VALUE SPACES.             
023604         10  HL4-HEAD-TRIP-TYPE-CDE   PIC X(01) VALUE SPACES.             
023610         10  FILLER                   PIC X(10) VALUE SPACES.             
023700                                                                          
023800     05  DL-ENFPO-LINE.                                                   
023900         10  DL-ENFPO-PO              PIC 999999999.                      
023910         10  FILLER                   PIC X(17) VALUE SPACE.              
023921         10  DL-ENFPO-EXTL-REF-NBR    PIC X(15) VALUE SPACE.              
023922         10  FILLER                   PIC X(08) VALUE SPACE.              
023923         10  DL-ENFPO-FOB-CDE         PIC X(03) VALUE SPACE.              
024000                                                                          
024100     05  DL-ENFCON-LINE.                                                  
024200         10  DL-ENFCON-CONTAINER      PIC X(15) VALUE SPACES.             
024300                                                                          
024301     05  DL-DOP-LINE.                                                     
024302         10  DL-DOP-CONTAINER         PIC X(15) VALUE SPACE.              
024303         10  FILLER                   PIC X(11) VALUE SPACE.              
024304         10  DL-DOP-DELY-SNT-DTE      PIC X(08) VALUE SPACE.              
024305         10  FILLER                   PIC X(06) VALUE SPACE.              
024306         10  DL-DOP-DELY-SNT-TM       PIC X(05) VALUE SPACE.              
024310                                                                          
024400     05  DL-ENFBOL-LINE.                                                  
024500         10  DL-ENFBOL-MASTER-BOL     PIC X(30) VALUE SPACES.             
024600         10  FILLER                   PIC X(03) VALUE SPACES.             
024700         10  DL-ENFBOL-HOUSE-BOL      PIC X(30) VALUE SPACES.             
024701         10  FILLER                   PIC X(10) VALUE SPACES.             
024710         10  DL-ENFBOL-CARR-SCAC-ID   PIC X(04) VALUE SPACES.             
024800                                                                          
024900     05  DL-EXD-LINE.                                                     
025000         10  DL-EXD-DATE              PIC X(08) VALUE SPACES.             
025100         10  FILLER                   PIC X(04) VALUE SPACE.              
025200         10  DL-EXD-TIME              PIC X(05) VALUE SPACES.             
025300                                                                          
025400     05  DL-REJ-LINE.                                                     
025500         10  DL-REJ-DATE              PIC X(08) VALUE SPACES.             
025600         10  FILLER                   PIC X(04) VALUE SPACE.              
025700         10  DL-REJ-TIME              PIC X(05) VALUE SPACES.             
025800         10  FILLER                   PIC X(16) VALUE SPACES.             
025900         10  DL-REJ-DESC              PIC X(30) VALUE SPACES.             
026000                                                                          
026100     05  DL-ECR-LINE.                                                     
026200         10  DL-ECR-DATE              PIC X(08) VALUE SPACES.             
026300         10  FILLER                   PIC X(04) VALUE SPACE.              
026400         10  DL-ECR-TIME              PIC X(05) VALUE SPACES.             
026500                                                                          
026600     05  DL-RLS-LINE.                                                     
026700         10  DL-RLS-DATE              PIC X(08) VALUE SPACES.             
026800         10  FILLER                   PIC X(04) VALUE SPACE.              
026900         10  DL-RLS-TIME              PIC X(05) VALUE SPACES.             
027000                                                                          
027100     05  DL-LIQ-LINE.                                                     
027200         10  DL-LIQ-DATE              PIC X(08) VALUE SPACES.             
027300         10  FILLER                   PIC X(04) VALUE SPACE.              
027400         10  DL-LIQ-TIME              PIC X(05) VALUE SPACES.             
027500                                                                          
027600     05  DL-LSU-LINE.                                                     
027700         10  DL-LSU-DATE              PIC X(08) VALUE SPACES.             
027800         10  FILLER                   PIC X(04) VALUE SPACE.              
027900         10  DL-LSU-TIME              PIC X(05) VALUE SPACES.             
028000         10  FILLER                   PIC X(16) VALUE SPACES.             
028100         10  DL-LSU-DESC              PIC X(30) VALUE SPACES.             
028200                                                                          
028300 01  DL-HEADING-DATA-IN-ERROR.                                            
028400     05  FILLER                      PIC  X(15)  VALUE SPACES.            
028500     05  FILLER                      PIC  X(13)  VALUE                    
028600         'DATA IN ERROR'.                                                 
028700     05  FILLER                      PIC  X(20)  VALUE SPACES.            
028800     05  FILLER                      PIC  X(10)  VALUE                    
028900         'DATA VALUE'.                                                    
029000     05  FILLER                      PIC  X(13)  VALUE SPACES.            
029100     05  FILLER                      PIC  X(04)  VALUE                    
029200         'TYPE'.                                                          
029300     05  FILLER                      PIC  X(20)  VALUE SPACES.            
029400     05  FILLER                      PIC  X(07)  VALUE                    
029500         'MESSAGE'.                                                       
029600     05  FILLER                      PIC  X(30)  VALUE SPACES.            
029700                                                                          
030800                                                                          
030900***************************************************************           
031000                                                                          
031100 01  ER-END-OF-REPORT-LINE.                                               
031200     05  FILLER                     PIC  X(54)   VALUE SPACES.            
031300     05  FILLER                     PIC  X(25)   VALUE                    
031400         '***** END OF REPORT *****'.                                     
031500     05  FILLER                     PIC  X(53)   VALUE SPACES.            
031600                                                                          
031700 01  EP-EMPTY-REPORT-LINE.                                                
031800     05  FILLER                     PIC  X(25)   VALUE                    
031900         '******* NO DATA *********'.                                     
032000     05  FILLER                     PIC  X(107)  VALUE SPACES.            
032100/                                                                         
032200 PROCEDURE DIVISION.                                                      
032300                                                                          
032400*----------------------------------------------------------------*        
032500* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE             
032600*      PROGRAM.                                                           
032700*----------------------------------------------------------------*        
032800 0000-PROGRAM-MAINLINE.                                                   
032900                                                                          
033000     PERFORM 1000-INITIALIZE.                                             
033100                                                                          
033101     IF PS-EOF-DETAIL-FILE                                                
033102        CONTINUE                                                          
033103     ELSE                                                                 
033104        PERFORM 2000-PROCESS-REPORT-DATA                                  
033110          UNTIL PS-EOF-DETAIL-FILE                                        
033200     END-IF.                                                              
033400                                                                          
033500     PERFORM 9000-EOJ-ROUTINE.                                            
033600                                                                          
033700     GOBACK.                                                              
033800                                                                          
033900 1000-INITIALIZE.                                                         
034000                                                                          
034100     OPEN INPUT  DETAIL-FILE                                              
034200          OUTPUT DETAIL-REPORT-FILE.                                      
034300                                                                          
034400     ACCEPT SD-SYSTEM-DATE FROM DATE.                                     
034500     ACCEPT ST-SYSTEM-TIME FROM TIME.                                     
034600                                                                          
034700     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.                      
034800     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.                     
034900     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.                       
035000     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.                      
035100     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.                    
035200                                                                          
035300     MOVE PC-CURRENT-PROGRAM-NAME                                         
035400                                 TO DP132O-PROGRAM-NAME.                  
035500                                                                          
035600     MOVE 1                      TO DP132O-REPORT-NUMBER.                 
035700                                                                          
035800     PERFORM 7000-READ-DETAIL-FILE.                                       
036100                                                                          
036200                                                                          
036300     IF PS-EOF-DETAIL-FILE                                                
036400        PERFORM  8000-WRITE-HEADINGS                                      
036500        WRITE DETAIL-REPORT-RECORD FROM EP-EMPTY-REPORT-LINE              
036600            AFTER ADVANCING 2 LINES                                       
037400     END-IF.                                                              
037500                                                                          
037600/                                                                         
037700****************************************************************          
037800*  PROCESSING FOR DETAIL RECORDS.                                         
037900******************************************************************        
038000 2000-PROCESS-REPORT-DATA.                                                
038100                                                                          
038500     IF TR241-REC-TYP-HDR-CDE-HDR                                         
038700         PERFORM 3000-HDR                                                 
038910     ELSE                                                                 
038911         IF TR241-CSTM-ENTR-ID     NOT =    PV-PREV-ENTRY                 
038912           MOVE TR241-CSTM-ENTR-ID TO PV-PREV-ENTRY                       
038913           MOVE TR241-CSTM-ENTR-ID          TO HL4-HEAD-ENTRY-ID          
038914                                               PV-PREV-ENTRY              
038916           IF TR241-ENF-ENTR-TYP-DESC  = SPACES                           
038917             MOVE TR241-ENF-ENTR-TYP-CDE    TO HL4-HEAD-ENTRY-DESC        
038918           ELSE                                                           
038919             MOVE TR241-ENF-ENTR-TYP-DESC   TO HL4-HEAD-ENTRY-DESC        
038920           END-IF                                                         
038921           MOVE TR241-BKR-REF-NBR           TO HL4-HEAD-BROKER-REF        
038922           MOVE TR241-POE-NM                TO HL4-HEAD-POE-NM            
038923           MOVE TR241-ENF-MOM-TRIP-TYP-CDE                                
038924                                    TO HL4-HEAD-TRIP-TYPE-CDE             
038925           PERFORM 8000-WRITE-HEADINGS                                    
038926           PERFORM 8010-WRITE-ENTRY-ID-HEADINGS                           
038927         END-IF                                                           
038928     END-IF.                                                              
038930                                                                          
038940     EVALUATE TRUE                                                        
039000     WHEN TR241-REC-TYP-ENF-CD-ENF                                        
039100         PERFORM 3005-ENF                                                 
039200     WHEN TR241-REC-TYP-ENFBOL-CD-ENFBOL                                  
039300         PERFORM 3010-ENFBOL                                              
039400     WHEN TR241-REC-TYP-ENFCON-CD-ENFCON                                  
039500         PERFORM 3015-ENFCON                                              
039501     WHEN TR241-REC-TYP-DOP-CD-DOP                                        
039510         PERFORM 3055-DOP                                                 
039600     WHEN TR241-REC-TYP-ENFPO-CDE-ENFPO                                   
039700         PERFORM 3020-ENFPO                                               
039800     WHEN TR241-REC-TYP-EXD-CDE-EXD                                       
039900         PERFORM 3025-EXD                                                 
040000     WHEN TR241-REC-TYP-REJ-CDE-REJ                                       
040100         PERFORM 3030-REJ                                                 
040200     WHEN TR241-REC-TYP-ECR-CDE-ECR                                       
040300         PERFORM 3035-ECR                                                 
040400     WHEN TR241-REC-TYP-RLS-CDE-RLS                                       
040500         PERFORM 3040-RLS                                                 
040600     WHEN TR241-REC-TYP-LIQ-CDE-LIQ                                       
040700         PERFORM 3045-LIQ                                                 
040800     WHEN TR241-REC-TYP-LSU-CDE-LSU                                       
040900         PERFORM 3050-LSU                                                 
041000     END-EVALUATE.                                                        
041200                                                                          
041300     IF TR241-REC-TYP-HDR-CDE-HDR                                         
041400         CONTINUE                                                         
041500     ELSE                                                                 
041600         IF PV-LINES-USED >= PC-PAGE-SIZE-054                             
041700            PERFORM 8000-WRITE-HEADINGS                                   
041710            PERFORM 8010-WRITE-ENTRY-ID-HEADINGS                          
041800         END-IF                                                           
041900         PERFORM 8050-WRITE-DTL-HDRS                                      
042000         PERFORM 8060-WRITE-DTL-LINES                                     
042100     END-IF.                                                              
042200                                                                          
042300     PERFORM 7000-READ-DETAIL-FILE.                                       
042400                                                                          
042500/                                                                         
042600 3000-HDR.                                                                
042700     MOVE TR241-HDR-CONSOL-TRNS-DTE (5:2)                                 
042800                                      TO HL-TRANS-MM                      
042900     MOVE TR241-HDR-CONSOL-TRNS-DTE (7:2)                                 
043000                                      TO HL-TRANS-DD                      
043100     MOVE TR241-HDR-CONSOL-TRNS-DTE (3:2)                                 
043200                                      TO HL-TRANS-YY                      
043300     MOVE TR241-HDR-CONSOL-TRNS-TM (1:2)                                  
043400                                      TO HL-TRANS-TIME-HH                 
043500     MOVE TR241-HDR-CONSOL-TRNS-TM (3:2)                                  
043600                                      TO HL-TRANS-TIME-MM                 
043700                                                                          
043800     MOVE TR241-HDR-CONSOL-FIL-ID     TO HL1-FILE-ID                      
043900                                                                          
044000     MOVE TR241-HDR-LOAD-DTE (5:2)    TO HL-LOAD-MM                       
044100     MOVE TR241-HDR-LOAD-DTE (7:2)    TO HL-LOAD-DD                       
044200     MOVE TR241-HDR-LOAD-DTE (3:2)    TO HL-LOAD-YY                       
044300     MOVE TR241-HDR-LOAD-TM (1:2)     TO HL-LOAD-TIME-HH                  
044400     MOVE TR241-HDR-LOAD-TM (3:2)     TO HL-LOAD-TIME-MM                  
044500                                                                          
044600     MOVE TR241-HDR-CONSOL-ENTNME     TO HL2-EXPEDITOR.                   
045000/                                                                         
045100 3005-ENF.                                                                
045200     MOVE DL-ENF-HDR                  TO DL2-DETAIL-LIT                   
045300                                                                          
045400     MOVE TR241-ENF-FILD-DTE          TO PV-WORK-DATE                     
045500     MOVE TR241-ENF-FILD-TM           TO PV-WORK-TIME                     
045600     PERFORM 3100-FORMAT-DATE-TIME.                                       
045700     MOVE PV-DISP-DATE                TO DL-ENF-DATE                      
045800     MOVE PV-DISP-TIME                TO DL-ENF-TIME                      
045900     MOVE DL-ENF-LINE                 TO DL1-TEXT.                        
046000                                                                          
046100 3010-ENFBOL.                                                             
046200     MOVE DL-ENFBOL-HDR               TO DL2-DETAIL-LIT                   
046300                                                                          
046301     MOVE TR241-ENFBOL-MSTR-BOL-NBR   TO DL-ENFBOL-MASTER-BOL.            
046302     MOVE TR241-ENFBOL-HSE-BOL-NBR    TO DL-ENFBOL-HOUSE-BOL.             
046303     MOVE TR241-ENFBOL-CARR-SCAC-ID   TO DL-ENFBOL-CARR-SCAC-ID.          
046310     MOVE DL-ENFBOL-LINE              TO DL1-TEXT.                        
046800                                                                          
046900 3015-ENFCON.                                                             
047000     MOVE DL-ENFCON-HDR               TO DL2-DETAIL-LIT                   
047100     MOVE TR241-ENFCON-CONTNR-ID      TO DL-ENFCON-CONTAINER              
047200     MOVE DL-ENFCON-LINE              TO DL1-TEXT.                        
047300                                                                          
047400 3020-ENFPO.                                                              
047500     MOVE DL-ENFPO-HDR                TO DL2-DETAIL-LIT                   
047600     MOVE TR241-ENFPO-PO-NBR          TO DL-ENFPO-PO                      
047610     MOVE TR241-ENFPO-EXTL-REF-NBR    TO DL-ENFPO-EXTL-REF-NBR            
047620     MOVE TR241-ENFPO-FOB-CDE         TO DL-ENFPO-FOB-CDE                 
047700     MOVE DL-ENFPO-LINE               TO DL1-TEXT.                        
047800                                                                          
047900 3025-EXD.                                                                
048000     MOVE DL-EXD-HDR                  TO DL2-DETAIL-LIT                   
048100                                                                          
048200     MOVE TR241-EXD-EXM-DTE           TO PV-WORK-DATE                     
048300     MOVE TR241-EXD-EXM-TM            TO PV-WORK-TIME                     
048400     PERFORM 3100-FORMAT-DATE-TIME.                                       
048500     MOVE PV-DISP-DATE                TO DL-EXD-DATE                      
048600     MOVE PV-DISP-TIME                TO DL-EXD-TIME                      
048700     MOVE DL-EXD-LINE                 TO DL1-TEXT.                        
048800                                                                          
048900 3030-REJ.                                                                
049000     MOVE DL-REJ-HDR                  TO DL2-DETAIL-LIT                   
049100     MOVE TR241-REJ-REJ-DTE           TO PV-WORK-DATE                     
049200     MOVE TR241-REJ-REJ-TM            TO PV-WORK-TIME                     
049300     PERFORM 3100-FORMAT-DATE-TIME.                                       
049400     MOVE PV-DISP-DATE                TO DL-REJ-DATE                      
049500     MOVE PV-DISP-TIME                TO DL-REJ-TIME                      
049600     MOVE TR241-REJ-REJ-DESC          TO DL-REJ-DESC                      
049700     MOVE DL-REJ-LINE                 TO DL1-TEXT.                        
049800                                                                          
049900                                                                          
050000 3035-ECR.                                                                
050100                                                                          
050200     MOVE DL-ECR-HDR                  TO DL2-DETAIL-LIT                   
050300     MOVE TR241-ECR-EST-CLR-DTE       TO PV-WORK-DATE                     
050400     MOVE TR241-ECR-EST-CLR-TM        TO PV-WORK-TIME                     
050500     PERFORM 3100-FORMAT-DATE-TIME.                                       
050600     MOVE PV-DISP-DATE                TO DL-ECR-DATE                      
050700     MOVE PV-DISP-TIME                TO DL-ECR-TIME                      
050800     MOVE DL-ECR-LINE                 TO DL1-TEXT.                        
050900                                                                          
051000 3040-RLS.                                                                
051100                                                                          
051200     MOVE DL-RLS-HDR                  TO DL2-DETAIL-LIT                   
051300     MOVE TR241-RLS-ACTL-CLR-DTE      TO PV-WORK-DATE                     
051400     MOVE TR241-RLS-ACTL-CLR-TM       TO PV-WORK-TIME                     
051500     PERFORM 3100-FORMAT-DATE-TIME.                                       
051600     MOVE PV-DISP-DATE                TO DL-RLS-DATE                      
051700     MOVE PV-DISP-TIME                TO DL-RLS-TIME                      
051800     MOVE DL-RLS-LINE                 TO DL1-TEXT.                        
051900                                                                          
052000 3045-LIQ.                                                                
052100                                                                          
052200     MOVE DL-LIQ-HDR                  TO DL2-DETAIL-LIT                   
052300     MOVE TR241-LIQ-LQDN-DTE          TO PV-WORK-DATE                     
052400     MOVE TR241-LIQ-LQDN-TM           TO PV-WORK-TIME                     
052500     PERFORM 3100-FORMAT-DATE-TIME.                                       
052600     MOVE PV-DISP-DATE                TO DL-LIQ-DATE                      
052700     MOVE PV-DISP-TIME                TO DL-LIQ-TIME                      
052800     MOVE DL-LIQ-LINE                 TO DL1-TEXT.                        
052900                                                                          
053000 3050-LSU.                                                                
053100                                                                          
053200     MOVE DL-LSU-HDR                  TO DL2-DETAIL-LIT                   
053300     MOVE TR241-LSU-LQDN-SSPNN-DTE    TO PV-WORK-DATE                     
053400     MOVE TR241-LSU-LQDN-SSPNN-TM     TO PV-WORK-TIME                     
053500     PERFORM 3100-FORMAT-DATE-TIME.                                       
053600     MOVE PV-DISP-DATE                TO DL-LSU-DATE                      
053700     MOVE PV-DISP-TIME                TO DL-LSU-TIME                      
053800     MOVE TR241-LSU-LQDN-SSPNN-DESC   TO DL-LSU-DESC                      
053900     MOVE DL-LSU-LINE                 TO DL1-TEXT.                        
054000                                                                          
054001 3055-DOP.                                                                
054002                                                                          
054003     MOVE DL-DOP-HDR                  TO DL2-DETAIL-LIT.                  
054004     MOVE TR241-DOP-CONTNR-ID         TO DL-DOP-CONTAINER.                
054005     MOVE TR241-DOP-DELY-SNT-DTE      TO PV-WORK-DATE.                    
054006     MOVE TR241-DOP-DELY-SNT-TM       TO PV-WORK-TIME.                    
054007     PERFORM 3100-FORMAT-DATE-TIME.                                       
054008     MOVE PV-DISP-DATE                TO DL-DOP-DELY-SNT-DTE.             
054009     MOVE PV-DISP-TIME                TO DL-DOP-DELY-SNT-TM.              
054010     MOVE DL-DOP-LINE                 TO DL1-TEXT.                        
054020                                                                          
054100                                                                          
054200 3100-FORMAT-DATE-TIME.                                                   
054201                                                                          
054202     IF PV-WORK-DATE = PV-DEFAULT-DATE OR SPACES                          
054203       MOVE SPACES                     TO PV-DISP-DATE                    
054204     ELSE                                                                 
054205       MOVE PV-EDIT-DATE                TO PV-DISP-DATE                   
054206       MOVE PV-WORK-YY                  TO PV-DISP-YY                     
054207       MOVE PV-WORK-MM                  TO PV-DISP-MM                     
054208       MOVE PV-WORK-DD                  TO PV-DISP-DD                     
054209     END-IF.                                                              
054210                                                                          
054211     IF PV-WORK-TIME = PV-DEFAULT-TIME OR SPACES OR                       
054212        PV-WORK-DATE = PV-DEFAULT-DATE OR SPACES                          
054213       MOVE SPACES                     TO PV-DISP-TIME                    
054214     ELSE                                                                 
054215       MOVE PV-EDIT-TIME                TO PV-DISP-TIME                   
054216       MOVE PV-WORK-HOUR                TO PV-DISP-HOUR                   
054217       MOVE PV-WORK-MINUTE              TO PV-DISP-MINUTE                 
054218     END-IF.                                                              
054900/                                                                         
055000 7000-READ-DETAIL-FILE.                                                   
055100                                                                          
055200     READ DETAIL-FILE                                                     
055300        INTO TR241-RECORD                                                 
055400           AT END                                                         
055500              SET PS-EOF-DETAIL-FILE TO TRUE                              
055600     END-READ.                                                            
055700/                                                                         
055800 8000-WRITE-HEADINGS.                                                     
055900                                                                          
056000     ADD 1                TO PV-PAGE-COUNT.                               
056100     MOVE PV-PAGE-COUNT   TO DP132O-PAGE-NUMBER.                          
056200                                                                          
056300     WRITE DETAIL-REPORT-RECORD                                           
056310      FROM DP132O-STANDRD-HEADER-132-COLS                                 
056400        AFTER ADVANCING PAGE.                                             
056500                                                                          
056600     MOVE PC-HEADING-SIZE TO PV-LINES-USED.                               
056700                                                                          
056800     WRITE DETAIL-REPORT-RECORD FROM HL1-HEADING-LINE-1                   
056900        AFTER ADVANCING 1 LINE.                                           
057000                                                                          
057100     WRITE DETAIL-REPORT-RECORD FROM HL2-HEADING-LINE-2                   
057200        AFTER ADVANCING 1 LINE.                                           
057300                                                                          
057400     WRITE DETAIL-REPORT-RECORD FROM HL3-HEADING-LINE-3                   
057500        AFTER ADVANCING 2 LINES.                                          
057600                                                                          
057610 8010-WRITE-ENTRY-ID-HEADINGS.                                            
057670                                                                          
057700     WRITE DETAIL-REPORT-RECORD FROM HL4-HEADING-LINE-4                   
057800        AFTER ADVANCING 1 LINE.                                           
057900                                                                          
058000     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                           
058100                                                                          
058200 8050-WRITE-DTL-HDRS.                                                     
058300     WRITE DETAIL-REPORT-RECORD FROM DL-COMMON-HEADING-1                  
058400                 AFTER ADVANCING 2 LINES                                  
058500     WRITE DETAIL-REPORT-RECORD FROM DL-COMMON-HEADING-2                  
058600                 AFTER ADVANCING 1 LINE.                                  
058700     ADD 4                            TO PV-LINES-USED.                   
058800                                                                          
058900 8060-WRITE-DTL-LINES.                                                    
059000     MOVE TR241-REC-TYP-HDR-CDE       TO DL1-REC-TYPE.                    
059100     MOVE TR241-TRN-TYP               TO DL1-TRN-TYPE.                    
059200     MOVE TR241-POE-STD-EDI-CDE       TO DL1-POE-CODE.                    
059600                                                                          
059700     WRITE DETAIL-REPORT-RECORD FROM DL-DETAIL-LINE-1                     
059800                 AFTER ADVANCING 1 LINES.                                 
060500     ADD 2                            TO PV-LINES-USED.                   
060600/                                                                         
060700 9000-EOJ-ROUTINE.                                                        
060800                                                                          
060910     IF PV-LINES-USED > PC-PAGE-SIZE-060                                  
061000         PERFORM 8000-WRITE-HEADINGS                                      
061100     END-IF                                                               
061200                                                                          
061300     WRITE DETAIL-REPORT-RECORD FROM ER-END-OF-REPORT-LINE                
061400            AFTER ADVANCING 2 LINES                                       
061500                                                                          
063200     CLOSE DETAIL-FILE                                                    
063300           DETAIL-REPORT-FILE.                                            
