      ***************************************************************** 00010005
       IDENTIFICATION DIVISION.                                         00020005
      ***************************************************************** 00030005
                                                                        00040005
       PROGRAM-ID.             PCKRP037.                                00050005
       AUTHOR.                 BRENDA ROCKWELL.                         00060005
       INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070005
       DATE-WRITTEN            APRIL, 2012.                             00080005
       DATE-COMPILED.                                                   00090005
                                                                        00100005
      ***************************************************************** 00110005
      *  THIS PROGRAM WILL PRINT THE INBOUND NEW SKUS REPORT          * 00130005
      ***************************************************************** 00140005
                                                                        00150005
      ***************************************************************** 00160005
       ENVIRONMENT DIVISION.                                            00170005
      ***************************************************************** 00180005
                                                                        00190005
       CONFIGURATION SECTION.                                           00200005
       SOURCE-COMPUTER.        IBM-3090.                                00210005
       OBJECT-COMPUTER.        IBM-3090.                                00220005
                                                                        00230005
       INPUT-OUTPUT SECTION.                                            00240005
                                                                        00250005
       FILE-CONTROL.                                                    00260005
                                                                        00270005
           SELECT INPUT01-FILE       ASSIGN TO INP01.                   00280005
           SELECT REPORT-FILE        ASSIGN TO RPT01.                   00290005
                                                                        00300005
      ***************************************************************** 00310005
       DATA DIVISION.                                                   00320005
      ***************************************************************** 00330005
                                                                        00340005
       FILE SECTION.                                                    00350005
                                                                        00360005
       FD  INPUT01-FILE                                                 00370005
           LABEL RECORDS ARE STANDARD                                   00380005
           RECORDING MODE IS F                                          00390005
           BLOCK CONTAINS 0 RECORDS                                     00400005
           RECORD CONTAINS 200 CHARACTERS.                              00410005
       01  INPUT01-RECORD                  PIC X(200).                  00420005
                                                                        00430005
       FD  REPORT-FILE                                                  00440005
           RECORDING MODE IS F                                          00450005
           BLOCK CONTAINS 0  RECORDS.                                   00460005
       01  REPORT-RECORD                   PIC  X(200).                 00470005
                                                                        00480005
       WORKING-STORAGE SECTION.                                         00490005
                                                                        00500005
       01  PROGRAM-SWITCHES.                                            00510005
           05  PS-END-OF-INPUT-SW          PIC  X(01)    VALUE 'N'.     00520005
               88  PS-END-OF-INPUT                       VALUE 'Y'.     00530005
           05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00540005
               88  PS-FIRST-TIME                         VALUE 'Y'.     00550005
                                                                        00560005
       01  PC-CONSTANTS.                                                00570005
           05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00580005
                                 'PCKRP037'.                            00590005
           05  PC-REPORT-NBR               PIC  X(02)    VALUE          00600005
                                 '-1'.                                  00610005
                                                                        00620005
       01  PV-MISC-FIELDS.                                              00630005
           05  PV-LINE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00640005
           05  PV-NBR-OF-LINES             PIC S9(05) COMP-3 VALUE +0.  00650005
           05  PV-LINE-LIMIT               PIC S9(03) COMP-3 VALUE +57. 00660005
           05  PV-PAGE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00670005
           05  PV-USER-NAME                PIC X(25)     VALUE SPACES.  00680005
           05  PV-HOLD-NUMERIC             PIC 9(9)      VALUE ZERO.    00690005
           05  PV-TOTAL-CARTONS            PIC S9(9) COMP-3 VALUE +0.   00700005
           05  PV-TOTAL-SSCC               PIC S9(9) COMP-3 VALUE +0.   00710005
           05  PV-TOTAL-UNITS              PIC S9(9) COMP-3 VALUE +0.   00720005
           05  PV-TODAYS-DATE.                                          00730005
               10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    00740005
               10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    00750005
               10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    00760005
           05  PV-TODAYS-TIME.                                          00770005
               10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    00780005
               10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    00790005
               10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    00800005
               10  FILLER                  PIC  9(02)    VALUE ZERO.    00810005
           05  PV-FORMAT-DATE.                                          00820005
               10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  00830005
               10  FILLER                  PIC  X(01)    VALUE '/'.     00840005
               10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  00850005
               10  FILLER                  PIC  X(01)    VALUE '/'.     00860005
               10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  00870005
           05  PV-EFC-LOCATION             PIC 9(04)         VALUE 0.   00880005
                                                                        00890005
      ****************************************************              00900005
      * INPUT01 COPYBOOK                                 *              00910005
      ****************************************************              00920005
           COPY PCRD071.                                                00930005
                                                                        00940005
      ******************************************************************00950005
      *    STANDARD HEADER FOR 200 COLUMN REPORT                       *00960005
      ******************************************************************00970005
           COPY DPWS200O.                                               00980005
                                                                        00990005
       01  HDR-LINES.                                                   01000005
           05  HDR01-LINE.                                              01010005
               10  FILLER                  PIC  X(90)    VALUE SPACES.  01020005
               10  FILLER                  PIC  X(20)    VALUE          01030005
                   'INBOUND NEW SKUS    '.                              01040005
               10  FILLER                  PIC  X(40)    VALUE SPACES.  01050005
           05  HDR02-LINE.                                              01060005
               10  FILLER                  PIC  X(17)    VALUE          01070005
                   'EFC............: '.                                 01080005
               10  HDR02-EFC               PIC  ZZZZ9.                  01090005
               10  FILLER                  PIC  X(02)    VALUE SPACES.  01100005
               10  HDR02-EFC-DESCRIPTION   PIC  X(40)    VALUE SPACES.  01110005
               10  FILLER                  PIC  X(86)    VALUE SPACES.  01120005
           05  HDR03-LINE.                                              01130005
               10  FILLER                  PIC  X(45)    VALUE          01140005
                   '                                             '.     01150008
               10  FILLER                  PIC  X(45)    VALUE          01160005
                   ' UNIT OUT IN  DEPT                           '.     01170009
               10  FILLER                  PIC  X(45)    VALUE          01171005
                   '            PO                               '.     01172011
               10  FILLER                  PIC  X(45)    VALUE          01173005
                   '    SHP                                      '.     01174018
               10  FILLER                  PIC  X(20)    VALUE          01175015
                   ' ARRIVAL            '.                              01176016
           05  HDR04-LINE.                                              01190005
               10  FILLER                  PIC  X(45)    VALUE          01200005
                   'EFC   SKU     SKU DESCRIPTION                '.     01210005
               10  FILLER                  PIC  X(45)    VALUE          01220005
                   ' QTY  PAK PAK NBR   DEPT  NAME               '.     01230006
               10  FILLER                  PIC  X(45)    VALUE          01240005
                   'PO   RCVR LINE LENGTH WIDTH  HEIGHT WEIGHT S/'.     01250017
               10  FILLER                  PIC  X(45)    VALUE          01260005
                   'N/C ALN HAZ BRKBL  TRIP     SCAC TRAILER #   '.     01261017
               10  FILLER                  PIC  X(20)    VALUE          01262006
                   ' DATE      LOC      '.                              01263017
           05  HDR05-LINE.                                              01270005
               10  FILLER                  PIC  X(45)    VALUE          01280005
                   '---- -------- ------------------------------ '.     01290005
               10  FILLER                  PIC  X(45)    VALUE          01300005
                   '----- --- --- ---- --------------------- ----'.     01310011
               10  FILLER                  PIC  X(45)    VALUE          01320005
                   '---- ---- ---- ------ ------ ------ ------ --'.     01330015
               10  FILLER                  PIC  X(45)    VALUE          01340005
                   '--- --- --- ----- --------- ---- ---------- -'.     01341019
               10  FILLER                  PIC  X(20)    VALUE          01342005
                   '--------- -----     '.                              01343019
           05  BLANK-LINE                  PIC X(200)    VALUE SPACES.  01350005
           05  END-OF-REPORT-LINE.                                      01360005
               10  FILLER                  PIC  X(44)    VALUE SPACES.  01370005
               10  FILLER                  PIC  X(45)    VALUE          01380005
                   '*******   E N D   O F   R E P O R T   *******'.     01390005
               10  FILLER                  PIC  X(43)    VALUE SPACES.  01400005
           05  NO-DATA-TO-REPORT-LINE.                                  01410005
               10  FILLER                  PIC  X(40)    VALUE SPACES.  01420005
               10  FILLER                  PIC  X(52)    VALUE          01430005
               '*******  N O   D A T A   T O   R E P O R T   *******'.  01440005
               10  FILLER                  PIC  X(40)    VALUE SPACES.  01450005
                                                                        01460005
       01  DETAIL-LINES.                                                01470005
           05  DTL01-LINE.                                              01480005
               10  DTL01-EFC               PIC  Z999.                   01490005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01500005
               10  DTL01-SKU               PIC  X(08)    VALUE SPACES.  01510005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01520005
               10  DTL01-SKU-DESC          PIC  X(30)    VALUE SPACES.  01521005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01522005
               10  DTL01-QTY               PIC  ZZZZ9   BLANK WHEN ZERO.01522105
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01522205
               10  DTL01-OTPK-QTY          PIC  ZZ9     BLANK WHEN ZERO.01522306
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01522410
               10  DTL01-INPK-QTY          PIC  ZZ9     BLANK WHEN ZERO.01522506
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01522610
               10  DTL01-DEPT-NBR          PIC  ZZ9     BLANK WHEN ZERO.01522706
               10  FILLER                  PIC  X(02)    VALUE SPACES.  01522806
               10  DTL01-DEPT-NAME         PIC  X(20)    VALUE SPACES.  01523005
               10  FILLER                  PIC  X(02)    VALUE SPACES.  01524014
               10  DTL01-PO                PIC ZZZZZZZ9 BLANK WHEN ZERO.01530005
               10  FILLER                  PIC  X(01)    VALUE ' '.     01540005
               10  DTL01-RECEIVER          PIC  ZZZ9    BLANK WHEN ZERO.01550005
               10  FILLER                  PIC  X(01)    VALUE ' '.     01551005
               10  DTL01-PO-LNE            PIC  ZZZ9    BLANK WHEN ZERO.01552005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01560005
               10  DTL01-LENGTH            PIC  ZZZ.99  BLANK WHEN ZERO.01570005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01580005
               10  DTL01-WIDTH             PIC  ZZZ.99  BLANK WHEN ZERO.01581005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01582005
               10  DTL01-HEIGHT            PIC  ZZZ.99  BLANK WHEN ZERO.01583005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01584005
               10  DTL01-WEIGHT            PIC  ZZZ.99  BLANK WHEN ZERO.01585005
               10  FILLER                  PIC  X(03)    VALUE SPACES.  01586005
               10  DTL01-SORT-NONSORT      PIC  X(01)    VALUE SPACES.  01630005
               10  FILLER                  PIC  X(04)    VALUE SPACES.  01640005
               10  DTL01-SHIP-ALONE        PIC  X(01)    VALUE SPACES.  01650005
               10  FILLER                  PIC  X(03)    VALUE SPACES.  01660005
               10  DTL01-HAZ-IND           PIC  X(01)    VALUE SPACES.  01670005
               10  FILLER                  PIC  X(04)    VALUE SPACES.  01680005
               10  DTL01-BRKBL-IND         PIC  X(01)    VALUE SPACES.  01681005
               10  FILLER                  PIC  X(03)    VALUE SPACES.  01682005
               10  DTL01-TRIP-ID           PIC  9(09)  BLANK WHEN ZERO. 01690005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01691005
               10  DTL01-SCAC              PIC  X(04)    VALUE SPACES.  01692005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01693005
               10  DTL01-TRAILER           PIC  X(10)    VALUE SPACES.  01694005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01695005
               10  DTL01-ARRIVAL-DT        PIC  X(10)    VALUE SPACES.  01696005
               10  FILLER                  PIC  X(01)    VALUE SPACES.  01697005
               10  DTL01-LOC               PIC  X(05)    VALUE SPACES.  01698005
                                                                        01800005
      ******************************************************            01810005
      *  XLT00010 - DC LOCATION TABLE                      *            01820005
      ******************************************************            01830005
           EXEC SQL                                                     01840005
                INCLUDE XLT00010                                        01850005
           END-EXEC.                                                    01860005
                                                                        01870005
      ******************************************************            01880005
      *  DB2 AREA FOR COMMUNICATIONS                       *            01890005
      ******************************************************            01900005
           EXEC SQL                                                     01910005
                INCLUDE SQLCA                                           01920005
           END-EXEC.                                                    01930005
                                                                        01940005
           COPY SQLCA2.                                                 01950005
                                                                        01960005
       PROCEDURE DIVISION.                                              01970005
                                                                        01980005
           DISPLAY '***BEGINNING PCKRP037***'.                          01990005
      ******************************************************            02000005
      * 0000-MAINLINE.                                     *            02010005
      ******************************************************            02020005
       0000-MAINLINE.                                                   02030005
                                                                        02040005
           PERFORM 0010-INITIALIZATION.                                 02050005
                                                                        02060005
           PERFORM 1000-PROCESS-INPUT                                   02070005
              THRU 1000-PROCESS-INPUT-EXIT                              02080005
               UNTIL ( PS-END-OF-INPUT ).                               02090005
                                                                        02100005
           PERFORM 0020-END-PROGRAM.                                    02110005
           GOBACK.                                                      02120005
                                                                        02130005
      ******************************************************            02140005
      * 0010-INITIALIZATION.                               *            02150005
      ******************************************************            02160005
       0010-INITIALIZATION.                                             02170005
                                                                        02180005
           OPEN INPUT  INPUT01-FILE                                     02190005
                OUTPUT REPORT-FILE.                                     02200005
                                                                        02210005
           ACCEPT PV-TODAYS-DATE   FROM DATE.                           02220005
           ACCEPT PV-TODAYS-TIME   FROM TIME.                           02230005
                                                                        02240005
           MOVE PV-TODAYS-DATE-MM      TO DP200O-RUN-MONTH.             02250005
           MOVE PV-TODAYS-DATE-DD      TO DP200O-RUN-DAY.               02260005
           MOVE PV-TODAYS-DATE-YY      TO DP200O-RUN-YEAR.              02270005
           MOVE PV-TODAYS-TIME-HH      TO DP200O-RUN-HOUR.              02280005
           MOVE PV-TODAYS-TIME-MM      TO DP200O-RUN-MINUTE.            02290005
           MOVE PC-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.          02300005
           MOVE PC-REPORT-NBR          TO DP200O-REPORT-NUMBER.         02310005
                                                                        02320005
           PERFORM 9050-REPORT-HEADERS.                                 02330005
                                                                        02340005
      ******************************************************            02350005
      * 0020-END-PROGRAM.                                  *            02360005
      ******************************************************            02370005
       0020-END-PROGRAM.                                                02380005
                                                                        02390005
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           02420005
               PERFORM 9050-REPORT-HEADERS                              02430005
           END-IF.                                                      02440005
                                                                        02450005
           IF ( PS-FIRST-TIME )                                         02460005
               WRITE REPORT-RECORD FROM NO-DATA-TO-REPORT-LINE          02470005
                    AFTER ADVANCING 2 LINES                             02480005
           END-IF.                                                      02490005
                                                                        02500005
           WRITE REPORT-RECORD FROM END-OF-REPORT-LINE                  02510005
                AFTER ADVANCING 3 LINES.                                02520005
                                                                        02530005
           CLOSE INPUT01-FILE                                           02540005
                 REPORT-FILE.                                           02550005
                                                                        02560005
      ******************************************************            02570005
      * 1000-PROCESS-INPUT.                                *            02580005
      ******************************************************            02590005
       1000-PROCESS-INPUT.                                              02600005
                                                                        02610005
           READ INPUT01-FILE INTO PC071-RECORD-LAYOUT                   02620005
               AT END MOVE 'Y' TO PS-END-OF-INPUT-SW                    02630005
                      GO TO 1000-PROCESS-INPUT-EXIT.                    02640005
                                                                        02650005
           IF ( PS-FIRST-TIME )                                         02660005
               MOVE 'N' TO PS-FIRST-TIME-SW                             02670005
               MOVE PC071-OPER-UNT-ID TO PV-EFC-LOCATION                02680005
                                         HDR02-EFC                      02690005
               PERFORM 2000-VALIDATE-EFC                                02700005
               PERFORM 9040-PAGE-HEADERS                                02710005
           END-IF.                                                      02720005
                                                                        02730005
           PERFORM 5000-REPORT-DETAIL.                                  02740005
                                                                        02750005
       1000-PROCESS-INPUT-EXIT.                                         02760005
           EXIT.                                                        02770005
                                                                        02780005
      ******************************************************            02790005
      * 2000-VALIDATE-EFC.                                 *            02800005
      ******************************************************            02810005
       2000-VALIDATE-EFC.                                               02820005
                                                                        02830005
           MOVE PV-EFC-LOCATION TO XLT00010-LOC-NBR.                    02840005
                                                                        02850005
           EXEC SQL                                                     02860005
               SELECT A.LOC_NM                                          02870005
                 INTO :XLT00010-LOC-NM                                  02880005
                 FROM XLT_LOC A                                         02890005
                WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 02900005
                 WITH UR                                                02910005
           END-EXEC.                                                    02920005
                                                                        02930005
           EVALUATE TRUE                                                02940005
             WHEN SQLCODE = ZERO                                        02950005
                 MOVE XLT00010-LOC-NM TO HDR02-EFC-DESCRIPTION          02960005
             WHEN OTHER                                                 02970005
                 MOVE SPACES          TO HDR02-EFC-DESCRIPTION          02980005
           END-EVALUATE.                                                02990005
                                                                        03000005
      ******************************************************            03180005
      * 5000-REPORT-DETAIL.                                *            03190005
      ******************************************************            03200005
       5000-REPORT-DETAIL.                                              03210005
                                                                        03220005
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03230005
               PERFORM 9050-REPORT-HEADERS                              03240005
               PERFORM 9040-PAGE-HEADERS                                03250005
           END-IF.                                                      03260005
                                                                        03270005
           MOVE PC071-OPER-UNT-ID        TO DTL01-EFC.                  03283005
           MOVE PC071-SKU-NBR            TO DTL01-SKU.                  03290005
           MOVE PC071-SKU-DESC           TO DTL01-SKU-DESC.             03290105
           MOVE PC071-SKU-QTY            TO DTL01-QTY.                  03290205
**GB 4/20/2012 BEG                                                      03290307
           MOVE PC071-OTPK-QTY           TO DTL01-OTPK-QTY.             03290520
           MOVE PC071-INPK-QTY           TO DTL01-INPK-QTY.             03290720
**GB 4/20/2012 END                                                      03290907
           MOVE PC071-DEPT-NBR           TO DTL01-DEPT-NBR.             03291005
           MOVE PC071-DEPT-NAME          TO DTL01-DEPT-NAME.            03291105
           MOVE PC071-PO-NBR             TO DTL01-PO.                   03291205
           MOVE PC071-REC-SEQ-NBR        TO DTL01-RECEIVER.             03291305
           MOVE PC071-PO-LNE-NBR         TO DTL01-PO-LNE.               03291405
           MOVE PC071-SKU-LENGTH         TO DTL01-LENGTH.               03291505
           MOVE PC071-SKU-WIDTH          TO DTL01-WIDTH.                03291605
           MOVE PC071-SKU-HEIGHT         TO DTL01-HEIGHT.               03291705
           MOVE PC071-SKU-WEIGHT         TO DTL01-WEIGHT.               03291805
           MOVE PC071-SORT-NONSORT       TO DTL01-SORT-NONSORT.         03292805
           MOVE PC071-SHIPALONE-IND      TO DTL01-SHIP-ALONE.           03292905
           MOVE PC071-HAZ-IND            TO DTL01-HAZ-IND.              03293005
           MOVE PC071-BRKBL-IND          TO DTL01-BRKBL-IND.            03293105
           MOVE PC071-TRIP-ID            TO DTL01-TRIP-ID.              03293205
           MOVE PC071-SCAC               TO DTL01-SCAC.                 03294005
           MOVE PC071-TRLR-NBR           TO DTL01-TRAILER.              03350005
           MOVE PC071-ARRIVAL-DATE       TO DTL01-ARRIVAL-DT.           03360005
           MOVE PC071-TRLR-LOC           TO DTL01-LOC.                  03370005
                                                                        03390005
           WRITE REPORT-RECORD FROM DTL01-LINE                          03400005
                  AFTER ADVANCING 1 LINE.                               03410005
                                                                        03420005
           ADD  +1 TO PV-LINE-CNT                                       03430005
                      PV-NBR-OF-LINES.                                  03440005
                                                                        03450005
      ******************************************************            03530005
      * 9040-PAGE-HEADERS.                                 *            03540005
      ******************************************************            03550005
       9040-PAGE-HEADERS.                                               03560005
                                                                        03570005
           IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03580005
               PERFORM 9050-REPORT-HEADERS                              03590005
           END-IF.                                                      03600005
                                                                        03610005
           WRITE REPORT-RECORD FROM HDR02-LINE                          03620005
                  AFTER ADVANCING 2 LINES.                              03630005
           WRITE REPORT-RECORD FROM HDR03-LINE                          03640005
                  AFTER ADVANCING 1 LINE.                               03650005
           WRITE REPORT-RECORD FROM HDR04-LINE                          03660005
                  AFTER ADVANCING 1 LINES.                              03670005
           WRITE REPORT-RECORD FROM HDR05-LINE                          03680005
                  AFTER ADVANCING 1 LINE.                               03690005
                                                                        03700005
           ADD  +5 TO PV-LINE-CNT.                                      03710005
                                                                        03720005
      ******************************************************            03730005
      * 9050-REPORT-HEADERS.                               *            03740005
      ******************************************************            03750005
       9050-REPORT-HEADERS.                                             03760005
                                                                        03770005
           ADD +1           TO PV-PAGE-CNT.                             03780005
           MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                      03790005
                                                                        03800005
           WRITE REPORT-RECORD FROM DP200O-STANDRD-HEADER-200-COLS      03810005
                  AFTER ADVANCING PAGE.                                 03820005
           WRITE REPORT-RECORD FROM HDR01-LINE                          03830005
                  AFTER ADVANCING 1 LINE.                               03840005
                                                                        03850005
           MOVE +2 TO PV-LINE-CNT.                                      03860005
                                                                        03870005
