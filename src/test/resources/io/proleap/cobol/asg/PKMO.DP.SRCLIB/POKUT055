000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000500 PROGRAM-ID.    POKUT055.                                         00040010
000600 AUTHOR.        RENEE SCHMITZ.                                    00050001
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000800 DATE-WRITTEN.  11/10/98.                                         00070001
000900 DATE-COMPILED.                                                   00080001
001000                                                                  00090007
001100******************************************************************00100001
001200*  THIS PROGRAM WILL STRIP FIELDS OFF THE DW ONORDER EXTRACT      00110001
001300*  CREATED IN POKUT028 - A NEW FILE WILL BE CREATED WHICH WILL    00120001
001400*  LOAD TSKSTOO NIGHTLY                                           00130011
003400******************************************************************00140001
      * DATE     WHO      DESCRIPTION                                 * 00150011
      * 100699   TKMA340  WR20353  - ADD ITEM NUMBER COLUMN TO TSKSTOO* 00160011
      ***************************************************************** 00170011
W24803* 05/13/03 - RAMAKRISHNA PRASAD V, IGSI - WR NO. 24803           *00172017
W24803*                                                                *00173020
W24803*       - COPY BOOK PORD018 HAS CHANGED FOR NI-SKU CONVERSION    *00174120
W24803*       - DEPARTMENT, CLASS, SEQUENCE NUMBER WERE REMOVED  FROM  *00176020
W24803*         THE OUTPUT RECORD LAYOUT PV-OUTPUT-RECORD              *00177020
W24803*       - RECORD LENGTH OF PO-ONORD-STRIPPED-RECWAS DECREASED    *00177222
W24803*         FROM 61 TO 53.                                         *00177322
W24803******************************************************************00178017
003600******************************************************************00180001
003700 ENVIRONMENT DIVISION.                                            00190001
003800******************************************************************00200001
003900                                                                  00210007
004000 CONFIGURATION SECTION.                                           00220001
004200 SOURCE-COMPUTER. IBM-3090.                                       00230001
004300 OBJECT-COMPUTER. IBM-3090.                                       00240001
004400                                                                  00250001
004500 INPUT-OUTPUT SECTION.                                            00260001
004600                                                                  00270001
004700 FILE-CONTROL.                                                    00280001
004800     SELECT PO-ONORD-EXT-FILE                                     00290001
004900         ASSIGN TO INP01.                                         00300001
005000     SELECT PO-ONORD-STRIPPED-FILE                                00310001
005100         ASSIGN TO OUT01.                                         00320001
005200                                                                  00330001
005300******************************************************************00340001
005400 DATA DIVISION.                                                   00350001
005500******************************************************************00360001
005600                                                                  00370001
005700 FILE SECTION.                                                    00380001
005800                                                                  00390001
005900 FD  PO-ONORD-EXT-FILE                                            00400001
006000     RECORDING MODE IS F                                          00410001
006100     LABEL RECORDS ARE STANDARD                                   00420001
006200     BLOCK CONTAINS 0 RECORDS.                                    00430001
006400 01  PO-ONORD-EXT-RECORD         PIC X(104).                      00441024
006600                                                                  00450001
006700 FD  PO-ONORD-STRIPPED-FILE                                       00460001
006800     RECORDING MODE IS F                                          00470001
006900     LABEL RECORDS ARE STANDARD                                   00480001
W24803     RECORD CONTAINS 53 CHARACTERS                                00490020
007100     BLOCK CONTAINS 0 RECORDS                                     00500001
007200     DATA RECORD IS PO-ONORD-STRIPPED-REC.                        00510001
W24803 01  PO-ONORD-STRIPPED-REC       PIC X(53).                       00521018
007500                                                                  00530001
007700 WORKING-STORAGE SECTION.                                         00540001
008500 01  PS-PROGRAM-SWITCHES.                                         00550001
008600     05  PS-END-OF-PO-ONORD-INPUT-SW PIC X  VALUE 'N'.            00560001
008700         88  PS-END-OF-PO-ONORD-INPUT       VALUE 'Y'.            00570001
009600                                                                  00580001
011400 01  PV-PROGRAM-VARIABLES.                                        00590001
014800     05  PV-OUTPUT-RECORD.                                        00600001
W24803         10  PV-ITEM-NBR            PIC S9(15)V COMP-3 VALUE 0.   00601015
014850         10  PV-STR-NBR-9           PIC S9(04) COMP  VALUE ZERO.  00650008
014851         10  PV-PO-NBR              PIC S9(09) COMP VALUE 0.      00660009
014860         10  PV-WEEK-DATE           PIC X(10)  VALUE SPACES.      00670001
014870         10  PV-OTB-PER-NBR         PIC X(06) VALUE SPACES.       00680021
015010         10  PV-UNT-QTY             PIC S9(09) COMP VALUE 0.      00690008
016300         10  PV-COST-AMT            PIC S9(9)V9(2) COMP-3 VALUE 0.00700008
016500         10  PV-RTL-PR-AMT          PIC S9(9)V9(2) COMP-3 VALUE 0.00710008
016601         10  PV-PROMO-IND           PIC X(01)  VALUE SPACES.      00720001
016610         10  PV-STR-PROMO-QTY       PIC S9(09) COMP VALUE 0.      00730008
016620                                                                  00750001
019200******************************************************************00760001
019300* PO ON-ORDER EXTRACT INPUT FILE LAYOUT                           00770001
019400******************************************************************00780001
019500     COPY PORD018.                                                00790001
020600                                                                  00800001
035500******************************************************************00810001
035600 PROCEDURE DIVISION.                                              00820001
035700******************************************************************00830001
035900 0000-MAINLINE.                                                   00840001
036100     OPEN INPUT  PO-ONORD-EXT-FILE                                00850001
036200          OUTPUT PO-ONORD-STRIPPED-FILE.                          00860001
036230                                                                  00870001
036300     PERFORM 1100-READ-INPUT-FILE                                 00880002
036400        UNTIL PS-END-OF-PO-ONORD-INPUT.                           00890001
039200                                                                  00900001
039400     CLOSE PO-ONORD-STRIPPED-FILE                                 00910001
039410           PO-ONORD-EXT-FILE.                                     00920001
039500                                                                  00930001
039600     GOBACK.                                                      00940001
042900                                                                  00950001
043000******************************************************************00960001
043100*  READ THE PO ONORDER EXTRACT FILE                              *00970001
043200******************************************************************00980001
043300 1100-READ-INPUT-FILE.                                            00990001
043400                                                                  01000001
043410     INITIALIZE PV-OUTPUT-RECORD.                                 01010001
043500     READ PO-ONORD-EXT-FILE                                       01020001
043600         INTO PO018-ONORD-EXTRACT-RECORD                          01030003
043700         AT END                                                   01040001
043800             SET PS-END-OF-PO-ONORD-INPUT TO TRUE                 01050001
043900     END-READ.                                                    01060005
043910                                                                  01070005
044000     IF NOT PS-END-OF-PO-ONORD-INPUT                              01080005
044720       PERFORM 2000-WRITE-RECORD                                  01090005
044900     END-IF.                                                      01100005
045000                                                                  01110005
055900******************************************************************01120001
055910*  WRITE A STRIPPED RECORD WHICH WILL BE LOADED INTO TSKSTOO     *01130006
055920******************************************************************01140006
056000 2000-WRITE-RECORD.                                               01150001
056003      MOVE PO018-ONORD-STORE-NBR   TO PV-STR-NBR-9.               01170006
056004      MOVE PO018-ONORD-WEEK-DATE   TO PV-WEEK-DATE.               01180006
056005      MOVE PO018-ONORD-PO-NBR      TO PV-PO-NBR.                  01190006
056006      MOVE PO018-ONORD-UNIT-QTY    TO PV-UNT-QTY.                 01200006
056007      MOVE PO018-ONORD-COST-AMT    TO PV-COST-AMT.                01210006
056008      MOVE PO018-ONORD-RTL-AMT     TO PV-RTL-PR-AMT.              01220006
056009      MOVE PO018-ONORD-PROMO-IND   TO PV-PROMO-IND.               01230006
056010      MOVE PO018-ONORD-PROMO-QTY   TO PV-STR-PROMO-QTY.           01240006
056011      MOVE PO018-ONORD-BOUGHT-DATE TO PV-OTB-PER-NBR.             01250001
056011      MOVE PO018-ONORD-ITEM-NBR    TO PV-ITEM-NBR.                01260013
056012                                                                  01270006
056020      WRITE PO-ONORD-STRIPPED-REC  FROM PV-OUTPUT-RECORD.         01280006
