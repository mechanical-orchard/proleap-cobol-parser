000300******************************************************************00030001
000400 IDENTIFICATION DIVISION.                                         00040001
000700 PROGRAM-ID.             SUKRF540.                                00070001
000800 AUTHOR.                 GERMAN BANDA.                            00080001
000900 INSTALLATION.           KOHLS.                                   00090001
001000 DATE-WRITTEN.           JANUARY  2001.                           00100001
001100 DATE-COMPILED.                                                   00110001
001200                                                                  00120001
001300******************************************************************00130001
001400* THIS PROGRAM WILL ALLOW THE USER TO ENTER THE TOTAL NUMBER OF   00140001
001500* UNITS IN A I-PACK. THE PROGRAM WILL THEN UPDATE THE INNER PACK  00150001
001600* QUANTITY ON TSUATRN.                                            00160001
001700******************************************************************00170001
263968*---------------------------------------------------------------* 00180006
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00181006
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00182006
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00183006
263968*---------------------------------------------------------------* 00184006
001900******************************************************************00190001
002000 ENVIRONMENT DIVISION.                                            00200001
002400 DATA DIVISION.                                                   00240001
002500******************************************************************00250001
002600                                                                  00260001
002700******************************************************************00270001
002800 WORKING-STORAGE SECTION.                                         00280001
002900******************************************************************00290001
003000 01  CA-COMMAREA.                                                 00300001
003100     COPY SUWS006.                                                00310005
003200    05  CA-PROGRAM-COMMAREA.                                      00320001
003300         10  CA-TOT-PREPK-QTY-X          PIC  X(05)  VALUE SPACE. 00330001
003400         10  CA-TOT-PREPK-QTY REDEFINES                           00340001
003500             CA-TOT-PREPK-QTY-X          PIC  9(05).              00350001
003600         10  CA-CNFRM-KEYED-QTY-SW       PIC  X(01)  VALUE 'N'.   00360001
003700             88  CA-CNFRM-KEYED-QTY                  VALUE 'Y'.   00370001
003800             88  CA-NO-CNFRM-KEYED-QTY               VALUE 'N'.   00380001
003900*                                                                 00390001
004000 01  DK-DB2-KEYS.                                                 00400001
004100     05  DK-UPC-QTY                      PIC S9(09) COMP.         00410001
004200     05  DK-SHIP-UNIT-NBR                PIC S9(18) COMP-3.       00420001
004300*                                                                 00430001
004400 01  PC-PROGRAM-CONSTANTS.                                        00440001
004500     05  PC-N                            PIC  X(01)  VALUE 'N'.   00450001
004600     05  PC-PO                           PIC  X(02)  VALUE 'PO'.  00460001
004700     05  PC-RCV                          PIC  X(03)  VALUE 'RCV'. 00470001
004800     05  PC-0                            PIC  X(01)  VALUE '0'.   00480001
004900     05  PC-4                            PIC  X(01)  VALUE '4'.   00490001
005000     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   00500001
005100     05  PC-0-9                          PIC  9(01)  VALUE 0.     00510001
005200     05  PC-ACTIVE                       PIC  X(01)  VALUE 'A'.   00520001
005300     05  PC-18                           PIC S9(04)  VALUE 18     00530001
005400                                                     COMP SYNC.   00540001
005500     05  PC-19                           PIC S9(04)  VALUE 19     00550001
005600                                                     COMP SYNC.   00560001
005700     05  PC-01                           PIC  X(02)  VALUE '01'.  00570001
005800     05  PC-PF-PREPK-PACK-ERR-MSG        PIC  X(19)  VALUE        00580001
005900         'F9-PACKING ERROR   '.                                   00590001
006000     05  PC-PPK-QTY-WARNING-1            PIC  X(18)  VALUE        00600001
006100         'PACK QTY MUST BE  '.                                    00610001
006110     05  PC-PPK-QTY-WARNING-2            PIC  X(18)  VALUE        00611001
006120         'GREATER THAN 1    '.                                    00612001
006130*                                                                 00613001
006140     05  PC-UPC-QTY-WARNING-1            PIC  X(18)  VALUE        00614001
006150         'PACK QTY GREATER  '.                                    00615001
006160     05  PC-UPC-QTY-WARNING-2            PIC  X(18)  VALUE        00616001
006170         'THAN CRTN UPC QTY '.                                    00617001
006180*                                                                 00618001
006200     05  PC-UPC-CONFIRM-QTY              PIC  X(18)  VALUE        00620001
006300         'ENTER TO CONFIRM  '.                                    00630001
006400     05  PC-INVALID-PO                   PIC  X(18)  VALUE        00640001
006500         'INVALID PO        '.                                    00650001
006600     05  PC-RETURN-PGM                   PIC  X(08)  VALUE        00660001
006700         'SUKRF509'.                                              00670001
006800     05  PC-PRTR-VALIDATION-PGM          PIC  X(08)  VALUE        00680001
006900         'DPKCS060'.                                              00690001
007000     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00700001
007100         'SUKRF540'.                                              00710001
007200     05  PC-CARTON-CONTINUE-PGM          PIC  X(08)  VALUE        00720001
007300         'SUKRF512'.                                              00730001
007400     05  PC-AUDIT-CONT-PROGRAM           PIC  X(08)  VALUE        00740001
007500         'SUKRF520'.                                              00750001
007600     05  PC-AUDIT-CLOSE-PROGRAM          PIC  X(08)  VALUE        00760001
007700         'SUKRF516'.                                              00770001
007800     05  PC-SCAN-UPC-PROGRAM             PIC  X(08)  VALUE        00780001
007900         'SUKRF518'.                                              00790001
008000     05  PC-MESSAGE-PROGRAM              PIC  X(08)  VALUE        00800001
008100         'SUKRF514'.                                              00810001
008200     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'S540'.00820001
008300     05  PC-ENTER-THROUGH-MENU-MSG       PIC  X(19)  VALUE        00830001
008400         'ENTER THROUGH MENU '.                                   00840001
008500     05  PC-ENTER-CARTON-MSG             PIC  X(19)  VALUE        00850001
008600         'ENTER CARTON #     '.                                   00860001
008700     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        00870001
008800         'TRANS NOT AVAILABLE'.                                   00880001
008900     05  PC-MUST-BE-NUM-MSG              PIC  X(19)  VALUE        00890001
009000         'MUST BE NUMERIC    '.                                   00900001
009300     05  PC-CICS-ERR-MSG                 PIC  X(19)  VALUE        00930001
009400         'CICS ACCESS ERROR  '.                                   00940001
009500     05  PC-PREPK-QTY-NOT-NUMERIC          PIC  X(19)  VALUE      00950001
009600         'PREPK QTY NOT NUMIC'.                                   00960001
009610     05  PC-INVLD-QTY-FKEY-COMBO-1        PIC  X(19)  VALUE       00961001
009620         'PACK QTY MUST BE 0 '.                                   00962001
009630     05  PC-INVLD-QTY-FKEY-COMBO-2        PIC  X(19)  VALUE       00963001
009640         'FOR FKEY PROCESSING'.                                   00964001
010410     05  PC-EXCEED-MAX-QTY.                                       00965004
010420         10  FILLER        PIC X(12) VALUE  'CANT EXCEED '.       00966004
010430         10  PC-MAX-QTY    PIC Z(05) VALUE  ZEROES.               00967004
009700                                                                  00970001
009800                                                                  00980001
009900 01  PS-PROGRAM-SWITCHES.                                         00990001
010000     05  PS-CHECK-DIGIT-IND              PIC  X(01)  VALUE 'N'.   01000001
010100         88  PS-VALID-CHECK-DIGIT                    VALUE 'Y'.   01010001
010200         88  PS-INVALID-CHECK-DIGIT                  VALUE 'N'.   01020001
010300     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   01030001
010400         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   01040001
010500         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   01050001
010600     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   01060001
010700         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   01070001
010800         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   01080001
010900                                                                  01090001
011000 01  PV-PROGRAM-VARIABLES.                                        01100001
011400     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE ZERO   01140001
011500                                                     COMP SYNC.   01150001
011600     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 01160001
011700     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01170001
011800     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01180001
011900                                                     COMP SYNC.   01190001
012000     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01200001
012100     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   01210001
012200                                                     COMP.        01220001
012300     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   01230001
012400                                                     COMP SYNC.   01240001
012500     05  PV-EXP-QTY                      PIC S9(09)  VALUE ZERO   01250001
012600                                                     COMP.        01260001
012810     05  PV-TOTAL-SHPD-QTY               PIC S9(09)  VALUE ZERO   01281001
012820                                                     COMP.        01282001
012900******************************************************************01290001
013000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01300001
013100******************************************************************01310001
013200     COPY DFHAID.                                                 01320001
013300                                                                  01330001
014000******************************************************************01400001
014100*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                01410001
014200******************************************************************01420001
014300     COPY DPWS013.                                                01430005
014400                                                                  01440001
014500******************************************************************01450001
014600*  SENDING/RECEIVING AREA FOR THE                                 01460001
014700*  PRINTER VALIDATION ROUTING (DPKCS060)                          01470001
014800******************************************************************01480001
014900     COPY DPWS072.                                                01490005
015000                                                                  01500001
015100******************************************************************01510001
015200*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        01520001
015300******************************************************************01530001
015400     COPY DPWS008.                                                01540005
015500                                                                  01550001
015600******************************************************************01560001
015700*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01570001
015800*****************************************************************.01580001
015900     COPY DPWS010I.                                               01590005
016000                                                                  01600001
016100******************************************************************01610001
016200*  RANDOM NUMBER AREA.                                            01620001
016300******************************************************************01630001
016400     COPY DPWS902.                                                01640005
016500                                                                  01650001
016600******************************************************************01660001
016700*  GENERATED DSECT FOR THE SUKM540 MAPSET                         01670001
016800******************************************************************01680001
016900     COPY SUKM540.                                                01690005
017000                                                                  01700001
017100******************************************************************01710001
017200*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01720001
017300******************************************************************01730001
017400     COPY DPWS015.                                                01740005
017500                                                                  01750001
017510*----------------------------------------------------------------*01751001
017520* HELP SCREEN COMMAREA                                            01752001
017530     COPY PCWS192.                                                01753001
017540*----------------------------------------------------------------*01754001
017550* HELP SCREEN WORK AREA                                           01755001
017560     COPY PCWS188.                                                01756001
017570                                                                  01757001
017600                                                                  01760001
017700******************************************************************01770001
017800*  TEMPORARY STORAGE QUEUE LAYOUT FOR LOGON/UNIT RELATED          01780001
017900*  INFORMATION CAPTURED BY THE NAVIGATOR AT LOGON TIME            01790001
018000******************************************************************01800001
018100     COPY DPWS026.                                                01810005
018200                                                                  01820001
018300******************************************************************01830001
018400*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      01840001
018500*  TO BE DISPLAYED ON THE LRT                                     01850001
018600******************************************************************01860001
018700     COPY SUWS005.                                                01870005
018800                                                                  01880001
018900******************************************************************01890001
019000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      01900001
019100*  AUDIT TABLE (TSUATRN)                                          01910001
019200******************************************************************01920001
019300     EXEC SQL                                                     01930001
019400         INCLUDE TSUATRN                                          01940001
019500     END-EXEC.                                                    01950001
019600                                                                  01960001
019700******************************************************************01970001
019800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      01980001
019900*  AUDIT TRANSACTION EXCEPTION TABLE                              01990001
020000******************************************************************02000001
020100     EXEC SQL                                                     02010001
020200         INCLUDE TCTEXCP                                          02020001
020300     END-EXEC.                                                    02030001
020400                                                                  02040001
020500******************************************************************02050001
020510******************************************************************02051001
020520*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02052001
020530*  UPC TABLE                                                      02053001
020540******************************************************************02054001
020550     EXEC SQL                                                     02055001
020560         INCLUDE TSHUUPC                                          02056001
020570     END-EXEC.                                                    02057001
020580                                                                  02058001
021900*    PARAMETER TABLE                                              02058104
022000     EXEC SQL                                                     02058204
022100         INCLUDE TKRPRPM                                          02058304
022200     END-EXEC.                                                    02058404
022300                                                                  02058504
020590******************************************************************02059001
020600*  COMMUNICATIONS AREA FOR DB2                                    02060001
020700******************************************************************02070001
020800     EXEC SQL                                                     02080001
020900         INCLUDE SQLCA                                            02090001
021000     END-EXEC.                                                    02100001
021100                                                                  02110001
021200******************************************************************02120001
021300 LINKAGE SECTION.                                                 02130001
021400******************************************************************02140001
021500 01  DFHCOMMAREA.                                                 02150001
021600     05  FILLER                         OCCURS  1 TO 4072 TIMES   02160001
021700                                        DEPENDING ON EIBCALEN.    02170001
021800         10  FILLER                     PIC X.                    02180001
021900                                                                  02190001
022000                                                                  02200001
022100******************************************************************02210001
022200 PROCEDURE DIVISION.                                              02220001
022300******************************************************************02230001
022400 0000-PROGRAM-MAINLINE.                                           02240001
022500     MOVE DFHCOMMAREA  TO  CA-COMMAREA.                           02250001
022600     MOVE LOW-VALUES   TO  SU540AI.                               02260001
022800                                                                  02280001
022900     EVALUATE TRUE                                                02290001
022910****************************************************************  02291003
022920* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        02292003
022930****************************************************************  02293003
022940         WHEN EIBTRNID = 'Z278'                                   02294003
022950             MOVE DFHCOMMAREA          TO PC192-COMMAREA          02295003
022960             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             02296003
022970             SET SU006-PROCESS-SCREEN  TO TRUE                    02297003
022980             INITIALIZE CA-TOT-PREPK-QTY                          02298003
022990             MOVE DP015-UNP-ALP-NOR-OFF      TO ATOTPKA           02299003
022991             MOVE -1                         TO ATOTPKL           02299103
022992             MOVE PC-PF-PREPK-PACK-ERR-MSG   TO AFKEYO            02299203
022993             MOVE SPACES                     TO AMSGLN1O          02299303
022994                                                AMSGLN2O          02299403
022995             PERFORM 8000-SEND-MAP                                02299503
022996             PERFORM 8200-RETURN-TRANID                           02299603
022997                                                                  02299703
023000         WHEN EIBCALEN = ZERO                                     02300001
023100         WHEN EIBAID = DFHCLEAR                                   02310001
023200         WHEN SU006-INITIALIZE-SCREEN                             02320001
023300             INITIALIZE CA-PROGRAM-COMMAREA                       02330001
023400             SET SU006-PROCESS-SCREEN  TO  TRUE                   02340001
023500             INITIALIZE CA-TOT-PREPK-QTY                          02350001
023800             MOVE DP015-UNP-ALP-NOR-OFF      TO ATOTPKA           02380001
023900             MOVE -1                         TO ATOTPKL           02390001
023910             MOVE PC-PF-PREPK-PACK-ERR-MSG   TO AFKEYO            02391001
024000             MOVE SPACES                     TO AMSGLN1O          02400001
024010                                                AMSGLN2O          02401001
024100             PERFORM 8000-SEND-MAP                                02410001
024200             PERFORM 8200-RETURN-TRANID                           02420001
024400                                                                  02440001
024500         WHEN EIBAID = DFHENTER                                   02450001
024600             PERFORM 1200-RECEIVE-MAP                             02460001
024700             PERFORM 1300-EDIT-SELECTION                          02470001
024800                                                                  02480001
026400             PERFORM 2240-SELECT-TSHUUPC                          02640001
026401             IF  CA-TOT-PREPK-QTY  > PV-TOTAL-SHPD-QTY            02640101
026402                 MOVE -1                   TO ATOTPKL             02640201
026403                 MOVE PC-UPC-QTY-WARNING-1 TO  AMSGLN1O           02640301
026404                 MOVE PC-UPC-QTY-WARNING-2 TO  AMSGLN2O           02640401
026405                 PERFORM 8100-SEND-DATA-ONLY                      02640501
026406                 PERFORM 8200-RETURN-TRANID                       02640601
026407             END-IF                                               02640701
026408                                                                  02640801
027500             PERFORM 7000-GET-MAX-QTY                             02641004
027510             IF CA-TOT-PREPK-QTY > KRPRPM-FUNC-QTY                02641104
027511                 MOVE KRPRPM-FUNC-QTY     TO PC-MAX-QTY           02641204
027512                 MOVE -1                  TO ATOTPKL              02641304
027513                 MOVE PC-EXCEED-MAX-QTY   TO AMSGLN1O             02641404
027514                 PERFORM 8100-SEND-DATA-ONLY                      02641504
027515                 PERFORM 8200-RETURN-TRANID                       02641604
027520             ELSE                                                 02641704
027700                 PERFORM 2250-UPDATE-TSUATRN                      02641804
027800                 MOVE PC-SCAN-UPC-PROGRAM                         02641904
027900                                      TO PV-TRANSFER-PROGRAM      02642004
028000                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            02642104
028010             END-IF                                               02642204
028100                                                                  02642304
027400         WHEN EIBAID = DFHPF3                                     02740001
027500             MOVE SU006-LAST-PROGRAM                              02750001
027600                                      TO PV-TRANSFER-PROGRAM      02760001
027700             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                02770001
027800                                                                  02780001
027810         WHEN EIBAID = DFHPF9                                     02781001
027811             PERFORM 1200-RECEIVE-MAP                             02781101
027812**           PERFORM 1300-EDIT-SELECTION                          02781201
027813                                                                  02781301
027814             IF CA-TOT-PREPK-QTY = 0                              02781401
027815                CONTINUE                                          02781501
027816             ELSE                                                 02781601
027817                MOVE -1                  TO ATOTPKL               02781701
027818                MOVE PC-INVLD-QTY-FKEY-COMBO-1                    02781801
027819                                         TO AMSGLN1O              02781901
027820                MOVE PC-INVLD-QTY-FKEY-COMBO-2                    02782001
027821                                         TO AMSGLN2O              02782101
027822                PERFORM 8100-SEND-DATA-ONLY                       02782201
027823                PERFORM 8200-RETURN-TRANID                        02782301
027824             END-IF                                               02782401
027825                                                                  02782501
027826             PERFORM 1600-UPDATE-SHIP-UNIT                        02782601
027828             PERFORM 2400-INSERT-TCTEXCP                          02782801
027829             MOVE SPACE TO SU006-PKGNG-CDE-IND                    02782901
027830                           SU006-PREPACK-CLOSED-IND               02783001
027831             MOVE PC-SCAN-UPC-PROGRAM                             02783101
027832                                      TO PV-TRANSFER-PROGRAM      02783201
027840             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                02784001
027850                                                                  02785001
027860         WHEN EIBAID = DFHPF1                                     02786001
027870              PERFORM 1400-HELP-SCREEN                            02787001
027880                                                                  02788001
027900         WHEN OTHER                                               02790001
028000             MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO  AMSGLN1O        02800001
028010             MOVE SPACES                      TO  AMSGLN2O        02801001
028100                                                                  02810001
028200     END-EVALUATE.                                                02820001
028300                                                                  02830001
028400     PERFORM 8100-SEND-DATA-ONLY.                                 02840001
028500     PERFORM 8200-RETURN-TRANID.                                  02850001
028600                                                                  02860001
028700     GOBACK.                                                      02870001
028800****************************************************************  02880001
028900* 1000-SETUP-SCREEN                                               02890001
029000*    INITIAL SETUP OF SCREEN FIELDS                               02900001
029100****************************************************************  02910001
029200 1000-SETUP-SCREEN.                                               02920001
029300                                                                  02930001
029500*                                                                 02950001
030600      INITIALIZE CA-PROGRAM-COMMAREA                              03060001
030700      MOVE SPACES                 TO SU006-SHIP-UNIT-NBR-X        03070001
030800                                                                  03080001
030900      MOVE DP015-UNP-ALP-NOR-OFF  TO ATOTPKA                      03090001
031000      MOVE -1                     TO ATOTPKL                      03100001
031100      MOVE SPACES                 TO AMSGLN1O                     03110001
031110                                     AMSGLN2O.                    03111001
031200                                                                  03120001
031400                                                                  03140001
031500*    IN ALL CASES, MOVE THE CURRENT COMMAREA TO THE SCREEN        03150001
031600*                                                                 03160001
031700*                                                                 03170001
031800 1200-RECEIVE-MAP.                                                03180001
031900     EXEC CICS                                                    03190001
032000         RECEIVE                                                  03200001
032100             MAP     ('SU540A')                                   03210001
032200             MAPSET  ('SUKM540')                                  03220001
032300             RESP    (PV-CICS-RESPONSE)                           03230001
032400     END-EXEC.                                                    03240001
032500                                                                  03250001
032600     EVALUATE TRUE                                                03260001
032700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03270001
032800              PERFORM 1210-RECEIVE-SCREEN-FIELDS                  03280001
032900         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                03290001
033000              CONTINUE                                            03300001
033100         WHEN OTHER                                               03310001
033200              MOVE '1200-RECEIVE-MAP'                             03320001
033300                                      TO DP013-PARAGRAPH          03330001
033400              MOVE 'UNABLE TO RECEIVE MAP'                        03340001
033500                                      TO DP013-MESSAGE-TEXT (1)   03350001
033600              SET DP013-LOGIC-ABEND   TO TRUE                     03360001
033700              SET DP013-NO-ROLLBACK   TO TRUE                     03370001
033800              PERFORM 9999-WRITE-CICS-LOG-MSG                     03380001
033900     END-EVALUATE.                                                03390001
034000*                                                                 03400001
034100 1210-RECEIVE-SCREEN-FIELDS.                                      03410001
034200*                                                                 03420001
034300     IF  ATOTPKL    > ZERO                                        03430001
034400         MOVE ATOTPKI                 TO CA-TOT-PREPK-QTY-X       03440001
034500     ELSE                                                         03450001
034600         IF ATOTPKA    = DP015-ERASE-EOF                          03460001
034700             MOVE SPACES              TO CA-TOT-PREPK-QTY-X       03470001
034800         END-IF                                                   03480001
034900     END-IF.                                                      03490001
035000                                                                  03500001
035100                                                                  03510001
035200*                                                                 03520001
035300**************************************************************    03530001
035400* EDIT ALL ENTERABLE FIELDS (OPERATING UNIT ID, AND SELECT)  *    03540001
035500**************************************************************    03550001
035600 1300-EDIT-SELECTION.                                             03560001
035700                                                                  03570001
035800*    VALIDATE THE UPC NUMBER THAT WAS ENTERED (IF ANY)            03580001
035900     IF CA-TOT-PREPK-QTY-X > SPACES                               03590001
036000        IF CA-TOT-PREPK-QTY   > 1                                 03600001
036100            MOVE CA-TOT-PREPK-QTY-X TO DP010I-UNEDITED-FIELD      03610001
036200            MOVE LENGTH OF CA-TOT-PREPK-QTY TO                    03620001
036300                                          DP010I-MAXIMUM-DIGITS   03630001
036400            MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS  03640001
036500            SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE               03650001
036600                                                                  03660001
263968            CALL DP010I-NUMERIC-EDIT-ROUTINE                      03671006
263968                 USING DP010I-NUMERIC-EDIT-AREA                   03672006
036800                                                                  03680001
036900            IF  DP010I-ERROR-DETECTED                             03690001
037000                MOVE -1                  TO ATOTPKL               03700001
037100                MOVE PC-PREPK-QTY-NOT-NUMERIC                     03710001
037200                                         TO AMSGLN1O              03720001
037210                MOVE SPACES              TO AMSGLN2O              03721001
037300                PERFORM 8100-SEND-DATA-ONLY                       03730001
037400                PERFORM 8200-RETURN-TRANID                        03740001
037500            ELSE                                                  03750001
037600                MOVE DP010I-NUMERIC-FIELD TO CA-TOT-PREPK-QTY     03760001
037800            END-IF                                                03780001
037900        ELSE                                                      03790001
038000            MOVE -1                   TO ATOTPKL                  03800001
038100            MOVE PC-PPK-QTY-WARNING-1 TO  AMSGLN1O                03810001
038110            MOVE PC-PPK-QTY-WARNING-2 TO  AMSGLN2O                03811001
038200            PERFORM 8100-SEND-DATA-ONLY                           03820001
038300            PERFORM 8200-RETURN-TRANID                            03830001
038400        END-IF                                                    03840001
038500     END-IF.                                                      03850001
038600                                                                  03860001
038601 1400-HELP-SCREEN.                                                03860101
038602     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03860201
038603     MOVE 'SUKRF540'                  TO PC192-PROGRAM-NAME       03860301
038604     COPY PCPD188.                                                03860401
038605     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03860501
038606     PERFORM 4200-XCTL-TO-HELP.                                   03860601
038607                                                                  03860701
038610***************************************************************** 03861001
038620*   1600-UPDATE-SHIP-UNIT                                       * 03862001
038630* UPDATE THE AUDIT ERROR INDICATOR TO SAY THERE ARE EXCEPTIONS  * 03863001
038640* FOR THIS SHIPPING UNIT AUDIT                                  * 03864001
038650***************************************************************** 03865001
038660 1600-UPDATE-SHIP-UNIT.                                           03866001
038670                                                                  03867001
038680     MOVE SU006-AUDIT-CNTL-NBR TO SUATRN-AUD-CNTL-NBR.            03868001
038690     MOVE SU006-SHIP-UNIT-NBR TO SUATRN-SHIPT-UNT-ID.             03869001
038691                                                                  03869101
038692     EXEC SQL                                                     03869201
038693         UPDATE TSUATRN                                           03869301
038694            SET UNT_AUD_ERR_IND = 'Y'                             03869401
038695         WHERE   AUD_CNTL_NBR = :SUATRN-AUD-CNTL-NBR              03869501
038696           AND   SHIPT_UNT_ID = :SUATRN-SHIPT-UNT-ID              03869601
038697     END-EXEC                                                     03869701
038698                                                                  03869801
038699     EVALUATE TRUE                                                03869901
038700         WHEN SQLCODE = ZERO                                      03870001
038701             SET SU006-AUD-ERR TO TRUE                            03870101
038702                                                                  03870201
038703         WHEN SQLWARN0 NOT = SPACES                               03870301
038704         WHEN SQLCODE < ZERO                                      03870401
038705         WHEN SQLCODE > ZERO                                      03870501
038706             MOVE '1600-UPDATE-SHIP-UNIT'                         03870601
038707                 TO DP013-PARAGRAPH                               03870701
038708             MOVE 'UPDATE THE AUDIT ERROR CODE'                   03870801
038709                 TO DP013-MESSAGE-TEXT (1)                        03870901
038710             MOVE SU006-AUDIT-CNTL-NBR-X TO DP013-MESSAGE-TEXT(2) 03871001
038711             MOVE SU006-SHIP-UNIT-NBR-X  TO DP013-MESSAGE-TEXT(3) 03871101
038712             MOVE SQLCA                  TO DP013-SQLCA           03871201
038713             MOVE 'TSUATRN'            TO DP013-DB2-TABLE-NAME(1) 03871301
038714             SET DP013-DB2-ABEND         TO TRUE                  03871401
038715             SET DP013-NO-ROLLBACK       TO TRUE                  03871501
038716             PERFORM 9999-WRITE-CICS-LOG-MSG                      03871601
038717             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLN1O              03871701
038718             MOVE SPACES                 TO AMSGLN2O              03871801
038719             PERFORM 8100-SEND-DATA-ONLY                          03871901
038720             PERFORM 8200-RETURN-TRANID                           03872001
038721     END-EVALUATE.                                                03872101
038722                                                                  03872201
038730*                                                                 03873001
038800 2100-XCTL-TO-SELECTED-PROGRAM.                                   03880001
038900     SET SU006-INITIALIZE-SCREEN   TO  TRUE.                      03890001
039000     MOVE LENGTH OF CA-COMMAREA    TO  PV-COMMAREA-LENGTH.        03900001
039100     MOVE PC-CURRENT-PROGRAM-NAME  TO  SU006-LAST-PROGRAM.        03910001
039200                                                                  03920001
039300     EXEC CICS                                                    03930001
039400         XCTL                                                     03940001
039500             PROGRAM   (PV-TRANSFER-PROGRAM)                      03950001
039600             COMMAREA  (CA-COMMAREA)                              03960001
039700             LENGTH    (PV-COMMAREA-LENGTH)                       03970001
039800             RESP      (PV-CICS-RESPONSE)                         03980001
039900     END-EXEC.                                                    03990001
040000                                                                  04000001
040100     EVALUATE TRUE                                                04010001
040200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04020001
040300              CONTINUE                                            04030001
040400         WHEN OTHER                                               04040001
040500              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                04050001
040600                                     TO DP013-PARAGRAPH           04060001
040700              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       04070001
040800                                     TO DP013-MESSAGE-TEXT (1)    04080001
040900              MOVE PV-TRANSFER-PROGRAM                            04090001
041000                                     TO DP013-MESSAGE-TEXT (2)    04100001
041100              SET DP013-CICS-ABEND   TO TRUE                      04110001
041200              SET DP013-NO-ROLLBACK  TO TRUE                      04120001
041300              PERFORM 9999-WRITE-CICS-LOG-MSG                     04130001
041400              MOVE PM-TRANS-NOT-AVAILABLE-MSG                     04140001
041500                                     TO AMSGLN1O                  04150001
041510              MOVE SPACES                                         04151001
041520                                     TO AMSGLN2O                  04152001
041600              SET SU006-PROCESS-SCREEN TO TRUE                    04160001
041700              PERFORM 8100-SEND-DATA-ONLY                         04170001
041800              PERFORM 8200-RETURN-TRANID                          04180001
041900     END-EVALUATE.                                                04190001
042000                                                                  04200001
042100******************************************************************04210001
042200* UPDATE TSHPUNT - UPDATE ROW WITH LABEL SEQUENCE NUMBER         *04220001
042300******************************************************************04230001
042400 2240-SELECT-TSHUUPC.                                             04240001
042410                                                                  04241001
042500     INITIALIZE PV-TOTAL-SHPD-QTY                                 04250001
042800     MOVE  SU006-SHIP-UNIT-NBR TO  SHUUPC-SHIPT-UNT-ID            04280001
042810                                                                  04281001
042900     EXEC SQL                                                     04290001
042910          SELECT SUM(SHPD_QTY)                                    04291001
042930          INTO  :PV-TOTAL-SHPD-QTY                                04293001
042950          FROM   TSHUUPC                                          04295001
042960          WHERE  SHIPT_UNT_ID = :SHUUPC-SHIPT-UNT-ID              04296001
042961          WITH UR                                                 04296101
042970     END-EXEC.                                                    04297001
043000                                                                  04300001
044000                                                                  04400001
044100     EVALUATE TRUE                                                04410001
044200         WHEN SQLCODE = ZERO                                      04420001
044300              CONTINUE                                            04430001
044400         WHEN SQLCODE = +100                                      04440001
044410         WHEN SQLCODE = -305                                      04441001
044500              CONTINUE                                            04450001
044600         WHEN SQLWARN0 NOT = SPACES                               04460001
044700         WHEN SQLCODE NOT EQUAL ZERO                              04470001
044800             MOVE '2250-UPDATE-TSUATRN'                           04480001
044900                             TO DP013-PARAGRAPH                   04490001
045000             MOVE 'UPDATE INPK QTY  '                             04500001
045100                             TO DP013-MESSAGE-TEXT(1)             04510001
045200             MOVE SUATRN-SHIPT-UNT-ID                             04520001
045300                             TO DP013-MESSAGE-TEXT(2)             04530001
045400             MOVE SQLCA      TO DP013-SQLCA                       04540001
045500             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           04550001
045600             SET DP013-DB2-ABEND                                  04560001
045700                             TO TRUE                              04570001
045800             SET DP013-NO-ROLLBACK                                04580001
045900                             TO TRUE                              04590001
046000             PERFORM 9999-WRITE-CICS-LOG-MSG                      04600001
046100             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLN1O              04610001
046110             MOVE SPACES                 TO AMSGLN2O              04611001
046200             PERFORM 8100-SEND-DATA-ONLY                          04620001
046300             PERFORM 8200-RETURN-TRANID                           04630001
046400     END-EVALUATE.                                                04640001
046500                                                                  04650001
046600******************************************************************04660001
046601******************************************************************04660101
046602* UPDATE TSHPUNT - UPDATE ROW WITH LABEL SEQUENCE NUMBER         *04660201
046603******************************************************************04660301
046604 2250-UPDATE-TSUATRN.                                             04660401
046605                                                                  04660501
046606     MOVE  CA-TOT-PREPK-QTY    TO  SUATRN-INPK-QTY                04660601
046607     MOVE  SU006-AUDIT-CNTL-NBR TO SUATRN-AUD-CNTL-NBR            04660701
046608     MOVE  SU006-SHIP-UNIT-NBR TO  SUATRN-SHIPT-UNT-ID            04660801
046609                                                                  04660901
046610     EXEC SQL                                                     04661001
046611         UPDATE TSUATRN                                           04661101
046612         SET                                                      04661201
046613              INPK_QTY        =  :SUATRN-INPK-QTY                 04661301
046614          WHERE                                                   04661401
046615              AUD_CNTL_NBR    =  :SUATRN-AUD-CNTL-NBR             04661501
046616          AND SHIPT_UNT_ID    =  :SUATRN-SHIPT-UNT-ID             04661601
046617     END-EXEC.                                                    04661701
046618                                                                  04661801
046619     EVALUATE TRUE                                                04661901
046620         WHEN SQLCODE = ZERO                                      04662001
046621            MOVE  CA-TOT-PREPK-QTY TO SU006-KEYED-PACK-QTY        04662101
046622         WHEN SQLCODE = +100                                      04662201
046623              CONTINUE                                            04662301
046624         WHEN SQLWARN0 NOT = SPACES                               04662401
046625         WHEN SQLCODE NOT EQUAL ZERO                              04662501
046626             MOVE '2250-UPDATE-TSUATRN'                           04662601
046627                             TO DP013-PARAGRAPH                   04662701
046628             MOVE 'UPDATE INPK QTY  '                             04662801
046629                             TO DP013-MESSAGE-TEXT(1)             04662901
046630             MOVE SUATRN-SHIPT-UNT-ID                             04663001
046631                             TO DP013-MESSAGE-TEXT(2)             04663101
046632             MOVE SQLCA      TO DP013-SQLCA                       04663201
046633             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           04663301
046634             SET DP013-DB2-ABEND                                  04663401
046635                             TO TRUE                              04663501
046636             SET DP013-NO-ROLLBACK                                04663601
046637                             TO TRUE                              04663701
046638             PERFORM 9999-WRITE-CICS-LOG-MSG                      04663801
046639             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLN1O              04663901
046640             MOVE SPACES                 TO AMSGLN2O              04664001
046641             PERFORM 8100-SEND-DATA-ONLY                          04664101
046642             PERFORM 8200-RETURN-TRANID                           04664201
046643     END-EVALUATE.                                                04664301
046644                                                                  04664401
046645******************************************************************04664501
046650******************************************************************04665001
046700 2400-INSERT-TCTEXCP.                                             04670001
046800                                                                  04680001
046810     MOVE SU006-AUDIT-CNTL-NBR-X TO CTEXCP-AUD-CNTL-NBR           04681001
046820     MOVE SU006-SHIP-UNIT-NBR-X TO CTEXCP-SHIPT-UNT-ID            04682001
046830     MOVE '37'                TO CTEXCP-VILN-GP-SEQ-NBR           04683001
046840     MOVE SU006-PO            TO CTEXCP-OVRRID-SYS-DAT-TXT        04684001
046850                                                                  04685001
046900     EXEC SQL                                                     04690001
047000         INSERT INTO TCTEXCP                                      04700001
047100               (AUD_CNTL_NBR,                                     04710001
047200                SHIPT_UNT_ID,                                     04720001
047300                VILN_GP_CDE,                                      04730001
047400                VILN_GP_SEQ_NBR,                                  04740001
047500                OVRRID_SYS_DAT_TXT)                               04750001
047600         VALUES                                                   04760001
047700               (:CTEXCP-AUD-CNTL-NBR                              04770001
047800              , :CTEXCP-SHIPT-UNT-ID                              04780001
047900              , 'VA'                                              04790001
048000              , :CTEXCP-VILN-GP-SEQ-NBR                           04800001
048100              , :CTEXCP-OVRRID-SYS-DAT-TXT)                       04810001
048200     END-EXEC.                                                    04820001
048300                                                                  04830001
048400     EVALUATE TRUE                                                04840001
048500         WHEN SQLCODE = ZERO                                      04850001
048600             CONTINUE                                             04860001
048700         WHEN SQLWARN0 NOT = SPACES                               04870001
048800         WHEN SQLCODE NOT EQUAL ZERO                              04880001
048900             MOVE '2400-INSERT-TCTEXCP'                           04890001
049000                             TO DP013-PARAGRAPH                   04900001
049100             MOVE 'INSERT TCTEXCP      '                          04910001
049200                             TO DP013-MESSAGE-TEXT(1)             04920001
049300             MOVE CTEXCP-SHIPT-UNT-ID                             04930001
049400                             TO DP013-MESSAGE-TEXT(2)             04940001
049500             MOVE SQLCA      TO DP013-SQLCA                       04950001
049600             MOVE 'TCTEXCP'  TO DP013-DB2-TABLE-NAME(1)           04960001
049700             SET DP013-DB2-ABEND                                  04970001
049800                             TO TRUE                              04980001
049900             SET DP013-NO-ROLLBACK                                04990001
050000                             TO TRUE                              05000001
050100             PERFORM 9999-WRITE-CICS-LOG-MSG                      05010001
050200             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLN1O              05020001
050210             MOVE SPACES                 TO AMSGLN2O              05021001
050300             PERFORM 8100-SEND-DATA-ONLY                          05030001
050400             PERFORM 8200-RETURN-TRANID                           05040001
050500     END-EVALUATE.                                                05050001
050600                                                                  05060001
050601 4200-XCTL-TO-HELP.                                               05060101
050602                                                                  05060201
050603     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      05060301
050604     SET  SU006-INITIALIZE-SCREEN     TO TRUE.                    05060401
050605     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    05060501
050606                                                                  05060601
050607     EXEC CICS                                                    05060701
050608         XCTL                                                     05060801
050609             PROGRAM   (PV-TRANSFER-PROGRAM)                      05060901
050610             COMMAREA  (PC192-COMMAREA)                           05061001
050611             LENGTH    (PV-COMMAREA-LENGTH)                       05061101
050612             RESP      (PV-CICS-RESPONSE)                         05061201
050613     END-EXEC.                                                    05061301
050614                                                                  05061401
050615     EVALUATE TRUE                                                05061501
050616         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05061601
050617              CONTINUE                                            05061701
050618         WHEN OTHER                                               05061801
050619             MOVE '4200-XCTL-TO-HELP '                            05061901
050620                 TO DP013-PARAGRAPH                               05062001
050621             MOVE 'SUKRF540 - UNABLE TO XCTL TO PROGRAM: '        05062101
050622                 TO DP013-MESSAGE-TEXT (1)                        05062201
050623             MOVE PV-TRANSFER-PROGRAM                             05062301
050624                 TO DP013-MESSAGE-TEXT (2)                        05062401
050625             SET DP013-CICS-ABEND  TO TRUE                        05062501
050626             SET DP013-ROLLBACK TO TRUE                           05062601
050627             PERFORM 9999-WRITE-CICS-LOG-MSG                      05062701
050628             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLN1O            05062802
050629             SET SU006-PROCESS-SCREEN TO TRUE                     05062901
050630             PERFORM 8000-SEND-MAP                                05063001
050631             PERFORM 8200-RETURN-TRANID                           05063101
050632     END-EVALUATE.                                                05063201
062300/                                                                 05063404
062400 7000-GET-MAX-QTY.                                                05063504
062500                                                                  05063604
062600     EXEC SQL                                                     05063704
062700          SELECT FUNC_QTY                                         05063804
062800            INTO :KRPRPM-FUNC-QTY                                 05063904
062900            FROM TKRPRPM                                          05064004
063000           WHERE LOC_ID            = 90                           05064104
063100             AND INTFC_SYS_CDE    = 'KHL'                         05064204
063200             AND SYS_PRC_FUNC_CDE = 'AUDPKQ'                      05064304
063300             AND FUNC_PRC_STAT_CDE = 'AC'                         05064404
063400     END-EXEC.                                                    05064504
063500                                                                  05064604
063600     EVALUATE TRUE                                                05064704
063700         WHEN SQLCODE = ZERO                                      05064804
063800              CONTINUE                                            05064904
063900                                                                  05065004
064000         WHEN OTHER                                               05065104
064100             MOVE '7000-GET-MAX-QTY'                              05065204
064200                                         TO DP013-PARAGRAPH       05065304
064300             MOVE 'SELECT OF TKRPRPM-AUDMXQ'                      05065404
064400                                         TO DP013-MESSAGE-TEXT (1)05065504
064500             MOVE SQLCA                  TO DP013-SQLCA           05065604
064600             MOVE 'TKRPRPM'            TO DP013-DB2-TABLE-NAME (1)05065704
064700             SET DP013-DB2-ABEND         TO TRUE                  05065804
064800             SET DP013-NO-ROLLBACK       TO TRUE                  05065904
064900             PERFORM 9999-WRITE-CICS-LOG-MSG                      05066004
065000                                                                  05066104
065100             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLN1O              05066204
065200             MOVE -1                     TO ATOTPKL               05066304
065300             PERFORM 8100-SEND-DATA-ONLY                          05066404
065400             PERFORM 8200-RETURN-TRANID                           05066504
065500     END-EVALUATE.                                                05066604
065600                                                                  05066704
065700                                                                  05066804
050634******************************************************************05066901
050640*  8000-SEND-MAP                                                 *05067001
050700*  SEND THE REFRESHED MAP IMAGE TO THE SCREEN                    *05070001
050800******************************************************************05080001
050900 8000-SEND-MAP.                                                   05090001
051000     EXEC CICS                                                    05100001
051100         SEND                                                     05110001
051200             MAP     ('SU540A')                                   05120001
051300             MAPSET  ('SUKM540')                                  05130001
051400             ERASE                                                05140001
051500             RESP    (PV-CICS-RESPONSE)                           05150001
051600     END-EXEC.                                                    05160001
051700                                                                  05170001
051800     EVALUATE TRUE                                                05180001
051900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05190001
052000             CONTINUE                                             05200001
052100         WHEN OTHER                                               05210001
052200             MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH            05220001
052300             MOVE 'UNABLE TO SEND MAP'                            05230001
052400                                    TO DP013-MESSAGE-TEXT (1)     05240001
052500             SET DP013-CICS-ABEND   TO TRUE                       05250001
052600             SET DP013-NO-ROLLBACK  TO TRUE                       05260001
052700             PERFORM 9999-WRITE-CICS-LOG-MSG                      05270001
052800     END-EVALUATE.                                                05280001
052900*                                                                 05290001
053000 8100-SEND-DATA-ONLY.                                             05300001
053100                                                                  05310001
053200     EXEC CICS                                                    05320001
053300         SEND                                                     05330001
053400             MAP       ('SU540A')                                 05340001
053500             MAPSET    ('SUKM540')                                05350001
053600             CURSOR                                               05360001
053700             DATAONLY                                             05370001
053800             RESP      (PV-CICS-RESPONSE)                         05380001
053900     END-EXEC.                                                    05390001
054000                                                                  05400001
054100     EVALUATE TRUE                                                05410001
054200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05420001
054300             CONTINUE                                             05430001
054400         WHEN OTHER                                               05440001
054500             MOVE '8100-SEND-DATA-ONLY'                           05450001
054600                                    TO DP013-PARAGRAPH            05460001
054700             MOVE 'UNABLE TO SEND DATA'                           05470001
054800                                    TO DP013-MESSAGE-TEXT (1)     05480001
054900             SET DP013-CICS-ABEND   TO TRUE                       05490001
055000             SET DP013-NO-ROLLBACK  TO TRUE                       05500001
055100             PERFORM 9999-WRITE-CICS-LOG-MSG                      05510001
055200     END-EVALUATE.                                                05520001
055300*                                                                 05530001
055400 8200-RETURN-TRANID.                                              05540001
055500     MOVE LENGTH OF CA-COMMAREA  TO  PV-COMMAREA-LENGTH.          05550001
055600                                                                  05560001
055700     EXEC CICS                                                    05570001
055800         RETURN                                                   05580001
055900             TRANSID   (PC-CURRENT-TRANID)                        05590001
056000             COMMAREA  (CA-COMMAREA)                              05600001
056100             LENGTH    (PV-COMMAREA-LENGTH)                       05610001
056200             RESP      (PV-CICS-RESPONSE)                         05620001
056300     END-EXEC.                                                    05630001
056400                                                                  05640001
056500     EVALUATE TRUE                                                05650001
056600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05660001
056700             CONTINUE                                             05670001
056800         WHEN OTHER                                               05680001
056900             MOVE '8200-RETURN-TRANID'                            05690001
057000                                    TO DP013-PARAGRAPH            05700001
057100             MOVE 'UNABLE TO RETURN TO TRANID'                    05710001
057200                                    TO DP013-MESSAGE-TEXT (1)     05720001
057300             SET DP013-CICS-ABEND   TO TRUE                       05730001
057400             SET DP013-NO-ROLLBACK  TO TRUE                       05740001
057500             PERFORM 9999-WRITE-CICS-LOG-MSG                      05750001
057600     END-EVALUATE.                                                05760001
057700*                                                                 05770001
057800*                                                                 05780001
057900 9999-WRITE-CICS-LOG-MSG.                                         05790001
058000     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            05800001
058100     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           05810001
058200     INITIALIZE DP013-SRC-TASK-NUMBER                             05820001
058300                DP013-STACK.                                      05830001
058400     SET DP013-LINK-RETURN           TO TRUE.                     05840001
058500                                                                  05850001
058600     EXEC CICS                                                    05860001
058700         LINK                                                     05870001
058800             PROGRAM   (DP013-NAME)                               05880001
058900             COMMAREA  (DP013-PARAMETERS)                         05890001
059000             LENGTH    (DP013-LENGTH)                             05900001
059100     END-EXEC.                                                    05910001
059200                                                                  05920001
059300*----------------------------------------------------------------*05930001
059400*    ABEND PROCESSOR MODULE                                      *05940001
059500*----------------------------------------------------------------*05950001
059600                                                                  05960001
059700     COPY DPPD014.                                                05970005
059800                                                                  05980001
