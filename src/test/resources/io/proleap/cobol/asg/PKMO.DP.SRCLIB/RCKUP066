000100******************************************************************00010000
000200*  THIS IS A PROGRAM THAT CAN BE USED TO TAKE IN A FILE IN THE    00020000
000300*  RCRD098 FORMAT AND GENERATE RECEIVERS FOR THE PO'S IN THE      00030001
000400*  FILE.                                                          00040000
000410*  THIS PROGRAM WAS COPIED FROM (RCKUP991, RCKUP009, RCKUP992).   00041001
000430*                                                                 00043001
000431*  THIS PROGRAM WILL CREATE A NEW "CR" RECEIVER WHENEVER THERE IS 00043101
000440*  A CHANGE IN DC/PO NUMBER ON THE FILE.                          00044001
000450*                                                                 00045001
000491*  INPUT FILE IS CREATED BY RCKUT166, IN RCRD098 FORMAT.          00049101
000495*  THE FILE CONTAINS UNRESOLVED PACK-TO-LIGHT FAILED STORE UNIT   00049501
000496*  ADJUSTMENTS (SUT_FINCL_ADJ)                                    00049601
000497*                                                                 00049701
000498*  FILE COMING INTO THIS PROGRAM SHOULD BE IN PO/DC/LINE SEQUENCE.00049801
000499*                                                                 00049901
000500*  OUTPUT FILE WILL CONTAIN THE NEW RECEIVER NUMBER THAT WAS      00050001
000501*  CREATED.  THIS WILL BE USED FOR REPORTING PURPOSES.            00050101
000502*                                                                 00050201
000503*  THIS PROGRAM WILL DO THE FOLLOWING:                            00050301
000504*       - CREATE CR RECEIVER FOR DC-PO                            00050401
000505*       - BOL ON THE NEW RECEIVER WILL REFERENCE THE ORIG RCVR    00050501
000506*         TSHIPMT                                                 00050601
000507*         EX:   REF10738024-8FSA    OR    REFMULTFSA              00050701
000508*       - VERIFY THE CR RECEIVER                                  00050801
000509*       - RESOLVE THE FAILED ADJUSTMENT (SUT_FINCL_ADJ)           00050901
000510*       - RESOLVE THE 371 TROUBLE AND ADD TROUBLE DETAILS         00051001
000511******************************************************************00051101
000520 IDENTIFICATION DIVISION.                                         00052001
000600 PROGRAM-ID.             RCKUP066.                                00060001
000700 AUTHOR.                 DENISE HAHN.                             00070001
000800 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00080001
000900 DATE-WRITTEN.           MARCH 2017.                              00090001
001000 DATE-COMPILED.                                                   00100001
001100                                                                  00110001
001200******************************************************************00120001
001300*                                                                 00130001
001400                                                                  00140001
001500* GENERAL PROCESSING:                                             00150001
001600* -------------------                                             00160001
001700* 1) INITIALIZE VARIABLES, SET SWITCHES, OPEN INPUT & OUTPUT      00170001
001800*                                                                 00180001
001900* 2) WHEN A ORDER/STORE HAS BEEN PROCESSED, THE DATA WILL BE      00190001
002000*    LOADED TO THE RECEIVER AN PACKSLIP TABLES.                   00200001
002100*                                                                 00210001
002200* 3) EVERYTHING WILL GET INITIALIZED AND RESET - READY FOR THE    00220001
002300*    NEXT RECORD                                                  00230001
002400*                                                                 00240001
002500* ERROR PROCESSING:                                               00250001
002600* -----------------                                               00260001
002700* THIS PRGM IS CODED TO TRAP 23 TYPES OF ERRORS WHICH INCLUDE:    00270001
002800*                                                                 00280001
002900* 1) VALUE 1 - ROW NOT FOUND                                      00290001
003000* 2) VALUE 2 - STYLE ID NOT FOUND                                 00300001
003100* 3) VALUE 3 - DUP INSERT ON STYLE                                00310001
003200* 4) VALUE 4 - DUP INSERT ON SKU                                  00320001
003300* 5) VALUE 5 - SIZE DESC CODE MISMATCH                            00330001
003400* 6) VALUE 6 - DUP UPDATE STYLE                                   00340001
003500* 7) VALUE 7 - DUP INSERT ON UPC                                  00350001
003600* 8) VALUE 8 - UPC ROW NOT FOUND                                  00360001
003700* 9) VALUE 9 - DUP UPDATE UPC                                     00370001
003800* 10)VALUE 10- SKU ROW PROBLEM                                    00380001
003900* 11)VALUE 11- SKU INTR UPC ID NOT FOUND                          00390001
004000* 12)VALUE 12- PK INSERT NOT SUCCESS                              00400001
004100* 13)VALUE 13- PK DELETE NOT SUCCESS                              00410001
004200* 14)VALUE 14- PK UPDATE NOT SUCCESS                              00420001
004300* 15)VALUE 15- PK CPT INSERT NOT SUCCESS                          00430001
004400* 16)VALUE 16- PK CPT DELETE NOT SUCCESS                          00440001
004500* 17)VALUE 17- PK CPT UPDATE NOT SUCCESS                          00450001
004600* 18)VALUE 18- PK UPC INSERT NOT SUCCESS                          00460001
004700* 19)VALUE 19- PK UPC DELETE NOT SUCCESS                          00470001
004800* 20)VALUE 20- PK UPC UPDATE NOT SUCCESS                          00480001
004900* 21)VALUE 21- POPRPK INSERT NOT SUCCESS                          00490001
005000* 22)VALUE 22- POPRPK DELETE NOT SUCCESS                          00500001
005100* 23)VALUE 23- POPRPK UPDATE NOT SUCCESS                          00510001
005200*                                                                 00520001
005300* UNITS OF WORK AND COMMITS:                                      00530001
005400* --------------------------                                      00540001
005500* A UNIT OF WORK FOR A DB2 COMMIT WILL BE COMPLETE WHEN A         00550001
005600* RECORD HAS BEEN READ FROM THE INPUT FILE, AND ALL TABLE         00560001
005700* INSERTS AND UPDATES HAVE BEEN DONE WITH NO ERRORS.              00570001
005800* THE DB2 COMMIT IS PERFORMED.                                    00580001
005900*                                                                 00590000
005910* CHANGE LOG:                                                  *  00591001
005920*                                                              *  00592000
005970******************************************************************00597000
005980 ENVIRONMENT DIVISION.                                            00598000
005990******************************************************************00599000
006000 CONFIGURATION SECTION.                                           00600000
006100 SOURCE-COMPUTER.        IBM-3090.                                00610000
006200 OBJECT-COMPUTER.        IBM-3090.                                00620000
006300                                                                  00630000
006400 INPUT-OUTPUT SECTION.                                            00640000
006500 FILE-CONTROL.                                                    00650000
006600                                                                  00660000
006700* ------------------------------------------------------------- * 00670000
006800     SELECT INPUT-FILE                                            00680000
006900            ASSIGN TO INP01.                                      00690000
007000     SELECT ERROR-FILE                                            00700000
007100            ASSIGN TO OUT01.                                      00710000
007200     SELECT BKUP-FILE                                             00720000
007300            ASSIGN TO OUT02.                                      00730000
007310     SELECT OUTPUT-FILE                                           00731024
007320            ASSIGN TO OUT03.                                      00732024
007400                                                                  00740000
007500******************************************************************00750000
007600 DATA DIVISION.                                                   00760000
007700******************************************************************00770000
007800 FILE SECTION.                                                    00780000
007900                                                                  00790000
008000 FD  INPUT-FILE                                                   00800000
008100     RECORDING MODE F                                             00810000
008200     BLOCK CONTAINS 0 RECORDS                                     00820000
008300     LABEL RECORDS ARE OMITTED.                                   00830000
008400 01  INPUT-RECORD                     PIC  X(200).                00840026
008500                                                                  00850000
008600 FD  ERROR-FILE                                                   00860000
008700     RECORDING MODE F                                             00870000
008800     BLOCK CONTAINS 0 RECORDS                                     00880000
008900     LABEL RECORDS ARE OMITTED.                                   00890000
009000 01  ERROR-RECORD                     PIC  X(200).                00900026
009100                                                                  00910000
009200 FD  BKUP-FILE                                                    00920000
009300     RECORDING MODE F                                             00930000
009400     BLOCK CONTAINS 0 RECORDS                                     00940000
009500     LABEL RECORDS ARE OMITTED.                                   00950000
009600 01  BKUP-RECORD                      PIC  X(080).                00960000
009601                                                                  00960124
009610 FD  OUTPUT-FILE                                                  00961024
009620     RECORDING MODE F                                             00962024
009630     BLOCK CONTAINS 0 RECORDS                                     00963024
009640     LABEL RECORDS ARE OMITTED.                                   00964024
009650 01  OUTPUT-RECORD                    PIC  X(200).                00965026
009660                                                                  00966024
009700******************************************************************00970000
009800 WORKING-STORAGE SECTION.                                         00980000
009900******************************************************************00990000
010000*  COMMUNICATIONS AREA FOR DB2                                    01000000
010100******************************************************************01010000
010200     EXEC SQL                                                     01020000
010300          INCLUDE SQLCA                                           01030000
010400     END-EXEC.                                                    01040000
010500                                                                  01050000
010600                                                                  01060000
010700*----------------------------------------------------------------*01070000
010800*    DB2 DCLGEN FOR THE PURCHASE ITEM TABLE                       01080000
010900*----------------------------------------------------------------*01090000
011000     EXEC SQL                                                     01100000
011100          INCLUDE TPURITM                                         01110000
011200     END-EXEC.                                                    01120000
011300                                                                  01130000
011400*----------------------------------------------------------------*01140000
011500*    DB2 DCLGEN FOR THE RECEIVER NUMBER TABLE                     01150000
011600*----------------------------------------------------------------*01160000
011700     EXEC SQL                                                     01170000
011800          INCLUDE TRECVER                                         01180000
011900     END-EXEC.                                                    01190000
012000                                                                  01200000
012100******************************************************************01210000
012200*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          01220000
012300******************************************************************01230000
012400     EXEC SQL                                                     01240000
012500          INCLUDE TPURCHS                                         01250000
012600     END-EXEC.                                                    01260000
012700                                                                  01270000
012800*----------------------------------------------------------------*01280000
012900*    DB2 DCLGEN FOR PO AGREEMENT TABLE                            01290000
013000*----------------------------------------------------------------*01300000
013100     EXEC SQL                                                     01310000
013200          INCLUDE TPOAGMT                                         01320000
013300     END-EXEC.                                                    01330000
013400                                                                  01340000
013500*----------------------------------------------------------------*01350000
013600*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        01360000
013700*----------------------------------------------------------------*01370000
013800     EXEC SQL                                                     01380000
013900          INCLUDE TPKSLIP                                         01390000
014000     END-EXEC.                                                    01400000
014100                                                                  01410000
014200*----------------------------------------------------------------*01420000
014300*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          01430000
014400*----------------------------------------------------------------*01440000
014500     EXEC SQL                                                     01450000
014600          INCLUDE TPKITEM                                         01460000
014700     END-EXEC.                                                    01470000
014800                                                                  01480000
014900*---------------------------------------------------------------* 01490000
015000*    DB2 AREA FOR RECEIVER TABLE                                * 01500000
015100*---------------------------------------------------------------* 01510000
015200     EXEC SQL                                                     01520000
015300          INCLUDE TRECEIV                                         01530000
015400     END-EXEC.                                                    01540000
015500                                                                  01550000
015600******************************************************************01560000
015700*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       01570000
015800******************************************************************01580000
015900     EXEC SQL                                                     01590000
016000          INCLUDE TRECITM                                         01600000
016100     END-EXEC.                                                    01610000
016200                                                                  01620000
016300******************************************************************01630000
016400*    DB2 DCLGEN FOR THE RECEIPT DISTRIBUTION TABLE                01640000
016500******************************************************************01650000
016600     EXEC SQL                                                     01660000
016700          INCLUDE TRECDIS                                         01670000
016800     END-EXEC.                                                    01680000
016900                                                                  01690000
017000******************************************************************01700000
017100*    DB2 DCLGEN FOR THE PARAMETER TABLE                           01710000
017200******************************************************************01720000
017300     EXEC SQL                                                     01730000
017400          INCLUDE TKRPRPM                                         01740000
017500     END-EXEC.                                                    01750000
017600                                                                  01760000
017700*---------------------------------------------------------------* 01770000
017800*    DB2 AREA FOR XLT_MDSE_INV_PARM-INVENTORY PARAMENTERS TABLE * 01780000
017900*---------------------------------------------------------------* 01790000
018000     EXEC SQL                                                     01800000
018100          INCLUDE XLT00025                                        01810000
018200     END-EXEC.                                                    01820000
018210                                                                  01821007
018220*---------------------------------------------------------------* 01822007
018230*    TROUBLE                                                    * 01823007
018240*---------------------------------------------------------------* 01824007
018250     EXEC SQL                                                     01825007
018260          INCLUDE TTRBNTF                                         01826007
018270     END-EXEC.                                                    01827007
018280                                                                  01828007
018290*---------------------------------------------------------------* 01829007
018291*    TROUBLE DETAIL                                             * 01829107
018292*---------------------------------------------------------------* 01829207
018293     EXEC SQL                                                     01829307
018294          INCLUDE TTRBDTL                                         01829407
018295     END-EXEC.                                                    01829507
018296                                                                  01829607
018297*---------------------------------------------------------------* 01829711
018298*    FINALCIAL ADJUSTMENT                                       * 01829811
018299*---------------------------------------------------------------* 01829911
018300     EXEC SQL                                                     01830011
018301          INCLUDE SUT00030                                        01830111
018302     END-EXEC.                                                    01830211
018303                                                                  01830311
018310******************************************************************01831000
018400*    DB2 DCLGEN WFT_LOD_CNTL                                      01840000
018500******************************************************************01850000
018600     EXEC SQL                                                     01860022
018610          INCLUDE WFT00001                                        01861022
018620     END-EXEC.                                                    01862022
018630                                                                  01863022
018640******************************************************************01864000
018650*    DB2 DCLGEN WFT_LOD_XFER                                      01865000
018660******************************************************************01866000
018670     EXEC SQL                                                     01867022
018680          INCLUDE WFT00002                                        01868022
018690     END-EXEC.                                                    01869022
018692                                                                  01869204
018693*-----------------------------------------------------------------01869304
018694*    TRECVER-CSR                                                  01869405
018695*-----------------------------------------------------------------01869504
018696     EXEC SQL                                                     01869604
018697          DECLARE TRECVER-CSR CURSOR FOR                          01869704
018698           SELECT MAX_RCVR_NBR                                    01869804
018699           FROM   TRECVER                                         01869904
018700           WHERE  OPERCO_NBR = '03'                               01870004
018701           FOR UPDATE OF MAX_RCVR_NBR                             01870104
018702     END-EXEC.                                                    01870204
018703                                                                  01870304
018704                                                                  01870405
018705*-----------------------------------------------------------------01870507
018706*    TROUBLE-CSR                                                  01870607
018707*-----------------------------------------------------------------01870707
018708     EXEC SQL                                                     01870807
018709          DECLARE TROUBLE-CSR CURSOR FOR                          01870913
018710          SELECT NOTIF_NBR                                        01871007
018711               , OPER_UNT_ID                                      01871107
018712               , FCLTY_ID                                         01871207
018713               , PO_NBR                                           01871307
018714               , REC_SEQ_NBR                                      01871407
018715               , TRBL_RSN_CDE                                     01871507
018716            FROM TTRBNTF                                          01871607
018717          WHERE PO_NBR        =  :TRBNTF-PO-NBR                   01871707
018718            AND REC_SEQ_NBR   =  :TRBNTF-REC-SEQ-NBR              01871807
018719            AND RESOLVED_TMST > CURRENT TIMESTAMP                 01871907
018720            AND TRBL_RSN_CDE  =  371                              01872007
018721           WITH UR                                                01872107
018722     END-EXEC.                                                    01872207
018723                                                                  01872307
018724                                                                  01872407
018730******************************************************************01873007
018800* INPUT LAYOUT                                                    01880000
018900******************************************************************01890000
019000     COPY RCRD098.                                                01900001
019100                                                                  01910000
019200******************************************************************01920000
019300*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     01930000
019400******************************************************************01940000
019500     COPY DPWS004.                                                01950000
019600                                                                  01960000
019810*                                                                 01981004
019900 01  PA-PROGRAM-ACCUMULATORS.                                     01990014
020000     05  PA-TO-VERIFY-QTY             PIC S9(09) VALUE +0 COMP-3. 02000016
020100     05  PA-TOTALS.                                               02010004
020200         10 PA-TOTAL-RECORDS-READ     PIC S9(09) VALUE +0 COMP-3. 02020004
020300         10 PA-TOTAL-UNITS-PROCESSED  PIC S9(09) VALUE +0 COMP-3. 02030004
020310                                                                  02031004
020400         10 PA-TOTAL-ERROR-RECS       PIC S9(09) VALUE +0 COMP-3. 02040016
020410         10 PA-TOTAL-PROCESS-RECS     PIC S9(09) VALUE +0 COMP-3. 02041024
020500         10 PA-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02050016
020600         10 PA-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02060016
020700         10 PA-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02070016
020800         10 PA-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02080016
020900         10 PA-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02090016
021000         10 PA-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02100016
021100         10 PA-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02110016
021200         10 PA-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 02120023
021300         10 PA-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 02130023
021301         10 PA-TOTAL-TROUBLE-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02130123
021302         10 PA-TROUBLE-DETAIL-COUNT   PIC S9(09) VALUE +0 COMP-3. 02130223
021303         10 PA-TOTAL-FINCL-ADJ-UPDATE PIC S9(09) VALUE +0 COMP-3. 02130323
021310                                                                  02131016
021400         10 PT-TOTAL-TPKSLIP-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02140016
021500         10 PT-TOTAL-TPKSLIP-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02150016
021600         10 PT-TOTAL-TPKITEM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02160016
021700         10 PT-TOTAL-TRECEIV-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02170016
021800         10 PT-TOTAL-TRECEIV-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02180016
021900         10 PT-TOTAL-TRECITM-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02190016
022000         10 PT-TOTAL-TRECDIS-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02200016
022100         10 PT-TOTAL-WFT-CNTL-INSERTS PIC S9(09) VALUE +0 COMP-3. 02210022
022200         10 PT-TOTAL-WFT-XFER-INSERTS PIC S9(09) VALUE +0 COMP-3. 02220022
022201         10 PT-TOTAL-TROUBLE-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02220123
022210         10 PT-TROUBLE-DETAIL-COUNT   PIC S9(09) VALUE +0 COMP-3. 02221019
022220         10 PT-TOTAL-FINCL-ADJ-UPDATE PIC S9(09) VALUE +0 COMP-3. 02222019
022300         10 PA-TOTAL-DB2-COMMITS      PIC S9(09) VALUE +0 COMP-3. 02230016
022400                                                                  02240016
022500 01  PS-PROGRAM-SWITCHES.                                         02250004
022600     05  PS-SAME-DC-PO-SW            PIC X(01) VALUE 'N'.         02260004
022700         88  PS-SAME-DC-PO-YES                 VALUE 'Y'.         02270004
022800         88  PS-SAME-DC-PO-NO                  VALUE 'N'.         02280004
022900     05  PS-SAME-DC-PO-LNE-SW        PIC X(01) VALUE 'N'.         02290004
023000         88  PS-SAME-DC-PO-LNE-YES             VALUE 'Y'.         02300004
023100         88  PS-SAME-DC-PO-LNE-NO              VALUE 'N'.         02310004
023110     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         02311004
023120         88  PS-END-OF-INPUT                   VALUE 'Y'.         02312004
023130         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         02313007
023131     05  PS-EOF-TROUBLE-CSR-SW       PIC X(01) VALUE 'N'.         02313107
023132         88  PS-EOF-TROUBLE                    VALUE 'Y'.         02313217
023133         88  PS-EOF-TROUBLE-NO                 VALUE 'N'.         02313317
023200     05  PS-DC-FLUSH-SW              PIC X(01) VALUE 'N'.         02320016
023300         88  PS-DC-FLUSH-YES                   VALUE 'Y'.         02330016
023400         88  PS-DC-FLUSH-NO                    VALUE 'N'.         02340016
023500                                                                  02350016
023800     05  PS-TRECVER-CURSOR-SW          PIC  X(01)  VALUE 'N'.     02380017
023900         88  PS-EOF-TRECVER-CSR                    VALUE 'Y'.     02390017
023901         88  PS-EOF-TRECVER-NO                     VALUE 'N'.     02390117
023902                                                                  02390236
023906                                                                  02390617
024000     05  PS-PKSLIP-INSERTED-SW         PIC  X(01)  VALUE 'N'.     02400016
024100         88  PS-PKSLIP-NOT-INSERTED                VALUE 'N'.     02410017
024200         88  PS-PKSLIP-INSERTED                    VALUE 'Y'.     02420017
024300     05  PS-ERROR-SW                   PIC  X(01)  VALUE 'N'.     02430017
024400         88  PS-ERROR-YES                          VALUE 'Y'.     02440017
024500         88  PS-ERROR-NO                           VALUE 'N'.     02450017
024501                                                                  02450136
024510     05  PS-FSA-RESOLVED-SW            PIC  X(01)  VALUE 'N'.     02451036
024520         88  PS-FSA-RESOLVED                       VALUE 'Y'.     02452036
024530         88  PS-FSA-RESOLVED-NO                    VALUE 'N'.     02453036
024540                                                                  02454036
024600 01  PC-PROGRAM-CONSTANTS.                                        02460013
024700     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'RCKUP066'.  02470013
024710     05  PC-PTL-FSA                 PIC X(08)  VALUE 'PTL-FSA'.   02471033
026000*                                                                 02600004
026100 01  DK-DB2-KEYS.                                                 02610004
026200     05  DK-OPER-UNIT-ID              PIC S9(04) COMP VALUE +0.   02620004
026210     05  DK-PO-NBR                    PIC S9(09) COMP VALUE +0.   02621004
026300     05  DK-AGRMT-TYP-ID              PIC X(01)  VALUE SPACES.    02630013
026400     05  DK-TYP-CDE                   PIC S9(04) COMP VALUE +0.   02640013
026500     05  DK-LNE-NBR                   PIC S9(09) COMP VALUE +0.   02650013
026600     05  DK-HOLD-PO-NBR               PIC S9(09) COMP VALUE +0.   02660013
026700     05  DK-HOLD-LNE-NBR              PIC S9(09) COMP VALUE +0.   02670013
026800                                                                  02680013
026900 01  PV-BKUP-RECORDS.                                             02690004
027000     05  PV-BKUP-RECORD-1.                                        02700004
027100         10  FILLER                 PIC X(05)  VALUE 'OPER:'.     02710004
027200         10  PV-BKUP-OPER-UNT-ID    PIC 9(04).                    02720004
027210         10  FILLER                 PIC X(05)  VALUE '  PO:'.     02721004
027220         10  PV-BKUP-PO-NBR-1       PIC 9(09).                    02722004
027300         10  FILLER                 PIC X(06)  VALUE              02730004
027400                                                  '  LNE:'.       02740004
027500         10  PV-BKUP-PO-LNE-1       PIC 9(04).                    02750004
027600         10  FILLER                 PIC X(06)  VALUE              02760004
027700                                                  '  STR:'.       02770004
027800         10  PV-BKUP-STR-NBR-1      PIC 9(05).                    02780004
027900         10  FILLER                 PIC X(09)  VALUE              02790004
028000                                                   '  VE QTY:'.   02800004
028100         10  PV-BKUP-TO-VERIFY-QTY-1 PIC 9(09).                   02810004
028200         10  FILLER                 PIC X(07)  VALUE SPACES.      02820004
028210                                                                  02821004
028220                                                                  02822004
028300     05  PV-BKUP-RECORD-2.                                        02830016
028400         10  FILLER                 PIC X(14)  VALUE              02840016
028500                                              'PO / RECEIVER '.   02850016
028600         10  PV-BKUP-PO-NBR-2       PIC 9(09).                    02860016
028700         10  FILLER                 PIC X(01)  VALUE SPACE.       02870016
028800         10  PV-BKUP-REC-SEQ-2      PIC 9(09).                    02880016
028900         10  FILLER                 PIC X(47)  VALUE SPACE.       02890016
029000                                                                  02900016
029100 01  PV-PROGRAM-VARIABLES.                                        02910013
029200     05  PV-SEQ-NBR-IND             PIC S9(04) VALUE +0           02920013
029300                                                  COMP.           02930013
029400     05  PV-NEXT-SEQ-NBR            PIC S9(04) VALUE +0           02940016
029500                                                 COMP.            02950016
029600     05  PV-SAVE-PKSLIP-SEQ-NBR     PIC S9(04) VALUE +0           02960013
029700                                                 COMP.            02970013
029800     05  PV-MAX-SEQ-NBR             PIC S9(04) VALUE +0           02980013
029900                                                 COMP.            02990013
030000     05  PV-COUNT                   PIC S9(04) VALUE +0           03000016
030100                                                 COMP.            03010016
030200     05  PV-DB2-COUNT               PIC S9(09)  VALUE +0          03020013
030300                                                 COMP-3.          03030013
030400     05  PV-WORK-DATE-PLUS-7        PIC  X(10)  VALUE ZEROS.      03040013
030500     05  PV-DISP-PO                 PIC 9(09).                    03050016
030600     05  PV-DISP-REC-SEQ            PIC 9(09).                    03060016
030610     05  PV-DISP-RCVR               PIC 9(04).                    03061016
030700     05  PV-DISP-LINE-NBR           PIC 9(04).                    03070016
030800     05  PV-DISP-TYP-CDE            PIC 9(04).                    03080016
030900     05  PV-DISP-STR-NBR            PIC 9(04).                    03090016
031000     05  PV-DISP-SQLCODE            PIC -9(09).                   03100016
031100     05  PV-DISP-SEQ                PIC 9(09).                    03110016
031110     05  PV-PARAGRAPH               PIC X(48)  VALUE SPACES.      03111016
031120     05  PV-REC-SEQ-NBR             PIC S9(09) VALUE +0 COMP.     03112016
031130                                                                  03113016
031140     05  PV-EXPTED-ITM-QTY          PIC  S9(9) COMP.              03114041
031150     05  PV-VERIFY-ITM-QTY          PIC  S9(9) COMP.              03115041
031160     05  PV-AP-VERIFY-ITM-QTY       PIC  S9(9) COMP.              03116041
031170                                                                  03117041
031200     05  PW-CONTROL-REC.                                          03120016
031300         10  PW-CONTROL-KEYREC.                                   03130016
031400             20  PW-CONTROL-PANL-NBR.                             03140016
031500                 30  PW-CONTROL-PANEL    PIC 9(05)  VALUE ZERO.   03150016
031600                 30  PW-CONTROL-KEYREC-NBR                        03160016
031700                                         PIC 9(02)  VALUE ZERO.   03170016
031800             20  PW-CONTROL-PANL-NBR-9 REDEFINES                  03180016
031900                                       PW-CONTROL-PANL-NBR        03190016
032000                                         PIC 9(7).                03200016
032100             20  PW-CONTROL-CEHCK-DIG    PIC 9(01)  VALUE ZERO.   03210016
032200         10  PW-CONTROL-KEYREC-9 REDEFINES PW-CONTROL-KEYREC      03220016
032300                                         PIC 9(08).               03230016
032400         10  PW-CONTROL-FILLER           PIC X(73)  VALUE SPACE.  03240016
032500                                                                  03250016
032600     05  PW-QUOTIENT                     PIC S9(7)  VALUE ZERO.   03260016
032700     05  PW-REMAINDER                    PIC S9     VALUE ZERO.   03270016
033100                                                                  03310016
033200     05  PV-RECEIPT-ADJUSTMENT-REC.                               03320023
033300         10  PV-HEADER-DATA.                                      03330023
033400             15  PV-ORDER-NUMBER               PIC 9(09).         03340023
033500             15  PV-RCVR-ID                    PIC 9(09).         03350023
033600             15  PV-DC                         PIC 9(04).         03360023
033700             15  PV-SKU                        PIC 9(08).         03370023
033800             15  PV-VRFY-DATE                  PIC X(14).         03380023
033900             15  PV-STORE-COUNT                PIC 9(04).         03390023
034000             15  FILLER                        PIC X(52).         03400023
034100         10  PV-STORE-DATA OCCURS 1 TO 100 TIMES                  03410023
034200                              DEPENDING ON PV-STORE-COUNT         03420023
034300                              INDEXED BY PV-IDX.                  03430023
034400             15  PV-STORE                      PIC 9(04).         03440023
034500             15  PV-STORE-QTY                  PIC 9(09).         03450023
034600             15  PV-STORE-QTY-SIGN             PIC X(01).         03460023
034700                                                                  03470023
034800 01  PV-DB2-TMST                      PIC X(26).                  03480013
034900 01  FILLER  REDEFINES  PV-DB2-TMST.                              03490013
035000         10  PV-DB2-TMST-CCYY         PIC X(04).                  03500013
035100         10  FILLER                   PIC X(01).                  03510013
035200         10  PV-DB2-TMST-MO           PIC X(02).                  03520013
035300         10  FILLER                   PIC X(01).                  03530013
035400         10  PV-DB2-TMST-DA           PIC X(02).                  03540013
035500         10  FILLER                   PIC X(01).                  03550013
035600         10  PV-DB2-TMST-HH           PIC X(02).                  03560013
035700         10  FILLER                   PIC X(01).                  03570013
035800         10  PV-DB2-TMST-MM           PIC X(02).                  03580013
035900         10  FILLER                   PIC X(01).                  03590013
036000         10  PV-DB2-TMST-SS           PIC X(02).                  03600013
036100             88  PV-DB2-TMST-SS-01               VALUE '01'.      03610013
036200         10  FILLER                   PIC X(01).                  03620013
036300         10  PV-DB2-TMST-MS           PIC X(06).                  03630013
036400             88  PV-DB2-TMST-MS-ZERO             VALUE '000000'.  03640013
036500*PV-MSG IS WHAT GETS BROKEN DOWN INTO DTLS/GFTS/END               03650000
036600*01  PV-MSG.                                                      03660004
036700*    05  PV-MSG-END                 PIC X(18).                    03670004
036800*        88 PV-END-RUN-MSG          VALUE 'END RUN OF PROGRAM'.   03680004
036900*    05  FILLER                     PIC X(432).                   03690004
037000*                                                                 03700004
037100*01  PV-DTL.                                                      03710004
037200*    05  PV-DTL-EVENT               PIC 9(03)   VALUE ZERO.       03720004
037300*    05  FILLER                     PIC X(447)  VALUE SPACE.      03730004
037400                                                                  03740004
037500 01  PV-HOLD-FIELDS.                                              03750004
037600     05  PV-HOLD-OPER-UNT-ID        PIC  9(04).                   03760004
037610     05  PV-HOLD-PO-NBR             PIC  9(09).                   03761004
037700     05  PV-HOLD-CRE-UID            PIC  X(08).                   03770004
037800     05  PV-HOLD-PO-LNE-NBR         PIC  9(04).                   03780004
037900     05  PV-HOLD-REC-SEQ-NBR        PIC S9(09) VALUE +0.          03790004
038000     05  PV-HOLD-SEQ-NBR            PIC S9(04) VALUE +0           03800004
038100                                                 COMP.            03810004
038200                                                                  03820004
038300*01  PV-ABEND-VARIABLES.                                          03830004
038400*    05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.03840004
038500*    88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 03850004
038600*    88  ABEND-4002-READ-ERROR                       VALUE +4002. 03860004
038700*    88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 03870004
038800*    88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 03880004
038900*    88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 03890004
039000*    88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 03900004
039100*    88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 03910004
039200*    88  ABEND-4008-DATA-ERROR                       VALUE +4008. 03920004
039300*    88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. 03930004
039400*    88  ABEND-4013-DB2-ERROR                        VALUE +4013. 03940004
039500*    88  ABEND-4019-CAL-SUB-ERROR                    VALUE +4019. 03950004
039600*    88  ABEND-4444-FORCED-ABEND                     VALUE +4444. 03960004
039700*                                                                 03970004
039800*                                                                 03980000
039900*                                                                 03990000
040000****************************************************************  04000000
040100 PROCEDURE DIVISION.                                              04010000
040200******************************************************************04020000
040300 0000-PROGRAM-MAINLINE.                                           04030000
040400     DISPLAY '************ START OF RCKUP066 ***************'     04040000
040500                                                                  04050000
040600*INIT VARIBLES, SET SWITHCES.                                     04060000
040700     PERFORM 1000-INITIALIZE.                                     04070000
040800                                                                  04080000
040900                                                                  04090000
041000     SET PS-NOT-END-OF-INPUT TO TRUE.                             04100000
041100                                                                  04110000
041200     OPEN INPUT  INPUT-FILE.                                      04120025
041300     OPEN OUTPUT ERROR-FILE                                       04130000
041400                 BKUP-FILE                                        04140000
041410                 OUTPUT-FILE.                                     04141025
041500     PERFORM 4000-READ-RECORD.                                    04150025
041510                                                                  04151004
041600     IF NOT PS-END-OF-INPUT                                       04160000
041700         SET PS-SAME-DC-PO-NO                                     04170004
041800             PS-SAME-DC-PO-LNE-YES TO TRUE                        04180004
041810                                                                  04181004
041820         MOVE RC098-OPER-UNIT   TO PV-HOLD-OPER-UNT-ID            04182016
041900         MOVE RC098-PO-NBR      TO PV-HOLD-PO-NBR                 04190001
042000         MOVE PC-PTL-FSA        TO PV-HOLD-CRE-UID                04200033
042100         MOVE RC098-PO-LNE-NBR  TO PV-HOLD-PO-LNE-NBR             04210001
042110                                                                  04211004
042200         PERFORM 2000-PROCESS-INPUT                               04220000
042300             UNTIL PS-END-OF-INPUT                                04230000
042310         IF PS-ERROR-NO                                           04231048
042320             PERFORM 2200-ADD-TPKITEM                             04232048
042330         END-IF                                                   04233048
042340         IF PS-ERROR-NO                                           04234048
042350             PERFORM 2400-ADD-RECITM                              04235048
042360         END-IF                                                   04236048
042400     END-IF.                                                      04240036
043100                                                                  04310000
043200     PERFORM 5000-END-RUN-ROUTINE.                                04320000
043300                                                                  04330000
043400******************************************************************04340000
043500* INITIALIZE VARIABLES.                                           04350000
043600* SET SWITCHES.                                                   04360000
043700******************************************************************04370000
043800 1000-INITIALIZE.                                                 04380000
043900                                                                  04390000
044000     INITIALIZE   PA-TOTAL-TRECEIV-INSERTS                        04400000
044100                  PA-TOTAL-TRECEIV-UPDATES                        04410000
044200                  PA-TOTAL-TPKITEM-INSERTS                        04420000
044300                  PA-TOTAL-TRECITM-INSERTS                        04430000
044400                  PA-TOTAL-TRECDIS-INSERTS                        04440000
044500                  PA-TOTAL-WFT-CNTL-INSERTS                       04450023
044600                  PA-TOTAL-WFT-XFER-INSERTS                       04460023
044610                  PA-TOTAL-TROUBLE-UPDATES                        04461023
044700                  PA-TOTAL-TPKSLIP-INSERTS                        04470000
044800                  PA-TOTAL-TPKSLIP-UPDATES                        04480000
044900                  PA-TOTAL-DB2-COMMITS                            04490000
044910                  PA-TROUBLE-DETAIL-COUNT                         04491023
044920                  PA-TOTAL-FINCL-ADJ-UPDATE                       04492019
045000                  PV-HOLD-FIELDS.                                 04500016
045200                                                                  04520000
045300*INIT SWITCHES USED FOR EDITING EACH MSG, AND CONTINUING RUN OF   04530000
045400*PROGRAM.                                                         04540000
045500                                                                  04550000
045600****************************************************************  04560000
045700* INIT SOME FIELDS BEFORE THE NEXT ITEM IS PROCESSED.             04570000
045800* RESET SOME SWITCHES.                                            04580000
045900****************************************************************  04590000
046000 1300-REINITIALIZE.                                               04600000
046100                                                                  04610000
046200     SET PS-ERROR-NO  TO TRUE.                                    04620000
046300                                                                  04630000
046400******************************************************************04640000
046500* BREAKDOWN AND EDIT INPUT.                                       04650000
046600* EDIT DB2 TABLES                                                 04660000
046700* GET THE NEXT RECORD                                             04670000
046800******************************************************************04680000
046900 2000-PROCESS-INPUT.                                              04690000
047000                                                                  04700000
047001     SET PS-FSA-RESOLVED-NO  TO  TRUE.                            04700136
047002                                                                  04700236
047010     PERFORM 2010-CHECK-FSA-RESOLVED.                             04701036
047020                                                                  04702036
047021     IF  PS-FSA-RESOLVED                                          04702136
047022         CONTINUE                                                 04702236
047023     ELSE                                                         04702336
047024         PERFORM 2020-PROCESS-FAILED-FSA                          04702436
047025     END-IF.                                                      04702536
047026                                                                  04702636
047027     PERFORM 1300-REINITIALIZE.                                   04702736
047028                                                                  04702836
047029     PERFORM 4000-READ-RECORD                                     04702936
047030     IF NOT PS-END-OF-INPUT                                       04703036
047031         IF  RC098-OPER-UNIT     = DK-OPER-UNIT-ID AND            04703136
047032             RC098-PO-NBR        = DK-PO-NBR                      04703236
047033             SET PS-SAME-DC-PO-YES TO TRUE                        04703336
047034             IF RC098-PO-LNE-NBR = DK-LNE-NBR                     04703436
047035                 SET PS-SAME-DC-PO-LNE-YES TO TRUE                04703536
047036             ELSE                                                 04703636
047037                 SET PS-SAME-DC-PO-LNE-NO TO TRUE                 04703736
047038             END-IF                                               04703836
047039         ELSE                                                     04703936
047040             SET PS-SAME-DC-PO-NO                                 04704036
047041                 PS-SAME-DC-PO-LNE-NO   TO TRUE                   04704136
047042         END-IF                                                   04704236
047043     END-IF.                                                      04704336
047044                                                                  04704436
047045                                                                  04704536
047046******************************************************************04704636
047047* CHECK TO SEE IF THE FAILED STORE ADJUSTMENT HAS BEEN RESOLVED   04704736
047048* IF IT HAS BEEN RESOLVED - THIS RECORD WILL BE BYPASSED          04704836
047049******************************************************************04704936
047050 2010-CHECK-FSA-RESOLVED.                                         04705036
047052                                                                  04705236
047053     MOVE  RC098-FINCL-ADJ-ID      TO SUT00030-FINCL-ADJ-ID       04705336
047054     MOVE  RC098-ORIG-PO-NBR       TO SUT00030-PO-NBR             04705436
047055     MOVE  RC098-ORIG-PO-RCVR      TO SUT00030-RCVR-SEQ-NBR       04705536
047056     MOVE  RC098-ORIG-PO-LNE-NBR   TO SUT00030-RCVR-LNE-NBR       04705636
047057     MOVE  RC098-ORIG-STR-NBR      TO SUT00030-DEST-LOC-NBR       04705736
047058     MOVE  RC098-FINCL-ADJ-ERR-CDE TO SUT00030-ADJ-ERR-CDE        04705836
047059     MOVE  RC098-PRC-RSN-CDE       TO SUT00030-PRC-RSN-CDE        04705936
047060                                                                  04706036
047067     EXEC SQL                                                     04706736
047068          SELECT RSLV_TMST                                        04706836
047069               , RSLV_BY_USR_ID                                   04706936
047070            INTO :SUT00030-RSLV-TMST                              04707036
047071               , :SUT00030-RSLV-BY-USR-ID                         04707136
047072            FROM SUT_FINCL_ADJ                                    04707236
047074           WHERE                                                  04707436
047075                 FINCL_ADJ_ID    = :SUT00030-FINCL-ADJ-ID         04707536
047076             AND PO_NBR          = :SUT00030-PO-NBR               04707636
047077             AND RCVR_LNE_NBR    = :SUT00030-RCVR-LNE-NBR         04707736
047078             AND RCVR_SEQ_NBR    = :SUT00030-RCVR-SEQ-NBR         04707836
047079             AND DEST_LOC_NBR    = :SUT00030-DEST-LOC-NBR         04707936
047080             AND ADJ_ERR_CDE     = :SUT00030-ADJ-ERR-CDE          04708036
047081             AND PRC_RSN_CDE     = :SUT00030-PRC-RSN-CDE          04708136
047082             AND RSLV_BY_USR_ID  = ' '                            04708236
047083             AND RSLV_TMST       > CURRENT TIMESTAMP              04708336
047084                                                                  04708436
047085     END-EXEC                                                     04708536
047086                                                                  04708636
047087     EVALUATE TRUE                                                04708736
047088         WHEN SQLCODE = +0                                        04708836
047089              SET  PS-FSA-RESOLVED-NO  TO  TRUE                   04708936
047091                                                                  04709136
047092         WHEN SQLCODE = +100                                      04709236
047093              SET  PS-FSA-RESOLVED     TO  TRUE                   04709336
047094              DISPLAY 'PREVIOUSLY RESOLVED:'                      04709436
047095                       RC098-FINCL-ADJ-ID       '-'               04709536
047096                       RC098-ORIG-PO-NBR        '-'               04709636
047097                       RC098-ORIG-PO-RCVR       '-'               04709736
047098                       RC098-ORIG-PO-LNE-NBR    '-'               04709836
047099                       RC098-ORIG-STR-NBR       '-'               04709936
047100                       RC098-FINCL-ADJ-ERR-CDE  '-'               04710036
047101                       RC098-PRC-RSN-CDE        '-'               04710136
047102                       SUT00030-RSLV-BY-USR-ID  '-'               04710236
047103                       SUT00030-RSLV-TMST                         04710336
047104                                                                  04710436
047105         WHEN SQLWARN0 NOT = SPACE                                04710536
047106         WHEN SQLCODE < +0                                        04710636
047107         WHEN SQLCODE > +0                                        04710736
047108             MOVE SQLCODE TO PV-DISP-SQLCODE                      04710836
047109             MOVE '5200-ACKNOWLEDGE-FSA       '                   04710936
047110                              TO RC098-ERROR-PARA-NAME            04711036
047111             SET RC098-DB-ERROR                                   04711136
047112                 PS-ERROR-YES    TO TRUE                          04711236
047113             DISPLAY '******************************************' 04711336
047114             DISPLAY '*ABEND                                   *' 04711436
047115             DISPLAY '*PROGRAM   = RCKUP066                    *' 04711536
047116             DISPLAY '*DB2 OPER  = RESOLVE TROUBLE             *' 04711636
047117             DISPLAY '*PARAGRAPH = 5200-ACKNOWLEDGE-FSA        *' 04711736
047118             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                04711836
047119             DISPLAY '******************************************' 04711936
047120             DISPLAY 'RC098-FINCL-ADJ-ID      ' RC098-FINCL-ADJ-ID04712036
047121             DISPLAY 'RC098-ORIG-PO-NBR       ' RC098-ORIG-PO-NBR 04712136
047122             DISPLAY 'RC098-ORIG-PO-RCVR      ' RC098-ORIG-PO-RCVR04712236
047123             DISPLAY 'RC098-ORIG-PO-LNE-NBR   '                   04712336
047124                                          RC098-ORIG-PO-LNE-NBR   04712436
047125             DISPLAY 'RC098-ORIG-STR-NBR      ' RC098-ORIG-STR-NBR04712536
047126             DISPLAY 'RC098-FINCL-ADJ-ERR-CDE '                   04712636
047127                                          RC098-FINCL-ADJ-ERR-CDE 04712736
047128             DISPLAY 'RC098-PRC-RSN-CDE       ' RC098-PRC-RSN-CDE 04712836
047129             DISPLAY '******************************************' 04712936
047130     END-EVALUATE.                                                04713036
047131                                                                  04713136
047132                                                                  04713236
047133                                                                  04713336
047134******************************************************************04713436
047135* PROCESS RECEIVER CREATE FOR PACK-TO-LIGHT FAILED STORE ADJ      04713536
047136******************************************************************04713636
047137 2020-PROCESS-FAILED-FSA.                                         04713736
047138                                                                  04713836
047140     MOVE 0    TO PT-TOTAL-TPKSLIP-INSERTS                        04714036
047200                  PT-TOTAL-TPKSLIP-UPDATES                        04720000
047300                  PT-TOTAL-TPKITEM-INSERTS                        04730036
047400                  PT-TOTAL-TRECEIV-INSERTS                        04740000
047500                  PT-TOTAL-TRECEIV-UPDATES                        04750000
047600                  PT-TOTAL-TRECITM-INSERTS                        04760036
047700                  PT-TOTAL-TRECDIS-INSERTS                        04770019
047710                  PT-TROUBLE-DETAIL-COUNT                         04771019
047720                  PT-TOTAL-FINCL-ADJ-UPDATE.                      04772019
047800                                                                  04780000
047900     MOVE RC098-OPER-UNIT   TO DK-OPER-UNIT-ID.                   04790016
047910     MOVE RC098-PO-NBR      TO DK-PO-NBR.                         04791004
048000     MOVE RC098-PO-LNE-NBR  TO DK-LNE-NBR                         04800001
048200     MOVE RC098-STR-NBR      TO RECDIS-STR-NBR.                   04820001
048210                                                                  04821004
048300     IF PS-SAME-DC-PO-NO                                          04830004
048400         SET PS-DC-FLUSH-NO      TO TRUE                          04840000
048500         PERFORM 2250-CHECK-DC-FLUSH-PARM                         04850000
048600     END-IF.                                                      04860000
048610                                                                  04861004
048700     IF PS-DC-FLUSH-YES                                           04870000
048800         PERFORM 2275-CHECK-INV-IN-PROCESS                        04880000
048900     END-IF.                                                      04890000
049000                                                                  04900000
049100     IF PS-ERROR-NO                                               04910000
049200         IF PS-SAME-DC-PO-NO                                      04920004
049300             PERFORM 2100-ADD-PACK-SLIP-HEADER                    04930000
049400         ELSE                                                     04940000
049500             PERFORM 2160-UPDATE-PACK-SLIP-HEADER                 04950000
049600         END-IF                                                   04960000
049700     END-IF.                                                      04970000
049800                                                                  04980000
049900     IF PS-ERROR-NO                                               04990000
050000         IF PS-SAME-DC-PO-NO                                      05000004
050100             IF PV-HOLD-REC-SEQ-NBR = ZERO                        05010000
050200                 MOVE PV-REC-SEQ-NBR TO PV-HOLD-REC-SEQ-NBR       05020000
050300             END-IF                                               05030000
050400             IF PV-HOLD-SEQ-NBR = ZERO                            05040000
050500                 MOVE PV-NEXT-SEQ-NBR TO PV-HOLD-SEQ-NBR          05050000
050600             END-IF                                               05060000
050700         END-IF                                                   05070000
050800     END-IF.                                                      05080000
050900                                                                  05090000
051000     IF PS-ERROR-NO                                               05100000
051100         IF PS-SAME-DC-PO-NO                                      05110004
051200             PERFORM 2300-BUILD-RECEIVER-INFO                     05120000
051300         ELSE                                                     05130000
051400             PERFORM 2350-UPDATE-RECEIVER-INFO                    05140000
051500     END-IF.                                                      05150000
051600                                                                  05160000
051700     IF PS-SAME-DC-PO-LNE-NO                                      05170004
051800         IF PS-ERROR-NO                                           05180000
051900             PERFORM 2200-ADD-TPKITEM                             05190000
052000         END-IF                                                   05200000
052100         IF PS-ERROR-NO                                           05210000
052200             PERFORM 2400-ADD-RECITM                              05220000
052300         END-IF                                                   05230000
052400         MOVE RC098-PO-NBR        TO PV-HOLD-PO-NBR               05240001
052410         MOVE RC098-OPER-UNIT     TO PV-HOLD-OPER-UNT-ID          05241037
052500         MOVE PC-PTL-FSA          TO PV-HOLD-CRE-UID              05250033
052600         MOVE RC098-PO-LNE-NBR    TO PV-HOLD-PO-LNE-NBR           05260001
052700         MOVE RC098-TO-VERIFY-QTY TO PA-TO-VERIFY-QTY             05270001
052800         IF PV-REC-SEQ-NBR NOT = PV-HOLD-REC-SEQ-NBR              05280000
052900             MOVE PV-REC-SEQ-NBR  TO PV-HOLD-REC-SEQ-NBR          05290000
053000         END-IF                                                   05300000
053100         IF PV-NEXT-SEQ-NBR NOT = PV-HOLD-SEQ-NBR                 05310000
053200             MOVE PV-NEXT-SEQ-NBR TO PV-HOLD-SEQ-NBR              05320000
053300         END-IF                                                   05330000
053400     ELSE                                                         05340000
053500         ADD RC098-TO-VERIFY-QTY  TO PA-TO-VERIFY-QTY             05350001
053600     END-IF.                                                      05360000
053700                                                                  05370000
053800     IF PS-ERROR-NO                                               05380000
053900         PERFORM 2500-PREPARE-TRECDIS                             05390000
054000     END-IF.                                                      05400000
054100                                                                  05410000
054101     IF PS-ERROR-NO                                               05410120
054102         PERFORM 5100-CHECK-FOR-TROUBLE                           05410220
054103     END-IF.                                                      05410320
054104                                                                  05410420
054105     IF PS-ERROR-NO                                               05410520
054106         PERFORM 5200-ACKNOWLEDGE-FSA                             05410620
054107     END-IF.                                                      05410720
054110                                                                  05411020
054111                                                                  05411136
054112     IF PS-ERROR-NO                                               05411236
054120         PERFORM 2600-INSERT-WFT-LOD-CNTL                         05412021
054130     END-IF.                                                      05413021
054140                                                                  05414000
054150     IF PS-ERROR-NO                                               05415021
054160         PERFORM 2700-INSERT-WFT-LOD-XFER                         05416021
054170     END-IF.                                                      05417021
054180                                                                  05418000
054181                                                                  05418124
054182     IF PS-ERROR-NO                                               05418224
054183***      MOVE  PV-HOLD-SEQ-NBR  TO  RC098-NEW-PO-RCVR             05418347
054184         MOVE  PV-REC-SEQ-NBR   TO  RC098-NEW-PO-RCVR             05418447
054185         WRITE OUTPUT-RECORD FROM RC098-ITEM-REC                  05418547
054186         ADD  +1  TO  PA-TOTAL-PROCESS-RECS                       05418647
054187     END-IF.                                                      05418747
054188                                                                  05418847
054190*IF NO ERRORS, JUST CONTINUE,                                     05419000
054200*ELSE REINIT AND RESET SWITCHES AND GO AFTER THE NEXT MSG         05420000
054300*(NEW ITEM) ON THE QUEUE.                                         05430000
054400     IF PS-ERROR-YES                                              05440000
054500         WRITE ERROR-RECORD FROM RC098-ITEM-REC                   05450001
054600         ADD +1 TO PA-TOTAL-ERROR-RECS                            05460000
054700*       PERFORM 7100-ERROR-ROUTINE                                05470000
054800     END-IF.                                                      05480000
054900                                                                  05490000
055000     IF PS-ERROR-NO                                               05500000
055100         PERFORM 6000-DB2-COMMIT                                  05510000
055200         CONTINUE                                                 05520000
055300     ELSE                                                         05530000
055400         PERFORM 6100-DB2-ROLLBACK                                05540000
055500     END-IF.                                                      05550000
055600                                                                  05560000
055700                                                                  05570036
057400******************************************************************05740000
057500* INSERT, UPDATE OR DELETE TABLES.                                05750000
057600* DB2 COMMIT.                                                     05760000
057700******************************************************************05770000
057800 2100-ADD-PACK-SLIP-HEADER.                                       05780000
057900                                                                  05790000
058000     INITIALIZE DCLTPKSLIP.                                       05800000
058100     MOVE RC098-PO-NBR             TO PKSLIP-PO-NBR.              05810001
058200     MOVE RC098-OPER-UNIT          TO PKSLIP-OPER-UNT-ID.         05820001
058300     MOVE 1                        TO PKSLIP-FCLTY-ID.            05830000
058400     MOVE RC098-PO-NBR (3:7)       TO PKSLIP-PKSL-NBR.            05840001
058500     MOVE ZERO                     TO PKSLIP-STR-DEST-NBR.        05850000
058600     MOVE ZERO                     TO PKSLIP-PKSL-PG-CNT.         05860000
058700                                                                  05870000
058800     MOVE 1                        TO PKSLIP-EXPTED-PKG-QTY.      05880000
058900                                                                  05890000
059000     MOVE SPACES                   TO PKSLIP-OWNER-SCAC-ID.       05900000
059100     MOVE SPACES                   TO PKSLIP-ASN-NBR.             05910000
059200     MOVE SPACES                   TO PKSLIP-CONTNR-ID.           05920000
059300     MOVE ZERO                     TO PKSLIP-SHIPT-ID.            05930000
059310     STRING 'REFSEQ'                                              05931006
059320             RC098-ORIG-PO-RCVR                                   05932006
059330            'FSA'                     DELIMITED BY SIZE           05933006
059400                                 INTO PKSLIP-BOL-NBR.             05940006
059500     MOVE SPACES                   TO PKSLIP-PRO-NBR.             05950000
059600     MOVE SPACES                   TO PKSLIP-CRE-SRC-CDE.         05960000
059700     MOVE 'AC'                     TO PKSLIP-PKSL-STAT-CDE.       05970000
059800     MOVE PC-PTL-FSA               TO PKSLIP-CRE-UID.             05980033
059900                                                                  05990000
059910*    GET PO VERSION NUMBER                                        05991004
060000     PERFORM 2110-GET-PO-VER-NBR.                                 06000000
060100     IF PS-ERROR-NO                                               06010000
060200         MOVE PURCHS-VER-NBR           TO PKSLIP-PO-VER-NBR       06020000
060300                                                                  06030000
060310*        GET NEXT PACKSLIP SEQUENCE NUMBER OF THE PO              06031004
060400         PERFORM 2120-GET-NEXT-SEQ-NBR                            06040000
060500     END-IF.                                                      06050000
060600                                                                  06060000
060700     IF PS-ERROR-NO                                               06070000
060800         MOVE PV-NEXT-SEQ-NBR          TO PKSLIP-SEQ-NBR          06080000
060900                                                                  06090000
061000         SET PS-PKSLIP-NOT-INSERTED    TO TRUE                    06100000
061100                                                                  06110000
061110*        GET THE NEXT RECEIVER SEQUENCE NUMBER FOR PO             06111004
061200         PERFORM 2130-GET-MAX-SEQ-NBR                             06120000
061300     END-IF.                                                      06130000
061400                                                                  06140000
061500     IF PS-ERROR-NO                                               06150000
061600         MOVE PV-REC-SEQ-NBR           TO PKSLIP-REC-SEQ-NBR      06160000
061700                                                                  06170000
061800         EXEC SQL                                                 06180000
061900              SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP       06190000
062000         END-EXEC                                                 06200000
062100                                                                  06210000
062200         SET PV-DB2-TMST-SS-01                                    06220000
062300             PV-DB2-TMST-MS-ZERO   TO  TRUE                       06230000
062400         PERFORM 2140-INSERT-LOOP                                 06240000
062500             UNTIL PS-PKSLIP-INSERTED                             06250000
062600                OR PS-ERROR-YES                                   06260000
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900 2110-GET-PO-VER-NBR.                                             06290000
063000                                                                  06300000
063100     EXEC SQL                                                     06310000
063200          SELECT VER_NBR                                          06320000
063300            INTO :PURCHS-VER-NBR                                  06330000
063400            FROM TPURCHS                                          06340000
063500           WHERE PO_NBR         = :DK-PO-NBR                      06350000
063600             AND VER_STATUS_CDE = 'A'                             06360000
063700     END-EXEC.                                                    06370000
063800                                                                  06380000
063900     EVALUATE TRUE                                                06390000
064000         WHEN SQLCODE = +0                                        06400000
064100              CONTINUE                                            06410000
064200         WHEN SQLCODE = +100                                      06420000
064300             MOVE DK-PO-NBR   TO PV-DISP-PO                       06430000
064400             MOVE SQLCODE     TO PV-DISP-SQLCODE                  06440000
064500             MOVE '2110-GET-PO-VER-NBR'                           06450000
064600                              TO RC098-ERROR-PARA-NAME            06460001
064700             SET RC098-PO-NOF                                     06470001
064800                 PS-ERROR-YES    TO TRUE                          06480000
064900             DISPLAY '******************************************' 06490000
065000             DISPLAY '*ABEND                                   *' 06500000
065100             DISPLAY '*PROGRAM   = RCKUP066                    *' 06510000
065200             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 06520000
065300             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 06530000
065400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                06540000
065500             DISPLAY '*PO = ' PV-DISP-PO                          06550000
065600             DISPLAY '******************************************' 06560000
065700                                                                  06570000
065800         WHEN SQLWARN0 NOT = SPACES                               06580000
065900         WHEN SQLCODE < +0                                        06590000
066000         WHEN SQLCODE > +0                                        06600000
066100             MOVE DK-PO-NBR   TO PV-DISP-PO                       06610000
066200             MOVE SQLCODE     TO PV-DISP-SQLCODE                  06620000
066300             MOVE '2110-GET-PO-VER-NBR'                           06630000
066400                              TO RC098-ERROR-PARA-NAME            06640001
066500             SET RC098-DB-ERROR                                   06650001
066600                 PS-ERROR-YES    TO TRUE                          06660000
066700             DISPLAY '******************************************' 06670000
066800             DISPLAY '*ABEND                                   *' 06680000
066900             DISPLAY '*PROGRAM   = RCKUP066                    *' 06690000
067000             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 06700000
067100             DISPLAY '*PARAGRAPH = 2110-GET-PO-VER-NBR         *' 06710000
067200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                06720000
067300             DISPLAY '*PO = ' PV-DISP-PO                          06730000
067400             DISPLAY '******************************************' 06740000
067500     END-EVALUATE.                                                06750000
067600                                                                  06760000
067610*---------------------------------------------------------------- 06761004
067620* GET THE NEXT PACKSLIP SEQUENCE NUMBER FOR THE PO                06762004
067630*---------------------------------------------------------------- 06763004
067700 2120-GET-NEXT-SEQ-NBR.                                           06770000
067800                                                                  06780000
067900     MOVE ZEROS                    TO PV-MAX-SEQ-NBR.             06790000
068000                                                                  06800000
068100     EXEC SQL                                                     06810000
068200          SELECT MAX(SEQ_NBR)                                     06820000
068300            INTO :PV-MAX-SEQ-NBR :PV-SEQ-NBR-IND                  06830000
068400            FROM TPKSLIP                                          06840000
068500           WHERE PO_NBR = :DK-PO-NBR                              06850000
068600     END-EXEC.                                                    06860000
068700                                                                  06870000
068800     EVALUATE TRUE                                                06880000
068900         WHEN SQLCODE = +0                                        06890000
069000              COMPUTE PV-NEXT-SEQ-NBR =                           06900000
069100                      PV-MAX-SEQ-NBR + 1                          06910000
069200                                                                  06920000
069300         WHEN SQLCODE = +100                                      06930000
069400              MOVE +1          TO PV-NEXT-SEQ-NBR                 06940000
069500                                                                  06950000
069600         WHEN SQLWARN0 NOT = SPACES                               06960000
069700         WHEN SQLCODE < +0                                        06970000
069800         WHEN SQLCODE > +0                                        06980000
069900             MOVE DK-PO-NBR   TO PV-DISP-PO                       06990000
070000             MOVE SQLCODE     TO PV-DISP-SQLCODE                  07000000
070100             MOVE '2120-GET-NEXT-SEQ-NBR'                         07010000
070200                              TO RC098-ERROR-PARA-NAME            07020001
070300             SET RC098-DB-ERROR                                   07030001
070400                 PS-ERROR-YES    TO TRUE                          07040000
070500             DISPLAY '******************************************' 07050000
070600             DISPLAY '*ABEND                                   *' 07060000
070700             DISPLAY '*PROGRAM   = RCKUP066                    *' 07070000
070800             DISPLAY '*DB2 OPER  = SELECT ON TPKSLIP           *' 07080000
070900             DISPLAY '*PARAGRAPH = 2120-GET-NEXT-SEQ-NBR       *' 07090000
071000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                07100000
071100             DISPLAY '*PO = ' PV-DISP-PO                          07110000
071200             DISPLAY '******************************************' 07120000
071300     END-EVALUATE.                                                07130000
071400                                                                  07140000
071500*----------------------------------------------------------------*07150000
071600* GET THE NEXT HIGHEST RECEIVER SEQ NBR                          *07160000
071700*----------------------------------------------------------------*07170000
071800 2130-GET-MAX-SEQ-NBR.                                            07180000
071900                                                                  07190000
072000     EXEC SQL                                                     07200000
072100         SELECT MAX(REC_SEQ_NBR)                                  07210000
072200         INTO  :RECEIV-REC-SEQ-NBR                                07220000
072300         FROM   TRECEIV                                           07230000
072400         WHERE  ORD_NBR = :DK-PO-NBR                              07240000
072500     END-EXEC.                                                    07250000
072600                                                                  07260000
072700     EVALUATE TRUE                                                07270000
072800         WHEN SQLCODE = +0                                        07280000
072900             MOVE RECEIV-REC-SEQ-NBR                              07290000
073000                             TO PV-REC-SEQ-NBR                    07300000
073100             ADD +1          TO PV-REC-SEQ-NBR                    07310000
073200         WHEN SQLCODE = +100                                      07320000
073300         WHEN SQLCODE = -305                                      07330000
073400             MOVE +1         TO PV-REC-SEQ-NBR                    07340000
073500                                                                  07350000
073600         WHEN SQLWARN0 NOT = SPACE                                07360000
073700         WHEN SQLCODE < +0                                        07370000
073800         WHEN SQLCODE > +0                                        07380000
073900             MOVE SQLCODE TO PV-DISP-SQLCODE                      07390000
074000             MOVE DK-PO-NBR   TO PV-DISP-PO                       07400000
074100             MOVE '2130-GET-MAX-SEQ-NBR'                          07410000
074200                              TO RC098-ERROR-PARA-NAME            07420001
074300             SET RC098-DB-ERROR                                   07430001
074400                 PS-ERROR-YES    TO TRUE                          07440000
074500             DISPLAY '******************************************' 07450000
074600             DISPLAY '*ABEND                                   *' 07460000
074700             DISPLAY '*PROGRAM   = RCKUP066                    *' 07470000
074800             DISPLAY '*DB2 OPER  = SELECT ON TRECEIV           *' 07480000
074900             DISPLAY '*PARAGRAPH = 2130-GET-MAX-SEQ-NBR        *' 07490000
075000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                07500000
075100             DISPLAY '*PO = ' PV-DISP-PO                          07510000
075200             DISPLAY '******************************************' 07520000
075300     END-EVALUATE.                                                07530000
075400                                                                  07540000
075500*----------------------------------------------------------------*07550000
075600*    THIS ROUTINE ADDED TO PRECLUDE LOGICAL DUPLICATES FROM      *07560000
075700*    BEING INSERTED.  WHEN 2 USERS ARE ADDING PACK SLIPS TO      *07570000
075800*    THE SAME PO, IT IS POSSIBLE TO OBTAIN THE SAME SEQUENCE     *07580000
075900*    NUMBER (LOGICAL DUPLICATE).  BECAUSE THE TIMESTAMP IS PART  *07590004
076000*    OF THE PHYSICAL KEY, NO -803 OCCURS.  IN 5001, WE FORCE     *07600000
076100*    A 01 IN THE SECONDS FIELD AND ALL ZEROES IN THE MICRO-      *07610000
076200*    SECONDS FIELD.  THIS WILL CAUSE A -803 WHICH IS HANDLED     *07620000
076300*    HERE BY ADDING 1 TO THE SEQUENCE NUMBER.                    *07630000
076400*----------------------------------------------------------------*07640000
076500                                                                  07650000
076600 2140-INSERT-LOOP.                                                07660000
076700                                                                  07670000
076800     MOVE PKSLIP-SEQ-NBR  TO PV-SAVE-PKSLIP-SEQ-NBR.              07680000
076900                                                                  07690000
077000     PERFORM 2150-INSERT-TPKSLIP.                                 07700000
077100                                                                  07710000
077200     EVALUATE TRUE                                                07720000
077300         WHEN SQLCODE EQUAL ZERO                                  07730000
077400              SET PS-PKSLIP-INSERTED                              07740000
077500                                   TO TRUE                        07750000
077600                                                                  07760000
077700         WHEN SQLCODE EQUAL -803                                  07770000
077800              ADD 1                TO PKSLIP-SEQ-NBR              07780000
077900                                                                  07790000
078000     END-EVALUATE.                                                07800000
078100                                                                  07810000
078200                                                                  07820000
078300 2150-INSERT-TPKSLIP.                                             07830000
078400                                                                  07840000
078500     EXEC SQL                                                     07850000
078600          INSERT INTO TPKSLIP                                     07860000
078700                 (PO_NBR                                          07870000
078800               ,  SEQ_NBR                                         07880000
078900               ,  CRE_TMST                                        07890000
079000               ,  VER_STAT_CDE                                    07900000
079100               ,  OPER_UNT_ID                                     07910000
079200               ,  FCLTY_ID                                        07920000
079300               ,  PKSL_NBR                                        07930000
079400               ,  STR_DEST_NBR                                    07940000
079500               ,  REC_SEQ_NBR                                     07950000
079600               ,  SHIPT_ID                                        07960000
079700               ,  BOL_NBR                                         07970000
079800               ,  PRO_NBR                                         07980000
079900               ,  PKSL_STAT_CDE                                   07990000
080000               ,  CRE_UID                                         08000000
080100               ,  PO_VER_NBR                                      08010000
080200               ,  CRE_SRC_CDE                                     08020000
080300               ,  EXPTED_PKG_QTY                                  08030000
080400               ,  OWNER_SCAC_ID                                   08040000
080500               ,  ASN_NBR                                         08050000
080600               ,  VEND_SHIP_DTE                                   08060000
080700               ,  PKSL_PG_CNT                                     08070000
080800               ,  CONTNR_ID                                       08080000
080900               ,  ORIG_PKSL_SEQ_NBR)                              08090000
081000          VALUES (:PKSLIP-PO-NBR                                  08100000
081100               ,  :PKSLIP-SEQ-NBR                                 08110000
081200               ,  :PV-DB2-TMST                                    08120000
081300               ,  'A'                                             08130000
081400               ,  :PKSLIP-OPER-UNT-ID                             08140000
081500               ,  :PKSLIP-FCLTY-ID                                08150000
081600               ,  :PKSLIP-PKSL-NBR                                08160000
081700               ,  :PKSLIP-STR-DEST-NBR                            08170000
081800               ,  :PKSLIP-REC-SEQ-NBR                             08180000
081900               ,  :PKSLIP-SHIPT-ID                                08190000
082000               ,  :PKSLIP-BOL-NBR                                 08200000
082100               ,  :PKSLIP-PRO-NBR                                 08210000
082200               ,  :PKSLIP-PKSL-STAT-CDE                           08220000
082300               ,  :PC-PTL-FSA                                     08230040
082400               ,  :PKSLIP-PO-VER-NBR                              08240000
082500               ,  :PKSLIP-CRE-SRC-CDE                             08250000
082600               ,  :PKSLIP-EXPTED-PKG-QTY                          08260000
082700               ,  :PKSLIP-OWNER-SCAC-ID                           08270000
082800               ,  :PKSLIP-ASN-NBR                                 08280000
082900               ,  CURRENT_DATE                                    08290000
083000               ,  :PKSLIP-PKSL-PG-CNT                             08300000
083100               ,  :PKSLIP-CONTNR-ID                               08310000
083200               ,  :PKSLIP-ORIG-PKSL-SEQ-NBR)                      08320000
083300     END-EXEC.                                                    08330000
083400                                                                  08340000
083500     EVALUATE TRUE                                                08350000
083600         WHEN SQLCODE = +0                                        08360000
083700              MOVE +1       TO PT-TOTAL-TPKSLIP-INSERTS           08370000
083800         WHEN SQLWARN0 NOT = SPACES                               08380000
083900         WHEN SQLCODE < +0                                        08390000
084000         WHEN SQLCODE > +0                                        08400000
084100             MOVE PKSLIP-PO-NBR   TO PV-DISP-PO                   08410000
084200             MOVE SQLCODE     TO PV-DISP-SQLCODE                  08420000
084300             MOVE '2150-INSERT-TPKSLIP'                           08430000
084400                              TO RC098-ERROR-PARA-NAME            08440001
084500             SET RC098-DB-ERROR                                   08450001
084600                 PS-ERROR-YES    TO TRUE                          08460000
084700             DISPLAY '******************************************' 08470000
084800             DISPLAY '*ABEND                                   *' 08480000
084900             DISPLAY '*PROGRAM   = RCKUP066                    *' 08490000
085000             DISPLAY '*DB2 OPER  = INSERT ON TPKSLIP           *' 08500000
085100             DISPLAY '*PARAGRAPH = 2150-INSERT-TPKSLIP         *' 08510000
085200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                08520000
085300             DISPLAY '*PO = ' PV-DISP-PO                          08530000
085400             DISPLAY '******************************************' 08540000
085500     END-EVALUATE.                                                08550000
085600                                                                  08560000
085700 2160-UPDATE-PACK-SLIP-HEADER.                                    08570000
085800     PERFORM 2170-SELECT-TPKSLIP.                                 08580000
085900     COMPUTE PKSLIP-EXPTED-PKG-QTY = PKSLIP-EXPTED-PKG-QTY +      08590000
086000                RC098-TO-VERIFY-QTY.                              08600001
086100     PERFORM 2180-UPDATE-TPKSLIP.                                 08610000
086200                                                                  08620000
086300 2170-SELECT-TPKSLIP.                                             08630000
086400                                                                  08640000
086500     EXEC SQL                                                     08650000
086600          SELECT EXPTED_PKG_QTY                                   08660000
086700            INTO :PKSLIP-EXPTED-PKG-QTY                           08670000
086800            FROM TPKSLIP                                          08680000
086900           WHERE PO_NBR       = :DK-PO-NBR                        08690000
087000             AND SEQ_NBR      = :PV-SAVE-PKSLIP-SEQ-NBR           08700000
087100             AND VER_STAT_CDE = 'A'                               08710000
087200     END-EXEC.                                                    08720000
087300                                                                  08730000
087400     EVALUATE TRUE                                                08740000
087500         WHEN SQLCODE = +0                                        08750000
087600              CONTINUE                                            08760000
087700         WHEN SQLWARN0 NOT = SPACES                               08770000
087800         WHEN SQLCODE < +0                                        08780000
087900         WHEN SQLCODE > +0                                        08790000
088000             MOVE DK-PO-NBR       TO PV-DISP-PO                   08800000
088100             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          08810000
088200                                  TO PV-DISP-SEQ                  08820000
088300             MOVE SQLCODE     TO PV-DISP-SQLCODE                  08830000
088400             MOVE '2170-SELECT-TPKSLIP'                           08840000
088500                              TO RC098-ERROR-PARA-NAME            08850001
088600             SET RC098-DB-ERROR                                   08860001
088700                 PS-ERROR-YES    TO TRUE                          08870000
088800             DISPLAY '******************************************' 08880000
088900             DISPLAY '*ABEND                                   *' 08890000
089000             DISPLAY '*PROGRAM   = RCKUP066                    *' 08900000
089100             DISPLAY '*DB2 OPER  = SELECT TPKSLIP              *' 08910000
089200             DISPLAY '*PARAGRAPH = 2170-SELECT-TPKSLIP         *' 08920000
089300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                08930000
089400             DISPLAY '*PO = ' PV-DISP-PO                          08940000
089500             DISPLAY '*SEQ = ' PV-DISP-SEQ                        08950000
089600             DISPLAY '******************************************' 08960000
089700     END-EVALUATE.                                                08970000
089800                                                                  08980000
089900 2180-UPDATE-TPKSLIP.                                             08990000
090000     EXEC SQL                                                     09000000
090100          UPDATE TPKSLIP                                          09010000
090200             SET EXPTED_PKG_QTY = :PKSLIP-EXPTED-PKG-QTY          09020000
090300           WHERE PO_NBR         = :DK-PO-NBR                      09030000
090400             AND SEQ_NBR        = :PV-SAVE-PKSLIP-SEQ-NBR         09040000
090500             AND VER_STAT_CDE   = 'A'                             09050000
090600     END-EXEC                                                     09060000
090700                                                                  09070000
090800     EVALUATE TRUE                                                09080000
090900         WHEN SQLCODE = +0                                        09090000
091000             MOVE +1       TO PT-TOTAL-TPKSLIP-UPDATES            09100000
091100         WHEN SQLWARN0 NOT = SPACES                               09110000
091200         WHEN SQLCODE < +0                                        09120000
091300         WHEN SQLCODE > +0                                        09130000
091400             MOVE DK-PO-NBR       TO PV-DISP-PO                   09140000
091500             MOVE PV-SAVE-PKSLIP-SEQ-NBR                          09150000
091600                                  TO PV-DISP-SEQ                  09160000
091700             MOVE SQLCODE     TO PV-DISP-SQLCODE                  09170000
091800             MOVE '2180-UPDATE-TPKSLIP'                           09180000
091900                              TO RC098-ERROR-PARA-NAME            09190001
092000             SET RC098-PO-NOF                                     09200001
092100                 PS-ERROR-YES    TO TRUE                          09210000
092200             DISPLAY '******************************************' 09220000
092300             DISPLAY '*ABEND                                   *' 09230000
092400             DISPLAY '*PROGRAM   = RCKUP066                    *' 09240000
092500             DISPLAY '*DB2 OPER  = UPDATE TPKSLIP              *' 09250000
092600             DISPLAY '*PARAGRAPH = 2180-UPDATE-TPKSLIP         *' 09260000
092700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                09270000
092800             DISPLAY '*PO = ' PV-DISP-PO                          09280000
092900             DISPLAY '*SEQ = ' PV-DISP-SEQ                        09290000
093000             DISPLAY '******************************************' 09300000
093100     END-EVALUATE.                                                09310000
093200*----------------------------------------------------------------*09320000
093300*    INSERT A PACK SLIP ITEM ROW                                 *09330000
093400*----------------------------------------------------------------*09340000
093500                                                                  09350000
093600                                                                  09360000
093700 2200-ADD-TPKITEM.                                                09370000
093800                                                                  09380000
093900     PERFORM 2210-SETUP-TPKITEM-FIELDS.                           09390000
094000     PERFORM 2230-INSERT-TPKITEM.                                 09400000
094100                                                                  09410000
094200 2210-SETUP-TPKITEM-FIELDS.                                       09420000
094300                                                                  09430000
094400     MOVE PV-HOLD-PO-NBR         TO PKITEM-PO-NBR.                09440000
094500     MOVE PV-HOLD-SEQ-NBR        TO PKITEM-SEQ-NBR.               09450000
094600     MOVE PA-TO-VERIFY-QTY       TO PKITEM-PKSL-ITM-QTY.          09460000
094700     MOVE PV-HOLD-CRE-UID        TO PKITEM-CRE-UID.               09470000
094800     MOVE PA-TO-VERIFY-QTY       TO PKITEM-ORIG-PKSL-ITM-QTY.     09480000
094900     MOVE PV-HOLD-PO-NBR         TO DK-HOLD-PO-NBR.               09490000
095000     MOVE PV-HOLD-PO-LNE-NBR     TO DK-HOLD-LNE-NBR.              09500000
095100     PERFORM 2220-SELECT-LINE.                                    09510000
095200     MOVE PURITM-VER-NBR         TO PKITEM-PURITM-VER-NBR.        09520000
095300     MOVE PURITM-APP-PO-LNE-NBR  TO PKITEM-PKSL-LNE-NBR.          09530000
095400                                                                  09540000
095500                                                                  09550000
095600 2220-SELECT-LINE.                                                09560000
095700     EXEC SQL                                                     09570000
095800        SELECT  A.APP_PO_LNE_NBR                                  09580000
095900           ,    A.VER_NBR                                         09590000
096000           ,    A.ITM_NBR                                         09600000
096100           ,    A.PIC_ITM_IND                                     09610000
096200           ,    A.PO_LNE_NBR                                      09620000
096300           ,    A.VEND_STYL_NAME                                  09630000
096400           ,    A.SKU_SEQ_NBR                                     09640000
096500           ,    A.UNT_RTL_PR_AMT                                  09650000
096600           ,    A.UNT_COST_AMT                                    09660000
096700           ,    A.GP_RTL_AMT                                      09670000
096800           ,    A.GP_QTY                                          09680000
096900          INTO :PURITM-APP-PO-LNE-NBR                             09690000
097000           ,    :PURITM-VER-NBR                                   09700000
097100           ,    :PURITM-ITM-NBR                                   09710000
097200           ,    :PURITM-PIC-ITM-IND                               09720000
097300           ,    :PURITM-PO-LNE-NBR                                09730000
097400           ,    :PURITM-VEND-STYL-NAME                            09740000
097500           ,    :PURITM-SKU-SEQ-NBR                               09750000
097600           ,    :PURITM-UNT-RTL-PR-AMT                            09760000
097700           ,    :PURITM-UNT-COST-AMT                              09770000
097800           ,    :PURITM-GP-RTL-AMT                                09780000
097900           ,    :PURITM-GP-QTY                                    09790000
098000          FROM TPURITM A                                          09800000
098100          WHERE A.PO_NBR          = :DK-HOLD-PO-NBR               09810000
098200            AND A.VER_STATUS_CDE  = 'A'                           09820000
098300            AND A.PO_LNE_NBR      = :DK-HOLD-LNE-NBR              09830000
098400     END-EXEC.                                                    09840000
098500                                                                  09850000
098600     EVALUATE TRUE                                                09860000
098700         WHEN SQLCODE = +0                                        09870000
098800         WHEN SQLCODE = -811                                      09880000
098900              CONTINUE                                            09890000
099000         WHEN SQLCODE = +100                                      09900000
099100             MOVE DK-PO-NBR   TO PV-DISP-PO                       09910000
099200             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 09920000
099300             MOVE SQLCODE     TO PV-DISP-SQLCODE                  09930000
099400             MOVE '2220-SELECT-LINE'                              09940000
099500                              TO RC098-ERROR-PARA-NAME            09950001
099600             SET RC098-ITEM-NOT-ON-PO                             09960001
099700                 PS-ERROR-YES    TO TRUE                          09970000
099800             DISPLAY '******************************************' 09980000
099900             DISPLAY '*ABEND                                   *' 09990000
100000             DISPLAY '*PROGRAM   = RCKUP066                    *' 10000000
100100             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 10010000
100200             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 10020000
100300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10030000
100400             DISPLAY '*PO = ' PV-DISP-PO                          10040000
100500             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  10050000
100600             DISPLAY '******************************************' 10060000
100700         WHEN SQLWARN0 NOT = SPACES                               10070000
100800         WHEN SQLCODE < +0                                        10080000
100900         WHEN SQLCODE > +0                                        10090000
101000             MOVE DK-PO-NBR   TO PV-DISP-PO                       10100000
101100             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 10110000
101200             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10120000
101300             MOVE '2220-SELECT-LINE'                              10130000
101400                              TO RC098-ERROR-PARA-NAME            10140001
101500             SET RC098-DB-ERROR                                   10150001
101600                 PS-ERROR-YES    TO TRUE                          10160000
101700             DISPLAY '******************************************' 10170000
101800             DISPLAY '*ABEND                                   *' 10180000
101900             DISPLAY '*PROGRAM   = RCKUP066                    *' 10190000
102000             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 10200000
102100             DISPLAY '*PARAGRAPH = 2220-SELECT-LINE            *' 10210000
102200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10220000
102300             DISPLAY '*PO = ' PV-DISP-PO                          10230000
102400             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  10240000
102500             DISPLAY '******************************************' 10250000
102600     END-EVALUATE.                                                10260000
102700                                                                  10270000
102800 2230-INSERT-TPKITEM.                                             10280000
102900     EXEC SQL                                                     10290000
103000          INSERT INTO TPKITEM                                     10300000
103100                 (PO_NBR                                          10310000
103200              ,   SEQ_NBR                                         10320000
103300              ,   PKSL_LNE_NBR                                    10330000
103400              ,   CRE_TMST                                        10340000
103500              ,   VER_STAT_CDE                                    10350000
103600              ,   PKSL_ITM_QTY                                    10360000
103700              ,   CRE_UID                                         10370000
103800              ,   PURITM_VER_NBR                                  10380000
103900              ,   ORIG_PKSL_ITM_QTY)                              10390000
104000          VALUES (:PKITEM-PO-NBR                                  10400000
104100              ,   :PKITEM-SEQ-NBR                                 10410000
104200              ,   :PKITEM-PKSL-LNE-NBR                            10420000
104300              ,    CURRENT_TIMESTAMP                              10430000
104400              ,    'A'                                            10440000
104500              ,   :PKITEM-PKSL-ITM-QTY                            10450000
104600              ,   :PC-PTL-FSA                                     10460038
104700              ,   :PKITEM-PURITM-VER-NBR                          10470000
104800              ,   0)                                              10480000
104900     END-EXEC.                                                    10490000
105000                                                                  10500000
105100     EVALUATE TRUE                                                10510000
105200         WHEN SQLCODE = +0                                        10520000
105300*             MOVE +1       TO PT-TOTAL-TPKITEM-INSERTS           10530000
105400              ADD  +1       TO PA-TOTAL-TPKITEM-INSERTS           10540000
105500         WHEN SQLWARN0 NOT = SPACES                               10550000
105600         WHEN SQLCODE < +0                                        10560000
105700         WHEN SQLCODE > +0                                        10570000
105800             MOVE PKITEM-PO-NBR  TO PV-DISP-PO                    10580000
105900             MOVE PKITEM-SEQ-NBR TO PV-DISP-SEQ                   10590000
106000             MOVE SQLCODE     TO PV-DISP-SQLCODE                  10600000
106100             MOVE '2230-INSERT-TPKITEM'                           10610000
106200                              TO RC098-ERROR-PARA-NAME            10620001
106300             SET RC098-DB-ERROR                                   10630001
106400                 PS-ERROR-YES    TO TRUE                          10640000
106500             DISPLAY '******************************************' 10650000
106600             DISPLAY '*ABEND                                   *' 10660000
106700             DISPLAY '*PROGRAM   = RCKUP066                    *' 10670000
106800             DISPLAY '*DB2 OPER  = INSERT ON TPKITEM           *' 10680000
106900             DISPLAY '*PARAGRAPH = 2230-INSERT-TPKITEM         *' 10690000
107000             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                10700000
107100             DISPLAY '*PO = ' PV-DISP-PO                          10710000
107200             DISPLAY '*SEQ = ' PV-DISP-SEQ                        10720000
107300             DISPLAY '******************************************' 10730000
107400     END-EVALUATE.                                                10740000
107500                                                                  10750000
107600/                                                                 10760000
107700*---------------------------------------------------------------* 10770000
107800* CHECK TO SEE IF THE DC SHOULD FLUSH THEIR BUILDING.             10780000
107900*---------------------------------------------------------------* 10790000
108000 2250-CHECK-DC-FLUSH-PARM.                                        10800000
108100                                                                  10810000
108200     EXEC SQL                                                     10820000
108300          SELECT  FUNC_TXT                                        10830000
108400          INTO   :KRPRPM-FUNC-TXT                                 10840000
108500          FROM  TKRPRPM                                           10850000
108600          WHERE LOC_ID            =  90                           10860000
108700            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      10870000
108800            AND FUNC_PRC_STAT_CDE =  'AC'                         10880000
108900     END-EXEC.                                                    10890000
109000                                                                  10900000
109100     EVALUATE TRUE                                                10910000
109200         WHEN SQLCODE = +0                                        10920000
109300            IF KRPRPM-FUNC-TXT = 'N'                              10930000
109400                SET PS-DC-FLUSH-NO  TO TRUE                       10940000
109500            ELSE                                                  10950000
109600                SET PS-DC-FLUSH-YES TO TRUE                       10960000
109700            END-IF                                                10970000
109800         WHEN OTHER                                               10980000
109900                SET PS-DC-FLUSH-NO  TO TRUE                       10990000
110000     END-EVALUATE.                                                11000000
110100                                                                  11010000
110200*---------------------------------------------------------------* 11020000
110300* CHECK TO SEE IF STORE IS IN INVENTORY CYCLE                     11030000
110400*---------------------------------------------------------------* 11040000
110500 2275-CHECK-INV-IN-PROCESS.                                       11050000
110600                                                                  11060000
110700     EXEC SQL                                                     11070000
110800          SELECT                                                  11080000
110900                 A.DC_CTOFF_DTE                                   11090000
111000             ,   (A.DC_CTOFF_DTE + 7 DAYS)                        11100000
111100          INTO                                                    11110000
111200                 :XLT00025-DC-CTOFF-DTE                           11120000
111300             ,   :PV-WORK-DATE-PLUS-7                             11130000
111400          FROM                                                    11140000
111500                XLT_MDSE_INV_PARM A                               11150000
111600          WHERE A.LOC_NBR           =  :RECDIS-STR-NBR            11160000
111700           AND  A.DC_CTOFF_DTE >= (CURRENT_DATE - 7 DAYS)         11170000
111800           AND  A.DC_CTOFF_DTE <= (CURRENT_DATE + 7 DAYS)         11180000
111900           AND  A.ACTV_IND         = 'Y'                          11190000
112000           AND  A.LOC_INV_STAT_CDE = 'IN'                         11200000
112100     END-EXEC.                                                    11210000
112200                                                                  11220000
112300     EVALUATE TRUE                                                11230000
112400         WHEN SQLCODE = +0                                        11240000
112500            SET RC098-STORE-INV-CYCLE                             11250001
112600                PS-ERROR-YES    TO TRUE                           11260000
112700         WHEN SQLCODE = +100                                      11270000
112800             CONTINUE                                             11280000
112900         WHEN SQLWARN0 NOT = SPACES                               11290000
113000         WHEN SQLCODE < +0                                        11300000
113100         WHEN SQLCODE > +0                                        11310000
113200             MOVE RECDIS-STR-NBR  TO PV-DISP-STR-NBR              11320000
113300             MOVE SQLCODE     TO PV-DISP-SQLCODE                  11330000
113400             MOVE '2275-CHECK-INV-IN-PROCESS'                     11340000
113500                              TO RC098-ERROR-PARA-NAME            11350001
113600             SET RC098-DB-ERROR                                   11360001
113700                 PS-ERROR-YES    TO TRUE                          11370000
113800             DISPLAY '******************************************' 11380000
113900             DISPLAY '*ABEND                                   *' 11390000
114000             DISPLAY '*PROGRAM   = RCKUP066                    *' 11400000
114100             DISPLAY '*DB2 OPER  = SELECT ON XLT_MDSE_INV_PARM *' 11410000
114200             DISPLAY '*PARAGRAPH = 2275-CHECK-INV-IN-PROCESS   *' 11420000
114300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                11430000
114400             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  11440000
114500             DISPLAY '******************************************' 11450000
114600     END-EVALUATE.                                                11460000
114700                                                                  11470000
114800                                                                  11480000
114900*---------------------------------------------------------------* 11490000
114910* CREATE VERIFIED 'CR' RECEIVER                                   11491004
114920*---------------------------------------------------------------* 11492004
115000 2300-BUILD-RECEIVER-INFO.                                        11500000
115100                                                                  11510000
115200     INITIALIZE DCLTRECEIV.                                       11520000
115300                                                                  11530000
115400     PERFORM 2310-DETERMINE-INDICATORS.                           11540000
115500                                                                  11550000
115600     MOVE RC098-PO-NBR           TO RECEIV-ORD-NBR.               11560001
115700     MOVE PV-REC-SEQ-NBR         TO RECEIV-REC-SEQ-NBR            11570000
115800                                    RECEIV-REFER-BACK-SEQ-NBR.    11580000
116000     MOVE PURCHS-VER-NBR         TO RECEIV-PO-VER-NBR.            11600000
116100                                                                  11610000
116200     MOVE RC098-OPER-UNIT        TO RECEIV-OPER-UNT-ID.           11620001
116300     MOVE 1                      TO RECEIV-FCLTY-ID.              11630000
116400     MOVE 'VE'                   TO RECEIV-STATUS-CDE.            11640000
116500     MOVE 'P'                    TO RECEIV-SYST-CRE-CDE.          11650000
116600     MOVE RC098-REC-TYP-CDE      TO RECEIV-REC-TYP-CDE.           11660001
116700     MOVE 'A'                    TO RECEIV-VER-STATUS-CDE.        11670000
116800     MOVE 1                      TO RECEIV-EXPTED-CART-CNT.       11680000
116900     MOVE 1                      TO RECEIV-ACTL-CART-CNT.         11690000
117000     MOVE RC098-TO-VERIFY-QTY    TO RECEIV-EXPTED-ITM-QTY         11700001
117100                                    RECEIV-ACTL-ITM-QTY.          11710000
117200     MOVE '9999-09-09-09.09.09.999999'                            11720000
117300                                 TO RECEIV-ML-POST-TMST           11730000
117400                                    RECEIV-FS-POST-TMST           11740000
117500                                    RECEIV-IN-TRBL-TMST           11750000
117600                                    RECEIV-MKNG-APRN-PRT-TMST.    11760000
117900     MOVE RC098-OPER-UNIT         TO RECEIV-CURR-OPER-UNT-ID.     11790001
118000                                                                  11800000
118100     MOVE RC098-OPER-UNIT         TO RECEIV-CRE-OPER-UNT-ID.      11810001
118200     MOVE PC-PTL-FSA              TO RECEIV-CRE-UID.              11820033
118300                                                                  11830000
118400     MOVE 1                       TO RECEIV-CURR-FCLTY-ID.        11840000
118500     MOVE 1                       TO RECEIV-CRE-FCLTY-ID.         11850000
118600     MOVE PC-CURRENT-PROGRAM-NAME TO RECEIV-UPD-PGM-ID.           11860034
118700     MOVE PC-PTL-FSA              TO RECEIV-UPD-UID               11870039
118800                                     RECEIV-VRFD-USR-ID.          11880000
118900                                                                  11890000
119000     MOVE RC098-RCVG-CLERK-INIT-ID                                11900001
119100                                 TO RECEIV-RCVG-CLERK-INIT-ID.    11910000
119200     MOVE 'N'                    TO RECEIV-FRE-ASTRA-IND.         11920000
119300                                                                  11930000
119400     PERFORM VARYING PV-COUNT FROM 1 BY 1 UNTIL                   11940000
119500          PV-COUNT > 10                                           11950000
119600         PERFORM 3000-OPEN-TRECVER-CSR                            11960000
119700         PERFORM 3020-FETCH-TRECVER-CSR                           11970000
119800                                                                  11980000
119900         MOVE RECVER-MAX-RCVR-NBR  TO PW-CONTROL-PANL-NBR-9       11990000
120000         DIVIDE PW-CONTROL-PANL-NBR-9 BY 9 GIVING PW-QUOTIENT     12000000
120100                                       REMAINDER  PW-REMAINDER    12010000
120200         COMPUTE PW-CONTROL-CEHCK-DIG = ( 9 - PW-REMAINDER )      12020000
120300         COMPUTE RECEIV-RCVR-NBR = PW-CONTROL-KEYREC-9 * 1        12030000
120400         ADD +1                    TO RECVER-MAX-RCVR-NBR         12040000
120500         PERFORM 3040-DELETE-TRECVER-CSR                          12050000
120600         PERFORM 3060-INSERT-TRECVER                              12060000
120700         PERFORM 3080-CLOSE-TRECVER-CSR                           12070000
120800     END-PERFORM.                                                 12080000
120900                                                                  12090000
121000     PERFORM 2340-INSERT-TRECEIV.                                 12100000
121500                                                                  12150000
121510                                                                  12151009
121600 2310-DETERMINE-INDICATORS.                                       12160000
121700                                                                  12170000
121800* SET PRE TICKET INDICATOR                                        12180000
121900     MOVE 4                      TO DK-AGRMT-TYP-ID.              12190000
122000     MOVE 1                      TO DK-TYP-CDE.                   12200000
122100                                                                  12210000
122200     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12220000
122300                                                                  12230000
122400     IF  PV-DB2-COUNT > +0                                        12240000
122500         MOVE 'Y'                TO RECEIV-PRE-TKT-IND            12250000
122600     ELSE                                                         12260000
122700         MOVE 'N'                TO RECEIV-PRE-TKT-IND            12270000
122800     END-IF.                                                      12280000
122900                                                                  12290000
123000                                                                  12300000
123100* SET GARMENT ON HANGER (GOH) INDICATOR                           12310000
123200     MOVE 4                      TO DK-AGRMT-TYP-ID.              12320000
123300     MOVE 2                      TO DK-TYP-CDE.                   12330000
123400                                                                  12340000
123500     PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12350000
123600                                                                  12360000
123700     IF  PV-DB2-COUNT > +0                                        12370000
123800         MOVE 'Y'                TO RECEIV-GOH-IND                12380000
123900     ELSE                                                         12390000
124000         MOVE 'N'                TO RECEIV-GOH-IND                12400000
124100     END-IF.                                                      12410000
124200                                                                  12420000
124300* SET PACK BY STORE INDICATOR AND PACKAGING CODE                  12430000
124400     MOVE RC098-PKGNG-CDE        TO RECEIV-PKGNG-CDE              12440001
124500     IF RC098-PKGNG-CDE = SPACE                                   12450001
124600         MOVE 'Y'                TO RECEIV-PACK-BY-ST-IND         12460000
124700     ELSE                                                         12470000
124800         MOVE 'N'                TO RECEIV-PACK-BY-ST-IND         12480000
124900     END-IF.                                                      12490000
125000                                                                  12500000
125100*    MOVE 4                      TO DK-AGRMT-TYP-ID.              12510000
125200*    MOVE 4                      TO DK-TYP-CDE.                   12520000
125300                                                                  12530000
125400*    PERFORM 2320-CHECK-PO-SERVICE-INFO.                          12540000
125500                                                                  12550000
125600*    IF  PV-DB2-COUNT > +0                                        12560000
125700*        MOVE 'Y'                TO RECEIV-PACK-BY-ST-IND         12570000
125800*    ELSE                                                         12580000
125900*        MOVE 'N'                TO RECEIV-PACK-BY-ST-IND         12590000
126000*    END-IF.                                                      12600000
126100                                                                  12610000
126200*    IF RECEIV-PACK-BY-ST-IND NOT = 'Y'                           12620000
126300*        PERFORM 2330-PKGNG-CDE-FROM-PO                           12630000
126400*    ELSE                                                         12640000
126500*        MOVE SPACES                   TO RECEIV-PKGNG-CDE        12650000
126600*    END-IF.                                                      12660000
126700                                                                  12670000
126800 2320-CHECK-PO-SERVICE-INFO.                                      12680000
126900                                                                  12690000
127000     MOVE 0        TO PV-DB2-COUNT.                               12700000
127100                                                                  12710000
127200     EXEC SQL                                                     12720000
127300          SELECT COUNT(*)                                         12730000
127400            INTO :PV-DB2-COUNT                                    12740000
127500            FROM TPOAGMT                                          12750000
127600           WHERE PO_NBR         = :DK-PO-NBR                      12760000
127700             AND AGRMT_TYP_ID   = :DK-AGRMT-TYP-ID                12770000
127800             AND VER_STATUS_CDE = 'A'                             12780000
127900             AND TYP_CDE        = :DK-TYP-CDE                     12790000
128000     END-EXEC.                                                    12800000
128100                                                                  12810000
128200     EVALUATE TRUE                                                12820000
128300         WHEN SQLCODE = +0                                        12830000
128400         WHEN SQLCODE = +100                                      12840000
128500              CONTINUE                                            12850000
128600                                                                  12860000
128700         WHEN SQLWARN0 NOT = SPACES                               12870000
128800         WHEN SQLCODE < +0                                        12880000
128900         WHEN SQLCODE > +0                                        12890000
129000             MOVE DK-PO-NBR   TO PV-DISP-PO                       12900000
129100             MOVE DK-TYP-CDE  TO PV-DISP-TYP-CDE                  12910000
129200             MOVE SQLCODE     TO PV-DISP-SQLCODE                  12920000
129300             MOVE '2320-CHECK-PO-SERVICE-INFO'                    12930000
129400                              TO RC098-ERROR-PARA-NAME            12940001
129500             SET RC098-DB-ERROR                                   12950001
129600                 PS-ERROR-YES    TO TRUE                          12960000
129700             DISPLAY '******************************************' 12970000
129800             DISPLAY '*ABEND                                   *' 12980000
129900             DISPLAY '*PROGRAM   = RCKUP066                    *' 12990000
130000             DISPLAY '*DB2 OPER  = SELECT ON TPOAGMT           *' 13000000
130100             DISPLAY '*PARAGRAPH = 2320-CHECK-PO-SERVICE-INFO  *' 13010000
130200             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                13020000
130300             DISPLAY '*PO = ' PV-DISP-PO                          13030000
130400             DISPLAY '*TYPE = ' PV-DISP-TYP-CDE                   13040000
130500             DISPLAY '*AGRMT TYP ID = ' DK-AGRMT-TYP-ID           13050000
130600             DISPLAY '******************************************' 13060000
130700     END-EVALUATE.                                                13070000
130800                                                                  13080000
134300                                                                  13430000
134400 2340-INSERT-TRECEIV.                                             13440000
134500                                                                  13450000
134600     EXEC SQL                                                     13460000
134700          INSERT INTO TRECEIV                                     13470000
134800                 ( ORD_NBR                                        13480000
134900                ,  REC_SEQ_NBR                                    13490000
135000                ,  CRE_TMST                                       13500000
135100                ,  CRE_UID                                        13510000
135200                ,  PO_VER_NBR                                     13520000
135300                ,  OPER_UNT_ID                                    13530000
135400                ,  FCLTY_ID                                       13540000
135500                ,  STATUS_CDE                                     13550000
135600                ,  SYST_CRE_CDE                                   13560000
135700                ,  REC_TYP_CDE                                    13570000
135800                ,  VER_STATUS_CDE                                 13580000
135900                ,  PACK_BY_ST_IND                                 13590000
136000                ,  REC_TMST                                       13600000
136100                ,  EXPTED_CART_CNT                                13610000
136200                ,  ACTL_CART_CNT                                  13620000
136300                ,  EXPTED_ITM_QTY                                 13630000
136400                ,  ACTL_ITM_QTY                                   13640000
136500                ,  RCVR_NBR                                       13650000
136600                ,  ML_POST_TMST                                   13660000
136700                ,  FS_POST_TMST                                   13670000
136800                ,  PRE_TKT_IND                                    13680000
136900                ,  AD_INFO_DESC                                   13690000
137000                ,  IN_TRBL_TMST                                   13700000
137100                ,  IN_TRBL_MIN_CNT                                13710000
137200                ,  IN_TRBL_HOUR_CNT                               13720000
137300                ,  VERFYD_TMST                                    13730000
137400                ,  RCVG_CLERK_INIT_ID                             13740000
137500                ,  REFER_BACK_SEQ_NBR                             13750000
137600                ,  AP_PRC_CDE                                     13760000
137700                ,  AP_PRC_DTE                                     13770000
137800                ,  MIS_DIRECT_IND                                 13780000
137900                ,  IMPRT_IND                                      13790000
138000                ,  CRE_OPER_UNT_ID                                13800000
138100                ,  CRE_FCLTY_ID                                   13810000
138200                ,  CURR_OPER_UNT_ID                               13820000
138300                ,  CURR_FCLTY_ID                                  13830000
138400                ,  UPD_TMST                                       13840000
138500                ,  UPD_UID                                        13850000
138600                ,  UPD_PGM_ID                                     13860000
138700                ,  MKNG_APRN_PRT_TMST                             13870000
138800                ,  GOH_IND                                        13880000
138900                ,  VRFD_USR_ID                                    13890000
139000                ,  AP_RVRSL_DTE                                   13900000
139100                ,  PKGNG_CDE                                      13910000
139200                ,  FRE_ASTRA_IND                                  13920000
139300                  )                                               13930000
139400         VALUES ( :RECEIV-ORD-NBR                                 13940000
139500                , :RECEIV-REC-SEQ-NBR                             13950000
139600                , CURRENT_TIMESTAMP                               13960000
139700                , :PC-PTL-FSA                                     13970038
139800                , :RECEIV-PO-VER-NBR                              13980000
139900                , :RECEIV-OPER-UNT-ID                             13990000
140000                , :RECEIV-FCLTY-ID                                14000000
140100                , :RECEIV-STATUS-CDE                              14010000
140200                , :RECEIV-SYST-CRE-CDE                            14020000
140300                , :RECEIV-REC-TYP-CDE                             14030000
140400                , :RECEIV-VER-STATUS-CDE                          14040000
140500                , :RECEIV-PACK-BY-ST-IND                          14050000
140600*               , :RECEIV-REC-TMST                                14060000
140700                , CURRENT_TIMESTAMP                               14070000
140800                , :RECEIV-EXPTED-CART-CNT                         14080000
140900                , :RECEIV-ACTL-CART-CNT                           14090000
141000                , :RECEIV-EXPTED-ITM-QTY                          14100000
141100                , :RECEIV-ACTL-ITM-QTY                            14110000
141200                , :RECEIV-RCVR-NBR                                14120000
141300                , :RECEIV-ML-POST-TMST                            14130000
141400                , :RECEIV-FS-POST-TMST                            14140000
141500                , :RECEIV-PRE-TKT-IND                             14150000
141600                , :RECEIV-AD-INFO-DESC                            14160000
141700                , :RECEIV-IN-TRBL-TMST                            14170000
141800                , :RECEIV-IN-TRBL-MIN-CNT                         14180000
141900                , :RECEIV-IN-TRBL-HOUR-CNT                        14190000
142000                , CURRENT_TIMESTAMP                               14200000
142100                , :RECEIV-RCVG-CLERK-INIT-ID                      14210000
142200                , :RECEIV-REFER-BACK-SEQ-NBR                      14220000
142300                , :RECEIV-AP-PRC-CDE                              14230000
142400                , '9999-09-09'                                    14240000
142500                , :RECEIV-MIS-DIRECT-IND                          14250000
142600                , :RECEIV-IMPRT-IND                               14260000
142700                , :RECEIV-CRE-OPER-UNT-ID                         14270000
142800                , :RECEIV-CRE-FCLTY-ID                            14280000
142900                , :RECEIV-CURR-OPER-UNT-ID                        14290000
143000                , :RECEIV-CURR-FCLTY-ID                           14300000
143100                , CURRENT_TIMESTAMP                               14310000
143200                , :PC-PTL-FSA                                     14320038
143300                , :RECEIV-UPD-PGM-ID                              14330000
143400                , :RECEIV-MKNG-APRN-PRT-TMST                      14340000
143500                , :RECEIV-GOH-IND                                 14350000
143600                , :PC-PTL-FSA                                     14360038
143700                , '9999-09-09'                                    14370000
143800                , :RECEIV-PKGNG-CDE                               14380000
143900                , :RECEIV-FRE-ASTRA-IND                           14390000
144000                 )                                                14400000
144100     END-EXEC.                                                    14410000
144200                                                                  14420000
144300     EVALUATE TRUE                                                14430000
144400         WHEN SQLCODE = +0                                        14440000
144500              MOVE +1       TO PT-TOTAL-TRECEIV-INSERTS           14450000
144600              MOVE RECEIV-ORD-NBR     TO PV-DISP-PO               14460000
144700              MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ          14470000
144800              DISPLAY ' PO / RECEIVER '                           14480000
144900                      PV-DISP-PO ' ' PV-DISP-REC-SEQ              14490000
145000              MOVE PV-DISP-PO         TO PV-BKUP-PO-NBR-2         14500000
145100              MOVE PV-DISP-REC-SEQ    TO PV-BKUP-REC-SEQ-2        14510000
145200              WRITE BKUP-RECORD FROM PV-BKUP-RECORD-2             14520000
145300         WHEN SQLWARN0 NOT = SPACE                                14530000
145400         WHEN SQLCODE < +0                                        14540000
145500         WHEN SQLCODE > +0                                        14550000
145600             MOVE RECEIV-ORD-NBR  TO PV-DISP-PO                   14560000
145700             MOVE RECEIV-REC-SEQ-NBR TO PV-DISP-REC-SEQ           14570000
145800             MOVE SQLCODE TO PV-DISP-SQLCODE                      14580000
145900             MOVE '2340-INSERT-TRECEIV'                           14590000
146000                              TO RC098-ERROR-PARA-NAME            14600001
146100             SET RC098-DB-ERROR                                   14610001
146200                 PS-ERROR-YES    TO TRUE                          14620000
146300             DISPLAY '******************************************' 14630000
146400             DISPLAY '*ABEND                                   *' 14640000
146500             DISPLAY '*PROGRAM   = RCKUP066                    *' 14650000
146600             DISPLAY '*DB2 OPER  = INSERT ON TRECEIV           *' 14660000
146700             DISPLAY '*PARAGRAPH = 2340-INSERT-TRECEIV         *' 14670000
146800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                14680000
146900             DISPLAY '*PO = ' PV-DISP-PO                          14690000
147000             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               14700000
147100             DISPLAY '******************************************' 14710000
147200                                                                  14720000
147300     END-EVALUATE.                                                14730000
147400                                                                  14740000
147500 2350-UPDATE-RECEIVER-INFO.                                       14750000
147600     PERFORM 2360-SELECT-TRECEIV.                                 14760000
147700     COMPUTE RECEIV-EXPTED-ITM-QTY = RECEIV-EXPTED-ITM-QTY +      14770000
147800                RC098-TO-VERIFY-QTY.                              14780001
147900     COMPUTE RECEIV-ACTL-ITM-QTY = RECEIV-ACTL-ITM-QTY +          14790000
148000                RC098-TO-VERIFY-QTY.                              14800001
148100     PERFORM 2370-UPDATE-TRECEIV.                                 14810000
148200                                                                  14820000
148300 2360-SELECT-TRECEIV.                                             14830000
148400     EXEC SQL                                                     14840000
148500          SELECT EXPTED_ITM_QTY                                   14850000
148600                ,ACTL_ITM_QTY                                     14860000
148700            INTO :RECEIV-EXPTED-ITM-QTY                           14870000
148800                ,:RECEIV-ACTL-ITM-QTY                             14880000
148900            FROM TRECEIV                                          14890000
149000           WHERE ORD_NBR     = :DK-PO-NBR                         14900000
149100             AND REC_SEQ_NBR = :PV-REC-SEQ-NBR                    14910000
149200             AND VER_STATUS_CDE = 'A'                             14920000
149300     END-EXEC.                                                    14930000
149400                                                                  14940000
149500     EVALUATE TRUE                                                14950000
149600         WHEN SQLCODE = ZERO                                      14960000
149700              CONTINUE                                            14970000
149800                                                                  14980000
149900         WHEN SQLWARN0 NOT = SPACES                               14990000
150000         WHEN SQLCODE  NOT = ZERO                                 15000000
150100             MOVE DK-PO-NBR         TO PV-DISP-PO                 15010000
150200             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           15020000
150300             MOVE SQLCODE TO PV-DISP-SQLCODE                      15030000
150400             MOVE '2360-SELECT-TRECEIV'                           15040000
150500                              TO RC098-ERROR-PARA-NAME            15050001
150600             SET RC098-DB-ERROR                                   15060001
150700                 PS-ERROR-YES    TO TRUE                          15070000
150800             DISPLAY '******************************************' 15080000
150900             DISPLAY '*ABEND                                   *' 15090000
151000             DISPLAY '*PROGRAM   = RCKUP066                    *' 15100000
151100             DISPLAY '*DB2 OPER  = SELECT TRECEIV              *' 15110000
151200             DISPLAY '*PARAGRAPH = 2360-SELECT-TRECEIV         *' 15120000
151300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15130000
151400             DISPLAY '*PO = ' PV-DISP-PO                          15140000
151500             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               15150000
151600             DISPLAY '******************************************' 15160000
151700     END-EVALUATE.                                                15170000
151800                                                                  15180000
151900 2370-UPDATE-TRECEIV.                                             15190000
152000     EXEC SQL                                                     15200000
152100       UPDATE TRECEIV                                             15210000
152200          SET   EXPTED_ITM_QTY     = :RECEIV-EXPTED-ITM-QTY       15220000
152300              , ACTL_ITM_QTY       = :RECEIV-ACTL-ITM-QTY         15230000
152400           WHERE ORD_NBR        = :DK-PO-NBR                      15240000
152500             AND REC_SEQ_NBR    = :PV-REC-SEQ-NBR                 15250000
152600             AND VER_STATUS_CDE = 'A'                             15260000
152700     END-EXEC.                                                    15270000
152800                                                                  15280000
152900     EVALUATE TRUE                                                15290000
153000         WHEN SQLCODE = ZERO                                      15300000
153100              MOVE +1       TO PT-TOTAL-TRECEIV-UPDATES           15310000
153200                                                                  15320000
153300         WHEN SQLWARN0 NOT = SPACES                               15330000
153400         WHEN SQLCODE  NOT = ZERO                                 15340000
153500             MOVE DK-PO-NBR         TO PV-DISP-PO                 15350000
153600             MOVE PV-REC-SEQ-NBR     TO PV-DISP-REC-SEQ           15360000
153700             MOVE SQLCODE TO PV-DISP-SQLCODE                      15370000
153800             MOVE '2370-UPDATE-TRECEIV'                           15380000
153900                              TO RC098-ERROR-PARA-NAME            15390001
154000             SET RC098-DB-ERROR                                   15400001
154100                 PS-ERROR-YES    TO TRUE                          15410000
154200             DISPLAY '******************************************' 15420000
154300             DISPLAY '*ABEND                                   *' 15430000
154400             DISPLAY '*PROGRAM   = RCKUP066                    *' 15440000
154500             DISPLAY '*DB2 OPER  = UPDATE TRECEIV              *' 15450000
154600             DISPLAY '*PARAGRAPH = 2370-UPDATE-TRECEIV         *' 15460000
154700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                15470000
154800             DISPLAY '*PO = ' PV-DISP-PO                          15480000
154900             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               15490000
155000             DISPLAY '******************************************' 15500000
155100     END-EVALUATE.                                                15510000
155200                                                                  15520000
155300 2400-ADD-RECITM.                                                 15530000
155400     PERFORM 2410-SETUP-RECITM-FIELDS.                            15540000
155500     PERFORM 2420-INSERT-RECITM.                                  15550000
155600                                                                  15560000
155700 2410-SETUP-RECITM-FIELDS.                                        15570000
155800                                                                  15580000
155900     INITIALIZE DCLTRECITM.                                       15590000
156000                                                                  15600000
156100     MOVE PV-HOLD-PO-NBR         TO RECITM-ORD-NBR.               15610000
156200     MOVE PURITM-APP-PO-LNE-NBR  TO RECITM-ORD-LNE-NBR.           15620000
156300                                                                  15630000
156400     MOVE PV-HOLD-REC-SEQ-NBR    TO RECITM-REC-SEQ-NBR.           15640000
156500     MOVE PV-HOLD-OPER-UNT-ID    TO RECITM-OPER-UNT-ID.           15650037
156600     MOVE 1                      TO RECITM-FCLTY-ID.              15660000
156700                                                                  15670000
156800     MOVE PURITM-VER-NBR         TO RECITM-PO-VER-NBR.            15680000
156900     MOVE PURITM-ITM-NBR         TO RECITM-ITM-NBR.               15690000
157000     MOVE PURITM-UNT-RTL-PR-AMT  TO RECITM-UNT-RTL-AMT            15700000
157100     MOVE PURITM-UNT-COST-AMT    TO RECITM-UNT-COST-AMT           15710000
157200     MOVE PURITM-GP-RTL-AMT      TO RECITM-GP-RTL-AMT             15720000
157300     MOVE PURITM-GP-QTY          TO RECITM-GP-QTY                 15730000
157400     MOVE RECEIV-PRE-TKT-IND     TO RECITM-PRE-TKT-IND.           15740000
157500     MOVE SPACES                 TO RECITM-TKT-FMT-ID.            15750000
157600     MOVE 'VE'                   TO RECITM-STATUS-CDE.            15760000
157700     MOVE 1                      TO RECITM-EXPTED-CART-CNT.       15770000
157800     MOVE PA-TO-VERIFY-QTY       TO RECITM-PKSL-ITM-QTY           15780000
157900                                    RECITM-DTL-CK-ITM-QTY.        15790000
158000     MOVE ZERO                   TO RECITM-ACTL-CART-CNT.         15800000
158100     MOVE '9999-09-09-09.09.09.999999'                            15810000
158200                                 TO RECITM-MKING-APRON-TMST       15820000
158300                                    RECITM-UPD-TMST.              15830000
158400     MOVE PC-PTL-FSA             TO RECITM-VRFD-USR-ID.           15840034
158500     MOVE PC-PTL-FSA             TO RECITM-CRE-UID.               15850034
158600                                                                  15860000
158700     INITIALIZE                     RECITM-PREPK-ID               15870000
158800                                    RECITM-PREPK-DRV-LNE-CDE      15880000
158900                                    RECITM-PREPK-RATO-QTY         15890000
159000                                    RECITM-PREPK-ODD-UNT-QTY.     15900000
159100                                                                  15910000
159200 2420-INSERT-RECITM.                                              15920000
159300                                                                  15930000
159400     EXEC SQL                                                     15940000
159500         INSERT INTO TRECITM                                      15950000
159600               (ORD_NBR                                           15960000
159700             ,  ORD_LNE_NBR                                       15970000
159800             ,  REC_SEQ_NBR                                       15980000
159900             ,  OPER_UNT_ID                                       15990000
160000             ,  FCLTY_ID                                          16000000
160100             ,  CRE_TMST                                          16010000
160200             ,  CRE_UID                                           16020000
160300             ,  PO_VER_NBR                                        16030000
160400             ,  ITM_NBR                                           16040000
160500             ,  PRE_TKT_IND                                       16050000
160600             ,  TKT_FMT_ID                                        16060000
160700             ,  RTV_IND                                           16070000
160800             ,  STATUS_CDE                                        16080000
160900             ,  VER_STATUS_CDE                                    16090000
161000             ,  PKSL_ITM_QTY                                      16100000
161100             ,  DTL_CK_ITM_QTY                                    16110000
161200             ,  INNR_PACK_QTY                                     16120000
161300             ,  CASE_PACK_QTY                                     16130000
161400             ,  RTV_QTY                                           16140000
161500             ,  EXPTED_CART_CNT                                   16150000
161600             ,  ACTL_CART_CNT                                     16160000
161700             ,  MKING_APRON_TMST                                  16170000
161800             ,  UNT_COST_AMT                                      16180000
161900             ,  COLOR_DESC                                        16190000
162000             ,  SIZE_DESC                                         16200000
162100             ,  VEND_STYL_NAME                                    16210000
162200             ,  VEND_DESC                                         16220000
162300             ,  VERFYD_TMST                                       16230000
162400             ,  PKSL_NBR                                          16240000
162500             ,  REC_INV_LNE_NBR                                   16250000
162600             ,  DMG_ITM_QTY                                       16260000
162700             ,  UPD_TMST                                          16270000
162800             ,  UPD_UID                                           16280000
162900             ,  UPD_PGM_ID                                        16290000
163000             ,  RCPT_DISTR_UPD_CDE                                16300000
163010             ,  VRFD_USR_ID                                       16301000
163020             ,  LAST_TRSCP_TMST                                   16302000
163030             ,  LAST_TRSCP_USR_ID                                 16303000
163040             ,  PREPK_ID                                          16304000
163050             ,  PREPK_RATO_QTY                                    16305000
163060             ,  PREPK_ODD_UNT_QTY                                 16306000
163070             ,  PREPK_DRV_LNE_CDE                                 16307000
163080             ,  UNT_RTL_AMT                                       16308000
163090             ,  GP_RTL_AMT                                        16309000
163100             ,  GP_QTY                                            16310000
163200             ,  ORIG_PKSL_ITM_QTY)                                16320000
163300        VALUES (:RECITM-ORD-NBR                                   16330000
163400             ,  :RECITM-ORD-LNE-NBR                               16340000
163500             ,  :RECITM-REC-SEQ-NBR                               16350000
163600             ,  :RECITM-OPER-UNT-ID                               16360000
163700             ,  :RECITM-FCLTY-ID                                  16370000
163800             ,   CURRENT_TIMESTAMP                                16380000
163900             ,  :PC-PTL-FSA                                       16390038
164000             ,  :RECITM-PO-VER-NBR                                16400000
164100             ,  :RECITM-ITM-NBR                                   16410000
164200             ,  :RECITM-PRE-TKT-IND                               16420000
164300             ,  :RECITM-TKT-FMT-ID                                16430000
164400             ,  :RECITM-RTV-IND                                   16440000
164500             ,  :RECITM-STATUS-CDE                                16450000
164600             ,  'A'                                               16460000
164700             ,  :RECITM-PKSL-ITM-QTY                              16470000
164800             ,  :RECITM-DTL-CK-ITM-QTY                            16480000
164900             ,  :RECITM-INNR-PACK-QTY                             16490000
165000             ,  :RECITM-CASE-PACK-QTY                             16500000
165100             ,  :RECITM-RTV-QTY                                   16510000
165200             ,  :RECITM-EXPTED-CART-CNT                           16520000
165300             ,  :RECITM-ACTL-CART-CNT                             16530000
165400             ,  :RECITM-MKING-APRON-TMST                          16540000
165500             ,  :RECITM-UNT-COST-AMT                              16550000
165600             ,  :RECITM-COLOR-DESC                                16560000
165700             ,  :RECITM-SIZE-DESC                                 16570000
165800             ,  :RECITM-VEND-STYL-NAME                            16580000
165900             ,  :RECITM-VEND-DESC                                 16590000
166000             ,  CURRENT_TIMESTAMP                                 16600000
166100             ,  :RECITM-PKSL-NBR                                  16610000
166200             ,  :RECITM-REC-INV-LNE-NBR                           16620000
166300             ,  :RECITM-DMG-ITM-QTY                               16630000
166400             ,  :RECITM-UPD-TMST                                  16640000
166500             ,  :PC-PTL-FSA                                       16650038
166600             ,  :RECITM-UPD-PGM-ID                                16660000
166700             ,  :RECITM-RCPT-DISTR-UPD-CDE                        16670000
166800             ,  :PC-PTL-FSA                                       16680038
166900             ,   CURRENT_TIMESTAMP                                16690000
167000             ,  :PC-CURRENT-PROGRAM-NAME                          16700000
167100             ,  :RECITM-PREPK-ID                                  16710000
167200             ,  :RECITM-PREPK-RATO-QTY                            16720000
167300             ,  :RECITM-PREPK-ODD-UNT-QTY                         16730000
167400             ,  :RECITM-PREPK-DRV-LNE-CDE                         16740000
167500             ,  :RECITM-UNT-RTL-AMT                               16750000
167600             ,  :RECITM-GP-RTL-AMT                                16760000
167700             ,  :RECITM-GP-QTY                                    16770000
167800             ,  0)                                                16780000
167900     END-EXEC.                                                    16790000
168000                                                                  16800000
168100     EVALUATE TRUE                                                16810000
168200         WHEN SQLCODE = ZERO                                      16820000
168300*             MOVE +1       TO PT-TOTAL-TRECITM-INSERTS           16830000
168400              ADD  +1       TO PA-TOTAL-TRECITM-INSERTS           16840000
168500                                                                  16850000
168600         WHEN SQLWARN0 NOT = SPACES                               16860000
168700         WHEN SQLCODE  NOT = ZERO                                 16870000
168800             MOVE DK-PO-NBR         TO PV-DISP-PO                 16880000
168900             MOVE RECITM-REC-SEQ-NBR TO PV-DISP-REC-SEQ           16890000
169000             MOVE RECITM-ORD-LNE-NBR TO PV-DISP-LINE-NBR          16900000
169100             MOVE SQLCODE TO PV-DISP-SQLCODE                      16910000
169200             MOVE '2420-INSERT-RECITM'                            16920000
169300                              TO RC098-ERROR-PARA-NAME            16930001
169400             SET RC098-DB-ERROR                                   16940001
169500                 PS-ERROR-YES    TO TRUE                          16950000
169600             DISPLAY '******************************************' 16960000
169700             DISPLAY '*ABEND                                   *' 16970000
169800             DISPLAY '*PROGRAM   = RCKUP066                    *' 16980000
169900             DISPLAY '*DB2 OPER  = INSERT ON TRECITM           *' 16990000
170000             DISPLAY '*PARAGRAPH = 2420-INSERT-RECITM          *' 17000000
170100             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                17010000
170200             DISPLAY '*PO = ' PV-DISP-PO                          17020000
170300             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               17030000
170400             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  17040000
170500             DISPLAY '******************************************' 17050000
170600     END-EVALUATE.                                                17060000
170700                                                                  17070000
170800 2500-PREPARE-TRECDIS.                                            17080000
170900     PERFORM 2530-SELECT-APP-PO-LINE.                             17090000
171000     IF PS-ERROR-NO                                               17100000
171100         PERFORM 2510-SETUP-TRECDIS-FIELDS                        17110000
171200         PERFORM 2520-INSERT-TRECDIS                              17120000
171300     END-IF.                                                      17130000
171400                                                                  17140000
171500 2510-SETUP-TRECDIS-FIELDS.                                       17150000
171600                                                                  17160000
171700     INITIALIZE DCLTRECDIS.                                       17170000
171800                                                                  17180000
171900     MOVE RC098-PO-NBR       TO RECDIS-ORD-NBR.                   17190001
172000     MOVE PURITM-APP-PO-LNE-NBR                                   17200000
172100                             TO RECDIS-ORD-LNE-NBR.               17210000
172200     MOVE PV-REC-SEQ-NBR     TO RECDIS-REC-SEQ-NBR.               17220000
172300     MOVE RC098-OPER-UNIT    TO RECDIS-OPER-UNT-ID.               17230001
172400     MOVE PC-PTL-FSA         TO RECDIS-CRE-UID.                   17240033
172500     MOVE 'A'                TO RECDIS-VER-STATUS-CDE.            17250000
172600     MOVE RC098-TO-VERIFY-QTY TO RECDIS-EXPTED-ITM-QTY            17260001
172700                                RECDIS-VERIFY-ITM-QTY             17270000
172800                                RECDIS-AP-VERIFY-ITM-QTY.         17280000
172900     MOVE RC098-STR-NBR      TO RECDIS-STR-NBR.                   17290001
173000     MOVE 1                  TO RECDIS-FCLTY-ID.                  17300000
173100     MOVE 1                  TO RECDIS-STR-FCLTY-ID.              17310000
173200                                                                  17320000
173300     MOVE '9999-09-09'       TO RECDIS-AP-PRC-DTE.                17330000
173400                                                                  17340000
173500                                                                  17350000
173600 2520-INSERT-TRECDIS.                                             17360000
173700                                                                  17370000
173800     EXEC SQL                                                     17380000
173900          INSERT INTO TRECDIS                                     17390000
174000                 (ORD_NBR                                         17400000
174100               ,  ORD_LNE_NBR                                     17410000
174200               ,  REC_SEQ_NBR                                     17420000
174300               ,  OPER_UNT_ID                                     17430000
174400               ,  FCLTY_ID                                        17440000
174500               ,  CRE_TMST                                        17450000
174600               ,  CRE_UID                                         17460000
174700               ,  VER_STATUS_CDE                                  17470000
174800               ,  EXPTED_ITM_QTY                                  17480000
174900               ,  VERIFY_ITM_QTY                                  17490000
175000               ,  AP_VERIFY_ITM_QTY                               17500000
175100               ,  STR_NBR                                         17510000
175200               ,  STR_FCLTY_ID                                    17520000
175300               ,  PLAN_ITM_QTY                                    17530000
175400               ,  AP_PRC_CDE                                      17540000
175500               ,  AP_PRC_DTE)                                     17550000
175600          VALUES (:RECDIS-ORD-NBR                                 17560000
175700               ,  :RECDIS-ORD-LNE-NBR                             17570000
175800               ,  :RECDIS-REC-SEQ-NBR                             17580000
175900               ,  :RECDIS-OPER-UNT-ID                             17590000
176000               ,  :RECDIS-FCLTY-ID                                17600000
176100               ,  CURRENT_TIMESTAMP                               17610000
176200               ,  :PC-PTL-FSA                                     17620038
176300               ,  :RECDIS-VER-STATUS-CDE                          17630000
176400               ,  :RECDIS-EXPTED-ITM-QTY                          17640000
176500               ,  :RECDIS-VERIFY-ITM-QTY                          17650000
176600               ,  :RECDIS-AP-VERIFY-ITM-QTY                       17660000
176700               ,  :RECDIS-STR-NBR                                 17670000
176800               ,  :RECDIS-STR-FCLTY-ID                            17680000
176900               ,  :RECDIS-PLAN-ITM-QTY                            17690000
177000               ,  :RECDIS-AP-PRC-CDE                              17700000
177100               ,  :RECDIS-AP-PRC-DTE)                             17710000
177200     END-EXEC.                                                    17720000
177300                                                                  17730000
177400     EVALUATE TRUE                                                17740000
177500         WHEN SQLCODE = +0                                        17750000
177600              MOVE +1       TO PT-TOTAL-TRECDIS-INSERTS           17760000
177700                                                                  17770000
177710         WHEN SQLCODE = -803                                      17771039
177720              PERFORM 2523-GET-TRECDIS-UNITS                      17772041
177721              PERFORM 2525-ADD-TRECDIS-UNITS                      17772141
177730                                                                  17773039
177800         WHEN OTHER                                               17780000
177900             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 17790000
178000             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           17800000
178100             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          17810000
178200             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           17820000
178300             MOVE SQLCODE TO PV-DISP-SQLCODE                      17830000
178400             MOVE '2510-INSERT-TRECDIS'                           17840000
178500                              TO RC098-ERROR-PARA-NAME            17850001
178600             SET RC098-DB-ERROR                                   17860001
178700                 PS-ERROR-YES    TO TRUE                          17870000
178800             DISPLAY '******************************************' 17880000
178900             DISPLAY '*ABEND                                   *' 17890000
179000             DISPLAY '*PROGRAM   = RCKUP066                    *' 17900000
179100             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 17910000
179200             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 17920000
179300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                17930000
179400             DISPLAY '*PO = ' PV-DISP-PO                          17940000
179500             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               17950000
179600             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  17960000
179700             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  17970000
179800             DISPLAY '******************************************' 17980000
179900     END-EVALUATE.                                                17990000
180000                                                                  18000000
180001 2523-GET-TRECDIS-UNITS.                                          18000141
180002                                                                  18000241
180003     EXEC SQL                                                     18000341
180004          SELECT                                                  18000441
180005                  EXPTED_ITM_QTY                                  18000542
180006               ,  VERIFY_ITM_QTY                                  18000641
180007               ,  AP_VERIFY_ITM_QTY                               18000741
180008            INTO                                                  18000841
180009                 :PV-EXPTED-ITM-QTY                               18000941
180010               , :PV-VERIFY-ITM-QTY                               18001041
180012               , :PV-AP-VERIFY-ITM-QTY                            18001241
180013            FROM TRECDIS                                          18001344
180014           WHERE                                                  18001444
180015                  ORD_NBR       =   :RECDIS-ORD-NBR               18001544
180016             AND  ORD_LNE_NBR   =   :RECDIS-ORD-LNE-NBR           18001644
180017             AND  REC_SEQ_NBR   =   :RECDIS-REC-SEQ-NBR           18001744
180018             AND  OPER_UNT_ID   =   :RECDIS-OPER-UNT-ID           18001844
180019             AND  FCLTY_ID      =   :RECDIS-FCLTY-ID              18001944
180020             AND  STR_NBR       =   :RECDIS-STR-NBR               18002044
180021             AND  STR_FCLTY_ID  =   :RECDIS-STR-FCLTY-ID          18002144
180022     END-EXEC.                                                    18002244
180023                                                                  18002344
180024     EVALUATE TRUE                                                18002444
180025         WHEN SQLCODE = +0                                        18002544
180026              CONTINUE                                            18002644
180036                                                                  18003641
180037         WHEN OTHER                                               18003741
180038             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 18003841
180039             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           18003941
180040             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          18004041
180041             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           18004141
180042             MOVE SQLCODE TO PV-DISP-SQLCODE                      18004241
180043             MOVE '2523-GET-RECDIS-UNITS'                         18004341
180044                              TO RC098-ERROR-PARA-NAME            18004441
180045             SET RC098-DB-ERROR                                   18004541
180046                 PS-ERROR-YES    TO TRUE                          18004641
180047             DISPLAY '******************************************' 18004741
180048             DISPLAY '*ABEND                                   *' 18004841
180049             DISPLAY '*PROGRAM   = RCKUP066                    *' 18004941
180050             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 18005041
180051             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 18005141
180052             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18005241
180053             DISPLAY '*PO = ' PV-DISP-PO                          18005341
180054             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               18005441
180055             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18005541
180056             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  18005641
180057             DISPLAY '******************************************' 18005741
180058     END-EVALUATE.                                                18005841
180059                                                                  18005941
180060                                                                  18006041
180061 2525-ADD-TRECDIS-UNITS.                                          18006141
180062                                                                  18006241
180063     ADD  RC098-TO-VERIFY-QTY  TO  PV-EXPTED-ITM-QTY              18006341
180064                                   PV-VERIFY-ITM-QTY              18006441
180065                                   PV-AP-VERIFY-ITM-QTY.          18006541
180066                                                                  18006641
180067     EXEC SQL                                                     18006741
180068          UPDATE TRECDIS                                          18006845
180070             SET  EXPTED_ITM_QTY    = :PV-EXPTED-ITM-QTY          18007041
180111               ,  VERIFY_ITM_QTY    = :PV-VERIFY-ITM-QTY          18011141
180113               ,  AP_VERIFY_ITM_QTY = :PV-AP-VERIFY-ITM-QTY       18011341
180120           WHERE                                                  18012039
180121                  ORD_NBR       =   :RECDIS-ORD-NBR               18012139
180122             AND  ORD_LNE_NBR   =   :RECDIS-ORD-LNE-NBR           18012246
180123             AND  REC_SEQ_NBR   =   :RECDIS-REC-SEQ-NBR           18012346
180124             AND  OPER_UNT_ID   =   :RECDIS-OPER-UNT-ID           18012446
180125             AND  FCLTY_ID      =   :RECDIS-FCLTY-ID              18012546
180126             AND  STR_NBR       =   :RECDIS-STR-NBR               18012646
180127             AND  STR_FCLTY_ID  =   :RECDIS-STR-FCLTY-ID          18012746
180128     END-EXEC.                                                    18012839
180129                                                                  18012939
180130     EVALUATE TRUE                                                18013039
180131         WHEN SQLCODE = +0                                        18013139
180132              MOVE +1       TO PT-TOTAL-TRECDIS-INSERTS           18013239
180133              MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                18013339
180134              MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ          18013439
180135              MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR         18013539
180136              MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR          18013639
180137              DISPLAY ' RCKUP066 - '                              18013739
180138                      '*RCVR:' PV-DISP-PO                         18013839
180139                      '-'      PV-DISP-REC-SEQ                    18013939
180140                      '-'      PV-DISP-LINE-NBR                   18014039
180141                      '-'      PV-DISP-STR-NBR                    18014139
180142                      '  -  UNITS ADDED TO EXISTING LINE'         18014239
180143                                                                  18014339
180144         WHEN OTHER                                               18014439
180145             MOVE RECDIS-ORD-NBR    TO PV-DISP-PO                 18014539
180146             MOVE RECDIS-REC-SEQ-NBR TO PV-DISP-REC-SEQ           18014639
180147             MOVE RECDIS-ORD-LNE-NBR TO PV-DISP-LINE-NBR          18014739
180148             MOVE RECDIS-STR-NBR     TO PV-DISP-STR-NBR           18014839
180149             MOVE SQLCODE TO PV-DISP-SQLCODE                      18014939
180150             MOVE '2510-INSERT-TRECDIS'                           18015039
180151                              TO RC098-ERROR-PARA-NAME            18015139
180152             SET RC098-DB-ERROR                                   18015239
180153                 PS-ERROR-YES    TO TRUE                          18015339
180154             DISPLAY '******************************************' 18015439
180155             DISPLAY '*ABEND                                   *' 18015539
180156             DISPLAY '*PROGRAM   = RCKUP066                    *' 18015639
180157             DISPLAY '*DB2 OPER  = INSERT TRECDIS              *' 18015739
180158             DISPLAY '*PARAGRAPH = 2520-INSERT-TRECDIS         *' 18015839
180159             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18015939
180160             DISPLAY '*PO = ' PV-DISP-PO                          18016039
180161             DISPLAY '*RECEIVER = ' PV-DISP-REC-SEQ               18016139
180162             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18016239
180163             DISPLAY '*STORE = ' PV-DISP-STR-NBR                  18016339
180164             DISPLAY '******************************************' 18016439
180165     END-EVALUATE.                                                18016539
180166                                                                  18016639
180170 2530-SELECT-APP-PO-LINE.                                         18017000
180200     EXEC SQL                                                     18020000
180300        SELECT  A.APP_PO_LNE_NBR                                  18030000
180400          INTO :PURITM-APP-PO-LNE-NBR                             18040000
180500          FROM TPURITM A                                          18050000
180600          WHERE A.PO_NBR          = :DK-PO-NBR                    18060000
180700            AND A.VER_STATUS_CDE  = 'A'                           18070000
180800            AND A.PO_LNE_NBR      = :DK-LNE-NBR                   18080000
180900     END-EXEC.                                                    18090000
181000                                                                  18100000
181100     EVALUATE TRUE                                                18110000
181200         WHEN SQLCODE = +0                                        18120000
181300         WHEN SQLCODE = -811                                      18130000
181400              CONTINUE                                            18140000
181500         WHEN SQLCODE = +100                                      18150000
181600             MOVE DK-PO-NBR   TO PV-DISP-PO                       18160000
181700             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 18170000
181800             MOVE SQLCODE     TO PV-DISP-SQLCODE                  18180000
181900             MOVE '2530-SELECT-APP-PO-LINE'                       18190000
182000                              TO RC098-ERROR-PARA-NAME            18200001
182100             SET RC098-ITEM-NOT-ON-PO                             18210001
182200                 PS-ERROR-YES    TO TRUE                          18220000
182300             DISPLAY '******************************************' 18230000
182400             DISPLAY '*ABEND                                   *' 18240000
182500             DISPLAY '*PROGRAM   = RCKUP066                    *' 18250000
182600             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 18260000
182700             DISPLAY '*PARAGRAPH = 2530-SELECT-APP-PO-LINE     *' 18270000
182800             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18280000
182900             DISPLAY '*PO = ' PV-DISP-PO                          18290000
183000             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18300000
183100             DISPLAY '******************************************' 18310000
183200         WHEN SQLWARN0 NOT = SPACES                               18320000
183300         WHEN SQLCODE < +0                                        18330000
183400         WHEN SQLCODE > +0                                        18340000
183500             MOVE DK-PO-NBR   TO PV-DISP-PO                       18350000
183600             MOVE DK-LNE-NBR  TO PV-DISP-LINE-NBR                 18360000
183700             MOVE SQLCODE     TO PV-DISP-SQLCODE                  18370000
183800             MOVE '2530-SELECT-APP-PO-LINE'                       18380000
183900                              TO RC098-ERROR-PARA-NAME            18390001
184000             SET RC098-DB-ERROR                                   18400001
184100                 PS-ERROR-YES    TO TRUE                          18410000
184200             DISPLAY '******************************************' 18420000
184300             DISPLAY '*ABEND                                   *' 18430000
184400             DISPLAY '*PROGRAM   = RCKUP066                    *' 18440000
184500             DISPLAY '*DB2 OPER  = SELECT ON TPURITM           *' 18450000
184600             DISPLAY '*PARAGRAPH = 2530-SELECT-APP-PO-LINE     *' 18460000
184700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18470000
184800             DISPLAY '*PO = ' PV-DISP-PO                          18480000
184900             DISPLAY '*LINE = ' PV-DISP-LINE-NBR                  18490000
185000             DISPLAY '******************************************' 18500000
185100     END-EVALUATE.                                                18510000
185200                                                                  18520000
185300 2600-INSERT-WFT-LOD-CNTL.                                        18530021
185400                                                                  18540021
185500     INITIALIZE DCLWFT00001.                                      18550021
185600     INITIALIZE DCLWFT00002.                                      18560021
185700                                                                  18570021
185800     EXEC SQL                                                     18580021
185810         SET :WFT00002-PRC-CNTL-TMST = CURRENT TIMESTAMP          18581021
185820     END-EXEC.                                                    18582021
185830                                                                  18583021
185840                                                                  18584021
185850     EXEC SQL                                                     18585021
185860         INSERT INTO WFT_LOD_CNTL                                 18586021
185870             ( PRC_CNTL_TMST                                      18587021
185880             , TRN_TYP_CDE                                        18588021
185890             , STAT_CDE                                           18589021
185891             , INIT_PRCG_BEG_TMST                                 18589121
185892             , END_TMST                                           18589221
185893             , ARCH_DAT_IND                                       18589321
185894             , DAT_LOD_VER_NBR                                    18589421
185895             , STR_NBR)                                           18589521
185896         VALUES                                                   18589621
185897             ( :WFT00002-PRC-CNTL-TMST                            18589721
185898             , 'SKUVER'                                           18589821
185899             , 'READY'                                            18589921
185900             , '0001-01-01-00.00.00.000000'                       18590021
185901             , '0001-01-01-00.00.00.000000'                       18590121
185902             , ' '                                                18590221
185903             , 0                                                  18590321
185904             , 0999                                               18590421
185905             )                                                    18590521
185906     END-EXEC.                                                    18590621
185907                                                                  18590721
185908     EVALUATE TRUE                                                18590821
185909        WHEN SQLCODE = +0                                         18590921
185910              MOVE +1       TO PT-TOTAL-WFT-CNTL-INSERTS          18591021
185911        WHEN SQLWARN0 NOT = SPACES                                18591121
185912        WHEN SQLCODE < +0                                         18591221
185913        WHEN SQLCODE > +0                                         18591321
185914             MOVE SQLCODE TO PV-DISP-SQLCODE                      18591421
185915             MOVE '2600-INSERT-WFT-LOD-CNTL'                      18591521
185916                              TO RC098-ERROR-PARA-NAME            18591621
185917             SET RC098-DB-ERROR                                   18591721
185918                 PS-ERROR-YES    TO TRUE                          18591821
185919             DISPLAY '******************************************' 18591921
185920             DISPLAY '*ABEND                                   *' 18592021
185921             DISPLAY '*PROGRAM   = RCKUP009                    *' 18592121
185922             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_CNTL      *' 18592221
185923             DISPLAY '*PARAGRAPH = 2600-INSERT-WFT-LOD-CNTL    *' 18592321
185924             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18592421
185925             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       18592521
185926             DISPLAY '******************************************' 18592621
185927     END-EVALUATE.                                                18592721
185928                                                                  18592821
185929 2700-INSERT-WFT-LOD-XFER.                                        18592921
185930                                                                  18593021
185931     INITIALIZE WFT00002-LOD-DAT-TXT.                             18593121
185932                                                                  18593221
185933     MOVE RC098-PO-NBR      TO PV-ORDER-NUMBER.                   18593321
185934     MOVE RC098-SKU-NBR     TO PV-SKU.                            18593421
185935     MOVE PV-REC-SEQ-NBR    TO PV-RCVR-ID.                        18593521
185936     MOVE RC098-OPER-UNIT   TO PV-DC.                             18593621
185937                                                                  18593721
185938     EXEC SQL                                                     18593821
185939          SET :PV-DB2-TMST         =  CURRENT_TIMESTAMP           18593921
185940     END-EXEC.                                                    18594021
185941                                                                  18594121
185942     MOVE PV-DB2-TMST-CCYY  TO PV-VRFY-DATE (1:4).                18594221
185943     MOVE PV-DB2-TMST-MO    TO PV-VRFY-DATE (5:2).                18594321
185944     MOVE PV-DB2-TMST-DA    TO PV-VRFY-DATE (7:2).                18594421
185945     MOVE PV-DB2-TMST-HH    TO PV-VRFY-DATE (9:2).                18594521
185946     MOVE PV-DB2-TMST-MM    TO PV-VRFY-DATE (11:2).               18594621
185947     MOVE PV-DB2-TMST-SS    TO PV-VRFY-DATE (13:2).               18594721
185948     MOVE 1                 TO PV-STORE-COUNT.                    18594821
185949     MOVE RC098-STR-NBR     TO PV-STORE (1).                      18594921
185950     MOVE RC098-TO-VERIFY-QTY TO PV-STORE-QTY (1).                18595021
185951     MOVE 'P'               TO PV-STORE-QTY-SIGN (1).             18595121
185952     MOVE LENGTH OF PV-RECEIPT-ADJUSTMENT-REC TO                  18595221
185953        WFT00002-LOD-DAT-TXT-LEN.                                 18595321
185954                                                                  18595421
185955     MOVE PV-RECEIPT-ADJUSTMENT-REC TO                            18595521
185956        WFT00002-LOD-DAT-TXT-TEXT.                                18595621
185957                                                                  18595721
185958                                                                  18595821
185959     EXEC SQL                                                     18595921
185960         INSERT INTO WFT_LOD_XFER                                 18596021
185961             ( PRC_CNTL_TMST                                      18596121
185962             , TRN_TYP_CDE                                        18596221
185963             , BTCH_LOD_SEQ_ID                                    18596321
185964             , LOD_DAT_TXT                                        18596421
185965             )                                                    18596521
185966         VALUES                                                   18596621
185967             (:WFT00002-PRC-CNTL-TMST                             18596721
185968             , 'SKUVER'                                           18596821
185969             , 1                                                  18596921
185970             , :WFT00002-LOD-DAT-TXT                              18597021
185971             )                                                    18597121
185972     END-EXEC.                                                    18597221
185973                                                                  18597321
185974     EVALUATE TRUE                                                18597421
185975        WHEN SQLCODE = +0                                         18597521
185976              MOVE +1       TO PT-TOTAL-WFT-XFER-INSERTS          18597621
185977        WHEN SQLWARN0 NOT = SPACES                                18597721
185978        WHEN SQLCODE < +0                                         18597821
185979        WHEN SQLCODE > +0                                         18597921
185980             MOVE SQLCODE TO PV-DISP-SQLCODE                      18598021
185981             MOVE '2700-INSERT-WFT-LOD-XFER'                      18598121
185982                              TO RC098-ERROR-PARA-NAME            18598221
185983             SET RC098-DB-ERROR                                   18598321
185984                 PS-ERROR-YES    TO TRUE                          18598421
185985             DISPLAY '******************************************' 18598521
185986             DISPLAY '*ABEND                                   *' 18598621
185987             DISPLAY '*PROGRAM   = RCKUP009                    *' 18598721
185988             DISPLAY '*DB2 OPER  = INSERT ON WFT_LOD_XFER      *' 18598821
185989             DISPLAY '*PARAGRAPH = 2700-INSERT-WFT-LOD-XFER    *' 18598921
185990             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18599021
185991             DISPLAY '*TIMESTAMP = ' WFT00002-PRC-CNTL-TMST       18599121
185992             DISPLAY '******************************************' 18599221
185993     END-EVALUATE.                                                18599321
185994                                                                  18599413
185995                                                                  18599513
185996*----------------------------------------------------------------*18599600
185997* OPEN THE TRECVER CURSOR                                        *18599700
185998*----------------------------------------------------------------*18599800
185999                                                                  18599900
186000 3000-OPEN-TRECVER-CSR.                                           18600000
186100                                                                  18610000
186800     EXEC SQL                                                     18680000
186900          OPEN TRECVER-CSR                                        18690000
187000     END-EXEC.                                                    18700000
187100                                                                  18710000
187200     EVALUATE TRUE                                                18720000
187300         WHEN SQLCODE = +0                                        18730000
187400              CONTINUE                                            18740000
187500         WHEN SQLWARN0 NOT = SPACE                                18750000
187600         WHEN SQLCODE  NOT = +0                                   18760000
187700             MOVE SQLCODE TO PV-DISP-SQLCODE                      18770000
187800             MOVE '3000-OPEN-TRECVER-CSR'                         18780000
187900                              TO RC098-ERROR-PARA-NAME            18790001
188000             SET RC098-DB-ERROR                                   18800001
188100                 PS-ERROR-YES    TO TRUE                          18810000
188200             DISPLAY '******************************************' 18820000
188300             DISPLAY '*ABEND                                   *' 18830000
188400             DISPLAY '*PROGRAM   = RCKUP066                    *' 18840000
188500             DISPLAY '*DB2 OPER  = OPEN TRECVER CURSOR         *' 18850000
188600             DISPLAY '*PARAGRAPH = 3000-OPEN-TRECVER-CSR       *' 18860000
188700             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                18870000
188800             DISPLAY '******************************************' 18880000
188900     END-EVALUATE.                                                18890000
189000                                                                  18900000
189100                                                                  18910007
189200*----------------------------------------------------------------*18920000
189300*    FETCH A TRECVER ROW                                         *18930000
189400*----------------------------------------------------------------*18940000
189500                                                                  18950000
189600 3020-FETCH-TRECVER-CSR.                                          18960000
189700                                                                  18970000
189800     EXEC SQL                                                     18980000
189900          FETCH TRECVER-CSR                                       18990000
190000          INTO :RECVER-MAX-RCVR-NBR                               19000000
190100     END-EXEC.                                                    19010000
190200                                                                  19020000
190300     EVALUATE TRUE                                                19030000
190400         WHEN SQLCODE = +0                                        19040000
190500              CONTINUE                                            19050000
190600                                                                  19060000
190700         WHEN SQLCODE = +100                                      19070000
190800              SET PS-EOF-TRECVER-CSR TO TRUE                      19080000
190900                                                                  19090000
191000         WHEN SQLWARN0 NOT = SPACE                                19100000
191100         WHEN SQLCODE < +0                                        19110000
191200         WHEN SQLCODE > +0                                        19120000
191300             MOVE SQLCODE TO PV-DISP-SQLCODE                      19130000
191400             MOVE '3020-FETCH-TRECVER-CSR'                        19140000
191500                              TO RC098-ERROR-PARA-NAME            19150001
191600             SET RC098-DB-ERROR                                   19160001
191700                 PS-ERROR-YES    TO TRUE                          19170000
191800             DISPLAY '******************************************' 19180000
191900             DISPLAY '*ABEND                                   *' 19190000
192000             DISPLAY '*PROGRAM   = RCKUP066                    *' 19200000
192100             DISPLAY '*DB2 OPER  = FETCH TRECVER CURSOR        *' 19210000
192200             DISPLAY '*PARAGRAPH = 3020-FETCH-TRECVER-CSR      *' 19220000
192300             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19230000
192400             DISPLAY '******************************************' 19240000
192500     END-EVALUATE.                                                19250000
192600                                                                  19260000
192700                                                                  19270007
192800*----------------------------------------------------------------*19280000
192900*    UDPATE CURRENT CURSOR                                       *19290000
193000*----------------------------------------------------------------*19300000
193100                                                                  19310000
193200 3040-DELETE-TRECVER-CSR.                                         19320000
193300                                                                  19330000
193400     EXEC SQL                                                     19340000
193500          DELETE FROM TRECVER                                     19350000
193600            WHERE CURRENT OF TRECVER-CSR                          19360000
193700     END-EXEC                                                     19370000
193800                                                                  19380000
193900     EVALUATE TRUE                                                19390000
194000         WHEN SQLCODE = +0                                        19400000
194100              CONTINUE                                            19410000
194200                                                                  19420000
194300         WHEN SQLWARN0 NOT = SPACE                                19430000
194400         WHEN SQLCODE < +0                                        19440000
194500         WHEN SQLCODE > +0                                        19450000
194600             MOVE SQLCODE TO PV-DISP-SQLCODE                      19460000
194700             MOVE '3040-DELETE-TRECVER-CSR'                       19470000
194800                              TO RC098-ERROR-PARA-NAME            19480001
194900             SET RC098-DB-ERROR                                   19490001
195000                 PS-ERROR-YES    TO TRUE                          19500000
195100             DISPLAY '******************************************' 19510000
195200             DISPLAY '*ABEND                                   *' 19520000
195300             DISPLAY '*PROGRAM   = RCKUP066                    *' 19530000
195400             DISPLAY '*DB2 OPER  = DELETE TRECVER CURSOR       *' 19540000
195500             DISPLAY '*PARAGRAPH = 3040-DELETE-TRECVER-CSR     *' 19550000
195600             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19560000
195700             DISPLAY '******************************************' 19570000
195800     END-EVALUATE.                                                19580000
195900                                                                  19590000
196000/                                                                 19600000
196100*----------------------------------------------------------------*19610000
196200* INSERT THE TRECVER ROW                                         *19620000
196300*----------------------------------------------------------------*19630000
196400                                                                  19640000
196500 3060-INSERT-TRECVER.                                             19650000
196600                                                                  19660000
196700     EXEC SQL                                                     19670000
196800          INSERT INTO TRECVER                                     19680000
196900                 ( OPERCO_NBR                                     19690000
197000                ,  MAX_RCVR_NBR )                                 19700000
197100          VALUES ( '03'                                           19710000
197200                ,  :RECVER-MAX-RCVR-NBR )                         19720000
197300     END-EXEC.                                                    19730000
197400                                                                  19740000
197500     EVALUATE TRUE                                                19750000
197600         WHEN SQLCODE = +0                                        19760000
197700         WHEN SQLCODE = -904                                      19770000
197800         WHEN SQLCODE = -913                                      19780000
197900             CONTINUE                                             19790000
198000                                                                  19800000
198100         WHEN SQLWARN0 NOT = SPACE                                19810000
198200         WHEN SQLCODE < +0                                        19820000
198300         WHEN SQLCODE > +0                                        19830000
198400             MOVE SQLCODE TO PV-DISP-SQLCODE                      19840000
198500             MOVE '3060-INSERT-TRECVER'                           19850000
198600                              TO RC098-ERROR-PARA-NAME            19860001
198700             SET RC098-DB-ERROR                                   19870001
198800                 PS-ERROR-YES    TO TRUE                          19880000
198900             DISPLAY '******************************************' 19890000
199000             DISPLAY '*ABEND                                   *' 19900000
199100             DISPLAY '*PROGRAM   = RCKUP066                    *' 19910000
199200             DISPLAY '*DB2 OPER  = INSERT TRECVER              *' 19920000
199300             DISPLAY '*PARAGRAPH = 3060-INSERT-TRECVER         *' 19930000
199400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                19940000
199500             DISPLAY '******************************************' 19950000
199600     END-EVALUATE.                                                19960000
199700                                                                  19970000
199800/                                                                 19980000
199900*----------------------------------------------------------------*19990000
200000* CLOSE THE TRECVER CURSOR                                       *20000000
200100*----------------------------------------------------------------*20010000
200200                                                                  20020000
200300 3080-CLOSE-TRECVER-CSR.                                          20030000
200400                                                                  20040000
200500     EXEC SQL                                                     20050000
200600          CLOSE TRECVER-CSR                                       20060000
200700     END-EXEC                                                     20070000
200800                                                                  20080000
200900     EVALUATE TRUE                                                20090000
201000         WHEN SQLCODE = +0                                        20100000
201100              CONTINUE                                            20110000
201200         WHEN SQLWARN0 NOT = SPACE                                20120000
201300         WHEN SQLCODE  NOT = +0                                   20130000
201400             MOVE SQLCODE TO PV-DISP-SQLCODE                      20140000
201500             MOVE '3080-CLOSE-TRECVER-CSR'                        20150000
201600                              TO RC098-ERROR-PARA-NAME            20160001
201700             SET RC098-DB-ERROR                                   20170001
201800                 PS-ERROR-YES    TO TRUE                          20180000
201900             DISPLAY '******************************************' 20190000
202000             DISPLAY '*ABEND                                   *' 20200000
202100             DISPLAY '*PROGRAM   = RCKUP066                    *' 20210000
202200             DISPLAY '*DB2 OPER  = CLOSE TRECVER CURSOR        *' 20220000
202300             DISPLAY '*PARAGRAPH = 3080-CLOSE-TRECVER-CSR      *' 20230000
202400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20240000
202500             DISPLAY '******************************************' 20250000
202600     END-EVALUATE.                                                20260000
202700                                                                  20270000
202800/                                                                 20280000
202900                                                                  20290000
203000 4000-READ-RECORD.                                                20300000
203100     SET PS-NOT-END-OF-INPUT TO TRUE.                             20310000
203200     READ INPUT-FILE  INTO RC098-ITEM-REC                         20320001
203300         AT END                                                   20330000
203400           SET PS-END-OF-INPUT TO TRUE                            20340000
203500         NOT AT END                                               20350000
203600           ADD +1               TO PA-TOTAL-RECORDS-READ          20360000
203700           ADD RC098-TO-VERIFY-QTY                                20370001
203800                                TO PA-TOTAL-UNITS-PROCESSED       20380000
203810                                                                  20381004
203901           DISPLAY ' RCVR:'    RC098-ORIG-OPER-UNIT               20390128
203910                   '-'         RC098-ORIG-PO-NBR                  20391027
203920                   '-'         RC098-ORIG-PO-RCVR                 20392027
204000                   '-'         RC098-ORIG-PO-LNE-NBR              20400027
204100                   ' STR:'     RC098-ORIG-STR-NBR                 20410027
204200                   ' VE QTY:'  RC098-TO-VERIFY-QTY                20420004
204201           DISPLAY ' '                                            20420127
204210                                                                  20421004
204300           MOVE RC098-OPER-UNIT     TO PV-BKUP-OPER-UNT-ID        20430016
204310           MOVE RC098-PO-NBR        TO PV-BKUP-PO-NBR-1           20431004
204400           MOVE RC098-PO-LNE-NBR    TO PV-BKUP-PO-LNE-1           20440001
204500           MOVE RC098-STR-NBR       TO PV-BKUP-STR-NBR-1          20450001
204600           MOVE RC098-TO-VERIFY-QTY TO PV-BKUP-TO-VERIFY-QTY-1    20460001
204700           WRITE BKUP-RECORD FROM PV-BKUP-RECORD-1.               20470000
204800                                                                  20480000
204900****************************************************************  20490000
205000* END RUN OF PROGRAM ROUTINE:                                     20500000
205100* DISPLAY SUMMARY STATISTICS                                      20510000
205200****************************************************************  20520000
205300 5000-END-RUN-ROUTINE.                                            20530000
205400                                                                  20540000
205500     CLOSE INPUT-FILE                                             20550000
205600           ERROR-FILE                                             20560000
205700           BKUP-FILE                                              20570025
205710           OUTPUT-FILE.                                           20571025
205800                                                                  20580000
205900*END OF JOB ROUTINE.                                              20590000
206000     PERFORM 8000-EOJ-ROUTINE.                                    20600000
206100                                                                  20610000
206200*END PROGRAM.                                                     20620000
206300     DISPLAY '************  END OF RCKUP066  ***************'     20630000
206400     STOP RUN.                                                    20640000
206500                                                                  20650000
206501                                                                  20650107
206502*-----------------------------------------------------------------20650207
206503* CHECK IF THERE ARE ANY 371 (FAILED ADJUSTMENTS) TROUBLE TO BE   20650307
206504* RESOLVED                                                        20650407
206505*-----------------------------------------------------------------20650507
206510 5100-CHECK-FOR-TROUBLE.                                          20651007
206520                                                                  20652007
206521     SET  PS-EOF-TROUBLE-NO  TO  TRUE.                            20652118
206522                                                                  20652207
206523     PERFORM 5110-OPEN-TROUBLE-CSR.                               20652307
206524     PERFORM 5120-PROCESS-TROUBLE                                 20652407
206525       UNTIL PS-EOF-TROUBLE                                       20652518
206526          OR PS-ERROR-YES.                                        20652607
206527     PERFORM 5150-CLOSE-TROUBLE-CSR.                              20652707
206528                                                                  20652807
206529                                                                  20652907
206530*-----------------------------------------------------------------20653007
206531* OPEN TROUBLE CURSOR                                             20653107
206532*-----------------------------------------------------------------20653207
206533 5110-OPEN-TROUBLE-CSR.                                           20653307
206534                                                                  20653407
206535     MOVE RC098-ORIG-PO-NBR  TO TRBNTF-PO-NBR.                    20653507
206536     MOVE RC098-ORIG-PO-RCVR TO TRBNTF-REC-SEQ-NBR.               20653607
206537                                                                  20653707
206538     EXEC SQL                                                     20653807
206539          OPEN TROUBLE-CSR                                        20653907
206540     END-EXEC.                                                    20654007
206541                                                                  20654107
206542     EVALUATE TRUE                                                20654207
206543         WHEN SQLCODE = +0                                        20654307
206544              CONTINUE                                            20654407
206545         WHEN SQLWARN0 NOT = SPACE                                20654507
206546         WHEN SQLCODE  NOT = +0                                   20654607
206547             MOVE SQLCODE TO PV-DISP-SQLCODE                      20654707
206548             MOVE '5110-OPEN-TROUBLE-CSR'                         20654807
206549                              TO RC098-ERROR-PARA-NAME            20654907
206550             SET RC098-DB-ERROR                                   20655007
206551                 PS-ERROR-YES    TO TRUE                          20655107
206552             DISPLAY '******************************************' 20655207
206553             DISPLAY '*ABEND                                   *' 20655307
206554             DISPLAY '*PROGRAM   = RCKUP066                    *' 20655407
206555             DISPLAY '*DB2 OPER  = OPEN TROUBLE CURSOR         *' 20655507
206556             DISPLAY '*PARAGRAPH = 5110-OPEN-TROUBLE-CSR       *' 20655607
206557             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20655707
206558             DISPLAY '******************************************' 20655807
206559     END-EVALUATE.                                                20655907
206560                                                                  20656007
206561                                                                  20656107
206562*-----------------------------------------------------------------20656207
206563* FETCH TROUBLE CURSOR                                            20656307
206564*-----------------------------------------------------------------20656407
206565 5120-PROCESS-TROUBLE.                                            20656507
206566                                                                  20656607
206567     EXEC SQL                                                     20656707
206568          FETCH TROUBLE-CSR                                       20656807
206570          INTO :TRBNTF-NOTIF-NBR                                  20657013
206571             , :TRBNTF-OPER-UNT-ID                                20657113
206572             , :TRBNTF-FCLTY-ID                                   20657213
206573             , :TRBNTF-PO-NBR                                     20657314
206574             , :TRBNTF-REC-SEQ-NBR                                20657413
206575             , :TRBNTF-TRBL-RSN-CDE                               20657513
206576     END-EXEC.                                                    20657607
206577                                                                  20657707
206578     EVALUATE TRUE                                                20657807
206579         WHEN SQLCODE = +0                                        20657907
206580              PERFORM 5130-INSERT-TROUBLE-DETAIL                  20658018
206581              PERFORM 5140-RESOLVE-TROUBLE                        20658107
206582                                                                  20658207
206583         WHEN SQLCODE = +100                                      20658307
206584              SET PS-EOF-TROUBLE  TO TRUE                         20658419
206585                                                                  20658507
206586         WHEN SQLWARN0 NOT = SPACE                                20658607
206587         WHEN SQLCODE < +0                                        20658707
206588         WHEN SQLCODE > +0                                        20658807
206589             MOVE SQLCODE TO PV-DISP-SQLCODE                      20658907
206590             MOVE '5120-PROCESS-TROUBLE  '                        20659007
206591                              TO RC098-ERROR-PARA-NAME            20659107
206592             SET RC098-DB-ERROR                                   20659207
206593                 PS-ERROR-YES    TO TRUE                          20659307
206594             DISPLAY '******************************************' 20659407
206595             DISPLAY '*ABEND                                   *' 20659507
206596             DISPLAY '*PROGRAM   = RCKUP066                    *' 20659607
206597             DISPLAY '*DB2 OPER  = FETCH TROUBLE CURSOR        *' 20659707
206598             DISPLAY '*PARAGRAPH = 5120-PROCESS-TROUBLE        *' 20659807
206599             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20659907
206600             DISPLAY '******************************************' 20660007
206601     END-EVALUATE.                                                20660107
206602                                                                  20660207
206603                                                                  20660307
206604*-----------------------------------------------------------------20660407
206605* INSERT TROUBLE DETAIL                                           20660507
206606*-----------------------------------------------------------------20660607
206607 5130-INSERT-TROUBLE-DETAIL.                                      20660707
206608                                                                  20660807
206609      MOVE TRBNTF-NOTIF-NBR      TO  TRBDTL-NOTIF-NBR.            20660907
206611      MOVE PC-PTL-FSA            TO  TRBDTL-CRE-UID.              20661133
206612      MOVE RECEIV-REC-SEQ-NBR    TO  PV-DISP-RCVR.                20661207
206613      STRING 'CR #'                                               20661307
206614             PV-DISP-RCVR                                         20661407
206615             ' AUTO CREATED '        DELIMITED BY SIZE            20661512
206616                               INTO  TRBDTL-FREEFORM-TEXT-TEXT.   20661607
206617      MOVE +25                   TO  TRBDTL-FREEFORM-TEXT-LEN.    20661735
206619                                                                  20661907
206621     EXEC SQL                                                     20662108
206622          INSERT                                                  20662208
206623            INTO  TTRBDTL                                         20662308
206624                ( NOTIF_NBR                                       20662408
206625                 ,CRE_TMST                                        20662508
206626                 ,CRE_UID                                         20662608
206627                 ,FREEFORM_TEXT)                                  20662708
206628          VALUES                                                  20662808
206629                ( :TRBDTL-NOTIF-NBR                               20662908
206630                ,  CURRENT TIMESTAMP                              20663008
206631                , :PC-PTL-FSA                                     20663138
206632                , :TRBDTL-FREEFORM-TEXT)                          20663208
206633     END-EXEC.                                                    20663308
206634                                                                  20663408
206635     EVALUATE TRUE                                                20663508
206636         WHEN SQLCODE = ZERO                                      20663608
206637             ADD +1 TO PT-TROUBLE-DETAIL-COUNT                    20663719
206638                                                                  20663808
206639         WHEN SQLWARN0 NOT = SPACE                                20663908
206640         WHEN SQLCODE < +0                                        20664008
206641         WHEN SQLCODE > +0                                        20664108
206642             MOVE SQLCODE TO PV-DISP-SQLCODE                      20664208
206643             MOVE '5130-INSERT-TROUBLE-DETAIL '                   20664308
206644                              TO RC098-ERROR-PARA-NAME            20664408
206645             SET RC098-DB-ERROR                                   20664508
206646                 PS-ERROR-YES    TO TRUE                          20664608
206647             DISPLAY '******************************************' 20664708
206648             DISPLAY '*ABEND                                   *' 20664808
206649             DISPLAY '*PROGRAM   = RCKUP066                    *' 20664908
206650             DISPLAY '*DB2 OPER  = INSERT TROUBLE DETAIL       *' 20665008
206651             DISPLAY '*PARAGRAPH = 5130-INSERT-TROUBLE-DETAIL  *' 20665108
206652             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20665208
206653             DISPLAY '******************************************' 20665308
206659     END-EVALUATE.                                                20665908
206660                                                                  20666008
206661                                                                  20666108
206666*-----------------------------------------------------------------20666607
206667* RESOLVE TROUBLE                                                 20666707
206668*-----------------------------------------------------------------20666807
206669 5140-RESOLVE-TROUBLE.                                            20666907
206670                                                                  20667008
206671     EXEC SQL                                                     20667108
206672          UPDATE TTRBNTF                                          20667208
206673             SET RESOLVED_IND   = 'A'                             20667309
206674               , RESOLVED_TMST  = CURRENT TIMESTAMP               20667409
206675               , RESOLVED_UID   = :PC-PTL-FSA                     20667533
206676               , ACKNOWLG_TMST  = CURRENT TIMESTAMP               20667609
206677               , ACKNOWLG_UID   = :PC-PTL-FSA                     20667733
206679           WHERE NOTIF_NBR      = :TRBNTF-NOTIF-NBR               20667909
206680             AND OPER_UNT_ID    = :TRBNTF-OPER-UNT-ID             20668009
206681             AND FCLTY_ID       = :TRBNTF-FCLTY-ID                20668109
206682             AND PO_NBR         = :TRBNTF-PO-NBR                  20668214
206683             AND REC_SEQ_NBR    = :TRBNTF-REC-SEQ-NBR             20668309
206684             AND TRBL_RSN_CDE   = :TRBNTF-TRBL-RSN-CDE            20668409
206685     END-EXEC                                                     20668509
206686                                                                  20668609
206687     EVALUATE TRUE                                                20668709
206688         WHEN SQLCODE = +0                                        20668809
206689             MOVE +1       TO PT-TOTAL-TROUBLE-UPDATES            20668909
206690                                                                  20669009
206693         WHEN SQLWARN0 NOT = SPACE                                20669309
206694         WHEN SQLCODE < +0                                        20669409
206695         WHEN SQLCODE > +0                                        20669509
206696             MOVE SQLCODE TO PV-DISP-SQLCODE                      20669609
206697             MOVE '5140-RESOLVE-TROUBLE       '                   20669709
206698                              TO RC098-ERROR-PARA-NAME            20669809
206699             SET RC098-DB-ERROR                                   20669909
206700                 PS-ERROR-YES    TO TRUE                          20670009
206701             DISPLAY '******************************************' 20670109
206702             DISPLAY '*ABEND                                   *' 20670209
206703             DISPLAY '*PROGRAM   = RCKUP066                    *' 20670309
206704             DISPLAY '*DB2 OPER  = RESOLVE TROUBLE             *' 20670409
206705             DISPLAY '*PARAGRAPH = 5140-RESOLVE-TROUBLE        *' 20670509
206706             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20670609
206707             DISPLAY '******************************************' 20670709
206725     END-EVALUATE.                                                20672509
206726                                                                  20672609
206727                                                                  20672709
206728*-----------------------------------------------------------------20672809
206729* CLOSE TROUBLE CURSOR                                            20672909
206730*-----------------------------------------------------------------20673009
206731 5150-CLOSE-TROUBLE-CSR.                                          20673109
206732                                                                  20673209
206733     EXEC SQL                                                     20673309
206734          CLOSE TROUBLE-CSR                                       20673409
206735     END-EXEC.                                                    20673509
206736                                                                  20673609
206737     EVALUATE TRUE                                                20673709
206738         WHEN SQLCODE = +0                                        20673809
206739              CONTINUE                                            20673909
206740         WHEN SQLWARN0 NOT = SPACE                                20674009
206741         WHEN SQLCODE  NOT = +0                                   20674109
206742             MOVE SQLCODE TO PV-DISP-SQLCODE                      20674209
206743             MOVE '5150-CLOSE-TROUBLE-CSR'                        20674309
206744                              TO RC098-ERROR-PARA-NAME            20674409
206745             SET RC098-DB-ERROR                                   20674509
206746                 PS-ERROR-YES    TO TRUE                          20674609
206747             DISPLAY '******************************************' 20674709
206748             DISPLAY '*ABEND                                   *' 20674809
206749             DISPLAY '*PROGRAM   = RCKUP066                    *' 20674909
206750             DISPLAY '*DB2 OPER  = CLOSE TROUBLE CURSOR        *' 20675009
206751             DISPLAY '*PARAGRAPH = 5150-CLOSE-TROUBLE-CSR      *' 20675109
206752             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20675209
206753             DISPLAY '******************************************' 20675309
206754     END-EVALUATE.                                                20675409
206755                                                                  20675509
206756******************************************************************20675609
206757* ACKNOWLEDGE FAILED STORE UNIT ADJUSTMENT                        20675709
206758******************************************************************20675809
206759 5200-ACKNOWLEDGE-FSA.                                            20675909
206760                                                                  20676009
206761     MOVE  RC098-FINCL-ADJ-ID      TO SUT00030-FINCL-ADJ-ID       20676110
206762     MOVE  RC098-ORIG-PO-NBR       TO SUT00030-PO-NBR             20676210
206763     MOVE  RC098-ORIG-PO-RCVR      TO SUT00030-RCVR-SEQ-NBR       20676331
206764     MOVE  RC098-ORIG-PO-LNE-NBR   TO SUT00030-RCVR-LNE-NBR       20676431
206765     MOVE  RC098-ORIG-STR-NBR      TO SUT00030-DEST-LOC-NBR       20676510
206766     MOVE  RC098-FINCL-ADJ-ERR-CDE TO SUT00030-ADJ-ERR-CDE        20676610
206767     MOVE  RC098-PRC-RSN-CDE       TO SUT00030-PRC-RSN-CDE        20676730
206769                                                                  20676910
206770     MOVE RECEIV-REC-SEQ-NBR       TO PV-DISP-RCVR.               20677010
206771     STRING 'CR #'                                                20677110
206772            PV-DISP-RCVR                                          20677210
206773            ' AUTO CREATED '          DELIMITED BY SIZE           20677313
206774                                 INTO SUT00030-RSLV-CMNT-TXT.     20677410
206775                                                                  20677510
206776     EXEC SQL                                                     20677610
206777          UPDATE SUT_FINCL_ADJ                                    20677710
206778             SET RSLV_BY_USR_ID  = :PC-PTL-FSA                    20677833
206779               , RSLV_TMST       = CURRENT TIMESTAMP              20677910
206780               , RSLV_CMNT_TXT   = :SUT00030-RSLV-CMNT-TXT        20678010
206783           WHERE                                                  20678311
206784                 FINCL_ADJ_ID    = :SUT00030-FINCL-ADJ-ID         20678411
206785             AND PO_NBR          = :SUT00030-PO-NBR               20678511
206786             AND RCVR_LNE_NBR    = :SUT00030-RCVR-LNE-NBR         20678611
206787             AND RCVR_SEQ_NBR    = :SUT00030-RCVR-SEQ-NBR         20678711
206788             AND DEST_LOC_NBR    = :SUT00030-DEST-LOC-NBR         20678811
206789             AND ADJ_ERR_CDE     = :SUT00030-ADJ-ERR-CDE          20678911
206790             AND PRC_RSN_CDE     = :SUT00030-PRC-RSN-CDE          20679011
206791             AND RSLV_BY_USR_ID  = ' '                            20679111
206792             AND RSLV_TMST       > CURRENT TIMESTAMP              20679211
206793                                                                  20679311
206794     END-EXEC                                                     20679411
206795                                                                  20679511
206796     EVALUATE TRUE                                                20679611
206797         WHEN SQLCODE = +0                                        20679711
206798             MOVE +1       TO PT-TOTAL-FINCL-ADJ-UPDATE           20679819
206799                                                                  20679911
206800         WHEN SQLWARN0 NOT = SPACE                                20680011
206801         WHEN SQLCODE < +0                                        20680111
206802         WHEN SQLCODE > +0                                        20680211
206803             MOVE SQLCODE TO PV-DISP-SQLCODE                      20680311
206804             MOVE '5200-ACKNOWLEDGE-FSA       '                   20680411
206805                              TO RC098-ERROR-PARA-NAME            20680511
206806             SET RC098-DB-ERROR                                   20680611
206807                 PS-ERROR-YES    TO TRUE                          20680711
206808             DISPLAY '******************************************' 20680811
206809             DISPLAY '*ABEND                                   *' 20680911
206810             DISPLAY '*PROGRAM   = RCKUP066                    *' 20681011
206811             DISPLAY '*DB2 OPER  = RESOLVE TROUBLE             *' 20681111
206812             DISPLAY '*PARAGRAPH = 5200-ACKNOWLEDGE-FSA        *' 20681211
206813             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                20681311
206814             DISPLAY '******************************************' 20681429
206815             DISPLAY 'RC098-FINCL-ADJ-ID      ' RC098-FINCL-ADJ-ID20681529
206816             DISPLAY 'RC098-ORIG-PO-NBR       ' RC098-ORIG-PO-NBR 20681629
206817             DISPLAY 'RC098-ORIG-PO-RCVR      ' RC098-ORIG-PO-RCVR20681729
206818             DISPLAY 'RC098-ORIG-PO-LNE-NBR   '                   20681829
206819                                          RC098-ORIG-PO-LNE-NBR   20681929
206820             DISPLAY 'RC098-ORIG-STR-NBR      ' RC098-ORIG-STR-NBR20682029
206821             DISPLAY 'RC098-FINCL-ADJ-ERR-CDE '                   20682129
206822                                          RC098-FINCL-ADJ-ERR-CDE 20682229
206823             DISPLAY 'RC098-PRC-RSN-CDE       ' RC098-PRC-RSN-CDE 20682330
206824             DISPLAY '******************************************' 20682429
206825     END-EVALUATE.                                                20682529
206826                                                                  20682629
206827                                                                  20682729
206828******************************************************************20682829
206829* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     20682929
206830******************************************************************20683029
206900 6000-DB2-COMMIT.                                                 20690000
207000                                                                  20700000
207100     EXEC SQL                                                     20710000
207200         COMMIT                                                   20720000
207300     END-EXEC.                                                    20730000
207400                                                                  20740000
207500     EVALUATE TRUE                                                20750000
207600         WHEN SQLCODE = +0                                        20760000
207700              ADD +1  TO PA-TOTAL-DB2-COMMITS                     20770000
207800              ADD PT-TOTAL-TPKSLIP-INSERTS                        20780000
207900                                     TO PA-TOTAL-TPKSLIP-INSERTS  20790000
208000              ADD PT-TOTAL-TPKSLIP-UPDATES                        20800000
208100                                     TO PA-TOTAL-TPKSLIP-UPDATES  20810000
208200              ADD PT-TOTAL-TPKITEM-INSERTS                        20820023
208300                                     TO PA-TOTAL-TPKITEM-INSERTS  20830023
208400              ADD PT-TOTAL-TRECEIV-INSERTS                        20840000
208500                                     TO PA-TOTAL-TRECEIV-INSERTS  20850000
208600              ADD PT-TOTAL-TRECEIV-UPDATES                        20860000
208700                                     TO PA-TOTAL-TRECEIV-UPDATES  20870000
208800              ADD PT-TOTAL-TRECITM-INSERTS                        20880023
208900                                     TO PA-TOTAL-TRECITM-INSERTS  20890023
209000              ADD PT-TOTAL-TRECDIS-INSERTS                        20900000
209100                                     TO PA-TOTAL-TRECDIS-INSERTS  20910000
209200              ADD PT-TOTAL-WFT-CNTL-INSERTS                       20920023
209300                                     TO PA-TOTAL-WFT-CNTL-INSERTS 20930023
209400              ADD PT-TOTAL-WFT-XFER-INSERTS                       20940023
209500                                     TO PA-TOTAL-WFT-XFER-INSERTS 20950023
209501              ADD PT-TOTAL-TROUBLE-UPDATES                        20950123
209502                                     TO PA-TOTAL-TROUBLE-UPDATES  20950223
209510              ADD PT-TROUBLE-DETAIL-COUNT                         20951019
209520                                     TO PA-TROUBLE-DETAIL-COUNT   20952019
209530              ADD PT-TOTAL-FINCL-ADJ-UPDATE                       20953019
209540                                     TO PT-TOTAL-FINCL-ADJ-UPDATE 20954019
209600         WHEN SQLWARN0 NOT = SPACES                               20960000
209700         WHEN SQLCODE  NOT = ZERO                                 20970000
209800         MOVE '6000-DB2-COMMIT'                                   20980000
209900                          TO RC098-ERROR-PARA-NAME                20990001
210000         SET RC098-DB-ERROR                                       21000001
210100             PS-ERROR-YES    TO TRUE                              21010000
210200         DISPLAY '****************************'                   21020000
210300         DISPLAY '** ABEND                  **'                   21030000
210400         DISPLAY '** PROGRAM = RCKUP066     **'                   21040000
210500         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   21050000
210600         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   21060000
210700         DISPLAY '****************************'                   21070000
210800     END-EVALUATE.                                                21080000
210900                                                                  21090000
211000 6100-DB2-ROLLBACK.                                               21100000
211100                                                                  21110000
211200     EXEC SQL                                                     21120000
211300         ROLLBACK                                                 21130000
211400     END-EXEC.                                                    21140000
211500                                                                  21150000
211600     EVALUATE TRUE                                                21160000
211700         WHEN SQLCODE = +0                                        21170000
211800              CONTINUE                                            21180000
211900         WHEN SQLWARN0 NOT = SPACES                               21190000
212000         WHEN SQLCODE  NOT = ZERO                                 21200000
212100         MOVE '6100-DB2-ROLLBACK'                                 21210000
212200                          TO RC098-ERROR-PARA-NAME                21220001
212300         SET RC098-DB-ERROR                                       21230001
212400             PS-ERROR-YES    TO TRUE                              21240000
212500         DISPLAY '****************************'                   21250000
212600         DISPLAY '** ABEND                  **'                   21260000
212700         DISPLAY '** PROGRAM = RCKUP066     **'                   21270000
212800         DISPLAY '** PARAGRAPH = 6100-ROLLBACK'                   21280000
212900         DISPLAY '** UNSUCCESSFUL ROLLBACK  **'                   21290000
213000         DISPLAY '****************************'                   21300000
213100     END-EVALUATE.                                                21310000
213200                                                                  21320000
213300******************************************************************21330000
213400* UPDATE CHECKPOINT STATUS CODE WITH 0 FOR COMPLETION.            21340000
213500* DISPLAY STATISTICS FOR THE PROGRAM                              21350000
213600******************************************************************21360000
213700 8000-EOJ-ROUTINE.                                                21370000
213800                                                                  21380000
213900                                                                  21390000
214000         DISPLAY ' ********************************************'  21400000
214100         DISPLAY '     * RCKUP066 SUMMARY STATISTICS *         '  21410000
214200         DISPLAY ' '                                              21420000
214300         DISPLAY '       ---------------------------           '  21430000
214400         DISPLAY '          RECEIVER CREATE UPDATES            '  21440000
214500         DISPLAY '       ---------------------------           '  21450000
214600         DISPLAY ' '                                              21460000
214700         DISPLAY ' TOTAL RECORDS READ                :'           21470000
214800                                        PA-TOTAL-RECORDS-READ     21480000
214900         DISPLAY ' TOTAL UNITS PROCESSED             :'           21490000
215000                                        PA-TOTAL-UNITS-PROCESSED  21500000
215100         DISPLAY ' TOTAL MESSAGES PROCESSED          :'           21510024
215200                                        PA-TOTAL-PROCESS-RECS     21520024
215210         DISPLAY ' TOTAL MESSAGES IN ERROR           :'           21521024
215220                                        PA-TOTAL-ERROR-RECS       21522024
215300         DISPLAY ' TOTAL PKSLIP INSERTS              :'           21530000
215400                                        PA-TOTAL-TPKSLIP-INSERTS  21540000
215500         DISPLAY ' TOTAL PKSLIP UPDATES              :'           21550000
215600                                        PA-TOTAL-TPKSLIP-UPDATES  21560000
215700         DISPLAY ' TOTAL PKITEM INSERTS              :'           21570000
215800                                        PA-TOTAL-TPKITEM-INSERTS  21580000
215900         DISPLAY ' TOTAL RECEIVER INSERTS            :'           21590000
216000                                        PA-TOTAL-TRECEIV-INSERTS  21600000
216100         DISPLAY ' TOTAL RECEIVER UPDATES            :'           21610000
216200                                        PA-TOTAL-TRECEIV-UPDATES  21620000
216300         DISPLAY ' TOTAL RECITM INSERTS              :'           21630000
216400                                        PA-TOTAL-TRECITM-INSERTS  21640000
216500         DISPLAY ' TOTAL RECDIS INSERTS              :'           21650000
216600                                        PA-TOTAL-TRECDIS-INSERTS  21660000
216610         DISPLAY ' TOTAL TROUBLE UPDATES             :'           21661019
216620                                        PA-TROUBLE-DETAIL-COUNT   21662019
216630         DISPLAY ' TOTAL SUT_FINCL_ADJ UPDATES       :'           21663019
216640                                        PA-TOTAL-FINCL-ADJ-UPDATE 21664019
216700         DISPLAY ' TOTAL DB2 COMMITS                 :'           21670000
216800                                        PA-TOTAL-DB2-COMMITS      21680000
216900         DISPLAY ' TOTAL WFT_CNTL INSERTS:  '                     21690000
217000                                        PA-TOTAL-WFT-CNTL-INSERTS 21700000
217100         DISPLAY ' TOTAL WFT_XFER INSERTS:  '                     21710000
217200                                        PA-TOTAL-WFT-XFER-INSERTS 21720000
217300         DISPLAY '********************************************'.  21730000
217400                                                                  21740000
217500                                                                  21750000
217600******************************************************************21760000
217700**                      END OF PROGRAM                            21770000
217800*                                                                 21780000
217900******************************************************************21790000
