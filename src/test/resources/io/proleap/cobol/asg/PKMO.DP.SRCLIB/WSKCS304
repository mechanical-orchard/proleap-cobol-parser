000100 IDENTIFICATION DIVISION.                                         00010099
000200 TITLE 'LEGACY SHIPPING SHIPMENT DOWNLOAD MODULE'.                00020099
000300*                                                                 00030099
000400 PROGRAM-ID.    WSKCS304.                                         00040099
000500 AUTHOR.        JEAN KURKOWSKI.                                   00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  FEBRURARY 2007.                                   00070099
000800 DATE-COMPILED.                                                   00080099
000900 ENVIRONMENT DIVISION.                                            00090099
001000                                                                  00100099
001100 CONFIGURATION SECTION.                                           00110099
001200 SOURCE-COMPUTER. IBM-3090.                                       00120099
001300 OBJECT-COMPUTER. IBM-3090.                                       00130099
001400                                                                  00140099
001500 DATA DIVISION.                                                   00150099
001600 WORKING-STORAGE SECTION.                                         00160099
001700 01  PV-VARIABLES.                                                00170099
001800     05  PV-CURRENT-TIMESTAMP         PIC X(26) VALUE SPACES.     00180099
001900     05  PV-REPOS-TIMESTAMP           PIC X(26) VALUE SPACES.     00190099
002000     05  PV-REPOS-TIMESTAMP-R REDEFINES PV-REPOS-TIMESTAMP.       00200099
002100         10  PV-BEGINNING             PIC X(20).                  00210099
002200         10  PV-CNTL-TMST             PIC 9(06).                  00220099
002300     05  PV-SQL-RETURN-CD             PIC -9(04).                 00230099
002400                                                                  00240099
002500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00250099
002600                                                     COMP SYNC.   00260099
002700     05  PV-CICS-RESP                    PIC S9(04)  VALUE +0     00270099
002800                                                     COMP SYNC.   00280099
002900     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 00290099
003000     05  PV-REPOS-COUNTER             PIC S9(04) VALUE +0         00300099
003100                                                COMP SYNC.        00310099
003200     05  PV-SQL-COUNT                 PIC  S9(09) COMP VALUE +0.  00320099
003210     05  PV-PO-COUNT                  PIC  S9(09) COMP VALUE +0.  00321099
003220     05  PV-ERDM-COUNT                PIC  S9(09) COMP VALUE +0.  00322099
003230     05  PV-DIVERT-COUNT              PIC  S9(09) COMP VALUE +0.  00323099
003240     05  PV-SHON-COUNT                PIC  S9(09) COMP VALUE +0.  00324099
003241                                                                  00324199
003242     05  PV-STR-TO-EFC-DC-NBR         PIC  S9(10)V9(5) COMP-3.    00324299
003243     05  PV-STR-TO-EFC-TRIP-ID        PIC  S9(10)V9(5) COMP-3.    00324399
003244     05  PV-STR-TO-EFC-ORIG-STR       PIC  S9(10)V9(5) COMP-3.    00324499
003245     05  PV-STR-TO-EFC-EFC-NBR        PIC  S9(10)V9(5) COMP-3.    00324599
003246     05  PV-STR-TO-EFC-EFC-STR        PIC  S9(10)V9(5) COMP-3.    00324699
003251     05  PV-STR-TO-EFC-PO             PIC  S9(9) COMP.            00325199
003252     05  PV-STR-TO-EFC-PO-CNT         PIC  S9(09) COMP VALUE +0.  00325299
003253                                                                  00325399
003254     05  PV-DISP-STE-DC               PIC   Z(04).                00325499
003255     05  PV-DISP-STE-TRIP             PIC   Z(10).                00325599
003256     05  PV-DISP-STE-STR              PIC   Z(04).                00325699
003257     05  PV-DISP-STE-EFC              PIC   Z(04).                00325799
003258     05  PV-DISP-STE-E-STR            PIC   Z(04).                00325899
003259                                                                  00325999
003260     05  PV-DISP-DC                   PIC   Z(04).                00326099
003261     05  PV-DISP-TRIP                 PIC   Z(10).                00326199
003262     05  PV-DISP-STR-1                PIC   Z(04).                00326299
003263     05  PV-DISP-STR-2                PIC   Z(04).                00326399
003264     05  PV-DISP-STR-3                PIC   Z(04).                00326499
003265     05  PV-DISP-STR-4                PIC   Z(04).                00326599
003266     05  PV-DISP-PO-CNT               PIC   Z(08).                00326699
003267     05  PV-DISP-SQL                  PIC   -999.                 00326799
003268     05  PV-CART-SRC-CDE              PIC   X(03).                00326899
003269                                                                  00326999
003270 01  WS-FIELDS.                                                   00327099
003271     05  WS-ENT-ID                    PIC S9(09) COMP.            00327199
003280     05  WS-RCVR-SEQ-NBR              PIC S9(09) COMP.            00328099
003290     05  WS-ROW-CNT                   PIC S9(09) COMP.            00329099
003300     05  WS-GP-CNT                    PIC S9(09) COMP.            00330099
003400     05  WS-VER-NBR                   PIC S9(04) COMP.            00340099
003500     05  WS-DEST-OPER-UNT-ID          PIC 9(04).                  00350099
003600     05  WS-SKU-NBR                   PIC S9(08) COMP-3.          00360099
003700     05  WS-SHPD-UNT-QTY              PIC S9(09)V COMP-3.         00370099
003800     05  WS-TOT-UNT-IN-CASE           PIC S9(09)V COMP-3.         00380099
003900     05  WS-CART-WT                   PIC S9(09)V9(04).           00390099
004000     05  WS-UNIT-WT                   PIC S9(09)V9(04).           00400099
004100     05  WS-SHIP-WT-QTY               PIC S9(05)V9(03) COMP-3.    00410099
004200     05  WS-UNIT-VOL                  PIC 9(09).                  00420099
004300     05  WS-CART-VOL                  PIC 9(09).                  00430099
004400     05  WS-SHIP-DPTH-QTY             PIC S9(05)V9(03) COMP-3.    00440099
004500     05  WS-SHIP-HT-QTY               PIC S9(05)V9(03) COMP-3.    00450099
004600     05  WS-SHIP-WD-QTY               PIC S9(05)V9(03) COMP-3.    00460099
004700     05  WS-CRE-TMST                  PIC X(26).                  00470099
004800     05  WS-DWNLD-TMST                PIC X(26).                  00480099
004900     05  WS-CRE-USR-ID                PIC X(08).                  00490099
005000     05  WS-DOOR-TYP-CDE              PIC X(02).                  00500099
005100     05  WS-SCAC-CDE                  PIC X(04).                  00510099
005200     05  WS-SHIP-SCAC-CDE             PIC X(04).                  00520099
005300     05  WS-TRLR-ID                   PIC X(12).                  00530099
005400     05  WS-SHIP-DATE                 PIC X(14).                  00540099
005500     05  WS-TRLR-SEAL-ID              PIC X(20).                  00550099
005600     05  WS-DISPLAY-OPER              PIC 9(04).                  00560099
005700     05  WS-DISPLAY-SHIPMT            PIC X(15).                  00570099
005800     05  WS-DISPLAY-1                 PIC -Z(08)9.                00580099
005900     05  WS-DISPLAY-2                 PIC  9(18).                 00590099
006000     05  WS-DISPLAY-3                 PIC -Z(08)9.                00600099
006100     05  WS-DISPLAY-4                 PIC -Z(08)9.                00610099
006200     05  WS-DISPLAY-5                 PIC -Z(08)9.                00620099
006300     05  WS-DISPLAY-6                 PIC  9(04).                 00630099
006400     05  WS-DISPLAY-7                 PIC -Z(08)9.                00640099
006500     05  WS-DISPLAY-WSWS004.                                      00650099
006600         10  WS-DISP-004-001-046      PIC X(46).                  00660099
006700         10  WS-DISP-004-047-098      PIC X(52).                  00670099
006800         10  WS-DISP-004-099-125      PIC X(26).                  00680099
006900     05  WS-PRC-TYP-CDE               PIC X(16).                  00690099
007000     05  WS-DAT-TXT-TEXT              PIC X(2000).                00700099
007100     05  WS-SHPT-UNT-ID               PIC 9(20).                  00710099
007200     05  WS-DAT-TXT-LEN               PIC S9(04) COMP.            00720099
007300     05  WS-HOST-INPT-ID              PIC X(10).                  00730099
007400     05  WS-HOST-INPT-ID-PIC          REDEFINES WS-HOST-INPT-ID.  00740099
007500         10  WS-HOST-INPT-NUM         PIC 9(10).                  00750099
007600     05  WS-TRN-LNE-CDE               PIC X(09).                  00760099
007700     05  WS-TRN-LNE-CDE-PIC           REDEFINES WS-TRN-LNE-CDE.   00770099
007800         10  WS-TRN-LNE-NBR           PIC 9(09).                  00780099
007900     05  WS-DEST-ID                   PIC 9(03).                  00790099
008000     05  WS-DEST-ID-R                 REDEFINES WS-DEST-ID.       00800099
008100         10  WS-DEST-ID-CHAR          PIC X(03).                  00810099
008200     05  WS-WHSE-CDE                  PIC X(04).                  00820099
008300     05  WS-WHSE-CDE-R                REDEFINES WS-WHSE-CDE.      00830099
008400         10  WS-WHSE-ZERO             PIC X.                      00840099
008500         10  WS-WHSE-DATA             PIC 9(03).                  00850099
008600                                                                  00860099
008700 01  DK-KEYS.                                                     00870099
008800     05  DK-TRIP-ID                   PIC S9(09) COMP VALUE +0.   00880099
008900     05  DK-SHIPT-ID                  PIC X(20)  VALUE SPACES.    00890099
009000     05  DK-OPER-UNT-ID               PIC S9(04) COMP VALUE +0.   00900099
009100     05  DK-SHPT-UNT-ID               PIC S9(18)V COMP-3 VALUE +0.00910099
009200     05  DK-TRN-NBR                   PIC S9(09) COMP-3 VALUE +0. 00920099
009300     05  DK-INTR-UPC-ID               PIC S9(09) COMP VALUE +0.   00930099
009400     05  DK-DEST-OPER-UNT-ID          PIC S9(04) COMP VALUE +0.   00940099
009500     05  DK-DEST-ID                   PIC X(03)  VALUE SPACES.    00950099
009600                                                                  00960099
009700 01  PS-SWITCHES.                                                 00970099
009800     05  PS-EOF-DETAIL-CSR           PIC X(01)  VALUE 'N'.        00980099
009900         88  PS-EOF-DETAIL-CSR-NO               VALUE 'N'.        00990099
010000         88  PS-EOF-DETAIL-CSR-YES              VALUE 'Y'.        01000099
010100     05  PS-CICS-SWITCH-IND          PIC X(01)  VALUE 'N'.        01010099
010200         88  PS-CICS-SWITCH-NO                  VALUE 'N'.        01020099
010300         88  PS-CICS-SWITCH-YES                 VALUE 'Y'.        01030099
010400     05  PS-DAT-LEVEL                PIC X(01)  VALUE 'N'.        01040099
010500         88  PS-DAT-LEVEL-DETAILS               VALUE 'D'.        01050099
010600         88  PS-DAT-LEVEL-HEADER                VALUE 'H'.        01060099
010700         88  PS-DAT-LEVEL-NONE                  VALUE 'N'.        01070099
010800     05  PS-FIRST-RECORD-SW          PIC X(01)  VALUE 'Y'.        01080099
010900         88  PS-FIRST-RECORD-YES                VALUE 'Y'.        01090099
011000         88  PS-FIRST-RECORD-NO                 VALUE 'N'.        01100099
011100     05  PS-DAT-CNTL-SW              PIC X(01)  VALUE 'Y'.        01110099
011200         88  PS-DAT-CNTL-DONE                   VALUE 'Y'.        01120099
011300         88  PS-DAT-CNTL-NOT-DONE               VALUE 'N'.        01130099
011310     05  PS-CRTN-PREV-DIVERT-SW      PIC X(01)  VALUE 'Y'.        01131099
011320         88  PS-CRTN-PREV-DIVERT-YES            VALUE 'Y'.        01132099
011330         88  PS-CRTN-PREV-DIVERT-NO             VALUE 'N'.        01133099
011340     05  PS-CRTN-ACTIVE-SHON-SW      PIC X(01)  VALUE 'Y'.        01134099
011350         88  PS-CRTN-ACTIVE-SHON-YES            VALUE 'Y'.        01135099
011360         88  PS-CRTN-ACTIVE-SHON-NO             VALUE 'N'.        01136099
011361                                                                  01136199
011362     05  PS-STR-TO-EFC-SW            PIC X(01)  VALUE 'N'.        01136299
011363         88  PS-STR-TO-EFC-YES                  VALUE 'Y'.        01136399
011364         88  PS-STR-TO-EFC-NO                   VALUE 'N'.        01136499
011365                                                                  01136599
011366     05  PS-STR-TO-EFC-PO-CK-SW      PIC X(01)  VALUE 'N'.        01136699
011367         88  PS-STR-TO-EFC-PO-CK-YES            VALUE 'Y'.        01136799
011368         88  PS-STR-TO-EFC-PO-CK-NO             VALUE 'N'.        01136899
011369     05  PS-SEND-FXR-TO-EFC-SW       PIC X(01)  VALUE 'N'.        01136999
011370         88  PS-SEND-FXR-TO-EFC-YES             VALUE 'Y'.        01137099
011371         88  PS-SEND-FXR-TO-EFC-NO              VALUE 'N'.        01137199
011372                                                                  01137299
011380 01  PC-CONSTANTS.                                                01138099
011390     05  PC-DEFAULT-NINES            PIC X(26)  VALUE             01139099
011400                              '9999-09-09-09.09.09.999999'.       01140099
011500     05  PC-DEFAULT-DATE             PIC X(14)  VALUE             01150099
011600                                          '99990909090909'.       01160099
011700     05  PC-HIGH-NINES               PIC S9(04) VALUE +9999 COMP. 01170099
011800     05  PC-ASN-MODULE               PIC X(08)  VALUE             01180099
011900                                                 'WSKCS302'.      01190099
012000     05  PC-ASN-MODULE-LENGTH        PIC S9(4) VALUE +125         01200099
012100                                                COMP SYNC.        01210099
012200/                                                                 01220099
012300* * * ASN HEADER - TRAILER INTO WMOS                              01230099
012400     COPY WSRD004.                                                01240099
012500* * * ASN DETAIL - TRAILER INTO WMOS                              01250099
012600     COPY WSRD005.                                                01260099
012700* * * CASE HEADER - INTO WMOS                                     01270099
012800     COPY WSRD006.                                                01280099
012900* * * CASE DETAIL - INTO WMOS                                     01290099
013000     COPY WSRD007.                                                01300099
013100* * * WMS APPOINTMENT - TRAILER INTO WMOS                         01310099
013200     COPY WSRD008.                                                01320099
013300* * * WMS ASN TRANSMISSION MODULE                                 01330099
013400     COPY WSWS006.                                                01340099
013500* * * WMS ASN DOWNLOAD CONTROL TABLE                              01350099
013600     COPY WSWS004.                                                01360099
013700* * * LAYOUT FOR THE ABEND COMMUNICATIONS AREA                    01370099
013800     COPY DPWS013.                                                01380099
013900                                                                  01390099
014000* * * COMMUNICATIONS AREA FOR DB2                                 01400099
014100     EXEC SQL                                                     01410099
014200          INCLUDE SQLCA                                           01420099
014300     END-EXEC.                                                    01430099
014400* * * WST_SHPMT_XREF_HDR VIEW - WMS SHIPMENT XREF HEADER          01440099
014500     EXEC SQL                                                     01450099
014600         INCLUDE WST00001                                         01460099
014700     END-EXEC.                                                    01470099
014800* * * WST_DAT_CNTL VIEW                                           01480099
014900     EXEC SQL                                                     01490099
015000         INCLUDE WST00003                                         01500099
015100     END-EXEC.                                                    01510099
015200* * * WST_DAT_XFER VIEW                                           01520099
015300     EXEC SQL                                                     01530099
015400         INCLUDE WST00004                                         01540099
015500     END-EXEC.                                                    01550099
015600* * * WST_ASN_DWNLD VIEW - WMS GLOBAL ASN DOWNLOAD TABLE          01560099
015700     EXEC SQL                                                     01570099
015800         INCLUDE WST00011                                         01580099
015900     END-EXEC.                                                    01590099
016000* * * WST_INTGRTN_TYP VIEW                                        01600099
016100     EXEC SQL                                                     01610099
016200         INCLUDE WST00008                                         01620099
016300     END-EXEC.                                                    01630099
016400* * * WST_ATTR_DEFN VIEW                                          01640099
016500     EXEC SQL                                                     01650099
016600         INCLUDE WST00009                                         01660099
016700     END-EXEC.                                                    01670099
016800* * * WST_ATTR_ELEM VIEW                                          01680099
016900     EXEC SQL                                                     01690099
017000         INCLUDE WST00010                                         01700099
017100     END-EXEC.                                                    01710099
017200* * * WSV_LOC_XREF VIEW - LOCATION CROSS REFERENCE                01720099
017300     EXEC SQL                                                     01730099
017400         INCLUDE WSV00000                                         01740099
017500     END-EXEC.                                                    01750099
017600* * * SUT_OTBND_UPC VIEW                                          01760099
017700     EXEC SQL                                                     01770099
017800         INCLUDE SUT00028                                         01780099
017900     END-EXEC.                                                    01790099
018000* * * SUT_OTBND_CART VIEW - OUTBOUND CARTON TABLE                 01800099
018100     EXEC SQL                                                     01810099
018200         INCLUDE SUT00024                                         01820099
018300     END-EXEC.                                                    01830099
018400* * * SUT_OTBND_LOC VIEW - OUTBOUND SHIPPING UNIT LOCATION TABLE  01840099
018500     EXEC SQL                                                     01850099
018600         INCLUDE SUT00027                                         01860099
018700     END-EXEC.                                                    01870099
018800* * * XLT_UPC VIEW                                                01880099
018900     EXEC SQL                                                     01890099
019000         INCLUDE XLT00006                                         01900099
019100     END-EXEC.                                                    01910099
019200* * * XLT_SKU VIEW                                                01920099
019300     EXEC SQL                                                     01930099
019400         INCLUDE XLT00003                                         01940099
019500     END-EXEC.                                                    01950099
019600* * * TSUOBTR VIEW - OUTBOUND TRAILER TRIP TABLE                  01960099
019700     EXEC SQL                                                     01970099
019800         INCLUDE TSUOBTR                                          01980099
019900     END-EXEC.                                                    01990099
020000* * * TSUOBTS VIEW - OUTBOUND TRAILER TRIP STATUS TABLE           02000099
020100     EXEC SQL                                                     02010099
020200         INCLUDE TSUOBTS                                          02020099
020300     END-EXEC.                                                    02030099
020400* * * TCNTRID VIEW - TRAILER ID TABLE                             02040099
020500     EXEC SQL                                                     02050099
020600         INCLUDE TCNTRID                                          02060099
020700     END-EXEC.                                                    02070099
020800* * * TSHIPMT VIEW - SHIPMENT TABLE                               02080099
020900     EXEC SQL                                                     02090099
021000         INCLUDE TSHIPMT                                          02100099
021100     END-EXEC.                                                    02110099
021200* * * TCNDCDR VIEW - DC TO DOOR ASSIGNMENT TABLE                  02120099
021300     EXEC SQL                                                     02130099
021400         INCLUDE TCNDCDR                                          02140099
021500     END-EXEC.                                                    02150099
021600* * * TPURCHS VIEW - PURCHASE HEADER TABLE                        02160099
021700     EXEC SQL                                                     02170099
021800         INCLUDE TPURCHS                                          02180099
021900     END-EXEC.                                                    02190099
022000* * * TWEBITM VIEW                                                02200099
022100     EXEC SQL                                                     02210099
022200         INCLUDE TWEBITM                                          02220099
022300     END-EXEC.                                                    02230099
022400* * * TSUCRDV VIEW - CARTON DIVERT FROM CONVEYOR SYSTEM TABLE     02240099
022500     EXEC SQL                                                     02250099
022600         INCLUDE TSUCRDV                                          02260099
022700     END-EXEC.                                                    02270099
022800* * * TSUCDOT VIEW - CARTON DIVERT / OUTBOUND TRIP ASSOCIATION    02280099
022900     EXEC SQL                                                     02290099
023000         INCLUDE TSUCDOT                                          02300099
023100     END-EXEC.                                                    02310099
023200* * * TCNDRST VIEW - DOOR TO STORE ASSOCIATION TABLE              02320099
023300     EXEC SQL                                                     02330099
023400         INCLUDE TCNDRST                                          02340099
023500     END-EXEC.                                                    02350099
023510* * * TKRPRPM - PARM TABLE                                        02351099
023520     EXEC SQL                                                     02352099
023530         INCLUDE TKRPRPM                                          02353099
023540     END-EXEC.                                                    02354099
023600                                                                  02360099
023610* * * XLT_VNDR_STYL TABLE                                         02361099
023620     EXEC SQL                                                     02362099
023630         INCLUDE XLT00004                                         02363099
023640     END-EXEC.                                                    02364099
023650                                                                  02365099
023700**DECLARE THE DETAIL_CSR                                          02370099
023800     EXEC SQL                                                     02380099
023900          DECLARE DETAIL-CSR CURSOR FOR                           02390099
024000           SELECT  DISTINCT                                       02400099
024100                   B.TRN_NBR                                      02410099
024200                 , B.RCVR_SEQ_NBR                                 02420099
024300                 , D.SKU_NBR                                      02430099
024400                 , C.INTR_UPC_ID                                  02440099
024500                 , B.SHPD_UNT_QTY                                 02450099
024600                 , B.TRN_LNE_NBR                                  02460099
024700           FROM    SUT_OTBND_CART A                               02470099
024800                 , SUT_OTBND_UPC  B                               02480099
024900                 , XLT_UPC        C                               02490099
025000                 , XLT_SKU        D                               02500099
025100           WHERE   A.SHIPT_UNT_ID   = :DK-SHPT-UNT-ID             02510099
025200           AND     C.INTR_UPC_ID    = D.INTR_UPC_ID               02520099
025300           AND     B.UPC_NBR        = C.UPC_NBR                   02530099
025400           AND     A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID              02540099
025500           AND     B.SHPD_UNT_QTY   > 0                           02550099
025600           AND     A.ACTV_IND       = 'Y'                         02560099
025700     END-EXEC.                                                    02570099
025800                                                                  02580099
025900                                                                  02590099
026000* * * VARIOUS CURSORS, SELECTS, AND WORKING STORAGE AREAS FOR     02600099
026100* * * RETRIEVING CARTONS                                          02610099
026200     COPY PCWS049.                                                02620099
026300     COPY PCWS050.                                                02630099
026400                                                                  02640099
026500****************************************************************  02650099
026600 LINKAGE SECTION.                                                 02660099
026700                                                                  02670099
026800 01  DFHCOMMAREA.                                                 02680099
026900     05  FILLER                       OCCURS  1 TO 4072 TIMES     02690099
027000                                      DEPENDING ON EIBCALEN.      02700099
027100         10 FILLER                    PIC X.                      02710099
027200                                                                  02720099
027300****************************************************************  02730099
027400/                                                                 02740099
027500                                                                  02750099
027600 PROCEDURE DIVISION.                                              02760099
027700                                                                  02770099
027800     MOVE LENGTH WS004-FIELDS    TO PV-COMMAREA-LENGTH.           02780099
027900                                                                  02790099
028000     EXEC CICS                                                    02800099
028100         RETRIEVE                                                 02810099
028200         INTO(WS004-FIELDS)                                       02820099
028300         LENGTH(PV-COMMAREA-LENGTH)                               02830099
028400         RESP(PV-CICS-RESP)                                       02840099
028500     END-EXEC.                                                    02850099
028600                                                                  02860099
028700     INITIALIZE PV-CICS-MSG-AREA.                                 02870099
028800     STRING   ' ' WS004-SRC-TASK-NUMBER                           02880099
028900              ' WSKCS304 CALLED FROM '                            02890099
029000              WS004-CALLING-PROGRAM-NAME                          02900099
029100              DELIMITED BY SIZE                                   02910099
029200                          INTO PV-CICS-MSG-AREA.                  02920099
029300     PERFORM 7000-WRITE-TO-CICS-LOG.                              02930099
029400                                                                  02940099
029500     IF PV-CICS-RESP = DFHRESP(NORMAL)                            02950099
029600         MOVE WS004-FIELDS  TO  WS-DISPLAY-WSWS004                02960099
029700         INITIALIZE  PV-CICS-MSG-AREA                             02970099
029800         STRING   ' ' WS004-SRC-TASK-NUMBER                       02980099
029900                    ' WSKCS304 '                                  02990099
030000                      WS-DISP-004-001-046                         03000099
030100                              DELIMITED BY SIZE                   03010099
030200                          INTO PV-CICS-MSG-AREA                   03020099
030300         PERFORM 7000-WRITE-TO-CICS-LOG                           03030099
030400         INITIALIZE  PV-CICS-MSG-AREA                             03040099
030500         STRING   ' ' WS004-SRC-TASK-NUMBER                       03050099
030600                    ' WSKCS304 '                                  03060099
030700                      WS-DISP-004-047-098                         03070099
030800                              DELIMITED BY SIZE                   03080099
030900                              INTO PV-CICS-MSG-AREA               03090099
031000         PERFORM 7000-WRITE-TO-CICS-LOG                           03100099
031100                                                                  03110099
031200         PERFORM 0500-INITIALIZE-PGM                              03120099
031300                                                                  03130099
031400         MOVE WS004-WMS-SHPT-ID    TO DK-SHIPT-ID                 03140099
031500         MOVE WS004-OTBND-TRIP-ID  TO DK-TRIP-ID                  03150099
031600                                      PC049-DK-OTBND-TRIP-ID      03160099
031610*                                                                 03161099
031620*** CHECK TO SEE IF THIS TRAILER IS ONE THAT IS BEING ROUTED FROM 03162099
031630*** A STORE TO A DC                                               03163099
031640*                                                                 03164099
031650         PERFORM 1700-CHECK-STR-TO-EFC-MOVE                       03165099
031652                                                                  03165299
031660*                                                                 03166099
031700         PERFORM 1010-GET-HDR-INFO                                03170099
031800         PERFORM 1020-GET-TRLR-INFO                               03180099
031900         PERFORM 1030-VRFY-DEST-KOHLS                             03190099
032000         PERFORM 5510-GET-DC-SHIPPED-INFO                         03200099
032100         PERFORM 2000-GET-TRLR-BOOKENDS                           03210099
032200         IF PS-DAT-LEVEL-DETAILS                                  03220099
032300           OR PS-DAT-LEVEL-HEADER                                 03230099
032400             PERFORM 8010-WRITE-DAT-CNTL                          03240099
032500                UNTIL PS-DAT-CNTL-DONE                            03250099
032600         END-IF                                                   03260099
032700         IF WS-DWNLD-TMST = PC-DEFAULT-NINES                      03270099
032800             PERFORM 1500-CREATE-APPT                             03280099
032900         END-IF                                                   03290099
033000         PERFORM 5500-CREATE-ASN-HDR                              03300099
033100                                                                  03310099
033200         IF PC049-DIVERT-CUTOFFS-NO                               03320099
033300             MOVE PC-DEFAULT-NINES        TO PC049-DK-START-TMST  03330099
033400             MOVE PC-DEFAULT-NINES        TO PC049-DK-END-TMST    03340099
033500         END-IF                                                   03350099
033600                                                                  03360099
033601*                                                                 03360199
033602*** REMOVE ANY STORE NUMBER IF DIVERTING STORE TRAILERS TO        03360299
033603*** AND EFC                                                       03360399
033604*** DMH 3/19/2020                                                 03360499
033605*                                                                 03360599
033606     IF  PS-STR-TO-EFC-YES                                        03360699
033607         MOVE  ZEROS        TO  PC049-PV-STORE-01                 03360799
033608                                PC049-PV-STORE-02                 03360899
033609                                PC049-PV-STORE-03                 03360999
033610                                PC049-PV-STORE-04                 03361099
033611     END-IF                                                       03361199
033612                                                                  03361299
033613                                                                  03361399
033614     IF PS-CICS-SWITCH-YES                                        03361499
033615         INITIALIZE  PV-CICS-MSG-AREA                             03361599
033616         STRING   ' ' WS004-SRC-TASK-NUMBER                       03361699
033617                  ' WSKCS304-OPEN-CSR '                           03361799
033618                  ' CSR:'                                         03361899
033619                  PC049-CURSOR-SWITCHES                           03361999
033620                  ' FROM:' PC049-DK-START-TMST                    03362099
033621                  ' END:'  PC049-DK-END-TMST                      03362199
033622                  DELIMITED BY SIZE                               03362299
033623             INTO PV-CICS-MSG-AREA                                03362399
033624         PERFORM 7000-WRITE-TO-CICS-LOG                           03362499
033625                                                                  03362599
033626         MOVE PC049-DK-OPER-UNT-ID   TO  PV-DISP-DC               03362699
033627         MOVE PC049-DK-OTBND-TRIP-ID TO  PV-DISP-TRIP             03362799
033628         MOVE PC049-PV-STORE-01      TO  PV-DISP-STR-1            03362899
033629         MOVE PC049-PV-STORE-02      TO  PV-DISP-STR-2            03362999
033630         MOVE PC049-PV-STORE-03      TO  PV-DISP-STR-3            03363099
033631         MOVE PC049-PV-STORE-04      TO  PV-DISP-STR-4            03363199
033632                                                                  03363299
033633         INITIALIZE  PV-CICS-MSG-AREA                             03363399
033634         STRING   ' ' WS004-SRC-TASK-NUMBER                       03363499
033635                  ' WSKCS304-OPEN-CSR '                           03363599
033636                  ' CSR:'                                         03363699
033637                  PC049-CURSOR-SWITCHES                           03363799
033638                  ' OPER:' PV-DISP-DC                             03363899
033639                  ' TRIP:' PV-DISP-TRIP                           03363999
033640                  DELIMITED BY SIZE                               03364099
033641             INTO PV-CICS-MSG-AREA                                03364199
033642         PERFORM 7000-WRITE-TO-CICS-LOG                           03364299
033643                                                                  03364399
033644         INITIALIZE  PV-CICS-MSG-AREA                             03364499
033645         STRING   ' ' WS004-SRC-TASK-NUMBER                       03364599
033646                  ' WSKCS304-OPEN-CSR '                           03364699
033647                  ' CSR:'                                         03364799
033648                  PC049-CURSOR-SWITCHES                           03364899
033649                  ' STR1:' PV-DISP-STR-1                          03364999
033650                  ' STR2:' PV-DISP-STR-2                          03365099
033651                  ' STR3:' PV-DISP-STR-3                          03365199
033652                  ' STR4:' PV-DISP-STR-4                          03365299
033653                  DELIMITED BY SIZE                               03365399
033654             INTO PV-CICS-MSG-AREA                                03365499
033655         PERFORM 7000-WRITE-TO-CICS-LOG                           03365599
033656     END-IF                                                       03365699
033657                                                                  03365799
033660                                                                  03366099
033700         EVALUATE TRUE                                            03370099
033800             WHEN WS-DOOR-TYP-CDE = 'DS'                          03380099
033900                 SET PC049-SHTL-TR-AL-CTN-CSR TO TRUE             03390099
034000                 PERFORM P7220-OPEN-SHTL-TR-AL-CTN-CSR            03400099
034100             WHEN WS-DOOR-TYP-CDE = 'SH'                          03410099
034200                 SET PC049-SHP-TR-ALL-CTN-CSR TO TRUE             03420099
034300                 PERFORM P7160-OPEN-SHP-TR-ALL-CTN-CSR            03430099
034400             WHEN OTHER                                           03440099
034500                 MOVE 'MAIN PROC'      TO DP013-PARAGRAPH         03450099
034600                 STRING 'INVALID DOOR TYPE CODE '                 03460099
034700                        WS-DOOR-TYP-CDE                           03470099
034800                        DELIMITED BY SIZE                         03480099
034900                                     INTO DP013-MESSAGE-TEXT(1)   03490099
035000                 STRING ' WMS-SHPT-ID='                           03500099
035100                        WS004-WMS-SHPT-ID                         03510099
035200                        DELIMITED BY SIZE                         03520099
035300                                     INTO DP013-MESSAGE-TEXT (2)  03530099
035400                 SET DP013-DB2-ABEND  TO TRUE                     03540099
035500                 PERFORM 9999-ABEND                               03550099
035600         END-EVALUATE                                             03560099
035700                                                                  03570099
035800         PERFORM UNTIL PC049-EOF-SHTL-TR-AL-CTN                   03580099
035900                    OR PC049-EOF-SHP-TR-ALL-CTN                   03590099
036000             PERFORM 3000-FETCH-CURSOR                            03600099
036100         END-PERFORM                                              03610099
036200                                                                  03620099
036300         EVALUATE TRUE                                            03630099
036400             WHEN PC049-SHTL-TR-AL-CTN-CSR                        03640099
036500                 PERFORM P7230-CLOSE-SHTL-TR-AL-CTN-CSR           03650099
036600             WHEN PC049-SHP-TR-ALL-CTN-CSR                        03660099
036700                 PERFORM P7170-CLOSE-SHP-TR-ALL-CTN-CSR           03670099
036800             WHEN OTHER                                           03680099
036900                 MOVE 'MAIN PROC'      TO DP013-PARAGRAPH         03690099
037000                 MOVE 'INVALID CURSOR TYPE '                      03700099
037100                                       TO DP013-MESSAGE-TEXT (1)  03710099
037200                 STRING ' WMS-SHPT-ID='                           03720099
037300                        WS004-WMS-SHPT-ID                         03730099
037400                        DELIMITED BY SIZE                         03740099
037500                                     INTO DP013-MESSAGE-TEXT (2)  03750099
037600                 SET DP013-DB2-ABEND  TO TRUE                     03760099
037700                 PERFORM 9999-ABEND                               03770099
037800         END-EVALUATE                                             03780099
037900                                                                  03790099
038000         PERFORM 9010-UPDATE-VER-NBR                              03800099
038100         PERFORM 9020-CALL-ASN-MODULE                             03810099
038200                                                                  03820099
038300     ELSE                                                         03830099
038400        INITIALIZE PV-CICS-MSG-AREA                               03840099
038500        STRING   ' ' WS004-SRC-TASK-NUMBER                        03850099
038600               ' WSKCS304 - INVALID RETREIVE OF COMMAREA'         03860099
038700            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA               03870099
038800        PERFORM 7000-WRITE-TO-CICS-LOG                            03880099
038900     END-IF.                                                      03890099
039000                                                                  03900099
039100     INITIALIZE PV-CICS-MSG-AREA.                                 03910099
039200     STRING   ' ' WS004-SRC-TASK-NUMBER                           03920099
039300              ' EXITING WSKCS304'                                 03930099
039400              DELIMITED BY SIZE                                   03940099
039500                          INTO PV-CICS-MSG-AREA.                  03950099
039600     PERFORM 7000-WRITE-TO-CICS-LOG.                              03960099
039700                                                                  03970099
039800     EXEC CICS                                                    03980099
039900         RETURN                                                   03990099
040000     END-EXEC.                                                    04000099
040100                                                                  04010099
040200/                                                                 04020099
040300 0500-INITIALIZE-PGM.                                             04030099
040400                                                                  04040099
040500     SET WS004-SUCCESSFUL        TO TRUE.                         04050099
040600     INITIALIZE DCLWST00001                                       04060099
040700                DCLWST00003                                       04070099
040800                DCLWST00004                                       04080099
040900                DCLWST00008                                       04090099
041000                DCLWST00009                                       04100099
041100                DCLWST00010                                       04110099
041200                DCLWST00011                                       04120099
041300                DCLWSV00000                                       04130099
041400                DCLSUT00028                                       04140099
041500                DCLSUT00024                                       04150099
041600                DCLSUT00027                                       04160099
041700                DCLXLT00006                                       04170099
041800                DCLXLT00003                                       04180099
041900                DCLTSUOBTR                                        04190099
042000                DCLTSUOBTS                                        04200099
042100                DCLTCNTRID                                        04210099
042200                DCLTCNDCDR                                        04220099
042300                DCLTPURCHS                                        04230099
042400                DCLTSUCRDV                                        04240099
042500                DCLTSUCDOT                                        04250099
042600                DCLTCNDRST                                        04260099
042700                DCLTWEBITM.                                       04270099
042800     INITIALIZE PV-VARIABLES.                                     04280099
042900     INITIALIZE PS-SWITCHES.                                      04290099
043000     MOVE 1 TO WS-ROW-CNT.                                        04300099
043100     MOVE 1 TO WS-GP-CNT.                                         04310099
043200                                                                  04320099
043300     PERFORM 0510-CICS-LOGGING.                                   04330099
043400     PERFORM 0520-REPOS-LOGGING.                                  04340099
043500     PERFORM 8030-GET-REPOS-TMST.                                 04350099
043510     PERFORM 0530-EFC-FXR-DWNLD.                                  04351099
043600                                                                  04360099
043700/                                                                 04370099
043800 0510-CICS-LOGGING.                                               04380099
043900* READ PARM TO DETERMINE CICS LOGGING                             04390099
044000                                                                  04400099
044100     EXEC SQL                                                     04410099
044200         SELECT  D.ATTR_ELEM_TXT                                  04420099
044300         INTO  :PS-CICS-SWITCH-IND                                04430099
044400         FROM   WST_INTGRTN_TYP A                                 04440099
044500              , WST_ATTR_DEFN   B                                 04450099
044600              , WST_ATTR_ELEM   C                                 04460099
044700              , WST_ATTR_ELEM   D                                 04470099
044800         WHERE  A.INTGRTN_TYP_CDE   = 'CSSLLOG'                   04480099
044900           AND  A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           04490099
045000           AND  B.ATTR_DEFN_SEQ_NBR = 1                           04500099
045100           AND  B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           04510099
045200           AND  C.ATTR_DEFN_SEQ_NBR = 1                           04520099
045300           AND  B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           04530099
045400           AND  D.ATTR_DEFN_SEQ_NBR = 2                           04540099
045500           AND  C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         04550099
045600           AND  C.ATTR_ELEM_TXT     = 'WSKCS304'                  04560099
045700     END-EXEC.                                                    04570099
045800                                                                  04580099
045900     EVALUATE TRUE                                                04590099
046000         WHEN SQLCODE = ZERO                                      04600099
046100             IF PS-CICS-SWITCH-YES                                04610099
046200                 INITIALIZE PV-CICS-MSG-AREA                      04620099
046300                 MOVE WS004-OPER-UNT-ID  TO WS-DISPLAY-OPER       04630099
046400                 STRING   ' ' WS004-SRC-TASK-NUMBER               04640099
046500                          ' WSKCS304-0510:'                       04650099
046600                          ' ' WS-DISPLAY-OPER                     04660099
046700                          ' ' WS004-USER-ID                       04670099
046800                          ' CICS LOGGING TURNED ON'               04680099
046900                          DELIMITED BY SIZE                       04690099
047000                          INTO PV-CICS-MSG-AREA                   04700099
047100                 PERFORM 7000-WRITE-TO-CICS-LOG                   04710099
047200             END-IF                                               04720099
047300         WHEN SQLCODE = -904                                      04730099
047400         WHEN SQLCODE = -913                                      04740099
047500         WHEN SQLCODE = -911                                      04750099
047600         WHEN SQLCODE = -803                                      04760099
047700             CONTINUE                                             04770099
047800         WHEN SQLWARN0 NOT = SPACES                               04780099
047900         WHEN SQLCODE NOT = ZERO                                  04790099
048000             INITIALIZE PV-CICS-MSG-AREA                          04800099
048100             MOVE SQLCODE              TO PV-SQL-RETURN-CD        04810099
048200             STRING   ' ' WS004-SRC-TASK-NUMBER                   04820099
048300                      ' WSKCS304-0510 ERROR:'                     04830099
048400                      ' SQL='                                     04840099
048500                      PV-SQL-RETURN-CD                            04850099
048600                      DELIMITED BY SIZE                           04860099
048700                      INTO PV-CICS-MSG-AREA                       04870099
048800             PERFORM 7000-WRITE-TO-CICS-LOG                       04880099
048900             MOVE '0510-CICS-LOGGING'  TO DP013-PARAGRAPH         04890099
049000             MOVE 'WST_INTGRTN_TYP'    TO                         04900099
049100                                       DP013-DB2-TABLE-NAME (1)   04910099
049200             MOVE 'WST_ATTR_DEFN'      TO                         04920099
049300                                       DP013-DB2-TABLE-NAME (2)   04930099
049400             MOVE 'WST_ATTR_ELEM'      TO                         04940099
049500                                       DP013-DB2-TABLE-NAME (3)   04950099
049600             MOVE SQLCA                TO DP013-SQLCA             04960099
049700             MOVE 'SELECT ATTR_ELEM_TXT'                          04970099
049800                                       TO DP013-MESSAGE-TEXT (1)  04980099
049900             SET DP013-DB2-ABEND  TO TRUE                         04990099
050000             PERFORM 9999-ABEND                                   05000099
050100     END-EVALUATE.                                                05010099
050200                                                                  05020099
050300/                                                                 05030099
050400 0520-REPOS-LOGGING.                                              05040099
050500* READ PARM TO DETERMINE REPOSITORY LOGGING LEVEL                 05050099
050600*         D = HEADER AND DETAILS                                  05060099
050700*         H = HEADER ONLY                                         05070099
050800*         N = NONE                                                05080099
050900                                                                  05090099
051000     EXEC SQL                                                     05100099
051100         SELECT B.ATTR_ELEM_TXT                                   05110099
051200         INTO   :PS-DAT-LEVEL                                     05120099
051300         FROM   WST_ATTR_ELEM B,                                  05130099
051400                WST_ATTR_DEFN C,                                  05140099
051500                WST_INTGRTN_TYP A                                 05150099
051600          WHERE A.APPL_FUNC_DESC    = 'REPOSITORY'                05160099
051700          AND   A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           05170099
051800          AND   A.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           05180099
051900          AND   C.ATTR_DEFN_SEQ_NBR = 1                           05190099
052000          AND   A.INTGRTN_TYP_CDE   = 'SHIPASN'                   05200099
052100     END-EXEC.                                                    05210099
052200                                                                  05220099
052300     EVALUATE TRUE                                                05230099
052400         WHEN SQLCODE = ZERO                                      05240099
052500             IF PS-CICS-SWITCH-YES                                05250099
052600                 INITIALIZE PV-CICS-MSG-AREA                      05260099
052700                 MOVE  WS004-OPER-UNT-ID  TO  WS-DISPLAY-OPER     05270099
052800                 STRING   ' ' WS004-SRC-TASK-NUMBER               05280099
052900                          ' WSKCS304-0520:'                       05290099
053000                          ' ' WS-DISPLAY-OPER                     05300099
053100                          ' ' WS004-USER-ID                       05310099
053200                          ' REPOSITORY LOGGING LEVEL '            05320099
053300                          PS-DAT-LEVEL                            05330099
053400                          DELIMITED BY SIZE                       05340099
053500                          INTO PV-CICS-MSG-AREA                   05350099
053600                 PERFORM 7000-WRITE-TO-CICS-LOG                   05360099
053700             END-IF                                               05370099
053800         WHEN SQLCODE = -904                                      05380099
053900         WHEN SQLCODE = -913                                      05390099
054000         WHEN SQLCODE = -911                                      05400099
054100         WHEN SQLCODE = -803                                      05410099
054200             CONTINUE                                             05420099
054300         WHEN SQLWARN0 NOT = SPACES                               05430099
054400         WHEN SQLCODE NOT = ZERO                                  05440099
054500             MOVE SQLCODE               TO PV-SQL-RETURN-CD       05450099
054600             INITIALIZE PV-CICS-MSG-AREA                          05460099
054700             STRING   ' ' WS004-SRC-TASK-NUMBER                   05470099
054800                      ' WSKCS304-0520 ERROR:'                     05480099
054900                      ' SQL='                                     05490099
055000                      PV-SQL-RETURN-CD                            05500099
055100                      DELIMITED BY SIZE                           05510099
055200                      INTO PV-CICS-MSG-AREA                       05520099
055300             PERFORM 7000-WRITE-TO-CICS-LOG                       05530099
055400             MOVE '0520-REPOS-LOGGING'                            05540099
055500                                       TO DP013-PARAGRAPH         05550099
055600             MOVE 'WST_INTGRTN_TYP'    TO                         05560099
055700                                       DP013-DB2-TABLE-NAME (1)   05570099
055800             MOVE 'WST_ATTR_DEFN'      TO                         05580099
055900                                       DP013-DB2-TABLE-NAME (2)   05590099
056000             MOVE 'WST_ATTR_ELEM'      TO                         05600099
056100                                       DP013-DB2-TABLE-NAME (3)   05610099
056200             MOVE SQLCA                TO DP013-SQLCA             05620099
056300             MOVE 'SELECT ATTR_ELEM_TXT'                          05630099
056400                                       TO DP013-MESSAGE-TEXT (1)  05640099
056500             SET DP013-DB2-ABEND       TO TRUE                    05650099
056600             PERFORM 9999-ABEND                                   05660099
056700     END-EVALUATE.                                                05670099
056800                                                                  05680099
056801                                                                  05680199
056802*----------------------------------------------------------------*05680299
056803* NEW PARM FXREFC TO SEE IF FAST TRANSFER CARTONS ARE TO BE SENT *05680399
056804* IN THE TRAILER MANIFEST THAT IS DOWNLOADED TO THE EFC WM       *05680499
056805*----------------------------------------------------------------*05680599
056810 0530-EFC-FXR-DWNLD.                                              05681099
056900                                                                  05690099
056901     SET  PS-SEND-FXR-TO-EFC-NO  TO  TRUE.                        05690199
056902     MOVE WS004-OPER-UNT-ID      TO  KRPRPM-LOC-ID.               05690299
056903                                                                  05690399
056904     EXEC SQL                                                     05690499
056905         SELECT FUNC_TXT                                          05690599
056906           INTO :PS-SEND-FXR-TO-EFC-SW                            05690699
056907           FROM TKRPRPM                                           05690799
056909          WHERE LOC_ID              = :KRPRPM-LOC-ID              05690999
056910            AND INTFC_SYS_CDE       = 'KHL'                       05691099
056911            AND SYS_PRC_FUNC_CDE    = 'EFCFXR'                    05691199
056912            AND FUNC_PRC_STAT_CDE   = 'AC'                        05691299
056913            AND FUNC_BEG_TMST      <= CURRENT TIMESTAMP           05691399
056914            AND FUNC_END_TMST      >= CURRENT TIMESTAMP           05691499
056918           WITH UR                                                05691899
056919     END-EXEC.                                                    05691999
056920                                                                  05692099
056921     EVALUATE TRUE                                                05692199
056922         WHEN SQLCODE = ZERO                                      05692299
056923             IF PS-CICS-SWITCH-YES                                05692399
056924                 INITIALIZE PV-CICS-MSG-AREA                      05692499
056925                 MOVE  WS004-OPER-UNT-ID  TO  WS-DISPLAY-OPER     05692599
056926                 STRING   ' ' WS004-SRC-TASK-NUMBER               05692699
056927                          ' WSKCS304-0530:'                       05692799
056928                          ' ' PS-SEND-FXR-TO-EFC-SW               05692899
056932                          DELIMITED BY SIZE                       05693299
056933                          INTO PV-CICS-MSG-AREA                   05693399
056934                 PERFORM 7000-WRITE-TO-CICS-LOG                   05693499
056935             END-IF                                               05693599
056936                                                                  05693699
056937         WHEN SQLCODE = +100                                      05693799
056938              SET PS-SEND-FXR-TO-EFC-YES TO  TRUE                 05693899
056939                                                                  05693999
056940              IF PS-CICS-SWITCH-YES                               05694099
056941                 INITIALIZE PV-CICS-MSG-AREA                      05694199
056942                 MOVE  WS004-OPER-UNT-ID  TO  WS-DISPLAY-OPER     05694299
056943                 STRING   ' ' WS004-SRC-TASK-NUMBER               05694399
056944                          ' WSKCS304-0530:  +100 '                05694499
056945                          ' ' PS-SEND-FXR-TO-EFC-SW               05694599
056946                          DELIMITED BY SIZE                       05694699
056947                          INTO PV-CICS-MSG-AREA                   05694799
056948                 PERFORM 7000-WRITE-TO-CICS-LOG                   05694899
056949              END-IF                                              05694999
056951                                                                  05695199
056952         WHEN SQLCODE = -904                                      05695299
056953         WHEN SQLCODE = -913                                      05695399
056954         WHEN SQLCODE = -911                                      05695499
056955         WHEN SQLCODE = -811                                      05695599
056956              SET PS-SEND-FXR-TO-EFC-NO  TO  TRUE                 05695699
056957                                                                  05695799
056958         WHEN SQLWARN0 NOT = SPACES                               05695899
056959         WHEN SQLCODE NOT = ZERO                                  05695999
056960             MOVE SQLCODE               TO PV-SQL-RETURN-CD       05696099
056961             INITIALIZE PV-CICS-MSG-AREA                          05696199
056962             STRING   ' ' WS004-SRC-TASK-NUMBER                   05696299
056963                      ' WSKCS304-0530 ERROR:'                     05696399
056964                      ' SQL='                                     05696499
056965                      PV-SQL-RETURN-CD                            05696599
056966                      DELIMITED BY SIZE                           05696699
056967                      INTO PV-CICS-MSG-AREA                       05696799
056968             PERFORM 7000-WRITE-TO-CICS-LOG                       05696899
056969             MOVE '0530-REPOS-LOGGING'                            05696999
056970                                       TO DP013-PARAGRAPH         05697099
056971             MOVE 'WST_INTGRTN_TYP'    TO                         05697199
056972                                       DP013-DB2-TABLE-NAME (1)   05697299
056973             MOVE 'WST_ATTR_DEFN'      TO                         05697399
056974                                       DP013-DB2-TABLE-NAME (2)   05697499
056975             MOVE 'WST_ATTR_ELEM'      TO                         05697599
056976                                       DP013-DB2-TABLE-NAME (3)   05697699
056977             MOVE SQLCA                TO DP013-SQLCA             05697799
056978             MOVE 'SELECT ATTR_ELEM_TXT'                          05697899
056979                                       TO DP013-MESSAGE-TEXT (1)  05697999
056980             SET DP013-DB2-ABEND       TO TRUE                    05698099
056981             PERFORM 9999-ABEND                                   05698199
056982     END-EVALUATE.                                                05698299
056990                                                                  05699099
057000 1010-GET-HDR-INFO.                                               05700099
057100                                                                  05710099
057200* GET THE WST_SHPMT_XREF_HDR RECORD.  IT SHOULD ALWAYS BE FOUND,  05720099
057300* BECAUSE THE CALLING PROGRAM CHECKS FOR IT AND IF IT DOESN'T     05730099
057400* EXIST, THEN IT IS CREATED.                                      05740099
057500                                                                  05750099
057600     EXEC SQL                                                     05760099
057700          SELECT CRE_TMST                                         05770099
057800               , CRE_USR_ID                                       05780099
057900               , DWNLD_TMST                                       05790099
058000               , VER_NBR                                          05800099
058100          INTO   :WST00001-CRE-TMST                               05810099
058200               , :WST00001-CRE-USR-ID                             05820099
058300               , :WST00001-DWNLD-TMST                             05830099
058400               , :WST00001-VER-NBR                                05840099
058500          FROM   WST_SHPMT_XREF_HDR                               05850099
058600          WHERE  EXT_SHP_ID   = :DK-SHIPT-ID                      05860099
058700     END-EXEC.                                                    05870099
058800                                                                  05880099
058900     EVALUATE TRUE                                                05890099
059000         WHEN SQLCODE = ZERO                                      05900099
059100             MOVE WST00001-CRE-TMST       TO WS-CRE-TMST          05910099
059200             MOVE WST00001-CRE-USR-ID     TO WS-CRE-USR-ID        05920099
059300             MOVE WST00001-DWNLD-TMST     TO WS-DWNLD-TMST        05930099
059400             MOVE WST00001-VER-NBR        TO WS-HOST-INPT-NUM     05940099
059500             IF PS-CICS-SWITCH-YES                                05950099
059600                 MOVE DK-SHIPT-ID         TO WS-DISPLAY-SHIPMT    05960099
059700                 INITIALIZE PV-CICS-MSG-AREA                      05970099
059800                 STRING   ' ' WS004-SRC-TASK-NUMBER               05980099
059900                          ' WSKCS304-1010:'                       05990099
060000                          ' SHPMT='     WS-DISPLAY-SHIPMT         06000099
060100                          ' CRE TMST='  WST00001-CRE-TMST         06010099
060200                          ' USRID=' WST00001-CRE-USR-ID           06020099
060300                          DELIMITED BY SIZE                       06030099
060400                          INTO PV-CICS-MSG-AREA                   06040099
060500                 PERFORM 7000-WRITE-TO-CICS-LOG                   06050099
060600             END-IF                                               06060099
060700         WHEN SQLCODE = -904                                      06070099
060800         WHEN SQLCODE = -913                                      06080099
060900         WHEN SQLCODE = -911                                      06090099
061000              CONTINUE                                            06100099
061100         WHEN SQLWARN0 NOT = SPACES                               06110099
061200         WHEN SQLCODE NOT = ZERO                                  06120099
061300             MOVE SQLCODE               TO PV-SQL-RETURN-CD       06130099
061400             INITIALIZE PV-CICS-MSG-AREA                          06140099
061500             STRING   ' ' WS004-SRC-TASK-NUMBER                   06150099
061600                      ' WSKCS304-1010 ERROR:'                     06160099
061700                      ' SQL='                                     06170099
061800                      PV-SQL-RETURN-CD                            06180099
061900                      DELIMITED BY SIZE                           06190099
062000                      INTO PV-CICS-MSG-AREA                       06200099
062100             PERFORM 7000-WRITE-TO-CICS-LOG                       06210099
062200             MOVE '1010-GET-HDR-INFO'                             06220099
062300                                       TO DP013-PARAGRAPH         06230099
062400             MOVE 'WST_SHPMT_XREF_HDR' TO                         06240099
062500                                       DP013-DB2-TABLE-NAME (1)   06250099
062600             MOVE SQLCA                TO DP013-SQLCA             06260099
062700             STRING 'SHPMT=' DK-SHIPT-ID                          06270099
062800                      DELIMITED BY SIZE                           06280099
062900                                     INTO DP013-MESSAGE-TEXT (1)  06290099
063000             SET DP013-DB2-ABEND       TO TRUE                    06300099
063100             PERFORM 9999-ABEND                                   06310099
063200     END-EVALUATE.                                                06320099
063300                                                                  06330099
063400/                                                                 06340099
063500 1020-GET-TRLR-INFO.                                              06350099
063600                                                                  06360099
063700* INC000001815333 - GET THE DC DOOR TYPE FROM TSUOBTR INSTEAD     06370099
063800* OF TCNDCDR.  TCNDCDR CONTAINS THE DC DOOR'S CURRENT TYPE (THEY  06380099
063810* CHANGE THE DOOR TYPE AT WILL BASED ON NEED) AND TSUOBTR         06381099
063820* CONTAINS THE DOOR'S TYPE AS IT WAS AT THE TIME THE TRALER WAS   06382099
063830* WAS MANIFESTED.  LINES ARE PREFIXED WITH "HOEFS1".              06383099
063840* MARJ HOEFS  8/24/2011                                           06384099
063850                                                                  06385099
063860     EXEC SQL                                                     06386099
063870         SELECT  B.SHIP_SCAC_CDE                                  06387099
063880                ,C.TRLR_ID                                        06388099
063890                ,A.DOOR_TYP_CDE                                   06389099
063900                ,A.ORGN_OPER_UNT_ID                               06390099
064000                ,A.DEST_OPER_UNT_ID                               06400099
064100                ,B.DOOR_ID                                        06410099
064200                ,B.TRLR_SEAL_ID                                   06420099
064300                ,C.SCAC_CDE                                       06430099
064400         INTO  :SUOBTS-SHIP-SCAC-CDE                              06440099
064500              ,:CNTRID-TRLR-ID                                    06450099
064600              ,:SUOBTR-DOOR-TYP-CDE                               06460099
064700              ,:SUOBTR-ORGN-OPER-UNT-ID                           06470099
064800              ,:SUOBTR-DEST-OPER-UNT-ID                           06480099
064900              ,:SUOBTS-DOOR-ID                                    06490099
065000              ,:SUOBTS-TRLR-SEAL-ID                               06500099
065100              ,:CNTRID-SCAC-CDE                                   06510099
065200         FROM   TSUOBTR A                                         06520099
065300              , TSUOBTS B                                         06530099
065400              , TCNTRID C                                         06540099
065500         WHERE  A.OTBND_TRIP_ID    = :DK-TRIP-ID                  06550099
065600           AND  A.TRIP_ACTV_CDE    = 'A'                          06560099
065700           AND  A.OTBND_TRIP_ID    = B.OTBND_TRIP_ID              06570099
065800           AND  A.TRLR_SRL_NBR     = C.TRLR_SRL_NBR               06580099
065900           AND  OTBND_STAT_TMST =                                 06590099
066000                     (SELECT MAX(E.OTBND_STAT_TMST)               06600099
066100                     FROM TSUOBTS E                               06610099
066200                     WHERE B.OTBND_TRIP_ID  =  E.OTBND_TRIP_ID)   06620099
066300     END-EXEC.                                                    06630099
066400                                                                  06640099
066500     EVALUATE TRUE                                                06650099
066600         WHEN SQLCODE = ZERO                                      06660099
066700             MOVE SUOBTR-DOOR-TYP-CDE  TO WS-DOOR-TYP-CDE         06670099
066800             MOVE SUOBTS-SHIP-SCAC-CDE TO WS-SHIP-SCAC-CDE        06680099
066900             MOVE CNTRID-TRLR-ID       TO WS-TRLR-ID              06690099
067000             MOVE SUOBTR-ORGN-OPER-UNT-ID TO DK-OPER-UNT-ID       06700099
067100                                          PC049-DK-OPER-UNT-ID    06710099
067200             MOVE SUOBTR-DEST-OPER-UNT-ID TO                      06720099
067300                                          DK-DEST-OPER-UNT-ID     06730099
067400                                          PC049-DK-TRLR-DEST      06740099
067500             MOVE SUOBTS-DOOR-ID TO PC049-DK-DOOR-ID              06750099
067600             MOVE SUOBTS-TRLR-SEAL-ID  TO WS-TRLR-SEAL-ID         06760099
067700             MOVE CNTRID-SCAC-CDE      TO WS-SCAC-CDE             06770099
067800             IF PS-CICS-SWITCH-YES                                06780099
067900                 INITIALIZE  PV-CICS-MSG-AREA                     06790099
068000                 STRING   ' ' WS004-SRC-TASK-NUMBER               06800099
068100                          ' WSKCS304-1020:'                       06810099
068200                          ' DOOR=' WS-DOOR-TYP-CDE                06820099
068300                          ' SCAC=' WS-SCAC-CDE                    06830099
068400                          ' TRLR=' WS-TRLR-ID                     06840099
068500                          DELIMITED BY SIZE                       06850099
068600                          INTO PV-CICS-MSG-AREA                   06860099
068700                 PERFORM 7000-WRITE-TO-CICS-LOG                   06870099
068800             END-IF                                               06880099
068900                                                                  06890099
069000         WHEN SQLCODE = -904                                      06900099
069100         WHEN SQLCODE = -913                                      06910099
069200         WHEN SQLCODE = -911                                      06920099
069300             CONTINUE                                             06930099
069400         WHEN SQLWARN0 NOT = SPACES                               06940099
069500         WHEN SQLCODE NOT = ZERO                                  06950099
069600             MOVE SQLCODE               TO PV-SQL-RETURN-CD       06960099
069700             INITIALIZE PV-CICS-MSG-AREA                          06970099
069800             STRING   ' ' WS004-SRC-TASK-NUMBER                   06980099
069900                      ' WSKCS304-1020 ERROR:'                     06990099
070000                      ' SQL='                                     07000099
070100                      PV-SQL-RETURN-CD                            07010099
070200                      DELIMITED BY SIZE                           07020099
070300                      INTO PV-CICS-MSG-AREA                       07030099
070400             PERFORM 7000-WRITE-TO-CICS-LOG                       07040099
070500             MOVE '1020-GET-TRLR-INFO'                            07050099
070600                                       TO DP013-PARAGRAPH         07060099
070700             MOVE 'TSUOBTR'            TO                         07070099
070800                                       DP013-DB2-TABLE-NAME (1)   07080099
070900             MOVE 'TSUOBTS'            TO                         07090099
071000                                       DP013-DB2-TABLE-NAME (2)   07100099
071100             MOVE 'TCNTRID'            TO                         07110099
071200                                       DP013-DB2-TABLE-NAME (3)   07120099
071300             MOVE 'TCNDCDR'            TO                         07130099
071400                                       DP013-DB2-TABLE-NAME (4)   07140099
071500             MOVE SQLCA                TO DP013-SQLCA             07150099
071600             MOVE DK-TRIP-ID           TO WS-DISPLAY-1            07160099
071700             STRING 'TRIP ID=' WS-DISPLAY-1                       07170099
071800                      DELIMITED BY SIZE                           07180099
071900                                     INTO DP013-MESSAGE-TEXT (1)  07190099
072000             SET DP013-DB2-ABEND       TO TRUE                    07200099
072100             PERFORM 9999-ABEND                                   07210099
072200     END-EVALUATE.                                                07220099
072300                                                                  07230099
072400/                                                                 07240099
072500 1030-VRFY-DEST-KOHLS.                                            07250099
072600                                                                  07260099
072700* CHECK TO SEE IF THE DESTINATION MATCHES A KOHLS LOCATION        07270099
072800* NUMBER, IF FOUND, THEN USE IT.  IF NOT FOUND, CHECK WMOS.       07280099
072900                                                                  07290099
073000     EXEC SQL                                                     07300099
073100         SELECT  KOHLS_LOC_NBR                                    07310099
073200         INTO  :WSV00000-KOHLS-LOC-NBR                            07320099
073300         FROM   WSV_LOC_XREF                                      07330099
073400         WHERE  INTGRTN_TYP_CDE    = 'LOCXREF'                    07340099
073500           AND  KOHLS_LOC_NBR      = :DK-DEST-OPER-UNT-ID         07350099
073600           AND  EFF_BEG_DTE       <= :PV-REPOS-TIMESTAMP          07360099
073700           AND  EFF_END_DTE       >= :PV-REPOS-TIMESTAMP          07370099
073800           AND  ACTV_IND           = 'Y'                          07380099
073900     END-EXEC.                                                    07390099
074000                                                                  07400099
074100     EVALUATE TRUE                                                07410099
074200         WHEN SQLCODE = ZERO                                      07420099
074300             MOVE DK-DEST-OPER-UNT-ID    TO WS-DEST-OPER-UNT-ID   07430099
074400             IF PS-CICS-SWITCH-YES                                07440099
074500                 INITIALIZE  PV-CICS-MSG-AREA                     07450099
074600                 STRING   ' ' WS004-SRC-TASK-NUMBER               07460099
074700                          ' WSKCS304-1030:'                       07470099
074800                          ' WHSE=' WS-DEST-OPER-UNT-ID            07480099
074900                          DELIMITED BY SIZE                       07490099
075000                                       INTO PV-CICS-MSG-AREA      07500099
075100                 PERFORM 7000-WRITE-TO-CICS-LOG                   07510099
075200             END-IF                                               07520099
075300                                                                  07530099
075400         WHEN SQLCODE = +100                                      07540099
075500             MOVE DK-DEST-OPER-UNT-ID    TO WS-DEST-ID            07550099
075600             MOVE WS-DEST-ID-CHAR        TO DK-DEST-ID            07560099
075700             PERFORM 1040-VRFY-DEST-WMOS                          07570099
075800         WHEN SQLCODE = -904                                      07580099
075900         WHEN SQLCODE = -913                                      07590099
076000         WHEN SQLCODE = -911                                      07600099
076100             CONTINUE                                             07610099
076200         WHEN SQLWARN0 NOT = SPACES                               07620099
076300         WHEN SQLCODE NOT = ZERO                                  07630099
076400             MOVE SQLCODE               TO PV-SQL-RETURN-CD       07640099
076500             INITIALIZE PV-CICS-MSG-AREA                          07650099
076600             STRING   ' ' WS004-SRC-TASK-NUMBER                   07660099
076700                      ' WSKCS304-1030 ERROR:'                     07670099
076800                      ' SQL='                                     07680099
076900                      PV-SQL-RETURN-CD                            07690099
077000                      DELIMITED BY SIZE                           07700099
077100                      INTO PV-CICS-MSG-AREA                       07710099
077200             PERFORM 7000-WRITE-TO-CICS-LOG                       07720099
077300             MOVE '1030-VRFY-DEST-KOHLS'                          07730099
077400                                       TO DP013-PARAGRAPH         07740099
077500             MOVE 'WSV_LOC_XREF'       TO                         07750099
077600                                       DP013-DB2-TABLE-NAME (1)   07760099
077700             MOVE SQLCA                TO DP013-SQLCA             07770099
077800             MOVE DK-DEST-OPER-UNT-ID  TO WS-DISPLAY-6            07780099
077900             STRING 'DEST=' WS-DISPLAY-6                          07790099
078000                      DELIMITED BY SIZE                           07800099
078100                                     INTO DP013-MESSAGE-TEXT (1)  07810099
078200             SET DP013-DB2-ABEND       TO TRUE                    07820099
078300             PERFORM 9999-ABEND                                   07830099
078400     END-EVALUATE.                                                07840099
078500                                                                  07850099
078600/                                                                 07860099
078700 1040-VRFY-DEST-WMOS.                                             07870099
078800                                                                  07880099
078900* CHECK TO SEE IF THE DESTINATION MATCHES A WMOS LOCATION         07890099
079000* NUMBER, IF FOUND, THEN USE THE KOHLS_LOC_NBR, ELSE ERROR.       07900099
079100                                                                  07910099
079200     EXEC SQL                                                     07920099
079300         SELECT  KOHLS_LOC_NBR                                    07930099
079400         INTO  :WSV00000-KOHLS-LOC-NBR                            07940099
079500         FROM   WSV_LOC_XREF                                      07950099
079600         WHERE  INTGRTN_TYP_CDE    = 'LOCXREF'                    07960099
079700           AND  WMOS_LOC_NBR       = :DK-DEST-ID                  07970099
079800           AND  EFF_BEG_DTE       <= :PV-REPOS-TIMESTAMP          07980099
079900           AND  EFF_END_DTE       >= :PV-REPOS-TIMESTAMP          07990099
080000           AND  ACTV_IND           = 'Y'                          08000099
080100     END-EXEC.                                                    08010099
080200                                                                  08020099
080300     EVALUATE TRUE                                                08030099
080400         WHEN SQLCODE = ZERO                                      08040099
080500             MOVE '0'                    TO WS-WHSE-ZERO          08050099
080600             MOVE WSV00000-KOHLS-LOC-NBR TO WS-WHSE-DATA          08060099
080700             MOVE WS-WHSE-CDE            TO WS-DEST-OPER-UNT-ID   08070099
080800             IF PS-CICS-SWITCH-YES                                08080099
080900                 INITIALIZE  PV-CICS-MSG-AREA                     08090099
081000                 STRING   ' ' WS004-SRC-TASK-NUMBER               08100099
081100                          ' WSKCS304-1040:'                       08110099
081200                          ' WHSE=' WS-DEST-OPER-UNT-ID            08120099
081300                          DELIMITED BY SIZE                       08130099
081400                                       INTO PV-CICS-MSG-AREA      08140099
081500                 PERFORM 7000-WRITE-TO-CICS-LOG                   08150099
081600             END-IF                                               08160099
081700                                                                  08170099
081800         WHEN SQLCODE = -904                                      08180099
081900         WHEN SQLCODE = -913                                      08190099
082000         WHEN SQLCODE = -911                                      08200099
082100             CONTINUE                                             08210099
082200         WHEN SQLWARN0 NOT = SPACES                               08220099
082300         WHEN SQLCODE NOT = ZERO                                  08230099
082400             MOVE SQLCODE               TO PV-SQL-RETURN-CD       08240099
082500             INITIALIZE PV-CICS-MSG-AREA                          08250099
082600             STRING   ' ' WS004-SRC-TASK-NUMBER                   08260099
082700                      ' WSKCS304-1040 ERROR:'                     08270099
082800                      ' SQL='                                     08280099
082900                      PV-SQL-RETURN-CD                            08290099
083000                      DELIMITED BY SIZE                           08300099
083100                      INTO PV-CICS-MSG-AREA                       08310099
083200             PERFORM 7000-WRITE-TO-CICS-LOG                       08320099
083300             MOVE '1040-VRFY-DEST-WMOS'                           08330099
083400                                       TO DP013-PARAGRAPH         08340099
083500             MOVE 'WSV_LOC_XREF'       TO                         08350099
083600                                       DP013-DB2-TABLE-NAME (1)   08360099
083700             MOVE SQLCA                TO DP013-SQLCA             08370099
083800             MOVE DK-DEST-OPER-UNT-ID  TO WS-DISPLAY-6            08380099
083900             STRING 'WHSE NOT FOUND FOR DEST=' WS-DISPLAY-6       08390099
084000                      DELIMITED BY SIZE                           08400099
084100                                     INTO DP013-MESSAGE-TEXT (1)  08410099
084200             SET DP013-DB2-ABEND       TO TRUE                    08420099
084300             PERFORM 9999-ABEND                                   08430099
084400     END-EVALUATE.                                                08440099
084500                                                                  08450099
084600/                                                                 08460099
084700 1500-CREATE-APPT.                                                08470099
084800                                                                  08480099
084900     PERFORM 1510-LOAD-APPT.                                      08490099
085000                                                                  08500099
085100     IF PS-DAT-LEVEL-DETAILS                                      08510099
085200         MOVE 'ASN WSRD008'      TO WS-PRC-TYP-CDE                08520099
085300         MOVE 300                TO WS-DAT-TXT-LEN                08530099
085400         MOVE WS008-APPOINTMENT-REC TO WS-DAT-TXT-TEXT            08540099
085500         PERFORM 8020-WRITE-DAT-XFER                              08550099
085600     END-IF.                                                      08560099
085700                                                                  08570099
085800     ADD 1 TO WS-ROW-CNT.                                         08580099
085900     ADD 1 TO WS-GP-CNT.                                          08590099
086000                                                                  08600099
086100/                                                                 08610099
086200 1510-LOAD-APPT.                                                  08620099
086300                                                                  08630099
086400     INITIALIZE WS008-APPOINTMENT-REC.                            08640099
086500     SET WS008-AP-ADD             TO TRUE.                        08650099
086600     SET WS008-AP-APPOINTMT       TO TRUE.                        08660099
086700     MOVE WS-CRE-USR-ID           TO WS008-AP-CREATE-USERID.      08670099
086800     MOVE WS-CRE-TMST             TO WS008-AP-CREATE-TMST.        08680099
086900     MOVE DK-SHIPT-ID             TO WS008-AP-SHIPMT-NBR.         08690099
087000     MOVE WS-DEST-OPER-UNT-ID     TO WS008-AP-WHSE.               08700099
087100     MOVE WS-SHIP-DATE            TO WS008-AP-EXPCT-STRT-DT-TM.   08710099
087200     SET WS008-AP-NO-PRIORITY     TO TRUE.                        08720099
087300     MOVE WS-SCAC-CDE             TO WS008-AP-SCAC.               08730099
087400     MOVE WS-TRLR-ID              TO WS008-AP-TRLR-NBR.           08740099
087500     MOVE SPACES                  TO WS008-AP-BOL.                08750099
087600     MOVE SPACES                  TO WS008-AP-PRO-NBR.            08760099
087700     SET WS008-AP-INS-UPD         TO TRUE.                        08770099
087800     MOVE WS-TRLR-SEAL-ID         TO WS008-AP-SEAL-NBR.           08780099
087900                                                                  08790099
088000     MOVE DK-SHIPT-ID             TO WST00011-EXT-SHP-ID.         08800099
088100     MOVE PV-REPOS-TIMESTAMP      TO WST00011-CRE-TMST.           08810099
088200     MOVE WS-ROW-CNT              TO WST00011-ROW-NBR.            08820099
088300     MOVE WS-GP-CNT               TO WST00011-REC-TYP-GP-NBR.     08830099
088400     MOVE 'AP'                    TO WST00011-REC-TYP-CDE.        08840099
088500     MOVE PC-HIGH-NINES           TO WST00011-CSE-DTL-NBR.        08850099
088600     MOVE 300                     TO WST00011-REC-TYP-DESC-LEN.   08860099
088700     MOVE WS008-APPOINTMENT-REC   TO WST00011-REC-TYP-DESC-TEXT.  08870099
088800                                                                  08880099
088900     PERFORM 9000-INSERT-TEMP-TABLE.                              08890099
089000                                                                  08900099
089001                                                                  08900199
089002******************************************************************08900299
089003* CHECK TO SEE IF THIS IS A STORE SHIPPING TRAILER BEING ROUTED  *08900399
089004* TO AN EFC.                                                     *08900499
089005* DMH - 3/19/2020                                                *08900599
089006******************************************************************08900699
089010 1700-CHECK-STR-TO-EFC-MOVE.                                      08901099
089020                                                                  08902099
089100     SET  PS-STR-TO-EFC-NO                                        08910099
089110          PS-STR-TO-EFC-PO-CK-NO  TO  TRUE.                       08911099
089111                                                                  08911199
089112     MOVE  ZEROES  TO  PV-STR-TO-EFC-DC-NBR                       08911299
089113                       PV-STR-TO-EFC-TRIP-ID                      08911399
089114                       PV-STR-TO-EFC-ORIG-STR                     08911499
089115                       PV-STR-TO-EFC-EFC-NBR                      08911599
089116                       PV-STR-TO-EFC-EFC-STR.                     08911699
089117                                                                  08911799
089118     MOVE  DK-TRIP-ID  TO  PV-STR-TO-EFC-TRIP-ID.                 08911899
089119                                                                  08911999
089120     EXEC SQL                                                     08912099
089121         SELECT                                                   08912199
089122                 C.ATTR_ELEM_NBR                                  08912299
089123              ,  D.ATTR_ELEM_NBR                                  08912399
089124              ,  E.ATTR_ELEM_NBR                                  08912499
089125              ,  F.ATTR_ELEM_NBR                                  08912599
089126              ,  G.ATTR_ELEM_NBR                                  08912699
089127              ,  H.ATTR_ELEM_TXT                                  08912799
089128              ,  I.ATTR_ELEM_TXT                                  08912899
089129           INTO                                                   08912999
089130                :PV-STR-TO-EFC-DC-NBR                             08913099
089131              , :PV-STR-TO-EFC-TRIP-ID                            08913199
089132              , :PV-STR-TO-EFC-ORIG-STR                           08913299
089133              , :PV-STR-TO-EFC-EFC-NBR                            08913399
089134              , :PV-STR-TO-EFC-EFC-STR                            08913499
089135              , :PS-STR-TO-EFC-PO-CK-SW                           08913599
089136              , :PS-STR-TO-EFC-SW                                 08913699
089137         FROM                                                     08913799
089138                WST_INTGRTN_TYP A                                 08913899
089139              , WST_ATTR_DEFN   B                                 08913999
089140              , WST_ATTR_ELEM   C                                 08914099
089141              , WST_ATTR_ELEM   D                                 08914199
089142              , WST_ATTR_ELEM   E                                 08914299
089143              , WST_ATTR_ELEM   F                                 08914399
089144              , WST_ATTR_ELEM   G                                 08914499
089145              , WST_ATTR_ELEM   H                                 08914599
089146              , WST_ATTR_ELEM   I                                 08914699
089147         WHERE                                                    08914799
089148               A.INTGRTN_TYP_CDE   = 'STRMOVEEFC'                 08914899
089149           AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE            08914999
089150           AND B.ATTR_DEFN_SEQ_NBR = 1                            08915099
089151           AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE            08915199
089152           AND C.ATTR_DEFN_SEQ_NBR = 1                            08915299
089153           AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE            08915399
089154           AND D.ATTR_DEFN_SEQ_NBR = 2                            08915499
089155           AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE            08915599
089156           AND E.ATTR_DEFN_SEQ_NBR = 3                            08915699
089157           AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE            08915799
089158           AND F.ATTR_DEFN_SEQ_NBR = 4                            08915899
089159           AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE            08915999
089160           AND G.ATTR_DEFN_SEQ_NBR = 5                            08916099
089161           AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE            08916199
089162           AND H.ATTR_DEFN_SEQ_NBR = 6                            08916299
089163           AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE            08916399
089164           AND I.ATTR_DEFN_SEQ_NBR = 7                            08916499
089165           AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR          08916599
089166           AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR          08916699
089167           AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR          08916799
089168           AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR          08916899
089169           AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR          08916999
089170           AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR          08917099
089171           AND D.ATTR_ELEM_NBR     = :DK-TRIP-ID                  08917199
089172           AND I.ATTR_ELEM_TXT     = 'Y'                          08917299
089174     END-EXEC.                                                    08917499
089175                                                                  08917599
089176     EVALUATE TRUE                                                08917699
089177         WHEN SQLCODE = ZERO                                      08917799
089178              MOVE PV-STR-TO-EFC-DC-NBR   TO PV-DISP-STE-DC       08917899
089179              MOVE PV-STR-TO-EFC-TRIP-ID  TO PV-DISP-STE-TRIP     08917999
089180              MOVE PV-STR-TO-EFC-ORIG-STR TO PV-DISP-STE-STR      08918099
089181              MOVE PV-STR-TO-EFC-EFC-NBR  TO PV-DISP-STE-EFC      08918199
089182              MOVE PV-STR-TO-EFC-EFC-STR  TO PV-DISP-STE-E-STR    08918299
089183                                                                  08918399
089184              INITIALIZE PV-CICS-MSG-AREA                         08918499
089186              STRING   ' ' WS004-SRC-TASK-NUMBER                  08918699
089187                         ' WSKCS304-1700  STORE-TO-EFC:'          08918799
089188                         '  DC:'    PV-DISP-STE-DC                08918899
089189                         '  TRIP:'  PV-DISP-STE-TRIP              08918999
089190                         '  STR:'   PV-DISP-STE-STR               08919099
089191                         '  EFC:'   PV-DISP-STE-EFC               08919199
089192                         '  E-STR:' PV-DISP-STE-E-STR             08919299
089196                               DELIMITED BY SIZE                  08919699
089197                          INTO PV-CICS-MSG-AREA                   08919799
089198                 PERFORM 7000-WRITE-TO-CICS-LOG                   08919899
089199                                                                  08919999
089200         WHEN SQLCODE = +100                                      08920099
089201              MOVE DK-TRIP-ID   TO  PV-DISP-TRIP                  08920199
089202              INITIALIZE PV-CICS-MSG-AREA                         08920299
089204              STRING   ' ' WS004-SRC-TASK-NUMBER                  08920499
089205                       ' WSKCS304-1700 '                          08920599
089207                       'EFC TRIP - NOT A STORE REROUTE TRIP '     08920799
089208                        PV-DISP-TRIP                              08920899
089209                      DELIMITED BY SIZE                           08920999
089210                      INTO PV-CICS-MSG-AREA                       08921099
089211              PERFORM 7000-WRITE-TO-CICS-LOG                      08921199
089212              CONTINUE                                            08921299
089213                                                                  08921399
089214         WHEN SQLCODE = -904                                      08921499
089215         WHEN SQLCODE = -913                                      08921599
089216         WHEN SQLCODE = -911                                      08921699
089217         WHEN SQLCODE = -803                                      08921799
089218             CONTINUE                                             08921899
089219         WHEN SQLWARN0 NOT = SPACES                               08921999
089220         WHEN SQLCODE NOT = ZERO                                  08922099
089221             INITIALIZE PV-CICS-MSG-AREA                          08922199
089222             MOVE SQLCODE              TO PV-SQL-RETURN-CD        08922299
089223             MOVE PV-STR-TO-EFC-TRIP-ID  TO PV-DISP-STE-TRIP      08922399
089224             STRING   ' ' WS004-SRC-TASK-NUMBER                   08922499
089225                      ' WSKCS304-1700 ERROR:'                     08922599
089226                      ' SQL='    PV-SQL-RETURN-CD                 08922699
089227                      ' TRIP:'   PV-DISP-STE-TRIP                 08922799
089228                      DELIMITED BY SIZE                           08922899
089229                      INTO PV-CICS-MSG-AREA                       08922999
089230             PERFORM 7000-WRITE-TO-CICS-LOG                       08923099
089231             MOVE '1700-CHECK-STR-TO-EFC-MOVE'                    08923199
089232                                       TO DP013-PARAGRAPH         08923299
089233             MOVE 'WST_INTGRTN_TYP'    TO                         08923399
089234                                       DP013-DB2-TABLE-NAME (1)   08923499
089235             MOVE 'WST_ATTR_DEFN'      TO                         08923599
089236                                       DP013-DB2-TABLE-NAME (2)   08923699
089237             MOVE 'WST_ATTR_ELEM'      TO                         08923799
089238                                       DP013-DB2-TABLE-NAME (3)   08923899
089239             MOVE SQLCA                TO DP013-SQLCA             08923999
089240             MOVE 'SELECT ATTR_ELEM_TXT'                          08924099
089241                                       TO DP013-MESSAGE-TEXT (1)  08924199
089242             SET DP013-DB2-ABEND  TO TRUE                         08924299
089243             PERFORM 9999-ABEND                                   08924399
089244     END-EVALUATE.                                                08924499
089245                                                                  08924599
089246                                                                  08924699
089247                                                                  08924799
089248******************************************************************08924899
089249*                                                                *08924999
089250*                                                                *08925099
089251*                                                                *08925199
089252******************************************************************08925299
089260 2000-GET-TRLR-BOOKENDS.                                          08926099
089300                                                                  08930099
089400     PERFORM P4000-STRT-END-DVRT.                                 08940099
089500     PERFORM P3000-DOOR-STR-CSR.                                  08950099
089600                                                                  08960099
089632                                                                  08963299
089700/                                                                 08970099
089800 3000-FETCH-CURSOR.                                               08980099
089900                                                                  08990099
090000     EVALUATE TRUE                                                09000099
090100         WHEN PC049-SHTL-TR-AL-CTN-CSR                            09010099
090200             PERFORM P7225-FETCH-SHTL-TR-AL-CTN-CSR               09020099
090300         WHEN PC049-SHP-TR-ALL-CTN-CSR                            09030099
090400             PERFORM P7165-FETCH-SHP-TR-ALL-CTN-CSR               09040099
090500         WHEN OTHER                                               09050099
090600                                                                  09060099
090700             INITIALIZE PV-CICS-MSG-AREA                          09070099
090800             STRING   ' ' WS004-SRC-TASK-NUMBER                   09080099
090900                      ' WSKCS304-3000 ERROR:'                     09090099
091000                      ' INVALID CURSOR'                           09100099
091100                      DELIMITED BY SIZE                           09110099
091200                      INTO PV-CICS-MSG-AREA                       09120099
091300             PERFORM 7000-WRITE-TO-CICS-LOG                       09130099
091400             MOVE '3000-FETCH-CURSOR'                             09140099
091500                                       TO DP013-PARAGRAPH         09150099
091600             MOVE 'INVALID CURSOR'                                09160099
091700                                       TO DP013-MESSAGE-TEXT (1)  09170099
091800             SET DP013-DB2-ABEND       TO TRUE                    09180099
091900             PERFORM 9999-ABEND                                   09190099
092000     END-EVALUATE.                                                09200099
092001                                                                  09200199
092002     IF PS-CICS-SWITCH-YES                                        09200299
092010         MOVE DK-SHPT-UNT-ID   TO WS-DISPLAY-2                    09201099
092020         INITIALIZE  PV-CICS-MSG-AREA                             09202099
092030         STRING   ' ' WS004-SRC-TASK-NUMBER                       09203099
092040                  ' WSKCS304-3000:'                               09204099
092050                  ' CSR:'                                         09205099
092060                  PC049-CURSOR-SWITCHES                           09206099
092070                  ' SML:'                                         09207099
092080                  WS-DISPLAY-2                                    09208099
092090                  DELIMITED BY SIZE                               09209099
092091             INTO PV-CICS-MSG-AREA                                09209199
092092         PERFORM 7000-WRITE-TO-CICS-LOG                           09209299
092093     END-IF                                                       09209399
092094                                                                  09209499
092100                                                                  09210099
092610**** DMH 5/23/07  BYPASS INACTIVE DIVERT RECORDS                  09261099
092620     IF  SUCRDV-ACTV-CDE  = 'I'                                   09262099
092630         CONTINUE                                                 09263099
092640     ELSE                                                         09264099
092650***                                                               09265099
092660**** DMH 8/29/23  BYPASS FAST TRANSFER CARTONS                    09266099
092691***                                                               09269199
092700     IF SQLCODE = ZERO                                            09270099
092710         IF  PS-SEND-FXR-TO-EFC-YES                               09271099
092800             MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHPT-UNT-ID           09280099
092900             PERFORM 4000-BUILD-TEMP-TBL                          09290099
093000         ELSE                                                     09300099
093001             MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHPT-UNT-ID           09300199
093002             PERFORM 3010-CHECK-SML-SRC                           09300299
093004             IF  PV-CART-SRC-CDE = 'FXR'                          09300499
093005                 CONTINUE                                         09300599
093006             ELSE                                                 09300699
093007                 MOVE SUCRDV-SHIPT-UNT-ID TO DK-SHPT-UNT-ID       09300799
093008                 PERFORM 4000-BUILD-TEMP-TBL                      09300899
093010             END-IF                                               09301099
093020         END-IF                                                   09302099
093100     END-IF                                                       09310099
093110     END-IF.                                                      09311099
093200                                                                  09320099
093201                                                                  09320199
093202*--------------------------------------------------------------*  09320299
093203* CHECK IF CARTON SOURCE IS FAST TRANSFER CARTON               *  09320399
093204* THIS IS ONLY CHECKED IF FAST TRANSFER CARTONS ARE NOT BEING  *  09320499
093205* SENT TO EFC                                                  *  09320599
093206*--------------------------------------------------------------*  09320699
093210 3010-CHECK-SML-SRC.                                              09321099
093211                                                                  09321199
093212     MOVE SPACES TO  PV-CART-SRC-CDE.                             09321299
093213                                                                  09321399
093220     EXEC SQL                                                     09322099
093230         SELECT CART_SRC_CDE                                      09323099
093240         INTO   :PV-CART-SRC-CDE                                  09324099
093250         FROM    SUT_OTBND_CART                                   09325099
093270         WHERE   SHIPT_UNT_ID   = :DK-SHPT-UNT-ID                 09327099
093291         WITH UR                                                  09329199
093292     END-EXEC.                                                    09329299
093293                                                                  09329399
093294     EVALUATE TRUE                                                09329499
093295         WHEN SQLCODE = ZERO                                      09329599
093296             IF PS-CICS-SWITCH-YES                                09329699
093299                 INITIALIZE  PV-CICS-MSG-AREA                     09329999
093300                 STRING   ' ' WS004-SRC-TASK-NUMBER               09330099
093301                          ' WSKCS304-3010:'                       09330199
093302                          ' SRC:' PV-CART-SRC-CDE                 09330299
093306                               DELIMITED BY SIZE                  09330699
093307                          INTO PV-CICS-MSG-AREA                   09330799
093308                 PERFORM 7000-WRITE-TO-CICS-LOG                   09330899
093309             END-IF                                               09330999
093310         WHEN SQLCODE = -904                                      09331099
093311         WHEN SQLCODE = -913                                      09331199
093312         WHEN SQLCODE = -911                                      09331299
093313         WHEN SQLCODE = +100                                      09331399
093314             MOVE SPACES  TO  PV-CART-SRC-CDE                     09331499
093315         WHEN SQLWARN0 NOT = SPACES                               09331599
093316         WHEN SQLCODE NOT = ZERO                                  09331699
093317             MOVE SQLCODE               TO PV-SQL-RETURN-CD       09331799
093318             INITIALIZE PV-CICS-MSG-AREA                          09331899
093319             STRING   ' ' WS004-SRC-TASK-NUMBER                   09331999
093320                      ' WSKCS304-3010 ERROR:'                     09332099
093321                      ' SQL='                                     09332199
093322                      PV-SQL-RETURN-CD                            09332299
093323                      DELIMITED BY SIZE                           09332399
093324                      INTO PV-CICS-MSG-AREA                       09332499
093325             PERFORM 7000-WRITE-TO-CICS-LOG                       09332599
093326             MOVE '3010-CHECK-SML-SRC'                            09332699
093327                                       TO DP013-PARAGRAPH         09332799
093328             MOVE 'SUT_OTBND_CART'     TO                         09332899
093329                                       DP013-DB2-TABLE-NAME (1)   09332999
093332             MOVE SQLCA                TO DP013-SQLCA             09333299
093333             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            09333399
093334             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   09333499
093335                      DELIMITED BY SIZE                           09333599
093336                                     INTO DP013-MESSAGE-TEXT (1)  09333699
093337             SET DP013-DB2-ABEND       TO TRUE                    09333799
093338             PERFORM 9999-ABEND                                   09333899
093339     END-EVALUATE.                                                09333999
093340                                                                  09334099
093341                                                                  09334199
093350/                                                                 09335099
093400 4000-BUILD-TEMP-TBL.                                             09340099
093500*                                                                 09350099
093600*** ADDED 5/24/07 --- DMH                                         09360099
093700*** CARTONS WITH MORE THAN 1 PO WILL NOT BE SENT TO WMOS          09370099
093800*                                                                 09380099
093900*** ADDED 8/74/07 --- DMH                                         09390099
094000*** CARTONS THAT HAVE ALREADY BEEN RECEIVED AT EFC (ERDM)         09400099
094100*** WILL NOT BE SENT TO WMOS                                      09410099
094200*                                                                 09420099
094300     SET  PS-CRTN-PREV-DIVERT-NO  TO  TRUE.                       09430099
094310     SET  PS-CRTN-ACTIVE-SHON-NO  TO  TRUE.                       09431099
094320*                                                                 09432099
094330     PERFORM 4001-GET-PO-COUNT.                                   09433099
094340     PERFORM 4002-GET-ERDM-COUNT.                                 09434099
094350*                                                                 09435099
094351     IF PS-CICS-SWITCH-YES                                        09435199
094352         MOVE  PV-PO-COUNT    TO  PV-DISP-PO-CNT                  09435299
094353         INITIALIZE  PV-CICS-MSG-AREA                             09435399
094354         STRING   ' ' WS004-SRC-TASK-NUMBER                       09435499
094355                  ' WSKCS304-4000-BUILD-TEMP-TBL '                09435599
094356                  ' PO-CNT:' PV-DISP-PO-CNT                       09435699
094358                  ' PS-STR-TO-EFC-WS:' PS-STR-TO-EFC-SW           09435899
094360                  DELIMITED BY SIZE                               09436099
094361             INTO PV-CICS-MSG-AREA                                09436199
094362         PERFORM 7000-WRITE-TO-CICS-LOG                           09436299
094363     END-IF                                                       09436399
094366                                                                  09436699
094367                                                                  09436799
094368     IF  PV-ERDM-COUNT  >  0                                      09436899
094370         CONTINUE                                                 09437099
094380     ELSE                                                         09438099
094381                                                                  09438199
094398*                                                                 09439899
094399***  IF PO-COUNT = 1  PROCESS THE CARTON                          09439999
094400*                                                                 09440099
094401         IF  PV-PO-COUNT    =  1                                  09440199
094402                                                                  09440299
094403             IF PS-CICS-SWITCH-YES                                09440399
094404                 MOVE  PV-PO-COUNT    TO  PV-DISP-PO-CNT          09440499
094405                 INITIALIZE  PV-CICS-MSG-AREA                     09440599
094406                 STRING   ' ' WS004-SRC-TASK-NUMBER               09440699
094407                          ' WSKCS304-4000-BUILD-TEMP-TBL '        09440799
094408                          '   A'                                  09440899
094409                          DELIMITED BY SIZE                       09440999
094410                     INTO PV-CICS-MSG-AREA                        09441099
094411                 PERFORM 7000-WRITE-TO-CICS-LOG                   09441199
094412             END-IF                                               09441299
094413                                                                  09441399
094414             PERFORM 4005-GET-DETAIL-CNT                          09441499
094415             IF  PV-SQL-COUNT > 0                                 09441599
094416                 PERFORM 4010-OPEN-DETAIL-CSR                     09441699
094417                 PERFORM 4020-FETCH-DETAIL-CSR                    09441799
094418                    UNTIL PS-EOF-DETAIL-CSR-YES                   09441899
094419                 PERFORM 4030-CLOSE-DETAIL-CSR                    09441999
094420             END-IF                                               09442099
094421         ELSE                                                     09442199
094422*                                                                 09442299
094423***  IF PO-COUNT > 1  & NOT STORE-TO-EFC --BYPASS THE CARTON      09442399
094424*                                                                 09442499
094425         IF  PV-PO-COUNT    >  1  AND                             09442599
094426             PS-STR-TO-EFC-NO                                     09442699
094427                                                                  09442799
094428             IF PS-CICS-SWITCH-YES                                09442899
094429                 MOVE  PV-PO-COUNT    TO  PV-DISP-PO-CNT          09442999
094430                 INITIALIZE  PV-CICS-MSG-AREA                     09443099
094431                 STRING   ' ' WS004-SRC-TASK-NUMBER               09443199
094432                          ' WSKCS304-4000-BUILD-TEMP-TBL '        09443299
094433                          '   B - BYPASS CARTON'                  09443399
094434                          DELIMITED BY SIZE                       09443499
094435                     INTO PV-CICS-MSG-AREA                        09443599
094436                 PERFORM 7000-WRITE-TO-CICS-LOG                   09443699
094437             END-IF                                               09443799
094438                                                                  09443899
094439                 CONTINUE                                         09443999
094440*                                                                 09444099
094441***  IF PO-COUNT > 1  & STORE-TO-EFC -- PROCESS WITH SAME PO      09444199
094442*                                                                 09444299
094443             ELSE                                                 09444399
094444             IF  PV-PO-COUNT    >  1  AND                         09444499
094445                 PS-STR-TO-EFC-YES                                09444599
094446                                                                  09444699
094447                 IF PS-CICS-SWITCH-YES                            09444799
094448                     MOVE  PV-PO-COUNT    TO  PV-DISP-PO-CNT      09444899
094449                     INITIALIZE  PV-CICS-MSG-AREA                 09444999
094450                     STRING   ' ' WS004-SRC-TASK-NUMBER           09445099
094451                              ' WSKCS304-4000-BUILD-TEMP-TBL '    09445199
094452                              '   C'                              09445299
094453                              DELIMITED BY SIZE                   09445399
094454                         INTO PV-CICS-MSG-AREA                    09445499
094455                     PERFORM 7000-WRITE-TO-CICS-LOG               09445599
094456                 END-IF                                           09445699
094457                                                                  09445799
094459                 PERFORM 4001EFC-GET-PO-NBR                       09445999
094460                                                                  09446099
094461                 PERFORM 4005-GET-DETAIL-CNT                      09446199
094462                     IF  PV-SQL-COUNT > 0                         09446299
094463                         PERFORM 4010-OPEN-DETAIL-CSR             09446399
094464                         PERFORM 4020-FETCH-DETAIL-CSR            09446499
094465                           UNTIL PS-EOF-DETAIL-CSR-YES            09446599
094466                         PERFORM 4030-CLOSE-DETAIL-CSR            09446699
094467                     END-IF                                       09446799
094468*                                                                 09446899
094469***  IF PO-COUNT = 1  PROCESS THE CARTON                          09446999
094470*                                                                 09447099
094471                 ELSE                                             09447199
094472                                                                  09447299
094473                 IF PS-CICS-SWITCH-YES                            09447399
094474                     MOVE  PV-PO-COUNT    TO  PV-DISP-PO-CNT      09447499
094475                     INITIALIZE  PV-CICS-MSG-AREA                 09447599
094476                     STRING   ' ' WS004-SRC-TASK-NUMBER           09447699
094477                              ' WSKCS304-4000-BUILD-TEMP-TBL '    09447799
094478                              '   D'                              09447899
094479                              DELIMITED BY SIZE                   09447999
094480                         INTO PV-CICS-MSG-AREA                    09448099
094481                     PERFORM 7000-WRITE-TO-CICS-LOG               09448199
094482                 END-IF                                           09448299
094483                                                                  09448399
094484                     PERFORM 4005-GET-DETAIL-CNT                  09448499
094485                     IF  PV-SQL-COUNT > 0                         09448599
094486                         PERFORM 4010-OPEN-DETAIL-CSR             09448699
094487                         PERFORM 4020-FETCH-DETAIL-CSR            09448799
094488                           UNTIL PS-EOF-DETAIL-CSR-YES            09448899
094489                         PERFORM 4030-CLOSE-DETAIL-CSR            09448999
094490                     END-IF                                       09449099
094491             END-IF                                               09449199
094492         END-IF                                                   09449299
094493     END-IF.                                                      09449399
094494                                                                  09449499
094800                                                                  09480099
094900                                                                  09490099
095000 4001-GET-PO-COUNT.                                               09500099
095100     EXEC SQL                                                     09510099
095200         SELECT COUNT(DISTINCT(TRN_NBR))                          09520099
095300         INTO   :PV-PO-COUNT                                      09530099
095400         FROM    SUT_OTBND_CART A                                 09540099
095500               , SUT_OTBND_UPC  B                                 09550099
095510         WHERE   A.SHIPT_UNT_ID   = :DK-SHPT-UNT-ID               09551099
095520         AND     A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                09552099
095530         AND     B.SHPD_UNT_QTY   > 0                             09553099
095540         AND     A.ACTV_IND       = 'Y'                           09554099
095550     END-EXEC.                                                    09555099
095560                                                                  09556099
095570     EVALUATE TRUE                                                09557099
095580         WHEN SQLCODE = ZERO                                      09558099
095590             IF PS-CICS-SWITCH-YES                                09559099
095591                 MOVE PV-PO-COUNT      TO WS-DISPLAY-1            09559199
095592                 MOVE DK-SHPT-UNT-ID   TO WS-DISPLAY-2            09559299
095593                 INITIALIZE  PV-CICS-MSG-AREA                     09559399
095594                 STRING   ' ' WS004-SRC-TASK-NUMBER               09559499
095595                          ' WSKCS304-4001:'                       09559599
095596                          ' SML='                                 09559699
095597                          WS-DISPLAY-2                            09559799
095598                          ' CASE PO COUNT='                       09559899
095599                          WS-DISPLAY-1                            09559999
095600                          DELIMITED BY SIZE                       09560099
095601                          INTO PV-CICS-MSG-AREA                   09560199
095602                 PERFORM 7000-WRITE-TO-CICS-LOG                   09560299
095603             END-IF                                               09560399
095604         WHEN SQLCODE = -904                                      09560499
095605         WHEN SQLCODE = -913                                      09560599
095606         WHEN SQLCODE = -911                                      09560699
095607         WHEN SQLCODE = +100                                      09560799
095608             MOVE ZERO TO PV-SQL-COUNT                            09560899
095609         WHEN SQLWARN0 NOT = SPACES                               09560999
095610         WHEN SQLCODE NOT = ZERO                                  09561099
095611             MOVE SQLCODE               TO PV-SQL-RETURN-CD       09561199
095612             INITIALIZE PV-CICS-MSG-AREA                          09561299
095613             STRING   ' ' WS004-SRC-TASK-NUMBER                   09561399
095614                      ' WSKCS304-4001 ERROR:'                     09561499
095615                      ' SQL='                                     09561599
095616                      PV-SQL-RETURN-CD                            09561699
095617                      DELIMITED BY SIZE                           09561799
095618                      INTO PV-CICS-MSG-AREA                       09561899
095619             PERFORM 7000-WRITE-TO-CICS-LOG                       09561999
095620             MOVE '4001-GET-PO-CNT'                               09562099
095621                                       TO DP013-PARAGRAPH         09562199
095622             MOVE 'SUT_OTBND_CART'     TO                         09562299
095623                                       DP013-DB2-TABLE-NAME (1)   09562399
095624             MOVE 'SUT_OTBND_UPC'      TO                         09562499
095625                                       DP013-DB2-TABLE-NAME (2)   09562599
095626             MOVE SQLCA                TO DP013-SQLCA             09562699
095627             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            09562799
095628             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   09562899
095629                      DELIMITED BY SIZE                           09562999
095630                                     INTO DP013-MESSAGE-TEXT (1)  09563099
095631             SET DP013-DB2-ABEND       TO TRUE                    09563199
095632             PERFORM 9999-ABEND                                   09563299
095633     END-EVALUATE.                                                09563399
095634                                                                  09563499
095635                                                                  09563599
095636 4001EFC-GET-PO-NBR.                                              09563699
095637     EXEC SQL                                                     09563799
095638         SELECT TRN_NBR                                           09563899
095639              , COUNT(*)                                          09563999
095640         INTO   :PV-STR-TO-EFC-PO                                 09564099
095641              , :PV-STR-TO-EFC-PO-CNT                             09564199
095642         FROM    SUT_OTBND_CART A                                 09564299
095643               , SUT_OTBND_UPC  B                                 09564399
095644         WHERE   A.SHIPT_UNT_ID   = :DK-SHPT-UNT-ID               09564499
095645         AND     A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                09564599
095646         AND     B.SHPD_UNT_QTY   > 0                             09564699
095647         AND     A.ACTV_IND       = 'Y'                           09564799
095648       GROUP BY TRN_NBR                                           09564899
095649       ORDER BY 2  DESC                                           09564999
095650              , 1  ASC                                            09565099
095651       FETCH FIRST 1 ROW ONLY                                     09565199
095652        WITH UR                                                   09565299
095653     END-EXEC.                                                    09565399
095654                                                                  09565499
095655     EVALUATE TRUE                                                09565599
095656         WHEN SQLCODE = ZERO                                      09565699
095657              CONTINUE                                            09565799
095670         WHEN SQLCODE = -904                                      09567099
095671         WHEN SQLCODE = -913                                      09567199
095672         WHEN SQLCODE = -911                                      09567299
095673         WHEN SQLCODE = +100                                      09567399
095674             MOVE ZERO TO PV-STR-TO-EFC-PO                        09567499
095675                          PV-STR-TO-EFC-PO-CNT                    09567599
095676         WHEN SQLWARN0 NOT = SPACES                               09567699
095677         WHEN SQLCODE NOT = ZERO                                  09567799
095678             MOVE SQLCODE               TO PV-SQL-RETURN-CD       09567899
095679             INITIALIZE PV-CICS-MSG-AREA                          09567999
095680             STRING   ' ' WS004-SRC-TASK-NUMBER                   09568099
095681                      ' WSKCS304-4001EFC ERROR:'                  09568199
095682                      ' SQL='                                     09568299
095683                      PV-SQL-RETURN-CD                            09568399
095684                      DELIMITED BY SIZE                           09568499
095685                      INTO PV-CICS-MSG-AREA                       09568599
095686             PERFORM 7000-WRITE-TO-CICS-LOG                       09568699
095687             MOVE '4001EFC-GET-PO-NBR'                            09568799
095688                                       TO DP013-PARAGRAPH         09568899
095689             MOVE 'SUT_OTBND_CART'     TO                         09568999
095690                                       DP013-DB2-TABLE-NAME (1)   09569099
095691             MOVE 'SUT_OTBND_UPC'      TO                         09569199
095692                                       DP013-DB2-TABLE-NAME (2)   09569299
095693             MOVE SQLCA                TO DP013-SQLCA             09569399
095694             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            09569499
095695             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   09569599
095696                      DELIMITED BY SIZE                           09569699
095697                                     INTO DP013-MESSAGE-TEXT (1)  09569799
095698             SET DP013-DB2-ABEND       TO TRUE                    09569899
095699             PERFORM 9999-ABEND                                   09569999
095700     END-EVALUATE.                                                09570099
095701                                                                  09570199
095702                                                                  09570299
095703 4002-GET-ERDM-COUNT.                                             09570399
095704     MOVE  ZEROES  TO  PV-ERDM-COUNT.                             09570499
095705                                                                  09570599
095706     EXEC SQL                                                     09570699
095707         SELECT COUNT(*)                                          09570799
095708         INTO   :PV-ERDM-COUNT                                    09570899
095709         FROM    SUT_OTBND_LOC                                    09570999
095710         WHERE   SHIPT_UNT_ID   = :DK-SHPT-UNT-ID                 09571099
095711         AND     SCN_CDE        = 'ERDM'                          09571199
095712     END-EXEC.                                                    09571299
095713                                                                  09571399
095714     EVALUATE TRUE                                                09571499
095715         WHEN SQLCODE = ZERO                                      09571599
095716             IF PS-CICS-SWITCH-YES                                09571699
095717                 MOVE PV-ERDM-COUNT    TO WS-DISPLAY-1            09571799
095718                 MOVE DK-SHPT-UNT-ID   TO WS-DISPLAY-2            09571899
095719                 INITIALIZE  PV-CICS-MSG-AREA                     09571999
095720                 STRING   ' ' WS004-SRC-TASK-NUMBER               09572099
095721                          ' WSKCS304-4002:'                       09572199
095722                          ' SML='                                 09572299
095723                          WS-DISPLAY-2                            09572399
095724                          ' ALREADY RECEIVED ERDM - '             09572499
095725                          WS-DISPLAY-1                            09572599
095726                          DELIMITED BY SIZE                       09572699
095727                          INTO PV-CICS-MSG-AREA                   09572799
095728                 PERFORM 7000-WRITE-TO-CICS-LOG                   09572899
095729             END-IF                                               09572999
095730         WHEN SQLCODE = -904                                      09573099
095731         WHEN SQLCODE = -913                                      09573199
095732         WHEN SQLCODE = -911                                      09573299
095733         WHEN SQLCODE = +100                                      09573399
095734             MOVE ZERO TO PV-SQL-COUNT                            09573499
095735         WHEN SQLWARN0 NOT = SPACES                               09573599
095736         WHEN SQLCODE NOT = ZERO                                  09573699
095737             MOVE SQLCODE               TO PV-SQL-RETURN-CD       09573799
095738             INITIALIZE PV-CICS-MSG-AREA                          09573899
095739             STRING   ' ' WS004-SRC-TASK-NUMBER                   09573999
095740                      ' WSKCS304-4002 ERROR:'                     09574099
095741                      ' SQL='                                     09574199
095742                      PV-SQL-RETURN-CD                            09574299
095743                      DELIMITED BY SIZE                           09574399
095744                      INTO PV-CICS-MSG-AREA                       09574499
095745             PERFORM 7000-WRITE-TO-CICS-LOG                       09574599
095746             MOVE '4002-GET-ERDM-CNT'                             09574699
095747                                       TO DP013-PARAGRAPH         09574799
095748             MOVE 'SUT_OTBND_LOC'      TO                         09574899
095749                                       DP013-DB2-TABLE-NAME (1)   09574999
095750             MOVE SQLCA                TO DP013-SQLCA             09575099
095751             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            09575199
095752             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   09575299
095753                      DELIMITED BY SIZE                           09575399
095754                                     INTO DP013-MESSAGE-TEXT (1)  09575499
095755             SET DP013-DB2-ABEND       TO TRUE                    09575599
095756             PERFORM 9999-ABEND                                   09575699
095757     END-EVALUATE.                                                09575799
095758                                                                  09575899
095759                                                                  09575999
095760**************************************************************    09576099
095761*** ADDED 8/08/07 --- DMH                                         09576199
095762*** CARTONS HAVE PREVIOUS ACTIVE DIVERTS DO NOT SEND              09576299
095763**************************************************************    09576399
095764*                                                                 09576499
095765 4003-GET-DIVERT-COUNT.                                           09576599
095766                                                                  09576699
095767     IF  PC049-PV-REC-TYPE = 'A'                                  09576799
095768                                                                  09576899
095769         EXEC SQL                                                 09576999
095770             SELECT COUNT(*)                                      09577099
095771               INTO :PV-DIVERT-COUNT                              09577199
095772               FROM  TSUCRDV                                      09577299
095773              WHERE  SHIPT_UNT_ID   = :DK-SHPT-UNT-ID             09577399
095774                AND  DIVERT_TMST    < :SUCRDV-DIVERT-TMST         09577499
095775         END-EXEC                                                 09577599
095776                                                                  09577699
095777         EVALUATE TRUE                                            09577799
095778             WHEN SQLCODE = ZERO                                  09577899
095779                  IF  PV-DIVERT-COUNT > 0                         09577999
095780                      SET  PS-CRTN-PREV-DIVERT-YES  TO  TRUE      09578099
095781                  ELSE                                            09578199
095782                      SET  PS-CRTN-PREV-DIVERT-NO  TO  TRUE       09578299
095783                      PERFORM 4004-GET-SHON-COUNT                 09578399
095784                 END-IF                                           09578499
095785                                                                  09578599
095786             WHEN SQLCODE = +100                                  09578699
095787                  PERFORM 4004-GET-SHON-COUNT                     09578799
095788                                                                  09578899
095789             WHEN SQLCODE = -904                                  09578999
095790             WHEN SQLCODE = -913                                  09579099
095791             WHEN SQLCODE = -911                                  09579199
095792                  CONTINUE                                        09579299
095793                                                                  09579399
095794             WHEN SQLWARN0 NOT = SPACES                           09579499
095795             WHEN SQLCODE NOT = ZERO                              09579599
095796             MOVE SQLCODE               TO PV-SQL-RETURN-CD       09579699
095797                 INITIALIZE PV-CICS-MSG-AREA                      09579799
095798                 STRING   ' ' WS004-SRC-TASK-NUMBER               09579899
095799                          ' WSKCS304-4002 ERROR:'                 09579999
095800                          ' SQL='                                 09580099
095801                          PV-SQL-RETURN-CD                        09580199
095802                          DELIMITED BY SIZE                       09580299
095803                          INTO PV-CICS-MSG-AREA                   09580399
095804                 PERFORM 7000-WRITE-TO-CICS-LOG                   09580499
095805                 MOVE '4003-GET-DIVERT-CNT'                       09580599
095806                                       TO DP013-PARAGRAPH         09580699
095807                 MOVE 'TSUCRDV'        TO                         09580799
095808                                       DP013-DB2-TABLE-NAME (1)   09580899
095809                 MOVE SQLCA            TO DP013-SQLCA             09580999
095810                 MOVE DK-SHPT-UNT-ID   TO WS-DISPLAY-2            09581099
095811                 STRING 'SHPT UNT ID=' WS-DISPLAY-2               09581199
095812                          DELIMITED BY SIZE                       09581299
095813                                     INTO DP013-MESSAGE-TEXT (1)  09581399
095814                 SET DP013-DB2-ABEND   TO TRUE                    09581499
095815                 PERFORM 9999-ABEND                               09581599
095816         END-EVALUATE                                             09581699
095817     END-IF.                                                      09581799
095818                                                                  09581899
095819                                                                  09581999
095820**************************************************************    09582099
095821*** ADDED 8/08/07 --- DMH                                         09582199
095822*** IF CARTON HAS ACTIVE SCAN ON - DO NOT SEND                    09582299
095823**************************************************************    09582399
095824*                                                                 09582499
095825 4004-GET-SHON-COUNT.                                             09582599
095826                                                                  09582699
095827     IF  PC049-PV-REC-TYPE = 'A'                                  09582799
095828                                                                  09582899
095829         EXEC SQL                                                 09582999
095830             SELECT COUNT(*)                                      09583099
095831               INTO :PV-SHON-COUNT                                09583199
095832               FROM  SUT_OTBND_LOC                                09583299
095833              WHERE  SHIPT_UNT_ID   = :DK-SHPT-UNT-ID             09583399
095834                AND  SCN_CDE        = 'SHON'                      09583499
095835                AND  ACTV_CDE       = 'A'                         09583599
095836         END-EXEC                                                 09583699
095837                                                                  09583799
095838         EVALUATE TRUE                                            09583899
095839             WHEN SQLCODE = ZERO                                  09583999
095840                  IF  PV-SHON-COUNT > 0                           09584099
095841                      SET  PS-CRTN-ACTIVE-SHON-YES  TO  TRUE      09584199
095842                  ELSE                                            09584299
095843                      SET  PS-CRTN-ACTIVE-SHON-NO  TO  TRUE       09584399
095844                 END-IF                                           09584499
095845                                                                  09584599
095846             WHEN SQLCODE = +100                                  09584699
095847                  SET  PS-CRTN-ACTIVE-SHON-NO  TO  TRUE           09584799
095848                                                                  09584899
095849             WHEN SQLCODE = -904                                  09584999
095850             WHEN SQLCODE = -913                                  09585099
095851             WHEN SQLCODE = -911                                  09585199
095852                  CONTINUE                                        09585299
095853                                                                  09585399
095854             WHEN SQLWARN0 NOT = SPACES                           09585499
095855             WHEN SQLCODE NOT = ZERO                              09585599
095856             MOVE SQLCODE               TO PV-SQL-RETURN-CD       09585699
095857                 INITIALIZE PV-CICS-MSG-AREA                      09585799
095858                 STRING   ' ' WS004-SRC-TASK-NUMBER               09585899
095859                          ' WSKCS304-4002 ERROR:'                 09585999
095860                          ' SQL='                                 09586099
095861                          PV-SQL-RETURN-CD                        09586199
095862                          DELIMITED BY SIZE                       09586299
095863                          INTO PV-CICS-MSG-AREA                   09586399
095864                 PERFORM 7000-WRITE-TO-CICS-LOG                   09586499
095865                 MOVE '4004-GET-SHON-CNT'                         09586599
095866                                       TO DP013-PARAGRAPH         09586699
095867                 MOVE 'TSUCRDV'        TO                         09586799
095868                                       DP013-DB2-TABLE-NAME (1)   09586899
095869                 MOVE SQLCA            TO DP013-SQLCA             09586999
095870                 MOVE DK-SHPT-UNT-ID   TO WS-DISPLAY-2            09587099
095871                 STRING 'SHPT UNT ID=' WS-DISPLAY-2               09587199
095872                          DELIMITED BY SIZE                       09587299
095873                                     INTO DP013-MESSAGE-TEXT (1)  09587399
095874                 SET DP013-DB2-ABEND   TO TRUE                    09587499
095875                 PERFORM 9999-ABEND                               09587599
095876         END-EVALUATE                                             09587699
095877     END-IF.                                                      09587799
095878                                                                  09587899
095879                                                                  09587999
095880 4005-GET-DETAIL-CNT.                                             09588099
095881                                                                  09588199
095882     EXEC SQL                                                     09588299
095883         SELECT COUNT(*)                                          09588399
095884         INTO   :PV-SQL-COUNT                                     09588499
095885         FROM    SUT_OTBND_CART A                                 09588599
095886               , SUT_OTBND_UPC  B                                 09588699
095887               , XLT_UPC        C                                 09588799
095888               , XLT_SKU        D                                 09588899
095889         WHERE   A.SHIPT_UNT_ID   = :DK-SHPT-UNT-ID               09588999
095890         AND     C.INTR_UPC_ID    = D.INTR_UPC_ID                 09589099
095891         AND     B.UPC_NBR        = C.UPC_NBR                     09589199
095892         AND     A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                09589299
095893         AND     B.SHPD_UNT_QTY   > 0                             09589399
095894         AND     A.ACTV_IND       = 'Y'                           09589499
095900     END-EXEC.                                                    09590099
096000                                                                  09600099
096100     EVALUATE TRUE                                                09610099
096200         WHEN SQLCODE = ZERO                                      09620099
096300             IF PS-CICS-SWITCH-YES                                09630099
096400                 MOVE PV-SQL-COUNT     TO WS-DISPLAY-1            09640099
096500                 MOVE DK-SHPT-UNT-ID   TO WS-DISPLAY-2            09650099
096600                 INITIALIZE  PV-CICS-MSG-AREA                     09660099
096700                 STRING   ' ' WS004-SRC-TASK-NUMBER               09670099
096800                          ' WSKCS304-4005:'                       09680099
096900                          ' SML='                                 09690099
097000                          WS-DISPLAY-2                            09700099
097100                          ' CASE DTL COUNT='                      09710099
097200                          WS-DISPLAY-1                            09720099
097300                          DELIMITED BY SIZE                       09730099
097400                          INTO PV-CICS-MSG-AREA                   09740099
097500                 PERFORM 7000-WRITE-TO-CICS-LOG                   09750099
097600             END-IF                                               09760099
097700         WHEN SQLCODE = -904                                      09770099
097800         WHEN SQLCODE = -913                                      09780099
097900         WHEN SQLCODE = -911                                      09790099
098000         WHEN SQLCODE = +100                                      09800099
098100             MOVE ZERO TO PV-SQL-COUNT                            09810099
098200         WHEN SQLWARN0 NOT = SPACES                               09820099
098300         WHEN SQLCODE NOT = ZERO                                  09830099
098400             MOVE SQLCODE               TO PV-SQL-RETURN-CD       09840099
098500             INITIALIZE PV-CICS-MSG-AREA                          09850099
098600             STRING   ' ' WS004-SRC-TASK-NUMBER                   09860099
098700                      ' WSKCS304-4005 ERROR:'                     09870099
098800                      ' SQL='                                     09880099
098900                      PV-SQL-RETURN-CD                            09890099
099000                      DELIMITED BY SIZE                           09900099
099100                      INTO PV-CICS-MSG-AREA                       09910099
099200             PERFORM 7000-WRITE-TO-CICS-LOG                       09920099
099300             MOVE '4005-GET-DETAIL-CNT'                           09930099
099400                                       TO DP013-PARAGRAPH         09940099
099500             MOVE 'SUT_OTBND_CART'     TO                         09950099
099600                                       DP013-DB2-TABLE-NAME (1)   09960099
099700             MOVE 'SUT_OTBND_UPC'      TO                         09970099
099800                                       DP013-DB2-TABLE-NAME (2)   09980099
099900             MOVE 'XLT_UPC'            TO                         09990099
100000                                       DP013-DB2-TABLE-NAME (3)   10000099
100100             MOVE 'XLT_SKU'            TO                         10010099
100200                                       DP013-DB2-TABLE-NAME (4)   10020099
100300             MOVE SQLCA                TO DP013-SQLCA             10030099
100400             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            10040099
100500             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   10050099
100600                      DELIMITED BY SIZE                           10060099
100700                                     INTO DP013-MESSAGE-TEXT (1)  10070099
100800             SET DP013-DB2-ABEND       TO TRUE                    10080099
100900             PERFORM 9999-ABEND                                   10090099
101000     END-EVALUATE.                                                10100099
101100                                                                  10110099
101200/                                                                 10120099
101300 4010-OPEN-DETAIL-CSR.                                            10130099
101400                                                                  10140099
101500     EXEC SQL                                                     10150099
101600          OPEN DETAIL-CSR                                         10160099
101700     END-EXEC.                                                    10170099
101800                                                                  10180099
101900     EVALUATE TRUE                                                10190099
102000         WHEN SQLCODE = ZERO                                      10200099
102100             IF PS-CICS-SWITCH-YES                                10210099
102200                 INITIALIZE  PV-CICS-MSG-AREA                     10220099
102300                 STRING   ' ' WS004-SRC-TASK-NUMBER               10230099
102400                          ' WSKCS304-4010:'                       10240099
102500                          ' OPENED DETAIL CURSOR'                 10250099
102600                          DELIMITED BY SIZE                       10260099
102700                          INTO PV-CICS-MSG-AREA                   10270099
102800                 PERFORM 7000-WRITE-TO-CICS-LOG                   10280099
102900             END-IF                                               10290099
103000         WHEN SQLCODE = -904                                      10300099
103100         WHEN SQLCODE = -913                                      10310099
103200         WHEN SQLCODE = -911                                      10320099
103300              CONTINUE                                            10330099
103400         WHEN SQLWARN0 NOT = SPACES                               10340099
103500         WHEN SQLCODE NOT = ZERO                                  10350099
103600             MOVE SQLCODE               TO PV-SQL-RETURN-CD       10360099
103700             INITIALIZE PV-CICS-MSG-AREA                          10370099
103800             STRING   ' ' WS004-SRC-TASK-NUMBER                   10380099
103900                      ' WSKCS304-4010 ERROR:'                     10390099
104000                      ' SQL='                                     10400099
104100                      PV-SQL-RETURN-CD                            10410099
104200                      DELIMITED BY SIZE                           10420099
104300                      INTO PV-CICS-MSG-AREA                       10430099
104400             PERFORM 7000-WRITE-TO-CICS-LOG                       10440099
104500             MOVE '4010-OPEN-DETAIL-CSR'                          10450099
104600                                       TO DP013-PARAGRAPH         10460099
104700             MOVE 'OPEN FAILED'                                   10470099
104800                                       TO DP013-MESSAGE-TEXT (1)  10480099
104900             SET DP013-DB2-ABEND       TO TRUE                    10490099
105000             PERFORM 9999-ABEND                                   10500099
105100     END-EVALUATE.                                                10510099
105200                                                                  10520099
105300     MOVE 0               TO WS-SHIP-WT-QTY.                      10530099
105400     MOVE 0               TO WS-SHIP-DPTH-QTY.                    10540099
105500     MOVE 0               TO WS-SHIP-HT-QTY.                      10550099
105600     MOVE 0               TO WS-SHIP-WD-QTY.                      10560099
105700     MOVE 0               TO WS-UNIT-VOL.                         10570099
105800     MOVE 0               TO WS-CART-VOL.                         10580099
105900     MOVE 0               TO WS-UNIT-WT.                          10590099
106000     MOVE 0               TO WS-CART-WT.                          10600099
106100     MOVE 0               TO WS-SHPD-UNT-QTY.                     10610099
106200     MOVE 0               TO WS-TRN-LNE-NBR.                      10620099
106300     MOVE 0               TO WS-TOT-UNT-IN-CASE.                  10630099
106400     SET PS-FIRST-RECORD-YES          TO TRUE.                    10640099
106500     SET PS-EOF-DETAIL-CSR-NO         TO TRUE.                    10650099
106600                                                                  10660099
106700/                                                                 10670099
106800 4020-FETCH-DETAIL-CSR.                                           10680099
106900                                                                  10690099
107000     EXEC SQL                                                     10700099
107100          FETCH DETAIL-CSR                                        10710099
107200          INTO                                                    10720099
107300                :SUT00028-TRN-NBR                                 10730099
107400               ,:SUT00028-RCVR-SEQ-NBR                            10740099
107500               ,:XLT00003-SKU-NBR                                 10750099
107600               ,:XLT00006-INTR-UPC-ID                             10760099
107700               ,:SUT00028-SHPD-UNT-QTY                            10770099
107800               ,:SUT00028-TRN-LNE-NBR                             10780099
107900     END-EXEC.                                                    10790099
108000                                                                  10800099
108100     EVALUATE TRUE                                                10810099
108200         WHEN SQLCODE = ZERO                                      10820099
108300             MOVE XLT00003-SKU-NBR TO WS-SKU-NBR                  10830099
108400             MOVE SUT00028-RCVR-SEQ-NBR TO WS-RCVR-SEQ-NBR        10840099
108500             MOVE XLT00006-INTR-UPC-ID  TO DK-INTR-UPC-ID         10850099
108600             MOVE SUT00028-TRN-NBR      TO DK-TRN-NBR             10860099
108700             MOVE SUT00028-SHPD-UNT-QTY TO WS-SHPD-UNT-QTY        10870099
108800             MOVE SUT00028-TRN-LNE-NBR  TO WS-TRN-LNE-NBR         10880099
108900                                                                  10890099
109000             IF PS-CICS-SWITCH-YES                                10900099
109100                 INITIALIZE  PV-CICS-MSG-AREA                     10910099
109200                 MOVE WS-SKU-NBR        TO WS-DISPLAY-1           10920099
109300                 MOVE WS-RCVR-SEQ-NBR   TO WS-DISPLAY-6           10930099
109400                 MOVE DK-INTR-UPC-ID    TO WS-DISPLAY-3           10940099
109500                 MOVE DK-TRN-NBR        TO WS-DISPLAY-4           10950099
109600                 MOVE WS-SHPD-UNT-QTY   TO WS-DISPLAY-5           10960099
109700                 MOVE WS-TRN-LNE-NBR    TO WS-DISPLAY-7           10970099
109800                 STRING   ' ' WS004-SRC-TASK-NUMBER               10980099
109900                          ' WSKCS304-4020:'                       10990099
110000                          ' PO='  WS-DISPLAY-4                    11000099
110100                          '-' WS-DISPLAY-6                        11010099
110200                          ' SKU='  WS-DISPLAY-1                   11020099
110300                          ' INTR-UPCID='  WS-DISPLAY-3            11030099
110400                          ' QTY='  WS-DISPLAY-5                   11040099
110500                          ' LNE='  WS-DISPLAY-7                   11050099
110600                          DELIMITED BY SIZE                       11060099
110700                          INTO PV-CICS-MSG-AREA                   11070099
110800                 PERFORM 7000-WRITE-TO-CICS-LOG                   11080099
110900             END-IF                                               11090099
111000                                                                  11100099
111100             IF PS-FIRST-RECORD-YES                               11110099
111200                 SET PS-FIRST-RECORD-NO TO TRUE                   11120099
111300             END-IF                                               11130099
111400             PERFORM 6000-CREATE-CASE-DTL                         11140099
111500                                                                  11150099
111600         WHEN SQLCODE = -904                                      11160099
111700         WHEN SQLCODE = -913                                      11170099
111800         WHEN SQLCODE = -911                                      11180099
111900             CONTINUE                                             11190099
112000         WHEN SQLCODE = +100                                      11200099
112100             SET PS-EOF-DETAIL-CSR-YES TO TRUE                    11210099
112200             IF PS-FIRST-RECORD-NO                                11220099
112300                 PERFORM 5000-CREATE-CASE-HDR                     11230099
112400             END-IF                                               11240099
112500         WHEN SQLWARN0 NOT = SPACES                               11250099
112600         WHEN SQLCODE NOT = ZERO                                  11260099
112700             MOVE SQLCODE               TO PV-SQL-RETURN-CD       11270099
112800             INITIALIZE PV-CICS-MSG-AREA                          11280099
112900             STRING   ' ' WS004-SRC-TASK-NUMBER                   11290099
113000                      ' WSKCS304-4020 ERROR:'                     11300099
113100                      ' SQL='                                     11310099
113200                      PV-SQL-RETURN-CD                            11320099
113300                      DELIMITED BY SIZE                           11330099
113400                      INTO PV-CICS-MSG-AREA                       11340099
113500             PERFORM 7000-WRITE-TO-CICS-LOG                       11350099
113600             MOVE '4020-FETCH-DETAIL-CSR'                         11360099
113700                                       TO DP013-PARAGRAPH         11370099
113800             MOVE 'SUT_OTBND_CART'     TO                         11380099
113900                                       DP013-DB2-TABLE-NAME (1)   11390099
114000             MOVE 'SUT_OTBND_UPC'      TO                         11400099
114100                                       DP013-DB2-TABLE-NAME (2)   11410099
114200             MOVE 'XLT_UPC'            TO                         11420099
114300                                       DP013-DB2-TABLE-NAME (3)   11430099
114400             MOVE 'XLT_SKU'            TO                         11440099
114500                                       DP013-DB2-TABLE-NAME (4)   11450099
114600             MOVE SQLCA                TO DP013-SQLCA             11460099
114700             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            11470099
114800             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   11480099
114900                      DELIMITED BY SIZE                           11490099
115000                                     INTO DP013-MESSAGE-TEXT (1)  11500099
115100             SET DP013-DB2-ABEND       TO TRUE                    11510099
115200             PERFORM 9999-ABEND                                   11520099
115300     END-EVALUATE.                                                11530099
115400                                                                  11540099
115500/                                                                 11550099
115600 4030-CLOSE-DETAIL-CSR.                                           11560099
115700                                                                  11570099
115800     EXEC SQL                                                     11580099
115900          CLOSE DETAIL-CSR                                        11590099
116000     END-EXEC.                                                    11600099
116100                                                                  11610099
116200     EVALUATE TRUE                                                11620099
116300         WHEN SQLCODE = ZERO                                      11630099
116400             IF PS-CICS-SWITCH-YES                                11640099
116500                 INITIALIZE  PV-CICS-MSG-AREA                     11650099
116600                 STRING   ' ' WS004-SRC-TASK-NUMBER               11660099
116700                          ' WSKCS304-4010:'                       11670099
116800                          ' CLOSED DETAIL CURSOR'                 11680099
116900                          DELIMITED BY SIZE                       11690099
117000                          INTO PV-CICS-MSG-AREA                   11700099
117100                 PERFORM 7000-WRITE-TO-CICS-LOG                   11710099
117200             END-IF                                               11720099
117300         WHEN SQLCODE = -904                                      11730099
117400         WHEN SQLCODE = -913                                      11740099
117500         WHEN SQLCODE = -911                                      11750099
117600              CONTINUE                                            11760099
117700         WHEN SQLWARN0 NOT = SPACES                               11770099
117800         WHEN SQLCODE NOT = ZERO                                  11780099
117900             MOVE SQLCODE               TO PV-SQL-RETURN-CD       11790099
118000             INITIALIZE PV-CICS-MSG-AREA                          11800099
118100             STRING   ' ' WS004-SRC-TASK-NUMBER                   11810099
118200                      ' WSKCS304-4030 ERROR:'                     11820099
118300                      ' SQL='                                     11830099
118400                      PV-SQL-RETURN-CD                            11840099
118500                      DELIMITED BY SIZE                           11850099
118600                      INTO PV-CICS-MSG-AREA                       11860099
118700             PERFORM 7000-WRITE-TO-CICS-LOG                       11870099
118800             MOVE '4030-CLOSE-DETAIL-CSR'                         11880099
118900                                       TO DP013-PARAGRAPH         11890099
119000             MOVE 'INVALID CLOSE'                                 11900099
119100                                       TO DP013-MESSAGE-TEXT (1)  11910099
119200             SET DP013-DB2-ABEND       TO TRUE                    11920099
119300             PERFORM 9999-ABEND                                   11930099
119400     END-EVALUATE.                                                11940099
119500                                                                  11950099
119600/                                                                 11960099
119700 4040-SELECT-DETAIL.                                              11970099
119800                                                                  11980099
119900     MOVE 0               TO WS-SHIP-WT-QTY.                      11990099
120000     MOVE 0               TO WS-SHIP-DPTH-QTY.                    12000099
120100     MOVE 0               TO WS-SHIP-HT-QTY.                      12010099
120200     MOVE 0               TO WS-SHIP-WD-QTY.                      12020099
120300     MOVE 0               TO WS-UNIT-VOL.                         12030099
120400     MOVE 0               TO WS-CART-VOL.                         12040099
120500     MOVE 0               TO WS-UNIT-WT.                          12050099
120600     MOVE 0               TO WS-CART-WT.                          12060099
120700     MOVE 0               TO WS-SHPD-UNT-QTY.                     12070099
120800     MOVE 0               TO WS-TRN-LNE-NBR.                      12080099
120900     MOVE 0               TO WS-TOT-UNT-IN-CASE.                  12090099
121000                                                                  12100099
121100     EXEC SQL                                                     12110099
121200           SELECT  DISTINCT                                       12120099
121300                   B.TRN_NBR                                      12130099
121400                 , B.RCVR_SEQ_NBR                                 12140099
121500                 , D.SKU_NBR                                      12150099
121600                 , C.INTR_UPC_ID                                  12160099
121700                 , B.SHPD_UNT_QTY                                 12170099
121800                 , B.TRN_LNE_NBR                                  12180099
121900          INTO                                                    12190099
122000                :SUT00028-TRN-NBR                                 12200099
122100               ,:SUT00028-RCVR-SEQ-NBR                            12210099
122200               ,:XLT00003-SKU-NBR                                 12220099
122300               ,:XLT00006-INTR-UPC-ID                             12230099
122400               ,:SUT00028-SHPD-UNT-QTY                            12240099
122500               ,:SUT00028-TRN-LNE-NBR                             12250099
122600           FROM    SUT_OTBND_CART A                               12260099
122700                 , SUT_OTBND_UPC  B                               12270099
122800                 , XLT_UPC        C                               12280099
122900                 , XLT_SKU        D                               12290099
123000           WHERE   A.SHIPT_UNT_ID   = :DK-SHPT-UNT-ID             12300099
123100           AND     C.INTR_UPC_ID    = D.INTR_UPC_ID               12310099
123200           AND     B.UPC_NBR        = C.UPC_NBR                   12320099
123300           AND     A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID              12330099
123400           AND     B.SHPD_UNT_QTY   > 0                           12340099
123500           AND     A.ACTV_IND       = 'Y'                         12350099
123600     END-EXEC.                                                    12360099
123700                                                                  12370099
123800     EVALUATE TRUE                                                12380099
123900         WHEN SQLCODE = ZERO                                      12390099
124000             MOVE XLT00003-SKU-NBR      TO WS-SKU-NBR             12400099
124100             MOVE SUT00028-RCVR-SEQ-NBR TO WS-RCVR-SEQ-NBR        12410099
124200             MOVE XLT00006-INTR-UPC-ID  TO DK-INTR-UPC-ID         12420099
124300             MOVE SUT00028-TRN-NBR      TO DK-TRN-NBR             12430099
124400             MOVE SUT00028-SHPD-UNT-QTY TO WS-SHPD-UNT-QTY        12440099
124500             MOVE SUT00028-TRN-LNE-NBR  TO WS-TRN-LNE-NBR         12450099
124600                                                                  12460099
124700             IF PS-CICS-SWITCH-YES                                12470099
124800                 INITIALIZE  PV-CICS-MSG-AREA                     12480099
124900                 MOVE WS-SKU-NBR        TO WS-DISPLAY-1           12490099
125000                 MOVE WS-RCVR-SEQ-NBR   TO WS-DISPLAY-6           12500099
125100                 MOVE DK-INTR-UPC-ID    TO WS-DISPLAY-3           12510099
125200                 MOVE DK-TRN-NBR        TO WS-DISPLAY-4           12520099
125300                 MOVE WS-SHPD-UNT-QTY   TO WS-DISPLAY-5           12530099
125400                 MOVE WS-TRN-LNE-NBR    TO WS-DISPLAY-7           12540099
125500                 STRING   ' ' WS004-SRC-TASK-NUMBER               12550099
125600                          ' WSKCS304-4040:'                       12560099
125700                          ' PO='  WS-DISPLAY-4                    12570099
125800                          '-' WS-DISPLAY-6                        12580099
125900                          ' SKU='  WS-DISPLAY-1                   12590099
126000                          ' INTR-UPCID='  WS-DISPLAY-3            12600099
126100                          ' QTY='  WS-DISPLAY-5                   12610099
126200                          ' LNE='  WS-DISPLAY-7                   12620099
126300                          DELIMITED BY SIZE                       12630099
126400                          INTO PV-CICS-MSG-AREA                   12640099
126500                 PERFORM 7000-WRITE-TO-CICS-LOG                   12650099
126600             END-IF                                               12660099
126700                                                                  12670099
126800             PERFORM 6000-CREATE-CASE-DTL                         12680099
126900             PERFORM 5000-CREATE-CASE-HDR                         12690099
127000                                                                  12700099
127100         WHEN SQLCODE = -904                                      12710099
127200         WHEN SQLCODE = -913                                      12720099
127300         WHEN SQLCODE = -911                                      12730099
127400             CONTINUE                                             12740099
127500         WHEN SQLCODE = +100                                      12750099
127600             CONTINUE                                             12760099
127700         WHEN SQLWARN0 NOT = SPACES                               12770099
127800         WHEN SQLCODE NOT = ZERO                                  12780099
127900             MOVE SQLCODE               TO PV-SQL-RETURN-CD       12790099
128000             INITIALIZE PV-CICS-MSG-AREA                          12800099
128100             STRING   ' ' WS004-SRC-TASK-NUMBER                   12810099
128200                      ' WSKCS304-4040 ERROR:'                     12820099
128300                      ' SQL='                                     12830099
128400                      PV-SQL-RETURN-CD                            12840099
128500                      DELIMITED BY SIZE                           12850099
128600                      INTO PV-CICS-MSG-AREA                       12860099
128700             PERFORM 7000-WRITE-TO-CICS-LOG                       12870099
128800             MOVE '4040-SELECT-DETAIL-CSR'                        12880099
128900                                       TO DP013-PARAGRAPH         12890099
129000             MOVE 'SUT_OTBND_CART'     TO                         12900099
129100                                       DP013-DB2-TABLE-NAME (1)   12910099
129200             MOVE 'SUT_OTBND_UPC'      TO                         12920099
129300                                       DP013-DB2-TABLE-NAME (2)   12930099
129400             MOVE 'XLT_UPC'            TO                         12940099
129500                                       DP013-DB2-TABLE-NAME (3)   12950099
129600             MOVE 'XLT_SKU'            TO                         12960099
129700                                       DP013-DB2-TABLE-NAME (4)   12970099
129800             MOVE SQLCA                TO DP013-SQLCA             12980099
129900             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            12990099
130000             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   13000099
130100                      DELIMITED BY SIZE                           13010099
130200                                     INTO DP013-MESSAGE-TEXT (1)  13020099
130300             SET DP013-DB2-ABEND       TO TRUE                    13030099
130400             PERFORM 9999-ABEND                                   13040099
130500     END-EVALUATE.                                                13050099
130600                                                                  13060099
130700/                                                                 13070099
130800 5000-CREATE-CASE-HDR.                                            13080099
130900                                                                  13090099
131000     INITIALIZE WS006-CASE-HDR-REC.                               13100099
131010                                                                  13101099
131011*                                                                 13101199
131012**  DMH 3/19/2020 BEGIN                                           13101299
131013*                                                                 13101399
131014                                                                  13101499
131020     IF  PV-PO-COUNT    >  1  AND                                 13102099
131030         PS-STR-TO-EFC-YES                                        13103099
131031         MOVE PV-STR-TO-EFC-PO  TO  DK-TRN-NBR                    13103199
131032     END-IF                                                       13103299
131033*                                                                 13103399
131034**  DMH 3/19/2020 BEGIN                                           13103499
131035*                                                                 13103599
131040                                                                  13104099
131100     PERFORM 5010-GET-PURCH-INFO.                                 13110099
131200     PERFORM 5020-GET-SKU-INFO.                                   13120099
131300     PERFORM 5030-INSERT-ASN-DWNLD.                               13130099
131400                                                                  13140099
131500     IF PS-DAT-LEVEL-DETAILS                                      13150099
131600         MOVE 'ASN WSRD006'      TO WS-PRC-TYP-CDE                13160099
131700         MOVE 300                TO WS-DAT-TXT-LEN                13170099
131800         MOVE WS006-CASE-HDR-REC TO WS-DAT-TXT-TEXT               13180099
131900         PERFORM 8020-WRITE-DAT-XFER                              13190099
132000     END-IF.                                                      13200099
132100                                                                  13210099
132200     ADD 1 TO WS-ROW-CNT.                                         13220099
132300     ADD 1 TO WS-GP-CNT.                                          13230099
132400                                                                  13240099
132500/                                                                 13250099
132600 5010-GET-PURCH-INFO.                                             13260099
132700                                                                  13270099
132800     EXEC SQL                                                     13280099
132900          SELECT ENT_ID                                           13290099
133000          INTO   :PURCHS-ENT-ID                                   13300099
133100          FROM   TPURCHS                                          13310099
133200          WHERE  PO_NBR         = :DK-TRN-NBR                     13320099
133300          AND    VER_STATUS_CDE = 'A'                             13330099
133310           WITH UR                                                13331099
133400     END-EXEC.                                                    13340099
133500                                                                  13350099
133600     EVALUATE TRUE                                                13360099
133700         WHEN SQLCODE = ZERO                                      13370099
133800             MOVE PURCHS-ENT-ID TO WS-ENT-ID                      13380099
133900                                       WS-DISPLAY-1               13390099
134000             IF PS-CICS-SWITCH-YES                                13400099
134100                 INITIALIZE  PV-CICS-MSG-AREA                     13410099
134200                 STRING   ' ' WS004-SRC-TASK-NUMBER               13420099
134300                          ' WSKCS304-5010:'                       13430099
134400                          ' ENT='                                 13440099
134500                          WS-DISPLAY-1                            13450099
134600                          DELIMITED BY SIZE                       13460099
134700                          INTO PV-CICS-MSG-AREA                   13470099
134800                 PERFORM 7000-WRITE-TO-CICS-LOG                   13480099
134900             END-IF                                               13490099
135000         WHEN SQLCODE = -904                                      13500099
135100         WHEN SQLCODE = -913                                      13510099
135200         WHEN SQLCODE = -911                                      13520099
135300         WHEN SQLCODE = +100                                      13530099
135301             MOVE ZEROES        TO PURCHS-ENT-ID                  13530199
135310                                   WS-ENT-ID                      13531099
135320                                   WS-DISPLAY-1                   13532099
135330             MOVE SQLCODE       TO PV-DISP-SQL                    13533099
135400                                                                  13540099
135410             IF PS-CICS-SWITCH-YES                                13541099
135420                 INITIALIZE  PV-CICS-MSG-AREA                     13542099
135430                 STRING   ' ' WS004-SRC-TASK-NUMBER               13543099
135440                          ' WSKCS304-5010: '                      13544099
135441                          ' SQL:'  PV-DISP-SQL                    13544199
135450                          ' ENT='  WS-DISPLAY-1                   13545099
135470                               DELIMITED BY SIZE                  13547099
135480                          INTO PV-CICS-MSG-AREA                   13548099
135490                 PERFORM 7000-WRITE-TO-CICS-LOG                   13549099
135491             END-IF                                               13549199
135492                                                                  13549299
135493             PERFORM 5015-GET-ENT-FOR-FXR                         13549399
135494                                                                  13549499
135500         WHEN SQLWARN0 NOT = SPACES                               13550099
135600         WHEN SQLCODE NOT = ZERO                                  13560099
135700             MOVE SQLCODE               TO PV-SQL-RETURN-CD       13570099
135800             INITIALIZE PV-CICS-MSG-AREA                          13580099
135900             STRING   ' ' WS004-SRC-TASK-NUMBER                   13590099
136000                      ' WSKCS304-5010 ERROR:'                     13600099
136100                      ' SQL='                                     13610099
136200                      PV-SQL-RETURN-CD                            13620099
136300                      DELIMITED BY SIZE                           13630099
136400                      INTO PV-CICS-MSG-AREA                       13640099
136500             PERFORM 7000-WRITE-TO-CICS-LOG                       13650099
136600             MOVE '5010-GET-PURCH-INFO'                           13660099
136700                                       TO DP013-PARAGRAPH         13670099
136800             MOVE 'TPURCHS'            TO                         13680099
136900                                       DP013-DB2-TABLE-NAME (1)   13690099
137000             MOVE SQLCA                TO DP013-SQLCA             13700099
137100             MOVE DK-TRN-NBR           TO WS-DISPLAY-1            13710099
137200             STRING 'TRN NBR=' WS-DISPLAY-1                       13720099
137300                      DELIMITED BY SIZE                           13730099
137400                                     INTO DP013-MESSAGE-TEXT (1)  13740099
137500             SET DP013-DB2-ABEND       TO TRUE                    13750099
137600             PERFORM 9999-ABEND                                   13760099
137700     END-EVALUATE.                                                13770099
137800                                                                  13780099
137900/                                                                 13790099
137910 5015-GET-ENT-FOR-FXR.                                            13791099
137920                                                                  13792099
137930     EXEC SQL                                                     13793099
137940          SELECT D.ENT_ID                                         13794099
137950          INTO   :XLT00004-ENT-ID                                 13795099
137960          FROM   SUT_OTBND_UPC A                                  13796099
137970               , XLT_UPC B                                        13797099
137980               , XLT_SKU C                                        13798099
137981               , XLT_VND_STYL D                                   13798199
137990          WHERE  A.SHIPT_UNT_ID = :DK-SHPT-UNT-ID                 13799099
137991          AND    A.SHPD_UNT_QTY > 0                               13799199
137992          AND    A.UPC_NBR      = B.UPC_NBR                       13799299
137993          AND    B.INTR_UPC_ID  = C.INTR_UPC_ID                   13799399
137994          AND    C.STYL_ID      = D.STYL_ID                       13799499
137995          WITH UR                                                 13799599
137996     END-EXEC.                                                    13799699
137997                                                                  13799799
137998     EVALUATE TRUE                                                13799899
137999         WHEN SQLCODE = ZERO                                      13799999
138000         WHEN SQLCODE = -811                                      13800099
138001             MOVE XLT00004-ENT-ID TO PURCHS-ENT-ID                13800199
138002                                     WS-ENT-ID                    13800299
138003         WHEN SQLCODE = +100                                      13800399
138004             MOVE 999999          TO PURCHS-ENT-ID                13800499
138005                                     WS-ENT-ID                    13800599
138024         WHEN SQLCODE = -904                                      13802499
138025         WHEN SQLCODE = -913                                      13802599
138026         WHEN SQLCODE = -911                                      13802699
138027              CONTINUE                                            13802799
138028         WHEN SQLWARN0 NOT = SPACES                               13802899
138029         WHEN SQLCODE NOT = ZERO                                  13802999
138030             MOVE SQLCODE               TO PV-SQL-RETURN-CD       13803099
138031             INITIALIZE PV-CICS-MSG-AREA                          13803199
138032             STRING   ' ' WS004-SRC-TASK-NUMBER                   13803299
138033                      ' WSKCS304-5015 SKU ENT ID ERROR:'          13803399
138034                      ' SQL='                                     13803499
138035                      PV-SQL-RETURN-CD                            13803599
138036                      DELIMITED BY SIZE                           13803699
138037                      INTO PV-CICS-MSG-AREA                       13803799
138038             PERFORM 7000-WRITE-TO-CICS-LOG                       13803899
138039             MOVE '5015-GET-ENT-FOR-FXR'                          13803999
138040                                       TO DP013-PARAGRAPH         13804099
138041             MOVE 'XLT_VND_STYL'       TO                         13804199
138042                                       DP013-DB2-TABLE-NAME (1)   13804299
138043             MOVE 'XLT_UPC'            TO                         13804399
138044                                       DP013-DB2-TABLE-NAME (2)   13804499
138045             MOVE 'XLT_SKU'            TO                         13804599
138046                                       DP013-DB2-TABLE-NAME (3)   13804699
138047             MOVE SQLCA                TO DP013-SQLCA             13804799
138048             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            13804899
138049             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   13804999
138050                      DELIMITED BY SIZE                           13805099
138051                                     INTO DP013-MESSAGE-TEXT (1)  13805199
138052             SET DP013-DB2-ABEND       TO TRUE                    13805299
138053             PERFORM 9999-ABEND                                   13805399
138054     END-EVALUATE.                                                13805499
138055                                                                  13805599
138060 5020-GET-SKU-INFO.                                               13806099
138100                                                                  13810099
138200     EXEC SQL                                                     13820099
138300          SELECT C.SKU_NBR                                        13830099
138400          INTO   :XLT00003-SKU-NBR                                13840099
138500          FROM   SUT_OTBND_UPC A                                  13850099
138600               , XLT_UPC B                                        13860099
138700               , XLT_SKU C                                        13870099
138800          WHERE  A.SHIPT_UNT_ID = :DK-SHPT-UNT-ID                 13880099
138900          AND    A.SHPD_UNT_QTY > 0                               13890099
139000          AND    A.UPC_NBR      = B.UPC_NBR                       13900099
139100          AND    B.INTR_UPC_ID  = C.INTR_UPC_ID                   13910099
139110          WITH UR                                                 13911099
139200     END-EXEC.                                                    13920099
139300                                                                  13930099
139400     EVALUATE TRUE                                                13940099
139500         WHEN SQLCODE = ZERO                                      13950099
139600         WHEN SQLCODE = +100                                      13960099
139700             SET WS006-CH-SNGL-SKU TO TRUE                        13970099
139800             IF PS-CICS-SWITCH-YES                                13980099
139900                 INITIALIZE  PV-CICS-MSG-AREA                     13990099
140000                 STRING   ' ' WS004-SRC-TASK-NUMBER               14000099
140100                          ' WSKCS304-5020:'                       14010099
140200                          ' CH-SNGL-SKU'                          14020099
140300                          DELIMITED BY SIZE                       14030099
140400                          INTO PV-CICS-MSG-AREA                   14040099
140500                 PERFORM 7000-WRITE-TO-CICS-LOG                   14050099
140600             END-IF                                               14060099
140700         WHEN SQLCODE = -811                                      14070099
140800             SET WS006-CH-MULT-SKU TO TRUE                        14080099
140900             IF PS-CICS-SWITCH-YES                                14090099
141000                 INITIALIZE  PV-CICS-MSG-AREA                     14100099
141100                 STRING   ' ' WS004-SRC-TASK-NUMBER               14110099
141200                          ' WSKCS304-5020:'                       14120099
141300                          ' CH-MULT-SKU'                          14130099
141400                          DELIMITED BY SIZE                       14140099
141500                          INTO PV-CICS-MSG-AREA                   14150099
141600                 PERFORM 7000-WRITE-TO-CICS-LOG                   14160099
141700             END-IF                                               14170099
141800         WHEN SQLCODE = -904                                      14180099
141900         WHEN SQLCODE = -913                                      14190099
142000         WHEN SQLCODE = -911                                      14200099
142100              CONTINUE                                            14210099
142200         WHEN SQLWARN0 NOT = SPACES                               14220099
142300         WHEN SQLCODE NOT = ZERO                                  14230099
142400             MOVE SQLCODE               TO PV-SQL-RETURN-CD       14240099
142500             INITIALIZE PV-CICS-MSG-AREA                          14250099
142600             STRING   ' ' WS004-SRC-TASK-NUMBER                   14260099
142700                      ' WSKCS304-5020 SELECT SKU ERROR:'          14270099
142800                      ' SQL='                                     14280099
142900                      PV-SQL-RETURN-CD                            14290099
143000                      DELIMITED BY SIZE                           14300099
143100                      INTO PV-CICS-MSG-AREA                       14310099
143200             PERFORM 7000-WRITE-TO-CICS-LOG                       14320099
143300             MOVE '5020-GET-SKU-INFO'                             14330099
143400                                       TO DP013-PARAGRAPH         14340099
143500             MOVE 'SUT_OTBND_UPC'      TO                         14350099
143600                                       DP013-DB2-TABLE-NAME (1)   14360099
143700             MOVE 'XLT_UPC'            TO                         14370099
143800                                       DP013-DB2-TABLE-NAME (2)   14380099
143900             MOVE 'XLT_SKU'            TO                         14390099
144000                                       DP013-DB2-TABLE-NAME (3)   14400099
144100             MOVE SQLCA                TO DP013-SQLCA             14410099
144200             MOVE DK-SHPT-UNT-ID       TO WS-DISPLAY-2            14420099
144300             STRING 'SHPT UNT ID=' WS-DISPLAY-2                   14430099
144400                      DELIMITED BY SIZE                           14440099
144500                                     INTO DP013-MESSAGE-TEXT (1)  14450099
144600             SET DP013-DB2-ABEND       TO TRUE                    14460099
144700             PERFORM 9999-ABEND                                   14470099
144800     END-EVALUATE.                                                14480099
144900                                                                  14490099
145000/                                                                 14500099
145100 5030-INSERT-ASN-DWNLD.                                           14510099
145200                                                                  14520099
145300     SET WS006-CH-ADD             TO TRUE.                        14530099
145400     SET WS006-CH-CSE-HDR         TO TRUE.                        14540099
145500     MOVE WS-CRE-USR-ID           TO WS006-CH-CREATE-USERID.      14550099
145600     MOVE WS-CRE-TMST             TO WS006-CH-CREATE-TMST.        14560099
145700     MOVE DK-SHIPT-ID             TO WS006-CH-ORIG-SHPMT-NBR.     14570099
145800     MOVE WS-DEST-OPER-UNT-ID     TO WS006-CH-WHSE.               14580099
145900     MOVE DK-SHPT-UNT-ID          TO WS-SHPT-UNT-ID.              14590099
146000     MOVE WS-SHPT-UNT-ID          TO WS006-CH-CASE-NBR.           14600099
146100     MOVE WS-RCVR-SEQ-NBR         TO WS006-CH-RCVR-SEQ-NBR.       14610099
146200     MOVE DK-TRIP-ID              TO WS006-CH-TRIP-ID.            14620099
146300     MOVE DK-TRN-NBR              TO WS006-CH-PO-NBR.             14630099
146400     MOVE WS-SHIP-SCAC-CDE        TO WS006-CH-SCAC.               14640099
146500     MOVE WS-TRLR-ID              TO WS006-CH-TRLR-ID.            14650099
146600     MOVE WS-ENT-ID               TO WS006-CH-VENDOR-ID.          14660099
146700     MOVE WS-TOT-UNT-IN-CASE      TO WS006-CH-SHPD-UNT-QTY.       14670099
146800     MOVE WS-CART-WT              TO WS006-CH-EST-WEIGHT.         14680099
146900     MOVE WS-HOST-INPT-ID         TO WS006-CH-HOST-INPT-ID.       14690099
147000     SET WS006-CH-FINDLAY-SHIPMT  TO TRUE.                        14700099
147100     MOVE WS-CART-VOL             TO WS006-CH-SHPD-UNT-VOL.       14710099
147200                                                                  14720099
147300     MOVE DK-SHIPT-ID             TO WST00011-EXT-SHP-ID.         14730099
147400     MOVE PV-REPOS-TIMESTAMP      TO WST00011-CRE-TMST.           14740099
147500     MOVE WS-ROW-CNT              TO WST00011-ROW-NBR.            14750099
147600     MOVE WS-GP-CNT               TO WST00011-REC-TYP-GP-NBR.     14760099
147700     MOVE 'CH'                    TO WST00011-REC-TYP-CDE.        14770099
147800     MOVE PV-SQL-COUNT            TO WST00011-CSE-DTL-NBR.        14780099
147900     MOVE 300                     TO WST00011-REC-TYP-DESC-LEN.   14790099
148000     MOVE WS006-CASE-HDR-REC      TO WST00011-REC-TYP-DESC-TEXT.  14800099
148100                                                                  14810099
148200     PERFORM 9000-INSERT-TEMP-TABLE.                              14820099
148300                                                                  14830099
148400/                                                                 14840099
148500 5500-CREATE-ASN-HDR.                                             14850099
148600                                                                  14860099
148700     INITIALIZE WS004-ASN-REC.                                    14870099
148800     PERFORM 5530-INSERT-ASN-DWNLD.                               14880099
148900                                                                  14890099
149000     IF PS-DAT-LEVEL-DETAILS                                      14900099
149100       OR PS-DAT-LEVEL-HEADER                                     14910099
149200         MOVE 'ASN WSRD004'      TO WS-PRC-TYP-CDE                14920099
149300         MOVE 300                TO WS-DAT-TXT-LEN                14930099
149400         MOVE WS004-ASN-REC      TO WS-DAT-TXT-TEXT               14940099
149500         PERFORM 8020-WRITE-DAT-XFER                              14950099
149600     END-IF.                                                      14960099
149700                                                                  14970099
149800     ADD 1 TO WS-ROW-CNT.                                         14980099
149900     ADD 1 TO WS-GP-CNT.                                          14990099
150000                                                                  15000099
150100                                                                  15010099
150200 5510-GET-DC-SHIPPED-INFO.                                        15020099
150300                                                                  15030099
150400     EXEC SQL                                                     15040099
150500          SELECT OTBND_STAT_TMST                                  15050099
150600          INTO   :SUOBTS-OTBND-STAT-TMST                          15060099
150700          FROM   TSUOBTS                                          15070099
150800          WHERE  OTBND_TRIP_ID    = :DK-TRIP-ID                   15080099
150900          AND    TRIP_STAT_CDE    = 'DS'                          15090099
151000     END-EXEC.                                                    15100099
151100                                                                  15110099
151200     EVALUATE TRUE                                                15120099
151300         WHEN SQLCODE = ZERO                                      15130099
151400             MOVE SUOBTS-OTBND-STAT-TMST (1:4) TO                 15140099
151500                                           WS-SHIP-DATE (1:4)     15150099
151600             MOVE SUOBTS-OTBND-STAT-TMST (6:2) TO                 15160099
151700                                           WS-SHIP-DATE (5:2)     15170099
151800             MOVE SUOBTS-OTBND-STAT-TMST (9:2) TO                 15180099
151900                                           WS-SHIP-DATE (7:2)     15190099
152000             MOVE SUOBTS-OTBND-STAT-TMST (12:2) TO                15200099
152100                                           WS-SHIP-DATE (9:2)     15210099
152200             MOVE SUOBTS-OTBND-STAT-TMST (15:2) TO                15220099
152300                                           WS-SHIP-DATE (11:2)    15230099
152400             MOVE SUOBTS-OTBND-STAT-TMST (18:2) TO                15240099
152500                                           WS-SHIP-DATE (13:2)    15250099
152600             IF PS-CICS-SWITCH-YES                                15260099
152700                 INITIALIZE  PV-CICS-MSG-AREA                     15270099
152800                 STRING   ' ' WS004-SRC-TASK-NUMBER               15280099
152900                          ' WSKCS304-5510:'                       15290099
153000                          ' OTBND STAT TMST='                     15300099
153100                          WS-SHIP-DATE                            15310099
153200                          DELIMITED BY SIZE                       15320099
153300                          INTO PV-CICS-MSG-AREA                   15330099
153400                 PERFORM 7000-WRITE-TO-CICS-LOG                   15340099
153500             END-IF                                               15350099
153600         WHEN SQLCODE = -904                                      15360099
153700         WHEN SQLCODE = -913                                      15370099
153800         WHEN SQLCODE = -911                                      15380099
153900         WHEN SQLCODE = +100                                      15390099
154000             MOVE PC-DEFAULT-DATE  TO WS-SHIP-DATE                15400099
154100             IF PS-CICS-SWITCH-YES                                15410099
154200                 INITIALIZE  PV-CICS-MSG-AREA                     15420099
154300                 MOVE DK-TRIP-ID TO WS-DISPLAY-1                  15430099
154400                 STRING   ' ' WS004-SRC-TASK-NUMBER               15440099
154500                          ' WSKCS304-5510:'                       15450099
154600                          ' NO DC SHIPPED ROW FOR '               15460099
154700                          WS-DISPLAY-1                            15470099
154800                          DELIMITED BY SIZE                       15480099
154900                          INTO PV-CICS-MSG-AREA                   15490099
155000                 PERFORM 7000-WRITE-TO-CICS-LOG                   15500099
155100             END-IF                                               15510099
155200         WHEN SQLWARN0 NOT = SPACES                               15520099
155300         WHEN SQLCODE NOT = ZERO                                  15530099
155400             MOVE SQLCODE               TO PV-SQL-RETURN-CD       15540099
155500             INITIALIZE PV-CICS-MSG-AREA                          15550099
155600             STRING   ' ' WS004-SRC-TASK-NUMBER                   15560099
155700                      ' WSKCS304-5510 ERROR:'                     15570099
155800                      ' SQL='                                     15580099
155900                      PV-SQL-RETURN-CD                            15590099
156000                      DELIMITED BY SIZE                           15600099
156100                      INTO PV-CICS-MSG-AREA                       15610099
156200             PERFORM 7000-WRITE-TO-CICS-LOG                       15620099
156300             MOVE '5510-GET-DC-SHIPPED-INFO'                      15630099
156400                                       TO DP013-PARAGRAPH         15640099
156500             MOVE 'TSUOBTS'            TO                         15650099
156600                                       DP013-DB2-TABLE-NAME (1)   15660099
156700             MOVE SQLCA                TO DP013-SQLCA             15670099
156800             MOVE DK-TRIP-ID           TO WS-DISPLAY-1            15680099
156900             STRING 'TRIP ID=' WS-DISPLAY-1                       15690099
157000                      DELIMITED BY SIZE                           15700099
157100                                     INTO DP013-MESSAGE-TEXT (1)  15710099
157200             SET DP013-DB2-ABEND       TO TRUE                    15720099
157300             PERFORM 9999-ABEND                                   15730099
157400     END-EVALUATE.                                                15740099
157500                                                                  15750099
157600/                                                                 15760099
157700 5530-INSERT-ASN-DWNLD.                                           15770099
157800                                                                  15780099
157900     SET WS004-AH-ADD             TO TRUE.                        15790099
158000     SET WS004-AH-ASN-HDR         TO TRUE.                        15800099
158100     MOVE WS-CRE-USR-ID           TO WS004-AH-CREATE-USERID.      15810099
158200     MOVE WS-CRE-TMST             TO WS004-AH-CREATE-TMST.        15820099
158300     MOVE DK-SHIPT-ID             TO WS004-AH-SHIPMT-NBR.         15830099
158400     MOVE WS-DEST-OPER-UNT-ID     TO WS004-AH-WHSE.               15840099
158500     MOVE SPACES                  TO WS004-AH-BOL-NBR.            15850099
158600     MOVE WS-SCAC-CDE             TO WS004-AH-CARRIER-SHIP-VIA.   15860099
158700     MOVE WS-TRLR-ID              TO WS004-AH-TRLR-NBR.           15870099
158800     MOVE DK-TRIP-ID              TO WS004-AH-TRIP-ID.            15880099
158900     MOVE SPACES                  TO WS004-AH-PRO-NBR.            15890099
159000     MOVE WS-SHIP-DATE            TO WS004-AH-SHIP-DATE.          15900099
159100     MOVE WS-SHIP-DATE            TO WS004-AH-EXPT-START-DATE.    15910099
159200     SET WS004-AH-NO-TROUBLE      TO TRUE.                        15920099
159300     SET WS004-AH-UN-SHIPPED      TO TRUE.                        15930099
159400     SET WS004-AH-DONT-CREATE-APPT TO TRUE.                       15940099
159500     SET WS004-AH-FINDLAY-SHIPMT  TO TRUE.                        15950099
159600     MOVE WS-HOST-INPT-ID         TO WS004-AH-HOST-INPT-ID.       15960099
159700                                                                  15970099
159800     MOVE DK-SHIPT-ID             TO WST00011-EXT-SHP-ID.         15980099
159900     MOVE PV-REPOS-TIMESTAMP      TO WST00011-CRE-TMST.           15990099
160000     MOVE WS-ROW-CNT              TO WST00011-ROW-NBR.            16000099
160100     MOVE WS-GP-CNT               TO WST00011-REC-TYP-GP-NBR.     16010099
160200     MOVE 'AH'                    TO WST00011-REC-TYP-CDE.        16020099
160300     MOVE PC-HIGH-NINES           TO WST00011-CSE-DTL-NBR.        16030099
160400     MOVE 300                     TO WST00011-REC-TYP-DESC-LEN.   16040099
160500     MOVE WS004-ASN-REC           TO WST00011-REC-TYP-DESC-TEXT.  16050099
160600                                                                  16060099
160700     PERFORM 9000-INSERT-TEMP-TABLE.                              16070099
160800                                                                  16080099
160900/                                                                 16090099
161000 6000-CREATE-CASE-DTL.                                            16100099
161100                                                                  16110099
161200     INITIALIZE WS007-CASE-DTL-REC.                               16120099
161300     PERFORM 6010-GET-WEBITM-INFO.                                16130099
161400     PERFORM 6030-WRITE-ASN-DWNLD.                                16140099
161500                                                                  16150099
161600     IF PS-DAT-LEVEL-DETAILS                                      16160099
161700         MOVE 'ASN WSRD007'      TO WS-PRC-TYP-CDE                16170099
161800         MOVE 300                TO WS-DAT-TXT-LEN                16180099
161900         MOVE WS007-CASE-DTL-REC TO WS-DAT-TXT-TEXT               16190099
162000         PERFORM 8020-WRITE-DAT-XFER                              16200099
162100     END-IF.                                                      16210099
162200                                                                  16220099
162300     ADD 1 TO WS-ROW-CNT.                                         16230099
162400                                                                  16240099
162500/                                                                 16250099
162600 6010-GET-WEBITM-INFO.                                            16260099
162700                                                                  16270099
162800     EXEC SQL                                                     16280099
162900          SELECT SHIP_WT_QTY                                      16290099
163000             ,   SHIP_DPTH_QTY                                    16300099
163100             ,   SHIP_HT_QTY                                      16310099
163110             ,   SHIP_WD_QTY                                      16311099
163120          INTO   :WEBITM-SHIP-WT-QTY                              16312099
163130             ,   :WEBITM-SHIP-DPTH-QTY                            16313099
163140             ,   :WEBITM-SHIP-HT-QTY                              16314099
163150             ,   :WEBITM-SHIP-WD-QTY                              16315099
163160          FROM   TWEBITM                                          16316099
163170          WHERE  INTR_UPC_ID    = :DK-INTR-UPC-ID                 16317099
163180          AND    EFF_END_TMST   IS NULL                           16318099
163190     END-EXEC.                                                    16319099
163200                                                                  16320099
163300     EVALUATE TRUE                                                16330099
163400         WHEN SQLCODE = ZERO                                      16340099
163500             MOVE WEBITM-SHIP-WT-QTY    TO WS-SHIP-WT-QTY         16350099
163600             MOVE WEBITM-SHIP-DPTH-QTY  TO WS-SHIP-DPTH-QTY       16360099
163700             MOVE WEBITM-SHIP-HT-QTY    TO WS-SHIP-HT-QTY         16370099
163800             MOVE WEBITM-SHIP-WD-QTY    TO WS-SHIP-WD-QTY         16380099
163900             IF PS-CICS-SWITCH-YES                                16390099
164000                 INITIALIZE  PV-CICS-MSG-AREA                     16400099
164100                 MOVE WS-SHIP-WT-QTY    TO WS-DISPLAY-1           16410099
164200                 STRING   ' ' WS004-SRC-TASK-NUMBER               16420099
164300                          ' WSKCS304-6010:'                       16430099
164400                          ' WT-QTY=' WS-DISPLAY-1                 16440099
164500                          DELIMITED BY SIZE                       16450099
164600                          INTO PV-CICS-MSG-AREA                   16460099
164700                 PERFORM 7000-WRITE-TO-CICS-LOG                   16470099
164800             END-IF                                               16480099
164900         WHEN SQLCODE = -904                                      16490099
165000         WHEN SQLCODE = -913                                      16500099
165100         WHEN SQLCODE = -911                                      16510099
165200         WHEN SQLCODE = +100                                      16520099
165300             MOVE 0                  TO WS-SHIP-WT-QTY            16530099
165400             MOVE 0                  TO WS-SHIP-DPTH-QTY          16540099
165500             MOVE 0                  TO WS-SHIP-HT-QTY            16550099
165510             MOVE 0                  TO WS-SHIP-WD-QTY            16551099
165520             IF PS-CICS-SWITCH-YES                                16552099
165530                 INITIALIZE  PV-CICS-MSG-AREA                     16553099
165540                 MOVE DK-INTR-UPC-ID TO WS-DISPLAY-1              16554099
165550                 STRING   ' ' WS004-SRC-TASK-NUMBER               16555099
165560                          ' WSKCS304-6010:'                       16556099
165570                          ' WT-QTY IS ZERO FOR INTR UPC ID='      16557099
165580                          WS-DISPLAY-1                            16558099
165590                          DELIMITED BY SIZE                       16559099
165600                          INTO PV-CICS-MSG-AREA                   16560099
165700                 PERFORM 7000-WRITE-TO-CICS-LOG                   16570099
165800             END-IF                                               16580099
165900         WHEN SQLWARN0 NOT = SPACES                               16590099
166000         WHEN SQLCODE NOT = ZERO                                  16600099
166100             MOVE SQLCODE               TO PV-SQL-RETURN-CD       16610099
166200             INITIALIZE PV-CICS-MSG-AREA                          16620099
166300             STRING   ' ' WS004-SRC-TASK-NUMBER                   16630099
166400                      ' WSKCS304-6010 ERROR:'                     16640099
166500                      ' SQL='                                     16650099
166600                      PV-SQL-RETURN-CD                            16660099
166700                      DELIMITED BY SIZE                           16670099
166800                      INTO PV-CICS-MSG-AREA                       16680099
166900             PERFORM 7000-WRITE-TO-CICS-LOG                       16690099
167000             MOVE '6010-GET-WEBITM-INFO'                          16700099
167100                                       TO DP013-PARAGRAPH         16710099
167200             MOVE 'TWEBITM'            TO                         16720099
167300                                       DP013-DB2-TABLE-NAME (1)   16730099
167400             MOVE SQLCA                TO DP013-SQLCA             16740099
167500             MOVE DK-INTR-UPC-ID       TO WS-DISPLAY-1            16750099
167600             STRING 'INTR UPC ID=' WS-DISPLAY-1                   16760099
167700                      DELIMITED BY SIZE                           16770099
167800                                     INTO DP013-MESSAGE-TEXT (1)  16780099
167900             SET DP013-DB2-ABEND       TO TRUE                    16790099
168000             PERFORM 9999-ABEND                                   16800099
168100     END-EVALUATE.                                                16810099
168200                                                                  16820099
168300/                                                                 16830099
168400 6030-WRITE-ASN-DWNLD.                                            16840099
168500                                                                  16850099
168600     SET WS007-CD-ADD             TO TRUE.                        16860099
168700     SET WS007-CD-CSE-DTL         TO TRUE.                        16870099
168800     MOVE WS-CRE-USR-ID           TO WS007-CD-CREATE-USERID.      16880099
168900     MOVE WS-CRE-TMST             TO WS007-CD-CREATE-TMST.        16890099
169000     MOVE DK-SHPT-UNT-ID          TO WS-SHPT-UNT-ID.              16900099
169100     MOVE WS-SHPT-UNT-ID          TO WS007-CD-CASE-NBR.           16910099
169200     MOVE WS-SKU-NBR              TO WS007-CD-SKU-NBR.            16920099
169300     MOVE WS-SKU-NBR              TO WS007-CD-SKU-ID.             16930099
169400     MOVE WS-SHPD-UNT-QTY         TO WS007-CD-SHIPD-UNT-QTY.      16940099
169500     MOVE WS-TRN-LNE-CDE(6:4)     TO WS007-CD-PO-LINE-NBR.        16950099
169600     ADD WS-SHPD-UNT-QTY          TO WS-TOT-UNT-IN-CASE.          16960099
169700     MOVE 0                       TO WS007-CD-PACK-SKU.           16970099
169800     MOVE WS-HOST-INPT-ID         TO WS007-CD-HOST-INPT-ID.       16980099
169900                                                                  16990099
170000     MULTIPLY WS-SHIP-WT-QTY BY WS-SHPD-UNT-QTY                   17000099
170100                                  GIVING WS-UNIT-WT.              17010099
170200     ADD WS-UNIT-WT               TO WS-CART-WT.                  17020099
170300                                                                  17030099
170400     IF WS006-CH-MULT-SKU                                         17040099
170500        MOVE WS-TOT-UNT-IN-CASE TO WS-CART-VOL                    17050099
170600     ELSE                                                         17060099
170700        IF (WS-SHIP-DPTH-QTY = 0 OR WS-SHIP-HT-QTY = 0            17070099
170800            OR WS-SHIP-WD-QTY = 0)                                17080099
170900            MOVE WS-TOT-UNT-IN-CASE TO WS-CART-VOL                17090099
171000        ELSE                                                      17100099
171100            COMPUTE WS-UNIT-VOL = WS-SHIP-DPTH-QTY *              17110099
171110            WS-SHIP-HT-QTY * WS-SHIP-WD-QTY * WS-TOT-UNT-IN-CASE  17111099
171111        END-IF                                                    17111199
171112     END-IF.                                                      17111299
171113     ADD  WS-UNIT-VOL             TO WS-CART-VOL                  17111399
171114     MOVE DK-SHIPT-ID             TO WST00011-EXT-SHP-ID.         17111499
171115     MOVE PV-REPOS-TIMESTAMP      TO WST00011-CRE-TMST.           17111599
171116     MOVE WS-ROW-CNT              TO WST00011-ROW-NBR.            17111699
171117     MOVE WS-GP-CNT               TO WST00011-REC-TYP-GP-NBR.     17111799
171118     MOVE 'CD'                    TO WST00011-REC-TYP-CDE.        17111899
171119     MOVE PV-SQL-COUNT            TO WST00011-CSE-DTL-NBR.        17111999
171120     MOVE 300                     TO WST00011-REC-TYP-DESC-LEN.   17112099
171130     MOVE WS007-CASE-DTL-REC      TO WST00011-REC-TYP-DESC-TEXT.  17113099
171140                                                                  17114099
171150     PERFORM 9000-INSERT-TEMP-TABLE.                              17115099
171160                                                                  17116099
171170/                                                                 17117099
171180 7000-WRITE-TO-CICS-LOG.                                          17118099
171190                                                                  17119099
171200     MOVE LENGTH PV-CICS-MSG-AREA TO                              17120099
171300                                     PV-COMMAREA-LENGTH.          17130099
171400     EXEC CICS                                                    17140099
171500          WRITEQ TD                                               17150099
171600          QUEUE  ('CSSL')                                         17160099
171700          FROM  (PV-CICS-MSG-AREA)                                17170099
171800          LENGTH  (PV-COMMAREA-LENGTH)                            17180099
171900          RESP  (PV-CICS-RESP)                                    17190099
172000     END-EXEC.                                                    17200099
172100                                                                  17210099
172200     MOVE SPACES TO PV-CICS-MSG-AREA.                             17220099
172300                                                                  17230099
172400/                                                                 17240099
172500 8010-WRITE-DAT-CNTL.                                             17250099
172600                                                                  17260099
172700     SET PS-DAT-CNTL-NOT-DONE  TO TRUE.                           17270099
172800     MOVE 'ASN'                TO WST00003-TRN-TYP-CDE.           17280099
172900     MOVE PV-CNTL-TMST         TO WST00003-PRC-GP-ID.             17290099
173000     MOVE PV-REPOS-TIMESTAMP   TO WST00003-PRC-CNTL-TMST.         17300099
173100     MOVE DK-OPER-UNT-ID       TO WST00003-LOC-NBR.               17310099
173200     MOVE 'LOADIN'             TO WST00003-STAT-CDE.              17320099
173300     MOVE PV-REPOS-TIMESTAMP   TO WST00003-BEG-PRC-TMST.          17330099
173400     MOVE PC-DEFAULT-NINES     TO WST00003-END-PRC-TMST.          17340099
173500     MOVE 1                    TO WST00003-DAT-LOD-VER-NBR.       17350099
173600                                                                  17360099
173700     EXEC SQL                                                     17370099
173800          INSERT INTO WST_DAT_CNTL                                17380099
173900            (TRN_TYP_CDE                                          17390099
174000           , PRC_GP_ID                                            17400099
174100           , PRC_CNTL_TMST                                        17410099
174200           , LOC_NBR                                              17420099
174300           , STAT_CDE                                             17430099
174400           , BEG_PRC_TMST                                         17440099
174500           , END_PRC_TMST                                         17450099
174600           , DAT_LOD_VER_NBR)                                     17460099
174700      VALUES                                                      17470099
174800            (:WST00003-TRN-TYP-CDE                                17480099
174900           , :WST00003-PRC-GP-ID                                  17490099
175000           , :WST00003-PRC-CNTL-TMST                              17500099
175100           , :WST00003-LOC-NBR                                    17510099
175200           , :WST00003-STAT-CDE                                   17520099
175300           , :WST00003-BEG-PRC-TMST                               17530099
175400           , :WST00003-END-PRC-TMST                               17540099
175500           , :WST00003-DAT-LOD-VER-NBR)                           17550099
175600     END-EXEC.                                                    17560099
175700                                                                  17570099
175800     EVALUATE TRUE                                                17580099
175900         WHEN SQLCODE = ZERO                                      17590099
176000             SET PS-DAT-CNTL-DONE TO TRUE                         17600099
176100             IF PS-CICS-SWITCH-YES                                17610099
176200                 INITIALIZE  PV-CICS-MSG-AREA                     17620099
176300                 STRING   ' ' WS004-SRC-TASK-NUMBER               17630099
176400                          ' WSKCS304-8010:'                       17640099
176500                          ' INSERT WST_DAT_CNTL'                  17650099
176600                          ' TRAN TYPE='                           17660099
176700                          WST00003-TRN-TYP-CDE                    17670099
176800                          DELIMITED BY SIZE                       17680099
176900                          INTO PV-CICS-MSG-AREA                   17690099
177000                 PERFORM 7000-WRITE-TO-CICS-LOG                   17700099
177100             END-IF                                               17710099
177200         WHEN SQLCODE = -803                                      17720099
177300* IF THE ROW EXISTS, INCREMENT THE PRC-GP-ID                      17730099
177400             IF PS-CICS-SWITCH-YES                                17740099
177500                 INITIALIZE  PV-CICS-MSG-AREA                     17750099
177600                 STRING   ' ' WS004-SRC-TASK-NUMBER               17760099
177700                          ' WSKCS304-8010:'                       17770099
177800                          ' INSERT WST_DAT_CNTL'                  17780099
177900                          ' SHPMT='                               17790099
178000                          WST00011-EXT-SHP-ID                     17800099
178100                          ' RECORD EXISTS '                       17810099
178200                          DELIMITED BY SIZE                       17820099
178300                          INTO PV-CICS-MSG-AREA                   17830099
178400                 PERFORM 7000-WRITE-TO-CICS-LOG                   17840099
178500                 ADD 1 TO PV-CNTL-TMST                            17850099
178600                 MOVE PV-CNTL-TMST TO WST00003-PRC-GP-ID          17860099
178700                 MOVE PV-REPOS-TIMESTAMP TO                       17870099
178800                                          WST00003-BEG-PRC-TMST   17880099
178900                                          WST00003-PRC-CNTL-TMST  17890099
179000             END-IF                                               17900099
179100         WHEN SQLCODE = -904                                      17910099
179200         WHEN SQLCODE = -913                                      17920099
179300         WHEN SQLCODE = -911                                      17930099
179400         WHEN SQLCODE = +100                                      17940099
179500              CONTINUE                                            17950099
179600         WHEN SQLWARN0 NOT = SPACES                               17960099
179700         WHEN SQLCODE NOT = ZERO                                  17970099
179800             MOVE SQLCODE               TO PV-SQL-RETURN-CD       17980099
179900             INITIALIZE PV-CICS-MSG-AREA                          17990099
180000             STRING   ' ' WS004-SRC-TASK-NUMBER                   18000099
180100                      ' WSKCS304-8010 ERROR:'                     18010099
180200                      ' SQL='                                     18020099
180300                      PV-SQL-RETURN-CD                            18030099
180400                      DELIMITED BY SIZE                           18040099
180500                      INTO PV-CICS-MSG-AREA                       18050099
180600             PERFORM 7000-WRITE-TO-CICS-LOG                       18060099
180700             MOVE '8010-WRITE-DAT-CNTL'                           18070099
180800                                       TO DP013-PARAGRAPH         18080099
180900             MOVE 'WST_DAT_CNTL'       TO                         18090099
181000                                       DP013-DB2-TABLE-NAME (1)   18100099
181100             MOVE SQLCA                TO DP013-SQLCA             18110099
181200             STRING 'SHPMT=' WST00011-EXT-SHP-ID                  18120099
181300                      DELIMITED BY SIZE                           18130099
181400                                     INTO DP013-MESSAGE-TEXT (1)  18140099
181500             SET DP013-DB2-ABEND       TO TRUE                    18150099
181600             PERFORM 9999-ABEND                                   18160099
181700     END-EVALUATE.                                                18170099
181800                                                                  18180099
181900/                                                                 18190099
182000 8020-WRITE-DAT-XFER.                                             18200099
182100                                                                  18210099
182200     ADD 1 TO PV-REPOS-COUNTER.                                   18220099
182300                                                                  18230099
182400     MOVE 'ASN'                  TO WST00004-TRN-TYP-CDE.         18240099
182500     MOVE WST00003-PRC-GP-ID     TO WST00004-PRC-GP-ID.           18250099
182600     MOVE PV-REPOS-COUNTER       TO WST00004-PRC-LOD-SEQ-ID.      18260099
182700     MOVE WST00003-PRC-CNTL-TMST TO WST00004-PRC-CNTL-TMST.       18270099
182800     MOVE WS-PRC-TYP-CDE         TO WST00004-RDM-PRC-TYP-CDE.     18280099
182900     MOVE WS-DAT-TXT-LEN         TO WST00004-LOD-DAT-TXT-LEN.     18290099
183000     MOVE WS-DAT-TXT-TEXT        TO WST00004-LOD-DAT-TXT-TEXT.    18300099
183100                                                                  18310099
183200     EXEC SQL                                                     18320099
183300          INSERT INTO WST_DAT_XFER                                18330099
183400            (TRN_TYP_CDE                                          18340099
183500           , PRC_GP_ID                                            18350099
183600           , PRC_LOD_SEQ_ID                                       18360099
183700           , PRC_CNTL_TMST                                        18370099
183800           , RDM_PRC_TYP_CDE                                      18380099
183900           , LOD_DAT_TXT)                                         18390099
184000      VALUES                                                      18400099
184100            (:WST00004-TRN-TYP-CDE                                18410099
184200           , :WST00004-PRC-GP-ID                                  18420099
184300           , :WST00004-PRC-LOD-SEQ-ID                             18430099
184400           , :WST00004-PRC-CNTL-TMST                              18440099
184500           , :WST00004-RDM-PRC-TYP-CDE                            18450099
184600           , :WST00004-LOD-DAT-TXT)                               18460099
184700     END-EXEC.                                                    18470099
184800                                                                  18480099
184900     EVALUATE TRUE                                                18490099
185000         WHEN SQLCODE = ZERO                                      18500099
185100             IF PS-CICS-SWITCH-YES                                18510099
185200                 INITIALIZE  PV-CICS-MSG-AREA                     18520099
185300                 STRING   ' ' WS004-SRC-TASK-NUMBER               18530099
185400                          ' WSKCS304-8020:'                       18540099
185500                          ' INSERT WST_DAT_XFER'                  18550099
185600                          ' SHPMT=' WST00011-EXT-SHP-ID           18560099
185700                          DELIMITED BY SIZE                       18570099
185800                          INTO PV-CICS-MSG-AREA                   18580099
185900                 PERFORM 7000-WRITE-TO-CICS-LOG                   18590099
186000             END-IF                                               18600099
186100         WHEN SQLCODE = -904                                      18610099
186200         WHEN SQLCODE = -913                                      18620099
186300         WHEN SQLCODE = -911                                      18630099
186400         WHEN SQLCODE = +100                                      18640099
186500              CONTINUE                                            18650099
186600         WHEN SQLWARN0 NOT = SPACES                               18660099
186700         WHEN SQLCODE NOT = ZERO                                  18670099
186800             MOVE SQLCODE               TO PV-SQL-RETURN-CD       18680099
186900             INITIALIZE PV-CICS-MSG-AREA                          18690099
187000             STRING   ' ' WS004-SRC-TASK-NUMBER                   18700099
187100                      ' WSKCS304-8020 ERROR:'                     18710099
187200                      ' SQL='                                     18720099
187300                      PV-SQL-RETURN-CD                            18730099
187400                      DELIMITED BY SIZE                           18740099
187500                      INTO PV-CICS-MSG-AREA                       18750099
187600             PERFORM 7000-WRITE-TO-CICS-LOG                       18760099
187700             MOVE '8020-WRITE-DAT-XFER'                           18770099
187800                                       TO DP013-PARAGRAPH         18780099
187900             MOVE 'WST_DAT_XFER'       TO                         18790099
188000                                       DP013-DB2-TABLE-NAME (1)   18800099
188100             MOVE SQLCA                TO DP013-SQLCA             18810099
188200             STRING 'SHPMT=' WST00011-EXT-SHP-ID                  18820099
188300                      DELIMITED BY SIZE                           18830099
188400                                     INTO DP013-MESSAGE-TEXT (1)  18840099
188500             SET DP013-DB2-ABEND       TO TRUE                    18850099
188600             PERFORM 9999-ABEND                                   18860099
188700     END-EVALUATE.                                                18870099
188800                                                                  18880099
188900/                                                                 18890099
189000 8030-GET-REPOS-TMST.                                             18900099
189100* THE SAME TIMESTAMP IS USED FOR ALL RECORDS FOR THE SHIPMENT     18910099
189200* SO, WE ONLY GET THIS ONCE                                       18920099
189300                                                                  18930099
189400     EXEC SQL                                                     18940099
189500         SET :PV-REPOS-TIMESTAMP = CURRENT TIMESTAMP              18950099
189600     END-EXEC.                                                    18960099
189700                                                                  18970099
189800/                                                                 18980099
189900 9000-INSERT-TEMP-TABLE.                                          18990099
190000                                                                  19000099
190100     EXEC SQL                                                     19010099
190200          INSERT INTO WST_ASN_DWNLD                               19020099
190300                (EXT_SHP_ID                                       19030099
190400               , CRE_TMST                                         19040099
190500               , ROW_NBR                                          19050099
190600               , REC_TYP_GP_NBR                                   19060099
190700               , REC_TYP_CDE                                      19070099
190800               , CSE_DTL_NBR                                      19080099
190900               , REC_TYP_DESC)                                    19090099
191000          VALUES                                                  19100099
191100                (:WST00011-EXT-SHP-ID                             19110099
191200               , :WST00011-CRE-TMST                               19120099
191300               , :WST00011-ROW-NBR                                19130099
191400               , :WST00011-REC-TYP-GP-NBR                         19140099
191500               , :WST00011-REC-TYP-CDE                            19150099
191600               , :WST00011-CSE-DTL-NBR                            19160099
191700               , :WST00011-REC-TYP-DESC)                          19170099
191800     END-EXEC.                                                    19180099
191900                                                                  19190099
192000                                                                  19200099
192100     EVALUATE TRUE                                                19210099
192200         WHEN SQLCODE = ZERO                                      19220099
192300             IF PS-CICS-SWITCH-YES                                19230099
192400                 INITIALIZE  PV-CICS-MSG-AREA                     19240099
192500                 STRING   ' ' WS004-SRC-TASK-NUMBER               19250099
192600                          ' WSKCS304-9000:'                       19260099
192700                          ' INSERT WST_ASN_DWNLD'                 19270099
192800                          ' SHPMT=' WST00011-EXT-SHP-ID           19280099
192900                          DELIMITED BY SIZE                       19290099
193000                          INTO PV-CICS-MSG-AREA                   19300099
193100                 PERFORM 7000-WRITE-TO-CICS-LOG                   19310099
193200             END-IF                                               19320099
193300         WHEN SQLCODE = -904                                      19330099
193400         WHEN SQLCODE = -913                                      19340099
193500         WHEN SQLCODE = -911                                      19350099
193600         WHEN SQLCODE = +100                                      19360099
193700              CONTINUE                                            19370099
193800         WHEN SQLWARN0 NOT = SPACES                               19380099
193900         WHEN SQLCODE NOT = ZERO                                  19390099
194000             MOVE SQLCODE               TO PV-SQL-RETURN-CD       19400099
194100             INITIALIZE PV-CICS-MSG-AREA                          19410099
194200             STRING   ' ' WS004-SRC-TASK-NUMBER                   19420099
194300                      ' WSKCS304-9000 ERROR:'                     19430099
194400                      ' SQL='                                     19440099
194500                      PV-SQL-RETURN-CD                            19450099
194600                      DELIMITED BY SIZE                           19460099
194700                      INTO PV-CICS-MSG-AREA                       19470099
194800             PERFORM 7000-WRITE-TO-CICS-LOG                       19480099
194900             MOVE '9000-INSERT-TEMP-TABLE'                        19490099
195000                                       TO DP013-PARAGRAPH         19500099
195100             MOVE 'WST_ASN_DWNLD'      TO                         19510099
195200                                       DP013-DB2-TABLE-NAME (1)   19520099
195300             MOVE SQLCA                TO DP013-SQLCA             19530099
195400             STRING 'SHPMT=' WST00011-EXT-SHP-ID                  19540099
195500                      DELIMITED BY SIZE                           19550099
195600                                     INTO DP013-MESSAGE-TEXT (1)  19560099
195700             SET DP013-DB2-ABEND       TO TRUE                    19570099
195800             PERFORM 9999-ABEND                                   19580099
195900     END-EVALUATE.                                                19590099
196000                                                                  19600099
196100/                                                                 19610099
196200 9010-UPDATE-VER-NBR.                                             19620099
196300                                                                  19630099
196400* THE WS-HOST-INPT-NUM CONTAINS THE VER_NBR FROM THE              19640099
196500* WST_SHPMT_XREF_HDR TABLE.  THIS FIELD WAS USED TO POPULATE THE  19650099
196600* HOST-INPT-ID ON THE CASE HEADER (WS006), CASE DETAIL (WS007), & 19660099
196700* ASN HEADER (WS004). NOW, INCREMENT THE VER_NBR ON XREF_HDR BY 1 19670099
196800                                                                  19680099
196900     ADD 1                            TO WS-HOST-INPT-NUM.        19690099
197000     MOVE WS-HOST-INPT-NUM            TO WS-VER-NBR.              19700099
197100                                                                  19710099
197200     EXEC SQL                                                     19720099
197300          UPDATE WST_SHPMT_XREF_HDR                               19730099
197400          SET VER_NBR = :WS-VER-NBR                               19740099
197500          WHERE  EXT_SHP_ID   = :DK-SHIPT-ID                      19750099
197600     END-EXEC.                                                    19760099
197700                                                                  19770099
197800     EVALUATE TRUE                                                19780099
197900         WHEN SQLCODE = ZERO                                      19790099
198000             MOVE WST00001-VER-NBR    TO WS-DISPLAY-6             19800099
198100             IF PS-CICS-SWITCH-YES                                19810099
198200                 MOVE DK-SHIPT-ID     TO WS-DISPLAY-SHIPMT        19820099
198300                 INITIALIZE PV-CICS-MSG-AREA                      19830099
198400                 STRING   ' ' WS004-SRC-TASK-NUMBER               19840099
198500                          ' WSKCS304-9010:'                       19850099
198600                          ' SHPMT='     WS-DISPLAY-SHIPMT         19860099
198700                          ' VER NBR='   WS-DISPLAY-6              19870099
198800                          DELIMITED BY SIZE                       19880099
198900                                    INTO PV-CICS-MSG-AREA         19890099
199000                 PERFORM 7000-WRITE-TO-CICS-LOG                   19900099
199100             END-IF                                               19910099
199200         WHEN SQLCODE = -904                                      19920099
199300         WHEN SQLCODE = -913                                      19930099
199400         WHEN SQLCODE = -911                                      19940099
199500              CONTINUE                                            19950099
199600         WHEN SQLWARN0 NOT = SPACES                               19960099
199700         WHEN SQLCODE NOT = ZERO                                  19970099
199800             MOVE SQLCODE             TO PV-SQL-RETURN-CD         19980099
199900             INITIALIZE PV-CICS-MSG-AREA                          19990099
200000             STRING   ' ' WS004-SRC-TASK-NUMBER                   20000099
200100                      ' WSKCS304-9010 ERROR:'                     20010099
200200                      ' SQL='                                     20020099
200300                      PV-SQL-RETURN-CD                            20030099
200400                      DELIMITED BY SIZE                           20040099
200500                      INTO PV-CICS-MSG-AREA                       20050099
200600             PERFORM 7000-WRITE-TO-CICS-LOG                       20060099
200700             MOVE '9010-UPDATE-VER-NBR'                           20070099
200800                                      TO DP013-PARAGRAPH          20080099
200900             MOVE 'WST_SHPMT_XREF_HDR'                            20090099
201000                                      TO DP013-DB2-TABLE-NAME (1) 20100099
201100             MOVE SQLCA               TO DP013-SQLCA              20110099
201200             STRING 'SHPMT=' DK-SHIPT-ID                          20120099
201300                      DELIMITED BY SIZE                           20130099
201400                                    INTO DP013-MESSAGE-TEXT (1)   20140099
201500             SET DP013-DB2-ABEND      TO TRUE                     20150099
201600             PERFORM 9999-ABEND                                   20160099
201700     END-EVALUATE.                                                20170099
201800                                                                  20180099
201900/                                                                 20190099
202000 9020-CALL-ASN-MODULE.                                            20200099
202100                                                                  20210099
202200     INITIALIZE WS006-TRANS-COMMAREA.                             20220099
202300                                                                  20230099
202400     MOVE DK-SHIPT-ID            TO WS006-EXT-SHP-ID.             20240099
202500     MOVE PV-REPOS-TIMESTAMP     TO WS006-DWNLD-TMST.             20250099
202600     MOVE 'WSKCS304'             TO WS006-CALLING-PROGRAM-NAME.   20260099
202700     MOVE WS004-OPER-UNT-ID      TO WS006-OPER-UNT-ID.            20270099
202800     MOVE WS004-USER-ID          TO WS006-USERID.                 20280099
202900     MOVE WS004-SRC-TASK-NUMBER  TO WS006-SRC-TASK-NUMBER.        20290099
203000     MOVE 'ASN'                  TO WS006-TRN-TYP-CDE.            20300099
203100     MOVE PV-CNTL-TMST           TO WS006-PRC-GP-ID.              20310099
203200                                                                  20320099
203300     IF PS-CICS-SWITCH-YES                                        20330099
203400         INITIALIZE  PV-CICS-MSG-AREA                             20340099
203500         STRING   ' ' WS004-SRC-TASK-NUMBER                       20350099
203600                  ' WSKCS304-9010 CALLING ASN MODULE: '           20360099
203700                    PC-ASN-MODULE                                 20370099
203800                    DELIMITED BY SIZE                             20380099
203900                    INTO PV-CICS-MSG-AREA                         20390099
204000         PERFORM 7000-WRITE-TO-CICS-LOG                           20400099
204100     END-IF.                                                      20410099
204200*                                                                 20420099
204300     MOVE LENGTH OF WS006-TRANS-COMMAREA TO PV-COMMAREA-LENGTH.   20430099
204400                                                                  20440099
204500     EXEC CICS                                                    20450099
204600         LINK PROGRAM  (PC-ASN-MODULE)                            20460099
204700              COMMAREA (WS006-TRANS-COMMAREA)                     20470099
204800              LENGTH   (PV-COMMAREA-LENGTH)                       20480099
204900     END-EXEC.                                                    20490099
205000                                                                  20500099
205100     IF PS-CICS-SWITCH-YES                                        20510099
205200         INITIALIZE  PV-CICS-MSG-AREA                             20520099
205300         STRING   ' ' WS004-SRC-TASK-NUMBER                       20530099
205400                  ' WSKCS304-9010 RETURNING FROM: '               20540099
205500                    PC-ASN-MODULE                                 20550099
205600                    DELIMITED BY SIZE                             20560099
205700                    INTO PV-CICS-MSG-AREA                         20570099
205800         PERFORM 7000-WRITE-TO-CICS-LOG                           20580099
205900     END-IF.                                                      20590099
206000                                                                  20600099
206100     IF NOT WS006-SUCCESSFUL                                      20610099
206200         INITIALIZE  PV-CICS-MSG-AREA                             20620099
206300         STRING   ' ' WS004-SRC-TASK-NUMBER                       20630099
206400                  ' WSKCS304-9010 ERROR FROM: '                   20640099
206500                    PC-ASN-MODULE                                 20650099
206600                  ' ' WS006-SUCCESS-IND                           20660099
206700                    DELIMITED BY SIZE                             20670099
206800                    INTO PV-CICS-MSG-AREA                         20680099
206900         PERFORM 7000-WRITE-TO-CICS-LOG                           20690099
207000     END-IF.                                                      20700099
207100                                                                  20710099
207200/                                                                 20720099
207300***************************************************************** 20730099
207400* PCPD049 - PROCEDURE DIVISION USED TO DETERMINE TRAILER CONTENTS 20740099
207500     COPY PCPD049.                                                20750099
207600                                                                  20760099
207700***************************************************************   20770099
207800*   STANDARD ABEND ROUTINE                                        20780099
207900* ==> PROCESSES:                                                  20790099
208000*   - ISSUES THE ABEND.                                           20800099
208100***************************************************************   20810099
208200 9999-ABEND.                                                      20820099
208300     MOVE 'WSKCS304'                  TO DP013-PROGRAM.           20830099
208400     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          20840099
208500     INITIALIZE DP013-SRC-TASK-NUMBER                             20850099
208600                DP013-STACK.                                      20860099
208700     SET DP013-LINK-RETURN TO TRUE.                               20870099
208800     SET DP013-ROLLBACK    TO TRUE.                               20880099
208900                                                                  20890099
209000     EXEC CICS                                                    20900099
209100         LINK                                                     20910099
209200             PROGRAM  (DP013-NAME)                                20920099
209300             COMMAREA (DP013-PARAMETERS)                          20930099
209400             LENGTH   (DP013-LENGTH)                              20940099
209500     END-EXEC.                                                    20950099
209600                                                                  20960099
209700                                                                  20970099
209800     EXEC CICS                                                    20980099
209900         RETURN                                                   20990099
210000     END-EXEC.                                                    21000099
