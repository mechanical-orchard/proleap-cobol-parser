000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    CEKCS607.                                         00040000
000500 AUTHOR.        JOE LAROSA.                                       00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  01-03-2000.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S607 - CENTRAL STOCK INTERFACE - PULL ITEM ADD STORE       * 00100000
001100*---------------------------------------------------------------* 00110024
001110*                                                               * 00111024
001120* CHANGE HISTORY:                                               * 00112024
001130* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES         * 00113024
001140* ------- ---------- ----------- -------------------------------- 00114024
001150* WR38216 04-26-2010 C. TWIEHAUS  EFC1-2 TRANSFERS              * 00115026
001200*---------------------------------------------------------------* 00120000
001201* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00120137
001202* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00120238
001203* MAKING THE CALL DYNAMIC VS STATIC.                              00120338
001204*----------------------------------------------------------------*00120438
001205* CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00120538
001206* ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00120638
001207* DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00120738
001208*-----------------------------------------------------------------00120838
001210                                                                * 00121024
001300 ENVIRONMENT DIVISION.                                            00130000
001400 DATA DIVISION.                                                   00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE +0 COMP.00170000
001800     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE +0 COMP.00180000
001900     15  DK-LINE-ITEM                   PIC S9(15)V COMP-3.       00190000
002000     15  DK-STORE-NUMBER                PIC S9(04)  VALUE +0 COMP.00200000
002500     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00250000
002600     15  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00260000
002610     15  DK-E-BUS-IND                   PIC  X(01)  VALUE SPACES. 00261023
002700                                                                  00270000
002800 01  PC-PROGRAM-CONSTANTS.                                        00280000
002810     05  PC-SPACE                  PIC  X(01)  VALUE ' '.         00281038
002900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE607A  '.  00290000
003000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM607 '.  00300000
003100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS607'.  00310000
003200     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00320000
003300     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00330000
003400     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          00340000
003500                                               COMP SYNC.         00350000
003600     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00360000
003700                                               COMP SYNC.         00370000
003800     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00380000
003900                                               COMP-3.            00390000
004000     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00400000
004100                                               COMP SYNC.         00410000
004200     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00420000
004300                                               COMP-3.            00430000
004400     05  PC-DEFAULT-DATE           PIC  X(10)  VALUE '9999-09-09'.00440000
004500     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00450000
004600     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00460000
004700     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00470000
004800     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00480000
004900     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00490000
005000     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00500000
005100     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00510000
005200                                               COMP.              00520000
005300     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00530000
005400     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00540000
005500     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00550000
005600     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00560000
005700     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00570000
005800     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00580000
005900     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00590000
006000     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00600000
006100     05  PC-01                     PIC  X(02)  VALUE '01'.        00610000
006200*                                                                 00620000
006300*----------------------------------------------------------------*00630000
006400*  DESCRIPTION CONSTANTS                                         *00640000
006500*----------------------------------------------------------------*00650000
006600     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  00660000
006700     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  00670000
006800     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  00680000
006900     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  00690000
007000     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  00700000
007100     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  00710000
007200     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  00720000
007300     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  00730000
007400     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  00740000
007500     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  00750000
007600     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.00760000
007700     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.00770000
007800*    05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     00780000
007900*                                          VALUE '** UNKNOWN **'. 00790000
008000*                                                                 00800023
008100*----------------------------------------------------------------*00810023
008200*  SYSTEM MESSAGES                                               *00820023
008300*----------------------------------------------------------------*00830023
008400*   00005 - INVALID VALUE                                        *00840023
008500*   00008 - MUST BE NUMERIC                                      *00850023
008600*   00034 - ADD SUCCESSFUL                                       *00860023
008700*   00045 - INVALID FUNCTION KEY                                 *00870023
008800*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00880023
008900*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00890023
009000*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00900023
009100*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00910023
009200*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00920023
009300*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00930023
009400*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00940023
009500*   00069 - TOP OF LIST                                          *00950023
009600*   00070 - BOTTOM OF LIST                                       *00960023
009700*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00970023
009800*   00334 - STORE NUMBER MUST BE NUMERIC                         *00980023
009900*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00990023
010000*   00594 - STORE NUMBER NOT FOUND                               *01000023
010100*   00279 - MORE ITEMS TO DISPLAY                                *01010023
010200*   00844 - STORE CLOSED                                         *01020023
010300*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01030023
010400*   01552 - STORE NOT OPEN TO RECEIVE                            *01040023
010500*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01050023
010600*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01060023
010700*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01070023
010800*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01080023
010900*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01090023
011000*   02279 = NO STORE(S) FOR ADD FUNCTION                         *01100023
011100*   02280 = STORE ALREADY EXISTS FOR THIS PULL# / LINE#          *01110023
011200*   02281 = REQUESTED STORE QUANTITY MUST BE GREATER THAN ZERO   *01120023
011300*   02282 = REQUESTED STORE QUANTITY REQUIRED FOR STORE ADD      *01130023
011400*   02283 = STORE NUMBER REQUIRED FOR STORE ADD                  *01140023
011500*   02284 = PRESS F13 TO ADD STORES                              *01150023
011600*   02292 = CANNOT ADD DUPLICATE STORE NUMBERS                   *01160023
011700*   02331 = STORE ALLOCATED UNITS CANNOT BE > LINE PULL REQ/ACT UN01170023
011800*   02629 = THA MAXIMUM STORE FOR AN E-COMMERCE PULL HAS BEEN EXC*01180023
011900*   99901 = INVALID COMMAND WAS ENTERED                          *01190023
012000*----------------------------------------------------------------*01200023
012100     05  PC-TSYMSG-NUMBERS.                                       01210023
012200         10  PC-TSYMSG-02279            PIC  9(05)  VALUE 02279.  01220023
012300         10  PC-TSYMSG-02280            PIC  9(05)  VALUE 02280.  01230023
012400         10  PC-TSYMSG-02281            PIC  9(05)  VALUE 02281.  01240023
012500         10  PC-TSYMSG-02282            PIC  9(05)  VALUE 02282.  01250023
012600         10  PC-TSYMSG-02283            PIC  9(05)  VALUE 02283.  01260023
012700         10  PC-TSYMSG-02284            PIC  9(05)  VALUE 02284.  01270023
012800         10  PC-TSYMSG-02292            PIC  9(05)  VALUE 02292.  01280023
012810         10  PC-TSYMSG-02293            PIC  9(05)  VALUE 02293.  01281038
012900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01290023
013000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01300023
013100         10  PC-TSYMSG-00034            PIC  9(05)  VALUE 00034.  01310023
013200         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01320023
013300         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01330023
013400         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01340023
013500         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01350023
013600         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01360023
013700         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01370023
013800         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01380023
013900         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01390023
014000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01400023
014100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01410023
014200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01420023
014300         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01430023
014400         10  PC-TSYMSG-00334            PIC  9(05)  VALUE 00334.  01440023
014500         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01450023
014600         10  PC-TSYMSG-00594            PIC  9(05)  VALUE 00594.  01460023
014700         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01470023
014800         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01480023
014900         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01490023
015000         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01500023
015100         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01510023
015200         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01520023
015300         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01530023
015400         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01540023
015500         10  PC-TSYMSG-02331            PIC  9(05)  VALUE 02331.  01550023
015600         10  PC-TSYMSG-02554            PIC  9(05)  VALUE 02554.  01560023
015700         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01570023
015800         10  PC-TSYMSG-00844            PIC  9(05)  VALUE 00844.  01580023
015900         10  PC-TSYMSG-01552            PIC  9(05)  VALUE 01552.  01590023
016000         10  PC-TSYMSG-02629            PIC  9(05)  VALUE 02629.  01600023
016100*                                                                 01610023
016200 01  PS-PROGRAM-SWITCHES.                                         01620023
016300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01630023
016400         88  PS-NO-ERROR                            VALUE 'Y'.    01640023
016500         88  PS-ERROR                               VALUE 'N'.    01650023
016600     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    01660023
016700         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    01670023
016800         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    01680023
016900     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01690023
017000         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01700023
017100         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01710023
017200     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01720023
017300         88  PS-DONE                                VALUE 'Y'.    01730023
017400         88  PS-NOT-DONE                            VALUE 'N'.    01740023
017500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01750023
017600         88  PS-LIST-END                            VALUE 'Y'.    01760023
017700         88  PS-NO-LIST-END                         VALUE 'N'.    01770023
017800*                                                                 01780023
017900 01  PV-PROGRAM-VARIABLES.                                        01790023
018000     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      01800023
018100                                                    COMP-3.       01810023
018200     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01820023
018300                                        COMP SYNC.                01830023
018400     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 01840023
018500     05  PV-ACCUM-CEPLDS-QTY            PIC S9(09)  VALUE +0.     01850023
018600     05  PV-SUB                         PIC S9(04)  VALUE +0      01860023
018700                                                    COMP SYNC.    01870023
018800     05  PV-SUB1                        PIC S9(04)  VALUE +0      01880023
018900                                                    COMP SYNC.    01890023
019000     05  PV-SUB2                        PIC S9(04)  VALUE +0      01900023
019100                                                    COMP SYNC.    01910023
019200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01920023
019300                                                    COMP SYNC.    01930023
019400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01940023
019500                                                    COMP-3.       01950023
019600     05  PV-STORE-COUNT                 PIC S9(09)  VALUE +0      01960023
019700                                                    COMP-3.       01970023
019800     05  PV-MAX-QTY                     PIC S9(09)  VALUE +0      01980023
019900                                                    COMP-3.       01990023
020000     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02000023
020100                                                    COMP-3.       02010023
020200     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02020023
020300                                                    COMP-3.       02030023
020400     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02040023
020500                                                    COMP-3.       02050023
020600     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02060023
020700                                                    COMP-3.       02070023
020800     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02080023
020900                                                    COMP-3.       02090023
021000     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02100023
021100                                                    COMP-3.       02110023
021200     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02120023
021300                                                    COMP SYNC.    02130023
021400     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02140023
021500                                                    COMP SYNC.    02150023
021600     05  PV-ITEM                        PIC S9(04)  VALUE +0      02160023
021700                                                    COMP SYNC.    02170023
021800     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02180023
021900                                                    COMP SYNC.    02190023
022000     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02200023
022100                                                    COMP SYNC.    02210023
022200     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02220023
022300                                                    COMP SYNC.    02230023
022400     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02240023
022500                                                    COMP SYNC.    02250023
022600     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02260023
022700                                                    COMP SYNC.    02270023
022800     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02280023
022900                                                    COMP SYNC.    02290023
023000     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02300023
023100                                                    COMP SYNC.    02310023
023200     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02320023
023300                                                    COMP SYNC.    02330023
023400     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02340023
023500                                                    COMP SYNC.    02350023
023600     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02360023
023700                                                    COMP SYNC.    02370023
023800     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02380023
023900                                                    COMP SYNC.    02390023
024000     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02400023
024100                                                    COMP SYNC.    02410023
024200     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02420023
024300                                                    COMP SYNC.    02430023
024400     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02440023
024500                                                    COMP.         02450023
024600     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02460023
024700                                                    COMP.         02470023
024800     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02480023
024900                                                    COMP.         02490023
025000     05  PV-SOFT-ABORT-MSG.                                       02500023
025100         10  FILLER            PIC X(12) VALUE ' CEKCS607 - '.    02510023
025200         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02520023
025300         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02530023
025400         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02540023
025500         10  PV-SOFT-PARAGRAPH PIC X(30).                         02550023
025600     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02560023
025700                                                     COMP SYNC.   02570023
025800     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02580023
025900     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02590023
026000     05  PV-CICS-MSG-HOLD.                                        02600023
026100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02610023
026200         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02620023
026300     05  PV-CICS-MSG-HOLD2.                                       02630023
026400         10  FILLER                      PIC  X(01)  VALUE SPACE. 02640023
026500         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02650023
026600                                                                  02660023
026700                                                                  02670023
026800     05  PV-CREATE-TMST                 PIC X(26)   VALUE SPACES. 02680023
026900     05  PV-CREATE-TMST-R REDEFINES  PV-CREATE-TMST.              02690023
027000         10   PV-CREATE-CC              PIC X(02).                02700023
027100         10   PV-CREATE-YY              PIC X(02).                02710023
027200         10   FILLER                    PIC X(01).                02720023
027300         10   PV-CREATE-MM              PIC X(02).                02730023
027400         10   FILLER                    PIC X(01).                02740023
027500         10   PV-CREATE-DD              PIC X(02).                02750023
027600         10   FILLER                    PIC X(16).                02760023
027700     05  PV-CREATE-MMDDYY.                                        02770023
027800         10   PV-CREATE-EDIT-MM         PIC X(02)   VALUE SPACES. 02780023
027900         10   PV-CREATE-SLASH-1         PIC X(01)   VALUE SPACES. 02790023
028000         10   PV-CREATE-EDIT-DD         PIC X(02)   VALUE SPACES. 02800023
028100         10   PV-CREATE-SLASH-2         PIC X(01)   VALUE SPACES. 02810023
028200         10   PV-CREATE-EDIT-YY         PIC X(02)   VALUE SPACES. 02820023
028300     05  PV-STATUS-MMDDYY.                                        02830023
028400         10   PV-STATUS-EDIT-MM         PIC X(02)   VALUE SPACES. 02840023
028500         10   PV-STATUS-SLASH-1         PIC X(01)   VALUE SPACES. 02850023
028600         10   PV-STATUS-EDIT-DD         PIC X(02)   VALUE SPACES. 02860023
028700         10   PV-STATUS-SLASH-2         PIC X(01)   VALUE SPACES. 02870023
028800         10   PV-STATUS-EDIT-YY         PIC X(02)   VALUE SPACES. 02880023
028900     05  PV-SELECT-FROM-DATE.                                     02890023
029000         10   PV-SELECT-FROM-EDIT-MM    PIC X(02)   VALUE SPACES. 02900023
029100         10   PV-SELECT-FROM-SLASH-1    PIC X(01)   VALUE SPACES. 02910023
029200         10   PV-SELECT-FROM-EDIT-DD    PIC X(02)   VALUE SPACES. 02920023
029300         10   PV-SELECT-FROM-SLASH-2    PIC X(01)   VALUE SPACES. 02930023
029400         10   PV-SELECT-FROM-EDIT-YY    PIC X(04)   VALUE SPACES. 02940023
029500     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 02950023
029600         88   PV-SOURCE-ADAM                        VALUE 'AD'.   02960023
029700         88   PV-SOURCE-INFOREM                     VALUE 'IN'.   02970023
029800         88   PV-SOURCE-MANUAL                      VALUE 'MA'.   02980023
029900         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 02990023
030000     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  03000023
030100                                                    COMP.         03010023
030200     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  03020023
030300                                                    COMP.         03030023
030400     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  03040023
030500                                                    COMP.         03050023
030600     05  PV-CEPLDS-REQ-QTY               PIC S9(09) VALUE ZEROES  03060023
030700                                                    COMP.         03070023
030800     05  PV-CEPLDS-ACT-QTY               PIC S9(09) VALUE ZEROES  03080023
030900                                                    COMP.         03090023
031000     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  03100023
031100                                                    COMP.         03110023
031200                                                                  03120023
031300     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 03130023
031400         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   03140023
031500         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   03150023
031600         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   03160023
031700     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 03170023
031800         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   03180023
031900         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   03190023
032000         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   03200023
032100     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 03210023
032200         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   03220023
032300         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   03230023
032400         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   03240023
032500                                                                  03250023
032600     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 03260023
032700         88   PV-STATUS-1-NEW                       VALUE 'NW'.   03270023
032800         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   03280023
032900         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   03290023
033000         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   03300023
033100         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   03310023
033200     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 03320023
033300         88   PV-STATUS-2-NEW                       VALUE 'NW'.   03330023
033400         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   03340023
033500         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   03350023
033600         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   03360023
033700         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   03370023
033800     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 03380023
033900         88   PV-STATUS-3-NEW                       VALUE 'NW'.   03390023
034000         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   03400023
034100         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   03410023
034200         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   03420023
034300         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   03430023
034400     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 03440023
034500         88   PV-STATUS-4-NEW                       VALUE 'NW'.   03450023
034600         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   03460023
034700         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   03470023
034800         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   03480023
034900         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   03490023
035000     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 03500023
035100         88   PV-STATUS-5-NEW                       VALUE 'NW'.   03510023
035200         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   03520023
035300         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   03530023
035400         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   03540023
035500         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   03550023
035600                                                                  03560023
035700     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 03570023
035800     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 03580023
035900     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 03590023
036000     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 03600023
036100     05  PV-STORE-NUMBER                 PIC  9(04) VALUE ZEROES. 03610023
036200     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 03620023
036300     05  PV-LINE-SKU                     PIC  X(10) VALUE SPACES. 03630023
036400     05  PV-LINE-SKU-RETAIL              PIC  9(05)V99            03640023
036500                                                    VALUE ZEROES. 03650023
036600     05  PV-LINE-ITEM                    PIC  9(15) VALUE ZEROES. 03660023
036700     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 03670023
036800     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 03680023
036900     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03690023
037000     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03700023
037100     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 03710023
037200     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 03720023
037300                                                                  03730023
037400     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 03740023
037500     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 03750023
037600         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   03760023
037700         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   03770023
037800         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   03780023
037900         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   03790023
038000         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   03800023
038100     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 03810023
038200     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 03820023
038300     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 03830023
038400     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 03840023
038500*    05  PV-SKU-NUMBER                   PIC  X(10) VALUE SPACES. 03850023
038600*    05  PV-SKU-NUMBER-HOLD.                                      03860023
038700*        10  PV-SKU-DEPT                 PIC  9(03) VALUE ZEROES. 03870023
038800*        10  FILLER                      PIC  X(01) VALUE '-'.    03880023
038900*        10  PV-SKU-CLASS                PIC  9(02) VALUE ZEROES. 03890023
039000*        10  FILLER                      PIC  X(01) VALUE '-'.    03900023
039100*        10  PV-SKU-SEQ                  PIC  9(03) VALUE ZEROES. 03910023
039200                                                                  03920023
039300     05  PV-SEL-TERM-ID                  PIC  X(04).              03930023
039400     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03940023
039500     05  PV-SEL-SEQ                      PIC  9(01).              03950023
039600     05  PV-SAVE-TOTAL-NEW-UNITS         PIC  9(06).              03960023
039700     05  PV-TOTAL-NEW-UNITS              PIC  9(06).              03970023
039800     05  PV-CURRENT-DATE                 PIC  X(10).              03980023
039900*----------------------------------------------------------------*03990023
040000*                                               WR # 230ZZ       *04000023
040100* ADDED NEW VARIABLES - DK-TEMP-SEQ-NBR,DK-TEMP-SKU-DESC.        *04010023
040200*----------------------------------------------------------------*04020023
040300     05  DK-TEMP-SEQ-NBR                 PIC  9(8).               04030023
040400     05  DK-TEMP-SKU-DESC                PIC  X(30).              04040023
040500*----------------------------------------------------------------*04050023
040600* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *04060023
040700*----------------------------------------------------------------*04070023
040800******************************************************************04080023
040900**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **04090023
041000**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **04100023
041100**  APPLICATION-SPECIFIC COMMAREA.                              **04110023
041200******************************************************************04120023
041300 01  LQW-LIST-QUEUE-WORK-AREA.                                    04130023
041400     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  04140023
041500     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           04150023
041600                                        INDEXED BY LQW-IDX.       04160023
041700         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04170023
041800         10  LQW-ACTION                 PIC  X(03).               04180023
041900             88  LQW-DEL                            VALUE 'DEL'.  04190023
042000             88  LQW-INQ                            VALUE 'INQ'.  04200023
042100             88  LQW-UPD                            VALUE 'UPD'.  04210023
042200             88  LQW-ERR                            VALUE 'ERR'.  04220023
042300         10  LQW-STORE-NBR              PIC  9(04).               04230023
042400         10  LQW-REQ-UNITS              PIC  Z(05).               04240023
042500         10  LQW-STORE-NAME             PIC  X(25).               04250023
042600                                                                  04260023
042700*---------------------------------------------------------------* 04270023
042800* SELECTON QUEUE LAYOUT                                         * 04280023
042900*---------------------------------------------------------------* 04290023
043000     COPY CEWS003.                                                04300023
043100**---------------------------------------------------------------*04310023
043200**  VARIABLES REQUIRED FOR THE USE OF THE LOG MESSAGE ROUTINE    *04320023
043300**  (EPPD000)                                                    *04330023
043400**---------------------------------------------------------------*04340023
043500                                                                  04350023
043600     COPY EPWS000.                                                04360023
043700                                                                  04370023
043800*----------------------------------------------------------------*04380023
043900*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE  WR # 230ZZ  *04390023
044000*----------------------------------------------------------------*04400023
044001     COPY XLWS001.                                                04400123
044002                                                                  04400200
044003*----------------------------------------------------------------*04400300
044004*   COPYBOOK FOR STORE DOMAIN ACCESS MODULE.                     *04400400
044005*----------------------------------------------------------------*04400500
044006     COPY XLWS071.                                                04400623
044007                                                                  04400700
044008*----------------------------------------------------------------*04400823
044009* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *04400923
044010*----------------------------------------------------------------*04401023
044020*---------------------------------------------------------------* 04402023
044030*    MAP LAYOUT                                                 * 04403023
044040*---------------------------------------------------------------* 04404023
044050     COPY CEKM607.                                                04405023
044060*                                                                 04406023
044070 01  MR-OCCURS-LAYOUT                   REDEFINES  CE607AO.       04407023
044080     05  FILLER                         PIC X(186).               04408023
044090     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          04409023
044100         10  MR-ACTIONL                 PIC S9(04) COMP.          04410023
044200         10  MR-ACTIONA                 PIC  X(01).               04420023
044300         10  MR-ACTIONC                 PIC  X(01).               04430023
044400         10  MR-ACTIONH                 PIC  X(01).               04440023
044500         10  MR-ACTION                  PIC  X(03).               04450023
044600                                                                  04460023
044700         10  MR-STORE-NBRL              PIC S9(04) COMP.          04470023
044800         10  MR-STORE-NBRA              PIC  X(01).               04480023
044900         10  MR-STORE-NBRC              PIC  X(01).               04490023
045000         10  MR-STORE-NBRH              PIC  X(01).               04500023
045100         10  MR-STORE-NBR-X.                                      04510023
045200             15  MR-STORE-NBR           PIC  X(04).               04520023
045300                                                                  04530023
045400         10  MR-REQ-UNITSL              PIC S9(04) COMP.          04540023
045500         10  MR-REQ-UNITSA              PIC  X(01).               04550023
045600         10  MR-REQ-UNITSC              PIC  X(01).               04560023
045700         10  MR-REQ-UNITSH              PIC  X(01).               04570023
045800         10  MR-REQ-UNITS               PIC  X(05).               04580023
045900                                                                  04590023
046000         10  MR-STORE-NAMEL             PIC S9(04) COMP.          04600023
046100         10  MR-STORE-NAMEA             PIC  X(01).               04610023
046200         10  MR-STORE-NAMEC             PIC  X(01).               04620023
046300         10  MR-STORE-NAMEH             PIC  X(01).               04630023
046400         10  MR-STORE-NAME              PIC  X(25).               04640023
046500                                                                  04650023
046600*---------------------------------------------------------------* 04660023
046700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04670023
046800*---------------------------------------------------------------* 04680023
046900     COPY DPWS015.                                                04690023
047000                                                                  04700023
047100*---------------------------------------------------------------* 04710023
047200*    FUNCTION KEYS COPYBOOK.                                    * 04720023
047300*---------------------------------------------------------------* 04730023
047400     COPY DPWS016.                                                04740023
047500                                                                  04750023
047600*---------------------------------------------------------------* 04760023
047700*    NUMERIC EDIT LAYOUT.                                       * 04770023
047800*---------------------------------------------------------------* 04780023
047900     COPY DPWS010I.                                               04790023
048000                                                                  04800023
048100*---------------------------------------------------------------* 04810023
048200*    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04820038
048300*---------------------------------------------------------------* 04830023
048400     COPY DPWS030.                                                04840023
048410     COPY DPWS930.                                                04841038
048500                                                                  04850023
048600*---------------------------------------------------------------* 04860023
048700*    STANDARD COMMAREA.                                         * 04870023
048800*---------------------------------------------------------------* 04880023
048900     COPY DPWS020.                                                04890023
049000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04900023
049100                                                                  04910023
049200*---------------------------------------------------------------* 04920023
049300* INTER-APPLICATION COMMAREA.                                   * 04930023
049400*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04940023
049500*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04950023
049600*---------------------------------------------------------------* 04960023
049700         10  INTER-APPL-COMM-AREA       PIC X(200).               04970023
049800     COPY CEWS002.                                                04980023
049900*---------------------------------------------------------------* 04990023
050000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05000023
050100*---------------------------------------------------------------* 05010023
050200         10  ASC-SPECIFIC-COMMAREA.                               05020023
050300             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          05030023
050400             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 05040023
050500                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          05050023
050600             15  ASC-CURR-FCLTY-ID           PIC  X(04).          05060023
050700             15  ASC-CURR-FCLTY-ID-N REDEFINES                    05070023
050800                     ASC-CURR-FCLTY-ID       PIC  9(04).          05080023
050900             15  ASC-CS-LOC                  PIC  X(04).          05090023
051000             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               05100023
051100                 20  ASC-CS-LOC-N            PIC  9(04).          05110023
051200             15  ASC-CS-LOCATION-DESC        PIC  X(25).          05120023
051300             15  ASC-PULL-NBR                PIC  X(09).          05130023
051400             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           05140023
051500                 20  ASC-PULL-NBR-N          PIC  9(09).          05150023
051600             15  ASC-REF-NBR                 PIC  X(15).          05160023
051700             15  ASC-SKU-NUMBER              PIC  X(10).          05170023
051800             15  ASC-LINE-NUMBER             PIC  9(04).          05180023
051900             15  ASC-LINE-ITEM               PIC  9(15).          05190023
052000             15  ASC-LINE-SKU-RETAIL         PIC  9(05)V99.       05200023
052100             15  ASC-LINE-STATUS-CDE         PIC  X(02).          05210023
052200                 88   ASC-LINE-STATUS-NEW             VALUE 'NW'. 05220023
052300                 88   ASC-LINE-STATUS-CANCELLED       VALUE 'CA'. 05230023
052400                 88   ASC-LINE-STATUS-INPROCESS       VALUE 'IP'. 05240023
052500                 88   ASC-LINE-STATUS-DISTRIBTD       VALUE 'DS'. 05250023
052600                 88   ASC-LINE-STATUS-POSTED          VALUE 'PD'. 05260023
052700             15  ASC-LINE-STATUS-DESC        PIC  X(08).          05270023
052800             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          05280023
052900                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    05290025
053000                                                   'I' 'N' 'P'    05300025
053010                                                   ' '.           05301027
053200                 88  ASC-SELECT-ALL               VALUE 'A'.      05320023
053300                 88  ASC-SELECT-CNCLD             VALUE 'C'.      05330023
053400                 88  ASC-SELECT-DSTRB             VALUE 'D'.      05340023
053500                 88  ASC-SELECT-INPROC            VALUE 'I'.      05350023
053600                 88  ASC-SELECT-NEW               VALUE 'N'.      05360023
053700                 88  ASC-SELECT-POSTD             VALUE 'P'.      05370023
053800             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          05380023
053810* 04-26-2010 CT START ADDED 'X' TO BOTH 88S                       05381038
053900                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    05390023
054000                                                   'M' 'X' ' '.   05400027
054100                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    05410023
054200                                                   'M' 'X'.       05420028
054210* 04-26-2010 CT END                                               05421038
054300                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      05430023
054400                 88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      05440023
054500                 88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      05450023
054600                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      05460023
054601* 04-26-2010 CT START ADDED 'X'= XFER                             05460138
054610                 88  ASC-SELECT-SRC-XFER          VALUE 'X'.      05461027
054620* 04-26-2010 CT END                                               05462038
054700             15  ASC-PULL-SELECT-DATE-FROM.                       05470023
054800                 20  ASC-FROM-MM             PIC  9(02).          05480023
054900                 20  ASC-FROM-DD             PIC  9(02).          05490023
055000                 20  ASC-FROM-YY             PIC  9(04).          05500023
055100             15  ASC-PULL-SELECT-DATE-TO.                         05510023
055200                 20  ASC-TO-MM               PIC  9(02).          05520023
055300                 20  ASC-TO-DD               PIC  9(02).          05530023
055400                 20  ASC-TO-YY               PIC  9(04).          05540023
055500             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          05550023
055600                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   05560023
055700                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       05570023
055800                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      05580023
055900                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      05590023
056000             15  ASC-PULL-STATUS             PIC  X(02).          05600023
056100                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     05610023
056200                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     05620023
056300                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     05630023
056400                 88  ASC-PULL-NEW                 VALUE 'NW'.     05640023
056500                 88  ASC-PULL-POSTED              VALUE 'PD'.     05650023
056600             15  ASC-PULL-TYPE               PIC  X(02).          05660023
056700                 88  ASC-PULL-SRC-ADAM            VALUE 'AD'.     05670023
056800                 88  ASC-PULL-SRC-INFOREM         VALUE 'IN'.     05680023
056900                 88  ASC-PULL-SRC-MANUAL          VALUE 'MA'.     05690023
056910                 88  ASC-PULL-SRC-XFER            VALUE 'XF'.     05691038
057000             15  ASC-NBR-STORES              PIC  S9(05).         05700023
057100             15  ASC-REQ-PULL-UNITS          PIC  S9(06).         05710023
057200             15  ASC-ACT-PULL-UNITS          PIC  S9(06).         05720023
057300             15  ASC-ACCUM-CEPLDS-QTY        PIC  S9(06).         05730023
057400                                                                  05740023
057500             15  FILLER                      PIC  X(107).         05750023
057600*-----------------------------------------------------------------05760023
057700             15  ASC-BLK-SUB                  PIC S9(04) COMP     05770023
057800                                                         SYNC.    05780023
057900             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05790023
058000                                                         SYNC.    05800023
058100             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05810023
058200             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05820023
058300             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05830023
058400             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05840023
058500             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05850023
058600             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05860023
058700                                                         SYNC.    05870023
058800             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05880023
058900             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05890023
059000             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05900023
059100                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05910023
059200                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05920023
059300             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05930023
059400                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05940023
059500                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05950023
059600             15  ASC-LIST-QUEUE-NAME.                             05960023
059700                 20  ASC-LIST-TERM-ID         PIC  X(04).         05970023
059800                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05980023
059900                 20  ASC-LIST-SEQ             PIC  9(01).         05990023
060000                                                                  06000023
060100             15  ASC-START-ITEM-REQUEST.                          06010023
060200                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         06020023
060300                                                                  06030023
060400             15  ASC-SEL-SUB                  PIC S9(4) COMP.     06040023
060500             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     06050023
060600             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          06060023
060700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 06070023
060800             15  ASC-SEL-QUEUE-NAME.                              06080023
060900                 20  ASC-SEL-TERM-ID          PIC  X(04).         06090023
061000                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  06100023
061100                 20  ASC-SEL-SEQ              PIC  9(01).         06110023
061200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  06120023
061300                                                                  06130023
061400*-----------------------------------------------------------------06140023
061500                                                                  06150023
061600             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06160023
061700                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06170023
061800                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06180023
061900                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06190023
062000                                                                  06200023
062100                 20  ASC-ITEM-ARRAY.                              06210023
062200                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        06220023
062300                         30  ASC-LIST-ITEM-NUMBER    PIC S9(09)   06230023
062400                                                     COMP-3.      06240023
062500                         30  ASC-ACTION              PIC  X(03).  06250023
062600                         30  ASC-STORE-NBR-X         PIC  X(04).  06260023
062700                         30  ASC-STORE-NBR-R REDEFINES            06270023
062800                             ASC-STORE-NBR-X.                     06280023
062900                             35  ASC-STORE-NBR       PIC  9(04).  06290023
063000                         30  ASC-REQ-UNITS-X         PIC  X(05).  06300023
063100                         30  ASC-REQ-UNITS-R REDEFINES            06310023
063200                             ASC-REQ-UNITS-X.                     06320023
063300                             35  ASC-REQ-UNITS       PIC  9(05).  06330023
063400                         30  ASC-STORE-NAME          PIC  X(25).  06340023
063500                                                                  06350023
063600*---------------------------------------------------------------* 06360023
063700*    ABEND PROCESSING COPYBOOK.                                 * 06370023
063800*---------------------------------------------------------------* 06380023
063900     COPY DPWS013.                                                06390023
064000                                                                  06400023
064100*---------------------------------------------------------------* 06410023
064200*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 06420023
064300*---------------------------------------------------------------* 06430023
064400     EXEC SQL                                                     06440023
064500          INCLUDE TCEPLRQ                                         06450023
064600     END-EXEC.                                                    06460023
064700                                                                  06470023
064800*---------------------------------------------------------------* 06480023
064900*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 06490023
065000*---------------------------------------------------------------* 06500023
065100     EXEC SQL                                                     06510023
065200          INCLUDE TCEPLDS                                         06520023
065300     END-EXEC.                                                    06530023
065400                                                                  06540023
065500*---------------------------------------------------------------* 06550023
065600*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 06560023
065700*---------------------------------------------------------------* 06570023
065800     EXEC SQL                                                     06580023
065900          INCLUDE TCEPLIT                                         06590023
066000     END-EXEC.                                                    06600023
066100                                                                  06610023
066200*---------------------------------------------------------------* 06620023
066300*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 06630023
066400*---------------------------------------------------------------* 06640023
066500     EXEC SQL                                                     06650023
066600          INCLUDE TCEPLST                                         06660023
066700     END-EXEC.                                                    06670023
066800                                                                  06680023
066900*-----------------------------------------------------------------06690023
067000*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 06700023
067100*-----------------------------------------------------------------06710023
067200     EXEC SQL                                                     06720023
067300          INCLUDE TKRPRPM                                         06730023
067400     END-EXEC.                                                    06740023
067500                                                                  06750023
067600*---------------------------------------------------------------* 06760023
067700*    DB2 AREA FOR COMMUNICATIONS                                * 06770023
067800*---------------------------------------------------------------* 06780023
067900     EXEC SQL                                                     06790023
068000          INCLUDE SQLCA                                           06800023
068100     END-EXEC.                                                    06810023
068200                                                                  06820023
068300*---------------------------------------------------------------* 06830023
068400*---------------------------------------------------------------* 06840023
068500 LINKAGE SECTION.                                                 06850023
068600                                                                  06860023
068700 01  DFHCOMMAREA.                                                 06870023
068800     05  FILLER                         OCCURS  1 TO 4072 TIMES   06880023
068900                                        DEPENDING ON EIBCALEN.    06890023
069000         10  FILLER                     PIC X.                    06900023
069100                                                                  06910023
069200/*****************************************************************06920023
069300 PROCEDURE DIVISION.                                              06930023
069400******************************************************************06940023
069500**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06950023
069600**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06960023
069700**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06970023
069800******************************************************************06980023
069900 0000-MAIN-MODULE.                                                06990023
070000     INITIALIZE DP030-CICS-API-FIELDS.                            07000023
070100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07010023
070200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07020023
070300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07030023
070400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07040023
070500     MOVE LENGTH OF CE607AI        TO DP030-MAP-LENGTH (1).       07050023
070600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07060023
070700     PERFORM 0001-CALL-CICS-ARCH-API.                             07070023
070800*                                                                 07080023
070900     PERFORM 1000-CONTROL-PROCESSING                              07090023
071000*                                                                 07100023
071100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07110023
071200     PERFORM 0001-CALL-CICS-ARCH-API.                             07120023
071300                                                                  07130023
071400******************************************************************07140023
071500**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07150023
071600**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07160023
071700******************************************************************07170023
071800 0001-CALL-CICS-ARCH-API.                                         07180023
071900     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07190038
072000                                    DFHCOMMAREA                   07200036
072100                                    DP030-CICS-API-FIELDS         07210036
072200                                    DP020-STANDARD-COMMAREA       07220036
072300                                    CE607AI.                      07230036
072400*                                                                 07240023
072500     IF  DP030-RC-CALL-SUCCESSFUL                                 07250023
072600         CONTINUE                                                 07260023
072700     ELSE                                                         07270023
072800         SET DP013-NO-ROLLBACK                                    07280023
072900             DP013-XCTL-DISPLAY-RESTART                           07290023
073000             DP013-CICS-ABEND      TO TRUE                        07300023
073100         MOVE '0001-CALL-CICS-ARCH-API'                           07310023
073200                                   TO DP013-PARAGRAPH             07320023
073210         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07321038
073220-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07322038
073500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07350023
073600         PERFORM DP013-0000-PROCESS-ABEND                         07360023
073700     END-IF.                                                      07370023
073800*----------------------------------------------------------------*07380023
073900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07390023
074000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07400023
074100*                                                                *07410023
074200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07420023
074300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07430023
074400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07440023
074500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07450023
074600*----------------------------------------------------------------*07460023
074700 1000-CONTROL-PROCESSING.                                         07470023
074800                                                                  07480023
074900     EVALUATE TRUE                                                07490023
075000         WHEN DP020-NEXT-ACT-INITIAL                              07500023
075100             INITIALIZE ASC-SPECIFIC-COMMAREA                     07510023
075200             MOVE EIBTRMID TO ASC-LIST-TERM-ID                    07520023
075300                              ASC-SEL-TERM-ID                     07530023
075400             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   07540023
075500                                           ASC-SEL-TASK-NUMBER    07550023
075600             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               07560023
075700             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                07570023
075800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07580023
075900***-----$TEMPLATE NOTE$-------------------------------------------07590023
076000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,07600023
076100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  07610023
076200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.07620023
076300***---------------------------------------------------------------07630023
076400             IF PS-COMMAREA-NOT-VALID                             07640023
076500                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            07650023
076600             ELSE                                                 07660023
076700                 PERFORM 4000-BUILD-INITIAL-PANEL                 07670023
076800             END-IF                                               07680023
076900                                                                  07690023
077000         WHEN DP020-NEXT-ACT-READ-MAP                             07700023
077100             PERFORM 2000-PROCESS-PANEL                           07710023
077200                                                                  07720023
077300         WHEN DP020-NEXT-ACT-RETURN                               07730023
077400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07740023
077500             PERFORM 3250-PROTECT-STORES                          07750023
077600                                                                  07760023
077700         WHEN OTHER                                               07770023
077800             SET DP013-LOGIC-ABEND TO TRUE                        07780023
077900             SET DP013-NO-ROLLBACK TO TRUE                        07790023
078000             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    07800023
078100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07810023
078200                                      TO DP013-MESSAGE-TEXT(1)    07820023
078300             PERFORM DP013-0000-PROCESS-ABEND                     07830023
078400     END-EVALUATE.                                                07840023
078500                                                                  07850023
078600*----------------------------------------------------------------*07860023
078700* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07870023
078800* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07880023
078900*----------------------------------------------------------------*07890023
079000 1100-PROCESS-INTER-APPL-COMM.                                    07900023
079100                                                                  07910023
079200     SET PS-COMMAREA-VALID         TO TRUE.                       07920023
079300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07930023
079400                                                                  07940023
079500     IF CE002-NUMBER-OF-SELECTED-ITEMS > 0                        07950023
079600         MOVE CE002-CURR-OPER-UNT-ID-N TO ASC-CURR-OPER-UNT-ID-N  07960023
079700         MOVE CE002-CURR-FCLTY-ID-N    TO ASC-CURR-FCLTY-ID-N     07970023
079800         MOVE CE002-CS-LOCATION        TO ASC-CS-LOC-N            07980023
079900         MOVE CE002-PULL-NBR           TO ASC-PULL-NBR-N          07990023
080000         MOVE CE002-REF-NBR            TO ASC-REF-NBR             08000023
080100         MOVE CE002-PULL-SELECT-STATUS TO ASC-PULL-SELECT-STATUS  08010023
080200         MOVE CE002-PULL-SELECT-TYPE   TO ASC-PULL-SELECT-TYPE    08020023
080201                                                                  08020138
080202         MOVE CE002-CURR-PULL-TYPE     TO ASC-PULL-TYPE           08020238
080203                                                                  08020338
080300         MOVE CE002-SELECT-LIST-SEQUENCE                          08030023
080400                                       TO ASC-SELECT-LIST-SEQUENCE08040023
080500         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    08050023
080600         MOVE CE002-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08060023
080700         MOVE CE002-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      08070023
080800         PERFORM 1120-PREPARE-LIST-ENTRY                          08080023
080900     ELSE                                                         08090023
081000         MOVE PC-TSYMSG-00057          TO DP020-MSG-NUMBER        08100023
081100         SET  PS-COMMAREA-NOT-VALID    TO TRUE                    08110023
081200     END-IF.                                                      08120023
081300                                                                  08130023
081400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08140023
081500 1120-PREPARE-LIST-ENTRY.                                         08150023
081600                                                                  08160023
081700     MOVE CE003-MAX-ITEMS          TO ASC-SEL-SUB.                08170023
081800     MOVE ZERO                     TO ASC-SEL-ITEM.               08180023
081900     PERFORM 1130-GET-NEXT-RECORD.                                08190023
082000                                                                  08200023
082100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08210023
082200*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08220023
082300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08230023
082400 1130-GET-NEXT-RECORD.                                            08240023
082500                                                                  08250023
082600     ADD +1                       TO ASC-SEL-SUB.                 08260023
082700                                                                  08270023
082800     IF  ASC-SEL-SUB > CE003-MAX-ITEMS                            08280023
082900         ADD +1                   TO ASC-SEL-ITEM                 08290023
083000         MOVE +1                  TO ASC-SEL-SUB                  08300023
083100     END-IF.                                                      08310023
083200                                                                  08320023
083300     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08330023
083400         PERFORM 9100-READ-SEL-QUEUE                              08340023
083500         IF  CE003-ITEM (ASC-SEL-SUB) > ZERO                      08350023
083600             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 08360023
083700                                  TO PV-PULL-NUMBER               08370023
083800                                     ASC-PULL-NBR-N               08380023
083900             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  08390023
084000                                  TO PV-REF-NUMBER                08400023
084100             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 08410023
084200                                  TO PV-LINE-NUMBER               08420023
084300                                     ASC-LINE-NUMBER              08430023
084400             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 08440023
084500                                  TO PV-CS-LOCATION               08450023
084600             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 08460023
084700                                  TO PV-CREATE-DATE               08470023
084800             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             08480023
084900                                  TO PV-PULL-STATUS-CDE           08490023
085000                                     ASC-PULL-STATUS              08500023
085100             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             08510023
085200                                  TO PV-PULL-SOURCE-CDE           08520023
085300*****                                ASC-PULL-TYPE                08530032
085400             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             08540023
085500                                  TO PV-SELECT-LIST-SEQ           08550023
085600             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   08560023
085700                                  TO PV-NBR-ITEMS                 08570023
085800             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  08580023
085900                                  TO PV-NBR-STORES                08590023
086000             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              08600023
086100                                  TO PV-REQ-PULL-UNITS            08610023
086200             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              08620023
086300                                  TO PV-ACT-PULL-UNITS            08630023
086400             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             08640023
086500                                  TO PV-DIST-PULL-UNITS           08650023
086600             MOVE CE003-LINE-STATUS-CDE (ASC-SEL-SUB)             08660023
086700                                  TO PV-LINE-STATUS-CDE           08670023
086800                                     ASC-LINE-STATUS-CDE          08680023
086900             MOVE CE003-LINE-SKU (ASC-SEL-SUB)                    08690023
087000                                  TO PV-LINE-SKU                  08700023
087100                                     ASC-SKU-NUMBER               08710023
087200             MOVE CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)             08720023
087300                                  TO PV-LINE-SKU-RETAIL           08730023
087400                                     ASC-LINE-SKU-RETAIL          08740023
087500             MOVE CE003-LINE-ITEM (ASC-SEL-SUB)                   08750023
087600                                  TO PV-LINE-ITEM                 08760023
087700                                     ASC-LINE-ITEM                08770023
087800                                                                  08780023
087900             SET CE003-INQ (ASC-SEL-SUB)                          08790023
088000                                  TO TRUE                         08800023
088100             INITIALIZE                 ASC-BLOCK-ENTRIES (1)     08810023
088200                                        ASC-BLOCK-ENTRIES (2)     08820023
088300             MOVE  1  TO  ASC-LIST-ITEM-NUMBER (1 1)              08830023
088400             INITIALIZE                 MR-REQ-UNITS (1)          08840023
088500                                        MR-REQ-UNITS (2)          08850023
088600                                        MR-REQ-UNITS (3)          08860023
088700                                        MR-REQ-UNITS (4)          08870023
088800                                        MR-REQ-UNITS (5)          08880023
088900                                        MR-REQ-UNITS (6)          08890023
089000                                        MR-REQ-UNITS (7)          08900023
089100                                        MR-REQ-UNITS (8)          08910023
089200                                        MR-REQ-UNITS (9)          08920023
089300                                        MR-REQ-UNITS (10)         08930023
089400                                                                  08940023
089500             PERFORM 9200-REWRITE-SEL-QUEUE                       08950023
089600         ELSE                                                     08960023
089700             SUBTRACT +1 FROM ASC-SEL-SUB                         08970023
089800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08980023
089900             SET DP020-MSG-INFORMATIONAL                          08990023
090000                 PS-LIST-END             TO TRUE                  09000023
090100         END-IF                                                   09010023
090200     ELSE                                                         09020023
090300         SUBTRACT +1 FROM ASC-SEL-ITEM                            09030023
090400         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  09040023
090500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09050023
090600         SET DP020-MSG-INFORMATIONAL                              09060023
090700             PS-LIST-END             TO TRUE                      09070023
090800     END-IF.                                                      09080023
090900                                                                  09090023
091000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09100023
091100*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09110023
091200*    PROCESSED.                                                  *09120023
091300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09130023
091400 1140-GET-PREV-RECORD.                                            09140023
091500                                                                  09150023
091600     SUBTRACT +1 FROM ASC-SEL-SUB.                                09160023
091700                                                                  09170023
091800     IF  ASC-SEL-SUB < +1                                         09180023
091900         SUBTRACT +1 FROM ASC-SEL-ITEM                            09190023
092000         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  09200023
092100     END-IF.                                                      09210023
092200                                                                  09220023
092300     IF  ASC-SEL-ITEM > ZERO                                      09230023
092400         PERFORM 9100-READ-SEL-QUEUE                              09240023
092500             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 09250023
092600                                  TO PV-PULL-NUMBER               09260023
092700                                     ASC-PULL-NBR-N               09270023
092800             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  09280023
092900                                  TO PV-REF-NUMBER                09290023
093000             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 09300023
093100                                  TO PV-LINE-NUMBER               09310023
093200                                     ASC-LINE-NUMBER              09320023
093300             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 09330023
093400                                  TO PV-CS-LOCATION               09340023
093500             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 09350023
093600                                  TO PV-CREATE-DATE               09360023
093700             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             09370023
093800                                  TO PV-PULL-STATUS-CDE           09380023
093900             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             09390023
094000                                  TO PV-PULL-SOURCE-CDE           09400023
094100             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             09410023
094200                                  TO PV-SELECT-LIST-SEQ           09420023
094300             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   09430023
094400                                  TO PV-NBR-ITEMS                 09440023
094500             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  09450023
094600                                  TO PV-NBR-STORES                09460023
094700             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              09470023
094800                                  TO PV-REQ-PULL-UNITS            09480023
094900             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              09490023
095000                                  TO PV-ACT-PULL-UNITS            09500023
095100             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             09510023
095200                                  TO PV-DIST-PULL-UNITS           09520023
095300             MOVE CE003-LINE-STATUS-CDE (ASC-SEL-SUB)             09530023
095400                                  TO PV-LINE-STATUS-CDE           09540023
095500             MOVE CE003-LINE-SKU (ASC-SEL-SUB)                    09550023
095600                                  TO PV-LINE-SKU                  09560023
095700             MOVE CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)             09570023
095800                                  TO PV-LINE-SKU-RETAIL           09580023
095900             MOVE CE003-LINE-ITEM (ASC-SEL-SUB)                   09590023
096000                                  TO PV-LINE-ITEM                 09600023
096100                                     ASC-LINE-ITEM                09610023
096200         SET CE003-INQ (ASC-SEL-SUB)                              09620023
096300                                  TO TRUE                         09630023
096400         INITIALIZE                 ASC-BLOCK-ENTRIES (1)         09640023
096500                                    ASC-BLOCK-ENTRIES (2)         09650023
096600         MOVE  1  TO  ASC-LIST-ITEM-NUMBER (1 1)                  09660023
096700         INITIALIZE                 MR-REQ-UNITS (1)              09670023
096800                                    MR-REQ-UNITS (2)              09680023
096900                                    MR-REQ-UNITS (3)              09690023
097000                                    MR-REQ-UNITS (4)              09700023
097100                                    MR-REQ-UNITS (5)              09710023
097200                                    MR-REQ-UNITS (6)              09720023
097300                                    MR-REQ-UNITS (7)              09730023
097400                                    MR-REQ-UNITS (8)              09740023
097500                                    MR-REQ-UNITS (9)              09750023
097600                                    MR-REQ-UNITS (10)             09760023
097700         PERFORM 9200-REWRITE-SEL-QUEUE                           09770023
097800     ELSE                                                         09780023
097900         MOVE +1                  TO ASC-SEL-ITEM                 09790023
098000                                     ASC-SEL-SUB                  09800023
098100         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09810023
098200         SET DP020-MSG-INFORMATIONAL                              09820023
098300             PS-LIST-END             TO TRUE                      09830023
098400     END-IF.                                                      09840023
098500                                                                  09850023
098600*----------------------------------------------------------------*09860023
098700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09870023
098800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09880023
098900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09890023
099000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09900023
099100* FUNCTION KEYS CAN GET THIS FAR.                                *09910023
099200*----------------------------------------------------------------*09920023
099300 2000-PROCESS-PANEL.                                              09930023
099400                                                                  09940023
099500     MOVE ASC-CS-LOC-N    TO DK-STORE-NUMBER.                     09950023
099600                                                                  09960023
099700     PERFORM 3500-GET-STORE-INFORMATION.                          09970023
099800                                                                  09980023
099900     MOVE XL071-E-BUS-IND TO DK-E-BUS-IND.                        09990023
100000                                                                  10000023
100100     EVALUATE TRUE                                                10010023
100200         WHEN DP020-SRC-AID = DP016-CLEAR                         10020023
100300             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                10030023
100400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10040023
100500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10050023
100600                                                                  10060023
100700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10070023
100800             PERFORM 2050-DELETE-LIST-QUEUE                       10080023
100900             PERFORM 4000-BUILD-INITIAL-PANEL                     10090023
101000                                                                  10100023
101100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10110023
101200             IF ASC-USE-SELECTION-QUEUE                           10120023
101300                 IF ASC-REQ-PULL-UNITS  NOT = ASC-ACCUM-CEPLDS-QTY10130023
101400                     MOVE PC-TSYMSG-02554 TO DP020-MSG-NUMBER     10140023
101500                     SET DP020-MSG-INFORMATIONAL TO TRUE          10150023
101600                 ELSE                                             10160023
101700                     PERFORM 1130-GET-NEXT-RECORD                 10170023
101800                     IF PS-LIST-END                               10180023
101900                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     10190023
102000                         SET PS-NO-LIST-END TO TRUE               10200023
102100                     ELSE                                         10210023
102200                         PERFORM 2050-DELETE-LIST-QUEUE           10220023
102300                         PERFORM 3200-RESET-ATTRIBUTES            10230023
102400                         PERFORM 4000-BUILD-INITIAL-PANEL         10240023
102500                     END-IF                                       10250023
102600                 END-IF                                           10260023
102700             ELSE                                                 10270023
102800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10280023
102900*                --- BOTTOM OF LIST ---                           10290023
103000                 MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER    10300023
103100                 SET DP020-MSG-INFORMATIONAL TO TRUE              10310023
103200             END-IF                                               10320023
103300                                                                  10330023
103400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10340023
103500             IF ASC-USE-SELECTION-QUEUE                           10350023
103600                 IF ASC-REQ-PULL-UNITS  NOT = ASC-ACCUM-CEPLDS-QTY10360023
103700                     MOVE PC-TSYMSG-02554 TO DP020-MSG-NUMBER     10370023
103800                     SET DP020-MSG-INFORMATIONAL TO TRUE          10380023
103900                 ELSE                                             10390023
104000                     PERFORM 1140-GET-PREV-RECORD                 10400023
104100                     IF PS-LIST-END                               10410023
104200                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     10420023
104300                         SET PS-NO-LIST-END TO TRUE               10430023
104400                     ELSE                                         10440023
104500                         PERFORM 2050-DELETE-LIST-QUEUE           10450023
104600                         PERFORM 3200-RESET-ATTRIBUTES            10460023
104700                         PERFORM 4000-BUILD-INITIAL-PANEL         10470023
104800                     END-IF                                       10480023
104900                 END-IF                                           10490023
105000             ELSE                                                 10500023
105100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10510023
105200                 MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER    10520023
105300                 SET DP020-MSG-INFORMATIONAL TO TRUE              10530023
105400             END-IF                                               10540023
105500                                                                  10550023
105600         WHEN OTHER                                               10560023
105700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10570023
105800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10580023
105900                                                                  10590023
106000             IF PS-NO-ERROR                                       10600023
106100                 SET DP030-CONTINUE-GO TO TRUE                    10610023
106200                 PERFORM 2100-CHECK-FUNCTION-KEY                  10620023
106300             ELSE                                                 10630023
106400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10640023
106500                 SET DP030-OVERRIDE-GO TO TRUE                    10650023
106600             END-IF                                               10660023
106700     END-EVALUATE.                                                10670023
106800                                                                  10680023
106900*----------------------------------------------------------------*10690023
107000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10700023
107100*----------------------------------------------------------------*10710023
107200 2050-DELETE-LIST-QUEUE.                                          10720023
107300                                                                  10730023
107400     EXEC CICS                                                    10740023
107500         DELETEQ TS                                               10750023
107600             QUEUE (ASC-LIST-QUEUE-NAME)                          10760023
107700             RESP  (PV-CICS-RESP)                                 10770023
107800     END-EXEC.                                                    10780023
107900                                                                  10790023
108000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10800023
108100        (PV-CICS-RESP = DFHRESP(QIDERR))                          10810023
108200         CONTINUE                                                 10820023
108300     ELSE                                                         10830023
108400         SET DP013-CICS-ABEND      TO TRUE                        10840023
108500         SET DP013-NO-ROLLBACK     TO TRUE                        10850023
108600                                                                  10860023
108700         MOVE '2050-DELETE-LIST-QUEUE'                            10870023
108800                                   TO DP013-PARAGRAPH             10880023
108900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10890023
109000                                   TO DP013-MESSAGE-TEXT (1)      10900023
109100         PERFORM DP013-0000-PROCESS-ABEND                         10910023
109200     END-IF.                                                      10920023
109300                                                                  10930023
109400     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        10940023
109500                                                                  10950023
109600*----------------------------------------------------------------*10960023
109700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10970023
109800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10980023
109900* CICS ARCHITECTURE API.                                         *10990023
110000*----------------------------------------------------------------*11000023
110100 2100-CHECK-FUNCTION-KEY.                                         11010023
110200                                                                  11020023
110300     EVALUATE TRUE                                                11030023
110400*                                                                 11040023
110500* F13 - ADD STORE(S)                                              11050023
110600*                                                                 11060023
110700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11070023
110800             IF (ASC-STORE-NBR (1 1) > ZERO AND                   11080023
110900                 ASC-ACTION (1 1) NOT = 'ADD')                    11090023
111000               OR (ASC-STORE-NBR (1 2) > ZERO AND                 11100023
111100                   ASC-ACTION (1 2) NOT = 'ADD')                  11110023
111200               OR (ASC-STORE-NBR (1 3) > ZERO AND                 11120023
111300                   ASC-ACTION (1 3) NOT = 'ADD')                  11130023
111400               OR (ASC-STORE-NBR (1 4) > ZERO AND                 11140023
111500                   ASC-ACTION (1 4) NOT = 'ADD')                  11150023
111600               OR (ASC-STORE-NBR (1 5) > ZERO AND                 11160023
111700                   ASC-ACTION (1 5) NOT = 'ADD')                  11170023
111800               OR (ASC-STORE-NBR (1 6) > ZERO AND                 11180023
111900                   ASC-ACTION (1 6) NOT = 'ADD')                  11190023
112000               OR (ASC-STORE-NBR (1 7) > ZERO AND                 11200023
112100                   ASC-ACTION (1 7) NOT = 'ADD')                  11210023
112200               OR (ASC-STORE-NBR (1 8) > ZERO AND                 11220023
112300                   ASC-ACTION (1 8) NOT = 'ADD')                  11230023
112400               OR (ASC-STORE-NBR (1 9) > ZERO AND                 11240023
112500                   ASC-ACTION (1 9) NOT = 'ADD')                  11250023
112600               OR (ASC-STORE-NBR (1 10) > ZERO AND                11260023
112700                   ASC-ACTION (1 10) NOT = 'ADD')                 11270023
112800                 IF DK-E-BUS-IND = 'Y'                            11280023
112900                     PERFORM 2220-COUNT-STORES                    11290023
113000                     PERFORM 2230-SELECT-LIMIT                    11300023
113100                     IF PV-STORE-COUNT > PV-MAX-QTY               11310023
113200                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11320023
113300                         SET DP030-OVERRIDE-GO TO TRUE            11330023
113400*                        ---- TOO MANY STORES FOR E-COMM  ----    11340023
113500                         MOVE PC-TSYMSG-02629  TO DP020-MSG-NUMBER11350023
113600                         SET DP020-MSG-FATAL TO TRUE              11360023
113700                     ELSE                                         11370023
113800                         MOVE ZEROES TO PV-ACCUM-CEPLDS-QTY       11380023
113900                         PERFORM 4700-PROCESS-ADD-FUNCTION        11390023
114000                           VARYING PV-ITEM FROM 1 BY 1            11400023
114100                             UNTIL PV-ITEM > 10                   11410023
114200                                OR PS-SOFT-ABORT-ERROR            11420023
114300** (DMH 1/23/00) **  PERFORM 4800-UPDATE-CEPLIT-REQ-QTY           11430023
114400                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     11440023
114500                         PERFORM 3250-PROTECT-STORES              11450023
114600                     END-IF                                       11460023
114700                 ELSE                                             11470023
114800                     MOVE ZEROES TO PV-ACCUM-CEPLDS-QTY           11480023
114900                     PERFORM 4700-PROCESS-ADD-FUNCTION            11490023
115000                       VARYING PV-ITEM FROM 1 BY 1                11500023
115100                         UNTIL PV-ITEM > 10                       11510023
115200                            OR PS-SOFT-ABORT-ERROR                11520023
115300** (DMH 1/23/00) **  PERFORM 4800-UPDATE-CEPLIT-REQ-QTY           11530023
115400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11540023
115500                     PERFORM 3250-PROTECT-STORES                  11550023
115600                 END-IF                                           11560023
115700             ELSE                                                 11570023
115800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11580023
115900                 SET DP030-OVERRIDE-GO TO TRUE                    11590023
116000*                ----  NO STORES TO ADD  ----                     11600023
116100                 MOVE PC-TSYMSG-02279  TO DP020-MSG-NUMBER        11610023
116200                 SET DP020-MSG-FATAL TO TRUE                      11620023
116300             END-IF                                               11630023
116400                                                                  11640023
116500*                                                                 11650023
116600* F17 - STORE LIST (CEKCS603)                                     11660023
116700*                                                                 11670023
116800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11680023
116900             INITIALIZE CE002-INTER-APPL-COMMAREA                 11690023
117000             MOVE +1                                              11700023
117100                   TO CE002-NUMBER-OF-SELECTED-ITEMS              11710023
117200             MOVE ASC-CURR-OPER-UNT-ID-N                          11720023
117300                   TO CE002-CURR-OPER-UNT-ID-N                    11730023
117400             MOVE ASC-CURR-FCLTY-ID-N                             11740023
117500                   TO CE002-CURR-FCLTY-ID-N                       11750023
117600             MOVE ASC-CS-LOC-N      TO CE002-CS-LOCATION          11760023
117700*???         MOVE ASC-CS-PRINTER-ID TO CE002-CS-PRINTER-ID        11770023
117800             MOVE ASC-PULL-NBR-N    TO CE002-PULL-NBR             11780023
117900             MOVE ASC-REF-NBR       TO CE002-REF-NBR              11790023
118000             MOVE ASC-PULL-SELECT-STATUS                          11800023
118100                   TO CE002-PULL-SELECT-STATUS                    11810023
118200             MOVE ASC-PULL-SELECT-TYPE                            11820023
118300                   TO CE002-PULL-SELECT-TYPE                      11830023
118400             MOVE ASC-SELECT-LIST-SEQUENCE                        11840023
118500                   TO CE002-SELECT-LIST-SEQUENCE                  11850023
118600             PERFORM 5000-PREPARE-SEL-QUEUE                       11860023
118700                                                                  11870023
118800*                                                                 11880023
118900* ENTER KEY                                                       11890023
119000*                                                                 11900023
119100         WHEN DP020-SRC-AID = DP016-ENTER                         11910023
119200             IF DK-E-BUS-IND = 'Y'                                11920023
119300                 PERFORM 2220-COUNT-STORES                        11930023
119400                 PERFORM 2230-SELECT-LIMIT                        11940023
119500                 IF PV-STORE-COUNT > PV-MAX-QTY                   11950023
119600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11960023
119700                     SET DP030-OVERRIDE-GO TO TRUE                11970023
119800*                    ---- TOO MANY STORES FOR E-COMM  ----        11980023
119900                     MOVE PC-TSYMSG-02629  TO DP020-MSG-NUMBER    11990023
120000                     SET DP020-MSG-FATAL TO TRUE                  12000023
120100                 ELSE                                             12010023
120200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12020023
120300                 END-IF                                           12030023
120400             ELSE                                                 12040023
120500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12050023
120600             END-IF                                               12060023
120700                                                                  12070023
120800         WHEN DP020-FK-LOCAL-FUNC-12 (DP020-SRC-AID)              12080023
120900             CONTINUE                                             12090023
121000                                                                  12100023
121100         WHEN OTHER                                               12110023
121200             SET DP013-NO-ROLLBACK                                12120023
121300                 DP013-XCTL-DISPLAY-RESTART                       12130023
121400                 DP013-CICS-ABEND           TO TRUE               12140023
121500             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    12150023
121600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12160023
121700                                   TO DP013-MESSAGE-TEXT (1)      12170023
121800             PERFORM DP013-0000-PROCESS-ABEND                     12180023
121900     END-EVALUATE.                                                12190023
122000                                                                  12200023
122100******************************************************************12210023
122200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **12220023
122300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **12230023
122400******************************************************************12240023
122500 2200-MOVE-SCREEN-TO-COMMAREA.                                    12250023
122600                                                                  12260023
122700     MOVE PV-TOP-ITEM          TO PV-ITEM-IN-USE.                 12270023
122800     MOVE +1                   TO PV-SUB.                         12280023
122900                                                                  12290023
123000     PERFORM 3100-SET-SUBSCRIPTS.                                 12300023
123100                                                                  12310023
123200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          12320023
123300       VARYING PV-SUB FROM 1 BY 1                                 12330023
123400         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      12340023
123500                                                                  12350023
123600******************************************************************12360023
123700** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**12370023
123800******************************************************************12380023
123900 2210-MOVE-LINES-TO-COMMAREA.                                     12390023
124000                                                                  12400023
124100*STORE NUMBER.                                                    12410023
124200     IF (MR-STORE-NBRL (PV-SUB) > ZERO)                           12420023
124300       AND (MR-ACTION (PV-SUB) NOT = 'ADD')                       12430023
124400         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             12440023
124500         MOVE MR-STORE-NBR (PV-SUB)                               12450023
124600           TO ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)          12460023
124700         MOVE ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)          12470023
124800           TO DP010I-UNEDITED-FIELD                               12480023
124900         MOVE LENGTH OF ASC-STORE-NBR                             12490023
125000           TO DP010I-MAXIMUM-DIGITS                               12500023
125100         MOVE ZERO TO DP010I-MAXIMUM-DECIMALS                     12510023
125200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12520023
125300         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12530038
125310              USING DP010I-NUMERIC-EDIT-AREA                      12531038
125400         IF DP010I-ERROR-DETECTED                                 12540023
125500             CONTINUE                                             12550023
125600         ELSE                                                     12560023
125700             MOVE DP010I-NUMERIC-FIELD                            12570023
125800               TO ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)        12580023
125900             IF ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES 12590023
126000                 MOVE ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)  12600023
126100                   TO MR-STORE-NBR (PV-SUB)                       12610023
126200             ELSE                                                 12620023
126300                 MOVE SPACES TO MR-STORE-NBR (PV-SUB)             12630023
126400                                MR-STORE-NAME (PV-SUB)            12640023
126500             END-IF                                               12650023
126600         END-IF                                                   12660023
126700     ELSE                                                         12670023
126800         IF MR-STORE-NBRA (PV-SUB) = DP015-ERASE-EOF              12680023
126900             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         12690023
127000             MOVE SPACES TO ASC-STORE-NBR-X                       12700023
127100                                    (ASC-BLK-SUB, ASC-ITEM-SUB)   12710023
127200             MOVE SPACES TO MR-STORE-NBR (PV-SUB)                 12720023
127300                            MR-STORE-NAME (PV-SUB)                12730023
127400         END-IF                                                   12740023
127500     END-IF.                                                      12750023
127600                                                                  12760023
127700*REQUESTED UNITS.                                                 12770023
127800     IF (MR-REQ-UNITSL (PV-SUB) > ZERO)                           12780023
127900       AND (MR-ACTION (PV-SUB) NOT = 'ADD')                       12790023
128000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             12800023
128100         MOVE MR-REQ-UNITS (PV-SUB)                               12810023
128200           TO ASC-REQ-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB)          12820023
128300         MOVE ASC-REQ-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB)          12830023
128400           TO DP010I-UNEDITED-FIELD                               12840023
128500         MOVE LENGTH OF ASC-REQ-UNITS TO DP010I-MAXIMUM-DIGITS    12850023
128600         MOVE ZERO TO DP010I-MAXIMUM-DECIMALS                     12860023
128700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12870023
128800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12880038
128810              USING DP010I-NUMERIC-EDIT-AREA                      12881038
128900         IF DP010I-ERROR-DETECTED                                 12890023
129000             CONTINUE                                             12900023
129100         ELSE                                                     12910023
129200             MOVE DP010I-NUMERIC-FIELD                            12920023
129300               TO ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)        12930023
129400             MOVE ASC-REQ-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB)      12940023
129500               TO MR-REQ-UNITS (PV-SUB)                           12950023
129600         END-IF                                                   12960023
129700     ELSE                                                         12970023
129800         IF MR-REQ-UNITSA (PV-SUB) = DP015-ERASE-EOF              12980023
129900             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         12990023
130000             MOVE SPACES TO ASC-REQ-UNITS-X                       13000023
130100                                    (ASC-BLK-SUB, ASC-ITEM-SUB)   13010023
130200             MOVE SPACES TO MR-REQ-UNITS (PV-SUB)                 13020023
130300         END-IF                                                   13030023
130400     END-IF.                                                      13040023
130500                                                                  13050023
130600     ADD +1 TO ASC-ITEM-SUB.                                      13060023
130700     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         13070023
130800         ADD +1  TO ASC-BLK-SUB                                   13080023
130900         MOVE +1 TO ASC-ITEM-SUB                                  13090023
131000     END-IF.                                                      13100023
131100                                                                  13110023
131200******************************************************************13120023
131300** COUNT THE NUMBER OF STORE FOR AN E-COMMERCE PULL             **13130023
131400******************************************************************13140023
131500 2220-COUNT-STORES.                                               13150023
131600                                                                  13160023
131700     PERFORM                                                      13170023
131800       VARYING PV-SUB FROM 1 BY 1                                 13180023
131900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        13190023
132000                                                                  13200023
132100         IF ASC-STORE-NBR (1 PV-SUB) > ZERO                       13210023
132200             ADD 1                  TO PV-STORE-COUNT             13220023
132300         END-IF                                                   13230023
132400     END-PERFORM.                                                 13240023
132500***************************************************************** 13250023
132600 2230-SELECT-LIMIT.                                               13260023
132700*     SELECT THE MAXIMUM NUMBER OF STORE LINES                    13270023
135000***************************************************************** 13500000
135100                                                                  13510000
135200     MOVE ZERO               TO PV-MAX-QTY.                       13520000
135300     EXEC SQL                                                     13530000
135400         SELECT FUNC_QTY                                          13540000
135500           INTO :KRPRPM-FUNC-QTY                                  13550000
135600           FROM TKRPRPM                                           13560000
135700          WHERE SYS_PRC_FUNC_CDE  = 'MAXSTR'                      13570000
135800            AND LOC_ID            = 090                           13580000
135900            AND INTFC_SYS_CDE     = 'RDM'                         13590000
136000            AND FUNC_PRC_STAT_CDE = 'AC'                          13600000
136100            AND (CURRENT DATE                                     13610000
136200        BETWEEN DATE(FUNC_BEG_TMST) AND                           13620000
136300                DATE(FUNC_END_TMST) )                             13630000
136400     END-EXEC.                                                    13640000
136500                                                                  13650000
136600     EVALUATE SQLCODE                                             13660000
136700         WHEN ZERO                                                13670000
136800             MOVE KRPRPM-FUNC-QTY     TO PV-MAX-QTY               13680000
136900         WHEN OTHER                                               13690000
137000              MOVE '2230-SELECT-LIMIT'                            13700000
137100                               TO DP013-PARAGRAPH                 13710000
137200              MOVE 'SELECT MAX NUMBER OF STORES'                  13720000
137300                               TO DP013-MESSAGE-TEXT (1)          13730000
137400              MOVE SQLCA       TO DP013-SQLCA                     13740000
137500              SET DP013-DB2-ABEND                                 13750000
137600                               TO TRUE                            13760000
137700              PERFORM DP013-0000-PROCESS-ABEND                    13770000
137800     END-EVALUATE.                                                13780000
142700******************************************************************14270000
142800** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **14280000
142900** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **14290000
143000******************************************************************14300000
143100 3000-EDIT-DATA-IN-COMMAREA.                                      14310000
143200                                                                  14320000
143300     SET PS-NO-ERROR               TO TRUE.                       14330000
143400     PERFORM 3200-RESET-ATTRIBUTES.                               14340000
143500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     14350000
143600                                                                  14360000
143700*-----------------------------------------------------------------14370000
143800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              14380000
143900* EDITTING IS DONE FROM THE BOTTOM UP.                            14390000
144000*-----------------------------------------------------------------14400000
144100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       14410000
144200         ASC-ITEMS-DISPLAYED - 1.                                 14420000
144300                                                                  14430000
144400     PERFORM 3100-SET-SUBSCRIPTS.                                 14440000
144500                                                                  14450000
144600     INITIALIZE  PV-TOTAL-NEW-UNITS.                              14460000
144700                                                                  14470000
144800     PERFORM 3300-EDIT-SELECTIONS                                 14480000
144900       VARYING PV-SUB FROM PV-SUB BY -1                           14490000
145000         UNTIL PV-SUB < +1.                                       14500000
145100                                                                  14510000
145200     MOVE PV-TOTAL-NEW-UNITS    TO PV-SAVE-TOTAL-NEW-UNITS.       14520000
145300     IF PS-NO-ERROR                                               14530000
145400         PERFORM 3400-XEDIT-STORES                                14540000
145500           VARYING PV-SUB1 FROM 1 BY 1                            14550000
145600             UNTIL PV-SUB1 > PC-ITEMS-PER-PANEL                   14560000
145700     END-IF.                                                      14570000
145800                                                                  14580000
145900     IF  PS-NO-ERROR                                              14590000
146000         MOVE ASC-PULL-NBR-N            TO DK-PULL-NUMBER         14600000
146100         MOVE ASC-LINE-NUMBER           TO DK-LINE-NUMBER         14610000
146200         PERFORM 4530-GET-CEPLDS-QTYS                             14620000
146300         IF  PV-CEPLDS-ACT-QTY  >  0                              14630000
146400             ADD  PV-CEPLDS-ACT-QTY  TO  PV-TOTAL-NEW-UNITS       14640000
146500         ELSE                                                     14650000
146600             ADD  PV-CEPLDS-REQ-QTY  TO  PV-TOTAL-NEW-UNITS       14660000
146700         END-IF                                                   14670000
146800         IF  ASC-ACT-PULL-UNITS  >  0                             14680000
146900             IF  PV-TOTAL-NEW-UNITS  > ASC-ACT-PULL-UNITS         14690000
147000                 SET PS-ERROR                                     14700000
147100                     DP020-MSG-FATAL  TO TRUE                     14710000
147200                 MOVE PC-TSYMSG-02331 TO DP020-MSG-NUMBER         14720000
147300                 MOVE -1                TO MR-STORE-NBRL (1)      14730000
147400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14740000
147500             END-IF                                               14750000
147600         ELSE                                                     14760000
147700             IF  PV-TOTAL-NEW-UNITS  > ASC-REQ-PULL-UNITS         14770000
147800                 SET PS-ERROR                                     14780000
147900                     DP020-MSG-FATAL  TO TRUE                     14790000
148000                 MOVE PC-TSYMSG-02331 TO DP020-MSG-NUMBER         14800000
148100                 MOVE -1                TO MR-STORE-NBRL (1)      14810000
148200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              14820000
148300             END-IF                                               14830000
148400         END-IF.                                                  14840000
148500                                                                  14850000
148600                                                                  14860000
148700     IF  PS-NO-ERROR                                              14870000
148800         IF DK-E-BUS-IND = 'Y' AND                                14880016
148900            (PV-CEPLDS-REQ-QTY + PV-SAVE-TOTAL-NEW-UNITS)         14890000
149000             <  ASC-REQ-PULL-UNITS  AND                           14900000
149100             DP020-FK-LOCAL-FUNC-12 (DP020-SRC-AID)               14910000
149200             SET PS-ERROR                                         14920000
149300                 DP020-MSG-FATAL  TO TRUE                         14930000
149400             MOVE PC-TSYMSG-02554 TO DP020-MSG-NUMBER             14940000
149500             MOVE -1                TO MR-STORE-NBRL (1)          14950000
149600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14960000
149700         END-IF                                                   14970000
149800     END-IF.                                                      14980000
149900*----------------------------------------------------------------*14990000
150000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15000000
150100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15010000
150200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15020000
150300*                                                                *15030000
150400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15040000
150500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15050000
150600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15060000
150700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15070000
150800*----------------------------------------------------------------*15080000
150900 3100-SET-SUBSCRIPTS.                                             15090000
151000                                                                  15100000
151100     COMPUTE ASC-ITEM-SUB =                                       15110000
151200         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15120000
151300                                                                  15130000
151400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15140000
151500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15150000
151600         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               15160000
151700     ELSE                                                         15170000
151800         MOVE +1                     TO ASC-BLK-SUB               15180000
151900     END-IF.                                                      15190000
152000                                                                  15200000
152100******************************************************************15210000
152200** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **15220000
152300******************************************************************15230000
152400 3200-RESET-ATTRIBUTES.                                           15240000
152500                                                                  15250000
152600     PERFORM                                                      15260000
152700       VARYING PV-SUB FROM 1 BY 1                                 15270000
152800         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        15280000
152900                                                                  15290000
153000         IF ASC-ACTION (1 1) = 'ADD'                              15300000
153100           OR ASC-ACTION (1 2) = 'ADD'                            15310000
153200           OR ASC-ACTION (1 3) = 'ADD'                            15320000
153300           OR ASC-ACTION (1 4) = 'ADD'                            15330000
153400           OR ASC-ACTION (1 5) = 'ADD'                            15340000
153500           OR ASC-ACTION (1 6) = 'ADD'                            15350000
153600           OR ASC-ACTION (1 7) = 'ADD'                            15360000
153700           OR ASC-ACTION (1 8) = 'ADD'                            15370000
153800           OR ASC-ACTION (1 9) = 'ADD'                            15380000
153900           OR ASC-ACTION (1 10) = 'ADD'                           15390000
154000             CONTINUE                                             15400000
154100         ELSE                                                     15410000
154200             MOVE DP015-UNP-ALP-NOR-OFF TO MR-STORE-NBRA (PV-SUB) 15420000
154300                                           MR-REQ-UNITSA (PV-SUB) 15430000
154400             MOVE DP015-GREEN           TO MR-STORE-NBRC (PV-SUB) 15440000
154500                                           MR-REQ-UNITSC (PV-SUB) 15450000
154600             MOVE DP015-UNDERLINE       TO MR-STORE-NBRH (PV-SUB) 15460000
154700                                           MR-REQ-UNITSH (PV-SUB) 15470000
154800         END-IF                                                   15480000
154900     END-PERFORM.                                                 15490000
155000                                                                  15500000
155100******************************************************************15510000
155200** PROTECT THE DETAIL PORTION OF THE MAP.                       **15520000
155300******************************************************************15530000
155400 3250-PROTECT-STORES.                                             15540000
155500                                                                  15550000
155600     PERFORM                                                      15560000
155700       VARYING PV-SUB FROM 1 BY 1                                 15570000
155800         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        15580000
155900                                                                  15590000
156000         IF MR-STORE-NBR (PV-SUB) NOT = SPACES                    15600000
156100             MOVE DP015-PRO-NOR-OFF TO MR-STORE-NBRA (PV-SUB)     15610000
156200                                       MR-REQ-UNITSA (PV-SUB)     15620000
156300             MOVE DP015-BLUE        TO MR-STORE-NBRC (PV-SUB)     15630000
156400                                       MR-REQ-UNITSC (PV-SUB)     15640000
156500         END-IF                                                   15650000
156600     END-PERFORM.                                                 15660000
156700                                                                  15670000
156800******************************************************************15680000
156900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **15690000
157000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **15700000
157100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **15710000
157200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **15720000
157300******************************************************************15730000
157400 3300-EDIT-SELECTIONS.                                            15740000
157500                                                                  15750000
157600     IF ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB) NOT = 'ADD'         15760000
157700         PERFORM 3310-EDIT-LINES                                  15770000
157800     END-IF.                                                      15780000
157900                                                                  15790000
158000     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             15800000
158100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               15810000
158200                                                                  15820000
158300     IF ASC-ITEM-SUB < 1                                          15830000
158400         SUBTRACT +1 FROM ASC-BLK-SUB                             15840000
158500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  15850000
158600     END-IF.                                                      15860000
158700                                                                  15870000
158800*----------------------------------------------------------------*15880000
158900*  EDIT SELECTED LINES                                           *15890000
159000*----------------------------------------------------------------*15900000
159100 3310-EDIT-LINES.                                                 15910000
159200                                                                  15920000
159300*EDIT STORE NUMBER.                                               15930000
159400     IF ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       15940000
159500         MOVE ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)          15950000
159600           TO DP010I-UNEDITED-FIELD                               15960000
159700         MOVE LENGTH OF ASC-STORE-NBR TO DP010I-MAXIMUM-DIGITS    15970000
159800         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  15980000
159900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15990000
160000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16000038
160010              USING DP010I-NUMERIC-EDIT-AREA                      16001038
160100         IF DP010I-ERROR-DETECTED                                 16010000
160200             SET PS-ERROR                                         16020000
160300                 DP020-MSG-FATAL  TO TRUE                         16030000
160400             MOVE PC-TSYMSG-00334 TO DP020-MSG-NUMBER             16040000
160500             MOVE DP015-UNP-ALP-BRT-OFF TO MR-STORE-NBRA (PV-SUB) 16050000
160600             MOVE DP015-RED             TO MR-STORE-NBRC (PV-SUB) 16060000
160700             MOVE DP015-REVERSE         TO MR-STORE-NBRH (PV-SUB) 16070000
160800             MOVE -1                    TO MR-STORE-NBRL (PV-SUB) 16080000
160900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16090000
161000         ELSE                                                     16100000
161100             MOVE DP010I-NUMERIC-FIELD                            16110000
161200               TO ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)        16120000
161300             IF ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES 16130000
161400                 MOVE ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)  16140000
161500                   TO MR-STORE-NBR (PV-SUB)                       16150000
161600             ELSE                                                 16160000
161700                 MOVE SPACES TO MR-STORE-NBR (PV-SUB)             16170000
161800                                MR-STORE-NAME (PV-SUB)            16180000
161900             END-IF                                               16190000
162000         END-IF                                                   16200000
162100                                                                  16210000
162200         IF PS-NO-ERROR                                           16220000
162300           AND ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  16230000
162400             MOVE ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)        16240000
162500               TO DK-STORE-NUMBER                                 16250000
165300             PERFORM 3311-PROCESS-STORE                           16530000
165301         END-IF                                                   16530123
165302                                                                  16530200
165303         IF PS-NO-ERROR                                           16530300
165304           AND ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES  16530400
165305             MOVE ZEROES TO PV-DB2-COUNT                          16530500
165306             MOVE ASC-PULL-NBR-N   TO DK-PULL-NUMBER              16530600
165307             MOVE ASC-LINE-NUMBER  TO DK-LINE-NUMBER              16530700
165308             MOVE ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)        16530800
165309                                   TO DK-STORE-NUMBER             16530900
165310             PERFORM 3312-CHECK-FOR-DUP-ON-DB                     16531000
165400*            --- STORE CANNOT ALREADY EXIST FOR PULL/LINE ---     16540000
165500             IF PV-DB2-COUNT > +0                                 16550000
165600                 SET PS-ERROR                                     16560000
165700                     DP020-MSG-FATAL  TO TRUE                     16570000
165800                 MOVE PC-TSYMSG-02280 TO DP020-MSG-NUMBER         16580000
165900                 MOVE DP015-UNP-ALP-BRT-OFF                       16590000
166000                                      TO MR-STORE-NBRA (PV-SUB)   16600000
166100                 MOVE DP015-RED       TO MR-STORE-NBRC (PV-SUB)   16610000
166200                 MOVE DP015-REVERSE   TO MR-STORE-NBRH (PV-SUB)   16620000
166300                 MOVE -1              TO MR-STORE-NBRL (PV-SUB)   16630000
166400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              16640000
166500             END-IF                                               16650000
166600         END-IF                                                   16660000
166700     END-IF.                                                      16670000
166800                                                                  16680000
166900*EDIT REQUESTED QUANTITY.                                         16690000
167000     IF ASC-REQ-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       16700000
167100         MOVE ASC-REQ-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB)          16710000
167200           TO DP010I-UNEDITED-FIELD                               16720000
167300         MOVE LENGTH OF ASC-REQ-UNITS TO DP010I-MAXIMUM-DIGITS    16730000
167400         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  16740000
167500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  16750000
167600         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16760038
167610              USING DP010I-NUMERIC-EDIT-AREA                      16761038
167700         IF DP010I-ERROR-DETECTED                                 16770000
167800             SET PS-ERROR                                         16780000
167900                 DP020-MSG-FATAL  TO TRUE                         16790000
168000             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             16800000
168100             MOVE DP015-UNP-ALP-BRT-OFF                           16810000
168200                                  TO MR-REQ-UNITSA (PV-SUB)       16820000
168300             MOVE DP015-RED       TO MR-REQ-UNITSC (PV-SUB)       16830000
168400             MOVE DP015-REVERSE   TO MR-REQ-UNITSH (PV-SUB)       16840000
168500             MOVE -1              TO MR-REQ-UNITSL (PV-SUB)       16850000
168600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16860000
168700         ELSE                                                     16870000
168800*            --- REQUESTED QUANTITY MUST BE GREATER THAN ZERO --- 16880000
168900*            IF (DP010I-NUMERIC-FIELD NOT > ZERO)                 16890000
169000*              AND (ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > 0) 16900000
169100*                SET PS-ERROR                                     16910000
169200*                    DP020-MSG-FATAL  TO TRUE                     16920000
169300*                MOVE PC-TSYMSG-02281 TO DP020-MSG-NUMBER         16930000
169400*                MOVE DP015-UNP-ALP-BRT-OFF                       16940000
169500*                                     TO MR-REQ-UNITSA (PV-SUB)   16950000
169600*                MOVE DP015-RED       TO MR-REQ-UNITSC (PV-SUB)   16960000
169700*                MOVE DP015-REVERSE   TO MR-REQ-UNITSH (PV-SUB)   16970000
169800*                MOVE -1              TO MR-REQ-UNITSL (PV-SUB)   16980000
169900*                SET DP030-SET-CURSOR-APPL-1 TO TRUE              16990000
170000*            ELSE                                                 17000000
170100                 MOVE DP010I-NUMERIC-FIELD                        17010000
170200                   TO ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB)    17020000
170300                 IF ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) > 0  17030000
170400                    MOVE ASC-REQ-UNITS-X(ASC-BLK-SUB ASC-ITEM-SUB)17040000
170500                      TO MR-REQ-UNITS (PV-SUB)                    17050000
170600                    ADD  ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) 17060000
170700                      TO PV-TOTAL-NEW-UNITS                       17070000
170800                 ELSE                                             17080000
170900                     MOVE SPACES TO MR-REQ-UNITS (PV-SUB)         17090000
171000                 END-IF                                           17100000
171100*            END-IF                                               17110000
171200         END-IF                                                   17120000
171300     END-IF.                                                      17130000
171400                                                                  17140000
171500*CROSS-EDIT STORE VERSUS QUANTITY.                                17150000
171600     IF PS-NO-ERROR                                               17160000
171700         PERFORM 3320-XEDIT-LINES                                 17170000
171800     END-IF.                                                      17180000
171900                                                                  17190000
172000*----------------------------------------------------------------*17200023
172100 3311-PROCESS-STORE.                                              17210023
172200                                                                  17220023
172300     PERFORM 3500-GET-STORE-INFORMATION.                          17230023
172400**??         PERFORM 3311-CHECK-STR-TABLE                         17240023
172500*            --- STORE MUST EXIST ON STORE MASTER TABLE ---       17250023
172600*            --- STORE MUST ALSO BE OPEN AND READY TO RECEIVE --- 17260023
172700     EXEC SQL                                                     17270023
172800         SET :PV-CURRENT-DATE = CURRENT DATE                      17280023
172900     END-EXEC.                                                    17290023
173000                                                                  17300023
173100     EVALUATE TRUE                                                17310023
173200         WHEN XL071-LOC-NOT-FOUND                                 17320023
173300              SET PS-ERROR                                        17330023
173400                  DP020-MSG-FATAL  TO TRUE                        17340023
173500              MOVE PC-TSYMSG-00594 TO DP020-MSG-NUMBER            17350023
173600              MOVE DP015-UNP-ALP-BRT-OFF                          17360023
173700                              TO MR-STORE-NBRA (PV-SUB)           17370023
173800              MOVE DP015-RED  TO MR-STORE-NBRC (PV-SUB)           17380023
173900              MOVE DP015-REVERSE TO MR-STORE-NBRH(PV-SUB)         17390023
174000              MOVE -1         TO MR-STORE-NBRL (PV-SUB)           17400023
174100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 17410023
174200                                                                  17420023
174300         WHEN XL071-CLO-DTE < PV-CURRENT-DATE                     17430023
174400              SET PS-ERROR DP020-MSG-FATAL TO TRUE                17440023
174500              MOVE PC-TSYMSG-00844 TO  DP020-MSG-NUMBER           17450023
174600              MOVE DP015-UNP-ALP-BRT-OFF                          17460023
174700                                TO MR-STORE-NBRA (PV-SUB)         17470023
174800              MOVE DP015-RED    TO MR-STORE-NBRC (PV-SUB)         17480023
174900              MOVE DP015-REVERSE TO MR-STORE-NBRH(PV-SUB)         17490023
175000              MOVE -1          TO MR-STORE-NBRL (PV-SUB)          17500023
175100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 17510023
175200                                                                  17520023
175300         WHEN XL071-DC-ASGMT-NOT-FND                              17530023
175400              SET PS-ERROR DP020-MSG-FATAL TO TRUE                17540023
175500              MOVE PC-TSYMSG-01552   TO DP020-MSG-NUMBER          17550023
175600              MOVE DP015-UNP-ALP-BRT-OFF                          17560023
175700                                     TO MR-STORE-NBRA(PV-SUB)     17570023
175800              MOVE DP015-RED         TO MR-STORE-NBRC(PV-SUB)     17580023
175900              MOVE DP015-REVERSE     TO MR-STORE-NBRH(PV-SUB)     17590023
176000              MOVE -1                TO MR-STORE-NBRL(PV-SUB)     17600023
176100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 17610023
176200                                                                  17620023
176300         WHEN OTHER                                               17630023
176400              MOVE XL071-LOC-NM                                   17640023
176500                   TO ASC-STORE-NAME (ASC-BLK-SUB ASC-ITEM-SUB)   17650023
176600                      MR-STORE-NAME (PV-SUB)                      17660023
176700                                                                  17670023
176800     END-EVALUATE.                                                17680023
176900                                                                  17690023
179100                                                                  17910000
179300*----------------------------------------------------------------*17930000
179400 3312-CHECK-FOR-DUP-ON-DB.                                        17940000
179500                                                                  17950000
179600     EXEC SQL                                                     17960000
179700         SELECT COUNT (*)                                         17970000
179800           INTO  :PV-DB2-COUNT                                    17980000
179900           FROM  TCEPLDS                                          17990000
180000          WHERE  CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              18000000
180100            AND  PL_LNE_NBR        = :DK-LINE-NUMBER              18010000
180200            AND  STR_NBR           = :DK-STORE-NUMBER             18020000
180300     END-EXEC.                                                    18030000
180400                                                                  18040000
180500     EVALUATE TRUE                                                18050000
180600         WHEN SQLCODE = ZERO                                      18060000
180700             CONTINUE                                             18070000
180800                                                                  18080000
180900         WHEN SQLWARN0 NOT = SPACES                               18090000
181000         WHEN SQLCODE  NOT = ZERO                                 18100000
181100             MOVE '3312-CHECK-FOR-DUP-ON-DB' TO DP013-PARAGRAPH   18110000
181200             MOVE 'UNSUCCESSFUL COUNT OF TCEPLDS'                 18120000
181300                              TO DP013-MESSAGE-TEXT (1)           18130000
181400             MOVE SQLCA       TO DP013-SQLCA                      18140000
181500             MOVE 'TCEPLDS'   TO DP013-DB2-TABLE-NAME (1)         18150000
181600             SET DP013-DB2-ABEND                                  18160000
181700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18170000
181800             PERFORM DP013-0000-PROCESS-ABEND                     18180000
181900     END-EVALUATE.                                                18190000
182000                                                                  18200000
182100*----------------------------------------------------------------*18210000
182200 3320-XEDIT-LINES.                                                18220000
182300                                                                  18230000
182400     IF ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       18240000
182500       AND ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES      18250000
182600         IF ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) NOT > ZEROES 18260000
182700             SET PS-ERROR                                         18270000
182800                 DP020-MSG-FATAL  TO TRUE                         18280000
182900             MOVE PC-TSYMSG-02282 TO DP020-MSG-NUMBER             18290000
183000             MOVE DP015-UNP-ALP-BRT-OFF                           18300000
183100                                  TO MR-REQ-UNITSA (PV-SUB)       18310000
183200             MOVE DP015-RED       TO MR-REQ-UNITSC (PV-SUB)       18320000
183300             MOVE DP015-REVERSE   TO MR-REQ-UNITSH (PV-SUB)       18330000
183400             MOVE -1              TO MR-REQ-UNITSL (PV-SUB)       18340000
183500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18350000
183600         END-IF                                                   18360000
183700     END-IF.                                                      18370000
183800                                                                  18380000
183900     IF ASC-REQ-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       18390000
184000       AND ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES      18400000
184100         IF ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) NOT > ZEROES 18410000
184200             SET PS-ERROR                                         18420000
184300                 DP020-MSG-FATAL  TO TRUE                         18430000
184400             MOVE PC-TSYMSG-02283 TO DP020-MSG-NUMBER             18440000
184500             MOVE DP015-UNP-ALP-BRT-OFF                           18450000
184600                                  TO MR-STORE-NBRA (PV-SUB)       18460000
184700             MOVE DP015-RED       TO MR-STORE-NBRC (PV-SUB)       18470000
184800             MOVE DP015-REVERSE   TO MR-STORE-NBRH (PV-SUB)       18480000
184900             MOVE -1              TO MR-STORE-NBRL (PV-SUB)       18490000
185000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18500000
185100         END-IF                                                   18510000
185200     END-IF.                                                      18520000
185300                                                                  18530000
185400*----------------------------------------------------------------*18540000
185500 3400-XEDIT-STORES.                                               18550000
185600                                                                  18560000
185700     IF (ASC-STORE-NBR (1 PV-SUB1) > ZEROES)                      18570000
185800       AND (ASC-ACTION (1 PV-SUB1) NOT = 'ADD')                   18580000
185900         PERFORM 3410-XEDIT-LINE                                  18590000
186000           VARYING PV-SUB2 FROM 1 BY 1                            18600000
186100             UNTIL PV-SUB2 > PC-ITEMS-PER-PANEL                   18610000
186200     END-IF.                                                      18620000
186300                                                                  18630000
186400*----------------------------------------------------------------*18640000
186500 3410-XEDIT-LINE.                                                 18650000
186600                                                                  18660000
186700     IF PV-SUB1 = PV-SUB2                                         18670000
186800         CONTINUE                                                 18680000
186900     ELSE                                                         18690000
187000         IF ASC-STORE-NBR (1 PV-SUB1) = ASC-STORE-NBR (1 PV-SUB2) 18700000
187100             SET PS-ERROR                                         18710000
187200                 DP020-MSG-FATAL  TO TRUE                         18720000
187300             MOVE PC-TSYMSG-02292 TO DP020-MSG-NUMBER             18730000
187400             MOVE DP015-UNP-ALP-BRT-OFF                           18740000
187500                                  TO MR-STORE-NBRA (PV-SUB1)      18750000
187600             MOVE DP015-RED       TO MR-STORE-NBRC (PV-SUB1)      18760000
187700             MOVE DP015-REVERSE   TO MR-STORE-NBRH (PV-SUB1)      18770000
187800             MOVE -1              TO MR-STORE-NBRL (PV-SUB1)      18780000
187900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18790000
188000         END-IF                                                   18800000
188100     END-IF.                                                      18810000
188200                                                                  18820023
188300****************************************************************  18830023
188400*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  18840023
188500*                                                              *  18850023
188600****************************************************************  18860023
188700 3500-GET-STORE-INFORMATION.                                      18870023
188800                                                                  18880023
188900     INITIALIZE XL071-COMMAREA.                                   18890023
189000     MOVE DK-STORE-NUMBER TO XL071-LOCATION-NUMBER.               18900023
189100                                                                  18910023
189200     CALL XL071-LOCATION-MODULE USING                             18920023
189300                                DFHEIBLK                          18930023
189400                                XL071-COMMAREA                    18940023
189500                                XL071-COMMAREA-REC.               18950023
189600                                                                  18960023
189700     EVALUATE TRUE                                                18970023
189800         WHEN XL071-NO-ERRORS                                     18980023
189900              CONTINUE                                            18990023
190000                                                                  19000023
190100         WHEN XL071-LOC-NOT-FOUND                                 19010023
190200              CONTINUE                                            19020023
190300                                                                  19030023
190400         WHEN OTHER                                               19040023
190500              MOVE ' 3500-GET-STORE-INFORMATION'                  19050023
190600                               TO DP013-PARAGRAPH                 19060023
190700              STRING ' CS LOCATION - '  DELIMITED BY SIZE         19070023
190800                     XL071-LOCATION-NUMBER                        19080023
190900                     '  TRYING TO GET E-COMM IND'                 19090023
191000                      DELIMITED BY SIZE                           19100023
191100                      INTO DP013-MESSAGE-TEXT (1)                 19110023
191200              MOVE XL071-SQLCODE   TO SQLCODE                     19120023
191300              MOVE XL071-SQLCA     TO DP013-SQLCA                 19130023
191400              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    19140023
191500              SET DP013-DB2-ABEND                                 19150023
191600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              19160023
191700              PERFORM DP013-0000-PROCESS-ABEND                    19170023
191800                                                                  19180023
191900     END-EVALUATE.                                                19190023
191901                                                                  19190123
191902                                                                  19190200
191903*----------------------------------------------------------------*19190300
191904*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *19190400
191905*    INITIALIZE ALL COUNTERS AND FLAGS.                          *19190500
191906*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *19190600
191907*    DISPLAY THE PANEL TO USER.                                  *19190700
191908*----------------------------------------------------------------*19190800
191909 4000-BUILD-INITIAL-PANEL.                                        19190900
191910                                                                  19191000
191911     MOVE +1                 TO ASC-BLK-SUB.                      19191100
191912     SET ASC-ITEMS-LEFT-ON-DB                                     19191200
191913                             TO TRUE.                             19191300
191914                                                                  19191400
191915     MOVE +0                 TO ASC-ITEM-SUB                      19191500
191916                                ASC-NUMBER-OF-SELECTED-ITEMS      19191600
191917                                ASC-HIGHEST-BLOCK-WRITTEN         19191700
191918                                ASC-START-OF-SELECTED-RANGE       19191800
191919                                ASC-END-OF-SELECTED-RANGE         19191900
191920                                ASC-ITEM-AT-TOP-OF-PANEL.         19192000
191921     MOVE +10                TO ASC-NUMBER-OF-ITEMS-READ.         19192100
191922                                                                  19192200
191923     MOVE ASC-PULL-NBR-N       TO DK-PULL-NUMBER.                 19192300
191924     MOVE ASC-REF-NBR          TO DK-REF-NUMBER.                  19192400
191925     MOVE ASC-LINE-NUMBER      TO DK-LINE-NUMBER.                 19192500
191926     MOVE ASC-LINE-ITEM        TO DK-LINE-ITEM.                   19192600
191927                                                                  19192700
191928     MOVE +1                   TO  PV-TOP-ITEM.                   19192800
191929                                                                  19192900
191930     INITIALIZE  ASC-BLOCK-ENTRIES (1)                            19193000
191931                 ASC-BLOCK-ENTRIES (2).                           19193100
191932                                                                  19193200
191933     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          19193300
191934         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    19193400
191935         SET DP020-MSG-FATAL   TO  TRUE                           19193500
191936         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               19193600
191937     ELSE                                                         19193700
191938**DJK - 05/05/2010 CODE ADDED FOR EFC2                            19193838
191939**THIS CODE WAS ADDED TO PREVENT ADDITIONAL STORES FROM BEING     19193938
191940**ADDED TO WAREHOUSE TRANSFERS.                                   19194038
191941**DJK - 05/05/2010 END                                            19194138
191942     IF ASC-PULL-SRC-XFER                                         19194231
191947         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    19194730
191948         SET DP020-MSG-FATAL   TO  TRUE                           19194830
191949         MOVE PC-TSYMSG-02293  TO  DP020-MSG-NUMBER               19194930
191950     ELSE                                                         19195030
191951         MOVE -1               TO MR-STORE-NBRL (1)               19195100
191960         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19196000
192000         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     19200000
192100     END-IF.                                                      19210000
192200                                                                  19220000
192300*----------------------------------------------------------------*19230000
192400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *19240000
192500*----------------------------------------------------------------*19250000
192600 4400-MOVE-COMMAREA-TO-SCREEN.                                    19260000
192700                                                                  19270000
192800     IF (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))              19280000
192900       AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))            19290000
193000        OR (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            19300000
193100         MOVE +1    TO ASC-BLK-SUB                                19310000
193200         PERFORM 5100-WRITE-TEMP-STORAGE                          19320000
193300         ADD +1     TO ASC-BLK-SUB                                19330000
193400         PERFORM 5100-WRITE-TEMP-STORAGE                          19340000
193500         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 19350000
193600             GIVING PV-BLOCK-NUMBER                               19360000
193700             REMAINDER PV-REMAINDER                               19370000
193800         IF PV-REMAINDER > ZERO                                   19380000
193900             ADD +1 TO PV-BLOCK-NUMBER                            19390000
194000         END-IF                                                   19400000
194100         MOVE +1    TO ASC-BLK-SUB                                19410000
194200         PERFORM 4410-READ-TEMP-STORAGE                           19420000
194300         ADD +1     TO ASC-BLK-SUB                                19430000
194400                       PV-BLOCK-NUMBER                            19440000
194500         PERFORM 4410-READ-TEMP-STORAGE                           19450000
194600     END-IF.                                                      19460000
194700                                                                  19470000
194800     MOVE +1    TO ASC-BLK-SUB.                                   19480000
194900     COMPUTE ASC-ITEM-SUB =                                       19490000
195000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              19500000
195100         + PC-ITEMS-PER-PANEL).                                   19510000
195200                                                                  19520000
195300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19530000
195400         ADD +1 TO ASC-BLK-SUB                                    19540000
195500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19550000
195600     END-IF.                                                      19560000
195700                                                                  19570000
195800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           19580000
195900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                19590000
196000                                                                  19600000
196100     PERFORM 4420-FORMAT-LIST-LINES                               19610000
196200       VARYING PV-SUB FROM PC-ITEMS-PER-PANEL BY -1               19620000
196300         UNTIL PV-SUB < +1.                                       19630000
196400                                                                  19640000
196500     COMPUTE ASC-ITEMS-DISPLAYED =                                19650000
196600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          19660000
196700     MOVE PV-TOP-ITEM TO ASC-ITEM-AT-TOP-OF-PANEL.                19670000
196800                                                                  19680000
196900*FILL TOP OF SCREEN.                                              19690000
197000     MOVE ASC-CS-LOC-N                      TO ALOCIDO.           19700000
197100                                                                  19710000
197200     MOVE ASC-PULL-NBR-N                    TO DK-PULL-NUMBER.    19720000
197300     PERFORM 4540-GET-PULL-NBR-DATA.                              19730000
197400                                                                  19740000
197500     EVALUATE TRUE                                                19750000
197600         WHEN ASC-PULL-CANCELLED                                  19760000
197700              MOVE PC-PULL-STATUS-CANCELLED TO APULSTO            19770000
197800         WHEN ASC-PULL-DISTRIBUTED                                19780000
197900              MOVE PC-DISTRIB-DESC          TO APULSTO            19790000
198000         WHEN ASC-PULL-IN-PROCESS                                 19800000
198100              MOVE PC-IN-PROCESS-DESC       TO APULSTO            19810000
198200         WHEN ASC-PULL-NEW                                        19820000
198300              MOVE PC-NEW-DESC              TO APULSTO            19830000
198400         WHEN ASC-PULL-POSTED                                     19840000
198500              MOVE PC-POSTED-DESC           TO APULSTO            19850000
198600         WHEN OTHER                                               19860000
198700              MOVE PC-UNKNOWN-DESC          TO APULSTO            19870000
198800     END-EVALUATE.                                                19880000
198900                                                                  19890000
199000     MOVE ASC-PULL-NBR-N                    TO APULNOO.           19900000
199100                                                                  19910000
199200     MOVE ASC-LINE-NUMBER                   TO DK-LINE-NUMBER.    19920000
199300     PERFORM 4550-GET-PULL-ITM-DATA.                              19930000
199400                                                                  19940000
199500     MOVE ASC-LINE-NUMBER                   TO ALNENOO            19950000
199600                                                                  19960000
199700     EVALUATE TRUE                                                19970000
199800         WHEN ASC-LINE-STATUS-CANCELLED                           19980000
199900              MOVE PC-PULL-STATUS-CANCELLED TO ALNESTO            19990000
200000         WHEN ASC-LINE-STATUS-DISTRIBTD                           20000000
200100              MOVE PC-DISTRIB-DESC          TO ALNESTO            20010000
200200         WHEN ASC-LINE-STATUS-INPROCESS                           20020000
200300              MOVE PC-IN-PROCESS-DESC       TO ALNESTO            20030000
200400         WHEN ASC-LINE-STATUS-NEW                                 20040000
200500              MOVE PC-NEW-DESC              TO ALNESTO            20050000
200600         WHEN  ASC-LINE-STATUS-POSTED                             20060000
200700              MOVE PC-POSTED-DESC           TO ALNESTO            20070000
200800         WHEN OTHER                                               20080000
200900              MOVE PC-UNKNOWN-DESC          TO ALNESTO            20090000
201000     END-EVALUATE.                                                20100000
201100*----------------------------------------------------------------*20110010
201200*                                               **   WR # 230ZZ  *20120010
201300* INITIALIZED XL001-ITEM-COMMAREA.                               *20130010
201400* COMMENTED OUT CALL TO 4500-GET-SKU-DATA AND ADDED CODE TO CALL *20140010
201500* TO LOGISTICS DOMAIN ITEM ACCESS MODULE XLKUT001.               *20150011
201600*----------------------------------------------------------------*20160010
201700                                                                  20170010
201800     INITIALIZE XL001-ITEM-COMMAREA                               20180010
201900                DK-TEMP-SEQ-NBR                                   20190010
202000                DK-TEMP-SKU-DESC.                                 20200010
202100                                                                  20210010
202200*    PERFORM 4500-GET-SKU-DATA.                      WR/IR# 230ZZ 20220012
202300     PERFORM 4500-CALL-CICS-API-ARCH.                             20230000
202400                                                                  20240010
202500     MOVE DK-TEMP-SEQ-NBR         TO ASC-SKU-NUMBER               20250012
202600     MOVE ASC-SKU-NUMBER          TO ASKUO.                       20260012
202700*    MOVE TSK-SKU-DESC            TO ADESCO.         WR/IR# 230ZZ 20270012
202800     MOVE DK-TEMP-SKU-DESC        TO ADESCO.                      20280012
202900*----------------------------------------------------------------*20290010
203000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *20300010
203100*----------------------------------------------------------------*20310010
203200                                                                  20320000
203300     MOVE ZEROES TO PV-CEPLDS-STORE-COUNT.                        20330000
203400     PERFORM 4510-COUNT-STORES.                                   20340000
203500     MOVE PV-CEPLDS-STORE-COUNT             TO ASTRSO             20350000
203600                                               ASC-NBR-STORES.    20360000
203700                                                                  20370000
203800     PERFORM 4520-GET-CEPLIT-QTYS.                                20380000
203900     MOVE PV-CEPLIT-REQ-QTY                 TO APLREQO            20390000
204000                                               ASC-REQ-PULL-UNITS.20400000
204100     MOVE PV-CEPLIT-ACTL-QTY                TO APLACTO            20410000
204200                                               ASC-ACT-PULL-UNITS.20420000
204300                                                                  20430000
204400     PERFORM 4530-GET-CEPLDS-QTYS.                                20440000
204500     MOVE PV-CEPLDS-REQ-QTY                 TO ADSREQO.           20450000
204600     MOVE PV-CEPLDS-ACT-QTY                 TO ADSACTO.           20460000
204700                                                                  20470000
204800     IF DP020-MSG-NUMBER-X = SPACE                                20480000
204900         IF (ASC-STORE-NBR (1 1) > ZEROES                         20490000
205000           AND ASC-ACTION (1 1) NOT = 'ADD')                      20500000
205100          OR (ASC-STORE-NBR (1 2) > ZEROES                        20510000
205200           AND ASC-ACTION (1 2) NOT = 'ADD')                      20520000
205300          OR (ASC-STORE-NBR (1 3) > ZEROES                        20530000
205400           AND ASC-ACTION (1 3) NOT = 'ADD')                      20540000
205500          OR (ASC-STORE-NBR (1 4) > ZEROES                        20550000
205600           AND ASC-ACTION (1 4) NOT = 'ADD')                      20560000
205700          OR (ASC-STORE-NBR (1 5) > ZEROES                        20570000
205800           AND ASC-ACTION (1 5) NOT = 'ADD')                      20580000
205900          OR (ASC-STORE-NBR (1 6) > ZEROES                        20590000
206000           AND ASC-ACTION (1 6) NOT = 'ADD')                      20600000
206100          OR (ASC-STORE-NBR (1 7) > ZEROES                        20610000
206200           AND ASC-ACTION (1 7) NOT = 'ADD')                      20620000
206300          OR (ASC-STORE-NBR (1 8) > ZEROES                        20630000
206400           AND ASC-ACTION (1 8) NOT = 'ADD')                      20640000
206500          OR (ASC-STORE-NBR (1 9) > ZEROES                        20650000
206600           AND ASC-ACTION (1 9) NOT = 'ADD')                      20660000
206700          OR (ASC-STORE-NBR (1 10) > ZEROES                       20670000
206800           AND ASC-ACTION (1 10) NOT = 'ADD')                     20680000
206900             MOVE PC-TSYMSG-02284 TO DP020-MSG-NUMBER             20690000
207000             SET DP020-MSG-INFORMATIONAL TO TRUE                  20700000
207100         END-IF                                                   20710000
207200     END-IF.                                                      20720000
207300                                                                  20730000
207400*----------------------------------------------------------------*20740000
207500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *20750000
207600*----------------------------------------------------------------*20760000
207700 4410-READ-TEMP-STORAGE.                                          20770000
207800                                                                  20780000
207900     EXEC CICS                                                    20790000
208000         READQ TS                                                 20800000
208100             QUEUE (ASC-LIST-QUEUE-NAME)                          20810000
208200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               20820000
208300             ITEM  (PV-BLOCK-NUMBER)                              20830000
208400             RESP  (PV-CICS-RESP)                                 20840000
208500     END-EXEC.                                                    20850000
208600                                                                  20860000
208700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       20870000
208800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     20880000
208900         CONTINUE                                                 20890000
209000     ELSE                                                         20900000
209100         SET DP013-CICS-ABEND     TO TRUE                         20910000
209200         SET DP013-NO-ROLLBACK    TO TRUE                         20920000
209300         MOVE '4410-READ-TEMP-STORAGE'                            20930000
209400                                  TO DP013-PARAGRAPH              20940000
209500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      20950000
209600                                  TO DP013-MESSAGE-TEXT(1)        20960000
209700         PERFORM DP013-0000-PROCESS-ABEND                         20970000
209800     END-IF.                                                      20980000
209900                                                                  20990000
210000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             21000000
210100                                                                  21010000
210200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         21020000
210300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               21030000
210400     END-IF.                                                      21040000
210500                                                                  21050000
210600*----------------------------------------------------------------*21060000
210700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *21070000
210800*----------------------------------------------------------------*21080000
210900 4420-FORMAT-LIST-LINES.                                          21090000
211000                                                                  21100000
211100     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       21110000
211200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                21120000
211300         MOVE DP015-ASK-DRK-OFF  TO MR-STORE-NBRA (PV-SUB)        21130000
211400                                    MR-REQ-UNITSA (PV-SUB)        21140000
211500         MOVE DP015-HL-OFF       TO MR-STORE-NBRH (PV-SUB)        21150000
211600                                    MR-REQ-UNITSH (PV-SUB)        21160000
211700         MOVE SPACES             TO MR-STORE-NBR (PV-SUB)         21170000
211800                                    MR-REQ-UNITS (PV-SUB)         21180000
211900     ELSE                                                         21190000
212000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               21200000
212100                                 TO MR-ACTION (PV-SUB)            21210000
212200         MOVE ASC-STORE-NAME (ASC-BLK-SUB ASC-ITEM-SUB)           21220000
212300                                 TO MR-STORE-NAME (PV-SUB)        21230000
212400         IF ASC-STORE-NBR (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES     21240000
212500             MOVE ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)      21250000
212600                                 TO MR-STORE-NBR (PV-SUB)         21260000
212700         ELSE                                                     21270000
212800             MOVE SPACES         TO MR-STORE-NAME (PV-SUB)        21280000
212900             IF ASC-STORE-NBR-X(ASC-BLK-SUB ASC-ITEM-SUB) = '0000'21290000
213000                 MOVE SPACES     TO MR-STORE-NBR (PV-SUB)         21300000
213100             ELSE                                                 21310000
213200                 MOVE ASC-STORE-NBR-X (ASC-BLK-SUB ASC-ITEM-SUB)  21320000
213300                                 TO MR-STORE-NBR (PV-SUB)         21330000
213400             END-IF                                               21340000
213500         END-IF                                                   21350000
213600         IF ASC-REQ-UNITS (ASC-BLK-SUB ASC-ITEM-SUB) > ZEROES     21360000
213700             MOVE ASC-REQ-UNITS-X (ASC-BLK-SUB ASC-ITEM-SUB)      21370000
213800                                 TO MR-REQ-UNITS (PV-SUB)         21380000
213900***      ELSE                                                     21390000
214000***          MOVE SPACES         TO MR-REQ-UNITS (PV-SUB)         21400000
214100         END-IF                                                   21410000
214200     END-IF.                                                      21420000
214300                                                                  21430000
214400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               21440000
214500     IF ASC-ITEM-SUB < + 1                                        21450000
214600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  21460000
214700         MOVE +1                 TO ASC-BLK-SUB                   21470000
214800     END-IF.                                                      21480000
214900                                                                  21490000
215000*----------------------------------------------------------------*21500000
215100*                                               WR # 230ZZ       *21510000
215200* DELETED CODE USED TO CALL TSK TABLE.                           *21520012
215300* ADDED CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE.  *21530009
215400*----------------------------------------------------------------*21540000
215500*                                                                 21550000
215600 4500-CALL-CICS-API-ARCH.                                         21560000
215700                                                                  21570000
215800     MOVE DK-LINE-ITEM         TO XL001-KEY-ITM-NBR.              21580000
215900                                                                  21590000
216000     SET  XL001-BY-ITEM                                           21600000
216100          XL001-SELECT-SKU     TO TRUE.                           21610000
216200                                                                  21620000
216300     CALL XL001-VSM-PGM USING  DFHEIBLK                           21630000
216400                               XL001-COMMAREA                     21640000
216500                               XL001-ITEM-COMMAREA.               21650000
216600     EVALUATE TRUE                                                21660000
216700                                                                  21670000
216800      WHEN XL001-SKU-SQLCODE = +0                                 21680000
216810        PERFORM 4560-INSPECT-XL001-SKU-DESC                       21681038
216900        MOVE XL001-SKU-NBR     TO  DK-TEMP-SEQ-NBR                21690000
217000        MOVE XL001-SKU-DESC    TO  DK-TEMP-SKU-DESC               21700000
217100                                                                  21710000
217200      WHEN XL001-SKU-SQLCODE = +100                               21720000
217300        MOVE ZEROES            TO  DK-TEMP-SEQ-NBR                21730000
217400        MOVE SPACES            TO  DK-TEMP-SKU-DESC               21740000
217500                                                                  21750000
217600      WHEN XL001-SKU-CONTENTION                                   21760012
217700        PERFORM 9900-SOFT-ABORT                                   21770000
217800                                                                  21780000
217900      WHEN XL001-INVALID-ACCESS                                   21790000
218000        MOVE '4500-CALL-CICS-API-ARCH'                            21800000
218100                             TO DP013-PARAGRAPH                   21810000
218200        MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'                 21820000
218300                             TO DP013-MESSAGE-TEXT (1)            21830000
218400        MOVE XL001-SQLCA     TO DP013-SQLCA                       21840012
218500        MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)          21850000
218600        SET DP013-DB2-ABEND                                       21860000
218700            DP013-XCTL-DISPLAY-RESTART TO TRUE                    21870000
218800        PERFORM DP013-0000-PROCESS-ABEND                          21880000
218900                                                                  21890000
219000      WHEN OTHER                                                  21900000
219100        MOVE '4500-CALL-CICS-API-ARCH'                            21910000
219200                             TO DP013-PARAGRAPH                   21920000
219300        MOVE 'UNSUCCESSFUL SELECT OF ITEM NBR'                    21930000
219400                             TO DP013-MESSAGE-TEXT (1)            21940000
219500        MOVE XL001-SQLCA     TO DP013-SQLCA                       21950012
219600        MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1)          21960000
219700        SET DP013-DB2-ABEND                                       21970000
219800            DP013-XCTL-DISPLAY-RESTART TO TRUE                    21980000
219900        PERFORM DP013-0000-PROCESS-ABEND                          21990000
220000     END-EVALUATE.                                                22000000
220100                                                                  22010000
220200*----------------------------------------------------------------*22020000
220300* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *22030000
220400*----------------------------------------------------------------*22040000
220500*----------------------------------------------------------------*22050000
220600 4510-COUNT-STORES.                                               22060000
220700                                                                  22070000
220800     EXEC SQL                                                     22080000
220900         SELECT COUNT (*)                                         22090000
221000           INTO  :PV-CEPLDS-STORE-COUNT                           22100000
221100           FROM  TCEPLDS                                          22110000
221200          WHERE  CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              22120000
221300            AND  PL_LNE_NBR        = :DK-LINE-NUMBER              22130000
221400     END-EXEC.                                                    22140000
221500                                                                  22150000
221600     EVALUATE TRUE                                                22160000
221700         WHEN SQLCODE = ZERO                                      22170000
221800             CONTINUE                                             22180000
221900                                                                  22190000
222000         WHEN OTHER                                               22200000
222100             MOVE '4510-COUNT-STORES' TO DP013-PARAGRAPH          22210000
222200             MOVE 'COUNT CEPLDS RCDS'                             22220000
222300                              TO DP013-MESSAGE-TEXT (1)           22230000
222400             MOVE SQLCA       TO DP013-SQLCA                      22240000
222500             MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (1)         22250000
222600             SET DP013-DB2-ABEND                                  22260000
222700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22270000
222800             PERFORM DP013-0000-PROCESS-ABEND                     22280000
222900     END-EVALUATE.                                                22290000
223000                                                                  22300000
223100*----------------------------------------------------------------*22310000
223200* GET PULL ITEM QTYS                                             *22320000
223300*----------------------------------------------------------------*22330000
223400 4520-GET-CEPLIT-QTYS.                                            22340000
223500                                                                  22350000
223600     INITIALIZE  PV-CEPLIT-ITEM-QTY                               22360000
223700                 PV-CEPLIT-REQ-QTY                                22370000
223800                 PV-CEPLIT-ACTL-QTY.                              22380000
223900                                                                  22390000
224000     EXEC SQL                                                     22400000
224100         SELECT  COUNT(*)                                         22410000
224200                ,SUM(PL_REQ_QTY)                                  22420000
224300                ,SUM(ACTL_PL_QTY)                                 22430000
224400           INTO  :PV-CEPLIT-ITEM-QTY                              22440000
224500                ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1               22450000
224600                ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2               22460000
224700           FROM  TCEPLIT                                          22470000
224800          WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER             22480000
224900            AND  PL_LNE_NBR        =  :DK-LINE-NUMBER             22490000
225000            AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD')    22500000
225100     END-EXEC                                                     22510000
225200                                                                  22520000
225300     EVALUATE TRUE                                                22530000
225400         WHEN SQLCODE = +0                                        22540000
225500             CONTINUE                                             22550000
225600                                                                  22560000
225700         WHEN OTHER                                               22570000
225800             MOVE '4520-GET-CEPLIT-QTYS' TO DP013-PARAGRAPH       22580000
225900             MOVE 'GET PULL ITEM QTYS'                            22590000
226000                              TO DP013-MESSAGE-TEXT (1)           22600000
226100             MOVE SQLCA       TO DP013-SQLCA                      22610000
226200             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         22620000
226300             SET DP013-DB2-ABEND                                  22630000
226400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22640000
226500             PERFORM DP013-0000-PROCESS-ABEND                     22650000
226600     END-EVALUATE.                                                22660000
226700                                                                  22670000
226800*----------------------------------------------------------------*22680000
226900* GET PULL DISTRIBUTION QTY                                      *22690000
227000*----------------------------------------------------------------*22700000
227100 4530-GET-CEPLDS-QTYS.                                            22710000
227200                                                                  22720000
227300     INITIALIZE  PV-CEPLDS-REQ-QTY                                22730000
227400                 PV-CEPLDS-ACT-QTY.                               22740000
227500                                                                  22750000
227600     EXEC SQL                                                     22760000
227700         SELECT  SUM(B.REQ_ORD_QTY)                               22770000
227800                ,SUM(B.ACTL_DISTRB_QTY)                           22780000
227900           INTO  :PV-CEPLDS-REQ-QTY :PV-NULL-IND-1                22790000
228000                ,:PV-CEPLDS-ACT-QTY :PV-NULL-IND-2                22800000
228100           FROM  TCEPLIT A                                        22810000
228200                ,TCEPLDS B                                        22820000
228300          WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER            22830000
228400            AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER            22840000
228500            AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR         22850000
228600            AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR               22860000
228700            AND  A.STAT_CDE   IN  ('NW', 'IP', 'DS', 'PD')        22870000
228800     END-EXEC                                                     22880000
228900                                                                  22890000
229000     EVALUATE TRUE                                                22900000
229100         WHEN SQLCODE = +0                                        22910000
229200             MOVE PV-CEPLDS-REQ-QTY TO ASC-ACCUM-CEPLDS-QTY       22920000
229300*            CONTINUE                                             22930000
229400                                                                  22940000
229500         WHEN OTHER                                               22950000
229600             MOVE '4530-GET-CEPLDS-QTYS'                          22960000
229700                              TO DP013-PARAGRAPH                  22970000
229800             MOVE 'ACCUM STORE QUANTITIES'                        22980000
229900                              TO DP013-MESSAGE-TEXT (1)           22990000
230000             MOVE SQLCA       TO DP013-SQLCA                      23000000
230100             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         23010000
230200             MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)         23020000
230300             SET DP013-DB2-ABEND                                  23030000
230400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23040000
230500                 PERFORM DP013-0000-PROCESS-ABEND                 23050000
230600     END-EVALUATE.                                                23060000
230700                                                                  23070000
230800*----------------------------------------------------------------*23080000
230900 4540-GET-PULL-NBR-DATA.                                          23090000
231000                                                                  23100000
231100     EXEC SQL                                                     23110000
231200         SELECT CNSTK_REQ_PL_NBR                                  23120000
231300              , CNSTK_LOC_ID                                      23130000
231400              , SRC_REF_NBR                                       23140000
231500              , SRC_TYP_CDE                                       23150000
231600              , STAT_CDE                                          23160000
231700           INTO :CEPLRQ-CNSTK-REQ-PL-NBR                          23170000
231800              , :CEPLRQ-CNSTK-LOC-ID                              23180000
231900              , :CEPLRQ-SRC-REF-NBR                               23190000
232000              , :CEPLRQ-SRC-TYP-CDE                               23200000
232100              , :CEPLRQ-STAT-CDE                                  23210000
232200           FROM  TCEPLRQ                                          23220000
232300          WHERE  CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              23230000
232400     END-EXEC.                                                    23240000
232500                                                                  23250000
232600     EVALUATE TRUE                                                23260000
232700         WHEN SQLCODE = ZERO                                      23270000
232800             MOVE CEPLRQ-STAT-CDE TO ASC-PULL-STATUS              23280000
232900                                                                  23290000
233000         WHEN SQLCODE = +100                                      23300000
233100             MOVE SPACES          TO ASC-PULL-STATUS              23310000
233200                                                                  23320000
233300         WHEN OTHER                                               23330000
233400             MOVE '4540-GET-PULL-NBR-DATA' TO DP013-PARAGRAPH     23340000
233500             MOVE 'SELECT PULL NUMBER'                            23350000
233600                              TO DP013-MESSAGE-TEXT (1)           23360000
233700             MOVE SQLCA       TO DP013-SQLCA                      23370000
233800             MOVE 'TCEPLRQ '  TO DP013-DB2-TABLE-NAME (1)         23380000
233900             SET DP013-DB2-ABEND                                  23390000
234000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23400000
234100             PERFORM DP013-0000-PROCESS-ABEND                     23410000
234200     END-EVALUATE.                                                23420000
234300                                                                  23430000
234400*----------------------------------------------------------------*23440000
234500 4550-GET-PULL-ITM-DATA.                                          23450000
234600                                                                  23460000
234700     EXEC SQL                                                     23470000
234800         SELECT CNSTK_REQ_PL_NBR                                  23480000
234900              , PL_LNE_NBR                                        23490000
235000              , ITM_NBR                                           23500000
235100              , PL_REQ_QTY                                        23510000
235200              , ACTL_PL_QTY                                       23520000
235300              , STAT_CDE                                          23530000
235400              , UNT_RTL_AMT                                       23540000
235500              , EXPRT_PRC_BTCH_ID                                 23550000
235600           INTO :CEPLIT-CNSTK-REQ-PL-NBR                          23560000
235700              , :CEPLIT-PL-LNE-NBR                                23570000
235800              , :CEPLIT-ITM-NBR                                   23580000
235900              , :CEPLIT-PL-REQ-QTY                                23590000
236000              , :CEPLIT-ACTL-PL-QTY :PV-NULL-IND-3                23600000
236100              , :CEPLIT-STAT-CDE                                  23610000
236200              , :CEPLIT-UNT-RTL-AMT                               23620000
236300              , :CEPLIT-EXPRT-PRC-BTCH-ID                         23630000
236400           FROM  TCEPLIT                                          23640000
236500          WHERE  CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER              23650000
236600            AND  PL_LNE_NBR        = :DK-LINE-NUMBER              23660000
236700     END-EXEC.                                                    23670000
236800                                                                  23680000
236900     EVALUATE TRUE                                                23690000
237000         WHEN SQLCODE = ZERO                                      23700000
237100             MOVE CEPLIT-ITM-NBR  TO DK-LINE-ITEM                 23710000
237200             MOVE CEPLIT-STAT-CDE TO ASC-LINE-STATUS-CDE          23720000
237300                                                                  23730000
237400         WHEN SQLCODE = +100                                      23740000
237500             MOVE ZEROES          TO DK-LINE-ITEM                 23750000
237600             MOVE SPACES          TO ASC-LINE-STATUS-CDE          23760000
237700                                                                  23770000
237800         WHEN OTHER                                               23780000
237900             MOVE '4550-GET-PULL-ITM-DATA' TO DP013-PARAGRAPH     23790000
238000             MOVE 'SELECT PULL NUMBER'                            23800000
238100                              TO DP013-MESSAGE-TEXT (1)           23810000
238200             MOVE SQLCA       TO DP013-SQLCA                      23820000
238300             MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)         23830000
238400             SET DP013-DB2-ABEND                                  23840000
238500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23850000
238600             PERFORM DP013-0000-PROCESS-ABEND                     23860000
238700     END-EVALUATE.                                                23870000
238701                                                                  23870138
238710*----------------------------------------------------------------*23871038
238720* INSPECT THE SKU DESCRIPTION FROM XLKUT001 TO CONVERT INVALID   *23872038
238730* CHARACTERS TO SPACES.                                          *23873038
238740*----------------------------------------------------------------*23874038
238750 4560-INSPECT-XL001-SKU-DESC.                                     23875038
238760                                                                  23876038
238780     MOVE SPACE TO  PC-SPACE.                                     23878038
238790     INSPECT XL001-SKU-DESC      REPLACING ALL                    23879038
238791         quote BY PC-SPACE.                                       23879138
238792     INSPECT XL001-SKU-DESC      REPLACING ALL                    23879238
238793         '&'   BY PC-SPACE.                                       23879338
238794     INSPECT XL001-SKU-DESC      REPLACING ALL                    23879438
238795         '"'   BY PC-SPACE.                                       23879538
238796     INSPECT XL001-SKU-DESC      REPLACING ALL                    23879638
238797         '<'   BY PC-SPACE.                                       23879738
238798     INSPECT XL001-SKU-DESC      REPLACING ALL                    23879838
238799         '>'   BY PC-SPACE.                                       23879938
238800*-------------------------                                        23880038
238801* ADDED CHECK FOR HEX 05                                          23880138
238802*-------------------------                                        23880238
238803     INSPECT XL001-SKU-DESC      REPLACING ALL                    23880338
238804         '	'   BY PC-SPACE.                                       23880438
238805     INSPECT XL001-SKU-DESC      REPLACING ALL                    23880538
238806         ''   BY PC-SPACE.                                       23880638
238807     INSPECT XL001-SKU-DESC      REPLACING ALL                    23880738
238808         ';'   BY PC-SPACE.                                       23880838
238809     INSPECT XL001-SKU-DESC      REPLACING ALL                    23880938
238810         LOW-VALUES BY PC-SPACE.                                  23881038
238811*-------------------------                                        23881138
238812* ADDED CHECK FOR HEX 3F                                          23881238
238813*-------------------------                                        23881338
238814     INSPECT XL001-SKU-DESC      REPLACING ALL                    23881438
238815         ''   BY PC-SPACE.                                       23881538
238816*-------------------------                                        23881638
238817* ADDED CHECK FOR HEX 71                                          23881738
238818*-------------------------                                        23881838
238819     INSPECT XL001-SKU-DESC      REPLACING ALL                    23881938
238820         ''   BY PC-SPACE.                                       23882038
238821                                                                  23882138
238830*----------------------------------------------------------------*23883000
238900*  ADD STORE(S) FUNCTION                                         *23890000
239000*----------------------------------------------------------------*23900000
239100 4700-PROCESS-ADD-FUNCTION.                                       23910000
239200                                                                  23920000
239300     IF PS-NO-SOFT-ABORT-ERROR                                    23930000
239400         IF ASC-STORE-NBR (1 PV-ITEM) > ZEROES AND                23940000
239500            ASC-ACTION (1 PV-ITEM) NOT = 'ADD'                    23950000
239600             PERFORM 4710-LOAD-STORE-RECORD                       23960000
239700             PERFORM 4720-ISRT-STORE-RECORD                       23970000
239800             MOVE 'ADD' TO ASC-ACTION (1 PV-ITEM)                 23980000
239900         END-IF                                                   23990000
240000     END-IF.                                                      24000000
240100                                                                  24010000
240200     IF PS-NO-ERROR                                               24020000
240300         EXEC CICS                                                24030000
240400              SYNCPOINT                                           24040000
240500         END-EXEC                                                 24050000
240600     END-IF.                                                      24060000
240700                                                                  24070000
240800     IF PS-NO-ERROR                                               24080000
240900*        ----  ADD SUCCESSFUL  ----                               24090000
241000         MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER                 24100000
241100         SET DP020-MSG-INFORMATIONAL TO TRUE                      24110000
241200     END-IF.                                                      24120000
241300                                                                  24130000
241400*----------------------------------------------------------------*24140000
241500 4710-LOAD-STORE-RECORD.                                          24150000
241600                                                                  24160000
241700     INITIALIZE DCLTCEPLDS.                                       24170000
241800                                                                  24180000
241900     MOVE ASC-PULL-NBR-N            TO CEPLDS-CNSTK-REQ-PL-NBR.   24190000
242000     MOVE ASC-LINE-NUMBER           TO CEPLDS-PL-LNE-NBR.         24200000
242100     MOVE ASC-STORE-NBR (1 PV-ITEM) TO CEPLDS-STR-NBR.            24210000
242200     MOVE ASC-REQ-UNITS (1 PV-ITEM) TO CEPLDS-REQ-ORD-QTY.        24220000
242300                                                                  24230000
242400     ADD  ASC-REQ-UNITS (1 PV-ITEM) TO PV-ACCUM-CEPLDS-QTY        24240000
242500                                       ASC-ACCUM-CEPLDS-QTY.      24250000
242600                                                                  24260000
242700*----------------------------------------------------------------*24270000
242800 4720-ISRT-STORE-RECORD.                                          24280000
242900                                                                  24290000
243000     EXEC SQL                                                     24300000
243100         INSERT INTO TCEPLDS                                      24310000
243200               (CNSTK_REQ_PL_NBR                                  24320000
243300              , PL_LNE_NBR                                        24330000
243400              , STR_NBR                                           24340000
243500              , REQ_ORD_QTY)                                      24350000
243600         VALUES                                                   24360000
243700               (:CEPLDS-CNSTK-REQ-PL-NBR                          24370000
243800              , :CEPLDS-PL-LNE-NBR                                24380000
243900              , :CEPLDS-STR-NBR                                   24390000
244000              , :CEPLDS-REQ-ORD-QTY)                              24400000
244100     END-EXEC.                                                    24410000
244200                                                                  24420000
244300     EVALUATE TRUE                                                24430000
244400         WHEN SQLCODE = ZERO                                      24440000
244500             CONTINUE                                             24450000
244600                                                                  24460000
244700         WHEN SQLCODE = -904                                      24470000
244800         WHEN SQLCODE = -911                                      24480000
244900         WHEN SQLCODE = -913                                      24490000
245000             MOVE SQLCODE                  TO PV-SOFT-SQLCODE     24500000
245100             MOVE '4720-ISRT-STORE-RECORD' TO PV-SOFT-PARAGRAPH   24510000
245200             MOVE PV-SOFT-ABORT-MSG        TO PV-CICS-MSG-AREA2   24520000
245300             MOVE LENGTH OF PV-CICS-MSG-AREA2                     24530000
245400                                           TO PV-COMMAREA-LENGTH  24540000
245500             EXEC CICS                                            24550000
245600                  WRITEQ TD                                       24560000
245700                   QUEUE  ('CSSL')                                24570000
245800                    FROM  (PV-CICS-MSG-AREA2)                     24580000
245900                  LENGTH  (PV-COMMAREA-LENGTH)                    24590000
246000                    RESP  (PV-CICS-RESP)                          24600000
246100             END-EXEC                                             24610000
246200             MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER             24620000
246300             PERFORM 9900-SOFT-ABORT                              24630000
246400                                                                  24640000
246500         WHEN SQLWARN0 NOT = SPACES                               24650000
246600         WHEN SQLCODE NOT EQUAL ZERO                              24660000
246700             MOVE '4720-ISRT-STORE-RECORD' TO DP013-PARAGRAPH     24670000
246800             MOVE CEPLDS-CNSTK-REQ-PL-NBR  TO PV-PULL-NUMBER      24680000
246900             MOVE CEPLDS-PL-LNE-NBR        TO PV-LINE-NUMBER      24690000
247000             MOVE CEPLDS-STR-NBR           TO PV-STORE-NUMBER     24700000
247100                                                                  24710000
247200             STRING ' PULL= '        DELIMITED BY SIZE            24720000
247300                    PV-PULL-NUMBER   DELIMITED BY SIZE            24730000
247400                    '  /  LINE= '    DELIMITED BY SIZE            24740000
247500                    PV-LINE-NUMBER   DELIMITED BY SIZE            24750000
247600                    '  /  STORE= '   DELIMITED BY SIZE            24760000
247700                    PV-STORE-NUMBER  DELIMITED BY SIZE            24770000
247800                    '  TRYING TO INSERT TCEPLDS'                  24780000
247900                                     DELIMITED BY SIZE            24790000
248000               INTO DP013-MESSAGE-TEXT (1)                        24800000
248100             MOVE SQLCA           TO DP013-SQLCA                  24810000
248200             MOVE 'TCEPLDS'       TO DP013-DB2-TABLE-NAME (1)     24820000
248300             SET DP013-DB2-ABEND  TO TRUE                         24830000
248400             PERFORM DP013-0000-PROCESS-ABEND                     24840000
248500     END-EVALUATE.                                                24850000
248600                                                                  24860000
248700*----------------------------------------------------------------*24870000
248800 4800-UPDATE-CEPLIT-REQ-QTY.                                      24880000
248900                                                                  24890000
249000     MOVE ASC-PULL-NBR-N      TO DK-PULL-NUMBER.                  24900000
249100     MOVE ASC-LINE-NUMBER     TO DK-LINE-NUMBER.                  24910000
249200     COMPUTE CEPLIT-PL-REQ-QTY = ASC-REQ-PULL-UNITS               24920000
249300                               + PV-ACCUM-CEPLDS-QTY.             24930000
249400                                                                  24940000
249500     EXEC SQL                                                     24950000
249600         UPDATE TCEPLIT                                           24960000
249700            SET PL_REQ_QTY        = :CEPLIT-PL-REQ-QTY            24970000
249800          WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER               24980000
249900            AND PL_LNE_NBR        = :DK-LINE-NUMBER               24990000
250000     END-EXEC.                                                    25000000
250100                                                                  25010000
250200     EVALUATE TRUE                                                25020000
250300         WHEN SQLCODE = ZERO                                      25030000
250400             CONTINUE                                             25040000
250500                                                                  25050000
250600         WHEN SQLCODE = -904                                      25060000
250700         WHEN SQLCODE = -911                                      25070000
250800         WHEN SQLCODE = -913                                      25080000
250900             MOVE SQLCODE              TO PV-SOFT-SQLCODE         25090000
251000             MOVE '4800-UPDATE-CEPLIT' TO PV-SOFT-PARAGRAPH       25100000
251100             MOVE PV-SOFT-ABORT-MSG    TO PV-CICS-MSG-AREA2       25110000
251200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25120000
251300                                       TO PV-COMMAREA-LENGTH      25130000
251400             EXEC CICS                                            25140000
251500                 WRITEQ TD                                        25150000
251600                  QUEUE  ('CSSL')                                 25160000
251700                   FROM  (PV-CICS-MSG-AREA2)                      25170000
251800                 LENGTH  (PV-COMMAREA-LENGTH)                     25180000
251900                   RESP  (PV-CICS-RESP)                           25190000
252000             END-EXEC                                             25200000
252100             MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER             25210000
252200             PERFORM 9900-SOFT-ABORT                              25220000
252300                                                                  25230000
252400         WHEN SQLWARN0 NOT = SPACES                               25240000
252500         WHEN SQLCODE NOT EQUAL ZERO                              25250000
252600             MOVE '4800-UPDATE-CEPLIT' TO DP013-PARAGRAPH         25260000
252700             MOVE DK-PULL-NUMBER       TO PV-PULL-NUMBER          25270000
252800             MOVE DK-LINE-NUMBER       TO PV-LINE-NUMBER          25280000
252900             STRING ' PULL= '        DELIMITED BY SIZE            25290000
253000                    PV-PULL-NUMBER   DELIMITED BY SIZE            25300000
253100                    '  /  LINE= '    DELIMITED BY SIZE            25310000
253200                    PV-LINE-NUMBER   DELIMITED BY SIZE            25320000
253300                    '  TRYING TO UPDATE TCEPLIT'                  25330000
253400                                     DELIMITED BY SIZE            25340000
253500               INTO DP013-MESSAGE-TEXT (1)                        25350000
253600             MOVE SQLCA           TO DP013-SQLCA                  25360000
253700             MOVE 'TCEPLIT'       TO DP013-DB2-TABLE-NAME (1)     25370000
253800             SET DP013-DB2-ABEND  TO TRUE                         25380000
253900             PERFORM DP013-0000-PROCESS-ABEND                     25390000
254000     END-EVALUATE.                                                25400000
254100                                                                  25410000
254200*----------------------------------------------------------------*25420000
254300* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *25430000
254400* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *25440000
254500* FOR THE SELECTED ITEMS QUEUE.                                  *25450000
254600*                                                                *25460000
254700* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *25470000
254800* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *25480000
254900* THE ARRAY IS FULL.                                             *25490000
255000*----------------------------------------------------------------*25500000
255100 5000-PREPARE-SEL-QUEUE.                                          25510000
255200                                                                  25520000
255300     MOVE +1                   TO  ASC-BLK-SUB.                   25530000
255400     PERFORM 5100-WRITE-TEMP-STORAGE.                             25540000
255500     ADD +1                    TO  ASC-BLK-SUB.                   25550000
255600     PERFORM 5100-WRITE-TEMP-STORAGE.                             25560000
255700                                                                  25570000
255800     MOVE ASC-SEL-QUEUE-NAME   TO  CE002-SEL-QUEUE-NAME.          25580000
255900     PERFORM 6010-DELETE-SEL-QUEUE.                               25590000
256000                                                                  25600000
256100     SET ASC-UPDATE-TSQ        TO  TRUE.                          25610000
256200                                                                  25620000
256300     SET CE003-IDX             TO  1.                             25630000
256400     MOVE ZERO                 TO CE002-NUMBER-OF-TS-ITEMS.       25640000
256500     INITIALIZE CE003-SELECTED-ITEM-ARRAY.                        25650000
256600                                                                  25660000
256700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           25670000
256800       VARYING PV-ITEM FROM 1 BY 1                                25680000
256900         UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.         25690000
257000                                                                  25700000
257100     IF CE003-IDX > 1                                             25710000
257200         PERFORM 5205-WRITE-SEL-QUEUE                             25720000
257300         ADD +1 TO CE002-NUMBER-OF-TS-ITEMS                       25730000
257400     END-IF.                                                      25740000
257500                                                                  25750000
257600*----------------------------------------------------------------*25760000
257700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *25770000
257800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *25780000
257900*----------------------------------------------------------------*25790000
258000 5100-WRITE-TEMP-STORAGE.                                         25800000
258100                                                                  25810000
258200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     25820000
258300                                   TO PV-LIST-ITEM-NUMBER.        25830000
258400     COMPUTE PV-BLOCK-NUMBER =                                    25840000
258500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    25850000
258600                                                                  25860000
258700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             25870000
258800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             25880000
258900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      25890000
259000             PERFORM 5105-REWRITE-ASC-LISTQ                       25900000
259100         END-IF                                                   25910000
259200     ELSE                                                         25920000
259300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       25930000
259400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            25940000
259500         PERFORM 5110-WRITE-ASC-LISTQ                             25950000
259600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   25960000
259700     END-IF.                                                      25970000
259800                                                                  25980000
259900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             25990000
260000                                                                  26000000
260100******************************************************************26010000
260200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **26020000
260300** SPECIFIC COMMAREA.                                           **26030000
260400******************************************************************26040000
260500 5105-REWRITE-ASC-LISTQ.                                          26050000
260600                                                                  26060000
260700     EXEC CICS                                                    26070000
260800         WRITEQ TS                                                26080000
260900             QUEUE (ASC-LIST-QUEUE-NAME)                          26090000
261000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26100000
261100             ITEM  (PV-BLOCK-NUMBER)                              26110000
261200             REWRITE                                              26120000
261300             RESP  (PV-CICS-RESP)                                 26130000
261400     END-EXEC.                                                    26140000
261500                                                                  26150000
261600     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           26160000
261700         CONTINUE                                                 26170000
261800     ELSE                                                         26180000
261900         SET DP013-CICS-ABEND            TO TRUE                  26190000
262000         SET DP013-NO-ROLLBACK           TO TRUE                  26200000
262100         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       26210000
262200         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     26220000
262300                                         TO DP013-MESSAGE-TEXT(1) 26230000
262400         PERFORM DP013-0000-PROCESS-ABEND                         26240000
262500     END-IF.                                                      26250000
262600                                                                  26260000
262700******************************************************************26270000
262800** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **26280000
262900** SPECIFIC COMMAREA.                                           **26290000
263000******************************************************************26300000
263100 5110-WRITE-ASC-LISTQ.                                            26310000
263200                                                                  26320000
263300     EXEC CICS                                                    26330000
263400         WRITEQ TS                                                26340000
263500             QUEUE (ASC-LIST-QUEUE-NAME)                          26350000
263600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               26360000
263700             ITEM  (PV-BLOCK-NUMBER)                              26370000
263800             RESP  (PV-CICS-RESP)                                 26380000
263900     END-EXEC.                                                    26390000
264000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      26400000
264100         SET DP013-CICS-ABEND      TO TRUE                        26410000
264200         SET DP013-NO-ROLLBACK     TO TRUE                        26420000
264300         MOVE '5110-WRITE-ASC-LISTQ'                              26430000
264400                                   TO DP013-PARAGRAPH             26440000
264500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           26450000
264600                                   TO DP013-MESSAGE-TEXT(1)       26460000
264700         PERFORM DP013-0000-PROCESS-ABEND                         26470000
264800     END-IF.                                                      26480000
264900                                                                  26490000
265000*----------------------------------------------------------------*26500000
265100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *26510000
265200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *26520000
265300*----------------------------------------------------------------*26530000
265400 5200-FILL-SEL-QUEUE-RECORD.                                      26540000
265500                                                                  26550000
265600     PERFORM 6112-READ-LIST-QUEUE.                                26560000
265700                                                                  26570000
265800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        26580000
265900         PERFORM                                                  26590000
266000           VARYING LQW-IDX FROM 1 BY 1                            26600000
266100             UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL        26610000
266200                OR LQW-IDX > 1                                    26620000
266300                                                                  26630000
266400             MOVE 1                                               26640000
266500               TO CE003-ITEM (CE003-IDX)                          26650000
266600             MOVE SPACE                                           26660000
266700               TO CE003-ACTION-SW (CE003-IDX)                     26670000
266800             MOVE ASC-PULL-NBR-N                                  26680000
266900               TO CE003-PULL-NUMBER (CE003-IDX)                   26690000
267000             MOVE ASC-REF-NBR                                     26700000
267100               TO CE003-REF-NUMBER (CE003-IDX)                    26710000
267200             MOVE ASC-CS-LOC-N                                    26720000
267300               TO CE003-CS-LOCATION (CE003-IDX)                   26730000
267400             MOVE ZEROES                                          26740000
267500               TO CE003-CREATE-DATE (CE003-IDX)                   26750000
267600             MOVE ASC-PULL-STATUS                                 26760000
267700               TO CE003-PULL-STATUS-CDE (CE003-IDX)               26770000
267800             MOVE ASC-PULL-TYPE                                   26780000
267900               TO CE003-PULL-SOURCE-CDE (CE003-IDX)               26790000
268000             MOVE ZEROES                                          26800000
268100               TO CE003-NBR-ITEMS (CE003-IDX)                     26810000
268200             MOVE ASC-NBR-STORES                                  26820000
268300               TO CE003-NBR-STORES (CE003-IDX)                    26830000
268400             MOVE ASC-REQ-PULL-UNITS                              26840000
268500               TO CE003-REQ-PULL-UNITS (CE003-IDX)                26850000
268600             MOVE ASC-ACT-PULL-UNITS                              26860000
268700               TO CE003-ACT-PULL-UNITS (CE003-IDX)                26870000
268800             MOVE ASC-LINE-STATUS-CDE                             26880000
268900               TO CE003-LINE-STATUS-CDE (CE003-IDX)               26890000
269000             MOVE ASC-SKU-NUMBER                                  26900000
269100               TO CE003-LINE-SKU (CE003-IDX)                      26910000
269200             MOVE ASC-LINE-SKU-RETAIL                             26920000
269300               TO CE003-LINE-SKU-RETAIL (CE003-IDX)               26930000
269400             MOVE ASC-LINE-ITEM                                   26940000
269500               TO CE003-LINE-ITEM (CE003-IDX)                     26950000
269600                                                                  26960000
269700             MOVE ASC-LINE-NUMBER                                 26970000
269800               TO CE003-LINE-NUMBER (CE003-IDX)                   26980000
269900                                                                  26990000
270000             SET CE003-IDX UP BY 1                                27000000
270100             IF CE003-IDX > CE003-MAX-ITEMS                       27010000
270200                 PERFORM 5205-WRITE-SEL-QUEUE                     27020000
270300                 ADD +1        TO CE002-NUMBER-OF-TS-ITEMS        27030000
270400                 INITIALIZE CE003-SELECTED-ITEM-ARRAY             27040000
270500                 SET CE003-IDX TO  1                              27050000
270600             END-IF                                               27060000
270700         END-PERFORM                                              27070000
270800     END-IF.                                                      27080000
270900                                                                  27090000
271000*----------------------------------------------------------------*27100000
271100*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *27110000
271200*----------------------------------------------------------------*27120000
271300 5205-WRITE-SEL-QUEUE.                                            27130000
271400                                                                  27140000
271500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO CE003-SELECTED-ITEMS.   27150000
271600                                                                  27160000
271700     EXEC CICS                                                    27170000
271800          WRITEQ TS                                               27180000
271900              QUEUE (ASC-SEL-QUEUE-NAME)                          27190000
272000              FROM  (CE003-SELECT-RECORD)                         27200000
272100              ITEM  (PV-SEL-QUEUE-ITEM)                           27210000
272200              RESP  (PV-CICS-RESP)                                27220000
272300     END-EXEC.                                                    27230000
272400                                                                  27240000
272500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           27250000
272600         CONTINUE                                                 27260000
272700     ELSE                                                         27270000
272800         SET DP013-CICS-ABEND        TO TRUE                      27280000
272900         SET DP013-NO-ROLLBACK       TO TRUE                      27290000
273000         MOVE '5205-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           27300000
273100         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          27310000
273200                                     TO DP013-MESSAGE-TEXT(1)     27320000
273300         PERFORM DP013-0000-PROCESS-ABEND                         27330000
273400     END-IF.                                                      27340000
273500                                                                  27350000
273600******************************************************************27360000
273700** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **27370000
273800** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **27380000
273900** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **27390000
274000** THE USER.                                                    **27400000
274100******************************************************************27410000
274200 6000-REFRESH-PANEL-FROM-TEMP.                                    27420000
274300                                                                  27430000
274400     IF ASC-UPDATE-TSQ                                            27440000
274500         SET ASC-NO-TSQ-UPDATE TO TRUE                            27450000
274600         MOVE ZERO                 TO PV-SAVE-ITEM                27460000
274700                                      PV-SEL-QUEUE-ITEM           27470000
274800         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        27480000
274900                                   TO PV-HOLD-SELECTED-ITEMS      27490000
275000         MOVE +1                   TO PV-ITEMS-PROCESSED          27500000
275100         PERFORM 6100-UPDATE-TSQ                                  27510000
275200             UNTIL PV-ITEMS-PROCESSED >                           27520000
275300                                     PV-HOLD-SELECTED-ITEMS       27530000
275400         PERFORM 6010-DELETE-SEL-QUEUE                            27540000
275500         INITIALIZE ASC-BLOCK-ENTRIES (1)                         27550000
275600                    ASC-BLOCK-ENTRIES (2)                         27560000
275700     END-IF.                                                      27570000
275800                                                                  27580000
275900*----------------------------------------------------------------*27590000
276000*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *27600000
276100*----------------------------------------------------------------*27610000
276200 6010-DELETE-SEL-QUEUE.                                           27620000
276300                                                                  27630000
276400     EXEC CICS                                                    27640000
276500         DELETEQ TS                                               27650000
276600             QUEUE (ASC-SEL-QUEUE-NAME)                           27660000
276700             RESP  (PV-CICS-RESP)                                 27670000
276800     END-EXEC.                                                    27680000
276900*                                                                 27690000
277000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      27700000
277100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         27710000
277200         CONTINUE                                                 27720000
277300     ELSE                                                         27730000
277400         SET DP013-CICS-ABEND TO TRUE                             27740000
277500         SET DP013-NO-ROLLBACK TO TRUE                            27750000
277600         MOVE '6010-DELETE-SEL-QUEUE'                             27760000
277700                        TO DP013-PARAGRAPH                        27770000
277800         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         27780000
277900                        TO DP013-MESSAGE-TEXT (1)                 27790000
278000         PERFORM DP013-0000-PROCESS-ABEND                         27800000
278100     END-IF.                                                      27810000
278200                                                                  27820000
278300*----------------------------------------------------------------*27830000
278400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *27840000
278500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *27850000
278600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *27860000
278700*    THE TEMP QUEUE.                                             *27870000
278800*----------------------------------------------------------------*27880000
278900 6100-UPDATE-TSQ.                                                 27890000
279000                                                                  27900000
279100     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  27910000
279200                                                                  27920000
279300     PERFORM 6105-READ-SEL-QUEUE.                                 27930000
279400                                                                  27940000
279500     PERFORM                                                      27950000
279600       VARYING CE003-IDX FROM 1 BY 1                              27960000
279700         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     27970000
279800            OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))          27980000
279900                                                                  27990000
280000         IF CE003-ACTION-SW (CE003-IDX) > SPACE                   28000000
280100             PERFORM 6110-PROCESS-ITEMS                           28010000
280200         END-IF                                                   28020000
280300                                                                  28030000
280400         ADD +1 TO PV-ITEMS-PROCESSED                             28040000
280500     END-PERFORM.                                                 28050000
280600                                                                  28060000
280700     PERFORM 6111-WRITE-LIST-QUEUE.                               28070000
280800                                                                  28080000
280900*----------------------------------------------------------------*28090000
281000*    READ THE LIST QUEUE RECORD.                                 *28100000
281100*----------------------------------------------------------------*28110000
281200 6105-READ-SEL-QUEUE.                                             28120000
281300                                                                  28130000
281400     EXEC CICS                                                    28140000
281500          READQ TS                                                28150000
281600              QUEUE (ASC-SEL-QUEUE-NAME)                          28160000
281700              INTO  (CE003-SELECT-RECORD)                         28170000
281800              ITEM  (PV-SEL-QUEUE-ITEM)                           28180000
281900              RESP  (PV-CICS-RESP)                                28190000
282000     END-EXEC.                                                    28200000
282100                                                                  28210000
282200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28220000
282300         CONTINUE                                                 28230000
282400     ELSE                                                         28240000
282500         SET DP013-CICS-ABEND      TO  TRUE                       28250000
282600         SET DP013-NO-ROLLBACK     TO  TRUE                       28260000
282700         MOVE '6105-READ-SEL-QUEUE'                               28270000
282800                                   TO  DP013-PARAGRAPH            28280000
282900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           28290000
283000                                   TO  DP013-MESSAGE-TEXT(1)      28300000
283100         PERFORM DP013-0000-PROCESS-ABEND                         28310000
283200     END-IF.                                                      28320000
283300                                                                  28330000
283400*----------------------------------------------------------------*28340000
283500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*28350000
283600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*28360000
283700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *28370000
283800*----------------------------------------------------------------*28380000
283900 6110-PROCESS-ITEMS.                                              28390000
284000                                                                  28400000
284100     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          28410000
284200                     / PC-ITEMS-PER-PANEL).                       28420000
284300                                                                  28430000
284400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           28440000
284500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          28450000
284600             PERFORM 6111-WRITE-LIST-QUEUE                        28460000
284700         END-IF                                                   28470000
284800         MOVE PV-ITEM          TO PV-SAVE-ITEM                    28480000
284900                                                                  28490000
285000         PERFORM 6112-READ-LIST-QUEUE                             28500000
285100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               28510000
285200             CONTINUE                                             28520000
285300         END-IF                                                   28530000
285400     END-IF.                                                      28540000
285500                                                                  28550000
285600     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     28560000
285700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              28570000
285800     EVALUATE TRUE                                                28580000
285900         WHEN CE003-INQ (CE003-IDX)                               28590000
286000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             28600000
286100                                                                  28610000
286200         WHEN CE003-UPD (CE003-IDX)                               28620000
286300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             28630000
286400                                                                  28640000
286500         WHEN CE003-DEL (CE003-IDX)                               28650000
286600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             28660000
286700                                                                  28670000
286800         WHEN CE003-ERR (CE003-IDX)                               28680000
286900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             28690000
287000     END-EVALUATE.                                                28700000
287100                                                                  28710000
287200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                28720000
287300                                                                  28730000
287400*----------------------------------------------------------------*28740000
287500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *28750000
287600*----------------------------------------------------------------*28760000
287700 6111-WRITE-LIST-QUEUE.                                           28770000
287800                                                                  28780000
287900     EXEC CICS                                                    28790000
288000         WRITEQ TS                                                28800000
288100             QUEUE (ASC-LIST-QUEUE-NAME)                          28810000
288200             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     28820000
288300             ITEM  (PV-SAVE-ITEM)                                 28830000
288400             REWRITE                                              28840000
288500             RESP  (PV-CICS-RESP)                                 28850000
288600     END-EXEC.                                                    28860000
288700*                                                                 28870000
288800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          28880000
288900         CONTINUE                                                 28890000
289000     ELSE                                                         28900000
289100         SET DP013-CICS-ABEND  TO  TRUE                           28910000
289200         SET DP013-NO-ROLLBACK TO  TRUE                           28920000
289300         MOVE '6111-WRITE-LIST-QUEUE'                             28930000
289400                               TO  DP013-PARAGRAPH                28940000
289500         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  28950000
289600                               TO  DP013-MESSAGE-TEXT(1)          28960000
289700         PERFORM DP013-0000-PROCESS-ABEND                         28970000
289800     END-IF.                                                      28980000
289900                                                                  28990000
290000*----------------------------------------------------------------*29000000
290100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*29010000
290200*----------------------------------------------------------------*29020000
290300 6112-READ-LIST-QUEUE.                                            29030000
290400                                                                  29040000
290500     EXEC CICS                                                    29050000
290600         READQ TS                                                 29060000
290700             QUEUE (ASC-LIST-QUEUE-NAME)                          29070000
290800             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29080000
290900             ITEM  (PV-ITEM)                                      29090000
291000             RESP  (PV-CICS-RESP)                                 29100000
291100     END-EXEC.                                                    29110000
291200*                                                                 29120000
291300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29130000
291400         CONTINUE                                                 29140000
291500     ELSE                                                         29150000
291600         SET DP013-CICS-ABEND        TO TRUE                      29160000
291700         SET DP013-NO-ROLLBACK       TO TRUE                      29170000
291800         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29180000
291900         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29190000
292000                                     TO DP013-MESSAGE-TEXT(1)     29200000
292100         PERFORM DP013-0000-PROCESS-ABEND                         29210000
292200     END-IF.                                                      29220000
292300                                                                  29230000
292400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 29240000
292500* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *29250000
292600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 29260000
292700 9100-READ-SEL-QUEUE.                                             29270000
292800                                                                  29280000
292900     EXEC CICS                                                    29290000
293000         READQ TS                                                 29300000
293100             QUEUE (ASC-SEL-QUEUE-NAME)                           29310000
293200             INTO  (CE003-SELECT-RECORD)                          29320000
293300             ITEM  (ASC-SEL-ITEM)                                 29330000
293400             RESP  (PV-CICS-RESP)                                 29340000
293500     END-EXEC.                                                    29350000
293600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        29360000
293700         CONTINUE                                                 29370000
293800     ELSE                                                         29380000
293900         SET DP013-LOGIC-ABEND                                    29390000
294000             DP013-NO-ROLLBACK   TO   TRUE                        29400000
294100         MOVE '9100-READ-SEL-QUEUE'                               29410000
294200                                 TO   DP013-PARAGRAPH             29420000
294300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   29430000
294400                                 TO   DP013-MESSAGE-TEXT (1)      29440000
294500         PERFORM DP013-0000-PROCESS-ABEND                         29450000
294600     END-IF.                                                      29460000
294700                                                                  29470000
294800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*29480000
294900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *29490000
295000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 29500000
295100 9200-REWRITE-SEL-QUEUE.                                          29510000
295200                                                                  29520000
295300     EXEC CICS                                                    29530000
295400          WRITEQ TS                                               29540000
295500              QUEUE  (ASC-SEL-QUEUE-NAME)                         29550000
295600              FROM   (CE003-SELECT-RECORD)                        29560000
295700              ITEM   (ASC-SEL-ITEM)                               29570000
295800              RESP   (PV-CICS-RESP)                               29580000
295900              REWRITE                                             29590000
296000     END-EXEC.                                                    29600000
296100                                                                  29610000
296200     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   29620000
296300         SET DP013-CICS-ABEND                                     29630000
296400             DP013-NO-ROLLBACK     TO TRUE                        29640000
296500         MOVE '9200-REWRITE-SEL-QUEUE'                            29650000
296600                                   TO DP013-PARAGRAPH             29660000
296700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   29670000
296800                                   TO DP013-MESSAGE-TEXT (1)      29680000
296900         PERFORM DP013-0000-PROCESS-ABEND                         29690000
297000     END-IF.                                                      29700000
297100                                                                  29710000
297200*----------------------------------------------------------------*29720000
297300*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *29730000
297400*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *29740000
297500*----------------------------------------------------------------*29750000
297600 9900-SOFT-ABORT.                                                 29760000
297700                                                                  29770000
297800     EXEC CICS SYNCPOINT                                          29780000
297900          ROLLBACK                                                29790000
298000     END-EXEC.                                                    29800000
298100                                                                  29810000
298200     SET  PS-ERROR                                                29820000
298300          PS-SOFT-ABORT-ERROR                                     29830000
298400          DP020-MSG-FATAL       TO  TRUE.                         29840000
298500                                                                  29850000
299100*----------------------------------------------------------------*29910000
299200*    ABEND PROCESSOR MODULE                                      *29920000
299300*----------------------------------------------------------------*29930000
299400     COPY DPPD013.                                                29940000
