000100******************************************************************00010002
000200 IDENTIFICATION DIVISION.                                         00020014
000300 PROGRAM-ID.             SUKUT115.                                00030014
000400 AUTHOR.                 LYNN MCADAMS.                            00040014
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050014
000600 DATE-WRITTEN            OCTOBER, 2005.                           00060014
000700 DATE-COMPILED.                                                   00070014
000800*----------------------------------------------------------------*00080014
000900* THIS PROGRAM WILL INDICATE RECEIVERS HAVING MULTIPLE LINES     *00090014
001000* THAT WERE MANUALLY RECEIVED AND RECEIVER LINES HAVING          *00100014
001100* MULTIPLE TROUBLES THAT WERE MANUALLY RECEIVED.                 *00110014
001200*                                                                *00120014
001300* THE LAYOUT FOR THE INPUT FILE IS SURD066.                      *00130014
001400* THE LAYOUT FOR THE OUTPUT FILE IS SURD066.                     *00140014
001500*----------------------------------------------------------------*00150014
001600 ENVIRONMENT DIVISION.                                            00160014
001700 INPUT-OUTPUT SECTION.                                            00170014
001800                                                                  00180014
001900 FILE-CONTROL.                                                    00190014
002000                                                                  00200014
002100     SELECT INPUT-FILE ASSIGN TO INP01.                           00210014
002200     SELECT EXTRACT-FILE ASSIGN TO OUT01.                         00220014
002300                                                                  00230014
002400***************************************************************** 00240014
002500 DATA DIVISION.                                                   00250014
002600 FILE SECTION.                                                    00260014
002700*                                                                 00270014
002800 FD  INPUT-FILE                                                   00280014
002900     RECORDING MODE IS F                                          00290014
003000     LABEL RECORDS ARE STANDARD                                   00300014
003100     BLOCK CONTAINS 0 RECORDS.                                    00310014
003200 01  INPUT-RECORD                PIC X(600).                      00320014
003300                                                                  00330014
003400 FD  EXTRACT-FILE                                                 00340014
003500     RECORDING MODE IS F                                          00350014
003600     LABEL RECORDS ARE STANDARD                                   00360014
003700     BLOCK CONTAINS 0 RECORDS.                                    00370014
003800 01  EXTRACT-RECORD              PIC X(600).                      00380014
003900*                                                                 00390014
004000***************************************************************** 00400014
004100 WORKING-STORAGE SECTION.                                         00410014
004200                                                                  00420014
004300 01  PS-PROGRAM-SWITCHES.                                         00430014
004400     05  PS-END-OF-INPUT-FILE-SW        PIC X(01)  VALUE 'N'.     00440014
004500         88  PS-END-OF-INPUT-FILE                  VALUE 'Y'.     00450014
004600         88  PS-NOT-END-OF-INPUT-FILE              VALUE 'N'.     00460014
004700                                                                  00470014
004800     05  PS-FIRST-REC-SW                 PIC X(01) VALUE 'N'.     00480015
004900         88  PS-FIRST-REC                          VALUE 'Y'.     00490017
005000                                                                  00500014
005100                                                                  00510014
005200 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00520014
005300                                                 COMP SYNC.       00530014
005400                                                                  00540014
005500 01  PV-PROGRAM-VARIABLES.                                        00550014
005600                                                                  00560014
005700     05  PV-TRN-NBR                   PIC S9(09) COMP.            00570014
005800     05  PV-RCVR-SEQ-NBR              PIC S9(09) COMP.            00580014
005900                                                                  00590014
006000     05  PV-PREV-RECORD.                                          00600022
006100         10  PV-PREV-OPER-UNT-ID            PIC 9(04).            00610022
006200         10  PV-PREV-DATE                   PIC X(10).            00620022
006300         10  PV-PREV-CART-SRC-CDE           PIC X(03).            00630022
006400         10  PV-PREV-DC-COMMENT-MTPL-IND    PIC X(01).            00640099
006500         10  PV-PREV-PO-NBR                 PIC 9(09).            00650022
006600         10  PV-PREV-REC-SEQ-NBR            PIC 9(09).            00660022
006700         10  PV-PREV-TRN-LNE-NBR            PIC 9(09).            00670022
006800         10  PV-PREV-PREPK-ID               PIC 9(04).            00680022
006900         10  PV-PREV-PO-TYP-CDE             PIC X(02).            00690022
007000         10  PV-PREV-PKGNG-CDE              PIC X(01).            00700022
007100         10  PV-PREV-ENT-ID                 PIC 9(09).            00710022
007200         10  PV-PREV-ENT-NAME-DESC          PIC X(30).            00720022
007300         10  PV-PREV-DEPT-NBR               PIC X(03).            00730022
007400         10  PV-PREV-CRTN-CNT               PIC 9(04).            00740022
007500         10  PV-PREV-TRBL-EXIST             PIC X(01).            00750022
007600         10  PV-PREV-TRBL-RSN-CDE           PIC 9(04).            00760022
007700         10  PV-PREV-TRBL-MTPL-IND          PIC X(01).            00770022
007800         10  PV-PREV-TRBL-SHT-DESC          PIC X(10).            00780022
007900         10  PV-PREV-FREEFORM-TEXT          PIC X(250).           00790022
008000         10  PV-PREV-CRE-DTE                PIC X(10).            00800022
008100         10  PV-PREV-CRE-TM                 PIC X(08).            00810022
008200         10  PV-PREV-SHFT-NBR               PIC 9(04).            00820022
008300         10  PV-PREV-CRE-USR-ID             PIC X(08).            00830022
008400         10  PV-PREV-COMBINED-NAME          PIC X(90).            00840022
008500         10  PV-PREV-VND-ASN-PRD-SW         PIC X(01).            00850022
008600         10  PV-PREV-ASN-CTN-DAT-SW         PIC X(01).            00860022
008700         10  PV-PREV-PR-QC-AU-SW            PIC X(01).            00870022
008800         10  PV-PREV-MX-SK-SW               PIC X(01).            00880022
008900         10  PV-PREV-IMPRT-VND-ID           PIC 9(09).            00890022
009000         10  PV-PREV-IMPRT-FCTRY-ID         PIC 9(09).            00900022
009100         10  PV-PREV-DECN-ENT-ID            PIC 9(09).            00910022
009200         10  PV-PREV-DECN-SCAC-CDE          PIC X(04).            00920022
009300         10  FILLER                         PIC X(81).            00930022
009400                                                                  00940014
009500     05  PV-READ-COUNT                PIC S9(09) VALUE ZERO       00950014
009600                                                  COMP SYNC.      00960014
009700     05  PV-WRITE-EXTR-COUNT          PIC S9(09) VALUE ZERO       00970014
009800                                                  COMP SYNC.      00980014
009900                                                                  00990014
010000     05  PV-DISPLAY-READ-CNT          PIC ZZZ,ZZZ,ZZ9.            01000014
010100     05  PV-DISPLAY-WRITE-CNT         PIC ZZZ,ZZZ,ZZ9.            01010014
010200                                                                  01020014
010300     05  PV-DISPLAY-TRN-NBR           PIC Z(9)-.                  01030014
010400     05  PV-DISPLAY-RCVR-SEQ-NBR      PIC Z(9)-.                  01040014
010500     05  PV-DISPLAY-TRN-LNE-NBR       PIC Z(9)-.                  01050014
010600     05  PV-DISPLAY-OPER-UNT-ID       PIC Z(9)-.                  01060014
010700     05  PV-DISPLAY-UPC-NBR           PIC Z(9)-.                  01070014
010800     05  PV-DISPLAY-ENT-ID            PIC Z(9)-.                  01080014
010900     05  PV-DISPLAY-PKSL-SEQ-NBR      PIC Z(9)-.                  01090014
011000     05  PV-DISPLAY-CART-COMB-NBR     PIC Z(9)-.                  01100014
011100     05  PV-DISPLAY-PREPK-ID          PIC Z(9)-.                  01110014
011200     05  PV-DISPLAY-USER-ID           PIC Z(9)-.                  01120014
011300     05  PV-DISPLAY-MI-FETCH-CNT      PIC Z(9)-.                  01130014
011400     05  PV-DISPLAY-BCS-FETCH-CNT     PIC Z(9)-.                  01140014
011500                                                                  01150014
011600     05  PV-RETAIL-AMOUNT             PIC S9(09)V99 VALUE ZERO    01160014
011700                                                  COMP SYNC.      01170014
011800     05  PV-CARTON-UNIT-COUNT         PIC S9(09) VALUE ZERO       01180014
011900                                                  COMP SYNC.      01190014
012000     05  PV-RETAIL-AMOUNT-EXTENDED    PIC S9(09)V99 VALUE ZERO    01200014
012100                                                  COMP SYNC.      01210014
012200     05  PV-CURRENT-DATE              PIC X(10) VALUE SPACE.      01220014
012300                                                                  01230014
012400                                                                  01240014
012500 01 PC-PROGRAM-CONSTANTS.                                         01250014
012600     05 PC-PROGRAM-NAME              PIC X(08)  VALUE 'SUKUT115'. 01260014
012700     05 PC-DEFAULT-TMST              PIC X(26)                    01270014
012800             VALUE '9999-09-09-09.09.09.999999'.                  01280014
012900     05 PC-INACTV-DTE                PIC X(10)                    01290014
013000             VALUE '9999-09-09'.                                  01300014
013100     05 PC-01                       PIC  X(01)  VALUE '1'.        01310014
013200     05 PC-DASH                     PIC  X(01)  VALUE '-'.        01320014
013300     05 PC-PERIOD                   PIC  X(01)  VALUE '.'.        01330014
013400     05 PC-MS                       PIC  X(06)  VALUE '999999'.   01340014
013500                                                                  01350014
013600 01  PV-ABEND-FIELDS.                                             01360014
013700     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         01370014
013800                                                 COMP SYNC.       01380014
013900     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'SUKUT115'.01390014
014000     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01400014
014100     05  PV-ABEND-OPERATION           PIC  X(51) VALUE SPACES.    01410014
014200     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACES.    01420014
014300                                                                  01430014
014400                                                                  01440014
014500*----------------------------------------------------------------*01450014
014600*    ABEND PROCESSING COPYBOOK.                                  *01460014
014700*----------------------------------------------------------------*01470014
014800     COPY DPWS013.                                                01480014
014900                                                                  01490014
015000******************************************************************01500014
015100*  RECORD LAYOUT FOR THE DAILY - NOT SCANNED DETAIL REPORT        01510099
015200*  EXTRACT.                                                       01520014
015300***********************************************************       01530014
015400*INPUT FILE LAYOUT                                                01540014
015500*OUTPUT FILE LAYOUT                                               01550014
015600     COPY SURD066.                                                01560014
015700                                                                  01570014
015800***********************************************************       01580014
015900 PROCEDURE DIVISION.                                              01590014
016000***********************************************************       01600014
016100     DISPLAY '***BEGINNING SUKUT115***'.                          01610014
016200                                                                  01620014
016300     PERFORM 1000-INITIALIZE.                                     01630014
016400                                                                  01640014
016500     PERFORM 7000-READ-INPUT-FILE.                                01650015
016600                                                                  01660021
016700     IF  PS-END-OF-INPUT-FILE                                     01670016
016800         DISPLAY SPACES                                           01680016
016900         DISPLAY ALL '*'                                          01690016
017000         DISPLAY '  INPUT FILE IS EMPTY '                         01700016
017100         DISPLAY ALL '*'                                          01710016
017200         DISPLAY SPACES                                           01720016
017300     ELSE                                                         01730016
017400         PERFORM 2000-MAIN-PROCESS                                01740017
017500           UNTIL  PS-END-OF-INPUT-FILE                            01750016
017600     END-IF.                                                      01760016
017700                                                                  01770014
017800     PERFORM 9000-CLOSE-FILES.                                    01780014
017900                                                                  01790014
018000     GOBACK.                                                      01800014
018100                                                                  01810014
018200******************************************************************01820014
018300*  DO FIRST TIME PROGRAM INITIALIZE TASKS.                        01830014
018400 1000-INITIALIZE.                                                 01840014
018500******************************************************************01850014
018600     INITIALIZE PV-PREV-RECORD.                                   01860014
018700                                                                  01870014
018800     MOVE 'Y' TO PS-FIRST-REC-SW.                                 01880017
018900                                                                  01890017
019000     OPEN INPUT  INPUT-FILE                                       01900014
019100          OUTPUT EXTRACT-FILE.                                    01910014
019200                                                                  01920014
019300***************************************************************** 01930014
019400 2000-MAIN-PROCESS.                                               01940014
019500***************************************************************** 01950014
019600                                                                  01960014
019700     IF PS-FIRST-REC-SW = 'Y'                                     01970019
019800        MOVE 'N' TO PS-FIRST-REC-SW                               01980088
019900     ELSE                                                         01990017
020000        PERFORM 2100-CHECK-FOR-MULT-LINE-TRBL                     02000093
020100     END-IF                                                       02010090
020200                                                                  02020090
020300     MOVE SU066-RECORD TO PV-PREV-RECORD                          02030085
020400                                                                  02040085
020500     PERFORM 7000-READ-INPUT-FILE                                 02050083
020600                                                                  02060093
020700     IF PS-END-OF-INPUT-FILE                                      02070093
020800        CONTINUE                                                  02080093
020900     ELSE                                                         02090093
021000        PERFORM 2100-CHECK-FOR-MULT-LINE-TRBL                     02100093
021100     END-IF                                                       02110093
021200                                                                  02120093
021300     IF PS-FIRST-REC-SW = 'N'                                     02130070
021400        PERFORM 8000-WRITE-EXTRACT                                02140070
021500     END-IF.                                                      02150073
021600                                                                  02160082
021700***************************************************************** 02170090
021800 2100-CHECK-FOR-MULT-LINE-TRBL.                                   02180090
021900***************************************************************** 02190090
022000     IF (SU066-OPER-UNT-ID     = PV-PREV-OPER-UNT-ID)             02200091
022100        AND (SU066-PO-NBR      = PV-PREV-PO-NBR)                  02210091
022200        AND (SU066-REC-SEQ-NBR = PV-PREV-REC-SEQ-NBR)             02220091
022300                                                                  02230090
022400        IF (PV-PREV-TRBL-MTPL-IND NOT = 'Y') AND                  02240099
022500           (PV-PREV-TRBL-EXIST = 'Y')                             02250099
022600           MOVE 'Y' TO PV-PREV-TRBL-MTPL-IND                      02260099
022700        END-IF                                                    02270099
022800                                                                  02280099
022900        IF (SU066-TRBL-EXIST = 'Y') AND                           02290099
023000           (PV-PREV-TRBL-EXIST = 'Y')                             02300099
023100           MOVE 'Y' TO SU066-TRBL-MTPL-IND                        02310099
023200        END-IF                                                    02320099
023300     END-IF.                                                      02330094
023400                                                                  02340096
023500***************************************************************** 02350014
023600 7000-READ-INPUT-FILE.                                            02360014
023700***************************************************************** 02370014
023800      READ INPUT-FILE INTO SU066-RECORD                           02380014
023900        AT END                                                    02390014
024000           SET PS-END-OF-INPUT-FILE TO TRUE                       02400014
024100        NOT AT END                                                02410014
024200           ADD +1 TO PV-READ-COUNT                                02420014
024300      END-READ.                                                   02430014
024400                                                                  02440014
024500***************************************************************** 02450014
024600 8000-WRITE-EXTRACT.                                              02460014
024700***************************************************************** 02470014
024800     WRITE EXTRACT-RECORD                                         02480014
024900*      FROM SU066-RECORD.                                         02490017
025000       FROM PV-PREV-RECORD.                                       02500017
025100                                                                  02510014
025200     ADD +1 TO PV-WRITE-EXTR-COUNT.                               02520014
025300                                                                  02530014
025400***************************************************************** 02540014
025500 9000-CLOSE-FILES.                                                02550014
025600                                                                  02560014
025700     MOVE PV-READ-COUNT              TO PV-DISPLAY-READ-CNT.      02570014
025800     DISPLAY 'TOT RECS READ       : '   PV-DISPLAY-READ-CNT.      02580014
025900                                                                  02590014
026000     MOVE PV-WRITE-EXTR-COUNT        TO PV-DISPLAY-WRITE-CNT.     02600014
026100     DISPLAY 'TOT RECS WRITTEN    : '   PV-DISPLAY-WRITE-CNT.     02610014
026200                                                                  02620014
026300     CLOSE INPUT-FILE                                             02630014
026400           EXTRACT-FILE.                                          02640014
026500                                                                  02650014
