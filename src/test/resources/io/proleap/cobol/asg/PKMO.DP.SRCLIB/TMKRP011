000010 IDENTIFICATION DIVISION.                                         00010000
000020                                                                  00020000
000030 PROGRAM-ID.             TMKRP011.                                00030001
000040 AUTHOR.                 TAMARA KOLTUN.                           00040000
000050 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000060 DATE-WRITTEN            10/09/96.                                00060000
000070 DATE-COMPILED.                                                   00070000
000080                                                                  00080000
000090 ENVIRONMENT DIVISION.                                            00090000
000100 INPUT-OUTPUT SECTION.                                            00100000
000200                                                                  00110000
000300 FILE-CONTROL.                                                    00120000
000400                                                                  00130000
000500     SELECT TROUBLE-EXTRACT-FILE       ASSIGN TO INP01.           00140000
000600     SELECT DIV-TRBL-SUMUM-BUY-RPT ASSIGN TO RPT01.               00150020
000601     SELECT DIV-TRBL-SUMUM-MER-RPT ASSIGN TO RPT02.               00160020
000602     SELECT DIV-TRBL-SUMUM-LOG-RPT ASSIGN TO RPT03.               00170020
000700                                                                  00180000
000800                                                                  00190000
000900 DATA DIVISION.                                                   00200000
001000                                                                  00210000
001100 FILE SECTION.                                                    00220000
001200 FD  TROUBLE-EXTRACT-FILE                                         00230000
001300     RECORDING MODE IS F                                          00240000
001400     LABEL RECORDS ARE STANDARD                                   00250000
001500     BLOCK CONTAINS 0 RECORDS.                                    00260000
001600                                                                  00270000
001700 01  TROUBLE-EXTRACT-RECORD         PIC X(400).                   00280000
001800                                                                  00290000
001808 FD  DIV-TRBL-SUMUM-BUY-RPT                                       00300020
001809     RECORDING MODE IS F                                          00310000
001810     LABEL RECORDS ARE STANDARD                                   00320000
001811     BLOCK CONTAINS 0 RECORDS.                                    00330000
001812                                                                  00340000
001813 01  DIV-TRBL-SUMUM-BUY-REC         PIC X(132).                   00350020
001814                                                                  00360020
001815 FD  DIV-TRBL-SUMUM-MER-RPT                                       00370020
001816     RECORDING MODE IS F                                          00380020
001817     LABEL RECORDS ARE STANDARD                                   00390020
001818     BLOCK CONTAINS 0 RECORDS.                                    00400020
001819                                                                  00410020
001820 01  DIV-TRBL-SUMUM-MER-REC         PIC X(132).                   00420020
001821                                                                  00430020
001822 FD  DIV-TRBL-SUMUM-LOG-RPT                                       00440020
001823     RECORDING MODE IS F                                          00450020
001824     LABEL RECORDS ARE STANDARD                                   00460020
001825     BLOCK CONTAINS 0 RECORDS.                                    00470020
001826                                                                  00480020
001827 01  DIV-TRBL-SUMUM-LOG-REC         PIC X(132).                   00490020
001828                                                                  00500020
001829 WORKING-STORAGE SECTION.                                         00510020
001830 01  PS-SWITCHES.                                                 00520020
001831     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     00530020
001832         88  PS-EOF                                VALUE 'Y'.     00540020
001833         88  PS-NOT-EOF                            VALUE 'N'.     00550020
004500     05  PS-SPECIAL-RUN-SW           PIC  X(01)    VALUE 'N'.     00450000
004600         88  PS-SPECIAL-RUN                        VALUE 'Y'.     00460000
004700         88  PS-NOT-SPECIAL-RUN                    VALUE 'N'.     00470000
001834     05  PS-RPT-PERIOD-SW            PIC  X(01)    VALUE ' '.     00560020
001835         88  PS-MONTHLY-RPT                        VALUE 'M'.     00570020
001836         88  PS-WEEKLY-RPT                         VALUE 'W'.     00580020
001837     05  PS-REPORT-SW                PIC  X(01)    VALUE ' '.     00590000
001840         88  PS-TROUBLE-ASSIGNED-RPT               VALUE 'A'.     00600000
001850         88  PS-TOP-TROUBLE-RPT                    VALUE 'T'.     00610000
001870     05  PS-FIRST-DMM-SW             PIC  X(01)    VALUE 'F'.     00620000
001871         88  PS-FIRST-DMM                          VALUE 'F'.     00630000
001872         88  PS-NOT-FIRST-DMM                      VALUE 'N'.     00640000
001873     05  PS-FIRST-DMM-SW             PIC  X(01)    VALUE 'F'.     00650000
001874         88  PS-FIRST-ANAL                         VALUE 'F'.     00660000
001875         88  PS-NOT-FIRST-ANAL                     VALUE 'N'.     00670000
001879     05 PS-FIRST-PROCESS-AREA-SW     PIC X(01)     VALUE 'F'.     00680000
001880         88  PS-FIRST-PROCESS-AREA                 VALUE 'F'.     00690000
001881         88  PS-NOT-FIRST-PROCESS-AREA             VALUE 'N'.     00700000
001882     05 PS-FIRST-MERCH-HEADER-SW     PIC X(01)     VALUE 'F'.     00710007
001883         88 PS-FIRST-MERCH-HEADER                  VALUE 'F'.     00720007
001886         88 PS-NOT-FIRST-MERCH-HEADER              VALUE ' '.     00730007
001887     05  PS-AREA-SW                  PIC  X(01)    VALUE ' '.     00740000
001888         88  PS-AREA-BUYING                        VALUE 'D'.     00750000
001889         88  PS-AREA-MERCH                         VALUE 'A'.     00760000
001890         88  PS-AREA-LOGISTICS                     VALUE 'L'.     00770000
001891     05  PS-FIRST-CM-RECORD-SW       PIC  X(01)    VALUE 'F'.     00780000
001892         88  PS-FIRST-CM-RECORD                    VALUE 'F'.     00790000
001893         88  PS-NOT-FIRST-CM-RECORD                VALUE ' '.     00800000
001894     05 PS-FIRST-TIME-THRU-SW           PIC X(01)  VALUE 'F'.     00810000
001895        88 PS-FIRST-TIME-THRU                      VALUE 'F'.     00820000
001896        88 PS-NOT-FIRST-TIME-THRU                  VALUE ' '.     00830000
001900 01  PC-PROGRAM-CONSTANTS.                                        00840000
001901     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00850000
001902                                    'TMKRP011'.                   00860001
001903     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00870000
001904                                                   COMP SYNC.     00880000
001905     05  PC-SPECIAL-RUN-NOTE         PIC X(27)     VALUE          00890000
001910                                    '** SPECIAL REQUESTED RUN **'.00900000
001911     05  PC-ONE                      PIC 9(01)     VALUE  1.      00910000
001912     05  PC-TWO                      PIC 9(01)     VALUE  2.      00920001
001913     05  PC-THREE                    PIC 9(01)     VALUE  3.      00930016
001914     05  PC-FOUR                     PIC 9(01)     VALUE  4.      00940016
001915     05  PC-FIVE                     PIC 9(01)     VALUE  5.      00950016
001916     05  PC-SIX                      PIC 9(01)     VALUE  6.      00960016
001917     05  PC-NOT-FOUND                PIC X(17)     VALUE          00970016
001918                                                'NTFND'.          00980016
001919     05  PC-TBL-MAX               PIC 9(03)   VALUE 250.          00990016
001920     05  PC-AREA-DMM              PIC X(03)   VALUE 'DMM'.        01000016
001921     05  PC-AREA-ANAL             PIC X(15)   VALUE               01010016
001922                                              'ANALIST MGR'.      01020016
001923     05  PC-PROCESS-AREA          PIC X(12)   VALUE               01030016
001924                                              'PROCESS AREA'.     01040016
010000     05  PC-MONTHLY               PIC X(13) VALUE '      MONTHLY'.01000002
010100     05  PC-WEEKLY                PIC X(13) VALUE '       WEEKLY'.01010002
010110     05  PC-FALL-SEASON           PIC X(13) VALUE '  FALL SEASON'.01010002
010120     05  PC-SPRING-SEASON         PIC X(13) VALUE 'SPRING SEASON'.01010002
010130     05  PC-FISCAL-YEAR           PIC X(13) VALUE 'FISCAL YEAR  '.01010002
010140     05  PC-CALENDAR-YEAR         PIC X(13) VALUE 'CALENDAR YEAR'.01010002
010200     05  PC-MONTH                 PIC X(11) VALUE '      MONTH'.  01020002
010300     05  PC-WEEK                  PIC X(11) VALUE '       WEEK'.  01030002
010310     05  PC-SEASON                PIC X(11) VALUE '     SEASON'.  01030002
010320     05  PC-FISCAL-YR             PIC X(11) VALUE '  FISCAL YR'.  01030002
010330     05  PC-CALENDAR-YR           PIC X(11) VALUE 'CALENDAR YR'.  01030002
001929     05  PC-AVERAGE               PIC X(07)   VALUE 'AVERAGE'.    01090016
001930     05  PC-TIME-TO-RESOLVE       PIC X(15)   VALUE               01100016
001931                                         'TIME TO RESOLVE'.       01110016
001932  01 PV-PROGRAM-VARIABLES.                                        01120016
001933     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01130016
001934                                                   COMP SYNC.     01140016
001935     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01150016
001935     05  PV-ABEND-SQLCODE            PIC  X(10)    VALUE SPACES.  01150016
001936     05  PV-BUY-LINE-COUNT           PIC S9(04)    VALUE +80      01160020
001937                                                   COMP SYNC.     01170016
001938     05  PV-MER-LINE-COUNT           PIC S9(04)    VALUE +80      01180020
001939                                                   COMP SYNC.     01190020
001940     05  PV-LOG-LINE-COUNT           PIC S9(04)    VALUE +80      01200020
001941                                                   COMP SYNC.     01210020
001942     05  PV-BUY-PAGE-COUNT           PIC S9(04)    VALUE 0        01220020
001943                                                   COMP SYNC.     01230020
001944     05  PV-MER-PAGE-COUNT           PIC S9(04)    VALUE 0        01231020
001945                                                   COMP SYNC.     01232020
001946     05  PV-LOG-PAGE-COUNT           PIC S9(04)    VALUE 0        01233020
001947                                                   COMP SYNC.     01234020
001948     05  PV-TOP-TRBLS-COUNT          PIC S9(04)    VALUE 1.       01240020
001951     05  PV-VER-REC-COUNT            PIC S9(04)    VALUE 0.       01250020
001952     05  PV-DETAIL-COUNT             PIC S9(10)    VALUE 0        01260020
001953                                                   COMP-3.        01270020
001954     05  PV-CURRENT-DATE             PIC  X(10)    VALUE SPACE.   01280020
001954     05  PV-START-DATE               PIC  X(08)    VALUE SPACE.   01280020
001955     05  PV-END-DATE                 PIC  X(08)    VALUE SPACE.   01290020
001956     05  PV-START-EXTRACT.                                        01300020
001957         10 PV-START-YYYY.                                        01310020
001958            15 PV-START-CC           PIC 9(02)     VALUE 0.       01320020
001959            15 PV-START-YY           PIC 9(02)     VALUE 0.       01330020
001960         10 FILLER                   PIC X(01)     VALUE SPACE.   01340020
001961         10 PV-START-MM              PIC 9(02)     VALUE 0.       01350020
001962         10 FILLER                   PIC X(01)     VALUE SPACE.   01360020
001963         10 PV-START-DD              PIC 9(02)     VALUE 0.       01370020
001964         10 FILLER                   PIC X(01)     VALUE SPACE.   01380020
001965     05  PV-START-EXTRACT-MMDDYY.                                 01390020
001966         10 PV-START-EXTR-MM         PIC 9(02)     VALUE 0.       01400020
001967         10 PV-START-EXTR-DD         PIC 9(02)     VALUE 0.       01410020
001968         10 PV-START-EXTR-YY         PIC 9(02)     VALUE 0.       01420020
001969     05  PV-END-EXTRACT.                                          01430020
001970         10 PV-END-YYYY.                                          01440020
001971            15 PV-END-CC             PIC 9(02)     VALUE 0.       01450020
001972            15 PV-END-YY             PIC 9(02)     VALUE 0.       01460020
001973         10 FILLER                   PIC X(01)     VALUE SPACE.   01470020
001974         10 PV-END-MM                PIC 9(02)     VALUE 0.       01480020
001975         10 FILLER                   PIC X(01)     VALUE SPACE.   01490020
001976         10 PV-END-DD                PIC 9(02)     VALUE 0.       01500020
001977         10 FILLER                   PIC X(01)     VALUE SPACE.   01510020
001978     05  PV-END-EXTRACT-MMDDYY.                                   01520020
001979         10 PV-END-EXTR-MM           PIC 9(02)     VALUE 0.       01530020
001980         10 PV-END-EXTR-DD           PIC 9(02)     VALUE 0.       01540020
001981         10 PV-END-EXTR-YY           PIC 9(02)     VALUE 0.       01550020
001982     05  PV-REPORT-DATE              PIC X(10)     VALUE SPACE.   01560020
001983     05  PV-AVG-TOT-HOURS            PIC 9(10)     VALUE 0.       01570020
001984     05  PV-AVG-TOT-MINUTES          PIC 9(10)     VALUE 0.       01580020
001985     05  PV-AVG-MINUTES              PIC 9(10)     VALUE 0.       01590020
001986     05  PV-GMM-SAVE                PIC  X(02)   VALUE 'XX'.      01600020
001987     05  PV-DMM-SAVE                PIC  X(02)   VALUE SPACES.    01610020
001988     05  PV-DMM-NAME-SAVE           PIC  X(30)   VALUE 'XXXX'.    01620020
001989     05  PV-ANAL-NAME-SAVE          PIC  X(30)   VALUE 'XXXX'.    01630020
001990     05  PV-TRBL-RSN-CDE-DESC-SAVE  PIC  X(20)   VALUE SPACES.    01640020
001991     05  PV-FCLTY-AREA-ID-SAVE      PIC  X(06)   VALUE SPACES.    01650020
001992     05  PV-DC-NUMBER-SAVE          PIC  X(04)   VALUE 'XXXX'.    01660020
001993     05  PV-PO-NBR-SAVE             PIC S9(9)    VALUE 0 COMP.    01670020
001994     05  PV-REC-SEQ-NBR-SAVE        PIC S9(9)    VALUE 0 COMP.    01680020
001995     05  PV-TRBL-RSN-CDE-SAVE       PIC S9(4)    VALUE 0 COMP.    01690020
001996     05  PV-TOT-MDS-TRBL-SAVE       PIC S9(7)    VALUE 0 COMP-3.  01700020
001997     05  PV-TOT-LOG-TRBL-SAVE       PIC S9(7)    VALUE 0 COMP-3.  01710020
001998     05  PV-RSN-CDE-TOT-QTY-SAVE    PIC S9(7)    VALUE 0 COMP-3.  01720020
001999     05  PV-NOTIF-DATE-SAVE         PIC  X(8)    VALUE SPACES.    01730020
002000     05  PV-OPER-UNT-ID-HOLD         PIC 9(04)     VALUE 0.       01740020
002001     05  PV-OPER-UNT-ID-GROUP       PIC  X(04)   VALUE SPACES.    01750020
002004     05  PV-PER-TO-TOT              PIC 9(3)V99  VALUE 0 COMP-3.  01780020
002005     05  PV-PER-OF-VER-REC          PIC 9(3)V99  VALUE 0 COMP-3.  01790020
002006     05  PV-ANAL-NAME-HOLD          PIC X(30)    VALUE SPACES.    01800020
002007     05  PV-RPT-AREA-SAVE           PIC X(01)    VALUE 'B'.       01810020
002008         88 PV-AREA-SAVE-BUYING VALUE 'B'.                        01820020
002009         88 PV-AREA-SAVE-ANAL   VALUE 'A'.                        01830020
002010         88 PV-AREA-SAVE-DC     VALUE 'D'.                        01840020
002011     05  PV-HOLD-AREA.                                            01850020
002012         10 FILLER                 PIC X(02) VALUE SPACES.        01860020
002013         10 PV-DC-NUMBER           PIC 9(04) VALUE ZERO.          01870020
002014                                                                  01880020
002015 01  CT-CPU-TIME.                                                 01890020
002016     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    01900020
002017     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    01910020
002018     03  FILLER                      PIC  9(04)    VALUE ZERO.    01920020
002019                                                                  01930020
002020 01  CD-CPU-DATE.                                                 01940020
002021     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    01950020
002022     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    01960020
002023     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    01970020
002024                                                                  01980020
002025 01  PA-PROGRAM-ACCUMULATORS.                                     01990020
002026     05  PA-RESOLVE-HOURS            PIC  S9(10)  VALUE 0 COMP-3. 02000020
002027     05  PA-RESOLVE-MINUTES          PIC  S9(10)  VALUE 0 COMP-3. 02010020
002028     05  PA-TOT-TRBLS                PIC  S9(10)  VALUE 0 COMP-3. 02020020
002029     05  PA-TOT-OF-PRBLMS            PIC  S9(10)  VALUE 0 COMP-3. 02030020
002030     05  PA-NBR-OF-RESOLVED-TRBLS    PIC  S9(10)  VALUE 0 COMP-3. 02040020
002031                                                                  02050020
002032     COPY DPWS132O.                                               02060020
002033                                                                  02070020
002034 01  HL1-HEADING-LINE-1.                                          02080020
002035     05  FILLER                      PIC  X(02)    VALUE SPACES.  02090020
002036     05  HL1-SPECIAL-RUN-NOTE        PIC  X(27)    VALUE SPACES.  02100020
002037     05  FILLER                      PIC  X(24)    VALUE SPACES.  02110020
002038     05  HL1-REPORT-PERIOD           PIC  X(13)    VALUE SPACES.  02120020
002039     05  FILLER                      PIC  X(29)    VALUE          02130020
002040                                 ' DIVISIONAL SUMMARY          '. 02140020
002041     05  FILLER                      PIC  X(45)    VALUE SPACES.  02150020
020000 01  HL1-DATE-LINE-1.                                             02000000
020100     05  FILLER                      PIC  X(04)    VALUE '  * '.  02010000
020200     05  HL1-DATE-BEGIN-MM           PIC  X(02)    VALUE SPACES.  02020000
020300     05  FILLER                      PIC  X(01)    VALUE '/'.     02030000
020200     05  HL1-DATE-BEGIN-DD           PIC  X(02)    VALUE SPACES.  02020000
020300     05  FILLER                      PIC  X(01)    VALUE '/'.     02030000
020200     05  HL1-DATE-BEGIN-YYYY         PIC  X(04)    VALUE SPACES.  02020000
020300     05  FILLER                      PIC  X(03)    VALUE ' - '.   02030000
020200     05  HL1-DATE-END-MM             PIC  X(02)    VALUE SPACES.  02020000
020300     05  FILLER                      PIC  X(01)    VALUE '/'.     02030000
020200     05  HL1-DATE-END-DD             PIC  X(02)    VALUE SPACES.  02020000
020300     05  FILLER                      PIC  X(01)    VALUE '/'.     02030000
020200     05  HL1-DATE-END-YYYY           PIC  X(04)    VALUE SPACES.  02020000
020300     05  FILLER                      PIC  X(02)    VALUE ' *'.    02030000
020700     05  FILLER                      PIC  X(103)   VALUE SPACES.  02070000
002042                                                                  02160020
002043 01  HL2-HEADING-LINE-2.                                          02170020
002044     05  FILLER                      PIC  X(64)   VALUE SPACES.   02180020
002045     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  02190020
002046     05  FILLER                      PIC  X(32)   VALUE SPACES.   02200020
002047     05  HL2-AVERAGE                 PIC  X(07)   VALUE SPACES.   02210020
002048     05  FILLER                      PIC  X(36)   VALUE SPACES.   02220020
002049                                                                  02230020
002050 01  HL3-HEADING-LINE-3.                                          02240020
002051     05  FILLER                      PIC  X(06)    VALUE SPACES.  02250020
002052     05  FILLER                      PIC  X(04)    VALUE 'AREA'.  02260020
002053     05  FILLER                      PIC  X(49)    VALUE SPACE.   02270020
002054     05  FILLER                      PIC  X(16)    VALUE          02280020
002055                                              'TROUBLE CREATED '. 02290020
002056     05  FILLER                      PIC  X(05)    VALUE SPACES.  02300020
002057     05  FILLER                      PIC  X(10)    VALUE          02310020
002058                                                   '% TO TOTAL'.  02320020
002059     05  FILLER                      PIC  X(07)    VALUE SPACES.  02330020
002060     05  HL3-TIME-TO-RESOLVE         PIC  X(15)    VALUE SPACES.  02340020
002061     05  FILLER                      PIC  X(27)    VALUE SPACES.  02350020
002062                                                                  02360020
002063 01  HL4-HEADING-LINE-4.                                          02370020
002064     05  FILLER                      PIC  X(02)    VALUE SPACES.  02380020
002065     05  FILLER                      PIC  X(21)    VALUE          02390020
002066                                         'TOP 5 TROUBLE REASONS'. 02400020
002067     05  FILLER                      PIC  X(109)   VALUE SPACE.   02410020
002068                                                                  02420020
002069 01  HL5-HEADING-LINE-5.                                          02430020
002070     05  FILLER                      PIC  X(06)    VALUE SPACES.  02440020
002071     05  FILLER                      PIC  X(07)    VALUE          02450020
002072                                                     'TROUBLE'.   02460020
002073     05  FILLER                      PIC  X(34)    VALUE SPACE.   02470020
002074     05  FILLER                      PIC  X(08)    VALUE          02480020
002075                                                     'CREATED '.  02490020
002076     05  FILLER                      PIC  X(86)    VALUE SPACES.  02500020
002077                                                                  02510020
002078 01  HL6-HEADING-LINE-6.                                          02520020
002079     05  FILLER                      PIC  X(06)    VALUE SPACES.  02530020
002080     05  FILLER                      PIC  X(06)    VALUE 'REASON'.02540020
002081     05  FILLER                      PIC  X(08)    VALUE SPACE.   02550020
002082     05  FILLER                      PIC  X(19)    VALUE          02560020
002083                                            'TROUBLE DESCRIPTION'.02570020
002084     05  FILLER                      PIC  X(08)    VALUE SPACES.  02580020
002085     05  FILLER                      PIC  X(08)    VALUE          02590020
002086                                            'QUANTITY'.           02600020
002087     05  FILLER                      PIC  X(07)    VALUE SPACES.  02610020
002088     05  FILLER                      PIC  X(10)    VALUE          02620020
002089                                            '% TO TOTAL'.         02630020
002090     05  FILLER                      PIC  X(52)    VALUE SPACES.  02640020
002091 01  HL7-HEADING-LINE-7.                                          02650020
002092     05  FILLER                      PIC  X(64)   VALUE SPACES.   02660020
002093     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  02670020
002094     05  FILLER                      PIC  X(71)   VALUE SPACES.   02680020
002095                                                                  02690000
002096 01  HL9-HEADING-LINE-9.                                          02700000
002097     05  FILLER                      PIC  X(02)    VALUE SPACES.  02710000
002098     05  FILLER                      PIC  X(60)    VALUE SPACES.  02720000
002099     05  FILLER                      PIC  X(09)    VALUE          02730000
002100                                                    'LOGISTICS'.  02740000
002101     05  FILLER                      PIC  X(61)    VALUE SPACES.  02750000
002102                                                                  02760000
002103 01  HL10-HEADING-LINE-10.                                        02770000
002104     05  FILLER                      PIC  X(02)    VALUE SPACES.  02780000
002105     05  FILLER                      PIC  X(58)    VALUE SPACES.  02790000
002106     05  FILLER                      PIC  X(13)    VALUE          02800000
002107                                                'MERCHANDISING'.  02810000
002108     05  FILLER                      PIC  X(59)    VALUE SPACES.  02820000
002109                                                                  02830000
002110 01  HL11-HEADING-LINE-11.                                        02840000
002111     05  FILLER                      PIC  X(02)    VALUE SPACES.  02850000
002112     05  FILLER                      PIC  X(58)    VALUE SPACES.  02860000
002113     05  FILLER                      PIC  X(13)    VALUE          02870000
002114                                                '   BUYING    '.  02880000
002115     05  FILLER                      PIC  X(59)    VALUE SPACES.  02890000
002116                                                                  02900000
002117 01  HL12-HEADING-LINE-12.                                        02910000
002118     05  FILLER                      PIC  X(02)  VALUE SPACES.    02920000
002119     05  FILLER                      PIC  X(04)  VALUE  'GMM:'.   02930000
002120     05  FILLER                      PIC  X(02)  VALUE SPACES.    02940000
002121     05  HL12-GMM-NBR                PIC  X(03)  VALUE SPACES.    02950000
002122     05  FILLER                      PIC  X(03)  VALUE ' - '.     02960000
002123     05  HL12-GMM-NAME               PIC  X(30)  VALUE SPACES.    02970000
002124     05  FILLER                      PIC  X(98)  VALUE SPACES.    02980000
002125                                                                  02990000
002126 01  HL13-HEADING-LINE-13.                                        03000000
002127     05  FILLER                      PIC  X(02)  VALUE SPACES.    03010000
002128     05  FILLER                      PIC  X(03)  VALUE  'DC:'.    03020000
002129     05  FILLER                      PIC  X(02)  VALUE SPACE.     03030000
002130     05  HL13-DC-NAME                PIC  X(05)  VALUE SPACE.     03040000
002131     05  FILLER                      PIC  X(107) VALUE SPACES.    03050000
002132                                                                  03060000
002133 01  DL-DMM-INFO.                                                 03070000
002134     05  DL-DMM-AREA               PIC  X(03)    VALUE 'DMM'.     03080000
002135     05  FILLER                    PIC  X(08)    VALUE ' -      '.03090000
002136     05  DL-DMM-NBR                PIC  X(03)    VALUE SPACES.    03100000
002137     05  FILLER                    PIC  X(01)    VALUE SPACE.     03110000
002138                                                                  03120000
002139 01  DL-ANALYST-INFO.                                             03130000
002140     05  DL-ANALYST-AREA           PIC  X(11)    VALUE            03140000
002141                                   'ANALYST MGR'.                 03150000
002142     05  FILLER                    PIC  X(04)    VALUE ' -  '.    03160000
002143                                                                  03170000
002144 01  DL-PROCESS-AREA-INFO.                                        03180000
002145     05  DL-ANALYST-AREA           PIC  X(12)    VALUE            03190000
002146                                   'PROCESS AREA'.                03200000
002147     05  FILLER                    PIC  X(03)    VALUE ' - '.     03210000
002148                                                                  03220000
002149                                                                  03230000
002150 01  DL1-DETAIL-LINE-1.                                           03240000
002151     05  FILLER                      PIC  X(06)    VALUE SPACES.  03250000
002152     05  DL1-INFO                    PIC  X(15)    VALUE SPACES.  03260000
002153     05  DL1-NAME                    PIC  X(30)    VALUE SPACES.  03270000
002154     05  FILLER                      PIC  X(12)    VALUE SPACE.   03280000
002155     05  DL1-TOT-ASSIGNED-TRBLS      PIC  Z,ZZZ,ZZ9   VALUE ZEROS.      00
002156     05  FILLER                      PIC  X(12)    VALUE SPACE.   03300000
002157     05  DL1-PER-TO-TOT              PIC  ZZ9.99   VALUE ZEROS.   03310000
002158     05  FILLER                      PIC  X(14)    VALUE SPACE.   03320000
002159     05  DL1-AVG-TIME                PIC  X(06)    VALUE SPACE.   03330012
002160     05  FILLER                      PIC  X(24)    VALUE SPACE.   03340000
002161                                                                  03350012
002162 01  DL1-AVG-TIME-FIELDS.                                         03360012
002163     05  DL1-AVG-RESOLVE-HHH         PIC  Z(2)9    VALUE ZEROS.   03370012
002164     05  DL1-COLON                   PIC  X(01)    VALUE ':'.     03380012
002165     05  DL1-AVG-RESOLVE-MM          PIC  9(02)    VALUE ZEROS.   03390012
002166                                                                  03400000
002167 01  DL2-DETAIL-LINE-2.                                           03410000
002168     05  FILLER                      PIC  X(08)    VALUE SPACES.  03420000
002169     05  DL2-TROUBLE-NBR             PIC  Z(3)9    VALUE ZEROS.   03430000
002170     05  FILLER                      PIC  X(08)    VALUE SPACES.  03440000
002171     05  DL2-TROUBLE-DESCRIPTION     PIC  X(20)    VALUE SPACES.  03450000
002172     05  FILLER                      PIC  X(05)    VALUE SPACE.   03460000
002173     05  DL2-ASSIGNED-QTY            PIC  Z,ZZZ,ZZ9   VALUE ZEROS.      00
002174     05  FILLER                      PIC  X(11)    VALUE SPACE.   03480000
002175     05  DL2-PER-TO-TOTAL            PIC  ZZ9.99   VALUE ZEROS.   03490000
002176     05  FILLER                      PIC  X(61)    VALUE SPACE.   03500000
002177                                                                  03510000
002178 01  DL3-DETAIL-LINE-3.                                           03520000
002179     05  FILLER                      PIC  X(06)    VALUE SPACES.  03530000
002180     05  DL3-INFO                    PIC  X(15)    VALUE SPACES.  03540000
002181     05  DL3-NAME                    PIC  X(30)    VALUE SPACES.  03550000
002182     05  FILLER                      PIC  X(10)    VALUE SPACE.   03560000
002183     05  DL3-TOT-ASSIGNED-TRBLS      PIC  ZZ,ZZ9   VALUE ZEROS.   03570000
002184     05  FILLER                      PIC  X(72)    VALUE SPACE.   03580000
002185                                                                  03590000
002186 01  TL1-TOTAL-LINE-1.                                            03600000
002187     05  FILLER                      PIC X(02)  VALUE SPACES.     03610000
002188     05  FILLER                      PIC X(26)  VALUE             03620000
002189                                   'TOTAL TROUBLE CREATED FOR '.  03630000
002190     05  TL1-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     03640001
002191     05  FILLER                      PIC X(08)  VALUE ' ENDING'.  03650001
002192     05  TL1-DATE                    PIC X(10)  VALUE SPACES.     03660000
002193     05  FILLER                      PIC X(03)  VALUE ' - '.      03670000
002194     05  TL1-TROUBLE-TOTAL           PIC Z,ZZZ,ZZ9.               03680000
002195     05  FILLER                      PIC X(68)  VALUE SPACE.      03690000
002196                                                                  03700001
002197 01  TL2-TOTAL-LINE-2.                                            03710001
002198     05  FILLER                      PIC X(02)  VALUE SPACES.     03720001
002199     05  FILLER                      PIC X(33)  VALUE             03730001
002200                           'TOTAL NOTIFY TROUBLE CREATED FOR '.   03740001
002201     05  TL2-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     03750001
002202     05  FILLER                      PIC X(08)  VALUE ' ENDING'.  03760001
002203     05  TL2-DATE                    PIC X(10)  VALUE SPACES.     03770001
002204     05  FILLER                      PIC X(03)  VALUE ' - '.      03780001
002205     05  TL2-TROUBLE-TOTAL           PIC Z,ZZZ,ZZ9.               03790001
002206     05  FILLER                      PIC X(68)  VALUE SPACE.      03800001
002207                                                                  03810000
002208 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  03820000
002209                                                                  03830001
002210 01  ER-END-REPORT-LINE.                                          03840000
002211     05  FILLER                      PIC X(02)  VALUE SPACE.      03850000
002212     05  FILLER                      PIC X(16)  VALUE             03860000
002213                                     '** END REPORT **'.          03870000
002214     05  FILLER                      PIC X(116) VALUE SPACE.      03880000
002215                                                                  03890000
002216 01  PR-PRINT-FINAL.                                              03900000
002217     05  FILLER                      PIC X(53)  VALUE SPACES.     03910000
002218     05  FILLER                      PIC X(21)  VALUE             03920000
002219         '*** END OF REPORT ***'.                                 03930000
002220                                                                  03940000
002221     COPY DPWS004.                                                03950000
002222                                                                  03960000
002223     COPY TMRD001.                                                03970000
002225                                                                  03990000
002226*  COPYBOOK FOR LOCATION MODULE XLKUT071                          04000000
002227                                                                  04010000
002228     COPY XLWS071.                                                04020000
002231                                                                  04010000
002232*---------------------------------------------------------------* 04060000
002233*    DB2 AREA FOR COMMUNICATIONS                                * 04070000
002234*---------------------------------------------------------------* 04080000
002235     EXEC SQL                                                     04090000
002236          INCLUDE SQLCA                                           04100000
002237     END-EXEC.                                                    04110000
002238***************************************************************** 04120000
002239 PROCEDURE DIVISION.                                              04130000
002240***************************************************************** 04140000
002241                                                                  04150000
002242 0000-MAINLINE.                                                   04160000
002243***************************************************************** 04170000
002250*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 04180000
002260***************************************************************** 04190000
002270     PERFORM 1000-INITIALIZE.                                     04200000
002280                                                                  04210000
002290     SET PS-NOT-EOF   TO TRUE.                                    04220000
002300     PERFORM 2000-MAIN-PROCESS                                    04230000
002400           UNTIL  PS-EOF.                                         04240000
002600                                                                  04250000
002700     PERFORM 9000-END-PROCESS                  THRU 9000-EXIT.    04260000
002800                                                                  04270000
002900 0000-EXIT.  STOP RUN.                                            04280000
003000                                                                  04290000
003100 1000-INITIALIZE.                                                 04300000
003200      OPEN INPUT  TROUBLE-EXTRACT-FILE                            04310000
003300      OPEN OUTPUT DIV-TRBL-SUMUM-BUY-RPT                          04320020
003301                  DIV-TRBL-SUMUM-MER-RPT                          04321020
003302                  DIV-TRBL-SUMUM-LOG-RPT.                         04322020
003400**** READING THE HEADER RECORD.                                   04330000
003500      READ TROUBLE-EXTRACT-FILE    INTO                           04340000
003600                                  TM001-TROUBLE-EXT-RECORD        04350000
003700          AT END                                                  04360000
003800             SET PS-EOF TO TRUE                                   04370000
003900          NOT AT END                                              04380000
004000             MOVE TM001-RUN-BEGIN-DATE  TO PV-START-EXTRACT       04390000
004100             MOVE TM001-RUN-END-DATE    TO PV-END-EXTRACT         04400000
004200             STRING                                               04410000
004300                   PV-END-MM                                      04420015
004400                   '/'                                            04430000
004500                   PV-END-DD                                      04440015
004600                   '/'                                            04450000
004700                   PV-END-YYYY                                    04460015
004800                DELIMITED BY SIZE                                 04470000
004900                INTO PV-REPORT-DATE                               04480000
005000              END-STRING                                          04490000
005100             STRING                                               04500000
005200                   PV-START-YYYY                                  04510000
005300                   PV-START-MM                                    04520000
005400                   PV-START-DD                                    04530000
005500                DELIMITED BY SIZE                                 04540000
005600                INTO PV-START-DATE                                04550000
005700             END-STRING                                           04560000
005800             STRING                                               04570000
005900                   PV-END-YYYY                                    04580000
006000                   PV-END-MM                                      04590000
006100                   PV-END-DD                                      04600000
006200                DELIMITED BY SIZE                                 04610000
006300                INTO PV-END-DATE                                  04620000
006400             END-STRING                                           04630000
006500             MOVE PV-REPORT-DATE     TO TL1-DATE                  04640000
006600                                        TL2-DATE                  04650000
006700     END-READ.                                                    04660000
006800                                                                  04670000
006800** PV-CURRENT-DATE NOT USED EXCEPT TO KEEP PROGRAM DB2            04670000
006900     EXEC SQL                                                     04680000
007000         SET :PV-CURRENT-DATE = CURRENT DATE                      04690000
007100     END-EXEC.                                                    04700000
007200                                                                  04710000
006900     ACCEPT CT-CPU-TIME          FROM TIME.                       04680000
007000     MOVE   CT-HOUR              TO DP132O-RUN-HOUR.              04690000
007100     MOVE   CT-MINUTE            TO DP132O-RUN-MINUTE.            04700000
007200                                                                  04710000
007300     ACCEPT CD-CPU-DATE          FROM DATE.                       04720000
007400     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              04730000
007500     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             04740000
007600     MOVE CD-DAY                 TO DP132O-RUN-DAY.               04750000
007700                                                                  04760000
007800     MOVE 'TMKRP011'             TO DP132O-PROGRAM-NAME.          04770001
007900*    MOVE PC-ONE                 TO DP132O-REPORT-NUMBER          04780016
008000                                                                  04790000
008001     IF TM001-RUN-WEEKLY                                          04800001
008003        SET  PS-WEEKLY-RPT          TO TRUE                       04810016
008004*       MOVE PC-ONE                 TO DP132O-REPORT-NUMBER       04820016
008005        MOVE PC-WEEKLY              TO HL1-REPORT-PERIOD          04830001
008006        MOVE PC-WEEK                TO TL1-REPORT-PERIOD          04840001
008007                                       TL2-REPORT-PERIOD          04850001
008008     ELSE                                                         04860001
008009       IF TM001-RUN-MONTHLY                                       04870001
008010        SET  PS-MONTHLY-RPT         TO TRUE                       04880016
008011*       MOVE PC-TWO                 TO DP132O-REPORT-NUMBER       04890016
008012        MOVE PC-MONTHLY             TO HL1-REPORT-PERIOD          04900001
008013        MOVE PC-MONTH               TO TL1-REPORT-PERIOD          04910001
008014                                       TL2-REPORT-PERIOD          04920001
047000     ELSE                                                         04700000
047100       IF TM001-RUN-FISCAL-YR                                     04710006
047200*       MOVE PC-THREE               TO DP132O-REPORT-NUMBER       04720000
047300        MOVE PC-FISCAL-YEAR         TO HL1-REPORT-PERIOD          04730000
047400        MOVE PC-FISCAL-YR           TO TL1-REPORT-PERIOD          04740000
047500                                       TL2-REPORT-PERIOD          04750020
047000     ELSE                                                         04700000
047100       IF TM001-RUN-CALENDAR-YR                                   04710006
047200*       MOVE PC-FOUR                TO DP132O-REPORT-NUMBER       04720000
047300        MOVE PC-CALENDAR-YEAR       TO HL1-REPORT-PERIOD          04730000
047400        MOVE PC-CALENDAR-YR         TO TL1-REPORT-PERIOD          04740000
047500                                       TL2-REPORT-PERIOD          04750020
047000     ELSE                                                         04700000
047100       IF TM001-RUN-SEASONAL                                      04710006
              IF TM001-SPRING-SEASON                                            
047200*          MOVE PC-FIVE                TO DP132O-REPORT-NUMBER    04720000
047300           MOVE PC-SPRING-SEASON       TO HL1-REPORT-PERIOD       04730000
              ELSE                                                              
047200*          MOVE PC-SIX                 TO DP132O-REPORT-NUMBER    04720000
047300           MOVE PC-FALL-SEASON         TO HL1-REPORT-PERIOD       04730000
047700       END-IF                                                     04770006
047400        MOVE PC-SEASON              TO TL1-REPORT-PERIOD          04740000
047500                                       TL2-REPORT-PERIOD          04750020
047700             END-IF                                               04770006
047700           END-IF                                                 04770006
047700         END-IF                                                   04770006
008015       END-IF                                                     04930001
008020     END-IF                                                       04940001
008100     IF TM001-RUN-SPECIAL                                         04950000
008200        MOVE PC-SPECIAL-RUN-NOTE TO HL1-SPECIAL-RUN-NOTE          04960000
              SET PS-SPECIAL-RUN TO TRUE                                        
048100        MOVE PC-SPECIAL-RUN-NOTE TO HL1-SPECIAL-RUN-NOTE          04810000
              MOVE TM001-BEGIN-MM   TO HL1-DATE-BEGIN-MM                        
              MOVE TM001-BEGIN-DD   TO HL1-DATE-BEGIN-DD                        
              MOVE TM001-BEGIN-YYYY TO HL1-DATE-BEGIN-YYYY                      
              MOVE TM001-END-MM     TO HL1-DATE-END-MM                          
              MOVE TM001-END-DD     TO HL1-DATE-END-DD                          
              MOVE TM001-END-YYYY   TO HL1-DATE-END-YYYY                        
008300     ELSE                                                         04970000
008400        MOVE SPACE               TO HL1-SPECIAL-RUN-NOTE          04980000
008500     END-IF.                                                      04990000
008600                                                                  05000000
009000 1000-EXIT.  EXIT.                                                05010000
009100                                                                  05020000
009200 2000-MAIN-PROCESS.                                               05030000
009300      READ TROUBLE-EXTRACT-FILE    INTO                           05040000
009400                                  TM001-TROUBLE-EXT-RECORD        05050000
009500          AT END                                                  05060000
009800             SET PS-EOF TO TRUE                                   05070000
009900          NOT AT END                                              05080000
010000             EVALUATE TRUE                                        05090000
010100               WHEN TM001-RECORD-TYPE-BYGMMTOT                    05100000
010200               WHEN TM001-RECORD-TYPE-MDSTOT                      05110000
010300               WHEN TM001-RECORD-TYPE-BYDCTOT                     05120000
010400                  PERFORM 2100-START-REPORT         THRU 2100-EXIT05130000
010500               WHEN TM001-RECORD-TYPE-DETAIL                      05140000
010600                  PERFORM 2200-SUMMARY-AREAS-REPORTS              05150000
010700                                                   THRU 2200-EXIT 05160000
010800               WHEN TM001-RECORD-TYPE-RSNTOT                      05170000
010900                  IF PS-FIRST-CM-RECORD                           05180000
011000                     PERFORM 6000-WRITE-DETAIL-LINE               05190000
011100                                                THRU 6000-EXIT    05200000
011400                  END-IF                                          05210000
011500                  PERFORM 2300-TOP-TROUBLE-RPT      THRU 2300-EXIT05220000
011600             END-EVALUATE.                                        05230000
011700 2000-EXIT.  EXIT.                                                05240000
011800                                                                  05250000
011900 2100-START-REPORT.                                               05260000
012300     PERFORM 5100-RESET  THRU 5100-EXIT                           05270004
012400     EVALUATE TRUE                                                05280000
012500         WHEN TM001-RECORD-TYPE-BYGMMTOT                          05290000
012600              MOVE TM001-REPORT-GMM-NBR     TO HL12-GMM-NBR       05300004
012700              MOVE TM001-ATL-NAME           TO HL12-GMM-NAME      05310004
012800              SET  PS-AREA-BUYING           TO TRUE               05320004
012810              IF TM001-REPORT-GMM-NBR  NOT = PV-GMM-SAVE          05330004
012811                 MOVE TM001-REPORT-GMM-NBR  TO PV-GMM-SAVE        05340005
012820                 PERFORM 6910-PRINT-COMMON-HEADINGS               05350004
012830                                              THRU 6910-EXIT      05360004
012840              END-IF                                              05370004
012900         WHEN TM001-RECORD-TYPE-MDSTOT                            05380000
013000              SET PS-AREA-MERCH             TO TRUE               05390004
013001              IF PS-FIRST-MERCH-HEADER                            05400007
013010                 PERFORM 6910-PRINT-COMMON-HEADINGS               05410007
013020                                            THRU 6910-EXIT        05420007
013030                 SET PS-NOT-FIRST-MERCH-HEADER TO TRUE            05430007
013040              END-IF                                              05440007
013100         WHEN TM001-RECORD-TYPE-BYDCTOT                           05450000
013200              SET PS-AREA-LOGISTICS         TO TRUE               05460004
013210              MOVE TM001-TROUBLE-EXT-RECORD TO PV-HOLD-AREA       05470004
013220              IF PV-DC-NUMBER NOT = PV-DC-NUMBER-SAVE             05480004
013230                 PERFORM 6910-PRINT-COMMON-HEADINGS               05490004
013240                                              THRU 6910-EXIT      05500004
013241                 MOVE PV-DC-NUMBER   TO PV-DC-NUMBER-SAVE         05510004
013250              END-IF                                              05520004
013300     END-EVALUATE                                                 05530000
013500                                                                  05540000
013510     EVALUATE TRUE                                                05550001
013520         WHEN TM001-REPORT-TROUBLE                                05560001
013600            MOVE TM001-ATL-ASSIGN-TOT-QTY TO                      05570001
013700                                   TL1-TROUBLE-TOTAL              05580001
013800                                   PV-TOT-MDS-TRBL-SAVE           05590001
013900            EVALUATE TRUE                                         05600020
013901                WHEN PS-AREA-BUYING                               05600120
013902                     WRITE DIV-TRBL-SUMUM-BUY-REC                 05601020
014000                             FROM TL1-TOTAL-LINE-1                05610001
014100                                  AFTER ADVANCING 2 LINES         05620001
014200                     ADD 2   TO PV-BUY-LINE-COUNT                 05630020
014201                WHEN PS-AREA-MERCH                                05631020
014202                     WRITE DIV-TRBL-SUMUM-MER-REC                 05632020
014203                             FROM TL1-TOTAL-LINE-1                05633020
014204                                  AFTER ADVANCING 2 LINES         05634020
014205                     ADD 2   TO PV-MER-LINE-COUNT                 05635020
014206                WHEN PS-AREA-LOGISTICS                            05636020
014207                     WRITE DIV-TRBL-SUMUM-LOG-REC                 05637020
014208                             FROM TL1-TOTAL-LINE-1                05638020
014209                                  AFTER ADVANCING 2 LINES         05639020
014210                     ADD 2   TO PV-LOG-LINE-COUNT                 05639120
014211            END-EVALUATE                                          05639221
014212         WHEN TM001-REPORT-NOTIFY                                 05640021
014220            MOVE TM001-ATL-ASSIGN-TOT-QTY TO                      05650001
014230                                   TL2-TROUBLE-TOTAL              05660001
014240                                   PV-TOT-MDS-TRBL-SAVE           05670001
014241            EVALUATE TRUE                                         05671021
014242                WHEN PS-AREA-BUYING                               05672021
014250                     WRITE DIV-TRBL-SUMUM-BUY-REC                 05680021
014260                             FROM TL2-TOTAL-LINE-2                05690001
014270                                  AFTER ADVANCING 4 LINES         05700006
014280                     ADD 4   TO PV-BUY-LINE-COUNT                 05710021
014281                WHEN PS-AREA-MERCH                                05711021
014282                     WRITE DIV-TRBL-SUMUM-MER-REC                 05712021
014283                             FROM TL2-TOTAL-LINE-2                05713021
014284                                  AFTER ADVANCING 4 LINES         05714021
014285                     ADD 4   TO PV-MER-LINE-COUNT                 05715021
014286                WHEN PS-AREA-LOGISTICS                            05716021
014287                     WRITE DIV-TRBL-SUMUM-LOG-REC                 05717021
014288                             FROM TL2-TOTAL-LINE-2                05718021
014289                                  AFTER ADVANCING 4 LINES         05719021
014290                     ADD 4   TO PV-LOG-LINE-COUNT                 05719121
014291            END-EVALUATE                                          05719221
014292     END-EVALUATE.                                                05720001
014300 2100-EXIT.  EXIT.                                                05730000
014400                                                                  05740000
028100 2150-GET-DC-NAME.                                                09920000
028300     INITIALIZE XL071-COMMAREA-REC.                               09930000
028400     MOVE PV-DC-NUMBER         TO XL071-LOCATION-NUMBER.          09940000
028500                                                                  09950000
028600     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         09960000
028700                                                                  09970000
028910     EVALUATE TRUE                                                10000000
028920         WHEN XL071-NO-ERRORS                                     10010000
028930             MOVE XL071-LOC-5-ABBR-NM TO HL13-DC-NAME             10020000
028940         WHEN XL071-LOC-NOT-FOUND                                 10030000
028950         WHEN XL071-SQLCODE-N = -904                              10040000
028960         WHEN XL071-SQLCODE-N = -913                              10050000
028970             MOVE PC-NOT-FOUND   TO HL13-DC-NAME                  10060000
028980         WHEN XL071-BAD-DB2-RETURN                                10070000
028990             MOVE XL071-SQLCODE TO PV-ABEND-SQLCODE               10080000
029010              DISPLAY '** ABEND ** IN TMKRP011'                   10100001
029020              DISPLAY 'PARAGRAPH:2150-GET-DC-NAME'                10110000
029020              DISPLAY 'SQLCODE  :  ' PV-ABEND-SQLCODE             10110000
029030              DISPLAY                                             10120000
029040             'MESSAGE:  SQL ERROR SELECTING FROM XLT_LOC'         10130000
029050              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             10140000
029060     END-EVALUATE.                                                10150000
029070 2150-EXIT.  EXIT.                                                10160000
014400                                                                  05740000
014500 2200-SUMMARY-AREAS-REPORTS.                                      05750000
014600     SET   PS-TROUBLE-ASSIGNED-RPT    TO TRUE.                    05760000
014700                                                                  05770000
014701     EVALUATE TRUE                                                05771021
014702         WHEN PS-AREA-BUYING                                      05772021
014800              IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT                05780021
014900                  PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT     05790021
015000              END-IF                                              05800021
015001         WHEN PS-AREA-MERCH                                       05800121
015002              IF PV-MER-LINE-COUNT > PC-LINE-LIMIT                05800221
015003                  PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT     05800321
015004              END-IF                                              05800421
015005         WHEN PS-AREA-LOGISTICS                                   05800521
015006              IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT                05800621
015007                  PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT     05800721
015008              END-IF                                              05800821
015009     END-EVALUATE.                                                05801021
015100                                                                  05810000
015200     EVALUATE TRUE                                                05820000
015300         WHEN PS-AREA-BUYING                                      05830000
015400              PERFORM 2210-DMM-TOTALS THRU 2210-EXIT              05840000
015500         WHEN PS-AREA-MERCH                                       05850000
015600              PERFORM 2220-ANAL-TOTALS THRU 2220-EXIT             05860000
015700         WHEN PS-AREA-LOGISTICS                                   05870000
015800              PERFORM 2250-DC-TOTALS    THRU 2250-EXIT            05880000
015900     END-EVALUATE.                                                05890000
016000                                                                  05900000
016100     IF TM001-PO-NBR       NOT = PV-PO-NBR-SAVE                   05910000
016200         MOVE TM001-PO-NBR       TO PV-PO-NBR-SAVE                05920000
016300     END-IF.                                                      05930000
016400     IF TM001-REC-SEQ-NBR  NOT = PV-REC-SEQ-NBR-SAVE              05940000
016500         MOVE TM001-REC-SEQ-NBR  TO PV-REC-SEQ-NBR-SAVE           05950000
016600     END-IF.                                                      05960000
016700     IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE             05970000
016800         MOVE TM001-TRBL-RSN-CDE TO PV-TRBL-RSN-CDE-SAVE          05980000
016900         MOVE TM001-TRBL-RSN-CDE-DESC                             05990000
017000                                 TO PV-TRBL-RSN-CDE-DESC-SAVE     06000000
017100     END-IF.                                                      06010000
017200     IF (TM001-NOTIF-DATE  NOT = PV-NOTIF-DATE-SAVE)              06020000
017300         MOVE TM001-NOTIF-DATE TO PV-NOTIF-DATE-SAVE              06030000
017400     END-IF.                                                      06040000
017500 2200-EXIT.  EXIT.                                                06050000
017600                                                                  06060000
017700 2210-DMM-TOTALS.                                                 06070000
017800     IF TM001-DMM-NBR NOT = PV-DMM-SAVE                           06080000
017900        IF NOT PS-FIRST-DMM                                       06090000
018000          PERFORM 6000-WRITE-DETAIL-LINE        THRU 6000-EXIT    06100000
018200        END-IF                                                    06110000
018300        MOVE 0    TO PA-RESOLVE-HOURS                             06120000
018400                     PA-RESOLVE-MINUTES                           06130000
018500                     PV-AVG-MINUTES                               06140000
018600                     PA-NBR-OF-RESOLVED-TRBLS                     06150000
018700                     PV-AVG-TOT-HOURS                             06160000
018800                     PV-AVG-TOT-MINUTES                           06170000
018900                     PA-TOT-OF-PRBLMS                             06180000
019000                     PA-TOT-TRBLS                                 06190000
019100        IF PS-FIRST-DMM                                           06200000
019200           PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT   06210000
019300           SET PS-NOT-FIRST-DMM                    TO TRUE        06220000
019400        END-IF                                                    06230000
019500        MOVE TM001-DMM-NBR     TO PV-DMM-SAVE                     06240000
019600        MOVE TM001-DMM-NAME    TO PV-DMM-NAME-SAVE                06250000
019700     END-IF                                                       06260000
019800                                                                  06270000
019900     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             06280000
020000 2210-EXIT.  EXIT.                                                06290000
020100                                                                  06300000
020200 2220-ANAL-TOTALS.                                                06310000
020300     IF TM001-ANALYST-MGR-NAME NOT = PV-ANAL-NAME-SAVE            06320000
020400        IF NOT PS-FIRST-ANAL                                      06330000
020500           PERFORM 6000-WRITE-DETAIL-LINE         THRU 6000-EXIT  06340000
020700        END-IF                                                    06350000
020800        MOVE 0    TO PA-RESOLVE-HOURS                             06360000
020900                     PA-RESOLVE-MINUTES                           06370000
021000                     PV-AVG-MINUTES                               06380000
021100                     PA-NBR-OF-RESOLVED-TRBLS                     06390000
021200                     PV-AVG-TOT-HOURS                             06400000
021300                     PV-AVG-TOT-MINUTES                           06410000
021400                     PA-TOT-OF-PRBLMS                             06420000
021500                     PA-TOT-TRBLS                                 06430000
021600        IF PS-FIRST-ANAL                                          06440000
021700           PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT   06450000
021800           SET PS-NOT-FIRST-ANAL                   TO TRUE        06460000
021900        END-IF                                                    06470000
022000        MOVE TM001-ANALYST-MGR-NAME  TO PV-ANAL-NAME-SAVE         06480000
022100     END-IF                                                       06490000
022200                                                                  06500000
022300     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             06510000
022400 2220-EXIT.  EXIT.                                                06520000
022500                                                                  06530000
022600 2250-DC-TOTALS.                                                  06540000
022700     IF TM001-FCLTY-AREA-ID NOT = PV-FCLTY-AREA-ID-SAVE           06550000
022800        IF NOT PS-FIRST-PROCESS-AREA                              06560000
022900           PERFORM 6000-WRITE-DETAIL-LINE         THRU 6000-EXIT  06570000
023100        END-IF                                                    06580000
023200        MOVE 0    TO PA-RESOLVE-HOURS                             06590000
023300                     PA-RESOLVE-MINUTES                           06600000
023400                     PV-AVG-MINUTES                               06610000
023500                     PA-NBR-OF-RESOLVED-TRBLS                     06620000
023600                     PV-AVG-TOT-HOURS                             06630000
023700                     PV-AVG-TOT-MINUTES                           06640000
023800                     PA-TOT-OF-PRBLMS                             06650000
023810                     PA-TOT-TRBLS                                 06660000
023820        IF PS-FIRST-PROCESS-AREA                                  06670000
023830           PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT   06680000
023840           SET PS-NOT-FIRST-PROCESS-AREA           TO TRUE        06690000
023850        END-IF                                                    06700000
023860        MOVE TM001-FCLTY-AREA-ID     TO PV-FCLTY-AREA-ID-SAVE     06710000
023861     END-IF                                                       06720000
023862                                                                  06730000
023863     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             06740000
023864 2250-EXIT.  EXIT.                                                06750000
023865                                                                  06760000
023866 2215-ACCUMULATE-TOTALS.                                          06770000
023867     IF TM001-NOTIF-DATE       <= PV-END-DATE     AND             06780000
023868        TM001-NOTIF-DATE       >= PV-START-DATE   AND             06790000
023869         ((TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR      06800000
023870          (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR      06810000
023871          (TM001-NOTIF-DATE   NOT = PV-NOTIF-DATE-SAVE)   OR      06820000
023872          (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE))       06830000
023873                                                                  06840000
023874        ADD 1   TO PA-TOT-TRBLS                                   06850000
023880     END-IF.                                                      06860000
023881                                                                  06870000
023882     IF TM001-RESOLVED-DATE    <= PV-END-DATE     AND             06880019
023883        TM001-RESOLVED-DATE    >= PV-START-DATE   AND             06890019
023884        TM001-RPT-RESOLVED                                        06900000
023885          ADD TM001-RESOLVED-HOURS    TO PA-RESOLVE-HOURS         06910000
023886          ADD TM001-RESOLVED-MINUTES  TO PA-RESOLVE-MINUTES       06920000
023887          ADD 1      TO PA-NBR-OF-RESOLVED-TRBLS                  06930000
023888     END-IF.                                                      06940000
023894 2215-EXIT.  EXIT.                                                06950000
023933 2300-TOP-TROUBLE-RPT.                                            06960000
023934     SET PS-TOP-TROUBLE-RPT    TO TRUE                            06970000
023935                                                                  06980000
023936     EVALUATE TRUE                                                06981021
023937         WHEN PS-AREA-BUYING                                      06982021
023938             IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT                 06990021
023939              PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT  07000021
023940             END-IF                                               07010021
023941         WHEN PS-AREA-MERCH                                       07011021
023942             IF PV-MER-LINE-COUNT > PC-LINE-LIMIT                 07012021
023943              PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT  07013021
023944             END-IF                                               07014021
023945         WHEN PS-AREA-LOGISTICS                                   07015021
023946             IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT                 07016021
023947              PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT  07017021
023948             END-IF                                               07018021
023949     END-EVALUATE.                                                07019021
023950                                                                  07020000
023951     IF PS-FIRST-CM-RECORD                                        07030000
023952         PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT     07040000
023953         SET PS-NOT-FIRST-CM-RECORD  TO TRUE                      07050000
023954     END-IF.                                                      07060000
023955                                                                  07070000
023956     IF PV-TOP-TRBLS-COUNT < 6                                    07080000
023957        IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE          07090000
023958          IF TM001-RTL-RSN-CDE-TOT-QTY > 0                        07100008
023959              PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT     07110008
023960              IF PV-TOP-TRBLS-COUNT = 5                           07120008
023961                 MOVE TM001-RTL-RSN-CDE-TOT-QTY TO                07130008
023962                                         PV-RSN-CDE-TOT-QTY-SAVE  07140008
023963              END-IF                                              07150008
023964              ADD  1  TO PV-TOP-TRBLS-COUNT                       07160008
023965          END-IF                                                  07170021
023966        END-IF                                                    07180021
023967     ELSE                                                         07190000
023968       IF TM001-RTL-RSN-CDE-TOT-QTY = PV-RSN-CDE-TOT-QTY-SAVE     07200000
023969          IF TM001-RTL-RSN-CDE-TOT-QTY > 0                        07210008
023970             ADD  1  TO PV-TOP-TRBLS-COUNT                        07220008
023971             PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT      07230008
023972          END-IF                                                  07240008
023973       END-IF                                                     07250000
023974     END-IF.                                                      07260000
023975 2300-EXIT.  EXIT.                                                07270000
023976                                                                  07280000
023977 5100-RESET.                                                      07290000
023978     MOVE ' '   TO PS-REPORT-SW                                   07300000
023979                   PS-AREA-SW                                     07310000
023980     SET  PS-NOT-FIRST-TIME-THRU   TO TRUE                        07320000
023981     SET  PS-FIRST-DMM             TO TRUE                        07330000
023982     SET  PS-FIRST-ANAL            TO TRUE                        07340000
023983     SET  PS-FIRST-PROCESS-AREA    TO TRUE                        07350000
023984     SET  PS-FIRST-CM-RECORD       TO TRUE                        07360000
023985     MOVE 1  TO PV-TOP-TRBLS-COUNT.                               07370000
023986     MOVE 0  TO PV-DETAIL-COUNT.                                  07380000
023987 5100-EXIT.  EXIT.                                                07390000
024023                                                                  07400000
024024 6000-WRITE-DETAIL-LINE.                                          07410000
024025     EVALUATE TRUE                                                07420021
024026         WHEN PS-AREA-BUYING                                      07420121
024027             IF PV-BUY-LINE-COUNT > PC-LINE-LIMIT                 07421021
024028                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      07430021
024029             END-IF                                               07440021
024030         WHEN PS-AREA-MERCH                                       07440121
024031             IF PV-MER-LINE-COUNT > PC-LINE-LIMIT                 07440221
024032                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      07440321
024033             END-IF                                               07440421
024034         WHEN PS-AREA-LOGISTICS                                   07440521
024035             IF PV-LOG-LINE-COUNT > PC-LINE-LIMIT                 07440621
024036                 PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT      07440721
024037             END-IF                                               07440821
024038     END-EVALUATE                                                 07441021
024039                                                                  07450000
024040     EVALUATE TRUE                                                07460000
024041        WHEN PS-TROUBLE-ASSIGNED-RPT                              07470000
024042          IF TM001-REPORT-TROUBLE                                 07480013
024043             PERFORM 6200-CALC-AVG-RESOLVE-TIME THRU 6200-EXIT    07490012
024044             IF   PA-TOT-TRBLS        = 0  AND                    07500012
024045                  PV-AVG-TOT-HOURS    = 0  AND                    07510012
024046                  PV-AVG-TOT-MINUTES  = 0                         07520012
024047                  GO TO 6000-EXIT                                 07530012
024048             END-IF                                               07540012
024049         ELSE                                                     07550012
024050             MOVE SPACE TO DL1-AVG-TIME                           07560012
024051         END-IF                                                   07570012
024052         PERFORM 6100-SET-UP-INFO-PART THRU 6100-EXIT             07580000
024053         MOVE PA-TOT-TRBLS      TO DL1-TOT-ASSIGNED-TRBLS         07590000
024054         IF PV-TOT-MDS-TRBL-SAVE > 0                              07600000
024055            COMPUTE PV-PER-TO-TOT = PA-TOT-TRBLS * 100 /          07610000
024056                                           PV-TOT-MDS-TRBL-SAVE   07620000
024060         ELSE                                                     07630000
024061            MOVE 0   TO PV-TOT-MDS-TRBL-SAVE                      07640000
024062         END-IF                                                   07650000
024063         MOVE PV-PER-TO-TOT     TO DL1-PER-TO-TOT                 07660000
024064         EVALUATE TRUE                                            07670021
024065             WHEN PS-AREA-BUYING                                  07671021
024066                 WRITE DIV-TRBL-SUMUM-BUY-REC                     07672021
024067                      FROM DL1-DETAIL-LINE-1                      07680021
024068                          AFTER ADVANCING 1 LINE                  07690021
024069                 ADD 1   TO PV-BUY-LINE-COUNT                     07700021
024070             WHEN PS-AREA-MERCH                                   07701021
024071                 WRITE DIV-TRBL-SUMUM-MER-REC                     07702021
024072                      FROM DL1-DETAIL-LINE-1                      07703021
024073                          AFTER ADVANCING 1 LINE                  07704021
024074                 ADD 1   TO PV-MER-LINE-COUNT                     07705021
024075             WHEN PS-AREA-LOGISTICS                               07706021
024076                 WRITE DIV-TRBL-SUMUM-LOG-REC                     07707021
024077                      FROM DL1-DETAIL-LINE-1                      07708021
024078                          AFTER ADVANCING 1 LINE                  07709021
024079                 ADD 1   TO PV-LOG-LINE-COUNT                     07709121
024080         END-EVALUATE                                             07709221
024081        WHEN PS-TOP-TROUBLE-RPT                                   07710021
024082         MOVE TM001-RTL-TRBL-RSN-CDE    TO DL2-TROUBLE-NBR        07720000
024083         MOVE TM001-RTL-TRBL-RSN-CDE-DESC                         07730000
024084                                        TO DL2-TROUBLE-DESCRIPTION07740000
024085         MOVE TM001-RTL-RSN-CDE-TOT-QTY TO DL2-ASSIGNED-QTY       07750000
024086         IF PV-TOT-MDS-TRBL-SAVE > 0                              07760003
024087            COMPUTE PV-PER-TO-TOT = TM001-RTL-RSN-CDE-TOT-QTY *   07770005
024088                                100 /  PV-TOT-MDS-TRBL-SAVE       07780005
024089         ELSE                                                     07790003
024090            MOVE 0   TO PV-PER-TO-TOT                             07800003
024091         END-IF                                                   07810003
024092         MOVE PV-PER-TO-TOT            TO DL2-PER-TO-TOTAL        07820000
024093                                                                  07830000
024094         EVALUATE TRUE                                            07831021
024095             WHEN PS-AREA-BUYING                                  07832021
024096                  WRITE DIV-TRBL-SUMUM-BUY-REC                    07840021
024097                        FROM DL2-DETAIL-LINE-2                    07850021
024098                             AFTER ADVANCING 1 LINE               07860021
024099                  ADD 1   TO PV-BUY-LINE-COUNT                    07870021
024100             WHEN PS-AREA-MERCH                                   07871021
024101                  WRITE DIV-TRBL-SUMUM-MER-REC                    07872021
024102                        FROM DL2-DETAIL-LINE-2                    07873021
024103                             AFTER ADVANCING 1 LINE               07874021
024104                  ADD 1   TO PV-MER-LINE-COUNT                    07875021
024105             WHEN PS-AREA-LOGISTICS                               07876021
024106                  WRITE DIV-TRBL-SUMUM-LOG-REC                    07877021
024107                        FROM DL2-DETAIL-LINE-2                    07878021
024108                             AFTER ADVANCING 1 LINE               07879021
024109                  ADD 1   TO PV-LOG-LINE-COUNT                    07879121
024110         END-EVALUATE                                             07880021
024111     END-EVALUATE.                                                07882021
024112                                                                  07890000
024113 6000-EXIT.  EXIT.                                                07900000
024114                                                                  07910000
024115 6100-SET-UP-INFO-PART.                                           07920000
024116      EVALUATE TRUE                                               07930000
024117         WHEN PS-AREA-BUYING                                      07940000
024118            MOVE PV-DMM-SAVE       TO DL-DMM-NBR                  07950000
024119            MOVE DL-DMM-INFO       TO DL1-INFO                    07960000
024120            MOVE PV-DMM-NAME-SAVE  TO DL1-NAME                    07970000
024121            IF NOT PS-FIRST-CM-RECORD                             07980000
024122               MOVE TM001-DMM-NAME    TO DL1-NAME                 07990000
024123            ELSE                                                  08000000
024124               MOVE PV-DMM-NAME-SAVE  TO DL1-NAME                 08010000
024125            END-IF                                                08020000
024126         WHEN PS-AREA-MERCH                                       08030000
024127           MOVE DL-ANALYST-INFO   TO DL1-INFO                     08040000
024128           IF NOT PS-FIRST-CM-RECORD                              08050000
024129              MOVE TM001-ANALYST-MGR-NAME  TO DL1-NAME            08060000
024130           ELSE                                                   08070000
024131              MOVE PV-ANAL-NAME-SAVE TO DL1-NAME                  08080000
024132           END-IF                                                 08090000
024133         WHEN PS-AREA-LOGISTICS                                   08100000
024134           MOVE DL-PROCESS-AREA-INFO TO DL1-INFO                  08110000
024135           IF NOT PS-FIRST-CM-RECORD                              08120000
024136              MOVE TM001-FCLTY-AREA-ID     TO DL1-NAME            08130000
024137           ELSE                                                   08140000
024138              MOVE PV-FCLTY-AREA-ID-SAVE   TO DL1-NAME            08150000
024139           END-IF                                                 08160000
024140           CONTINUE                                               08170000
024141     END-EVALUATE.                                                08180000
024142 6100-EXIT.  EXIT.                                                08190000
024143                                                                  08200000
024144 6200-CALC-AVG-RESOLVE-TIME.                                      08210000
024145       INITIALIZE                                                 08220000
024146                  DL1-AVG-RESOLVE-HHH                             08230000
024147                  DL1-AVG-RESOLVE-MM.                             08240000
024148                                                                  08250000
024149        IF PA-RESOLVE-HOURS          = 0 AND                      08260000
024150           PA-RESOLVE-MINUTES        = 0 AND                      08270000
024151           PA-NBR-OF-RESOLVED-TRBLS  = 0                          08280000
024152           MOVE 0   TO PV-AVG-TOT-HOURS                           08290000
024153           MOVE 0   TO PV-AVG-TOT-MINUTES                         08300000
024154       ELSE                                                       08310000
024155         MULTIPLY 60 BY PA-RESOLVE-HOURS                          08320000
024156         ADD PA-RESOLVE-HOURS TO PA-RESOLVE-MINUTES               08330000
024157         DIVIDE PA-RESOLVE-MINUTES                                08340000
024158                      BY PA-NBR-OF-RESOLVED-TRBLS                 08350000
024159                  GIVING PV-AVG-MINUTES ROUNDED                   08360000
024160                  ON SIZE ERROR                                   08370000
024161                       MOVE 0 TO PV-AVG-MINUTES                   08380000
024162         END-DIVIDE                                               08390000
024163                                                                  08400000
024164         DIVIDE PV-AVG-MINUTES BY 60                              08410000
024165                GIVING PV-AVG-TOT-HOURS                           08420000
024166                REMAINDER PV-AVG-TOT-MINUTES                      08430000
024167                ON SIZE ERROR                                     08440000
024168                      MOVE 0 TO PV-AVG-TOT-HOURS                  08450000
024169                                PV-AVG-TOT-MINUTES                08460000
024170         END-DIVIDE                                               08470000
024171      END-IF.                                                     08480000
024172                                                                  08490000
024173        MOVE PV-AVG-TOT-HOURS          TO DL1-AVG-RESOLVE-HHH     08500000
024174        MOVE PV-AVG-TOT-MINUTES        TO DL1-AVG-RESOLVE-MM.     08510000
024175        MOVE DL1-AVG-TIME-FIELDS       TO DL1-AVG-TIME.           08520012
024176                                                                  08530000
024177 6200-EXIT.  EXIT.                                                08540000
024178                                                                  08550000
024179 6900-PRINT-HEADINGS.                                             08560000
024180     PERFORM 6910-PRINT-COMMON-HEADINGS   THRU 6910-EXIT.         08570000
024181     PERFORM 6920-PRINT-SPECIFIC-HEADINGS THRU 6920-EXIT.         08580000
024182                                                                  08590000
024183 6900-EXIT.   EXIT.                                               08600000
024184*                                                                 08610000
024185 6910-PRINT-COMMON-HEADINGS.                                      08620000
024186                                                                  08660000
024187     EVALUATE TRUE                                                08670018
024188         WHEN PS-AREA-BUYING                                      08680018
024189             MOVE 0         TO PV-BUY-LINE-COUNT                  08681021
024190             ADD  1         TO PV-BUY-PAGE-COUNT                  08682021
024191             MOVE PV-BUY-PAGE-COUNT TO DP132O-PAGE-NUMBER         08683021
024192             IF PS-WEEKLY-RPT                                     08690021
024193                 MOVE PC-ONE    TO DP132O-REPORT-NUMBER           08700021
024194             ELSE                                                 08710021
024195                 MOVE PC-FOUR   TO DP132O-REPORT-NUMBER           08720021
024196             END-IF                                               08730021
024206             WRITE DIV-TRBL-SUMUM-BUY-REC                         08731021
024207                   FROM DP132O-STANDRD-HEADER-132-COLS            08732021
024208                        AFTER ADVANCING PAGE                      08733021
024210             WRITE DIV-TRBL-SUMUM-BUY-REC                         08735021
024211                   FROM HL1-HEADING-LINE-1                        08736021
024212                        AFTER ADVANCING 2 LINES                   08737021
048000             IF PS-SPECIAL-RUN                                    04800000
096300                 WRITE DIV-TRBL-SUMUM-BUY-REC                     09630002
096400                       FROM HL1-DATE-LINE-1                       09640000
096500                           AFTER ADVANCING 1 LINE                 09650000
024228                 ADD 1  TO PV-BUY-LINE-COUNT                      08739621
                   END-IF                                                       
024222             WRITE DIV-TRBL-SUMUM-BUY-REC                         08739021
024223                  FROM HL11-HEADING-LINE-11                       08739121
024224                       AFTER ADVANCING 1 LINES                    08739221
024225             WRITE DIV-TRBL-SUMUM-BUY-REC                         08739321
024226                  FROM HL12-HEADING-LINE-12                       08739421
024227                       AFTER ADVANCING 3 LINES                    08739521
024228             ADD 6  TO PV-BUY-LINE-COUNT                          08739621
024229         WHEN PS-AREA-MERCH                                       08740018
024230             MOVE 0         TO PV-MER-LINE-COUNT                  08741021
024231             ADD  1         TO PV-MER-PAGE-COUNT                  08742021
024232             MOVE PV-MER-PAGE-COUNT TO DP132O-PAGE-NUMBER         08743021
024233             IF PS-WEEKLY-RPT                                     08750021
024234                 MOVE PC-TWO    TO DP132O-REPORT-NUMBER           08760021
024235             ELSE                                                 08770021
024236                 MOVE PC-FIVE   TO DP132O-REPORT-NUMBER           08780021
024237             END-IF                                               08790021
024238             WRITE DIV-TRBL-SUMUM-MER-REC                         08791021
024239                   FROM DP132O-STANDRD-HEADER-132-COLS            08792021
024240                        AFTER ADVANCING PAGE                      08793021
024241             WRITE DIV-TRBL-SUMUM-MER-REC                         08794021
024242                   FROM HL1-HEADING-LINE-1                        08795021
024243                        AFTER ADVANCING 2 LINES                   08796021
048000             IF PS-SPECIAL-RUN                                    04800000
096300                 WRITE DIV-TRBL-SUMUM-MER-REC                     09630002
096400                       FROM HL1-DATE-LINE-1                       09640000
096500                           AFTER ADVANCING 1 LINE                 09650000
024228                 ADD 1  TO PV-MER-LINE-COUNT                      08739621
                   END-IF                                                       
024300             WRITE DIV-TRBL-SUMUM-MER-REC                         08798021
024400                  FROM HL10-HEADING-LINE-10                       08799021
024500                       AFTER ADVANCING 1 LINES                    08799121
024600             ADD 4  TO PV-MER-LINE-COUNT                          08799221
024601         WHEN PS-AREA-LOGISTICS                                   08800018
024602             MOVE 0         TO PV-LOG-LINE-COUNT                  08801021
024603             ADD  1         TO PV-LOG-PAGE-COUNT                  08802021
024604             MOVE PV-LOG-PAGE-COUNT TO DP132O-PAGE-NUMBER         08803021
024605             IF PS-WEEKLY-RPT                                     08810021
024606                 MOVE PC-THREE  TO DP132O-REPORT-NUMBER           08820021
024607             ELSE                                                 08830021
024608                 MOVE PC-SIX    TO DP132O-REPORT-NUMBER           08840021
024609             END-IF                                               08850021
024610             WRITE DIV-TRBL-SUMUM-LOG-REC                         08851021
024611                   FROM DP132O-STANDRD-HEADER-132-COLS            08852021
024612                        AFTER ADVANCING PAGE                      08853021
024613             WRITE DIV-TRBL-SUMUM-LOG-REC                         08854021
024614                   FROM HL1-HEADING-LINE-1                        08855021
024615                        AFTER ADVANCING 2 LINES                   08856021
048000             IF PS-SPECIAL-RUN                                    04800000
096300                 WRITE DIV-TRBL-SUMUM-LOG-REC                     09630002
096400                       FROM HL1-DATE-LINE-1                       09640000
096500                           AFTER ADVANCING 1 LINE                 09650000
024228                 ADD 1  TO PV-LOG-LINE-COUNT                      08739621
                   END-IF                                                       
024710             WRITE DIV-TRBL-SUMUM-LOG-REC                         08858021
024720                  FROM HL9-HEADING-LINE-9                         08859021
024730                       AFTER ADVANCING 1 LINES                    08859121
024750             PERFORM 2150-GET-DC-NAME  THRU 2150-EXIT             08859221
024760             WRITE DIV-TRBL-SUMUM-LOG-REC                         08859321
024770                  FROM HL13-HEADING-LINE-13                       08859421
024780                       AFTER ADVANCING 3 LINES                    08859521
024790             ADD 7  TO PV-LOG-LINE-COUNT                          08859621
024791     END-EVALUATE.                                                08860021
024792                                                                  08960000
024793 6910-EXIT.  EXIT.                                                09370000
024794                                                                  09380000
024795 6920-PRINT-SPECIFIC-HEADINGS.                                    09390000
024796     EVALUATE TRUE                                                09400000
024797        WHEN PS-TROUBLE-ASSIGNED-RPT                              09410000
024798            IF TM001-REPORT-TROUBLE                               09420013
024799              MOVE PC-AVERAGE         TO HL2-AVERAGE              09430012
024800              MOVE PC-TIME-TO-RESOLVE TO HL3-TIME-TO-RESOLVE      09440012
024801            ELSE                                                  09450012
024802              MOVE SPACES             TO HL2-AVERAGE              09460012
024803              MOVE SPACES             TO HL3-TIME-TO-RESOLVE      09470012
024804            END-IF                                                09480012
024805            EVALUATE TRUE                                         09481021
024806                WHEN PS-AREA-BUYING                               09482021
024807                     WRITE DIV-TRBL-SUMUM-BUY-REC                 09490021
024808                          FROM HL2-HEADING-LINE-2                 09500021
024809                               AFTER ADVANCING 2 LINES            09510021
024810                     WRITE DIV-TRBL-SUMUM-BUY-REC                 09520021
024900                          FROM HL3-HEADING-LINE-3                 09530021
025000                               AFTER ADVANCING 1 LINE             09540021
025010                     WRITE DIV-TRBL-SUMUM-BUY-REC                 09550021
025020                          FROM BL-BLANK-LINE                      09560021
025030                               AFTER ADVANCING 1 LINE             09570021
025040                     ADD 4  TO PV-BUY-LINE-COUNT                  09580021
025041                WHEN PS-AREA-MERCH                                09581021
025042                     WRITE DIV-TRBL-SUMUM-MER-REC                 09582021
025043                          FROM HL2-HEADING-LINE-2                 09583021
025044                               AFTER ADVANCING 2 LINES            09584021
025045                     WRITE DIV-TRBL-SUMUM-MER-REC                 09585021
025046                          FROM HL3-HEADING-LINE-3                 09586021
025047                               AFTER ADVANCING 1 LINE             09587021
025048                     WRITE DIV-TRBL-SUMUM-MER-REC                 09588021
025049                          FROM BL-BLANK-LINE                      09589021
025050                               AFTER ADVANCING 1 LINE             09589121
025051                     ADD 4  TO PV-MER-LINE-COUNT                  09589221
025052                WHEN PS-AREA-LOGISTICS                            09589321
025053                     WRITE DIV-TRBL-SUMUM-LOG-REC                 09589421
025054                          FROM HL2-HEADING-LINE-2                 09589521
025055                               AFTER ADVANCING 2 LINES            09589621
025056                     WRITE DIV-TRBL-SUMUM-LOG-REC                 09589721
025057                          FROM HL3-HEADING-LINE-3                 09589821
025058                               AFTER ADVANCING 1 LINE             09589921
025059                     WRITE DIV-TRBL-SUMUM-LOG-REC                 09590021
025060                          FROM BL-BLANK-LINE                      09590121
025061                               AFTER ADVANCING 1 LINE             09590221
025062                     ADD 4  TO PV-LOG-LINE-COUNT                  09590321
025063            END-EVALUATE                                          09590421
025064        WHEN PS-TOP-TROUBLE-RPT                                   09591021
025065            EVALUATE TRUE                                         09592021
025066                WHEN PS-AREA-BUYING                               09593021
025067                    WRITE DIV-TRBL-SUMUM-BUY-REC                  09600021
025070                         FROM HL4-HEADING-LINE-4                  09610021
025080                             AFTER ADVANCING 4 LINES              09620021
025090                    WRITE DIV-TRBL-SUMUM-BUY-REC                  09630021
025091                         FROM HL5-HEADING-LINE-5                  09640021
025092                             AFTER ADVANCING 2 LINES              09650021
025093                    WRITE DIV-TRBL-SUMUM-BUY-REC                  09660021
025094                         FROM HL6-HEADING-LINE-6                  09670021
025095                             AFTER ADVANCING 1 LINE               09680021
025096                    WRITE DIV-TRBL-SUMUM-BUY-REC                  09690021
025097                         FROM BL-BLANK-LINE                       09700021
025098                             AFTER ADVANCING 1 LINES              09710021
025099                    ADD 8  TO PV-BUY-LINE-COUNT                   09720021
025100                WHEN PS-AREA-MERCH                                09721021
025101                    WRITE DIV-TRBL-SUMUM-MER-REC                  09722021
025102                         FROM HL4-HEADING-LINE-4                  09723021
025103                             AFTER ADVANCING 4 LINES              09724021
025104                    WRITE DIV-TRBL-SUMUM-MER-REC                  09725021
025105                         FROM HL5-HEADING-LINE-5                  09726021
025106                             AFTER ADVANCING 2 LINES              09727021
025107                    WRITE DIV-TRBL-SUMUM-MER-REC                  09728021
025108                         FROM HL6-HEADING-LINE-6                  09729021
025109                             AFTER ADVANCING 1 LINE               09729121
025110                    WRITE DIV-TRBL-SUMUM-MER-REC                  09729221
025111                         FROM BL-BLANK-LINE                       09729321
025112                             AFTER ADVANCING 1 LINES              09729421
025113                    ADD 8  TO PV-MER-LINE-COUNT                   09729521
025114                WHEN PS-AREA-LOGISTICS                            09729621
025115                    WRITE DIV-TRBL-SUMUM-LOG-REC                  09729721
025116                         FROM HL4-HEADING-LINE-4                  09729821
025117                             AFTER ADVANCING 4 LINES              09729921
025118                    WRITE DIV-TRBL-SUMUM-LOG-REC                  09730021
025119                         FROM HL5-HEADING-LINE-5                  09730121
025120                             AFTER ADVANCING 2 LINES              09730221
025121                    WRITE DIV-TRBL-SUMUM-LOG-REC                  09730321
025122                         FROM HL6-HEADING-LINE-6                  09730421
025123                             AFTER ADVANCING 1 LINE               09730521
025124                    WRITE DIV-TRBL-SUMUM-LOG-REC                  09730621
025125                         FROM BL-BLANK-LINE                       09730721
025126                             AFTER ADVANCING 1 LINES              09730821
025127                    ADD 8  TO PV-LOG-LINE-COUNT                   09730921
026200            END-EVALUATE                                          09731022
026210     END-EVALUATE.                                                09732021
026300 6920-EXIT.  EXIT.                                                09740000
026400                                                                  09750000
026500 9000-END-PROCESS.                                                09760000
026600     WRITE DIV-TRBL-SUMUM-BUY-REC                                 09770021
026700           FROM ER-END-REPORT-LINE                                09780000
026800                AFTER ADVANCING 2 LINES.                          09790000
026801     WRITE DIV-TRBL-SUMUM-MER-REC                                 09791021
026802           FROM ER-END-REPORT-LINE                                09792021
026803                AFTER ADVANCING 2 LINES.                          09793021
026804     WRITE DIV-TRBL-SUMUM-LOG-REC                                 09794021
026805           FROM ER-END-REPORT-LINE                                09795021
026806                AFTER ADVANCING 2 LINES.                          09796021
026900                                                                  09800000
027000     CLOSE  TROUBLE-EXTRACT-FILE                                  09810000
027100            DIV-TRBL-SUMUM-BUY-RPT                                09820021
027101            DIV-TRBL-SUMUM-MER-RPT                                09821021
027102            DIV-TRBL-SUMUM-LOG-RPT.                               09822021
027200 9000-EXIT.  EXIT.                                                09830000
027300                                                                  09840000
027400 9999-SQL-ERROR.                                                  09850000
027500                                                                  09860000
027600     COPY DPPD004.                                                09870000
027700                                                                  09880000
027800     MOVE +4013 TO PV-ABEND-CODE.                                 09890000
027900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09900000
028000 9999-EXIT.   EXIT.                                               09910000
029080****************  END OF PROGRAM TMKRP011 SOURCE *************    10170021
