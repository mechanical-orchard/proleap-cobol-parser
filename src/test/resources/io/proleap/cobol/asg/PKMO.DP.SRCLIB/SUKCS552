000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS552.                                         00040000
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  FEBRUARY 2000.                                    00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    S552 - PO/RECEIVER CHECK-IN STATUS LIST.                   * 00110000
001200*                                                               * 00120000
001300*    THIS PROGRAM GENERATES A LIST OF PO/RECEIVERS THAT ARE     * 00130000
001400*    ASSOCIATED TO A TRIP ID OR SCAC,TRAILER THAT WAS           * 00140000
001500*    SELECTED FROM THE PREVIOUS LIST SCREEN OR THE CRIT SPEC    * 00150000
001600*    SCREEN.                                                    F 00160000
001700*                                                               * 00170000
001800*---------------------------------------------------------------* 00180000
001500*    CHANGES                                                     *00182003
      *    MADE BY: CHERI PARMLEY                                      *00183003
      *    DATE:    09/24/2014                                         *00184003
      *                                                                *00185003
      *    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00186003
      *    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/24/2014      *00187003
      *                                                                *00188003
001600*----------------------------------------------------------------*00188106
273427*    CHANGES                                                     *00188208
273427*    MADE BY: BARB SCHULTZ            CHG0273427                 *00188308
273427*    DATE:    08/15/2022                                         *00188408
273427*                                                                *00188508
273427*    CHANGED CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE*00188608
273427*    MAKING THE CALL DYNAMIC VS STATIC.                          *00188708
273427*                                                                *00188808
273427*    MADE BY: JEAN KURK               CHG0278099                 *00189109
273427*    DATE:    01/09/2023                                         *00189209
001120*    CHANGE CALL OF DPKCS030 TO BE DYNAMIC                        00189309
273427*----------------------------------------------------------------*00189408
001900 EJECT                                                            00190000
002000 ENVIRONMENT DIVISION.                                            00200000
002100                                                                  00210000
002200 DATA DIVISION.                                                   00220000
002300                                                                  00230000
002400 WORKING-STORAGE SECTION.                                         00240000
002500                                                                  00250000
002600 01  DK-DB2-KEYS.                                                 00260000
002700     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00270000
002800                                                    COMP.         00280000
002900     05  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00290000
003000                                                    COMP.         00300000
003100     05  DK-SCAC-ID                     PIC  X(04)  VALUE SPACE.  00310000
003200     05  DK-VEHICLE-NBR                 PIC  X(10)  VALUE SPACE.  00320000
003300     05  DK-SHIPT-ID                    PIC S9(09)  VALUE +0      00330000
003400                                                    COMP.         00340000
003500     05  DK-TRIP-ID                     PIC S9(09)  VALUE +0      00350000
003600                                                    COMP.         00360000
003700     05  DK-STATUS-CDE                  PIC  X(02)  VALUE SPACES. 00370000
003800     05  DK-STATUS-DTE                  PIC  X(10)  VALUE SPACES. 00380000
003900     05  DK-STATUS-TME                  PIC  X(08)  VALUE SPACES. 00390000
004000     05  DK-PO-NBR                      PIC S9(09)  COMP.         00400000
004100     05  DK-REC-SEQ-NBR                 PIC S9(09)  COMP.         00410000
004200                                                                  00420000
004300***************************************************************** 00430000
004400*    THESE FIELDS ARE USED TO BUILD THE TEMPORARY WORK TABLE      00440000
004500                                                                  00450000
004600 01  PS-TEMP-TABLE-SWITCHES.                                      00460000
004700     05  PS-TYPE-A-CSR-SW             PIC X(01) VALUE 'N'.        00470000
004800         88  PS-EOF-TYPE-A-NO                 VALUE 'N'.          00480000
004900         88  PS-EOF-TYPE-A-YES                VALUE 'Y'.          00490000
005000     05  PS-CHECKIN-CSR-SW             PIC X(01) VALUE 'N'.       00500000
005100         88  PS-EOF-CHECKIN-CSR-NO               VALUE 'N'.       00510000
005200         88  PS-EOF-CHECKIN-YES                  VALUE 'Y'.       00520000
005300     05  PS-TEMP-B-SWITCH              PIC X(01) VALUE 'N'.       00530000
005400         88  PS-TEMP-B-NO                        VALUE 'N'.       00540000
005500         88  PS-TEMP-B-YES                       VALUE 'Y'.       00550000
005600     05  PS-TEMP-PKSLIP-STAT-SW       PIC X(01)  VALUE 'N'.       00560000
005700         88  PS-TEMP-PKSLIP-DELETED-NO           VALUE 'N'.       00570000
005800         88  PS-TEMP-PKSLIP-DELETED-YES          VALUE 'Y'.       00580000
005900                                                                  00590000
006000 01  PV-TEMP-TABLE-VARIABLES.                                     00600000
006100     05  PV-TEMP-PO-NBR               PIC S9(09) COMP VALUE ZERO. 00610000
006200     05  PV-TEMP-REC-SEQ-NBR          PIC S9(09) COMP VALUE ZERO. 00620000
006300     05  PV-TEMP-STATUS-CDE           PIC X(02)       VALUE SPACE.00630000
006400     05  PV-TEMP-SCREEN-SEQUENCE      PIC S9(04) COMP VALUE ZERO. 00640000
006500     05  PV-TEMP-UNION-TYPE           PIC X(01)       VALUE SPACE.00650000
006600     05  PV-TEMP-SHIPT-UNT-ID         PIC S9(18)V COMP-3          00660000
006700                                                      VALUE ZERO. 00670000
006800     05  PV-TEMP-SEQ-NBR              PIC S9(04) COMP VALUE ZERO. 00680000
006900     05  PV-TEMP-PO-NULL              PIC S9(04) COMP VALUE ZERO. 00690000
007000     05  PV-TEMP-SEQ-NULL             PIC S9(04) COMP VALUE ZERO. 00700000
007100                                                                  00710000
007200     05  PV-CURRENT-TEMP.                                         00720000
007300         10  PV-CURR-TEMP-PO          PIC 9(09)       VALUE ZERO. 00730000
007400         10  PV-CURR-TEMP-SEQ         PIC 9(04)       VALUE ZERO. 00740000
007500     05  PV-PREVIOUS-TEMP.                                        00750000
007600         10  PV-PREV-TEMP-PO          PIC 9(09)       VALUE ZERO. 00760000
007700         10  PV-PREV-TEMP-SEQ         PIC 9(04)       VALUE ZERO. 00770000
007800                                                                  00780000
007900 01  PV-TEMP-LIST.                                                00790000
008000     05  FILLER                       PIC X(03) VALUE 'PO='.      00800000
008100     05  PV-LIST-PO-NBR               PIC 9(09)       VALUE ZERO. 00810000
008200     05  FILLER                       PIC X(06) VALUE ' RCVR='.   00820000
008300     05  PV-LIST-REC-SEQ-NBR          PIC 9(09)       VALUE ZERO. 00830000
008400     05  FILLER                       PIC X(06) VALUE ' TYPE='.   00840000
008500     05  PV-LIST-STATUS-CDE           PIC X(02)       VALUE SPACE.00850000
008600     05  FILLER                       PIC X(05) VALUE ' SEQ='.    00860000
008700     05  PV-LIST-SCREEN-SEQUENCE      PIC 9(04)       VALUE ZERO. 00870000
008800     05  FILLER                       PIC X(07) VALUE ' UNION='.  00880000
008900     05  PV-LIST-UNION-TYPE           PIC X(01)       VALUE SPACE.00890000
008901                                                                  00890100
008902                                                                  00890200
008903 01  PC-PROGRAM-CONSTANTS.                                        00890300
008904     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00890400
008905                                                    'SUK552  '.   00890500
008906     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00890600
008907                                                    'SUKM552 '.   00890700
008908     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00890800
008909                                                    'SUKCS552'.   00890900
008910     05  PC-RANDNBR-PGM                 PIC X(08)   VALUE         00891000
008911                                                    'DPKUT001'.   00891100
008914     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00891400
008915     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00891500
008916                                                    COMP SYNC.    00891600
008917     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00891700
008918     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00891800
008919     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00891900
008920     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00892000
008921     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +9      00892100
008922                                                    COMP SYNC.    00892200
008923     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00892300
008924                                                    COMP SYNC.    00892400
008925     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00892500
008926                                                    +1000000      00892600
008927                                                    COMP-3.       00892700
008928     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00892800
008929                                                    COMP SYNC.    00892900
008930     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00893000
008931                                                    COMP-3.       00893100
008932     05  PC-DELETED-STATUS-CDE          PIC  X(02)  VALUE 'DE'.   00893200
008933     05  PC-I                           PIC  X(01)  VALUE  'I'.   00893300
008934     05  PC-A                           PIC  X(01)  VALUE  'A'.   00893400
008935     05  PC-U                           PIC  X(01)  VALUE  'U'.   00893500
008936     05  PC-49                          PIC  X(02)  VALUE  '49'.  00893600
008937     05  PC-EN                          PIC  X(02)  VALUE  'EN'.  00893700
008938     05  PC-ET                          PIC  X(02)  VALUE  'ET'.  00893800
008939     05  PC-ONE                         PIC  X(01)  VALUE  '1'.   00893900
008940*                                                                 00894000
008941     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00894100
008942     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00894200
008943     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00894300
008944     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00894400
008945     05  PC-UNKNWN-VND-NME         PIC  X(20)  VALUE              00894500
008946                               'UNKNOWN VENDOR NAME '.            00894600
008947*                                                                 00894700
008948     05  PC-INNER-PREPACK          PIC X(06)   VALUE 'INPRPK'.    00894800
008949     05  PC-MULTI-SKU              PIC X(06)   VALUE 'MLTSKU'.    00894900
008950     05  PC-SINGLE-SKU             PIC X(06)   VALUE 'SGLSKU'.    00895000
008960     05  PC-CASEPACK               PIC X(06)   VALUE 'CASEPK'.    00896000
008970     05  PC-BULK                   PIC X(06)   VALUE 'BULK  '.    00897000
008980     05  PC-PBS                    PIC X(06)   VALUE 'PBS   '.    00898000
008990     05  PC-FREE-ASTRAY            PIC X(06)   VALUE 'FRASTY'.    00899000
009000                                                                  00900000
009100     05  PC-TSYMSG-NUMBERS.                                       00910000
009200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00920000
009300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00930000
009400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00940000
009500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00950000
009600         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00960000
009700         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00970000
009800         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00980000
009900         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00990000
010000         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01000000
010100         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01010000
010200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01020000
010300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01030000
010400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01040000
010500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01050000
010600         10  PC-TSYMSG-00463            PIC  9(05)  VALUE 00463.  01060000
010700         10  PC-TSYMSG-00954            PIC  9(05)  VALUE 00954.  01070000
010800         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01080000
010900         10  PC-TSYMSG-02479            PIC  9(05)  VALUE 02479.  01090000
011000         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01100000
011100*                                                                 01110000
011200 01  PS-PROGRAM-SWITCHES.                                         01120000
011300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01130000
011400         88  PS-NO-ERROR                            VALUE 'Y'.    01140000
011500         88  PS-ERROR                               VALUE 'N'.    01150000
011600     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01160000
011700         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01170000
011800         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01180000
011900     05  PS-RECEIVER-EXISTS-SW          PIC  X(01)  VALUE 'Y'.    01190000
012000         88  PS-RECEIVER-EXISTS                     VALUE 'Y'.    01200000
012100         88  PS-RECEIVER-DOESNT-EXIST               VALUE 'N'.    01210000
012200     05  PS-END-OF-STATUS-CURSOR-SW     PIC  X(01)  VALUE 'N'.    01220000
012300         88  PS-END-OF-STATUS-CURSOR          VALUE 'Y'.          01230000
012400         88  PS-NOT-END-OF-STATUS-CURSOR      VALUE 'N'.          01240000
012500     05  PS-CONTINUE-FUNC-03-SW   PIC  X(01)  VALUE 'N'.          01250000
012600         88  PS-CONTINUE-FUNC-03              VALUE 'Y'.          01260000
012700         88  PS-END-FUNC-03                   VALUE 'N'.          01270000
012800     05  PS-END-OF-RECITM-CSR-SW  PIC  X(01)  VALUE 'N'.          01280000
012900         88  PS-END-OF-RECITM-CSR             VALUE 'Y'.          01290000
013000         88  PS-NOT-END-OF-RECITM-CSR         VALUE 'N'.          01300000
013100     05  PS-LIST-END-SW           PIC  X(01)  VALUE 'N'.          01310000
013200         88  PS-LIST-END                      VALUE 'Y'.          01320000
013300         88  PS-NO-LIST-END                   VALUE 'N'.          01330000
013400     05  PS-BLOCK-ERROR-SW        PIC  X(01)  VALUE 'Y'.          01340000
013500         88  PS-NO-BLOCK-ERROR                VALUE 'Y'.          01350000
013600         88  PS-BLOCK-ERROR                   VALUE 'N'.          01360000
013700     05  PS-FREE-ASTRAY-SW        PIC  X(01)  VALUE 'N'.          01370000
013800         88  PS-FREE-ASTRAY                   VALUE 'Y'.          01380000
013900         88  PS-NO-FREE-ASTRAY                VALUE 'N'.          01390000
014000     05  PS-VERIFIED-RECEIVER-SW  PIC  X(01)  VALUE 'N'.          01400000
014100         88  PS-VERIFIED-RECEIVER             VALUE 'Y'.          01410000
014200         88  PS-NO-VERIFIED-RECEIVER          VALUE 'N'.          01420000
014300     05  PS-PBS-ERRORS-FOUND-SW   PIC  X(01)  VALUE 'N'.          01430000
014400         88  PS-PBS-ERRORS-FOUND              VALUE 'Y'.          01440000
014500         88  PS-PBS-ERRORS-FOUND-NO           VALUE 'N'.          01450000
014600     05  PS-DC-LEVEL-SW           PIC  X(01)  VALUE 'N'.          01460000
014700         88  PS-DC-LEVEL-YES                  VALUE 'Y'.          01470000
014800         88  PS-DC-LEVEL-NO                   VALUE 'N'.          01480000
014900     05  PS-RECEIVER-FOUND-SW     PIC  X(01)  VALUE 'N'.          01490000
015000         88  PS-RECEIVER-FOUND-YES            VALUE 'Y'.          01500000
015100         88  PS-RECEIVER-FOUND-NO             VALUE 'N'.          01510000
015200     05  PS-MISDIRECT-SW           PIC  X(01) VALUE 'N'.          01520000
015300         88  PS-MISDIRECT-YES                 VALUE 'Y'.          01530000
015400         88  PS-MISDIRECT-NO                  VALUE 'N'.          01540000
015500*                                                                 01550000
015600 01  DN-DB2-NULL-INDICATORS.                                      01560000
015700     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROES. 01570000
015800     05  DN-EXP-CTN-CNT             PIC S9(04) COMP VALUE ZEROES. 01580000
015900*                                                                 01590000
016000 01  PV-PROGRAM-VARIABLES.                                        01600000
016100     05  PV-SEL-TERM-ID                  PIC  X(04).              01610000
016200     05  PV-SEL-TASK-NUMBER              PIC  9(05).              01620000
016300     05  PV-SEL-SEQ                      PIC  9(01).              01630000
016400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01640000
016500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01650000
016600                                                     COMP SYNC.   01660000
016700     05  PV-SUB                         PIC S9(04)  VALUE +0      01670000
016800                                                    COMP SYNC.    01680000
016900     05  PV-CURRENT-DATE                PIC  9(06).               01690000
017000     05  PV-CURRENT-TIME                PIC  9(06).               01700000
017100     05  PV-SHIPMENT-COUNT              PIC S9(09)  VALUE +0      01710000
017200                                                    COMP-3.       01720000
017300     05  PV-NUMBER-OF-UPDATES           PIC S9(04)  VALUE +0      01730000
017400                                                    COMP-3.       01740000
017500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01750000
017600                                                    COMP SYNC.    01760000
017700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01770000
017800                                                    COMP-3.       01780000
017900     05  PV-COUNT                       PIC S9(09)  VALUE +0      01790000
018000                                                    COMP-3.       01800000
018010     05  PV-BRANCH-COUNT                PIC S9(09)  VALUE +0      01801000
018020                                                    COMP-3.       01802000
018030     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01803000
018040                                                    COMP-3.       01804000
018050     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01805000
018060                                                    COMP-3.       01806000
018070     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01807000
018080                                                    COMP-3.       01808000
018090     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01809000
018100                                                    COMP SYNC.    01810000
018200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01820000
018300                                                    COMP SYNC.    01830000
018400     05  PV-ITEM                        PIC S9(04)  VALUE +0      01840000
018500                                                    COMP SYNC.    01850000
018600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01860000
018700                                                    COMP SYNC.    01870000
018800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01880000
018900                                                    COMP SYNC.    01890000
019000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01900000
019100                                                    COMP SYNC.    01910000
019200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01920000
019300                                                    COMP SYNC.    01930000
019400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01940000
019500                                                    COMP SYNC.    01950000
019600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01960000
019700                                                    COMP SYNC.    01970000
019800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01980000
019900                                                    COMP SYNC.    01990000
020000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02000000
020100                                                    COMP SYNC.    02010000
020200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02020000
020300                                                    COMP SYNC.    02030000
020400     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02040000
020500                                                    COMP SYNC.    02050000
020600     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02060000
020700                                                    COMP SYNC.    02070000
020800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02080000
020900                                                    COMP SYNC.    02090000
021000     05  PV-PO-RCVR-UNT-CNTR            PIC S9(06)  VALUE +0      02100000
021100                                                    COMP.         02110000
021200     05  PV-SHIPMENT-CSR-IND            PIC  X(01)  VALUE SPACES. 02120000
021300     05  PV-VEND-SHIP-DTE               PIC  X(10)  VALUE SPACES. 02130000
021400     05  PV-DB2-COUNT                   PIC S9(04)  VALUE +0      02140000
021500                                                    COMP SYNC.    02150000
021600     05  PV-VERIFY-ITM-QTY              PIC S9(09)  VALUE +0      02160000
021700                                                    COMP.         02170000
021800     05  PV-AP-VERIFY-ITM-QTY           PIC S9(09)  VALUE +0      02180000
021900                                                    COMP.         02190000
022000     05  PV-DB2-COUNT-EXP-SCN           PIC S9(05)  VALUE +0      02200000
022100                                                    COMP.         02210000
022200     05  PV-DB2-COUNT-ACTL-CTN          PIC S9(04)  VALUE +0      02220000
022300                                                    COMP.         02230000
022400     05  PV-DB2-COUNT-ACTL-SCN          PIC S9(04)  VALUE +0      02240000
022500                                                    COMP.         02250000
022600     05  PV-DB2-COUNT-MANIFEST          PIC S9(04)  VALUE +0      02260000
022700                                                    COMP SYNC.    02270000
022800     05  PV-DB2-COUNT-PBS-ERRORS        PIC S9(04)  VALUE +0      02280000
022900                                                    COMP SYNC.    02290000
023000     05  PV-CURR-TRIP-ID                PIC S9(09)  VALUE +0      02300000
023100                                                    COMP SYNC.    02310000
023200     05  PV-TRIP-CHECK                  PIC  9(09).               02320000
023300     05  PV-TRIP-ID                     PIC S9(09)  VALUE +0      02330000
023400                                                    COMP SYNC.    02340000
023500     05  PV-SAVE-TRIP-ID                PIC S9(09)  VALUE +0      02350000
023600                                                    COMP SYNC.    02360000
023700     05  PV-VHTRIP-COUNT                PIC S9(09)  VALUE +0      02370000
023800                                                    COMP-3.       02380000
023900     05  PV-REC-SEQ-NBR                 PIC S9(09)  VALUE +0      02390000
024000                                                    COMP SYNC.    02400000
024100     05  PV-PERCENT-SCANNED             PIC  9(03)V99.            02410000
024200                                                                  02420000
024300     05  PV-PERCENT-EDITED.                                       02430000
024400         10  PV-PERCENT                 PIC  Z(03).99.            02440000
024500                                                                  02450000
024600     05  PV-DIVIDEND                    PIC   9(03)V9999.         02460000
024700                                                                  02470000
024800     05  PV-PACK-TYPE                   PIC X(06) VALUE SPACES.   02480000
024900                                                                  02490000
025000     05  PV-PO-RECEIVER.                                          02500000
      *CLP 09/24/2014                                                   02501003
025100         10  PV-PO-NBR                  PIC  9(08).               02510003
025200         10  FILLER                     PIC  X(01) VALUE '-'.     02520000
025300         10  PV-RECEIVER                PIC  9(03).               02530000
025400                                                                  02540000
025500     05  PV-VER-NBR                     PIC S9(09)  VALUE +0      02550000
025600                                                    COMP SYNC.    02560000
025700     05  PV-UNION-TYPE                  PIC  X(01).               02570000
025800*                                                                 02580000
025900     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02590000
026000                                                    COMP-3.       02600000
026100     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02610000
026200                                                    COMP SYNC.    02620000
026300     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       02630000
026400     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       02640000
026500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02650000
026600                                                    COMP-3.       02660000
026700                                                                  02670000
026800                                                                  02680000
026900                                                                  02690000
027000******************************************************************02700000
027100**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02710000
027200**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02720000
027300**  APPLICATION-SPECIFIC COMMAREA.                              **02730000
027400******************************************************************02740000
027500 01  LQW-LIST-QUEUE-WORK-AREA.                                    02750000
027600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02760000
027700     05  LQW-ITEM-ENTRIES               OCCURS 9  TIMES           02770000
027800                                        INDEXED BY LQW-IDX.       02780000
027900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02790000
028000*                                                                 02800000
028100         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02810000
028200         10  LQW-SELECTED-SW            PIC  X(01).               02820000
028300             88  LQW-SELECT                         VALUE 'S'.    02830000
028400             88  LQW-DESELECT                       VALUE ' '.    02840000
028500         10  LQW-ACTION                 PIC  X(03).               02850000
028600         10  LQW-PO-RECEIVER.                                     02860000
      *CLP 09/24/2014                                                   02861003
028700             15 LQW-PO-NBR              PIC  X(08).               02870003
028800             15 FILLER                  PIC  X(01).               02880000
028900             15 LQW-RECEIVER            PIC  X(03).               02890000
029000         10  LQW-PO-STATUS              PIC  X(02).               02900000
029100         10  LQW-VND-NME                PIC  X(22).               02910000
029200         10  LQW-PACK-TYPE              PIC  X(01).               02920000
029300         10  LQW-EXP-CART-COUNT         PIC  9(05).               02930000
029400         10  LQW-ACTL-CART-COUNT        PIC  9(05).               02940000
029500         10  LQW-EXP-SCN-COUNT          PIC  9(05).               02950000
029600         10  LQW-ACTL-SCN-COUNT         PIC  9(05).               02960000
029700         10  LQW-PERCENT-SCND           PIC  X(06).               02970000
029800         10  LQW-TOTAL-UNITS            PIC  9(06).               02980000
029900         10  LQW-CSR-IND                PIC  X(01).               02990000
030000         10  LQW-PBS-ERRORS-SW          PIC  X(01).               03000000
030100             88  LQW-PBS-ERRORS-FOUND               VALUE 'Y'.    03010000
030200         10  LQW-COLOR-YELLOW-SW        PIC X(01).                03020000
030300             88 LQW-COLOR-YELLOW         VALUE 'Y'.               03030000
030400             88 LQW-COLOR-YELLOW-NO      VALUE 'N'.               03040000
030500         10  LQW-AUTO-VE-SW             PIC X(01).                03050000
030600             88 LQW-AUTO-VE              VALUE 'Y'.               03060000
030700             88 LQW-AUTO-VE-NO           VALUE 'N'.               03070000
030800         10  LQW-CHCKIN-SW              PIC X(01).                03080000
030900             88 LQW-CHCKIN-YES          VALUE 'Y'.                03090000
031000             88 LQW-CHCKIN-NO           VALUE 'N'.                03100000
031100         10  LQW-MISDIRECT-SW        PIC  X(01).                  03110000
031200             88  LQW-MISDIRECT-YES   VALUE 'Y'.                   03120000
031300             88  LQW-MISDIRECT-NO    VALUE 'N'.                   03130000
031400                                                                  03140000
031500                                                                  03150000
031600     EJECT                                                        03160000
031700*---------------------------------------------------------------* 03170000
031800*  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 03180000
031900*---------------------------------------------------------------* 03190000
031901                                                                  03190100
031902     COPY SUWS004.                                                03190200
031903                                                                  03190300
031904*---------------------------------------------------------------* 03190400
031905*  RECORD LAYOUT FOR SELECTION TEMP STORAGE QUEUE.  *             03190500
031906*---------------------------------------------------------------* 03190600
031907                                                                  03190700
031908     COPY RCWS013.                                                03190800
031909*LMM                                                              03190900
031910     COPY PCWS237.                                                03191000
031920                                                                  03192000
031930     COPY SUWS010.                                                03193000
031980                                                                  03198000
031990/                                                                 03199000
032000***************************************************************** 03200000
032100*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 03210000
032200*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 03220000
032300***************************************************************** 03230000
032400     COPY RCWS040.                                                03240000
032500/                                                                 03250000
032600*----------------------------------------------------------------*03260000
032700*  WORK AREA PASSED IN CALL TO DPKUT500                          *03270000
032800*----------------------------------------------------------------*03280000
032900     COPY DPWS500.                                                03290000
033000                                                                  03300000
033100*---------------------------------------------------------------* 03310000
033200*    MAP LAYOUT                                                 * 03320000
033300*---------------------------------------------------------------* 03330000
033400                                                                  03340000
033500     COPY SUKM552.                                                03350000
033600*                                                                 03360000
033700 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK552O.       03370000
033800     05  FILLER                         PIC X(218).               03380000
033900     05  MR-SCROLL-AREA                 OCCURS 9  TIMES.          03390000
034000         10  MR-SELECTL                 PIC S9(04) COMP.          03400000
034100         10  MR-SELECTA                 PIC  X(01).               03410000
034200         10  MR-SELECTC                 PIC  X(01).               03420000
034300         10  MR-SELECTH                 PIC  X(01).               03430000
034400         10  MR-SELECTI                 PIC  X(01).               03440000
034500                                                                  03450000
034600         10  MR-ACTIONL                 PIC S9(04) COMP.          03460000
034700         10  MR-ACTIONA                 PIC  X(01).               03470000
034800         10  MR-ACTIONC                 PIC  X(01).               03480000
034900         10  MR-ACTIONH                 PIC  X(01).               03490000
035000         10  MR-ACTION                  PIC  X(03).               03500000
035100                                                                  03510000
035200         10  MR-PO-RCVRL                   PIC S9(04) COMP.       03520000
035300         10  MR-PO-RCVRA                   PIC  X(01).            03530000
035400         10  MR-PO-RCVRC                   PIC  X(01).            03540000
035500         10  MR-PO-RCVRH                   PIC  X(01).            03550000
      *CLP 09/24/2014                                                   03551003
035600         10  MR-PO-RCVR                    PIC  X(12).            03560003
035700                                                                  03570000
035800         10  MR-PO-STATUSL                 PIC S9(04) COMP.       03580000
035900         10  MR-PO-STATUSA                 PIC  X(01).            03590000
036000         10  MR-PO-STATUSC                 PIC  X(01).            03600000
036100         10  MR-P0-STATUSH                 PIC  X(01).            03610000
036200         10  MR-PO-STATUS                  PIC  X(02).            03620000
036300                                                                  03630000
036400         10  MR-VND-NMEL                   PIC S9(04) COMP.       03640000
036500         10  MR-VND-NMEA                   PIC  X(01).            03650000
036600         10  MR-VND-NMEC                   PIC  X(01).            03660000
036700         10  MR-VND-NMEH                   PIC  X(01).            03670000
      *CLP 09/24/2014                                                   03671004
036800         10  MR-VND-NME                    PIC  X(21).            03680004
036900                                                                  03690000
037000         10  MR-PACK-TYPEL              PIC S9(04) COMP.          03700000
037100         10  MR-PACK-TYPEA              PIC  X(01).               03710000
037200         10  MR-PACK-TYPEC              PIC  X(01).               03720000
037300         10  MR-PACK-TYPEH              PIC  X(01).               03730000
037400         10  MR-PACK-TYPE               PIC  X(01).               03740000
037500                                                                  03750000
037600         10  MR-EXP-CART-COUNTL         PIC S9(04) COMP.          03760000
037700         10  MR-EXP-CART-COUNTA         PIC  X(01).               03770000
037800         10  MR-EXP-CART-COUNTC         PIC  X(01).               03780000
037900         10  MR-EXP-CART-COUNTH         PIC  X(01).               03790000
038000         10  MR-EXP-CART-COUNT-X.                                 03800000
038100             15 MR-EXP-CART-COUNT       PIC  ZZZ9.                03810000
038200                                                                  03820000
038300         10  MR-ACTL-CART-COUNTL        PIC S9(04) COMP.          03830000
038400         10  MR-ACTL-CART-COUNTA        PIC  X(01).               03840000
038500         10  MR-ACTL-CART-COUNTC        PIC  X(01).               03850000
038600         10  MR-ACTL-CART-COUNTH        PIC  X(01).               03860000
038700         10  MR-ACTL-CART-COUNT-X.                                03870000
038800             15 MR-ACTL-CART-COUNT      PIC  ZZZ9.                03880000
038900                                                                  03890000
039000         10  MR-EXP-SCN-COUNTL          PIC S9(04) COMP.          03900000
039100         10  MR-EXP-SCN-COUNTA          PIC  X(01).               03910000
039200         10  MR-EXP-SCN-COUNTC          PIC  X(01).               03920000
039300         10  MR-EXP-SCN-COUNTH          PIC  X(01).               03930000
039400         10  MR-EXP-SCN-COUNT-X.                                  03940000
039500             15  MR-EXP-SCN-COUNT       PIC ZZZ9.                 03950000
039600                                                                  03960000
039700         10  MR-ACTL-SCN-COUNTL         PIC S9(04) COMP.          03970000
039800         10  MR-ACTL-SCN-COUNTA         PIC  X(01).               03980000
039900         10  MR-ACTL-SCN-COUNTC         PIC  X(01).               03990000
040000         10  MR-ACTL-SCN-COUNTH         PIC  X(01).               04000000
040100         10  MR-ACTL-SCN-COUNT-X.                                 04010000
040200             15  MR-ACTL-SCN-COUNT      PIC ZZZ9.                 04020000
040300                                                                  04030000
040400         10  MR-PERCENT-SCNDL           PIC S9(04) COMP.          04040000
040500         10  MR-PERCENT-SCNDA           PIC  X(01).               04050000
040600         10  MR-PERCENT-SCNDC           PIC  X(01).               04060000
040700         10  MR-PERCENT-SCNDH           PIC  X(01).               04070000
040800         10  MR-PERCENT-SCND-X.                                   04080000
040900             15  MR-PERCENT-SCND        PIC  X(06).               04090000
041000                                                                  04100000
041100         10  MR-TOTAL-UNITSL            PIC S9(04) COMP.          04110000
041200         10  MR-TOTAL-UNITSA            PIC  X(01).               04120000
041300         10  MR-TOTAL-UNITSC            PIC  X(01).               04130000
041400         10  MR-TOTAL-UNITSH            PIC  X(01).               04140000
041500         10  MR-TOTAL-UNITS-X.                                    04150000
041600             15  MR-TOTAL-UNITS         PIC  ZZZZZ9.              04160000
041700     05  FILLER                         PIC  X(10).               04170000
041800                                                                  04180000
041900                                                                  04190000
042000     EJECT                                                        04200000
042100/                                                                 04210000
042200*----------------------------------------------------------------*04220000
042300**  SECURITY SUBROUTINE PARAMETERS                                04230000
042400*----------------------------------------------------------------*04240000
042500     COPY DPWS008.                                                04250000
042600*---------------------------------------------------------------* 04260000
042700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04270000
042800*---------------------------------------------------------------* 04280000
042900                                                                  04290000
043000     COPY DPWS015.                                                04300000
043100                                                                  04310000
043200*---------------------------------------------------------------* 04320000
043300*    FUNCTION KEYS COPYBOOK.                                    * 04330000
043400*---------------------------------------------------------------* 04340000
043500                                                                  04350000
043600     COPY DPWS016.                                                04360000
043700                                                                  04370000
043800*---------------------------------------------------------------* 04380000
043900*    NUMERIC EDIT LAYOUT.                                       * 04390000
044000*---------------------------------------------------------------* 04400000
044100                                                                  04410000
044200     COPY DPWS010I.                                               04420000
044300 EJECT                                                            04430000
044400*---------------------------------------------------------------* 04440000
044500*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04450009
044600*---------------------------------------------------------------* 04460000
044700                                                                  04470000
044800     COPY DPWS030.                                                04480000
044800     COPY DPWS930.                                                04481009
044900 EJECT                                                            04490000
045000*---------------------------------------------------------------* 04500000
045100*    STANDARD COMMAREA.                                         * 04510000
045200*---------------------------------------------------------------* 04520000
045300                                                                  04530000
045400     COPY DPWS020.                                                04540000
045500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04550000
045600                                                                  04560000
045700*---------------------------------------------------------------* 04570000
045800* INTER-APPLICATION COMMAREA.                                   * 04580000
045900*   SUWS002 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04590000
046000*             SPEC SCREEN.                                      * 04600000
046100*   SUWS003 - IS THE INPUT  LAYOUT THAT WILL BE PASSED FROM     * 04610000
046200*             THE TRAILER/TRIP LIST SCREEN.                     * 04620000
046300*---------------------------------------------------------------* 04630000
046400                                                                  04640000
046500         10  INTER-APPL-COMM-AREA       PIC X(200).               04650000
046600     COPY SUWS002.                                                04660000
046700     COPY SUWS003.                                                04670000
046800     COPY RCWS015.                                                04680000
046900     COPY SUWS009.                                                04690000
047000*LMM                                                              04700000
047100     COPY PCWS236.                                                04710000
047200     COPY SUWS046.                                                04720000
047300*                                                                 04730000
047400*---------------------------------------------------------------* 04740000
047500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04750000
047600*---------------------------------------------------------------* 04760000
047700         10  ASC-SPECIFIC-COMMAREA.                               04770000
047800             15  ASC-LIST-KEYS.                                   04780000
047900                 20  ASC-OPER-UNT-ID                 PIC S9(04)   04790000
048000                                                           COMP.  04800000
048100                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   04810000
048200                                                           COMP.  04820000
048300                 20  ASC-FCLTY-ID                    PIC S9(04)   04830000
048400                                                           COMP.  04840000
048500                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   04850000
048600                                                           COMP.  04860000
048700                 20  ASC-FCLTY-NME                   PIC  X(25).  04870000
048800                 20  ASC-SCAC-ID                     PIC  X(04).  04880000
048900                 20  ASC-VEH-NBR                     PIC  X(10).  04890000
049000                 20  ASC-STATUS                      PIC  X(02).  04900000
049100                 20  ASC-TRIP-ID                     PIC S9(09)   04910000
049200                                                           COMP.  04920000
049300                 20  ASC-ALL-PO-IND                  PIC  X(01).  04930000
049400                     88  ASC-ALL-PO-NBRS             VALUE 'Y'.   04940000
049500                     88  ASC-NOT-ALL-PO-NBRS         VALUE 'N'.   04950000
049600             15  ASC-BLK-SUB                         PIC S9(04)   04960000
049700                                                          COMP    04970000
049800                                                          SYNC.   04980000
049900             15  ASC-ITEM-SUB                        PIC S9(04)   04990000
050000                                                          COMP    05000000
050100                                                          SYNC.   05010000
050200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   05020000
050300                                                          COMP-3. 05030000
050400             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   05040000
050500                                                          COMP-3. 05050000
050600             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   05060000
050700                                                          COMP-3. 05070000
050800             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   05080000
050900                                                          COMP-3. 05090000
051000             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   05100000
051100                                                          COMP-3. 05110000
051200             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   05120000
051300                                                          COMP    05130000
051400                                                          SYNC.   05140000
051500             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   05150000
051600                                                          COMP-3. 05160000
051700             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   05170000
051800                                                          COMP-3. 05180000
051900             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  05190000
052000                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   05200000
052100                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   05210000
052200             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  05220000
052300                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   05230000
052400                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   05240000
052500             15  ASC-LIST-QUEUE-NAME.                             05250000
052600                 20  ASC-LIST-TERM-ID                PIC  X(04).  05260000
052700                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05270000
052800                                                          COMP-3. 05280000
052900                 20  ASC-LIST-SEQ                    PIC  9(01).  05290000
053000             15  ASC-SEL-QUEUE-NAME.                              05300000
053100                 20  ASC-SEL-TERM-ID          PIC  X(04).         05310000
053200                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05320000
053300                 20  ASC-SEL-SEQ              PIC  9(01).         05330000
053400             15  ASC-SEL-QUEUE-NAME-IN.                           05340000
053500                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         05350000
053600                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  05360000
053700                 20  ASC-SEL-SEQ-IN           PIC  9(01).         05370000
053800             15  ASC-PKGNG-CD                 PIC  X(01).         05380000
053900                 88  ASC-PRE-PACK-ORDER            VALUE 'I', 'M'.05390000
054000                 88  ASC-INNER-PREPK                    VALUE 'I'.05400000
054100                 88  ASC-MULTI-SKU-PREPK                VALUE 'M'.05410000
054200                 88  ASC-SINGLE-SKU-PREPK               VALUE 'S'.05420000
054300                 88  ASC-CASEPACK                       VALUE 'C'.05430000
054400                 88  ASC-BULK-PACK                      VALUE 'B'.05440000
054500                 88  ASC-PBS                            VALUE ' '.05450000
054600             15  ASC-TOT-EXP-CRTNS            PIC S9(05) COMP.    05460000
054700             15  ASC-TOT-ACTL-CRTNS           PIC S9(05) COMP.    05470000
054800             15  ASC-TOT-EXP-SCAN             PIC S9(05) COMP.    05480000
054900             15  ASC-TOT-ACTL-SCN             PIC S9(05) COMP.    05490000
055000             15  ASC-TOT-UNITS                PIC 9(07).          05500000
055100                                                                  05510000
055200                                                                  05520000
055300             15  ASC-START-ITEM-REQUEST.                          05530000
055400                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  05540000
055500*                                                                 05550000
055600             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05560000
055700             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05570000
055800             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05580000
055900                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05590000
056000             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05600000
056100                                                                  05610000
056200             15  ASC-FUNC02-RETURN-FLAG       PIC  X(1).          05620000
056300                 88  ASC-FUNC02-RETURN-NO   VALUE 'N'.            05630000
056400                 88  ASC-FUNC02-RETURN-YES  VALUE 'Y'.            05640000
056500                                                                  05650000
056600             15  ASC-FUNC03-RETURN-FLAG       PIC  X(1).          05660000
056700                 88  ASC-FUNC03-RETURN-NO   VALUE 'N'.            05670000
056800                 88  ASC-FUNC03-RETURN-YES  VALUE 'Y'.            05680000
056900                                                                  05690000
057000             15  ASC-FUNC05-RETURN-FLAG       PIC  X(1).          05700000
057100                 88  ASC-FUNC05-RETURN-NO   VALUE 'N'.            05710000
057200                 88  ASC-FUNC05-RETURN-YES  VALUE 'Y'.            05720000
057300*LMM                                                              05730000
057400             15  ASC-FUNC06-RETURN-FLAG       PIC  X(1).          05740000
057500                 88  ASC-FUNC06-RETURN-NO   VALUE 'N'.            05750000
057600                 88  ASC-FUNC06-RETURN-YES  VALUE 'Y'.            05760000
057700                                                                  05770000
057800             15  ASC-FUNC07-RETURN-FLAG       PIC  X(1).          05780000
057900                 88  ASC-FUNC07-RETURN-NO   VALUE 'N'.            05790000
058000                 88  ASC-FUNC07-RETURN-YES  VALUE 'Y'.            05800000
058100                                                                  05810000
058200             15  ASC-FREE-ASTRAY-SW           PIC X(01).          05820000
058300                 88  ASC-FREE-ASTRAY        VALUE 'Y'.            05830000
058400                 88  ASC-FREE-ASTRAY-NO     VALUE 'N'.            05840000
058500                                                                  05850000
058600             15  ASC-FACILITY-AUTOVE-SW        PIC X(01).         05860000
058700                 88  ASC-FACILITY-AUTOVE-YES   VALUE 'Y'.         05870000
058800                 88  ASC-FACILITY-AUTOVE-NO    VALUE 'N'.         05880000
058900                                                                  05890000
059000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                05900000
059100                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  05910000
059200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   05920000
059300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   05930000
059400                                                                  05940000
059500                 20  ASC-ITEM-ARRAY.                              05950000
059600                     25  ASC-ITEM-ENTRIES OCCURS 9  TIMES.        05960000
059700                         30  ASC-LIST-ITEM-NUMBER                 05970000
059800                                                     PIC S9(09)   05980000
059900                                                     COMP-3.      05990000
060000                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06000000
060100                             88  ASC-VALID-SELECT    VALUE ' '    06010000
060200                                                           'S'    06020000
060300                                                           'B'    06030000
060400                                                           'E'.   06040000
060500                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06050000
060600                             88  ASC-TEMP-SELECT     VALUE 'S'.   06060000
060700                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06070000
060800                             88  ASC-TEMP-END        VALUE 'E'.   06080000
060900                         30  ASC-SELECTED-SW         PIC  X(01).  06090000
061000                             88  ASC-NO-SELECT       VALUE ' '.   06100000
061100                             88  ASC-SELECT          VALUE 'S'.   06110000
061200                             88  ASC-BEGIN           VALUE 'B'.   06120000
061300                             88  ASC-END             VALUE 'E'.   06130000
061400                         30  ASC-ACTION             PIC  X(03).   06140000
061500                         30  ASC-PO-RECEIVER.                     06150000
      *CLP 09/24/2014                                                   06151003
061600                             35 ASC-PO-NBR          PIC  X(08).   06160003
061700                             35 FILLER              PIC  X(01).   06170000
061800                             35 ASC-RECEIVER        PIC  X(03).   06180000
061900                         30  ASC-PO-STATUS          PIC  X(02).   06190000
062000                         30  ASC-VND-NME.                         06200000
062100                             35 ASC-VND-NME-1-12    PIC  X(12).   06210000
062200                             35 ASC-VND-NME-12-22   PIC  X(10).   06220000
062300                         30  ASC-PACK-TYPE          PIC  X(01).   06230000
062400                         30  ASC-EXP-CART-COUNT     PIC  9(05).   06240000
062500                         30  ASC-ACTL-CART-COUNT    PIC  9(05).   06250000
062600                         30  ASC-EXP-SCN-COUNT      PIC  9(05).   06260000
062700                         30  ASC-ACTL-SCN-COUNT     PIC  9(05).   06270000
062800                         30  ASC-PERCENT-SCND       PIC  X(06).   06280000
062900                         30  ASC-TOTAL-UNITS        PIC  9(06).   06290000
063000                         30  ASC-CSR-IND            PIC  X(01).   06300000
063100                         30  ASC-PBS-ERRORS-SW      PIC  X(01).   06310000
063200                             88  ASC-PBS-ERRORS-FOUND VALUE 'Y'.  06320000
063300                         30  ASC-COLOR-YELLOW-SW     PIC X(01).   06330000
063400                             88 ASC-COLOR-YELLOW     VALUE 'Y'.   06340000
063500                             88 ASC-COLOR-YELLOW-NO  VALUE 'N'.   06350000
063600                         30  ASC-AUTO-VE-SW          PIC X(01).   06360000
063700                             88 ASC-AUTO-VE          VALUE 'Y'.   06370000
063800                             88 ASC-AUTO-VE-NO       VALUE 'N'.   06380000
063900                         30  ASC-CHCKIN-SW           PIC X(01).   06390000
064000                             88 ASC-CHCKIN-YES       VALUE 'Y'.   06400000
064100                             88 ASC-CHCKIN-NO        VALUE 'N'.   06410000
064200                         30  ASC-MISDIRECT-SW        PIC  X(01).  06420000
064300                             88  ASC-MISDIRECT-YES   VALUE 'Y'.   06430000
064400                             88  ASC-MISDIRECT-NO    VALUE 'N'.   06440000
064500                                                                  06450000
064600     EJECT                                                        06460000
064700*---------------------------------------------------------------* 06470000
064800*    ABEND PROCESSING COPYBOOK.                                 * 06480000
064900*---------------------------------------------------------------* 06490000
065000                                                                  06500000
065100     COPY DPWS013.                                                06510000
065200                                                                  06520000
065300 EJECT                                                            06530000
065400*----------------------------------------------------------------*06540000
065500*    DB2 DCLGEN FOR THE PURCHASE ORDER  TABLE                     06550000
065600*----------------------------------------------------------------*06560000
065700     EXEC SQL                                                     06570000
065800          INCLUDE TPURCHS                                         06580000
065900     END-EXEC.                                                    06590000
066000                                                                  06600000
066100*----------------------------------------------------------------*06610000
066200*    DB2 DCLGEN FOR THE EXTERNAL ENTITY NAME TABLE                06620000
066300*----------------------------------------------------------------*06630000
066400     EXEC SQL                                                     06640000
066500          INCLUDE TENTNME                                         06650000
066600     END-EXEC.                                                    06660000
066700                                                                  06670000
066800*---------------------------------------------------------------* 06680000
066900*    DB2 AREA FOR SHIPMENT TABLE                                * 06690000
067000*---------------------------------------------------------------* 06700000
067100     EXEC SQL                                                     06710000
067200          INCLUDE TSHIPMT                                         06720000
067300     END-EXEC.                                                    06730000
067400*---------------------------------------------------------------* 06740000
067500*    DB2 AREA FOR SHIPMENT PO TABLE                             * 06750000
067600*---------------------------------------------------------------* 06760000
067700     EXEC SQL                                                     06770000
067800          INCLUDE TSHPTPO                                         06780000
067900     END-EXEC.                                                    06790000
068000*---------------------------------------------------------------* 06800000
068100*    DB2 AREA FOR TRIP STATUS TABLE                             * 06810000
068200*---------------------------------------------------------------* 06820000
068300     EXEC SQL                                                     06830000
068400          INCLUDE TTRSTYP                                         06840000
068500     END-EXEC.                                                    06850000
068600*---------------------------------------------------------------* 06860000
068700*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 06870000
068800*---------------------------------------------------------------* 06880000
068900     EXEC SQL                                                     06890000
069000          INCLUDE TVHTRIP                                         06900000
069100     END-EXEC.                                                    06910000
069200*---------------------------------------------------------------* 06920000
069300*    DB2 AREA FOR RECEIVER TABLE                                * 06930000
069400*---------------------------------------------------------------* 06940000
069500     EXEC SQL                                                     06950000
069600          INCLUDE TRECEIV                                         06960000
069700     END-EXEC.                                                    06970000
069800*---------------------------------------------------------------* 06980000
069900*    DB2 AREA FOR TRIP STATUS TABLE                             * 06990000
070000*---------------------------------------------------------------* 07000000
070100     EXEC SQL                                                     07010000
070200          INCLUDE TTRIPST                                         07020000
070300     END-EXEC.                                                    07030000
070400*---------------------------------------------------------------* 07040000
070500*    DB2 AREA                                                     07050000
070600*---------------------------------------------------------------* 07060000
070700     EXEC SQL                                                     07070000
070800          INCLUDE TINPKSU                                         07080000
070900     END-EXEC.                                                    07090000
071000*---------------------------------------------------------------* 07100000
071100*    DB2 AREA                                                     07110000
071200*---------------------------------------------------------------* 07120000
071300     EXEC SQL                                                     07130000
071400          INCLUDE TSHPUNT                                         07140000
071500     END-EXEC.                                                    07150000
071600*---------------------------------------------------------------* 07160000
071700*    DB2 AREA FOR THE PACKSLIP TABLE                            * 07170000
071800*---------------------------------------------------------------* 07180000
071900     EXEC SQL                                                     07190000
072000          INCLUDE TPKSLIP                                         07200000
072100     END-EXEC.                                                    07210000
072200*---------------------------------------------------------------* 07220000
072300*    DB2 AREA FOR THE SHIP UNIT TABLE                           * 07230000
072400*---------------------------------------------------------------* 07240000
072500     EXEC SQL                                                     07250000
072600          INCLUDE TSHUNLO                                         07260000
072700     END-EXEC.                                                    07270000
072800*---------------------------------------------------------------* 07280000
072900*    DB2 AREA                                                     07290000
073000*---------------------------------------------------------------* 07300000
073100     EXEC SQL                                                     07310000
073200          INCLUDE TRECITM                                         07320000
073300     END-EXEC.                                                    07330000
073400*---------------------------------------------------------------* 07340000
073500*    DB2 AREA                                                     07350000
073600*---------------------------------------------------------------* 07360000
073700     EXEC SQL                                                     07370000
073800          INCLUDE TRECDIS                                         07380000
073900     END-EXEC.                                                    07390000
074000*---------------------------------------------------------------* 07400000
074100*    DB2 AREA                                                     07410000
074200*---------------------------------------------------------------* 07420000
074300     EXEC SQL                                                     07430000
074400          INCLUDE TSHUUPC                                         07440000
074500     END-EXEC.                                                    07450000
074600/                                                                 07460000
074700*----------------------------------------------------------------*07470000
074800*    SUTT_PO_RCVR_TRLR                                            07480000
074900*----------------------------------------------------------------*07490000
075000     EXEC SQL                                                     07500000
075100          INCLUDE SUT00042                                        07510000
075200     END-EXEC.                                                    07520000
075300                                                                  07530000
075400*----------------------------------------------------------------*07540000
075500*                                                                 07550000
075600*----------------------------------------------------------------*07560000
075700     EXEC SQL                                                     07570000
075800          INCLUDE SUT00028                                        07580000
075810     END-EXEC.                                                    07581000
075820*----------------------------------------------------------------*07582000
075830*                                                                 07583000
075840*----------------------------------------------------------------*07584000
075850     EXEC SQL                                                     07585000
075860          INCLUDE SUT00024                                        07586000
075861     END-EXEC.                                                    07586100
075862*----------------------------------------------------------------*07586200
075863*                                                                 07586300
075864*----------------------------------------------------------------*07586400
075865     EXEC SQL                                                     07586500
075866          INCLUDE SUT00113                                        07586600
075867     END-EXEC.                                                    07586700
075868*----------------------------------------------------------------*07586800
075869     EXEC SQL                                                     07586900
075870          INCLUDE SUT00027                                        07587000
075880     END-EXEC.                                                    07588000
075890*---------------------------------------------------------------* 07589000
075900*    DB2 AREA FOR COMMUNICATIONS                                * 07590000
076000*---------------------------------------------------------------* 07600000
076100     EXEC SQL                                                     07610000
076200          INCLUDE SQLCA                                           07620000
076300     END-EXEC.                                                    07630000
076400                                                                  07640000
076500***************************************************************   07650000
076600*    THIS CURSOR CONTAINS THE BULK OF THE PO/RCVRS EXPECTED       07660000
076700*    TO BE ON THIS TRAILER.  ALL OF THESE WILL BE LOADED          07670000
076800*    DIRECTLY TO THE TEMP WORK TABLE.                             07680000
076900                                                                  07690000
077000     EXEC SQL                                                     07700000
077100         DECLARE TYPE-A-CSR CURSOR FOR                            07710000
077200             SELECT                                               07720000
077300                  'A'                                             07730000
077400                , C.PO_NBR                                        07740000
077500                , C.REC_SEQ_NBR                                   07750000
077600                , D.STATUS_CDE                                    07760000
077700                , CASE                                            07770000
077800                      WHEN D.STATUS_CDE = 'IP'                    07780000
077900                      THEN 1 ELSE 9                               07790000
078000                  END                                             07800000
078100            FROM  TVHTRIP A                                       07810000
078200                , TSHIPMT B                                       07820000
078300                , TSHPTPO C                                       07830000
078400                , TRECEIV D                                       07840000
078500            WHERE A.TRIP_ID           = :DK-TRIP-ID               07850000
078600              AND A.TRIP_ID           = B.TRIP_ID                 07860000
078700              AND C.SHIPT_ID          = B.SHIPT_ID                07870000
078800              AND C.PO_NBR          = D.ORD_NBR                   07880000
078900              AND C.REC_SEQ_NBR     = D.REC_SEQ_NBR               07890000
079000              AND D.VER_STATUS_CDE  = 'A'                         07900000
079100     END-EXEC.                                                    07910000
079200                                                                  07920000
079300****************************************************************  07930000
079400*    THIS CURSOR IS A LIST OF ALL THE PO/RCVRS FOUND ON THE       07940000
079500*    TRAILER.  THE ONES WITHOUT PACKSLIPS ARE FREE-ASTRAYS.       07950000
079600                                                                  07960000
079700     EXEC SQL                                                     07970000
079800         DECLARE CHECKIN-CSR CURSOR FOR                           07980000
079900           SELECT                                                 07990000
080000                  A.SHIPT_UNT_ID                                  08000000
080100              ,   B.PO_NBR                                        08010000
080200              ,   B.SEQ_NBR                                       08020000
080300*               , 'IP'  AS RCVR_STATUS_CDE                        08030000
080400*               , 'A'   AS SCREEN_SEQUENCE                        08040000
080500             FROM  TSHUNLO A                                      08050000
080600             LEFT OUTER JOIN                                      08060000
080700                  TINPKSU B                                       08070000
080800              ON A.SHIPT_UNT_ID       = B.SHIPT_UNT_ID            08080000
080900             WHERE A.TRIP_ID          = :DK-TRIP-ID               08090000
081000             ORDER BY                                             08100000
081100                 B.PO_NBR                                         08110000
081200              ,  B.SEQ_NBR                                        08120000
081300     END-EXEC.                                                    08130000
081400                                                                  08140000
081500******************************************************************08150000
081600*  CURSOR FOR THE EXPECTED NUMBER OF CARTONS FOR EACH PO/RECVR  **08160000
081700*  AND PO/RECVR SCANNED BUT NOT EXPECTED                          08170000
081800*  UNION 'B' AND  'C' TYPES = FREE ASTRAYS                        08180000
081900******************************************************************08190000
082000                                                                  08200000
082100     EXEC SQL                                                     08210000
082200         DECLARE SHIPMT-EXP-CSR CURSOR FOR                        08220000
082300           SELECT DISTINCT                                        08230000
082400                  RCVR_PRCG_CDE                                   08240000
082500                , PO_NBR                                          08250000
082600                , RCVR_SEQ_NBR                                    08260000
082700                , RCVR_STAT_CDE                                   08270000
082800                , DISP_SEQ_NBR                                    08280000
082900                                                                  08290000
083000            FROM  SUTT_PO_RCVR_TRLR                               08300000
083100            ORDER BY                                              08310000
083200                 DISP_SEQ_NBR                                     08320000
083300             ,   PO_NBR                                           08330000
083400             ,   RCVR_SEQ_NBR                                     08340000
083500     END-EXEC.                                                    08350000
083600                                                                  08360000
083700                                                                  08370000
083800     EXEC SQL                                                     08380000
083900          DECLARE RECV-ITM-CSR CURSOR FOR                         08390000
084000          SELECT     ORD_LNE_NBR                                  08400000
084100                 ,   STATUS_CDE                                   08410000
084200                 ,   PKSL_ITM_QTY                                 08420000
084300                 ,   DTL_CK_ITM_QTY                               08430000
084400           FROM    TRECITM                                        08440000
084500           WHERE     ORD_NBR        = :DK-PO-NBR                  08450000
084600              AND    REC_SEQ_NBR    = :DK-REC-SEQ-NBR             08460000
084700              AND    VER_STATUS_CDE = 'A'                         08470000
084800     END-EXEC.                                                    08480000
084900 EJECT                                                            08490000
085000 LINKAGE SECTION.                                                 08500000
085100                                                                  08510000
085200 01  DFHCOMMAREA.                                                 08520000
085300     05  FILLER                         OCCURS  1 TO 4072 TIMES   08530000
085400                                        DEPENDING ON EIBCALEN.    08540000
085500         10  FILLER                     PIC X.                    08550000
085600                                                                  08560000
085700 EJECT                                                            08570000
085800 PROCEDURE DIVISION.                                              08580000
085900******************************************************************08590000
086000**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **08600000
086100**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **08610000
086200**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **08620000
086300******************************************************************08630000
086400 0000-MAIN-MODULE.                                                08640000
086500     INITIALIZE DP030-CICS-API-FIELDS.                            08650000
086600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08660000
086700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08670000
086800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08680000
086900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08690000
087000     MOVE LENGTH OF SUK552I        TO DP030-MAP-LENGTH (1).       08700000
087100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08710000
087200     PERFORM 0001-CALL-CICS-ARCH-API.                             08720000
087300                                                                  08730000
087400     PERFORM 1000-CONTROL-PROCESSING                              08740000
087500                                                                  08750000
087600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08760000
087700     PERFORM 0001-CALL-CICS-ARCH-API.                             08770000
087800                                                                  08780000
087900******************************************************************08790000
088000**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08800000
088100**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08810000
088200******************************************************************08820000
088300 0001-CALL-CICS-ARCH-API.                                         08830000
088400*    CALL 'DPKCS030' USING DFHEIBLK                               08840009
088400     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08841009
088500                           DFHCOMMAREA                            08850000
088600                           DP030-CICS-API-FIELDS                  08860000
088700                           DP020-STANDARD-COMMAREA                08870000
088800                           SUK552I.                               08880000
088900                                                                  08890000
089000     IF  DP030-RC-CALL-SUCCESSFUL                                 08900000
089100         CONTINUE                                                 08910000
089200     ELSE                                                         08920000
089300         SET DP013-NO-ROLLBACK                                    08930000
089400             DP013-XCTL-DISPLAY-RESTART                           08940000
089500             DP013-CICS-ABEND      TO TRUE                        08950000
089600         MOVE '0001-CALL-CICS-ARCH-API'                           08960000
089700                                   TO DP013-PARAGRAPH             08970000
089800*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX08980009
089900*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      08990009
089800         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O08991009
089900-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08992009
090000         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09000000
090100         PERFORM DP013-0000-PROCESS-ABEND                         09010000
090200     END-IF.                                                      09020000
090300*----------------------------------------------------------------*09030000
090400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09040000
090500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09050000
090600*                                                                *09060000
090700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09070000
090800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09080000
090900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09090000
091000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09100000
091100*----------------------------------------------------------------*09110000
091200                                                                  09120000
091300 1000-CONTROL-PROCESSING.                                         09130000
091400                                                                  09140000
091500     EVALUATE TRUE                                                09150000
091600         WHEN DP020-NEXT-ACT-INITIAL                              09160000
091700             INITIALIZE ASC-SPECIFIC-COMMAREA                     09170000
091800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09180000
091900                                      ASC-SEL-TERM-ID             09190000
092000             MOVE DP020-SRC-TASK-NUMBER                           09200000
092100                                   TO ASC-LIST-TASK-NUMBER        09210000
092200                                      ASC-SEL-TASK-NUMBER         09220000
092300             MOVE PC-LIST-QUEUE-SEQ                               09230000
092400                                   TO ASC-LIST-SEQ                09240000
092500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 09250000
092600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09260000
092700***-----$TEMPLATE NOTE$-------------------------------------------09270000
092800*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,09280000
092900*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  09290000
093000*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.09300000
093100***---------------------------------------------------------------09310000
093200             IF  PS-COMMAREA-NOT-VALID                            09320000
093300                 SET DP020-NEXT-ACT-APPL-ERROR                    09330000
093400                                   TO TRUE                        09340000
093500             ELSE                                                 09350000
093600                 PERFORM 4000-BUILD-INITIAL-PANEL                 09360000
093700             END-IF                                               09370000
093800                                                                  09380000
093900         WHEN DP020-NEXT-ACT-READ-MAP                             09390000
094000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09400000
094100                                   TO PV-TOP-ITEM                 09410000
094200             PERFORM 2000-PROCESS-PANEL                           09420000
094300                                                                  09430000
094400         WHEN DP020-NEXT-ACT-RETURN                               09440000
094500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09450000
094600                                   TO PV-TOP-ITEM                 09460000
094700             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09470000
094800             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 09480000
094900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09490000
095000                                                                  09500000
095100         WHEN OTHER                                               09510000
095200             SET DP013-LOGIC-ABEND TO TRUE                        09520000
095300             SET DP013-NO-ROLLBACK TO TRUE                        09530000
095400             MOVE '1000-CONTROL-PROCESSING'                       09540000
095500                                   TO DP013-PARAGRAPH             09550000
095600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    09560000
095700                                   TO DP013-MESSAGE-TEXT(1)       09570000
095800             PERFORM DP013-0000-PROCESS-ABEND                     09580000
095900     END-EVALUATE.                                                09590000
096000                                                                  09600000
096100 EJECT                                                            09610000
096200*----------------------------------------------------------------*09620000
096300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *09630000
096400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *09640000
096500*----------------------------------------------------------------*09650000
096600                                                                  09660000
096700 1100-PROCESS-INTER-APPL-COMM.                                    09670000
096800                                                                  09680000
096900******COMING FROM SUWS002 CRIT SPEC                               09690000
097000                                                                  09700000
097100     SET PS-COMMAREA-VALID          TO TRUE.                      09710000
097200     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    09720000
097300     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          09730000
097400                                                                  09740000
097500         MOVE SU002-OPER-UNT-ID     TO ASC-OPER-UNT-ID            09750000
097600         MOVE SU002-FCLTY-ID        TO ASC-FCLTY-ID               09760000
097700         MOVE SU002-FCLTY-NME       TO ASC-FCLTY-NME              09770000
097800         MOVE SU002-SCAC            TO ASC-SCAC-ID                09780000
097900         MOVE SU002-TRLR-NBR        TO ASC-VEH-NBR                09790000
098000         MOVE SU002-TRIP-ID         TO ASC-TRIP-ID                09800000
098100         MOVE SU002-PO-NBR          TO PV-PO-NBR                  09810000
098200                                       DK-PO-NBR                  09820000
098300         MOVE SU002-REC-SEQ-NBR     TO PV-RECEIVER                09830000
098400                                       DK-REC-SEQ-NBR             09840000
098500          IF ASC-TRIP-ID GREATER THAN ZEROS                       09850000
098600              CONTINUE                                            09860000
098700          ELSE                                                    09870000
098800             IF  PV-PO-NBR GREATER THAN ZEROS                     09880000
098900                 AND PV-RECEIVER GREATER THAN ZEROS               09890000
099000                    PERFORM 7200-GET-TRIP-ID                      09900000
099100             ELSE                                                 09910000
099200             SET PS-ERROR          TO TRUE                        09920000
099300                    MOVE PC-TSYMSG-00050       TO DP020-MSG-NUMBER09930000
099400                    SET  PS-COMMAREA-NOT-VALID TO TRUE            09940000
099500             END-IF                                               09950000
099600          END-IF                                                  09960000
099700     END-IF.                                                      09970000
099800     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              09980000
099900       IF SU003-NUMBER-OF-SELECTED-ITEMS > 0                      09990000
100000         MOVE SU003-OPER-UNT-ID        TO ASC-OPER-UNT-ID         10000000
100100         MOVE SU003-FCLTY-ID           TO ASC-FCLTY-ID            10010000
100200         MOVE SU003-FCLTY-NME          TO ASC-FCLTY-NME           10020000
100300         MOVE SU003-SCAC-CDE           TO ASC-SCAC-ID             10030000
100400         MOVE SU003-TRLR-NBR           TO ASC-VEH-NBR             10040000
100500         MOVE SU003-TRIP-ID            TO ASC-TRIP-ID             10050000
100600                                                                  10060000
100700         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    10070000
100800         MOVE SU003-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  10080000
100900         MOVE SU003-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   10090000
101000                                                                  10100000
101100         PERFORM 1120-PREPARE-LIST-ENTRY                          10110000
101200       ELSE                                                       10120000
101300         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           10130000
101400         SET  PS-COMMAREA-NOT-VALID TO TRUE                       10140000
101500       END-IF                                                     10150000
101600     END-IF.                                                      10160000
101700                                                                  10170000
101800 EJECT                                                            10180000
101900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10190000
102000 1120-PREPARE-LIST-ENTRY.                                         10200000
102100                                                                  10210000
102200     MOVE SU004-MAX-ITEMS          TO ASC-SEL-SUB.                10220000
102300     MOVE ZERO                     TO ASC-SEL-ITEM.               10230000
102400     PERFORM 1130-GET-NEXT-RECORD.                                10240000
102500                                                                  10250000
102600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10260000
102700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*10270000
102800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10280000
102900 1130-GET-NEXT-RECORD.                                            10290000
103000                                                                  10300000
103100     ADD +1                       TO ASC-SEL-SUB.                 10310000
103200                                                                  10320000
103300     IF  ASC-SEL-SUB > SU004-MAX-ITEMS                            10330000
103400         ADD +1                   TO ASC-SEL-ITEM                 10340000
103500         MOVE +1                  TO ASC-SEL-SUB                  10350000
103600     END-IF.                                                      10360000
103700                                                                  10370000
103800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10380000
103900         PERFORM 9100-READ-SEL-QUEUE                              10390000
104000         IF  SU004-ITEM (ASC-SEL-SUB) > ZERO                      10400000
104100             MOVE ZEROS TO ASC-TOT-EXP-CRTNS                      10410000
104200             MOVE ZEROS TO ASC-TOT-ACTL-CRTNS                     10420000
104300             MOVE ZEROS TO ASC-TOT-EXP-SCAN                       10430000
104400             MOVE ZEROS TO ASC-TOT-ACTL-SCN                       10440000
104500             MOVE ZEROS TO ASC-TOT-UNITS                          10450000
104600             MOVE SU004-SCAC-CDE   (ASC-SEL-SUB)                  10460000
104700                                       TO ASC-SCAC-ID             10470000
104800             MOVE SU004-VEH-NBR     (ASC-SEL-SUB)                 10480000
104900                                       TO ASC-VEH-NBR             10490000
105000             MOVE SU004-TRIP-ID   (ASC-SEL-SUB)                   10500000
105100                                       TO ASC-TRIP-ID             10510000
105200                                                                  10520000
105300             SET SU004-INQ (ASC-SEL-SUB)                          10530000
105400                                  TO TRUE                         10540000
105500             PERFORM 9200-REWRITE-SEL-QUEUE                       10550000
105600         ELSE                                                     10560000
105700             SUBTRACT +1 FROM ASC-SEL-SUB                         10570000
105800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             10580000
105900             SET DP020-MSG-INFORMATIONAL                          10590000
106000                 PS-LIST-END             TO TRUE                  10600000
106100         END-IF                                                   10610000
106200     ELSE                                                         10620000
106300         SUBTRACT +1 FROM ASC-SEL-ITEM                            10630000
106400         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  10640000
106500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             10650000
106600             SET DP020-MSG-INFORMATIONAL                          10660000
106700                 PS-LIST-END             TO TRUE                  10670000
106800     END-IF.                                                      10680000
106900                                                                  10690000
107000/                                                                 10700000
107100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10710000
107200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *10720000
107300*    PROCESSED.                                                  *10730000
107400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10740000
107500                                                                  10750000
107600 1140-GET-PREV-RECORD.                                            10760000
107700                                                                  10770000
107800     SUBTRACT +1 FROM ASC-SEL-SUB.                                10780000
107900                                                                  10790000
108000     IF  ASC-SEL-SUB < +1                                         10800000
108100         SUBTRACT +1 FROM ASC-SEL-ITEM                            10810000
108200         MOVE SU004-MAX-ITEMS     TO ASC-SEL-SUB                  10820000
108300     END-IF.                                                      10830000
108400                                                                  10840000
108500     IF  ASC-SEL-ITEM > ZERO                                      10850000
108600         PERFORM 9100-READ-SEL-QUEUE                              10860000
108700             MOVE ZEROS TO ASC-TOT-EXP-CRTNS                      10870000
108800             MOVE ZEROS TO ASC-TOT-ACTL-CRTNS                     10880000
108900             MOVE ZEROS TO ASC-TOT-EXP-SCAN                       10890000
109000             MOVE ZEROS TO ASC-TOT-ACTL-SCN                       10900000
109100             MOVE ZEROS TO ASC-TOT-UNITS                          10910000
109200             MOVE SU004-SCAC-CDE   (ASC-SEL-SUB)                  10920000
109300                                       TO ASC-SCAC-ID             10930000
109400             MOVE SU004-VEH-NBR     (ASC-SEL-SUB)                 10940000
109500                                       TO ASC-VEH-NBR             10950000
109600             MOVE SU004-TRIP-ID   (ASC-SEL-SUB)                   10960000
109700                                       TO ASC-TRIP-ID             10970000
109800         SET SU004-INQ (ASC-SEL-SUB)                              10980000
109900                                  TO TRUE                         10990000
110000         PERFORM 9200-REWRITE-SEL-QUEUE                           11000000
110100     ELSE                                                         11010000
110200         MOVE +1                  TO ASC-SEL-ITEM                 11020000
110300                                     ASC-SEL-SUB                  11030000
110400         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11040000
110500             SET DP020-MSG-INFORMATIONAL                          11050000
110600                 PS-LIST-END             TO TRUE                  11060000
110700     END-IF.                                                      11070000
110800                                                                  11080000
110900                                                                  11090000
111000                                                                  11100000
111100*----------------------------------------------------------------*11110000
111200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11120000
111300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11130000
111400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11140000
111500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11150000
111600* FUNCTION KEYS CAN GET THIS FAR.                                *11160000
111700*----------------------------------------------------------------*11170000
111800                                                                  11180000
111900 2000-PROCESS-PANEL.                                              11190000
112000     EVALUATE TRUE                                                11200000
112100         WHEN DP020-SRC-AID = DP016-CLEAR                         11210000
112200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11220000
112300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11230000
112400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11240000
112500                                                                  11250000
112600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11260000
112700             MOVE ASC-OPER-UNT-ID   TO DK-OPER-UNT-ID             11270000
112800             MOVE ASC-FCLTY-ID      TO DK-FCLTY-ID                11280000
112900             MOVE ASC-SCAC-ID       TO DK-SCAC-ID                 11290000
113000             MOVE ASC-VEH-NBR       TO DK-VEHICLE-NBR             11300000
113100             MOVE ASC-TRIP-ID       TO DK-TRIP-ID                 11310000
113200             MOVE ASC-STATUS        TO DK-STATUS-CDE              11320000
113300                                                                  11330000
113400             PERFORM 2050-DELETE-LIST-QUEUE                       11340000
113500             MOVE ZEROS TO ASC-TOT-EXP-CRTNS                      11350000
113600             MOVE ZEROS TO ASC-TOT-ACTL-CRTNS                     11360000
113700             MOVE ZEROS TO ASC-TOT-EXP-SCAN                       11370000
113800             MOVE ZEROS TO ASC-TOT-ACTL-SCN                       11380000
113900             MOVE ZEROS TO ASC-TOT-UNITS                          11390000
114000             PERFORM 4000-BUILD-INITIAL-PANEL                     11400000
114100                                                                  11410000
114200         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    11420000
114300             PERFORM 2140-DESELECT-ALL-ITEMS                      11430000
114400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11440000
114500                                                                  11450000
114600         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  11460000
114700             PERFORM 2150-SELECT-ALL-ITEMS                        11470000
114800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11480000
114900                                                                  11490000
115000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11500000
115100           IF  ASC-USE-SELECTION-QUEUE                            11510000
115200               PERFORM 1130-GET-NEXT-RECORD                       11520000
115300               IF PS-LIST-END                                     11530000
115400                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           11540000
115500                   SET PS-NO-LIST-END TO TRUE                     11550000
115600               ELSE                                               11560000
115700                   PERFORM 2050-DELETE-LIST-QUEUE                 11570000
115800                   PERFORM 3200-RESET-ATTRIBUTES                  11580000
115900                   PERFORM 4000-BUILD-INITIAL-PANEL               11590000
116000               END-IF                                             11600000
116100            ELSE                                                  11610000
116200               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               11620000
116300*              --- BOTTOM OF LIST ---                             11630000
116400               MOVE PC-TSYMSG-00070                               11640000
116500                                 TO DP020-MSG-NUMBER              11650000
116600               SET DP020-MSG-INFORMATIONAL                        11660000
116700                                 TO TRUE                          11670000
116800           END-IF                                                 11680000
116900                                                                  11690000
117000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             11700000
117100           IF  ASC-USE-SELECTION-QUEUE                            11710000
117200               PERFORM 1140-GET-PREV-RECORD                       11720000
117300               IF PS-LIST-END                                     11730000
117400                   PERFORM 4400-MOVE-COMMAREA-TO-SCREEN           11740000
117500                   SET PS-NO-LIST-END                             11750000
117600                                 TO TRUE                          11760000
117700               ELSE                                               11770000
117800                   PERFORM 2050-DELETE-LIST-QUEUE                 11780000
117900                   PERFORM 3200-RESET-ATTRIBUTES                  11790000
118000                   PERFORM 4000-BUILD-INITIAL-PANEL               11800000
118100               END-IF                                             11810000
118200           ELSE                                                   11820000
118300               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               11830000
118400               MOVE PC-TSYMSG-00069                               11840000
118500                                 TO DP020-MSG-NUMBER              11850000
118600               SET DP020-MSG-INFORMATIONAL                        11860000
118700                                 TO TRUE                          11870000
118800           END-IF                                                 11880000
118900                                                                  11890000
119000         WHEN OTHER                                               11900000
119100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 11910000
119200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11920000
119300             IF  PS-NO-ERROR                                      11930000
119400                 SET DP030-CONTINUE-GO                            11940000
119500                                 TO TRUE                          11950000
119600                 PERFORM 2100-CHECK-FUNCTION-KEY                  11960000
119700             ELSE                                                 11970000
119800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11980000
119900                 SET DP030-OVERRIDE-GO                            11990000
120000                                 TO TRUE                          12000000
120100             END-IF                                               12010000
120200     END-EVALUATE.                                                12020000
120300 EJECT                                                            12030000
120400*----------------------------------------------------------------*12040000
120500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12050000
120600*----------------------------------------------------------------*12060000
120700 2050-DELETE-LIST-QUEUE.                                          12070000
120800                                                                  12080000
120900     EXEC CICS                                                    12090000
121000         DELETEQ TS                                               12100000
121100             QUEUE (ASC-LIST-QUEUE-NAME)                          12110000
121200             RESP  (PV-CICS-RESP)                                 12120000
121300     END-EXEC.                                                    12130000
121400                                                                  12140000
121500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12150000
121600        (PV-CICS-RESP = DFHRESP(QIDERR))                          12160000
121700         CONTINUE                                                 12170000
121800     ELSE                                                         12180000
121900         SET DP013-CICS-ABEND      TO TRUE                        12190000
122000         SET DP013-NO-ROLLBACK     TO TRUE                        12200000
122100                                                                  12210000
122200         MOVE '2050-DELETE-LIST-QUEUE'                            12220000
122300                                   TO DP013-PARAGRAPH             12230000
122400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    12240000
122500                                   TO DP013-MESSAGE-TEXT (1)      12250000
122600         PERFORM DP013-0000-PROCESS-ABEND                         12260000
122700     END-IF.                                                      12270000
122800                                                                  12280000
122900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  12290000
123000 EJECT                                                            12300000
123100*----------------------------------------------------------------*12310000
123200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*12320000
123300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *12330000
123400* CICS ARCHITECTURE API.                                         *12340000
123500*----------------------------------------------------------------*12350000
123600***********************************                               12360000
123700*                                                                 12370000
123800***********************************                               12380000
123900                                                                  12390000
124000 2100-CHECK-FUNCTION-KEY.                                         12400000
124100     SET SU003-UPDATE-TSQ TO TRUE.                                12410000
124200     EVALUATE TRUE                                                12420000
124300****F23 **PO/RCVR CARTON LIST*** (SUKCS553)                       12430000
124400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              12440000
124500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12450000
124600                 INITIALIZE SU003-INTER-APPL-COMMAREA             12460000
124700                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12470000
124800                                TO SU003-NUMBER-OF-SELECTED-ITEMS 12480000
124900                 MOVE ASC-OPER-UNT-ID                             12490000
125000                                TO SU003-OPER-UNT-ID              12500000
125100                 MOVE ASC-FCLTY-ID                                12510000
125200                                TO SU003-FCLTY-ID                 12520000
125300                 MOVE ASC-FCLTY-NME                               12530000
125400                                TO SU003-FCLTY-NME                12540000
125500                 MOVE ASC-SCAC-ID                                 12550000
125600                                TO SU003-SCAC-CDE                 12560000
125700                 MOVE ASC-VEH-NBR                                 12570000
125800                                TO SU003-TRLR-NBR                 12580000
125900                 MOVE ASC-TRIP-ID                                 12590000
126000                                TO SU003-TRIP-ID                  12600000
126100                                                                  12610000
126200                 PERFORM 5000-PREPARE-SEL-QUEUE                   12620000
126300             ELSE                                                 12630000
126400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12640000
126500                 SET DP030-OVERRIDE-GO                            12650000
126600                                   TO TRUE                        12660000
126700                 MOVE PC-TSYMSG-00057                             12670000
126800                                   TO DP020-MSG-NUMBER            12680000
126900                 SET DP020-MSG-WARNING                            12690000
127000                                   TO TRUE                        12700000
127100             END-IF                                               12710000
127200****F24 **PO/RCVR CARTON LIST*** (SUKCS539)                       12720000
127210         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              12721000
127220*            IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12722000
127221                 INITIALIZE SU009-INTER-APPL-COMMAREA             12722100
127222                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12722200
127223                           TO SU009-NUMBER-OF-SELECTED-ITEMS      12722300
127224                 MOVE ASC-TRIP-ID                                 12722400
127225                                TO SU009-TRIP-ID                  12722500
127226                 MOVE ASC-OPER-UNT-ID                             12722600
127227                                TO SU009-OPER-UNT-ID              12722700
127228                 MOVE ASC-TRIP-ID      TO SU009-TRIP-ID           12722800
127229                 MOVE ASC-SCAC-ID      TO SU009-SCAC-CDE          12722900
127230                 MOVE ASC-VEH-NBR      TO SU009-TRLR-ID           12723000
127231*                MOVE ASC-PO-RCVR      TO SU009-PO-RCVR           12723100
127232*                MOVE ASC-LINE-NUMBER  TO SU009-LINE-NBR          12723200
127233*                MOVE ASC-STR-NBR      TO SU009-DEST-STR-NBR      12723300
127234*                MOVE ASC-OUTBND-CRTNS TO SU009-TOT-CRTNS         12723400
127235*                MOVE ASC-PACKAGE      TO SU009-PACKAGE           12723500
127236                 PERFORM 5000-PREPARE-SEL-QUEUE                   12723600
127237*            ELSE                                                 12723700
127238*                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12723800
127239*                SET DP030-OVERRIDE-GO TO TRUE                    12723900
127240*                MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         12724000
127241*                SET DP020-MSG-WARNING TO TRUE                    12724100
127242*            END-IF                                               12724200
127243****F14 RCVRING**(RCKCS223)                                       12724300
127244                                                                  12724400
127245         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              12724500
127246             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12724600
127247                 INITIALIZE RC015-INTER-APPL-COMMAREA             12724700
127248                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12724800
127249                                TO RC015-NUMBER-OF-SELECTED-ITEMS 12724900
127250                 MOVE ASC-OPER-UNT-ID                             12725000
127260                                TO RC015-OPER-UNT-ID              12726000
127270                 MOVE ASC-FCLTY-ID                                12727000
127280                                TO RC015-FCLTY-ID                 12728000
127290                                                                  12729000
127300                 PERFORM 5000-PREPARE-SEL-QUEUE                   12730000
127400                 SET ASC-FUNC02-RETURN-YES TO TRUE                12740000
127500                 IF PS-RECEIVER-DOESNT-EXIST                      12750000
127600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12760000
127700                     SET DP030-OVERRIDE-GO                        12770000
127800                                       TO TRUE                    12780000
127900                     MOVE PC-TSYMSG-02479                         12790000
128000                                       TO DP020-MSG-NUMBER        12800000
128100                     SET DP020-MSG-WARNING                        12810000
128200                                       TO TRUE                    12820000
128300                 END-IF                                           12830000
128400             ELSE                                                 12840000
128500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12850000
128600                 SET DP030-OVERRIDE-GO                            12860000
128700                                   TO TRUE                        12870000
128800                 MOVE PC-TSYMSG-00057                             12880000
128900                                   TO DP020-MSG-NUMBER            12890000
129000                 SET DP020-MSG-WARNING                            12900000
129100                                   TO TRUE                        12910000
129200             END-IF                                               12920000
129300                                                                  12930000
129400****F15 **RCVG RECEIVER UPDATE** (RCKCS221)                       12940000
129500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              12950000
129600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              12960000
129700                 INITIALIZE RC015-INTER-APPL-COMMAREA             12970000
129800                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                12980000
129900                                TO RC015-NUMBER-OF-SELECTED-ITEMS 12990000
130000                 MOVE ASC-OPER-UNT-ID                             13000000
130100                                TO RC015-OPER-UNT-ID              13010000
130200                 MOVE ASC-FCLTY-ID                                13020000
130300                                TO RC015-FCLTY-ID                 13030000
130400                                                                  13040000
130500                 PERFORM 5000-PREPARE-SEL-QUEUE                   13050000
130600****   IF ANY OF THE SELECTED RECORDS IS FOR A VERIFIED RECEIVER, 13060000
130700****   DO NOT PASS CONTROL TO ANOTHER PROGRAM.  DISPLAY AN ERROR  13070000
130800****   MESSAGE.  THE INITIALIZATION OF THE ASC-BLOCK-ENTRIES IS   13080000
130900****   DONE TO FORCE THE PROGRAM TO REBUILD THE SCREEN FROM THE   13090000
131000****   LQW.  THE LQW-ACTION FIELDS WERE UPDATE WITH 'ERR' FOR THE 13100000
131100****   LIST ITEMS THAT HAD VERIFIED RECEIVERS.                    13110000
131200                 IF PS-VERIFIED-RECEIVER                          13120000
131300                     SET DP030-OVERRIDE-GO                        13130000
131400                                       TO TRUE                    13140000
131500                     MOVE PC-TSYMSG-00463                         13150000
131600                                 TO DP020-MSG-NUMBER              13160000
131700                     SET DP020-MSG-WARNING                        13170000
131800                                       TO TRUE                    13180000
131900                     INITIALIZE        ASC-BLOCK-ENTRIES (1)      13190000
132000                                       ASC-BLOCK-ENTRIES (2)      13200000
132100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13210000
132200                 ELSE                                             13220000
132300                     SET ASC-FUNC03-RETURN-YES TO TRUE            13230000
132400             ELSE                                                 13240000
132500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13250000
132600                 SET DP030-OVERRIDE-GO                            13260000
132700                                   TO TRUE                        13270000
132800                 MOVE PC-TSYMSG-00057                             13280000
132900                                   TO DP020-MSG-NUMBER            13290000
133000                 SET DP020-MSG-WARNING                            13300000
133100                                   TO TRUE                        13310000
133200             END-IF                                               13320000
133300                                                                  13330000
133400****F13 **SUSPEND LIST ** (RCKCS299)                              13340000
133500         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              13350000
133600             INITIALIZE RC015-INTER-APPL-COMMAREA                 13360000
133700             MOVE ASC-TRIP-ID         TO RC015-TRIP-ID            13370000
133800             MOVE ASC-OPER-UNT-ID     TO RC015-OPER-UNT-ID        13380000
133900*            IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13390000
134000*                INITIALIZE RC015-INTER-APPL-COMMAREA             13400000
134100*                MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13410000
134200*                               TO RC015-NUMBER-OF-SELECTED-ITEMS 13420000
134300*                MOVE ASC-OPER-UNT-ID                             13430000
134400*                               TO RC015-OPER-UNT-ID              13440000
134500*                MOVE ASC-FCLTY-ID                                13450000
134600*                               TO RC015-FCLTY-ID                 13460000
134700*                                                                 13470000
134800*                PERFORM 5000-PREPARE-SEL-QUEUE                   13480000
134900*                SET ASC-FUNC07-RETURN-YES TO TRUE                13490000
135000*                IF PS-RECEIVER-DOESNT-EXIST                      13500000
135100*                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13510000
135200*                    SET DP030-OVERRIDE-GO                        13520000
135300*                                      TO TRUE                    13530000
135400*                    MOVE PC-TSYMSG-02479                         13540000
135500*                                      TO DP020-MSG-NUMBER        13550000
135600*                    SET DP020-MSG-WARNING                        13560000
135700*                                      TO TRUE                    13570000
135800*                END-IF                                           13580000
135900*            ELSE                                                 13590000
136000*                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13600000
136100*                SET DP030-OVERRIDE-GO                            13610000
136200*                                  TO TRUE                        13620000
136300*                MOVE PC-TSYMSG-00057                             13630000
136400*                                  TO DP020-MSG-NUMBER            13640000
136500*                SET DP020-MSG-WARNING                            13650000
136600*                                  TO TRUE                        13660000
136700*            END-IF                                               13670000
136800                                                                  13680000
136900****F16 **FREE ASTRAY LIST ** (SUKCS761)                          13690000
137000         WHEN DP020-FK-LOCAL-FUNC-09(DP020-SRC-AID)               13700000
137100             INITIALIZE SU046-INTER-APPL-COMMAREA                 13710000
137200             MOVE ASC-OPER-UNT-ID                                 13720000
137300                                TO SU046-OPER-UNT-ID              13730000
137400             MOVE ASC-FCLTY-ID                                    13740000
137500                                TO SU046-FCLTY-ID                 13750000
137600             MOVE ASC-FCLTY-NME                                   13760000
137700                                TO SU046-FCLTY-NME                13770000
137800             MOVE ASC-SCAC-ID                                     13780000
137900                                TO SU046-SCAC                     13790000
138000             MOVE ASC-VEH-NBR                                     13800000
138100                                TO SU046-TRLR-NBR                 13810000
138200*            SET ASC-FUNC09-RETURN-YES TO TRUE                    13820000
138300                                                                  13830000
138400****F17 **P2L/CASEPACK ** (PCKCS700)                              13840000
138500         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              13850000
138600             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13860000
138700                 INITIALIZE RC015-INTER-APPL-COMMAREA             13870000
138800                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13880000
138900                                TO RC015-NUMBER-OF-SELECTED-ITEMS 13890000
139000                 MOVE ASC-OPER-UNT-ID                             13900000
139100                                TO RC015-OPER-UNT-ID              13910000
139200                 MOVE ASC-FCLTY-ID                                13920000
139300                                TO RC015-FCLTY-ID                 13930000
139400                                                                  13940000
139500                 PERFORM 5000-PREPARE-SEL-QUEUE                   13950000
139600                 SET ASC-FUNC05-RETURN-YES TO TRUE                13960000
139700                 IF PS-RECEIVER-DOESNT-EXIST                      13970000
139800                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         13980000
139900                     SET DP030-OVERRIDE-GO                        13990000
140000                                       TO TRUE                    14000000
140100                     MOVE PC-TSYMSG-02479                         14010000
140200                                       TO DP020-MSG-NUMBER        14020000
140300                     SET DP020-MSG-WARNING                        14030000
140400                                       TO TRUE                    14040000
140500                 END-IF                                           14050000
140600             ELSE                                                 14060000
140700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14070000
140800                 SET DP030-OVERRIDE-GO                            14080000
140900                                   TO TRUE                        14090000
141000                 MOVE PC-TSYMSG-00057                             14100000
141100                                   TO DP020-MSG-NUMBER            14110000
141200                 SET DP020-MSG-WARNING                            14120000
141300                                   TO TRUE                        14130000
141400             END-IF                                               14140000
141500                                                                  14150000
141600****F18 ***PO REPORT REQUEST SCREEN*** (SUKCS556)                 14160000
141700         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              14170000
141800             IF  ASC-NUMBER-OF-ITEMS-READ =                       14180000
141900                 ASC-NUMBER-OF-SELECTED-ITEMS                     14190000
142000                    MOVE 'Y' TO ASC-ALL-PO-IND                    14200000
142100             ELSE                                                 14210000
142200                    MOVE 'N' TO ASC-ALL-PO-IND                    14220000
142300             END-IF                                               14230000
142400                                                                  14240000
142500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14250000
142600                 INITIALIZE SU003-INTER-APPL-COMMAREA             14260000
142700                 MOVE ASC-ALL-PO-IND                              14270000
142800                                TO SU003-ALL-PO-IND               14280000
142900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14290000
143000                                TO SU003-NUMBER-OF-SELECTED-ITEMS 14300000
143100                 MOVE ASC-OPER-UNT-ID                             14310000
143200                                TO SU003-OPER-UNT-ID              14320000
143300                 MOVE ASC-FCLTY-ID                                14330000
143400                                TO SU003-FCLTY-ID                 14340000
143500                 MOVE ASC-FCLTY-NME                               14350000
143600                                TO SU003-FCLTY-NME                14360000
143700                 MOVE ASC-TRIP-ID                                 14370000
143800                                TO SU003-TRIP-ID                  14380000
143900                 MOVE ASC-SCAC-ID                                 14390000
144000                                TO SU003-SCAC-CDE                 14400000
144100                 MOVE ASC-VEH-NBR                                 14410000
144200                                TO SU003-TRLR-NBR                 14420000
144300                                                                  14430000
144400                 PERFORM 5000-PREPARE-SEL-QUEUE                   14440000
144500                 SET SU003-NO-TSQ-UPDATE TO TRUE                  14450000
144600             ELSE                                                 14460000
144700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14470000
144800                 SET DP030-OVERRIDE-GO                            14480000
144900                                   TO TRUE                        14490000
145000                 MOVE PC-TSYMSG-00057                             14500000
145100                                   TO DP020-MSG-NUMBER            14510000
145200                 SET DP020-MSG-WARNING                            14520000
145300                                   TO TRUE                        14530000
145400             END-IF                                               14540000
145500*LMM                                                              14550000
145600****F22 **PBS SMOOTHING ** (PCKCS709)                             14560000
145700         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              14570000
145800             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              14580000
145900                 INITIALIZE PC236-INTER-APPL-COMMAREA             14590000
146000                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                14600000
146100                                TO PC236-NUMBER-OF-SELECTED-ITEMS 14610000
146200                 MOVE ASC-OPER-UNT-ID                             14620000
146300                                TO PC236-OPER-UNT-ID              14630000
146400                 MOVE ASC-FCLTY-ID                                14640000
146500                                TO PC236-FCLTY-ID                 14650000
146600                                                                  14660000
146700                 PERFORM 5000-PREPARE-SEL-QUEUE                   14670000
146800                 SET ASC-FUNC06-RETURN-YES TO TRUE                14680000
146900                 IF PS-RECEIVER-DOESNT-EXIST                      14690000
147000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14700000
147100                     SET DP030-OVERRIDE-GO                        14710000
147200                                       TO TRUE                    14720000
147300                     MOVE PC-TSYMSG-02479                         14730000
147400                                       TO DP020-MSG-NUMBER        14740000
147500                     SET DP020-MSG-WARNING                        14750000
147600                                       TO TRUE                    14760000
147700                 END-IF                                           14770000
147800             ELSE                                                 14780000
147900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14790000
148000                 SET DP030-OVERRIDE-GO                            14800000
148100                                   TO TRUE                        14810000
148200                 MOVE PC-TSYMSG-00057                             14820000
148300                                   TO DP020-MSG-NUMBER            14830000
148400                 SET DP020-MSG-WARNING                            14840000
148500                                   TO TRUE                        14850000
148600             END-IF                                               14860000
148700                                                                  14870000
148800*                                                                 14880000
148900* F6 - FIRST PAGE                                                 14890000
149000*                                                                 14900000
149100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  14910000
149200             MOVE +1               TO PV-TOP-ITEM                 14920000
149300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14930000
149400*                                                                 14940000
149500* F7 - PREVIOUS PAGE                                              14950000
149600*                                                                 14960000
149700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   14970000
149800             PERFORM 2110-BROWSE-BACKWARD                         14980000
149900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14990000
150000*                                                                 15000000
150100* F8 - NEXT PAGE                                                  15010000
150200*                                                                 15020000
150300         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   15030000
150400             PERFORM 2120-BROWSE-FORWARD                          15040000
150500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15050000
150600*                                                                 15060000
150700* ENTER KEY                                                       15070000
150800*                                                                 15080000
150900         WHEN DP020-SRC-AID = DP016-ENTER                         15090000
151000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15100000
151100             IF  PS-ERROR                                         15110000
151200                 CONTINUE                                         15120000
151300             ELSE                                                 15130000
151400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15140000
151500             END-IF                                               15150000
151600                                                                  15160000
151700         WHEN OTHER                                               15170000
151800             SET DP013-NO-ROLLBACK                                15180000
151900                 DP013-XCTL-DISPLAY-RESTART                       15190000
152000                 DP013-CICS-ABEND  TO TRUE                        15200000
152100             MOVE '2100-CHECK-FUNCTION-KEY'                       15210000
152200                                   TO DP013-PARAGRAPH             15220000
152300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      15230000
152400                                   TO DP013-MESSAGE-TEXT (1)      15240000
152500             PERFORM DP013-0000-PROCESS-ABEND                     15250000
152600     END-EVALUATE.                                                15260000
152700*                                                                 15270000
152800*----------------------------------------------------------------*15280000
152900*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *15290000
153000*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *15300000
153100*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *15310000
153200*    MESSAGE.                                                    *15320000
153300*----------------------------------------------------------------*15330000
153400                                                                  15340000
153500 2110-BROWSE-BACKWARD.                                            15350000
153600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15360000
153700         GIVING PV-TOP-ITEM.                                      15370000
153800                                                                  15380000
153900     IF  ((PV-TOP-ITEM < +1)                                      15390000
154000       OR (PV-TOP-ITEM = +1))                                     15400000
154100         MOVE +1                   TO PV-TOP-ITEM                 15410000
154200*        -- TOP OF LIST --                                        15420000
154300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            15430000
154400         SET DP020-MSG-INFORMATIONAL TO TRUE                      15440000
154500     END-IF.                                                      15450000
154600                                                                  15460000
154700 EJECT                                                            15470000
154800*----------------------------------------------------------------*15480000
154900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *15490000
155000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *15500000
155100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *15510000
155200*----------------------------------------------------------------*15520000
155300                                                                  15530000
155400 2120-BROWSE-FORWARD.                                             15540000
155500                                                                  15550000
155600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15560000
155700         GIVING PV-TOP-ITEM.                                      15570000
155800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   15580000
155900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15590000
156000                                   TO PV-TOP-ITEM                 15600000
156100*        -- BOTTOM OF LIST --                                     15610000
156200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15620000
156300         SET DP020-MSG-INFORMATIONAL                              15630000
156400                                   TO TRUE                        15640000
156500     ELSE                                                         15650000
156600         COMPUTE PV-BOTTOM-ITEM =                                 15660000
156700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15670000
156800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            15680000
156900*            -- BOTTOM OF LIST --                                 15690000
157000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15700000
157100             SET DP020-MSG-INFORMATIONAL                          15710000
157200                                   TO TRUE                        15720000
157300         END-IF                                                   15730000
157400     END-IF.                                                      15740000
157500 EJECT                                                            15750000
157600*----------------------------------------------------------------*15760000
157700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *15770000
157800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *15780000
157900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *15790000
158000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *15800000
158100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *15810000
158200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *15820000
158300*----------------------------------------------------------------*15830000
158400                                                                  15840000
158500 2130-CHECK-FOR-JUMP-BROWSE.                                      15850000
158600     SET PS-NO-ERROR               TO TRUE.                       15860000
158700     IF (ASC-START-ITEM-REQUEST = SPACE)                          15870000
158800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15880000
158900                                   TO PV-TOP-ITEM                 15890000
159000     ELSE                                                         15900000
159100         MOVE ASC-START-ITEM-REQUEST                              15910000
159200                                   TO DP010I-UNEDITED-FIELD       15920000
159300         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15930000
159400         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15940000
159500         SET DP010I-NEGATIVE-NOT-ALLOWED                          15950000
159600                                   TO TRUE                        15960000
273427         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15980008
273427              USING DP010I-NUMERIC-EDIT-AREA                      15981008
159800                                                                  15982006
159900         IF  NOT DP010I-ERROR-DETECTED                            15990000
160000             MOVE DP010I-NUMERIC-FIELD                            16000000
160100                                   TO  ASC-START-ITEM-REQUEST-N   16010000
160200             IF  ASC-START-ITEM-REQUEST-N > ZERO                  16020000
160300                 IF  ASC-START-ITEM-REQUEST-N >                   16030000
160400                                          ASC-NUMBER-OF-ITEMS-READ16040000
160500                     MOVE SPACE TO ASC-START-ITEM-REQUEST         16050000
160600                     COMPUTE PV-TOP-ITEM =                        16060000
160700                             ASC-NUMBER-OF-ITEMS-READ             16070000
160800                             - PC-ITEMS-PER-PANEL + 1             16080000
160900                     IF  PV-TOP-ITEM < +1                         16090000
161000                         MOVE +1   TO PV-TOP-ITEM                 16100000
161100                         MOVE PC-TSYMSG-00070                     16110000
161200                                   TO DP020-MSG-NUMBER            16120000
161300                         SET DP020-MSG-INFORMATIONAL              16130000
161400                                   TO TRUE                        16140000
161500                     END-IF                                       16150000
161600                 ELSE                                             16160000
161700                     MOVE ASC-START-ITEM-REQUEST-N                16170000
161800                                   TO PV-TOP-ITEM                 16180000
161900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      16190000
162000                     COMPUTE PV-BOTTOM-ITEM =                     16200000
162100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     16210000
162200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ16220000
162300*                        -- BOTTOM OF LIST --                     16230000
162400                         MOVE PC-TSYMSG-00070                     16240000
162500                                   TO DP020-MSG-NUMBER            16250000
162600                         SET DP020-MSG-INFORMATIONAL              16260000
162700                                   TO TRUE                        16270000
162800                     END-IF                                       16280000
162900                 END-IF                                           16290000
163000             ELSE                                                 16300000
163100*                --- VALUE OUT OF RANGE ----                      16310000
163200                 MOVE PC-TSYMSG-00101                             16320000
163300                                   TO DP020-MSG-NUMBER            16330000
163400                 MOVE -1           TO ASTRTITL                    16340000
163500                 SET DP030-SET-CURSOR-APPL-1                      16350000
163600                                   TO TRUE                        16360000
163700                 MOVE DP015-REVERSE                               16370000
163800                                   TO ASTRTITH                    16380000
163900                 MOVE DP015-RED    TO ASTRTITC                    16390000
164000                 MOVE DP015-UNP-NUM-BRT-MDT                       16400000
164100                                   TO ASTRTITA                    16410000
164200                 SET DP020-MSG-FATAL                              16420000
164300                                   TO TRUE                        16430000
164400                 SET PS-ERROR      TO TRUE                        16440000
164500             END-IF                                               16450000
164600                                                                  16460000
164700         ELSE                                                     16470000
164800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            16480000
164900             MOVE -1               TO ASTRTITL                    16490000
165000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16500000
165100             MOVE DP015-REVERSE    TO ASTRTITH                    16510000
165200             MOVE DP015-RED        TO ASTRTITC                    16520000
165300             MOVE DP015-UNP-NUM-BRT-MDT                           16530000
165400                                   TO ASTRTITA                    16540000
165500             SET DP020-MSG-FATAL   TO TRUE                        16550000
165600             SET PS-ERROR          TO TRUE                        16560000
165700         END-IF                                                   16570000
165800     END-IF.                                                      16580000
165900 EJECT                                                            16590000
166000*----------------------------------------------------------------*16600000
166100*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *16610000
166200*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *16620000
166300*----------------------------------------------------------------*16630000
166400 2140-DESELECT-ALL-ITEMS.                                         16640000
166500     MOVE +1                       TO ASC-BLK-SUB.                16650000
166600                                                                  16660000
166700     PERFORM 2141-CLEAR-SELECTED-INDS                             16670000
166800         VARYING ASC-ITEM-SUB                                     16680000
166900         FROM 1 BY 1                                              16690000
167000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16700000
167100                                                                  16710000
167200     ADD +1                        TO ASC-BLK-SUB.                16720000
167300                                                                  16730000
167400     PERFORM 2141-CLEAR-SELECTED-INDS                             16740000
167500         VARYING ASC-ITEM-SUB                                     16750000
167600         FROM 1 BY 1                                              16760000
167700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16770000
167800                                                                  16780000
167900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16790000
168000                                   TO PV-LIST-ITEM-NUMBER.        16800000
168100                                                                  16810000
168200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16820000
168300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16830000
168400                                                                  16840000
168500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16850000
168600        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16860000
168700         MOVE +1                   TO ASC-BLK-SUB                 16870000
168800                                                                  16880000
168900         PERFORM 5100-WRITE-TEMP-STORAGE                          16890000
169000                                                                  16900000
169100         MOVE +1                   TO PV-BLOCK-NUMBER             16910000
169200                                                                  16920000
169300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16930000
169400             PV-FIRST-BLOCK-IN-ARRAY - 1                          16940000
169500                                                                  16950000
169600         PERFORM                                                  16960000
169700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16970000
169800                                                                  16980000
169900             PERFORM 4410-READ-TEMP-STORAGE                       16990000
170000                                                                  17000000
170100             PERFORM 2141-CLEAR-SELECTED-INDS                     17010000
170200                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 17020000
170300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17030000
170400                                                                  17040000
170500             PERFORM 5100-WRITE-TEMP-STORAGE                      17050000
170600                                                                  17060000
170700             ADD +1                TO PV-BLOCK-NUMBER             17070000
170800                                                                  17080000
170900         END-PERFORM                                              17090000
171000                                                                  17100000
171100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17110000
171200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17120000
171300                                                                  17130000
171400         PERFORM                                                  17140000
171500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17150000
171600                   ASC-HIGHEST-BLOCK-WRITTEN                      17160000
171700                                                                  17170000
171800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17180000
171900                                   TO PV-BLOCK-NUMBER             17190000
172000                                                                  17200000
172100             PERFORM 4410-READ-TEMP-STORAGE                       17210000
172200                                                                  17220000
172300             PERFORM 2141-CLEAR-SELECTED-INDS                     17230000
172400                 VARYING ASC-ITEM-SUB                             17240000
172500                 FROM 1 BY 1                                      17250000
172600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17260000
172700                                                                  17270000
172800             PERFORM 5100-WRITE-TEMP-STORAGE                      17280000
172900                                                                  17290000
173000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17300000
173100                                                                  17310000
173200         END-PERFORM                                              17320000
173300                                                                  17330000
173400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17340000
173500                                   TO PV-BLOCK-NUMBER             17350000
173600                                                                  17360000
173700         PERFORM 4410-READ-TEMP-STORAGE                           17370000
173800     END-IF.                                                      17380000
173900                                                                  17390000
174000                                                                  17400000
174100     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 17410000
174200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.17420000
174300     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  17430000
174400                                                                  17440000
174500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17450000
174600                                                                  17460000
174700 EJECT                                                            17470000
174800*----------------------------------------------------------------*17480000
174900*    MARK EACH ITEM AS BEING NOT SELECTED.                       *17490000
175000*----------------------------------------------------------------*17500000
175100                                                                  17510000
175200 2141-CLEAR-SELECTED-INDS.                                        17520000
175300                                                                  17530000
175400     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           17540000
175500             NOT EQUAL ZERO                                       17550000
175600         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17560000
175700             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17570000
175800                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17580000
175900                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17590000
176000                                   TO TRUE                        17600000
176100         END-IF                                                   17610000
176200     END-IF.                                                      17620000
176300                                                                  17630000
176400 EJECT                                                            17640000
176500*----------------------------------------------------------------*17650000
176600*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *17660000
176700*  FOR ALL ITEMS.                                                *17670000
176800*----------------------------------------------------------------*17680000
176900                                                                  17690000
177000 2150-SELECT-ALL-ITEMS.                                           17700000
177100                                                                  17710000
177200     MOVE +1                       TO ASC-BLK-SUB.                17720000
177300                                                                  17730000
177400     PERFORM 2151-SET-SELECTED-INDS                               17740000
177500         VARYING ASC-ITEM-SUB                                     17750000
177600         FROM 1 BY 1                                              17760000
177700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17770000
177800                                                                  17780000
177900     ADD +1                        TO ASC-BLK-SUB.                17790000
178000                                                                  17800000
178100     PERFORM 2151-SET-SELECTED-INDS                               17810000
178200         VARYING ASC-ITEM-SUB                                     17820000
178300         FROM 1 BY 1                                              17830000
178400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17840000
178500                                                                  17850000
178600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17860000
178700                                   TO PV-LIST-ITEM-NUMBER.        17870000
178800                                                                  17880000
178900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17890000
179000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17900000
179100                                                                  17910000
179200*10/13/00- BEGIN                                                  17920000
179300     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            17930000
179400         MOVE +1                   TO ASC-BLK-SUB                 17940000
179500                                                                  17950000
179600         PERFORM 5100-WRITE-TEMP-STORAGE                          17960000
179700         MOVE +2                   TO ASC-BLK-SUB                 17970000
179800         PERFORM 5100-WRITE-TEMP-STORAGE                          17980000
179900         MOVE +1                   TO ASC-BLK-SUB                 17990000
180000         MOVE +1                   TO PV-BLOCK-NUMBER             18000000
180100     END-IF.                                                      18010000
180200* 10/13/00 END                                                    18020000
180300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18030000
180400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18040000
180500         MOVE +1                   TO ASC-BLK-SUB                 18050000
180600                                                                  18060000
180700         PERFORM 5100-WRITE-TEMP-STORAGE                          18070000
180800                                                                  18080000
180900         MOVE +1                   TO PV-BLOCK-NUMBER             18090000
181000                                                                  18100000
181100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18110000
181200             PV-FIRST-BLOCK-IN-ARRAY - 1                          18120000
181300                                                                  18130000
181400         PERFORM                                                  18140000
181500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18150000
181600                                                                  18160000
181700             PERFORM 4410-READ-TEMP-STORAGE                       18170000
181800                                                                  18180000
181900             PERFORM 2151-SET-SELECTED-INDS                       18190000
182000                 VARYING ASC-ITEM-SUB                             18200000
182100                 FROM 1 BY 1                                      18210000
182200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18220000
182300                                                                  18230000
182400             PERFORM 5100-WRITE-TEMP-STORAGE                      18240000
182500                                                                  18250000
182600             ADD +1                TO PV-BLOCK-NUMBER             18260000
182700                                                                  18270000
182800         END-PERFORM                                              18280000
182900                                                                  18290000
183000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18300000
183100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18310000
183200                                                                  18320000
183300         PERFORM                                                  18330000
183400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18340000
183500                   ASC-HIGHEST-BLOCK-WRITTEN                      18350000
183600                                                                  18360000
183700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18370000
183800                                   TO PV-BLOCK-NUMBER             18380000
183900                                                                  18390000
184000             PERFORM 4410-READ-TEMP-STORAGE                       18400000
184100                                                                  18410000
184200             PERFORM 2151-SET-SELECTED-INDS                       18420000
184300                 VARYING ASC-ITEM-SUB                             18430000
184400                 FROM 1 BY 1                                      18440000
184500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18450000
184600                                                                  18460000
184700             PERFORM 5100-WRITE-TEMP-STORAGE                      18470000
184800                                                                  18480000
184900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18490000
185000                                                                  18500000
185100         END-PERFORM                                              18510000
185200                                                                  18520000
185300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18530000
185400                                   TO PV-BLOCK-NUMBER             18540000
185500                                                                  18550000
185600         PERFORM 4410-READ-TEMP-STORAGE                           18560000
185700     END-IF.                                                      18570000
185800                                                                  18580000
185900                                                                  18590000
186000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18600000
186100                       ASC-NUMBER-OF-SELECTED-ITEMS.              18610000
186200                                                                  18620000
186300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18630000
186400                                                                  18640000
186500 EJECT                                                            18650000
186600*----------------------------------------------------------------*18660000
186700*    MARK EACH ITEM AS BEING SELECTED.                           *18670000
186800*----------------------------------------------------------------*18680000
186900                                                                  18690000
187000 2151-SET-SELECTED-INDS.                                          18700000
187100                                                                  18710000
187200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18720000
187300             NOT EQUAL ZERO                                       18730000
187400         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18740000
187500             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18750000
187600                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18760000
187700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18770000
187800                               TO  TRUE                           18780000
187900         END-IF                                                   18790000
188000     END-IF.                                                      18800000
188100                                                                  18810000
188200******************************************************************18820000
188300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **18830000
188400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **18840000
188500******************************************************************18850000
188600 2200-MOVE-SCREEN-TO-COMMAREA.                                    18860000
188700                                                                  18870000
188800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18880000
188900     MOVE +1                       TO PV-SUB.                     18890000
189000                                                                  18900000
189100     PERFORM 3100-SET-SUBSCRIPTS.                                 18910000
189200     IF  ASTRTITL > ZERO                                          18920000
189300         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          18930000
189400     ELSE                                                         18940000
189500         IF  ASTRTITF = DP015-ERASE-EOF                           18950000
189600             INITIALIZE ASC-START-ITEM-REQUEST                    18960000
189700         END-IF                                                   18970000
189800     END-IF.                                                      18980000
189900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18990000
190000         VARYING PV-SUB                                           19000000
190100         FROM 1 BY 1                                              19010000
190200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      19020000
190300******************************************************************19030000
190400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**19040000
190500******************************************************************19050000
190600 2210-MOVE-LINES-TO-COMMAREA.                                     19060000
190700     IF  MR-SELECTL (PV-SUB) > ZERO                               19070000
190800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             19080000
190900         MOVE MR-SELECTI (PV-SUB)                                 19090000
191000                                   TO ASC-TEMP-SELECTED-SW        19100000
191100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19110000
191200     ELSE                                                         19120000
191300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                19130000
191400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     19140000
191500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        19150000
191600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19160000
191700         END-IF                                                   19170000
191800     END-IF.                                                      19180000
191900     ADD +1                        TO ASC-ITEM-SUB.               19190000
192000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19200000
192100         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     19210000
192200             COMPUTE PV-BLOCK-NUMBER  =                           19220000
192300                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         19230000
192400                    PC-ITEMS-PER-PANEL                            19240000
192500             PERFORM 5105-REWRITE-ASC-LISTQ                       19250000
192600         END-IF                                                   19260000
192700         ADD +1                    TO ASC-BLK-SUB                 19270000
192800         MOVE +1                   TO ASC-ITEM-SUB                19280000
192900     ELSE                                                         19290000
193000     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             19300000
193100         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     19310000
193200             COMPUTE PV-BLOCK-NUMBER  =                           19320000
193300                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         19330000
193400                    PC-ITEMS-PER-PANEL                            19340000
193500             PERFORM 5105-REWRITE-ASC-LISTQ                       19350000
193600         END-IF                                                   19360000
193700     END-IF.                                                      19370000
193800*----------------------------------------------------------------*19380000
193900*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          19390000
194000*----------------------------------------------------------------*19400000
194100 2300-CALL-AUTOVE-MODULE.                                         19410000
194200                                                                  19420000
194300     INITIALIZE RC040-FIELDS.                                     19430000
194400     IF PS-DC-LEVEL-YES                                           19440000
194500        SET RC040-DC-LEVEL     TO TRUE                            19450000
194600     END-IF                                                       19460000
194700     MOVE DK-OPER-UNT-ID       TO RC040-SIGNON-LOCATION.          19470000
194800     MOVE PV-PO-NBR            TO RC040-PO-NBR                    19480000
194900     MOVE PV-RECEIVER          TO RC040-PO-RCVR                   19490000
195000     MOVE DP020-USERID         TO RC040-USER-ID.                  19500000
195100     MOVE 'SUKCS552'           TO RC040-CALLING-PROGRAM.          19510000
195200                                                                  19520000
195300     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  19530000
195400                                        RC040-COMMAREA            19540000
195500                                        RC040-FIELDS.             19550000
195600                                                                  19560000
195700     EVALUATE TRUE                                                19570000
195800         WHEN RC040-SUCCESSFUL                                    19580000
195900              CONTINUE                                            19590000
196000         WHEN RC040-DATABASE-BUSY OR                              19600000
196100              RC040-INVALID-SQL                                   19610000
196200                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       19620000
196300                  SET DP020-MSG-WARNING TO TRUE                   19630000
196400                  SET DP030-OVERRIDE-GO TO TRUE                   19640000
196500                  SET PS-ERROR          TO TRUE                   19650000
196600         WHEN RC040-NOT-SUCCESSFUL                                19660000
196700                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       19670000
196800                  SET DP020-MSG-WARNING TO TRUE                   19680000
196900                  SET DP030-OVERRIDE-GO TO TRUE                   19690000
197000                  SET PS-ERROR          TO TRUE                   19700000
197100         WHEN OTHER                                               19710000
197200             MOVE '2300-CALL-AUTOVE-MODULE'  TO DP013-PARAGRAPH   19720000
197300             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              19730000
197400                                         TO DP013-MESSAGE-TEXT (1)19740000
197500             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)19750000
197600             MOVE PV-PO-NBR              TO DP013-MESSAGE-TEXT (3)19760000
197700             MOVE RC040-SQLCA            TO DP013-SQLCA           19770000
197800             SET DP013-DB2-ABEND                                  19780000
197900                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              19790000
198000             SET PS-ERROR                    TO TRUE              19800000
198100             PERFORM DP013-0000-PROCESS-ABEND                     19810000
198200                                                                  19820000
198300     END-EVALUATE.                                                19830000
198400/                                                                 19840000
198500******************************************************************19850000
198600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **19860000
198700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **19870000
198800******************************************************************19880000
198900 3000-EDIT-DATA-IN-COMMAREA.                                      19890000
199000     SET PS-NO-ERROR               TO TRUE.                       19900000
199100     PERFORM 3200-RESET-ATTRIBUTES.                               19910000
199200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     19920000
199300**                                                                19930000
199400* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              19940000
199500* EDITTING IS DONE FROM THE BOTTOM UP.                            19950000
199600**                                                                19960000
199700     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19970000
199800         ASC-ITEMS-DISPLAYED - 1.                                 19980000
199900     PERFORM 3100-SET-SUBSCRIPTS.                                 19990000
200000                                                                  20000000
200100     IF  PS-NO-ERROR                                              20010000
200200         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        20020000
200300     END-IF.                                                      20030000
200400                                                                  20040000
200500     IF  PS-NO-ERROR                                              20050000
200600         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20060000
200700     END-IF.                                                      20070000
200800                                                                  20080000
200900     IF  ((PS-NO-ERROR)                                           20090000
201000       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   20100000
201100       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    20110000
201200             PERFORM 3500-MARK-RANGE-AS-SELECTED                  20120000
201300     END-IF.                                                      20130000
201400 EJECT                                                            20140000
201500                                                                  20150000
201600                                                                  20160000
201700*----------------------------------------------------------------*20170000
201800*   3005-EDIT-COMMAREA-BLOCKS                                    *20180000
201900*----------------------------------------------------------------*20190000
202000 3005-EDIT-COMMAREA-BLOCKS.                                       20200000
202100     MOVE +1                       TO PV-BLOCK-NUMBER.            20210000
202200     MOVE +1                       TO ASC-BLK-SUB.                20220000
202300     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               20230000
202400                                                                  20240000
202500     COMPUTE PV-BLOCK-NUMBER  =                                   20250000
202600        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 20260000
202700            PC-ITEMS-PER-PANEL.                                   20270000
202800                                                                  20280000
202900     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          20290000
203000                                                                  20300000
203100     PERFORM                                                      20310000
203200       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          20320000
203300          OR PS-ERROR                                             20330000
203400          OR PS-BLOCK-ERROR                                       20340000
203500                                                                  20350000
203600             COMPUTE PV-ITEMS-HOLD  =                             20360000
203700                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        20370000
203800                     PC-ITEMS-PER-PANEL - 1                       20380000
203900                                                                  20390000
204000             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       20400000
204100                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               20410000
204200                     FROM  PV-ITEMS-HOLD                          20420000
204300                   GIVING  PV-ITEMS-DIFF                          20430000
204400                 SUBTRACT  PV-ITEMS-DIFF                          20440000
204500                     FROM  PC-ITEMS-PER-PANEL                     20450000
204600                   GIVING  PV-ITEMS-HOLD                          20460000
204700                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              20470000
204800                                              ASC-ITEM-SUB        20480000
204900                                              ASC-ITEMS-DISPLAYED 20490000
205000             ELSE                                                 20500000
205100                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              20510000
205200                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        20520000
205300             END-IF                                               20530000
205400                                                                  20540000
205500             PERFORM 3300-EDIT-SELECTIONS                         20550000
205600                     VARYING PV-SUB                               20560000
205700                        FROM PV-SUB BY -1                         20570000
205800                       UNTIL PV-SUB < +1                          20580000
205900                                                                  20590000
206000             MOVE +1               TO ASC-BLK-SUB                 20600000
206100                                                                  20610000
206200             PERFORM 5105-REWRITE-ASC-LISTQ                       20620000
206300                                                                  20630000
206400             MOVE +1                TO ASC-BLK-SUB                20640000
206500                                                                  20650000
206600             IF  PS-BLOCK-ERROR                                   20660000
206700                 SET  PS-ERROR     TO TRUE                        20670000
206800                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        20680000
206900                                   TO PV-TOP-ITEM                 20690000
207000             ELSE                                                 20700000
207100                 ADD  +1           TO PV-BLOCK-NUMBER             20710000
207200                 IF  PV-BLOCK-NUMBER >                            20720000
207300                     ASC-HIGHEST-BLOCK-WRITTEN                    20730000
207400                     MOVE +2       TO ASC-BLK-SUB                 20740000
207500                     PERFORM 4410-READ-TEMP-STORAGE               20750000
207600                     MOVE +1       TO ASC-BLK-SUB                 20760000
207700                 ELSE                                             20770000
207800                     PERFORM 4410-READ-TEMP-STORAGE               20780000
207900                     ADD  +1        TO PV-BLOCK-NUMBER            20790000
208000                     MOVE +2        TO ASC-BLK-SUB                20800000
208100                     PERFORM 4410-READ-TEMP-STORAGE               20810000
208200                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            20820000
208300                     MOVE +1        TO ASC-BLK-SUB                20830000
208400                 END-IF                                           20840000
208500             END-IF                                               20850000
208600     END-PERFORM.                                                 20860000
208700                                                                  20870000
208800     IF  PV-ORIGINAL-BLOCK  = +1    OR                            20880000
208900         PS-ERROR                   OR                            20890000
209000         PS-BLOCK-ERROR                                           20900000
209100         CONTINUE                                                 20910000
209200     ELSE                                                         20920000
209300         MOVE +1                 TO PV-BLOCK-NUMBER               20930000
209400         MOVE +1                 TO ASC-BLK-SUB                   20940000
209500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20950000
209600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           20960000
209700         PERFORM 4410-READ-TEMP-STORAGE                           20970000
209800                                                                  20980000
209900         PERFORM                                                  20990000
210000           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              21000000
210100              OR PS-ERROR                                         21010000
210200              OR PS-BLOCK-ERROR                                   21020000
210300                                                                  21030000
210400                 COMPUTE PV-ITEMS-HOLD  =                         21040000
210500                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    21050000
210600                         PC-ITEMS-PER-PANEL - 1                   21060000
210700                                                                  21070000
210800                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     21080000
210900                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           21090000
211000                         FROM  PV-ITEMS-HOLD                      21100000
211100                       GIVING  PV-ITEMS-DIFF                      21110000
211200                     SUBTRACT  PV-ITEMS-DIFF                      21120000
211300                         FROM  PC-ITEMS-PER-PANEL                 21130000
211400                       GIVING  PV-ITEMS-HOLD                      21140000
211500                         MOVE  PV-ITEMS-HOLD TO PV-SUB            21150000
211600                                                ASC-ITEM-SUB      21160000
211700                                               ASC-ITEMS-DISPLAYED21170000
211800                 ELSE                                             21180000
211900                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          21190000
212000                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    21200000
212100                 END-IF                                           21210000
212200                                                                  21220000
212300                 PERFORM 3300-EDIT-SELECTIONS                     21230000
212400                         VARYING PV-SUB                           21240000
212500                            FROM PV-SUB BY -1                     21250000
212600                           UNTIL PV-SUB < +1                      21260000
212700                                                                  21270000
212800                 MOVE +1               TO ASC-BLK-SUB             21280000
212900                                                                  21290000
213000                 PERFORM 5105-REWRITE-ASC-LISTQ                   21300000
213100                                                                  21310000
213200                 MOVE +1                TO ASC-BLK-SUB            21320000
213300                                                                  21330000
213400                 IF  PS-BLOCK-ERROR                               21340000
213500                     SET  PS-ERROR     TO TRUE                    21350000
213600                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    21360000
213700                                       TO PV-TOP-ITEM             21370000
213800                 ELSE                                             21380000
213900                     ADD  +1            TO PV-BLOCK-NUMBER        21390000
214000                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      21400000
214100                         MOVE +2        TO ASC-BLK-SUB            21410000
214200                         PERFORM 4410-READ-TEMP-STORAGE           21420000
214300                         MOVE +1        TO ASC-BLK-SUB            21430000
214400                     ELSE                                         21440000
214500                         PERFORM 4410-READ-TEMP-STORAGE           21450000
214600                         ADD  +1        TO PV-BLOCK-NUMBER        21460000
214700                         MOVE +2        TO ASC-BLK-SUB            21470000
214800                         PERFORM 4410-READ-TEMP-STORAGE           21480000
214900                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        21490000
215000                         MOVE +1        TO ASC-BLK-SUB            21500000
215100                     END-IF                                       21510000
215200                 END-IF                                           21520000
215300     END-PERFORM.                                                 21530000
215400*                                                                 21540000
215500*                                                                 21550000
215600*----------------------------------------------------------------*21560000
215700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21570000
215800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21580000
215900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21590000
216000*                                                                *21600000
216100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21610000
216200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21620000
216300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21630000
216400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21640000
216500*----------------------------------------------------------------*21650000
216600                                                                  21660000
216700 3100-SET-SUBSCRIPTS.                                             21670000
216800                                                                  21680000
216900     COMPUTE ASC-ITEM-SUB =                                       21690000
217000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21700000
217100                                                                  21710000
217200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21720000
217300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21730000
217400                                                                  21740000
217500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               21750000
217600     ELSE                                                         21760000
217700         MOVE +1                     TO ASC-BLK-SUB               21770000
217800     END-IF.                                                      21780000
217900******************************************************************21790000
218000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **21800000
218100******************************************************************21810000
218200                                                                  21820000
218300 3200-RESET-ATTRIBUTES.                                           21830000
218400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   21840000
218500     MOVE DP015-GREEN              TO ASTRTITC.                   21850000
218600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   21860000
218700                                                                  21870000
218800     PERFORM                                                      21880000
218900         VARYING PV-SUB                                           21890000
219000         FROM 1 BY 1                                              21900000
219100         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        21910000
219200         MOVE DP015-UNP-ALP-NOR-OFF                               21920000
219300                                   TO MR-SELECTA (PV-SUB)         21930000
219400         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         21940000
219500         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         21950000
219600     END-PERFORM.                                                 21960000
219700*----------------------------------------------------------------*21970000
219800*  GET PACKAGE TYPE CODE FOR PO-RCVR                             *21980000
219900*----------------------------------------------------------------*21990000
220000 3250-GET-PKG-TYP-CDE.                                            22000000
220100                                                                  22010000
220200     IF DK-REC-SEQ-NBR = ZERO                                     22020000
220300         EXEC SQL                                                 22030000
220400              SELECT   PKGNG_CDE                                  22040000
220500                INTO  :ASC-PKGNG-CD                               22050000
220600                FROM TPURCHS                                      22060000
220700              WHERE VER_STATUS_CDE = 'A'                          22070000
220800                   AND PO_NBR  = :DK-PO-NBR                       22080000
220900         END-EXEC                                                 22090000
221000     ELSE                                                         22100000
221100         EXEC SQL                                                 22110000
221200              SELECT   PKGNG_CDE                                  22120000
221300                INTO  :ASC-PKGNG-CD                               22130000
221400                FROM TRECEIV                                      22140000
221500               WHERE ORD_NBR       =  :DK-PO-NBR                  22150000
221600                 AND REC_SEQ_NBR   =  :DK-REC-SEQ-NBR             22160000
221700         END-EXEC.                                                22170000
221800                                                                  22180000
221900     EVALUATE TRUE                                                22190000
222000         WHEN SQLCODE = ZERO                                      22200000
222100              IF  ASC-INNER-PREPK                                 22210000
222200                  MOVE  PC-INNER-PREPACK TO PV-PACK-TYPE          22220000
222300              ELSE                                                22230000
222400              IF  ASC-MULTI-SKU-PREPK                             22240000
222500                  MOVE  PC-MULTI-SKU     TO PV-PACK-TYPE          22250000
222600              ELSE                                                22260000
222700              IF  ASC-SINGLE-SKU-PREPK                            22270000
222800                  MOVE  PC-SINGLE-SKU    TO PV-PACK-TYPE          22280000
222900              ELSE                                                22290000
223000              IF  ASC-CASEPACK                                    22300000
223100                  MOVE  PC-CASEPACK      TO PV-PACK-TYPE          22310000
223200              ELSE                                                22320000
223300              IF  ASC-BULK-PACK                                   22330000
223400                  MOVE  PC-BULK          TO PV-PACK-TYPE          22340000
223500              END-IF                                              22350000
223600              IF  ASC-PBS                                         22360000
223700                  MOVE  PC-PBS           TO PV-PACK-TYPE          22370000
223800              END-IF                                              22380000
223900              END-IF                                              22390000
224000              END-IF                                              22400000
224100              END-IF                                              22410000
224200              END-IF                                              22420000
224300         WHEN SQLCODE = +100                                      22430000
224400              MOVE PC-FREE-ASTRAY        TO PV-PACK-TYPE          22440000
224500         WHEN SQLWARN0 NOT = SPACES                               22450000
224600         WHEN SQLCODE < ZERO                                      22460000
224700         WHEN SQLCODE > ZERO                                      22470000
224800              MOVE '3250-GET-PKG-TYP-CDE'                         22480000
224900                                  TO DP013-PARAGRAPH              22490000
225000              MOVE 'SELECT PACKAGING TYPE CODE  '                 22500000
225100                                  TO DP013-MESSAGE-TEXT (1)       22510000
225200              MOVE DK-PO-NBR      TO DP013-MESSAGE-TEXT (2)       22520000
225300              MOVE DK-REC-SEQ-NBR TO DP013-MESSAGE-TEXT (3)       22530000
225400              MOVE SQLCA          TO DP013-SQLCA                  22540000
225500              MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (1)     22550000
225600              SET DP013-DB2-ABEND TO TRUE                         22560000
225700              SET DP013-XCTL-DISPLAY-RESTART TO TRUE              22570000
225800              PERFORM DP013-0000-PROCESS-ABEND                    22580000
225900     END-EVALUATE.                                                22590000
226000                                                                  22600000
226100                                                                  22610000
226200******************************************************************22620000
226300** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **22630000
226400** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **22640000
226500** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **22650000
226600** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **22660000
226700******************************************************************22670000
226800 3300-EDIT-SELECTIONS.                                            22680000
226900     EVALUATE TRUE                                                22690000
227000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22700000
227100             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22710000
227200                 CONTINUE                                         22720000
227300         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22730000
227400             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22740000
227500                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   22750000
227600                 MOVE ASC-TEMP-SELECTED-SW                        22760000
227700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22770000
227800                                TO ASC-SELECTED-SW                22780000
227900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22790000
228000             END-IF                                               22800000
228100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22810000
228200                 = SPACE                                          22820000
228300             EVALUATE TRUE                                        22830000
228400                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22840000
228500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22850000
228600                     MOVE SPACE TO ASC-SELECTED-SW                22860000
228700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22870000
228800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22880000
228900                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    22890000
229000                     MOVE SPACE TO ASC-SELECTED-SW                22900000
229100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22910000
229200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22920000
229300                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22930000
229400                     MOVE SPACE TO ASC-SELECTED-SW                22940000
229500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22950000
229600             END-EVALUATE                                         22960000
229700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22970000
229800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22980000
229900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22990000
230000             END-IF                                               23000000
230100             PERFORM 3310-EDIT-RANGE                              23010000
230200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             23020000
230300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23030000
230400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    23040000
230500             END-IF                                               23050000
230600             PERFORM 3310-EDIT-RANGE                              23060000
230700         WHEN OTHER                                               23070000
230800             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           23080000
230900             SET DP020-MSG-FATAL    TO TRUE                       23090000
231000             MOVE -1                TO MR-SELECTL (PV-SUB)        23100000
231100             SET DP030-SET-CURSOR-APPL-1                          23110000
231200                                    TO TRUE                       23120000
231300             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        23130000
231400             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        23140000
231500             SET PS-ERROR TO TRUE                                 23150000
231600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23160000
231700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23170000
231800                 MOVE SPACE         TO ASC-SELECTED-SW            23180000
231900                                        (ASC-BLK-SUB ASC-ITEM-SUB)23190000
232000             END-IF                                               23200000
232100     END-EVALUATE.                                                23210000
232200                                                                  23220000
232300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 23230000
232400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               23240000
232500     IF  ASC-ITEM-SUB < 1                                         23250000
232600         SUBTRACT +1 FROM ASC-BLK-SUB                             23260000
232700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                23270000
232800     END-IF.                                                      23280000
232900******************************************************************23290000
233000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **23300000
233100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **23310000
233200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**23320000
233300** THE ENDING.                                                  **23330000
233400******************************************************************23340000
233500 3310-EDIT-RANGE.                                                 23350000
233600     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                23360000
233700         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   23370000
233800             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)23380000
233900                                   TO ASC-SELECTED-SW             23390000
234000                                        (ASC-BLK-SUB ASC-ITEM-SUB)23400000
234100             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 23410000
234200         ELSE                                                     23420000
234300             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     23430000
234400                 CONTINUE                                         23440000
234500             ELSE                                                 23450000
234600*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        23460000
234700                 MOVE PC-TSYMSG-00054                             23470000
234800                                   TO DP020-MSG-NUMBER            23480000
234900                 SET DP020-MSG-FATAL                              23490000
235000                                   TO TRUE                        23500000
235100                 MOVE -1           TO MR-SELECTL (PV-SUB)         23510000
235200                 SET DP030-SET-CURSOR-APPL-1                      23520000
235300                                   TO TRUE                        23530000
235400                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         23540000
235500                 MOVE DP015-UNDERLINE                             23550000
235600                                   TO MR-SELECTH (PV-SUB)         23560000
235700                 SET PS-ERROR      TO TRUE                        23570000
235800             END-IF                                               23580000
235900         END-IF                                                   23590000
236000     ELSE                                                         23600000
236100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     23610000
236200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23620000
236300                                   TO ASC-SELECTED-SW             23630000
236400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23640000
236500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   23650000
236600         ELSE                                                     23660000
236700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23670000
236800                 CONTINUE                                         23680000
236900             ELSE                                                 23690000
237000*                -- ONLY ONE END-OF-RANGE ALLOWED --              23700000
237100                 MOVE PC-TSYMSG-00055                             23710000
237200                                   TO DP020-MSG-NUMBER            23720000
237300                 SET DP020-MSG-FATAL                              23730000
237400                                   TO TRUE                        23740000
237500                 MOVE -1           TO MR-SELECTL (PV-SUB)         23750000
237600                 SET DP030-SET-CURSOR-APPL-1                      23760000
237700                                   TO TRUE                        23770000
237800                 SET PS-ERROR      TO TRUE                        23780000
237900             END-IF                                               23790000
238000         END-IF                                                   23800000
238100     END-IF.                                                      23810000
238200                                                                  23820000
238300******************************************************************23830000
238400** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **23840000
238500** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **23850000
238600******************************************************************23860000
238700 3400-CHECK-RANGE-SEQUENCE.                                       23870000
238800     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       23880000
238900       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      23890000
239000       AND  ASC-START-OF-SELECTED-RANGE >                         23900000
239100                                         ASC-END-OF-SELECTED-RANGE23910000
239200*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23920000
239300         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23930000
239400         SET DP020-MSG-FATAL TO TRUE                              23940000
239500         SET PS-ERROR TO TRUE                                     23950000
239600         PERFORM 3410-POSITION-AT-ERROR                           23960000
239700     END-IF.                                                      23970000
239800******************************************************************23980000
239900** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **23990000
240000** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **24000000
240100** SHOULD BE POSITIONED ON A RANGE ERROR.                       **24010000
240200******************************************************************24020000
240300 3410-POSITION-AT-ERROR.                                          24030000
240400     SET DP030-SET-CURSOR-APPL-1                                  24040000
240500                                   TO TRUE.                       24050000
240600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24060000
240700                    - PV-TOP-ITEM + 1.                            24070000
240800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24080000
240900         CONTINUE                                                 24090000
241000     ELSE                                                         24100000
241100         MOVE -1                   TO MR-SELECTL (PV-SUB)         24110000
241200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24120000
241300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24130000
241400     END-IF.                                                      24140000
241500                                                                  24150000
241600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24160000
241700                    - PV-TOP-ITEM + 1.                            24170000
241800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24180000
241900         CONTINUE                                                 24190000
242000     ELSE                                                         24200000
242100         MOVE -1                   TO MR-SELECTL (PV-SUB)         24210000
242200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24220000
242300         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24230000
242400     END-IF.                                                      24240000
242500 EJECT                                                            24250000
242600*----------------------------------------------------------------*24260000
242700*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *24270000
242800*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *24280000
242900*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *24290000
243000*----------------------------------------------------------------*24300000
243100                                                                  24310000
243200 3500-MARK-RANGE-AS-SELECTED.                                     24320000
243300     MOVE +1                       TO  ASC-BLK-SUB.               24330000
243400     PERFORM 3510-MARK-SELECTED-INDS                              24340000
243500         VARYING ASC-ITEM-SUB                                     24350000
243600         FROM 1 BY 1                                              24360000
243700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24370000
243800                                                                  24380000
243900     ADD +1                        TO ASC-BLK-SUB.                24390000
244000     PERFORM 3510-MARK-SELECTED-INDS                              24400000
244100         VARYING ASC-ITEM-SUB                                     24410000
244200         FROM 1 BY 1                                              24420000
244300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24430000
244400                                                                  24440000
244500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24450000
244600                                   TO  PV-LIST-ITEM-NUMBER.       24460000
244700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24470000
244800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         24480000
244900               PC-ITEMS-PER-PANEL).                               24490000
245000                                                                  24500000
245100     MOVE ASC-START-OF-SELECTED-RANGE                             24510000
245200                                   TO PV-START-OF-SELECTED-RANGE. 24520000
245300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24530000
245400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24540000
245500               PC-ITEMS-PER-PANEL).                               24550000
245600                                                                  24560000
245700     MOVE ASC-END-OF-SELECTED-RANGE                               24570000
245800                                   TO  PV-END-OF-SELECTED-RANGE.  24580000
245900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24590000
246000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24600000
246100               PC-ITEMS-PER-PANEL).                               24610000
246200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             24620000
246300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             24630000
246400                                                                  24640000
246500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24650000
246600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24660000
246700         MOVE +1                   TO ASC-BLK-SUB                 24670000
246800         PERFORM 5100-WRITE-TEMP-STORAGE                          24680000
246900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24690000
247000             PV-FIRST-BLOCK-IN-ARRAY - 1                          24700000
247100                                                                  24710000
247200         PERFORM                                                  24720000
247300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24730000
247400                   PV-PREV-BLOCK-IN-ARRAY                         24740000
247500             MOVE PV-FIRST-BLOCK-IN-RANGE                         24750000
247600                                   TO PV-BLOCK-NUMBER             24760000
247700             PERFORM 4410-READ-TEMP-STORAGE                       24770000
247800             PERFORM 3510-MARK-SELECTED-INDS                      24780000
247900                 VARYING ASC-ITEM-SUB                             24790000
248000                 FROM 1 BY 1                                      24800000
248100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24810000
248200             PERFORM 5100-WRITE-TEMP-STORAGE                      24820000
248300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     24830000
248400         END-PERFORM                                              24840000
248500                                                                  24850000
248600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24860000
248700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     24870000
248800         PERFORM                                                  24880000
248900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       24890000
249000                   PV-LAST-BLOCK-IN-RANGE                         24900000
249100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          24910000
249200                                   TO PV-BLOCK-NUMBER             24920000
249300             PERFORM 4410-READ-TEMP-STORAGE                       24930000
249400             PERFORM 3510-MARK-SELECTED-INDS                      24940000
249500                 VARYING ASC-ITEM-SUB                             24950000
249600                 FROM 1 BY 1                                      24960000
249700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          24970000
249800             PERFORM 5100-WRITE-TEMP-STORAGE                      24980000
249900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      24990000
250000         END-PERFORM                                              25000000
250100                                                                  25010000
250200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             25020000
250300                                   TO PV-BLOCK-NUMBER             25030000
250400         PERFORM 4410-READ-TEMP-STORAGE                           25040000
250500     END-IF.                                                      25050000
250600                                                                  25060000
250700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 25070000
250800                                      ASC-END-OF-SELECTED-RANGE.  25080000
250900                                                                  25090000
251000 EJECT                                                            25100000
251100*----------------------------------------------------------------*25110000
251200* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *25120000
251300*----------------------------------------------------------------*25130000
251400                                                                  25140000
251500 3510-MARK-SELECTED-INDS.                                         25150000
251600                                                                  25160000
251700     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25170000
251800                                ASC-ITEM-SUB) >                   25180000
251900         ASC-START-OF-SELECTED-RANGE)                             25190000
252000     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25200000
252100                                ASC-ITEM-SUB) =                   25210000
252200         ASC-START-OF-SELECTED-RANGE)                             25220000
252300                                                                  25230000
252400         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25240000
252500                                    ASC-ITEM-SUB) <               25250000
252600             ASC-END-OF-SELECTED-RANGE)                           25260000
252700         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25270000
252800                                    ASC-ITEM-SUB) =               25280000
252900             ASC-END-OF-SELECTED-RANGE)                           25290000
253000                                                                  25300000
253100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25310000
253200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   25320000
253300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   25330000
253400                               TO TRUE                            25340000
253500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25350000
253600                               TO TRUE                            25360000
253700                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    25370000
253800             END-IF                                               25380000
253900         END-IF                                                   25390000
254000     END-IF.                                                      25400000
254100                                                                  25410000
254200 EJECT                                                            25420000
254300                                                                  25430000
254400*----------------------------------------------------------------*25440000
254500*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25450000
254600*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25460000
254700*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25470000
254800*    DISPLAY THE PANEL TO USER.                                  *25480000
254900*----------------------------------------------------------------*25490000
255000                                                                  25500000
255100 4000-BUILD-INITIAL-PANEL.                                        25510000
255200                                                                  25520000
255300     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            25530000
255400                                 ASC-BLOCK-ENTRIES (2).           25540000
255500     MOVE +1                 TO ASC-BLK-SUB.                      25550000
255600     SET ASC-ITEMS-LEFT-ON-DB                                     25560000
255700                             TO TRUE.                             25570000
255800                                                                  25580000
255900     MOVE +0                 TO ASC-ITEM-SUB                      25590000
256000                                ASC-NUMBER-OF-ITEMS-READ          25600000
256100                                ASC-NUMBER-OF-SELECTED-ITEMS      25610000
256200                                ASC-HIGHEST-BLOCK-WRITTEN         25620000
256300                                ASC-START-OF-SELECTED-RANGE       25630000
256400                                ASC-END-OF-SELECTED-RANGE         25640000
256500                                ASC-ITEM-AT-TOP-OF-PANEL.         25650000
256600                                                                  25660000
256700     SET PS-DC-LEVEL-YES            TO  TRUE                      25670000
256800     MOVE ASC-OPER-UNT-ID           TO DK-OPER-UNT-ID             25680000
256900     PERFORM 2300-CALL-AUTOVE-MODULE                              25690000
257000     SET PS-DC-LEVEL-NO             TO  TRUE                      25700000
257100     IF RC040-FACILITY-AUTOVE-YES                                 25710000
257200        SET ASC-FACILITY-AUTOVE-YES TO  TRUE                      25720000
257300     END-IF                                                       25730000
257400                                                                  25740000
257500     PERFORM 4100-PREPARE-CURSOR.                                 25750000
257600                                                                  25760000
257700     PERFORM 4010-OPEN-EXPCTD-CURSOR.                             25770000
257800                                                                  25780000
257900     PERFORM 4300-READ-ITEMS-FROM-DB.                             25790000
258000                                                                  25800000
258100     PERFORM 4020-CLOSE-EXPCTD-CURSOR.                            25810000
258200                                                                  25820000
258300     MOVE +1                   TO  PV-TOP-ITEM.                   25830000
258400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          25840000
258500         CONTINUE                                                 25850000
258600*        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    25860000
258700*        SET DP020-MSG-FATAL   TO  TRUE                           25870000
258800*        MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               25880000
258900         PERFORM 7210-SELECT-MAX-STATUS                           25890000
259000         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     25900000
259100     ELSE                                                         25910000
259200         MOVE -1               TO MR-SELECTL (1)                  25920000
259300         SET DP030-SET-CURSOR-APPL-1                              25930000
259400                               TO TRUE                            25940000
259500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     25950000
259600     END-IF.                                                      25960000
259700 EJECT                                                            25970000
259800*----------------------------------------------------------------*25980000
259900* OPEN THE EXPCTD CURSOR.                                        *25990000
260000*----------------------------------------------------------------*26000000
260100                                                                  26010000
260200 4010-OPEN-EXPCTD-CURSOR.                                         26020000
260300***EXPECTED NUMBER OF CARTONS FOR EACH PO/RECEIVER ON THE TRAILER 26030000
260400***FOR THE TRIP -ID ENTERED :DK-TRIP-ID                           26040000
260500     PERFORM                                                      26050000
260600         WITH TEST AFTER                                          26060000
260700         VARYING PV-RETRY-COUNTER                                 26070000
260800         FROM 1 BY 1                                              26080000
260900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26090000
261000                   OR (SQLCODE = ZERO))                           26100000
261100                 EXEC SQL                                         26110000
261200                      OPEN SHIPMT-EXP-CSR                         26120000
261300                 END-EXEC                                         26130000
261400                                                                  26140000
261500                                                                  26150000
261600         EVALUATE TRUE                                            26160000
261700             WHEN SQLCODE = ZERO                                  26170000
261800             WHEN SQLCODE = -904                                  26180000
261900             WHEN SQLCODE = -913                                  26190000
262000                 CONTINUE                                         26200000
262100             WHEN SQLWARN0 NOT = SPACES                           26210000
262200             WHEN SQLCODE < ZERO                                  26220000
262300             WHEN SQLCODE > ZERO                                  26230000
262400                 MOVE '4010-OPEN-EXPCTD-CURSOR'                   26240000
262500                                   TO DP013-PARAGRAPH             26250000
262600                 MOVE 'OPEN SHIPMT CURSOR - '                     26260000
262700                                   TO DP013-MESSAGE-TEXT (1)      26270000
262800                 MOVE SQLCA        TO DP013-SQLCA                 26280000
262900                 MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)    26290000
263000                 SET DP013-DB2-ABEND                              26300000
263100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26310000
263200                 PERFORM DP013-0000-PROCESS-ABEND                 26320000
263300         END-EVALUATE                                             26330000
263400     END-PERFORM.                                                 26340000
263500                                                                  26350000
263600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    26360000
263700         SQLCODE NOT = ZERO                                       26370000
263800         MOVE '4010-OPEN-EXPECTD-CURSOR'   TO DP013-PARAGRAPH     26380000
263900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   26390000
264000                                   TO DP013-MESSAGE-TEXT (1)      26400000
264100         MOVE SQLCA                TO DP013-SQLCA                 26410000
264200         MOVE 'TSHIPMT '           TO DP013-DB2-TABLE-NAME (1)    26420000
264300         SET DP013-DB2-ABEND                                      26430000
264400             DP013-XCTL-DISPLAY-RESTART                           26440000
264500                                   TO TRUE                        26450000
264600         PERFORM DP013-0000-PROCESS-ABEND                         26460000
264700     END-IF.                                                      26470000
264800                                                                  26480000
264900 EJECT                                                            26490000
265000******************************************************************26500000
265100*  CLOSE EXPECTED CURSOR                                       * *26510000
265200******************************************************************26520000
265300 4020-CLOSE-EXPCTD-CURSOR.                                        26530000
265400         EXEC SQL                                                 26540000
265500             CLOSE SHIPMT-EXP-CSR                                 26550000
265600         END-EXEC                                                 26560000
265700                                                                  26570000
265800     EVALUATE TRUE                                                26580000
265900         WHEN SQLCODE = ZERO                                      26590000
266000             CONTINUE                                             26600000
266100         WHEN SQLWARN0 NOT = SPACES                               26610000
266200         WHEN SQLCODE < ZERO                                      26620000
266300         WHEN SQLCODE > ZERO                                      26630000
266400             MOVE '4020-CLOSE-EXPCTD-CURSOR'                      26640000
266500                               TO DP013-PARAGRAPH                 26650000
266600             MOVE 'CLOSE SHIPMT CURSOR '                          26660000
266700                               TO DP013-MESSAGE-TEXT (1)          26670000
266800             MOVE SQLCA        TO DP013-SQLCA                     26680000
266900             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        26690000
267000             SET DP013-DB2-ABEND                                  26700000
267100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               26710000
267200             PERFORM DP013-0000-PROCESS-ABEND                     26720000
267300     END-EVALUATE.                                                26730000
267400                                                                  26740000
267500 EJECT                                                            26750000
267600*----------------------------------------------------------------*26760000
267700*    SET UP THE HOST VARIABLES.                                  *26770000
267800*----------------------------------------------------------------*26780000
267900                                                                  26790000
268000 4100-PREPARE-CURSOR.                                             26800000
268100                                                                  26810000
268200     MOVE ASC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                26820000
268300     MOVE ASC-FCLTY-ID          TO DK-FCLTY-ID.                   26830000
268400     MOVE ASC-SCAC-ID           TO DK-SCAC-ID.                    26840000
268500     MOVE ASC-VEH-NBR           TO DK-VEHICLE-NBR.                26850000
268600     MOVE ASC-TRIP-ID           TO DK-TRIP-ID.                    26860000
268700     MOVE PV-PO-NBR             TO DK-PO-NBR.                     26870000
268800     MOVE PV-RECEIVER           TO DK-REC-SEQ-NBR.                26880000
268900                                                                  26890000
269000     PERFORM 4200-BUILD-TEMP-TABLE.                               26900000
269100/                                                                 26910000
269200 4200-BUILD-TEMP-TABLE.                                           26920000
269300                                                                  26930000
269400*    RETRIEVE EXPECTED PO/RCVRS AND INSERT THEM TO THE TEMP TABLE 26940000
269500     PERFORM 7500-OPEN-TYPE-A-CSR                                 26950000
269600     PERFORM 7505-FETCH-TYPE-A-CSR                                26960000
269700     PERFORM UNTIL PS-EOF-TYPE-A-YES                              26970000
269800         PERFORM 7600-INSERT-TEMP-TABLE                           26980000
269900         PERFORM 7505-FETCH-TYPE-A-CSR                            26990000
270000     END-PERFORM.                                                 27000000
270100     PERFORM 7510-CLOSE-TYPE-A-CSR.                               27010000
270200                                                                  27020000
270300*    MOVE ALL '-' TO PV-CICS-MSG-AREA                             27030000
270400*    PERFORM 9900-WRITE-CICS-LOG                                  27040000
270500                                                                  27050000
270600                                                                  27060000
270700*    GET THE CHECKIN DATA AND INSERT THEN TO THE TEMP TABLE       27070000
270800                                                                  27080000
270900     MOVE ZERO                        TO PV-PREV-TEMP-PO          27090000
271000                                         PV-PREV-TEMP-SEQ         27100000
271100                                                                  27110000
271200     PERFORM 7520-OPEN-CHECKIN-CSR.                               27120000
271300     PERFORM 7525-FETCH-CHECKIN-CSR                               27130000
271400                                                                  27140000
271500     PERFORM UNTIL PS-EOF-CHECKIN-YES                             27150000
271600         IF PV-TEMP-PO-NULL = -1 OR PV-TEMP-SEQ-NULL = -1         27160000
271700             PERFORM 4201-TYPE-C                                  27170000
271800             PERFORM 7600-INSERT-TEMP-TABLE                       27180000
271900         ELSE                                                     27190000
272000             IF PV-CURRENT-TEMP = PV-PREVIOUS-TEMP                27200000
272100                 CONTINUE                                         27210000
272200             ELSE                                                 27220000
272300                 PERFORM 4202-OTHER-TYPES                         27230000
272400                 PERFORM 7600-INSERT-TEMP-TABLE                   27240000
272500                 MOVE PV-CURR-TEMP-PO TO PV-PREV-TEMP-PO          27250000
272600                 MOVE PV-CURR-TEMP-SEQ                            27260000
272700                                      TO PV-PREV-TEMP-SEQ         27270000
272800             END-IF                                               27280000
272900         END-IF                                                   27290000
273000                                                                  27300000
273100         PERFORM 7525-FETCH-CHECKIN-CSR                           27310000
273200                                                                  27320000
273300     END-PERFORM.                                                 27330000
273400                                                                  27340000
273500     PERFORM 7530-CLOSE-CHECKIN-CSR.                              27350000
273600                                                                  27360000
273700 4201-TYPE-C.                                                     27370000
273800     PERFORM 7540-SELECT-TSHUUPC.                                 27380000
273900     MOVE 'C'                         TO PV-TEMP-UNION-TYPE       27390000
274000     MOVE  1                          TO PV-TEMP-SCREEN-SEQUENCE. 27400000
274100     MOVE ZERO                        TO PV-TEMP-REC-SEQ-NBR.     27410000
274200                                                                  27420000
274300 4202-OTHER-TYPES.                                                27430000
274400     PERFORM 7545-SELECT-TPKSLIP.                                 27440000
274500     IF SQLCODE = ZERO                                            27450000
274600         IF PV-TEMP-REC-SEQ-NBR = ZERO                            27460000
274700             MOVE 'D'                 TO PV-TEMP-UNION-TYPE       27470000
274800             MOVE  1                  TO PV-TEMP-SCREEN-SEQUENCE  27480000
274900         ELSE                                                     27490000
275000             PERFORM 7550-SELECT-FROM-TEMP                        27500000
275100             IF PS-TEMP-B-YES                                     27510000
275200                 MOVE 'B'             TO PV-TEMP-UNION-TYPE       27520000
275300                 MOVE  1              TO PV-TEMP-SCREEN-SEQUENCE  27530000
275400             END-IF                                               27540000
275500         END-IF                                                   27550000
275600     ELSE                                                         27560000
275700         PERFORM 7555-FIND-DELETED-PKSLIPS                        27570000
275800         IF PS-TEMP-PKSLIP-DELETED-YES                            27580000
275900             MOVE ZERO                TO PV-TEMP-REC-SEQ-NBR      27590000
276000             MOVE 'E'                 TO PV-TEMP-UNION-TYPE       27600000
276100             MOVE 1                   TO PV-TEMP-SCREEN-SEQUENCE  27610000
276200         ELSE                                                     27620000
276300             MOVE 'E'                 TO PV-TEMP-UNION-TYPE       27630000
276400             MOVE 1                   TO PV-TEMP-SCREEN-SEQUENCE  27640000
276500         END-IF                                                   27650000
276600     END-IF.                                                      27660000
276700                                                                  27670000
276800/                                                                 27680000
276900 EJECT                                                            27690000
277000*----------------------------------------------------------------*27700000
277100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *27710000
277200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *27720000
277300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *27730000
277400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *27740000
277500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *27750000
277600*                                                                *27760000
277700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *27770000
277800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *27780000
277900*    UPON INITIALIZATION.                                        *27790000
278000*----------------------------------------------------------------*27800000
278100                                                                  27810000
278200 4300-READ-ITEMS-FROM-DB.                                         27820000
278300                                                                  27830000
278400     PERFORM                                                      27840000
278500         VARYING PV-READ-COUNT                                    27850000
278600         FROM 1 BY 1                                              27860000
278700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    27870000
278800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         27880000
278900                                                                  27890000
279000         PERFORM 4310-FETCH-EXPECTED-CNT                          27900000
279100                                                                  27910000
279200         IF  ASC-ITEMS-LEFT-ON-DB                                 27920000
279300             PERFORM 3250-GET-PKG-TYP-CDE                         27930000
279400             PERFORM 4320-SELECT-EXPECTD-CNT                      27940000
279500             PERFORM 4330-SELECT-SCANNED-CNT                      27950000
279600             PERFORM 4340-SELECT-TOT-EXP-AND-ACTUAL               27960000
279700                                                                  27970000
279800             IF DK-REC-SEQ-NBR = 0                                27980000
279900                MOVE ZEROES TO  PV-PO-RCVR-UNT-CNTR               27990000
280000             ELSE                                                 28000000
280100                PERFORM 5010-OPEN-TOTAL-UNTS-CSR                  28010000
280200                SET PS-NOT-END-OF-RECITM-CSR TO TRUE              28020000
280300                                                                  28030000
280400                PERFORM 5310-FETCH-TOTAL-UNITS                    28040000
280500                            UNTIL PS-END-OF-RECITM-CSR            28050000
280600                PERFORM 5020-CLOSE-TOTAL-UNTS-CSR                 28060000
280700             END-IF                                               28070000
280800                                                                  28080000
280900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                28090000
281000                 ADD +1            TO ASC-ITEM-SUB                28100000
281100             ELSE                                                 28110000
281200                 ADD +1            TO ASC-BLK-SUB                 28120000
281300                 MOVE +1           TO ASC-ITEM-SUB                28130000
281400                                                                  28140000
281500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         28150000
281600                     MOVE +1       TO ASC-BLK-SUB                 28160000
281700                     SET ASC-BLOCK-MODIFIED (1)                   28170000
281800                                   TO TRUE                        28180000
281900                     PERFORM 5100-WRITE-TEMP-STORAGE              28190000
282000                     MOVE ASC-BLOCK-ENTRIES                       28200000
282100                               (PC-MAX-BLOCKS-IN-ARRAY)           28210000
282200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 28220000
282300                     ADD +1        TO ASC-BLK-SUB                 28230000
282400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   28240000
282500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      28250000
282600                                   TO TRUE                        28260000
282700                 END-IF                                           28270000
282800             END-IF                                               28280000
282900                                                                  28290000
283000             PERFORM 7210-SELECT-MAX-STATUS                       28300000
283100                                                                  28310000
283200             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    28320000
283300             MOVE ASC-NUMBER-OF-ITEMS-READ                        28330000
283400                                   TO ASC-LIST-ITEM-NUMBER        28340000
283500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  28350000
283600             MOVE SPACES                 TO  ASC-ACTION           28360000
283700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28370000
283800             MOVE PV-UNION-TYPE          TO  ASC-CSR-IND          28380000
283900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28390000
284000             MOVE PV-PO-RECEIVER     TO ASC-PO-RECEIVER           28400000
284100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28410000
284200             IF PV-PACK-TYPE = PC-PBS                             28420000
284300                PERFORM 4360-CHECK-FOR-PBS-ERRORS                 28430000
284400                IF PS-PBS-ERRORS-FOUND                            28440000
284500                   SET ASC-PBS-ERRORS-FOUND                       28450000
284600                      (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE          28460000
284700                END-IF                                            28470000
284800             END-IF                                               28480000
284900             MOVE ENTNME-ENT-NAME-DESC TO ASC-VND-NME             28490000
285000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28500000
285100             IF PV-PACK-TYPE = PC-PBS                             28510000
285200                 MOVE ' '                  TO ASC-PACK-TYPE       28520000
285300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28530000
285400             ELSE                                                 28540000
285500                 MOVE PV-PACK-TYPE         TO ASC-PACK-TYPE       28550000
285600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 28560000
285700             END-IF                                               28570000
285800*----------------------------------------------------------------*28580000
285900* IDENTIFY FREE-ASTRAY LABELS.                                    28590000
286000*----------------------------------------------------------------*28600000
286100                                                                  28610000
286200             IF DK-PO-NBR      NOT = 99999999 AND                 28620000
286300                DK-REC-SEQ-NBR NOT = ZEROS                        28630000
286400                PERFORM 4380-GET-RECEIVER-INFO                    28640000
286500                                                                  28650000
286600                IF PS-RECEIVER-FOUND-YES                          28660000
286700                   MOVE RECEIV-STATUS-CDE   TO ASC-PO-STATUS      28670000
286800                                        (ASC-BLK-SUB ASC-ITEM-SUB)28680000
286900                   IF  RECEIV-STATUS-CDE = 'IP' OR 'CM'           28690000
287000                     IF RECEIV-FRE-ASTRA-IND = 'Y'                28700000
287100                        SET ASC-COLOR-YELLOW                      28710000
287200                            (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE   28720000
287300                        IF ASC-FREE-ASTRAY-SW NOT = 'Y'           28730000
287400                           SET ASC-FREE-ASTRAY   TO TRUE          28740000
287500                        END-IF                                    28750000
287600                     END-IF                                       28760000
287700                   END-IF                                         28770000
287800                                                                  28780000
287900                     IF ASC-FACILITY-AUTOVE-YES                   28790000
288000                        PERFORM 2300-CALL-AUTOVE-MODULE           28800000
288100                        IF RC040-AUTO-VE-NO                       28810000
288200                           MOVE '==>MANUAL'  TO ASC-VND-NME-12-22 28820000
288300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     28830000
288400                           SET ASC-AUTO-VE-NO                     28840000
288500                              (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE 28850000
288600                        ELSE                                      28860000
288700                           IF RECEIV-CRE-UID = 'CHECK-IN'         28870000
288800                             MOVE '==>CHCKIN' TO ASC-VND-NME-12-2228880000
288900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28890000
289000                            SET ASC-CHCKIN-YES                    28900000
289100                              (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE 28910000
289200                           END-IF                                 28920000
289300                        END-IF                                    28930000
289400                     END-IF                                       28940000
289500                ELSE                                              28950000
289600                   MOVE SPACES       TO ASC-PO-STATUS             28960000
289700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   28970000
289800                END-IF                                            28980000
289900             END-IF                                               28990000
290000*----------------------------------------------------------------*29000000
290100              PERFORM 4381-SELECT-TTRIPST                         29010000
290200              IF PS-MISDIRECT-YES                                 29020000
290300                IF DK-REC-SEQ-NBR  > 0                            29030000
290400                  PERFORM 4383-SELECT-TRECEIV                     29040000
290500                  IF RECEIV-CURR-OPER-UNT-ID =                    29050000
290600                                    ASC-OPER-UNT-ID               29060000
290700                     SET ASC-MISDIRECT-NO                         29070000
290800                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    29080000
290900                  ELSE                                            29090000
291000                     SET ASC-MISDIRECT-YES                        29100000
291100                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    29110000
291200                     MOVE '==>MSDRCT'  TO ASC-VND-NME-12-22       29120000
291300                                 (ASC-BLK-SUB ASC-ITEM-SUB)       29130000
291400                  END-IF                                          29140000
291500                ELSE                                              29150000
291600                   SET ASC-MISDIRECT-YES                          29160000
291700                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    29170000
291800                   MOVE '==>MSDRCT'  TO ASC-VND-NME-12-22         29180000
291900                                 (ASC-BLK-SUB ASC-ITEM-SUB)       29190000
292000                END-IF                                            29200000
292100              ELSE                                                29210000
292200                 SET ASC-MISDIRECT-NO                             29220000
292300                            (ASC-BLK-SUB ASC-ITEM-SUB) TO TRUE    29230000
292400              END-IF                                              29240000
292500*----------------------------------------------------------------*29250000
292600*** MOVE FOR EXPECTED CTN COUNT                                   29260000
292700             MOVE PV-DB2-COUNT-MANIFEST                           29270000
292800                                       TO ASC-EXP-CART-COUNT      29280000
292900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29290000
293000             ADD PV-DB2-COUNT-MANIFEST                            29300000
293100                                   TO ASC-TOT-EXP-CRTNS           29310000
293200*** MOVE FOR ACTUAL CTN COUNT                                     29320000
293300             MOVE PV-DB2-COUNT-ACTL-CTN                           29330000
293400                                       TO ASC-ACTL-CART-COUNT     29340000
293500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29350000
293600             ADD PV-DB2-COUNT-ACTL-CTN                            29360000
293700                                   TO ASC-TOT-ACTL-CRTNS          29370000
293800*** MOVE FOR SCANNED  CTN COUNT                                   29380000
293900             MOVE PV-DB2-COUNT-EXP-SCN                            29390000
294000                                   TO ASC-EXP-SCN-COUNT           29400000
294100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29410000
294200             ADD PV-DB2-COUNT-EXP-SCN                             29420000
294300                                   TO ASC-TOT-EXP-SCAN            29430000
294400*** MOVE FOR ACTUAL SCAN COUNT                                    29440000
294500             MOVE PV-DB2-COUNT-ACTL-SCN                           29450000
294600                                   TO ASC-ACTL-SCN-COUNT          29460000
294700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29470000
294800             ADD PV-DB2-COUNT-ACTL-SCN                            29480000
294900                                   TO ASC-TOT-ACTL-SCN            29490000
295000*** MOVE FOR PERCENT SCANNED                                      29500000
295100             PERFORM 4350-CALCULATE-PERCENT-SCANNED               29510000
295200             MOVE PV-PERCENT-SCANNED TO PV-PERCENT                29520000
295300             MOVE PV-PERCENT-EDITED                               29530000
295400                                   TO ASC-PERCENT-SCND            29540000
295500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29550000
295600*** MOVE FOR TOTAL UNITS                                          29560000
295700             MOVE PV-PO-RCVR-UNT-CNTR                             29570000
295800                                   TO ASC-TOTAL-UNITS             29580000
295900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 29590000
296000             ADD PV-PO-RCVR-UNT-CNTR                              29600000
296100                                   TO ASC-TOT-UNITS               29610000
296200             INITIALIZE PV-PO-RCVR-UNT-CNTR                       29620000
296300         END-IF                                                   29630000
296400     END-PERFORM.                                                 29640000
296500                                                                  29650000
296600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          29660000
296700         MOVE +1               TO ASC-BLK-SUB                     29670000
296800         PERFORM 5100-WRITE-TEMP-STORAGE                          29680000
296900         ADD +1                TO ASC-BLK-SUB                     29690000
297000         PERFORM 5100-WRITE-TEMP-STORAGE                          29700000
297100                                                                  29710000
297200         MOVE 1                TO ASC-BLK-SUB                     29720000
297300                                  PV-BLOCK-NUMBER                 29730000
297400         PERFORM 4410-READ-TEMP-STORAGE                           29740000
297500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             29750000
297600             MOVE 2            TO ASC-BLK-SUB                     29760000
297700                                  PV-BLOCK-NUMBER                 29770000
297800             PERFORM 4410-READ-TEMP-STORAGE                       29780000
297900         END-IF                                                   29790000
298000     END-IF.                                                      29800000
298100                                                                  29810000
298200 EJECT                                                            29820000
298300*----------------------------------------------------------------*29830000
298400*    FETCH THE MESSAGE CURSOR.                                   *29840000
298500*----------------------------------------------------------------*29850000
298600                                                                  29860000
298700 4310-FETCH-EXPECTED-CNT.                                         29870000
298800                                                                  29880000
298900         EXEC SQL                                                 29890000
299000             FETCH SHIPMT-EXP-CSR                                 29900000
299100             INTO   :PV-UNION-TYPE                                29910000
299200                  , :DK-PO-NBR                                    29920000
299300                  , :DK-REC-SEQ-NBR                               29930000
299400         END-EXEC                                                 29940000
299500                                                                  29950000
299600     EVALUATE TRUE                                                29960000
299700         WHEN SQLCODE = ZERO                                      29970000
299800              MOVE DK-PO-NBR      TO   PV-PO-NBR                  29980000
299900              MOVE DK-REC-SEQ-NBR TO   PV-RECEIVER                29990000
300000         WHEN SQLCODE = +100                                      30000000
300100              SET ASC-NO-ITEMS-LEFT-ON-DB                         30010000
300200                                        TO TRUE                   30020000
300300         WHEN SQLWARN0 NOT = SPACE                                30030000
300400         WHEN SQLCODE NOT = ZERO                                  30040000
300500              MOVE '4310-FETCH-EXPECTED-CNT'                      30050000
300600                               TO DP013-PARAGRAPH                 30060000
300700              MOVE 'FETCH MESSAGE CURSOR'                         30070000
300800                               TO DP013-MESSAGE-TEXT (1)          30080000
300900              MOVE SQLCA       TO DP013-SQLCA                     30090000
301000              SET DP013-DB2-ABEND                                 30100000
301100                               TO TRUE                            30110000
301200              PERFORM DP013-0000-PROCESS-ABEND                    30120000
301300     END-EVALUATE.                                                30130000
301400                                                                  30140000
301500                                                                  30150000
301600     IF SQLCODE = +0                                              30160000
301700         PERFORM  5910-GET-ENT-NAME-DESC                          30170000
301800     END-IF.                                                      30180000
301900                                                                  30190000
302000******************************************************************30200000
302100******************************************************************30210000
302200                                                                  30220000
302300 4320-SELECT-EXPECTD-CNT.                                         30230000
302400     INITIALIZE        PV-DB2-COUNT-EXP-SCN.                      30240000
302500                                                                  30250000
302600                                                                  30260000
302700     EXEC SQL                                                     30270000
302800          SELECT  COUNT(*)                                        30280000
302900          INTO  :PV-DB2-COUNT-EXP-SCN                             30290000
303000          FROM   TSHIPMT A                                        30300000
303100                ,TSHPTPO B                                        30310000
303200                ,TPKSLIP C                                        30320000
303300                ,TINPKSU D                                        30330000
303400                ,TSHPUNT E                                        30340000
303500          WHERE A.TRIP_ID = :DK-TRIP-ID                           30350000
303600            AND B.PO_NBR   = :DK-PO-NBR                           30360000
303700            AND B.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   30370000
303800            AND B.PO_NBR   = C.PO_NBR                             30380000
303900            AND B.REC_SEQ_NBR = C.REC_SEQ_NBR                     30390000
304000            AND B.PRIM_SHIPT_IND= 'Y'                             30400000
304100            AND C.VER_STAT_CDE = 'A'                              30410000
304200            AND B.PO_NBR   = D.PO_NBR                             30420000
304300            AND D.SEQ_NBR   = C.SEQ_NBR                           30430000
304400            AND A.SHIPT_ID = B.SHIPT_ID                           30440000
304500            AND D.SHIPT_UNT_ID = E.SHIPT_UNT_ID                   30450000
304600            AND E.ACTV_IND = 'A'                                  30460000
304700     END-EXEC                                                     30470000
304800                                                                  30480000
304900                                                                  30490000
305000     EVALUATE TRUE                                                30500000
305100         WHEN SQLCODE = ZERO                                      30510000
305200         WHEN SQLCODE = +100                                      30520000
305300              CONTINUE                                            30530000
305400         WHEN SQLWARN0 NOT = SPACE                                30540000
305500         WHEN SQLCODE NOT = ZERO                                  30550000
305600              MOVE '4320-SELECT-EXPECTD-CNT'                      30560000
305700                               TO DP013-PARAGRAPH                 30570000
305800              MOVE 'FETCH MESSAGE CURSOR'                         30580000
305900                               TO DP013-MESSAGE-TEXT (1)          30590000
306000              MOVE SQLCA       TO DP013-SQLCA                     30600000
306100              SET DP013-DB2-ABEND                                 30610000
306200                               TO TRUE                            30620000
306300              PERFORM DP013-0000-PROCESS-ABEND                    30630000
306400     END-EVALUATE.                                                30640000
306500                                                                  30650000
306600                                                                  30660000
306700******************************************************************30670000
306800******************************************************************30680000
306900 4330-SELECT-SCANNED-CNT.                                         30690000
307000      INITIALIZE             PV-DB2-COUNT-ACTL-SCN.               30700000
307100     EVALUATE TRUE                                                30710000
307200       WHEN PV-UNION-TYPE = 'A'                                   30720000
307300         EXEC SQL                                                 30730000
307400              SELECT  COUNT(*)                                    30740000
307500              INTO  :PV-DB2-COUNT-ACTL-SCN                        30750000
307600              FROM   TPKSLIP A                                    30760000
307700                    ,TINPKSU B                                    30770000
307800                    ,TSHUNLO C                                    30780000
307900              WHERE A.PO_NBR   = :DK-PO-NBR                       30790000
308000                AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR               30800000
308100                AND A.VER_STAT_CDE = 'A'                          30810000
308200                AND A.PO_NBR   = B.PO_NBR                         30820000
308300                AND A.SEQ_NBR  = B.SEQ_NBR                        30830000
308400                AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID               30840000
308500                AND C.TRIP_ID = :DK-TRIP-ID                       30850000
308600         END-EXEC                                                 30860000
308700                                                                  30870000
308800       WHEN  PV-UNION-TYPE =  'B'                                 30880000
308900           EXEC SQL                                               30890000
309000              SELECT COUNT(*)                                     30900000
309100              INTO  :PV-DB2-COUNT-ACTL-SCN                        30910000
309200               FROM  TPKSLIP A,                                   30920000
309300                     TINPKSU B,                                   30930000
309400                     TSHUNLO C                                    30940000
309500               WHERE A.PO_NBR = :DK-PO-NBR                        30950000
309600                 AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR              30960000
309700                 AND A.PO_NBR = B.PO_NBR                          30970000
309800                 AND A.SEQ_NBR = B.SEQ_NBR                        30980000
309900                 AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID              30990000
310000                 AND C.TRIP_ID = :DK-TRIP-ID                      31000000
310100                 AND A.VER_STAT_CDE = 'A'                         31010000
310200         END-EXEC                                                 31020000
310300       WHEN PV-UNION-TYPE = 'C'                                   31030000
310400         EXEC SQL                                                 31040000
310500              SELECT  COUNT(*)                                    31050000
310600              INTO  :PV-DB2-COUNT-ACTL-SCN                        31060000
310700              FROM   TSHUNLO A                                    31070000
310800                    ,TSHUUPC B                                    31080000
310900              WHERE A.TRIP_ID = :DK-TRIP-ID                       31090000
311000                AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID               31100000
311100                AND B.TRN_NBR  = :DK-PO-NBR                       31110000
311200              AND NOT EXISTS                                      31120000
311300               (SELECT C.SHIPT_UNT_ID                             31130000
311400                FROM TINPKSU C                                    31140000
311500                WHERE B.SHIPT_UNT_ID  = C.SHIPT_UNT_ID            31150000
311600                  AND C.PO_NBR = B.TRN_NBR)                       31160000
311700         END-EXEC                                                 31170000
311800       WHEN PV-UNION-TYPE = 'D'                                   31180000
311900         EXEC SQL                                                 31190000
312000              SELECT  COUNT(*)                                    31200000
312100              INTO  :PV-DB2-COUNT-ACTL-SCN                        31210000
312200              FROM   TSHUNLO A                                    31220000
312300                    ,TINPKSU B                                    31230000
312400                    ,TPKSLIP C                                    31240000
312500              WHERE A.TRIP_ID = :DK-TRIP-ID                       31250000
312600                AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID               31260000
312700                AND B.PO_NBR  = :DK-PO-NBR                        31270000
312800                AND B.PO_NBR  = C.PO_NBR                          31280000
312900                AND B.SEQ_NBR = C.SEQ_NBR                         31290000
313000                AND C.VER_STAT_CDE = 'A'                          31300000
313100                AND C.REC_SEQ_NBR = :DK-REC-SEQ-NBR               31310000
313200         END-EXEC                                                 31320000
313300       WHEN PV-UNION-TYPE = 'E'                                   31330000
313400         EXEC SQL                                                 31340000
313500              SELECT  COUNT(*)                                    31350000
313600              INTO  :PV-DB2-COUNT-ACTL-SCN                        31360000
313700              FROM   TSHUNLO A                                    31370000
313800                    ,TINPKSU B                                    31380000
313900                    ,TPKSLIP C                                    31390000
314000              WHERE A.TRIP_ID = :DK-TRIP-ID                       31400000
314100                AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID               31410000
314200                AND B.PO_NBR  = :DK-PO-NBR                        31420000
314300                AND B.PO_NBR  = C.PO_NBR                          31430000
314400                AND B.SEQ_NBR = C.SEQ_NBR                         31440000
314500                AND C.PKSL_STAT_CDE = 'DE'                        31450000
314600         END-EXEC                                                 31460000
314700     END-EVALUATE                                                 31470000
314800                                                                  31480000
314900                                                                  31490000
315000     EVALUATE TRUE                                                31500000
315100         WHEN SQLCODE = ZERO                                      31510000
315200         WHEN SQLCODE = +100                                      31520000
315300              CONTINUE                                            31530000
315400         WHEN SQLWARN0 NOT = SPACE                                31540000
315500         WHEN SQLCODE NOT = ZERO                                  31550000
315600              MOVE '4330-SELECT-SCANNED-CNT'                      31560000
315700                               TO DP013-PARAGRAPH                 31570000
315800              MOVE 'FETCH MESSAGE CURSOR'                         31580000
315900                               TO DP013-MESSAGE-TEXT (1)          31590000
316000              MOVE SQLCA       TO DP013-SQLCA                     31600000
316100              SET DP013-DB2-ABEND                                 31610000
316200                               TO TRUE                            31620000
316300              PERFORM DP013-0000-PROCESS-ABEND                    31630000
316400     END-EVALUATE.                                                31640000
316500                                                                  31650000
316600                                                                  31660000
316700 4340-SELECT-TOT-EXP-AND-ACTUAL.                                  31670000
316800     IF  PV-UNION-TYPE    = 'A'                                   31680000
316900                                                                  31690000
317000         EXEC SQL                                                 31700000
317100                SELECT SUM(EXPTED_CART_CNT)                       31710000
317200                INTO  :PV-DB2-COUNT-MANIFEST                      31720000
317300                FROM    TSHPTPO                                   31730000
317400                WHERE   PO_NBR      = :DK-PO-NBR                  31740000
317500                  AND   REC_SEQ_NBR = :DK-REC-SEQ-NBR             31750000
317600         END-EXEC                                                 31760000
317700         EVALUATE TRUE                                            31770000
317800             WHEN SQLCODE = ZERO                                  31780000
317900                  CONTINUE                                        31790000
318000             WHEN SQLCODE = +100                                  31800000
318100             WHEN SQLCODE = -305                                  31810000
318200                  MOVE ZEROES TO PV-DB2-COUNT-MANIFEST            31820000
318300             WHEN SQLWARN0 NOT = SPACE                            31830000
318400             WHEN SQLCODE NOT = ZERO                              31840000
318500                  MOVE '4340-SELECT-TOT-EXP-AND-ACTUAL'           31850000
318600                                   TO DP013-PARAGRAPH             31860000
318700                  MOVE 'FETCH MESSAGE CURSOR'                     31870000
318800                                   TO DP013-MESSAGE-TEXT (1)      31880000
318900                  MOVE SQLCA       TO DP013-SQLCA                 31890000
319000                  SET DP013-DB2-ABEND                             31900000
319100                                   TO TRUE                        31910000
319200                  PERFORM DP013-0000-PROCESS-ABEND                31920000
319300         END-EVALUATE                                             31930000
319400                                                                  31940000
319500**GB 6/12/00                                                      31950000
319600         EXEC SQL                                                 31960000
319700                SELECT ACTL_CART_CNT                              31970000
319800                INTO  :PV-DB2-COUNT-ACTL-CTN                      31980000
319900                FROM    TRECEIV                                   31990000
320000                WHERE   ORD_NBR     = :DK-PO-NBR                  32000000
320100                  AND   REC_SEQ_NBR = :DK-REC-SEQ-NBR             32010000
320200         END-EXEC                                                 32020000
320300                                                                  32030000
320400         EVALUATE TRUE                                            32040000
320500             WHEN SQLCODE = ZERO                                  32050000
320600                  CONTINUE                                        32060000
320700             WHEN SQLCODE = +100                                  32070000
320800                  MOVE ZEROES TO PV-DB2-COUNT-ACTL-CTN            32080000
320900             WHEN SQLWARN0 NOT = SPACE                            32090000
321000             WHEN SQLCODE NOT = ZERO                              32100000
321100                  MOVE '4340-SELECT-TOT-EXP-AND-ACTUAL'           32110000
321200                                   TO DP013-PARAGRAPH             32120000
321300                  MOVE 'FETCH MESSAGE CURSOR'                     32130000
321400                                   TO DP013-MESSAGE-TEXT (1)      32140000
321500                  MOVE SQLCA       TO DP013-SQLCA                 32150000
321600                  SET DP013-DB2-ABEND                             32160000
321700                                   TO TRUE                        32170000
321800                  PERFORM DP013-0000-PROCESS-ABEND                32180000
321900         END-EVALUATE                                             32190000
322000     ELSE                                                         32200000
322100          MOVE ZERO TO PV-DB2-COUNT-MANIFEST                      32210000
322200          MOVE ZERO TO PV-DB2-COUNT-ACTL-CTN                      32220000
322300     END-IF.                                                      32230000
322400                                                                  32240000
322500                                                                  32250000
322600 4350-CALCULATE-PERCENT-SCANNED.                                  32260000
322700     IF PV-DB2-COUNT-EXP-SCN > ZERO                               32270000
322800       DIVIDE PV-DB2-COUNT-ACTL-SCN BY PV-DB2-COUNT-EXP-SCN       32280000
322900         GIVING PV-DIVIDEND ROUNDED                               32290000
323000         MULTIPLY PV-DIVIDEND BY 100                              32300000
323100             GIVING PV-PERCENT-SCANNED                            32310000
323200     ELSE                                                         32320000
323300         MOVE ZEROES  TO  PV-DIVIDEND                             32330000
323400                          PV-PERCENT-SCANNED                      32340000
323500     END-IF.                                                      32350000
323600******************************************************************32360000
323700                                                                  32370000
323800 4360-CHECK-FOR-PBS-ERRORS.                                       32380000
323900                                                                  32390000
324000                                                                  32400000
324100     EXEC SQL                                                     32410000
324200         SELECT  COUNT(*)                                         32420000
324300         INTO  :PV-DB2-COUNT-PBS-ERRORS                           32430000
324400         FROM   TPKSLIP A                                         32440000
324500               ,TINPKSU B                                         32450000
324600               ,TSHUNLO C                                         32460000
324700         WHERE A.PO_NBR   = :DK-PO-NBR                            32470000
324800           AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                    32480000
324900           AND A.VER_STAT_CDE = 'A'                               32490000
325000           AND A.PO_NBR   = B.PO_NBR                              32500000
325100           AND A.SEQ_NBR  = B.SEQ_NBR                             32510000
325200           AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    32520000
325300           AND C.SCN_LOC_ID IN                                    32530000
325400                 ('PBSA', 'PBSB', 'PBSC','PBSD','PBSE')           32540000
325500     END-EXEC                                                     32550000
325600                                                                  32560000
325700                                                                  32570000
325800     EVALUATE TRUE                                                32580000
325900         WHEN SQLCODE = ZERO                                      32590000
326000         WHEN SQLCODE = +100                                      32600000
326100              IF PV-DB2-COUNT-PBS-ERRORS > 0                      32610000
326200                 SET PS-PBS-ERRORS-FOUND TO TRUE                  32620000
326300              ELSE                                                32630000
326400                 SET PS-PBS-ERRORS-FOUND-NO TO TRUE               32640000
326500              END-IF                                              32650000
326600         WHEN SQLWARN0 NOT = SPACE                                32660000
326700         WHEN SQLCODE NOT = ZERO                                  32670000
326800              MOVE '4360-CHECK-FOR-PBS-ERRORS'                    32680000
326900                               TO DP013-PARAGRAPH                 32690000
327000              MOVE 'CHECK FOR PBS ERRORS'                         32700000
327100                                  TO DP013-MESSAGE-TEXT (1)       32710000
327200              MOVE DK-PO-NBR      TO DP013-MESSAGE-TEXT (2)       32720000
327300              MOVE DK-REC-SEQ-NBR TO DP013-MESSAGE-TEXT (3)       32730000
327400              MOVE SQLCA       TO DP013-SQLCA                     32740000
327500              SET DP013-DB2-ABEND                                 32750000
327600                               TO TRUE                            32760000
327700              PERFORM DP013-0000-PROCESS-ABEND                    32770000
327800     END-EVALUATE.                                                32780000
327900                                                                  32790000
328000                                                                  32800000
328100******************************************************************32810000
328200****************************************************************  32820000
328300*GET CORRECT OPER AND FACILITY WHEN GOING TO                 ***  32830000
328400*RCVRINQ OR RCVRMNT SCREENS                                  ***  32840000
328500****************************************************************  32850000
328600 4370-CHECK-OPER-AND-FACILTY.                                     32860000
328700                                                                  32870000
328800         EXEC SQL                                                 32880000
328900                SELECT OPER_UNT_ID                                32890000
329000                     , FCLTY_ID                                   32900000
329100                     , STATUS_CDE                                 32910000
329200                INTO  :RECEIV-OPER-UNT-ID                         32920000
329300                     ,:RECEIV-FCLTY-ID                            32930000
329400                     ,:RECEIV-STATUS-CDE                          32940000
329500                FROM    TRECEIV                                   32950000
329600                WHERE   ORD_NBR     = :DK-PO-NBR                  32960000
329700                  AND   REC_SEQ_NBR = :DK-REC-SEQ-NBR             32970000
329800         END-EXEC                                                 32980000
329900                                                                  32990000
330000         EVALUATE TRUE                                            33000000
330100             WHEN SQLCODE = ZERO                                  33010000
330200             WHEN SQLCODE = +100                                  33020000
330300                  MOVE RECEIV-OPER-UNT-ID TO ASC-KEY-OPER-UNT-ID  33030000
330400                  MOVE RECEIV-FCLTY-ID    TO ASC-KEY-FCLTY-ID     33040000
330500             WHEN SQLWARN0 NOT = SPACE                            33050000
330600             WHEN SQLCODE NOT = ZERO                              33060000
330700                  MOVE '4370-CHECK-OPER-AND-FACILTY '             33070000
330800                                   TO DP013-PARAGRAPH             33080000
330900                  MOVE 'FETCH MESSAGE CURSOR'                     33090000
331000                                      TO DP013-MESSAGE-TEXT (1)   33100000
331100                  MOVE DK-PO-NBR      TO DP013-MESSAGE-TEXT (2)   33110000
331200                  MOVE DK-REC-SEQ-NBR TO DP013-MESSAGE-TEXT (3)   33120000
331300                  MOVE SQLCA       TO DP013-SQLCA                 33130000
331400                  SET DP013-DB2-ABEND                             33140000
331500                                   TO TRUE                        33150000
331600                  PERFORM DP013-0000-PROCESS-ABEND                33160000
331700         END-EVALUATE.                                            33170000
331800****************************************************************  33180000
331900* IDENTIFY FREE-ASTRAY ORDERS AND NON AUTO-VE ORDERS.          *  33190000
332000****************************************************************  33200000
332100 4380-GET-RECEIVER-INFO.                                          33210000
332200                                                                  33220000
332300         EXEC SQL                                                 33230000
332400                SELECT STATUS_CDE                                 33240000
332500                     , FRE_ASTRA_IND                              33250000
332600                     , CRE_UID                                    33260000
332700                INTO  :RECEIV-STATUS-CDE                          33270000
332800                     ,:RECEIV-FRE-ASTRA-IND                       33280000
332900                     ,:RECEIV-CRE-UID                             33290000
333000                FROM    TRECEIV                                   33300000
333100                WHERE   ORD_NBR     = :DK-PO-NBR                  33310000
333200                  AND   REC_SEQ_NBR = :DK-REC-SEQ-NBR             33320000
333300         END-EXEC                                                 33330000
333400                                                                  33340000
333500         EVALUATE TRUE                                            33350000
333600             WHEN SQLCODE = ZERO                                  33360000
333700                  SET PS-RECEIVER-FOUND-YES     TO TRUE           33370000
333800             WHEN SQLCODE = +100                                  33380000
333900                  SET PS-RECEIVER-FOUND-NO      TO TRUE           33390000
334000             WHEN SQLWARN0 NOT = SPACE                            33400000
334100             WHEN SQLCODE NOT = ZERO                              33410000
334200                  MOVE '4380-GET-RECEIVER-INFO'                   33420000
334300                                   TO DP013-PARAGRAPH             33430000
334400                  MOVE 'IDENTIFY FREE-ASTRAYS'                    33440000
334500                                      TO DP013-MESSAGE-TEXT (1)   33450000
334600                  MOVE DK-PO-NBR      TO DP013-MESSAGE-TEXT (2)   33460000
334700                  MOVE DK-REC-SEQ-NBR TO DP013-MESSAGE-TEXT (3)   33470000
334800                  MOVE SQLCA          TO DP013-SQLCA              33480000
334900                  SET DP013-DB2-ABEND                             33490000
335000                                      TO TRUE                     33500000
335100                  PERFORM DP013-0000-PROCESS-ABEND                33510000
335200         END-EVALUATE.                                            33520000
335300******************************************************************33530000
335400*  SELECT OPER UNIT FROM TRIPST.                                  33540000
335500******************************************************************33550000
335600 4381-SELECT-TTRIPST.                                             33560000
335700                                                                  33570000
335800         EXEC SQL                                                 33580000
335900                SELECT DISTINCT B.ORGN_OPER_UNT_ID                33590000
336000                INTO :SHPUNT-ORGN-OPER-UNT-ID                     33600000
336100                FROM   TSHUNLO A                                  33610000
336200                      ,TSHPUNT B                                  33620000
336300                      ,TSHUUPC C                                  33630000
336400                WHERE A.SHIPT_UNT_ID = B.SHIPT_UNT_ID             33640000
336500                  AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID             33650000
336600                  AND A.TRIP_ID      = :DK-TRIP-ID                33660000
336700                  AND A.OPER_UNT_ID  <>    B.ORGN_OPER_UNT_ID     33670000
336800                  AND C.TRN_NBR      = :DK-PO-NBR                 33680000
336900         END-EXEC                                                 33690000
337000                                                                  33700000
337100         EVALUATE TRUE                                            33710000
337200             WHEN SQLCODE = +0                                    33720000
337300             WHEN SQLCODE = -811                                  33730000
337400                 SET PS-MISDIRECT-YES   TO TRUE                   33740000
337500             WHEN SQLCODE = +100                                  33750000
337600                 SET PS-MISDIRECT-NO    TO TRUE                   33760000
337700                                                                  33770000
337800             WHEN SQLWARN0 NOT = SPACES                           33780000
337900             WHEN SQLCODE < +0                                    33790000
338000             WHEN SQLCODE > +0                                    33800000
338100                 MOVE '4381-SELECT-TTRIPST'                       33810000
338200                                   TO DP013-PARAGRAPH             33820000
338300                 MOVE 'SELECT OPER ON TTRIPST'                    33830000
338400                                   TO DP013-MESSAGE-TEXT(1)       33840000
338500                 MOVE DK-PO-NBR      TO DP013-MESSAGE-TEXT (2)    33850000
338600                 MOVE DK-REC-SEQ-NBR TO DP013-MESSAGE-TEXT (3)    33860000
338700                 MOVE SQLCA        TO DP013-SQLCA                 33870000
338800                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    33880000
338900                 SET DP013-DB2-ABEND                              33890000
339000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           33900000
339100                 PERFORM DP013-0000-PROCESS-ABEND                 33910000
339200         END-EVALUATE.                                            33920000
339300                                                                  33930000
339400****************************************************************  33940000
339500*GET CURR OPER UNT ID FROM TRECEIV                           ***  33950000
339600****************************************************************  33960000
339700 4383-SELECT-TRECEIV.                                             33970000
339800                                                                  33980000
339900         EXEC SQL                                                 33990000
340000                SELECT CURR_OPER_UNT_ID                           34000000
340100                INTO  :RECEIV-CURR-OPER-UNT-ID                    34010000
340200                FROM    TRECEIV                                   34020000
340300                WHERE   ORD_NBR     = :DK-PO-NBR                  34030000
340400                  AND   REC_SEQ_NBR = :DK-REC-SEQ-NBR             34040000
340500         END-EXEC                                                 34050000
340600                                                                  34060000
340700         EVALUATE TRUE                                            34070000
340800             WHEN SQLCODE = ZERO                                  34080000
340900                  CONTINUE                                        34090000
341000             WHEN SQLCODE = +100                                  34100000
341100                  MOVE ZEROES TO RECEIV-CURR-OPER-UNT-ID          34110000
341200             WHEN SQLWARN0 NOT = SPACE                            34120000
341300             WHEN SQLCODE NOT = ZERO                              34130000
341400                  MOVE '4383-SELECT-TRECEIV'                      34140000
341500                                   TO DP013-PARAGRAPH             34150000
341600                  MOVE 'FETCH CURRENT OPER'                       34160000
341700                                   TO DP013-MESSAGE-TEXT (1)      34170000
341800                  MOVE DK-PO-NBR      TO DP013-MESSAGE-TEXT (2)   34180000
341900                  MOVE DK-REC-SEQ-NBR TO DP013-MESSAGE-TEXT (3)   34190000
342000                  MOVE SQLCA       TO DP013-SQLCA                 34200000
342100                  SET DP013-DB2-ABEND                             34210000
342200                                   TO TRUE                        34220000
342300                  PERFORM DP013-0000-PROCESS-ABEND                34230000
342400         END-EVALUATE.                                            34240000
342500*----------------------------------------------------------------*34250000
342600* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *34260000
342700*----------------------------------------------------------------*34270000
342800                                                                  34280000
342900 4400-MOVE-COMMAREA-TO-SCREEN.                                    34290000
343000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             34300000
343100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          34310000
343200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          34320000
343300             MOVE +1    TO ASC-BLK-SUB                            34330000
343400             PERFORM 5100-WRITE-TEMP-STORAGE                      34340000
343500             ADD +1     TO ASC-BLK-SUB                            34350000
343600             PERFORM 5100-WRITE-TEMP-STORAGE                      34360000
343700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             34370000
343800                 GIVING PV-BLOCK-NUMBER                           34380000
343900                 REMAINDER PV-REMAINDER                           34390000
344000             IF  PV-REMAINDER > ZERO                              34400000
344100                 ADD +1 TO PV-BLOCK-NUMBER                        34410000
344200             END-IF                                               34420000
344300             MOVE +1    TO ASC-BLK-SUB                            34430000
344400             PERFORM 4410-READ-TEMP-STORAGE                       34440000
344500             ADD +1     TO ASC-BLK-SUB                            34450000
344600                           PV-BLOCK-NUMBER                        34460000
344700             PERFORM 4410-READ-TEMP-STORAGE                       34470000
344800     END-IF.                                                      34480000
344900     MOVE +1            TO ASC-BLK-SUB.                           34490000
345000     COMPUTE ASC-ITEM-SUB =                                       34500000
345100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              34510000
345200         + PC-ITEMS-PER-PANEL).                                   34520000
345300                                                                  34530000
345310     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        34531000
345320         ADD +1         TO ASC-BLK-SUB                            34532000
345330         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            34533000
345331     END-IF.                                                      34533100
345332                                                                  34533200
345333     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           34533300
345334         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                34533400
345335     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        34533500
345336     PERFORM 4420-FORMAT-LIST-LINES                               34533600
345337         VARYING PV-SUB                                           34533700
345338         FROM PC-ITEMS-PER-PANEL BY -1                            34533800
345339         UNTIL PV-SUB < +1.                                       34533900
345340                                                                  34534000
345341     COMPUTE ASC-ITEMS-DISPLAYED =                                34534100
345342         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          34534200
345343     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    34534300
345344                                      ASTRTITO.                   34534400
345345     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    34534500
345346     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    34534600
345347     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34534700
345348                                   TO ASELITO.                    34534800
345349     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     34534900
345350     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    34535000
345360     MOVE ASC-FCLTY-NME            TO ANAMEO.                     34536000
345370     MOVE ASC-SCAC-ID              TO ASCACO.                     34537000
345380     MOVE ASC-VEH-NBR              TO ATRLRO.                     34538000
345390     MOVE ASC-TRIP-ID              TO ATRIPO.                     34539000
345400     MOVE ASC-TOT-EXP-CRTNS        TO ATOTECRTO.                  34540000
345500     MOVE ASC-TOT-EXP-SCAN         TO ATOTESCNO.                  34550000
345600     MOVE ASC-STATUS               TO ASTATO.                     34560000
345700                                                                  34570000
345800     MOVE ASC-TOT-ACTL-CRTNS       TO ATOTACRTO.                  34580000
345900     MOVE ASC-TOT-ACTL-SCN         TO ATOTASCNO.                  34590000
346000     MOVE ASC-TOT-UNITS            TO ATOTUNTO.                   34600000
346100     MOVE ASC-TRIP-ID       TO DK-TRIP-ID                         34610000
346200                                                                  34620000
346300     PERFORM 8000-DETERMINE-COUNTS THRU 8000-EXIT.                34630000
346400     IF PV-BRANCH-COUNT > 0                                       34640000
346500         MOVE DP015-YELLOW         TO AMESSC                      34650000
346600         MOVE 'REPLEN'             TO AMESSO                      34660000
346700     ELSE                                                         34670000
346800         MOVE SPACES               TO AMESSO                      34680000
346500         MOVE DP015-YELLOW         TO AMESSC                      34681002
346900*        MOVE DP015-ASK-DRK-OFF    TO AMESSC                      34690002
347000     END-IF.                                                      34700000
347100                                                                  34710000
347200     IF  DP020-MSG-NUMBER-X = SPACE                               34720000
347300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  34730000
347400*            --- MORE ITEMS TO DISPLAY ----                       34740000
347500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            34750000
347600             SET DP020-MSG-INFORMATIONAL TO TRUE                  34760000
347700         END-IF                                                   34770000
347800     END-IF.                                                      34780000
347900*----------------------------------------------------------------*34790000
348000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *34800000
348100*----------------------------------------------------------------*34810000
348200                                                                  34820000
348300 4410-READ-TEMP-STORAGE.                                          34830000
348400                                                                  34840000
348500     EXEC CICS                                                    34850000
348600         READQ TS                                                 34860000
348700             QUEUE (ASC-LIST-QUEUE-NAME)                          34870000
348800             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34880000
348900             ITEM  (PV-BLOCK-NUMBER)                              34890000
349000             RESP  (PV-CICS-RESP)                                 34900000
349100     END-EXEC.                                                    34910000
349200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       34920000
349300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     34930000
349400         CONTINUE                                                 34940000
349500     ELSE                                                         34950000
349600         SET DP013-CICS-ABEND     TO TRUE                         34960000
349700         SET DP013-NO-ROLLBACK    TO TRUE                         34970000
349800         MOVE '4410-READ-TEMP-STORAGE'                            34980000
349900                                  TO DP013-PARAGRAPH              34990000
350000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      35000000
350100                                  TO DP013-MESSAGE-TEXT(1)        35010000
350200         PERFORM DP013-0000-PROCESS-ABEND                         35020000
350300     END-IF.                                                      35030000
350400                                                                  35040000
350500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             35050000
350600                                                                  35060000
350700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         35070000
350800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               35080000
350900     END-IF.                                                      35090000
351000 EJECT                                                            35100000
351100*----------------------------------------------------------------*35110000
351200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *35120000
351300*----------------------------------------------------------------*35130000
351400                                                                  35140000
351500 4420-FORMAT-LIST-LINES.                                          35150000
351600     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      35160000
351700         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                35170000
351800         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           35180000
351900         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           35190000
352000         MOVE SPACE              TO MR-ACTION  (PV-SUB)           35200000
352100                                    MR-SELECTI (PV-SUB)           35210000
352200                                    MR-PO-RCVR (PV-SUB)           35220000
352300                                    MR-PO-STATUS (PV-SUB)         35230000
352400                                    MR-VND-NME (PV-SUB)           35240000
352500                                    MR-PACK-TYPE (PV-SUB)         35250000
352600                                    MR-EXP-CART-COUNT-X  (PV-SUB) 35260000
352700                                    MR-ACTL-CART-COUNT-X (PV-SUB) 35270000
352800                                    MR-EXP-SCN-COUNT-X (PV-SUB)   35280000
352900                                    MR-ACTL-SCN-COUNT-X (PV-SUB)  35290000
353000                                    MR-PERCENT-SCND-X  (PV-SUB)   35300000
353100                                    MR-TOTAL-UNITS-X (PV-SUB)     35310000
353200     ELSE                                                         35320000
353300         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      35330000
353400                                                   > SPACE        35340000
353500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 35350000
353600                                 TO MR-SELECTI (PV-SUB)           35360000
353700         ELSE                                                     35370000
353800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      35380000
353900                                 TO MR-SELECTI (PV-SUB)           35390000
354000         END-IF                                                   35400000
354100                                                                  35410000
354200         IF  DP030-SET-CURSOR-TRAILER                             35420000
354300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)35430000
354400                 > SPACE)                                         35440000
354500               OR (PV-SUB = 1))                                   35450000
354600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               35460000
354700                MOVE -1          TO MR-SELECTL (PV-SUB)           35470000
354800             END-IF                                               35480000
354900         END-IF                                                   35490000
355000                                                                  35500000
355100         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           35510000
355200             IF ASC-CSR-IND (ASC-BLK-SUB ASC-ITEM-SUB) = 'A'      35520000
355300                 MOVE DP015-BLUE   TO MR-ACTIONC (PV-SUB)         35530000
355400                                      MR-PO-RCVRC (PV-SUB)        35540000
355500                                      MR-PO-STATUSC (PV-SUB)      35550000
355600                                      MR-VND-NMEC (PV-SUB)        35560000
355700                                      MR-PACK-TYPEC (PV-SUB)      35570000
355800                                      MR-EXP-CART-COUNTC (PV-SUB) 35580000
355900                                      MR-ACTL-CART-COUNTC (PV-SUB)35590000
356000                                      MR-EXP-SCN-COUNTC (PV-SUB)  35600000
356100                                      MR-ACTL-SCN-COUNTC (PV-SUB) 35610000
356200                                      MR-PERCENT-SCNDC (PV-SUB)   35620000
356300                                      MR-TOTAL-UNITSC (PV-SUB)    35630000
356400                 IF ASC-PBS-ERRORS-FOUND                          35640000
356500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35650000
356600                   MOVE DP015-RED TO MR-EXP-SCN-COUNTC (PV-SUB)   35660000
356700                 ELSE                                             35670000
356800                   MOVE DP015-BLUE   TO MR-EXP-SCN-COUNTC (PV-SUB)35680000
356900                 END-IF                                           35690000
357000                 IF ASC-AUTO-VE-NO (ASC-BLK-SUB ASC-ITEM-SUB)     35700000
357100                    MOVE DP015-YELLOW TO MR-VND-NMEC (PV-SUB)     35710000
357200                 END-IF                                           35720000
357300                 IF ASC-COLOR-YELLOW (ASC-BLK-SUB ASC-ITEM-SUB)   35730000
357400                     MOVE DP015-YELLOW TO MR-ACTIONC (PV-SUB)     35740000
357500                                          MR-PO-RCVRC (PV-SUB)    35750000
357600                                          MR-PO-STATUSC (PV-SUB)  35760000
357700                                          MR-VND-NMEC (PV-SUB)    35770000
357800                                          MR-PACK-TYPEC (PV-SUB)  35780000
357900                                          MR-EXP-CART-COUNTC      35790000
358000                                                       (PV-SUB)   35800000
358100                                          MR-ACTL-CART-COUNTC     35810000
358200                                                        (PV-SUB)  35820000
358300                                          MR-EXP-SCN-COUNTC       35830000
358400                                                        (PV-SUB)  35840000
358500                                          MR-ACTL-SCN-COUNTC      35850000
358600                                                        (PV-SUB)  35860000
358700                                          MR-PERCENT-SCNDC        35870000
358800                                                        (PV-SUB)  35880000
358900                                          MR-TOTAL-UNITSC (PV-SUB)35890000
359000                 END-IF                                           35900000
359100             ELSE                                                 35910000
359200                 MOVE DP015-YELLOW TO MR-ACTIONC (PV-SUB)         35920000
359300                                      MR-PO-RCVRC (PV-SUB)        35930000
359400                                      MR-PO-STATUSC (PV-SUB)      35940000
359500                                      MR-VND-NMEC (PV-SUB)        35950000
359600                                      MR-PACK-TYPEC (PV-SUB)      35960000
359700                                      MR-EXP-CART-COUNTC (PV-SUB) 35970000
359800                                      MR-ACTL-CART-COUNTC (PV-SUB)35980000
359900                                      MR-ACTL-SCN-COUNTC (PV-SUB) 35990000
360000                                      MR-PERCENT-SCNDC (PV-SUB)   36000000
360100                                      MR-TOTAL-UNITSC (PV-SUB)    36010000
360200                 IF ASC-PBS-ERRORS-FOUND                          36020000
360300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     36030000
360400                   MOVE DP015-RED TO MR-EXP-SCN-COUNTC (PV-SUB)   36040000
360500                 ELSE                                             36050000
360600                   MOVE DP015-YELLOW TO MR-EXP-SCN-COUNTC (PV-SUB)36060000
360700                 END-IF                                           36070000
360800             END-IF                                               36080000
360900                                                                  36090000
361000             IF ASC-AUTO-VE-NO (ASC-BLK-SUB ASC-ITEM-SUB)         36100000
361100                  MOVE DP015-YELLOW TO MR-VND-NMEC (PV-SUB)       36110000
361200             END-IF                                               36120000
361300                                                                  36130000
361400             IF ASC-CHCKIN-YES (ASC-BLK-SUB ASC-ITEM-SUB)         36140000
361500                  MOVE DP015-YELLOW TO MR-VND-NMEC (PV-SUB)       36150000
361600             END-IF                                               36160000
361601                                                                  36160100
361602             IF ASC-MISDIRECT-YES (ASC-BLK-SUB ASC-ITEM-SUB)      36160200
361603                  MOVE DP015-YELLOW TO MR-VND-NMEC (PV-SUB)       36160300
361604             END-IF                                               36160400
361605                                                                  36160500
361606             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           36160600
361607                                 TO MR-ACTION (PV-SUB)            36160700
361608             MOVE ASC-PO-RECEIVER  (ASC-BLK-SUB ASC-ITEM-SUB)     36160800
361609                                 TO MR-PO-RCVR (PV-SUB)           36160900
361610             MOVE ASC-PO-STATUS    (ASC-BLK-SUB ASC-ITEM-SUB)     36161000
361620                                 TO MR-PO-STATUS (PV-SUB)         36162000
361630             MOVE ASC-VND-NME      (ASC-BLK-SUB ASC-ITEM-SUB)     36163000
361640                                 TO MR-VND-NME (PV-SUB)           36164000
361650             MOVE ASC-PACK-TYPE  (ASC-BLK-SUB ASC-ITEM-SUB)       36165000
361660                                    TO MR-PACK-TYPE (PV-SUB)      36166000
361670             MOVE ASC-EXP-CART-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)   36167000
361680                                 TO MR-EXP-CART-COUNT (PV-SUB)    36168000
361690             MOVE ASC-ACTL-CART-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)  36169000
361700                                 TO MR-ACTL-CART-COUNT (PV-SUB)   36170000
361800             IF  ASC-EXP-SCN-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)     36180000
361900                                 > 9999                           36190000
362000                 MOVE '****'                                      36200000
362100                                 TO MR-EXP-SCN-COUNT-X (PV-SUB)   36210000
362200             ELSE                                                 36220000
362300                 MOVE ASC-EXP-SCN-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)36230000
362400                                 TO MR-EXP-SCN-COUNT (PV-SUB)     36240000
362500             END-IF                                               36250000
362600             MOVE ASC-ACTL-SCN-COUNT (ASC-BLK-SUB ASC-ITEM-SUB)   36260000
362700                                 TO MR-ACTL-SCN-COUNT (PV-SUB)    36270000
362800             MOVE ASC-PERCENT-SCND (ASC-BLK-SUB ASC-ITEM-SUB)     36280000
362900                                 TO MR-PERCENT-SCND (PV-SUB)      36290000
363000             MOVE ASC-TOTAL-UNITS  (ASC-BLK-SUB ASC-ITEM-SUB)     36300000
363100                                 TO MR-TOTAL-UNITS (PV-SUB)       36310000
363200         ELSE                                                     36320000
363300             IF ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES    36330000
363400                 MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)       36340000
363500                                     TO MR-ACTION (PV-SUB)        36350000
363600             END-IF                                               36360000
363700         END-IF                                                   36370000
363800     END-IF.                                                      36380000
363900     SUBTRACT +1 FROM ASC-ITEM-SUB                                36390000
364000     IF  ASC-ITEM-SUB < + 1                                       36400000
364100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  36410000
364200         MOVE +1                 TO ASC-BLK-SUB                   36420000
364300     END-IF.                                                      36430000
364400******************************************************************36440000
364500** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **36450000
364600** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **36460000
364700** ISSUE A WARNING.                                             **36470000
364800******************************************************************36480000
364900 4430-CHECK-FOR-BEGIN-AND-END.                                    36490000
365000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       36500000
365100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     36510000
365200*            -- NO END-OF-RANGE SPECFIED ---                      36520000
365300             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            36530000
365400             SET DP020-MSG-WARNING TO TRUE                        36540000
365500             PERFORM 4431-POSITION-AT-WARNING                     36550000
365600         END-IF                                                   36560000
365700     ELSE                                                         36570000
365800         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     36580000
365900*            -- NO BEGINNING-OF-RANGE SPECFIED ---                36590000
366000             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            36600000
366100             SET DP020-MSG-WARNING TO TRUE                        36610000
366200             PERFORM 4431-POSITION-AT-WARNING                     36620000
366300         END-IF                                                   36630000
366400     END-IF.                                                      36640000
366500******************************************************************36650000
366600** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **36660000
366700** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **36670000
366800** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **36680000
366900** POSITION THE CURSOR THERE.                                   **36690000
367000******************************************************************36700000
367100 4431-POSITION-AT-WARNING.                                        36710000
367200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 36720000
367300                    - PV-TOP-ITEM + 1.                            36730000
367400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36740000
367500         CONTINUE                                                 36750000
367600     ELSE                                                         36760000
367700         SET DP030-SET-CURSOR-APPL-1                              36770000
367800                                   TO TRUE                        36780000
367900         MOVE -1                   TO MR-SELECTL (PV-SUB)         36790000
368000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         36800000
368100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         36810000
368200     END-IF.                                                      36820000
368300                                                                  36830000
368400     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   36840000
368500                    - PV-TOP-ITEM + 1.                            36850000
368600     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      36860000
368700         CONTINUE                                                 36870000
368800     ELSE                                                         36880000
368900         SET DP030-SET-CURSOR-APPL-1                              36890000
369000                                   TO TRUE                        36900000
369100         MOVE -1                   TO MR-SELECTL (PV-SUB)         36910000
369200         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         36920000
369300         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         36930000
369400     END-IF.                                                      36940000
369500 EJECT                                                            36950000
369600*----------------------------------------------------------------*36960000
369700* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *36970000
369800* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *36980000
369900* FOR THE SELECTED ITEMS QUEUE.                                  *36990000
370000*                                                                *37000000
370100* DETERMINE WHICH COPYBOOK WILL BE USED TO PREPARE THE SELECTION *37010000
370200* QUEUE BASED ON THE FUNCTION SELECTED (FUCN02 AND FUNC03 GO TO  *37020000
370300* RC LISTS WHICH USE A DIFFERENT COPYBOOK                        *37030000
370400*                                                                *37040000
370500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *37050000
370600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *37060000
370700* THE ARRAY IS FULL.                                             *37070000
370800*----------------------------------------------------------------*37080000
370900                                                                  37090000
371000 5000-PREPARE-SEL-QUEUE.                                          37100000
371100                                                                  37110000
371200     MOVE +1                   TO  ASC-BLK-SUB.                   37120000
371300     PERFORM 5100-WRITE-TEMP-STORAGE.                             37130000
371400     ADD +1                    TO  ASC-BLK-SUB.                   37140000
371500     PERFORM 5100-WRITE-TEMP-STORAGE.                             37150000
371600                                                                  37160000
371700*LMM                                                              37170000
371800     EVALUATE TRUE                                                37180000
371900       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                37190000
372000       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                37200000
372100       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                37210000
372200       WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                37220000
372300               MOVE ASC-SEL-QUEUE-NAME TO RC015-SEL-QUEUE-NAME    37230000
372400*LMM                                                              37240000
372500       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                37250000
372600               MOVE ASC-SEL-QUEUE-NAME TO PC236-SEL-QUEUE-NAME    37260000
372700*F24                                                              37270000
372800       WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                37280000
372900               MOVE ASC-SEL-QUEUE-NAME TO SU009-SEL-QUEUE-NAME    37290000
373000       WHEN OTHER                                                 37300000
373100               MOVE ASC-SEL-QUEUE-NAME TO SU003-SEL-QUEUE-NAME    37310000
373200     END-EVALUATE.                                                37320000
373300                                                                  37330000
373400     PERFORM 6010-DELETE-SEL-QUEUE.                               37340000
373500                                                                  37350000
373600     SET ASC-UPDATE-TSQ        TO  TRUE.                          37360000
373700                                                                  37370000
373800                                                                  37380000
373900     EVALUATE TRUE                                                37390000
374000       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                37400000
374100       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                37410000
374200       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                37420000
374300       WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                37430000
374400               SET RC013-IDX         TO  1                        37440000
374500               MOVE ZERO             TO RC015-NUMBER-OF-TS-ITEMS  37450000
374600               INITIALIZE RC013-SELECTED-ITEM-ARRAY               37460000
374700*LMM                                                              37470000
374800       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                37480000
374900               SET PC237-IDX         TO  1                        37490000
375000               MOVE ZERO             TO PC236-NUMBER-OF-TS-ITEMS  37500000
375100               INITIALIZE PC237-SELECTED-ITEM-ARRAY               37510000
375200       WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                37520000
375300               SET SU010-IDX         TO  1                        37530000
375400               MOVE ZERO             TO SU009-NUMBER-OF-TS-ITEMS  37540000
375410               INITIALIZE SU010-SELECTED-ITEM-ARRAY               37541000
375420           CONTINUE                                               37542000
375430       WHEN OTHER                                                 37543000
375440               SET SU004-IDX         TO  1                        37544000
375450               MOVE ZERO             TO SU003-NUMBER-OF-TS-ITEMS  37545000
375460               INITIALIZE SU004-SELECTED-ITEM-ARRAY               37546000
375470     END-EVALUATE.                                                37547000
375480                                                                  37548000
375490     EVALUATE TRUE                                                37549000
375500       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                37550000
375600       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                37560000
375700       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                37570000
375800       WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                37580000
375900               SET PS-NO-VERIFIED-RECEIVER TO TRUE                37590000
376000               PERFORM 5300-FILL-SEL-QUEUE-RECORD                 37600000
376100                 VARYING PV-ITEM FROM 1 BY 1                      37610000
376200                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      37620000
376300*LMM                                                              37630000
376400       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                37640000
376500               SET PS-NO-VERIFIED-RECEIVER TO TRUE                37650000
376600               PERFORM 5400-FILL-SEL-QUEUE-RECORD                 37660000
376700                 VARYING PV-ITEM FROM 1 BY 1                      37670000
376800                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      37680000
376900*F24 BRANCH                                                       37690000
377000       WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)                37700000
377100               PERFORM 5600-FILL-SEL-QUEUE-RECORD                 37710000
377200                 VARYING PV-ITEM FROM 1 BY 1                      37720000
377300                   UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      37730000
377400       WHEN OTHER                                                 37740000
377500            PERFORM 5200-FILL-SEL-QUEUE-RECORD                    37750000
377600              VARYING PV-ITEM FROM 1 BY 1                         37760000
377700                UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN         37770000
377800     END-EVALUATE.                                                37780000
377900                                                                  37790000
378000     EVALUATE TRUE                                                37800000
378100       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                37810000
378200       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                37820000
378300       WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)                37830000
378400       WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                37840000
378500               IF RC013-IDX > 1                                   37850000
378600                  PERFORM 5305-WRITE-SEL-QUEUE                    37860000
378700                  ADD +1 TO RC015-NUMBER-OF-TS-ITEMS              37870000
378800               END-IF                                             37880000
378900*LMM                                                              37890000
379000       WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                37900000
379100               IF PC237-IDX > 1                                   37910000
379200                  PERFORM 5405-WRITE-SEL-QUEUE                    37920000
379300                  ADD +1 TO PC236-NUMBER-OF-TS-ITEMS              37930000
379400               END-IF                                             37940000
379500                                                                  37950000
379600       WHEN OTHER                                                 37960000
379700               IF SU004-IDX > 1                                   37970000
379800                  PERFORM 5205-WRITE-SEL-QUEUE                    37980000
379900                  ADD +1 TO SU003-NUMBER-OF-TS-ITEMS              37990000
380000               END-IF                                             38000000
380100     END-EVALUATE.                                                38010000
380200 EJECT                                                            38020000
380300                                                                  38030000
380400**********************************************************        38040000
380500 5010-OPEN-TOTAL-UNTS-CSR.                                        38050000
380600***TOTAL NUMBER OF CARTONS FOR EACH  PO/RECEIVER ON THE***        38060000
380700***TRAILER                                                        38070000
380800**********************************************************        38080000
380900                                                                  38090000
381000     PERFORM                                                      38100000
381100         WITH TEST AFTER                                          38110000
381200         VARYING PV-RETRY-COUNTER                                 38120000
381300         FROM 1 BY 1                                              38130000
381400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38140000
381500                   OR (SQLCODE = ZERO))                           38150000
381600                                                                  38160000
381700                 EXEC SQL                                         38170000
381800                      OPEN RECV-ITM-CSR                           38180000
381900                 END-EXEC                                         38190000
382000                                                                  38200000
382100                                                                  38210000
382200         EVALUATE TRUE                                            38220000
382300             WHEN SQLCODE = ZERO                                  38230000
382400             WHEN SQLCODE = -904                                  38240000
382500             WHEN SQLCODE = -913                                  38250000
382600                 CONTINUE                                         38260000
382700             WHEN SQLWARN0 NOT = SPACES                           38270000
382800             WHEN SQLCODE < ZERO                                  38280000
382900             WHEN SQLCODE > ZERO                                  38290000
383000                 MOVE '5010-OPEN-TOTAL-UNTS-CSR'                  38300000
383100                                   TO DP013-PARAGRAPH             38310000
383200                 MOVE 'OPEN SHIPMT CURSOR - '                     38320000
383300                                   TO DP013-MESSAGE-TEXT (1)      38330000
383400                 MOVE SQLCA        TO DP013-SQLCA                 38340000
383500                 MOVE 'TSHIPMT '   TO DP013-DB2-TABLE-NAME (1)    38350000
383600                 SET DP013-DB2-ABEND                              38360000
383700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38370000
383800                 PERFORM DP013-0000-PROCESS-ABEND                 38380000
383900         END-EVALUATE                                             38390000
384000     END-PERFORM.                                                 38400000
384100                                                                  38410000
384200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38420000
384300         SQLCODE NOT = ZERO                                       38430000
384400         MOVE '5010-OPEN-TOTAL-UNTS-CSR' TO DP013-PARAGRAPH       38440000
384500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   38450000
384600                                   TO DP013-MESSAGE-TEXT (1)      38460000
384700         MOVE SQLCA                TO DP013-SQLCA                 38470000
384800         MOVE 'TSHIPMT '           TO DP013-DB2-TABLE-NAME (1)    38480000
384900         SET DP013-DB2-ABEND                                      38490000
385000             DP013-XCTL-DISPLAY-RESTART                           38500000
385100                                   TO TRUE                        38510000
385200         PERFORM DP013-0000-PROCESS-ABEND                         38520000
385300     END-IF.                                                      38530000
385400                                                                  38540000
385500 EJECT                                                            38550000
385600******************************************************************38560000
385700* CLOSE TOTAL UNITS CURSOR                                     * *38570000
385800******************************************************************38580000
385900 5020-CLOSE-TOTAL-UNTS-CSR.                                       38590000
386000                                                                  38600000
386100         EXEC SQL                                                 38610000
386200             CLOSE RECV-ITM-CSR                                   38620000
386300         END-EXEC                                                 38630000
386400                                                                  38640000
386500     EVALUATE TRUE                                                38650000
386600         WHEN SQLCODE = ZERO                                      38660000
386700             CONTINUE                                             38670000
386800         WHEN SQLWARN0 NOT = SPACES                               38680000
386900         WHEN SQLCODE < ZERO                                      38690000
387000         WHEN SQLCODE > ZERO                                      38700000
387100             MOVE '5020-CLOSE-TOTAL-UNTS-CSR'                     38710000
387200                               TO DP013-PARAGRAPH                 38720000
387300             MOVE 'CLOSE SHIPMT CURSOR '                          38730000
387400                               TO DP013-MESSAGE-TEXT (1)          38740000
387500             MOVE SQLCA        TO DP013-SQLCA                     38750000
387600             MOVE 'TSYMSG  '   TO DP013-DB2-TABLE-NAME (1)        38760000
387700             SET DP013-DB2-ABEND                                  38770000
387800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               38780000
387900             PERFORM DP013-0000-PROCESS-ABEND                     38790000
388000     END-EVALUATE.                                                38800000
388100                                                                  38810000
388200 EJECT                                                            38820000
388300*----------------------------------------------------------------*38830000
388400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *38840000
388500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *38850000
388600*----------------------------------------------------------------*38860000
388700                                                                  38870000
388800 5100-WRITE-TEMP-STORAGE.                                         38880000
388900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     38890000
389000                                   TO PV-LIST-ITEM-NUMBER.        38900000
389100     COMPUTE PV-BLOCK-NUMBER =                                    38910000
389200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    38920000
389300                                                                  38930000
389400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             38940000
389500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             38950000
389600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      38960000
389700             PERFORM 5105-REWRITE-ASC-LISTQ                       38970000
389800         END-IF                                                   38980000
389900     ELSE                                                         38990000
390000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       39000000
390100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            39010000
390200         PERFORM 5110-WRITE-ASC-LISTQ                             39020000
390300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   39030000
390400     END-IF.                                                      39040000
390500                                                                  39050000
390600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             39060000
390700******************************************************************39070000
390800** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **39080000
390900** SPECIFIC COMMAREA.                                           **39090000
391000******************************************************************39100000
391100 5105-REWRITE-ASC-LISTQ.                                          39110000
391200     EXEC CICS                                                    39120000
391300         WRITEQ TS                                                39130000
391400             QUEUE (ASC-LIST-QUEUE-NAME)                          39140000
391500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               39150000
391600             ITEM  (PV-BLOCK-NUMBER)                              39160000
391700             REWRITE                                              39170000
391800             RESP  (PV-CICS-RESP)                                 39180000
391900     END-EXEC.                                                    39190000
392000                                                                  39200000
392100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           39210000
392200         CONTINUE                                                 39220000
392300     ELSE                                                         39230000
392400         SET DP013-CICS-ABEND            TO TRUE                  39240000
392500         SET DP013-NO-ROLLBACK           TO TRUE                  39250000
392600         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       39260000
392700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     39270000
392800                                         TO DP013-MESSAGE-TEXT(1) 39280000
392900         PERFORM DP013-0000-PROCESS-ABEND                         39290000
393000     END-IF.                                                      39300000
393100                                                                  39310000
393200******************************************************************39320000
393300** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **39330000
393400** SPECIFIC COMMAREA.                                           **39340000
393500******************************************************************39350000
393600 5110-WRITE-ASC-LISTQ.                                            39360000
393700     EXEC CICS                                                    39370000
393800         WRITEQ TS                                                39380000
393900             QUEUE (ASC-LIST-QUEUE-NAME)                          39390000
394000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               39400000
394100             ITEM  (PV-BLOCK-NUMBER)                              39410000
394200             RESP  (PV-CICS-RESP)                                 39420000
394300     END-EXEC.                                                    39430000
394400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      39440000
394500         SET DP013-CICS-ABEND      TO TRUE                        39450000
394600         SET DP013-NO-ROLLBACK     TO TRUE                        39460000
394700         MOVE '5110-WRITE-ASC-LISTQ'                              39470000
394800                                   TO DP013-PARAGRAPH             39480000
394900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           39490000
395000                                   TO DP013-MESSAGE-TEXT(1)       39500000
395100         PERFORM DP013-0000-PROCESS-ABEND                         39510000
395200     END-IF.                                                      39520000
395300 EJECT                                                            39530000
395400*----------------------------------------------------------------*39540000
395500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *39550000
395600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *39560000
395700*----------------------------------------------------------------*39570000
395800                                                                  39580000
395900 5200-FILL-SEL-QUEUE-RECORD.                                      39590000
396000                                                                  39600000
396100     PERFORM 6112-READ-LIST-QUEUE.                                39610000
396200     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       39620000
396300         PERFORM                                                  39630000
396400         VARYING LQW-IDX                                          39640000
396500         FROM 1 BY 1                                              39650000
396600         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            39660000
396700           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          39670000
396800             IF  LQW-SELECT (LQW-IDX)                             39680000
396900               MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)                39690000
397000                                 TO SU004-ITEM (SU004-IDX)        39700000
397100               MOVE SPACE        TO SU004-ACTION-SW (SU004-IDX)   39710000
397200               MOVE LQW-PO-NBR (LQW-IDX)                          39720000
397300                                 TO SU004-PO-NBR (SU004-IDX)      39730000
397400               MOVE LQW-RECEIVER (LQW-IDX)                        39740000
397500                                 TO SU004-REC-SEQ-NBR (SU004-IDX) 39750000
397600               MOVE LQW-RECEIVER (LQW-IDX)                        39760000
397700                                 TO SU004-REC-SEQ-NBR (SU004-IDX) 39770000
397800                 SET SU004-IDX UP BY 1                            39780000
397900                 IF  SU004-IDX > SU004-MAX-ITEMS                  39790000
398000                     PERFORM 5205-WRITE-SEL-QUEUE                 39800000
398100                     ADD +1        TO SU003-NUMBER-OF-TS-ITEMS    39810000
398200                     INITIALIZE SU004-SELECTED-ITEM-ARRAY         39820000
398300                     SET SU004-IDX TO  1                          39830000
398400                 END-IF                                           39840000
398500             END-IF                                               39850000
398600         END-PERFORM                                              39860000
398700     END-IF.                                                      39870000
398800                                                                  39880000
398900*----------------------------------------------------------------*39890000
399000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *39900000
399100*----------------------------------------------------------------*39910000
399200                                                                  39920000
399300 5205-WRITE-SEL-QUEUE.                                            39930000
399400                                                                  39940000
399500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            39950000
399600                                   TO SU004-SELECTED-ITEMS.       39960000
399700                                                                  39970000
399800     EXEC CICS                                                    39980000
399900          WRITEQ TS                                               39990000
400000              QUEUE (ASC-SEL-QUEUE-NAME)                          40000000
400100              FROM  (SU004-DC-SELECT-RECORD)                      40010000
400200              ITEM  (PV-SEL-QUEUE-ITEM)                           40020000
400300              RESP  (PV-CICS-RESP)                                40030000
400400     END-EXEC.                                                    40040000
400500                                                                  40050000
400600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          40060000
400700         CONTINUE                                                 40070000
400800     ELSE                                                         40080000
400900         SET DP013-CICS-ABEND      TO TRUE                        40090000
401000         SET DP013-NO-ROLLBACK     TO TRUE                        40100000
401100         MOVE '5205-WRITE-SEL-QUEUE'                              40110000
401200                                   TO DP013-PARAGRAPH             40120000
401300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          40130000
401400                                   TO DP013-MESSAGE-TEXT(1)       40140000
401500         PERFORM DP013-0000-PROCESS-ABEND                         40150000
401600     END-IF.                                                      40160000
401700*----------------------------------------------------------------*40170000
401800 5300-FILL-SEL-QUEUE-RECORD.                                      40180000
401900                                                                  40190000
402000     PERFORM 6112-READ-LIST-QUEUE.                                40200000
402100                                                                  40210000
402200     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        40220000
402300         PERFORM                                                  40230000
402400           VARYING LQW-IDX FROM 1 BY 1                            40240000
402500             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   40250000
402600                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          40260000
402700                                                                  40270000
402800             IF LQW-SELECT (LQW-IDX)                              40280000
402900                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              40290000
403000                            TO RC013-ITEM (RC013-IDX)             40300000
403100                 MOVE SPACE TO RC013-ACTION-SW (RC013-IDX)        40310000
403200                 MOVE LQW-PO-NBR (LQW-IDX)                        40320000
403300                            TO RC013-PO-NBR   (RC013-IDX)         40330000
403400                               DK-PO-NBR                          40340000
403500                 MOVE LQW-RECEIVER (LQW-IDX)                      40350000
403600                            TO RC013-REC-SEQ-NBR (RC013-IDX)      40360000
403700                               DK-REC-SEQ-NBR                     40370000
403800                                                                  40380000
403900                 PERFORM 4370-CHECK-OPER-AND-FACILTY              40390000
404000                                                                  40400000
404100                 IF RECEIV-STATUS-CDE = 'VE'                      40410000
404200                     SET PS-VERIFIED-RECEIVER TO TRUE             40420000
404300                     MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          40430000
404400                 END-IF                                           40440000
404500                 MOVE ASC-KEY-OPER-UNT-ID                         40450000
404600                            TO RC013-OPER-UNT-ID (RC013-IDX)      40460000
404700                 MOVE ASC-KEY-FCLTY-ID                            40470000
404800                            TO RC013-FCLTY-ID (RC013-IDX)         40480000
404900                                                                  40490000
405000                 IF LQW-RECEIVER(LQW-IDX) = ZERO                  40500000
405100                    SET PS-RECEIVER-DOESNT-EXIST TO TRUE          40510000
405200                 END-IF                                           40520000
405300                                                                  40530000
405400                 SET RC013-IDX UP BY 1                            40540000
405500                 IF RC013-IDX > RC013-MAX-ITEMS                   40550000
405600                     PERFORM 5305-WRITE-SEL-QUEUE                 40560000
405700                     ADD +1  TO RC015-NUMBER-OF-TS-ITEMS          40570000
405800                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         40580000
405900                     SET RC013-IDX TO 1                           40590000
406000                 END-IF                                           40600000
406100             END-IF                                               40610000
406200         END-PERFORM                                              40620000
406300     END-IF.                                                      40630000
406400     IF PS-VERIFIED-RECEIVER                                      40640000
406500         PERFORM 6113-WRITE-LIST-QUEUE                            40650000
406600     END-IF.                                                      40660000
406700                                                                  40670000
406800                                                                  40680000
406900*----------------------------------------------------------------*40690000
407000*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *40700000
407100*----------------------------------------------------------------*40710000
407200 5305-WRITE-SEL-QUEUE.                                            40720000
407300                                                                  40730000
407400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO RC013-SELECTED-ITEMS.   40740000
407500                                                                  40750000
407600     EXEC CICS                                                    40760000
407700          WRITEQ TS                                               40770000
407800              QUEUE (ASC-SEL-QUEUE-NAME)                          40780000
407900              FROM  (RC013-DC-SELECT-RECORD)                      40790000
408000              ITEM  (PV-SEL-QUEUE-ITEM)                           40800000
408100              RESP  (PV-CICS-RESP)                                40810000
408200     END-EXEC.                                                    40820000
408300     IF PV-CICS-RESP = DFHRESP (NORMAL)                           40830000
408400         CONTINUE                                                 40840000
408500     ELSE                                                         40850000
408600         SET DP013-CICS-ABEND        TO TRUE                      40860000
408700         SET DP013-NO-ROLLBACK       TO TRUE                      40870000
408800         MOVE '5305-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           40880000
408900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          40890000
409000                                     TO DP013-MESSAGE-TEXT(1)     40900000
409100         PERFORM DP013-0000-PROCESS-ABEND                         40910000
409200     END-IF.                                                      40920000
409300                                                                  40930000
409400*-----------------------------------------------------------------40940000
409500* FETCH FOR TOTAL UNITS                                           40950000
409600*-----------------------------------------------------------------40960000
409700 5310-FETCH-TOTAL-UNITS.                                          40970000
409800                                                                  40980000
409900     EXEC SQL                                                     40990000
410000            FETCH   RECV-ITM-CSR                                  41000000
410100            INTO   :RECITM-ORD-LNE-NBR                            41010000
410200                 , :RECITM-STATUS-CDE                             41020000
410300                 , :RECITM-PKSL-ITM-QTY                           41030000
410400                 , :RECITM-DTL-CK-ITM-QTY                         41040000
410500     END-EXEC                                                     41050000
410600                                                                  41060000
410700                                                                  41070000
410800     EVALUATE TRUE                                                41080000
410900         WHEN SQLCODE = ZERO                                      41090000
411000              PERFORM 5320-CHECK-RECEIPT-DISTRB                   41100000
411100         WHEN SQLCODE = +100                                      41110000
411200              SET PS-END-OF-RECITM-CSR TO TRUE                    41120000
411300         WHEN SQLWARN0 NOT = SPACE                                41130000
411400         WHEN SQLCODE NOT = ZERO                                  41140000
411500              MOVE '5310-FETCH-TOTAL-UNITS'                       41150000
411600                               TO DP013-PARAGRAPH                 41160000
411700              MOVE 'FETCH MESSAGE CURSOR'                         41170000
411800                               TO DP013-MESSAGE-TEXT (1)          41180000
411900              MOVE SQLCA       TO DP013-SQLCA                     41190000
412000              SET DP013-DB2-ABEND                                 41200000
412100                               TO TRUE                            41210000
412200              PERFORM DP013-0000-PROCESS-ABEND                    41220000
412300     END-EVALUATE.                                                41230000
412400******************************************************************41240000
412500******************************************************************41250000
412600                                                                  41260000
412700 5320-CHECK-RECEIPT-DISTRB.                                       41270000
412800                                                                  41280000
412900     EXEC SQL                                                     41290000
413000            SELECT SUM(VERIFY_ITM_QTY)                            41300000
413100                 , SUM(AP_VERIFY_ITM_QTY)                         41310000
413200            INTO   :PV-VERIFY-ITM-QTY                             41320000
413300                 , :PV-AP-VERIFY-ITM-QTY                          41330000
413400            FROM    TRECDIS                                       41340000
413500           WHERE   ORD_NBR        = :DK-PO-NBR                    41350000
413600              AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR               41360000
413700              AND  ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR           41370000
413800     END-EXEC                                                     41380000
413900                                                                  41390000
414000                                                                  41400000
414100     EVALUATE TRUE                                                41410000
414200         WHEN SQLCODE = ZERO                                      41420000
414300         WHEN SQLCODE = -305                                      41430000
414400         WHEN SQLCODE = +100                                      41440000
414500              CONTINUE                                            41450000
414600         WHEN SQLWARN0 NOT = SPACE                                41460000
414700         WHEN SQLCODE NOT = ZERO                                  41470000
414800              MOVE '5320-CHECK-RECEIPT-DISTRB'                    41480000
414900                               TO DP013-PARAGRAPH                 41490000
415000              MOVE 'FETCH MESSAGE CURSOR'                         41500000
415100                               TO DP013-MESSAGE-TEXT (1)          41510000
415200              MOVE SQLCA       TO DP013-SQLCA                     41520000
415300              SET DP013-DB2-ABEND                                 41530000
415400                               TO TRUE                            41540000
415500              PERFORM DP013-0000-PROCESS-ABEND                    41550000
415600     END-EVALUATE.                                                41560000
415700                                                                  41570000
415800     IF SQLCODE = ZERO                                            41580000
415900        IF RECITM-STATUS-CDE = 'VE'                               41590000
416000           ADD PV-AP-VERIFY-ITM-QTY TO  PV-PO-RCVR-UNT-CNTR       41600000
416100        ELSE                                                      41610000
416200           ADD PV-VERIFY-ITM-QTY TO PV-PO-RCVR-UNT-CNTR           41620000
416300        END-IF                                                    41630000
416400     ELSE                                                         41640000
416500        IF RECITM-DTL-CK-ITM-QTY > 0                              41650000
416600           ADD RECITM-DTL-CK-ITM-QTY TO  PV-PO-RCVR-UNT-CNTR      41660000
416700        ELSE                                                      41670000
416800           ADD RECITM-PKSL-ITM-QTY TO PV-PO-RCVR-UNT-CNTR         41680000
416900        END-IF                                                    41690000
417000     END-IF.                                                      41700000
417100*----------------------------------------------------------------*41710000
417200*LMM                                                              41720000
417300 5400-FILL-SEL-QUEUE-RECORD.                                      41730000
417400                                                                  41740000
417500     PERFORM 6112-READ-LIST-QUEUE.                                41750000
417600                                                                  41760000
417700     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        41770000
417800         PERFORM                                                  41780000
417900           VARYING LQW-IDX FROM 1 BY 1                            41790000
418000             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   41800000
418100                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          41810000
418200                                                                  41820000
418300             IF LQW-SELECT (LQW-IDX)                              41830000
418400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              41840000
418500                            TO PC237-ITEM (PC237-IDX)             41850000
418600                 MOVE SPACE TO PC237-ACTION-SW (PC237-IDX)        41860000
418700                 MOVE LQW-PO-NBR (LQW-IDX)                        41870000
418800                            TO PC237-PO-NBR   (PC237-IDX)         41880000
418900                               DK-PO-NBR                          41890000
419000                 MOVE LQW-RECEIVER (LQW-IDX)                      41900000
419100                            TO PC237-REC-SEQ-NBR (PC237-IDX)      41910000
419200                               DK-REC-SEQ-NBR                     41920000
419300                                                                  41930000
419400                 PERFORM 4370-CHECK-OPER-AND-FACILTY              41940000
419500                                                                  41950000
419600                 IF RECEIV-STATUS-CDE = 'VE'                      41960000
419700                     SET PS-VERIFIED-RECEIVER TO TRUE             41970000
419800                     MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          41980000
419900                 END-IF                                           41990000
420000                 MOVE ASC-KEY-OPER-UNT-ID                         42000000
420100                            TO PC237-OPER-UNT-ID (PC237-IDX)      42010000
420200                 MOVE ASC-KEY-FCLTY-ID                            42020000
420300                            TO PC237-FCLTY-ID (PC237-IDX)         42030000
420400                                                                  42040000
420500                 IF LQW-RECEIVER(LQW-IDX) = ZERO                  42050000
420600                    SET PS-RECEIVER-DOESNT-EXIST TO TRUE          42060000
420700                 END-IF                                           42070000
420800                                                                  42080000
420900                 SET PC237-IDX UP BY 1                            42090000
421000                 IF PC237-IDX > PC237-MAX-ITEMS                   42100000
421100                     PERFORM 5405-WRITE-SEL-QUEUE                 42110000
421200                     ADD +1  TO PC236-NUMBER-OF-TS-ITEMS          42120000
421300                     INITIALIZE PC237-SELECTED-ITEM-ARRAY         42130000
421400                     SET PC237-IDX TO 1                           42140000
421500                 END-IF                                           42150000
421600             END-IF                                               42160000
421700         END-PERFORM                                              42170000
421800     END-IF.                                                      42180000
421900     IF PS-VERIFIED-RECEIVER                                      42190000
422000         PERFORM 6113-WRITE-LIST-QUEUE                            42200000
422100     END-IF.                                                      42210000
422200                                                                  42220000
422300*LMM                                                              42230000
422400*----------------------------------------------------------------*42240000
422500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *42250000
422600*----------------------------------------------------------------*42260000
422700 5405-WRITE-SEL-QUEUE.                                            42270000
422800                                                                  42280000
422900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO PC237-SELECTED-ITEMS.   42290000
423000                                                                  42300000
423100     EXEC CICS                                                    42310000
423200          WRITEQ TS                                               42320000
423300              QUEUE (ASC-SEL-QUEUE-NAME)                          42330000
423400              FROM  (PC237-DC-SELECT-RECORD)                      42340000
423500              ITEM  (PV-SEL-QUEUE-ITEM)                           42350000
423600              RESP  (PV-CICS-RESP)                                42360000
423700     END-EXEC.                                                    42370000
423800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           42380000
423900         CONTINUE                                                 42390000
424000     ELSE                                                         42400000
424100         SET DP013-CICS-ABEND        TO TRUE                      42410000
424200         SET DP013-NO-ROLLBACK       TO TRUE                      42420000
424300         MOVE '5405-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           42430000
424400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          42440000
424500                                     TO DP013-MESSAGE-TEXT(1)     42450000
424600         PERFORM DP013-0000-PROCESS-ABEND                         42460000
424700     END-IF.                                                      42470000
424800                                                                  42480000
424810*----------------------------------------------------------------*42481000
424811 5410-WRITE-SEL-QUEUE.                                            42481100
424812                                                                  42481200
424813     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU010-SELECTED-ITEMS.   42481300
424814                                                                  42481400
424815     EXEC CICS                                                    42481500
424816          WRITEQ TS                                               42481600
424817              QUEUE (ASC-SEL-QUEUE-NAME)                          42481700
424818              FROM  (SU010-SELECT-RECORD)                         42481800
424819              ITEM  (PV-SEL-QUEUE-ITEM)                           42481900
424820              RESP  (PV-CICS-RESP)                                42482000
424821     END-EXEC.                                                    42482100
424822     IF PV-CICS-RESP = DFHRESP (NORMAL)                           42482200
424823         CONTINUE                                                 42482300
424824     ELSE                                                         42482400
424825         SET DP013-CICS-ABEND        TO TRUE                      42482500
424826         SET DP013-NO-ROLLBACK       TO TRUE                      42482600
424827         MOVE '5410-WRITE-SEL-QUEUE' TO DP013-PARAGRAPH           42482700
424828         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          42482800
424829                                     TO DP013-MESSAGE-TEXT(1)     42482900
424830         PERFORM DP013-0000-PROCESS-ABEND                         42483000
424831     END-IF.                                                      42483100
424832                                                                  42483200
424833*----------------------------------------------------------------*42483300
424834* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *42483400
424835* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *42483500
424836*----------------------------------------------------------------*42483600
424837                                                                  42483700
424838 5500-FILL-SEL-QUEUE-RECORD.                                      42483800
424839     MOVE ASC-TRIP-ID TO SU009-TRIP-ID.                           42483900
424840     PERFORM 6112-READ-LIST-QUEUE.                                42484000
424850                                                                  42485000
424860     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        42486000
424861         PERFORM                                                  42486100
424862           VARYING LQW-IDX FROM 1 BY 1                            42486200
424863             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   42486300
424864                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          42486400
424865                                                                  42486500
424866             IF LQW-SELECT (LQW-IDX)                              42486600
424867                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              42486700
424868                            TO PC237-ITEM (PC237-IDX)             42486800
424869                 MOVE SPACE TO PC237-ACTION-SW (PC237-IDX)        42486900
424870                 MOVE LQW-PO-NBR (LQW-IDX)                        42487000
424871                            TO PC237-PO-NBR   (PC237-IDX)         42487100
424872                               DK-PO-NBR                          42487200
424873                 MOVE LQW-RECEIVER (LQW-IDX)                      42487300
424874                            TO PC237-REC-SEQ-NBR (PC237-IDX)      42487400
424875                               DK-REC-SEQ-NBR                     42487500
424876                                                                  42487600
424877                 PERFORM 4370-CHECK-OPER-AND-FACILTY              42487700
424878                                                                  42487800
424879                 IF RECEIV-STATUS-CDE = 'VE'                      42487900
424880                     SET PS-VERIFIED-RECEIVER TO TRUE             42488000
424881                     MOVE PC-ERR TO LQW-ACTION (LQW-IDX)          42488100
424882                 END-IF                                           42488200
424883                 MOVE ASC-KEY-OPER-UNT-ID                         42488300
424884                            TO PC237-OPER-UNT-ID (PC237-IDX)      42488400
424885                 MOVE ASC-KEY-FCLTY-ID                            42488500
424886                            TO PC237-FCLTY-ID (PC237-IDX)         42488600
424887                                                                  42488700
424888                 IF LQW-RECEIVER(LQW-IDX) = ZERO                  42488800
424889                    SET PS-RECEIVER-DOESNT-EXIST TO TRUE          42488900
424890                 END-IF                                           42489000
424891                                                                  42489100
424892                 SET PC237-IDX UP BY 1                            42489200
424893                 IF PC237-IDX > PC237-MAX-ITEMS                   42489300
424894                     PERFORM 5405-WRITE-SEL-QUEUE                 42489400
424895                     ADD +1  TO PC236-NUMBER-OF-TS-ITEMS          42489500
424896                     INITIALIZE PC237-SELECTED-ITEM-ARRAY         42489600
424897                     SET PC237-IDX TO 1                           42489700
424898                 END-IF                                           42489800
424899             END-IF                                               42489900
424900         END-PERFORM                                              42490000
424901     END-IF.                                                      42490100
424902     IF PS-VERIFIED-RECEIVER                                      42490200
424903         PERFORM 6113-WRITE-LIST-QUEUE                            42490300
424904     END-IF.                                                      42490400
424905                                                                  42490500
424906 5600-FILL-SEL-QUEUE-RECORD.                                      42490600
424907     PERFORM 6112-READ-LIST-QUEUE.                                42490700
424908                                                                  42490800
424909     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        42490900
424910         PERFORM                                                  42491000
424911           VARYING LQW-IDX FROM 1 BY 1                            42491100
424912             UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                   42491200
424913                OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO          42491300
424914                                                                  42491400
424915*            IF LQW-SELECT (LQW-IDX)                              42491500
424916                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              42491600
424917                            TO SU010-ITEM (SU010-IDX)             42491700
424918                 MOVE SPACE TO PC237-ACTION-SW (SU010-IDX)        42491800
424919                 MOVE ASC-TRIP-ID TO SU010-TRIP-ID (SU010-IDX)    42491900
424920                 MOVE ASC-KEY-OPER-UNT-ID                         42492000
424930                            TO SU010-OPER-UNIT-ID (SU010-IDX)     42493000
424940                                                                  42494000
424941                 SET SU010-IDX UP BY 1                            42494100
424942                 IF SU010-IDX > SU010-MAX-ITEMS                   42494200
424943                     PERFORM 5410-WRITE-SEL-QUEUE                 42494300
424944                     ADD +1  TO SU009-NUMBER-OF-TS-ITEMS          42494400
424945                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         42494500
424946                     SET SU010-IDX TO 1                           42494600
424947                 END-IF                                           42494700
424948*            END-IF                                               42494800
424949         END-PERFORM                                              42494900
424950     END-IF.                                                      42495000
424960                                                                  42496000
424970*----------------------------------------------------------------*42497000
424980*  RETRIEVE THE PRIMARY VENDOR NAME                               42498000
424990*----------------------------------------------------------------*42499000
425000                                                                  42500000
425100 5910-GET-ENT-NAME-DESC.                                          42510000
425200                                                                  42520000
425300     PERFORM                                                      42530000
425400         WITH TEST AFTER                                          42540000
425500         VARYING PV-RETRY-COUNTER                                 42550000
425600         FROM 1 BY 1                                              42560000
425700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42570000
425800             OR (SQLCODE = +0)                                    42580000
425900             OR (SQLCODE = +100))                                 42590000
426000                                                                  42600000
426100         EXEC SQL                                                 42610000
426200              SELECT B.ENT_NAME_DESC                              42620000
426300                INTO :ENTNME-ENT-NAME-DESC                        42630000
426400                FROM TPURCHS A                                    42640000
426500                    ,TENTNME B                                    42650000
426600               WHERE A.PO_NBR         = :DK-PO-NBR                42660000
426700                 AND A.VER_STATUS_CDE = 'A'                       42670000
426800                 AND B.TYPE_CDE       = '01'                      42680000
426900                 AND A.ENT_ID = B.ENT_ID                          42690000
427000         END-EXEC                                                 42700000
427100                                                                  42710000
427200         EVALUATE TRUE                                            42720000
427300             WHEN SQLCODE = +0                                    42730000
427400               CONTINUE                                           42740000
427500             WHEN SQLCODE = +100                                  42750000
427600               MOVE PC-UNKNWN-VND-NME TO ENTNME-ENT-NAME-DESC     42760000
427700             WHEN SQLWARN0 NOT = SPACES                           42770000
427800             WHEN SQLCODE < +0                                    42780000
427900             WHEN SQLCODE > +0                                    42790000
428000                  MOVE '5910-GET-ENT-NAME-DESC'                   42800000
428100                                  TO DP013-PARAGRAPH              42810000
428200                  MOVE 'UNSUCCESSFUL SELECT ENTERPRISE NAME'      42820000
428300                                  TO DP013-MESSAGE-TEXT (1)       42830000
428400                  MOVE DK-PO-NBR      TO DP013-MESSAGE-TEXT (2)   42840000
428500                  MOVE DK-REC-SEQ-NBR TO DP013-MESSAGE-TEXT (3)   42850000
428600                  MOVE SQLCA      TO DP013-SQLCA                  42860000
428700                  MOVE 'TENTNME ' TO DP013-DB2-TABLE-NAME (1)     42870000
428800                  SET DP013-DB2-ABEND                             42880000
428900                      DP013-XCTL-DISPLAY-RESTART                  42890000
429000                                  TO TRUE                         42900000
429100                  PERFORM DP013-0000-PROCESS-ABEND                42910000
429200         END-EVALUATE                                             42920000
429300     END-PERFORM.                                                 42930000
429400                                                                  42940000
429500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42950000
429600         SQLCODE NOT = ZERO                                       42960000
429700         MOVE '5910-GET-ENT-NAME-DESC'                            42970000
429800                                  TO DP013-PARAGRAPH              42980000
429900         MOVE 'MAX RETRIES EXCEEDED ON SELECT ENTERPRISE NAME'    42990000
430000                                  TO DP013-MESSAGE-TEXT (1)       43000000
430100         MOVE DK-PO-NBR           TO DP013-MESSAGE-TEXT (2)       43010000
430200         MOVE DK-REC-SEQ-NBR      TO DP013-MESSAGE-TEXT (3)       43020000
430300         MOVE SQLCA               TO DP013-SQLCA                  43030000
430400         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (1)     43040000
430500         SET DP013-DB2-ABEND                                      43050000
430600             DP013-XCTL-DISPLAY-RESTART                           43060000
430700                                  TO TRUE                         43070000
430800         PERFORM DP013-0000-PROCESS-ABEND                         43080000
430900     END-IF.                                                      43090000
431000                                                                  43100000
431100/                                                                 43110000
431200******************************************************************43120000
431300 6000-REFRESH-PANEL-FROM-TEMP.                                    43130000
431400     IF  ASC-UPDATE-TSQ AND                                       43140000
431500         ((ASC-FUNC02-RETURN-YES OR                               43150000
431600           ASC-FUNC03-RETURN-YES OR                               43160000
431700           ASC-FUNC05-RETURN-YES OR                               43170000
431800           ASC-FUNC06-RETURN-YES OR                               43180000
431900*LMM                                                              43190000
432000           ASC-FUNC07-RETURN-YES) OR                              43200000
432100          SU003-UPDATE-TSQ)                                       43210000
432200         SET ASC-NO-TSQ-UPDATE TO TRUE                            43220000
432300         MOVE ZERO                 TO PV-SAVE-ITEM                43230000
432400                                      PV-SEL-QUEUE-ITEM           43240000
432500         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        43250000
432600                                   TO PV-HOLD-SELECTED-ITEMS      43260000
432700         MOVE +1                   TO PV-ITEMS-PROCESSED          43270000
432800                                                                  43280000
432900*LMM                                                              43290000
433000         EVALUATE TRUE                                            43300000
433100            WHEN ASC-FUNC02-RETURN-YES OR                         43310000
433200                 ASC-FUNC03-RETURN-YES OR                         43320000
433300                 ASC-FUNC05-RETURN-YES OR                         43330000
433400                 ASC-FUNC07-RETURN-YES                            43340000
433500               PERFORM 6200-UPDATE-TSQ                            43350000
433600                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS43360000
433700*LMM                                                              43370000
433800            WHEN ASC-FUNC06-RETURN-YES                            43380000
433900               PERFORM 6300-UPDATE-TSQ                            43390000
434000                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS43400000
434100            WHEN OTHER                                            43410000
434200               PERFORM 6100-UPDATE-TSQ                            43420000
434300                 UNTIL PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS43430000
434400         END-EVALUATE                                             43440000
434500                                                                  43450000
434600         SET ASC-FUNC02-RETURN-NO TO TRUE                         43460000
434700         SET ASC-FUNC03-RETURN-NO TO TRUE                         43470000
434800         SET ASC-FUNC05-RETURN-NO TO TRUE                         43480000
434900         SET ASC-FUNC07-RETURN-NO TO TRUE                         43490000
435000*LMM                                                              43500000
435100         SET ASC-FUNC06-RETURN-NO TO TRUE                         43510000
435200                                                                  43520000
435300                                                                  43530000
435400         INITIALIZE ASC-BLOCK-ENTRIES (1)                         43540000
435500                    ASC-BLOCK-ENTRIES (2)                         43550000
435600     END-IF.                                                      43560000
435700                                                                  43570000
435800*----------------------------------------------------------------*43580000
435900*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *43590000
436000*----------------------------------------------------------------*43600000
436100 6010-DELETE-SEL-QUEUE.                                           43610000
436200                                                                  43620000
436300     EXEC CICS                                                    43630000
436400         DELETEQ TS                                               43640000
436500             QUEUE (ASC-SEL-QUEUE-NAME)                           43650000
436600             RESP  (PV-CICS-RESP)                                 43660000
436700     END-EXEC.                                                    43670000
436800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      43680000
436900        (PV-CICS-RESP = DFHRESP(QIDERR)))                         43690000
437000         CONTINUE                                                 43700000
437100     ELSE                                                         43710000
437200         SET DP013-CICS-ABEND TO TRUE                             43720000
437300         SET DP013-NO-ROLLBACK TO TRUE                            43730000
437400         MOVE '6010-DELETE-SEL-QUEUE'                             43740000
437500                        TO DP013-PARAGRAPH                        43750000
437600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         43760000
437700                        TO DP013-MESSAGE-TEXT (1)                 43770000
437800         PERFORM DP013-0000-PROCESS-ABEND                         43780000
437900     END-IF.                                                      43790000
438000                                                                  43800000
438100 EJECT                                                            43810000
438200*----------------------------------------------------------------*43820000
438300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *43830000
438400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *43840000
438500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *43850000
438600*    THE TEMP QUEUE.                                             *43860000
438700*----------------------------------------------------------------*43870000
438800                                                                  43880000
438900 6100-UPDATE-TSQ.                                                 43890000
439000                                                                  43900000
439100     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             43910000
439200     PERFORM 6105-READ-SEL-QUEUE.                                 43920000
439300     PERFORM                                                      43930000
439400         VARYING SU004-IDX                                        43940000
439500         FROM 1 BY 1                                              43950000
439600         UNTIL ((PV-ITEMS-PROCESSED >                             43960000
439700                              PV-HOLD-SELECTED-ITEMS)             43970000
439800         OR (SU004-IDX GREATER THAN SU004-MAX-ITEMS))             43980000
439900         IF  SU004-ACTION-SW (SU004-IDX) > SPACE                  43990000
440000             PERFORM 6110-PROCESS-ITEMS                           44000000
440100         END-IF                                                   44010000
440200         ADD +1                TO PV-ITEMS-PROCESSED              44020000
440300     END-PERFORM.                                                 44030000
440400     PERFORM 6111-WRITE-LIST-QUEUE.                               44040000
440500*----------------------------------------------------------------*44050000
440600*    READ THE LIST QUEUE RECORD.                                 *44060000
440700*----------------------------------------------------------------*44070000
440800                                                                  44080000
440900 6105-READ-SEL-QUEUE.                                             44090000
441000                                                                  44100000
441100     EXEC CICS                                                    44110000
441200          READQ TS                                                44120000
441300              QUEUE (ASC-SEL-QUEUE-NAME)                          44130000
441400              INTO  (SU004-DC-SELECT-RECORD)                      44140000
441500              ITEM  (PV-SEL-QUEUE-ITEM)                           44150000
441600              RESP  (PV-CICS-RESP)                                44160000
441700     END-EXEC.                                                    44170000
441800*                                                                 44180000
441900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44190000
442000         CONTINUE                                                 44200000
442100     ELSE                                                         44210000
442200         SET DP013-CICS-ABEND      TO  TRUE                       44220000
442300         SET DP013-NO-ROLLBACK     TO  TRUE                       44230000
442400         MOVE '6105-READ-SEL-QUEUE'                               44240000
442500                                   TO  DP013-PARAGRAPH            44250000
442600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           44260000
442700                                   TO  DP013-MESSAGE-TEXT(1)      44270000
442800         PERFORM DP013-0000-PROCESS-ABEND                         44280000
442900     END-IF.                                                      44290000
443000 EJECT                                                            44300000
443100*----------------------------------------------------------------*44310000
443200*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*44320000
443300*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*44330000
443400*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *44340000
443500*----------------------------------------------------------------*44350000
443600                                                                  44360000
443700 6110-PROCESS-ITEMS.                                              44370000
443800                                                                  44380000
443900     COMPUTE PV-ITEM = 1 + ((SU004-ITEM (SU004-IDX) - 1)          44390000
444000                     / PC-ITEMS-PER-PANEL).                       44400000
444100                                                                  44410000
444200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           44420000
444300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          44430000
444400             PERFORM 6111-WRITE-LIST-QUEUE                        44440000
444500         END-IF                                                   44450000
444600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    44460000
444700                                                                  44470000
444800         PERFORM 6112-READ-LIST-QUEUE                             44480000
444900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               44490000
445000             CONTINUE                                             44500000
445100         END-IF                                                   44510000
445200     END-IF.                                                      44520000
445300                                                                  44530000
445400     COMPUTE PV-SUB = (SU004-ITEM (SU004-IDX)                     44540000
445500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              44550000
445600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         44560000
445700     MOVE LQW-SELECTED-SW (PV-SUB)                                44570000
445800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  44580000
445900     EVALUATE TRUE                                                44590000
446000         WHEN SU004-INQ (SU004-IDX)                               44600000
446100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             44610000
446200                                                                  44620000
446300         WHEN SU004-UPD (SU004-IDX)                               44630000
446400              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             44640000
446500                                                                  44650000
446600         WHEN SU004-DEL (SU004-IDX)                               44660000
446700              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             44670000
446800                                                                  44680000
446900         WHEN SU004-ERR (SU004-IDX)                               44690000
447000              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             44700000
447100     END-EVALUATE.                                                44710000
447200                                                                  44720000
447300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                44730000
447400                                                                  44740000
447500*----------------------------------------------------------------*44750000
447600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *44760000
447700*----------------------------------------------------------------*44770000
447800                                                                  44780000
447900 6111-WRITE-LIST-QUEUE.                                           44790000
448000                                                                  44800000
448100     EXEC CICS                                                    44810000
448200         WRITEQ TS                                                44820000
448300             QUEUE (ASC-LIST-QUEUE-NAME)                          44830000
448400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     44840000
448500             ITEM  (PV-SAVE-ITEM)                                 44850000
448600             REWRITE                                              44860000
448700             RESP  (PV-CICS-RESP)                                 44870000
448800     END-EXEC.                                                    44880000
448900*                                                                 44890000
449000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44900000
449100         CONTINUE                                                 44910000
449200     ELSE                                                         44920000
449300         SET DP013-CICS-ABEND  TO  TRUE                           44930000
449400         SET DP013-NO-ROLLBACK TO  TRUE                           44940000
449500         MOVE '6111-WRITE-LIST-QUEUE'                             44950000
449600                               TO  DP013-PARAGRAPH                44960000
449700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  44970000
449800                               TO  DP013-MESSAGE-TEXT(1)          44980000
449900         PERFORM DP013-0000-PROCESS-ABEND                         44990000
450000     END-IF.                                                      45000000
450100                                                                  45010000
450200 EJECT                                                            45020000
450300*----------------------------------------------------------------*45030000
450400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*45040000
450500*----------------------------------------------------------------*45050000
450600                                                                  45060000
450700 6112-READ-LIST-QUEUE.                                            45070000
450800                                                                  45080000
450900     EXEC CICS                                                    45090000
451000         READQ TS                                                 45100000
451100             QUEUE (ASC-LIST-QUEUE-NAME)                          45110000
451200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     45120000
451300             ITEM  (PV-ITEM)                                      45130000
451400             RESP  (PV-CICS-RESP)                                 45140000
451500     END-EXEC.                                                    45150000
451600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          45160000
451700         CONTINUE                                                 45170000
451800     ELSE                                                         45180000
451900         SET DP013-CICS-ABEND        TO TRUE                      45190000
452000         SET DP013-NO-ROLLBACK       TO TRUE                      45200000
452100         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           45210000
452200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    45220000
452300                                     TO DP013-MESSAGE-TEXT(1)     45230000
452400         PERFORM DP013-0000-PROCESS-ABEND                         45240000
452500     END-IF.                                                      45250000
452600                                                                  45260000
452700*----------------------------------------------------------------*45270000
452800*    WRITE THE TS QUEUE RECORD                                   *45280000
452900*----------------------------------------------------------------*45290000
453000                                                                  45300000
453100 6113-WRITE-LIST-QUEUE.                                           45310000
453200                                                                  45320000
453300     EXEC CICS                                                    45330000
453400         WRITEQ TS                                                45340000
453500             QUEUE (ASC-LIST-QUEUE-NAME)                          45350000
453600             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     45360000
453700             ITEM  (PV-ITEM)                                      45370000
453800             REWRITE                                              45380000
453900             RESP  (PV-CICS-RESP)                                 45390000
454000     END-EXEC.                                                    45400000
454100*                                                                 45410000
454200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          45420000
454300         CONTINUE                                                 45430000
454400     ELSE                                                         45440000
454500         SET DP013-CICS-ABEND  TO  TRUE                           45450000
454600         SET DP013-NO-ROLLBACK TO  TRUE                           45460000
454700         MOVE '6113-WRITE-LIST-QUEUE'                             45470000
454800                               TO  DP013-PARAGRAPH                45480000
454900         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  45490000
455000                               TO  DP013-MESSAGE-TEXT(1)          45500000
455100         PERFORM DP013-0000-PROCESS-ABEND                         45510000
455200     END-IF.                                                      45520000
455300                                                                  45530000
455400 EJECT                                                            45540000
455500*----------------------------------------------------------------*45550000
455600 6200-UPDATE-TSQ.                                                 45560000
455700                                                                  45570000
455800     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  45580000
455900     PERFORM 6205-READ-SEL-QUEUE.                                 45590000
456000                                                                  45600000
456100     PERFORM                                                      45610000
456200       VARYING RC013-IDX FROM 1 BY 1                              45620000
456300         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     45630000
456400            OR (RC013-IDX > RC013-MAX-ITEMS))                     45640000
456500                                                                  45650000
456600         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   45660000
456700             PERFORM 6210-PROCESS-ITEMS                           45670000
456800         END-IF                                                   45680000
456900                                                                  45690000
457000         ADD +1 TO PV-ITEMS-PROCESSED                             45700000
457100     END-PERFORM.                                                 45710000
457200                                                                  45720000
457300     PERFORM 6111-WRITE-LIST-QUEUE.                               45730000
457400                                                                  45740000
457500*----------------------------------------------------------------*45750000
457600*    READ THE LIST QUEUE RECORD.                                 *45760000
457700*----------------------------------------------------------------*45770000
457800 6205-READ-SEL-QUEUE.                                             45780000
457900                                                                  45790000
458000     EXEC CICS                                                    45800000
458100          READQ TS                                                45810000
458200              QUEUE (ASC-SEL-QUEUE-NAME)                          45820000
458300              INTO  (RC013-DC-SELECT-RECORD)                      45830000
458400              ITEM  (PV-SEL-QUEUE-ITEM)                           45840000
458500              RESP  (PV-CICS-RESP)                                45850000
458600     END-EXEC.                                                    45860000
458700                                                                  45870000
458800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           45880000
458900         CONTINUE                                                 45890000
459000     ELSE                                                         45900000
459100         SET DP013-CICS-ABEND       TO  TRUE                      45910000
459200         SET DP013-NO-ROLLBACK      TO  TRUE                      45920000
459300         MOVE '6205-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           45930000
459400         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           45940000
459500                                    TO  DP013-MESSAGE-TEXT(1)     45950000
459600                                                                  45960000
459700         PERFORM DP013-0000-PROCESS-ABEND                         45970000
459800     END-IF.                                                      45980000
459900                                                                  45990000
460000*----------------------------------------------------------------*46000000
460100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*46010000
460200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*46020000
460300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *46030000
460400*----------------------------------------------------------------*46040000
460500 6210-PROCESS-ITEMS.                                              46050000
460600                                                                  46060000
460700     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          46070000
460800                     / PC-ITEMS-PER-PANEL).                       46080000
460900                                                                  46090000
461000     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            46100000
461100         IF PV-SAVE-ITEM NOT EQUAL ZERO                           46110000
461200             PERFORM 6111-WRITE-LIST-QUEUE                        46120000
461300         END-IF                                                   46130000
461400                                                                  46140000
461500         MOVE PV-ITEM TO PV-SAVE-ITEM                             46150000
461600                                                                  46160000
461700         PERFORM 6112-READ-LIST-QUEUE                             46170000
461800                                                                  46180000
461900         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                46190000
462000             CONTINUE                                             46200000
462100         END-IF                                                   46210000
462200     END-IF.                                                      46220000
462300                                                                  46230000
462400     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     46240000
462500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              46250000
462600                                                                  46260000
462700     SET LQW-DESELECT (PV-SUB) TO TRUE                            46270000
462800     MOVE LQW-SELECTED-SW (PV-SUB)                                46280000
462900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  46290000
463000                                                                  46300000
463100     EVALUATE TRUE                                                46310000
463200         WHEN RC013-INQ (RC013-IDX)                               46320000
463300              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             46330000
463400                                                                  46340000
463500         WHEN RC013-UPD (RC013-IDX)                               46350000
463600              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             46360000
463700                                                                  46370000
463800         WHEN RC013-DEL (RC013-IDX)                               46380000
463900              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             46390000
464000                                                                  46400000
464100         WHEN RC013-ERR (RC013-IDX)                               46410000
464200              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             46420000
464300     END-EVALUATE.                                                46430000
464400                                                                  46440000
464500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                46450000
464600*LMM                                                              46460000
464700*----------------------------------------------------------------*46470000
464800 6300-UPDATE-TSQ.                                                 46480000
464900                                                                  46490000
465000     ADD 1 TO PV-SEL-QUEUE-ITEM.                                  46500000
465100     PERFORM 6305-READ-SEL-QUEUE.                                 46510000
465200                                                                  46520000
465300     PERFORM                                                      46530000
465400       VARYING PC237-IDX FROM 1 BY 1                              46540000
465500         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     46550000
465600            OR (PC237-IDX > PC237-MAX-ITEMS))                     46560000
465700                                                                  46570000
465800         IF PC237-ACTION-SW (PC237-IDX) > SPACE                   46580000
465900             PERFORM 6310-PROCESS-ITEMS                           46590000
466000         END-IF                                                   46600000
466100                                                                  46610000
466200         ADD +1 TO PV-ITEMS-PROCESSED                             46620000
466300     END-PERFORM.                                                 46630000
466400                                                                  46640000
466500     PERFORM 6111-WRITE-LIST-QUEUE.                               46650000
466600                                                                  46660000
466700*LMM                                                              46670000
466800*----------------------------------------------------------------*46680000
466900*    READ THE LIST QUEUE RECORD.                                 *46690000
467000*----------------------------------------------------------------*46700000
467100 6305-READ-SEL-QUEUE.                                             46710000
467200                                                                  46720000
467300     EXEC CICS                                                    46730000
467400          READQ TS                                                46740000
467500              QUEUE (ASC-SEL-QUEUE-NAME)                          46750000
467600              INTO  (PC237-DC-SELECT-RECORD)                      46760000
467700              ITEM  (PV-SEL-QUEUE-ITEM)                           46770000
467800              RESP  (PV-CICS-RESP)                                46780000
467900     END-EXEC.                                                    46790000
468000                                                                  46800000
468100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           46810000
468200         CONTINUE                                                 46820000
468300     ELSE                                                         46830000
468400         SET DP013-CICS-ABEND       TO  TRUE                      46840000
468500         SET DP013-NO-ROLLBACK      TO  TRUE                      46850000
468600         MOVE '6305-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           46860000
468700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           46870000
468800                                    TO  DP013-MESSAGE-TEXT(1)     46880000
468900                                                                  46890000
469000         PERFORM DP013-0000-PROCESS-ABEND                         46900000
469100     END-IF.                                                      46910000
469200                                                                  46920000
469300*LMM                                                              46930000
469400*----------------------------------------------------------------*46940000
469500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*46950000
469600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*46960000
469700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *46970000
469800*----------------------------------------------------------------*46980000
469900 6310-PROCESS-ITEMS.                                              46990000
470000                                                                  47000000
470100     COMPUTE PV-ITEM = 1 + ((PC237-ITEM (PC237-IDX) - 1)          47010000
470200                     / PC-ITEMS-PER-PANEL).                       47020000
470300                                                                  47030000
470400     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            47040000
470500         IF PV-SAVE-ITEM NOT EQUAL ZERO                           47050000
470600             PERFORM 6111-WRITE-LIST-QUEUE                        47060000
470700         END-IF                                                   47070000
470800                                                                  47080000
470900         MOVE PV-ITEM TO PV-SAVE-ITEM                             47090000
471000                                                                  47100000
471100         PERFORM 6112-READ-LIST-QUEUE                             47110000
471200                                                                  47120000
471300         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                47130000
471400             CONTINUE                                             47140000
471500         END-IF                                                   47150000
471600     END-IF.                                                      47160000
471700                                                                  47170000
471800     COMPUTE PV-SUB = (PC237-ITEM (PC237-IDX)                     47180000
471900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              47190000
472000                                                                  47200000
472100     SET LQW-DESELECT (PV-SUB) TO TRUE                            47210000
472200     MOVE LQW-SELECTED-SW (PV-SUB)                                47220000
472300                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  47230000
472400                                                                  47240000
472500     EVALUATE TRUE                                                47250000
472600         WHEN PC237-INQ (PC237-IDX)                               47260000
472700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             47270000
472800                                                                  47280000
472900         WHEN PC237-UPD (PC237-IDX)                               47290000
473000              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             47300000
473100                                                                  47310000
473200         WHEN PC237-DEL (PC237-IDX)                               47320000
473300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             47330000
473400                                                                  47340000
473500         WHEN PC237-ERR (PC237-IDX)                               47350000
473600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             47360000
473700     END-EVALUATE.                                                47370000
473800                                                                  47380000
473900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                47390000
474000                                                                  47400000
474100******************************************************************47410000
474200 7200-GET-TRIP-ID.                                                47420000
474201                                                                  47420100
474202     EXEC SQL                                                     47420200
474203          SELECT A.TRIP_ID                                        47420300
474204                ,A.OWNER_SCAC_ID                                  47420400
474205                ,A.VEH_NBR                                        47420500
474206                ,B.TRIP_STATUS_CDE                                47420600
474207          INTO  :DK-TRIP-ID                                       47420700
474208               ,:DK-SCAC-ID                                       47420800
474209               ,:DK-VEHICLE-NBR :DN-VEH-NBR                       47420900
474210               ,:DK-STATUS-CDE                                    47421000
474211           FROM TVHTRIP A                                         47421100
474212               ,TTRIPST B                                         47421200
474213               ,TTRSTYP C                                         47421300
474214               ,TSHIPMT E                                         47421400
474215               ,TSHPTPO F                                         47421500
474216          WHERE F.PO_NBR           = :DK-PO-NBR                   47421600
474217            AND F.REC_SEQ_NBR      = :DK-REC-SEQ-NBR              47421700
474218            AND A.TRIP_ID          = B.TRIP_ID                    47421800
474219            AND B.TRIP_STATUS_CDE  = C.TRIP_STATUS_CDE            47421900
474220            AND A.TRIP_ID          = E.TRIP_ID                    47422000
474221            AND E.SHIPT_ID         = F.SHIPT_ID                   47422100
474222            AND F.PRIM_SHIPT_IND   = 'Y'                          47422200
474223            AND C.PRTY_CDE         =                              47422300
474224              (SELECT MAX(E.PRTY_CDE)                             47422400
474225                FROM TTRIPST D                                    47422500
474226                    ,TTRSTYP E                                    47422600
474227               WHERE D.TRIP_ID         = A.TRIP_ID                47422700
474228                 AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)       47422800
474229     END-EXEC                                                     47422900
474230                                                                  47423000
474231                                                                  47423100
474232     EVALUATE TRUE                                                47423200
474233         WHEN SQLCODE = ZERO                                      47423300
474234              MOVE DK-TRIP-ID      TO   ASC-TRIP-ID               47423400
474235              MOVE DK-SCAC-ID      TO   ASC-SCAC-ID               47423500
474236              MOVE DK-STATUS-CDE   TO   ASC-STATUS                47423600
474237              IF DN-VEH-NBR = -1                                  47423700
474238                 MOVE SPACES       TO   ASC-VEH-NBR               47423800
474239                                        DK-VEHICLE-NBR            47423900
474240              ELSE                                                47424000
474241                 MOVE DK-VEHICLE-NBR  TO   ASC-VEH-NBR            47424100
474242              END-IF                                              47424200
474243         WHEN SQLCODE = +100                                      47424300
474244              MOVE PC-TSYMSG-00954       TO DP020-MSG-NUMBER      47424400
474245              SET  PS-COMMAREA-NOT-VALID TO TRUE                  47424500
474246         WHEN SQLCODE = -811                                      47424600
474247         WHEN SQLWARN0 NOT = SPACE                                47424700
474248         WHEN SQLCODE NOT = ZERO                                  47424800
474249              MOVE '7200-GET-TRIP-ID'                             47424900
474250                               TO DP013-PARAGRAPH                 47425000
474251              MOVE 'FETCH MESSAGE CURSOR'                         47425100
474252                               TO DP013-MESSAGE-TEXT (1)          47425200
474253              MOVE SQLCA       TO DP013-SQLCA                     47425300
474254              SET DP013-DB2-ABEND                                 47425400
474255                               TO TRUE                            47425500
474256              PERFORM DP013-0000-PROCESS-ABEND                    47425600
474257     END-EVALUATE.                                                47425700
474258                                                                  47425800
474259 7210-SELECT-MAX-STATUS.                                          47425900
474260                                                                  47426000
474261     EXEC SQL                                                     47426100
474262          SELECT MAX(STATUS_DTE),MAX(STATUS_TME)                  47426200
474263          INTO  :DK-STATUS-DTE                                    47426300
474264               ,:DK-STATUS-TME                                    47426400
474265          FROM   TVHTRIP A                                        47426500
474266                ,TTRIPST B                                        47426600
474267          WHERE A.TRIP_ID = :DK-TRIP-ID                           47426700
474268          AND   A.TRIP_ID =  B.TRIP_ID                            47426800
474269            AND B.STATUS_DTE =                                    47426900
474270                 (SELECT MAX(D.STATUS_DTE)                        47427000
474271                    FROM TTRIPST D                                47427100
474272                  WHERE D.TRIP_ID = A.TRIP_ID)                    47427200
474273     END-EXEC                                                     47427300
474274                                                                  47427400
474275                                                                  47427500
474276     EXEC SQL                                                     47427600
474277          SELECT B.TRIP_STATUS_CDE                                47427700
474278          INTO  :DK-STATUS-CDE                                    47427800
474279          FROM   TVHTRIP A                                        47427900
474280                ,TTRIPST B                                        47428000
474281          WHERE A.TRIP_ID = :DK-TRIP-ID                           47428100
474282              AND A.TRIP_ID =  B.TRIP_ID                          47428200
474283              AND B.STATUS_DTE = :DK-STATUS-DTE                   47428300
474284              AND B.STATUS_TME = :DK-STATUS-TME                   47428400
474285     END-EXEC                                                     47428500
474286                                                                  47428600
474287                                                                  47428700
474288     EVALUATE TRUE                                                47428800
474289         WHEN SQLCODE = ZERO                                      47428900
474290              MOVE DK-STATUS-CDE TO   ASC-STATUS                  47429000
474291         WHEN SQLCODE = +100                                      47429100
474292         WHEN SQLWARN0 NOT = SPACE                                47429200
474293         WHEN SQLCODE NOT = ZERO                                  47429300
474294              MOVE '7210-SELECT-MAX-STATUS'                       47429400
474295                               TO DP013-PARAGRAPH                 47429500
474296              MOVE 'FETCH MESSAGE CURSOR'                         47429600
474297                               TO DP013-MESSAGE-TEXT (1)          47429700
474298              MOVE SQLCA       TO DP013-SQLCA                     47429800
474299              SET DP013-DB2-ABEND                                 47429900
474300                               TO TRUE                            47430000
474301              PERFORM DP013-0000-PROCESS-ABEND                    47430100
474302     END-EVALUATE.                                                47430200
474303/                                                                 47430300
474304 7500-OPEN-TYPE-A-CSR.                                            47430400
474305     EXEC SQL                                                     47430500
474306         OPEN TYPE-A-CSR                                          47430600
474307     END-EXEC.                                                    47430700
474308                                                                  47430800
474309     EVALUATE TRUE                                                47430900
474310         WHEN SQLCODE = ZERO                                      47431000
474311             CONTINUE                                             47431100
474312         WHEN SQLCODE = -904                                      47431200
474313         WHEN SQLCODE = -913                                      47431300
474314         WHEN SQLCODE = -911                                      47431400
474315             MOVE '7500-OPEN-TYPE-A-CSR'                          47431500
474316                                      TO DP013-PARAGRAPH          47431600
474317            MOVE 'TIMEMOUT TO OPEN CSR'                           47431700
474318                                      TO DP013-MESSAGE-TEXT (1)   47431800
474319             MOVE SQLCA               TO DP013-SQLCA              47431900
474320             MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1) 47432000
474321             MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (2) 47432100
474322             MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (3) 47432200
474323             MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (4) 47432300
474324             SET DP013-DB2-ABEND                                  47432400
474325                 DP013-XCTL-DISPLAY-RESTART                       47432500
474326                                      TO TRUE                     47432600
474327             PERFORM DP013-0000-PROCESS-ABEND                     47432700
474328         WHEN SQLWARN0 NOT = SPACES                               47432800
474329         WHEN SQLCODE < ZERO                                      47432900
474330         WHEN SQLCODE > ZERO                                      47433000
474331             MOVE '7500-OPEN-TYPE-A-CSR'                          47433100
474332                                   TO DP013-PARAGRAPH             47433200
474333             MOVE 'OPEN TYPE-A - ' TO DP013-MESSAGE-TEXT (1)      47433300
474334             MOVE SQLCA        TO DP013-SQLCA                     47433400
474335             MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1) 47433500
474336             MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (2) 47433600
474337             MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (3) 47433700
474338             MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (4) 47433800
474339             SET DP013-DB2-ABEND                                  47433900
474340                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47434000
474341             PERFORM DP013-0000-PROCESS-ABEND                     47434100
474342     END-EVALUATE.                                                47434200
474343                                                                  47434300
474344 7505-FETCH-TYPE-A-CSR.                                           47434400
474345                                                                  47434500
474346     EXEC SQL                                                     47434600
474347         FETCH TYPE-A-CSR                                         47434700
474348     INTO                                                         47434800
474349         :PV-TEMP-UNION-TYPE                                      47434900
474350       , :PV-TEMP-PO-NBR                                          47435000
474351       , :PV-TEMP-REC-SEQ-NBR                                     47435100
474352       , :PV-TEMP-STATUS-CDE                                      47435200
474353       , :PV-TEMP-SCREEN-SEQUENCE                                 47435300
474354                                                                  47435400
474355     END-EXEC                                                     47435500
474356                                                                  47435600
474357     EVALUATE TRUE                                                47435700
474358         WHEN SQLCODE = ZERO                                      47435800
474359             CONTINUE                                             47435900
474360         WHEN SQLCODE = +100                                      47436000
474361             SET PS-EOF-TYPE-A-YES    TO TRUE                     47436100
474362         WHEN SQLCODE = -904                                      47436200
474363         WHEN SQLCODE = -913                                      47436300
474364         WHEN SQLCODE = -911                                      47436400
474365             MOVE '7505-FETCH-TYPE-A-CSR'                         47436500
474366                                      TO DP013-PARAGRAPH          47436600
474367            MOVE 'TIMEOUT TO FETCH TYPE-A CSR'                    47436700
474368                                      TO DP013-MESSAGE-TEXT (1)   47436800
474369             MOVE SQLCA               TO DP013-SQLCA              47436900
474370             MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1) 47437000
474371             MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (2) 47437100
474372             MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (3) 47437200
474373             MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (4) 47437300
474374             SET DP013-DB2-ABEND                                  47437400
474375                 DP013-XCTL-DISPLAY-RESTART                       47437500
474376                                      TO TRUE                     47437600
474377             PERFORM DP013-0000-PROCESS-ABEND                     47437700
474378         WHEN SQLWARN0 NOT = SPACES                               47437800
474379         WHEN SQLCODE < ZERO                                      47437900
474380         WHEN SQLCODE > ZERO                                      47438000
474381             MOVE '7505-FETCH-TYPE-A-CSR'                         47438100
474382                                      TO DP013-PARAGRAPH          47438200
474383             MOVE 'ABEND FETCHING TYPE-A CSR'                     47438300
474384                                      TO DP013-MESSAGE-TEXT (1)   47438400
474385             MOVE SQLCA               TO DP013-SQLCA              47438500
474386             MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1) 47438600
474387             MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (2) 47438700
474388             MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (3) 47438800
474389             MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (4) 47438900
474390             SET DP013-DB2-ABEND                                  47439000
474391                 DP013-XCTL-DISPLAY-RESTART                       47439100
474392                                      TO TRUE                     47439200
474393             PERFORM DP013-0000-PROCESS-ABEND                     47439300
474394     END-EVALUATE.                                                47439400
474395                                                                  47439500
474396 7510-CLOSE-TYPE-A-CSR.                                           47439600
474397     EXEC SQL                                                     47439700
474398         CLOSE TYPE-A-CSR                                         47439800
474399     END-EXEC.                                                    47439900
474400                                                                  47440000
474401     EVALUATE TRUE                                                47440100
474402         WHEN SQLCODE = ZERO                                      47440200
474403             CONTINUE                                             47440300
474404         WHEN SQLWARN0 NOT = SPACES                               47440400
474405         WHEN SQLCODE < ZERO                                      47440500
474406         WHEN SQLCODE > ZERO                                      47440600
474407             MOVE '7510-CLOSE-TYPE-A-CSR'                         47440700
474408                                   TO DP013-PARAGRAPH             47440800
474409             MOVE 'CLOSE TYPE-A - ' TO DP013-MESSAGE-TEXT (1)     47440900
474410             MOVE SQLCA        TO DP013-SQLCA                     47441000
474411             MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1) 47441100
474412             MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (2) 47441200
474413             MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (3) 47441300
474414             MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (4) 47441400
474415             SET DP013-DB2-ABEND                                  47441500
474416                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47441600
474417             PERFORM DP013-0000-PROCESS-ABEND                     47441700
474418     END-EVALUATE.                                                47441800
474419                                                                  47441900
474420 7520-OPEN-CHECKIN-CSR.                                           47442000
474430     EXEC SQL                                                     47443000
474440         OPEN CHECKIN-CSR                                         47444000
474450     END-EXEC.                                                    47445000
474460                                                                  47446000
474461     EVALUATE TRUE                                                47446100
474462         WHEN SQLCODE = ZERO                                      47446200
474463             CONTINUE                                             47446300
474464         WHEN SQLCODE = -904                                      47446400
474465         WHEN SQLCODE = -913                                      47446500
474466         WHEN SQLCODE = -911                                      47446600
474467             MOVE '7520-OPEN-CHECKIN-CSR'                         47446700
474468                                      TO DP013-PARAGRAPH          47446800
474469            MOVE 'TIMEMOUT TO OPEN CSR'                           47446900
474470                                      TO DP013-MESSAGE-TEXT (1)   47447000
474471             MOVE SQLCA               TO DP013-SQLCA              47447100
474472             MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1) 47447200
474473             MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (2) 47447300
474474             MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (3) 47447400
474475             MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (4) 47447500
474476             SET DP013-DB2-ABEND                                  47447600
474477                 DP013-XCTL-DISPLAY-RESTART                       47447700
474478                                      TO TRUE                     47447800
474479             PERFORM DP013-0000-PROCESS-ABEND                     47447900
474480         WHEN SQLWARN0 NOT = SPACES                               47448000
474481         WHEN SQLCODE < ZERO                                      47448100
474482         WHEN SQLCODE > ZERO                                      47448200
474483             MOVE '7520-OPEN-CHECKIN-CSR'                         47448300
474484                                   TO DP013-PARAGRAPH             47448400
474485             MOVE 'OPEN CHECKIN  ' TO DP013-MESSAGE-TEXT (1)      47448500
474486             MOVE SQLCA        TO DP013-SQLCA                     47448600
474487             MOVE 'TSHUNLO '          TO DP013-DB2-TABLE-NAME (1) 47448700
474488             MOVE 'TINPKSU '          TO DP013-DB2-TABLE-NAME (2) 47448800
474489             SET DP013-DB2-ABEND                                  47448900
474490                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47449000
474491             PERFORM DP013-0000-PROCESS-ABEND                     47449100
474492     END-EVALUATE.                                                47449200
474493                                                                  47449300
474494 7525-FETCH-CHECKIN-CSR.                                          47449400
474495                                                                  47449500
474496     EXEC SQL                                                     47449600
474497         FETCH CHECKIN-CSR                                        47449700
474498         INTO                                                     47449800
474499            :PV-TEMP-SHIPT-UNT-ID                                 47449900
474500         ,  :PV-TEMP-PO-NBR :PV-TEMP-PO-NULL                      47450000
474600         ,  :PV-TEMP-SEQ-NBR :PV-TEMP-SEQ-NULL                    47460000
474700*        ,  :PV-TEMP-STATUS-CDE                                   47470000
474800*        ,  :PV-TEMP-SCREEN-SEQUENCE                              47480000
474900                                                                  47490000
475000     END-EXEC                                                     47500000
475100                                                                  47510000
475200     EVALUATE TRUE                                                47520000
475201         WHEN SQLCODE = ZERO                                      47520100
475202             IF PV-TEMP-PO-NULL = -1 OR PV-TEMP-SEQ-NULL = -1     47520200
475203                 CONTINUE                                         47520300
475204             ELSE                                                 47520400
475205                 MOVE PV-TEMP-PO-NBR  TO PV-CURR-TEMP-PO          47520500
475206                 MOVE PV-TEMP-SEQ-NBR TO PV-CURR-TEMP-SEQ         47520600
475207             END-IF                                               47520700
475208         WHEN SQLCODE = +100                                      47520800
475209             SET PS-EOF-CHECKIN-YES   TO TRUE                     47520900
475210         WHEN SQLCODE = -904                                      47521000
475211         WHEN SQLCODE = -913                                      47521100
475212         WHEN SQLCODE = -911                                      47521200
475213             MOVE '7525-FETCH-CHECKIN-CSR'                        47521300
475214                                      TO DP013-PARAGRAPH          47521400
475215            MOVE 'TIMEOUT TO FETCH TYPE-A CSR'                    47521500
475216                                      TO DP013-MESSAGE-TEXT (1)   47521600
475217             MOVE SQLCA               TO DP013-SQLCA              47521700
475218             MOVE 'TINPKSU '          TO DP013-DB2-TABLE-NAME (1) 47521800
475219             MOVE 'TSHUNLO '          TO DP013-DB2-TABLE-NAME (2) 47521900
475220             SET DP013-DB2-ABEND                                  47522000
475221                 DP013-XCTL-DISPLAY-RESTART                       47522100
475222                                      TO TRUE                     47522200
475223             PERFORM DP013-0000-PROCESS-ABEND                     47522300
475224         WHEN SQLWARN0 NOT = SPACES                               47522400
475225         WHEN SQLCODE < ZERO                                      47522500
475226         WHEN SQLCODE > ZERO                                      47522600
475227             MOVE '7525-FETCH-CHECKIN-CSR'                        47522700
475228                                      TO DP013-PARAGRAPH          47522800
475229             MOVE 'ABEND FETCHING TYPE-A CSR'                     47522900
475230                                      TO DP013-MESSAGE-TEXT (1)   47523000
475231             MOVE SQLCA               TO DP013-SQLCA              47523100
475232             MOVE 'TINPKSU '          TO DP013-DB2-TABLE-NAME (1) 47523200
475233             MOVE 'TSHUNLO '          TO DP013-DB2-TABLE-NAME (2) 47523300
475234             SET DP013-DB2-ABEND                                  47523400
475235                 DP013-XCTL-DISPLAY-RESTART                       47523500
475236                                      TO TRUE                     47523600
475237             PERFORM DP013-0000-PROCESS-ABEND                     47523700
475238     END-EVALUATE.                                                47523800
475239                                                                  47523900
475240 7530-CLOSE-CHECKIN-CSR.                                          47524000
475250     EXEC SQL                                                     47525000
475260         CLOSE CHECKIN-CSR                                        47526000
475270     END-EXEC.                                                    47527000
475280                                                                  47528000
475281     EVALUATE TRUE                                                47528100
475282         WHEN SQLCODE = ZERO                                      47528200
475283             CONTINUE                                             47528300
475284         WHEN SQLWARN0 NOT = SPACES                               47528400
475285         WHEN SQLCODE < ZERO                                      47528500
475286         WHEN SQLCODE > ZERO                                      47528600
475287             MOVE '7530-CLOSE-CHECKIN-CSR'                        47528700
475288                                   TO DP013-PARAGRAPH             47528800
475289             MOVE 'CLOSE CHECKIN CSR ' TO DP013-MESSAGE-TEXT (1)  47528900
475290             MOVE SQLCA        TO DP013-SQLCA                     47529000
475291             MOVE 'TINPKSU '          TO DP013-DB2-TABLE-NAME (1) 47529100
475292             MOVE 'TSHUNLO '          TO DP013-DB2-TABLE-NAME (2) 47529200
475293             SET DP013-DB2-ABEND                                  47529300
475294                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47529400
475295             PERFORM DP013-0000-PROCESS-ABEND                     47529500
475296     END-EVALUATE.                                                47529600
475297                                                                  47529700
475298 7540-SELECT-TSHUUPC.                                             47529800
475299                                                                  47529900
475300     EXEC SQL                                                     47530000
475400         SELECT                                                   47540000
475500             TRN_NBR                                              47550000
475600         INTO                                                     47560000
475700             :PV-TEMP-PO-NBR                                      47570000
475800         FROM                                                     47580000
475900             TSHUUPC                                              47590000
476000         WHERE                                                    47600000
476100             SHIPT_UNT_ID = :PV-TEMP-SHIPT-UNT-ID                 47610000
476200         FETCH FIRST ROWS ONLY                                    47620000
476300     END-EXEC.                                                    47630000
476400                                                                  47640000
476401     EVALUATE TRUE                                                47640100
476402         WHEN SQLCODE = ZERO                                      47640200
476403         WHEN SQLCODE = -811                                      47640300
476404             CONTINUE                                             47640400
476405         WHEN SQLCODE = -904                                      47640500
476406         WHEN SQLCODE = -913                                      47640600
476407         WHEN SQLCODE = -911                                      47640700
476408             MOVE '7540-SELECT-TSHUUPC'                           47640800
476409                                      TO DP013-PARAGRAPH          47640900
476410            MOVE 'TIMEOUT SELECTING TRN-NBR'                      47641000
476411                                      TO DP013-MESSAGE-TEXT (1)   47641100
476412             MOVE SQLCA               TO DP013-SQLCA              47641200
476413             MOVE 'TSHUUPC '          TO DP013-DB2-TABLE-NAME (1) 47641300
476414             SET DP013-DB2-ABEND                                  47641400
476415                 DP013-XCTL-DISPLAY-RESTART                       47641500
476416                                      TO TRUE                     47641600
476417             PERFORM DP013-0000-PROCESS-ABEND                     47641700
476418         WHEN SQLWARN0 NOT = SPACES                               47641800
476419         WHEN SQLCODE < ZERO                                      47641900
476420         WHEN SQLCODE > ZERO                                      47642000
476421             MOVE '7540-SELECT-TSHUUPC'                           47642100
476422                                   TO DP013-PARAGRAPH             47642200
476423             MOVE 'SELECT TRN-NBR    ' TO DP013-MESSAGE-TEXT (1)  47642300
476424             MOVE SQLCA        TO DP013-SQLCA                     47642400
476425             MOVE 'TSHUUPC '          TO DP013-DB2-TABLE-NAME (1) 47642500
476426             SET DP013-DB2-ABEND                                  47642600
476427                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47642700
476428             PERFORM DP013-0000-PROCESS-ABEND                     47642800
476429     END-EVALUATE.                                                47642900
476430                                                                  47643000
476440 7545-SELECT-TPKSLIP.                                             47644000
476450                                                                  47645000
476460     EXEC SQL                                                     47646000
476470         SELECT                                                   47647000
476480             REC_SEQ_NBR                                          47648000
476490         INTO                                                     47649000
476500             :PV-TEMP-REC-SEQ-NBR                                 47650000
476600         FROM                                                     47660000
476700             TPKSLIP                                              47670000
476800         WHERE                                                    47680000
476900             PO_NBR       = :PV-TEMP-PO-NBR                       47690000
477000         AND SEQ_NBR      = :PV-TEMP-SEQ-NBR                      47700000
477100         AND VER_STAT_CDE = 'A'                                   47710000
477200         FETCH FIRST ROWS ONLY                                    47720000
477300     END-EXEC.                                                    47730000
477400                                                                  47740000
477401     EVALUATE TRUE                                                47740100
477402         WHEN SQLCODE = ZERO                                      47740200
477403         WHEN SQLCODE = +100                                      47740300
477404         WHEN SQLCODE = -811                                      47740400
477405             CONTINUE                                             47740500
477406         WHEN SQLCODE = -904                                      47740600
477407         WHEN SQLCODE = -913                                      47740700
477408         WHEN SQLCODE = -911                                      47740800
477409             MOVE '7545-SELECT-TPKSLIP'                           47740900
477410                                      TO DP013-PARAGRAPH          47741000
477411            MOVE 'TIMEOUT SELECTING REC-SEQ-NBR'                  47741100
477412                                      TO DP013-MESSAGE-TEXT (1)   47741200
477413             MOVE SQLCA               TO DP013-SQLCA              47741300
477414             MOVE 'TPKSLIP '          TO DP013-DB2-TABLE-NAME (1) 47741400
477415             SET DP013-DB2-ABEND                                  47741500
477416                 DP013-XCTL-DISPLAY-RESTART                       47741600
477417                                      TO TRUE                     47741700
477418             PERFORM DP013-0000-PROCESS-ABEND                     47741800
477419         WHEN SQLWARN0 NOT = SPACES                               47741900
477420         WHEN SQLCODE < ZERO                                      47742000
477421         WHEN SQLCODE > ZERO                                      47742100
477422             MOVE '7545-SELECT-TPKSLIP'                           47742200
477423                                   TO DP013-PARAGRAPH             47742300
477424             MOVE 'SELECT REC-SEQ-NBR' TO DP013-MESSAGE-TEXT (1)  47742400
477425             MOVE SQLCA        TO DP013-SQLCA                     47742500
477426             MOVE 'TPKSLIP '          TO DP013-DB2-TABLE-NAME (1) 47742600
477427             SET DP013-DB2-ABEND                                  47742700
477428                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47742800
477429             PERFORM DP013-0000-PROCESS-ABEND                     47742900
477430     END-EVALUATE.                                                47743000
477431                                                                  47743100
477432 7550-SELECT-FROM-TEMP.                                           47743200
477433                                                                  47743300
477434*    IF THE PO/RCVR IS ALREADY IN THE TEMP TABLE WE CAN'T MAKE IT 47743400
477435*    A 'B' UNION-TYPE                                             47743500
477436                                                                  47743600
477437     SET PS-TEMP-B-YES                TO TRUE                     47743700
477438                                                                  47743800
477439     EXEC SQL                                                     47743900
477440         SELECT                                                   47744000
477450             'N'                                                  47745000
477460         ,   RCVR_STAT_CDE                                        47746000
477470         ,   RCVR_PRCG_CDE                                        47747000
477480         ,   DISP_SEQ_NBR                                         47748000
477490         INTO                                                     47749000
477500             :PS-TEMP-B-SWITCH                                    47750000
477600         ,   :PV-TEMP-STATUS-CDE                                  47760000
477700         ,   :PV-TEMP-UNION-TYPE                                  47770000
477800         ,   :PV-TEMP-SCREEN-SEQUENCE                             47780000
477900         FROM                                                     47790000
478000             SUTT_PO_RCVR_TRLR                                    47800000
478100         WHERE                                                    47810000
478200             PO_NBR          = :PV-TEMP-PO-NBR                    47820000
478300         AND RCVR_SEQ_NBR    = :PV-TEMP-REC-SEQ-NBR               47830000
478400         FETCH FIRST ROWS ONLY                                    47840000
478500     END-EXEC.                                                    47850000
478600                                                                  47860000
478601     EVALUATE TRUE                                                47860100
478602         WHEN SQLCODE = ZERO                                      47860200
478603         WHEN SQLCODE = +100                                      47860300
478604         WHEN SQLCODE = -811                                      47860400
478605             CONTINUE                                             47860500
478606         WHEN SQLWARN0 NOT = SPACES                               47860600
478607         WHEN SQLCODE < ZERO                                      47860700
478608         WHEN SQLCODE > ZERO                                      47860800
478609             MOVE '7550-SELECT-FROM-TEMP'                         47860900
478610                                   TO DP013-PARAGRAPH             47861000
478611             MOVE 'SELECT PO/RCVR' TO DP013-MESSAGE-TEXT (1)      47861100
478612             MOVE SQLCA        TO DP013-SQLCA                     47861200
478613             MOVE 'SUTT_PO_RCVR_TRLR ' TO DP013-DB2-TABLE-NAME (1)47861300
478614             SET DP013-DB2-ABEND                                  47861400
478615                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47861500
478616             PERFORM DP013-0000-PROCESS-ABEND                     47861600
478617     END-EVALUATE.                                                47861700
478618                                                                  47861800
478619 7555-FIND-DELETED-PKSLIPS.                                       47861900
478620                                                                  47862000
478630     SET PS-TEMP-PKSLIP-DELETED-NO    TO TRUE                     47863000
478640                                                                  47864000
478650     EXEC SQL                                                     47865000
478660         SELECT                                                   47866000
478670             'Y'                                                  47867000
478680         INTO                                                     47868000
478690             :PS-TEMP-PKSLIP-STAT-SW                              47869000
478700         FROM                                                     47870000
478800             TPKSLIP                                              47880000
478900         WHERE                                                    47890000
479000             PO_NBR        = :PV-TEMP-PO-NBR                      47900000
479100         AND PKSL_STAT_CDE = 'DE'                                 47910000
479200         FETCH FIRST ROWS ONLY                                    47920000
479300     END-EXEC.                                                    47930000
479400                                                                  47940000
479401     EVALUATE TRUE                                                47940100
479402         WHEN SQLCODE = ZERO                                      47940200
479403         WHEN SQLCODE = +100                                      47940300
479404         WHEN SQLCODE = -811                                      47940400
479405             CONTINUE                                             47940500
479406         WHEN SQLCODE = -904                                      47940600
479407         WHEN SQLCODE = -913                                      47940700
479408         WHEN SQLCODE = -911                                      47940800
479409             MOVE '7555-FIND-DELETED-PKSLIPS'                     47940900
479410                                      TO DP013-PARAGRAPH          47941000
479411            MOVE 'TIMEOUT SELECTING REC-SEQ-NBR'                  47941100
479412                                      TO DP013-MESSAGE-TEXT (1)   47941200
479413             MOVE SQLCA               TO DP013-SQLCA              47941300
479414             MOVE 'TPKSLIP '          TO DP013-DB2-TABLE-NAME (1) 47941400
479415             SET DP013-DB2-ABEND                                  47941500
479416                 DP013-XCTL-DISPLAY-RESTART                       47941600
479417                                      TO TRUE                     47941700
479418             PERFORM DP013-0000-PROCESS-ABEND                     47941800
479419         WHEN SQLWARN0 NOT = SPACES                               47941900
479420         WHEN SQLCODE < ZERO                                      47942000
479421         WHEN SQLCODE > ZERO                                      47942100
479422             MOVE '7555-FIND-DELETED-PKSLIPS'                     47942200
479423                                   TO DP013-PARAGRAPH             47942300
479424             MOVE 'SELECT REC-SEQ-NBR' TO DP013-MESSAGE-TEXT (1)  47942400
479425             MOVE SQLCA        TO DP013-SQLCA                     47942500
479426             MOVE 'TPKSLIP '          TO DP013-DB2-TABLE-NAME (1) 47942600
479427             SET DP013-DB2-ABEND                                  47942700
479428                 DP013-XCTL-DISPLAY-RESTART TO TRUE               47942800
479429             PERFORM DP013-0000-PROCESS-ABEND                     47942900
479430     END-EVALUATE.                                                47943000
479431                                                                  47943100
479432/                                                                 47943200
479433 7600-INSERT-TEMP-TABLE.                                          47943300
479434                                                                  47943400
479435     INITIALIZE DCLSUT00042                                       47943500
479436     MOVE PV-TEMP-PO-NBR              TO SUT00042-PO-NBR          47943600
479437     MOVE PV-TEMP-REC-SEQ-NBR         TO SUT00042-RCVR-SEQ-NBR    47943700
479438     MOVE PV-TEMP-STATUS-CDE          TO SUT00042-RCVR-STAT-CDE   47943800
479439     MOVE PV-TEMP-SCREEN-SEQUENCE     TO SUT00042-DISP-SEQ-NBR    47943900
479440     MOVE PV-TEMP-UNION-TYPE          TO SUT00042-RCVR-PRCG-CDE   47944000
479450                                                                  47945000
479460     EXEC SQL                                                     47946000
479470         INSERT                                                   47947000
479480         INTO                                                     47948000
479490             SUTT_PO_RCVR_TRLR                                    47949000
479500         (                                                        47950000
479600           PO_NBR                                                 47960000
479700         , RCVR_SEQ_NBR                                           47970000
479800         , RCVR_STAT_CDE                                          47980000
479900         , DISP_SEQ_NBR                                           47990000
480000         , RCVR_PRCG_CDE                                          48000000
480100         )                                                        48010000
480200         VALUES                                                   48020000
480300         (                                                        48030000
480400           :SUT00042-PO-NBR                                       48040000
480500         , :SUT00042-RCVR-SEQ-NBR                                 48050000
480600         , :SUT00042-RCVR-STAT-CDE                                48060000
480700         , :SUT00042-DISP-SEQ-NBR                                 48070000
480800         , :SUT00042-RCVR-PRCG-CDE                                48080000
480900         )                                                        48090000
481000     END-EXEC.                                                    48100000
481100                                                                  48110000
481200     EVALUATE TRUE                                                48120000
481201         WHEN SQLCODE = ZERO                                      48120100
481202*        MOVE PV-TEMP-PO-NBR          TO  PV-LIST-PO-NBR          48120200
481203*        MOVE PV-TEMP-REC-SEQ-NBR     TO  PV-LIST-REC-SEQ-NBR     48120300
481204*        MOVE PV-TEMP-STATUS-CDE      TO  PV-LIST-STATUS-CDE      48120400
481205*        MOVE PV-TEMP-SCREEN-SEQUENCE TO  PV-LIST-SCREEN-SEQUENCE 48120500
481206*        MOVE PV-TEMP-UNION-TYPE      TO  PV-LIST-UNION-TYPE      48120600
481207*        MOVE PV-TEMP-LIST            TO  PV-CICS-MSG-AREA        48120700
481208*            PERFORM 9900-WRITE-CICS-LOG                          48120800
481209             CONTINUE                                             48120900
481210         WHEN SQLWARN0 NOT = SPACES                               48121000
481211         WHEN SQLCODE < ZERO                                      48121100
481212         WHEN SQLCODE > ZERO                                      48121200
481213             MOVE '7600-INSERT-TEMP-TABLE'                        48121300
481214                                   TO DP013-PARAGRAPH             48121400
481215             MOVE 'INSERT INTO TEMP'  TO DP013-MESSAGE-TEXT (1)   48121500
481216             MOVE SQLCA        TO DP013-SQLCA                     48121600
481217             MOVE 'SUTT_PO_RCVR_TRLR' TO DP013-DB2-TABLE-NAME (1) 48121700
481218             SET DP013-DB2-ABEND                                  48121800
481219                 DP013-XCTL-DISPLAY-RESTART TO TRUE               48121900
481220             PERFORM DP013-0000-PROCESS-ABEND                     48122000
481221     END-EVALUATE.                                                48122100
481222                                                                  48122200
481223 8000-DETERMINE-COUNTS.                                           48122300
481224     MOVE ZEROES              TO PV-BRANCH-COUNT.                 48122400
481225                                                                  48122500
481226     EXEC SQL                                                     48122600
481227         SELECT COUNT(*)                                          48122700
481228         INTO :PV-BRANCH-COUNT                                    48122800
481229          FROM  SUT_OTBND_UPC A                                   48122900
481230               ,SUT_OTBND_CART B                                  48123000
481240               ,SUT_TRLR_RPLN_CART C                              48124000
481241         WHERE  C.INBND_TRIP_ID     = :DK-TRIP-ID                 48124100
481242           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              48124200
481243           AND  A.SHIPT_UNT_ID      = C.SHIPT_UNT_ID              48124300
481244           AND  A.TRN_TYP_CDE       = 'CS'                        48124400
481245           AND  B.ACTV_IND          = 'Y'                         48124500
481246         WITH UR                                                  48124601
481247       END-EXEC.                                                  48124700
481248                                                                  48124800
481249     EVALUATE TRUE                                                48124900
481250         WHEN SQLCODE = ZERO                                      48125000
481251         WHEN SQLCODE = -811                                      48125100
481260             CONTINUE                                             48126000
481270         WHEN OTHER                                               48127000
481280             MOVE '8000-DETERMINE-COUNTS'                         48128000
481281                                   TO DP013-PARAGRAPH             48128100
481282             MOVE 'COUNT FROM TABLE'  TO DP013-MESSAGE-TEXT (1)   48128200
481283             MOVE SQLCA        TO DP013-SQLCA                     48128300
481284             MOVE 'SUTT_OTBND_UPC   '  TO DP013-DB2-TABLE-NAME (1)48128400
481285             MOVE 'SUTT_OTBND_CART  '  TO DP013-DB2-TABLE-NAME (2)48128500
481286             MOVE 'SUT_TRLR_RPLN_CART' TO DP013-DB2-TABLE-NAME (3)48128600
481287             SET DP013-DB2-ABEND                                  48128700
481288                 DP013-XCTL-DISPLAY-RESTART TO TRUE               48128800
481289             PERFORM DP013-0000-PROCESS-ABEND                     48128900
481290     END-EVALUATE.                                                48129000
481291     IF PV-BRANCH-COUNT = 0                                       48129100
481292         PERFORM 8100-DETERMINE-COUNTS THROUGH 8100-EXIT          48129200
481293     END-IF.                                                      48129300
481294 8000-EXIT.                                                       48129400
481295     EXIT.                                                        48129500
481296                                                                  48129600
481297 8100-DETERMINE-COUNTS.                                           48129700
481298     EXEC SQL                                                     48129800
481299         SELECT COUNT(*)                                          48129900
481300         INTO :PV-BRANCH-COUNT                                    48130000
481301          FROM  SUT_OTBND_UPC A                                   48130100
481302               ,SUT_OTBND_CART B                                  48130200
481303               ,SUT_OTBND_LOC F                                   48130300
481304         WHERE  F.INBD_TRIP_ID     = :DK-TRIP-ID                  48130400
481305           AND  A.SHIPT_UNT_ID      = B.SHIPT_UNT_ID              48130500
481306           AND  A.SHIPT_UNT_ID      = F.SHIPT_UNT_ID              48130600
481307           AND  B.CART_SRC_CDE      = 'RDM'                       48130700
481308           AND  B.ACTV_IND          = 'Y'                         48130800
481309           AND  F.SCN_CDE           = 'RECV'                      48130900
481310         WITH UR                                                  48131001
481311       END-EXEC.                                                  48131100
481312                                                                  48131200
481313     EVALUATE TRUE                                                48131300
481314         WHEN SQLCODE = ZERO                                      48131400
481315         WHEN SQLCODE = -811                                      48131500
481316             CONTINUE                                             48131600
481317         WHEN OTHER                                               48131700
481318             MOVE '8100-DETERMINE-COUNTS'                         48131800
481319                                   TO DP013-PARAGRAPH             48131900
481320             MOVE 'SELECT COUNTS   '  TO DP013-MESSAGE-TEXT (1)   48132000
481321             MOVE SQLCA        TO DP013-SQLCA                     48132100
481322             MOVE 'SUT_OTBND_UPC    ' TO DP013-DB2-TABLE-NAME (1) 48132200
481323             MOVE 'SUT_OTBND_CART   ' TO DP013-DB2-TABLE-NAME (2) 48132300
481324             MOVE 'SUT_OTBND_LOC    ' TO DP013-DB2-TABLE-NAME (3) 48132400
481325             SET DP013-DB2-ABEND                                  48132500
481326                 DP013-XCTL-DISPLAY-RESTART TO TRUE               48132600
481327             PERFORM DP013-0000-PROCESS-ABEND                     48132700
481328     END-EVALUATE.                                                48132800
481329 8100-EXIT.                                                       48132900
481330     EXIT.                                                        48133000
481331                                                                  48133100
481332******************************************************************48133200
481333*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 48133300
481334 9100-READ-SEL-QUEUE.                                             48133400
481335     EXEC CICS                                                    48133500
481336         READQ TS                                                 48133600
481337             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        48133700
481338             INTO  (SU004-DC-SELECT-RECORD)                       48133800
481339             ITEM  (ASC-SEL-ITEM)                                 48133900
481340             RESP  (PV-CICS-RESP)                                 48134000
481341     END-EXEC.                                                    48134100
481342     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        48134200
481343         CONTINUE                                                 48134300
481344     ELSE                                                         48134400
481345         SET DP013-LOGIC-ABEND                                    48134500
481346             DP013-NO-ROLLBACK   TO   TRUE                        48134600
481347         MOVE '9100-READ-SEL-QUEUE'                               48134700
481348                                 TO   DP013-PARAGRAPH             48134800
481349         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   48134900
481350                                 TO   DP013-MESSAGE-TEXT (1)      48135000
481351         PERFORM DP013-0000-PROCESS-ABEND                         48135100
481352     END-IF.                                                      48135200
481353                                                                  48135300
481354                                                                  48135400
481355*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*48135500
481356* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *48135600
481357*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 48135700
481358 9200-REWRITE-SEL-QUEUE.                                          48135800
481359                                                                  48135900
481360     EXEC CICS                                                    48136000
481361          WRITEQ TS                                               48136100
481362              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      48136200
481363              FROM   (SU004-DC-SELECT-RECORD)                     48136300
481364              ITEM   (ASC-SEL-ITEM)                               48136400
481365              RESP   (PV-CICS-RESP)                               48136500
481366              REWRITE                                             48136600
481367     END-EXEC.                                                    48136700
481368                                                                  48136800
481369     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   48136900
481370         SET DP013-CICS-ABEND                                     48137000
481371             DP013-NO-ROLLBACK     TO TRUE                        48137100
481372         MOVE '9200-REWRITE-SEL-QUEUE'                            48137200
481373                                   TO DP013-PARAGRAPH             48137300
481374         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   48137400
481375                                   TO DP013-MESSAGE-TEXT (1)      48137500
481376         PERFORM DP013-0000-PROCESS-ABEND                         48137600
481377     END-IF.                                                      48137700
481378                                                                  48137800
481379                                                                  48137900
481380*----------------------------------------------------------------*48138000
481381*    ABEND PROCESSOR MODULE                                      *48138100
481382*----------------------------------------------------------------*48138200
481383                                                                  48138300
481384     COPY DPPD013.                                                48138400
481385                                                                  48138500
