000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - ERROR SCREENS'.                             00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRF871.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN            APRIL, 2001.                             00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000******************************************************************00100000
001100* THIS PROGRAM HAS 3 FUNCTIONS:                                   00110000
001200* 1 -  DISPLAY A FULL-SCREEN MESSAGE TO THE USER.                 00120000
001300                                                                  00130000
001400* 2 -  GRACEFULLY HANDLE A DB2 ABEND BY DISPLAYING A READABLE     00140000
001500*      MESSAGE ON THE LRT AND PRINTING DIAGNOSTICS TO THE CICS LOG00150000
001600                                                                  00160000
001700* 3 -  IN SOME CASES THERE IS A FLOW-THRU CAPABILITY TO XCNTL     00170000
001800*      FORWARD TO A PROGRAM OTHER THAN THE ORIGINATOR.            00180000
001900                                                                  00190000
002000                                                                  00200000
002100******************************************************************00210000
002200                                                                  00220000
002300 ENVIRONMENT DIVISION.                                            00230000
002400 DATA DIVISION.                                                   00240000
002500                                                                  00250000
002600 WORKING-STORAGE SECTION.                                         00260000
002700                                                                  00270000
002800 01  DK-DB2-KEYS.                                                 00280000
002900     05  DK-ADJ-USR-ID                PIC  X(08) VALUE SPACES.    00290000
003000                                                                  00300000
003100 01  PV-PROGRAM-VARIABLES.                                        00310000
003200     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE ZERO      00320000
003300                                                     COMP SYNC.   00330000
003400     05  PV-TEXT-LENGTH               PIC S9(04)  VALUE ZERO      00340000
003500                                                     COMP SYNC.   00350000
003600     05  PV-MESSAGE-AREA              PIC X(19)  VALUE SPACE.     00360000
003700     05  PV-CICS-RESPONSE             PIC S9(08) VALUE ZEROS      00370000
003800                                                     COMP SYNC.   00380000
003900     05  PV-TRANSFER-PROGRAM          PIC X(08) VALUE SPACES.     00390000
004000     05  PV-DATE                      PIC X(10) VALUE SPACES.     00400000
004100     05  PV-TIME                      PIC X(08) VALUE SPACES.     00410000
004200     05  PV-TIMESTAMP                 PIC X(26) VALUE SPACES.     00420000
004201*                                                                 00420100
004202*** DMH 1/31/13 - BEGIN                                           00420200
004210     05  PV-MSG34-DATE-TIME           PIC X(19) VALUE SPACES.     00420300
004220     05  PV-MSG34-DATE-TIME-R REDEFINES PV-MSG34-DATE-TIME.       00420400
004221         10 PV-MSG34-DATE             PIC X(10).                  00420500
004222         10 PV-MSG34-AT               PIC X(03).                  00420600
004223         10 PV-MSG34-TIME             PIC X(05).                  00420700
004224         10 FILLER                    PIC X(01).                  00420800
004230*** DMH 1/31/13 - END                                             00420900
004240*                                                                 00421000
004300                                                                  00422000
004400 01  PC-PROGRAM-CONSTANTS.                                        00423000
004500     05  PC-CURRENT-TRANID            PIC X(04)  VALUE 'E871'.    00424000
004600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'PCKRF871'.00425000
004700     05  PC-OPEN-FOR-AUDIT-PROGRAM    PIC X(08)  VALUE 'PCKRF875'.00426000
004800     05  PC-CLOSE-TRAILER-PROGRAM     PIC X(08)  VALUE 'PCKRF877'.00427000
004900*    PC-NEW-LINE IS HEX '15'                                      00428000
005000     05  PC-NEW-LINE                  PIC X(01)  VALUE X'15'.     00429000
005100                                                                  00430000
005200     COPY DFHAID.                                                 00440000
005300     COPY DPWS013.                                                00450000
005400                                                                  00460000
005500     COPY PCKM871.                                                00470000
005600                                                                  00480000
005700                                                                  00490000
005800                                                                  00500000
005900*  COMMAREA TO/FROM HOST PROGRAM                                  00510000
006000 01  CA-COMMAREA.                                                 00520000
006100     COPY PCWS233.                                                00530000
006101**  EXTRA SPACES ADDED TO CARRY PRIVATE COMMAREA DATA             00540000
006102     05  CA-PRIVATE-COMMAREA          PIC X(300).                 00550000
006103                                                                  00560000
006104*  COPY BOOK CONTAINING THE SYSTEM SCREEN MESSAGES                00570000
006105     COPY PCWS235.                                                00580000
006106                                                                  00590000
006107*  COPY BOOK USED FOR AUDIT APPLICATION PROCESSING                00600000
006108     COPY PCWS045.                                                00610000
006109                                                                  00610100
006110* HELP SCREEN COMMAREA                                            00610200
006120     COPY PCWS192.                                                00610300
006130* HELP SCREEN WORK AREA                                           00610400
006140     COPY PCWS188.                                                00610500
006150                                                                  00610600
006160**   LAYOUT FOR TEMP-STORAGE QUEUE INFORMATION.                   00610700
006170*                                                                 00610800
006180     COPY DPWS026.                                                00610900
006190*                                                                 00611000
006200**   HEX CONVERSION ROUTINE PARAMETER LIST                        00612000
006300*                                                                 00613000
006400     COPY DPWS012.                                                00614000
006500*                                                                 00615000
006600/                                                                 00616000
006700 01  LT-LOG-LINE-TABLE.                                           00617000
006800     05  LT-LOG-LINE             OCCURS 52 TIMES                  00618000
006900                                 INDEXED BY LT-IDX.               00619000
007000         10  LT-ERROR-MESSAGE    PIC  X(79).                      00620000
007100                                                                  00630000
007200 01  PV-TEXT.                                                     00640000
007300     05  PV-TEXT-LINE-1.                                          00650000
007400         10  FILLER              PIC X(06)   VALUE 'PGM:  '.      00660000
007500         10  PV-TEXT-HEADER      PIC X(08)   VALUE 'PCKRF871'.    00670000
007600         10  FILLER              PIC X(05)   VALUE SPACES.        00680000
007700         10  PV-NEW-LINE-1       PIC X(01)   VALUE SPACES.        00690000
007800     05  PV-TEXT-LINE-2.                                          00700000
007900         10  FILLER              PIC X(06)   VALUE 'MSG:  '.      00710000
008000         10  PV-TEXT-MSG-NBR     PIC 9(03)   VALUE ZEROES.        00720000
008100         10  FILLER              PIC X(10)   VALUE SPACES.        00730000
008200         10  PV-NEW-LINE-2       PIC X(01)   VALUE SPACES.        00740000
008300     05  PV-TEXT-LINE-3.                                          00750000
008400         10  FILLER              PIC X(06)   VALUE 'LAST: '.      00760000
008500         10  PV-TEXT-LAST-PGM    PIC X(08)   VALUE SPACES.        00770000
008600         10  FILLER              PIC X(05)   VALUE SPACES.        00780000
008700         10  PV-NEW-LINE-3       PIC X(01)   VALUE SPACES.        00790000
008800     05  PV-TEXT-LINE-4.                                          00800000
008900         10  FILLER              PIC X(06)   VALUE 'ROOT: '.      00810000
009000         10  PV-TEXT-ROOT-PGM    PIC X(08)   VALUE SPACES.        00820000
009100         10  FILLER              PIC X(05)   VALUE SPACES.        00830000
009200         10  PV-NEW-LINE-4       PIC X(01)   VALUE SPACES.        00840000
009300     05  PV-TEXT-LINE-5.                                          00850000
009400         10  FILLER              PIC X(06)   VALUE 'MENU: '.      00860000
009500         10  PV-TEXT-MENU-PGM    PIC X(08)   VALUE SPACES.        00870000
009600         10  FILLER              PIC X(05)   VALUE SPACES.        00880000
009700         10  PV-NEW-LINE-5       PIC X(01)   VALUE SPACES.        00890000
009800     05  PV-TEXT-LINE-6.                                          00900000
009900         10  FILLER              PIC X(06)   VALUE 'NEXT: '.      00910000
010000         10  PV-NEXT-MENU-PGM    PIC X(08)   VALUE SPACES.        00920000
010100         10  FILLER              PIC X(05)   VALUE SPACES.        00930000
010200         10  PV-NEW-LINE-6       PIC X(01)   VALUE SPACES.        00940000
010300     05  PV-TEXT-LINE-7.                                          00950000
010400         10  FILLER              PIC X(19)   VALUE SPACES.        00960000
010500         10  PV-NEW-LINE-7       PIC X(01)   VALUE SPACES.        00970000
010600     05  PV-TEXT-LINE-8          PIC X(20)   VALUE                00980000
010700         ' ENTER TO CONTINUE  '.                                  00990000
010800                                                                  01000000
010900 01  PV-ABEND-STUFF.                                              01010000
011000     05  PV-LOG-LINE.                                             01020000
011100         10  FILLER              PIC  X(22)  VALUE                01030000
011200             '*** ERROR ON TERMINAL '.                            01040000
011300         10  PV-LOG-TERMINAL     PIC  X(04)  VALUE SPACE.         01050000
011400         10  FILLER              PIC  X(06)  VALUE ' ===> '.      01060000
011500         10  PV-LOG-DATA         PIC  X(79)  VALUE SPACE.         01070000
011600     05 DL1-DB2-LINE-1.                                           01080000
011700         10 FILLER               PIC  X(16)  VALUE SPACE.         01090000
011800         10 FILLER               PIC  X(47)  VALUE                01100000
011900             'THERE WAS AN ERROR ENCOUNTERED IN A DB2 COMMAND'.   01110000
012000         10 FILLER               PIC  X(16)  VALUE SPACE.         01120000
012100     05 DL2-DB2-LINE-2.                                           01130000
012200         10 FILLER               PIC  X(43)  VALUE                01140000
012300             'THE FOLLOWING DB2 TABLE(S) MAY BE INVOLVED:'.       01150000
012400         10 FILLER               PIC  X(36)  VALUE SPACE.         01160000
012500                                                                  01170000
012600     05  TS-INFO-QUEUE-NAME.                                      01180000
012700         10  TS-INFO-QUEUE-TERMINAL                               01190000
012800                                 PIC X(04)   VALUE SPACE.         01200000
012900         10  FILLER              PIC X(04)   VALUE 'INFO'.        01210000
013000                                                                  01220000
013100     05  PC-LOG-QUEUE-RESOURCE   PIC  X(04)  VALUE 'CSSL'.        01230000
013200     05  PV-NUMBER-LOG-LINES     PIC S9(04)  VALUE +0             01240000
013300                                              COMP SYNC.          01250000
013400     05  PC-LOG-QUEUE            PIC  X(04)  VALUE 'CSSL'.        01260000
013500     05  PS-LOG-OVERFLOW-SW      PIC  X(01)  VALUE 'N'.           01270000
013600         88  PS-LOG-OVERFLOW                 VALUE 'Y'.           01280000
013700     05  PC-LOGON-TRAN           PIC  X(04)  VALUE 'Z028'.        01290000
013800     05  PV-SYSID                PIC  X(04)  VALUE SPACES.        01300000
013900     05  PV-TS-ITEM              PIC S9(04)  VALUE +1             01310000
014000                                              COMP SYNC.          01320000
014100     05  PV-MSG-SUB              PIC S9(04)  VALUE +0             01330000
014200                                              COMP SYNC.          01340000
014300     05  PC-LOG-TABLE-MAX        PIC S9(04)  VALUE +52            01350000
014400                                             COMP.                01360000
014500     05  PV-STRING-POINTER       PIC S9(04)  VALUE +1             01370000
014600                                              COMP SYNC.          01380000
014700     05  PC-STRING-POINTER-MAX   PIC S9(04)  VALUE +60            01390000
014800                                             COMP.                01400000
014900 01  FDB-FORMAT-DB2-ERROR-FIELDS.                                 01410000
015000     05  FDB-MAX-MESSAGE-LINES     PIC S9(04)  VALUE +12          01420000
015100                                               COMP SYNC.         01430000
015200     05  FDB-ERROR-LINE-LENGTH     PIC S9(09)  VALUE +75          01440000
015300                                               COMP SYNC.         01450000
015400     05  FDB-FORMATTED-MESSAGE.                                   01460000
015500         10  FILLER                PIC S9(04)  VALUE +900         01470000
015600                                               COMP SYNC.         01480000
015700         10  FDB-MESSAGE-LINE      OCCURS 12 TIMES                01490000
015800                                   INDEXED BY FDB-MSG-IDX         01500000
015900                                   PIC  X(75).                    01510000
016000*                                                                 01520000
016100                                                                  01530000
016200*                                                                 01540000
016300 01  AL1-ABEND-LINE-1.                                            01550000
016400     05  FILLER                  PIC  X(12)  VALUE 'PROGRAM...: '.01560000
016500     05  AL1-PROGRAM             PIC  X(08)  VALUE SPACE.         01570000
016600     05  FILLER                  PIC  X(04)  VALUE SPACE.         01580000
016700     05  FILLER                  PIC  X(11)  VALUE 'PARAGRAPH: '. 01590000
016800     05  AL1-PARAGRAPH           PIC  X(30)  VALUE SPACE.         01600000
016900     05  FILLER                  PIC  X(14)  VALUE SPACE.         01610000
017000 01  AL2-ABEND-LINE-2.                                            01620000
017100     05  FILLER                  PIC  X(12)  VALUE 'USERID....: '.01630000
017200     05  AL2-USERID              PIC  X(08)  VALUE SPACE.         01640000
017300     05  FILLER                  PIC  X(06)  VALUE SPACE.         01650000
017400     05  FILLER                  PIC  X(09)  VALUE 'NETNAME: '.   01660000
017500     05  AL2-NETNAME             PIC  X(08)  VALUE SPACE.         01670000
017600     05  FILLER                  PIC  X(02)  VALUE SPACE.         01680000
017700     05  FILLER                  PIC  X(10)  VALUE 'LOCATION: '.  01690000
017800     05  AL2-LOCATION            PIC  9(04)  VALUE ZEROS.         01700000
017900     05  FILLER                  PIC  X(20)  VALUE SPACE.         01710000
018000 01  AL3-ABEND-LINE-3.                                            01720000
018100     05  FILLER                  PIC  X(12)  VALUE                01730000
018200                                             'ABEND TYPE: '.      01740000
018300     05  AL3-ABEND-TYPE          PIC  X(01)  VALUE SPACE.         01750000
018400     05  FILLER                  PIC  X(07)  VALUE SPACE.         01760000
018500     05  FILLER                  PIC  X(15)  VALUE                01770000
018600                                             'ABEND CONTROL: '.   01780000
018700     05  AL3-ABEND-CONTROL       PIC  X(01)  VALUE SPACE.         01790000
018800     05  FILLER                  PIC  X(09)  VALUE SPACE.         01800000
018900     05  FILLER                  PIC  X(10)  VALUE                01810000
019000                                             'ROLLBACK: '.        01820000
019100     05  AL3-ROLLBACK            PIC  X(01)  VALUE SPACE.         01830000
019200     05  FILLER                  PIC  X(23)  VALUE SPACE.         01840000
019300                                                                  01850000
019400 01  AL4-ABEND-LINE-4.                                            01860000
019500     05  FILLER                  PIC  X(11)  VALUE                01870000
019600                                             'MESSAGE...:'.       01880000
019700     05  FILLER                  PIC  X(68)  VALUE SPACE.         01890000
019800*                                                                 01900000
019900*                                                                 01910000
020000**   PREFORMATTED LINES FOR THE EIB AREA                          01920000
020100*                                                                 01930000
020200 01  EL1-EIB-LINE-1.                                              01940000
020300     05  FILLER                  PIC  X(28)  VALUE                01950000
020400         'EIB INFORMATION FOLLOWS:'.                              01960000
020500     05  FILLER                  PIC  X(51)  VALUE SPACE.         01970000
020600 01  EL2-EIB-LINE-2.                                              01980000
020700     05  FILLER                  PIC  X(02)  VALUE SPACE.         01990000
020800     05  FILLER                  PIC  X(10)  VALUE 'EIBTIME.: '.  02000000
020900     05  EL2-EIBTIME             PIC  9(07)+ VALUE ZERO.          02010000
021000     05  FILLER                  PIC  X(20)  VALUE SPACE.         02020000
021100     05  FILLER                  PIC  X(10)  VALUE 'EIBDATE.: '.  02030000
021200     05  EL2-EIBDATE             PIC  9(07)+ VALUE ZERO.          02040000
021300     05  FILLER                  PIC  X(21)  VALUE SPACE.         02050000
021400 01  EL3-EIB-LINE-3.                                              02060000
021500     05  FILLER                  PIC  X(02)  VALUE SPACE.         02070000
021600     05  FILLER                  PIC  X(10)  VALUE 'EIBTRNID: '.  02080000
021700     05  EL3-EIBTRNID            PIC  X(04)  VALUE SPACE.         02090000
021800     05  FILLER                  PIC  X(24)  VALUE SPACE.         02100000
021900     05  FILLER                  PIC  X(10)  VALUE 'EIBTASKN: '.  02110000
022000     05  EL3-EIBTASKN            PIC  9(07)+ VALUE ZERO.          02120000
022100     05  FILLER                  PIC  X(21)  VALUE SPACE.         02130000
022200 01  EL4-EIB-LINE-4.                                              02140000
022300     05  FILLER                  PIC  X(02)  VALUE SPACE.         02150000
022400     05  FILLER                  PIC  X(10)  VALUE 'EIBTRMID: '.  02160000
022500     05  EL4-EIBTRMID            PIC  X(04)  VALUE SPACE.         02170000
022600     05  FILLER                  PIC  X(24)  VALUE SPACE.         02180000
022700     05  FILLER                  PIC  X(10)  VALUE 'EIBCPOSN: '.  02190000
022800     05  EL4-EIBCPOSN            PIC  9(04)+ VALUE ZERO.          02200000
022900     05  FILLER                  PIC  X(24)  VALUE SPACE.         02210000
023000 01  EL5-EIB-LINE-5.                                              02220000
023100     05  FILLER                  PIC  X(02)  VALUE SPACE.         02230000
023200     05  FILLER                  PIC  X(10)  VALUE 'EIBCALEN: '.  02240000
023300     05  EL5-EIBCALEN            PIC  9(05)  VALUE ZERO.          02250000
023400     05  FILLER                  PIC  X(23)  VALUE SPACE.         02260000
023500     05  FILLER                  PIC  X(10)  VALUE 'EIBAID..: '.  02270000
023600     05  EL5-EIBAID              PIC  X(01)  VALUE SPACE.         02280000
023700     05  FILLER                  PIC  X(02)  VALUE ' ('.          02290000
023800     05  EL5-EIBAID-DESCRIPTION  PIC  X(05)  VALUE SPACE.         02300000
023900     05  FILLER                  PIC  X(01)  VALUE ')'.           02310000
024000     05  FILLER                  PIC  X(30)  VALUE SPACE.         02320000
024100 01  EL6-EIB-LINE-6.                                              02330000
024200     05  FILLER                  PIC  X(02)  VALUE SPACE.         02340000
024300     05  FILLER                  PIC  X(12)  VALUE                02350000
024400                                             'EIBFN...: X'''.     02360000
024500     05  EL6-EIBFN-HEX           PIC  X(04)  VALUE SPACE.         02370000
024600     05  FILLER                  PIC  X(01)  VALUE ''''.          02380000
024700     05  FILLER                  PIC  X(21)  VALUE SPACE.         02390000
024800     05  FILLER                  PIC  X(11)  VALUE                02400000
024900                                             'EIBRCODE:X'''.      02410000
025000     05  EL6-EIBRCODE-HEX        PIC  X(12)  VALUE SPACE.         02420000
025100     05  FILLER                  PIC  X(01)  VALUE ''''.          02430000
025200     05  FILLER                  PIC  X(15)  VALUE SPACE.         02440000
025300 01  EL7-EIB-LINE-7.                                              02450000
025400     05  FILLER                  PIC  X(02)  VALUE SPACE.         02460000
025500     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP.: '.  02470000
025600     05  EL7-EIBRESP             PIC  9(08)  VALUE ZERO.          02480000
025700     05  FILLER                  PIC  X(02)  VALUE ' ('.          02490000
025800     05  EL7-EIBRESP-DESCRIPTION PIC  X(12)  VALUE SPACE.         02500000
025900     05  FILLER                  PIC  X(01)  VALUE ')'.           02510000
026000     05  FILLER                  PIC  X(05)  VALUE SPACE.         02520000
026100     05  FILLER                  PIC  X(10)  VALUE 'EIBRESP2: '.  02530000
026200     05  EL7-EIBRESP2            PIC  9(08)+ VALUE ZERO.          02540000
026300     05  FILLER                  PIC  X(20)  VALUE SPACE.         02550000
026400 01  EL8-EIB-LINE-8.                                              02560000
026500     05  FILLER                  PIC  X(02)  VALUE SPACE.         02570000
026600     05  FILLER                  PIC  X(10)  VALUE 'EIBDS...: '.  02580000
026700     05  EL8-EIBDS               PIC  X(08)  VALUE SPACE.         02590000
026800     05  FILLER                  PIC  X(20)  VALUE SPACE.         02600000
026900     05  FILLER                  PIC  X(10)  VALUE 'EIBREQID: '.  02610000
027000     05  EL8-EIBREQID-HEX        PIC  X(08)  VALUE SPACE.         02620000
027100     05  FILLER                  PIC  X(21)  VALUE SPACE.         02630000
027200 01  EL9-EIB-LINE-9.                                              02640000
027300     05  FILLER                  PIC  X(02)  VALUE SPACE.         02650000
027400     05  FILLER                  PIC  X(12)  VALUE                02660000
027500                                             'EIBRSRCE: X'''.     02670000
027600     05  EL9-EIBRSRCE-HEX        PIC  X(16)  VALUE SPACE.         02680000
027700     05  FILLER                  PIC  X(01)  VALUE ''''.          02690000
027800     05  FILLER                  PIC  X(09)  VALUE SPACE.         02700000
027900     05  FILLER                  PIC  X(12)  VALUE                02710000
028000                                             'EIBEOC..: X'''.     02720000
028100     05  EL9-EIBEOC-HEX          PIC  X(02)  VALUE SPACE.         02730000
028200     05  FILLER                  PIC  X(01)  VALUE ''''.          02740000
028300     05  FILLER                  PIC  X(24)  VALUE SPACE.         02750000
028400 01  EL10-EIB-LINE-10.                                            02760000
028500     05  FILLER                  PIC  X(02)  VALUE SPACE.         02770000
028600     05  FILLER                  PIC  X(12)  VALUE                02780000
028700                                             'EIBFREE.: X'''.     02790000
028800     05  EL10-EIBFREE-HEX        PIC  X(02)  VALUE SPACE.         02800000
028900     05  FILLER                  PIC  X(01)  VALUE ''''.          02810000
029000     05  FILLER                  PIC  X(23)  VALUE SPACE.         02820000
029100     05  FILLER                  PIC  X(12)  VALUE                02830000
029200                                             'EIBRECV.: X'''.     02840000
029300     05  EL10-EIBRECV-HEX        PIC  X(02)  VALUE SPACE.         02850000
029400     05  FILLER                  PIC  X(01)  VALUE ''''.          02860000
029500     05  FILLER                  PIC  X(24)  VALUE SPACE.         02870000
029600 01  EL11-EIB-LINE-11.                                            02880000
029700     05  FILLER                  PIC  X(02)  VALUE SPACE.         02890000
029800     05  FILLER                  PIC  X(12)  VALUE                02900000
029900                                             'EIBATT..: X'''.     02910000
030000     05  EL11-EIBATT-HEX         PIC  X(02)  VALUE SPACE.         02920000
030100     05  FILLER                  PIC  X(01)  VALUE ''''.          02930000
030200     05  FILLER                  PIC  X(23)  VALUE SPACE.         02940000
030300     05  FILLER                  PIC  X(12)  VALUE                02950000
030400                                             'EIBSYNC.: X'''.     02960000
030500     05  EL11-EIBSYNC-HEX        PIC  X(02)  VALUE SPACE.         02970000
030600     05  FILLER                  PIC  X(01)  VALUE ''''.          02980000
030700     05  FILLER                  PIC  X(24)  VALUE SPACE.         02990000
030800 01  EL12-EIB-LINE-12.                                            03000000
030900     05  FILLER                  PIC  X(02)  VALUE SPACE.         03010000
031000     05  FILLER                  PIC  X(12)  VALUE                03020000
031100                                             'EIBFMH..: X'''.     03030000
031200     05  EL12-EIBFMH-HEX         PIC  X(02)  VALUE SPACE.         03040000
031300     05  FILLER                  PIC  X(01)  VALUE ''''.          03050000
031400     05  FILLER                  PIC  X(23)  VALUE SPACE.         03060000
031500     05  FILLER                  PIC  X(12)  VALUE                03070000
031600                                             'EIBCOMPL: X'''.     03080000
031700     05  EL12-EIBCOMPL-HEX       PIC  X(02)  VALUE SPACE.         03090000
031800     05  FILLER                  PIC  X(01)  VALUE ''''.          03100000
031900     05  FILLER                  PIC  X(24)  VALUE SPACE.         03110000
032000 01  EL13-EIB-LINE-13.                                            03120000
032100     05  FILLER                  PIC  X(02)  VALUE SPACE.         03130000
032200     05  FILLER                  PIC  X(12)  VALUE                03140000
032300                                             'EIBSIG..: X'''.     03150000
032400     05  EL13-EIBSIG-HEX         PIC  X(02)  VALUE SPACE.         03160000
032500     05  FILLER                  PIC  X(01)  VALUE ''''.          03170000
032600     05  FILLER                  PIC  X(23)  VALUE SPACE.         03180000
032700     05  FILLER                  PIC  X(12)  VALUE                03190000
032800                                             'EIBCONF.: X'''.     03200000
032900     05  EL13-EIBCONF-HEX        PIC  X(02)  VALUE SPACE.         03210000
033000     05  FILLER                  PIC  X(01)  VALUE ''''.          03220000
033100     05  FILLER                  PIC  X(24)  VALUE SPACE.         03230000
033200 01  EL14-EIB-LINE-14.                                            03240000
033300     05  FILLER                  PIC  X(02)  VALUE SPACE.         03250000
033400     05  FILLER                  PIC  X(12)  VALUE                03260000
033500                                             'EIBERR..: X'''.     03270000
033600     05  EL14-EIBERR-HEX         PIC  X(02)  VALUE SPACE.         03280000
033700     05  FILLER                  PIC  X(01)  VALUE ''''.          03290000
033800     05  FILLER                  PIC  X(23)  VALUE SPACE.         03300000
033900     05  FILLER                  PIC  X(12)  VALUE                03310000
034000                                             'EIBERRCD: X'''.     03320000
034100     05  EL14-EIBERRCD-HEX       PIC  X(08)  VALUE SPACE.         03330000
034200     05  FILLER                  PIC  X(01)  VALUE ''''.          03340000
034300     05  FILLER                  PIC  X(18)  VALUE SPACE.         03350000
034400 01  EL15-EIB-LINE-15.                                            03360000
034500     05  FILLER                  PIC  X(02)  VALUE SPACE.         03370000
034600     05  FILLER                  PIC  X(12)  VALUE                03380000
034700                                             'EIBSYNRB: X'''.     03390000
034800     05  EL15-EIBSYNRB-HEX       PIC  X(02)  VALUE SPACE.         03400000
034900     05  FILLER                  PIC  X(01)  VALUE ''''.          03410000
035000     05  FILLER                  PIC  X(23)  VALUE SPACE.         03420000
035100     05  FILLER                  PIC  X(12)  VALUE                03430000
035200                                             'EIBNODAT: X'''.     03440000
035300     05  EL15-EIBNODAT-HEX       PIC  X(02)  VALUE SPACE.         03450000
035400     05  FILLER                  PIC  X(01)  VALUE ''''.          03460000
035500     05  FILLER                  PIC  X(24)  VALUE SPACE.         03470000
035600*                                                                 03480000
035700*                                                                 03490000
035800**   FOLLOWING IS THE LAYOUT FOR THE EXEC INTERFACE BLOCK         03500000
035900**   USED IN PROCESSING A THE EIB AREA PASSED BY THE CALLING      03510000
036000**   PROGRAM.                                                     03520000
036100*                                                                 03530000
036200 01  EIBM-EIBLK-MASK.                                             03540000
036300     05  EIBM-TIME         PIC S9(07)  VALUE ZERO                 03550000
036400                                       COMP-3.                    03560000
036500     05  EIBM-DATE         PIC S9(07)  VALUE ZERO                 03570000
036600                                       COMP-3.                    03580000
036700     05  EIBM-TRNID        PIC  X(04)  VALUE SPACE.               03590000
036800     05  EIBM-TASKN        PIC S9(07)  VALUE ZERO                 03600000
036900                                       COMP-3.                    03610000
037000     05  EIBM-TRMID        PIC  X(04)  VALUE SPACE.               03620000
037100     05  FILLER            PIC S9(04)  VALUE ZERO                 03630000
037200                                       COMP.                      03640000
037300     05  EIBM-CPOSN        PIC S9(04)  VALUE ZERO                 03650000
037400                                       COMP.                      03660000
037500     05  EIBM-CALEN        PIC S9(04)  VALUE ZERO                 03670000
037600                                       COMP.                      03680000
037700     05  EIBM-AID          PIC  X(01)  VALUE SPACE.               03690000
037800     05  EIBM-FN           PIC  X(02)  VALUE SPACE.               03700000
037900     05  EIBM-RCODE        PIC  X(06)  VALUE SPACE.               03710000
038000     05  EIBM-DS           PIC  X(08)  VALUE SPACE.               03720000
038100     05  EIBM-REQID        PIC  X(08)  VALUE SPACE.               03730000
038200     05  EIBM-RSRCE        PIC  X(08)  VALUE SPACE.               03740000
038300     05  EIBM-SYNC         PIC  X(01)  VALUE SPACE.               03750000
038400     05  EIBM-FREE         PIC  X(01)  VALUE SPACE.               03760000
038500     05  EIBM-RECV         PIC  X(01)  VALUE SPACE.               03770000
038600     05  EIBM-SEND         PIC  X(01)  VALUE SPACE.               03780000
038700     05  EIBM-ATT          PIC  X(01)  VALUE SPACE.               03790000
038800     05  EIBM-EOC          PIC  X(01)  VALUE SPACE.               03800000
038900     05  EIBM-FMH          PIC  X(01)  VALUE SPACE.               03810000
039000     05  EIBM-COMPL        PIC  X(01)  VALUE SPACE.               03820000
039100     05  EIBM-SIG          PIC  X(01)  VALUE SPACE.               03830000
039200     05  EIBM-CONF         PIC  X(01)  VALUE SPACE.               03840000
039300     05  EIBM-ERR          PIC  X(01)  VALUE SPACE.               03850000
039400     05  EIBM-ERRCD        PIC  X(04)  VALUE SPACE.               03860000
039500     05  EIBM-SYNRB        PIC  X(01)  VALUE SPACE.               03870000
039600     05  EIBM-NODAT        PIC  X(01)  VALUE SPACE.               03880000
039700     05  EIBM-RESP         PIC S9(08)  VALUE ZERO                 03890000
039800                                       COMP.                      03900000
039900     05  EIBM-RESP2        PIC S9(08)  VALUE ZERO                 03910000
040000                                       COMP.                      03920000
040100     05  EIBM-RLDBK        PIC  X(01)  VALUE SPACE.               03930000
040200*                                                                 03940000
040300 01  AC-AID-CONVERSION-TABLE.                                     03950000
040400     05  AC-ATTENTION-ID-ENTRIES.                                 03960000
040500         10  FILLER              PIC  X(06)  VALUE ' NULL '.      03970000
040600         10  FILLER              PIC  X(06)  VALUE '''ENTER'.     03980000
040700         10  FILLER              PIC  X(06)  VALUE '_CLEAR'.      03990000
040800         10  FILLER              PIC  X(06)  VALUE 'ºCLRP '.      04000000
040900         10  FILLER              PIC  X(06)  VALUE '=PEN  '.      04010000
041000         10  FILLER              PIC  X(06)  VALUE 'WOPID '.      04020000
041100         10  FILLER              PIC  X(06)  VALUE 'XMSRE '.      04030000
041200         10  FILLER              PIC  X(06)  VALUE 'HSTRF '.      04040000
041300         10  FILLER              PIC  X(06)  VALUE '"TRIG '.      04050000
041400         10  FILLER              PIC  X(06)  VALUE '%PA1  '.      04060000
041500         10  FILLER              PIC  X(06)  VALUE '>PA2  '.      04070000
041600         10  FILLER              PIC  X(06)  VALUE ',PA3  '.      04080000
041700         10  FILLER              PIC  X(06)  VALUE '1PF1  '.      04090000
041800         10  FILLER              PIC  X(06)  VALUE '2PF2  '.      04100000
041900         10  FILLER              PIC  X(06)  VALUE '3PF3  '.      04110000
042000         10  FILLER              PIC  X(06)  VALUE '4PF4  '.      04120000
042100         10  FILLER              PIC  X(06)  VALUE '5PF5  '.      04130000
042200         10  FILLER              PIC  X(06)  VALUE '6PF6  '.      04140000
042300         10  FILLER              PIC  X(06)  VALUE '7PF7  '.      04150000
042400         10  FILLER              PIC  X(06)  VALUE '8PF8  '.      04160000
042500         10  FILLER              PIC  X(06)  VALUE '9PF9  '.      04170000
042600         10  FILLER              PIC  X(06)  VALUE ':PF10 '.      04180000
042700         10  FILLER              PIC  X(06)  VALUE '#PF11 '.      04190000
042800         10  FILLER              PIC  X(06)  VALUE '@PF12 '.      04200000
042900         10  FILLER              PIC  X(06)  VALUE 'APF13 '.      04210000
043000         10  FILLER              PIC  X(06)  VALUE 'BPF14 '.      04220000
043100         10  FILLER              PIC  X(06)  VALUE 'CPF15 '.      04230000
043200         10  FILLER              PIC  X(06)  VALUE 'DPF16 '.      04240000
043300         10  FILLER              PIC  X(06)  VALUE 'EPF17 '.      04250000
043400         10  FILLER              PIC  X(06)  VALUE 'FPF18 '.      04260000
043500         10  FILLER              PIC  X(06)  VALUE 'GPF19 '.      04270000
043600         10  FILLER              PIC  X(06)  VALUE 'HPF20 '.      04280000
043700         10  FILLER              PIC  X(06)  VALUE 'IPF21 '.      04290000
043800         10  FILLER              PIC  X(06)  VALUE '›PF22 '.      04300000
043900         10  FILLER              PIC  X(06)  VALUE '.PF23 '.      04310000
044000         10  FILLER              PIC  X(06)  VALUE '<PF24 '.      04320000
044100     05  AC-ATTENTION-ID-ENTRY   REDEFINES                        04330000
044200                                 AC-ATTENTION-ID-ENTRIES          04340000
044300                                 OCCURS 36 TIMES                  04350000
044400                                 INDEXED BY AC-AID-IDX.           04360000
044500         10  AC-EIBAID           PIC  X(01).                      04370000
044600         10  AC-AID-NAME         PIC  X(05).                      04380000
044700*                                                                 04390000
044800** EIBRESP DESCRIPTION TABLE                                      04400000
044900*                                                                 04410000
045000 01  EC-EIBRESP-CONVERSION-TABLE.                                 04420000
045100     05  EC-EIBRESP-ENTRIES.                                      04430000
045200         10  FILLER              PIC S9(08)  VALUE +00            04440000
045300                                             COMP.                04450000
045400         10  FILLER              PIC  X(12)  VALUE 'NORMAL'.      04460000
045500         10  FILLER              PIC S9(08)  VALUE +01            04470000
045600                                             COMP.                04480000
045700         10  FILLER              PIC  X(12)  VALUE 'ERROR'.       04490000
045800         10  FILLER              PIC S9(08)  VALUE +02            04500000
045900                                             COMP.                04510000
046000         10  FILLER              PIC  X(12)  VALUE 'RDATT'.       04520000
046100         10  FILLER              PIC S9(08)  VALUE +03            04530000
046200                                             COMP.                04540000
046300         10  FILLER              PIC  X(12)  VALUE 'WRBRK'.       04550000
046400         10  FILLER              PIC S9(08)  VALUE +04            04560000
046500                                             COMP.                04570000
046600         10  FILLER              PIC  X(12)  VALUE 'EOF'.         04580000
046700         10  FILLER              PIC S9(08)  VALUE +05            04590000
046800                                             COMP.                04600000
046900         10  FILLER              PIC  X(12)  VALUE 'EODS'.        04610000
047000         10  FILLER              PIC S9(08)  VALUE +06            04620000
047100                                             COMP.                04630000
047200         10  FILLER              PIC  X(12)  VALUE 'EOC'.         04640000
047300         10  FILLER              PIC S9(08)  VALUE +07            04650000
047400                                             COMP.                04660000
047500         10  FILLER              PIC  X(12)  VALUE 'INBFMH'.      04670000
047600         10  FILLER              PIC S9(08)  VALUE +08            04680000
047700                                             COMP.                04690000
047800         10  FILLER              PIC  X(12)  VALUE 'ENDINPT'.     04700000
047900         10  FILLER              PIC S9(08)  VALUE +09            04710000
048000                                             COMP.                04720000
048100         10  FILLER              PIC  X(12)  VALUE 'NONVAL'.      04730000
048200         10  FILLER              PIC S9(08)  VALUE +10            04740000
048300                                             COMP.                04750000
048400         10  FILLER              PIC  X(12)  VALUE 'NOSTART'.     04760000
048500         10  FILLER              PIC S9(08)  VALUE +11            04770000
048600                                             COMP.                04780000
048700         10  FILLER              PIC  X(12)  VALUE 'TERMIDERR'.   04790000
048800         10  FILLER              PIC S9(08)  VALUE +12            04800000
048900                                             COMP.                04810000
049000         10  FILLER              PIC  X(12)  VALUE 'DSIDERR'.     04820000
049100         10  FILLER              PIC S9(08)  VALUE +13            04830000
049200                                             COMP.                04840000
049300         10  FILLER              PIC  X(12)  VALUE 'NOTFND'.      04850000
049400         10  FILLER              PIC S9(08)  VALUE +14            04860000
049500                                             COMP.                04870000
049600         10  FILLER              PIC  X(12)  VALUE 'DUPREC'.      04880000
049700         10  FILLER              PIC S9(08)  VALUE +15            04890000
049800                                             COMP.                04900000
049900         10  FILLER              PIC  X(12)  VALUE 'DUPKEY'.      04910000
050000         10  FILLER              PIC S9(08)  VALUE +16            04920000
050100                                             COMP.                04930000
050200         10  FILLER              PIC  X(12)  VALUE 'INVREQ'.      04940000
050300         10  FILLER              PIC S9(08)  VALUE +17            04950000
050400                                             COMP.                04960000
050500         10  FILLER              PIC  X(12)  VALUE 'IOERR'.       04970000
050600         10  FILLER              PIC S9(08)  VALUE +18            04980000
050700                                             COMP.                04990000
050800         10  FILLER              PIC  X(12)  VALUE 'NOSPACE'.     05000000
050900         10  FILLER              PIC S9(08)  VALUE +19            05010000
051000                                             COMP.                05020000
051100         10  FILLER              PIC  X(12)  VALUE 'NOTOPEN'.     05030000
051200         10  FILLER              PIC S9(08)  VALUE +20            05040000
051300                                             COMP.                05050000
051400         10  FILLER              PIC  X(12)  VALUE 'ENDFILE'.     05060000
051500         10  FILLER              PIC S9(08)  VALUE +21            05070000
051600                                             COMP.                05080000
051700         10  FILLER              PIC  X(12)  VALUE 'ILLOGIC'.     05090000
051800         10  FILLER              PIC S9(08)  VALUE +22            05100000
051900                                             COMP.                05110000
052000         10  FILLER              PIC  X(12)  VALUE 'LENGERR'.     05120000
052100         10  FILLER              PIC S9(08)  VALUE +23            05130000
052200                                             COMP.                05140000
052300         10  FILLER              PIC  X(12)  VALUE 'QZERO'.       05150000
052400         10  FILLER              PIC S9(08)  VALUE +24            05160000
052500                                             COMP.                05170000
052600         10  FILLER              PIC  X(12)  VALUE 'SIGNAL'.      05180000
052700         10  FILLER              PIC S9(08)  VALUE +25            05190000
052800                                             COMP.                05200000
052900         10  FILLER              PIC  X(12)  VALUE 'QBUSY'.       05210000
053000         10  FILLER              PIC S9(08)  VALUE +26            05220000
053100                                             COMP.                05230000
053200         10  FILLER              PIC  X(12)  VALUE 'ITEMERR'.     05240000
053300         10  FILLER              PIC S9(08)  VALUE +27            05250000
053400                                             COMP.                05260000
053500         10  FILLER              PIC  X(12)  VALUE 'PGMIDERR'.    05270000
053600         10  FILLER              PIC S9(08)  VALUE +28            05280000
053700                                             COMP.                05290000
053800         10  FILLER              PIC  X(12)  VALUE 'TRANSIDERR'.  05300000
053900         10  FILLER              PIC S9(08)  VALUE +29            05310000
054000                                             COMP.                05320000
054100         10  FILLER              PIC  X(12)  VALUE 'ENDDATA'.     05330000
054200         10  FILLER              PIC S9(08)  VALUE +30            05340000
054300                                             COMP.                05350000
054400         10  FILLER              PIC  X(12)  VALUE 'INVTSREQ'.    05360000
054500         10  FILLER              PIC S9(08)  VALUE +31            05370000
054600                                             COMP.                05380000
054700         10  FILLER              PIC  X(12)  VALUE 'EXPIRED'.     05390000
054800         10  FILLER              PIC S9(08)  VALUE +32            05400000
054900                                             COMP.                05410000
055000         10  FILLER              PIC  X(12)  VALUE 'RETPAGE'.     05420000
055100         10  FILLER              PIC S9(08)  VALUE +33            05430000
055200                                             COMP.                05440000
055300         10  FILLER              PIC  X(12)  VALUE 'RTEFAIL'.     05450000
055400         10  FILLER              PIC S9(08)  VALUE +34            05460000
055500                                             COMP.                05470000
055600         10  FILLER              PIC  X(12)  VALUE 'RTESOME'.     05480000
055700         10  FILLER              PIC S9(08)  VALUE +35            05490000
055800                                             COMP.                05500000
055900         10  FILLER              PIC  X(12)  VALUE 'TSIOERR'.     05510000
056000         10  FILLER              PIC S9(08)  VALUE +36            05520000
056100                                             COMP.                05530000
056200         10  FILLER              PIC  X(12)  VALUE 'MAPFAIL'.     05540000
056300         10  FILLER              PIC S9(08)  VALUE +37            05550000
056400                                             COMP.                05560000
056500         10  FILLER              PIC  X(12)  VALUE 'INVERRTERM'.  05570000
056600         10  FILLER              PIC S9(08)  VALUE +38            05580000
056700                                             COMP.                05590000
056800         10  FILLER              PIC  X(12)  VALUE 'INVMPSZ'.     05600000
056900         10  FILLER              PIC S9(08)  VALUE +39            05610000
057000                                             COMP.                05620000
057100         10  FILLER              PIC  X(12)  VALUE 'IGREQID'.     05630000
057200         10  FILLER              PIC S9(08)  VALUE +40            05640000
057300                                             COMP.                05650000
057400         10  FILLER              PIC  X(12)  VALUE 'OVERFLOW'.    05660000
057500         10  FILLER              PIC S9(08)  VALUE +41            05670000
057600                                             COMP.                05680000
057700         10  FILLER              PIC  X(12)  VALUE 'INVLDC'.      05690000
057800         10  FILLER              PIC S9(08)  VALUE +42            05700000
057900                                             COMP.                05710000
058000         10  FILLER              PIC  X(12)  VALUE 'NOSTG'.       05720000
058100         10  FILLER              PIC S9(08)  VALUE +43            05730000
058200                                             COMP.                05740000
058300         10  FILLER              PIC  X(12)  VALUE 'JIDERR'.      05750000
058400         10  FILLER              PIC S9(08)  VALUE +44            05760000
058500                                             COMP.                05770000
058600         10  FILLER              PIC  X(12)  VALUE 'QIDERR'.      05780000
058700         10  FILLER              PIC S9(08)  VALUE +45            05790000
058800                                             COMP.                05800000
058900         10  FILLER              PIC  X(12)  VALUE 'NOJBUFSP'.    05810000
059000         10  FILLER              PIC S9(08)  VALUE +46            05820000
059100                                             COMP.                05830000
059200         10  FILLER              PIC  X(12)  VALUE 'DSSTAT'.      05840000
059300         10  FILLER              PIC S9(08)  VALUE +47            05850000
059400                                             COMP.                05860000
059500         10  FILLER              PIC  X(12)  VALUE 'SELNERR'.     05870000
059600         10  FILLER              PIC S9(08)  VALUE +48            05880000
059700                                             COMP.                05890000
059800         10  FILLER              PIC  X(12)  VALUE 'FUNCERR'.     05900000
059900         10  FILLER              PIC S9(08)  VALUE +49            05910000
060000                                             COMP.                05920000
060100         10  FILLER              PIC  X(12)  VALUE 'UNEXPIN'.     05930000
060200         10  FILLER              PIC S9(08)  VALUE +50            05940000
060300                                             COMP.                05950000
060400         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKRD'.  05960000
060500         10  FILLER              PIC S9(08)  VALUE +51            05970000
060600                                             COMP.                05980000
060700         10  FILLER              PIC  X(12)  VALUE 'NOPASSBKWR'.  05990000
060800         10  FILLER              PIC S9(08)  VALUE +53            06000000
060900                                             COMP.                06010000
061000         10  FILLER              PIC  X(12)  VALUE 'SYSIDERR'.    06020000
061100         10  FILLER              PIC S9(08)  VALUE +54            06030000
061200                                             COMP.                06040000
061300         10  FILLER              PIC  X(12)  VALUE 'ISCINVREQ'.   06050000
061400         10  FILLER              PIC S9(08)  VALUE +55            06060000
061500                                             COMP.                06070000
061600         10  FILLER              PIC  X(12)  VALUE 'ENQBUSY'.     06080000
061700         10  FILLER              PIC S9(08)  VALUE +56            06090000
061800                                             COMP.                06100000
061900         10  FILLER              PIC  X(12)  VALUE 'ENVDEFERR'.   06110000
062000         10  FILLER              PIC S9(08)  VALUE +57            06120000
062100                                             COMP.                06130000
062200         10  FILLER              PIC  X(12)  VALUE 'IGREQCD'.     06140000
062300         10  FILLER              PIC S9(08)  VALUE +58            06150000
062400                                             COMP.                06160000
062500         10  FILLER              PIC  X(12)  VALUE 'SESSIONERR'.  06170000
062600         10  FILLER              PIC S9(08)  VALUE +59            06180000
062700                                             COMP.                06190000
062800         10  FILLER              PIC  X(12)  VALUE 'SYSBUSY'.     06200000
062900         10  FILLER              PIC S9(08)  VALUE +60            06210000
063000                                             COMP.                06220000
063100         10  FILLER              PIC  X(12)  VALUE 'SESSBUSY'.    06230000
063200         10  FILLER              PIC S9(08)  VALUE +61            06240000
063300                                             COMP.                06250000
063400         10  FILLER              PIC  X(12)  VALUE 'NOTALLOC'.    06260000
063500         10  FILLER              PIC S9(08)  VALUE +62            06270000
063600                                             COMP.                06280000
063700         10  FILLER              PIC  X(12)  VALUE 'CBIDERR'.     06290000
063800         10  FILLER              PIC S9(08)  VALUE +64            06300000
063900                                             COMP.                06310000
064000         10  FILLER              PIC  X(12)  VALUE 'INVPARTNSET '.06320000
064100         10  FILLER              PIC S9(08)  VALUE +65            06330000
064200                                             COMP.                06340000
064300         10  FILLER              PIC  X(12)  VALUE 'INVPARTN    '.06350000
064400         10  FILLER              PIC S9(08)  VALUE +66            06360000
064500                                             COMP.                06370000
064600         10  FILLER              PIC  X(12)  VALUE 'PARTNFAIL   '.06380000
064700         10  FILLER              PIC S9(08)  VALUE +70            06390000
064800                                             COMP.                06400000
064900         10  FILLER              PIC  X(12)  VALUE 'NOTAUTH'.     06410000
065000         10  FILLER              PIC S9(08)  VALUE +80            06420000
065100                                             COMP.                06430000
065200         10  FILLER              PIC  X(12)  VALUE 'NOSPOOL'.     06440000
065300         10  FILLER              PIC S9(08)  VALUE +81            06450000
065400                                             COMP.                06460000
065500         10  FILLER              PIC  X(12)  VALUE 'TERMERR'.     06470000
065600         10  FILLER              PIC S9(08)  VALUE +82            06480000
065700                                             COMP.                06490000
065800         10  FILLER              PIC  X(12)  VALUE 'ROLLEDBACK  '.06500000
065900         10  FILLER              PIC S9(08)  VALUE +83            06510000
066000                                             COMP.                06520000
066100         10  FILLER              PIC  X(12)  VALUE 'END'.         06530000
066200         10  FILLER              PIC S9(08)  VALUE +84            06540000
066300                                             COMP.                06550000
066400         10  FILLER              PIC  X(12)  VALUE 'DISABLED    '.06560000
066500         10  FILLER              PIC S9(08)  VALUE +85            06570000
066600                                             COMP.                06580000
066700         10  FILLER              PIC  X(12)  VALUE 'ALLOCERR    '.06590000
066800         10  FILLER              PIC S9(08)  VALUE +86            06600000
066900                                             COMP.                06610000
067000         10  FILLER              PIC  X(12)  VALUE 'STRELERR    '.06620000
067100         10  FILLER              PIC S9(08)  VALUE +87            06630000
067200                                             COMP.                06640000
067300         10  FILLER              PIC  X(12)  VALUE 'OPENERR'.     06650000
067400         10  FILLER              PIC S9(08)  VALUE +88            06660000
067500                                             COMP.                06670000
067600         10  FILLER              PIC  X(12)  VALUE 'SPOLBUSY    '.06680000
067700         10  FILLER              PIC S9(08)  VALUE +89            06690000
067800                                             COMP.                06700000
067900         10  FILLER              PIC  X(12)  VALUE 'SPOLERR'.     06710000
068000         10  FILLER              PIC S9(08)  VALUE +90            06720000
068100                                             COMP.                06730000
068200         10  FILLER              PIC  X(12)  VALUE 'NODEIDER    '.06740000
068300     05  EC-EIBRESP-ENTRY        REDEFINES EC-EIBRESP-ENTRIES     06750000
068400                                 OCCURS 77 TIMES                  06760000
068500                                 ASCENDING KEY EC-EIBRESP         06770000
068600                                 INDEXED BY EC-RESP-IDX.          06780000
068700         10  EC-EIBRESP          PIC S9(08)  COMP.                06790000
068800         10  EC-CONDITION-NAME   PIC  X(12).                      06800000
068900*                                                                 06810000
069000* COMMUNICATIONS AREA FOR DB2                                     06820000
069100     EXEC SQL                                                     06830000
069200         INCLUDE SQLCA                                            06840000
069300     END-EXEC.                                                    06850000
069400*                                                                 06860000
069500******************************************************************06870000
069600 LINKAGE SECTION.                                                 06880000
069700******************************************************************06890000
069800 01  DFHCOMMAREA.                                                 06900000
069900     05  FILLER                         OCCURS  1 TO 4072 TIMES   06910000
070000                                        DEPENDING ON EIBCALEN.    06920000
070100         10  FILLER                     PIC X.                    06930000
070200                                                                  06940000
070300******************************************************************06950000
070400 PROCEDURE DIVISION.                                              06960000
070500******************************************************************06970000
070600 0000-PROGRAM-MAINLINE.                                           06980000
070700     MOVE DFHCOMMAREA                TO CA-COMMAREA.              06990000
070800     MOVE LOW-VALUES                 TO PC871AI.                  07000000
070900     MOVE 'PRESS ENTER TO CONT'      TO AMSG8O                    07010000
071000                                                                  07020000
071100     EVALUATE TRUE                                                07030000
071200         WHEN PC233-XCTL                                          07040000
071300             PERFORM 2200-XCTL-TO-MAIN-MENU                       07050000
071400                                                                  07060000
071500         WHEN PC233-ABEND                                         07070000
071600             PERFORM 3000-ABEND-SCREEN                            07080000
071700             PERFORM 3500-LOG-ABEND-INFO                          07090000
071800             MOVE 3                   TO PC233-PGM-MSG-NBR        07100000
071900             MOVE PC233-TRAN-ID       TO PC235-ERROR-TRANID       07110000
072000             MOVE PC233-ERROR-NBR     TO PC235-ERROR-NBR          07120000
072100             PERFORM 1000-SETUP-SCREEN                            07130000
072200                                                                  07140000
072300             PERFORM 8400-ROLLBACK                                07150000
072400             SET PC233-XCTL           TO TRUE                     07160000
072500             PERFORM 8000-SEND-MAP                                07170000
072600             PERFORM 8200-RETURN-TRANID                           07180000
072700                                                                  07190000
072800         WHEN EIBCALEN = ZERO                                     07200000
072900         WHEN EIBAID = DFHCLEAR                                   07210000
073000         WHEN PC233-INITIALIZE-SCREEN                             07220000
073100         WHEN PC233-WAIT-FOR-CONFIRM                              07230000
073200         WHEN PC233-CONFIRM-TRAILER-SEAL                          07240000
073300             SET PC233-PROCESS-SCREEN  TO  TRUE                   07250000
073400             PERFORM 1000-SETUP-SCREEN                            07260000
073500             PERFORM 8000-SEND-MAP                                07270000
073600             PERFORM 8200-RETURN-TRANID                           07280000
073700                                                                  07290000
073800         WHEN EIBTRNID = 'Z278'                                   07300000
073900*        GENERIC HELP SCREEN                                      07310000
074000             MOVE DFHCOMMAREA          TO PC192-COMMAREA          07320000
074100             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             07330000
074200             MOVE PC192-HOST-SAVE-MAP  TO PC871AO                 07340000
074300             SET PC233-PROCESS-SCREEN  TO  TRUE                   07350000
074400             PERFORM 8000-SEND-MAP                                07360000
074500             PERFORM 8200-RETURN-TRANID                           07370000
074600                                                                  07380000
074700                                                                  07390000
074800         WHEN EIBAID = DFHPF2                                     07400000
074900             EVALUATE PC233-PGM-MSG-NBR                           07410000
075000             WHEN 8                                               07420000
075100*               CONFIRM NO STARTING CARTON                        07430000
075200                 SET PC233-INITIALIZE-SCREEN                      07440000
075300                                      TO TRUE                     07450000
075400                 MOVE PC233-MENU-PROGRAM                          07460000
075500                                      TO PV-TRANSFER-PROGRAM      07470000
075600                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            07480000
075700             WHEN 10                                              07490000
075800*               CONFIRM NO RECORD OF CARTONS ON DIVERTER LINE     07500000
075900                 SET PC233-INITIALIZE-SCREEN                      07510000
076000                                      TO TRUE                     07520000
076100                 MOVE PC233-NEXT-PROGRAM                          07530000
076200                                      TO PV-TRANSFER-PROGRAM      07540000
076300                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            07550000
076400             WHEN 23                                              07560000
076500*               XCTL TO OPEN FOR AUDIT PROGRAM                    07570000
076600                 SET PC233-INITIALIZE-SCREEN                      07580000
076700*                    PC233-INVLD-CLSD-STAT-AUD                    07590000
076800                                      TO TRUE                     07600000
076900                 MOVE PC-OPEN-FOR-AUDIT-PROGRAM                   07610000
077000                                      TO PV-TRANSFER-PROGRAM      07620000
077100                 MOVE PC233-HOST-SAVE-AREA                        07630000
077200                                      TO PC045-COMMAREA-REC       07640000
077300                 SET PC045-AUDIT-CREATE                           07650000
077400                                      TO TRUE                     07660000
077500                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            07670000
077600             WHEN 24                                              07680000
077700*               XCTL TO CLOSE TRAILER PROGRAM                     07690000
077800                 SET PC233-INITIALIZE-SCREEN                      07700000
077900                                      TO TRUE                     07710000
078000                 MOVE PC-CLOSE-TRAILER-PROGRAM                    07720000
078100                                      TO PV-TRANSFER-PROGRAM      07730000
078200                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            07740000
078300             WHEN 30                                              07750000
078400*               SET SWITCHES FOR PCKRF894                         07760000
078500                 MOVE PC233-HOST-SAVE-AREA                        07770000
078600                                      TO PC045-COMMAREA-REC       07780000
078700                 SET PC045-DUPLICATE-ADD                          07790000
078800                                      TO TRUE                     07800000
078900                 MOVE PC233-LAST-PROGRAM                          07810000
079000                                      TO PV-TRANSFER-PROGRAM      07820000
079100                 SET PC233-INITIALIZE-SCREEN                      07830000
079200                                      TO TRUE                     07840000
079300                 MOVE PC045-COMMAREA-REC                          07850000
079400                                      TO PC233-HOST-SAVE-AREA     07860000
079500                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            07870000
079600             WHEN 40                                              07880000
079700             WHEN 44                                              07890000
079800*               SET SWITCHES FOR PCKRF876                         07900000
079900*               MSG 44 IS THE SEASONAL SET WARNING                07910000
080000                 SET PC233-UPDATE-CONFIRMED                       07920000
080100                                      TO TRUE                     07930000
080200                 MOVE PC233-LAST-PROGRAM                          07940000
080300                                      TO PV-TRANSFER-PROGRAM      07950000
080400                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            07960000
080500             WHEN 41                                              07970000
080600*               SET SWITCHES FOR PCKRF876                         07980000
080700                 SET PC233-UPDATE-CONFIRMED                       07990000
080800                                      TO TRUE                     08000000
080900                 MOVE PC233-LAST-PROGRAM                          08010000
081000                                      TO PV-TRANSFER-PROGRAM      08020000
081100                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08030000
081200             END-EVALUATE                                         08040000
081300                                                                  08050000
081400         WHEN EIBAID = DFHPF3                                     08060000
081500             EVALUATE TRUE                                        08070000
081600             WHEN PC233-PGM-MSG-NBR = 8                           08080000
081700*               CONFIRM NO STARTING CARTON                        08090000
081800                SET PC233-INITIALIZE-SCREEN                       08100000
081900                                        TO TRUE                   08110000
082000                 MOVE PC233-MENU-PROGRAM                          08120000
082100                                      TO PV-TRANSFER-PROGRAM      08130000
082200                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08140000
082300             WHEN PC233-PGM-MSG-NBR = 30                          08150000
082400                 MOVE 'UNRECOGNIZED PF KEY' TO AMSG8O             08160000
082500             WHEN PC233-PGM-MSG-NBR = 32                          08170000
082600*               RETURN TO RE-ENTER SEAL NBR (PCKRF875)            08180000
082700                SET PC233-INITIALIZE-SCREEN                       08190000
082800                                        TO TRUE                   08200000
082900                 MOVE PC233-LAST-PROGRAM                          08210000
083000                                      TO PV-TRANSFER-PROGRAM      08220000
083100                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08230000
083200             WHEN PC233-PGM-MSG-NBR = 40                          08240000
083300*               SET SWITCHES FOR PCKRF876                         08250000
083400                 SET PC233-ABEND      TO TRUE                     08260000
083500                 MOVE PC233-MENU-PROGRAM                          08270000
083600                                      TO PV-TRANSFER-PROGRAM      08280000
083610                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08290000
083611             WHEN PC233-PGM-MSG-NBR = 41                          08300000
083612*               SET SWITCHES FOR PCKRF876                         08310000
083613                 SET PC233-ABEND      TO TRUE                     08320000
083614                 MOVE PC233-MENU-PROGRAM                          08330000
083615                                      TO PV-TRANSFER-PROGRAM      08340000
083616                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08350000
083617             WHEN OTHER                                           08360000
083618                SET PC233-INITIALIZE-SCREEN                       08361000
083619                                        TO TRUE                   08361100
083620                PERFORM 2400-XCTL-TO-ROOT-SCREEN                  08361200
083630             END-EVALUATE                                         08361300
083640                                                                  08361400
083650         WHEN EIBAID = DFHPF4                                     08361500
083660             EVALUATE TRUE                                        08361600
083670             WHEN PC233-REOPEN-CARTON                             08361700
083680                 SET PC233-INITIALIZE-SCREEN                      08361800
083690                                         TO TRUE                  08361900
083700                 PERFORM 2300-XCTL-TO-NEXT-SCREEN                 08362000
083800             WHEN PC233-PGM-MSG-NBR = 16 OR 17                    08363000
083900                 SET PC233-UPDATE-CONFIRMED                       08364000
084000                                         TO TRUE                  08365000
084100                 MOVE PC233-LAST-PROGRAM                          08366000
084200                                      TO PV-TRANSFER-PROGRAM      08367000
084300                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08368000
084400             WHEN PC233-PGM-MSG-NBR = 30                          08369000
084500*               SET SWITCHES FOR PCKRF894                         08370000
084600                 MOVE PC233-HOST-SAVE-AREA                        08380000
084700                                      TO PC045-COMMAREA-REC       08390000
084800                 SET PC045-DUPLICATE-IGNORE                       08400000
084900                                         TO TRUE                  08410000
085000                 MOVE PC233-LAST-PROGRAM                          08420000
085100                                      TO PV-TRANSFER-PROGRAM      08430000
085200                 SET PC233-INITIALIZE-SCREEN                      08440000
085300                                      TO TRUE                     08450000
085400                 MOVE PC045-COMMAREA-REC                          08460000
085500                                      TO PC233-HOST-SAVE-AREA     08470000
085600                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08480000
085700             WHEN OTHER                                           08490000
085800                 SET PC233-INITIALIZE-SCREEN                      08500000
085900                                         TO TRUE                  08510000
086000                 PERFORM 2400-XCTL-TO-ROOT-SCREEN                 08520000
086100             END-EVALUATE                                         08530000
086200                                                                  08540000
086300         WHEN EIBAID = DFHENTER                                   08550000
086400             EVALUATE TRUE                                        08560000
086500             WHEN PC233-PGM-MSG-NBR = 1                           08570000
086600*                SOFT ABORT LOGIC                                 08580000
086700                 SET PC233-INITIALIZE-SCREEN TO TRUE              08590000
086800                 MOVE PC233-LAST-PROGRAM  TO PV-TRANSFER-PROGRAM  08600000
086900                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08610000
087000             WHEN PC233-PGM-MSG-NBR = 30                          08620000
087100                 MOVE 'UNRECOGNIZED PF KEY' TO AMSG8O             08630000
087200             WHEN PC233-PGM-MSG-NBR = 32                          08640000
087300*                CONFIRM UPDATE OF SEAL NBR                       08650000
087400                 SET PC233-UPDATE-CONFIRMED                       08660000
087500                                      TO TRUE                     08670000
087600                 MOVE PC233-LAST-PROGRAM                          08680000
087700                                      TO PV-TRANSFER-PROGRAM      08690000
087800                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08700000
087900             WHEN PC233-PGM-MSG-NBR = 10                          08710000
088000*                CONFIRM NO LOG OF CARTON ON DIVERTER             08720000
088100                SET PC233-INITIALIZE-SCREEN                       08730000
088200                                        TO TRUE                   08740000
088300                PERFORM 2400-XCTL-TO-ROOT-SCREEN                  08750000
088400             WHEN PC233-PGM-MSG-NBR = 15                          08760000
088500*                CONFIRM NO LOG OF CARTON ON DIVERTER             08770000
088600                SET PC233-INITIALIZE-SCREEN                       08780000
088700                                        TO TRUE                   08790000
088800                PERFORM 2400-XCTL-TO-ROOT-SCREEN                  08800000
088900             WHEN PC233-PGM-MSG-NBR = 33                          08810000
089000*                RETURN TO ORIGINAL SCREEN                        08820000
089100                 SET PC233-INITIALIZE-SCREEN                      08830000
089200                                      TO TRUE                     08840000
089300                 MOVE PC233-LAST-PROGRAM                          08850000
089400                                      TO PV-TRANSFER-PROGRAM      08860000
089500                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08870000
089600             WHEN OTHER                                           08880000
089700                 SET PC233-INITIALIZE-SCREEN TO TRUE              08890000
089800                 MOVE PC233-LAST-PROGRAM                          08900000
089900                                      TO PV-TRANSFER-PROGRAM      08910000
090000                 PERFORM 2100-XCTL-TO-SELECTED-PROGRAM            08920000
090100             END-EVALUATE                                         08930000
090200                                                                  08940000
090300         WHEN EIBAID = DFHPF1                                     08950000
090400             MOVE PC233-PGM-MSG-NBR   TO PV-TEXT-MSG-NBR          08960000
090500             MOVE PC233-LAST-PROGRAM  TO PV-TEXT-LAST-PGM         08970000
090600             MOVE PC233-ROOT-PROGRAM  TO PV-TEXT-ROOT-PGM         08980000
090700             MOVE PC233-MENU-PROGRAM  TO PV-TEXT-MENU-PGM         08990000
090800             MOVE PC233-NEXT-PROGRAM  TO PV-NEXT-MENU-PGM         09000000
090900             MOVE PC-NEW-LINE         TO PV-NEW-LINE-1            09010000
091000                                         PV-NEW-LINE-2            09020000
091100                                         PV-NEW-LINE-3            09030000
091200                                         PV-NEW-LINE-4            09040000
091300                                         PV-NEW-LINE-5            09050000
091400                                         PV-NEW-LINE-6            09060000
091500                                         PV-NEW-LINE-7            09070000
091600             PERFORM 8030-SEND-TEXT                               09080000
091700             PERFORM 8200-RETURN-TRANID                           09090000
091800                                                                  09100000
091900         WHEN OTHER                                               09110000
092000             MOVE 'UNRECOGNIZED PF KEY' TO AMSG8O                 09120000
092100     END-EVALUATE.                                                09130000
092200                                                                  09140000
092300     PERFORM 8100-SEND-DATA-ONLY.                                 09150000
092400     PERFORM 8200-RETURN-TRANID.                                  09160000
092500                                                                  09170000
092600     GOBACK.                                                      09180000
092700****************************************************************  09190000
092800* 1000-SETUP-SCREEN                                               09200000
092900*    INITIAL SETUP OF AUDIT NUMBER AND STATUS                     09210000
093000****************************************************************  09220000
093100 1000-SETUP-SCREEN.                                               09230000
093200                                                                  09240000
093300     EVALUATE TRUE                                                09250000
093400       WHEN EIBTRNID = 'E870'                                     09260000
093500         SET PC233-REOPEN-CARTON      TO TRUE                     09270000
093600       WHEN EIBTRNID = 'E892'                                     09280000
093700         MOVE PC233-HOST-SAVE-AREA    TO PC045-COMMAREA-REC       09290000
093800         MOVE PC045-TRLR-SRL-NBR-X    TO PC235-SERIAL-23          09300000
093900                                         PC235-SERIAL-21          09310000
094000                                         PC235-SERIAL-4           09320000
094100                                         PC235-SERIAL-22          09330000
094200         MOVE PC045-AUDIT-CNTL-NBR    TO PC235-AUDIT-21           09340000
094300         MOVE PC233-TRAILER-STATUS    TO                          09350000
094400                                         PC233-ERROR-TRLR-STATUS  09360000
094500       WHEN EIBTRNID = 'E894'                                     09370000
094600         MOVE PC233-HOST-SAVE-AREA    TO PC045-COMMAREA-REC       09380000
094700         MOVE PC045-SHIP-UNIT-NBR-X   TO PC235-SML-30             09390000
094800         MOVE PC045-TRLR-SRL-NBR-X    TO PC235-SERIAL-30          09400000
094900                                         PC235-SERIAL-4           09410000
095000         MOVE PC045-AUDIT-CNTL-NBR    TO PC235-AUDIT-30           09420000
095100         PERFORM 1105-SELECT-DATE-TIME                            09430000
095200         STRING PV-DATE(1:6) PV-DATE(9:2) DELIMITED BY            09440000
095300                                          SIZE                    09450000
095400                                    INTO PC235-CURR-DATE-30       09460000
095500         MOVE PV-TIME                 TO PC235-CURR-TIME-30       09470000
095600         MOVE PC045-SCN-TMST          TO PV-TIMESTAMP             09480000
095700         PERFORM 1106-EXTRACT-DATE-TIME                           09490000
095800         STRING PV-DATE(1:6) PV-DATE(9:2) DELIMITED BY            09500000
095900                                          SIZE                    09510000
096000                                    INTO PC235-PREV-DATE-30       09520000
096100         MOVE PV-TIME                 TO PC235-PREV-TIME-30       09530000
096200     END-EVALUATE                                                 09540000
096300                                                                  09550000
096400*    MOVE APPROPRIATE MESSAGE TO THE SCREEN                       09560000
096500     SET PC235-IDX                    TO PC233-PGM-MSG-NBR.       09570000
096600*                                                                 09580000
096700     MOVE PC233-CARTON                TO PC235-SML-14             09590000
096800                                         PC235-SML-15             09600000
096900                                         PC235-SML-16             09610000
097000                                         PC235-SML-17             09620000
097100                                         PC235-SML-18             09630000
097200                                         PC235-SML-19             09640000
097300                                         PC235-SML-33             09650000
097400                                                                  09660000
097500     MOVE PC233-ERROR-MSTR-CARTON     TO PC235-SML-MASTER-17      09670000
097600                                                                  09680000
097700     MOVE PC233-ERROR-SCAC-ID         TO PC235-SCAC-4             09690000
097800                                         PC235-SCAC-5             09700000
097900                                         PC235-SCAC-7             09710000
098000                                         PC235-SCAC-10            09720000
098100                                         PC235-SCAC-12            09730000
098200                                         PC235-SCAC-14            09740000
098300                                         PC235-SCAC-37            09750000
098400                                                                  09760000
098500     MOVE PC233-ERROR-TRLR-ID         TO PC235-TRAILER-4          09770000
098600                                         PC235-TRAILER-5          09780000
098700                                         PC235-TRAILER-7          09790000
098800                                         PC235-TRAILER-10         09800000
098900                                         PC235-TRAILER-12         09810000
099000                                         PC235-TRAILER-14         09820000
099100                                         PC235-TRAILER-37         09830000
099200                                                                  09840000
099300     MOVE PC233-ERROR-DOOR-NBR        TO PC235-DOOR-4             09850000
099400                                         PC235-DOOR-5             09860000
099500                                         PC235-DOOR-6             09870000
099600                                         PC235-DOOR-37            09880000
099700                                         PC235-DOOR-48            09890000
099800                                                                  09900000
099900     MOVE PC233-ERROR-TRIP-ID         TO PC235-TRIP-4             09910000
100000                                         PC235-TRIP-5             09920000
100100                                         PC235-TRIP-7             09930000
100200                                         PC235-TRIP-10            09940000
100300                                         PC235-TRIP-14            09950000
100400                                         PC235-TRIP-37            09960000
100500                                                                  09970000
100600     MOVE PC233-ERROR-SRL-NBR         TO PC235-SERIAL-4           09980000
100700                                         PC235-SERIAL-7           09990000
100800                                         PC235-SERIAL-12          10000000
100900                                         PC235-SERIAL-15          10010000
101000                                         PC235-SERIAL-20          10020000
101100                                         PC235-SERIAL-37          10030000
101200                                         PC235-SERIAL-45          10040000
101300                                         PC235-SERIAL-48          10050000
101400                                                                  10060000
101500     MOVE PC233-ERROR-STR-NBR         TO PC235-STORE-6            10070000
101600                                         PC235-STORE-45           10080000
101700     MOVE PC233-ERROR-STR-NBR         TO PC235-STORE-37           10090000
101800     MOVE PC233-ERROR-TRLR-STR-NBR    TO PC235-STORE-15B          10100000
101900                                         PC235-TRLR-STR-27        10110000
102000     MOVE PC233-ERROR-CTN-STR-NBR     TO PC235-STORE-15A          10120000
102100                                         PC235-CTN-STR-27         10130000
102200                                                                  10140000
102300     MOVE PC233-ERROR-TRLR-STATUS     TO PC235-STATUS-12          10150000
102400                                         PC235-STATUS-20          10160000
102500                                         PC235-STATUS-22          10170000
102600     MOVE PC233-ERROR-KID-COUNT       TO PC235-CHILD-COUNT        10180000
102700     MOVE PC233-SEAL-ID               TO PC235-SEAL-32            10190000
102800     MOVE PC045-AUDIT-CNTL-NBR        TO PC235-AUDIT-21           10200000
102900     EVALUATE TRUE                                                10210000
103000     WHEN PC045-100-AUDIT-CHECK                                   10220000
103100         MOVE '100%'                  TO PC235-AUDIT-TYPE-21      10230000
103200     WHEN PC045-SPOT-AUDIT-CHECK                                  10240000
103300         MOVE 'SPOT'                  TO PC235-AUDIT-TYPE-21      10250000
103400     END-EVALUATE                                                 10260000
103500                                                                  10270000
103600     IF PC233-TOT-CARTONS NOT NUMERIC                             10280000
103700         MOVE ZEROES                  TO PC233-TOT-CARTONS        10290000
103800     END-IF                                                       10300000
103900     IF PC233-TOT-ERROR-CARTONS NOT NUMERIC                       10310000
104000         MOVE ZEROES                  TO PC233-TOT-ERROR-CARTONS  10320000
104100     END-IF                                                       10330000
104200     MOVE PC233-TOT-CARTONS           TO PC235-CTN-CNT-37         10340000
104300     MOVE PC233-TOT-ERROR-CARTONS     TO PC235-ERR-CNT-37         10350000
104400     MOVE PC233-RETURN-MSG            TO PC235-ERROR-37           10360000
104500     STRING '    '                                                10370000
104600          PC233-SEASET-STR-RLSE-BEG-DTE                           10380000
104700            '     '                                               10390000
104701          DELIMITED BY SIZE         INTO PC235-RELEASE-DATE-44    10400000
104702*                                                                 10410000
104704     MOVE PC233-ERROR-DIVERT-DATE     TO PV-MSG34-DATE            10420000
104705     MOVE ' @ '                       TO PV-MSG34-AT              10430000
104706     MOVE PC233-ERROR-DIVERT-TIME     TO PV-MSG34-TIME            10440000
104707     MOVE PC233-ERROR-DIVERT-SML      TO PC235-SML-34             10450000
104708     MOVE PV-MSG34-DATE-TIME          TO PC235-DATE-TIME-34       10460000
104709                                                                  10470000
104710*    MOVE PC233-SQLCODE               TO PC235-SQLCODE            10471000
104711*    MOVE PC233-PARAGRAPH             TO PC235-PARAGRAPH          10471100
104712*    MOVE PC233-LAST-PROGRAM          TO PC235-PROGRAM            10471200
104713                                                                  10471300
104714                                                                  10471400
104715                                                                  10471500
104716     MOVE PC235-LINE-1 (PC235-IDX)    TO AMSG1O.                  10471600
104720     MOVE PC235-LINE-2 (PC235-IDX)    TO AMSG2O.                  10471700
104730     MOVE PC235-LINE-3 (PC235-IDX)    TO AMSG3O.                  10471800
104740     MOVE PC235-LINE-4 (PC235-IDX)    TO AMSG4O.                  10471900
104750     MOVE PC235-LINE-5 (PC235-IDX)    TO AMSG5O.                  10472000
104760     MOVE PC235-LINE-6 (PC235-IDX)    TO AMSG6O.                  10473000
104770     MOVE PC235-LINE-7 (PC235-IDX)    TO AMSG7O.                  10474000
104780     MOVE PC235-LINE-8 (PC235-IDX)    TO AMSG8O.                  10475000
104790                                                                  10476000
104800 1105-SELECT-DATE-TIME.                                           10477000
104900     EXEC SQL                                                     10478000
105000         SELECT                                                   10479000
105100             CHAR(DATE(CURRENT TIMESTAMP),USA)                    10480000
105200         ,   CHAR(TIME(CURRENT TIMESTAMP),ISO)                    10490000
105300         INTO                                                     10500000
105400             :PV-DATE                                             10510000
105500           , :PV-TIME                                             10520000
105600         FROM SYSIBM.SYSDUMMY1                                    10530000
105700     END-EXEC.                                                    10540000
105800 1106-EXTRACT-DATE-TIME.                                          10550000
105900     EXEC SQL                                                     10560000
106000         SELECT                                                   10570000
106100             CHAR(DATE(:PV-TIMESTAMP),USA)                        10580000
106200         ,   CHAR(TIME(:PV-TIMESTAMP),ISO)                        10590000
106300         INTO                                                     10600000
106400             :PV-DATE                                             10610000
106500           , :PV-TIME                                             10620000
106600         FROM SYSIBM.SYSDUMMY1                                    10630000
106700     END-EXEC.                                                    10640000
106800                                                                  10650000
106900 1200-HELP-SCREEN.                                                10660000
107000     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      10670000
107100     MOVE 'PCKRF871'                  TO PC192-PROGRAM-NAME       10680000
107200     COPY PCPD188.                                                10690000
107300     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      10700000
107400     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     10710000
107500     PERFORM 8300-XCTL-TO-HELP.                                   10720000
107600                                                                  10730000
107700 2100-XCTL-TO-SELECTED-PROGRAM.                                   10740000
107800                                                                  10750000
107900     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      10760000
108000                                                                  10770000
108100     EXEC CICS                                                    10780000
108200         XCTL                                                     10790000
108300             PROGRAM   (PV-TRANSFER-PROGRAM)                      10800000
108400             COMMAREA  (CA-COMMAREA)                              10810000
108500             LENGTH    (PV-COMMAREA-LENGTH)                       10820000
108600             RESP      (PV-CICS-RESPONSE)                         10830000
108700     END-EXEC.                                                    10840000
108800                                                                  10850000
108900     EVALUATE TRUE                                                10860000
109000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10870000
109100              CONTINUE                                            10880000
109200         WHEN OTHER                                               10890000
109300              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                10900000
109400                                      TO DP013-PARAGRAPH          10910000
109500              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       10920000
109600                                      TO DP013-MESSAGE-TEXT (1)   10930000
109700              MOVE PC233-LAST-PROGRAM TO DP013-MESSAGE-TEXT (2)   10940000
109800              SET DP013-CICS-ABEND    TO TRUE                     10950000
109900              SET DP013-NO-ROLLBACK   TO TRUE                     10960000
110000              PERFORM 9999-WRITE-CICS-LOG-MSG                     10970000
110100              MOVE 'TRANS NOT AVAILABLE'                          10980000
110200                                      TO AMSG8O                   10990000
110300              SET PC233-PROCESS-SCREEN TO TRUE                    11000000
110400              PERFORM 8100-SEND-DATA-ONLY                         11010000
110500              PERFORM 8200-RETURN-TRANID                          11020000
110600     END-EVALUATE.                                                11030000
110700                                                                  11040000
110800 2200-XCTL-TO-MAIN-MENU.                                          11050000
110900                                                                  11060000
111000     EXEC CICS                                                    11070000
111100         XCTL                                                     11080000
111200             PROGRAM   ('MPKCS027')                               11090000
111300             RESP      (PV-CICS-RESPONSE)                         11100000
111400     END-EXEC.                                                    11110000
111500                                                                  11120000
111600     EVALUATE TRUE                                                11130000
111700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11140000
111800              CONTINUE                                            11150000
111900         WHEN OTHER                                               11160000
112000              MOVE '2200-XCTL-TO-MAIN-MENU'                       11170000
112100                                      TO DP013-PARAGRAPH          11180000
112200              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       11190000
112300                                      TO DP013-MESSAGE-TEXT (1)   11200000
112400              MOVE 'MPKCS027'         TO DP013-MESSAGE-TEXT (2)   11210000
112500              SET DP013-CICS-ABEND    TO TRUE                     11220000
112600              SET DP013-NO-ROLLBACK   TO TRUE                     11230000
112700              PERFORM 9999-WRITE-CICS-LOG-MSG                     11240000
112800              MOVE 'TRANS NOT AVAILABLE'                          11250000
112900                                      TO AMSG8O                   11260000
113000              SET PC233-PROCESS-SCREEN TO TRUE                    11270000
113100              PERFORM 8100-SEND-DATA-ONLY                         11280000
113200              PERFORM 8200-RETURN-TRANID                          11290000
113300     END-EVALUATE.                                                11300000
113400                                                                  11310000
113500 2300-XCTL-TO-NEXT-SCREEN.                                        11320000
113600                                                                  11330000
113700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      11340000
113800     MOVE 'PCKRF871'                  TO PC233-LAST-PROGRAM       11350000
113900                                                                  11360000
114000     EXEC CICS                                                    11370000
114100         XCTL                                                     11380000
114200             PROGRAM   (PC233-NEXT-PROGRAM)                       11390000
114300             COMMAREA  (CA-COMMAREA)                              11400000
114400             LENGTH    (PV-COMMAREA-LENGTH)                       11410000
114500             RESP      (PV-CICS-RESPONSE)                         11420000
114600     END-EXEC.                                                    11430000
114700                                                                  11440000
114800     EVALUATE TRUE                                                11450000
114900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11460000
115000              CONTINUE                                            11470000
115100         WHEN OTHER                                               11480000
115200              MOVE '2300-XCTL-TO-NEXT-SCREEN'                     11490000
115300                                      TO DP013-PARAGRAPH          11500000
115400              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       11510000
115500                                      TO DP013-MESSAGE-TEXT (1)   11520000
115600              MOVE PC233-NEXT-PROGRAM TO DP013-MESSAGE-TEXT (2)   11530000
115700              SET DP013-CICS-ABEND    TO TRUE                     11540000
115800              SET DP013-NO-ROLLBACK   TO TRUE                     11550000
115900              PERFORM 9999-WRITE-CICS-LOG-MSG                     11560000
116000              MOVE 'TRANS NOT AVAILABLE'                          11570000
116100                                      TO AMSG8O                   11580000
116200              SET PC233-PROCESS-SCREEN TO TRUE                    11590000
116300              PERFORM 8100-SEND-DATA-ONLY                         11600000
116400              PERFORM 8200-RETURN-TRANID                          11610000
116500     END-EVALUATE.                                                11620000
116600                                                                  11630000
116700 2400-XCTL-TO-ROOT-SCREEN.                                        11640000
116800                                                                  11650000
116900     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      11660000
117000                                                                  11670000
117100     EXEC CICS                                                    11680000
117200         XCTL                                                     11690000
117300             PROGRAM   (PC233-ROOT-PROGRAM)                       11700000
117400             COMMAREA  (CA-COMMAREA)                              11710000
117500             LENGTH    (PV-COMMAREA-LENGTH)                       11720000
117600             RESP      (PV-CICS-RESPONSE)                         11730000
117700     END-EXEC.                                                    11740000
117800                                                                  11750000
117900     EVALUATE TRUE                                                11760000
118000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11770000
118100              CONTINUE                                            11780000
118200         WHEN OTHER                                               11790000
118300              MOVE '2400-XCTL-TO-ROOT-SCREEN'                     11800000
118400                                      TO DP013-PARAGRAPH          11810000
118500              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       11820000
118600                                      TO DP013-MESSAGE-TEXT (1)   11830000
118700              MOVE PC233-ROOT-PROGRAM TO DP013-MESSAGE-TEXT (2)   11840000
118800              SET DP013-CICS-ABEND    TO TRUE                     11850000
118900              SET DP013-NO-ROLLBACK   TO TRUE                     11860000
119000              PERFORM 9999-WRITE-CICS-LOG-MSG                     11870000
119100              MOVE 'TRANS NOT AVAILABLE'                          11880000
119200                                      TO AMSG8O                   11890000
119300              SET PC233-PROCESS-SCREEN TO TRUE                    11900000
119400              PERFORM 8100-SEND-DATA-ONLY                         11910000
119500              PERFORM 8200-RETURN-TRANID                          11920000
119600     END-EVALUATE.                                                11930000
119700/                                                                 11940000
119800 3000-ABEND-SCREEN.                                               11950000
119900     PERFORM 3100-FORMAT-ABEND-INFO.                              11960000
120000                                                                  11970000
120100 3100-FORMAT-ABEND-INFO.                                          11980000
120200     INITIALIZE LT-LOG-LINE-TABLE.                                11990000
120300     MOVE EIBTRMID TO PV-LOG-TERMINAL.                            12000000
120400                                                                  12010000
120500     SET LT-IDX TO 1.                                             12020000
120600     PERFORM 3200-FORMAT-DB2.                                     12030000
120700                                                                  12040000
120800     MOVE PC233-DFHEIBLK           TO EIBM-EIBLK-MASK.            12050000
120900     PERFORM 3300-FORMAT-EIB.                                     12060000
121000*                                                                 12070000
121100 3200-FORMAT-DB2.                                                 12080000
121200     MOVE DL1-DB2-LINE-1      TO LT-ERROR-MESSAGE (LT-IDX).       12090000
121300     PERFORM 3210-FORMAT-COMMON-INFO.                             12100000
121400*                                                                 12110000
121500     PERFORM 5110-SET-LINE-INDEX.                                 12120000
121600     MOVE DL2-DB2-LINE-2      TO LT-ERROR-MESSAGE (LT-IDX).       12130000
121700     PERFORM 5110-SET-LINE-INDEX.                                 12140000
121800     STRING  PC233-DB2-TABLE-NAME (1) DELIMITED BY SPACE          12150000
121900             SPACE                    DELIMITED BY SIZE           12160000
122000             PC233-DB2-TABLE-NAME (2) DELIMITED BY SPACE          12170000
122100             SPACE                    DELIMITED BY SIZE           12180000
122200             PC233-DB2-TABLE-NAME (3) DELIMITED BY SPACE          12190000
122300             SPACE                    DELIMITED BY SIZE           12200000
122400             PC233-DB2-TABLE-NAME (4) DELIMITED BY SPACE          12210000
122500     INTO    LT-ERROR-MESSAGE (LT-IDX)                            12220000
122600     POINTER PV-STRING-POINTER.                                   12230000
122700*                                                                 12240000
122800     IF  PV-STRING-POINTER > PC-STRING-POINTER-MAX                12250000
122900         IF  PC233-DB2-TABLE-NAME (5) > SPACE                     12260000
123000             PERFORM 5110-SET-LINE-INDEX                          12270000
123100             MOVE PC233-DB2-TABLE-NAME (5)                        12280000
123200                              TO LT-ERROR-MESSAGE (LT-IDX)        12290000
123300         END-IF                                                   12300000
123400     ELSE                                                         12310000
123500         STRING  SPACE                    DELIMITED BY SIZE       12320000
123600                 PC233-DB2-TABLE-NAME (5) DELIMITED BY SPACE      12330000
123700         INTO    LT-ERROR-MESSAGE (LT-IDX)                        12340000
123800         POINTER PV-STRING-POINTER                                12350000
123900     END-IF.                                                      12360000
124000     PERFORM 3210-FORMAT-SQLCA.                                   12370000
124100*                                                                 12380000
124200*                                                                 12390000
124300 3210-FORMAT-SQLCA.                                               12400000
124400*                                                                 12410000
124500**   DISPLAY SQLCA INFORMATION IN A READABLE FORMAT               12420000
124600*                                                                 12430000
124700     CALL 'DSNTIAR' USING PC233-SQLCA                             12440000
124800                          FDB-FORMATTED-MESSAGE                   12450000
124900                          FDB-ERROR-LINE-LENGTH.                  12460000
125000*                                                                 12470000
125100     PERFORM                                                      12480000
125200         VARYING FDB-MSG-IDX                                      12490000
125300         FROM 1 BY 1                                              12500000
125400         UNTIL FDB-MSG-IDX > FDB-MAX-MESSAGE-LINES                12510000
125500             IF  FDB-MESSAGE-LINE (FDB-MSG-IDX) > SPACE           12520000
125600                 PERFORM 5110-SET-LINE-INDEX                      12530000
125700                 MOVE FDB-MESSAGE-LINE (FDB-MSG-IDX)              12540000
125800                                 TO LT-ERROR-MESSAGE (LT-IDX)     12550000
125900             END-IF                                               12560000
126000     END-PERFORM.                                                 12570000
126100*                                                                 12580000
126200 3210-FORMAT-COMMON-INFO.                                         12590000
126300     MOVE PC233-LAST-PROGRAM      TO AL1-PROGRAM.                 12600000
126400     MOVE PC233-PARAGRAPH         TO AL1-PARAGRAPH.               12610000
126500     SET LT-IDX UP BY 1.                                          12620000
126600     MOVE AL1-ABEND-LINE-1        TO LT-ERROR-MESSAGE (LT-IDX).   12630000
126700*                                                                 12640000
126800** EIBTRMID WILL BE LOW-VALUES FOR NON-TERMINALLY ATTACHED        12650000
126900** APPLICATIONS  SO DON'T TRY TO READ THE 'INFO' TS QUEUE.        12660000
127000*                                                                 12670000
127100     IF  EIBTRMID > SPACE                                         12680000
127200         PERFORM 3211-GET-USER-FROM-TS                            12690000
127300         MOVE DP026-USERID        TO AL2-USERID                   12700000
127400         MOVE DP026-NETNAME       TO AL2-NETNAME                  12710000
127500         MOVE DP026-LOCATION-NBR  TO AL2-LOCATION                 12720000
127600         SET LT-IDX UP BY 1                                       12730000
127700         MOVE AL2-ABEND-LINE-2    TO LT-ERROR-MESSAGE (LT-IDX)    12740000
127800     END-IF.                                                      12750000
127900*                                                                 12760000
128000     MOVE 'D'                     TO AL3-ABEND-TYPE.              12770000
128100     MOVE SPACE                   TO AL3-ABEND-CONTROL.           12780000
128200     MOVE SPACE                   TO AL3-ROLLBACK.                12790000
128300     SET LT-IDX UP BY 1.                                          12800000
128400     MOVE AL3-ABEND-LINE-3        TO LT-ERROR-MESSAGE (LT-IDX).   12810000
128500*                                                                 12820000
128600     IF  PC233-MESSAGE-TABLE = SPACE                              12830000
128700         CONTINUE                                                 12840000
128800     ELSE                                                         12850000
128900         SET LT-IDX UP BY 1                                       12860000
129000         MOVE AL4-ABEND-LINE-4    TO LT-ERROR-MESSAGE (LT-IDX)    12870000
129100         PERFORM                                                  12880000
129200             VARYING PV-MSG-SUB                                   12890000
129300             FROM 1 BY 1                                          12900000
129400             UNTIL PV-MSG-SUB > 4                                 12910000
129500                 IF  PC233-MESSAGE-TEXT (PV-MSG-SUB) > SPACE      12920000
129600                     SET LT-IDX UP BY 1                           12930000
129700                     MOVE PC233-MESSAGE-TEXT (PV-MSG-SUB)         12940000
129800                              TO LT-ERROR-MESSAGE (LT-IDX)        12950000
129900                 END-IF                                           12960000
130000         END-PERFORM                                              12970000
130100     END-IF.                                                      12980000
130200*                                                                 12990000
130300*                                                                 13000000
130400 3211-GET-USER-FROM-TS.                                           13010000
130500     MOVE EIBTRMID             TO TS-INFO-QUEUE-TERMINAL.         13020000
130600     MOVE SPACE                TO PV-SYSID.                       13030000
130700     EXEC CICS                                                    13040000
130800         INQUIRE                                                  13050000
130900             TRANSACTION  (PC-LOGON-TRAN)                         13060000
131000             REMOTESYSTEM (PV-SYSID)                              13070000
131100     END-EXEC.                                                    13080000
131200*                                                                 13090000
131300     IF  PV-SYSID = SPACE                                         13100000
131400         EXEC CICS                                                13110000
131500             READQ TS                                             13120000
131600                 QUEUE (TS-INFO-QUEUE-NAME)                       13130000
131700                 INTO  (DP026-SIGN-ON-INFO)                       13140000
131800                 ITEM  (PV-TS-ITEM)                               13150000
131900                 RESP  (PV-CICS-RESPONSE)                         13160000
132000         END-EXEC                                                 13170000
132100     ELSE                                                         13180000
132200         EXEC CICS                                                13190000
132300             READQ TS                                             13200000
132400                 QUEUE (TS-INFO-QUEUE-NAME)                       13210000
132500                 INTO  (DP026-SIGN-ON-INFO)                       13220000
132600                 ITEM  (PV-TS-ITEM)                               13230000
132700                 SYSID (PV-SYSID)                                 13240000
132800                 LENGTH(LENGTH OF DP026-SIGN-ON-INFO)             13250000
132900                 RESP  (PV-CICS-RESPONSE)                         13260000
133000         END-EXEC                                                 13270000
133100     END-IF.                                                      13280000
133200*                                                                 13290000
133300     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       13300000
133400         CONTINUE                                                 13310000
133500     ELSE                                                         13320000
133600         MOVE ALL '?'   TO DP026-USERID                           13330000
133700                           DP026-NETNAME                          13340000
133800         MOVE ZEROS     TO DP026-LOCATION-NBR                     13350000
133900     END-IF.                                                      13360000
134000*                                                                 13370000
134100*                                                                 13380000
134200 3300-FORMAT-EIB.                                                 13390000
134300     PERFORM 5110-SET-LINE-INDEX.                                 13400000
134400     MOVE EL1-EIB-LINE-1  TO LT-ERROR-MESSAGE (LT-IDX).           13410000
134500*                                                                 13420000
134600     MOVE EIBM-TIME       TO EL2-EIBTIME.                         13430000
134700     MOVE EIBM-DATE       TO EL2-EIBDATE.                         13440000
134800     PERFORM 5110-SET-LINE-INDEX.                                 13450000
134900     MOVE EL2-EIB-LINE-2  TO LT-ERROR-MESSAGE (LT-IDX).           13460000
135000*                                                                 13470000
135100     MOVE EIBM-TRNID      TO EL3-EIBTRNID.                        13480000
135200     MOVE EIBM-TASKN      TO EL3-EIBTASKN.                        13490000
135300     PERFORM 5110-SET-LINE-INDEX.                                 13500000
135400     MOVE EL3-EIB-LINE-3  TO LT-ERROR-MESSAGE (LT-IDX).           13510000
135500*                                                                 13520000
135600     MOVE EIBM-TRMID      TO EL4-EIBTRMID.                        13530000
135700     MOVE EIBM-CPOSN      TO EL4-EIBCPOSN.                        13540000
135800     PERFORM 5110-SET-LINE-INDEX.                                 13550000
135900     MOVE EL4-EIB-LINE-4  TO LT-ERROR-MESSAGE (LT-IDX).           13560000
136000*                                                                 13570000
136100     MOVE EIBM-CALEN      TO EL5-EIBCALEN.                        13580000
136200     MOVE EIBM-AID        TO EL5-EIBAID.                          13590000
136300     SET AC-AID-IDX TO 1.                                         13600000
136400     SEARCH AC-ATTENTION-ID-ENTRY                                 13610000
136500         AT END                                                   13620000
136600             MOVE ALL '?'            TO EL5-EIBAID-DESCRIPTION    13630000
136700         WHEN AC-EIBAID (AC-AID-IDX) = EIBM-AID                   13640000
136800             MOVE AC-AID-NAME (AC-AID-IDX)                        13650000
136900                                     TO EL5-EIBAID-DESCRIPTION    13660000
137000     END-SEARCH.                                                  13670000
137100     PERFORM 5110-SET-LINE-INDEX.                                 13680000
137200     MOVE EL5-EIB-LINE-5  TO LT-ERROR-MESSAGE (LT-IDX).           13690000
137300*                                                                 13700000
137400     MOVE EIBM-FN                    TO DP012-CONVERSION-FIELD.   13710000
137500     MOVE LENGTH OF EIBM-FN          TO DP012-LENGTH.             13720000
137600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13730000
137700     IF  DP012-CALL-SUCCESSFUL                                    13740000
137800         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBFN-HEX             13750000
137900     ELSE                                                         13760000
138000         MOVE ALL '?'                TO EL6-EIBFN-HEX             13770000
138100     END-IF.                                                      13780000
138200     MOVE EIBM-RCODE                 TO DP012-CONVERSION-FIELD.   13790000
138300     MOVE LENGTH OF EIBM-RCODE       TO DP012-LENGTH.             13800000
138400     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              13810000
138500     IF  DP012-CALL-SUCCESSFUL                                    13820000
138600         MOVE DP012-CONVERTED-FIELD  TO EL6-EIBRCODE-HEX          13830000
138700     ELSE                                                         13840000
138800         MOVE ALL '?'                TO EL6-EIBRCODE-HEX          13850000
138900     END-IF.                                                      13860000
139000     PERFORM 5110-SET-LINE-INDEX.                                 13870000
139100     MOVE EL6-EIB-LINE-6             TO LT-ERROR-MESSAGE (LT-IDX).13880000
139200*                                                                 13890000
139300     MOVE EIBM-RESP                  TO EL7-EIBRESP.              13900000
139400     SET EC-RESP-IDX TO 1.                                        13910000
139500     SEARCH EC-EIBRESP-ENTRY                                      13920000
139600         AT END                                                   13930000
139700             MOVE ALL '?'            TO EL7-EIBRESP-DESCRIPTION   13940000
139800         WHEN EC-EIBRESP (EC-RESP-IDX) = EIBM-RESP                13950000
139900             MOVE EC-CONDITION-NAME (EC-RESP-IDX)                 13960000
140000                                     TO EL7-EIBRESP-DESCRIPTION   13970000
140100     END-SEARCH.                                                  13980000
140200     MOVE EIBM-RESP2                 TO EL7-EIBRESP2.             13990000
140300     PERFORM 5110-SET-LINE-INDEX.                                 14000000
140400     MOVE EL7-EIB-LINE-7             TO LT-ERROR-MESSAGE (LT-IDX).14010000
140500*                                                                 14020000
140600     MOVE EIBM-DS                    TO EL8-EIBDS.                14030000
140700*                                                                 14040000
140800     MOVE EIBM-REQID                 TO DP012-CONVERSION-FIELD.   14050000
140900     MOVE LENGTH OF EIBM-REQID       TO DP012-LENGTH.             14060000
141000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14070000
141100     IF  DP012-CALL-SUCCESSFUL                                    14080000
141200         MOVE DP012-CONVERTED-FIELD  TO EL8-EIBREQID-HEX          14090000
141300     ELSE                                                         14100000
141400         MOVE ALL '?'                TO EL8-EIBREQID-HEX          14110000
141500     END-IF.                                                      14120000
141600     PERFORM 5110-SET-LINE-INDEX.                                 14130000
141700     MOVE EL8-EIB-LINE-8             TO LT-ERROR-MESSAGE (LT-IDX).14140000
141800*                                                                 14150000
141900     MOVE EIBM-RSRCE                 TO DP012-CONVERSION-FIELD.   14160000
142000     MOVE LENGTH OF EIBM-RSRCE       TO DP012-LENGTH.             14170000
142100     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14180000
142200     IF  DP012-CALL-SUCCESSFUL                                    14190000
142300         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBRSRCE-HEX          14200000
142400     ELSE                                                         14210000
142500         MOVE ALL '?'                TO EL9-EIBRSRCE-HEX          14220000
142600     END-IF.                                                      14230000
142700*                                                                 14240000
142800     MOVE EIBM-EOC                   TO DP012-CONVERSION-FIELD.   14250000
142900     MOVE LENGTH OF EIBM-EOC         TO DP012-LENGTH.             14260000
143000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14270000
143100     IF  DP012-CALL-SUCCESSFUL                                    14280000
143200         MOVE DP012-CONVERTED-FIELD  TO EL9-EIBEOC-HEX            14290000
143300     ELSE                                                         14300000
143400         MOVE ALL '?'                TO EL9-EIBEOC-HEX            14310000
143500     END-IF.                                                      14320000
143600     PERFORM 5110-SET-LINE-INDEX.                                 14330000
143700     MOVE EL9-EIB-LINE-9             TO LT-ERROR-MESSAGE (LT-IDX).14340000
143800*                                                                 14350000
143900     MOVE EIBM-FREE                  TO DP012-CONVERSION-FIELD.   14360000
144000     MOVE LENGTH OF EIBM-FREE        TO DP012-LENGTH.             14370000
144100     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14380000
144200     IF  DP012-CALL-SUCCESSFUL                                    14390000
144300         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBFREE-HEX          14400000
144400     ELSE                                                         14410000
144500         MOVE ALL '?'                TO EL10-EIBFREE-HEX          14420000
144600     END-IF.                                                      14430000
144700     MOVE EIBM-RECV                  TO DP012-CONVERSION-FIELD.   14440000
144800     MOVE LENGTH OF EIBM-RECV        TO DP012-LENGTH.             14450000
144900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14460000
145000     IF  DP012-CALL-SUCCESSFUL                                    14470000
145100         MOVE DP012-CONVERTED-FIELD  TO EL10-EIBRECV-HEX          14480000
145200     ELSE                                                         14490000
145300         MOVE ALL '?'                TO EL10-EIBRECV-HEX          14500000
145400     END-IF.                                                      14510000
145500     PERFORM 5110-SET-LINE-INDEX.                                 14520000
145600     MOVE EL10-EIB-LINE-10           TO LT-ERROR-MESSAGE (LT-IDX).14530000
145700*                                                                 14540000
145800     MOVE EIBM-ATT                   TO DP012-CONVERSION-FIELD.   14550000
145900     MOVE LENGTH OF EIBM-ATT         TO DP012-LENGTH.             14560000
146000     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14570000
146100     IF  DP012-CALL-SUCCESSFUL                                    14580000
146200         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBATT-HEX           14590000
146300     ELSE                                                         14600000
146400         MOVE ALL '?'                TO EL11-EIBATT-HEX           14610000
146500     END-IF.                                                      14620000
146600     MOVE EIBM-SYNC                  TO DP012-CONVERSION-FIELD.   14630000
146700     MOVE LENGTH OF EIBM-SYNC        TO DP012-LENGTH.             14640000
146800     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14650000
146900     IF  DP012-CALL-SUCCESSFUL                                    14660000
147000         MOVE DP012-CONVERTED-FIELD  TO EL11-EIBSYNC-HEX          14670000
147100     ELSE                                                         14680000
147200         MOVE ALL '?'                TO EL11-EIBSYNC-HEX          14690000
147300     END-IF.                                                      14700000
147400     PERFORM 5110-SET-LINE-INDEX.                                 14710000
147500     MOVE EL11-EIB-LINE-11           TO LT-ERROR-MESSAGE (LT-IDX).14720000
147600*                                                                 14730000
147700     MOVE EIBM-FMH                   TO DP012-CONVERSION-FIELD.   14740000
147800     MOVE LENGTH OF EIBM-FMH         TO DP012-LENGTH.             14750000
147900     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14760000
148000     IF  DP012-CALL-SUCCESSFUL                                    14770000
148100         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBFMH-HEX           14780000
148200     ELSE                                                         14790000
148300         MOVE ALL '?'                TO EL12-EIBFMH-HEX           14800000
148400     END-IF.                                                      14810000
148500     MOVE EIBM-COMPL                 TO DP012-CONVERSION-FIELD.   14820000
148600     MOVE LENGTH OF EIBM-COMPL       TO DP012-LENGTH.             14830000
148700     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14840000
148800     IF  DP012-CALL-SUCCESSFUL                                    14850000
148900         MOVE DP012-CONVERTED-FIELD  TO EL12-EIBCOMPL-HEX         14860000
149000     ELSE                                                         14870000
149100         MOVE ALL '?'                TO EL12-EIBCOMPL-HEX         14880000
149200     END-IF.                                                      14890000
149300     PERFORM 5110-SET-LINE-INDEX.                                 14900000
149400     MOVE EL12-EIB-LINE-12           TO LT-ERROR-MESSAGE (LT-IDX).14910000
149500*                                                                 14920000
149600     MOVE EIBM-SIG                   TO DP012-CONVERSION-FIELD.   14930000
149700     MOVE LENGTH OF EIBM-SIG         TO DP012-LENGTH.             14940000
149800     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              14950000
149900     IF  DP012-CALL-SUCCESSFUL                                    14960000
150000         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBSIG-HEX           14970000
150100     ELSE                                                         14980000
150200         MOVE ALL '?'                TO EL13-EIBSIG-HEX           14990000
150300     END-IF.                                                      15000000
150400     MOVE EIBM-CONF                  TO DP012-CONVERSION-FIELD.   15010000
150500     MOVE LENGTH OF EIBM-CONF        TO DP012-LENGTH.             15020000
150600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15030000
150700     IF  DP012-CALL-SUCCESSFUL                                    15040000
150800         MOVE DP012-CONVERTED-FIELD  TO EL13-EIBCONF-HEX          15050000
150900     ELSE                                                         15060000
151000         MOVE ALL '?'                TO EL13-EIBCONF-HEX          15070000
151100     END-IF.                                                      15080000
151200     PERFORM 5110-SET-LINE-INDEX.                                 15090000
151300     MOVE EL13-EIB-LINE-13           TO LT-ERROR-MESSAGE (LT-IDX).15100000
151400*                                                                 15110000
151500     MOVE EIBM-ERR                   TO DP012-CONVERSION-FIELD.   15120000
151600     MOVE LENGTH OF EIBM-ERR         TO DP012-LENGTH.             15130000
151700     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15140000
151800     IF  DP012-CALL-SUCCESSFUL                                    15150000
151900         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERR-HEX           15160000
152000     ELSE                                                         15170000
152100         MOVE ALL '?'                TO EL14-EIBERR-HEX           15180000
152200     END-IF.                                                      15190000
152300     MOVE EIBM-ERRCD                 TO DP012-CONVERSION-FIELD.   15200000
152400     MOVE LENGTH OF EIBM-ERRCD       TO DP012-LENGTH.             15210000
152500     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15220000
152600     IF  DP012-CALL-SUCCESSFUL                                    15230000
152700         MOVE DP012-CONVERTED-FIELD  TO EL14-EIBERRCD-HEX         15240000
152800     ELSE                                                         15250000
152900         MOVE ALL '?'                TO EL14-EIBERRCD-HEX         15260000
153000     END-IF.                                                      15270000
153100     PERFORM 5110-SET-LINE-INDEX.                                 15280000
153200     MOVE EL14-EIB-LINE-14           TO LT-ERROR-MESSAGE (LT-IDX).15290000
153300*                                                                 15300000
153400     MOVE EIBM-SYNRB                 TO DP012-CONVERSION-FIELD.   15310000
153500     MOVE LENGTH OF EIBM-SYNRB       TO DP012-LENGTH.             15320000
153600     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15330000
153700     IF  DP012-CALL-SUCCESSFUL                                    15340000
153800         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBSYNRB-HEX         15350000
153900     ELSE                                                         15360000
154000         MOVE ALL '?'                TO EL15-EIBSYNRB-HEX         15370000
154100     END-IF.                                                      15380000
154200     MOVE EIBM-NODAT                 TO DP012-CONVERSION-FIELD.   15390000
154300     MOVE LENGTH OF EIBM-NODAT       TO DP012-LENGTH.             15400000
154400     CALL 'DPKUT012' USING DP012-HEX-PARAMETER-LIST.              15410000
154500     IF  DP012-CALL-SUCCESSFUL                                    15420000
154600         MOVE DP012-CONVERTED-FIELD  TO EL15-EIBNODAT-HEX         15430000
154700     ELSE                                                         15440000
154800         MOVE ALL '?'                TO EL15-EIBNODAT-HEX         15450000
154900     END-IF.                                                      15460000
155000     PERFORM 5110-SET-LINE-INDEX.                                 15470000
155100     MOVE EL15-EIB-LINE-15           TO LT-ERROR-MESSAGE (LT-IDX).15480000
155200*                                                                 15490000
155300*                                                                 15500000
155400 3500-LOG-ABEND-INFO.                                             15510000
155500     EXEC CICS                                                    15520000
155600         ENQ                                                      15530000
155700             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     15540000
155800     END-EXEC.                                                    15550000
155900*                                                                 15560000
156000     SET PV-NUMBER-LOG-LINES TO LT-IDX.                           15570000
156100     PERFORM                                                      15580000
156200         VARYING LT-IDX                                           15590000
156300         FROM 1 BY 1                                              15600000
156400         UNTIL LT-IDX > PV-NUMBER-LOG-LINES                       15610000
156500             MOVE LT-LOG-LINE (LT-IDX) TO PV-LOG-DATA             15620000
156600             PERFORM 3510-WRITEQ-TD                               15630000
156700     END-PERFORM.                                                 15640000
156800*                                                                 15650000
156900     EXEC CICS                                                    15660000
157000         DEQ                                                      15670000
157100             RESOURCE (PC-LOG-QUEUE-RESOURCE)                     15680000
157200     END-EXEC.                                                    15690000
157300*    PERFORM 3520-DISPLAY-OPER-MSG.                               15700000
157400*                                                                 15710000
157500*                                                                 15720000
157600 3510-WRITEQ-TD.                                                  15730000
157700     EXEC CICS                                                    15740000
157800         WRITEQ TD                                                15750000
157900             QUEUE (PC-LOG-QUEUE)                                 15760000
158000             FROM  (PV-LOG-LINE)                                  15770000
158100             RESP  (PV-CICS-RESPONSE)                             15780000
158200     END-EXEC.                                                    15790000
158300*                                                                 15800000
158400     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       15810000
158500         CONTINUE                                                 15820000
158600     ELSE                                                         15830000
158700         EXEC CICS                                                15840000
158800             ABEND                                                15850000
158900                 ABCODE (EIBTRMID)                                15860000
159000         END-EXEC                                                 15870000
159100     END-IF.                                                      15880000
159200 5110-SET-LINE-INDEX.                                             15890000
159300     IF  LT-IDX > PC-LOG-TABLE-MAX                                15900000
159400         SET PS-LOG-OVERFLOW TO TRUE                              15910000
159500     ELSE                                                         15920000
159600         SET LT-IDX UP BY 1                                       15930000
159700     END-IF.                                                      15940000
159800*                                                                 15950000
159900*                                                                 15960000
160000 8000-SEND-MAP.                                                   15970000
160100     EXEC CICS                                                    15980000
160200         SEND                                                     15990000
160300             MAP     ('PC871A')                                   16000000
160400             MAPSET  ('PCKM871')                                  16010000
160500             ERASE                                                16020000
160600             RESP    (PV-CICS-RESPONSE)                           16030000
160700     END-EXEC.                                                    16040000
160800                                                                  16050000
160900     EVALUATE TRUE                                                16060000
161000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16070000
161100             CONTINUE                                             16080000
161200         WHEN OTHER                                               16090000
161300             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          16100000
161400             MOVE 'UNABLE TO SEND MAP'                            16110000
161500                                      TO DP013-MESSAGE-TEXT (1)   16120000
161600             SET DP013-CICS-ABEND     TO TRUE                     16130000
161700             SET DP013-NO-ROLLBACK    TO TRUE                     16140000
161800             PERFORM 9999-WRITE-CICS-LOG-MSG                      16150000
161900     END-EVALUATE.                                                16160000
162000*                                                                 16170000
162100 8020-RECEIVE-MAP.                                                16180000
162200                                                                  16190000
162300     EXEC CICS                                                    16200000
162400         RECEIVE MAP    ('PC871A')                                16210000
162500                 MAPSET ('PCKM871')                               16220000
162600                 RESP   (PV-CICS-RESPONSE)                        16230000
162700     END-EXEC.                                                    16240000
162800                                                                  16250000
162900     EVALUATE TRUE                                                16260000
163000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16270000
163100             CONTINUE                                             16280000
163200         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                16290000
163300             CONTINUE                                             16300000
163400         WHEN OTHER                                               16310000
163500             MOVE '8020-RECEIVE-MAP'  TO DP013-PARAGRAPH          16320000
163600             MOVE 'PCKRF871 - UNABLE TO RECEIVE MAP'              16330000
163700                                      TO DP013-MESSAGE-TEXT (1)   16340000
163800             SET DP013-LOGIC-ABEND    TO TRUE                     16350000
163900             SET DP013-NO-ROLLBACK    TO TRUE                     16360000
164000             PERFORM 9999-WRITE-CICS-LOG-MSG                      16370000
164100     END-EVALUATE.                                                16380000
164200                                                                  16390000
164300 8030-SEND-TEXT.                                                  16400000
164400                                                                  16410000
164500     MOVE LENGTH OF PV-TEXT TO PV-TEXT-LENGTH                     16420000
164600                                                                  16430000
164700     EXEC CICS                                                    16440000
164800         SEND TEXT                                                16450000
164900             FROM (PV-TEXT)                                       16460000
165000             LENGTH (PV-TEXT-LENGTH)                              16470000
165100             ERASE                                                16480000
165200             RESP   (PV-CICS-RESPONSE)                            16490000
165300     END-EXEC.                                                    16500000
165400                                                                  16510000
165500     EVALUATE TRUE                                                16520000
165600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16530000
165700             CONTINUE                                             16540000
165800         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                16550000
165900             CONTINUE                                             16560000
166000         WHEN OTHER                                               16570000
166100             MOVE '8030-SEND-TEXT'    TO DP013-PARAGRAPH          16580000
166200             MOVE 'PCKRF871 - UNABLE TO SEND TEXT'                16590000
166300                                      TO DP013-MESSAGE-TEXT (1)   16600000
166400             SET DP013-LOGIC-ABEND    TO TRUE                     16610000
166500             SET DP013-NO-ROLLBACK    TO TRUE                     16620000
166600             PERFORM 9999-WRITE-CICS-LOG-MSG                      16630000
166700     END-EVALUATE.                                                16640000
166800                                                                  16650000
166900 8100-SEND-DATA-ONLY.                                             16660000
167000                                                                  16670000
167100     EXEC CICS                                                    16680000
167200         SEND                                                     16690000
167300             MAP       ('PC871A')                                 16700000
167400             MAPSET    ('PCKM871')                                16710000
167500             CURSOR                                               16720000
167600             DATAONLY                                             16730000
167700             RESP      (PV-CICS-RESPONSE)                         16740000
167800     END-EXEC.                                                    16750000
167900                                                                  16760000
168000     EVALUATE TRUE                                                16770000
168100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16780000
168200             CONTINUE                                             16790000
168300         WHEN OTHER                                               16800000
168400             MOVE '8100-SEND-DATA-ONLY'                           16810000
168500                                      TO DP013-PARAGRAPH          16820000
168600             MOVE 'UNABLE TO SEND DATA'                           16830000
168700                                      TO DP013-MESSAGE-TEXT (1)   16840000
168800             SET DP013-CICS-ABEND     TO TRUE                     16850000
168900             SET DP013-NO-ROLLBACK    TO TRUE                     16860000
169000             PERFORM 9999-WRITE-CICS-LOG-MSG                      16870000
169100     END-EVALUATE.                                                16880000
169200*                                                                 16890000
169300 8200-RETURN-TRANID.                                              16900000
169400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      16910000
169500                                                                  16920000
169600     EXEC CICS                                                    16930000
169700         RETURN                                                   16940000
169800             TRANSID   (PC-CURRENT-TRANID)                        16950000
169900             COMMAREA  (CA-COMMAREA)                              16960000
170000             LENGTH    (PV-COMMAREA-LENGTH)                       16970000
170100             RESP      (PV-CICS-RESPONSE)                         16980000
170200     END-EXEC.                                                    16990000
170300                                                                  17000000
170400     EVALUATE TRUE                                                17010000
170500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17020000
170600             CONTINUE                                             17030000
170700         WHEN OTHER                                               17040000
170800             MOVE '8200-RETURN-TRANID'                            17050000
170900                                      TO DP013-PARAGRAPH          17060000
171000             MOVE 'UNABLE TO RETURN   TO TRANID'                  17070000
171100                                      TO DP013-MESSAGE-TEXT (1)   17080000
171200             SET DP013-CICS-ABEND     TO TRUE                     17090000
171300             SET DP013-NO-ROLLBACK    TO TRUE                     17100000
171400             PERFORM 9999-WRITE-CICS-LOG-MSG                      17110000
171500     END-EVALUATE.                                                17120000
171600*                                                                 17130000
171700 8300-XCTL-TO-HELP.                                               17140000
171800                                                                  17150000
171900     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       17160000
172000                                                                  17170000
172100     EXEC CICS                                                    17180000
172200         XCTL                                                     17190000
172300             PROGRAM   (PV-TRANSFER-PROGRAM)                      17200000
172400             COMMAREA  (PC192-COMMAREA)                           17210000
172500             LENGTH    (PV-COMMAREA-LENGTH)                       17220000
172600             RESP      (PV-CICS-RESPONSE)                         17230000
172700     END-EXEC.                                                    17240000
172800                                                                  17250000
172900     EVALUATE TRUE                                                17260000
173000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17270000
173100             CONTINUE                                             17280000
173200         WHEN OTHER                                               17290000
173300             MOVE '8300-XCTL-TO-HELP'                             17300000
173400                                      TO DP013-PARAGRAPH          17310000
173500             MOVE 'UNABLE TO RETURN   TO TRANID'                  17320000
173600                                      TO DP013-MESSAGE-TEXT (1)   17330000
173700             SET DP013-CICS-ABEND     TO TRUE                     17340000
173800             SET DP013-NO-ROLLBACK    TO TRUE                     17350000
173900             PERFORM 9999-WRITE-CICS-LOG-MSG                      17360000
174000     END-EVALUATE.                                                17370000
174100*                                                                 17380000
174200 8400-ROLLBACK.                                                   17390000
174300                                                                  17400000
174400     EXEC CICS                                                    17410000
174500         SYNCPOINT                                                17420000
174600         ROLLBACK                                                 17430000
174700     END-EXEC.                                                    17440000
174800                                                                  17450000
174900*                                                                 17460000
175000 9999-WRITE-CICS-LOG-MSG.                                         17470000
175100     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           17480000
175200     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          17490000
175300     INITIALIZE DP013-SRC-TASK-NUMBER                             17500000
175400                DP013-STACK.                                      17510000
175500     SET DP013-LINK-RETURN            TO TRUE.                    17520000
175600                                                                  17530000
175700     EXEC CICS                                                    17540000
175800         LINK                                                     17550000
175900             PROGRAM   (DP013-NAME)                               17560000
176000             COMMAREA  (DP013-PARAMETERS)                         17570000
176100             LENGTH    (DP013-LENGTH)                             17580000
176200     END-EXEC.                                                    17590000
176300                                                                  17600000
176400*----------------------------------------------------------------*17610000
176500*    ABEND PROCESSOR MODULE                                      *17620000
176600*----------------------------------------------------------------*17630000
176700                                                                  17640000
176800     COPY DPPD014.                                                17650000
176900                                                                  17660000
