000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400                                                                  00040099
000500 PROGRAM-ID.    RCKRP082.                                         00050099
000600 AUTHOR.        TKMA479.                                          00060099
000700 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00070099
000800 DATE-WRITTEN   SEPTEMBER 2012.                                   00080099
000900 DATE-COMPILED.                                                   00090099
001000                                                                  00100099
001100******************************************************************00110099
001200*  PAGE BREAKS ON SET/DMM/BYR/DEPT/PO - VER1                      00120099
001300*                                                                 00130099
001400*  REPORT PROGRAM FOR SEASONAL SET EXTRACT FILE.                  00140099
001500*                                                                 00150099
001600*  FOR EACH RECORD OF INPUT, WRITE A REPORT LINE.                 00160099
001700*  BREAKS FOR SET, DMM, BUYER AND DEPARTMENT CHANGES WITH         00170099
001800*  DEPARTMENT TOTALS FOR EACH.  PLUS SET TOTALS AT SET BREAKS.    00180099
001900*  GET DEPARTMENT NAME FROM XLT_DEPT AND SEASONAL SET NAME FROM   00190099
002000*  TSEASET.                                                       00200099
002100******************************************************************00210099
001410******************************************************************00211099
001300* CHANGE HISTORY:                                                *00212099
001300*    CHANGES                                                     *00213099
001300*     MADE BY: VENKATSUBBU (COGNIZANT)                           *00214099
001300*     DATE:    11/26/2014                                        *00215099
001300*                                                                *00216099
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00217099
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 11/26/2014     *00218099
001340******************************************************************00219099
002200                                                                  00220099
002300 ENVIRONMENT DIVISION.                                            00230099
002400 CONFIGURATION SECTION.                                           00240099
002500 SOURCE-COMPUTER.        IBM-3090.                                00250099
002600 OBJECT-COMPUTER.        IBM-3090.                                00260099
002700                                                                  00270099
002800 INPUT-OUTPUT SECTION.                                            00280099
002900 FILE-CONTROL.                                                    00290099
003000                                                                  00300099
003100     SELECT INPUT-FILE                                            00310099
003200         ASSIGN TO INP01.                                         00320099
003300                                                                  00330099
003400     SELECT REPORT-FILE                                           00340099
003500         ASSIGN TO RPT01.                                         00350099
003600                                                                  00360099
003700 DATA DIVISION.                                                   00370099
003800 FILE SECTION.                                                    00380099
003900                                                                  00390099
004000 FD  INPUT-FILE                                                   00400099
004100     RECORDING MODE IS F                                          00410099
004200     LABEL RECORDS ARE STANDARD                                   00420099
004300     RECORD CONTAINS 110                                          00430099
004400     BLOCK CONTAINS 0 RECORDS                                     00440099
004500     DATA RECORD IS INPUT-RECORD.                                 00450099
004600                                                                  00460099
004700 01  INPUT-RECORD              PIC  X(110).                       00470099
004800                                                                  00480099
004900 FD  REPORT-FILE                                                  00490099
005000     RECORDING MODE IS F                                          00500099
005100     LABEL RECORDS ARE STANDARD                                   00510099
005200*CHG98147 - START                                                 00520099
005300*    RECORD CONTAINS 200                                          00530099
005400     RECORD CONTAINS 250                                          00540099
005500     BLOCK CONTAINS 0 RECORDS                                     00550099
005600     DATA RECORD IS REPORT-RECORD.                                00560099
005700                                                                  00570099
005800*01  REPORT-RECORD             PIC  X(200).                       00580099
005900 01  REPORT-RECORD             PIC  X(250).                       00590099
006000*CHG98147 - END                                                   00600099
006100                                                                  00610099
006200******************************************************************00620099
006300 WORKING-STORAGE SECTION.                                         00630099
006400******************************************************************00640099
006500 01  PS-PROGRAM-SWITCHES.                                         00650099
006600     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00660099
006700         88  PS-EOF-INPUT                        VALUE 'Y'.       00670099
006800         88  PS-NOT-EOF-INPUT                    VALUE 'N'.       00680099
006900                                                                  00690099
007000 01  PC-PROGRAM-CONSTANTS.                                        00700099
007100     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'RCKRP082'. 00710099
007200     05  PC-MAX-LINES                 PIC 99    VALUE 70.         00720099
007300     05  PC-REPORT-NBR                PIC X(10) VALUE             00730099
007400                                                  'RCKRP082-1'.   00740099
007500     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3 COMP.   00750099
007600                                                                  00760099
007700 01  PC-NO-INPUT-LINE.                                            00770099
007800     05 FILLER                      PIC X(75) VALUE SPACES.       00780099
007900     05 FILLER                      PIC X(50) VALUE               00790099
008000     '       ***  THERE IS NO DATA TO REPORT  ***       '.        00800099
008100     05 FILLER                      PIC X(75) VALUE SPACES.       00810099
008200                                                                  00820099
008300 01  PC-END-OF-REPORT-LINE.                                       00830099
008400     05 FILLER                      PIC X(75) VALUE SPACES.       00840099
008500     05 FILLER                      PIC X(50) VALUE               00850099
008600     '             ***  END OF REPORT  ***              '.        00860099
008700     05 FILLER                      PIC X(75) VALUE SPACES.       00870099
008800                                                                  00880099
008900 01  PV-PROGRAM-VARIABLES.                                        00890099
009000     05  PV-DETAIL-WRITES             PIC 9(9)   VALUE 0.         00900099
009100     05  PV-RECORDS-READ              PIC 9(9)   VALUE 0.         00910099
009200     05  PV-LINE-COUNT                PIC 9(09)  VALUE 80.        00920099
009300     05  PV-PAGE-COUNT                PIC 9(09)  VALUE 0.         00930099
009400     05  PV-SQLCODE                   PIC 9999-.                  00940099
009500     05  PV-DEPT-NBR-N                PIC 9(4)   VALUE 0.         00950099
009600     05  PV-DEPT-NBR-X REDEFINES PV-DEPT-NBR-N                    00960099
009700                                      PIC X(4).                   00970099
009800     05  PV-TMST                      PIC X(26)  VALUE SPACES.    00980099
009900     05  PV-DATE                      PIC X(10)  VALUE SPACES.    00990099
010000     05  WS-HOLD-SET-YR               PIC X(4)   VALUE SPACES.    01000099
010100     05  WS-HOLD-SET                  PIC X(5)   VALUE SPACES.    01010099
010200     05  WS-HOLD-DEPT                 PIC 9(4)   VALUE 0.         01020099
010300     05  WS-HOLD-DMA-NBR              PIC X(2)   VALUE SPACES.    01030099
010400     05  WS-HOLD-BYR-NBR              PIC X(3)   VALUE SPACES.    01040099
010500     05  WS-HOLD-DMM-NM               PIC X(18)  VALUE SPACES.    01050099
010600     05  WS-HOLD-BYR-NM               PIC X(18)  VALUE SPACES.    01060099
010700     05  PV-CURR-DATE.                                            01070099
010800         10  PV-CURR-YY               PIC  9(02) VALUE ZERO.      01080099
010900         10  PV-CURR-MM               PIC  9(02) VALUE ZERO.      01090099
011000         10  PV-CURR-DD               PIC  9(02) VALUE ZERO.      01100099
011100     05  PV-CURR-TIME.                                            01110099
011200         10  PV-CURR-HH               PIC  9(02) VALUE ZERO.      01120099
011300         10  PV-CURR-MN               PIC  9(02) VALUE ZERO.      01130099
011400         10  PV-CURR-TIME-SSHH        PIC  9(04) VALUE ZERO.      01140099
011500     05  PV-SEASONAL-SET.                                         01150099
011600         10  PV-SET-YEAR              PIC  X(04).                 01160099
011700         10  FILLER                   PIC  X     VALUE '-'.       01170099
011800         10  PV-SET-NAME              PIC  X(05).                 01180099
011900                                                                  01190099
012000 01  PV-DEPT-TOTALS.                                              01200099
012100     05  PV-DPT-TOT-PO-QTY             PIC   9(7)  VALUE 0.       01210099
012200     05  PV-DPT-TOT-UNT-QTY            PIC   9(11) VALUE 0.       01220099
012210*CHG98147 - START                                                 01221099
012211     05  PV-DPT-TOT-PO-SPLIT-QTY       PIC   9(11) VALUE 0.       01221199
012212     05  PV-DPT-TOT-PO-SPLIT-DIFF      PIC  S9(11) VALUE 0.       01221299
012220*CHG98147 - END                                                   01222099
012300     05  PV-DPT-TOT-PO-ALLOC-QTY       PIC   9(11) VALUE 0.       01230099
012400     05  PV-DPT-TOT-PO-ALLOC-DIFF      PIC  S9(11) VALUE 0.       01240099
012500     05  PV-DPT-TOT-RCVR-ALLOC-QTY     PIC   9(11) VALUE 0.       01250099
012600     05  PV-DPT-TOT-RCVR-ALLOC-DIFF    PIC  S9(11) VALUE 0.       01260099
012700     05  PV-DPT-TOT-RCVR-VERFYD-QTY    PIC   9(11) VALUE 0.       01270099
012800                                                                  01280099
012900 01  PV-SET-TOTALS.                                               01290099
013000     05  PV-SET-TOT-PO-QTY             PIC   9(7)  VALUE 0.       01300099
013100     05  PV-SET-TOT-UNT-QTY            PIC  S9(11) VALUE 0.       01310099
013110*CHG98147 - START                                                 01311099
013111     05  PV-SET-TOT-PO-SPLIT-QTY       PIC  S9(11) VALUE 0.       01311199
013112     05  PV-SET-TOT-PO-SPLIT-DIFF      PIC  S9(11) VALUE 0.       01311299
013120*CHG98147 - END                                                   01312099
013200     05  PV-SET-TOT-PO-ALLOC-QTY       PIC  S9(11) VALUE 0.       01320099
013300     05  PV-SET-TOT-PO-ALLOC-DIFF      PIC  S9(11) VALUE 0.       01330099
013400     05  PV-SET-TOT-RCVR-ALLOC-QTY     PIC  S9(11) VALUE 0.       01340099
013500     05  PV-SET-TOT-RCVR-ALLOC-DIFF    PIC  S9(11) VALUE 0.       01350099
013600     05  PV-SET-TOT-RCVR-VERFYD-QTY    PIC  S9(11) VALUE 0.       01360099
013700                                                                  01370099
013800 01  PV-RPT-TOTALS.                                               01380099
013900     05  PV-RPT-TOT-PO-QTY             PIC   9(7)  VALUE 0.       01390099
014000     05  PV-RPT-TOT-UNT-QTY            PIC  S9(11) VALUE 0.       01400099
014100     05  PV-RPT-TOT-PO-ALLOC-QTY       PIC  S9(11) VALUE 0.       01410099
014200     05  PV-RPT-TOT-PO-ALLOC-DIFF      PIC  S9(11) VALUE 0.       01420099
014300     05  PV-RPT-TOT-RCVR-ALLOC-QTY     PIC  S9(11) VALUE 0.       01430099
014400     05  PV-RPT-TOT-RCVR-ALLOC-DIFF    PIC  S9(11) VALUE 0.       01440099
014500     05  PV-RPT-TOT-RCVR-VERFYD-QTY    PIC  S9(11) VALUE 0.       01450099
014600                                                                  01460099
014700     05 PV-FIRST-NAME.                                            01470099
014800        10 PV-FIRST-NAME-BYTE  OCCURS 12 TIMES INDEXED BY INX1    01480099
014900                                      PIC X(01).                  01490099
015000     05 PV-LAST-NAME.                                             01500099
015100        10 PV-LAST-NAME-BYTE   OCCURS 18 TIMES INDEXED BY INX2    01510099
015200                                      PIC X(01).                  01520099
015300     05 PV-NAME.                                                  01530099
015400        10 PV-NAME-BYTE        OCCURS 30 TIMES INDEXED BY INX3    01540099
015500                                      PIC X(01).                  01550099
015600                                                                  01560099
015700 01  WS-RPT-SEC-NO-DATA.                                          01570099
015800     05 FILLER                      PIC X(2)  VALUE SPACES.       01580099
015900     05 FILLER                      PIC X(30) VALUE               01590099
016000        '*** NO DATA TO REPORT ***     '.                         01600099
016100     05 FILLER                      PIC X(168) VALUE SPACES.      01610099
016200                                                                  01620099
016300 01  WS-RPT-SECTION.                                              01630099
016400     05 FILLER                      PIC X(2)  VALUE SPACES.       01640099
016500     05 SECT-SEASET-YY              PIC X(2)  VALUE SPACES.       01650099
016600     05 FILLER                      PIC X(1)  VALUE '-'.          01660099
016700     05 SECT-SEASET-SHRT-NM         PIC X(5)  VALUE SPACES.       01670099
016800     05 FILLER                      PIC X(1)  VALUE SPACES.       01680099
016900     05 FILLER                      PIC X(4)  VALUE 'DMM:'.       01690099
017000     05 SECT-DMA-NBR                PIC X(2)  VALUE SPACES.       01700099
017100     05 FILLER                      PIC X(4)  VALUE 'BYR:'.       01710099
017200     05 SECT-BYR-NBR                PIC X(3)  VALUE SPACES.       01720099
017300     05 FILLER                      PIC X(4)  VALUE 'DPT:'.       01730099
017400     05 SECT-DPT-NBR                PIC X(4)  VALUE SPACES.       01740099
017500                                                                  01750099
017600 01  WS-RPT-HEADER1.                                              01760099
017700     05 FILLER                      PIC X(71) VALUE SPACES.       01770099
017800     05 FILLER                      PIC X(58) VALUE               01780099
017900     'SEASONAL SET RECAP REPORT - BY  SET/DMM/BYR/DEPT/PO - VER1'.01790099
018000     05 FILLER                      PIC X(71) VALUE SPACES.       01800099
018100                                                                  01810099
018200 01  WS-RPT-HEADER2.                                              01820099
018300     05 FILLER                      PIC X(2)  VALUE SPACES.       01830099
018400     05 FILLER                      PIC X(06) VALUE 'SET:  '.     01840099
018500     05 H2-SEASET-CCYY              PIC X(4).                     01850099
018600     05 FILLER                      PIC X(1)  VALUE '-'.          01860099
018700     05 H2-SEASET-SHRT-NM           PIC X(5).                     01870099
018800     05 FILLER                      PIC X(01) VALUE SPACES.       01880099
018900     05 H2-SEASONAL-SET-NAME        PIC X(25).                    01890099
019000                                                                  01900099
019100 01  WS-RPT-HEADER2A.                                             01910099
019200     05 FILLER                      PIC X(2)  VALUE SPACES.       01920099
019300     05 FILLER                      PIC X(06) VALUE 'DMM: ('.     01930099
019400     05 H2A-DMA-NBR                 PIC X(2).                     01940099
019500     05 FILLER                      PIC X(1)  VALUE ')'.          01950099
019600     05 H2A-DMM-NM                  PIC X(18).                    01960099
019700     05 FILLER                      PIC X(1)  VALUE SPACES.       01970099
019800     05 FILLER                      PIC X(08) VALUE 'BUYER: ('.   01980099
019900     05 H2A-BYR-NBR                 PIC X(3).                     01990099
020000     05 FILLER                      PIC X(1)  VALUE ')'.          02000099
020100     05 H2A-BYR-NM                  PIC X(18).                    02010099
020200                                                                  02020099
020300 01  WS-RPT-HEADER3.                                              02030099
020400     05 FILLER                      PIC X(2)  VALUE SPACES.       02040099
020500     05 FILLER                      PIC X(6)  VALUE 'DEPT: '.     02050099
020600     05 H3-DEPT                     PIC ZZZ9.                     02060099
020700     05 FILLER                      PIC X(7)  VALUE SPACES.       02070099
020800     05 H3-DEPT-NAME                PIC X(25).                    02080099
020900                                                                  02090099
021000 01  WS-RPT-HEADER4.                                              02100099
021100     05 FILLER                       PIC X(63)  VALUE SPACES.     02110099
021200     05 FILLER                       PIC X(05)  VALUE 'TOTAL'.    02120099
021300     05 FILLER                       PIC X(12)  VALUE SPACES.     02130099
021400     05 FILLER                       PIC X(05)  VALUE 'TOTAL'.    02140099
021500     05 FILLER                       PIC X(113) VALUE SPACES.     02150099
021600                                                                  02160099
021700 01  WS-RPT-HEADER5.                                              02170099
021800     05 FILLER                       PIC X(63) VALUE SPACES.      02180099
021900     05 FILLER                       PIC X(05) VALUE 'VALUE'.     02190099
022000     05 FILLER                       PIC X(12) VALUE SPACES.      02200099
022100     05 FILLER                       PIC X(05) VALUE 'VALUE'.     02210099
022200     05 FILLER                       PIC X(02) VALUE SPACES.      02220099
022300     05 FILLER                       PIC X(05) VALUE 'TOTAL'.     02230099
022400     05 FILLER                       PIC X(17) VALUE SPACES.      02240099
022500     05 FILLER                       PIC X(03) VALUE 'SET'.       02250099
022600     05 FILLER                       PIC X(9)  VALUE SPACES.      02260099
022700     05 FILLER                       PIC X(05) VALUE 'TOTAL'.     02270099
022800     05 FILLER                       PIC X(12) VALUE SPACES.      02280099
022900*CHG98147 - START                                                 02290099
023000     05 FILLER                       PIC X(02) VALUE 'PO'.        02300099
023100     05 FILLER                       PIC X(14) VALUE SPACES.      02310099
023200     05 FILLER                       PIC X(02) VALUE 'PO'.        02320099
023300     05 FILLER                       PIC X(12) VALUE SPACES.      02330099
023500*CHG98147 - END                                                   02350099
023510     05 FILLER                       PIC X(02) VALUE 'PO'.        02351099
023600     05 FILLER                       PIC X(14) VALUE SPACES.      02360099
023700     05 FILLER                       PIC X(02) VALUE 'PO'.        02370099
023800     05 FILLER                       PIC X(06) VALUE SPACES.      02380099
023900     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  02390099
024000     05 FILLER                       PIC X(08) VALUE SPACES.      02400099
024100     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  02410099
024200     05 FILLER                       PIC X(06) VALUE SPACES.      02420099
024300     05 FILLER                       PIC X(08) VALUE 'RECEIVER'.  02430099
024400                                                                  02440099
024500 01  WS-RPT-HEADER6.                                              02450099
024500*TV 11/26/2014 CHANGE STARTS                                      02451099
024600     05 FILLER                       PIC X(51) VALUE SPACES.      02460099
024500*TV 11/26/2014 CHANGE ENDS                                        02461099
024700     05 FILLER                       PIC X(2)  VALUE 'PO'.        02470099
024700*TV 11/26/2014 CHANGE STARTS                                      02471099
024800     05 FILLER                       PIC X(11) VALUE SPACES.      02480099
024500*TV 11/26/2014 CHANGE ENDS                                        02481099
024900     05 FILLER                       PIC X(4)  VALUE 'COST'.      02490099
025000     05 FILLER                       PIC X(11) VALUE SPACES.      02500099
025100     05 FILLER                       PIC X(6)  VALUE 'RETAIL'.    02510099
025200     05 FILLER                       PIC X(3)  VALUE SPACES.      02520099
025300     05 FILLER                       PIC X(4)  VALUE 'SKUS'.      02530099
025400     05 FILLER                       PIC X(2)  VALUE SPACES.      02540099
025500     05 FILLER                       PIC X(2)  VALUE 'ST'.        02550099
025600     05 FILLER                       PIC X(6)  VALUE SPACES.      02560099
025700     05 FILLER                       PIC X(3)  VALUE 'SET'.       02570099
025800     05 FILLER                       PIC X(2)  VALUE SPACES.      02580099
025900     05 FILLER                       PIC X(5)  VALUE 'SHORT'.     02590099
026000     05 FILLER                       PIC X(10) VALUE SPACES.      02600099
026100     05 FILLER                       PIC X(4)  VALUE 'UNIT'.      02610099
026200     05 FILLER                       PIC X(09) VALUE SPACES.      02620099
026300*CHG98147 - START                                                 02630099
026400     05 FILLER                       PIC X(5)  VALUE 'SPLIT'.     02640099
026500     05 FILLER                       PIC X(11) VALUE SPACES.      02650099
026600     05 FILLER                       PIC X(5)  VALUE 'SPLIT'.     02660099
026700     05 FILLER                       PIC X(09) VALUE SPACES.      02670099
026800*CHG98147 - END                                                   02680099
026900     05 FILLER                       PIC X(5)  VALUE 'ALLOC'.     02690099
027000     05 FILLER                       PIC X(11) VALUE SPACES.      02700099
027100     05 FILLER                       PIC X(05) VALUE 'ALLOC'.     02710099
027200     05 FILLER                       PIC X(9)  VALUE SPACES.      02720099
027300     05 FILLER                       PIC X(08) VALUE 'ALLOC'.     02730099
027400     05 FILLER                       PIC X(08) VALUE SPACES.      02740099
027500     05 FILLER                       PIC X(05) VALUE 'ALLOC'.     02750099
027600     05 FILLER                       PIC X(06) VALUE SPACES.      02760099
027700     05 FILLER                       PIC X(08) VALUE 'VERIFIED'.  02770099
027800                                                                  02780099
027900 01  WS-RPT-HEADER7.                                              02790099
028000     05 FILLER                       PIC X(2)  VALUE SPACES.      02800099
028100     05 FILLER                       PIC X(3)  VALUE 'DMM'.       02810099
028200     05 FILLER                       PIC X(16) VALUE SPACES.      02820099
028300     05 FILLER                       PIC X(5)  VALUE 'BUYER'.     02830099
028400     05 FILLER                       PIC X(14) VALUE SPACES.      02840099
028500     05 FILLER                       PIC X(4)  VALUE 'DEPT'.      02850099
028500*TV 11/26/2014 CHANGE STARTS                                      02851099
028600     05 FILLER                       PIC X(03) VALUE SPACES.      02860099
028500*TV 11/26/2014 CHANGE ENDS                                        02861099
028700     05 FILLER                       PIC X(06) VALUE 'NUMBER'.    02870099
028700*TV 11/26/2014 CHANGE STARTS                                      02871099
028800     05 FILLER                       PIC X(09) VALUE SPACES.      02880099
028500*TV 11/26/2014 CHANGE ENDS                                        02881099
028900     05 FILLER                       PIC X(06) VALUE 'AMOUNT'.    02890099
029000     05 FILLER                       PIC X(11) VALUE SPACES.      02900099
029100     05 FILLER                       PIC X(06) VALUE 'AMOUNT'.    02910099
029200     05 FILLER                       PIC X(04) VALUE SPACES.      02920099
029300     05 FILLER                       PIC X(03) VALUE 'QTY'.       02930099
029400     05 FILLER                       PIC X(2)  VALUE SPACES.      02940099
029500     05 FILLER                       PIC X(02) VALUE 'CD'.        02950099
029600     05 FILLER                       PIC X(1)  VALUE SPACES.      02960099
029700     05 FILLER                       PIC X(03) VALUE 'PKG'.       02970099
029800     05 FILLER                       PIC X(1)  VALUE SPACES.      02980099
029900     05 FILLER                       PIC X(05) VALUE 'YEAR'.      02990099
030000     05 FILLER                       PIC X(2)  VALUE SPACES.      03000099
030100     05 FILLER                       PIC X(06) VALUE 'NAME'.      03010099
030200     05 FILLER                       PIC X(04) VALUE SPACES.      03020099
030300     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  03030099
030400     05 FILLER                       PIC X(06) VALUE SPACES.      03040099
030500*CHG98147 - START                                                 03050099
030600     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  03060099
030700     05 FILLER                       PIC X(12) VALUE SPACES.      03070099
030800     05 FILLER                       PIC X(04) VALUE 'DIFF'.      03080099
030900     05 FILLER                       PIC X(06) VALUE SPACES.      03090099
031000*CHG98147 - END                                                   03100099
031100     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  03110099
031200     05 FILLER                       PIC X(12) VALUE SPACES.      03120099
031300     05 FILLER                       PIC X(04) VALUE 'DIFF'.      03130099
031400     05 FILLER                       PIC X(06) VALUE SPACES.      03140099
031500     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  03150099
031600     05 FILLER                       PIC X(12) VALUE SPACES.      03160099
031700     05 FILLER                       PIC X(04) VALUE 'DIFF'.      03170099
031800     05 FILLER                       PIC X(06) VALUE SPACES.      03180099
031900     05 FILLER                       PIC X(08) VALUE 'QUANTITY'.  03190099
032000                                                                  03200099
032100 01  WS-DETAIL-REC.                                               03210099
032200     05 FILLER                       PIC X(2)  VALUE SPACES.      03220099
032300     05 WS-DTL-DMM-NAME              PIC X(18) VALUE SPACES.      03230099
032400     05 FILLER                       PIC X(01) VALUE SPACES.      03240099
032500     05 WS-DTL-BYR-NAME              PIC X(18) VALUE SPACES.      03250099
032600     05 FILLER                       PIC X(01) VALUE SPACES.      03260099
032700     05 WS-DTL-DEPT                  PIC ZZZ9.                    03270099
032800     05 FILLER                       PIC X(01) VALUE SPACES.      03280099
032900*TV 11/26/2014 CHANGE STARTS                                      03290099
032900     05 WS-DTL-PO                    PIC ZZZZZZZ9.                03291099
033000     05 FILLER                       PIC X(02) VALUE SPACES.      03300099
032900*TV 11/26/2014 CHANGE ENDS                                        03301099
033100     05 WS-DTL-TOT-COST              PIC ZZ,ZZZ,ZZ9.99.           03310099
033200     05 FILLER                       PIC X(04) VALUE SPACES.      03320099
033300     05 WS-DTL-TOT-RETAIL            PIC ZZ,ZZZ,ZZ9.99.           03330099
033400     05 FILLER                       PIC X(02) VALUE SPACES.      03340099
033500     05 WS-DTL-QTY-SKUS              PIC ZZZZ9.                   03350099
033600     05 FILLER                       PIC X(02) VALUE SPACES.      03360099
033700     05 WS-DTL-STAT-CODE             PIC XX.                      03370099
033800     05 FILLER                       PIC X(02) VALUE SPACES.      03380099
033900     05 WS-DTL-PKGNG-CDE             PIC X.                       03390099
034000     05 FILLER                       PIC X(02) VALUE SPACES.      03400099
034100     05 WS-DTL-SEASET-YR             PIC X(04).                   03410099
034200     05 FILLER                       PIC X(02) VALUE SPACES.      03420099
034300     05 WS-DTL-SEASET-SHRT-NM        PIC X(05).                   03430099
034400     05 FILLER                       PIC X(04) VALUE SPACES.      03440099
034500     05 WS-DTL-TOT-UNITS             PIC ZZ,ZZZ,ZZ9.              03450099
034600     05 FILLER                       PIC X(04) VALUE SPACES.      03460099
034700*CHG98147 - START                                                 03470099
034800     05 WS-DTL-SPLIT-QTY             PIC ZZ,ZZZ,ZZ9.              03480099
034900     05 FILLER                       PIC X(05) VALUE SPACES.      03490099
035000     05 WS-DTL-SPLIT-DIFF            PIC ZZ,ZZZ,ZZ9-.             03500099
035100     05 FILLER                       PIC X(04) VALUE SPACES.      03510099
035200*CHG98147 - END                                                   03520099
035300     05 WS-DTL-PO-ALLOC-QTY          PIC ZZ,ZZZ,ZZ9.              03530099
035400     05 FILLER                       PIC X(05) VALUE SPACES.      03540099
035500     05 WS-DTL-PO-ALLOC-DIFF         PIC ZZ,ZZZ,ZZ9-.             03550099
035600     05 FILLER                       PIC X(04) VALUE SPACES.      03560099
035700     05 WS-DTL-RCVR-ALLOC-QTY        PIC ZZ,ZZZ,ZZ9.              03570099
035800     05 FILLER                       PIC X(05) VALUE SPACES.      03580099
035900     05 WS-DTL-RCVR-ALLOC-DIFF       PIC ZZ,ZZZ,ZZ9-.             03590099
036000     05 FILLER                       PIC X(04) VALUE SPACES.      03600099
036100     05 WS-DTL-RCVR-VERFYD           PIC ZZ,ZZZ,ZZ9.              03610099
036200                                                                  03620099
036300 01  WS-SET-TOT-REC.                                              03630099
036400     05 FILLER                       PIC X(45) VALUE SPACES.      03640099
036500     05 WS-SET-TOT-PO                PIC ZZZZZZ9.                 03650099
036600     05 FILLER                       PIC X(3) VALUE SPACES.       03660099
036700     05 FILLER                       PIC X(5) VALUE 'SET  '.      03670099
036800     05 WS-SET-TOT-SET               PIC X(5).                    03680099
036900     05 FILLER                       PIC X(01) VALUE SPACES.      03690099
037000     05 FILLER                       PIC X(6) VALUE 'TOTALS'.     03700099
037100     05 FILLER                       PIC X(41) VALUE SPACES.      03710099
037200     05 WS-SET-TOT-UNITS             PIC Z,ZZZ,ZZZ,ZZ9.           03720099
037300     05 FILLER                       PIC X(01) VALUE SPACES.      03730099
037400*CHG98147 - START                                                 03740099
037410     05 WS-SET-TOT-PO-SPLIT-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03741099
037500     05 FILLER                       PIC X(02) VALUE SPACES.      03750099
037510     05 WS-SET-TOT-PO-SPLIT-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03751099
037520     05 FILLER                       PIC X(01) VALUE SPACES.      03752099
037600*CHG98147 - END                                                   03760099
037700     05 WS-SET-TOT-PO-ALLOC-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03770099
037800     05 FILLER                       PIC X(02) VALUE SPACES.      03780099
037900     05 WS-SET-TOT-PO-ALLOC-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          03790099
038000     05 FILLER                       PIC X(01) VALUE SPACES.      03800099
038100     05 WS-SET-TOT-RCVR-ALLOC-QTY    PIC Z,ZZZ,ZZZ,ZZ9.           03810099
038200     05 FILLER                       PIC X(02) VALUE SPACES.      03820099
038300     05 WS-SET-TOT-RCVR-ALLOC-DIFF   PIC Z,ZZZ,ZZZ,ZZ9-.          03830099
038400     05 FILLER                       PIC X(01) VALUE SPACES.      03840099
038500     05 WS-SET-TOT-RCVR-VERFYD       PIC Z,ZZZ,ZZZ,ZZ9.           03850099
038600                                                                  03860099
038700 01  WS-DPT-TOT-REC.                                              03870099
038800     05 FILLER                       PIC X(45) VALUE SPACES.      03880099
038900     05 WS-DPT-TOT-PO                PIC ZZZZZZ9.                 03890099
039000     05 FILLER                       PIC X(3)  VALUE SPACES.      03900099
039100     05 FILLER                       PIC X(4) VALUE 'DEPT'.       03910099
039200     05 FILLER                       PIC X(2) VALUE SPACES.       03920099
039300     05 WS-DPT-TOT-DEPT              PIC ZZZ9.                    03930099
039400     05 FILLER                       PIC X(1) VALUE SPACES.       03940099
039500     05 FILLER                       PIC X(6) VALUE 'TOTALS'.     03950099
039600     05 FILLER                       PIC X(41) VALUE SPACES.      03960099
039700     05 WS-DPT-TOT-UNITS             PIC Z,ZZZ,ZZZ,ZZ9.           03970099
039800     05 FILLER                       PIC X(01) VALUE SPACES.      03980099
039900*CHG98147 - START                                                 03990099
039910     05 WS-DPT-TOT-PO-SPLIT-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           03991099
040000     05 FILLER                       PIC X(02) VALUE SPACES.      04000099
040010     05 WS-DPT-TOT-PO-SPLIT-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          04001099
040020     05 FILLER                       PIC X(01) VALUE SPACES.      04002099
040100*CHG98147 - END                                                   04010099
040200     05 WS-DPT-TOT-PO-ALLOC-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           04020099
040300     05 FILLER                       PIC X(02) VALUE SPACES.      04030099
040400     05 WS-DPT-TOT-PO-ALLOC-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          04040099
040500     05 FILLER                       PIC X(01) VALUE SPACES.      04050099
040600     05 WS-DPT-TOT-RCVR-ALLOC-QTY    PIC Z,ZZZ,ZZZ,ZZ9.           04060099
040700     05 FILLER                       PIC X(02) VALUE SPACES.      04070099
040800     05 WS-DPT-TOT-RCVR-ALLOC-DIFF   PIC Z,ZZZ,ZZZ,ZZ9-.          04080099
040900     05 FILLER                       PIC X(01) VALUE SPACES.      04090099
041000     05 WS-DPT-TOT-RCVR-VERFYD       PIC Z,ZZZ,ZZZ,ZZ9.           04100099
041100                                                                  04110099
041200 01  WS-RPT-TOT-REC.                                              04120099
041300     05 FILLER                       PIC X(45) VALUE SPACES.      04130099
041400     05 WS-RPT-TOT-PO                PIC ZZZZZZ9.                 04140099
041500     05 FILLER                       PIC X(14) VALUE SPACES.      04150099
041600     05 FILLER                       PIC X(6) VALUE 'TOTALS'.     04160099
041700     05 FILLER                       PIC X(41) VALUE SPACES.      04170099
041800     05 WS-RPT-TOT-UNITS             PIC Z,ZZZ,ZZZ,ZZ9.           04180099
041900     05 FILLER                       PIC X(01) VALUE SPACES.      04190099
042000     05 WS-RPT-TOT-PO-ALLOC-QTY      PIC Z,ZZZ,ZZZ,ZZ9.           04200099
042100     05 FILLER                       PIC X(02) VALUE SPACES.      04210099
042200     05 WS-RPT-TOT-PO-ALLOC-DIFF     PIC Z,ZZZ,ZZZ,ZZ9-.          04220099
042300     05 FILLER                       PIC X(01) VALUE SPACES.      04230099
042400     05 WS-RPT-TOT-RCVR-ALLOC-QTY    PIC Z,ZZZ,ZZZ,ZZ9.           04240099
042500     05 FILLER                       PIC X(02) VALUE SPACES.      04250099
042600     05 WS-RPT-TOT-RCVR-ALLOC-DIFF   PIC Z,ZZZ,ZZZ,ZZ9-.          04260099
042700     05 FILLER                       PIC X(01) VALUE SPACES.      04270099
042800     05 WS-RPT-TOT-RCVR-VERFYD       PIC Z,ZZZ,ZZZ,ZZ9.           04280099
042900                                                                  04290099
043000 01  WS-BLANK-LINE.                                               04300099
043010*CHG98147 - START                                                 04301099
043100*    05 FILLER                       PIC  X(200) VALUE SPACES.    04310099
043110     05 FILLER                       PIC  X(250) VALUE SPACES.    04311099
043120*CHG98147 - END                                                   04312099
043200                                                                  04320099
043300 01  PV-ABEND-FIELDS.                                             04330099
043400     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         04340099
043500                                                 COMP SYNC.       04350099
043600     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKRP082'.04360099
043700     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    04370099
043800     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    04380099
043900     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    04390099
044000     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    04400099
044100     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    04410099
044200     05  PV-DB2-TABLE-NAME            PIC  X(08) VALUE SPACES.    04420099
044300                                                                  04430099
044400******************************************************************04440099
044500*  INPUT FILE                                                     04450099
044600******************************************************************04460099
044700     COPY RCRD092.                                                04470099
044800                                                                  04480099
044900*CHG98147 - START                                                 04490099
045000***************************************************************** 04500099
045100*  STANDARD REPORT HEADER FOR A 200 COLUMN REPORT.              * 04510099
045200***************************************************************** 04520099
045300*                                                                 04530099
045400*    COPY DPWS200.                                                04540099
045500*                                                                 04550099
045600***************************************************************** 04560099
045700*  STANDARD REPORT HEADER FOR A 250 COLUMN REPORT.              * 04570099
045800***************************************************************** 04580099
045900*                                                                 04590099
046000     COPY DPWS250O.                                               04600099
046100*                                                                 04610099
046200*CHG98147 - END                                                   04620099
046300***********************************************************       04630099
046400*  DB2 SQL COMMUNICATION AREA                                     04640099
046500***********************************************************       04650099
046600     EXEC SQL                                                     04660099
046700         INCLUDE SQLCA                                            04670099
046800     END-EXEC.                                                    04680099
046900                                                                  04690099
047000***********************************************************       04700099
047100*  TSEASET                                                        04710099
047200***********************************************************       04720099
047300     EXEC SQL                                                     04730099
047400         INCLUDE TSEASET                                          04740099
047500     END-EXEC.                                                    04750099
047600                                                                  04760099
047700***********************************************************       04770099
047800*  XLT_DEPT(XLT00002)                                             04780099
047900***********************************************************       04790099
048000     EXEC SQL                                                     04800099
048100         INCLUDE XLT00002                                         04810099
048200     END-EXEC.                                                    04820099
048300                                                                  04830099
048400***********************************************************       04840099
048500*  USED FOR DB2 ERROR MESSAGE BUILDING                    *       04850099
048600***********************************************************       04860099
048700     COPY DPWS004.                                                04870099
048800                                                                  04880099
048900******************************************************************04890099
049000 PROCEDURE DIVISION.                                              04900099
049100******************************************************************04910099
049200 0000-PROGRAM-MAINLINE.                                           04920099
049300                                                                  04930099
049400     PERFORM 1000-INITIAL.                                        04940099
049500                                                                  04950099
049600     IF PS-NOT-EOF-INPUT                                          04960099
049700        PERFORM 2000-PROCESS-INPUT-FILE                           04970099
049800           UNTIL PS-EOF-INPUT                                     04980099
049900        PERFORM 9000-EOJ                                          04990099
050000     END-IF.                                                      05000099
050100                                                                  05010099
050200     PERFORM 9100-CLOSE-FILES.                                    05020099
050300                                                                  05030099
050400     GOBACK.                                                      05040099
050500                                                                  05050099
050600                                                                  05060099
050700 1000-INITIAL.                                                    05070099
050800                                                                  05080099
050900     OPEN INPUT  INPUT-FILE                                       05090099
051000          OUTPUT REPORT-FILE.                                     05100099
051100                                                                  05110099
051200*CHG98147 - START                                                 05120099
051300*    MOVE PC-PROGRAM-NAME TO DP200-PROGRAM-NAME.                  05130099
051400*    MOVE PC-REPORT-NBR TO DP200-REPORT-NUMBER.                   05140099
051500     MOVE PC-PROGRAM-NAME TO DP250O-PROGRAM-NAME.                 05150099
051600     MOVE PC-REPORT-NBR TO DP250O-REPORT-NUMBER.                  05160099
051700*CHG98147 - END                                                   05170099
051800                                                                  05180099
051900     PERFORM 7100-GET-TIMESTAMP.                                  05190099
052000                                                                  05200099
052100*CHG98147 - START                                                 05210099
052200*    MOVE 1                    TO DP200-REPORT-NUMBER.            05220099
052300*    MOVE 0                    TO DP200-PAGE-NUMBER.              05230099
052400     MOVE 1                    TO DP250O-REPORT-NUMBER.           05240099
052500     MOVE 0                    TO DP250O-PAGE-NUMBER.             05250099
052600*CHG98147 - END                                                   05260099
052700                                                                  05270099
052800     PERFORM 7000-READ-INPUT-FILE.                                05280099
052900                                                                  05290099
053000     IF PS-NOT-EOF-INPUT                                          05300099
053100        MOVE RC092-SEASET-YR TO WS-HOLD-SET-YR                    05310099
053200        MOVE RC092-SEASET-SHRT-NM TO WS-HOLD-SET                  05320099
053300        MOVE RC092-DEPT-NBR TO WS-HOLD-DEPT                       05330099
053400        MOVE RC092-DMA-NBR TO WS-HOLD-DMA-NBR                     05340099
053500        MOVE RC092-BUYER-NBR TO WS-HOLD-BYR-NBR                   05350099
053600        MOVE RC092-DMM-NM  TO WS-HOLD-DMM-NM                      05360099
053700        MOVE RC092-BUYER-NM  TO WS-HOLD-BYR-NM                    05370099
053800     ELSE                                                         05380099
053900        PERFORM 8200-NO-DATA                                      05390099
054000     END-IF.                                                      05400099
054100                                                                  05410099
054200******************************************************************05420099
054300* PROCESS INPUT RECORDS                                          *05430099
054400******************************************************************05440099
054500 2000-PROCESS-INPUT-FILE.                                         05450099
054600                                                                  05460099
054700     MOVE '2000-PROCESS-INPUT-FILE.'    TO PV-ABEND-PARAGRAPH.    05470099
054800                                                                  05480099
054900     MOVE RC092-DEPT-NBR TO PV-DEPT-NBR-N.                        05490099
055000     MOVE RC092-DMM-NM   TO WS-DTL-DMM-NAME.                      05500099
055100     MOVE RC092-BUYER-NM TO WS-DTL-BYR-NAME.                      05510099
055200     MOVE RC092-DEPT-NBR  TO WS-DTL-DEPT.                         05520099
055300     MOVE RC092-PO-NUMBER TO WS-DTL-PO.                           05530099
055400     MOVE RC092-TOT-VAL-COST-AMT TO WS-DTL-TOT-COST.              05540099
055500     MOVE RC092-TOT-VAL-RTL-AMT TO WS-DTL-TOT-RETAIL.             05550099
055600     MOVE RC092-TOT-SKUS-QTY TO WS-DTL-QTY-SKUS.                  05560099
055700     MOVE RC092-STATUS-CDE TO WS-DTL-STAT-CODE.                   05570099
055800     MOVE RC092-PKGNG-CDE TO WS-DTL-PKGNG-CDE.                    05580099
055900     MOVE RC092-SEASET-YR TO WS-DTL-SEASET-YR.                    05590099
056000     MOVE RC092-SEASET-SHRT-NM TO WS-DTL-SEASET-SHRT-NM.          05600099
056100     MOVE RC092-TOT-UNT-QTY TO WS-DTL-TOT-UNITS.                  05610099
056200*CHG98147 - START                                                 05620099
056300     MOVE RC092-PO-SPLIT-QTY TO WS-DTL-SPLIT-QTY.                 05630099
056400     MOVE RC092-PO-SPLIT-DIFF TO WS-DTL-SPLIT-DIFF.               05640099
056500*CHG98147 - END                                                   05650099
056600     MOVE RC092-PO-ALLOC-QTY TO WS-DTL-PO-ALLOC-QTY.              05660099
056700     MOVE RC092-PO-ALLOC-DIFF TO WS-DTL-PO-ALLOC-DIFF.            05670099
056800     MOVE RC092-RCVR-ALLOC-QTY TO WS-DTL-RCVR-ALLOC-QTY.          05680099
056900     MOVE RC092-RCVR-ALLOC-DIFF TO WS-DTL-RCVR-ALLOC-DIFF.        05690099
057000     MOVE RC092-RCVR-VERFYD-QTY TO WS-DTL-RCVR-VERFYD.            05700099
057100                                                                  05710099
057200     PERFORM 8000-WRITE-REPORT-RECORD.                            05720099
057300                                                                  05730099
057400     PERFORM 7000-READ-INPUT-FILE.                                05740099
057500                                                                  05750099
057600 3400-GET-SEASET-INFO.                                            05760099
057700                                                                  05770099
057800     MOVE '3400-GET-SEASET-INFO       ' TO PV-ABEND-PARAGRAPH.    05780099
057900                                                                  05790099
058000     EXEC SQL                                                     05800099
058100          SELECT SEASET_NM                                        05810099
058200            INTO :SEASET-SEASET-NM                                05820099
058300            FROM TSEASET                                          05830099
058400           WHERE SEASET_YR      = :SEASET-SEASET-YR               05840099
058500             AND SEASET_SHRT_NM = :SEASET-SEASET-SHRT-NM          05850099
058600     END-EXEC.                                                    05860099
058700                                                                  05870099
058800     EVALUATE TRUE                                                05880099
058900        WHEN SQLCODE = 0                                          05890099
059000           MOVE SEASET-SEASET-NM TO H2-SEASONAL-SET-NAME          05900099
059100        WHEN OTHER                                                05910099
059200           MOVE '3400-GET-SEASET-INFO'                            05920099
059300                                  TO PV-ABEND-PARAGRAPH           05930099
059400           MOVE 'SELECT TSEASET'                                  05940099
059500                                  TO PV-ABEND-OPERATION           05950099
059600           MOVE ' '               TO PV-ABEND-STRUCTURE-1         05960099
059700           MOVE 'SELECT      '    TO PV-DB2-OPERATION-MESSAGE-1   05970099
059800           PERFORM 9900-DB2-ABEND                                 05980099
059900     END-EVALUATE.                                                05990099
060000                                                                  06000099
060100 3500-GET-DEPT-INFO.                                              06010099
060200                                                                  06020099
060300     MOVE '3500-GET-DEPT-INFO       ' TO PV-ABEND-PARAGRAPH.      06030099
060400                                                                  06040099
060500     EXEC SQL                                                     06050099
060600          SELECT DEPT_NM                                          06060099
060700            INTO :XLT00002-DEPT-NM                                06070099
060800            FROM XLT_DEPT                                         06080099
060900           WHERE DEPT_NBR = :XLT00002-DEPT-NBR                    06090099
061000     END-EXEC.                                                    06100099
061100                                                                  06110099
061200     EVALUATE TRUE                                                06120099
061300        WHEN SQLCODE = 0                                          06130099
061400           MOVE XLT00002-DEPT-NM TO H3-DEPT-NAME                  06140099
061500        WHEN OTHER                                                06150099
061600           MOVE '3500-GET-DEPT-INFO'                              06160099
061700                                  TO PV-ABEND-PARAGRAPH           06170099
061800           MOVE 'SELECT XLT_DEPT'                                 06180099
061900                                  TO PV-ABEND-OPERATION           06190099
062000           MOVE ' '               TO PV-ABEND-STRUCTURE-1         06200099
062100           MOVE 'SELECT      '    TO PV-DB2-OPERATION-MESSAGE-1   06210099
062200           PERFORM 9900-DB2-ABEND                                 06220099
062300     END-EVALUATE.                                                06230099
062400                                                                  06240099
062500******************************************************************06250099
062600* MOVE DEPT TOTALS                                                06260099
062700******************************************************************06270099
062800 6000-MOVE-DEPT-TOTALS.                                           06280099
062900                                                                  06290099
063000     MOVE WS-HOLD-DEPT               TO WS-DPT-TOT-DEPT.          06300099
063100     MOVE PV-DPT-TOT-PO-QTY          TO WS-DPT-TOT-PO.            06310099
063200     MOVE PV-DPT-TOT-UNT-QTY         TO WS-DPT-TOT-UNITS.         06320099
063210*CHG98147 - START                                                 06321099
063211     MOVE PV-DPT-TOT-PO-SPLIT-QTY    TO WS-DPT-TOT-PO-SPLIT-QTY.  06321199
063212     MOVE PV-DPT-TOT-PO-SPLIT-DIFF   TO WS-DPT-TOT-PO-SPLIT-DIFF. 06321299
063220*CHG98147 - END                                                   06322099
063300     MOVE PV-DPT-TOT-PO-ALLOC-QTY    TO WS-DPT-TOT-PO-ALLOC-QTY.  06330099
063400     MOVE PV-DPT-TOT-PO-ALLOC-DIFF   TO WS-DPT-TOT-PO-ALLOC-DIFF. 06340099
063500     MOVE PV-DPT-TOT-RCVR-ALLOC-QTY  TO WS-DPT-TOT-RCVR-ALLOC-QTY.06350099
063600     MOVE PV-DPT-TOT-RCVR-ALLOC-DIFF TO                           06360099
063700        WS-DPT-TOT-RCVR-ALLOC-DIFF.                               06370099
063800     MOVE PV-DPT-TOT-RCVR-VERFYD-QTY TO WS-DPT-TOT-RCVR-VERFYD.   06380099
063900                                                                  06390099
064000******************************************************************06400099
064100* MOVE SET TOTALS                                                 06410099
064200******************************************************************06420099
064300 6100-MOVE-SET-TOTALS.                                            06430099
064400                                                                  06440099
064500     MOVE WS-HOLD-SET                TO WS-SET-TOT-SET.           06450099
064600     MOVE PV-SET-TOT-PO-QTY          TO WS-SET-TOT-PO.            06460099
064700     MOVE PV-SET-TOT-UNT-QTY         TO WS-SET-TOT-UNITS.         06470099
064710*CHG98147 - START                                                 06471099
064720     MOVE PV-SET-TOT-PO-SPLIT-QTY    TO WS-SET-TOT-PO-SPLIT-QTY.  06472099
064721     MOVE PV-SET-TOT-PO-SPLIT-DIFF   TO WS-SET-TOT-PO-SPLIT-DIFF. 06472199
064730*CHG98147 - END                                                   06473099
064800     MOVE PV-SET-TOT-PO-ALLOC-QTY    TO WS-SET-TOT-PO-ALLOC-QTY.  06480099
064900     MOVE PV-SET-TOT-PO-ALLOC-DIFF   TO WS-SET-TOT-PO-ALLOC-DIFF. 06490099
065000     MOVE PV-SET-TOT-RCVR-ALLOC-QTY  TO WS-SET-TOT-RCVR-ALLOC-QTY.06500099
065100     MOVE PV-SET-TOT-RCVR-ALLOC-DIFF TO                           06510099
065200        WS-SET-TOT-RCVR-ALLOC-DIFF.                               06520099
065300     MOVE PV-SET-TOT-RCVR-VERFYD-QTY TO WS-SET-TOT-RCVR-VERFYD.   06530099
065400                                                                  06540099
065500******************************************************************06550099
065600* MOVE RPT TOTALS                                                 06560099
065700******************************************************************06570099
065800 6200-MOVE-RPT-TOTALS.                                            06580099
065900                                                                  06590099
066000     MOVE PV-RPT-TOT-PO-QTY          TO WS-RPT-TOT-PO.            06600099
066100     MOVE PV-RPT-TOT-UNT-QTY         TO WS-RPT-TOT-UNITS.         06610099
066200     MOVE PV-RPT-TOT-PO-ALLOC-QTY    TO WS-RPT-TOT-PO-ALLOC-QTY.  06620099
066300     MOVE PV-RPT-TOT-PO-ALLOC-DIFF   TO WS-RPT-TOT-PO-ALLOC-DIFF. 06630099
066400     MOVE PV-RPT-TOT-RCVR-ALLOC-QTY  TO WS-RPT-TOT-RCVR-ALLOC-QTY.06640099
066500     MOVE PV-RPT-TOT-RCVR-ALLOC-DIFF TO                           06650099
066600        WS-RPT-TOT-RCVR-ALLOC-DIFF.                               06660099
066700     MOVE PV-RPT-TOT-RCVR-VERFYD-QTY TO WS-RPT-TOT-RCVR-VERFYD.   06670099
066800                                                                  06680099
066900******************************************************************06690099
067000* ACCUMULATE TOTALS                                               06700099
067100******************************************************************06710099
067200 6300-ACCUM-TOTALS.                                               06720099
067300                                                                  06730099
067400     ADD 1                     TO  PV-DPT-TOT-PO-QTY.             06740099
067500     ADD RC092-TOT-UNT-QTY     TO  PV-DPT-TOT-UNT-QTY.            06750099
067510*CHG98147 - START                                                 06751099
067520     ADD RC092-PO-SPLIT-QTY    TO  PV-DPT-TOT-PO-SPLIT-QTY.       06752099
067521     ADD RC092-PO-SPLIT-DIFF   TO  PV-DPT-TOT-PO-SPLIT-DIFF.      06752199
067530*CHG98147 - END                                                   06753099
067600     ADD RC092-PO-ALLOC-QTY    TO  PV-DPT-TOT-PO-ALLOC-QTY.       06760099
067700     ADD RC092-PO-ALLOC-DIFF   TO  PV-DPT-TOT-PO-ALLOC-DIFF.      06770099
067800     ADD RC092-RCVR-ALLOC-QTY  TO  PV-DPT-TOT-RCVR-ALLOC-QTY.     06780099
067900     ADD RC092-RCVR-ALLOC-DIFF TO  PV-DPT-TOT-RCVR-ALLOC-DIFF.    06790099
068000     ADD RC092-RCVR-VERFYD-QTY TO  PV-DPT-TOT-RCVR-VERFYD-QTY.    06800099
068100                                                                  06810099
068200     ADD 1                     TO  PV-SET-TOT-PO-QTY.             06820099
068300     ADD RC092-TOT-UNT-QTY     TO  PV-SET-TOT-UNT-QTY.            06830099
068310*CHG98147 - START                                                 06831099
068320     ADD RC092-PO-SPLIT-QTY    TO  PV-SET-TOT-PO-SPLIT-QTY.       06832099
068321     ADD RC092-PO-SPLIT-DIFF   TO  PV-SET-TOT-PO-SPLIT-DIFF.      06832199
068330*CHG98147 - END                                                   06833099
068400     ADD RC092-PO-ALLOC-QTY    TO  PV-SET-TOT-PO-ALLOC-QTY.       06840099
068500     ADD RC092-PO-ALLOC-DIFF   TO  PV-SET-TOT-PO-ALLOC-DIFF.      06850099
068600     ADD RC092-RCVR-ALLOC-QTY  TO  PV-SET-TOT-RCVR-ALLOC-QTY.     06860099
068700     ADD RC092-RCVR-ALLOC-DIFF TO  PV-SET-TOT-RCVR-ALLOC-DIFF.    06870099
068800     ADD RC092-RCVR-VERFYD-QTY TO  PV-SET-TOT-RCVR-VERFYD-QTY.    06880099
068900                                                                  06890099
069000     ADD 1                     TO  PV-RPT-TOT-PO-QTY.             06900099
069100     ADD RC092-TOT-UNT-QTY     TO  PV-RPT-TOT-UNT-QTY.            06910099
069200     ADD RC092-PO-ALLOC-QTY    TO  PV-RPT-TOT-PO-ALLOC-QTY.       06920099
069300     ADD RC092-PO-ALLOC-DIFF   TO  PV-RPT-TOT-PO-ALLOC-DIFF.      06930099
069400     ADD RC092-RCVR-ALLOC-QTY  TO  PV-RPT-TOT-RCVR-ALLOC-QTY.     06940099
069500     ADD RC092-RCVR-ALLOC-DIFF TO  PV-RPT-TOT-RCVR-ALLOC-DIFF.    06950099
069600     ADD RC092-RCVR-VERFYD-QTY TO  PV-RPT-TOT-RCVR-VERFYD-QTY.    06960099
069700                                                                  06970099
069800******************************************************************06980099
069900* READS RECORD FROM THE INPUT FILE                                06990099
070000******************************************************************07000099
070100 7000-READ-INPUT-FILE.                                            07010099
070200     MOVE '7000-READ-INPUT-FILE.'      TO  PV-ABEND-PARAGRAPH.    07020099
070300                                                                  07030099
070400     READ INPUT-FILE                                              07040099
070500          INTO RCRD092-SEASET-PO-EXTRACT                          07050099
070600            AT END                                                07060099
070700               SET PS-EOF-INPUT     TO TRUE.                      07070099
070800                                                                  07080099
070900     IF PS-NOT-EOF-INPUT                                          07090099
071000        ADD 1 TO PV-RECORDS-READ                                  07100099
071100     END-IF.                                                      07110099
071200                                                                  07120099
071300******************************************************************07130099
071400 7100-GET-TIMESTAMP.                                              07140099
071500***************************************************************** 07150099
071600                                                                  07160099
071700     MOVE '7100-GET-TIMESTAMP         ' TO PV-ABEND-PARAGRAPH.    07170099
071800                                                                  07180099
071900     EXEC SQL                                                     07190099
072000         SET :PV-TMST = CURRENT TIMESTAMP                         07200099
072100     END-EXEC.                                                    07210099
072200                                                                  07220099
072300     EVALUATE TRUE                                                07230099
072400        WHEN SQLCODE = ZERO                                       07240099
072500           MOVE PV-TMST(1:10)    TO PV-DATE                       07250099
072600*CHG98147 - START                                                 07260099
072700*          MOVE PV-TMST(1:4)     TO DP200-RUN-YEAR                07270099
072800*          MOVE PV-TMST(6:2)     TO DP200-RUN-MONTH               07280099
072900*          MOVE PV-TMST(9:2)     TO DP200-RUN-DAY                 07290099
073000*          MOVE PV-TMST(12:2)    TO DP200-RUN-HOUR                07300099
073100*          MOVE PV-TMST(15:2)    TO DP200-RUN-MINUTE              07310099
073200           MOVE PV-TMST(1:4)     TO DP250O-RUN-YEAR               07320099
073300           MOVE PV-TMST(6:2)     TO DP250O-RUN-MONTH              07330099
073400           MOVE PV-TMST(9:2)     TO DP250O-RUN-DAY                07340099
073500           MOVE PV-TMST(12:2)    TO DP250O-RUN-HOUR               07350099
073600           MOVE PV-TMST(15:2)    TO DP250O-RUN-MINUTE             07360099
073700*CHG98147 - END                                                   07370099
073800        WHEN OTHER                                                07380099
073900           MOVE '7100-GET-TIMESTAMP'                              07390099
074000                                  TO PV-ABEND-PARAGRAPH           07400099
074100           MOVE 'SET TIMESTAMP  ' TO PV-ABEND-OPERATION           07410099
074200           MOVE ' '               TO PV-ABEND-STRUCTURE-1         07420099
074300           MOVE 'SET TIMESTAMP'   TO PV-DB2-OPERATION-MESSAGE-1   07430099
074400           PERFORM 9900-DB2-ABEND                                 07440099
074500     END-EVALUATE.                                                07450099
074600                                                                  07460099
074700******************************************************************07470099
074800* WRITE OUTPUT                                                    07480099
074900******************************************************************07490099
075000 8000-WRITE-REPORT-RECORD.                                        07500099
075100                                                                  07510099
075200     IF (RC092-SEASET-YR = WS-HOLD-SET-YR) AND                    07520099
075300        (RC092-SEASET-SHRT-NM = WS-HOLD-SET)                      07530099
075400        IF RC092-DMA-NBR = WS-HOLD-DMA-NBR                        07540099
075500           IF RC092-BUYER-NBR = WS-HOLD-BYR-NBR                   07550099
075600              IF RC092-DEPT-NBR = WS-HOLD-DEPT                    07560099
075700                 IF PV-LINE-COUNT > PC-MAX-LINES                  07570099
075800                    PERFORM 8100-NEW-PAGE                         07580099
075900                 END-IF                                           07590099
076000              ELSE                                                07600099
076100                 INITIALIZE WS-DPT-TOT-REC                        07610099
076200                 PERFORM 6000-MOVE-DEPT-TOTALS                    07620099
076300                 WRITE REPORT-RECORD FROM WS-DPT-TOT-REC          07630099
076400                     AFTER ADVANCING 2 LINE                       07640099
076500                 WRITE REPORT-RECORD FROM WS-BLANK-LINE           07650099
076600                     AFTER ADVANCING 1 LINES                      07660099
076700                 ADD 3 TO PV-LINE-COUNT                           07670099
076800                 MOVE RC092-DEPT-NBR TO WS-HOLD-DEPT              07680099
076900                 INITIALIZE PV-DEPT-TOTALS                        07690099
077000                 PERFORM 8100-NEW-PAGE                            07700099
077100              END-IF                                              07710099
077200           ELSE                                                   07720099
077300              INITIALIZE WS-DPT-TOT-REC                           07730099
077400              PERFORM 6000-MOVE-DEPT-TOTALS                       07740099
077500              WRITE REPORT-RECORD FROM WS-DPT-TOT-REC             07750099
077600                  AFTER ADVANCING 2 LINE                          07760099
077700              WRITE REPORT-RECORD FROM WS-BLANK-LINE              07770099
077800                  AFTER ADVANCING 1 LINES                         07780099
077900              ADD 3 TO PV-LINE-COUNT                              07790099
078000              MOVE RC092-DEPT-NBR TO WS-HOLD-DEPT                 07800099
078100              MOVE RC092-BUYER-NM TO WS-HOLD-BYR-NM               07810099
078200              MOVE RC092-BUYER-NBR TO WS-HOLD-BYR-NBR             07820099
078300              INITIALIZE PV-DEPT-TOTALS                           07830099
078400              PERFORM 8100-NEW-PAGE                               07840099
078500           END-IF                                                 07850099
078600        ELSE                                                      07860099
078700           INITIALIZE WS-DPT-TOT-REC                              07870099
078800           PERFORM 6000-MOVE-DEPT-TOTALS                          07880099
078900           WRITE REPORT-RECORD FROM WS-DPT-TOT-REC                07890099
079000               AFTER ADVANCING 2 LINE                             07900099
079100           WRITE REPORT-RECORD FROM WS-BLANK-LINE                 07910099
079200               AFTER ADVANCING 1 LINES                            07920099
079300           ADD 3 TO PV-LINE-COUNT                                 07930099
079400           MOVE RC092-DMM-NM TO WS-HOLD-DMM-NM                    07940099
079500           MOVE RC092-DMA-NBR TO WS-HOLD-DMA-NBR                  07950099
079600           MOVE RC092-BUYER-NM TO WS-HOLD-BYR-NM                  07960099
079700           MOVE RC092-BUYER-NBR TO WS-HOLD-BYR-NBR                07970099
079800           MOVE RC092-DEPT-NBR TO WS-HOLD-DEPT                    07980099
079900           INITIALIZE PV-DEPT-TOTALS                              07990099
080000           PERFORM 8100-NEW-PAGE                                  08000099
080100        END-IF                                                    08010099
080200     ELSE                                                         08020099
080300        INITIALIZE WS-DPT-TOT-REC                                 08030099
080400        PERFORM 6000-MOVE-DEPT-TOTALS                             08040099
080500        WRITE REPORT-RECORD FROM WS-DPT-TOT-REC                   08050099
080600            AFTER ADVANCING 2 LINE                                08060099
080700        WRITE REPORT-RECORD FROM WS-BLANK-LINE                    08070099
080800            AFTER ADVANCING 1 LINES                               08080099
080900        ADD 3 TO PV-LINE-COUNT                                    08090099
081000        MOVE RC092-DEPT-NBR TO WS-HOLD-DEPT                       08100099
081100        INITIALIZE PV-DEPT-TOTALS                                 08110099
081200                                                                  08120099
081300        INITIALIZE WS-SET-TOT-REC                                 08130099
081400        PERFORM 6100-MOVE-SET-TOTALS                              08140099
081500        WRITE REPORT-RECORD FROM WS-SET-TOT-REC                   08150099
081600            AFTER ADVANCING 2 LINE                                08160099
081700        WRITE REPORT-RECORD FROM WS-BLANK-LINE                    08170099
081800            AFTER ADVANCING 1 LINES                               08180099
081900        ADD 3 TO PV-LINE-COUNT                                    08190099
082000        MOVE RC092-DMM-NM TO WS-HOLD-DMM-NM                       08200099
082100        MOVE RC092-DMA-NBR TO WS-HOLD-DMA-NBR                     08210099
082200        MOVE RC092-BUYER-NM TO WS-HOLD-BYR-NM                     08220099
082300        MOVE RC092-BUYER-NBR TO WS-HOLD-BYR-NBR                   08230099
082400        MOVE RC092-DEPT-NBR TO WS-HOLD-DEPT                       08240099
082500        MOVE RC092-SEASET-YR TO WS-HOLD-SET-YR                    08250099
082600        MOVE RC092-SEASET-SHRT-NM TO WS-HOLD-SET                  08260099
082700        INITIALIZE PV-SET-TOTALS                                  08270099
082800                                                                  08280099
082900        PERFORM 8100-NEW-PAGE                                     08290099
083000     END-IF.                                                      08300099
083100                                                                  08310099
083200     WRITE REPORT-RECORD FROM WS-DETAIL-REC                       08320099
083300         AFTER ADVANCING 1 LINE.                                  08330099
083400                                                                  08340099
083500     ADD 1 TO PV-DETAIL-WRITES.                                   08350099
083600     ADD 1 TO PV-LINE-COUNT.                                      08360099
083700                                                                  08370099
083800     PERFORM 6300-ACCUM-TOTALS.                                   08380099
083900                                                                  08390099
084000******************************************************************08400099
084100* NEW PAGE                                                        08410099
084200******************************************************************08420099
084300 8100-NEW-PAGE.                                                   08430099
084400                                                                  08440099
084500     ADD 1 TO PV-PAGE-COUNT.                                      08450099
084600*CHG98147 - START                                                 08460099
084700*    MOVE PV-PAGE-COUNT TO DP200-PAGE-NUMBER.                     08470099
084800     MOVE PV-PAGE-COUNT TO DP250O-PAGE-NUMBER.                    08480099
084900                                                                  08490099
085000*    WRITE REPORT-RECORD FROM DP200-STANDRD-HEADER-200-COLS       08500099
085100     WRITE REPORT-RECORD FROM DP250O-STANDRD-HEADER-250-COLS      08510099
085200         AFTER ADVANCING PAGE.                                    08520099
085300*CHG98147 - END                                                   08530099
085400                                                                  08540099
085500     WRITE REPORT-RECORD FROM WS-RPT-HEADER1                      08550099
085600         AFTER ADVANCING 2 LINES.                                 08560099
085700                                                                  08570099
085800     INITIALIZE WS-RPT-SECTION.                                   08580099
085900     MOVE WS-HOLD-SET-YR(3:2) TO SECT-SEASET-YY.                  08590099
086000     MOVE WS-HOLD-SET TO SECT-SEASET-SHRT-NM.                     08600099
086100     MOVE WS-HOLD-DMA-NBR TO SECT-DMA-NBR.                        08610099
086200     MOVE WS-HOLD-BYR-NBR TO SECT-BYR-NBR.                        08620099
086300     MOVE WS-HOLD-DEPT TO SECT-DPT-NBR.                           08630099
086400                                                                  08640099
086500     WRITE REPORT-RECORD FROM WS-RPT-SECTION                      08650099
086600         AFTER ADVANCING 1 LINES.                                 08660099
086700                                                                  08670099
086800     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       08680099
086900         AFTER ADVANCING 1 LINES.                                 08690099
087000                                                                  08700099
087100     MOVE WS-HOLD-SET-YR TO SEASET-SEASET-YR.                     08710099
087200     MOVE WS-HOLD-SET    TO SEASET-SEASET-SHRT-NM.                08720099
087300                                                                  08730099
087400     PERFORM 3400-GET-SEASET-INFO.                                08740099
087500                                                                  08750099
087600     MOVE WS-HOLD-SET-YR TO H2-SEASET-CCYY.                       08760099
087700     MOVE WS-HOLD-SET    TO H2-SEASET-SHRT-NM.                    08770099
087800                                                                  08780099
087900     WRITE REPORT-RECORD FROM WS-RPT-HEADER2                      08790099
088000         AFTER ADVANCING 1 LINES.                                 08800099
088100                                                                  08810099
088200     MOVE WS-HOLD-DMM-NM TO H2A-DMM-NM.                           08820099
088300     MOVE WS-HOLD-BYR-NM TO H2A-BYR-NM.                           08830099
088400     MOVE WS-HOLD-DMA-NBR TO H2A-DMA-NBR.                         08840099
088500     MOVE WS-HOLD-BYR-NBR TO H2A-BYR-NBR.                         08850099
088600                                                                  08860099
088700     WRITE REPORT-RECORD FROM WS-RPT-HEADER2A                     08870099
088800         AFTER ADVANCING 1 LINES.                                 08880099
088900                                                                  08890099
089000     MOVE WS-HOLD-DEPT TO XLT00002-DEPT-NBR.                      08900099
089100     MOVE WS-HOLD-DEPT TO H3-DEPT.                                08910099
089200                                                                  08920099
089300     PERFORM 3500-GET-DEPT-INFO.                                  08930099
089400                                                                  08940099
089500     WRITE REPORT-RECORD FROM WS-RPT-HEADER3                      08950099
089600         AFTER ADVANCING 1 LINES.                                 08960099
089700                                                                  08970099
089800     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       08980099
089900         AFTER ADVANCING 1 LINES.                                 08990099
090000                                                                  09000099
090100     WRITE REPORT-RECORD FROM WS-RPT-HEADER4                      09010099
090200         AFTER ADVANCING 1 LINES.                                 09020099
090300                                                                  09030099
090400     WRITE REPORT-RECORD FROM WS-RPT-HEADER5                      09040099
090500         AFTER ADVANCING 1 LINES.                                 09050099
090600                                                                  09060099
090700     WRITE REPORT-RECORD FROM WS-RPT-HEADER6                      09070099
090800         AFTER ADVANCING 1 LINES.                                 09080099
090900                                                                  09090099
091000     WRITE REPORT-RECORD FROM WS-RPT-HEADER7                      09100099
091100         AFTER ADVANCING 1 LINES.                                 09110099
091200                                                                  09120099
091300     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       09130099
091400         AFTER ADVANCING 1 LINES.                                 09140099
091500                                                                  09150099
091600     MOVE 14 TO PV-LINE-COUNT.                                    09160099
091700                                                                  09170099
091800******************************************************************09180099
091900* NO DATA                                                         09190099
092000******************************************************************09200099
092100 8200-NO-DATA.                                                    09210099
092200                                                                  09220099
092300     ADD 1 TO PV-PAGE-COUNT.                                      09230099
092400*CHG98147 - START                                                 09240099
092500*    MOVE PV-PAGE-COUNT TO DP200-PAGE-NUMBER.                     09250099
092600     MOVE PV-PAGE-COUNT TO DP250O-PAGE-NUMBER.                    09260099
092700                                                                  09270099
092800*    WRITE REPORT-RECORD FROM DP200-STANDRD-HEADER-200-COLS       09280099
092900     WRITE REPORT-RECORD FROM DP250O-STANDRD-HEADER-250-COLS      09290099
093000         AFTER ADVANCING PAGE.                                    09300099
093100*CHG98147 - END                                                   09310099
093200                                                                  09320099
093300     WRITE REPORT-RECORD FROM WS-RPT-HEADER1                      09330099
093400         AFTER ADVANCING 2 LINES.                                 09340099
093500                                                                  09350099
093600     WRITE REPORT-RECORD FROM WS-RPT-SEC-NO-DATA                  09360099
093700         AFTER ADVANCING 1 LINES.                                 09370099
093800                                                                  09380099
093900     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       09390099
094000         AFTER ADVANCING 1 LINES.                                 09400099
094100                                                                  09410099
094200     WRITE REPORT-RECORD FROM WS-RPT-HEADER4                      09420099
094300         AFTER ADVANCING 1 LINES.                                 09430099
094400                                                                  09440099
094500     WRITE REPORT-RECORD FROM WS-RPT-HEADER5                      09450099
094600         AFTER ADVANCING 1 LINES.                                 09460099
094700                                                                  09470099
094800     WRITE REPORT-RECORD FROM WS-RPT-HEADER6                      09480099
094900         AFTER ADVANCING 1 LINES.                                 09490099
095000                                                                  09500099
095100     WRITE REPORT-RECORD FROM WS-RPT-HEADER7                      09510099
095200         AFTER ADVANCING 1 LINES.                                 09520099
095300                                                                  09530099
095400     WRITE REPORT-RECORD FROM WS-BLANK-LINE                       09540099
095500         AFTER ADVANCING 1 LINES.                                 09550099
095600                                                                  09560099
095700     WRITE REPORT-RECORD FROM PC-NO-INPUT-LINE                    09570099
095800         AFTER ADVANCING 1 LINES.                                 09580099
095900                                                                  09590099
096000 9000-EOJ.                                                        09600099
096100                                                                  09610099
096200     PERFORM 6000-MOVE-DEPT-TOTALS.                               09620099
096300     PERFORM 6100-MOVE-SET-TOTALS.                                09630099
096400     PERFORM 6200-MOVE-RPT-TOTALS.                                09640099
096500                                                                  09650099
096600     IF PV-LINE-COUNT > PC-MAX-LINES                              09660099
096700        PERFORM 8100-NEW-PAGE                                     09670099
096800     END-IF.                                                      09680099
096900                                                                  09690099
097000     WRITE REPORT-RECORD FROM WS-DPT-TOT-REC                      09700099
097100         AFTER ADVANCING 2 LINES.                                 09710099
097200     WRITE REPORT-RECORD FROM WS-SET-TOT-REC                      09720099
097300         AFTER ADVANCING 2 LINES.                                 09730099
097400     WRITE REPORT-RECORD FROM PC-END-OF-REPORT-LINE               09740099
097500         AFTER ADVANCING 2 LINES.                                 09750099
097600                                                                  09760099
097700******************************************************************09770099
097800*   CLOSE FILES                                                   09780099
097900******************************************************************09790099
098000 9100-CLOSE-FILES.                                                09800099
098100                                                                  09810099
098200*DISPLAY COUNTS.                                                  09820099
098300     DISPLAY ' '.                                                 09830099
098400     DISPLAY '*********** RCKRP082 COUNTS ************'.          09840099
098500     DISPLAY '*** RECORDS READ     ==> ' PV-RECORDS-READ.         09850099
098600     DISPLAY '*** DETAILS WRITTEN  ==> ' PV-DETAIL-WRITES.        09860099
098700     DISPLAY '****************************************'.          09870099
098800     DISPLAY ' '.                                                 09880099
098900                                                                  09890099
099000     CLOSE INPUT-FILE                                             09900099
099100           REPORT-FILE.                                           09910099
099200                                                                  09920099
099300******************************************************************09930099
099400 9900-DB2-ABEND.                                                  09940099
099500******************************************************************09950099
099600                                                                  09960099
099700     MOVE SQLCODE TO PV-SQLCODE.                                  09970099
099800     DISPLAY '*** DB2 ERROR '.                                    09980099
099900     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       09990099
100000     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 10000099
100100     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               10010099
100200     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               10020099
100300     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       10030099
100400     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       10040099
100500     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                10050099
100600                                                                  10060099
100700*ABEND                                                            10070099
100800                                                                  10080099
100900     DISPLAY '*** RCKRP082 ABEND ***'.                            10090099
101000                                                                  10100099
101100     COPY DPPD004.                                                10110099
101200                                                                  10120099
101300     MOVE +4013 TO PV-ABEND-CODE.                                 10130099
101400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10140099
