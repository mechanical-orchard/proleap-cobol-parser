000100*-----------------------*                                         00010039
000200 IDENTIFICATION DIVISION.                                         00020039
000300*-----------------------*                                         00030039
000400 PROGRAM-ID.    APKCS320.                                         00040039
000500 AUTHOR.        PAT DOYLE.                                        00050039
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060039
000700 DATE-WRITTEN.  05/24/94.                                         00070039
000800 DATE-COMPILED.                                                   00080039
000900                                                                  00090039
001000*----------------------------------------------------------------*00100039
001100*    A320 - INVOICE SELECTION CRITERIA SPECIFICATION             *00110039
001200*                                                                *00120039
001300*    THIS PROGRAM ALLOWS THE USER ENTER DATA TO BE USED BY       *00130039
001400*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00140039
001500*    DETAIL SCREEN.                                              *00150039
001600*                                                                *00160039
001700*    EDITS DONE BY THIS PROGRAM ARE:                             *00170039
001800*    -- PO NUMBER MUST BE NUMERIC, IF ENTERED.                   *00180039
001900*    -- SELECTION DATE MUST BE NUMERIC, IF ENTERED.              *00190039
002000*    -- SELECTION DATE MUST BE A VALID DATE, IF ENTERED.         *00200039
002100*                                                                *00210039
002200*    ANY OTHER EDITS ARE DONE IN THE SUBSEQUENT PROGRAMS.        *00220039
002300*                                                                *00230039
002400*----------------------------------------------------------------*00240039
002500*                                                               * 00250039
002600* CHANGE LOG:                                                   * 00260039
002700*                                                               * 00270039
002800* 01/12/95    BMW  ADDED STORE NUMBER TO THE SCREEN.  THE STR   * 00280039
002900*                  NUMBER SHOULD BE CLEARED WHEN RETURNING TO   * 00290039
003000*                  THIS SCREEN FROM ANOTHER SCREEN.             * 00300039
003100*                                                               * 00310039
003200* 08/25/97   CHRIS KUNSTMANN     TKMA318     WR/IR #: WR4164    * 00320039
003300*              - ADDED INVOICE TYPE TO MAP.                     * 00330039
003400*              - MODIFIED PARAGRAPHS WITH NEW FIELD LOGIC:      * 00340039
003500*  2110-PREPARE-INTER-APPL-COMM, 2200-MOVE-SCREEN-TO-COMMAREA,  * 00350039
003600*  3200-RESET-ATTRIBUTES, 4400-MOVE-COMMAREA-TO-SCREEN          * 00360039
003700*                                                               * 00370039
003800* 02/03/98   ROBIN BERNOSKI      TKMA373     WR/IR #: WR5703    * 00380039
003900*            - MODIFIED THE MANNER IN WHICH THE STANDARD DATE   * 00390039
004000*              ROUTINE, DPKUT500, IS TO BE CALLED WITHIN A      * 00400039
004100*              PROGRAM SO THAT THE CALL IS DYNAMIC.             * 00410039
004200*            - REPLACED ++INCLUDES WITH COPY STATEMENTS.        * 00420039
004300*                                                               * 00430039
004400* 12/08/1999 JILL JUEL                       WR/IR #: WR6041    * 00440039
004500*            - MODIFIED THE CHECK ON THE DATE ROUTINE TO        * 00450039
004600*              CONFORM WITH Y2K STANDARDS BY ADDING             * 00460039
004700*              DPG54-WARNING-ERROR.                             * 00470039
004800*                                                               * 00480039
004900* 05/04/2000 MIKE BESKE                      WR/IR #: WR20978   * 00490040
005000*            - ADDED A REFERENCE FOR THE NEW FUNCTION KEY PF24  * 00500040
005100*              THAT WILL TRANSFER TO THE UPDATE INVOICE TO BULK * 00510040
005200*              PROGRAM (APKCS367).                              * 00520040
005300*                                                               * 00530040
005400* 04/23/2004 MIKE BESKE                      WR/IR #: WR25805   * 00540041
005500*            - INCREASED THE SIZE OF ASC-STR-NUMBER TO 4 CHARS  * 00550041
005600*              AS PART OF STORE CONSTRAINTS PROJECT.            * 00560041
005700*                                                               * 00570041
005710* 03/11/2007 ROLF NOHE                       WR/IR #: WR21578   * 00571049
005720*            - MATCH BY DC PROJECT.                             * 00572047
005730*              ADDED DC NUMBER TO THE MAP APKM320.  ADDED       * 00573048
005731*              DC-NBR AND MTCH-LVL-CDE TO THE COMMAREA APWS300. * 00573148
005732*              ADDED DC-NBR LOGIC TO PARAGRAPHS 1000-, 2110-,   * 00573248
005733*              2200-, AND 4400-.                                * 00573348
005740*                                                               * 00574042
005750* 09/01/2021 GERMAN BANDA                    WR/IR #: CHG0261053* 00575054
005760*            - CHANGE CALL OF DPKUT100 TO                       * 00576053
005770*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00577050
005780*              MAKING THE CALL DYNAMIC VS STATIC                * 00578050
005792*                                                               * 00579250
005793*                                                               * 00579356
005794* 10/21/2022 BOB MCASEY                      WR/IR #: CHG0      * 00579456
005795*            - CICS ARCHITECTURE CHANGES                        * 00579556
005796*              ADD DPWS930 AND CHANGED THE CALL                 * 00579656
005797*              TO THE CICS API TO DP930-CICS-ARCH-API           * 00579756
005798*                                                               * 00579856
005800*---------------------------------------------------------------* 00580039
005900                                                                  00590039
006000 ENVIRONMENT DIVISION.                                            00600039
006100                                                                  00610039
006200 DATA DIVISION.                                                   00620039
006300                                                                  00630039
006400 WORKING-STORAGE SECTION.                                         00640039
006500                                                                  00650039
006600 01  PC-PROGRAM-CONSTANTS.                                        00660039
006700     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'AP320A  '. 00670039
006800     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'APKM320 '. 00680039
006900     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'APKCS320'. 00690039
007000     05  PC-TSYMSG-NUMBERS.                                       00700039
007100         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00710039
007200         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00720039
007300         10  PC-TSYMSG-00527       PIC  9(05)  VALUE  00527.      00730039
007400                                                                  00740039
007500 01  PS-PROGRAM-SWITCHES.                                         00750039
007600     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00760039
007700         88  PS-ERROR                          VALUE  'Y'.        00770039
007800         88  PS-NO-ERROR                       VALUE  'N'.        00780039
007900                                                                  00790039
008000*----------------------------------------------------------------*00800039
008100*    MAP LAYOUT                                                  *00810039
008200*----------------------------------------------------------------*00820039
008300                                                                  00830039
008400     COPY APKM320.                                                00840039
008500                                                                  00850039
008600*----------------------------------------------------------------*00860039
008700*    ATTRIBUTE SETTINGS COPYBOOK.                                *00870039
008800*----------------------------------------------------------------*00880039
008900                                                                  00890039
009000     COPY DPWS015.                                                00900039
009100                                                                  00910039
009200*----------------------------------------------------------------*00920039
009300*    FUNCTION KEYS COPYBOOK                                      *00930039
009400*----------------------------------------------------------------*00940039
009500                                                                  00950039
009600     COPY DPWS016.                                                00960039
009700 EJECT                                                            00970039
009800*----------------------------------------------------------------*00980039
009900*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *00990039
010000*  SUB-ROUTINE (DPKUT100).                                       *01000039
010100*----------------------------------------------------------------*01010039
010200     COPY DPWS010I.                                               01020039
010300 EJECT                                                            01030039
010400*----------------------------------------------------------------*01040039
010500*  DATE VALIDATION CALLING PARAMETER LIST                        *01050039
010600*----------------------------------------------------------------*01060039
010700     COPY DPWS500.                                                01070039
010800 EJECT                                                            01080039
010900*----------------------------------------------------------------*01090039
011000*    CURRENT DATE/TIME COPYBOOK                                  *01100039
011100*----------------------------------------------------------------*01110039
011200                                                                  01120039
011300     COPY DPWS017.                                                01130039
011400                                                                  01140039
011500*----------------------------------------------------------------*01150039
011600*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *01160039
011700*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *01170039
011800*----------------------------------------------------------------*01180039
011900     COPY DPWS030.                                                01190039
011910     COPY DPWS930.                                                01191055
012000 EJECT                                                            01200039
012100*---------------------------------------------------------------* 01210039
012200*    STANDARD COMMAREA.                                         * 01220039
012300*---------------------------------------------------------------* 01230039
012400                                                                  01240039
012500     COPY DPWS020.                                                01250039
012600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01260039
012700                                                                  01270039
012800*---------------------------------------------------------------* 01280039
012900*    INTER-APPLICATION COMMAREA.                                * 01290039
013000*---------------------------------------------------------------* 01300039
013100                                                                  01310039
013200         10  INTER-APPL-COMM-AREA PIC X(200).                     01320039
013300     COPY APWS300.                                                01330039
013400*---------------------------------------------------------------* 01340039
013500*    SPECIFIC COMMMAREA FOR APKCS320.                           * 01350039
013600*---------------------------------------------------------------* 01360039
013700         10  ASC-SPECIFIC-COMMAREA.                               01370039
013800             15  ASC-PO-NUMBER               PIC  X(09).          01380039
013900             15  ASC-PO-NUMBER-N REDEFINES ASC-PO-NUMBER          01390039
014000                                             PIC  9(09).          01400039
014100             15  ASC-VENDOR-NUMBER           PIC  X(09).          01410039
014200             15  ASC-INVC-NUMBER             PIC  X(22).          01420039
014300             15  ASC-STR-NUMBER              PIC  X(04).          01430041
014400             15  ASC-INVC-STATUS             PIC  X(02).          01440039
014500             15  ASC-SEL-DATE.                                    01450039
014600                 20  ASC-SEL-MM              PIC  X(02).          01460039
014700                 20  ASC-SEL-MM-N REDEFINES ASC-SEL-MM            01470039
014800                                             PIC  9(02).          01480039
014900                 20  ASC-SEL-DD              PIC  X(02).          01490039
015000                 20  ASC-SEL-DD-N REDEFINES ASC-SEL-DD            01500039
015100                                             PIC  9(02).          01510039
015200                 20  ASC-SEL-YY              PIC  X(02).          01520039
015300                 20  ASC-SEL-YY-N REDEFINES ASC-SEL-YY            01530039
015400                                             PIC  9(02).          01540039
015500             15  ASC-INVC-TYP-CDE            PIC  X(02).          01550039
015600             15  ASC-SEL-DATE-DB2            PIC  X(10).          01560039
015610             15  ASC-DC-NUMBER               PIC  X(04).          01561046
015700     EJECT                                                        01570039
015800*----------------------------------------------------------------*01580039
015900*    ABEND PROCESSING COPYBOOK.                                  *01590039
016000*----------------------------------------------------------------*01600039
016100                                                                  01610039
016200     COPY DPWS013.                                                01620039
016300                                                                  01630039
016400 EJECT                                                            01640039
016500 LINKAGE SECTION.                                                 01650039
016600                                                                  01660039
016700 01  DFHCOMMAREA.                                                 01670039
016800     05  FILLER                         OCCURS  1 TO 4072 TIMES   01680039
016900                                        DEPENDING ON EIBCALEN.    01690039
017000         10  FILLER                     PIC X.                    01700039
017100                                                                  01710039
017200 PROCEDURE DIVISION.                                              01720039
017300                                                                  01730039
017400*---------------------------------------------------------------* 01740039
017500*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.  * 01750039
017600*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API   * 01760039
017700*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.             * 01770039
017800*                                                               * 01780039
017900*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE   * 01790039
018000*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.        * 01800039
018100*---------------------------------------------------------------* 01810039
018200                                                                  01820039
018300 0000-MAIN-MODULE.                                                01830039
018400                                                                  01840039
018500     INITIALIZE DP030-CICS-API-FIELDS.                            01850039
018600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01860039
018700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01870039
018800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01880039
018900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01890039
019000     MOVE LENGTH OF AP320AI        TO DP030-MAP-LENGTH (1).       01900039
019100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01910039
019200     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       01920039
019300     PERFORM 0001-CALL-CICS-ARCH-API.                             01930039
019400                                                                  01940039
019500     PERFORM 1000-CONTROL-PROCESSING                              01950039
019600                                                                  01960039
019700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01970039
019800     PERFORM 0001-CALL-CICS-ARCH-API.                             01980039
019900                                                                  01990039
020000*---------------------------------------------------------------* 02000039
020100*    CALL THE ARCHITECTURE API.                                 * 02010039
020200*---------------------------------------------------------------* 02020039
020300                                                                  02030039
020400 0001-CALL-CICS-ARCH-API.                                         02040039
020500                                                                  02050039
020600*    CALL 'DPKCS030' USING DFHEIBLK                               02060055
020610     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02061055
020700                                    DFHCOMMAREA                   02070055
020800                                    DP030-CICS-API-FIELDS         02080055
020900                                    DP020-STANDARD-COMMAREA       02090055
021000                                    AP320AI.                      02100055
021100                                                                  02110039
021200     IF  DP030-RC-CALL-SUCCESSFUL OR                              02120039
021300         DP030-RC-APPL-ERROR                                      02130039
021400         CONTINUE                                                 02140039
021500     ELSE                                                         02150039
021600         SET DP013-NO-ROLLBACK                                    02160039
021700             DP013-XCTL-DISPLAY-RESTART                           02170039
021800             DP013-CICS-ABEND      TO TRUE                        02180039
021900         MOVE 'BEFORE 0000-MAIN-MODULE'                           02190039
022000                                   TO DP013-PARAGRAPH             02200039
022100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX02210055
022200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      02220055
022210         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02221055
022220-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02222055
022300         MOVE DP030-RETURN-CODE                                   02230039
022400                                   TO DP013-MESSAGE-TEXT (3)      02240039
022500         PERFORM DP013-0000-PROCESS-ABEND                         02250039
022600     END-IF.                                                      02260039
022700 EJECT                                                            02270039
022800*----------------------------------------------------------------*02280039
022900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02290039
023000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02300039
023100*----------------------------------------------------------------*02310039
023200                                                                  02320039
023300 1000-CONTROL-PROCESSING.                                         02330039
023400                                                                  02340039
023500     EVALUATE TRUE                                                02350039
023600         WHEN DP030-RC-APPL-ERROR                                 02360039
023700             INITIALIZE ASC-STR-NUMBER                            02370039
023710             INITIALIZE ASC-DC-NUMBER                             02371042
023800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02380039
023900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02390039
024000                                                                  02400039
024100         WHEN DP020-NEXT-ACT-INITIAL                              02410039
024200             INITIALIZE ASC-SPECIFIC-COMMAREA                     02420039
024300             PERFORM 4000-BUILD-INITIAL-PANEL                     02430039
024400                                                                  02440039
024500         WHEN DP020-NEXT-ACT-READ-MAP                             02450039
024600             PERFORM 2000-FKEY-PROCESSING                         02460039
024700                                                                  02470039
024800         WHEN DP020-NEXT-ACT-RETURN                               02480039
024900             INITIALIZE ASC-STR-NUMBER                            02490039
024910             INITIALIZE ASC-DC-NUMBER                             02491042
025000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02500039
025100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02510039
025200                                                                  02520039
025300         WHEN OTHER                                               02530039
025400             SET DP013-LOGIC-ABEND                                02540039
025500                 DP013-NO-ROLLBACK TO TRUE                        02550039
025600             MOVE '1000-CONTROL-PROCESSING'                       02560039
025700                                   TO  DP013-PARAGRAPH            02570039
025800             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02580039
025900                                   TO  DP013-MESSAGE-TEXT(1)      02590039
026000             MOVE DP020-NEXT-APPL-ACTIVITY                        02600039
026100                                   TO DP013-MESSAGE-TEXT(2)       02610039
026200             PERFORM DP013-0000-PROCESS-ABEND                     02620039
026300     END-EVALUATE.                                                02630039
026400                                                                  02640039
026500*----------------------------------------------------------------*02650039
026600* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02660039
026700* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02670039
026800* EDITS.                                                         *02680039
026900*----------------------------------------------------------------*02690039
027000                                                                  02700039
027100 2000-FKEY-PROCESSING.                                            02710039
027200                                                                  02720039
027300     EVALUATE TRUE                                                02730039
027400                                                                  02740039
027500         WHEN DP020-SRC-AID = DP016-CLEAR                         02750039
027600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02760039
027700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02770039
027800                                                                  02780039
027900         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    02790039
028000             INITIALIZE ASC-SPECIFIC-COMMAREA                     02800039
028100             PERFORM 4000-BUILD-INITIAL-PANEL                     02810039
028200             PERFORM 3200-RESET-ATTRIBUTES                        02820039
028300                                                                  02830039
028400         WHEN OTHER                                               02840039
028500             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02850039
028600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02860039
028700             IF  PS-NO-ERROR                                      02870039
028800                 SET DP030-CONTINUE-GO TO TRUE                    02880039
028900                 PERFORM 2100-CHECK-FUNCTION-KEY                  02890039
029000             ELSE                                                 02900039
029100                 SET DP030-OVERRIDE-GO TO TRUE                    02910039
029200             END-IF                                               02920039
029300     END-EVALUATE.                                                02930039
029400                                                                  02940039
029500*----------------------------------------------------------------*02950039
029600*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *02960039
029700*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *02970039
029800*  FROM THE CICS ARCHITECTURE API.                               *02980039
029900*----------------------------------------------------------------*02990039
030000                                                                  03000039
030100 2100-CHECK-FUNCTION-KEY.                                         03010039
030200                                                                  03020039
030300     EVALUATE TRUE                                                03030039
030400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 03040039
030500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03050039
030600         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              03060040
030700             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03070040
030800                                                                  03080040
030900         WHEN DP020-SRC-AID = DP016-ENTER                         03090040
031000             CONTINUE                                             03100040
031100                                                                  03110040
031200         WHEN OTHER                                               03120040
031300             SET DP013-NO-ROLLBACK                                03130040
031400                 DP013-XCTL-DISPLAY-RESTART                       03140040
031500                 DP013-CICS-ABEND  TO TRUE                        03150040
031600             MOVE '2100-CHECK-FUNCTION-KEY'                       03160040
031700                                   TO DP013-PARAGRAPH             03170040
031800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03180040
031900                                   TO DP013-MESSAGE-TEXT (1)      03190040
032000             PERFORM DP013-0000-PROCESS-ABEND                     03200040
032100     END-EVALUATE.                                                03210040
032200                                                                  03220040
032300*----------------------------------------------------------------*03230040
032400*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *03240040
032500*  INTER-APPLICATION COMMAREA.                                   *03250040
032600*----------------------------------------------------------------*03260040
032700                                                                  03270040
032800 2110-PREPARE-INTER-APPL-COMM.                                    03280040
032900                                                                  03290040
033000     INITIALIZE AP300-INTER-APPL-COMMAREA.                        03300040
033100     MOVE ASC-PO-NUMBER-N          TO AP300-PO-NBR.               03310040
033200     MOVE ASC-VENDOR-NUMBER        TO AP300-DUN-NBR.              03320040
033300     MOVE ASC-INVC-NUMBER          TO AP300-INVC-ID.              03330040
033400     MOVE ASC-STR-NUMBER           TO AP300-STORE-NBR.            03340040
033500     MOVE ASC-INVC-STATUS          TO AP300-INVC-STATUS.          03350040
033600     MOVE ASC-SEL-DATE-DB2         TO AP300-SELCTN-DTE.           03360040
033700     MOVE ASC-INVC-TYP-CDE         TO AP300-INVC-TYP-CDE.         03370040
033710     MOVE ASC-DC-NUMBER            TO AP300-DC-NBR.               03371042
033800 EJECT                                                            03380040
033900*----------------------------------------------------------------*03390040
034000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03400040
034100* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03410040
034200* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03420040
034300*----------------------------------------------------------------*03430040
034400                                                                  03440040
034500 2200-MOVE-SCREEN-TO-COMMAREA.                                    03450040
034600                                                                  03460040
034700     IF  APONUML > ZERO                                           03470040
034800         MOVE APONUMI              TO ASC-PO-NUMBER               03480040
034900     ELSE                                                         03490040
035000         IF  APONUMF = DP015-ERASE-EOF                            03500040
035100             MOVE SPACE            TO ASC-PO-NUMBER               03510040
035200         END-IF                                                   03520040
035300     END-IF.                                                      03530040
035400                                                                  03540040
035500     IF  AVNDNUML > ZERO                                          03550040
035600         MOVE AVNDNUMI             TO ASC-VENDOR-NUMBER           03560040
035700     ELSE                                                         03570040
035800         IF  AVNDNUMF = DP015-ERASE-EOF                           03580040
035900             MOVE SPACE            TO ASC-VENDOR-NUMBER           03590040
036000         END-IF                                                   03600040
036100     END-IF.                                                      03610040
036200                                                                  03620040
036300     IF  AINVNUML > ZERO                                          03630040
036400         MOVE AINVNUMI             TO ASC-INVC-NUMBER             03640040
036500     ELSE                                                         03650040
036600         IF  AINVNUMF = DP015-ERASE-EOF                           03660040
036700             MOVE SPACE            TO ASC-INVC-NUMBER             03670040
036800         END-IF                                                   03680040
036900     END-IF.                                                      03690040
037000                                                                  03700040
037100     IF  ASTRNUML > ZERO                                          03710040
037200         MOVE ASTRNUMI             TO ASC-STR-NUMBER              03720040
037300     ELSE                                                         03730040
037400         IF  ASTRNUMF = DP015-ERASE-EOF                           03740040
037500             MOVE SPACE            TO ASC-STR-NUMBER              03750040
037600         END-IF                                                   03760040
037700     END-IF.                                                      03770040
037800                                                                  03780040
037900     IF  AINVSTAL > ZERO                                          03790040
038000         MOVE AINVSTAI             TO ASC-INVC-STATUS             03800040
038100     ELSE                                                         03810040
038200         IF  AINVSTAF = DP015-ERASE-EOF                           03820040
038300             MOVE SPACE            TO ASC-INVC-STATUS             03830040
038400         END-IF                                                   03840040
038500     END-IF.                                                      03850040
038600                                                                  03860040
038700     IF  ASELMML > ZERO                                           03870040
038800         MOVE ASELMMI              TO ASC-SEL-MM                  03880040
038900     ELSE                                                         03890040
039000         IF  ASELMMF = DP015-ERASE-EOF                            03900040
039100             MOVE SPACE            TO ASC-SEL-MM                  03910040
039200         END-IF                                                   03920040
039300     END-IF.                                                      03930040
039400                                                                  03940040
039500     IF  ASELDDL > ZERO                                           03950040
039600         MOVE ASELDDI              TO ASC-SEL-DD                  03960040
039700     ELSE                                                         03970040
039800         IF  ASELDDF = DP015-ERASE-EOF                            03980040
039900             MOVE SPACE            TO ASC-SEL-DD                  03990040
040000         END-IF                                                   04000040
040100     END-IF.                                                      04010040
040200                                                                  04020040
040300     IF  ASELYYL > ZERO                                           04030040
040400         MOVE ASELYYI              TO ASC-SEL-YY                  04040040
040500     ELSE                                                         04050040
040600         IF  ASELYYF = DP015-ERASE-EOF                            04060040
040700             MOVE SPACE            TO ASC-SEL-YY                  04070040
040800         END-IF                                                   04080040
040900     END-IF.                                                      04090040
041000                                                                  04100040
041100     IF    ASC-SEL-MM = SPACES                                    04110040
041200       AND ASC-SEL-DD = SPACES                                    04120040
041300       AND ASC-SEL-YY = SPACES                                    04130040
041400         MOVE SPACES TO ASC-SEL-DATE-DB2                          04140040
041500     END-IF.                                                      04150040
041600                                                                  04160040
041700     IF  AINVTYPL > ZERO                                          04170040
041800         MOVE AINVTYPI             TO ASC-INVC-TYP-CDE            04180040
041900     ELSE                                                         04190040
042000         IF  AINVTYPF = DP015-ERASE-EOF                           04200040
042100             MOVE SPACE            TO ASC-INVC-TYP-CDE            04210040
042200         END-IF                                                   04220040
042300     END-IF.                                                      04230040
042400                                                                  04240040
042410     IF  ADCNUML > ZERO                                           04241042
042420         MOVE ADCNUMI              TO ASC-DC-NUMBER               04242042
042430     ELSE                                                         04243042
042440         IF  ADCNUMI = DP015-ERASE-EOF                            04244042
042441             MOVE SPACE            TO ASC-DC-NUMBER               04244146
042460         END-IF                                                   04246042
042470     END-IF.                                                      04247042
042480                                                                  04248042
042500*----------------------------------------------------------------*04250040
042600* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *04260040
042700* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *04270040
042800* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*04280040
042900* IN THE DESTINATION PROGRAM, NOT HERE.                          *04290040
043000*                                                                *04300040
043100* EDITS DONE HERE ARE:                                           *04310040
043200* -- PO NUMBER MUST BE NUMERIC, IF ENTERED.                      *04320040
043300* -- SELECTION DATE MUST BE NUMERIC, IF ENTERED.                 *04330040
043400* -- SELECTION DATE MUST BE A VALID DATE, IF ENTERED.            *04340040
043500*----------------------------------------------------------------*04350040
043600                                                                  04360040
043700 3000-EDIT-DATA-IN-COMMAREA.                                      04370040
043800                                                                  04380040
043900     PERFORM 3200-RESET-ATTRIBUTES.                               04390040
044000     IF  ASC-PO-NUMBER > SPACE                                    04400040
044100         MOVE ASC-PO-NUMBER        TO DP010I-UNEDITED-FIELD       04410040
044200         MOVE LENGTH OF ASC-PO-NUMBER TO DP010I-MAXIMUM-DIGITS    04420040
044300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     04430040
044400         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04440040
044500         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04450050
044510                         USING DP010I-NUMERIC-EDIT-AREA           04451050
044600         IF  DP010I-ERROR-DETECTED                                04460040
044700             SET PS-ERROR                                         04470040
044800                 DP020-MSG-FATAL   TO TRUE                        04480040
044900*            -- MUST BE NUMERIC --                                04490040
045000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            04500040
045100             MOVE DP015-UNP-ALP-BRT-OFF                           04510040
045200                                   TO APONUMA                     04520040
045300             MOVE DP015-RED        TO APONUMC                     04530040
045400             MOVE DP015-REVERSE    TO APONUMH                     04540040
045500             MOVE -1               TO APONUML                     04550040
045600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04560040
045700         ELSE                                                     04570040
045800             MOVE DP010I-NUMERIC-FIELD                            04580040
045900                                   TO ASC-PO-NUMBER-N             04590040
046000                                      APONUMO                     04600040
046100         END-IF                                                   04610040
046200     END-IF.                                                      04620040
046300                                                                  04630040
046400     IF ASC-SEL-DATE NOT = SPACES AND                             04640040
046500        ASC-SEL-MM > SPACE                                        04650040
046600         MOVE ASC-SEL-MM          TO DP010I-UNEDITED-FIELD        04660040
046700         MOVE LENGTH OF ASC-SEL-MM                                04670040
046800                                  TO DP010I-MAXIMUM-DIGITS        04680040
046900         MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS      04690040
047000         SET DP010I-NEGATIVE-NOT-ALLOWED                          04700040
047100                                  TO TRUE                         04710040
047220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04722051
047230                         USING DP010I-NUMERIC-EDIT-AREA           04723051
047300         IF  DP010I-ERROR-DETECTED                                04730040
047400             SET PS-ERROR         TO TRUE                         04740040
047500             SET DP020-MSG-FATAL  TO TRUE                         04750040
047600*            -- MUST BE NUMERIC --                                04760040
047700             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             04770040
047800             MOVE DP015-UNP-ALP-BRT-OFF                           04780040
047900                                  TO ASELMMA                      04790040
048000             MOVE DP015-RED       TO ASELMMC                      04800040
048100             MOVE DP015-REVERSE   TO ASELMMH                      04810040
048200             MOVE -1              TO ASELMML                      04820040
048300             SET DP030-SET-CURSOR-APPL-1                          04830040
048400                                  TO TRUE                         04840040
048500         ELSE                                                     04850040
048600             MOVE DP010I-NUMERIC-FIELD                            04860040
048700                                  TO ASC-SEL-MM-N                 04870040
048800         END-IF                                                   04880040
048900     END-IF.                                                      04890040
049000                                                                  04900040
049100     IF ASC-SEL-DATE NOT = SPACES AND                             04910040
049200        ASC-SEL-DD > SPACE                                        04920040
049300         MOVE ASC-SEL-DD          TO DP010I-UNEDITED-FIELD        04930040
049400         MOVE LENGTH OF ASC-SEL-DD                                04940040
049500                                  TO DP010I-MAXIMUM-DIGITS        04950040
049600         MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS      04960040
049700         SET DP010I-NEGATIVE-NOT-ALLOWED                          04970040
049800                                  TO TRUE                         04980040
049920         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04992051
049930                         USING DP010I-NUMERIC-EDIT-AREA           04993051
050000         IF  DP010I-ERROR-DETECTED                                05000040
050100             SET PS-ERROR         TO TRUE                         05010040
050200             SET DP020-MSG-FATAL  TO TRUE                         05020040
050300*            -- MUST BE NUMERIC --                                05030040
050400             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             05040040
050500             MOVE DP015-UNP-ALP-BRT-OFF                           05050040
050600                                  TO ASELDDA                      05060040
050700             MOVE DP015-RED       TO ASELDDC                      05070040
050800             MOVE DP015-REVERSE   TO ASELDDH                      05080040
050900             MOVE -1              TO ASELDDL                      05090040
051000             SET DP030-SET-CURSOR-APPL-1                          05100040
051100                                  TO TRUE                         05110040
051200         ELSE                                                     05120040
051300             MOVE DP010I-NUMERIC-FIELD                            05130040
051400                                  TO ASC-SEL-DD-N                 05140040
051500         END-IF                                                   05150040
051600     END-IF.                                                      05160040
051700                                                                  05170040
051800     IF ASC-SEL-DATE NOT = SPACES AND                             05180040
051900        ASC-SEL-YY > SPACE                                        05190040
052000         MOVE ASC-SEL-YY          TO DP010I-UNEDITED-FIELD        05200040
052100         MOVE LENGTH OF ASC-SEL-YY                                05210040
052200                                  TO DP010I-MAXIMUM-DIGITS        05220040
052300         MOVE ZERO                TO DP010I-MAXIMUM-DECIMALS      05230040
052400         SET DP010I-NEGATIVE-NOT-ALLOWED                          05240040
052500                                  TO TRUE                         05250040
052620         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05262051
052630                         USING DP010I-NUMERIC-EDIT-AREA           05263051
052700         IF  DP010I-ERROR-DETECTED                                05270040
052800             SET PS-ERROR         TO TRUE                         05280040
052900             SET DP020-MSG-FATAL  TO TRUE                         05290040
053000*            -- MUST BE NUMERIC --                                05300040
053100             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             05310040
053200             MOVE DP015-UNP-ALP-BRT-OFF                           05320040
053300                                  TO ASELYYA                      05330040
053400             MOVE DP015-RED       TO ASELYYC                      05340040
053500             MOVE DP015-REVERSE   TO ASELYYH                      05350040
053600             MOVE -1              TO ASELYYL                      05360040
053700             SET DP030-SET-CURSOR-APPL-1                          05370040
053800                                  TO TRUE                         05380040
053900         ELSE                                                     05390040
054000             MOVE DP010I-NUMERIC-FIELD                            05400040
054100                                  TO ASC-SEL-YY-N                 05410040
054200         END-IF                                                   05420040
054300     END-IF.                                                      05430040
054400                                                                  05440040
054500     IF (ASC-SEL-MM > SPACE OR                                    05450040
054600         ASC-SEL-DD > SPACE OR                                    05460040
054700         ASC-SEL-YY > SPACE) AND                                  05470040
054800         PS-NO-ERROR                                              05480040
054900                                                                  05490040
055000         MOVE DP017-CURRENT-DATE-YMD                              05500040
055100                                 TO DPG51-SYSTEM-DATE             05510040
055200         MOVE ASC-SEL-DATE       TO DPG52-LK-DATE-INPUT           05520040
055300         SET DPG52-LK-DTE-GREG   TO TRUE                          05530040
055400         SET DPG51-ACTUAL-CALENDAR-ONLY                           05540040
055500                                 TO TRUE                          05550040
055600         SET DPG51-DO-NOT-INCR-DECR-DATE                          05560040
055700                                 TO TRUE                          05570040
055800         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  05580040
055900                                           DPG51 DPG52            05590040
056000                                           DPG53 DPG54            05600040
056100                                           DPG55 DPG56            05610040
056200         EVALUATE TRUE                                            05620040
056300             WHEN DPG54-SEVERE-ERROR                              05630040
056400             WHEN DPG54-WARNING-ERROR                             05640040
056500                 SET PS-ERROR    TO TRUE                          05650040
056600                 SET DP020-MSG-FATAL                              05660040
056700                                 TO TRUE                          05670040
056800*                -- INVALID DATE --                               05680040
056900                 MOVE PC-TSYMSG-00009                             05690040
057000                                 TO DP020-MSG-NUMBER              05700040
057100                 MOVE DP015-UNP-ALP-BRT-OFF                       05710040
057200                                 TO ASELMMA                       05720040
057300                                    ASELDDA                       05730040
057400                                    ASELYYA                       05740040
057500                 MOVE DP015-RED  TO ASELMMC                       05750040
057600                                    ASELDDC                       05760040
057700                                    ASELYYC                       05770040
057800                 MOVE DP015-REVERSE                               05780040
057900                                 TO ASELMMH                       05790040
058000                                    ASELDDH                       05800040
058100                                    ASELYYH                       05810040
058200                 MOVE -1         TO ASELMML                       05820040
058300                 SET DP030-SET-CURSOR-APPL-1                      05830040
058400                                 TO TRUE                          05840040
058500             WHEN OTHER                                           05850040
058600                 MOVE DPG55-DB2-ISO-DATE-FMT                      05860040
058700                                 TO ASC-SEL-DATE-DB2              05870040
058800         END-EVALUATE                                             05880040
058900     END-IF.                                                      05890040
059000                                                                  05900040
059100     IF  PS-NO-ERROR                                              05910040
059200         MOVE -1                   TO APONUML                     05920040
059300         SET DP030-SET-CURSOR-APPL-1                              05930040
059400                                   TO TRUE                        05940040
059500     END-IF.                                                      05950040
059600                                                                  05960040
059700*----------------------------------------------------------------*05970040
059800*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *05980040
059900*  MAP.                                                          *05990040
060000*----------------------------------------------------------------*06000040
060100                                                                  06010040
060200 3200-RESET-ATTRIBUTES.                                           06020040
060300                                                                  06030040
060400     MOVE DP015-UNP-ALP-NOR-OFF    TO APONUMA                     06040040
060500                                      AVNDNUMA                    06050040
060600                                      AINVNUMA                    06060040
060700                                      ASTRNUMA                    06070040
060800                                      AINVSTAA                    06080040
060900                                      ASELMMA                     06090040
061000                                      ASELDDA                     06100040
061100                                      ASELYYA                     06110040
061200                                      AINVTYPA.                   06120040
061300     MOVE DP015-GREEN              TO APONUMC                     06130040
061400                                      AVNDNUMC                    06140040
061500                                      AINVNUMC                    06150040
061600                                      ASTRNUMC                    06160040
061700                                      AINVSTAC                    06170040
061800                                      ASELMMC                     06180040
061900                                      ASELDDC                     06190040
062000                                      ASELYYC                     06200040
062100                                      AINVTYPC.                   06210040
062200     MOVE DP015-UNDERLINE          TO APONUMH                     06220040
062300                                      AVNDNUMH                    06230040
062400                                      AINVNUMH                    06240040
062500                                      ASTRNUMH                    06250040
062600                                      AINVSTAH                    06260040
062700                                      ASELMMH                     06270040
062800                                      ASELDDH                     06280040
062900                                      ASELYYH                     06290040
063000                                      AINVTYPH.                   06300040
063100                                                                  06310040
063200*----------------------------------------------------------------*06320040
063300*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *06330040
063400*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *06340040
063500*  IT HERE.                                                      *06350040
063600*----------------------------------------------------------------*06360040
063700                                                                  06370040
063800 4000-BUILD-INITIAL-PANEL.                                        06380040
063900                                                                  06390040
064000     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        06400040
064100     MOVE -1                       TO APONUML.                    06410040
064200                                                                  06420040
064300*----------------------------------------------------------------*06430040
064400*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *06440040
064500*----------------------------------------------------------------*06450040
064600                                                                  06460040
064700 4400-MOVE-COMMAREA-TO-SCREEN.                                    06470040
064800                                                                  06480040
064900     MOVE ASC-PO-NUMBER-N          TO APONUMO.                    06490040
065000     MOVE ASC-VENDOR-NUMBER        TO AVNDNUMO.                   06500040
065100     MOVE ASC-INVC-NUMBER          TO AINVNUMO.                   06510040
065200     MOVE ASC-STR-NUMBER           TO ASTRNUMO.                   06520040
065300     MOVE ASC-INVC-STATUS          TO AINVSTAO.                   06530040
065400     MOVE ASC-SEL-MM               TO ASELMMO.                    06540040
065500     MOVE ASC-SEL-DD               TO ASELDDO.                    06550040
065600     MOVE ASC-SEL-YY               TO ASELYYO.                    06560040
065700     MOVE ASC-INVC-TYP-CDE         TO AINVTYPO.                   06570040
065710     MOVE ASC-DC-NUMBER            TO ADCNUMO.                    06571042
065800 EJECT                                                            06580040
065900*----------------------------------------------------------------*06590040
066000*    ABEND PROCESSOR MODULE                                      *06600040
066100*----------------------------------------------------------------*06610040
066200                                                                  06620040
066300     COPY DPPD013.                                                06630040
