000100*----------------------------------------------------------       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.    XSKRP030.                                         00040000
000500 AUTHOR.        JOSEPH MENYAH.                                    00050000
000600 DATE-WRITTEN.  OCTOBER , 2002.                                   00060000
000700                                                                  00070000
000800*----------------------------------------------------------       00080000
000900*            PRICING STORE GROUP INTEGRITY CHECK                  00090000
001000*----------------------------------------------------------       00100000
001010* THIS PROGRAM WILL PERFORM THE NECESSARY BUSINESS EVENT          00110000
001020* INTEGRITY CHECK FOR THE PRICING BUSINESS EVENT.                 00120000
001124*                                                                 00130000
001125*----------------------------------------------------------       00140000
001126* HISTORY LOG:                                                    00150000
001127*                                                                 00160000
001128*----------------------------------------------------------       00170000
042010* DATE: 04/20/2010                                                00180000
042010* WR/IR#: INC 1209937                                             00190000
042010* PROGRAMMER: COGNIZANT                                           00200000
042010* DESCRIPTION: CHANGE THE PROGRAM TO NOT COMPARE ALL THE FIELDS   00210000
042010*              IF THE STATUS IS DELETED IN BOTH THE FILES.        00220000
001128*----------------------------------------------------------       00230000
042010* DATE: 08/30/2010                                                00240000
042010* WR/IR#: WR 38172                                                00250000
042010* PROGRAMMER: CHERI PARMLEY                                       00260000
042010* DESCRIPTION: CHANGED PV-DOMAIN-NF AND PV-PROMO-NF REFERENCES    00270000
042010*              USED INCORRECTLY                                   00280000
042010*              IF THE STATUS IS DELETED IN BOTH THE FILES.        00290000
001160*----------------------------------------------------------       00300000
001128*----------------------------------------------------------       00310000
P11215* DATE: 12/07/2010                                                00320000
P11215* WR/IR#: WR P11215                                               00330000
P11215* PROGRAMMER: COGNIZANT                                           00340000
P11215* DESCRIPTION: CHANGED THE PROGRAM LOGIC TO EXCLUDE               00350000
P11215*              THE STAT-CDE = 'D'. THUS, SKU'S WITH               00360000
P11215*              STAT-CDE = 'D' WOULD BE SKIPPED FROM REPORT.       00370000
P11215*----------------------------------------------------------       00380000
001128*----------------------------------------------------------       00390000
P11215* DATE: 01/19/2011                                                00400000
P11215* WR/IR#: INC000001561152                                         00410000
P11215* PROGRAMMER: COGNIZANT                                           00420000
P11215* DESCRIPTION: PROGRAM WENT INTO INFINITE LOOP.                   00430000
P11215*              CHANGED THE LOGIC TO CORRECT IT.                   00440000
P11215*----------------------------------------------------------       00450000
001128*----------------------------------------------------------       00460000
P11215* DATE: 12/01/2011                                                00470000
P11215* WR/IR#: PBI000000016208                                         00480000
P11215* PROGRAMMER: COGNIZANT                                           00490000
P11215* DESCRIPTION: TO CORRECT THE PRICE VERSION ERRORS IN XSK056      00500000
P11215*              REPORT                                             00510000
P11215*----------------------------------------------------------       00520000
001128*----------------------------------------------------------       00521002
C39558* DATE: 01/23/2013                                                00522002
C39558* WR/IR#: CRQ000000039558                                         00523002
C39558* PROGRAMMER: COGNIZANT                                           00524002
C39558* DESCRIPTION: TO FIX THE INFINITE LOOP PROBLEM DUE TO IMPROPER   00525003
C39558*              FILE READ.                                         00526002
C39558*----------------------------------------------------------       00527002
001170 ENVIRONMENT DIVISION.                                            00530000
001180*----------------------------------------------------------       00540000
001190 CONFIGURATION SECTION.                                           00550000
001200 SOURCE-COMPUTER. IBM-3090.                                       00560000
001300 OBJECT-COMPUTER. IBM-3090.                                       00570000
001400                                                                  00580000
001500 INPUT-OUTPUT SECTION.                                            00590000
001600                                                                  00600000
001700 FILE-CONTROL.                                                    00610000
004900     SELECT CONTROL-CARD                                          00620000
005000         ASSIGN TO INP00.                                         00630000
                                                                        00640000
004900     SELECT PROMO-EXTRACT-FILE                                    00650000
005000         ASSIGN TO INP01.                                         00660000
                                                                        00670000
004900     SELECT DOMAIN-EXTRACT-FILE                                   00680000
005000         ASSIGN TO INP02.                                         00690000
                                                                        00700000
                                                                        00710000
004900     SELECT ERROR-FILE                                            00720000
005000         ASSIGN TO OUT01.                                         00730000
                                                                        00740000
004900     SELECT REPORT-FILE                                           00750000
005000         ASSIGN TO RPT01.                                         00760000
                                                                        00770000
001900*----------------------------------------------------------       00780000
002000 DATA DIVISION.                                                   00790000
002100*----------------------------------------------------------       00800000
002200 FILE SECTION.                                                    00810000
002300                                                                  00820000
008000 FD  PROMO-EXTRACT-FILE                                           00830000
008100     RECORDING MODE IS F                                          00840000
008200     LABEL RECORDS ARE OMITTED                                    00850000
008300     RECORD CONTAINS 250 CHARACTERS                               00860000
008400     DATA RECORD IS PROMO-EVNT-RECORD.                            00870000
008500 01  PROMO-EVNT-REC              PIC X(250).                      00880000
008600                                                                  00890000
008000 FD  DOMAIN-EXTRACT-FILE                                          00900000
008100     RECORDING MODE IS F                                          00910000
008200     LABEL RECORDS ARE OMITTED                                    00920000
008300     RECORD CONTAINS 250 CHARACTERS                               00930000
008400     DATA RECORD IS DOMAIN-EVNT-RECORD.                           00940000
008500 01  DOMAIN-EVNT-REC              PIC X(250).                     00950000
006500                                                                  00960000
       FD  CONTROL-CARD                                                 00970000
           RECORDING MODE F                                             00980000
           BLOCK CONTAINS 0 RECORDS                                     00990000
           LABEL RECORDS ARE OMITTED                                    01000000
           DATA RECORD IS CONTROL-CARD-RECORD.                          01010000
       01  CONTROL-CARD-RECORD             PIC X(080).                  01020000
                                                                        01030000
       FD  REPORT-FILE                                                  01040000
           RECORDING MODE F                                             01050000
           BLOCK CONTAINS 0 RECORDS                                     01060000
           LABEL RECORDS ARE OMITTED                                    01070000
009600     RECORD CONTAINS 132 CHARACTERS                               01080000
           DATA RECORD IS REPORT-RECORD.                                01090000
       01  REPORT-RECORD                   PIC X(132).                  01100000
                                                                        01110000
       FD  ERROR-FILE                                                   01120000
           RECORDING MODE F                                             01130000
           BLOCK CONTAINS 0 RECORDS                                     01140000
           LABEL RECORDS ARE OMITTED                                    01150000
           DATA RECORD IS DIFFERENCES-RECORD.                           01160000
       01  DIFFERENCES-RECORD              PIC X(250).                  01170000
                                                                        01180000
002500*---------------------------------------------------------        01190000
002600                                                                  01200000
002700 WORKING-STORAGE SECTION.                                         01210000
002800*---------------------------------------------------------        01220000
003500* PC- PROGRAM CONSTANTS                                           01230000
003600*----------------------------------------------------------       01240000
003700 01  PC-PROGRAM-CONSTANTS.                                        01250000
003800     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XSKRP030'. 01260000
003900     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   01270000
004000                                                                  01280000
097700 01  CD-CPU-DATE.                                                 01290000
097800     03  CD-CPU-YEAR             PIC 99.                          01300000
097900     03  CD-CPU-MONTH            PIC 99.                          01310000
098000     03  CD-CPU-DAY              PIC 99.                          01320000
098100                                                                  01330000
098200 01  CD-CPU-DATE-CC.                                              01340000
098300     03  CD-CPU-CENT             PIC 99.                          01350000
098400     03  CD-CPU-YYMMDD           PIC 9(6).                        01360000
                                                                        01370000
084800 01  PC-REPORT-NO                PIC  9(5)          VALUE 00001.  01380000
                                                                        01390000
011200 01  CT-CPU-TIME.                                                 01400000
011300     03  CT-HOUR                 PIC 99.                          01410000
011400     03  CT-MINUTE               PIC 99.                          01420000
011500     03  FILLER                  PIC 9(4).                        01430000
      *----------------------------------------------------------       01440000
      **PROGRAM                                                         01450000
      *----------------------------------------------------------       01460000
       01  PC-PROGRAM-COUNTER.                                          01470000
           05  PC-RECORD-COUNT                 PIC S9(09) VALUE ZEROS   01480000
                                                          COMP-3.       01490000
           05  PC-PROMO-EXTRACT-RECS-READ      PIC 9(09) VALUE ZEROS.   01500000
           05  PC-DOMAIN-EXTRACT-RECS-READ     PIC 9(09) VALUE ZEROS.   01510000
           05  PC-ERROR-RECORD-WRITTEN         PIC 9(09) VALUE ZEROS.   01520000
           05  PC-ERROR-REPORT-WRITTEN         PIC 9(09) VALUE ZEROS.   01530000
           05  PC-PAGE-CNT                     PIC 9(09) VALUE ZEROS.   01540000
004100*----------------------------------------------------------       01550000
004200* PS- PROGRAM SWITCHES                                            01560000
004300*----------------------------------------------------------       01570000
004400 01  PS-PROGRAM-SWITCHES.                                         01580000
004500     05  PS-EOF-PROMO-EXTRACT-SW          PIC X(01)  VALUE SPACE. 01590000
004600         88  PS-EOF-PROMO                        VALUE 'Y'.       01600000
004600         88  PS-NOT-EOF-PROMO                    VALUE 'N'.       01610000
004800                                                                  01620000
004500     05  PS-EOF-DOMAIN-EXTRACT-SW         PIC X(01)  VALUE SPACE. 01630000
004600         88  PS-EOF-DOMAIN                       VALUE 'Y'.       01640000
004600         88  PS-NOT-EOF-DOMAIN                   VALUE 'N'.       01650000
004800                                                                  01660000
004500     05  PS-NEW-RECORD-SW                 PIC X(01)  VALUE SPACE. 01670000
004600         88  PS-NEW-RECORD                       VALUE 'Y'.       01680000
004600         88  PS-NOT-NEW-RECORD                   VALUE 'N'.       01690000
004800                                                                  01700000
004900*----------------------------------------------------------       01710000
      *    CONTROL-CARD-LAYOUT.                                         01720000
004900*----------------------------------------------------------       01730000
       01  CONTROL-CARD-LAYOUT.                                         01740000
           05  CC-START-POINT                  PIC 9(05) VALUE ZEROS.   01750000
           05  FILLER                          PIC X(01) VALUE SPACES.  01760000
           05  CC-READ-FREQUENCY               PIC 9(05) VALUE ZEROS.   01770000
           05  FILLER                          PIC X(69) VALUE SPACES.  01780000
004900*----------------------------------------------------------       01790000
005000* PV- PROGRAM VARIABLES                                           01800000
005100*----------------------------------------------------------       01810000
005200 01 PV-PROGRAM-VARIABLES.                                         01820000
013800    05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 01830000
005500    05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   01840000
005600    05  PV-MAX-OFFSET-DTE             PIC 9(08)  VALUE 0.         01850000
005710    05  PV-PROMO-INTFC-ID-HLD         PIC 9(10) VALUE 0.          01860000
005710    05  PV-MDSE-LNE-ID-HLD            PIC 9(05) VALUE 0.          01870000
005800    05  PV-ACTION-CODE                PIC X(01).                  01880000
005810        88  PV-INSERT-DATA                       VALUE 'I'.       01890000
005820        88  PV-UPDATE-DATA                       VALUE 'U'.       01900000
                                                                        01910000
006000    05  PV-RECORD-COUNT               PIC 9(05) VALUE ZEROS.      01920000
006000    05  PV-LD-STATUS-CDE              PIC X(02).                  01930000
006100        88  PV-NO-ERROR                          VALUE '00'.      01940000
006200        88  PV-CRITICAL-ERROR                    VALUE '01'.      01950000
006300        88  PV-NOT-CRITICAL-ERROR                VALUE '02'.      01960000
007000                                                                  01970000
           05  PS-ERROR-FOUND-SW               PIC X(01) VALUE 'N'.     01980000
               88  PS-ERROR-FOUND                        VALUE 'Y'.     01990000
               88  PS-ERROR-NOT-FOUND                    VALUE 'N'.     02000000
                                                                        02010000
007100    05  PV-STRT-PARM.                                             02020000
007200        10  PV-STRT-DTE-CC            PIC X(02).                  02030000
007200        10  PV-STRT-DTE-YY            PIC X(02).                  02040000
007400        10  PV-STRT-DTE-MM            PIC X(02).                  02050000
007600        10  PV-STRT-DTE-DD            PIC X(02).                  02060000
007400        10  FILLER                    PIC X.                      02070000
007400        10  PV-DECREMENT              PIC X(02).                  02080000
007400        10  FILLER                    PIC X(69).                  02090000
007700                                                                  02100000
007100    05  PV-PROMO-STRT-DTE           PIC X(10).                    02110000
007100    05  PV-PROMO-END-DTE            PIC X(10).                    02120000
                                                                        02130000
008600    05  PV-PROMO-KEY.                                             02140000
008700        10  PV-PM-PROMO-INTFC-ID          PIC 9(10).              02150000
008700        10  PV-PM-MDSE-LNE-ID             PIC 9(10).              02160000
008700        10  PV-PM-STR-GP-TYP-CDE          PIC 9(04).              02170000
008700        10  PV-PM-STR-GP-ID               PIC 9(04).              02180000
                                                                        02190000
008600    05  PV-DOMAIN-KEY.                                            02200000
008700        10  PV-XS-PROMO-INTFC-ID          PIC 9(10).              02210000
008700        10  PV-XS-MDSE-LNE-ID             PIC 9(10).              02220000
008700        10  PV-XS-STR-GP-TYP-CDE          PIC 9(04).              02230000
008700        10  PV-XS-STR-GP-ID               PIC 9(04).              02240000
                                                                        02250000
008600    05  PV-PROMO-SOURCE              PIC X(40) VALUE              02260000
              'DATA SOURCE IS THE PROMO DATABASE'.                      02270000
                                                                        02280000
008600    05  PV-PROMO-NF                  PIC X(40) VALUE              02290000
              'RECORD NOT FOUND IN PROMO TABLES'.                       02300000
                                                                        02310000
008600    05  PV-DOMAIN-SOURCE             PIC X(40) VALUE              02320000
              'DATA SOURCE IS THE XS DOMAIN DATABASE'.                  02330000
                                                                        02340000
008600    05  PV-DOMAIN-NF                  PIC X(40) VALUE             02350000
              'RECORD NOT FOUND IN XS DOMAIN'.                          02360000
                                                                        02370000
       01  PV-PM-TOTAL-RECORD.                                          02380000
           05 PV-PM-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    02390000
           05 PV-PM-ACTION-CDE                 PIC X(01) VALUE 'T'.     02400000
           05 PV-PM-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    02410000
                                                                        02420000
       01  PV-XS-TOTAL-RECORD.                                          02430000
           05 PV-XS-BUSINESS-EVNT-ID           PIC 9(03) VALUE ZERO.    02440000
           05 PV-XS-ACTION-CDE                 PIC X(01) VALUE 'T'.     02450000
           05 PV-XS-TOTAL-NBR-OF-RECS          PIC 9(11) VALUE ZERO.    02460000
                                                                        02470000
000700 01  ERROR-RECORD                    PIC X(250) VALUE SPACES.     02480000
                                                                        02490000
042800     COPY DPWS132O.                                               02500000
042900                                                                  02510000
                                                                        02520000
043100 01  DR-HEAD2.                                                    02530000
043200     05  FILLER                 PIC X(41)    VALUE SPACES.        02540000
043300     05  DR-TITLE               PIC X(55)    VALUE                02550000
043400      'INTEGRITY CHECK PROGRAM  - STORE GROUP     '.              02560000
                                                                        02570000
043500                                                                  02580000
043100 01  DR-HEAD3.                                                    02590000
043200     05  FILLER                 PIC X(03)    VALUE                02600000
            'KEY'.                                                      02610000
043200     05  FILLER                 PIC X(39)    VALUE SPACES.        02620000
043200     05  FILLER                 PIC X(10)    VALUE                02630000
            'FIELD NAME'.                                               02640000
043200     05  FILLER                 PIC X(12)    VALUE SPACES.        02650000
043200     05  FILLER                 PIC X(05)    VALUE                02660000
            'VALUE'.                                                    02670000
043200     05  FILLER                 PIC X(23)    VALUE SPACES.        02680000
043200     05  FILLER                 PIC X(16)    VALUE                02690000
            'SOURCE / MESSAGE'.                                         02700000
043200     05  FILLER                 PIC X(35)    VALUE SPACES.        02710000
043500                                                                  02720000
043100 01  DR-HEAD5.                                                    02730000
043200     05  FILLER                 PIC X(132)   VALUE ALL '='.       02740000
000700 01  REPORT-DETAIL.                                               02750000
000800   05 PROMO-RPT-INFO.                                             02760000
000800      10 PROMO-EVNT-KEY              PIC X(30).                   02770000
 00800      10 FILLER                      PIC X(2).                    02780000
 00800      10 PROMO-RPT-DATA-NAME         PIC X(30).                   02790000
 00800      10 FILLER                      PIC X(2).                    02800000
 00800      10 PROMO-RPT-DATA-VALUE        PIC X(26).                   02810000
 00800      10 FILLER                      PIC X(2).                    02820000
000800   05 REPORT-NOTES                   PIC X(40).                   02830000
010900*----------------------------------------------------------       02840000
011000* DOMAIN PRICING EVENT RECORD LAYOUT                              02850000
011100*----------------------------------------------------------       02860000
011200     COPY XSRD022.                                                02870000
011800                                                                  02880000
004900*----------------------------------------------------------       02890000
005000* PROMO PRICING  COPY BOOK.                                       02900000
005100*----------------------------------------------------------       02910000
           COPY PMRD709.                                                02920000
011800                                                                  02930000
030310                                                                  02940000
031400*----------------------------------------------------------       02950000
031500 PROCEDURE DIVISION.                                              02960000
032100*----------------------------------------------------------       02970000
032200 0000-MAINLINE.                                                   02980000
128200     ACCEPT CD-CPU-DATE FROM DATE.                                02990000
128300     IF CD-CPU-YEAR > 80                                          03000000
128400         MOVE 19 TO CD-CPU-CENT                                   03010000
128500     ELSE                                                         03020000
128600         MOVE 20 TO CD-CPU-CENT.                                  03030000
128700     MOVE CD-CPU-DATE TO CD-CPU-YYMMDD.                           03040000
128800                                                                  03050000
128900     ACCEPT CT-CPU-TIME FROM TIME.                                03060000
032300                                                                  03070000
032400     PERFORM 1000-INITIALIZATION.                                 03080000
032500                                                                  03090000
032600     PERFORM 2000-PROCESS-EXTRACT-DATA                            03100000
032700             UNTIL PS-EOF-DOMAIN                                  03110000
032700                OR PS-EOF-PROMO.                                  03120000
                                                                        03130000
           PERFORM 3000-PROCESS-EXTRA-RECORDS                           03140000
032700             UNTIL PS-EOF-DOMAIN                                  03150000
032700               AND PS-EOF-PROMO.                                  03160000
035000                                                                  03170000
035100     PERFORM 9999-WRAPUP.                                         03180000
035200                                                                  03190000
035500     GOBACK.                                                      03200000
035700                                                                  03210000
035701*0000-EXIT.                                                       03220000
035702 EJECT.                                                           03230000
035703                                                                  03240000
035800*----------------------------------------------------------       03250000
035900* 1000-INITIALIZATION.                                            03260000
036000*     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            03270000
036100*     UPDATE OR INSERT A RECORD.                                  03280000
036200*----------------------------------------------------------       03290000
036300 1000-INITIALIZATION.                                             03300000
                                                                        03310000
132408     MOVE CD-CPU-YEAR  TO DP132O-RUN-YEAR.                        03320000
132409     MOVE CD-CPU-MONTH TO DP132O-RUN-MONTH.                       03330000
132410     MOVE CD-CPU-DAY   TO DP132O-RUN-DAY.                         03340000
132420     MOVE CT-HOUR    TO DP132O-RUN-HOUR.                          03350000
132430     MOVE CT-MINUTE  TO DP132O-RUN-MINUTE.                        03360000
132440     MOVE 'XSKRP030' TO DP132O-PROGRAM-NAME.                      03370000
132450     MOVE 1          TO DP132O-REPORT-NUMBER.                     03380000
           SET PS-NOT-EOF-PROMO TO TRUE.                                03390000
           SET PS-NOT-EOF-DOMAIN TO TRUE.                               03400000
026600     OPEN INPUT  PROMO-EXTRACT-FILE                               03410000
026600                 DOMAIN-EXTRACT-FILE                              03420000
026600                 CONTROL-CARD                                     03430000
026600          OUTPUT ERROR-FILE                                       03440000
026600                 REPORT-FILE.                                     03450000
                                                                        03460000
           PERFORM 9999-PRINT-HEADINGS.                                 03470000
           PERFORM 9999-READ-CONTROL-CARD.                              03480000
           READ DOMAIN-EXTRACT-FILE INTO PV-XS-TOTAL-RECORD             03490000
           READ PROMO-EXTRACT-FILE INTO PV-PM-TOTAL-RECORD              03500000
                                                                        03510000
           IF PV-PM-TOTAL-NBR-OF-RECS NOT EQUAL TO                      03520000
              PV-XS-TOTAL-NBR-OF-RECS                                   03530000
             MOVE 1 TO CC-START-POINT                                   03540000
             MOVE 1 TO CC-READ-FREQUENCY                                03550000
           END-IF.                                                      03560000
                                                                        03570000
           PERFORM 9999-READ-PROMO-EXTRACT CC-START-POINT TIMES.        03580000
           PERFORM 9999-READ-DOMAIN-EXTRACT  CC-START-POINT TIMES.      03590000
                                                                        03600000
056500                                                                  03610000
037240*1100-EXIT.                                                       03620000
037250 EJECT.                                                           03630000
037251                                                                  03640000
037260*----------------------------------------------------------       03650000
037300* 2000-PROCESS-EXTRACT-DATA.                                      03660000
037400*     THIS CHECKS THE ACTION TO SEE WHETHER THE RECORD            03670000
037500*     SHOULD BE INSERTED INTO THE AD EVENT TABLE OR UPDATED.      03680000
037600*     IF SOMETHING IS WRONG WITH THE ACTION CODE IT WILL          03690000
037700*     PROCESS AN ERROR AND EXIT THE PROGRAM.                      03700000
037800*----------------------------------------------------------       03710000
037900 2000-PROCESS-EXTRACT-DATA.                                       03720000
           IF PM709-PROMO-INTFC-ID = XS022-PROMO-INTFC-ID               03730000
             IF PM709-MDSE-LNE-ID    = XS022-MDSE-LNE-ID                03740000
               IF PM709-STR-GP-TYP-CDE = XS022-STR-GP-TYP-CDE           03750000
                 IF PM709-STR-GP-ID = XS022-STR-GP-ID                   03760000
042010             IF PM709-STAT-CDE = XS022-STAT-CDE                   03770000
042010                   IF PM709-STAT-CDE = 'D'                        03780000
042010                         CONTINUE                                 03790000
042010                   ELSE                                           03800000
042010                         PERFORM 2100-COMPARE-FIELDS              03810000
042010                   END-IF                                         03820000
042010             ELSE                                                 03830000
                         PERFORM 2100-COMPARE-FIELDS                    03840000
042010             END-IF                                               03850000
                   PERFORM 9999-READ-DOMAIN-EXTRACT                     03860000
                           CC-READ-FREQUENCY TIMES                      03870000
                   PERFORM 9999-READ-PROMO-EXTRACT                      03880000
                           CC-READ-FREQUENCY TIMES                      03890000
                 ELSE                                                   03900000
                  IF PM709-STR-GP-ID > XS022-STR-GP-ID                  03910000
P11215             IF XS022-STAT-CDE = 'D'                              03920000
P11215             PERFORM 9999-READ-DOMAIN-EXTRACT                     03930000
P11215             ELSE                                                 03940000
                       MOVE PV-PROMO-NF  TO REPORT-NOTES                03950000
                       MOVE PV-DOMAIN-KEY  TO PROMO-EVNT-KEY            03960000
                       PERFORM 9999-WRITE-ERROR-REPORT                  03970000
                       MOVE XS022-PRICING-STR-GP-RECORD TO ERROR-RECORD 03980000
                                                                        03990000
                       PERFORM 9999-WRITE-ERROR-RECORD                  04000000
                       PERFORM 9999-READ-DOMAIN-EXTRACT                 04010000
                   END-IF                                               04020000
                  ELSE                                                  04030000
P11215             IF PM709-STAT-CDE = 'D'                              04040000
P11215                PERFORM 9999-READ-PROMO-EXTRACT                   04050000
P11215             ELSE                                                 04060000
                       MOVE PV-DOMAIN-NF TO REPORT-NOTES                04070000
                       MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY              04080000
                       PERFORM 9999-WRITE-ERROR-REPORT                  04090000
                       MOVE PM709-PRICING-STR-GP-RECORD TO ERROR-RECORD 04100000
                       PERFORM 9999-WRITE-ERROR-RECORD                  04110000
                       PERFORM 9999-READ-PROMO-EXTRACT                  04120000
P11215             END-IF                                               04130000
                  END-IF                                                04140000
                 END-IF                                                 04150000
               ELSE                                                     04160000
                IF PM709-STR-GP-TYP-CDE > XS022-STR-GP-TYP-CDE          04170000
P11215           IF XS022-STAT-CDE = 'D'                                04180000
P11215             PERFORM 9999-READ-DOMAIN-EXTRACT                     04190000
P11215           ELSE                                                   04200000
                   MOVE PV-PROMO-NF    TO REPORT-NOTES                  04210000
                   MOVE PV-DOMAIN-KEY TO PROMO-EVNT-KEY                 04220000
                   PERFORM 9999-WRITE-ERROR-REPORT                      04230000
                   MOVE XS022-PRICING-STR-GP-RECORD TO ERROR-RECORD     04240000
                   PERFORM 9999-WRITE-ERROR-RECORD                      04250000
                   PERFORM 9999-READ-DOMAIN-EXTRACT                     04260000
P11215           END-IF                                                 04270000
                ELSE                                                    04280000
P11215           IF PM709-STAT-CDE = 'D'                                04290000
P11215                PERFORM 9999-READ-PROMO-EXTRACT                   04300000
P11215           ELSE                                                   04310000
                   MOVE PV-DOMAIN-NF TO REPORT-NOTES                    04320000
                   MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY                  04330000
                   PERFORM 9999-WRITE-ERROR-REPORT                      04340000
                   MOVE PM709-PRICING-STR-GP-RECORD TO ERROR-RECORD     04350000
                   PERFORM 9999-WRITE-ERROR-RECORD                      04360000
                   PERFORM 9999-READ-PROMO-EXTRACT                      04370000
P11215           END-IF                                                 04380000
                END-IF                                                  04390000
               END-IF                                                   04400000
             ELSE                                                       04410000
              IF PM709-MDSE-LNE-ID > XS022-MDSE-LNE-ID                  04420000
P11215         IF XS022-STAT-CDE = 'D'                                  04430000
P11215             PERFORM 9999-READ-DOMAIN-EXTRACT                     04440000
P11215         ELSE                                                     04450000
                 MOVE PV-PROMO-NF   TO REPORT-NOTES                     04460000
                 MOVE PV-DOMAIN-KEY         TO PROMO-EVNT-KEY           04470000
                 PERFORM 9999-WRITE-ERROR-REPORT                        04480000
                 MOVE XS022-PRICING-STR-GP-RECORD TO ERROR-RECORD       04490000
                 PERFORM 9999-WRITE-ERROR-RECORD                        04500000
                 PERFORM 9999-READ-DOMAIN-EXTRACT                       04510000
P11215         END-IF                                                   04520000
              ELSE                                                      04530000
P11215         IF PM709-STAT-CDE = 'D'                                  04540000
P11215                PERFORM 9999-READ-PROMO-EXTRACT                   04550000
P11215         ELSE                                                     04560000
                 MOVE PV-DOMAIN-NF TO REPORT-NOTES                      04570000
                 MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY                    04580000
                 PERFORM 9999-WRITE-ERROR-REPORT                        04590000
                 MOVE PM709-PRICING-STR-GP-RECORD TO ERROR-RECORD       04600000
                 PERFORM 9999-WRITE-ERROR-RECORD                        04610000
                 PERFORM 9999-READ-PROMO-EXTRACT                        04620000
P11215         END-IF                                                   04630000
              END-IF                                                    04640000
             END-IF                                                     04650000
           ELSE                                                         04660000
            IF PM709-PROMO-INTFC-ID > XS022-PROMO-INTFC-ID              04670000
             IF XS022-STAT-CDE = 'D'                                    04680000
P11215             PERFORM 9999-READ-DOMAIN-EXTRACT                     04690000
             ELSE                                                       04700000
               MOVE PV-PROMO-NF    TO REPORT-NOTES                      04710000
               MOVE PV-DOMAIN-KEY         TO PROMO-EVNT-KEY             04720000
               PERFORM 9999-WRITE-ERROR-REPORT                          04730000
               MOVE XS022-PRICING-STR-GP-RECORD TO ERROR-RECORD         04740000
               PERFORM 9999-WRITE-ERROR-RECORD                          04750000
               PERFORM 9999-READ-DOMAIN-EXTRACT                         04760000
             END-IF                                                     04770000
            ELSE                                                        04780000
P11215       IF PM709-STAT-CDE = 'D'                                    04790000
P11215                PERFORM 9999-READ-PROMO-EXTRACT                   04800000
P11215       ELSE                                                       04810000
               MOVE PV-DOMAIN-NF TO REPORT-NOTES                        04820000
               MOVE PV-PROMO-KEY TO PROMO-EVNT-KEY                      04830000
               PERFORM 9999-WRITE-ERROR-REPORT                          04840000
               MOVE PM709-PRICING-STR-GP-RECORD TO ERROR-RECORD         04850000
               PERFORM 9999-WRITE-ERROR-RECORD                          04860000
               PERFORM 9999-READ-PROMO-EXTRACT                          04870000
P11215       END-IF                                                     04880000
            END-IF                                                      04890000
           END-IF.                                                      04900000
                                                                        04910000
038110*2000-EXIT.                                                       04920000
038200 EJECT.                                                           04930000
                                                                        04940000
038300*------------------------------------------------------           04950000
038400* 2100-COMPARE-FIELDS.                                            04960000
038500*     COMPARES THE EXTRACT FILES AND NOTES ANY DIFFERENCES        04970000
038600*------------------------------------------------------           04980000
038210                                                                  04990000
054400 2100-COMPARE-FIELDS.                                             05000000
036600     IF PM709-BUSINESS-EVNT-ID NOT EQUAL XS022-BUSINESS-EVNT-ID   05010000
              MOVE 'PM709-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      05020000
              MOVE PM709-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     05030000
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             05040000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           05050000
              PERFORM 9999-WRITE-ERROR-REPORT                           05060000
              MOVE 'XS022-BUSINESS-EVNT-ID' TO PROMO-RPT-DATA-NAME      05070000
              MOVE XS022-BUSINESS-EVNT-ID   TO PROMO-RPT-DATA-VALUE     05080000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             05090000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           05100000
              PERFORM 9999-WRITE-ERROR-REPORT                           05110000
              SET PS-ERROR-FOUND            TO TRUE                     05120000
           END-IF.                                                      05130000
                                                                        05140000
036600     IF PM709-PROMO-INTFC-ID   NOT EQUAL XS022-PROMO-INTFC-ID     05150000
              MOVE 'PM709-PROMO-INTFC-ID'   TO PROMO-RPT-DATA-NAME      05160000
              MOVE PM709-PROMO-INTFC-ID     TO PROMO-RPT-DATA-VALUE     05170000
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             05180000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           05190000
              PERFORM 9999-WRITE-ERROR-REPORT                           05200000
              MOVE 'XS022-PROMO-INTFC-ID'   TO PROMO-RPT-DATA-NAME      05210000
              MOVE XS022-PROMO-INTFC-ID     TO PROMO-RPT-DATA-VALUE     05220000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             05230000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           05240000
              PERFORM 9999-WRITE-ERROR-REPORT                           05250000
              SET PS-ERROR-FOUND            TO TRUE                     05260000
           END-IF.                                                      05270000
                                                                        05280000
036600     IF PM709-MDSE-LNE-ID NOT EQUAL XS022-MDSE-LNE-ID             05290000
              MOVE 'PM709-MDSE-LNE-ID'      TO PROMO-RPT-DATA-NAME      05300000
              MOVE PM709-MDSE-LNE-ID        TO PROMO-RPT-DATA-VALUE     05310000
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             05320000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           05330000
              PERFORM 9999-WRITE-ERROR-REPORT                           05340000
              MOVE 'XS022-MDSE-LNE-ID'      TO PROMO-RPT-DATA-NAME      05350000
              MOVE XS022-MDSE-LNE-ID TO PROMO-RPT-DATA-VALUE            05360000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           05370000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             05380000
              PERFORM 9999-WRITE-ERROR-REPORT                           05390000
              SET PS-ERROR-FOUND            TO TRUE                     05400000
           END-IF.                                                      05410000
                                                                        05420000
                                                                        05430000
036600     IF PM709-STR-SELN-HIER-LVL-CDE NOT EQUAL                     05440000
              XS022-STR-SELN-HIER-LVL-CDE                               05450000
              MOVE 'PM709-STR-SELN-HIER-LVL-CDE' TO PROMO-RPT-DATA-NAME 05460000
              MOVE PM709-STR-SELN-HIER-LVL-CDE TO PROMO-RPT-DATA-VALUE  05470000
              MOVE PV-PROMO-SOURCE             TO REPORT-NOTES          05480000
              MOVE PV-PROMO-KEY                TO PROMO-EVNT-KEY        05490000
              PERFORM 9999-WRITE-ERROR-REPORT                           05500000
              MOVE 'XS022-STR-SELN-HIER-LVL-CDE' TO PROMO-RPT-DATA-NAME 05510000
              MOVE XS022-STR-SELN-HIER-LVL-CDE TO PROMO-RPT-DATA-VALUE  05520000
              MOVE PV-DOMAIN-SOURCE            TO REPORT-NOTES          05530000
              MOVE PV-DOMAIN-KEY               TO PROMO-EVNT-KEY        05540000
              PERFORM 9999-WRITE-ERROR-REPORT                           05550000
              SET PS-ERROR-FOUND     TO TRUE                            05560000
           END-IF.                                                      05570000
                                                                        05580000
036600     IF PM709-ADHC-STR-GP-ID NOT EQUAL XS022-ADHC-STR-GP-ID       05590000
              MOVE 'PM709-ADHC-STR-GP-ID'      TO PROMO-RPT-DATA-NAME   05600000
              MOVE PM709-ADHC-STR-GP-ID        TO PROMO-RPT-DATA-VALUE  05610000
              MOVE PV-PROMO-SOURCE             TO REPORT-NOTES          05620000
              MOVE PV-PROMO-KEY                TO PROMO-EVNT-KEY        05630000
              PERFORM 9999-WRITE-ERROR-REPORT                           05640000
              MOVE 'XS022-ADHC-STR-GP-ID'      TO PROMO-RPT-DATA-NAME   05650000
              MOVE XS022-ADHC-STR-GP-ID        TO PROMO-RPT-DATA-VALUE  05660000
              MOVE PV-DOMAIN-SOURCE            TO REPORT-NOTES          05670000
              MOVE PV-DOMAIN-KEY               TO PROMO-EVNT-KEY        05680000
              PERFORM 9999-WRITE-ERROR-REPORT                           05690000
              SET PS-ERROR-FOUND               TO TRUE                  05700000
           END-IF.                                                      05710000
                                                                        05720000
036600     IF PM709-STR-GP-TYP-CDE NOT EQUAL XS022-STR-GP-TYP-CDE       05730000
              MOVE 'PM709-STR-GP-TYP-CDE'      TO PROMO-RPT-DATA-NAME   05740000
              MOVE PM709-STR-GP-TYP-CDE        TO PROMO-RPT-DATA-VALUE  05750000
              MOVE PV-PROMO-SOURCE             TO REPORT-NOTES          05760000
              MOVE PV-PROMO-KEY                TO PROMO-EVNT-KEY        05770000
              PERFORM 9999-WRITE-ERROR-REPORT                           05780000
              MOVE 'XS022-STR-GP-TYP-CDE'      TO PROMO-RPT-DATA-NAME   05790000
              MOVE XS022-STR-GP-TYP-CDE        TO PROMO-RPT-DATA-VALUE  05800000
              MOVE PV-DOMAIN-SOURCE            TO REPORT-NOTES          05810000
              MOVE PV-DOMAIN-KEY               TO PROMO-EVNT-KEY        05820000
              PERFORM 9999-WRITE-ERROR-REPORT                           05830000
              SET PS-ERROR-FOUND               TO TRUE                  05840000
           END-IF.                                                      05850000
                                                                        05860000
036600     IF PM709-STR-GP-ID NOT EQUAL XS022-STR-GP-ID                 05870000
              MOVE 'PM709-STR-GP-ID'           TO PROMO-RPT-DATA-NAME   05880000
              MOVE PM709-STR-GP-ID             TO PROMO-RPT-DATA-VALUE  05890000
              MOVE PV-PROMO-SOURCE             TO REPORT-NOTES          05900000
              MOVE PV-PROMO-KEY                TO PROMO-EVNT-KEY        05910000
              PERFORM 9999-WRITE-ERROR-REPORT                           05920000
              MOVE 'XS022-STR-GP-ID'           TO PROMO-RPT-DATA-NAME   05930000
              MOVE XS022-STR-GP-ID             TO PROMO-RPT-DATA-VALUE  05940000
              MOVE PV-DOMAIN-SOURCE            TO REPORT-NOTES          05950000
              MOVE PV-DOMAIN-KEY               TO PROMO-EVNT-KEY        05960000
              PERFORM 9999-WRITE-ERROR-REPORT                           05970000
              SET PS-ERROR-FOUND               TO TRUE                  05980000
           END-IF.                                                      05990000
                                                                        06000000
036600     IF PM709-PRNT-OV-STR-SELN-CDE NOT EQUAL                      06010000
              XS022-PRNT-OV-STR-SELN-CDE                                06020000
              MOVE 'PM709-PRNT-OV-STR-SELN-CDE' TO PROMO-RPT-DATA-NAME  06030000
              MOVE PM709-PRNT-OV-STR-SELN-CDE   TO PROMO-RPT-DATA-VALUE 06040000
              MOVE PV-PROMO-SOURCE              TO REPORT-NOTES         06050000
              MOVE PV-PROMO-KEY                 TO PROMO-EVNT-KEY       06060000
              PERFORM 9999-WRITE-ERROR-REPORT                           06070000
              MOVE 'XS022-PRNT-OV-STR-SELN-CDE' TO PROMO-RPT-DATA-NAME  06080000
              MOVE XS022-PRNT-OV-STR-SELN-CDE   TO PROMO-RPT-DATA-VALUE 06090000
              MOVE PV-DOMAIN-SOURCE             TO REPORT-NOTES         06100000
              MOVE PV-DOMAIN-KEY                TO PROMO-EVNT-KEY       06110000
              PERFORM 9999-WRITE-ERROR-REPORT                           06120000
              SET PS-ERROR-FOUND                TO TRUE                 06130000
           END-IF.                                                      06140000
                                                                        06150000
036600     IF PM709-PRNT-OV-STR-GP-CDE NOT EQUAL                        06160000
              XS022-PRNT-OV-STR-GP-CDE                                  06170000
              MOVE 'PM709-PRNT-OV-STR-GP-CDE' TO PROMO-RPT-DATA-NAME    06180000
              MOVE PM709-PRNT-OV-STR-GP-CDE   TO PROMO-RPT-DATA-VALUE   06190000
              MOVE PV-PROMO-SOURCE            TO REPORT-NOTES           06200000
              MOVE PV-PROMO-KEY               TO PROMO-EVNT-KEY         06210000
              PERFORM 9999-WRITE-ERROR-REPORT                           06220000
              MOVE 'XS022-PRNT-OV-STR-GP-CDE' TO PROMO-RPT-DATA-NAME    06230000
              MOVE XS022-PRNT-OV-STR-GP-CDE   TO PROMO-RPT-DATA-VALUE   06240000
              MOVE PV-DOMAIN-SOURCE           TO REPORT-NOTES           06250000
              MOVE PV-DOMAIN-KEY              TO PROMO-EVNT-KEY         06260000
              PERFORM 9999-WRITE-ERROR-REPORT                           06270000
              SET PS-ERROR-FOUND     TO TRUE                            06280000
           END-IF.                                                      06290000
036600     IF PM709-PRNT-OV-STR-GP-ID NOT EQUAL                         06300000
              XS022-PRNT-OV-STR-GP-ID                                   06310000
              MOVE 'PM709-PRNT-OV-STR-GP-ID' TO PROMO-RPT-DATA-NAME     06320000
              MOVE PM709-PRNT-OV-STR-GP-ID   TO PROMO-RPT-DATA-VALUE    06330000
              MOVE PV-PROMO-SOURCE           TO REPORT-NOTES            06340000
              MOVE PV-PROMO-KEY              TO PROMO-EVNT-KEY          06350000
              PERFORM 9999-WRITE-ERROR-REPORT                           06360000
              MOVE 'XS022-PRNT-OV-STR-GP-ID' TO PROMO-RPT-DATA-NAME     06370000
              MOVE XS022-PRNT-OV-STR-GP-ID   TO PROMO-RPT-DATA-VALUE    06380000
              MOVE PV-DOMAIN-SOURCE          TO REPORT-NOTES            06390000
              MOVE PV-DOMAIN-KEY             TO PROMO-EVNT-KEY          06400000
              PERFORM 9999-WRITE-ERROR-REPORT                           06410000
              SET PS-ERROR-FOUND             TO TRUE                    06420000
           END-IF.                                                      06430000
                                                                        06440000
036600     IF PM709-PRNT-ADHC-STR-GP-ID NOT EQUAL                       06450000
              XS022-PRNT-ADHC-STR-GP-ID                                 06460000
              MOVE 'PM709-PRNT-ADHC-STR-GP-ID' TO PROMO-RPT-DATA-NAME   06470000
              MOVE PM709-PRNT-ADHC-STR-GP-ID   TO PROMO-RPT-DATA-VALUE  06480000
              MOVE PV-PROMO-SOURCE             TO REPORT-NOTES          06490000
              MOVE PV-PROMO-KEY                TO PROMO-EVNT-KEY        06500000
              PERFORM 9999-WRITE-ERROR-REPORT                           06510000
              MOVE 'XS022-PRNT-ADHC-STR-GP-ID' TO PROMO-RPT-DATA-NAME   06520000
              MOVE XS022-PRNT-ADHC-STR-GP-ID   TO PROMO-RPT-DATA-VALUE  06530000
              MOVE PV-DOMAIN-SOURCE            TO REPORT-NOTES          06540000
              MOVE PV-DOMAIN-KEY               TO PROMO-EVNT-KEY        06550000
              PERFORM 9999-WRITE-ERROR-REPORT                           06560000
              SET PS-ERROR-FOUND           TO TRUE                      06570000
           END-IF.                                                      06580000
                                                                        06590000
036600     IF PM709-STRT-TMST NOT EQUAL XS022-STRT-TMST                 06600000
              MOVE 'PM709-STRT-TMST'       TO PROMO-RPT-DATA-NAME       06610000
              MOVE PM709-STRT-TMST         TO PROMO-RPT-DATA-VALUE      06620000
              MOVE PV-PROMO-SOURCE         TO REPORT-NOTES              06630000
              MOVE PV-PROMO-KEY            TO PROMO-EVNT-KEY            06640000
              PERFORM 9999-WRITE-ERROR-REPORT                           06650000
              MOVE 'XS022-STRT-TMST'        TO PROMO-RPT-DATA-NAME      06660000
              MOVE XS022-STRT-TMST TO PROMO-RPT-DATA-VALUE              06670000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             06680000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           06690000
              PERFORM 9999-WRITE-ERROR-REPORT                           06700000
              SET PS-ERROR-FOUND            TO TRUE                     06710000
           END-IF.                                                      06720000
                                                                        06730000
036600     IF PM709-END-TMST NOT EQUAL XS022-END-TMST                   06740000
              MOVE 'PM709-END-TMST'         TO PROMO-RPT-DATA-NAME      06750000
              MOVE PM709-END-TMST           TO PROMO-RPT-DATA-VALUE     06760000
              MOVE PV-PROMO-SOURCE          TO REPORT-NOTES             06770000
              MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY           06780000
              PERFORM 9999-WRITE-ERROR-REPORT                           06790000
              MOVE 'XS022-END-TMST'         TO PROMO-RPT-DATA-NAME      06800000
              MOVE XS022-END-TMST           TO PROMO-RPT-DATA-VALUE     06810000
              MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES             06820000
              MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY           06830000
              PERFORM 9999-WRITE-ERROR-REPORT                           06840000
              SET PS-ERROR-FOUND            TO TRUE                     06850000
           END-IF.                                                      06860000
                                                                        06870000
036600     IF PM709-STAT-CDE  NOT EQUAL XS022-STAT-CDE                  06880000
              IF PM709-STAT-CDE = 'D' AND                               06890000
                 XS022-STAT-CDE = 'C'                                   06900000
                   NEXT SENTENCE                                        06910000
              ELSE                                                      06920000
                   MOVE 'PM709-STAT-CDE'         TO PROMO-RPT-DATA-NAME 06930000
                   MOVE PM709-STAT-CDE           TO PROMO-RPT-DATA-VALUE06940000
                   MOVE PV-PROMO-SOURCE          TO REPORT-NOTES        06950000
                   MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY      06960000
                   PERFORM 9999-WRITE-ERROR-REPORT                      06970000
                   MOVE 'XS022-STAT-CDE'         TO PROMO-RPT-DATA-NAME 06980000
                   MOVE XS022-STAT-CDE           TO PROMO-RPT-DATA-VALUE06990000
                   MOVE PV-DOMAIN-SOURCE         TO REPORT-NOTES        07000000
                   MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY      07010000
                   PERFORM 9999-WRITE-ERROR-REPORT                      07020000
                   SET PS-ERROR-FOUND            TO TRUE                07030000
              END-IF                                                    07040000
           END-IF.                                                      07050000
                                                                        07060000
                                                                        07070000
           IF  PS-ERROR-FOUND                                           07080000
037200        IF PM709-LAST-UPD-TMST > XS022-LAST-UPD-TMST              07090000
                 PERFORM 9999-FORMAT-ERROR-RECORD                       07100000
                 PERFORM 9999-WRITE-ERROR-RECORD                        07110000
                 SET PS-ERROR-NOT-FOUND     TO TRUE                     07120000
              END-IF                                                    07130000
           END-IF.                                                      07140000
054500                                                                  07150000
056900 2100-EXIT.                                                       07160000
057000     EXIT.                                                        07170000
043600 EJECT.                                                           07180000
043610                                                                  07190000
                                                                        07200000
      ******************************************************************07210000
      **COMPARES FIELDS BETWEEN FILES TO SEE IF ANY DIFFERENCES EXIST   07220000
      ******************************************************************07230000
       3000-PROCESS-EXTRA-RECORDS.                                      07240000
           IF  PS-NOT-EOF-PROMO                                         07250000
P11215      IF PM709-STAT-CDE = 'D'                                     07260000
C39558         PERFORM 9999-READ-PROMO-EXTRACT                          07270002
P11215      ELSE                                                        07280000
               INITIALIZE REPORT-DETAIL                                 07290000
               MOVE PV-DOMAIN-NF             TO REPORT-NOTES            07300000
               MOVE PV-PROMO-KEY             TO PROMO-EVNT-KEY          07310000
               PERFORM 9999-WRITE-ERROR-REPORT                          07320000
               MOVE PM709-PRICING-STR-GP-RECORD TO ERROR-RECORD         07330000
               PERFORM 9999-WRITE-ERROR-RECORD                          07340000
               PERFORM 9999-READ-PROMO-EXTRACT                          07350000
P11215      END-IF                                                      07360000
           END-IF.                                                      07370000
                                                                        07380000
           IF  PS-NOT-EOF-DOMAIN                                        07390000
P11215      IF XS022-STAT-CDE = 'D'                                     07400000
C39558         PERFORM 9999-READ-DOMAIN-EXTRACT                         07410002
P11215      ELSE                                                        07420000
               INITIALIZE REPORT-DETAIL                                 07430000
               MOVE PV-PROMO-NF              TO REPORT-NOTES            07440000
               MOVE PV-DOMAIN-KEY            TO PROMO-EVNT-KEY          07450000
               PERFORM 9999-WRITE-ERROR-REPORT                          07460000
               MOVE XS022-PRICING-STR-GP-RECORD TO ERROR-RECORD         07470000
               PERFORM 9999-WRITE-ERROR-RECORD                          07480000
               PERFORM 9999-READ-DOMAIN-EXTRACT                         07490000
P11215      END-IF                                                      07500000
           END-IF.                                                      07510000
                                                                        07520000
056900 3000-EXIT.                                                       07530000
057000     EXIT.                                                        07540000
                                                                        07550000
       EJECT.                                                           07560000
059800*----------------------------------------------------------       07570000
059900* 9999-WRAPUP.                                                    07580000
059910*     MOVES ALL ERROR CODES TO THE LINKAGE VARIABLES TO           07590000
059920*     BE PASSED BACK TO THE CALLING PROGRAM.  EXITS THE           07600000
059930*     PROGRAM.                                                    07610000
060000*----------------------------------------------------------       07620000
060100 9999-WRAPUP.                                                     07630000
026600     CLOSE PROMO-EXTRACT-FILE                                     07640000
026600           DOMAIN-EXTRACT-FILE                                    07650000
026600           ERROR-FILE                                             07660000
026600           REPORT-FILE.                                           07670000
                                                                        07680000
           IF  PC-ERROR-RECORD-WRITTEN > 0                              07690000
               MOVE 04               TO RETURN-CODE                     07700000
           END-IF.                                                      07710000
                                                                        07720000
                                                                        07730000
060500                                                                  07740000
060710*9999-EXIT.                                                       07750000
060800 EJECT.                                                           07760000
      ***************************************************************** 07770000
      **FORMAT ERROR-RECORD                                             07780000
      ***************************************************************** 07790000
       9999-FORMAT-ERROR-RECORD.                                        07800000
           MOVE PM709-PRICING-STR-GP-RECORD TO ERROR-RECORD.            07810000
                                                                        07820000
       EJECT.                                                           07830000
      ***************************************************************** 07840000
      **READ PROMO  EXTRACT FILE                                        07850000
      ***************************************************************** 07860000
       9999-READ-PROMO-EXTRACT.                                         07870000
           IF  PS-NOT-EOF-PROMO                                         07880000
               READ PROMO-EXTRACT-FILE INTO PM709-PRICING-STR-GP-RECORD 07890000
                    AT END                                              07900000
                       SET PS-EOF-PROMO TO TRUE                         07910000
               END-READ                                                 07920000
           END-IF.                                                      07930000
                                                                        07940000
           IF  PS-NOT-EOF-PROMO                                         07950000
               ADD +1                      TO PC-PROMO-EXTRACT-RECS-READ07960000
               MOVE PM709-PROMO-INTFC-ID   TO PV-PM-PROMO-INTFC-ID      07970000
               MOVE PM709-MDSE-LNE-ID      TO PV-PM-MDSE-LNE-ID         07980000
               MOVE PM709-STR-GP-TYP-CDE   TO PV-PM-STR-GP-TYP-CDE      07990000
               MOVE PM709-STR-GP-ID        TO PV-PM-STR-GP-ID           08000000
           END-IF.                                                      08010000
                                                                        08020000
       EJECT.                                                           08030000
      ***************************************************************** 08040000
      **READ XS EXTRACT FILE                                            08050000
      ***************************************************************** 08060000
       9999-READ-DOMAIN-EXTRACT.                                        08070000
           IF  PS-NOT-EOF-DOMAIN                                        08080000
               READ DOMAIN-EXTRACT-FILE INTO                            08090000
                                    XS022-PRICING-STR-GP-RECORD         08100000
                    AT END                                              08110000
                       SET PS-EOF-DOMAIN TO TRUE                        08120000
               END-READ                                                 08130000
           END-IF.                                                      08140000
                                                                        08150000
           IF  PS-NOT-EOF-DOMAIN                                        08160000
               ADD +1                     TO PC-DOMAIN-EXTRACT-RECS-READ08170000
               MOVE XS022-PROMO-INTFC-ID  TO PV-XS-PROMO-INTFC-ID       08180000
               MOVE XS022-MDSE-LNE-ID     TO PV-XS-MDSE-LNE-ID          08190000
               MOVE XS022-STR-GP-TYP-CDE  TO PV-XS-STR-GP-TYP-CDE       08200000
               MOVE XS022-STR-GP-ID       TO PV-XS-STR-GP-ID            08210000
                                                                        08220000
           END-IF.                                                      08230000
                                                                        08240000
       EJECT.                                                           08250000
      ***************************************************************** 08260000
      **READ CONTROL CARD FOR FREQUENCY OF COMPARE                      08270000
      ***************************************************************** 08280000
       9999-READ-CONTROL-CARD.                                          08290000
                                                                        08300000
           READ CONTROL-CARD INTO CONTROL-CARD-LAYOUT.                  08310000
                                                                        08320000
       EJECT.                                                           08330000
      ***************************************************************** 08340000
      **WRITE ERROR RECORD                                              08350000
      ***************************************************************** 08360000
       9999-WRITE-ERROR-RECORD.                                         08370000
           WRITE DIFFERENCES-RECORD FROM ERROR-RECORD.                  08380000
           ADD +1  TO PC-ERROR-RECORD-WRITTEN.                          08390000
                                                                        08400000
       EJECT.                                                           08410000
      ***************************************************************** 08420000
      **WRITE ERROR REPORT                                              08430000
      ***************************************************************** 08440000
       9999-WRITE-ERROR-REPORT.                                         08450000
           IF PC-ERROR-REPORT-WRITTEN > 66                              08460000
              PERFORM 9999-PRINT-HEADINGS                               08470000
           ELSE                                                         08480000
              WRITE REPORT-RECORD FROM REPORT-DETAIL                    08490000
              INITIALIZE REPORT-DETAIL                                  08500000
              ADD +1 TO PC-ERROR-REPORT-WRITTEN                         08510000
           END-IF.                                                      08520000
       EJECT.                                                           08530000
      ***************************************************************** 08540000
      **PRINT HEADINGS                                                  08550000
      ***************************************************************** 08560000
       9999-PRINT-HEADINGS.                                             08570000
           ADD 1 TO PC-PAGE-CNT.                                        08580000
           MOVE PC-PAGE-CNT TO DP132O-PAGE-NUMBER.                      08590000
           MOVE ZEROS TO PC-ERROR-REPORT-WRITTEN.                       08600000
                                                                        08610000
491700     WRITE REPORT-RECORD                                          08620000
491800         FROM DP132O-STANDRD-HEADER-132-COLS                      08630000
491900         AFTER ADVANCING PAGE.                                    08640000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     08650000
                                                                        08660000
491700     WRITE REPORT-RECORD                                          08670000
491800         FROM DR-HEAD2                                            08680000
491900         AFTER ADVANCING 1 LINE.                                  08690000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     08700000
                                                                        08710000
491700     WRITE REPORT-RECORD                                          08720000
491800         FROM DR-HEAD3                                            08730000
491900         AFTER ADVANCING 2 LINE.                                  08740000
           ADD +2                       TO PC-ERROR-REPORT-WRITTEN.     08750000
                                                                        08760000
491700     WRITE REPORT-RECORD                                          08770000
491800         FROM DR-HEAD5                                            08780000
491900         AFTER ADVANCING 1 LINE.                                  08790000
                                                                        08800000
           ADD +1                       TO PC-ERROR-REPORT-WRITTEN.     08810000
                                                                        08820000
       EJECT.                                                           08830000
