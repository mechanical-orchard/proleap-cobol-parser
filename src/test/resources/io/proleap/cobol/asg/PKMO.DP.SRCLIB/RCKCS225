000100*-----------------------*                                         00010006
000200 IDENTIFICATION DIVISION.                                         00020006
000300*-----------------------*                                         00030006
000400 PROGRAM-ID.    RCKCS225.                                         00040006
000500 AUTHOR.        JOHN GREFFER (STRATAGEM).                         00050006
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060006
000700 DATE-WRITTEN.  03-19-93.                                         00070006
000800 DATE-COMPILED.                                                   00080006
000900                                                                  00090006
001000*---------------------------------------------------------------* 00100006
001100*    E225 - RECEIVING TRAILER LIST                              * 00110006
001200*                                                               * 00120006
001300*    THIS PROGRAM GENERATES A LIST OF PO NUMBERS BY CARRIER     * 00130006
001400*    AND TRAILER.  LABEL PRINTING CAN BE REQUESTED FOR SELECTED * 00140006
001500*    ITEMS.  SELECTED ITEMS CAN ALSO BE ROUTED TO THE RECEIVER  * 00150006
001600*    INQUIRY AND RECEIVER MAINTENANCE PROGRAMS VIA PF KEY.      * 00160006
001700*    THE SCROLLABLE LIST CAN BE REPOSITIONED BY ENTERING A      * 00170006
001800*    SEARCH FOR PO NUMBER.  THE FAST PATHING CAPABILITY HAS NOT * 00180006
001900*    BEEN ENABLED FOR THIS SCREEN.  THIS PROGRAM CAN ONLY BE    * 00190006
002000*    ENTERED FROM THE TRAILER CRITERIA SCREEN (RCKCS224).       * 00200006
002100*                                                               * 00210006
002200*    THE DP030-OVERRIDE-APPL-ERROR SWITCH IS SET TO TRUE WHEN   * 00220006
002300*    ENTERING THE PROGRAM IN ORDER TO GIVE CONTROL BACK TO THE  * 00230006
002400*    LIST WHEN A NEXT-ACT-APPL-ERROR IS SENT BACK FROM THE      * 00240006
002500*    UPDATE.  THE DP030-RC-APPL-ERROR IS CHECKED TO DETERMINE   * 00250006
002600*    IF A NEXT-ACT-APPL-ERROR IS BEING RETURNED TO THE LIST.    * 00260006
002700*                                                               * 00270006
002800*    SHENG TSANG 6/17/94                                        * 00280006
002900*     3270-VALIDATE-PRINTER-ID.                                 * 00290006
003000*     ADD CODE TO VALIDATE PRINTER ID AGAINST OPER UNIT AND     * 00300006
003100*     FACILITY.                                                 * 00310006
003200*                                                               * 00320006
003210* 07/30/2010  EKTA AGRAWAL             TKID: TKMAV49            * 00321006
003220*             MODIFIED TO DISPLAY THE WAREHOUSE CARTON FIELD    * 00322006
003230*             ON THE SCREEN.                                    * 00323006
003240*             CHANGES TAGGED AS EA 07/30/2010                   * 00324006
003250*---------------------------------------------------------------* 00325006
003251*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)              * 00325117
003255*     DATE:    10/16/2014                                       * 00325511
003256*                                                               * 00325611
003257*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO# * 00325711
003258*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/16/2014    * 00325811
003260*---------------------------------------------------------------* 00326011
003261* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00326131
003262* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00326232
003263* MAKING THE CALL DYNAMIC VS STATIC.                              00326332
003264*---------------------------------------------------------------* 00326432
003266/                                                                 00326606
003270 ENVIRONMENT DIVISION.                                            00327006
003280                                                                  00328006
003290 DATA DIVISION.                                                   00329006
003300                                                                  00330006
003400 WORKING-STORAGE SECTION.                                         00340006
003500                                                                  00350006
003600 01  PV-RCKCS226-COMMAREA.                                        00360006
003700     05  PV-CA-SCAC-CDE              PIC X(04).                   00370006
003800     05  PV-CA-TRLR-ID               PIC X(10).                   00380006
003900     05  PV-CA-ARRIVAL-DTE           PIC X(10).                   00390006
004000     05  PV-CA-PRINTER               PIC X(08).                   00400006
004100     05  PV-TRIP-ID                  PIC S9(09) COMP.             00410006
004200     05  PV-CA-USERID                PIC X(08).                   00420006
004300     05  PV-CA-PRTR-AUTO-CUTTER-IND  PIC X(01).                   00430006
004400     05  PV-CA-PRTR-BARCODE-IND      PIC  X(01).                  00440006
004500     05  PV-CA-PRTR-PRTR-CNTL-IND    PIC  X(01).                  00450006
004600     05  PV-CA-PRTR-TRACK-NBR        PIC S9(04) COMP.             00460006
004700     05  PV-CA-PRNT-PACKAGE-IND      PIC  X(01).                  00470006
004800         88  PV-NOT-PRINT-PACKAGE    VALUE 'N'.                   00480006
004900     05  PV-TRANS-RCVRS-COUNT        PIC S9(04) VALUE +0          00490006
005000                                               COMP SYNC.         00500006
005100                                                                  00510006
005200 01  DK-DB2-KEYS.                                                 00520006
005300     05  DK-OWNER-SCAC-ID                PIC  X(04)  VALUE SPACE. 00530006
005400     05  DK-VEH-NBR                      PIC  X(10)  VALUE SPACE. 00540006
005500     05  DK-ARRIVAL-DTE                  PIC  X(10)  VALUE SPACE. 00550006
005600     05  DK-DEPT-NBR                     PIC  X(03)  VALUE SPACE. 00560006
005700     05  DK-PO-NBR                       PIC S9(09) COMP VALUE +0.00570006
005800     05  DK-ORD-NBR                      PIC S9(09) COMP VALUE +0.00580006
005900     05  DK-REC-SEQ-NBR                  PIC S9(09) COMP VALUE +0.00590006
006000     05  DK-TRIP-ID                      PIC S9(09) COMP VALUE +0.00600006
006100     05  DK-SHIPT-ID                     PIC S9(09) COMP VALUE +0.00610006
006200     05  DK-OPER-UNT-ID                  PIC S9(04) COMP VALUE +0.00620006
006300     05  DK-FCLTY-ID                     PIC S9(04) COMP VALUE +0.00630006
006400     05  DK-CURR-OPER-UNT-ID             PIC S9(04) COMP VALUE +0.00640006
006500     05  DK-CURR-FCLTY-ID                PIC S9(04) COMP VALUE +0.00650006
006600     05  DK-PRTR-ID                      PIC S9(04) COMP VALUE +0.00660006
006700     05  DK-STORE-NMBR                   PIC X(04)  VALUE SPACES. 00670006
006800     05  DK-CNTL-DESC                    PIC X(07)  VALUE SPACES. 00680006
006900                                                                  00690006
007000 01  DN-NULL-INDICATORS.                                          00700006
007100     05  DN-AD-EVNT-DTE                  PIC S9(04) COMP VALUE +0.00710006
007200     05  DN-TKT-FMT-ID                   PIC S9(04) COMP VALUE +0.00720006
007300     05  DN-CURR-TRIP-ID                 PIC S9(04) COMP VALUE +0.00730006
007400                                                                  00740006
007500 01  PC-PROGRAM-CONSTANTS.                                        00750006
007600     05  PC-CURRENT-MAP-NAME             PIC  X(08)  VALUE        00760006
007700                                                     'RC225A  '.  00770006
007800     05  PC-CURRENT-MAPSET-NAME          PIC  X(08)  VALUE        00780006
007900                                                     'RCKM225 '.  00790006
008000     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00800006
008100                                                     'RCKCS225'.  00810006
008200     05  PC-REPORT-PROGRAM-NAME          PIC  X(08)  VALUE        00820006
008300                                                     'PCKCS112'.  00830006
008400     05  PC-DPKCS060                     PIC  X(08)  VALUE        00840006
008500                                                     'DPKCS060'.  00850006
008600     05  PC-AUTOVE-MODULE           PIC  X(08) VALUE 'RCKUT127'.  00860006
008700     05  PC-AUTOVE-MODULE-LENGTH    PIC S9(04) VALUE  +400        00870006
008800                                                    COMP SYNC.    00880006
008900     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00890006
009000     05  PC-LIST-QUEUE-SEQ               PIC  9(01)  VALUE 1.     00900006
009100     05  PC-SEL-QUEUE-SEQ                PIC  9(01)  VALUE 2.     00910006
009200     05  PC-INTER-APPL-CODES.                                     00920006
009300         10 PC-INTER-APPL-CRIT-SPEC     PIC  X(01)  VALUE '1'.    00930006
009400         10 PC-INTER-APPL-YARD-LIST     PIC  X(01)  VALUE 'A'.    00940006
009500         10 PC-INTER-APPL-SULTRLR       PIC  X(01)  VALUE '2'.    00950006
009600     05  PC-ITEMS-PER-PANEL              PIC S9(04)  VALUE +10    00960006
009700                                                     COMP SYNC.   00970006
009800     05  PC-MAX-BLOCKS-IN-ARRAY          PIC S9(04)  VALUE +2     00980006
009900                                                     COMP SYNC.   00990006
010000     05  PC-MAX-ITEMS                    PIC S9(09)  VALUE        01000006
010100                                                     +1000000     01010006
010200                                                     COMP-3.      01020006
010300*PS 10/16/2014 CHANGE STARTS                                      01030015
010310     05  PC-MSG-NUMBER-LENGTH            PIC S9(04)  VALUE +8     01031015
010400                                                     COMP SYNC.   01040006
010410*PS 10/16/2014 CHANGE ENDS                                        01041015
010500     05  PC-MAX-RETRIES                  PIC S9(03)  VALUE 3      01050006
010600                                                     COMP-3.      01060006
010700     05  PC-ZERO                         PIC S9(09)  VALUE +0     01070006
010800                                                     COMP SYNC.   01080006
010900     05  PC-PERCENT                      PIC  X(01)  VALUE '%'.   01090006
011000     05  PC-89                           PIC  X(02)  VALUE '89'.  01100006
011100     05  PC-RC                           PIC  X(02)  VALUE 'RC'.  01110006
011200     05  PC-DWNLD-CDE                   PIC  X(06) VALUE 'ASNDWN'.01120006
011300     05  PC-DWNLD-MOD                 PIC  X(08) VALUE 'WSKCS305'.01130006
011400     05  PC-INQ                          PIC  X(03)  VALUE 'INQ'. 01140006
011500     05  PC-UPD                          PIC  X(03)  VALUE 'UPD'. 01150006
011600     05  PC-DEL                          PIC  X(03)  VALUE 'DEL'. 01160006
011700     05  PC-PRT                          PIC  X(03)  VALUE 'PRT'. 01170006
011800     05  PC-ERR                          PIC  X(03)  VALUE 'ERR'. 01180006
011900     05  PC-997                          PIC S9(04)  VALUE +997   01190006
012000                                                     COMP.        01200006
012100     05  PC-998                          PIC S9(04)  VALUE +998   01210006
012200                                                     COMP.        01220006
012300     05  PC-999                          PIC S9(04)  VALUE +999   01230006
012400                                                     COMP.        01240006
012500     05  PC-N                            PIC  X(01)  VALUE 'N'.   01250006
012600     05  PC-I                            PIC  X(01)  VALUE 'I'.   01260006
012700     05  PC-A                            PIC  X(01)  VALUE 'A'.   01270006
012800     05  PC-R                            PIC  X(01)  VALUE 'R'.   01280006
012900     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   01290006
013000     05  PC-P                            PIC  X(01)  VALUE 'P'.   01300006
013100     05  PC-T                            PIC  X(01)  VALUE 'T'.   01310006
013200     05  PC-01                           PIC  X(02)  VALUE '01'.  01320006
013300     05  PC-90                    PIC  X(02)  VALUE '90'.         01330006
013400     05  PC-DEFAULT-NINES            PIC X(26)  VALUE             01340006
013500                              '9999-09-09-09.09.09.999999'.       01350006
013600     05  PC-OPER-UNT-ID               PIC S9(04) VALUE +0         01360006
013700                                                 COMP.            01370006
013800     05  PC-FCLTY-ID                  PIC S9(04) VALUE +0         01380006
013900                                                 COMP.            01390006
014000     05  PC-MULTIPLE-SHIPMENTS           PIC  X(18)  VALUE        01400006
014100         'MULTIPLE SHIPMENTS'.                                    01410006
014200     05  PC-PACKED-BY-STORE              PIC  X(15)  VALUE        01420006
014300         'PACKED BY STORE'.                                       01430006
014400     05  PC-PRE-TICKETED                 PIC  X(15)  VALUE        01440006
014500         'PRE TICKETED   '.                                       01450006
014600     05  PC-DETAIL-CHECK                 PIC  X(12)  VALUE        01460006
014700         'DETAIL CHECK'.                                          01470006
014800     05  PC-ON-HANGER                    PIC  X(09)  VALUE        01480006
014900         'ON HANGER'.                                             01490006
014910                                                                  01491020
014920     05  PC-E838-RPAMSD                 PIC  X(04) VALUE 'E838'.  01492020
015000                                                                  01500006
015100     05  PC-TSYMSG-NUMBERS.                                       01510006
015200         10  PC-TSYMSG-00005             PIC  9(05)  VALUE 00005. 01520006
015300         10  PC-TSYMSG-00007             PIC  9(05)  VALUE 00007. 01530006
015400         10  PC-TSYMSG-00008             PIC  9(05)  VALUE 00008. 01540006
015500         10  PC-TSYMSG-00050             PIC  9(05)  VALUE 00050. 01550006
015600         10  PC-TSYMSG-00051             PIC  9(05)  VALUE 00051. 01560006
015700         10  PC-TSYMSG-00052             PIC  9(05)  VALUE 00052. 01570006
015800         10  PC-TSYMSG-00053             PIC  9(05)  VALUE 00053. 01580006
015900         10  PC-TSYMSG-00054             PIC  9(05)  VALUE 00054. 01590006
016000         10  PC-TSYMSG-00055             PIC  9(05)  VALUE 00055. 01600006
016100         10  PC-TSYMSG-00057             PIC  9(05)  VALUE 00057. 01610006
016200         10  PC-TSYMSG-00069             PIC  9(05)  VALUE 00069. 01620006
016300         10  PC-TSYMSG-00070             PIC  9(05)  VALUE 00070. 01630006
016400         10  PC-TSYMSG-00082             PIC  9(05)  VALUE 00082. 01640006
016500         10  PC-TSYMSG-00098             PIC  9(05)  VALUE 00098. 01650006
016600         10  PC-TSYMSG-00101             PIC  9(05)  VALUE 00101. 01660006
016700         10  PC-TSYMSG-00148             PIC  9(05)  VALUE 00148. 01670006
016800         10  PC-TSYMSG-00279             PIC  9(05)  VALUE 00279. 01680006
016900         10  PC-TSYMSG-00390             PIC  9(05)  VALUE 00390. 01690006
017000         10  PC-TSYMSG-00416             PIC  9(05)  VALUE 00416. 01700006
017100         10  PC-TSYMSG-00417             PIC  9(05)  VALUE 00417. 01710006
017200         10  PC-TSYMSG-00746             PIC  9(05)  VALUE 00746. 01720006
017300         10  PC-TSYMSG-00984             PIC  9(05)  VALUE 00984. 01730006
017400         10  PC-TSYMSG-01074             PIC  9(05)  VALUE 01074. 01740006
017500         10  PC-TSYMSG-02122             PIC  9(05)  VALUE 02122. 01750006
017600         10  PC-TSYMSG-03138             PIC  9(05)  VALUE 03138. 01760006
017700         10  PC-TSYMSG-03217             PIC  9(05)  VALUE 03217. 01770006
017800         10  PC-TSYMSG-03535             PIC  9(05)  VALUE 03535. 01780006
017900         10  PC-TSYMSG-03536             PIC  9(05)  VALUE 03536. 01790006
018000         10  PC-TSYMSG-03542             PIC  9(05)  VALUE 03542. 01800006
018100         10  PC-TSYMSG-03546             PIC  9(05)  VALUE 03546. 01810006
018200         10  PC-TSYMSG-03565             PIC  9(05)  VALUE 03565. 01820006
018300         10  PC-TSYMSG-03571             PIC  9(05)  VALUE 03571. 01830006
018310         10  PC-TSYMSG-03817             PIC  9(05)  VALUE 03817. 01831027
018400         10  PC-TSYMSG-99901             PIC  9(05)  VALUE 99901. 01840006
018500         10  PC-TSYMSG-99907             PIC  9(05)  VALUE 99907. 01850006
018600                                                                  01860006
018700 01  PM-PROGRAM-MESSAGES.                                         01870006
018800     05  PM-PROGRAM-MESSAGE-1.                                    01880006
018900         10  PM-RET-CDE                  PIC  X(02)  VALUE SPACE. 01890006
019000         10  FILLER                      PIC  X(01)  VALUE '-'.   01900006
019100         10  PM-RET-MSG                  PIC  X(25)  VALUE SPACE. 01910006
019200         10  FILLER                      PIC  X(48)  VALUE SPACE. 01920006
019300                                                                  01930006
019400 01  PS-PROGRAM-SWITCHES.                                         01940006
019500     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'Y'.   01950006
019600         88  PS-NO-ERROR                             VALUE 'Y'.   01960006
019700         88  PS-ERROR                                VALUE 'N'.   01970006
019800     05  PS-COMMAREA-SW                  PIC  X(01)  VALUE 'N'.   01980006
019900         88  PS-COMMAREA-VALID                       VALUE 'Y'.   01990006
020000         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   02000006
020100     05  PS-DONE-SW                      PIC  X(01)  VALUE 'N'.   02010006
020200         88  PS-DONE                                 VALUE 'Y'.   02020006
020300         88  PS-NOT-DONE                             VALUE 'N'.   02030006
020400     05  PS-VALID-SEARCH-PO-SW           PIC X(01)   VALUE 'N'.   02040006
020500         88  PS-VALID-SRCH-PO                        VALUE 'Y'.   02050006
020600         88  PS-INVALID-SRCH-PO                      VALUE 'N'.   02060006
020700     05  PS-SHIPMENT-CURSOR-SW           PIC  X(01)  VALUE 'N'.   02070006
020800         88  PS-NO-MORE-SHIPMENTS                    VALUE 'Y'.   02080006
020900     05  PS-AR-STATUS-SW                 PIC  X(01)  VALUE 'N'.   02090006
021000         88  PS-AR-STATUS                            VALUE 'Y'.   02100006
021100         88  PS-NO-AR-STATUS                         VALUE 'N'.   02110006
021200     05  PS-STATUS-OK-SW                 PIC  X(01)  VALUE 'N'.   02120006
021300         88  PS-STATUS-OK                            VALUE 'Y'.   02130006
021400         88  PS-STATUS-NOT-OK                        VALUE 'N'.   02140006
021500     05  PS-STOR-TRBL-SW                 PIC  X(01)  VALUE 'N'.   02150006
021600         88  PS-NO-STOR-TRBL                         VALUE 'N'.   02160006
021700         88  PS-CURR-STOR-TRBL                       VALUE 'Y'.   02170006
021800         88  PS-PREV-STOR-TRBL                       VALUE 'P'.   02180006
021900     05  PS-OTHER-TRBL-SW                PIC  X(01)  VALUE 'N'.   02190006
022000         88  PS-NO-OTHER-TRBL                        VALUE 'N'.   02200006
022100         88  PS-OTHER-TRBL                           VALUE 'Y'.   02210006
022200     05  PS-ITM-NBR-SW                   PIC  X(01)  VALUE 'N'.   02220006
022300         88  PS-ITM-NBR-NOT-FOUND                    VALUE 'N'.   02230006
022400         88  PS-ITM-NBR-FOUND                        VALUE 'Y'.   02240006
022500     05  PS-DWNLD-TO-WMS-SW            PIC  X(01)    VALUE 'N'.   02250006
022600         88  PS-DWNLD-TO-WMS-YES                     VALUE 'Y'.   02260006
022700         88  PS-DWNLD-TO-WMS-NO                      VALUE 'N'.   02270006
022800     05  PS-END-OF-HDR-CSR-SW          PIC  X(01)    VALUE 'N'.   02280006
022900         88  PS-END-OF-HDR-CSR-YES                   VALUE 'Y'.   02290006
023000         88  PS-END-OF-HDR-CSR-NO                    VALUE 'N'.   02300006
023100     05  PS-CALL-DWNLD-MODULE-SW       PIC  X(01)    VALUE 'N'.   02310006
023200         88  PS-CALL-DWNLD-MODULE-YES                VALUE 'Y'.   02320006
023300         88  PS-CALL-DWNLD-MODULE-NO                 VALUE 'N'.   02330006
023310     05  PS-TRANSCRIBED-RCVRS-SW       PIC  X(01)    VALUE 'N'.   02331006
023320         88  PS-TRANS-RCVRS                          VALUE 'Y'.   02332006
023330         88  PS-NO-TRANS-RCVRS                       VALUE 'N'.   02333006
023340     05  PS-END-OF-TRBL-CSR-SW         PIC  X(01)    VALUE 'N'.   02334006
023350         88  PS-END-OF-TRBL-CSR-YES                  VALUE 'Y'.   02335006
023360         88  PS-END-OF-TRBL-CSR-NO                   VALUE 'N'.   02336006
023370     05  PS-TRBL-DUMMY-SW              PIC  X(01)    VALUE 'N'.   02337006
023380         88  PS-TRBL-DUMMY-YES                       VALUE 'Y'.   02338006
023390         88  PS-TRBL-DUMMY-NO                        VALUE 'N'.   02339006
023391     05  PS-FIRST-RECORD-SW            PIC  X(01)    VALUE 'N'.   02339106
023392         88  PS-FIRST-RECORD-YES                     VALUE 'Y'.   02339206
023393         88  PS-FIRST-RECORD-NO                      VALUE 'N'.   02339306
023394                                                                  02339406
023395 01  PV-PROGRAM-VARIABLES.                                        02339506
023396     05  PV-TRIP-ID-DISPLAY        PIC 9(09).                     02339606
023397     05  PV-DP020-LOCATION         PIC  X(04)  VALUE '0000'.      02339706
023398     05  PV-LOCATION-N REDEFINES PV-DP020-LOCATION                02339806
023399                                   PIC  9(04).                    02339906
023400     05  PV-NUMBER-OF-SELECTED-ITEM   PIC S9(9) VALUE ZERO        02340006
023500                                                COMP-3.           02350006
023600     05  PV-TRECEIV-ACTL-CART-CNT        PIC S9(04)  COMP.        02360006
023700     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02370006
023800                                                     COMP.        02380006
023900     05  PV-PRINTER-NO.                                           02390006
024000         10  PV-PRINTER-NO-9             PIC  9(03)  VALUE ZERO.  02400006
024100     05  PV-SUB                          PIC S9(04)  VALUE +0     02410006
024200                                                     COMP SYNC.   02420006
024300     05  PV-SUB-X                        PIC S9(04)  VALUE +0     02430006
024400                                                     COMP SYNC.   02440006
024500     05  PV-REMAINDER                    PIC S9(04)  VALUE +0     02450006
024600                                                     COMP SYNC.   02460006
024700     05  PV-READ-COUNT                   PIC S9(09)  VALUE +0     02470006
024800                                                     COMP-3.      02480006
024900     05  PV-ITEMS-PROCESSED              PIC S9(09)  VALUE +0     02490006
025000                                                     COMP-3.      02500006
025100     05  PV-HOLD-SELECTED-ITEMS          PIC S9(09)  VALUE +0     02510006
025200                                                     COMP-3.      02520006
025300     05  PV-ITEM-IN-USE                  PIC S9(09)  VALUE +0     02530006
025400                                                     COMP-3.      02540006
025500     05  PV-TOP-ITEM                     PIC S9(09)  VALUE +0     02550006
025600                                                     COMP-3.      02560006
025700     05  PV-BOTTOM-ITEM                  PIC S9(09)  VALUE +0     02570006
025800                                                     COMP-3.      02580006
025900     05  PV-TEMP-BLOCK-NUMBER            PIC S9(09)  VALUE +0     02590006
026000                                                     COMP-3.      02600006
026100     05  PV-BLOCK-NUMBER                 PIC S9(04)  VALUE +0     02610006
026200                                                     COMP SYNC.   02620006
026300     05  PV-CICS-RESP                    PIC S9(04)  VALUE +0     02630006
026400                                                     COMP SYNC.   02640006
026500     05  PV-ITEM                         PIC S9(04)  VALUE +0     02650006
026600                                                     COMP SYNC.   02660006
026700     05  PV-SEL-QUEUE-ITEM               PIC S9(04)  VALUE +0     02670006
026800                                                     COMP SYNC.   02680006
026900     05  PV-SAVE-ITEM                    PIC S9(04)  VALUE +0     02690006
027000                                                     COMP SYNC.   02700006
027100     05  PV-HIGHEST-BLOCK-WRITTEN        PIC S9(04)  VALUE +0     02710006
027200                                                     COMP SYNC.   02720006
027300     05  PV-LIST-ITEM-NUMBER             PIC S9(04)  VALUE +0     02730006
027400                                                     COMP SYNC.   02740006
027500     05  PV-FIRST-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0     02750006
027600                                                     COMP SYNC.   02760006
027700     05  PV-NEXT-BLOCK-IN-ARRAY          PIC S9(04)  VALUE +0     02770006
027800                                                     COMP SYNC.   02780006
027900     05  PV-PREV-BLOCK-IN-ARRAY          PIC S9(04)  VALUE +0     02790006
028000                                                     COMP SYNC.   02800006
028100     05  PV-FIRST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0     02810006
028200                                                     COMP SYNC.   02820006
028300     05  PV-LAST-BLOCK-IN-RANGE          PIC S9(04)  VALUE +0     02830006
028400                                                     COMP SYNC.   02840006
028500     05  PV-START-OF-SELECTED-RANGE      PIC S9(04)  VALUE +0     02850006
028600                                                     COMP SYNC.   02860006
028700     05  PV-END-OF-SELECTED-RANGE        PIC S9(04)  VALUE +0     02870006
028800                                                     COMP SYNC.   02880006
028900     05  PV-SQL-SUB                      PIC S9(04)  VALUE +0     02890006
029000                                                     COMP SYNC.   02900006
029100     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE +0     02910006
029200                                                     COMP SYNC.   02920006
029300     05  PV-SUB1                         PIC S9(04)  VALUE ZERO   02930006
029400                                                     COMP.        02940006
029500     05  PV-TOTAL-CTN-CNT                PIC S9(09)  VALUE ZERO   02950006
029600                                                     COMP.        02960006
029700     05  PV-TOTAL-ACTL-CTN-CNT           PIC S9(09)  VALUE ZERO   02970006
029800                                                     COMP.        02980006
029900     05  PV-TOTAL-DMG-CTN-CNT            PIC S9(09)  VALUE ZERO   02990006
030000                                                     COMP.        03000006
030100     05  PV-INDNULL1                     PIC S9(04)  VALUE ZERO   03010006
030200                                                     COMP.        03020006
030300     05  PV-INDNULL2                     PIC S9(04)  VALUE ZERO   03030006
030400                                                     COMP.        03040006
030500     05  PV-INDNULL3                     PIC S9(04)  VALUE ZERO   03050006
030600                                                     COMP.        03060006
030700     05  PV-DB2-COUNT                    PIC S9(09)  VALUE +0     03070006
030800                                                     COMP-3.      03080006
030900     05 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.      03090006
031000     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          03100006
031100         10 FILLER                   PIC  X(03).                  03110006
031200         10 PV-2-DIGIT-DC-ABBR       PIC  X(02).                  03120006
031300     05  PV-FORMAT-DATE                  PIC  X(06)  VALUE SPACES.03130006
031400     05  FILLER REDEFINES PV-FORMAT-DATE.                         03140006
031500         10  PV-MM                       PIC  X(02).              03150006
031600         10  PV-DD                       PIC  X(02).              03160006
031700         10  PV-YY                       PIC  X(02).              03170006
031800     05  PV-DB2-DATE-HOST             PIC  X(10).                 03180006
031900     05  PV-DB2-REC-DATE              PIC  X(10).                 03190006
032000     05  PV-DB2-DATE                  PIC  X(10).                 03200006
032100     05  FILLER  REDEFINES PV-DB2-DATE.                           03210006
032200         10  PV-DB2-DATE-CC           PIC  X(02).                 03220006
032300         10  PV-DB2-DATE-YY           PIC  X(02).                 03230006
032400         10  FILLER                   PIC  X(01).                 03240006
032500         10  PV-DB2-DATE-MM           PIC  X(02).                 03250006
032600         10  FILLER                   PIC  X(01).                 03260006
032700         10  PV-DB2-DATE-DD           PIC  X(02).                 03270006
032800     05  PV-DISPLAY-DATE.                                         03280006
032900         10  PV-DISPLAY-DATE-MM       PIC  X(02).                 03290006
033000         10  FILLER                   PIC  X(01) VALUE '/'.       03300006
033100         10  PV-DISPLAY-DATE-DD       PIC  X(02).                 03310006
033200         10  FILLER                   PIC  X(01) VALUE '/'.       03320006
033300         10  PV-DISPLAY-DATE-YY       PIC  X(02).                 03330006
033400     05  PV-PO-KEY.                                               03340006
033500         10  PV-OP-CO                 PIC  9(02).                 03350006
033600*PS 10/16/2014 CHANGE STARTS                                      03360011
033610         10  PV-PO-NBR                PIC  X(08).                 03361011
033611         10  PV-PO-NBR-N              PIC  9(08) VALUE ZEROES.    03361113
033620*PS 10/16/2014 CHANGE ENDS                                        03362011
033700     05  PV-OPER-UNT-ID               PIC 9(04).                  03370006
033800     05  PV-OPER-UNT-ID-X REDEFINES                               03380006
033900         PV-OPER-UNT-ID               PIC X(04).                  03390006
034000     05  PV-CHAR-ARRAY.                                           03400006
034100         10  PV-CHAR    OCCURS  4 TIMES                           03410006
034200                        INDEXED BY PV-CHAR-ARRAY-INDEX            03420006
034300                                         PIC  9(01).              03430006
034400     05  PV-X                            PIC  9(03)  VALUE ZERO.  03440006
034500     05  PV-Q                            PIC  9(03)  VALUE ZERO.  03450006
034600     05  PV-R                            PIC  9(01)  VALUE ZERO.  03460006
034700     05  PV-CICS-MSG-AREA          PIC  X(100) VALUE SPACE.       03470006
034800     05  PV-MOD-10-CK-DGT                PIC  9(01)  VALUE ZERO.  03480006
034900     05  PV-RCVR-SEQ-4-DGT               PIC  9(04)  VALUE ZERO.  03490006
035000     05  PV-RCVR-SEQ-4-X REDEFINES PV-RCVR-SEQ-4-DGT.             03500006
035100         10  FILLER                      PIC  X(01).              03510006
035200         10  PV-RCVR-SEQ-3-X             PIC  X(03).              03520006
035300     05  PV-DISPLAY-TRIP                 PIC  9(09).              03530006
035400     05  PV-ERROR-MSG.                                            03540006
035500         10  FILLER                     PIC X(4) VALUE 'PO= '.    03550006
035600         10  PV-ERROR-PO                PIC Z(8)9.                03560006
035700         10  FILLER                     PIC X(6) VALUE ' RCVR='.  03570006
035800         10  PV-ERROR-SEQ               PIC Z(8)9.                03580006
035900         10  FILLER                     PIC X(6) VALUE ' OPER='.  03590006
036000         10  PV-ERROR-OPER-UNT-ID       PIC Z(4)9.                03600006
036100         10  FILLER                     PIC X(7) VALUE ' FCLTY='. 03610006
036200         10  PV-ERROR-FCLTY-ID          PIC Z(3)9.                03620006
036300     05  PV-PO-NBR-8-POSITIONS          PIC 9(08) VALUE ZEROES.   03630006
036400* EA 07/30/2010                                                   03640006
036500     05  PV-PRCSD-CARTONS            PIC S9(9) VALUE ZERO         03650006
036600                                               COMP.              03660006
036700     05  PV-EXP-PRCSD-CARTONS        PIC S9(9) VALUE ZERO         03670006
036800                                               COMP.              03680006
036801     05  PV-BULK-MULT-SKU                PIC S9(09)  VALUE +0     03680122
036802                                                     COMP-3.      03680222
036810* EA 07/30/2010                                                   03681006
036820                                                                  03682006
036830******************************************************************03683006
036840**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03684006
036850**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03685006
036860**  APPLICATION-SPECIFIC COMMAREA.                              **03686006
036870******************************************************************03687006
036880 01  LQW-LIST-QUEUE-WORK-AREA.                                    03688006
036890     05  LQW-BLOCK-MODIFIED              PIC  X(01)  VALUE SPACE. 03689006
036900     05  LQW-ITEM-ENTRIES                                         03690006
037000                 OCCURS 10 TIMES                                  03700006
037100                 INDEXED BY LQW-IDX.                              03710006
037200         10  LQW-LIST-ITEM-NUMBER        PIC S9(09)  COMP-3.      03720006
037300         10  LQW-TEMP-SELECTED-SW        PIC  X(01).              03730006
037400         10  LQW-SELECTED-SW             PIC  X(01).              03740006
037500             88  LQW-SELECT                          VALUE 'S'.   03750006
037600             88  LQW-DESELECT                        VALUE ' '.   03760006
037700*PS 10/16/2014 CHANGE STARTS                                      03770012
037710         10  LQW-PO-NBR                  PIC  S9(09) COMP.        03771012
037720*PS 10/16/2014 CHANGE ENDS                                        03772012
037800         10  LQW-REC-SEQ-NBR             PIC  S9(04) COMP.        03780006
037900         10  LQW-STOR-IND                PIC  X(01).              03790006
038000         10  LQW-ENT-NAME-DESC           PIC  X(14).              03800006
038100         10  LQW-OPER-SET-DESC           PIC  X(15).              03810006
038200         10  LQW-PKGNG-CDE               PIC  X(01).              03820006
038300         10  LQW-SEA-NAME-DESC           PIC  X(05).              03830006
038400         10  LQW-CTN-CNT                 PIC  S9(04) COMP.        03840006
038500         10  LQW-ACTL-CTN-CNT            PIC  S9(04) COMP.        03850006
038600         10  LQW-DMG-CTN-CNT             PIC  S9(04) COMP.        03860006
038700         10  LQW-REC-CLK                 PIC  X(03).              03870006
038800         10  LQW-SHIPT-ID                PIC  S9(09) COMP.        03880006
038900         10  LQW-OPER-UNT-ID             PIC  S9(04) COMP.        03890006
039000         10  LQW-FCLTY-ID                PIC  S9(04) COMP.        03900006
039100*                                                                 03910006
039200         10  LQW-ARRIVAL-DTE             PIC  X(06).              03920006
039300         10  LQW-AD-INFO                 PIC  X(04).              03930006
039400         10  LQW-PRE-TKT-IND             PIC  X(01).              03940006
039500         10  LQW-PACK-BY-ST-IND          PIC  X(01).              03950006
039600         10  LQW-AD-DATE                 PIC  X(06).              03960006
039700         10  LQW-PO-INSTR                PIC  X(25).              03970006
039800         10  LQW-DETAIL-CHECK            PIC  X(01).              03980006
039900         10  LQW-TKT-TYP                 PIC  X(06).              03990006
040000         10  LQW-DEPT-CLASS.                                      04000006
040100             15  LQW-DEPT                PIC  X(03).              04010006
040200             15  LQW-CLASS.                                       04020006
040300                 20  LQW-MAJOR-CLASS     PIC  X(01).              04030006
040400                 20  LQW-CLASS-ZERO      PIC  X(01).              04040006
040500         10  LQW-MULT-IND                PIC  X(01).              04050006
040600         10  LQW-GOH-IND                 PIC  X(01).              04060006
040700         10  LQW-STOR-TRBL-SW            PIC  X(01).              04070006
040800             88  LQW-NO-STOR-TRBL             VALUE 'N'.          04080006
040900             88  LQW-CURR-STOR-TRBL           VALUE 'Y'.          04090006
041000             88  LQW-PREV-STOR-TRBL           VALUE 'P'.          04100006
041100         10  LQW-OTHER-TRBL-SW           PIC  X(01).              04110006
041200             88  LQW-NO-OTHER-TRBL            VALUE 'N'.          04120006
041300             88  LQW-OTHER-TRBL               VALUE 'Y'.          04130006
041400         10  LQW-ARRIVAL-DTE-CC          PIC  X(02).              04140006
041410         10  LQW-BULK-MULT-SKU-SW        PIC  X(01).              04141030
041420             88  LQW-BULK-MULT-SKU-YES        VALUE 'Y'.          04142029
041440             88  LQW-BULK-MULT-SKU-NO         VALUE 'N'.          04144029
041450                                                                  04145029
041500                                                                  04150006
041600                                                                  04160006
041700/                                                                 04170006
041800*----------------------------------------------------------------*04180006
041900*    COPYBOOK FOR LOCATION CALL MODULE                            04190006
042000*-----------------------------------------------------------------04200006
042100     COPY XLWS071.                                                04210006
042200                                                                  04220006
042300/                                                                 04230006
042400*----------------------------------------------------------------*04240006
042500*    COPYBOOK FOR ITEM DATA CALL MODULE                           04250006
042600*-----------------------------------------------------------------04260006
042700     COPY XLWS001.                                                04270006
042800                                                                  04280006
042900*---------------------------------------------------------------* 04290006
043000*  RECORD LAYOUT FOR THE RECEIVER SELECTION TEMP STORAGE QUEUE. * 04300006
043100*---------------------------------------------------------------* 04310006
043200                                                                  04320006
043300     COPY RCWS013.                                                04330006
043400                                                                  04340006
043410*---------------------------------------------------------------* 04341018
043420*  RECORD LAYOUT RPA MISDIRECT CALLED MODULE RCKCS838           * 04342018
043430*---------------------------------------------------------------* 04343018
043440     COPY RCWS077.                                                04344018
043450                                                                  04345018
043500/                                                                 04350006
043600*---------------------------------------------------------------* 04360006
043700*  RECORD LAYOUT FOR THE PRINTER LINE COMMANDS                  * 04370006
043800*---------------------------------------------------------------* 04380006
043900                                                                  04390006
044000     COPY DSWS004.                                                04400006
044100/                                                                 04410006
044200*-----------------------------------------------------------------04420006
044300*  ASN DOWNLOAD CONTROL TABLE MAINTENANCE                         04430006
044400*-----------------------------------------------------------------04440006
044500     COPY WSWS001.                                                04450006
044600                                                                  04460006
044700/                                                                 04470006
044800*---------------------------------------------------------------* 04480006
044900*  RECORD LAYOUT FOR THE PRINTER CONTROL ROUTINE DPKCS060.      * 04490006
045000*---------------------------------------------------------------* 04500006
045100                                                                  04510006
045200     COPY DPWS072.                                                04520006
045300                                                                  04530006
045400                                                                  04540006
045500/                                                                 04550006
045600*---------------------------------------------------------------* 04560006
045700*  RECORD LAYOUT FOR THE YARD SELECTION TEMP STORAGE QUEUE.     * 04570006
045800*---------------------------------------------------------------* 04580006
045900                                                                  04590006
046000     COPY TRWS006.                                                04600006
046100                                                                  04610006
046200/                                                                 04620006
046300*---------------------------------------------------------------* 04630006
046400*    MAP LAYOUT                                                 * 04640006
046500*---------------------------------------------------------------* 04650006
046600                                                                  04660006
046700     COPY RCKM225.                                                04670006
046800                                                                  04680006
046900 01  MR-OCCURS-LAYOUT REDEFINES RC225AO.                          04690006
047010     05  FILLER                          PIC X(12).               04701017
047100     05  FILLER.                                                  04710006
047200         10  MR-OWNER-SCAC-IDL           PIC S9(04)  COMP.        04720006
047300         10  MR-OWNER-SCAC-IDA           PIC  X(01).              04730006
047400         10  MR-OWNER-SCAC-IDC           PIC  X(01).              04740006
047500         10  MR-OWNER-SCAC-IDH           PIC  X(01).              04750006
047600         10  MR-OWNER-SCAC-ID-X.                                  04760006
047700             15  MR-OWNER-SCAC-ID        PIC  X(04).              04770006
047800                                                                  04780006
047900         10  MR-VEH-NBRL                 PIC S9(04)  COMP.        04790006
048000         10  MR-VEH-NBRA                 PIC  X(01).              04800006
048100         10  MR-VEH-NBRC                 PIC  X(01).              04810006
048200         10  MR-VEH-NBRH                 PIC  X(01).              04820006
048300         10  MR-VEH-NBR-X.                                        04830006
048400             15  MR-VEH-NBR              PIC  X(10).              04840006
048500                                                                  04850006
048600         10  MR-SPONUML                  PIC S9(04)  COMP.        04860006
048700         10  MR-SPONUMA                  PIC  X(01).              04870006
048800         10  MR-SPONUMC                  PIC  X(01).              04880006
048900         10  MR-SPONUMH                  PIC  X(01).              04890006
049000         10  MR-SPONUM-X.                                         04900006
049100*PS 10/16/2014 CHANGE STARTS                                      04910016
049110             15  MR-SPONUM               PIC  9(7)9.              04911016
049120*PS 10/16/2014 CHANGE ENDS                                        04912016
049200                                                                  04920006
049300         10  MR-PRINTERL                 PIC S9(04)  COMP.        04930006
049400         10  MR-PRINTERA                 PIC  X(01).              04940006
049500         10  MR-PRINTERC                 PIC  X(01).              04950006
049600         10  MR-PRINTERH                 PIC  X(01).              04960006
049700         10  MR-PRINTER                  PIC  X(08).              04970006
049800                                                                  04980006
049900         10  MR-RCPT-DTEL                PIC S9(04)  COMP.        04990006
050000         10  MR-RCPT-DTEA                PIC  X(01).              05000006
050100         10  MR-RCPT-DTEC                PIC  X(01).              05010006
050200         10  MR-RCPT-DTEH                PIC  X(01).              05020006
050300         10  MR-RCPT-DTE                 PIC  X(08).              05030006
050400                                                                  05040006
050500         10  MR-TRIP-IDL                 PIC S9(04)  COMP.        05050006
050600         10  MR-TRIP-IDA                 PIC  X(01).              05060006
050700         10  MR-TRIP-IDC                 PIC  X(01).              05070006
050800         10  MR-TRIP-IDH                 PIC  X(01).              05080006
050900         10  MR-TRIP-ID                  PIC  X(09).              05090006
051000                                                                  05100006
051100         10  FILLER                      PIC  X(36).              05110006
051200* EA 07/30/2010                                                   05120006
051300                                                                  05130006
051400         10  MR-WEXCTN-IDL                 PIC S9(04)  COMP.      05140006
051500         10  MR-WEXCTN-IDA                 PIC  X(01).            05150006
051600         10  MR-WEXCTN-IDC                 PIC  X(01).            05160006
051700         10  MR-WEXCTN-IDH                 PIC  X(01).            05170006
051800         10  MR-WEXCTN-CNT                 PIC  ZZZZZZZ.          05180006
051900                                                                  05190006
051910         10  MR-WCTN-IDL                 PIC S9(04)  COMP.        05191006
051920         10  MR-WCTN-IDA                 PIC  X(01).              05192006
051921         10  MR-WCTN-IDC                 PIC  X(01).              05192106
051922         10  MR-WCTN-IDH                 PIC  X(01).              05192206
051923         10  MR-WCTN-CNT                 PIC  ZZZZZZZ.            05192306
051924* EA 07/30/2010                                                   05192406
051925* DMH - 4/27/2021 - BEGIN                                         05192525
051926         10  MR-B-MSGL                   PIC S9(04)  COMP.        05192625
051927         10  MR-B-MSGA                   PIC  X(01).              05192725
051928         10  MR-B-MSGC                   PIC  X(01).              05192825
051929         10  MR-B-MSGH                   PIC  X(01).              05192925
051930         10  MR-B-MSG                    PIC  X(23).              05193025
051931* DMH - 4/27/2021                                                 05193125
051932                                                                  05193206
051933     05  MR-SCROLL-AREA OCCURS 10 TIMES.                          05193306
051934         10  MR-SELECTL                  PIC S9(04)  COMP.        05193406
051935         10  MR-SELECTA                  PIC  X(01).              05193506
051936         10  MR-SELECTC                  PIC  X(01).              05193606
051937         10  MR-SELECTH                  PIC  X(01).              05193706
051940         10  MR-SELECTI                  PIC  X(01).              05194006
051950                                                                  05195006
051960         10  MR-PO-NBRL                  PIC S9(04)  COMP.        05196006
051970         10  MR-PO-NBRA                  PIC  X(01).              05197006
051980         10  MR-PO-NBRC                  PIC  X(01).              05198006
051990         10  MR-PO-NBRH                  PIC  X(01).              05199006
052000*PS 10/16/2015 CHANGE STARTS                                      05200011
052010         10  MR-PO-NBR                   PIC  X(08).              05201011
052020*PS 10/16/2015 CHANGE ENDS                                        05202011
052100                                                                  05210006
052200         10  MR-REC-SEQ-NBRL             PIC S9(04)  COMP.        05220006
052300         10  MR-REC-SEQ-NBRA             PIC  X(01).              05230006
052400         10  MR-REC-SEQ-NBRC             PIC  X(01).              05240006
052500         10  MR-REC-SEQ-NBRH             PIC  X(01).              05250006
052600         10  MR-REC-SEQ-NBR              PIC  X(04).              05260006
052700                                                                  05270006
052800         10  MR-STOR-INDL                PIC S9(04)  COMP.        05280006
052900         10  MR-STOR-INDA                PIC  X(01).              05290006
053000         10  MR-STOR-INDC                PIC  X(01).              05300006
053100         10  MR-STOR-INDH                PIC  X(01).              05310006
053200         10  MR-STOR-IND                 PIC  X(01).              05320006
053300                                                                  05330006
053400         10  MR-ENT-NAME-DESCL           PIC S9(04)  COMP.        05340006
053500         10  MR-ENT-NAME-DESCA           PIC  X(01).              05350006
053600         10  MR-ENT-NAME-DESCC           PIC  X(01).              05360006
053700         10  MR-ENT-NAME-DESCH           PIC  X(01).              05370006
053800         10  MR-ENT-NAME-DESC            PIC  X(14).              05380006
053900                                                                  05390006
054000         10  MR-OPER-SET-DESCL           PIC S9(04)  COMP.        05400006
054100         10  MR-OPER-SET-DESCA           PIC  X(01).              05410006
054200         10  MR-OPER-SET-DESCC           PIC  X(01).              05420006
054300         10  MR-OPER-SET-DESCH           PIC  X(01).              05430006
054400         10  MR-OPER-SET-DESC            PIC  X(15).              05440006
054500                                                                  05450006
054600         10  MR-MULTIPLE-INDL            PIC S9(04)  COMP.        05460006
054700         10  MR-MULTIPLE-INDA            PIC  X(01).              05470006
054800         10  MR-MULTIPLE-INDC            PIC  X(01).              05480006
054900         10  MR-MULTIPLE-INDH            PIC  X(01).              05490006
055000         10  MR-MULTIPLE-IND             PIC  X(01).              05500006
055100                                                                  05510006
055200         10  MR-PKGNG-CDEL               PIC S9(04)  COMP.        05520006
055300         10  MR-PKGNG-CDEA               PIC  X(01).              05530006
055400         10  MR-PKGNG-CDEC               PIC  X(01).              05540006
055500         10  MR-PKGNG-CDEH               PIC  X(01).              05550006
055600         10  MR-PKGNG-CDE                PIC  X(01).              05560006
055700                                                                  05570006
055800         10  MR-SEA-NAME-DESCL           PIC S9(04)  COMP.        05580006
055900         10  MR-SEA-NAME-DESCA           PIC  X(01).              05590006
056000         10  MR-SEA-NAME-DESCC           PIC  X(01).              05600006
056100         10  MR-SEA-NAME-DESCH           PIC  X(01).              05610006
056200         10  MR-SEA-NAME-DESC            PIC  X(05).              05620006
056300                                                                  05630006
056400         10  MR-CARTON-CNTL              PIC S9(04)  COMP.        05640006
056500         10  MR-CARTON-CNTA              PIC  X(01).              05650006
056600         10  MR-CARTON-CNTC              PIC  X(01).              05660006
056700         10  MR-CARTON-CNTH              PIC  X(01).              05670006
056800         10  MR-CARTON-CNT-X.                                     05680006
056900             15  MR-CARTON-CNT           PIC  Z(3)9.              05690006
057000                                                                  05700006
057100         10  MR-ACTL-CARTON-CNTL         PIC S9(04)  COMP.        05710006
057200         10  MR-ACTL-CARTON-CNTA         PIC  X(01).              05720006
057300         10  MR-ACTL-CARTON-CNTC         PIC  X(01).              05730006
057400         10  MR-ACTL-CARTON-CNTH         PIC  X(01).              05740006
057500         10  MR-ACTL-CARTON-CNT-X.                                05750006
057600             15  MR-ACTL-CARTON-CNT      PIC  Z(3)9.              05760006
057700                                                                  05770006
057800         10  MR-DMG-CARTON-CNTL          PIC S9(04)  COMP.        05780006
057900         10  MR-DMG-CARTON-CNTA          PIC  X(01).              05790006
058000         10  MR-DMG-CARTON-CNTC          PIC  X(01).              05800006
058100         10  MR-DMG-CARTON-CNTH          PIC  X(01).              05810006
058200         10  MR-DMG-CARTON-CNT-X.                                 05820006
058300             15  MR-DMG-CARTON-CNT       PIC  Z(3)9.              05830006
058400                                                                  05840006
058500         10  MR-REC-CLERKL               PIC S9(04)  COMP.        05850006
058600         10  MR-REC-CLERKA               PIC  X(01).              05860006
058700         10  MR-REC-CLERKC               PIC  X(01).              05870006
058800         10  MR-REC-CLERKH               PIC  X(01).              05880006
058900         10  MR-REC-CLERK                PIC  X(03).              05890006
059000                                                                  05900006
059100/                                                                 05910006
059200*---------------------------------------------------------------* 05920006
059300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05930006
059400*---------------------------------------------------------------* 05940006
059500                                                                  05950006
059600     COPY DPWS015.                                                05960006
059700                                                                  05970006
059800*---------------------------------------------------------------* 05980006
059900*    FUNCTION KEYS COPYBOOK.                                    * 05990006
060000*---------------------------------------------------------------* 06000006
060100                                                                  06010006
060200     COPY DPWS016.                                                06020006
060300                                                                  06030006
060400***************************************************************** 06040006
060500*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 06050006
060600*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 06060006
060700***************************************************************** 06070006
060800     COPY RCWS040.                                                06080006
060900/                                                                 06090006
061000*---------------------------------------------------------------* 06100006
061100*    NUMERIC EDIT LAYOUT.                                       * 06110006
061200*---------------------------------------------------------------* 06120006
061300                                                                  06130006
061400     COPY DPWS010I.                                               06140006
061500/                                                                 06150006
061600******************************************************************06160032
061700** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **06170032
061710** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **06171032
061800******************************************************************06180032
061900                                                                  06190006
062000     COPY DPWS030.                                                06200006
062010     COPY DPWS930.                                                06201032
062100/                                                                 06210006
062200*---------------------------------------------------------------* 06220006
062300*    STANDARD COMMAREA.                                         * 06230006
062400*---------------------------------------------------------------* 06240006
062500                                                                  06250006
062600     COPY DPWS020.                                                06260006
062700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                06270006
062800                                                                  06280006
062900*---------------------------------------------------------------* 06290006
063000* INTER-APPLICATION COMMAREA.                                   * 06300006
063100*---------------------------------------------------------------* 06310006
063200                                                                  06320006
063300         10  INTER-APPL-COMM-AREA       PIC X(200).               06330006
063400     COPY RCWS012.                                                06340006
063500     COPY RCWS015.                                                06350006
063600**** THE FOLLOWING COMMAREA IS USED TO CREATE TROUBLE             06360006
063700     COPY PCWS000.                                                06370006
063800*---------------------------------------------------------------* 06380006
063900*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 06390006
064000*---------------------------------------------------------------* 06400006
064100         10  ASC-SPECIFIC-COMMAREA.                               06410006
064200             15  ASC-LIST-KEYS.                                   06420006
064300                 20  ASC-KEY-OWNER-SCAC-ID           PIC  X(04).  06430006
064400                 20  ASC-KEY-VEH-NBR                 PIC  X(10).  06440006
064500                 20  ASC-KEY-ARRIVAL-DTE             PIC  X(10).  06450006
064600                 20  ASC-KEY-PO-NBR-X.                            06460006
064700*PS 10/16/2015 CHANGE STARTS                                      06470011
064710                     25  ASC-KEY-PO-NBR              PIC  9(08).  06471011
064720*PS 10/16/2015 CHANGE ENDS                                        06472011
064800                 20  ASC-KEY-REC-SEQ-NBR             PIC S9(04)   06480006
064900                                                         COMP.    06490006
065000                 20  ASC-KEY-TRIP-ID                 PIC S9(09)   06500006
065100                                                         COMP.    06510006
065200                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   06520006
065300                                                         COMP.    06530006
065400                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   06540006
065500                                                         COMP.    06550006
065600                 20  ASC-AUTO-VE-SW                  PIC X(01).   06560006
065700                     88 ASC-AUTO-VE                  VALUE 'Y'.   06570006
065800                     88 ASC-AUTO-VE-NO               VALUE 'N'.   06580006
065900                                                                  06590006
066000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06600006
066100                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06610006
066200                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06620006
066300                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06630006
066400                                                                  06640006
066500                 20  ASC-ITEM-ARRAY.                              06650006
066600                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        06660006
066700                         30  ASC-LIST-ITEM-NUMBER                 06670006
066800                                                     PIC S9(09)   06680006
066900                                                     COMP-3.      06690006
067000                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06700006
067100                             88  ASC-VALID-SELECT    VALUE ' '    06710006
067200                                                           'S'    06720006
067300                                                           'B'    06730006
067400                                                           'E'.   06740006
067500                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06750006
067600                             88  ASC-TEMP-SELECT     VALUE 'S'.   06760006
067700                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06770006
067800                             88  ASC-TEMP-END        VALUE 'E'.   06780006
067900                         30  ASC-SELECTED-SW         PIC  X(01).  06790006
068000                             88  ASC-NO-SELECT       VALUE ' '.   06800006
068100                             88  ASC-SELECT          VALUE 'S'.   06810006
068200                             88  ASC-BEGIN           VALUE 'B'.   06820006
068300                             88  ASC-END             VALUE 'E'.   06830006
068400*PS 10/16/2014 CHANGE STARTS                                      06840012
068410                         30  ASC-PO-NBR              PIC S9(09)   06841012
068500                                                          COMP.   06850006
068510*PS 10/16/2014 CHANGE ENDS                                        06851012
068600                         30  ASC-REC-SEQ-NBR         PIC S9(04)   06860006
068700                                                          COMP.   06870006
068800                         30  ASC-STOR-IND            PIC  X(01).  06880006
068900                         30  ASC-ENT-NAME-DESC       PIC  X(14).  06890006
069000                         30  ASC-OPER-SET-DESC       PIC  X(15).  06900006
069100                         30  ASC-PKGNG-CDE           PIC  X(01).  06910006
069200                         30  ASC-SEA-NAME-DESC       PIC  X(05).  06920006
069300                         30  ASC-CTN-CNT             PIC S9(04)   06930006
069400                                                          COMP.   06940006
069500                         30  ASC-ACTL-CTN-CNT-X.                  06950006
069600                             35  ASC-ACTL-CTN-CNT    PIC S9(04)   06960006
069700                                                          COMP.   06970006
069800                         30  ASC-DMG-CTN-CNT-X.                   06980006
069900                             35  ASC-DMG-CTN-CNT     PIC S9(04)   06990006
070000                                                          COMP.   07000006
070100                         30  ASC-REC-CLK             PIC  X(03).  07010006
070200                         30  ASC-SHIPT-ID            PIC  S9(09)  07020006
070300                                                          COMP.   07030006
070400                         30  ASC-OPER-UNT-ID         PIC  S9(04)  07040006
070500                                                          COMP.   07050006
070600                         30  ASC-FCLTY-ID            PIC  S9(04)  07060006
070700                                                          COMP.   07070006
070800                                                                  07080006
070900                         30  ASC-ARRIVAL-DTE         PIC  X(06).  07090006
071000                         30  ASC-AD-INFO             PIC  X(04).  07100006
071100                         30  ASC-PRE-TKT-IND         PIC  X(01).  07110006
071200                         30  ASC-PACK-BY-ST-IND      PIC  X(01).  07120006
071300                         30  ASC-AD-DATE             PIC  X(06).  07130006
071400                         30  ASC-PO-INSTR            PIC  X(25).  07140006
071500                         30  ASC-DETAIL-CHECK        PIC  X(01).  07150006
071600                         30  ASC-TKT-TYP             PIC  X(06).  07160006
071700                         30  ASC-DEPT-CLASS.                      07170006
071800                             35  ASC-DEPT            PIC  X(03).  07180006
071900                             35  ASC-CLASS.                       07190006
072000                                 40  ASC-MAJOR-CLASS PIC  X(01).  07200006
072100                                 40  ASC-CLASS-ZERO  PIC  X(01).  07210006
072200                         30  ASC-MULT-IND            PIC  X(01).  07220006
072300                         30  ASC-GOH-IND             PIC  X(01).  07230006
072400                         30  ASC-STOR-TRBL-SW        PIC  X(01).  07240006
072500                             88  ASC-NO-STOR-TRBL    VALUE 'N'.   07250006
072600                             88  ASC-CURR-STOR-TRBL  VALUE 'Y'.   07260006
072700                             88  ASC-PREV-STOR-TRBL  VALUE 'P'.   07270006
072800                         30  ASC-OTHER-TRBL-SW       PIC  X(01).  07280006
072900                             88  ASC-NO-OTHER-TRBL   VALUE 'N'.   07290006
073000                             88  ASC-OTHER-TRBL      VALUE 'Y'.   07300006
073100                         30  ASC-ARRIVAL-DTE-CC      PIC  X(02).  07310006
073101                         30  ASC-BULK-MULT-SKU-SW    PIC  X(01).  07310121
073110                             88  ASC-BULK-MULT-SKU-YES            07311021
073120                                                     VALUE 'Y'.   07312021
073130                             88  ASC-BULK-MULT-SKU-NO             07313021
073140                                                     VALUE 'N'.   07314021
073200                                                                  07320006
073300             15  ASC-CURR-OPER-UNT-ID                PIC  9(04).  07330006
073400             15  ASC-CURR-FCLTY-ID                   PIC  9(04).  07340006
073500             15  ASC-PRINTER-ID                      PIC  X(08).  07350006
073600             15  ASC-PRINTER-ID-N                    PIC  9(08).  07360006
073700* EA 07/30/2010                                                   07370006
073800             15  ASC-WHSE-CTN                      PIC  9(07).    07380006
073900             15  ASC-WHSE-EXP-CTN                  PIC  9(07).    07390006
074000* EA 07/30/2010                                                   07400006
074100             15  ASC-LOGL-UNIT-NAME                  PIC  X(08).  07410006
074200             15  ASC-BLK-SUB                         PIC S9(04)   07420006
074300                                                          COMP    07430006
074400                                                          SYNC.   07440006
074500             15  ASC-ITEM-SUB                        PIC S9(04)   07450006
074600                                                          COMP    07460006
074700                                                          SYNC.   07470006
074800             15  ASC-SEL-SUB                         PIC S9(04)   07480006
074900                                                          COMP.   07490006
075000             15  ASC-SEL-ITEM                        PIC S9(04)   07500006
075100                                                          COMP.   07510006
075200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   07520006
075300                                                          COMP-3. 07530006
075400             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   07540006
075500                                                          COMP-3. 07550006
075600             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   07560006
075700                                                          COMP-3. 07570006
075800             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   07580006
075900                                                          COMP-3. 07590006
076000             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   07600006
076100                                                          COMP-3. 07610006
076200             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   07620006
076300                                                          COMP-3. 07630006
076400             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   07640006
076500                                                          COMP    07650006
076600                                                          SYNC.   07660006
076700             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   07670006
076800                                                          COMP-3. 07680006
076900             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   07690006
077000                                                          COMP-3. 07700006
077100             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  07710006
077200                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   07720006
077300                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   07730006
077400             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  07740006
077500                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07750006
077600                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07760006
077700             15  ASC-LIST-QUEUE-NAME.                             07770006
077800                 20  ASC-LIST-TERM-ID                PIC  X(04).  07780006
077900                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   07790006
078000                                                          COMP-3. 07800006
078100                 20  ASC-LIST-SEQ                    PIC  9(01).  07810006
078200             15  ASC-SEL-QUEUE-NAME-IN               PIC X(08).   07820006
078300             15  ASC-SEL-QUEUE-NAME-OUT.                          07830006
078400                 20  ASC-SEL-TERM-ID-OUT             PIC X(04).   07840006
078500                 20  ASC-SEL-TASK-NUMBER-OUT         PIC S9(05)   07850006
078600                                                          COMP-3. 07860006
078700                 20  ASC-SEL-SEQ-OUT                 PIC 9(01).   07870006
078800                                                                  07880006
078900             15  ASC-CURSOR-SW                       PIC  X(01).  07890006
079000                 88  ASC-NO-CURSOR                   VALUE 'Z'.   07900006
079100             15  ASC-START-ITEM-REQUEST.                          07910006
079200                 20  ASC-START-ITEM-REQUEST-N        PIC  9(07).  07920006
079300             15  ASC-TRAILER-STATUS                  PIC  X(01).  07930006
079400                 88  ASC-TRLR-UNLOADED               VALUE ' '    07940006
079500                                                           'U'.   07950006
079600                 88  ASC-TRLR-NOT-UNLOADED           VALUE 'L'.   07960006
079700             15  ASC-TOTAL-CTN-CNT                   PIC S9(09)   07970006
079800                                                          COMP-3. 07980006
079900             15  ASC-TOTAL-ACTL-CTN-CNT              PIC S9(09)   07990006
080000                                                          COMP-3. 08000006
080100             15  ASC-TOTAL-DMG-CTN-CNT               PIC S9(09)   08010006
080200                                                          COMP-3. 08020006
080300             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(01).   08030006
080400                 88  ASC-USE-SELECTION-QUEUE          VALUE 'Y'.  08040006
080500             15  ASC-PRTR-AUTO-CUTTER-IND            PIC  X(01).  08050006
080600             15  ASC-PRTR-BARCODE-IND                PIC  X(01).  08060006
080700             15  ASC-PRTR-PRTR-CNTL-IND              PIC  X(01).  08070006
080800             15  ASC-PRTR-TRACK-NBR                  PIC S9(04)   08080006
080900                                                         COMP.    08090006
080910             15  ASC-RPA-MISDRCT-CK-SW  PIC X(01).                08091018
080920                 88  ASC-RPA-MISDRCT-CK            VALUE 'Y'.     08092018
080930                 88  ASC-NO-RPA-MISDRCT-CK         VALUE 'N'.     08093018
080931             15  ASC-HAS-BULK-MULTI-SKU-SW           PIC X(01).   08093121
080932                 88  ASC-HAS-BULK-MULTI-SKU-YES    VALUE 'Y'.     08093221
080933                 88  ASC-HAS-BULK-MULTI-SKU-NO     VALUE 'N'.     08093321
080940                                                                  08094018
081000                                                                  08100006
081100/                                                                 08110006
081200*---------------------------------------------------------------* 08120006
081300*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 08130006
081400*---------------------------------------------------------------* 08140006
081500     EXEC SQL                                                     08150006
081600          INCLUDE TPURCHS                                         08160006
081700     END-EXEC.                                                    08170006
081800                                                                  08180006
081900/                                                                 08190006
082000*---------------------------------------------------------------* 08200006
082100*    DB2 AREA FOR THE PURCHASE ORDER LINE ITEM TABLE            * 08210006
082200*---------------------------------------------------------------* 08220006
082300     EXEC SQL                                                     08230006
082400          INCLUDE TPURITM                                         08240006
082500     END-EXEC.                                                    08250006
082600                                                                  08260006
082700/                                                                 08270006
082800*---------------------------------------------------------------* 08280006
082900*    DB2 AREA FOR THE PO INSTRUCTIONS TABLE                     * 08290006
083000*---------------------------------------------------------------* 08300006
083100     EXEC SQL                                                     08310006
083200          INCLUDE TPOINST                                         08320006
083300     END-EXEC.                                                    08330006
083400                                                                  08340006
083500/                                                                 08350006
083600*---------------------------------------------------------------* 08360006
083700*    DB2 AREA FOR THE PO INSTRUCTION CODE TABLE                 * 08370006
083800*---------------------------------------------------------------* 08380006
083900     EXEC SQL                                                     08390006
084000          INCLUDE TINSTCD                                         08400006
084100     END-EXEC.                                                    08410006
084200                                                                  08420006
084300/                                                                 08430006
084400*---------------------------------------------------------------* 08440006
084500*    DB2 AREA FOR RECEIVER TABLE                                * 08450006
084600*---------------------------------------------------------------* 08460006
084700     EXEC SQL                                                     08470006
084800          INCLUDE TRECEIV                                         08480006
084900     END-EXEC.                                                    08490006
085000                                                                  08500006
085100/                                                                 08510006
085200*---------------------------------------------------------------* 08520006
085300*    DB2 AREA FOR SHIPMENT TABLE                                * 08530006
085400*---------------------------------------------------------------* 08540006
085500     EXEC SQL                                                     08550006
085600          INCLUDE TSHIPMT                                         08560006
085700     END-EXEC.                                                    08570006
085800                                                                  08580006
085900/                                                                 08590006
086000*---------------------------------------------------------------* 08600006
086100*    DB2 AREA FOR SHIPMENT STATUS TABLE                         * 08610006
086200*---------------------------------------------------------------* 08620006
086300     EXEC SQL                                                     08630006
086400          INCLUDE TSHIPST                                         08640006
086500     END-EXEC.                                                    08650006
086600                                                                  08660006
086700/                                                                 08670006
086800*---------------------------------------------------------------* 08680006
086900*    DB2 AREA FOR THE VEHICLE TABLE                             * 08690006
087000*---------------------------------------------------------------* 08700006
087100     EXEC SQL                                                     08710006
087200          INCLUDE TVEHICL                                         08720006
087300     END-EXEC.                                                    08730006
087400                                                                  08740006
087500*---------------------------------------------------------------* 08750006
087600*    DB2 AREA FOR VEHICLE AUDIT TABLE                           * 08760006
087700*---------------------------------------------------------------* 08770006
087800     EXEC SQL                                                     08780006
087900          INCLUDE TAUVHCL                                         08790006
088000     END-EXEC.                                                    08800006
088100                                                                  08810006
088200/                                                                 08820006
088300*---------------------------------------------------------------* 08830006
088400*    DB2 AREA FOR SHIPMENT PO TABLE                             * 08840006
088500*---------------------------------------------------------------* 08850006
088600     EXEC SQL                                                     08860006
088700          INCLUDE TSHPTPO                                         08870006
088800     END-EXEC.                                                    08880006
088900                                                                  08890006
089000/                                                                 08900006
089100*---------------------------------------------------------------* 08910006
089200*    DB2 AREA FOR VEHICLE TRIP TABLE                            * 08920006
089300*---------------------------------------------------------------* 08930006
089400     EXEC SQL                                                     08940006
089500          INCLUDE TVHTRIP                                         08950006
089600     END-EXEC.                                                    08960006
089700                                                                  08970006
089800/                                                                 08980006
089900*---------------------------------------------------------------* 08990006
090000*    DB2 AREA FOR VEHICLE TRIP STATUS TABLE                     * 09000006
090100*---------------------------------------------------------------* 09010006
090200     EXEC SQL                                                     09020006
090300          INCLUDE TTRIPST                                         09030006
090400     END-EXEC.                                                    09040006
090500                                                                  09050006
090600/                                                                 09060006
090700*---------------------------------------------------------------* 09070006
090800*    DB2 AREA FOR VEHICLE TRIP STATUS CODE TABLE                * 09080006
090900*---------------------------------------------------------------* 09090006
091000     EXEC SQL                                                     09100006
091100          INCLUDE TTRSTYP                                         09110006
091200     END-EXEC.                                                    09120006
091300                                                                  09130006
091400/                                                                 09140006
091500*---------------------------------------------------------------* 09150006
091600*    DB2 AREA FOR SHIPMENT STATUS CODE TABLE                    * 09160006
091700*---------------------------------------------------------------* 09170006
091800     EXEC SQL                                                     09180006
091900          INCLUDE TSHSTYP                                         09190006
092000     END-EXEC.                                                    09200006
092100                                                                  09210006
092200/                                                                 09220006
092300*---------------------------------------------------------------* 09230006
092400*    DB2 AREA FOR THE ENTERPRISE TABLE                          * 09240006
092500*---------------------------------------------------------------* 09250006
092600     EXEC SQL                                                     09260006
092700          INCLUDE TEXTENT                                         09270006
092800     END-EXEC.                                                    09280006
092900                                                                  09290006
093000/                                                                 09300006
093100*---------------------------------------------------------------* 09310006
093200*    DB2 AREA FOR THE ENTERPRISE NAME TABLE                     * 09320006
093300*---------------------------------------------------------------* 09330006
093400     EXEC SQL                                                     09340006
093500          INCLUDE TENTNME                                         09350006
093600     END-EXEC.                                                    09360006
093700                                                                  09370006
093800/                                                                 09380006
093900*---------------------------------------------------------------* 09390006
094000*    DB2 AREA FOR TPCLABL  (LABEL TABLE)                        * 09400006
094100*---------------------------------------------------------------* 09410006
094200                                                                  09420006
094300     EXEC SQL                                                     09430006
094400          INCLUDE TPCLABL                                         09440006
094500     END-EXEC.                                                    09450006
094600                                                                  09460006
094700/                                                                 09470006
094800*----------------------------------------------------------------*09480006
094900*    DB2 AREA FOR OPERATION SET TABLE                            *09490006
095000*----------------------------------------------------------------*09500006
095100                                                                  09510006
095200     EXEC SQL                                                     09520006
095300          INCLUDE TOPRSET                                         09530006
095400     END-EXEC.                                                    09540006
095500                                                                  09550006
095600/                                                                 09560006
095700*----------------------------------------------------------------*09570006
095800*    DB2 AREA FOR WORK ORDER TABLE                               *09580006
095900*----------------------------------------------------------------*09590006
096000                                                                  09600006
096100     EXEC SQL                                                     09610006
096200          INCLUDE TWRKORD                                         09620006
096300     END-EXEC.                                                    09630006
096400                                                                  09640006
096500/                                                                 09650006
096600*---------------------------------------------------------------* 09660006
096700*    DB2 AREA FOR TICKET FORMAT ASSIGNMENTS                     * 09670006
096800*---------------------------------------------------------------* 09680006
096900*                                                                 09690006
097000/                                                                 09700006
097100*----------------------------------------------------------------*09710006
097200*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                09720006
097300*----------------------------------------------------------------*09730006
097400     EXEC SQL                                                     09740006
097500          INCLUDE TTRBNTF                                         09750006
097600     END-EXEC.                                                    09760006
097700                                                                  09770006
097800/                                                                 09780006
097900*-----------------------------------------------------------------09790006
098000*  DB2 TABLE DECLARATION - HEADER SHIPMENT CROSS REFERENCE        09800006
098100*      (WST_SHPMT_XREF_HDR)                                       09810006
098200*-----------------------------------------------------------------09820006
098300     EXEC SQL                                                     09830006
098400          INCLUDE WST00001                                        09840006
098500     END-EXEC.                                                    09850006
098600                                                                  09860006
098700/                                                                 09870006
098800*-----------------------------------------------------------------09880006
098900*  DB2 TABLE DECLARATION - DETAIL SHIPMENT CROSS REFERENCE        09890006
099000*      (WST_SHPMT_XREF_DTL)                                       09900006
099100*-----------------------------------------------------------------09910006
099200     EXEC SQL                                                     09920006
099300          INCLUDE WST00002                                        09930006
099400     END-EXEC.                                                    09940006
099500                                                                  09950006
099510/                                                                 09951006
099520*-----------------------------------------------------------------09952006
099530*  DB2 TABLE DECLARATION - RC-KOHLS TO RETEK PROCESSING PARAMETERS09953006
099540*      (TKRPRPM)                                                  09954006
099550*-----------------------------------------------------------------09955006
099560     EXEC SQL                                                     09956006
099570          INCLUDE TKRPRPM                                         09957006
099580     END-EXEC.                                                    09958006
099590/                                                                 09959006
099600*-----------------------------------------------------------------09960006
099700*  DB2 TABLE DECLARATION - RC-PACK SLIP                           09970006
099800*      (TPKSLIP)                                                  09980006
099900*-----------------------------------------------------------------09990006
100000     EXEC SQL                                                     10000006
100100          INCLUDE TPKSLIP                                         10010006
100200     END-EXEC.                                                    10020006
100300                                                                  10030006
100400/                                                                 10040006
100500* EA 07/30/2010                                                   10050006
100600*-----------------------------------------------------------------10060006
100700*  DB2 TABLE DECLARATION                                          10070006
100800*      (SUT_OTBND_LOC)                                            10080006
100900*-----------------------------------------------------------------10090006
101000     EXEC SQL                                                     10100006
101100          INCLUDE SUT00027                                        10110006
101200     END-EXEC.                                                    10120006
101210                                                                  10121006
101220/                                                                 10122006
101230*-----------------------------------------------------------------10123006
101240*  DB2 TABLE DECLARATION                                          10124006
101250*      (SUT_OTBND_CART)                                           10125006
101260*-----------------------------------------------------------------10126006
101270     EXEC SQL                                                     10127006
101280          INCLUDE SUT00024                                        10128006
101290     END-EXEC.                                                    10129006
101291                                                                  10129106
101292/                                                                 10129206
101293*-----------------------------------------------------------------10129306
101294*  DB2 TABLE DECLARATION                                          10129406
101295*      (SUT_TRLR_RPLN_CART)                                       10129506
101296*-----------------------------------------------------------------10129606
101297     EXEC SQL                                                     10129706
101298          INCLUDE SUT00113                                        10129806
101299     END-EXEC.                                                    10129906
101300                                                                  10130006
101301*-----------------------------------------------------------------10130122
101303*  TSHUUPC - INBOUND UPC                                          10130322
101304*-----------------------------------------------------------------10130422
101305     EXEC SQL                                                     10130522
101306          INCLUDE TSHUUPC                                         10130622
101307     END-EXEC.                                                    10130722
101308                                                                  10130822
101309*-----------------------------------------------------------------10130922
101310*  TINPKSU - PACKSLIP-INBOUND CARTON ASSOCIATION                  10131022
101311*-----------------------------------------------------------------10131122
101312     EXEC SQL                                                     10131222
101313          INCLUDE TINPKSU                                         10131322
101314     END-EXEC.                                                    10131422
101315                                                                  10131522
101323/                                                                 10132306
101324*---------------------------------------------------------------* 10132406
101325*    DB2 AREA FOR COMMUNICATIONS                                * 10132506
101326*---------------------------------------------------------------* 10132606
101327     EXEC SQL                                                     10132706
101328          INCLUDE SQLCA                                           10132806
101329     END-EXEC.                                                    10132906
101330                                                                  10133006
101331/                                                                 10133106
101332*---------------------------------------------------------------* 10133206
101333*     RECEIVER CURSOR DECLARE                                   * 10133306
101340*---------------------------------------------------------------* 10134006
101350                                                                  10135006
101360     EXEC SQL                                                     10136006
101370          DECLARE RECEIVER-CSR CURSOR FOR                         10137006
101380             SELECT DISTINCT                                      10138006
101390                    A.PO_NBR                                      10139006
101400                   ,A.REC_SEQ_NBR                                 10140006
101500                   ,A.EXPTED_CART_CNT                             10150006
101600                   ,F.ACTL_CART_CNT                               10160006
101700                   ,A.DMG_CART_CNT                                10170006
101800                   ,A.PKSL_IND                                    10180006
101900                   ,A.VEND_NAME                                   10190006
102000                   ,B.SHIPT_ID                                    10200006
102100                   ,B.LAST_UPD_DTE                                10210006
102200                   ,B.LAST_UPD_TME                                10220006
102300                   ,C.OWNER_SCAC_ID                               10230006
102400                   ,C.VEH_NBR                                     10240006
102500                   ,C.TRIP_ID                                     10250006
102600                   ,DATE(F.REC_TMST)                              10260006
102700                   ,F.CRE_TMST                                    10270006
102800               FROM TSHPTPO A                                     10280006
102900                   ,TSHIPMT B                                     10290006
103000                   ,TVHTRIP C                                     10300006
103100                   ,TRECEIV F                                     10310006
103200              WHERE C.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID           10320006
103300                AND C.VEH_NBR       = :DK-VEH-NBR                 10330006
103400                AND C.TRIP_ID       = :DK-TRIP-ID                 10340006
103500                AND A.SHIPT_ID        = B.SHIPT_ID                10350006
103600                AND B.TRIP_ID         = C.TRIP_ID                 10360006
103700                AND A.PO_NBR          = F.ORD_NBR                 10370006
103800                AND A.REC_SEQ_NBR     = F.REC_SEQ_NBR             10380006
103900                AND F.VER_STATUS_CDE  = 'A'                       10390006
104000             ORDER BY F.CRE_TMST                                  10400006
104100     END-EXEC.                                                    10410006
104200                                                                  10420006
104300                                                                  10430006
104400/                                                                 10440006
104500*---------------------------------------------------------------* 10450006
104600*  CURSOR TO LIST SHIPMENTS FOR A TRIP                          * 10460006
104700*---------------------------------------------------------------* 10470006
104800                                                                  10480006
104900     EXEC SQL                                                     10490006
105000          DECLARE SHIPMENT-CSR CURSOR FOR                         10500006
105100           SELECT SHIPT_ID                                        10510006
105200            FROM  TSHIPMT                                         10520006
105300           WHERE  TRIP_ID = :DK-TRIP-ID                           10530006
105400             AND  TRIP_ID IS NOT NULL                             10540006
105500         ORDER BY SHIPT_ID                                        10550006
105600     END-EXEC.                                                    10560006
105700                                                                  10570006
105800/                                                                 10580006
105900*---------------------------------------------------------------* 10590006
106000*  CURSOR TO LIST THE WST_SHPMT_XREF_ HDRS FOR WMS              * 10600006
106100*---------------------------------------------------------------* 10610006
106200     EXEC SQL                                                     10620006
106300          DECLARE HDR_CSR CURSOR FOR                              10630006
106400           SELECT  EXT_SHP_ID                                     10640006
106500                  ,RCPT_TMST                                      10650006
106600           FROM    WST_SHPMT_XREF_HDR H                           10660006
106700           WHERE   H.INTR_TRIP_ID = :ASC-KEY-TRIP-ID              10670006
106800           AND     H.SOR_CDE      = :PC-RC                        10680006
106900     END-EXEC.                                                    10690006
107000                                                                  10700006
107100*---------------------------------------------------------------* 10710006
107200*  CURSOR TO GET THE SHPMT DETAILS THAT ARE IN TROUBLE          * 10720006
107300*---------------------------------------------------------------* 10730006
107400     EXEC SQL                                                     10740006
107500          DECLARE TRBL_CSR CURSOR FOR                             10750006
107600           SELECT  DISTINCT H.EXT_SHP_ID                          10760006
107700           FROM    WST_SHPMT_XREF_HDR H                           10770006
107800                  ,WST_SHPMT_XREF_DTL D                           10780006
107900           WHERE   H.INTR_TRIP_ID = :ASC-KEY-TRIP-ID              10790006
108000           AND     H.EXT_SHP_ID   = D.EXT_SHP_ID                  10800006
108100           AND     D.DWNLD_CDE    = :PC-T                         10810006
108200           AND     D.ACTV_CDE     = :PC-A                         10820006
108300           AND     H.SOR_CDE      = :PC-RC                        10830006
108400     END-EXEC.                                                    10840006
108500                                                                  10850006
108600*---------------------------------------------------------------* 10860006
108700*    ABEND PROCESSING COPYBOOK.                                 * 10870006
108800*---------------------------------------------------------------* 10880006
108900                                                                  10890006
109000     COPY DPWS013.                                                10900006
109100                                                                  10910006
109200/                                                                 10920006
109300                                                                  10930006
109400                                                                  10940006
109500                                                                  10950006
109600     COPY PCWS140.                                                10960006
109700                                                                  10970006
109800/                                                                 10980006
109900 LINKAGE SECTION.                                                 10990006
110000                                                                  11000006
110100 01  DFHCOMMAREA.                                                 11010006
110200     05  FILLER                          OCCURS 1 TO 4072 TIMES   11020006
110300                                         DEPENDING ON EIBCALEN.   11030006
110400         10  FILLER                      PIC X.                   11040006
110500                                                                  11050006
110600/                                                                 11060006
110700 PROCEDURE DIVISION.                                              11070006
110800******************************************************************11080006
110900**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **11090006
111000**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **11100006
111100**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **11110006
111200******************************************************************11120006
111300 0000-MAIN-MODULE.                                                11130006
111400                                                                  11140006
111500     INITIALIZE DP030-CICS-API-FIELDS.                            11150006
111600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       11160006
111700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          11170006
111800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         11180006
111900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       11190006
112000     MOVE LENGTH OF RC225AI        TO DP030-MAP-LENGTH (1).       11200006
112100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     11210006
112200     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       11220006
112300                                                                  11230006
112400     PERFORM 0001-CALL-CICS-ARCH-API.                             11240006
112500     PERFORM 1000-CONTROL-PROCESSING                              11250006
112600                                                                  11260006
112700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     11270006
112800     PERFORM 0001-CALL-CICS-ARCH-API.                             11280006
112900                                                                  11290006
113000******************************************************************11300006
113100**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **11310006
113200**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **11320006
113300******************************************************************11330006
113400 0001-CALL-CICS-ARCH-API.                                         11340006
113510     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      11351032
113600                                    DFHCOMMAREA                   11360032
113700                                    DP030-CICS-API-FIELDS         11370032
113800                                    DP020-STANDARD-COMMAREA       11380032
113900                                    RC225AI.                      11390032
114000*                                                                 11400006
114100     IF DP030-RC-CALL-SUCCESSFUL OR                               11410006
114200        DP030-RC-APPL-ERROR                                       11420006
114300         CONTINUE                                                 11430006
114400     ELSE                                                         11440006
114500         SET DP013-NO-ROLLBACK                                    11450006
114600             DP013-XCTL-DISPLAY-RESTART                           11460006
114700             DP013-CICS-ABEND      TO TRUE                        11470006
114800         MOVE 'BEFORE 0000-MAIN-MODULE'                           11480006
114900                                   TO DP013-PARAGRAPH             11490006
114910         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O11491032
114920-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      11492032
115200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      11520006
115300         PERFORM DP013-0000-PROCESS-ABEND                         11530006
115400     END-IF.                                                      11540006
115500*----------------------------------------------------------------*11550006
115600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *11560006
115700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *11570006
115800*                                                                *11580006
115900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *11590006
116000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *11600006
116100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *11610006
116200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *11620006
116300*----------------------------------------------------------------*11630006
116400                                                                  11640006
116500 1000-CONTROL-PROCESSING.                                         11650006
116600                                                                  11660006
116700     EVALUATE TRUE                                                11670006
116800                                                                  11680006
116900         WHEN DP030-RC-APPL-ERROR                                 11690006
117000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         11700006
117100             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                11710006
117200             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 11720006
117300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11730006
117400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11740006
117500                                                                  11750006
117600         WHEN DP020-NEXT-ACT-INITIAL                              11760006
117700             INITIALIZE ASC-SPECIFIC-COMMAREA                     11770006
117800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            11780006
117900                                      ASC-SEL-TERM-ID-OUT         11790006
118000             MOVE DP020-SRC-TASK-NUMBER                           11800006
118100                                   TO ASC-LIST-TASK-NUMBER        11810006
118200                                      ASC-SEL-TASK-NUMBER-OUT     11820006
118300             MOVE DP020-LOCATION-NBR   TO PV-DP020-LOCATION       11830006
118400             MOVE PV-LOCATION-N        TO ASC-CURR-OPER-UNT-ID    11840006
118500             MOVE 1                    TO ASC-CURR-FCLTY-ID       11850006
118600             MOVE PC-LIST-QUEUE-SEQ                               11860006
118700                                   TO ASC-LIST-SEQ                11870006
118800             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             11880006
118900             PERFORM 1100-PROCESS-INTER-APPL-COMM                 11890006
119000                                                                  11900006
119100             IF  PS-COMMAREA-NOT-VALID                            11910006
119200                 CONTINUE                                         11920006
119300             ELSE                                                 11930006
119400                 PERFORM 4000-BUILD-INITIAL-PANEL                 11940006
119500             END-IF                                               11950006
119600                                                                  11960006
119700         WHEN DP020-NEXT-ACT-READ-MAP                             11970006
119800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        11980006
119900                                   TO PV-TOP-ITEM                 11990006
120000             PERFORM 2000-PROCESS-PANEL                           12000006
120100                                                                  12010006
120200         WHEN DP020-NEXT-ACT-RETURN                               12020006
120300             MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID       12030006
120400             MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR             12040006
120500             MOVE ASC-KEY-ARRIVAL-DTE   TO DK-ARRIVAL-DTE         12050006
120600             MOVE ASC-KEY-PO-NBR        TO DK-PO-NBR              12060006
120700             MOVE ASC-KEY-TRIP-ID       TO DK-TRIP-ID             12070006
120800             PERFORM 2050-DELETE-LIST-QUEUE                       12080006
120900             PERFORM 4000-BUILD-INITIAL-PANEL                     12090006
121000                                                                  12100006
121100                                                                  12110006
121200         WHEN OTHER                                               12120006
121300             SET DP013-LOGIC-ABEND TO TRUE                        12130006
121400             SET DP013-NO-ROLLBACK TO TRUE                        12140006
121500             MOVE '1000-CONTROL-PROCESSING'                       12150006
121600                                   TO DP013-PARAGRAPH             12160006
121700             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    12170006
121800                                   TO DP013-MESSAGE-TEXT(1)       12180006
121900             PERFORM DP013-0000-PROCESS-ABEND                     12190006
122000     END-EVALUATE.                                                12200006
122100/                                                                 12210006
122200*----------------------------------------------------------------*12220006
122300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *12230006
122400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *12240006
122500*----------------------------------------------------------------*12250006
122600                                                                  12260006
122700 1100-PROCESS-INTER-APPL-COMM.                                    12270006
122800                                                                  12280006
122900     SET PS-COMMAREA-VALID         TO TRUE.                       12290006
123000     MOVE SPACES                   TO ASC-START-ITEM-REQUEST      12300006
123100                                      ASC-PRINTER-ID.             12310006
123200                                                                  12320006
123300     MOVE ZERO                     TO ASC-KEY-PO-NBR.             12330006
123400                                                                  12340006
123500     EVALUATE DP020-INT-APPL-FORMAT-IND                           12350006
123600                                                                  12360006
123700         WHEN PC-INTER-APPL-CRIT-SPEC                             12370006
123800             IF  RC012-OWNER-SCAC-ID = SPACES                     12380006
123900             AND RC012-VEH-NBR       = SPACES                     12390006
124000                 MOVE PC-TSYMSG-00082 TO DP020-MSG-NUMBER         12400006
124100                 SET PS-COMMAREA-NOT-VALID                        12410006
124200                     DP020-MSG-FATAL                              12420006
124300                     DP020-NEXT-ACT-APPL-ERROR                    12430006
124400                                      TO TRUE                     12440006
124500             ELSE                                                 12450006
124600                 MOVE RC012-VEH-NBR   TO ASC-KEY-VEH-NBR          12460006
124700                                         DK-VEH-NBR               12470006
124800                 MOVE RC012-TRIP-ID   TO ASC-KEY-TRIP-ID          12480006
124900                                       DK-TRIP-ID                 12490006
125000                 MOVE RC012-OWNER-SCAC-ID                         12500006
125100                                      TO ASC-KEY-OWNER-SCAC-ID    12510006
125200                                         DK-OWNER-SCAC-ID         12520006
125300                 MOVE RC012-ARRIVAL-DTE                           12530006
125400                                      TO ASC-KEY-ARRIVAL-DTE      12540006
125500                                         DK-ARRIVAL-DTE           12550006
125600                 MOVE RC012-OPER-UNT-ID                           12560006
125700                                      TO ASC-KEY-OPER-UNT-ID      12570006
125800                                         DK-OPER-UNT-ID           12580006
125900                 MOVE RC012-FCLTY-ID  TO ASC-KEY-FCLTY-ID         12590006
126000                                         DK-FCLTY-ID              12600006
126100                 IF  RC012-ARRIVAL-DTE = SPACES                   12610006
126200                     MOVE '0001-01-01' TO ASC-KEY-ARRIVAL-DTE     12620006
126300                                           DK-ARRIVAL-DTE         12630006
126400                 END-IF                                           12640006
126500             END-IF                                               12650006
126600                                                                  12660006
126700         WHEN PC-INTER-APPL-YARD-LIST                             12670006
126800         WHEN PC-INTER-APPL-SULTRLR                               12680006
126900             SET ASC-USE-SELECTION-QUEUE                          12690006
127000                                   TO TRUE                        12700006
127100             MOVE RC015-NUMBER-OF-SELECTED-ITEMS                  12710006
127200                                   TO ASC-NUMBER-OF-SELECTED-ITEMS12720006
127300             MOVE RC015-NUMBER-OF-TS-ITEMS                        12730006
127400                                   TO ASC-NUMBER-OF-TS-ITEMS      12740006
127500             MOVE RC015-SEL-QUEUE-NAME                            12750006
127600                                   TO ASC-SEL-QUEUE-NAME-IN       12760006
127700             MOVE RC015-OPER-UNT-ID                               12770006
127800                                   TO ASC-KEY-OPER-UNT-ID         12780006
127900             MOVE RC015-FCLTY-ID   TO ASC-KEY-FCLTY-ID            12790006
128000                                                                  12800006
128100             PERFORM 1120-PREPARE-YARD-LIST-ENTRY                 12810006
128200             PERFORM 1130-GET-ARRIVAL-DATE                        12820006
128300             IF  SQLCODE = -305                                   12830006
128400                 MOVE '0001-01-01'  TO ASC-KEY-ARRIVAL-DTE        12840006
128500                                       DK-ARRIVAL-DTE             12850006
128600             ELSE                                                 12860006
128700                 MOVE TRIPST-STATUS-DTE                           12870006
128800                                    TO ASC-KEY-ARRIVAL-DTE        12880006
128900                                       DK-ARRIVAL-DTE             12890006
129000             END-IF                                               12900006
129100                                                                  12910006
129200     END-EVALUATE.                                                12920006
129300                                                                  12930006
129400/                                                                 12940006
129500*----------------------------------------------------------------*12950006
129600*  ENTRY IS FROM A YARD LIST SCREEN. GET KEYS FROM TEMP STORAGE  *12960006
129700*  QUEUE PASSED FROM THE LIST.                                   *12970006
129800*----------------------------------------------------------------*12980006
129900                                                                  12990006
130000 1120-PREPARE-YARD-LIST-ENTRY.                                    13000006
130100                                                                  13010006
130200      MOVE TR006-MAX-ITEMS         TO ASC-SEL-SUB.                13020006
130300      MOVE ZERO                    TO ASC-SEL-ITEM.               13030006
130400      PERFORM 2300-GET-YARD-NEXT-RECORD.                          13040006
130500                                                                  13050006
130600/                                                                 13060006
130700 1130-GET-ARRIVAL-DATE.                                           13070006
130800                                                                  13080006
130900     PERFORM                                                      13090006
131000         WITH TEST AFTER                                          13100006
131100         VARYING PV-RETRY-COUNTER                                 13110006
131200         FROM 1 BY 1                                              13120006
131300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13130006
131400             OR (SQLCODE = +0)                                    13140006
131500             OR (SQLCODE = -305))                                 13150006
131600                                                                  13160006
131700         EXEC SQL                                                 13170006
131800              SELECT MAX(B.STATUS_DTE)                            13180006
131900                INTO :TRIPST-STATUS-DTE                           13190006
132000              FROM   TVHTRIP A                                    13200006
132100                    ,TTRIPST B                                    13210006
132200                    ,TTRSTYP C                                    13220006
132300              WHERE A.TRIP_ID = :DK-TRIP-ID                       13230006
132400                AND B.TRIP_STATUS_CDE IN ('AR','EN')              13240006
132500                AND A.TRIP_ID  = B.TRIP_ID                        13250006
132600                AND C.PRTY_CDE =                                  13260006
132700                    (SELECT MAX(E.PRTY_CDE)                       13270006
132800                       FROM TTRIPST D                             13280006
132900                           ,TTRSTYP E                             13290006
133000                      WHERE D.TRIP_ID         = A.TRIP_ID         13300006
133100                        AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)13310006
133110               WITH UR                                            13311008
133200         END-EXEC                                                 13320006
133300                                                                  13330006
133400         EVALUATE TRUE                                            13340006
133500             WHEN SQLCODE = +0                                    13350006
133600             WHEN SQLCODE = -305                                  13360006
133700             WHEN SQLCODE = -904                                  13370006
133800             WHEN SQLCODE = -913                                  13380006
133900                  CONTINUE                                        13390006
134000                                                                  13400006
134100             WHEN SQLWARN0 NOT = SPACES                           13410006
134200             WHEN SQLCODE < +0                                    13420006
134300             WHEN SQLCODE > +0                                    13430006
134400                  MOVE '1130-GET-ARRIVAL-DATE'                    13440006
134500                                  TO DP013-PARAGRAPH              13450006
134600                  MOVE 'UNSUCCESSFUL SELECT ON TVHTRIP'           13460006
134700                                  TO DP013-MESSAGE-TEXT (1)       13470006
134800                  MOVE SQLCA      TO DP013-SQLCA                  13480006
134900                  MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)     13490006
135000                  MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)     13500006
135100                  MOVE 'TTRSTYP ' TO DP013-DB2-TABLE-NAME (3)     13510006
135200                  SET DP013-DB2-ABEND                             13520006
135300                      DP013-XCTL-DISPLAY-RESTART                  13530006
135400                                  TO TRUE                         13540006
135500                  PERFORM DP013-0000-PROCESS-ABEND                13550006
135600         END-EVALUATE                                             13560006
135700     END-PERFORM.                                                 13570006
135800                                                                  13580006
135900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    13590006
136000         SQLCODE NOT = +0                                         13600006
136100         MOVE '1130-GET-ARRIVAL-DATE'                             13610006
136200                                  TO DP013-PARAGRAPH              13620006
136300         MOVE 'MAX RETRIES EXCEEDED ON SELECT TVHTRIP'            13630006
136400                                  TO DP013-MESSAGE-TEXT (1)       13640006
136500         MOVE SQLCA               TO DP013-SQLCA                  13650006
136600         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (1)     13660006
136700         MOVE 'TTRIPST '          TO DP013-DB2-TABLE-NAME (2)     13670006
136800         MOVE 'TTRSTYP '          TO DP013-DB2-TABLE-NAME (3)     13680006
136900         SET DP013-DB2-ABEND                                      13690006
137000             DP013-XCTL-DISPLAY-RESTART                           13700006
137100                                  TO TRUE                         13710006
137200         PERFORM DP013-0000-PROCESS-ABEND                         13720006
137300     END-IF.                                                      13730006
137400                                                                  13740006
137500/                                                                 13750006
137600*----------------------------------------------------------------*13760006
137700* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *13770006
137800* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *13780006
137900* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *13790006
138000* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *13800006
138100* FUNCTION KEYS CAN GET THIS FAR.                                *13810006
138200*----------------------------------------------------------------*13820006
138300                                                                  13830006
138400 2000-PROCESS-PANEL.                                              13840006
138500                                                                  13850006
138600     EVALUATE TRUE                                                13860006
138700         WHEN DP020-SRC-AID = DP016-CLEAR                         13870006
138800             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    13880006
138900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   13890006
139000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13900006
139100                                                                  13910006
139200         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    13920006
139300             MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID       13930006
139400             MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR             13940006
139500             MOVE ASC-KEY-ARRIVAL-DTE   TO DK-ARRIVAL-DTE         13950006
139600             MOVE ASC-KEY-PO-NBR        TO DK-PO-NBR              13960006
139700             MOVE ASC-KEY-TRIP-ID       TO DK-TRIP-ID             13970006
139800             MOVE ASC-CURR-OPER-UNT-ID  TO DK-OPER-UNT-ID         13980006
139900             MOVE ASC-CURR-FCLTY-ID     TO DK-FCLTY-ID            13990006
140000             PERFORM 2050-DELETE-LIST-QUEUE                       14000006
140100             PERFORM 4000-BUILD-INITIAL-PANEL                     14010006
140200                                                                  14020006
140300         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    14030006
140400             PERFORM 2140-DESELECT-ALL-ITEMS                      14040006
140500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14050006
140600                                                                  14060006
140700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  14070006
140800             PERFORM 2150-SELECT-ALL-ITEMS                        14080006
140900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14090006
141000                                                                  14100006
141100         WHEN OTHER                                               14110006
141200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 14120006
141300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   14130006
141400             IF  PS-NO-ERROR                                      14140006
141500                 SET DP030-CONTINUE-GO TO TRUE                    14150006
141600                 PERFORM 2100-CHECK-FUNCTION-KEY                  14160006
141700             ELSE                                                 14170006
141800                 SET DP030-OVERRIDE-GO TO TRUE                    14180006
141900             END-IF                                               14190006
142000     END-EVALUATE.                                                14200006
142100/                                                                 14210006
142200*----------------------------------------------------------------*14220006
142300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14230006
142400*----------------------------------------------------------------*14240006
142500 2050-DELETE-LIST-QUEUE.                                          14250006
142600                                                                  14260006
142700     EXEC CICS                                                    14270006
142800         DELETEQ TS                                               14280006
142900             QUEUE (ASC-LIST-QUEUE-NAME)                          14290006
143000             RESP  (PV-CICS-RESP)                                 14300006
143100     END-EXEC.                                                    14310006
143200                                                                  14320006
143300     IF (PV-CICS-RESP = DFHRESP(NORMAL))                          14330006
143400     OR (PV-CICS-RESP = DFHRESP(QIDERR))                          14340006
143500         CONTINUE                                                 14350006
143600     ELSE                                                         14360006
143700         SET DP013-CICS-ABEND      TO TRUE                        14370006
143800         SET DP013-NO-ROLLBACK     TO TRUE                        14380006
143900                                                                  14390006
144000         MOVE '2050-DELETE-LIST-QUEUE'                            14400006
144100                                   TO DP013-PARAGRAPH             14410006
144200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    14420006
144300                                   TO DP013-MESSAGE-TEXT (1)      14430006
144400         PERFORM DP013-0000-PROCESS-ABEND                         14440006
144500     END-IF.                                                      14450006
144600                                                                  14460006
144700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  14470006
144800/                                                                 14480006
144900*----------------------------------------------------------------*14490006
145000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*14500006
145100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *14510006
145200* CICS ARCHITECTURE API.                                         *14520006
145300*----------------------------------------------------------------*14530006
145400                                                                  14540006
145500 2100-CHECK-FUNCTION-KEY.                                         14550006
145600                                                                  14560006
145700     EVALUATE TRUE                                                14570006
145800                                                                  14580006
145900         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  14590006
146000             INITIALIZE RC015-INTER-APPL-COMMAREA                 14600006
146100             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 14610006
146200                                   RC015-NUMBER-OF-SELECTED-ITEMS 14620006
146300             MOVE ASC-KEY-OPER-UNT-ID                             14630006
146400                                TO RC015-OPER-UNT-ID              14640006
146500             MOVE ASC-KEY-FCLTY-ID                                14650006
146600                                TO RC015-FCLTY-ID                 14660006
146700             PERFORM 5000-PREPARE-SEL-QUEUE                       14670006
146800                                                                  14680006
146900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              14690006
147000             IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO               14700006
147100                 SET DP030-OVERRIDE-GO TO TRUE                    14710006
147200                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        14720006
147300                 SET DP020-MSG-WARNING TO TRUE                    14730006
147400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14740006
147500             ELSE                                                 14750006
147600                 SET DP030-CONTINUE-GO TO TRUE                    14760006
147700                 PERFORM 5000-PREPARE-SEL-QUEUE                   14770006
147800                 IF PC140-CRA-SUCCESSFUL                          14780006
147900                     MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER     14790006
148000                     SET DP020-MSG-INFORMATIONAL TO TRUE          14800006
148100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14810006
148200                 ELSE                                             14820006
148300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14830006
148400                 END-IF                                           14840006
148500             END-IF                                               14850006
148600                                                                  14860006
148700         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              14870006
148800             IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO               14880006
148900                 SET DP030-OVERRIDE-GO TO TRUE                    14890006
149000                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         14900006
149100                 SET DP020-MSG-WARNING TO TRUE                    14910006
149200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14920006
149300             ELSE                                                 14930006
149400                 SET DP030-CONTINUE-GO TO TRUE                    14940006
149500                 PERFORM 5000-PREPARE-SEL-QUEUE                   14950006
149600                 IF PC140-CRA-SUCCESSFUL                          14960006
149700                     MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER     14970006
149800                     SET DP020-MSG-INFORMATIONAL TO TRUE          14980006
149900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         14990006
150000                 ELSE                                             15000006
150100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         15010006
150200                 END-IF                                           15020006
150300             END-IF                                               15030006
150400                                                                  15040006
150500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              15050006
150600             IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO               15060006
150700                 PERFORM 7200-FORMAT-COMMAREA                     15070006
150800                 PERFORM 7300-START-TRANID-E226                   15080006
150900                 SET DP030-OVERRIDE-GO TO TRUE                    15090006
151000                 MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER         15100006
151100                 SET DP020-MSG-INFORMATIONAL TO TRUE              15110006
151200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15120006
151300             ELSE                                                 15130006
151400                 SET DP030-OVERRIDE-GO TO TRUE                    15140006
151500                 MOVE PC-TSYMSG-99907 TO DP020-MSG-NUMBER         15150006
151600                 SET DP020-MSG-WARNING TO TRUE                    15160006
151700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15170006
151800             END-IF                                               15180006
151900                                                                  15190006
152000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              15200006
152100           IF ASC-AUTO-VE                                         15210006
152200               MOVE PC-TSYMSG-03217 TO DP020-MSG-NUMBER           15220006
152300               SET DP020-MSG-WARNING TO TRUE                      15230006
152400               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               15240006
152500           ELSE                                                   15250006
152600             SET PS-AR-STATUS                                     15260006
152700                 PS-STATUS-OK TO TRUE                             15270006
152800             MOVE ASC-KEY-TRIP-ID       TO DK-TRIP-ID             15280006
152900             PERFORM 2160-SELECT-TTRIPST                          15290006
153000             IF SQLCODE = +0                                      15300006
153100                 PERFORM 2170-TTRIPST-RANGE-CHK                   15310006
153200             END-IF                                               15320006
153300             IF PS-AR-STATUS                                      15330006
153400               AND PS-STATUS-OK                                   15340006
153500                 MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID   15350006
153600                 MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR         15360006
153700                 MOVE ASC-KEY-ARRIVAL-DTE   TO DK-ARRIVAL-DTE     15370006
153800                 MOVE ASC-KEY-PO-NBR        TO DK-PO-NBR          15380006
153900                 PERFORM 2050-DELETE-LIST-QUEUE                   15390006
154000                 PERFORM 4000-BUILD-INITIAL-PANEL                 15400006
154100                 IF ASC-TRLR-UNLOADED                             15410006
154200                     PERFORM 8000-UPDATE-TRIP-SHIPMENT-STAT       15420006
154300                     MOVE PC-TSYMSG-00417 TO DP020-MSG-NUMBER     15430006
154400                     SET DP020-MSG-INFORMATIONAL TO TRUE          15440006
154500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         15450006
154600                 ELSE                                             15460006
154700                     MOVE PC-TSYMSG-00416 TO DP020-MSG-NUMBER     15470006
154800                     SET DP020-MSG-WARNING TO TRUE                15480006
154900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         15490006
155000                 END-IF                                           15500006
155100             ELSE                                                 15510006
155200                 IF PS-NO-AR-STATUS                               15520006
155300                     MOVE PC-TSYMSG-01074 TO DP020-MSG-NUMBER     15530006
155400                 ELSE                                             15540006
155500                     MOVE PC-TSYMSG-00417 TO DP020-MSG-NUMBER     15550006
155600                 END-IF                                           15560006
155700                 SET DP020-MSG-WARNING TO TRUE                    15570006
155800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15580006
155900             END-IF                                               15590006
156000           END-IF                                                 15600006
156100                                                                  15610006
156200         WHEN DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)               15620006
156300             INITIALIZE PC000-INTER-APPL-COMMAREA                 15630006
156400             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 15640006
156500                                   PC000-NUMBER-OF-SELECTED-ITEMS 15650006
156600             MOVE ASC-KEY-PO-NBR                                  15660006
156700                                TO PC000-PO-NBR-N                 15670006
156800             MOVE ASC-KEY-REC-SEQ-NBR                             15680006
156900                                TO PC000-REC-SEQ-NBR-N            15690006
157000             MOVE ASC-KEY-OPER-UNT-ID                             15700006
157100                                TO PC000-OPERATING-UNIT-ID        15710006
157200             MOVE ASC-KEY-FCLTY-ID                                15720006
157300                                TO PC000-FACILITY-ID              15730006
157400             PERFORM 5000-PREPARE-SEL-QUEUE                       15740006
157500                                                                  15750006
157600         WHEN DP020-FK-LOCAL-FUNC-06(DP020-SRC-AID)               15760006
157601                                                                  15760127
157604              PERFORM 6300-CHECK-DC-OK-FOR-DWNLD                  15760427
157605              IF PS-DWNLD-TO-WMS-NO                               15760527
157610                 MOVE PC-TSYMSG-03571 TO DP020-MSG-NUMBER         15761027
157620                 SET DP020-MSG-INFORMATIONAL TO TRUE              15762027
157621*                                                                 15762127
157622*DMH 4-27-2021 BEGIN - DO NOT ALLOW DOWNLOAD IF BULK RECEIVERS    15762227
157623*                      HAVE MULTI SKU CASES                       15762327
157624              ELSE                                                15762427
157625                  IF ASC-HAS-BULK-MULTI-SKU-YES                   15762527
157626                     MOVE PC-TSYMSG-03817 TO DP020-MSG-NUMBER     15762627
157627                     SET DP020-MSG-INFORMATIONAL TO TRUE          15762727
157629*                                                                 15762927
157630*DMH 4-27-2021 END                                                15763027
157631*                                                                 15763127
157632                                                                  15763227
157633                  ELSE                                            15763327
157640                     SET PS-NO-TRANS-RCVRS TO TRUE                15764027
157650                     PERFORM 6500-CHECK-TRANSCRIBED-RCVRS         15765027
157660                     IF PS-TRANS-RCVRS                            15766027
157670                        PERFORM 6400-PROCESS-DWNLD                15767027
157680                        IF PS-CALL-DWNLD-MODULE-YES               15768027
157690                           PERFORM 6600-CALL-WMS-MODULE           15769027
157700                           IF WS001-SUCCESSFUL                    15770027
157800**                            TRANSCRIBED RCVRS DOWNLOADED TO WMS 15780027
157900                              MOVE PC-TSYMSG-03535                15790027
158000                                         TO DP020-MSG-NUMBER      15800006
158100                              SET DP020-MSG-INFORMATIONAL TO TRUE 15810027
158110                           ELSE                                   15811027
158120**                            ERROR IN DWNLD - CALL HELP DESK     15812027
158130                              MOVE PC-TSYMSG-03546                15813027
158140                                         TO DP020-MSG-NUMBER      15814006
158150                              SET DP020-MSG-WARNING TO TRUE       15815027
158160                           END-IF                                 15816027
158170                        ELSE                                      15817027
158180**                    RECEIVING HAS BEGUN ON TRAILER, UNABLE TO   15818006
158190**                    DOWNLOAD TO WMS                             15819006
158191**                       IF ANY DETAIL RECS ARE IN TROUBLE, THEN  15819106
158192**                       CREATE DUMMY HEADER                      15819206
158193                         PERFORM 6700-CHECK-FOR-TRBL-RECS         15819306
158194                         IF PS-TRBL-DUMMY-YES                     15819406
158195                             MOVE PC-TSYMSG-03565                 15819506
158196                                              TO DP020-MSG-NUMBER 15819606
158197                             SET DP020-MSG-INFORMATIONAL TO TRUE  15819706
158198                         ELSE                                     15819806
158199                             MOVE PC-TSYMSG-03542                 15819906
158200                                              TO DP020-MSG-NUMBER 15820006
158201                             SET DP020-MSG-INFORMATIONAL TO TRUE  15820106
158202                         END-IF                                   15820206
158203                        END-IF                                    15820327
158204                   ELSE                                           15820406
158205**                    TRAILER DOES NOT CONTAIN TRANSCRIBED RCVRS  15820506
158206**                    NOTHING DOWNLOADED TO WMS                   15820606
158207                      MOVE PC-TSYMSG-03536 TO DP020-MSG-NUMBER    15820706
158208                      SET DP020-MSG-INFORMATIONAL TO TRUE         15820806
158209                   END-IF                                         15820906
158210                END-IF                                            15821006
158211             END-IF                                               15821127
158212             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15821227
158219                                                                  15821927
158220         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  15822027
158221             MOVE +1               TO PV-TOP-ITEM                 15822127
158230             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15823006
158240             PERFORM 3200-RESET-ATTRIBUTES                        15824006
158250                                                                  15825006
158260         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   15826006
158270             PERFORM 2110-BROWSE-BACKWARD                         15827006
158280             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15828006
158290             PERFORM 3200-RESET-ATTRIBUTES                        15829006
158300                                                                  15830006
158400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   15840006
158500             PERFORM 2120-BROWSE-FORWARD                          15850006
158600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 15860006
158700             PERFORM 3200-RESET-ATTRIBUTES                        15870006
158800                                                                  15880006
158900         WHEN DP020-SRC-AID = DP016-ENTER                         15890006
159000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   15900006
159100             IF  PS-ERROR                                         15910006
159200                 CONTINUE                                         15920006
159300             ELSE                                                 15930006
159400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15940006
159500             END-IF                                               15950006
159600                                                                  15960006
159700         WHEN OTHER                                               15970006
159800             SET DP013-NO-ROLLBACK                                15980006
159900                 DP013-XCTL-DISPLAY-RESTART                       15990006
160000                 DP013-CICS-ABEND  TO TRUE                        16000006
160100             MOVE '2100-CHECK-FUNCTION-KEY'                       16010006
160200                                   TO DP013-PARAGRAPH             16020006
160300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      16030006
160400                                   TO DP013-MESSAGE-TEXT (1)      16040006
160500             PERFORM DP013-0000-PROCESS-ABEND                     16050006
160600     END-EVALUATE.                                                16060006
160700/                                                                 16070006
160800*----------------------------------------------------------------*16080006
160900*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16090006
161000*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16100006
161100*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16110006
161200*    MESSAGE.                                                    *16120006
161300*----------------------------------------------------------------*16130006
161400                                                                  16140006
161500 2110-BROWSE-BACKWARD.                                            16150006
161600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    16160006
161700         GIVING PV-TOP-ITEM.                                      16170006
161800                                                                  16180006
161900     IF  ((PV-TOP-ITEM < +1)                                      16190006
162000       OR (PV-TOP-ITEM = +1))                                     16200006
162100         MOVE +1                   TO PV-TOP-ITEM                 16210006
162200*        -- TOP OF LIST --                                        16220006
162300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16230006
162400         SET DP020-MSG-INFORMATIONAL TO TRUE                      16240006
162500     END-IF.                                                      16250006
162600                                                                  16260006
162700                                                                  16270006
162800*----------------------------------------------------------------*16280006
162900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *16290006
163000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *16300006
163100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *16310006
163200*----------------------------------------------------------------*16320006
163300                                                                  16330006
163400 2120-BROWSE-FORWARD.                                             16340006
163500                                                                  16350006
163600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              16360006
163700         GIVING PV-TOP-ITEM.                                      16370006
163800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   16380006
163900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16390006
164000                                   TO PV-TOP-ITEM                 16400006
164100*        -- BOTTOM OF LIST --                                     16410006
164200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16420006
164300         SET DP020-MSG-INFORMATIONAL                              16430006
164400                                   TO TRUE                        16440006
164500     ELSE                                                         16450006
164600         COMPUTE PV-BOTTOM-ITEM =                                 16460006
164700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 16470006
164800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            16480006
164900*            -- BOTTOM OF LIST --                                 16490006
165000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16500006
165100             SET DP020-MSG-INFORMATIONAL                          16510006
165200                                   TO TRUE                        16520006
165300         END-IF                                                   16530006
165400     END-IF.                                                      16540006
165500/                                                                 16550006
165600*----------------------------------------------------------------*16560006
165700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *16570006
165800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *16580006
165900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *16590006
166000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *16600006
166100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *16610006
166200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *16620006
166300*----------------------------------------------------------------*16630006
166400                                                                  16640006
166500 2130-CHECK-FOR-JUMP-BROWSE.                                      16650006
166600                                                                  16660006
166700     SET PS-NO-ERROR               TO TRUE.                       16670006
166800                                                                  16680006
166900*PS 10/16/2015 CHANGE STARTS                                      16690011
166910     IF ASC-KEY-PO-NBR-X NOT = '00000000'                         16691011
166920*PS 10/16/2015 CHANGE ENDS                                        16692011
167000         PERFORM 2300-CHECK-FOR-SEARCH-PO.                        16700006
167100                                                                  16710006
167200     IF (ASC-START-ITEM-REQUEST = SPACE)                          16720006
167300         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            16730006
167400                                   TO PV-TOP-ITEM                 16740006
167500     ELSE                                                         16750006
167600         MOVE ASC-START-ITEM-REQUEST                              16760006
167700                                   TO DP010I-UNEDITED-FIELD       16770006
167800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       16780006
167900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     16790006
168000         SET DP010I-NEGATIVE-NOT-ALLOWED                          16800006
168100                                   TO TRUE                        16810006
168210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16821031
168220              USING DP010I-NUMERIC-EDIT-AREA                      16822031
168300                                                                  16830006
168400         IF  NOT DP010I-ERROR-DETECTED                            16840006
168500             MOVE DP010I-NUMERIC-FIELD                            16850006
168600                                   TO  ASC-START-ITEM-REQUEST-N   16860006
168700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  16870006
168800                 IF  ASC-START-ITEM-REQUEST-N >                   16880006
168900                                          ASC-NUMBER-OF-ITEMS-READ16890006
169000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         16900006
169100                     COMPUTE PV-TOP-ITEM =                        16910006
169200                             ASC-NUMBER-OF-ITEMS-READ             16920006
169300                             - PC-ITEMS-PER-PANEL + 1             16930006
169400                     IF  PV-TOP-ITEM < +1                         16940006
169500                         MOVE +1   TO PV-TOP-ITEM                 16950006
169600                         MOVE PC-TSYMSG-00070                     16960006
169700                                   TO DP020-MSG-NUMBER            16970006
169800                         SET DP020-MSG-INFORMATIONAL              16980006
169900                                   TO TRUE                        16990006
170000                     END-IF                                       17000006
170100                 ELSE                                             17010006
170200                     MOVE ASC-START-ITEM-REQUEST-N                17020006
170300                                   TO PV-TOP-ITEM                 17030006
170400                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      17040006
170500                     COMPUTE PV-BOTTOM-ITEM =                     17050006
170600                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     17060006
170700                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ17070006
170800*                        -- BOTTOM OF LIST --                     17080006
170900                         MOVE PC-TSYMSG-00070                     17090006
171000                                   TO DP020-MSG-NUMBER            17100006
171100                         SET DP020-MSG-INFORMATIONAL              17110006
171200                                   TO TRUE                        17120006
171300                     END-IF                                       17130006
171400                 END-IF                                           17140006
171500             ELSE                                                 17150006
171600*                --- VALUE OUT OF RANGE ----                      17160006
171700                 MOVE PC-TSYMSG-00101                             17170006
171800                                   TO DP020-MSG-NUMBER            17180006
171900                 MOVE -1           TO ASTRTITL                    17190006
172000                 SET DP030-SET-CURSOR-APPL-1                      17200006
172100                                   TO TRUE                        17210006
172200                 MOVE DP015-REVERSE                               17220006
172300                                   TO ASTRTITH                    17230006
172400                 MOVE DP015-RED    TO ASTRTITC                    17240006
172500                 MOVE DP015-UNP-NUM-BRT-MDT                       17250006
172600                                   TO ASTRTITA                    17260006
172700                 SET DP020-MSG-FATAL                              17270006
172800                                   TO TRUE                        17280006
172900                 SET PS-ERROR      TO TRUE                        17290006
173000             END-IF                                               17300006
173100                                                                  17310006
173200         ELSE                                                     17320006
173300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17330006
173400             MOVE -1               TO ASTRTITL                    17340006
173500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17350006
173600             MOVE DP015-REVERSE    TO ASTRTITH                    17360006
173700             MOVE DP015-RED        TO ASTRTITC                    17370006
173800             MOVE DP015-UNP-NUM-BRT-MDT                           17380006
173900                                   TO ASTRTITA                    17390006
174000             SET DP020-MSG-FATAL   TO TRUE                        17400006
174100             SET PS-ERROR          TO TRUE                        17410006
174200         END-IF                                                   17420006
174300     END-IF.                                                      17430006
174400/                                                                 17440006
174500*----------------------------------------------------------------*17450006
174600*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *17460006
174700*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *17470006
174800*----------------------------------------------------------------*17480006
174900 2140-DESELECT-ALL-ITEMS.                                         17490006
175000                                                                  17500006
175100     MOVE +1                       TO ASC-BLK-SUB.                17510006
175200                                                                  17520006
175300     PERFORM 2141-CLEAR-SELECTED-INDS                             17530006
175400         VARYING ASC-ITEM-SUB                                     17540006
175500         FROM 1 BY 1                                              17550006
175600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17560006
175700                                                                  17570006
175800     ADD +1                        TO ASC-BLK-SUB.                17580006
175900                                                                  17590006
176000     PERFORM 2141-CLEAR-SELECTED-INDS                             17600006
176100         VARYING ASC-ITEM-SUB                                     17610006
176200         FROM 1 BY 1                                              17620006
176300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17630006
176400                                                                  17640006
176500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17650006
176600                                   TO PV-LIST-ITEM-NUMBER.        17660006
176700                                                                  17670006
176800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17680006
176900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17690006
177000                                                                  17700006
177100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17710006
177200        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      17720006
177300         MOVE +1                   TO ASC-BLK-SUB                 17730006
177400                                                                  17740006
177500         PERFORM 5100-WRITE-TEMP-STORAGE                          17750006
177600                                                                  17760006
177700         MOVE +1                   TO PV-BLOCK-NUMBER             17770006
177800                                                                  17780006
177900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17790006
178000             PV-FIRST-BLOCK-IN-ARRAY - 1                          17800006
178100                                                                  17810006
178200         PERFORM                                                  17820006
178300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17830006
178400                                                                  17840006
178500             PERFORM 4410-READ-TEMP-STORAGE                       17850006
178600                                                                  17860006
178700             PERFORM 2141-CLEAR-SELECTED-INDS                     17870006
178800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 17880006
178900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17890006
179000                                                                  17900006
179100             PERFORM 5100-WRITE-TEMP-STORAGE                      17910006
179200                                                                  17920006
179300             ADD +1                TO PV-BLOCK-NUMBER             17930006
179400                                                                  17940006
179500         END-PERFORM                                              17950006
179600                                                                  17960006
179700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17970006
179800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17980006
179900                                                                  17990006
180000         PERFORM                                                  18000006
180100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18010006
180200                   ASC-HIGHEST-BLOCK-WRITTEN                      18020006
180300                                                                  18030006
180400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18040006
180500                                   TO PV-BLOCK-NUMBER             18050006
180600                                                                  18060006
180700             PERFORM 4410-READ-TEMP-STORAGE                       18070006
180800                                                                  18080006
180900             PERFORM 2141-CLEAR-SELECTED-INDS                     18090006
181000                 VARYING ASC-ITEM-SUB                             18100006
181100                 FROM 1 BY 1                                      18110006
181200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18120006
181300                                                                  18130006
181400             PERFORM 5100-WRITE-TEMP-STORAGE                      18140006
181500                                                                  18150006
181600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18160006
181700                                                                  18170006
181800         END-PERFORM                                              18180006
181900                                                                  18190006
182000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18200006
182100                                   TO PV-BLOCK-NUMBER             18210006
182200                                                                  18220006
182300         PERFORM 4410-READ-TEMP-STORAGE                           18230006
182400     END-IF.                                                      18240006
182500                                                                  18250006
182600                                                                  18260006
182700     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 18270006
182800     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.18280006
182900     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  18290006
183000                                                                  18300006
183100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18310006
183200                                                                  18320006
183300                                                                  18330006
183400*----------------------------------------------------------------*18340006
183500*    MARK EACH ITEM AS BEING NOT SELECTED.                       *18350006
183600*----------------------------------------------------------------*18360006
183700                                                                  18370006
183800 2141-CLEAR-SELECTED-INDS.                                        18380006
183900                                                                  18390006
184000     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           18400006
184100             NOT EQUAL ZERO                                       18410006
184200         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18420006
184300             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18430006
184400                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    18440006
184500                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18450006
184600                                   TO TRUE                        18460006
184700         END-IF                                                   18470006
184800     END-IF.                                                      18480006
184900/                                                                 18490006
185000*----------------------------------------------------------------*18500006
185100*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *18510006
185200*  FOR ALL ITEMS.                                                *18520006
185300*----------------------------------------------------------------*18530006
185400                                                                  18540006
185500 2150-SELECT-ALL-ITEMS.                                           18550006
185600                                                                  18560006
185700     MOVE +1                       TO ASC-BLK-SUB.                18570006
185800                                                                  18580006
185900     PERFORM 2151-SET-SELECTED-INDS                               18590006
186000         VARYING ASC-ITEM-SUB                                     18600006
186100         FROM 1 BY 1                                              18610006
186200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18620006
186300                                                                  18630006
186400     ADD +1                        TO ASC-BLK-SUB.                18640006
186500                                                                  18650006
186600     PERFORM 2151-SET-SELECTED-INDS                               18660006
186700         VARYING ASC-ITEM-SUB                                     18670006
186800         FROM 1 BY 1                                              18680006
186900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18690006
187000                                                                  18700006
187100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18710006
187200                                   TO PV-LIST-ITEM-NUMBER.        18720006
187300                                                                  18730006
187400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18740006
187500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18750006
187600                                                                  18760006
187700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18770006
187800        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    18780006
187900         MOVE +1                   TO ASC-BLK-SUB                 18790006
188000                                                                  18800006
188100         PERFORM 5100-WRITE-TEMP-STORAGE                          18810006
188200                                                                  18820006
188300         MOVE +1                   TO PV-BLOCK-NUMBER             18830006
188400                                                                  18840006
188500         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18850006
188600             PV-FIRST-BLOCK-IN-ARRAY - 1                          18860006
188700                                                                  18870006
188800         PERFORM                                                  18880006
188900             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18890006
189000                                                                  18900006
189100             PERFORM 4410-READ-TEMP-STORAGE                       18910006
189200                                                                  18920006
189300             PERFORM 2151-SET-SELECTED-INDS                       18930006
189400                 VARYING ASC-ITEM-SUB                             18940006
189500                 FROM 1 BY 1                                      18950006
189600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18960006
189700                                                                  18970006
189800             PERFORM 5100-WRITE-TEMP-STORAGE                      18980006
189900                                                                  18990006
190000             ADD +1                TO PV-BLOCK-NUMBER             19000006
190100                                                                  19010006
190200         END-PERFORM                                              19020006
190300                                                                  19030006
190400         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19040006
190500             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19050006
190600                                                                  19060006
190700         PERFORM                                                  19070006
190800             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19080006
190900                   ASC-HIGHEST-BLOCK-WRITTEN                      19090006
191000                                                                  19100006
191100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19110006
191200                                   TO PV-BLOCK-NUMBER             19120006
191300                                                                  19130006
191400             PERFORM 4410-READ-TEMP-STORAGE                       19140006
191500                                                                  19150006
191600             PERFORM 2151-SET-SELECTED-INDS                       19160006
191700                 VARYING ASC-ITEM-SUB                             19170006
191800                 FROM 1 BY 1                                      19180006
191900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19190006
192000                                                                  19200006
192100             PERFORM 5100-WRITE-TEMP-STORAGE                      19210006
192200                                                                  19220006
192300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19230006
192400                                                                  19240006
192500         END-PERFORM                                              19250006
192600                                                                  19260006
192700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19270006
192800                                   TO PV-BLOCK-NUMBER             19280006
192900                                                                  19290006
193000         PERFORM 4410-READ-TEMP-STORAGE                           19300006
193100     END-IF.                                                      19310006
193200                                                                  19320006
193300                                                                  19330006
193400     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             19340006
193500                       ASC-NUMBER-OF-SELECTED-ITEMS.              19350006
193600                                                                  19360006
193700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        19370006
193800                                                                  19380006
193900                                                                  19390006
194000*----------------------------------------------------------------*19400006
194100*    MARK EACH ITEM AS BEING SELECTED.                           *19410006
194200*----------------------------------------------------------------*19420006
194300                                                                  19430006
194400 2151-SET-SELECTED-INDS.                                          19440006
194500                                                                  19450006
194600     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           19460006
194700             NOT EQUAL ZERO                                       19470006
194800         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19480006
194900             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             19490006
195000                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        19500006
195100                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19510006
195200                               TO  TRUE                           19520006
195300         END-IF                                                   19530006
195400     END-IF.                                                      19540006
195500/                                                                 19550006
195600                                                                  19560006
195700*----------------------------------------------------------------*19570006
195800*  SELECT THE ARRIVED TRIP STATUS ROW                            *19580006
195900*----------------------------------------------------------------*19590006
196000 2160-SELECT-TTRIPST.                                             19600006
196100                                                                  19610006
196200     PERFORM                                                      19620006
196300         WITH TEST AFTER                                          19630006
196400         VARYING PV-RETRY-COUNTER                                 19640006
196500         FROM 1 BY 1                                              19650006
196600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19660006
196700             OR (SQLCODE = +0)                                    19670006
196800             OR (SQLCODE = +100))                                 19680006
196900                                                                  19690006
197000         EXEC SQL                                                 19700006
197100             SELECT  A.TRIP_STATUS_CDE                            19710006
197200              INTO   :TRIPST-TRIP-STATUS-CDE                      19720006
197300              FROM  TTRIPST A                                     19730006
197400             WHERE  A.TRIP_ID          = :DK-TRIP-ID              19740006
197500               AND  A.TRIP_STATUS_CDE  = 'AR'                     19750006
197510              WITH UR                                             19751008
197600         END-EXEC                                                 19760006
197700                                                                  19770006
197800         EVALUATE TRUE                                            19780006
197900             WHEN SQLCODE = +0                                    19790006
198000             WHEN SQLCODE = -904                                  19800006
198100             WHEN SQLCODE = -913                                  19810006
198200                 CONTINUE                                         19820006
198300                                                                  19830006
198400             WHEN SQLCODE = +100                                  19840006
198500                 SET PS-NO-AR-STATUS TO TRUE                      19850006
198600                                                                  19860006
198700             WHEN SQLWARN0 NOT = SPACES                           19870006
198800             WHEN SQLCODE < +0                                    19880006
198900             WHEN SQLCODE > +0                                    19890006
199000                 MOVE '2160-SELECT-TTRIPST'                       19900006
199100                                   TO DP013-PARAGRAPH             19910006
199200                 MOVE 'SELECT A ROW ON TTRIPST'                   19920006
199300                                   TO DP013-MESSAGE-TEXT(1)       19930006
199400                 MOVE SQLCA        TO DP013-SQLCA                 19940006
199500                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    19950006
199600                 MOVE DK-TRIP-ID   TO PV-DISPLAY-TRIP             19960006
199700                 STRING               DK-OWNER-SCAC-ID '/'        19970006
199800                                      DK-ARRIVAL-DTE '/'          19980006
199900                                      DK-VEH-NBR '/'              19990006
200000                                      PV-DISPLAY-TRIP '/'         20000006
200100                 DELIMITED BY SIZE                                20010006
200200                                 INTO DP013-MESSAGE-TEXT(2)       20020006
200300                 SET DP013-DB2-ABEND                              20030006
200400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           20040006
200500                 PERFORM DP013-0000-PROCESS-ABEND                 20050006
200600         END-EVALUATE                                             20060006
200700     END-PERFORM.                                                 20070006
200800                                                                  20080006
200900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    20090006
201000         SQLCODE NOT = +0                                         20100006
201100         MOVE '2160-SELECT-TTRIPST'                               20110006
201200                                   TO DP013-PARAGRAPH             20120006
201300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              20130006
201400                                   TO DP013-MESSAGE-TEXT (1)      20140006
201500         MOVE 'TO SELECT A TTRIPST ROW'                           20150006
201600                                   TO DP013-MESSAGE-TEXT (2)      20160006
201700         MOVE SQLCA                TO DP013-SQLCA                 20170006
201800         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    20180006
201900         SET DP013-DB2-ABEND                                      20190006
202000             DP013-XCTL-DISPLAY-RESTART                           20200006
202100                                   TO TRUE                        20210006
202200         PERFORM DP013-0000-PROCESS-ABEND                         20220006
202300     END-IF.                                                      20230006
202400*----------------------------------------------------------------*20240006
202500*  CHECK THAT TRIP STATUS IS NOT UNLOADED OR BEYOND UNLOADED     *20250006
202600*----------------------------------------------------------------*20260006
202700 2170-TTRIPST-RANGE-CHK.                                          20270006
202800                                                                  20280006
202900     PERFORM                                                      20290006
203000         WITH TEST AFTER                                          20300006
203100         VARYING PV-RETRY-COUNTER                                 20310006
203200         FROM 1 BY 1                                              20320006
203300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20330006
203400             OR (SQLCODE = +0)                                    20340006
203500             OR (SQLCODE = -305)                                  20350006
203600             OR (SQLCODE = +100))                                 20360006
203700                                                                  20370006
203800         EXEC SQL                                                 20380006
203900             SELECT  MAX(B.PRTY_CDE)                              20390006
204000              INTO   :TRSTYP-PRTY-CDE                             20400006
204100              FROM  TTRIPST A                                     20410006
204200                   ,TTRSTYP B                                     20420006
204300             WHERE  A.TRIP_ID          = :DK-TRIP-ID              20430006
204400               AND  A.TRIP_STATUS_CDE  = B.TRIP_STATUS_CDE        20440006
204410              WITH UR                                             20441008
204500         END-EXEC                                                 20450006
204600                                                                  20460006
204700         EVALUATE TRUE                                            20470006
204800             WHEN SQLCODE = +0                                    20480006
204900             IF TRSTYP-PRTY-CDE < '70'                            20490006
205000                 CONTINUE                                         20500006
205100             ELSE                                                 20510006
205200                 SET PS-STATUS-NOT-OK TO TRUE                     20520006
205300             END-IF                                               20530006
205400             WHEN SQLCODE = -904                                  20540006
205500             WHEN SQLCODE = -913                                  20550006
205600                 CONTINUE                                         20560006
205700                                                                  20570006
205800             WHEN SQLCODE = +100                                  20580006
205900             WHEN SQLCODE = -305                                  20590006
206000                 SET PS-STATUS-NOT-OK TO TRUE                     20600006
206100                                                                  20610006
206200             WHEN SQLWARN0 NOT = SPACES                           20620006
206300             WHEN SQLCODE < +0                                    20630006
206400             WHEN SQLCODE > +0                                    20640006
206500                 MOVE '2170-TTRIPST-RANGE-CHK'                    20650006
206600                                   TO DP013-PARAGRAPH             20660006
206700                 MOVE 'GET MAX TTRSTYP PRTY_CDE'                  20670006
206800                                   TO DP013-MESSAGE-TEXT(1)       20680006
206900                 MOVE SQLCA        TO DP013-SQLCA                 20690006
207000                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    20700006
207100                 MOVE 'TTRSTYP'    TO DP013-DB2-TABLE-NAME (2)    20710006
207200                 MOVE DK-TRIP-ID   TO PV-DISPLAY-TRIP             20720006
207300                 STRING               DK-OWNER-SCAC-ID '/'        20730006
207400                                      DK-ARRIVAL-DTE '/'          20740006
207500                                      DK-VEH-NBR '/'              20750006
207600                                      PV-DISPLAY-TRIP '/'         20760006
207700                 DELIMITED BY SIZE                                20770006
207800                                 INTO DP013-MESSAGE-TEXT(2)       20780006
207900                 SET DP013-DB2-ABEND                              20790006
208000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           20800006
208100                 PERFORM DP013-0000-PROCESS-ABEND                 20810006
208200         END-EVALUATE                                             20820006
208300     END-PERFORM.                                                 20830006
208400                                                                  20840006
208500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    20850006
208600         SQLCODE NOT = +0                                         20860006
208700         MOVE '2170-TTRIPST-RANGE-CHK'                            20870006
208800                                   TO DP013-PARAGRAPH             20880006
208900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              20890006
209000                                   TO DP013-MESSAGE-TEXT (1)      20900006
209100         MOVE 'TO GET MAX TTRSTYP PRTY_CDE'                       20910006
209200                                   TO DP013-MESSAGE-TEXT (2)      20920006
209300         MOVE SQLCA                TO DP013-SQLCA                 20930006
209400         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    20940006
209500         MOVE 'TTRSTYP'            TO DP013-DB2-TABLE-NAME (2)    20950006
209600         SET DP013-DB2-ABEND                                      20960006
209700             DP013-XCTL-DISPLAY-RESTART                           20970006
209800                                   TO TRUE                        20980006
209900         PERFORM DP013-0000-PROCESS-ABEND                         20990006
210000     END-IF.                                                      21000006
210100                                                                  21010006
210200******************************************************************21020006
210300** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **21030006
210400** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **21040006
210500******************************************************************21050006
210600 2200-MOVE-SCREEN-TO-COMMAREA.                                    21060006
210700                                                                  21070006
210800     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             21080006
210900     MOVE +1                       TO PV-SUB.                     21090006
211000                                                                  21100006
211100     PERFORM 3100-SET-SUBSCRIPTS.                                 21110006
211200                                                                  21120006
211300     IF  ASTRTITL > ZERO                                          21130006
211400         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          21140006
211500     ELSE                                                         21150006
211600         IF  ASTRTITF = DP015-ERASE-EOF                           21160006
211700             INITIALIZE ASC-START-ITEM-REQUEST                    21170006
211800         END-IF                                                   21180006
211900     END-IF.                                                      21190006
212000                                                                  21200006
212100     IF ASPONBRL > ZERO                                           21210006
212200         MOVE ASPONBRI         TO ASC-KEY-PO-NBR-X                21220006
212300                                  DK-PO-NBR                       21230006
212400     ELSE                                                         21240006
212500         IF  ASPONBRF = DP015-ERASE-EOF                           21250006
212600             INITIALIZE ASC-KEY-PO-NBR                            21260006
212700                        DK-PO-NBR                                 21270006
212800         END-IF                                                   21280006
212900     END-IF.                                                      21290006
213000                                                                  21300006
213100     IF APRINTRL > ZERO                                           21310006
213200         MOVE APRINTRI TO ASC-PRINTER-ID                          21320006
213300     ELSE                                                         21330006
213400         IF APRINTRF = DP015-ERASE-EOF                            21340006
213500             INITIALIZE ASC-PRINTER-ID                            21350006
213600         END-IF                                                   21360006
213700     END-IF.                                                      21370006
213800                                                                  21380006
213900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          21390006
214000         VARYING PV-SUB                                           21400006
214100         FROM 1 BY 1                                              21410006
214200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      21420006
214300                                                                  21430006
214400                                                                  21440006
214500******************************************************************21450006
214600** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**21460006
214700******************************************************************21470006
214800 2210-MOVE-LINES-TO-COMMAREA.                                     21480006
214900                                                                  21490006
215000     IF  MR-SELECTL (PV-SUB) > ZERO                               21500006
215100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             21510006
215200         MOVE MR-SELECTI (PV-SUB)                                 21520006
215300                                   TO ASC-TEMP-SELECTED-SW        21530006
215400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21540006
215500     ELSE                                                         21550006
215600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                21560006
215700                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     21570006
215800                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        21580006
215900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21590006
216000         END-IF                                                   21600006
216100     END-IF.                                                      21610006
216200                                                                  21620006
216300     ADD +1                        TO ASC-ITEM-SUB.               21630006
216400                                                                  21640006
216500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        21650006
216600         ADD +1                    TO ASC-BLK-SUB                 21660006
216700         MOVE +1                   TO ASC-ITEM-SUB                21670006
216800     END-IF.                                                      21680006
216900/                                                                 21690006
217000*----------------------------------------------------------------*21700006
217100*    THE USER CAN CHANGE THE SEARCH FOR PO SCREEN FIELD TO       *21710006
217200*    REPOSITION THE LIST TO THE NEXT PO NBR THAT IS EQUAL OR     *21720006
217300*    GREATER THAN THE SEARCH FOR PO FIELD ENTERED.               *21730006
217400*----------------------------------------------------------------*21740006
217500                                                                  21750006
217600 2300-CHECK-FOR-SEARCH-PO.                                        21760006
217700                                                                  21770006
217800     MOVE ASC-KEY-PO-NBR-X         TO DP010I-UNEDITED-FIELD.      21780006
217900     MOVE PC-MSG-NUMBER-LENGTH     TO DP010I-MAXIMUM-DIGITS.      21790006
218000     MOVE +0                       TO DP010I-MAXIMUM-DECIMALS.    21800006
218100     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     21810006
218200                                                                  21820006
218310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             21831031
218320          USING DP010I-NUMERIC-EDIT-AREA.                         21832031
218400                                                                  21840006
218500     IF NOT DP010I-ERROR-DETECTED                                 21850006
218600         MOVE DP010I-NUMERIC-FIELD TO ASC-KEY-PO-NBR              21860006
218700         SET PS-INVALID-SRCH-PO TO TRUE                           21870006
218800     ELSE                                                         21880006
218900         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                21890006
219000         MOVE -1               TO ASPONBRL                        21900006
219100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      21910006
219200         MOVE DP015-REVERSE    TO ASPONBRH                        21920006
219300         MOVE DP015-RED        TO ASPONBRC                        21930006
219400         MOVE DP015-UNP-NUM-BRT-MDT                               21940006
219500                               TO ASPONBRA                        21950006
219600         SET DP020-MSG-FATAL   TO TRUE                            21960006
219700         SET PS-ERROR          TO TRUE                            21970006
219800     END-IF.                                                      21980006
219900                                                                  21990006
220000     IF NOT PS-ERROR                                              22000006
220100     AND ASC-KEY-PO-NBR > ZERO                                    22010006
220200         MOVE 99999 TO ASC-START-ITEM-REQUEST-N                   22020006
220300         PERFORM 2400-SRCH-LISTQ-CNTL                             22030006
220400             VARYING PV-ITEM                                      22040006
220500             FROM 1 BY 1                                          22050006
220600             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN            22060006
220700             OR ASC-KEY-PO-NBR = LQW-PO-NBR (LQW-IDX).            22070006
220800                                                                  22080006
220900     IF PS-INVALID-SRCH-PO                                        22090006
221000         MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER                22100006
221100         MOVE -1               TO ASPONBRL                        22110006
221200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      22120006
221300         MOVE DP015-REVERSE    TO ASPONBRH                        22130006
221400         MOVE DP015-YELLOW     TO ASPONBRC                        22140006
221500         MOVE DP015-UNP-NUM-BRT-MDT                               22150006
221600                               TO ASPONBRA                        22160006
221700         SET DP020-MSG-WARNING TO TRUE                            22170006
221800         SET PS-ERROR          TO TRUE                            22180006
221900     END-IF.                                                      22190006
222000                                                                  22200006
222100                                                                  22210006
222200*----------------------------------------------------------------*22220006
222300*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          22230006
222400*----------------------------------------------------------------*22240006
222500 2350-CALL-AUTOVE-MODULE.                                         22250006
222600                                                                  22260006
222700     INITIALIZE RC040-FIELDS.                                     22270006
222800     MOVE DK-OPER-UNT-ID       TO RC040-SIGNON-LOCATION.          22280006
222900     MOVE DK-PO-NBR            TO RC040-PO-NBR                    22290006
223000     MOVE DK-REC-SEQ-NBR       TO RC040-PO-RCVR                   22300006
223100     MOVE DP020-USERID         TO RC040-USER-ID.                  22310006
223200     MOVE 'RCKCS225'           TO RC040-CALLING-PROGRAM.          22320006
223300                                                                  22330006
223400     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  22340006
223500                                        RC040-COMMAREA            22350006
223600                                        RC040-FIELDS.             22360006
223700                                                                  22370006
223800     EVALUATE TRUE                                                22380006
223900         WHEN RC040-SUCCESSFUL                                    22390006
224000              CONTINUE                                            22400006
224100         WHEN RC040-DATABASE-BUSY OR                              22410006
224200              RC040-INVALID-SQL                                   22420006
224300                  MOVE PC-TSYMSG-00984  TO DP020-MSG-NUMBER       22430006
224400                  SET DP020-MSG-WARNING TO TRUE                   22440006
224500                  SET DP030-OVERRIDE-GO TO TRUE                   22450006
224600                  SET PS-ERROR          TO TRUE                   22460006
224700         WHEN RC040-NOT-SUCCESSFUL                                22470006
224800                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       22480006
224900                  SET DP020-MSG-WARNING TO TRUE                   22490006
225000                  SET DP030-OVERRIDE-GO TO TRUE                   22500006
225100                  SET PS-ERROR          TO TRUE                   22510006
225200         WHEN OTHER                                               22520006
225300             MOVE '2350-CALL-AUTOVE ' TO DP013-PARAGRAPH          22530006
225400             MOVE 'UNSUCCESSFUL CALL TO AUTO VE MOD'              22540006
225500                                         TO DP013-MESSAGE-TEXT (1)22550006
225600             MOVE RC040-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)22560006
225700             MOVE RC040-SQLCA            TO DP013-SQLCA           22570006
225800             SET DP013-DB2-ABEND                                  22580006
225900                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              22590006
226000             SET PS-ERROR                    TO TRUE              22600006
226100             PERFORM DP013-0000-PROCESS-ABEND                     22610006
226200                                                                  22620006
226300     END-EVALUATE.                                                22630006
226400/                                                                 22640006
226500*----------------------------------------------------------------*22650006
226600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *22660006
226700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *22670006
226800*----------------------------------------------------------------*22680006
226900                                                                  22690006
227000 2400-SRCH-LISTQ-CNTL.                                            22700006
227100                                                                  22710006
227200     PERFORM 6112-READ-LIST-QUEUE.                                22720006
227300                                                                  22730006
227400     IF PV-CICS-RESP = DFHRESP(NORMAL)                            22740006
227500         PERFORM                                                  22750006
227600         VARYING LQW-IDX                                          22760006
227700         FROM 1 BY 1                                              22770006
227800         UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                       22780006
227900         OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO                22790006
228000                                                                  22800006
228100             IF ASC-KEY-PO-NBR = LQW-PO-NBR (LQW-IDX)             22810006
228200                 SET PS-VALID-SRCH-PO TO TRUE                     22820006
228300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              22830006
228400                                   TO ASC-START-ITEM-REQUEST-N    22840006
228500                 SET LQW-IDX TO PC-ITEMS-PER-PANEL                22850006
228600                 ADD ASC-HIGHEST-BLOCK-WRITTEN TO PV-ITEM         22860006
228700             END-IF                                               22870006
228800         END-PERFORM                                              22880006
228900     END-IF.                                                      22890006
229000/                                                                 22900006
229100*----------------------------------------------------------------*22910006
229200*    THIS ROUTINE CONTROLS THE HEADER LABEL REQUEST FUNCTION.    *22920006
229300*----------------------------------------------------------------*22930006
229400                                                                  22940006
229500 2500-LABEL-CNTL-HEADER.                                          22950006
229600                                                                  22960006
229700     SET PC140-CRA-SUCCESSFUL TO TRUE.                            22970006
229800                                                                  22980006
229900     MOVE +1 TO ASC-BLK-SUB.                                      22990006
230000     PERFORM 2520-DO-ONE-ASC-BLK.                                 23000006
230100                                                                  23010006
230200     IF PC140-CRA-SUCCESSFUL                                      23020006
230300         ADD +1 TO ASC-BLK-SUB                                    23030006
230400         PERFORM 2520-DO-ONE-ASC-BLK                              23040006
230500     END-IF.                                                      23050006
230600                                                                  23060006
230700*ST  IF PC011-CRA-SUCCESSFUL                                      23070006
230800*ST    OR PC140-CRA-SUCCESSFUL                                    23080006
230900*ST      PERFORM 2530-DO-ALL-LISTQ-HEADER.                        23090006
231000                                                                  23100006
231100                                                                  23110006
231200*----------------------------------------------------------------*23120006
231300*    THIS ROUTINE CONTROLS THE CARTON LABEL REQUEST FUNCTION.    *23130006
231400*----------------------------------------------------------------*23140006
231500                                                                  23150006
231600 2510-LABEL-CNTL-CARTON.                                          23160006
231700                                                                  23170006
231800     SET PC140-CRA-SUCCESSFUL TO TRUE.                            23180006
231900                                                                  23190006
232000     MOVE +1 TO ASC-BLK-SUB.                                      23200006
232100     PERFORM 2525-DO-1-ASC-BLK.                                   23210006
232200                                                                  23220006
232300     IF PC140-CRA-SUCCESSFUL                                      23230006
232400         ADD +1 TO ASC-BLK-SUB                                    23240006
232500         PERFORM 2525-DO-1-ASC-BLK.                               23250006
232600                                                                  23260006
232700*ST  IF PC011-CRA-SUCCESSFUL                                      23270006
232800*ST    OR PC140-CRA-SUCCESSFUL                                    23280006
232900*ST      PERFORM 2550-DO-ALL-LISTQ-CARTON.                        23290006
233000/                                                                 23300006
233100*----------------------------------------------------------------*23310006
233200*    CREATE LABELS FOR ONE ASC BLOCK, IF SELECTED.               *23320006
233300*----------------------------------------------------------------*23330006
233400                                                                  23340006
233500 2520-DO-ONE-ASC-BLK.                                             23350006
233600                                                                  23360006
233700     PERFORM 2650-HEADER-ITEMS                                    23370006
233800         VARYING ASC-ITEM-SUB                                     23380006
233900         FROM 1 BY 1                                              23390006
234000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                  23400006
234100         OR NOT PC140-CRA-SUCCESSFUL.                             23410006
234200                                                                  23420006
234300     PERFORM 5100-WRITE-TEMP-STORAGE.                             23430006
234400                                                                  23440006
234500                                                                  23450006
234600*----------------------------------------------------------------*23460006
234700*    CREATE LABELS FOR ONE ASC BLOCK, IF SELECTED.               *23470006
234800*----------------------------------------------------------------*23480006
234900                                                                  23490006
235000 2525-DO-1-ASC-BLK.                                               23500006
235100                                                                  23510006
235200     PERFORM 2660-CARTON-ITEMS                                    23520006
235300         VARYING ASC-ITEM-SUB                                     23530006
235400         FROM 1 BY 1                                              23540006
235500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                  23550006
235600         OR NOT PC140-CRA-SUCCESSFUL.                             23560006
235700                                                                  23570006
235800     PERFORM 5100-WRITE-TEMP-STORAGE.                             23580006
235900                                                                  23590006
236000                                                                  23600006
236100*----------------------------------------------------------------*23610006
236200*    CREATE HEADER LABELS FOR ONE EACH LISTQ RECORD, IF SELECTED.*23620006
236300*----------------------------------------------------------------*23630006
236400                                                                  23640006
236500 2530-DO-ALL-LISTQ-HEADER.                                        23650006
236600                                                                  23660006
236700     MOVE ZERO TO PV-SAVE-ITEM                                    23670006
236800                  PV-ITEMS-PROCESSED.                             23680006
236900                                                                  23690006
237000     PERFORM 2950-LABELS-LISTQ-HEADER                             23700006
237100         VARYING PV-ITEM                                          23710006
237200         FROM 1 BY 1                                              23720006
237300         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                23730006
237400         OR NOT PC140-CRA-SUCCESSFUL.                             23740006
237500                                                                  23750006
237600     IF LQW-BLOCK-MODIFIED = 'Y'                                  23760006
237700*    AND  PC140-CRA-SUCCESSFUL                                    23770006
237800*          OR PC140-CRA-SUCCESSFUL)                               23780006
237900         MOVE 'N' TO LQW-BLOCK-MODIFIED                           23790006
238000         PERFORM 6111-WRITE-LIST-QUEUE                            23800006
238100     END-IF.                                                      23810006
238200                                                                  23820006
238300                                                                  23830006
238400*----------------------------------------------------------------*23840006
238500*    CREATE CARTON LABELS FOR ONE EACH LISTQ RECORD, IF SELECTED.*23850006
238600*----------------------------------------------------------------*23860006
238700                                                                  23870006
238800 2550-DO-ALL-LISTQ-CARTON.                                        23880006
238900                                                                  23890006
239000     MOVE ZERO TO PV-SAVE-ITEM                                    23900006
239100                  PV-ITEMS-PROCESSED.                             23910006
239200                                                                  23920006
239300     PERFORM 2960-LABELS-LISTQ-CARTON                             23930006
239400         VARYING PV-ITEM                                          23940006
239500         FROM 1 BY 1                                              23950006
239600         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN                23960006
239700         OR NOT PC140-CRA-SUCCESSFUL.                             23970006
239800                                                                  23980006
239900     IF LQW-BLOCK-MODIFIED = 'Y'                                  23990006
240000     AND  PC140-CRA-SUCCESSFUL                                    24000006
240100*        OR PC140-CRA-SUCCESSFUL)                                 24010006
240200         MOVE 'N' TO LQW-BLOCK-MODIFIED                           24020006
240300         PERFORM 6111-WRITE-LIST-QUEUE                            24030006
240400     END-IF.                                                      24040006
240500/                                                                 24050006
240600*----------------------------------------------------------------*24060006
240700*    CREATE LABELS FOR SELECTED HEADER ITEMS.                    *24070006
240800*----------------------------------------------------------------*24080006
240900                                                                  24090006
241000 2650-HEADER-ITEMS.                                               24100006
241100                                                                  24110006
241200     MOVE LQW-PO-NBR (LQW-IDX)                                    24120006
241300                                  TO DK-PO-NBR.                   24130006
241400     MOVE LQW-REC-SEQ-NBR (LQW-IDX)                               24140006
241500                                  TO DK-REC-SEQ-NBR.              24150006
241600     MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              24160006
241700     MOVE ASC-KEY-FCLTY-ID        TO DK-FCLTY-ID.                 24170006
241800     PERFORM 4380-GET-OPER-SET-DESC.                              24180006
241900     MOVE OPRSET-CNTL-DESC        TO DK-CNTL-DESC.                24190006
242000     PERFORM 7000-SETUP-HDR-LABELS-ASC.                           24200006
242100                                                                  24210006
242200                                                                  24220006
242300*----------------------------------------------------------------*24230006
242400*    CREATE LABELS FOR SELECTED CARTON ITEMS.                    *24240006
242500*----------------------------------------------------------------*24250006
242600                                                                  24260006
242700 2660-CARTON-ITEMS.                                               24270006
242800                                                                  24280006
242900     MOVE LQW-PO-NBR (LQW-IDX)                                    24290006
243000                                  TO DK-PO-NBR.                   24300006
243100     MOVE LQW-REC-SEQ-NBR (LQW-IDX)                               24310006
243200                                  TO DK-REC-SEQ-NBR.              24320006
243300     MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              24330006
243400     MOVE ASC-KEY-FCLTY-ID        TO DK-FCLTY-ID.                 24340006
243500     PERFORM 4380-GET-OPER-SET-DESC.                              24350006
243600     MOVE OPRSET-CNTL-DESC        TO DK-CNTL-DESC.                24360006
243700     PERFORM 7010-SETUP-CTN-LABELS-ASC.                           24370006
243800                                                                  24380006
243900                                                                  24390006
244000*----------------------------------------------------------------*24400006
244100*    DESELECT THE PRINTED ITEM IN THE ASC.                       *24410006
244200*----------------------------------------------------------------*24420006
244300                                                                  24430006
244400 2800-DESELECT-ITEM-ASC.                                          24440006
244500                                                                  24450006
244600     MOVE SPACE TO                                                24460006
244700         ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)               24470006
244800         ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB).         24480006
244900                                                                  24490006
245000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                24500006
245100                                                                  24510006
245200     COMPUTE PV-BOTTOM-ITEM                                       24520006
245300         = PC-ITEMS-PER-PANEL                                     24530006
245400         + PV-TOP-ITEM                                            24540006
245500         - 1.                                                     24550006
245600                                                                  24560006
245700     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) <         24570006
245800         PV-TOP-ITEM                                              24580006
245900     OR ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) >         24590006
246000         PV-BOTTOM-ITEM                                           24600006
246100             CONTINUE                                             24610006
246200     ELSE                                                         24620006
246300         COMPUTE PV-SUB                                           24630006
246400             = ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)    24640006
246500             - PV-TOP-ITEM                                        24650006
246600             + 1                                                  24660006
246700         MOVE SPACE TO MR-SELECTI (PV-SUB)                        24670006
246800     END-IF.                                                      24680006
246900/                                                                 24690006
247000*----------------------------------------------------------------*24700006
247100*    DESELECT THE PRINTED ITEM IN LQW.                           *24710006
247200*----------------------------------------------------------------*24720006
247300                                                                  24730006
247400 2920-DESELECT-ITEM-LQW.                                          24740006
247500                                                                  24750006
247600     IF PC140-CRA-SUCCESSFUL                                      24760006
247700         MOVE SPACE TO LQW-SELECTED-SW (LQW-IDX)                  24770006
247800                       LQW-TEMP-SELECTED-SW (LQW-IDX)             24780006
247900         SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.            24790006
248000                                                                  24800006
248100                                                                  24810006
248200*----------------------------------------------------------------*24820006
248300*    PRINT HEADER LABELS FOR SELECTED ITEMS IN THE LIST QUEUE.   *24830006
248400*----------------------------------------------------------------*24840006
248500                                                                  24850006
248600 2950-LABELS-LISTQ-HEADER.                                        24860006
248700                                                                  24870006
248800     IF PV-ITEM NOT = PV-SAVE-ITEM                                24880006
248900         IF PV-SAVE-ITEM NOT = ZERO                               24890006
249000             IF LQW-BLOCK-MODIFIED = 'Y'                          24900006
249100                 MOVE 'N' TO LQW-BLOCK-MODIFIED                   24910006
249200                 PERFORM 6111-WRITE-LIST-QUEUE                    24920006
249300             END-IF                                               24930006
249400         END-IF                                                   24940006
249500         MOVE PV-ITEM TO PV-SAVE-ITEM.                            24950006
249600                                                                  24960006
249700     PERFORM 6112-READ-LIST-QUEUE.                                24970006
249800                                                                  24980006
249900     IF PV-CICS-RESP = DFHRESP(NORMAL)                            24990006
250000         PERFORM                                                  25000006
250100         VARYING LQW-IDX                                          25010006
250200         FROM 1 BY 1                                              25020006
250300         UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                       25030006
250400         OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO                 25040006
250500                                                                  25050006
250600             IF LQW-SELECT (LQW-IDX)                              25060006
250700                 PERFORM 7050-SETUP-LABELS-HEADER                 25070006
250800                 PERFORM 2920-DESELECT-ITEM-LQW                   25080006
250900             END-IF                                               25090006
251000         END-PERFORM                                              25100006
251100     END-IF.                                                      25110006
251200/                                                                 25120006
251300*----------------------------------------------------------------*25130006
251400*    PRINT CARTON LABELS FOR SELECTED ITEMS IN THE LIST QUEUE.   *25140006
251500*----------------------------------------------------------------*25150006
251600                                                                  25160006
251700 2960-LABELS-LISTQ-CARTON.                                        25170006
251800                                                                  25180006
251900     IF PV-ITEM NOT = PV-SAVE-ITEM                                25190006
252000         IF PV-SAVE-ITEM NOT = ZERO                               25200006
252100             IF LQW-BLOCK-MODIFIED = 'Y'                          25210006
252200                 MOVE 'N' TO LQW-BLOCK-MODIFIED                   25220006
252300                 PERFORM 6111-WRITE-LIST-QUEUE                    25230006
252400             END-IF                                               25240006
252500         END-IF                                                   25250006
252600         MOVE PV-ITEM TO PV-SAVE-ITEM.                            25260006
252700                                                                  25270006
252800     PERFORM 6112-READ-LIST-QUEUE.                                25280006
252900                                                                  25290006
253000     IF PV-CICS-RESP = DFHRESP(NORMAL)                            25300006
253100         PERFORM                                                  25310006
253200         VARYING LQW-IDX                                          25320006
253300         FROM 1 BY 1                                              25330006
253400         UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                       25340006
253500         OR LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO                 25350006
253600                                                                  25360006
253700             IF LQW-SELECT (LQW-IDX)                              25370006
253800                 PERFORM 7060-SETUP-LABELS-CARTON                 25380006
253900                 PERFORM 2920-DESELECT-ITEM-LQW                   25390006
254000             END-IF                                               25400006
254100         END-PERFORM                                              25410006
254200     END-IF.                                                      25420006
254300                                                                  25430006
254400/                                                                 25440006
254500******************************************************************25450006
254600* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *25460006
254700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *25470006
254800******************************************************************25480006
254900 2300-GET-YARD-NEXT-RECORD.                                       25490006
255000                                                                  25500006
255100     ADD +1                        TO ASC-SEL-SUB.                25510006
255200     IF ASC-SEL-SUB > TR006-MAX-ITEMS                             25520006
255300         ADD +1                    TO ASC-SEL-ITEM                25530006
255400         MOVE +1                   TO ASC-SEL-SUB                 25540006
255500     END-IF.                                                      25550006
255600                                                                  25560006
255700     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                25570006
255800         PERFORM 9100-READ-SEL-QUEUE                              25580006
255900         IF TR006-ITEM (ASC-SEL-SUB) > ZERO                       25590006
256000             MOVE TR006-OWNER-SCAC-ID (ASC-SEL-SUB)               25600006
256100                                   TO ASC-KEY-OWNER-SCAC-ID       25610006
256200                                      DK-OWNER-SCAC-ID            25620006
256300             MOVE TR006-VEH-NBR (ASC-SEL-SUB)                     25630006
256400                                   TO ASC-KEY-VEH-NBR             25640006
256500                                      DK-VEH-NBR                  25650006
256600             MOVE TR006-TRIP-ID (ASC-SEL-SUB)                     25660006
256700                                   TO ASC-KEY-TRIP-ID             25670006
256800                                      DK-TRIP-ID                  25680006
256900             MOVE TR006-OPER-UNT-ID (ASC-SEL-SUB)                 25690006
257000                                   TO ASC-KEY-OPER-UNT-ID         25700006
257100             MOVE TR006-FCLTY-ID (ASC-SEL-SUB)                    25710006
257200                                   TO ASC-KEY-FCLTY-ID            25720006
257300             SET TR006-INQ (ASC-SEL-SUB)                          25730006
257400                                   TO TRUE                        25740006
257500             PERFORM 9200-REWRITE-LIST-QUEUE                      25750006
257600         ELSE                                                     25760006
257700             SUBTRACT +1 FROM ASC-SEL-SUB                         25770006
257800*            --- BOTTOM OF LIST ---                               25780006
257900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            25790006
258000             SET DP020-MSG-INFORMATIONAL                          25800006
258100                                   TO TRUE                        25810006
258200         END-IF                                                   25820006
258300     ELSE                                                         25830006
258400         SUBTRACT +1 FROM ASC-SEL-ITEM                            25840006
258500         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 25850006
258600         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            25860006
258700         SET DP020-MSG-INFORMATIONAL                              25870006
258800                                   TO TRUE                        25880006
258900     END-IF.                                                      25890006
259000                                                                  25900006
259100/                                                                 25910006
259200******************************************************************25920006
259300* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *25930006
259400* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *25940006
259500******************************************************************25950006
259600 2310-GET-YARD-PREV-RECORD.                                       25960006
259700                                                                  25970006
259800     SUBTRACT +1 FROM ASC-SEL-SUB.                                25980006
259900     IF  ASC-SEL-SUB < +1                                         25990006
260000         SUBTRACT +1 FROM ASC-SEL-ITEM                            26000006
260100         MOVE TR006-MAX-ITEMS      TO ASC-SEL-SUB                 26010006
260200     END-IF.                                                      26020006
260300                                                                  26030006
260400     IF ASC-SEL-ITEM > ZERO                                       26040006
260500         PERFORM 9100-READ-SEL-QUEUE                              26050006
260600         MOVE TR006-OWNER-SCAC-ID (ASC-SEL-SUB)                   26060006
260700                                   TO ASC-KEY-OWNER-SCAC-ID       26070006
260800         MOVE TR006-VEH-NBR (ASC-SEL-SUB)                         26080006
260900                                   TO ASC-KEY-VEH-NBR             26090006
261000         MOVE TR006-TRIP-ID (ASC-SEL-SUB)                         26100006
261100                                   TO ASC-KEY-TRIP-ID             26110006
261200                                      DK-TRIP-ID                  26120006
261300         MOVE TR006-OPER-UNT-ID (ASC-SEL-SUB)                     26130006
261400                                   TO ASC-KEY-OPER-UNT-ID         26140006
261500         MOVE TR006-FCLTY-ID (ASC-SEL-SUB)                        26150006
261600                                   TO ASC-KEY-FCLTY-ID            26160006
261700     ELSE                                                         26170006
261800         MOVE +1                   TO ASC-SEL-ITEM                26180006
261900                                      ASC-SEL-SUB                 26190006
262000*        --- TOP OF LIST ---                                      26200006
262100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            26210006
262200         SET DP020-MSG-INFORMATIONAL                              26220006
262300                                   TO TRUE                        26230006
262400     END-IF.                                                      26240006
262500                                                                  26250006
262600/                                                                 26260006
262700******************************************************************26270006
262800** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **26280006
262900** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **26290006
263000******************************************************************26300006
263100                                                                  26310006
263200 3000-EDIT-DATA-IN-COMMAREA.                                      26320006
263300                                                                  26330006
263400     SET PS-NO-ERROR               TO TRUE.                       26340006
263500     PERFORM 3200-RESET-ATTRIBUTES.                               26350006
263600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     26360006
263700**                                                                26370006
263800* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              26380006
263900* EDITTING IS DONE FROM THE BOTTOM UP.                            26390006
264000**                                                                26400006
264100     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       26410006
264200         ASC-ITEMS-DISPLAYED - 1.                                 26420006
264300                                                                  26430006
264400     PERFORM 3100-SET-SUBSCRIPTS.                                 26440006
264500     PERFORM 3300-EDIT-SELECTIONS                                 26450006
264600         VARYING PV-SUB                                           26460006
264700         FROM PV-SUB BY -1                                        26470006
264800         UNTIL PV-SUB < +1                                        26480006
264900                                                                  26490006
265000     IF  PS-NO-ERROR                                              26500006
265100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        26510006
265200     END-IF.                                                      26520006
265300                                                                  26530006
265400     IF ((PS-NO-ERROR)                                            26540006
265500     AND (ASC-START-OF-SELECTED-RANGE > ZERO)                     26550006
265600     AND (ASC-END-OF-SELECTED-RANGE > ZERO))                      26560006
265700         PERFORM 3500-MARK-RANGE-AS-SELECTED                      26570006
265800     END-IF.                                                      26580006
265900                                                                  26590006
266000     IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                    26600006
266100     OR DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                    26610006
266200         IF ASC-PRINTER-ID = SPACES                               26620006
266300             SET PS-ERROR            TO TRUE                      26630006
266400             SET DP020-MSG-FATAL     TO TRUE                      26640006
266500             MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER          26650006
266600             MOVE DP015-UNP-ALP-BRT-OFF TO APRINTRA               26660006
266700             MOVE DP015-RED          TO APRINTRC                  26670006
266800             MOVE DP015-REVERSE      TO APRINTRH                  26680006
266900             MOVE -1                 TO APRINTRL                  26690006
267000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  26700006
267100         ELSE                                                     26710006
267200             PERFORM 3245-EDIT-PRINTER-ID                         26720006
267300         END-IF                                                   26730006
267400     END-IF.                                                      26740006
267500                                                                  26750006
267600     IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                    26760006
267700         IF ASC-PRINTER-ID = SPACES                               26770006
267800             SET PS-ERROR            TO TRUE                      26780006
267900             SET DP020-MSG-FATAL     TO TRUE                      26790006
268000             MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER          26800006
268100             MOVE DP015-UNP-ALP-BRT-OFF TO APRINTRA               26810006
268200             MOVE DP015-RED          TO APRINTRC                  26820006
268300             MOVE DP015-REVERSE      TO APRINTRH                  26830006
268400             MOVE -1                 TO APRINTRL                  26840006
268500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  26850006
268600         ELSE                                                     26860006
268700             PERFORM 3280-VALIDATE-MANIFEST-PRINTER               26870006
268800         END-IF                                                   26880006
268900     END-IF.                                                      26890006
268901                                                                  26890118
268910     IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                    26891018
268920         PERFORM 8200-CHECK-RPAMSD                                26892018
268995     END-IF.                                                      26899518
269000                                                                  26900006
269100                                                                  26910006
269200*----------------------------------------------------------------*26920006
269300*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *26930006
269400*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*26940006
269500*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *26950006
269600*                                                                *26960006
269700*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *26970006
269800*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *26980006
269900*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *26990006
270000*    US IN THE 2ND BLOCK OF THE ARRAY.                           *27000006
270100*----------------------------------------------------------------*27010006
270200                                                                  27020006
270300 3100-SET-SUBSCRIPTS.                                             27030006
270400                                                                  27040006
270500     COMPUTE ASC-ITEM-SUB =                                       27050006
270600         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        27060006
270700                                                                  27070006
270800     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         27080006
270900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            27090006
271000                                                                  27100006
271100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               27110006
271200     ELSE                                                         27120006
271300         MOVE +1                     TO ASC-BLK-SUB               27130006
271400     END-IF.                                                      27140006
271500                                                                  27150006
271600                                                                  27160006
271700******************************************************************27170006
271800** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **27180006
271900******************************************************************27190006
272000                                                                  27200006
272100 3200-RESET-ATTRIBUTES.                                           27210006
272200                                                                  27220006
272300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA                    27230006
272400                                      APRINTRA.                   27240006
272500     MOVE DP015-UNP-NUM-NOR-OFF    TO ASPONBRA.                   27250006
272600     MOVE DP015-GREEN              TO ASTRTITC                    27260006
272700                                      ASPONBRC                    27270006
272800                                      APRINTRC.                   27280006
272900     MOVE DP015-UNDERLINE          TO ASTRTITH                    27290006
273000                                      ASPONBRH                    27300006
273100                                      APRINTRH.                   27310006
273200                                                                  27320006
273300     IF DP020-NEXT-ACT-RETURN                                     27330006
273400     OR DP020-NEXT-ACT-READ-MAP                                   27340006
273500        PERFORM                                                   27350006
273600            VARYING PV-SUB                                        27360006
273700            FROM 1 BY 1                                           27370006
273800            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    27380006
273900            MOVE DP015-UNP-ALP-NOR-OFF                            27390006
274000                                      TO MR-SELECTA (PV-SUB)      27400006
274100            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      27410006
274200            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      27420006
274300        END-PERFORM                                               27430006
274400     ELSE                                                         27440006
274500        PERFORM                                                   27450006
274600            VARYING PV-SUB                                        27460006
274700            FROM 1 BY 1                                           27470006
274800            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     27480006
274900            MOVE DP015-UNP-ALP-NOR-OFF                            27490006
275000                                      TO MR-SELECTA (PV-SUB)      27500006
275100            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      27510006
275200            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      27520006
275300        END-PERFORM                                               27530006
275400     END-IF.                                                      27540006
275500                                                                  27550006
275600/                                                                 27560006
275700*----------------------------------------------------------------*27570006
275800*    CHECK THE PRINTER NUMBER FOR NUMERIC                        *27580006
275900*----------------------------------------------------------------*27590006
276000                                                                  27600006
276100 3245-EDIT-PRINTER-ID.                                            27610006
276200                                                                  27620006
276300     MOVE ASC-PRINTER-ID         TO DP010I-UNEDITED-FIELD.        27630006
276400     MOVE LENGTH OF ASC-PRINTER-ID                                27640006
276500                                 TO DP010I-MAXIMUM-DIGITS.        27650006
276600     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      27660006
276700                                                                  27670006
276800     SET DP010I-NEGATIVE-NOT-ALLOWED                              27680006
276900                                 TO TRUE.                         27690006
277000                                                                  27700006
277110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             27711031
277120          USING DP010I-NUMERIC-EDIT-AREA.                         27712031
277200                                                                  27720006
277300     IF DP010I-ERROR-DETECTED                                     27730006
277400         SET PS-ERROR            TO TRUE                          27740006
277500         SET DP020-MSG-FATAL     TO TRUE                          27750006
277600         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              27760006
277700         MOVE DP015-UNP-ALP-BRT-OFF                               27770006
277800                                 TO APRINTRA                      27780006
277900         MOVE DP015-RED          TO APRINTRC                      27790006
278000         MOVE DP015-REVERSE      TO APRINTRH                      27800006
278100         MOVE -1                 TO APRINTRL                      27810006
278200         SET DP030-SET-CURSOR-APPL-1                              27820006
278300                                 TO TRUE                          27830006
278400     ELSE                                                         27840006
278500         MOVE DP010I-NUMERIC-FIELD                                27850006
278600                                 TO ASC-PRINTER-ID-N              27860006
278700         PERFORM 3270-VALIDATE-PRINTER-ID                         27870006
278800         PERFORM 3600-GET-DC-LOCATION                             27880006
278900     END-IF.                                                      27890006
279000/                                                                 27900006
279100*----------------------------------------------------------------*27910006
279200*   3270-VALIDATE-PRINTER-ID                                     *27920006
279300* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *27930006
279400*----------------------------------------------------------------*27940006
279500                                                                  27950006
279600 3270-VALIDATE-PRINTER-ID.                                        27960006
279700*  VALIDATE THE PRINTER ID BASED ON THE PHYSICAL LOCATION         27970006
279800*  OF THE TERMINAL.                                               27980006
279900                                                                  27990006
280000     MOVE ASC-PRINTER-ID             TO DP072-PRINTER-ID.         28000006
280100     MOVE PC-REPORT-PROGRAM-NAME     TO DP072-RPT-PGM-NME.        28010006
280200     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     28020006
280300     MOVE ASC-CURR-OPER-UNT-ID       TO DP072-ORIGIN-OPER-UNT-ID  28030006
280400                                        DP072-OPER-UNT-ID.        28040006
280500     MOVE ASC-CURR-FCLTY-ID          TO DP072-ORIGIN-FCLTY-ID     28050006
280600                                        DP072-FCLTY-ID.           28060006
280700                                                                  28070006
280800     SET DP072-VALIDATE              TO TRUE.                     28080006
280900                                                                  28090006
281000     EXEC CICS                                                    28100006
281100         LINK PROGRAM  (PC-DPKCS060)                              28110006
281200              COMMAREA (DP072-COMM-AREA)                          28120006
281300              RESP     (PV-CICS-RESP)                             28130006
281400     END-EXEC.                                                    28140006
281500                                                                  28150006
281600     EVALUATE TRUE                                                28160006
281700         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     28170006
281800             CONTINUE                                             28180006
281900         WHEN OTHER                                               28190006
282000               MOVE '3270-VALIDATE-PRINTER-ID'                    28200006
282100                                     TO DP013-PARAGRAPH           28210006
282200               MOVE PV-CICS-RESP                                  28220006
282300                    TO DP013-MESSAGE-TEXT(1)                      28230006
282400               MOVE SQLCA            TO DP013-SQLCA               28240006
282500               SET DP013-CICS-ABEND                               28250006
282600                   DP013-NO-ROLLBACK TO TRUE                      28260006
282700               PERFORM DP013-0000-PROCESS-ABEND                   28270006
282800     END-EVALUATE.                                                28280006
282900                                                                  28290006
283000     IF DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                      28300006
283100         CONTINUE                                                 28310006
283200     ELSE                                                         28320006
283300         MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER          28330006
283400         SET PS-ERROR                                             28340006
283500             DP020-MSG-FATAL                                      28350006
283600             DP030-SET-CURSOR-APPL-1 TO TRUE                      28360006
283700                                                                  28370006
283800         MOVE DP015-UNP-ALP-BRT-OFF  TO APRINTRA                  28380006
283900         MOVE DP015-RED              TO APRINTRC                  28390006
284000         MOVE DP015-REVERSE          TO APRINTRH                  28400006
284100         MOVE -1                     TO APRINTRL                  28410006
284200     END-IF.                                                      28420006
284300                                                                  28430006
284400/                                                                 28440006
284500                                                                  28450006
284600*----------------------------------------------------------------*28460006
284700*    VERIFY THE PRINTER ID USING THE PRINTER CONTROL ROUTINE     *28470006
284800*    (DPKCS060) WHEN PRINTING THE MANIFEST                       *28480006
284900*----------------------------------------------------------------*28490006
285000 3280-VALIDATE-MANIFEST-PRINTER.                                  28500006
285100                                                                  28510006
285200     MOVE ASC-PRINTER-ID             TO DP072-PRINTER-ID.         28520006
285300     MOVE 'RCKCS226'                 TO DP072-RPT-PGM-NME.        28530006
285400     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     28540006
285500                                                                  28550006
285600     MOVE DP020-LOCATION-NBR         TO PV-DP020-LOCATION.        28560006
285700     MOVE PV-LOCATION-N              TO DP072-OPER-UNT-ID         28570006
285800                                        DP072-ORIGIN-OPER-UNT-ID. 28580006
285900                                                                  28590006
286000     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     28600006
286100                                        DP072-FCLTY-ID.           28610006
286200                                                                  28620006
286300     SET DP072-VALIDATE              TO TRUE.                     28630006
286400                                                                  28640006
286500     EXEC CICS                                                    28650006
286600         LINK PROGRAM  (PC-DPKCS060)                              28660006
286700              COMMAREA (DP072-COMM-AREA)                          28670006
286800              RESP     (PV-CICS-RESP)                             28680006
286900     END-EXEC.                                                    28690006
287000                                                                  28700006
287100     EVALUATE TRUE                                                28710006
287200         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     28720006
287300             CONTINUE                                             28730006
287400         WHEN OTHER                                               28740006
287500               MOVE '3280-VALIDATE-MANIFEST-PRINTER'              28750006
287600                                     TO DP013-PARAGRAPH           28760006
287700               MOVE PV-CICS-RESP                                  28770006
287800                    TO DP013-MESSAGE-TEXT(1)                      28780006
287900               MOVE SQLCA            TO DP013-SQLCA               28790006
288000               SET DP013-CICS-ABEND                               28800006
288100                   DP013-NO-ROLLBACK TO TRUE                      28810006
288200               PERFORM DP013-0000-PROCESS-ABEND                   28820006
288300     END-EVALUATE.                                                28830006
288400                                                                  28840006
288500     IF  DP072-PRTR-PRTR-TRK-STAT-CDE = 'A'                       28850006
288600         MOVE DP072-PRTR-AUTO-CUTTER-IND                          28860006
288700                                     TO ASC-PRTR-AUTO-CUTTER-IND  28870006
288800         MOVE DP072-PRTR-PRTR-BRCDE-IND                           28880006
288900                                     TO ASC-PRTR-BARCODE-IND      28890006
289000         MOVE DP072-PRTR-PRTR-CNTL-IND                            28900006
289100                                     TO ASC-PRTR-PRTR-CNTL-IND    28910006
289200         MOVE DP072-PRTR-TRACK-NBR   TO ASC-PRTR-TRACK-NBR        28920006
289300     ELSE                                                         28930006
289400         MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER          28940006
289500         SET PS-ERROR                                             28950006
289600             DP020-MSG-FATAL                                      28960006
289700             DP030-SET-CURSOR-APPL-1 TO TRUE                      28970006
289800                                                                  28980006
289900         MOVE DP015-UNP-ALP-BRT-OFF  TO APRINTRA                  28990006
290000         MOVE DP015-RED              TO APRINTRC                  29000006
290100         MOVE DP015-REVERSE          TO APRINTRH                  29010006
290200         MOVE -1                     TO APRINTRL                  29020006
290300     END-IF.                                                      29030006
290400                                                                  29040006
290500/                                                                 29050006
290600******************************************************************29060006
290700** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **29070006
290800** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **29080006
290900** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **29090006
291000** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **29100006
291100******************************************************************29110006
291200 3300-EDIT-SELECTIONS.                                            29120006
291300                                                                  29130006
291400     EVALUATE TRUE                                                29140006
291500                                                                  29150006
291600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     29160006
291700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         29170006
291800                 CONTINUE                                         29180006
291900                                                                  29190006
292000         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         29200006
292100             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        29210006
292200                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   29220006
292300                 MOVE ASC-TEMP-SELECTED-SW                        29230006
292400                      (ASC-BLK-SUB ASC-ITEM-SUB) TO               29240006
292500                          ASC-SELECTED-SW                         29250006
292600                          (ASC-BLK-SUB ASC-ITEM-SUB)              29260006
292700             END-IF                                               29270006
292800                                                                  29280006
292900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     29290006
293000                 = SPACE                                          29300006
293100             EVALUATE TRUE                                        29310006
293200                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       29320006
293300                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS29330006
293400                     MOVE SPACE TO ASC-SELECTED-SW                29340006
293500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29350006
293600                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        29360006
293700                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    29370006
293800                     MOVE SPACE TO ASC-SELECTED-SW                29380006
293900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29390006
294000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          29400006
294100                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      29410006
294200                     MOVE SPACE TO ASC-SELECTED-SW                29420006
294300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29430006
294400             END-EVALUATE                                         29440006
294500                                                                  29450006
294600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           29460006
294700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29470006
294800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    29480006
294900             END-IF                                               29490006
295000             PERFORM 3310-EDIT-RANGE                              29500006
295100                                                                  29510006
295200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             29520006
295300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29530006
295400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    29540006
295500             END-IF                                               29550006
295600             PERFORM 3310-EDIT-RANGE                              29560006
295700                                                                  29570006
295800*        WHEN ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          29580006
295900*            IF DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)            29590006
296000*                MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER       29600006
296100*                SET DP020-MSG-FATAL    TO TRUE                   29610006
296200*                MOVE -1                TO MR-SELECTL (PV-SUB)    29620006
296300*                SET DP030-SET-CURSOR-APPL-1                      29630006
296400*                                       TO TRUE                   29640006
296500*                MOVE DP015-RED         TO MR-SELECTC (PV-SUB)    29650006
296600*                MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)    29660006
296700*                SET PS-ERROR TO TRUE                             29670006
296800*                IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)         29680006
296900*                    SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS 29690006
297000*                    MOVE SPACE         TO ASC-SELECTED-SW        29700006
297100*                        (ASC-BLK-SUB ASC-ITEM-SUB)               29710006
297200*                END-IF                                           29720006
297300*            END-IF                                               29730006
297400                                                                  29740006
297500         WHEN OTHER                                               29750006
297600             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           29760006
297700             SET DP020-MSG-FATAL    TO TRUE                       29770006
297800             MOVE -1                TO MR-SELECTL (PV-SUB)        29780006
297900             SET DP030-SET-CURSOR-APPL-1                          29790006
298000                                    TO TRUE                       29800006
298100             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        29810006
298200             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        29820006
298300             SET PS-ERROR TO TRUE                                 29830006
298400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            29840006
298500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     29850006
298600                 MOVE SPACE         TO ASC-SELECTED-SW            29860006
298700                                        (ASC-BLK-SUB ASC-ITEM-SUB)29870006
298800             END-IF                                               29880006
298900     END-EVALUATE.                                                29890006
299000                                                                  29900006
299100     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             29910006
299200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               29920006
299300                                                                  29930006
299400     IF ASC-ITEM-SUB < 1                                          29940006
299500         SUBTRACT +1 FROM ASC-BLK-SUB                             29950006
299600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                29960006
299700     END-IF.                                                      29970006
299800/                                                                 29980006
299900******************************************************************29990006
300000** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **30000006
300100** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **30010006
300200** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**30020006
300300** THE ENDING.                                                  **30030006
300400******************************************************************30040006
300500 3310-EDIT-RANGE.                                                 30050006
300600                                                                  30060006
300700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                30070006
300800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   30080006
300900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)30090006
301000                                   TO ASC-SELECTED-SW             30100006
301100                                        (ASC-BLK-SUB ASC-ITEM-SUB)30110006
301200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 30120006
301300         ELSE                                                     30130006
301400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     30140006
301500                 CONTINUE                                         30150006
301600             ELSE                                                 30160006
301700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        30170006
301800                 MOVE PC-TSYMSG-00054                             30180006
301900                                   TO DP020-MSG-NUMBER            30190006
302000                 SET DP020-MSG-FATAL                              30200006
302100                                   TO TRUE                        30210006
302200                 MOVE -1           TO MR-SELECTL (PV-SUB)         30220006
302300                 SET DP030-SET-CURSOR-APPL-1                      30230006
302400                                   TO TRUE                        30240006
302500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         30250006
302600                 MOVE DP015-UNDERLINE                             30260006
302700                                   TO MR-SELECTH (PV-SUB)         30270006
302800                 SET PS-ERROR      TO TRUE                        30280006
302900             END-IF                                               30290006
303000         END-IF                                                   30300006
303100     ELSE                                                         30310006
303200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     30320006
303300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 30330006
303400                                   TO ASC-SELECTED-SW             30340006
303500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   30350006
303600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   30360006
303700         ELSE                                                     30370006
303800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       30380006
303900                 CONTINUE                                         30390006
304000             ELSE                                                 30400006
304100*                -- ONLY ONE END-OF-RANGE ALLOWED --              30410006
304200                 MOVE PC-TSYMSG-00055                             30420006
304300                                   TO DP020-MSG-NUMBER            30430006
304400                 SET DP020-MSG-FATAL                              30440006
304500                                   TO TRUE                        30450006
304600                 MOVE -1           TO MR-SELECTL (PV-SUB)         30460006
304700                 SET DP030-SET-CURSOR-APPL-1                      30470006
304800                                   TO TRUE                        30480006
304900                 SET PS-ERROR      TO TRUE                        30490006
305000             END-IF                                               30500006
305100         END-IF                                                   30510006
305200     END-IF.                                                      30520006
305300/                                                                 30530006
305400******************************************************************30540006
305500** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **30550006
305600** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **30560006
305700******************************************************************30570006
305800 3400-CHECK-RANGE-SEQUENCE.                                       30580006
305900                                                                  30590006
306000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       30600006
306100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      30610006
306200       AND  ASC-START-OF-SELECTED-RANGE >                         30620006
306300                                         ASC-END-OF-SELECTED-RANGE30630006
306400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                30640006
306500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 30650006
306600         SET DP020-MSG-FATAL TO TRUE                              30660006
306700         SET PS-ERROR TO TRUE                                     30670006
306800         PERFORM 3410-POSITION-AT-ERROR                           30680006
306900     END-IF.                                                      30690006
307000                                                                  30700006
307100                                                                  30710006
307200******************************************************************30720006
307300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **30730006
307400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **30740006
307500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **30750006
307600******************************************************************30760006
307700 3410-POSITION-AT-ERROR.                                          30770006
307800                                                                  30780006
307900     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       30790006
308000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 30800006
308100                    - PV-TOP-ITEM + 1.                            30810006
308200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      30820006
308300         CONTINUE                                                 30830006
308400     ELSE                                                         30840006
308500         MOVE -1                   TO MR-SELECTL (PV-SUB)         30850006
308600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         30860006
308700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         30870006
308800     END-IF.                                                      30880006
308900                                                                  30890006
309000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   30900006
309100                    - PV-TOP-ITEM + 1.                            30910006
309200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      30920006
309300         CONTINUE                                                 30930006
309400     ELSE                                                         30940006
309500         MOVE -1                   TO MR-SELECTL (PV-SUB)         30950006
309600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         30960006
309700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         30970006
309800     END-IF.                                                      30980006
309900/                                                                 30990006
310000*----------------------------------------------------------------*31000006
310100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *31010006
310200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *31020006
310300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *31030006
310400*----------------------------------------------------------------*31040006
310500 3500-MARK-RANGE-AS-SELECTED.                                     31050006
310600                                                                  31060006
310700     MOVE +1                       TO  ASC-BLK-SUB.               31070006
310800     PERFORM 3510-MARK-SELECTED-INDS                              31080006
310900         VARYING ASC-ITEM-SUB                                     31090006
311000         FROM 1 BY 1                                              31100006
311100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 31110006
311200                                                                  31120006
311300     ADD +1                        TO ASC-BLK-SUB.                31130006
311400     PERFORM 3510-MARK-SELECTED-INDS                              31140006
311500         VARYING ASC-ITEM-SUB                                     31150006
311600         FROM 1 BY 1                                              31160006
311700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 31170006
311800                                                                  31180006
311900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               31190006
312000                                   TO  PV-LIST-ITEM-NUMBER.       31200006
312100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            31210006
312200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         31220006
312300               PC-ITEMS-PER-PANEL).                               31230006
312400                                                                  31240006
312500     MOVE ASC-START-OF-SELECTED-RANGE                             31250006
312600                                   TO PV-START-OF-SELECTED-RANGE. 31260006
312700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            31270006
312800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  31280006
312900               PC-ITEMS-PER-PANEL).                               31290006
313000                                                                  31300006
313100     MOVE ASC-END-OF-SELECTED-RANGE                               31310006
313200                                   TO  PV-END-OF-SELECTED-RANGE.  31320006
313300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             31330006
313400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    31340006
313500               PC-ITEMS-PER-PANEL).                               31350006
313600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             31360006
313700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             31370006
313800                                                                  31380006
313900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    31390006
314000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        31400006
314100         MOVE +1                   TO ASC-BLK-SUB                 31410006
314200         PERFORM 5100-WRITE-TEMP-STORAGE                          31420006
314300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         31430006
314400             PV-FIRST-BLOCK-IN-ARRAY - 1                          31440006
314500                                                                  31450006
314600         PERFORM                                                  31460006
314700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      31470006
314800                   PV-PREV-BLOCK-IN-ARRAY                         31480006
314900             MOVE PV-FIRST-BLOCK-IN-RANGE                         31490006
315000                                   TO PV-BLOCK-NUMBER             31500006
315100             PERFORM 4410-READ-TEMP-STORAGE                       31510006
315200             PERFORM 3510-MARK-SELECTED-INDS                      31520006
315300                 VARYING ASC-ITEM-SUB                             31530006
315400                 FROM 1 BY 1                                      31540006
315500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          31550006
315600             PERFORM 5100-WRITE-TEMP-STORAGE                      31560006
315700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     31570006
315800         END-PERFORM                                              31580006
315900                                                                  31590006
316000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         31600006
316100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     31610006
316200         PERFORM                                                  31620006
316300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       31630006
316400                   PV-LAST-BLOCK-IN-RANGE                         31640006
316500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          31650006
316600                                   TO PV-BLOCK-NUMBER             31660006
316700             PERFORM 4410-READ-TEMP-STORAGE                       31670006
316800             PERFORM 3510-MARK-SELECTED-INDS                      31680006
316900                 VARYING ASC-ITEM-SUB                             31690006
317000                 FROM 1 BY 1                                      31700006
317100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          31710006
317200             PERFORM 5100-WRITE-TEMP-STORAGE                      31720006
317300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      31730006
317400         END-PERFORM                                              31740006
317500                                                                  31750006
317600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             31760006
317700                                   TO PV-BLOCK-NUMBER             31770006
317800         PERFORM 4410-READ-TEMP-STORAGE                           31780006
317900     END-IF.                                                      31790006
318000                                                                  31800006
318100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 31810006
318200                                      ASC-END-OF-SELECTED-RANGE.  31820006
318300/                                                                 31830006
318400*----------------------------------------------------------------*31840006
318500* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *31850006
318600*----------------------------------------------------------------*31860006
318700                                                                  31870006
318800 3510-MARK-SELECTED-INDS.                                         31880006
318900                                                                  31890006
319000     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         31900006
319100                                ASC-ITEM-SUB) >                   31910006
319200         ASC-START-OF-SELECTED-RANGE)                             31920006
319300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         31930006
319400                                ASC-ITEM-SUB) =                   31940006
319500         ASC-START-OF-SELECTED-RANGE)                             31950006
319600                                                                  31960006
319700         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     31970006
319800                                    ASC-ITEM-SUB) <               31980006
319900             ASC-END-OF-SELECTED-RANGE)                           31990006
320000         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     32000006
320100                                    ASC-ITEM-SUB) =               32010006
320200             ASC-END-OF-SELECTED-RANGE)                           32020006
320300                                                                  32030006
320400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          32040006
320500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   32050006
320600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   32060006
320700                               TO TRUE                            32070006
320800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              32080006
320900                               TO TRUE                            32090006
321000                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    32100006
321100             END-IF                                               32110006
321200         END-IF                                                   32120006
321300     END-IF.                                                      32130006
321400*----------------------------------------------------------------*32140006
321500*                                                                *32150006
321600*----------------------------------------------------------------*32160006
321700 3600-GET-DC-LOCATION.                                            32170006
321800                                                                  32180006
321900     INITIALIZE XL071-COMMAREA-REC.                               32190006
322000     MOVE PC-OPER-UNT-ID               TO XL071-LOCATION-NUMBER.  32200006
322100                                                                  32210006
322200     CALL XL071-LOCATION-MODULE  USING  DFHEIBLK                  32220006
322300                                        XL071-COMMAREA            32230006
322400                                        XL071-COMMAREA-REC.       32240006
322500                                                                  32250006
322600     EVALUATE TRUE                                                32260006
322700         WHEN XL071-NO-ERRORS                                     32270006
322800         WHEN XL071-DC-ASGMT-NOT-FND                              32280006
322900           IF XL071-LOC-TYP-CDE = 'DC'                            32290006
323000              MOVE  XL071-LOC-5-ABBR-NM TO PV-DC-5-CHAR-ABBR      32300006
323100              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       32310006
323200              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 32320006
323300           ELSE                                                   32330006
323400              MOVE  PC-90   TO  PC140-CRA-DC-ID                   32340006
323500                                PC140-CRA-OPER-UNT-ID             32350006
323600           END-IF                                                 32360006
323700                                                                  32370006
323800         WHEN XL071-LOC-NOT-FOUND                                 32380006
323900              MOVE  PC-90   TO  PC140-CRA-DC-ID                   32390006
324000                                PC140-CRA-OPER-UNT-ID             32400006
324100                                                                  32410006
324200         WHEN OTHER                                               32420006
324300             MOVE '3600-GET-DC-LOCATION'                          32430006
324400                                   TO DP013-PARAGRAPH             32440006
324500             MOVE 'CALL TO XLKUT071'                              32450006
324600                                   TO DP013-MESSAGE-TEXT (1)      32460006
324700             MOVE XL071-SQLCODE-N  TO SQLCODE                     32470006
324800*            MOVE XL071-SQLCA      TO DP013-SQLCA                 32480006
324900             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (1)    32490006
325000             SET DP013-DB2-ABEND                                  32500006
325100                                   TO TRUE                        32510006
325200             SET DP013-XCTL-DISPLAY-RESTART                       32520006
325300                                   TO TRUE                        32530006
325400             PERFORM DP013-0000-PROCESS-ABEND                     32540006
325500     END-EVALUATE.                                                32550006
325600                                                                  32560006
325700/                                                                 32570006
325800*----------------------------------------------------------------*32580006
325900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *32590006
326000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *32600006
326100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *32610006
326200*    DISPLAY THE PANEL TO USER.                                  *32620006
326300*----------------------------------------------------------------*32630006
326400                                                                  32640006
326500 4000-BUILD-INITIAL-PANEL.                                        32650006
326600                                                                  32660006
326700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            32670006
326800                                 ASC-BLOCK-ENTRIES (2).           32680006
326900     MOVE +1                 TO ASC-BLK-SUB.                      32690006
327000     SET ASC-ITEMS-LEFT-ON-DB                                     32700006
327010         ASC-HAS-BULK-MULTI-SKU-NO                                32701021
327100                             TO TRUE.                             32710006
327200                                                                  32720006
327300     MOVE +0                 TO ASC-ITEM-SUB                      32730006
327400                                ASC-NUMBER-OF-ITEMS-READ          32740006
327500                                ASC-NUMBER-OF-SELECTED-ITEMS      32750006
327600                                ASC-HIGHEST-BLOCK-WRITTEN         32760006
327700                                ASC-START-OF-SELECTED-RANGE       32770006
327800                                ASC-END-OF-SELECTED-RANGE         32780006
327900                                ASC-ITEM-AT-TOP-OF-PANEL.         32790006
328000                                                                  32800006
328100     PERFORM 4060-OPEN-CURSOR.                                    32810006
328200                                                                  32820006
328300     SET ASC-TRLR-UNLOADED TO TRUE.                               32830006
328400                                                                  32840006
328500     PERFORM 4300-READ-ITEMS-FROM-TABLE.                          32850006
328600                                                                  32860006
328700     PERFORM 4070-CLOSE-CURSOR.                                   32870006
328800* EA 07/30/2010                                                   32880006
328900     PERFORM 4080-GET-WHSE-CTN.                                   32890006
329000     PERFORM 4090-GET-EXP-WHSE-CTN.                               32900006
329100* EA 07/30/2010                                                   32910006
329200                                                                  32920006
329300     MOVE +1                   TO  PV-TOP-ITEM.                   32930006
329400                                                                  32940006
329500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          32950006
329600* EA 07/30/2010                                                   32960006
329700*        MOVE 'A' TO DP020-NEXT-APPL-ACTIVITY                     32970006
329800*        SET DP020-MSG-FATAL   TO  TRUE                           32980006
329900*        MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               32990006
330000         IF PV-PRCSD-CARTONS > 0 OR                               33000006
330100            PV-EXP-PRCSD-CARTONS > 0                              33010006
330200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 33020006
330300         ELSE                                                     33030006
330400            MOVE 'A' TO DP020-NEXT-APPL-ACTIVITY                  33040006
330500            SET DP020-MSG-FATAL   TO  TRUE                        33050006
330600            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            33060006
330700         END-IF                                                   33070006
330800* EA 07/30/2010                                                   33080006
330900     ELSE                                                         33090006
331000         MOVE -1               TO MR-SELECTL (1)                  33100006
331100         SET DP030-SET-CURSOR-APPL-1                              33110006
331200                               TO TRUE                            33120006
331300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     33130006
331400     END-IF.                                                      33140006
331500                                                                  33150006
331600/                                                                 33160006
331700*----------------------------------------------------------------*33170006
331800* OPEN THE RECEIVER CURSOR.                                      *33180006
331900*----------------------------------------------------------------*33190006
332000                                                                  33200006
332100 4060-OPEN-CURSOR.                                                33210006
332200                                                                  33220006
332300     PERFORM                                                      33230006
332400         WITH TEST AFTER                                          33240006
332500         VARYING PV-RETRY-COUNTER                                 33250006
332600         FROM 1 BY 1                                              33260006
332700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33270006
332800            OR (SQLCODE = +0))                                    33280006
332900                                                                  33290006
333000         EXEC SQL                                                 33300006
333100              OPEN RECEIVER-CSR                                   33310006
333200         END-EXEC                                                 33320006
333300                                                                  33330006
333400         EVALUATE TRUE                                            33340006
333500             WHEN SQLCODE = +0                                    33350006
333600                  CONTINUE                                        33360006
333700             WHEN SQLCODE = -904                                  33370006
333800             WHEN SQLCODE = -913                                  33380006
333900                  CONTINUE                                        33390006
334000             WHEN SQLWARN0 NOT = SPACE                            33400006
334100             WHEN SQLCODE  NOT = +0                               33410006
334200                  MOVE '4060-OPEN-CURSOR'                         33420006
334300                                   TO DP013-PARAGRAPH             33430006
334400                  MOVE 'OPEN RECEIVER CURSOR'                     33440006
334500                                   TO DP013-MESSAGE-TEXT (1)      33450006
334600                  MOVE SQLCA       TO DP013-SQLCA                 33460006
334700                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    33470006
334800                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (2)    33480006
334900                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (3)    33490006
335000                  MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (4)    33500006
335100                  MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (5)    33510006
335200                  SET DP013-DB2-ABEND                             33520006
335300                                   TO TRUE                        33530006
335400                  PERFORM DP013-0000-PROCESS-ABEND                33540006
335500         END-EVALUATE                                             33550006
335600     END-PERFORM.                                                 33560006
335700                                                                  33570006
335800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    33580006
335900         SQLCODE NOT = +0                                         33590006
336000         MOVE '4060-OPEN-CURSOR' TO DP013-PARAGRAPH               33600006
336100         MOVE 'MAX RETRIES EXCEEDED FOR OPEN RECEIVER CURSOR'     33610006
336200                                   TO DP013-MESSAGE-TEXT (1)      33620006
336300         MOVE SQLCA                TO DP013-SQLCA                 33630006
336400         SET DP013-DB2-ABEND       TO TRUE                        33640006
336500         PERFORM DP013-0000-PROCESS-ABEND                         33650006
336600     END-IF.                                                      33660006
336700                                                                  33670006
336800/                                                                 33680006
336900*----------------------------------------------------------------*33690006
337000* CLOSE THE RECEIVER CURSOR.                                     *33700006
337100*----------------------------------------------------------------*33710006
337200                                                                  33720006
337300 4070-CLOSE-CURSOR.                                               33730006
337400                                                                  33740006
337500     PERFORM                                                      33750006
337600         WITH TEST AFTER                                          33760006
337700         VARYING PV-RETRY-COUNTER                                 33770006
337800         FROM 1 BY 1                                              33780006
337900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33790006
338000            OR (SQLCODE = +0))                                    33800006
338100                                                                  33810006
338200         EXEC SQL                                                 33820006
338300              CLOSE RECEIVER-CSR                                  33830006
338400         END-EXEC                                                 33840006
338500                                                                  33850006
338600         EVALUATE TRUE                                            33860006
338700             WHEN SQLCODE = +0                                    33870006
338800                  CONTINUE                                        33880006
338900             WHEN SQLCODE = -904                                  33890006
339000             WHEN SQLCODE = -913                                  33900006
339100                  CONTINUE                                        33910006
339200             WHEN SQLWARN0 NOT = SPACE                            33920006
339300             WHEN SQLCODE  NOT = +0                               33930006
339400                  MOVE '4070-CLOSE-CURSOR'                        33940006
339500                                   TO DP013-PARAGRAPH             33950006
339600                  MOVE 'CLOSE RECEIVER CURSOR'                    33960006
339700                                   TO DP013-MESSAGE-TEXT (1)      33970006
339800                  MOVE SQLCA       TO DP013-SQLCA                 33980006
339900                  MOVE 'TSHPTPO'   TO DP013-DB2-TABLE-NAME (1)    33990006
340000                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (2)    34000006
340100                  MOVE 'TVHTRIP'   TO DP013-DB2-TABLE-NAME (3)    34010006
340200                  MOVE 'TTRIPST'   TO DP013-DB2-TABLE-NAME (4)    34020006
340300                  MOVE 'TTRSTYP'   TO DP013-DB2-TABLE-NAME (5)    34030006
340400                  SET DP013-DB2-ABEND                             34040006
340500                                   TO TRUE                        34050006
340600                  PERFORM DP013-0000-PROCESS-ABEND                34060006
340700         END-EVALUATE                                             34070006
340800     END-PERFORM.                                                 34080006
340900                                                                  34090006
341000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    34100006
341100         SQLCODE NOT = +0                                         34110006
341200         MOVE '4070-CLOSE-CURSOR' TO DP013-PARAGRAPH              34120006
341300         MOVE 'MAX RETRIES EXCEEDED FOR CLOSE RECEIVER CURSOR'    34130006
341400                                   TO DP013-MESSAGE-TEXT (1)      34140006
341500         MOVE SQLCA                TO DP013-SQLCA                 34150006
341600         SET DP013-DB2-ABEND       TO TRUE                        34160006
341700         PERFORM DP013-0000-PROCESS-ABEND                         34170006
341800     END-IF.                                                      34180006
341900* EA  7/30/2010                                                   34190006
342000*----------------------------------------------------------------*34200006
342100* NEW PARAGRAPH TO COUNT THE ACTUAL WHSE CTN ON THE TRIP.        *34210006
342200*----------------------------------------------------------------*34220006
342300                                                                  34230006
342400 4080-GET-WHSE-CTN.                                               34240006
342500                                                                  34250006
342510     INITIALIZE PV-PRCSD-CARTONS.                                 34251006
342520                                                                  34252006
342530     EXEC SQL                                                     34253006
342540        SELECT  COUNT (DISTINCT(A.SHIPT_UNT_ID))                  34254006
342550        INTO    :PV-PRCSD-CARTONS                                 34255006
342560        FROM    SUT_OTBND_LOC  A,                                 34256006
342570                SUT_OTBND_CART B                                  34257006
342580        WHERE   A.INBD_TRIP_ID = :DK-TRIP-ID                      34258006
342591          AND   A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                   34259106
342592          AND   B.CART_SRC_CDE = 'RDM'                            34259206
342593          AND   A.SCN_CDE      = 'RECV'                           34259307
342594        WITH UR                                                   34259407
342595     END-EXEC.                                                    34259507
342596                                                                  34259607
342597                                                                  34259707
342598         EVALUATE TRUE                                            34259807
342599             WHEN SQLCODE = +0                                    34259907
342600                  MOVE PV-PRCSD-CARTONS TO ASC-WHSE-CTN           34260007
342601             WHEN SQLCODE = +100                                  34260107
342602                  MOVE 0     TO ASC-WHSE-CTN                      34260207
342603             WHEN OTHER                                           34260307
342604                 MOVE '4080-GET-WHSE-CTN'                         34260407
342605                                  TO DP013-PARAGRAPH              34260507
342606                 MOVE 'UNSUCCESSFUL SELECT ON OTBND TABLES'       34260607
342607                                  TO DP013-MESSAGE-TEXT (1)       34260707
342608                 MOVE SQLCA      TO DP013-SQLCA                   34260807
342609                 MOVE 'SUT_OTBND_LOC' TO DP013-DB2-TABLE-NAME (1) 34260907
342610                 MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (2)34261007
342611                  SET DP013-DB2-ABEND                             34261107
342612                      DP013-XCTL-DISPLAY-RESTART                  34261207
342613                                  TO TRUE                         34261307
342614                  PERFORM DP013-0000-PROCESS-ABEND                34261407
342615         END-EVALUATE.                                            34261507
342616                                                                  34261607
342617*----------------------------------------------------------------*34261707
342618* NEW PARAGRAPH TO COUNT THE EXPECTED WHSE CTN ON THE TRIP.      *34261807
342619*----------------------------------------------------------------*34261907
342620                                                                  34262007
342621 4090-GET-EXP-WHSE-CTN.                                           34262107
342630                                                                  34263006
342631     INITIALIZE PV-EXP-PRCSD-CARTONS.                             34263106
342632                                                                  34263206
342633     EXEC SQL                                                     34263306
342634        SELECT  COUNT (DISTINCT(A.SHIPT_UNT_ID))                  34263406
342635        INTO    :PV-EXP-PRCSD-CARTONS                             34263506
342636        FROM    SUT_TRLR_RPLN_CART A                              34263606
342637               ,SUT_OTBND_CART B                                  34263706
342638        WHERE   A.INBND_TRIP_ID > 0                               34263806
342639          AND   A.INBND_TRIP_ID = :DK-TRIP-ID                     34263906
342640          AND   A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                   34264006
342650          AND   B.CART_SRC_CDE = 'RDM'                            34265006
342651          AND   A.SCAC_CDE     = :DK-OWNER-SCAC-ID                34265107
342652          AND   A.VEH_NBR      = :DK-VEH-NBR                      34265207
342660        WITH UR                                                   34266006
342661     END-EXEC.                                                    34266106
342662                                                                  34266206
342663                                                                  34266306
342664         EVALUATE TRUE                                            34266406
342665             WHEN SQLCODE = +0                                    34266506
342666                  MOVE PV-EXP-PRCSD-CARTONS TO ASC-WHSE-EXP-CTN   34266606
342667             WHEN SQLCODE = +100                                  34266706
342668                  MOVE 0     TO ASC-WHSE-EXP-CTN                  34266806
342669             WHEN OTHER                                           34266906
342670                 MOVE '4090-GET-EXP-WHSE-CTN'                     34267006
342671                                  TO DP013-PARAGRAPH              34267106
342672                 MOVE 'UNSUCCESSFUL SELECT ON OTBND TABLES'       34267206
342673                                  TO DP013-MESSAGE-TEXT (1)       34267306
342674                 MOVE SQLCA       TO DP013-SQLCA                  34267406
342675                 MOVE 'SUT_TRLR_RPLN_CART'                        34267506
342676                                  TO DP013-DB2-TABLE-NAME (1)     34267606
342677                 MOVE 'SUT_OTBND_CART'                            34267706
342678                                  TO DP013-DB2-TABLE-NAME (2)     34267806
342679                  SET DP013-DB2-ABEND                             34267906
342680                      DP013-XCTL-DISPLAY-RESTART                  34268006
342681                                  TO TRUE                         34268106
342682                  PERFORM DP013-0000-PROCESS-ABEND                34268206
342683         END-EVALUATE.                                            34268306
342684                                                                  34268406
342685* EA 07/30/2010                                                   34268506
342686/                                                                 34268606
342687*----------------------------------------------------------------*34268706
342688*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *34268806
342689*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *34268906
342690*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *34269006
342700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *34270006
342800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *34280006
342900*                                                                *34290006
343000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *34300006
343100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *34310006
343200*    UPON INITIALIZATION.                                        *34320006
343300*----------------------------------------------------------------*34330006
343400                                                                  34340006
343500 4300-READ-ITEMS-FROM-TABLE.                                      34350006
343600                                                                  34360006
343700     PERFORM                                                      34370006
343800         VARYING PV-READ-COUNT                                    34380006
343900         FROM 1 BY 1                                              34390006
344000         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    34400006
344100            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         34410006
344200                                                                  34420006
344300         PERFORM 4310-FETCH                                       34430006
344400                                                                  34440006
344500         IF  ASC-ITEMS-LEFT-ON-DB                                 34450006
344600             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                34460006
344700                 ADD +1            TO ASC-ITEM-SUB                34470006
344800             ELSE                                                 34480006
344900                 ADD +1            TO ASC-BLK-SUB                 34490006
345000                 MOVE +1           TO ASC-ITEM-SUB                34500006
345100                                                                  34510006
345200                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         34520006
345300                     MOVE +1       TO ASC-BLK-SUB                 34530006
345400                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           34540006
345500                     PERFORM 5100-WRITE-TEMP-STORAGE              34550006
345600                     MOVE ASC-BLOCK-ENTRIES                       34560006
345700                               (PC-MAX-BLOCKS-IN-ARRAY)           34570006
345800                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 34580006
345900                     ADD +1        TO ASC-BLK-SUB                 34590006
346000                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   34600006
346100                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      34610006
346200                                   TO TRUE                        34620006
346300                 END-IF                                           34630006
346400             END-IF                                               34640006
346500             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    34650006
346600             MOVE ASC-NUMBER-OF-ITEMS-READ                        34660006
346700                                   TO ASC-LIST-ITEM-NUMBER        34670006
346800                                       (ASC-BLK-SUB ASC-ITEM-SUB) 34680006
346900             MOVE SHPTPO-PO-NBR    TO                             34690006
347000                            ASC-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 34700006
347100                            DK-ORD-NBR                            34710006
347200                            DK-PO-NBR                             34720006
347300             MOVE SHPTPO-REC-SEQ-NBR TO                           34730006
347400                       ASC-REC-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 34740006
347500                       DK-REC-SEQ-NBR                             34750006
347600             MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           34760006
347700             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              34770006
347800             INITIALIZE DCLTPURCHS                                34780006
347900                        DCLTRECEIV                                34790006
348000                        DCLTENTNME                                34800006
348100                        DCLTOPRSET                                34810006
348200                        DCLTTRBNTF                                34820006
348300             PERFORM 4360-GET-PO-INFO                             34830006
348400             IF  SQLCODE = +0                                     34840006
348500                 MOVE ENTNME-ENT-NAME-DESC  TO                    34850006
348600                      ASC-ENT-NAME-DESC (ASC-BLK-SUB ASC-ITEM-SUB)34860006
348700             ELSE                                                 34870006
348800                 MOVE SHPTPO-VEND-NAME      TO                    34880006
348900                      ASC-ENT-NAME-DESC (ASC-BLK-SUB ASC-ITEM-SUB)34890006
349000             END-IF                                               34900006
349100                                                                  34910006
349200             MOVE PURCHS-SEASET-SHRT-NM     TO                    34920006
349300                      ASC-SEA-NAME-DESC (ASC-BLK-SUB ASC-ITEM-SUB)34930006
349400                                                                  34940006
349500             PERFORM 4395-GET-SHIPMENT-INFO                       34950006
349600             IF  SQLCODE = -811                                   34960006
349700                 MOVE 'M' TO ASC-MULT-IND                         34970006
349800                              (ASC-BLK-SUB ASC-ITEM-SUB)          34980006
349900             END-IF                                               34990006
350000             PERFORM 4370-GET-RECEIVER-INFO                       35000006
350100             IF  ASC-AUTO-VE-SW  NOT = 'Y'         AND            35010006
350200                 RECEIV-STATUS-CDE = 'IP' OR 'CM'                 35020006
350300                 PERFORM 2350-CALL-AUTOVE-MODULE                  35030006
350400                 IF RC040-AUTO-VE-YES                             35040006
350500                     SET ASC-AUTO-VE            TO TRUE           35050006
350600                 END-IF                                           35060006
350700             END-IF                                               35070006
350800                                                                  35080006
350900             MOVE RECEIV-PKGNG-CDE          TO                    35090006
351000                      ASC-PKGNG-CDE     (ASC-BLK-SUB ASC-ITEM-SUB)35100006
351100             IF  RECEIV-REC-TYP-CDE = 'EX'                        35110006
351200                 MOVE 'EXPENSE RECEIPT' TO ASC-OPER-SET-DESC      35120006
351300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 35130006
351400             ELSE                                                 35140006
351500                 PERFORM 4380-GET-OPER-SET-DESC                   35150006
351600                 MOVE OPRSET-OPER-SET-DESC TO                     35160006
351700                     ASC-OPER-SET-DESC (ASC-BLK-SUB ASC-ITEM-SUB) 35170006
351800             END-IF                                               35180006
351900*----------------------------------------------------------------*35190006
352000*    NEED TO FIND OUT WHAT KIND OF TROUBLE EXISTS IF ANY FOR     *35200006
352100*    EACH PO/RECEIVER. IF THERE IS ANY UNRESOLVED TROUBLE, OTHER *35210006
352200*    THAN STORAGE TROUBLE (997,998,999), THE PO NBR AND THE RCVR *35220006
352300*    SEQ NBR WILL BE HILIGHTED. IF THERE IS CURRENTLY UNRESOLVED *35230006
352400*    (RESOLVED IND ='N' OR 'I') STORAGE TROUBLE A 'Y' WILL BE    *35240006
352500*    DISPLAYED IN THE STORAGE TROUBLE FIELD ON THE SCREEN. IF NO *35250006
352600*    UNRESOLVED STOR. TRBL BUT THERE IS RESOLVED (RESOLVED IND = *35260006
352700*    'R' OR 'A'), A 'P' WILL BE DISPLAYED ON  THE SCREEN. IF     *35270006
352800*    THERE IS NO STOR.TRBL OF ANY KIND, THE FIELD WILL BE BLANK. *35280006
352900*----------------------------------------------------------------*35290006
353000             PERFORM 4372-CHK4-TROUBLE                            35300006
353100             INITIALIZE PV-DB2-COUNT                              35310006
353200             MOVE RECEIV-OPER-UNT-ID TO PV-OPER-UNT-ID            35320006
353300             MOVE PV-OPER-UNT-ID-X                                35330006
353400                                     TO DK-STORE-NMBR             35340006
353500             PERFORM 4365-CHECK-DIRECT-STORE                      35350006
353600             IF  XL071-LOC-TYP-CDE = 'DS'                         35360006
353700                 STRING PV-OPER-UNT-ID-X      DELIMITED BY SIZE   35370006
353800                        ' - '                 DELIMITED BY SIZE   35380006
353900                        'DIR. STORE'          DELIMITED BY SIZE   35390006
354000                                      INTO ASC-OPER-SET-DESC      35400006
354100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 35410006
354200             END-IF                                               35420006
354300             MOVE SHPTPO-EXPTED-CART-CNT TO                       35430006
354400                       ASC-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB)     35440006
354500* MGG        IF  SHPTPO-EXPTED-CART-CNT NOT = SHPTPO-ACTL-CART-CNT35450006
354600                 MOVE PV-TRECEIV-ACTL-CART-CNT TO                 35460006
354700                       ASC-ACTL-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB)35470006
354800* MGG        ELSE                                                 35480006
354900* MGG            MOVE ZEROES               TO                     35490006
355000* MGG                  ASC-ACTL-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB)35500006
355100* MGG        END-IF                                               35510006
355200             MOVE SHPTPO-DMG-CART-CNT TO                          35520006
355300                       ASC-DMG-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB) 35530006
355400             MOVE PV-DB2-REC-DATE  TO PV-DB2-DATE                 35540006
355500*            MOVE TRIPST-STATUS-DTE TO PV-DB2-DATE                35550006
355600             STRING PV-DB2-DATE-MM                                35560006
355700                    PV-DB2-DATE-DD                                35570006
355800                    PV-DB2-DATE-YY DELIMITED BY SIZE              35580006
355900                                 INTO ASC-ARRIVAL-DTE             35590006
356000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35600006
356100             MOVE   PV-DB2-DATE-CC TO ASC-ARRIVAL-DTE-CC          35610006
356200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35620006
356300             MOVE RECEIV-PACK-BY-ST-IND TO                        35630006
356400                  ASC-PACK-BY-ST-IND (ASC-BLK-SUB ASC-ITEM-SUB)   35640006
356500             MOVE RECEIV-AD-INFO-DESC TO                          35650006
356600                  ASC-AD-INFO (ASC-BLK-SUB ASC-ITEM-SUB)          35660006
356700             MOVE RECEIV-PRE-TKT-IND TO                           35670006
356800                  ASC-PRE-TKT-IND (ASC-BLK-SUB ASC-ITEM-SUB)      35680006
356900             MOVE RECEIV-GOH-IND TO                               35690006
357000                  ASC-GOH-IND (ASC-BLK-SUB ASC-ITEM-SUB)          35700006
357100             MOVE RECEIV-RCVG-CLERK-INIT-ID TO                    35710006
357200                  ASC-REC-CLK (ASC-BLK-SUB ASC-ITEM-SUB)          35720006
357300             IF  ASC-REC-CLK (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES  35730006
357400                 SET ASC-TRLR-NOT-UNLOADED                        35740006
357500                                      TO TRUE                     35750006
357600             END-IF                                               35760006
357700             MOVE ASC-KEY-OPER-UNT-ID TO DK-OPER-UNT-ID           35770006
357800             MOVE ASC-KEY-FCLTY-ID    TO DK-FCLTY-ID              35780006
357900             MOVE PURCHS-DEPT-NBR     TO DK-DEPT-NBR              35790006
358000*                                                                 35800006
358100             MOVE SPACES              TO ASC-TKT-TYP              35810006
358200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 35820006
358300             PERFORM 4320-GET-AD-DATE                             35830006
358400             IF  SQLCODE = -305                                   35840006
358500                 MOVE SPACES               TO ASC-AD-DATE         35850006
358600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35860006
358700             ELSE                                                 35870006
358800                 IF  DN-AD-EVNT-DTE = -1                          35880006
358900                     MOVE SPACES           TO ASC-AD-DATE         35890006
359000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35900006
359100                 ELSE                                             35910006
359200                     MOVE PURITM-AD-EVNT-DTE TO PV-DB2-DATE       35920006
359300                     STRING PV-DB2-DATE-MM                        35930006
359400                            PV-DB2-DATE-DD                        35940006
359500                            PV-DB2-DATE-YY DELIMITED BY SIZE      35950006
359600                                         INTO ASC-AD-DATE         35960006
359700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  35970006
359800                 END-IF                                           35980006
359900             END-IF                                               35990006
360000             MOVE PURCHS-DEPT-NBR TO ASC-DEPT                     36000006
360100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36010006
360200             PERFORM 4390-GET-ITM-NBR                             36020006
360300                                                                  36030006
360400             INITIALIZE XL001-ITEM-COMMAREA                       36040006
360500                                                                  36050006
360600             IF PS-ITM-NBR-FOUND                                  36060006
360700                 PERFORM 4391-CALL-XLKUT001                       36070006
360800             END-IF                                               36080006
360900             IF XL001-SUCCESSFUL                                  36090006
361000                 MOVE XL001-SUB-CL-NBR-2CH                        36100006
361100                                  TO ASC-CLASS                    36110006
361200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36120006
361300             ELSE                                                 36130006
361400                 MOVE SPACE       TO ASC-CLASS                    36140006
361500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36150006
361600             END-IF                                               36160006
361700                                                                  36170006
361800             PERFORM 4330-GET-SPECIAL-INSTR                       36180006
361900             IF  SQLCODE = +0                                     36190006
362000                 MOVE INSTCD-INSTR-DESC(1:25)                     36200006
362100                                           TO ASC-PO-INSTR        36210006
362200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   36220006
362300             END-IF                                               36230006
362400             MOVE SHPTPO-PKSL-IND TO                              36240006
362500                       ASC-DETAIL-CHECK (ASC-BLK-SUB ASC-ITEM-SUB)36250006
362600             MOVE SHIPMT-SHIPT-ID TO                              36260006
362700                       ASC-SHIPT-ID (ASC-BLK-SUB ASC-ITEM-SUB)    36270006
362800             MOVE RECEIV-OPER-UNT-ID TO                           36280006
362900                       ASC-OPER-UNT-ID (ASC-BLK-SUB ASC-ITEM-SUB) 36290006
363000             MOVE RECEIV-FCLTY-ID    TO                           36300006
363100                       ASC-FCLTY-ID (ASC-BLK-SUB ASC-ITEM-SUB)    36310006
363200             MOVE VHTRIP-TRIP-ID     TO ASC-KEY-TRIP-ID           36320006
363201                                                                  36320121
363210* - DMH 4/27/2021 BEGIN                                           36321021
363211* IF A BULK RECEIVER CHECK IF CARTONS HAVE MULTIPLE SKU'S IN THEM 36321121
363212* IF MULTIPLE SKU'S IN CARTON THEN MUST BE PBS ORDER              36321221
363213             IF  RECEIV-PKGNG-CDE = 'B'                           36321321
363214                 PERFORM 4335-CHECK-BULK-SINGLE-SKU               36321421
363215                 IF  PV-BULK-MULT-SKU   >  1                      36321521
363216                     SET  ASC-BULK-MULT-SKU-YES                   36321623
363218                         (ASC-BLK-SUB ASC-ITEM-SUB)               36321821
363219                         TO  TRUE                                 36321921
363220                     SET  ASC-HAS-BULK-MULTI-SKU-YES              36322021
363222                         TO  TRUE                                 36322221
363223                 ELSE                                             36322321
363224                     SET  ASC-BULK-MULT-SKU-NO                    36322421
363225                         (ASC-BLK-SUB ASC-ITEM-SUB)               36322521
363226                         TO  TRUE                                 36322621
363227                 END-IF                                           36322723
363228             ELSE                                                 36322823
363229                 MOVE SPACE  TO  ASC-BULK-MULT-SKU-SW             36322923
363230                         (ASC-BLK-SUB ASC-ITEM-SUB)               36323023
363231             END-IF                                               36323123
363232* - DMH 4/27/2021 END                                             36323223
363240                                                                  36324021
363300         END-IF                                                   36330006
363400     END-PERFORM.                                                 36340006
363500                                                                  36350006
363600     MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID.              36360006
363700     MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR.                    36370006
363800     MOVE ASC-KEY-TRIP-ID       TO DK-TRIP-ID.                    36380006
363900                                                                  36390006
364000     PERFORM 4350-SUM1-RECEIPTS.                                  36400006
364100                                                                  36410006
364200     IF  PV-INDNULL1 NOT < ZERO                                   36420006
364300         MOVE PV-TOTAL-CTN-CNT TO ATLRTOTO                        36430006
364400                                  ASC-TOTAL-CTN-CNT               36440006
364500     ELSE                                                         36450006
364600         MOVE ZERO             TO ATLRTOTO                        36460006
364700                                  ASC-TOTAL-CTN-CNT               36470006
364800     END-IF.                                                      36480006
364900                                                                  36490006
365000     IF  PV-INDNULL3 NOT < ZERO                                   36500006
365100         MOVE PV-TOTAL-DMG-CTN-CNT                                36510006
365200                               TO ADMGTOTO                        36520006
365300                                  ASC-TOTAL-DMG-CTN-CNT           36530006
365400     ELSE                                                         36540006
365500         MOVE ZERO             TO ADMGTOTO                        36550006
365600                                  ASC-TOTAL-DMG-CTN-CNT           36560006
365700     END-IF.                                                      36570006
365800                                                                  36580006
365900     PERFORM 4350-SUM2-RECEIPTS.                                  36590006
366000                                                                  36600006
366100     IF  PV-INDNULL2 NOT < ZERO                                   36610006
366200         MOVE PV-TOTAL-ACTL-CTN-CNT                               36620006
366300                               TO AADJTOTO                        36630006
366400                                  ASC-TOTAL-ACTL-CTN-CNT          36640006
366500     ELSE                                                         36650006
366600         MOVE ZERO             TO AADJTOTO                        36660006
366700                                  ASC-TOTAL-ACTL-CTN-CNT          36670006
366800     END-IF.                                                      36680006
366900                                                                  36690006
367000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          36700006
367100         MOVE +1               TO ASC-BLK-SUB                     36710006
367200         PERFORM 5100-WRITE-TEMP-STORAGE                          36720006
367300         ADD +1                TO ASC-BLK-SUB                     36730006
367400         PERFORM 5100-WRITE-TEMP-STORAGE                          36740006
367500                                                                  36750006
367600         MOVE 1                TO ASC-BLK-SUB                     36760006
367700                                  PV-BLOCK-NUMBER                 36770006
367800         PERFORM 4410-READ-TEMP-STORAGE                           36780006
367900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             36790006
368000             MOVE 2            TO ASC-BLK-SUB                     36800006
368100                                  PV-BLOCK-NUMBER                 36810006
368200             PERFORM 4410-READ-TEMP-STORAGE                       36820006
368300         END-IF                                                   36830006
368400     END-IF.                                                      36840006
368500/                                                                 36850006
368600*----------------------------------------------------------------*36860006
368700*    FETCH THE RECEIVER NUMBER CURSOR.                           *36870006
368800*----------------------------------------------------------------*36880006
368900                                                                  36890006
369000 4310-FETCH.                                                      36900006
369100                                                                  36910006
369200                                                                  36920006
369300     EXEC SQL                                                     36930006
369400          FETCH RECEIVER-CSR                                      36940006
369500          INTO                                                    36950006
369600                :SHPTPO-PO-NBR                                    36960006
369700              , :SHPTPO-REC-SEQ-NBR                               36970006
369800              , :SHPTPO-EXPTED-CART-CNT                           36980006
369900              , :PV-TRECEIV-ACTL-CART-CNT                         36990006
370000              , :SHPTPO-DMG-CART-CNT                              37000006
370100              , :SHPTPO-PKSL-IND                                  37010006
370200              , :SHPTPO-VEND-NAME                                 37020006
370300              , :SHIPMT-SHIPT-ID                                  37030006
370400              , :SHIPMT-LAST-UPD-DTE                              37040006
370500              , :SHIPMT-LAST-UPD-TME                              37050006
370600              , :VHTRIP-OWNER-SCAC-ID                             37060006
370700              , :VHTRIP-VEH-NBR                                   37070006
370800              , :VHTRIP-TRIP-ID                                   37080006
370900              , :PV-DB2-REC-DATE                                  37090006
371000              , :RECEIV-CRE-TMST                                  37100006
371100     END-EXEC.                                                    37110006
371200                                                                  37120006
371300                                                                  37130006
371400     EVALUATE TRUE                                                37140006
371500         WHEN SQLCODE = ZERO                                      37150006
371600              CONTINUE                                            37160006
371700         WHEN SQLCODE = +100                                      37170006
371800              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 37180006
371900         WHEN SQLWARN0 NOT EQUAL SPACE                            37190006
372000         WHEN SQLCODE NOT EQUAL ZERO                              37200006
372100              MOVE '4310-FETCH-CURSOR'                            37210006
372200                               TO DP013-PARAGRAPH                 37220006
372300              MOVE 'FETCH REC SEQ CURSOR'                         37230006
372400                               TO DP013-MESSAGE-TEXT (1)          37240006
372500              MOVE SQLCA       TO DP013-SQLCA                     37250006
372600              SET DP013-DB2-ABEND                                 37260006
372700                               TO TRUE                            37270006
372800              PERFORM DP013-0000-PROCESS-ABEND                    37280006
372900     END-EVALUATE.                                                37290006
373000                                                                  37300006
373100/                                                                 37310006
373200*----------------------------------------------------------------*37320006
373300*    GET THE EARLIEST AD DATE                                    *37330006
373400*----------------------------------------------------------------*37340006
373500 4320-GET-AD-DATE.                                                37350006
373600                                                                  37360006
373700     PERFORM                                                      37370006
373800         WITH TEST AFTER                                          37380006
373900         VARYING PV-RETRY-COUNTER                                 37390006
374000         FROM 1 BY 1                                              37400006
374100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37410006
374200             OR (SQLCODE = +0)                                    37420006
374300             OR (SQLCODE = -305))                                 37430006
374400                                                                  37440006
374500         EXEC SQL                                                 37450006
374600              SELECT MIN(AD_EVNT_DTE)                             37460006
374700                INTO :PURITM-AD-EVNT-DTE                          37470006
374800                       :DN-AD-EVNT-DTE                            37480006
374900                FROM TPURITM                                      37490006
375000               WHERE PO_NBR         = :DK-PO-NBR                  37500006
375100                 AND VER_STATUS_CDE = 'A'                         37510006
375200                 AND AD_EVNT_DTE > '0001-01-01'                   37520006
375210                WITH UR                                           37521008
375300         END-EXEC                                                 37530006
375400                                                                  37540006
375500         EVALUATE TRUE                                            37550006
375600             WHEN SQLCODE = +0                                    37560006
375700             WHEN SQLCODE = -305                                  37570006
375800             WHEN SQLCODE = -904                                  37580006
375900             WHEN SQLCODE = -913                                  37590006
376000                  CONTINUE                                        37600006
376100                                                                  37610006
376200             WHEN SQLWARN0 NOT = SPACES                           37620006
376300             WHEN SQLCODE < +0                                    37630006
376400             WHEN SQLCODE > +0                                    37640006
376500                  MOVE '4320-GET-AD-DATE'                         37650006
376600                                  TO DP013-PARAGRAPH              37660006
376700                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           37670006
376800                                  TO DP013-MESSAGE-TEXT (1)       37680006
376900                  MOVE SQLCA      TO DP013-SQLCA                  37690006
377000                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     37700006
377100                  SET DP013-DB2-ABEND                             37710006
377200                      DP013-XCTL-DISPLAY-RESTART                  37720006
377300                                  TO TRUE                         37730006
377400                  PERFORM DP013-0000-PROCESS-ABEND                37740006
377500         END-EVALUATE                                             37750006
377600     END-PERFORM.                                                 37760006
377700                                                                  37770006
377800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    37780006
377900         SQLCODE NOT = +0                                         37790006
378000         MOVE '4320-GET-AD-DATE'                                  37800006
378100                                  TO DP013-PARAGRAPH              37810006
378200         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            37820006
378300                                  TO DP013-MESSAGE-TEXT (1)       37830006
378400         MOVE SQLCA               TO DP013-SQLCA                  37840006
378500         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     37850006
378600         SET DP013-DB2-ABEND                                      37860006
378700             DP013-XCTL-DISPLAY-RESTART                           37870006
378800                                  TO TRUE                         37880006
378900         PERFORM DP013-0000-PROCESS-ABEND                         37890006
379000     END-IF.                                                      37900006
379100                                                                  37910006
379200/                                                                 37920006
379300*----------------------------------------------------------------*37930006
379400*    GET SPECIAL INSTRUCTION FOR PO                              *37940006
379500*----------------------------------------------------------------*37950006
379600 4330-GET-SPECIAL-INSTR.                                          37960006
379700                                                                  37970006
379800     PERFORM                                                      37980006
379900         WITH TEST AFTER                                          37990006
380000         VARYING PV-RETRY-COUNTER                                 38000006
380100         FROM 1 BY 1                                              38010006
380200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38020006
380300            OR (SQLCODE = +0)                                     38030006
380400            OR (SQLCODE = -811)                                   38040008
380500            OR (SQLCODE = +100))                                  38050008
380600                                                                  38060006
380700         EXEC SQL                                                 38070006
380800            SELECT  B.INSTR_DESC                                  38080006
380900              INTO :INSTCD-INSTR-DESC                             38090006
381000              FROM  TPOINST A                                     38100006
381100                   ,TINSTCD B                                     38110006
381200          WHERE A.PO_NBR    = :DK-PO-NBR                          38120006
381300            AND A.RECIP_CDE = 'DC'                                38130006
381400            AND A.INSTR_NBR = B.INSTR_NBR                         38140006
381401          FETCH FIRST 1 ROW ONLY                                  38140109
381410           WITH UR                                                38141008
381500         END-EXEC                                                 38150006
381600                                                                  38160006
381700         EVALUATE TRUE                                            38170006
381800             WHEN SQLCODE = +0                                    38180006
381900             WHEN SQLCODE = +100                                  38190006
382000             WHEN SQLCODE = -811                                  38200006
382100             WHEN SQLCODE = -904                                  38210006
382200             WHEN SQLCODE = -913                                  38220006
382300                 CONTINUE                                         38230006
382400                                                                  38240006
382500             WHEN SQLWARN0 NOT = SPACE                            38250006
382600             WHEN SQLCODE < +0                                    38260006
382700             WHEN SQLCODE > +0                                    38270006
382800                 MOVE '4330-GET-SPECIAL-INSTR'                    38280006
382900                                 TO DP013-PARAGRAPH               38290006
383000                 MOVE 'SELECT ON TPOINST'                         38300006
383100                                 TO DP013-MESSAGE-TEXT (1)        38310006
383200                 MOVE SQLCA      TO DP013-SQLCA                   38320006
383300                 MOVE 'TPOINST'  TO DP013-DB2-TABLE-NAME (1)      38330006
383400                 MOVE 'TINSTCD'  TO DP013-DB2-TABLE-NAME (2)      38340006
383500                 SET DP013-DB2-ABEND                              38350006
383600                                 TO TRUE                          38360006
383700                 SET DP013-XCTL-DISPLAY-RESTART                   38370006
383800                                 TO TRUE                          38380006
383900                 PERFORM DP013-0000-PROCESS-ABEND                 38390006
384000         END-EVALUATE                                             38400006
384100     END-PERFORM.                                                 38410006
384200                                                                  38420006
384300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38430006
384400         SQLCODE NOT = +0                                         38440006
384500         MOVE '4330-GET-SPECIAL-INSTR'                            38450006
384600                                 TO DP013-PARAGRAPH               38460006
384700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38470006
384800                                 TO DP013-MESSAGE-TEXT (1)        38480006
384900         MOVE 'SPECIAL INSTRUCTIONS FOR PO'                       38490006
385000                                 TO DP013-MESSAGE-TEXT (2)        38500006
385100         MOVE SQLCA              TO DP013-SQLCA                   38510006
385200         MOVE 'TPOINST'          TO DP013-DB2-TABLE-NAME (1)      38520006
385300         MOVE 'TINSTCD'          TO DP013-DB2-TABLE-NAME (2)      38530006
385400         SET DP013-DB2-ABEND     TO TRUE                          38540006
385500         SET DP013-XCTL-DISPLAY-RESTART                           38550006
385600                                 TO TRUE                          38560006
385700         PERFORM DP013-0000-PROCESS-ABEND                         38570006
385800     END-IF.                                                      38580006
385900                                                                  38590006
385910*----------------------------------------------------------------*38591021
385920* CHECK BULK RECEIVER HAS ONLY SINGLE SKU CARTONS                *38592021
385930*----------------------------------------------------------------*38593021
385940 4335-CHECK-BULK-SINGLE-SKU.                                      38594021
385950                                                                  38595021
385951     MOVE  ZEROES  TO  PV-BULK-MULT-SKU.                          38595121
385952                                                                  38595221
385960     PERFORM                                                      38596021
385970         WITH TEST AFTER                                          38597021
385980         VARYING PV-RETRY-COUNTER                                 38598021
385990         FROM 1 BY 1                                              38599021
385991         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38599121
385992            OR (SQLCODE = +0)                                     38599221
385993            OR (SQLCODE = -811)                                   38599321
385994            OR (SQLCODE = +100))                                  38599421
385995                                                                  38599521
385996         EXEC SQL                                                 38599621
385997              SELECT D.SHIPT_UNT_ID                               38599721
385998                   , COUNT(DISTINCT(D.TRN_LNE_NBR))               38599821
385999                INTO :SHUUPC-SHIPT-UNT-ID                         38599921
386000                   , :PV-BULK-MULT-SKU                            38600021
386001                FROM TRECEIV A                                    38600121
386002                   , TPKSLIP B                                    38600221
386003                   , TINPKSU C                                    38600321
386004                   , TSHUUPC D                                    38600421
386005               WHERE A.ORD_NBR       = :DK-ORD-NBR                38600524
386006                 AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR            38600624
386007                 AND A.PKGNG_CDE     = 'B'                        38600721
386008                 AND A.ORD_NBR       =  B.PO_NBR                  38600821
386009                 AND A.REC_SEQ_NBR   =  B.REC_SEQ_NBR             38600921
386010                 AND B.PO_NBR        =  C.PO_NBR                  38601021
386011                 AND B.SEQ_NBR       =  C.SEQ_NBR                 38601121
386012                 AND C.SHIPT_UNT_ID  =  D.SHIPT_UNT_ID            38601221
386013               GROUP BY D.SHIPT_UNT_ID                            38601321
386014               HAVING COUNT(DISTINCT(D.TRN_LNE_NBR)) > 1          38601421
386015               FETCH FIRST 1 ROW ONLY                             38601521
386024           WITH UR                                                38602421
386025         END-EXEC                                                 38602521
386026                                                                  38602621
386027         EVALUATE TRUE                                            38602721
386028             WHEN SQLCODE = +0                                    38602821
386029             WHEN SQLCODE = +100                                  38602921
386030             WHEN SQLCODE = -811                                  38603021
386031             WHEN SQLCODE = -904                                  38603121
386032             WHEN SQLCODE = -913                                  38603221
386033                 CONTINUE                                         38603321
386034                                                                  38603421
386035             WHEN SQLWARN0 NOT = SPACE                            38603521
386036             WHEN SQLCODE < +0                                    38603621
386037             WHEN SQLCODE > +0                                    38603721
386038                 MOVE '4335-CHECK-BULK-SINGLE-SKU'                38603821
386039                                 TO DP013-PARAGRAPH               38603921
386040                 MOVE 'CHECK BULK FOR SINGLE SKU CARTONS'         38604021
386041                                 TO DP013-MESSAGE-TEXT (1)        38604121
386042                 MOVE SQLCA      TO DP013-SQLCA                   38604221
386043                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      38604321
386044                 MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME (2)      38604421
386045                 MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME (3)      38604521
386046                 MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME (4)      38604621
386047                 SET DP013-DB2-ABEND                              38604721
386048                                 TO TRUE                          38604821
386049                 SET DP013-XCTL-DISPLAY-RESTART                   38604921
386050                                 TO TRUE                          38605021
386051                 PERFORM DP013-0000-PROCESS-ABEND                 38605121
386052         END-EVALUATE                                             38605221
386053     END-PERFORM.                                                 38605321
386054                                                                  38605421
386055     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    38605521
386056         SQLCODE NOT = +0                                         38605621
386057         MOVE '4335-CHECK-BULK-SINGLE-SKU'                        38605721
386058                                 TO DP013-PARAGRAPH               38605821
386059         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38605921
386060                                 TO DP013-MESSAGE-TEXT (1)        38606021
386061         MOVE 'CHECK BULK FOR SINGLE SKU CARTONS'                 38606121
386062                                 TO DP013-MESSAGE-TEXT (2)        38606221
386063         MOVE SQLCA              TO DP013-SQLCA                   38606321
386064         MOVE 'TRECEIV'          TO DP013-DB2-TABLE-NAME (1)      38606421
386065         MOVE 'TPKSLIP'          TO DP013-DB2-TABLE-NAME (2)      38606521
386066         MOVE 'TINPKSU'          TO DP013-DB2-TABLE-NAME (2)      38606621
386067         MOVE 'TSHUUPC'          TO DP013-DB2-TABLE-NAME (2)      38606721
386068         SET DP013-DB2-ABEND     TO TRUE                          38606821
386069         SET DP013-XCTL-DISPLAY-RESTART                           38606921
386070                                 TO TRUE                          38607021
386071         PERFORM DP013-0000-PROCESS-ABEND                         38607121
386072     END-IF.                                                      38607221
386073                                                                  38607321
386080/                                                                 38608021
386100*----------------------------------------------------------------*38610006
386200*    RETRIEVE TICKET FORMAT                                      *38620006
386300*----------------------------------------------------------------*38630006
386400*                                                                 38640006
386500                                                                  38650006
386600                                                                  38660006
386700/                                                                 38670006
386800******************************************************************38680006
386900*  SUM CARTON COUNT FOR TRAILER WITHIN SEARCH PO NUMBER.         *38690006
387000******************************************************************38700006
387100                                                                  38710006
387200 4350-SUM1-RECEIPTS.                                              38720006
387300                                                                  38730006
387400     PERFORM                                                      38740006
387500         WITH TEST AFTER                                          38750006
387600         VARYING PV-SQL-SUB                                       38760006
387700         FROM 1 BY 1                                              38770006
387800         UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        38780006
387900         OR SQLCODE = ZERO                                        38790006
388000                                                                  38800006
388100         EXEC SQL                                                 38810006
388200             SELECT SUM(A.EXPTED_CART_CNT)                        38820006
388300                   ,SUM(A.DMG_CART_CNT)                           38830006
388400                INTO :PV-TOTAL-CTN-CNT                            38840006
388500                       :PV-INDNULL1                               38850006
388600                    ,:PV-TOTAL-DMG-CTN-CNT                        38860006
388700                       :PV-INDNULL3                               38870006
388800                FROM TSHPTPO A                                    38880006
388900                    ,TSHIPMT B                                    38890006
389000                    ,TVHTRIP C                                    38900006
389100               WHERE C.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID          38910006
389200                 AND C.VEH_NBR       = :DK-VEH-NBR                38920006
389300                 AND C.VEH_NBR IS NOT NULL                        38930006
389400                 AND C.TRIP_ID       = :DK-TRIP-ID                38940006
389500                 AND A.SHIPT_ID      = B.SHIPT_ID                 38950006
389600                 AND A.REC_SEQ_NBR   > :PC-ZERO                   38960006
389700                 AND B.TRIP_ID       = C.TRIP_ID                  38970006
389710                WITH UR                                           38971008
389800         END-EXEC                                                 38980006
389900                                                                  38990006
390000         EVALUATE TRUE                                            39000006
390100             WHEN SQLCODE = ZERO                                  39010006
390200                 CONTINUE                                         39020006
390300             WHEN SQLWARN0 NOT = SPACES                           39030006
390400             WHEN SQLCODE NOT = ZERO                              39040006
390500                 MOVE '4350-SUM1-RECEIPTS' TO DP013-PARAGRAPH     39050006
390600                 MOVE 'BAD SQLCODE FROM SUM' TO                   39060006
390700                     DP013-MESSAGE-TEXT (1)                       39070006
390800                 MOVE SQLCA TO DP013-SQLCA                        39080006
390900                 SET DP013-DB2-ABEND TO TRUE                      39090006
391000                 PERFORM DP013-0000-PROCESS-ABEND                 39100006
391100         END-EVALUATE                                             39110006
391200     END-PERFORM.                                                 39120006
391300                                                                  39130006
391400     IF PV-SQL-SUB > PC-MAX-RETRIES AND                           39140006
391500         SQLCODE NOT = +0                                         39150006
391600         MOVE '4350-SUM1-RECEIPTS' TO DP013-PARAGRAPH             39160006
391700         MOVE 'MAX RETRIES EXCEEDED FOR SUM' TO                   39170006
391800             DP013-MESSAGE-TEXT (1)                               39180006
391900         MOVE SQLCA TO DP013-SQLCA                                39190006
392000         SET DP013-DB2-ABEND TO TRUE                              39200006
392100         PERFORM DP013-0000-PROCESS-ABEND                         39210006
392200     END-IF.                                                      39220006
392300                                                                  39230006
392400/                                                                 39240006
392500 4350-SUM2-RECEIPTS.                                              39250006
392600                                                                  39260006
392700     PERFORM                                                      39270006
392800         WITH TEST AFTER                                          39280006
392900         VARYING PV-SQL-SUB                                       39290006
393000         FROM 1 BY 1                                              39300006
393100         UNTIL PV-SQL-SUB > PC-MAX-RETRIES                        39310006
393200         OR SQLCODE = ZERO                                        39320006
393300                                                                  39330006
393400* MGG DEL    SELECT SUM(A.ACTL_CART_CNT)                          39340006
393500* MGG ADD    SELECT SUM(F.ACTL_CART_CNT)                          39350006
393600* MGG ADD           ,TRECEIV F                                    39360006
393700* MGG ADD       AND A.PO_NBR          = F.ORD_NBR                 39370006
393800* MGG ADD       AND A.REC_SEQ_NBR     = F.REC_SEQ_NBR             39380006
393900* MGG ADD       AND F.VER_STATUS_CDE  = 'A'                       39390006
394000         EXEC SQL                                                 39400006
394100             SELECT SUM(F.ACTL_CART_CNT)                          39410006
394200                INTO :PV-TOTAL-ACTL-CTN-CNT                       39420006
394300                       :PV-INDNULL2                               39430006
394400                FROM TSHPTPO A                                    39440006
394500                    ,TSHIPMT B                                    39450006
394600                    ,TVHTRIP C                                    39460006
394700                    ,TRECEIV F                                    39470006
394800               WHERE C.OWNER_SCAC_ID = :DK-OWNER-SCAC-ID          39480006
394900                 AND C.VEH_NBR       = :DK-VEH-NBR                39490006
395000                 AND C.VEH_NBR IS NOT NULL                        39500006
395100                 AND C.TRIP_ID       = :DK-TRIP-ID                39510006
395200*                AND F.EXPTED_CART_CNT ^= F.ACTL_CART_CNT         39520006
395300*                AND A.EXPTED_CART_CNT ^= A.ACTL_CART_CNT         39530006
395400                 AND A.SHIPT_ID = B.SHIPT_ID                      39540006
395500                 AND B.TRIP_ID  = C.TRIP_ID                       39550006
395600                AND A.PO_NBR          = F.ORD_NBR                 39560006
395700                AND A.REC_SEQ_NBR     = F.REC_SEQ_NBR             39570006
395800                AND F.VER_STATUS_CDE  = 'A'                       39580006
395810               WITH UR                                            39581008
395900         END-EXEC                                                 39590006
396000                                                                  39600006
396100         EVALUATE TRUE                                            39610006
396200             WHEN SQLCODE = ZERO                                  39620006
396300                 CONTINUE                                         39630006
396400             WHEN SQLWARN0 NOT = SPACES                           39640006
396500             WHEN SQLCODE NOT = ZERO                              39650006
396600                 MOVE '4350-SUM2-RECEIPTS' TO DP013-PARAGRAPH     39660006
396700                 MOVE 'BAD SQLCODE FROM SUM' TO                   39670006
396800                     DP013-MESSAGE-TEXT (1)                       39680006
396900                 MOVE SQLCA TO DP013-SQLCA                        39690006
397000                 SET DP013-DB2-ABEND TO TRUE                      39700006
397100                 PERFORM DP013-0000-PROCESS-ABEND                 39710006
397200         END-EVALUATE                                             39720006
397300     END-PERFORM.                                                 39730006
397400                                                                  39740006
397500     IF PV-SQL-SUB > PC-MAX-RETRIES AND                           39750006
397600         SQLCODE NOT = +0                                         39760006
397700         MOVE '4350-SUM2-RECEIPTS' TO DP013-PARAGRAPH             39770006
397800         MOVE 'MAX RETRIES EXCEEDED FOR SUM' TO                   39780006
397900             DP013-MESSAGE-TEXT (1)                               39790006
398000         MOVE SQLCA TO DP013-SQLCA                                39800006
398100         SET DP013-DB2-ABEND TO TRUE                              39810006
398200         PERFORM DP013-0000-PROCESS-ABEND                         39820006
398300     END-IF.                                                      39830006
398400                                                                  39840006
398500/                                                                 39850006
398600*----------------------------------------------------------------*39860006
398700*    GET PURCHASE ORDER INFO                                     *39870006
398800*----------------------------------------------------------------*39880006
398900 4360-GET-PO-INFO.                                                39890006
399000                                                                  39900006
399100     PERFORM                                                      39910006
399200         WITH TEST AFTER                                          39920006
399300         VARYING PV-RETRY-COUNTER                                 39930006
399400         FROM 1 BY 1                                              39940006
399500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               39950006
399600            OR (SQLCODE = +0)                                     39960006
399700            OR (SQLCODE = +100))                                  39970006
399800                                                                  39980006
399900         EXEC SQL                                                 39990006
400000            SELECT  A.DEPT_NBR                                    40000006
400100***                ,A.PKGNG_CDE                                   40010006
400200                   ,A.SEASET_SHRT_NM                              40020006
400300                   ,B.ENT_NAME_DESC                               40030006
400400              INTO :PURCHS-DEPT-NBR                               40040006
400500***               ,:PURCHS-PKGNG-CDE                              40050006
400600                  ,:PURCHS-SEASET-SHRT-NM                         40060006
400700                  ,:ENTNME-ENT-NAME-DESC                          40070006
400800              FROM  TPURCHS A                                     40080006
400900                   ,TENTNME B                                     40090006
401000          WHERE A.PO_NBR         = :DK-PO-NBR                     40100006
401100            AND A.VER_STATUS_CDE = 'A'                            40110006
401200            AND B.TYPE_CDE       = '01'                           40120006
401300            AND A.ENT_ID = B.ENT_ID                               40130006
401310           WITH UR                                                40131008
401400         END-EXEC                                                 40140006
401500                                                                  40150006
401600         EVALUATE TRUE                                            40160006
401700             WHEN SQLCODE = +0                                    40170006
401800             WHEN SQLCODE = +100                                  40180006
401900             WHEN SQLCODE = -904                                  40190006
402000             WHEN SQLCODE = -913                                  40200006
402100                 CONTINUE                                         40210006
402200                                                                  40220006
402300             WHEN SQLWARN0 NOT = SPACE                            40230006
402400             WHEN SQLCODE < +0                                    40240006
402500             WHEN SQLCODE > +0                                    40250006
402600                 MOVE '4360-GET-PO-INFO'                          40260006
402700                                 TO DP013-PARAGRAPH               40270006
402800                 MOVE 'SELECT ON TPURCHS'                         40280006
402900                                 TO DP013-MESSAGE-TEXT (1)        40290006
403000                 MOVE SQLCA      TO DP013-SQLCA                   40300006
403100                 MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)      40310006
403200                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (2)      40320006
403300                 SET DP013-DB2-ABEND                              40330006
403400                                 TO TRUE                          40340006
403500                 SET DP013-XCTL-DISPLAY-RESTART                   40350006
403600                                 TO TRUE                          40360006
403700                 PERFORM DP013-0000-PROCESS-ABEND                 40370006
403800         END-EVALUATE                                             40380006
403900     END-PERFORM.                                                 40390006
404000                                                                  40400006
404100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    40410006
404200         SQLCODE NOT = +0                                         40420006
404300         MOVE '4360-GET-PO-INFO'                                  40430006
404400                                 TO DP013-PARAGRAPH               40440006
404500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     40450006
404600                                 TO DP013-MESSAGE-TEXT (1)        40460006
404700         MOVE 'PURCHASE ORDER INFO'                               40470006
404800                                 TO DP013-MESSAGE-TEXT (2)        40480006
404900         MOVE SQLCA              TO DP013-SQLCA                   40490006
405000         MOVE 'TPURCHS'          TO DP013-DB2-TABLE-NAME (1)      40500006
405100         MOVE 'TENTNME'          TO DP013-DB2-TABLE-NAME (2)      40510006
405200         SET DP013-DB2-ABEND     TO TRUE                          40520006
405300         SET DP013-XCTL-DISPLAY-RESTART                           40530006
405400                                 TO TRUE                          40540006
405500         PERFORM DP013-0000-PROCESS-ABEND                         40550006
405600     END-IF.                                                      40560006
405700                                                                  40570006
405800/                                                                 40580006
405900*----------------------------------------------------------------*40590006
406000*     CHECK TO SEE IF OPERATING UNIT IS A STORE                  *40600006
406100*----------------------------------------------------------------*40610006
406200 4365-CHECK-DIRECT-STORE.                                         40620006
406300                                                                  40630006
406400     INITIALIZE XL071-COMMAREA-REC.                               40640006
406500     MOVE DK-STORE-NMBR  TO XL071-LOCATION-NUMBER.                40650006
406600                                                                  40660006
406700     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    40670006
406800                                XL071-COMMAREA                    40680006
406900                                XL071-COMMAREA-REC.               40690006
407000                                                                  40700006
407100     EVALUATE TRUE                                                40710006
407200         WHEN XL071-NO-ERRORS                                     40720006
407300         WHEN XL071-LOC-NOT-FOUND                                 40730006
407400         WHEN XL071-DC-ASGMT-NOT-FND                              40740006
407500         WHEN XL071-SQLCODE-N = -904                              40750006
407600         WHEN XL071-SQLCODE-N = -913                              40760006
407700             CONTINUE                                             40770006
407800                                                                  40780006
407900         WHEN OTHER                                               40790006
408000              MOVE '4365-CHECK-DIRECT-STORE'                      40800006
408100                                TO DP013-PARAGRAPH                40810006
408200              MOVE 'CALL TO XLKUT071'                             40820006
408300                                TO DP013-MESSAGE-TEXT (1)         40830006
408400              MOVE XL071-SQLCA  TO DP013-SQLCA                    40840006
408500              MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)       40850006
408600              SET DP013-DB2-ABEND                                 40860006
408700                                TO TRUE                           40870006
408800              SET DP013-XCTL-DISPLAY-RESTART                      40880006
408900                                TO TRUE                           40890006
409000              PERFORM DP013-0000-PROCESS-ABEND                    40900006
409100     END-EVALUATE.                                                40910006
409200                                                                  40920006
409300/                                                                 40930006
409400*----------------------------------------------------------------*40940006
409500*    GET RECEIVER INFO                                           *40950006
409600*----------------------------------------------------------------*40960006
409700 4370-GET-RECEIVER-INFO.                                          40970006
409800                                                                  40980006
409900     PERFORM                                                      40990006
410000         WITH TEST AFTER                                          41000006
410100         VARYING PV-RETRY-COUNTER                                 41010006
410200         FROM 1 BY 1                                              41020006
410300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41030006
410400            OR (SQLCODE = +0)                                     41040006
410500            OR (SQLCODE = +100))                                  41050006
410600                                                                  41060006
410700         EXEC SQL                                                 41070006
410800            SELECT  PRE_TKT_IND                                   41080006
410900                   ,AD_INFO_DESC                                  41090006
411000                   ,PACK_BY_ST_IND                                41100006
411100                   ,REC_TYP_CDE                                   41110006
411200                   ,RCVG_CLERK_INIT_ID                            41120006
411300                   ,OPER_UNT_ID                                   41130006
411400                   ,FCLTY_ID                                      41140006
411500                   ,GOH_IND                                       41150006
411600                   ,PKGNG_CDE                                     41160006
411700                   ,STATUS_CDE                                    41170006
411800              INTO :RECEIV-PRE-TKT-IND                            41180006
411900                  ,:RECEIV-AD-INFO-DESC                           41190006
412000                  ,:RECEIV-PACK-BY-ST-IND                         41200006
412100                  ,:RECEIV-REC-TYP-CDE                            41210006
412200                  ,:RECEIV-RCVG-CLERK-INIT-ID                     41220006
412300                  ,:RECEIV-OPER-UNT-ID                            41230006
412400                  ,:RECEIV-FCLTY-ID                               41240006
412500                  ,:RECEIV-GOH-IND                                41250006
412600                  ,:RECEIV-PKGNG-CDE                              41260006
412700                  ,:RECEIV-STATUS-CDE                             41270006
412800              FROM  TRECEIV                                       41280006
412900***       WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                  41290006
413000          WHERE FCLTY_ID       = :DK-FCLTY-ID                     41300006
413100            AND ORD_NBR        = :DK-ORD-NBR                      41310006
413200            AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  41320006
413300            AND VER_STATUS_CDE = 'A'                              41330006
413310           WITH UR                                                41331008
413400         END-EXEC                                                 41340006
413500                                                                  41350006
413600         EVALUATE TRUE                                            41360006
413700             WHEN SQLCODE = +0                                    41370006
413800             WHEN SQLCODE = +100                                  41380006
413900             WHEN SQLCODE = -904                                  41390006
414000             WHEN SQLCODE = -913                                  41400006
414100                 CONTINUE                                         41410006
414200                                                                  41420006
414300             WHEN SQLWARN0 NOT = SPACE                            41430006
414400             WHEN SQLCODE < +0                                    41440006
414500             WHEN SQLCODE > +0                                    41450006
414600                 MOVE '4370-GET-RECEIVER-INFO'                    41460006
414700                                 TO DP013-PARAGRAPH               41470006
414800                 MOVE 'SELECT ON TRECEIV'                         41480006
414900                                 TO DP013-MESSAGE-TEXT (1)        41490006
415000                 MOVE SQLCA      TO DP013-SQLCA                   41500006
415100                 MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)      41510006
415200                 SET DP013-DB2-ABEND                              41520006
415300                                 TO TRUE                          41530006
415400                 SET DP013-XCTL-DISPLAY-RESTART                   41540006
415500                                 TO TRUE                          41550006
415600                 PERFORM DP013-0000-PROCESS-ABEND                 41560006
415700         END-EVALUATE                                             41570006
415800     END-PERFORM.                                                 41580006
415900                                                                  41590006
416000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    41600006
416100         SQLCODE NOT = +0                                         41610006
416200         MOVE '4370-GET-RECEIVER-INFO'                            41620006
416300                                 TO DP013-PARAGRAPH               41630006
416400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     41640006
416500                                 TO DP013-MESSAGE-TEXT (1)        41650006
416600         MOVE 'RECEIVER INFO     '                                41660006
416700                                 TO DP013-MESSAGE-TEXT (2)        41670006
416800         MOVE SQLCA              TO DP013-SQLCA                   41680006
416900         MOVE 'TRECEIV'          TO DP013-DB2-TABLE-NAME (1)      41690006
417000         SET DP013-DB2-ABEND     TO TRUE                          41700006
417100         SET DP013-XCTL-DISPLAY-RESTART                           41710006
417200                                 TO TRUE                          41720006
417300         PERFORM DP013-0000-PROCESS-ABEND                         41730006
417400     END-IF.                                                      41740006
417500                                                                  41750006
417600*----------------------------------------------------------------*41760006
417700*     CHECK TO SEE IF ANY TROUBLE EXISTS                         *41770006
417800*----------------------------------------------------------------*41780006
417900 4372-CHK4-TROUBLE.                                               41790006
418000     INITIALIZE PV-DB2-COUNT.                                     41800006
418100     SET PS-NO-STOR-TRBL                                          41810006
418200         PS-NO-OTHER-TRBL  TO TRUE.                               41820006
418300*** FIRST CHECK FOR ANY TROUBLE THAT IS NOT STORAGE TROUBLE       41830006
418400     PERFORM 4375-CHK4-OTHER-TROUBLE.                             41840006
418500     IF PV-DB2-COUNT = ZERO                                       41850006
418600         SET PS-NO-OTHER-TRBL                                     41860006
418700             ASC-NO-OTHER-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)         41870006
418800                                 TO TRUE                          41880006
418900     ELSE                                                         41890006
419000         SET PS-OTHER-TRBL                                        41900006
419100             ASC-OTHER-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)            41910006
419200                                 TO TRUE                          41920006
419300     END-IF.                                                      41930006
419400                                                                  41940006
419500*** SECOND CHECK FOR ANY UNRESOLVED STORAGE TROUBLE               41950006
419600     INITIALIZE PV-DB2-COUNT                                      41960006
419700     PERFORM 4376-CHK4-UNRSLVD-STOR-TRBL.                         41970006
419800     IF PV-DB2-COUNT = ZERO                                       41980006
419900         SET PS-NO-STOR-TRBL                                      41990006
420000             ASC-NO-STOR-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)          42000006
420100                                 TO TRUE                          42010006
420200     ELSE                                                         42020006
420300         SET PS-CURR-STOR-TRBL                                    42030006
420400             ASC-CURR-STOR-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)        42040006
420500                                 TO TRUE                          42050006
420600     END-IF.                                                      42060006
420700                                                                  42070006
420800*** THIRD CHECK FOR ANY RESOLVED STORAGE TROUBLE                  42080006
420900*** ONLY DO THIS CHECK IF NO UNRESOLVED TROUBLE WAS FOUND         42090006
421000     IF PS-NO-STOR-TRBL                                           42100006
421100       INITIALIZE PV-DB2-COUNT                                    42110006
421200       PERFORM 4377-CHK4-RSLVD-STOR-TRBL                          42120006
421300       IF PV-DB2-COUNT = ZERO                                     42130006
421400           SET PS-NO-STOR-TRBL                                    42140006
421500            ASC-NO-STOR-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)           42150006
421600                               TO TRUE                            42160006
421700       ELSE                                                       42170006
421800           SET PS-PREV-STOR-TRBL                                  42180006
421900            ASC-PREV-STOR-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)         42190006
422000                               TO TRUE                            42200006
422100       END-IF                                                     42210006
422200     END-IF.                                                      42220006
422300                                                                  42230006
422400*** SET UP STORAGE INDICATOR                                      42240006
422500     IF PS-NO-STOR-TRBL                                           42250006
422600         MOVE SPACES TO                                           42260006
422700                ASC-STOR-IND (ASC-BLK-SUB ASC-ITEM-SUB)           42270006
422800     END-IF.                                                      42280006
422900                                                                  42290006
423000     IF PS-CURR-STOR-TRBL                                         42300006
423100         MOVE PC-Y   TO                                           42310006
423200                ASC-STOR-IND (ASC-BLK-SUB ASC-ITEM-SUB)           42320006
423300     END-IF.                                                      42330006
423400                                                                  42340006
423500     IF PS-PREV-STOR-TRBL                                         42350006
423600         MOVE PC-P   TO                                           42360006
423700                ASC-STOR-IND (ASC-BLK-SUB ASC-ITEM-SUB)           42370006
423800     END-IF.                                                      42380006
423900                                                                  42390006
424000 4375-CHK4-OTHER-TROUBLE.                                         42400006
424100     PERFORM                                                      42410006
424200         WITH TEST AFTER                                          42420006
424300         VARYING PV-RETRY-COUNTER                                 42430006
424400         FROM 1 BY 1                                              42440006
424500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42450006
424600            OR (SQLCODE = +0)                                     42460006
424700            OR (SQLCODE = +100))                                  42470006
424800                                                                  42480006
424900         EXEC SQL                                                 42490006
425000             SELECT COUNT(*)                                      42500006
425100              INTO :PV-DB2-COUNT                                  42510006
425200              FROM  TTRBNTF                                       42520006
425300             WHERE PO_NBR      = :DK-PO-NBR                       42530006
425400               AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                  42540006
425500               AND RESOLVED_IND IN (:PC-N, :PC-I)                 42550006
425600               AND TRBL_RSN_CDE NOT IN                            42560006
425700                                (:PC-997, :PC-998, :PC-999)       42570006
425701             FETCH FIRST 1 ROW ONLY                               42570108
425710              WITH UR                                             42571008
425800         END-EXEC                                                 42580006
425900                                                                  42590006
426000         EVALUATE TRUE                                            42600006
426100             WHEN SQLCODE = +0                                    42610006
426200             WHEN SQLCODE = +100                                  42620006
426300             WHEN SQLCODE = -904                                  42630006
426400             WHEN SQLCODE = -913                                  42640006
426500                 CONTINUE                                         42650006
426600                                                                  42660006
426700             WHEN SQLWARN0 NOT = SPACE                            42670006
426800             WHEN SQLCODE < +0                                    42680006
426900             WHEN SQLCODE > +0                                    42690006
427000                 MOVE '4375-CHK4-OTHER-TROUBLE'                   42700006
427100                                 TO DP013-PARAGRAPH               42710006
427200                 MOVE 'COUNT ON TTRBNTF'                          42720006
427300                                 TO DP013-MESSAGE-TEXT (1)        42730006
427400                 MOVE SQLCA      TO DP013-SQLCA                   42740006
427500                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      42750006
427600                 SET DP013-DB2-ABEND                              42760006
427700                                 TO TRUE                          42770006
427800                 SET DP013-XCTL-DISPLAY-RESTART                   42780006
427900                                 TO TRUE                          42790006
428000                 PERFORM DP013-0000-PROCESS-ABEND                 42800006
428100         END-EVALUATE                                             42810006
428200     END-PERFORM.                                                 42820006
428300                                                                  42830006
428400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    42840006
428500         SQLCODE NOT = +0                                         42850006
428600         MOVE '4375-CHK4-OTHER-TROUBLE'                           42860006
428700                                 TO DP013-PARAGRAPH               42870006
428800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     42880006
428900                                 TO DP013-MESSAGE-TEXT (1)        42890006
429000         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        42900006
429100         MOVE SQLCA              TO DP013-SQLCA                   42910006
429200         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      42920006
429300         SET DP013-DB2-ABEND     TO TRUE                          42930006
429400         SET DP013-XCTL-DISPLAY-RESTART                           42940006
429500                                 TO TRUE                          42950006
429600         PERFORM DP013-0000-PROCESS-ABEND                         42960006
429700     END-IF.                                                      42970006
429800                                                                  42980006
429900 4376-CHK4-UNRSLVD-STOR-TRBL.                                     42990006
430000     PERFORM                                                      43000006
430100         WITH TEST AFTER                                          43010006
430200         VARYING PV-RETRY-COUNTER                                 43020006
430300         FROM 1 BY 1                                              43030006
430400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43040006
430500            OR (SQLCODE = +0)                                     43050006
430600            OR (SQLCODE = +100))                                  43060006
430700                                                                  43070006
430800         EXEC SQL                                                 43080006
430900             SELECT COUNT(*)                                      43090006
431000              INTO :PV-DB2-COUNT                                  43100006
431100              FROM  TTRBNTF                                       43110006
431200             WHERE PO_NBR      = :DK-PO-NBR                       43120006
431300               AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                  43130006
431400               AND RESOLVED_IND IN (:PC-N, :PC-I)                 43140006
431500               AND TRBL_RSN_CDE IN                                43150006
431600                                (:PC-997, :PC-998, :PC-999)       43160006
431601             FETCH FIRST 1 ROW ONLY                               43160108
431610              WITH UR                                             43161008
431700         END-EXEC                                                 43170006
431800                                                                  43180006
431900         EVALUATE TRUE                                            43190006
432000             WHEN SQLCODE = +0                                    43200006
432100             WHEN SQLCODE = +100                                  43210006
432200             WHEN SQLCODE = -904                                  43220006
432300             WHEN SQLCODE = -913                                  43230006
432400                 CONTINUE                                         43240006
432500                                                                  43250006
432600             WHEN SQLWARN0 NOT = SPACE                            43260006
432700             WHEN SQLCODE < +0                                    43270006
432800             WHEN SQLCODE > +0                                    43280006
432900                 MOVE '4376-CHK4-UNRSLVD-STOR-TRBL'               43290006
433000                                 TO DP013-PARAGRAPH               43300006
433100                 MOVE 'COUNT ON TTRBNTF'                          43310006
433200                                 TO DP013-MESSAGE-TEXT (1)        43320006
433300                 MOVE SQLCA      TO DP013-SQLCA                   43330006
433400                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      43340006
433500                 SET DP013-DB2-ABEND                              43350006
433600                                 TO TRUE                          43360006
433700                 SET DP013-XCTL-DISPLAY-RESTART                   43370006
433800                                 TO TRUE                          43380006
433900                 PERFORM DP013-0000-PROCESS-ABEND                 43390006
434000         END-EVALUATE                                             43400006
434100     END-PERFORM.                                                 43410006
434200                                                                  43420006
434300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    43430006
434400         SQLCODE NOT = +0                                         43440006
434500         MOVE '4376-CHK4-UNRSLVD-STOR-TRBL'                       43450006
434600                                 TO DP013-PARAGRAPH               43460006
434700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     43470006
434800                                 TO DP013-MESSAGE-TEXT (1)        43480006
434900         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        43490006
435000         MOVE SQLCA              TO DP013-SQLCA                   43500006
435100         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      43510006
435200         SET DP013-DB2-ABEND     TO TRUE                          43520006
435300         SET DP013-XCTL-DISPLAY-RESTART                           43530006
435400                                 TO TRUE                          43540006
435500         PERFORM DP013-0000-PROCESS-ABEND                         43550006
435600     END-IF.                                                      43560006
435700                                                                  43570006
435800 4377-CHK4-RSLVD-STOR-TRBL.                                       43580006
435900     PERFORM                                                      43590006
436000         WITH TEST AFTER                                          43600006
436100         VARYING PV-RETRY-COUNTER                                 43610006
436200         FROM 1 BY 1                                              43620006
436300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43630006
436400            OR (SQLCODE = +0)                                     43640006
436500            OR (SQLCODE = +100))                                  43650006
436600                                                                  43660006
436700         EXEC SQL                                                 43670006
436800             SELECT COUNT(*)                                      43680006
436900              INTO :PV-DB2-COUNT                                  43690006
437000              FROM  TTRBNTF                                       43700006
437100             WHERE PO_NBR      = :DK-PO-NBR                       43710010
437200               AND REC_SEQ_NBR = :DK-REC-SEQ-NBR                  43720006
437300               AND RESOLVED_IND IN (:PC-R, :PC-A)                 43730006
437400               AND TRBL_RSN_CDE IN                                43740006
437500                                (:PC-997, :PC-998, :PC-999)       43750006
437501             FETCH FIRST 1 ROW ONLY                               43750108
437510              WITH UR                                             43751008
437600         END-EXEC                                                 43760006
437700                                                                  43770006
437800         EVALUATE TRUE                                            43780006
437900             WHEN SQLCODE = +0                                    43790006
438000             WHEN SQLCODE = +100                                  43800006
438100             WHEN SQLCODE = -904                                  43810006
438200             WHEN SQLCODE = -913                                  43820006
438300                 CONTINUE                                         43830006
438400                                                                  43840006
438500             WHEN SQLWARN0 NOT = SPACE                            43850006
438600             WHEN SQLCODE < +0                                    43860006
438700             WHEN SQLCODE > +0                                    43870006
438800                 MOVE '4377-CHK4-RSLVD-STOR-TRBL'                 43880006
438900                                 TO DP013-PARAGRAPH               43890006
439000                 MOVE 'COUNT ON TTRBNTF'                          43900006
439100                                 TO DP013-MESSAGE-TEXT (1)        43910006
439200                 MOVE SQLCA      TO DP013-SQLCA                   43920006
439300                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      43930006
439400                 SET DP013-DB2-ABEND                              43940006
439500                                 TO TRUE                          43950006
439600                 SET DP013-XCTL-DISPLAY-RESTART                   43960006
439700                                 TO TRUE                          43970006
439800                 PERFORM DP013-0000-PROCESS-ABEND                 43980006
439900         END-EVALUATE                                             43990006
440000     END-PERFORM.                                                 44000006
440100                                                                  44010006
440200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44020006
440300         SQLCODE NOT = +0                                         44030006
440400         MOVE '4377-CHK4-RSLVD-STOR-TRBL'                         44040006
440500                                 TO DP013-PARAGRAPH               44050006
440600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     44060006
440700                                 TO DP013-MESSAGE-TEXT (1)        44070006
440800         MOVE 'ON TTRBNTF'       TO DP013-MESSAGE-TEXT (2)        44080006
440900         MOVE SQLCA              TO DP013-SQLCA                   44090006
441000         MOVE 'TTRBNTF'          TO DP013-DB2-TABLE-NAME (1)      44100006
441100         SET DP013-DB2-ABEND     TO TRUE                          44110006
441200         SET DP013-XCTL-DISPLAY-RESTART                           44120006
441300                                 TO TRUE                          44130006
441400         PERFORM DP013-0000-PROCESS-ABEND                         44140006
441500     END-IF.                                                      44150006
441600                                                                  44160006
441700/                                                                 44170006
441800*----------------------------------------------------------------*44180006
441900*    RETRIEVE OPERATION SET DESCRIPTION                          *44190006
442000*----------------------------------------------------------------*44200006
442100 4380-GET-OPER-SET-DESC.                                          44210006
442200                                                                  44220006
442300     PERFORM                                                      44230006
442400         WITH TEST AFTER                                          44240006
442500         VARYING PV-RETRY-COUNTER                                 44250006
442600         FROM 1 BY 1                                              44260006
442700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44270006
442800             OR (SQLCODE = +0)                                    44280006
442900             OR (SQLCODE = +100))                                 44290006
443000                                                                  44300006
443100         EXEC SQL                                                 44310006
443200            SELECT  DISTINCT                                      44320006
443300                    C.OPER_SET_DESC                               44330006
443400                   ,C.CNTL_DESC                                   44340006
443500              INTO :OPRSET-OPER-SET-DESC                          44350006
443600                  ,:OPRSET-CNTL-DESC                              44360006
443700              FROM  TRECEIV A                                     44370006
443800                   ,TWRKORD B                                     44380006
443900                   ,TOPRSET C                                     44390006
444000             WHERE  A.OPER_UNT_ID    = :DK-OPER-UNT-ID            44400006
444100               AND  A.FCLTY_ID       = :DK-FCLTY-ID               44410006
444200               AND  A.ORD_NBR        = :DK-PO-NBR                 44420006
444300               AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR            44430006
444400               AND  B.ORD_LNE_NBR    = 0                          44440006
444500               AND  A.VER_STATUS_CDE = 'A'                        44450006
444600               AND  B.VER_STATUS_CDE = 'A'                        44460006
444700               AND  A.ORD_NBR        = B.ORD_NBR                  44470006
444800               AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR             44480006
444900               AND  B.OPER_SET_ID    = C.OPER_SET_ID              44490006
445000               AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID         44500006
445010              WITH UR                                             44501008
445100         END-EXEC                                                 44510006
445200                                                                  44520006
445300         EVALUATE TRUE                                            44530006
445400             WHEN SQLCODE = +0                                    44540006
445500             WHEN SQLCODE = +100                                  44550006
445600             WHEN SQLCODE = -904                                  44560006
445700             WHEN SQLCODE = -913                                  44570006
445800                  CONTINUE                                        44580006
445900                                                                  44590006
446000             WHEN SQLWARN0 NOT = SPACES                           44600006
446100             WHEN SQLCODE < +0                                    44610006
446200             WHEN SQLCODE > +0                                    44620006
446300                  MOVE '4380-GET-OPER-SET-DESC'                   44630006
446400                                  TO DP013-PARAGRAPH              44640006
446500                  MOVE 'UNSUCCESSFUL SELECT ON TOPRSET  '         44650006
446600                                  TO DP013-MESSAGE-TEXT (1)       44660006
446700                  MOVE DK-PO-NBR  TO PV-ERROR-PO                  44670006
446800                  MOVE DK-REC-SEQ-NBR                             44680006
446900                                  TO PV-ERROR-SEQ                 44690006
447000                  MOVE DK-OPER-UNT-ID                             44700006
447100                                  TO PV-ERROR-OPER-UNT-ID         44710006
447200                  MOVE DK-FCLTY-ID                                44720006
447300                                  TO PV-ERROR-FCLTY-ID            44730006
447400                  MOVE PV-ERROR-MSG                               44740006
447500                                  TO DP013-MESSAGE-TEXT (2)       44750006
447600                  MOVE SQLCA      TO DP013-SQLCA                  44760006
447700                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     44770006
447800                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (2)     44780006
447900                  MOVE 'TOPRSET ' TO DP013-DB2-TABLE-NAME (3)     44790006
448000                  SET DP013-DB2-ABEND                             44800006
448100                      DP013-XCTL-DISPLAY-RESTART                  44810006
448200                                  TO TRUE                         44820006
448300                  PERFORM DP013-0000-PROCESS-ABEND                44830006
448400         END-EVALUATE                                             44840006
448500     END-PERFORM.                                                 44850006
448600                                                                  44860006
448700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    44870006
448800         SQLCODE NOT = +0                                         44880006
448900         MOVE '4380-GET-OPER-SET-DESC'                            44890006
449000                                  TO DP013-PARAGRAPH              44900006
449100         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TOPRSET  '       44910006
449200                                  TO DP013-MESSAGE-TEXT (1)       44920006
449300         MOVE SQLCA               TO DP013-SQLCA                  44930006
449400         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     44940006
449500         MOVE 'TWRKORD '          TO DP013-DB2-TABLE-NAME (2)     44950006
449600         MOVE 'TOPRSET '          TO DP013-DB2-TABLE-NAME (3)     44960006
449700         SET DP013-DB2-ABEND                                      44970006
449800             DP013-XCTL-DISPLAY-RESTART                           44980006
449900                                  TO TRUE                         44990006
450000         PERFORM DP013-0000-PROCESS-ABEND                         45000006
450100     END-IF.                                                      45010006
450200                                                                  45020006
450300/                                                                 45030006
450400*----------------------------------------------------------------*45040006
450500*    GET THE ITEM NUMBER                                         *45050006
450600*----------------------------------------------------------------*45060006
450700 4390-GET-ITM-NBR.                                                45070006
450800                                                                  45080006
450900     INITIALIZE PS-ITM-NBR-SW                                     45090006
451000                                                                  45100006
451100     PERFORM                                                      45110006
451200         WITH TEST AFTER                                          45120006
451300         VARYING PV-RETRY-COUNTER                                 45130006
451400         FROM 1 BY 1                                              45140006
451500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45150006
451600             OR (SQLCODE = +0)                                    45160006
451700             OR (SQLCODE = +100))                                 45170006
451800                                                                  45180006
451900         EXEC SQL                                                 45190006
452000              SELECT A.ITM_NBR                                    45200006
452100                INTO :PURITM-ITM-NBR                              45210006
452200                FROM TPURITM A                                    45220006
452300               WHERE A.PO_NBR         = :DK-PO-NBR                45230006
452400                 AND A.VER_STATUS_CDE = 'A'                       45240006
452500                 AND A.PO_LNE_NBR =                               45250006
452600                  (SELECT MIN(B.PO_LNE_NBR)                       45260006
452700                    FROM TPURITM B                                45270006
452800                   WHERE B.PO_NBR = A.PO_NBR                      45280006
452900                     AND B.VER_STATUS_CDE = 'A')                  45290006
452910                WITH UR                                           45291008
453000         END-EXEC                                                 45300006
453100                                                                  45310006
453200         EVALUATE TRUE                                            45320006
453300             WHEN SQLCODE = +0                                    45330006
453400                  SET PS-ITM-NBR-FOUND TO TRUE                    45340006
453500             WHEN SQLCODE = +100                                  45350006
453600             WHEN SQLCODE = -904                                  45360006
453700             WHEN SQLCODE = -913                                  45370006
453800                  CONTINUE                                        45380006
453900                                                                  45390006
454000             WHEN SQLWARN0 NOT = SPACES                           45400006
454100             WHEN SQLCODE < +0                                    45410006
454200             WHEN SQLCODE > +0                                    45420006
454300                  MOVE '4390-GET-ITM-NBR'                         45430006
454400                                  TO DP013-PARAGRAPH              45440006
454500                  MOVE 'UNSUCCESSFUL SELECT ON TPURITM'           45450006
454600                                  TO DP013-MESSAGE-TEXT (1)       45460006
454700                  MOVE SQLCA      TO DP013-SQLCA                  45470006
454800                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)     45480006
454900                  SET DP013-DB2-ABEND                             45490006
455000                      DP013-XCTL-DISPLAY-RESTART                  45500006
455100                                  TO TRUE                         45510006
455200                  PERFORM DP013-0000-PROCESS-ABEND                45520006
455300         END-EVALUATE                                             45530006
455400     END-PERFORM.                                                 45540006
455500                                                                  45550006
455600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    45560006
455700         SQLCODE NOT = +0                                         45570006
455800         MOVE '4390-GET-ITM-NBR'                                  45580006
455900                                  TO DP013-PARAGRAPH              45590006
456000         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            45600006
456100                                  TO DP013-MESSAGE-TEXT (1)       45610006
456200         MOVE SQLCA               TO DP013-SQLCA                  45620006
456300         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     45630006
456400         SET DP013-DB2-ABEND                                      45640006
456500             DP013-XCTL-DISPLAY-RESTART                           45650006
456600                                  TO TRUE                         45660006
456700         PERFORM DP013-0000-PROCESS-ABEND                         45670006
456800     END-IF.                                                      45680006
456900                                                                  45690006
457000/                                                                 45700006
457100*----------------------------------------------------------------*45710006
457200*    CALL XLKUT001 FOR ITM NUMBER                                *45720006
457300*----------------------------------------------------------------*45730006
457400 4391-CALL-XLKUT001.                                              45740006
457500                                                                  45750006
457600     MOVE PURITM-ITM-NBR         TO XL001-KEY-ITM-NBR.            45760006
457700                                                                  45770006
457800     SET  XL001-BY-ITEM                                           45780006
457900          XL001-SELECT-VND-STYL  TO TRUE.                         45790006
458000                                                                  45800006
458100     CALL XL001-VSM-PGM USING  DFHEIBLK                           45810006
458200                               XL001-COMMAREA                     45820006
458300                               XL001-ITEM-COMMAREA.               45830006
458400                                                                  45840006
458500     EVALUATE TRUE                                                45850006
458600                                                                  45860006
458700         WHEN XL001-SUCCESSFUL                                    45870006
458800             WHEN XL001-SKU-SQLCODE =                             45880006
458900                          (0 OR +100 OR -904 OR -913)             45890006
459000             WHEN XL001-VND-STYL-SQLCODE =                        45900006
459100                          (0 OR +100 OR -904 OR -913)             45910006
459200                 CONTINUE                                         45920006
459300                                                                  45930006
459400             WHEN OTHER                                           45940006
459500                 MOVE '4391-CALL-XLKUT001'                        45950006
459600                                TO DP013-PARAGRAPH                45960006
459700                 MOVE 'UNSUCCESSFUL SELECT OF SUB CLASS'          45970006
459800                                TO DP013-MESSAGE-TEXT (1)         45980006
459900                 IF XL001-SKU-SQLCODE NOT = ZERO                  45990006
460000                     MOVE XL001-SKU-SQLCODE                       46000006
460100                                TO SQLCODE                        46010006
460200                 ELSE                                             46020006
460300                     MOVE XL001-VND-STYL-SQLCODE                  46030006
460400                                TO SQLCODE                        46040006
460500                 END-IF                                           46050006
460600                 MOVE SQLCA     TO DP013-SQLCA                    46060006
460700                 MOVE 'SKU VND' TO DP013-DB2-TABLE-NAME (1)       46070006
460800                 SET DP013-DB2-ABEND                              46080006
460900                     DP013-XCTL-DISPLAY-RESTART                   46090006
461000                                TO TRUE                           46100006
461100                 PERFORM DP013-0000-PROCESS-ABEND                 46110006
461200             END-EVALUATE.                                        46120006
461300                                                                  46130006
461400/                                                                 46140006
461500*----------------------------------------------------------------*46150006
461600*    GET SHIPMENT INFO                                           *46160006
461700*----------------------------------------------------------------*46170006
461800 4395-GET-SHIPMENT-INFO.                                          46180006
461900                                                                  46190006
462000     PERFORM                                                      46200006
462100         WITH TEST AFTER                                          46210006
462200         VARYING PV-RETRY-COUNTER                                 46220006
462300         FROM 1 BY 1                                              46230006
462400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46240006
462500            OR (SQLCODE = +0)                                     46250006
462600            OR (SQLCODE = +100)                                   46260006
462700            OR (SQLCODE = -811))                                  46270006
462800                                                                  46280006
462900         EXEC SQL                                                 46290006
463000            SELECT  B.PRO_NBR                                     46300006
463100                   ,B.BOL_NBR                                     46310006
463200                   ,B.VEND_SHIP_DTE                               46320006
463300              INTO :SHIPMT-PRO-NBR                                46330006
463400                  ,:SHIPMT-BOL-NBR                                46340006
463500                  ,:SHIPMT-VEND-SHIP-DTE                          46350006
463600              FROM  TSHPTPO A                                     46360006
463700                   ,TSHIPMT B                                     46370006
463800          WHERE A.PO_NBR      = :DK-PO-NBR                        46380006
463900            AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                   46390006
464000            AND A.SHIPT_ID = B.SHIPT_ID                           46400006
464010           WITH UR                                                46401008
464100         END-EXEC                                                 46410006
464200                                                                  46420006
464300         EVALUATE TRUE                                            46430006
464400             WHEN SQLCODE = +0                                    46440006
464500             WHEN SQLCODE = +100                                  46450006
464600             WHEN SQLCODE = -811                                  46460006
464700             WHEN SQLCODE = -904                                  46470006
464800             WHEN SQLCODE = -913                                  46480006
464900                 CONTINUE                                         46490006
465000                                                                  46500006
465100             WHEN SQLWARN0 NOT = SPACE                            46510006
465200             WHEN SQLCODE < +0                                    46520006
465300             WHEN SQLCODE > +0                                    46530006
465400                 MOVE '4395-GET-SHIPMENT-INFO'                    46540006
465500                                 TO DP013-PARAGRAPH               46550006
465600                 MOVE 'SELECT SHIPMENT INFO'                      46560006
465700                                 TO DP013-MESSAGE-TEXT (1)        46570006
465800                 MOVE SQLCA      TO DP013-SQLCA                   46580006
465900                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      46590006
466000                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)      46600006
466100                 SET DP013-DB2-ABEND                              46610006
466200                                 TO TRUE                          46620006
466300                 SET DP013-XCTL-DISPLAY-RESTART                   46630006
466400                                 TO TRUE                          46640006
466500                 PERFORM DP013-0000-PROCESS-ABEND                 46650006
466600         END-EVALUATE                                             46660006
466700     END-PERFORM.                                                 46670006
466800                                                                  46680006
466900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46690006
467000             AND (SQLCODE = -904 OR -913)                         46700006
467100         MOVE '4395-GET-SHIPMTNE-INFO'                            46710006
467200                                 TO DP013-PARAGRAPH               46720006
467300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     46730006
467400                                 TO DP013-MESSAGE-TEXT (1)        46740006
467500         MOVE 'SHIPMENT INFO'                                     46750006
467600                                 TO DP013-MESSAGE-TEXT (2)        46760006
467700         MOVE SQLCA              TO DP013-SQLCA                   46770006
467800         MOVE 'TSHPTPO'          TO DP013-DB2-TABLE-NAME (1)      46780006
467900         MOVE 'TSHIPMT'          TO DP013-DB2-TABLE-NAME (2)      46790006
468000         SET DP013-DB2-ABEND     TO TRUE                          46800006
468100         SET DP013-XCTL-DISPLAY-RESTART                           46810006
468200                                 TO TRUE                          46820006
468300         PERFORM DP013-0000-PROCESS-ABEND                         46830006
468400     END-IF.                                                      46840006
468500                                                                  46850006
468600/                                                                 46860006
468700*----------------------------------------------------------------*46870006
468800* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *46880006
468900*----------------------------------------------------------------*46890006
469000                                                                  46900006
469100 4400-MOVE-COMMAREA-TO-SCREEN.                                    46910006
469200                                                                  46920006
469300     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             46930006
469400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          46940006
469500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          46950006
469600             MOVE +1    TO ASC-BLK-SUB                            46960006
469700             PERFORM 5100-WRITE-TEMP-STORAGE                      46970006
469800             ADD +1     TO ASC-BLK-SUB                            46980006
469900             PERFORM 5100-WRITE-TEMP-STORAGE                      46990006
470000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             47000006
470100                 GIVING PV-BLOCK-NUMBER                           47010006
470200                 REMAINDER PV-REMAINDER                           47020006
470300             IF  PV-REMAINDER > ZERO                              47030006
470400                 ADD +1 TO PV-BLOCK-NUMBER                        47040006
470500             END-IF                                               47050006
470600             MOVE +1    TO ASC-BLK-SUB                            47060006
470700             PERFORM 4410-READ-TEMP-STORAGE                       47070006
470800             ADD +1     TO ASC-BLK-SUB                            47080006
470900                           PV-BLOCK-NUMBER                        47090006
471000             PERFORM 4410-READ-TEMP-STORAGE                       47100006
471100     END-IF.                                                      47110006
471200                                                                  47120006
471300     MOVE +1            TO ASC-BLK-SUB.                           47130006
471400                                                                  47140006
471500     COMPUTE ASC-ITEM-SUB =                                       47150006
471600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              47160006
471700         + PC-ITEMS-PER-PANEL).                                   47170006
471800                                                                  47180006
471900     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        47190006
472000         ADD +1         TO ASC-BLK-SUB                            47200006
472100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            47210006
472200     END-IF.                                                      47220006
472300                                                                  47230006
472400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           47240006
472500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                47250006
472600     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        47260006
472700     PERFORM 4420-FORMAT-LIST-LINES                               47270006
472800         VARYING PV-SUB                                           47280006
472900         FROM PC-ITEMS-PER-PANEL BY -1                            47290006
473000         UNTIL PV-SUB < +1.                                       47300006
473100                                                                  47310006
473200     MOVE ASC-KEY-OWNER-SCAC-ID TO MR-OWNER-SCAC-ID.              47320006
473300     MOVE ASC-KEY-VEH-NBR       TO MR-VEH-NBR.                    47330006
473400                                                                  47340006
473500     MOVE ASC-PRINTER-ID        TO MR-PRINTER.                    47350006
473600                                                                  47360006
473700     IF ASC-KEY-PO-NBR = ZERO                                     47370006
473800         MOVE ASC-KEY-PO-NBR    TO ASPONBRO                       47380006
473900     ELSE                                                         47390006
474000         MOVE ASC-KEY-PO-NBR    TO MR-SPONUM-X.                   47400006
474100                                                                  47410006
474200     MOVE ASC-KEY-ARRIVAL-DTE   TO PV-DB2-DATE.                   47420006
474300     MOVE PV-DB2-DATE-MM        TO PV-DISPLAY-DATE-MM.            47430006
474400     MOVE PV-DB2-DATE-DD        TO PV-DISPLAY-DATE-DD.            47440006
474500     MOVE PV-DB2-DATE-YY        TO PV-DISPLAY-DATE-YY.            47450006
474600     MOVE PV-DISPLAY-DATE       TO MR-RCPT-DTE.                   47460006
474700                                                                  47470006
474800     MOVE ASC-KEY-TRIP-ID       TO PV-TRIP-ID-DISPLAY.            47480006
474900     MOVE PV-TRIP-ID-DISPLAY    TO MR-TRIP-ID.                    47490006
475000* EA 07/30/2010                                                   47500006
475100     MOVE ASC-WHSE-CTN          TO MR-WCTN-CNT.                   47510006
475200     MOVE ASC-WHSE-EXP-CTN      TO MR-WEXCTN-CNT.                 47520006
475300* EA 07/30/2010                                                   47530006
475400     MOVE ASC-TOTAL-CTN-CNT     TO ATLRTOTO.                      47540006
475500     MOVE ASC-TOTAL-ACTL-CTN-CNT TO AADJTOTO.                     47550006
475600     MOVE ASC-TOTAL-DMG-CTN-CNT TO ADMGTOTO.                      47560006
475700                                                                  47570006
475710* DMH - 4/27/2021 BEGIN                                           47571025
475711     IF  ASC-HAS-BULK-MULTI-SKU-YES                               47571125
475712         MOVE 'PKG-B W/MIXED SKU CASE'  TO MR-B-MSG               47571228
475713         MOVE DP015-RED                 TO MR-B-MSGC              47571326
475714     ELSE                                                         47571425
475715         MOVE SPACE                     TO MR-B-MSG               47571526
475716         MOVE DP015-BLUE                TO MR-B-MSGC              47571626
475717     END-IF.                                                      47571725
475718                                                                  47571825
475719* DMH - 4/27/2021 END                                             47571925
475720                                                                  47572025
475800     COMPUTE ASC-ITEMS-DISPLAYED =                                47580006
475900         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          47590006
476000     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    47600006
476100                                      ASTRTITO.                   47610006
476200     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    47620006
476300     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    47630006
476400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            47640006
476500                                   TO ASELITO.                    47650006
476600                                                                  47660006
476700     IF  DP020-MSG-NUMBER-X = SPACE                               47670006
476800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  47680006
476900*            --- MORE ITEMS TO DISPLAY ----                       47690006
477000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            47700006
477100             SET DP020-MSG-INFORMATIONAL TO TRUE                  47710006
477200         END-IF                                                   47720006
477300     END-IF.                                                      47730006
477400/                                                                 47740006
477500*----------------------------------------------------------------*47750006
477600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *47760006
477700*----------------------------------------------------------------*47770006
477800                                                                  47780006
477900 4410-READ-TEMP-STORAGE.                                          47790006
478000                                                                  47800006
478100     EXEC CICS                                                    47810006
478200         READQ TS                                                 47820006
478300             QUEUE (ASC-LIST-QUEUE-NAME)                          47830006
478400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               47840006
478500             ITEM  (PV-BLOCK-NUMBER)                              47850006
478600             RESP  (PV-CICS-RESP)                                 47860006
478700     END-EXEC.                                                    47870006
478800                                                                  47880006
478900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       47890006
479000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     47900006
479100         CONTINUE                                                 47910006
479200     ELSE                                                         47920006
479300         SET DP013-CICS-ABEND     TO TRUE                         47930006
479400         SET DP013-NO-ROLLBACK    TO TRUE                         47940006
479500         MOVE '4410-READ-TEMP-STORAGE'                            47950006
479600                                  TO DP013-PARAGRAPH              47960006
479700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      47970006
479800                                  TO DP013-MESSAGE-TEXT(1)        47980006
479900         PERFORM DP013-0000-PROCESS-ABEND                         47990006
480000     END-IF.                                                      48000006
480100                                                                  48010006
480200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             48020006
480300                                                                  48030006
480400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         48040006
480500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               48050006
480600     END-IF.                                                      48060006
480700/                                                                 48070006
480800*----------------------------------------------------------------*48080006
480900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *48090006
481000*----------------------------------------------------------------*48100006
481100                                                                  48110006
481200 4420-FORMAT-LIST-LINES.                                          48120006
481300                                                                  48130006
481400     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       48140006
481500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                48150006
481600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           48160006
481700         MOVE SPACES             TO MR-OWNER-SCAC-ID-X            48170006
481800                                    MR-VEH-NBR-X                  48180006
481900                                    MR-SPONUM-X                   48190006
482000                                    MR-PRINTER                    48200006
482100                                    MR-RCPT-DTE                   48210006
482200                                                                  48220006
482300                                    MR-SELECTI (PV-SUB)           48230006
482400                                    MR-REC-SEQ-NBR (PV-SUB)       48240006
482500                                    MR-PO-NBR (PV-SUB)            48250006
482600                                    MR-STOR-IND (PV-SUB)          48260006
482700                                    MR-PKGNG-CDE (PV-SUB)         48270006
482800                                    MR-ENT-NAME-DESC (PV-SUB)     48280006
482900                                    MR-SEA-NAME-DESC (PV-SUB)     48290006
483000                                    MR-OPER-SET-DESC (PV-SUB)     48300006
483100                                    MR-MULTIPLE-IND (PV-SUB)      48310006
483200                                    MR-CARTON-CNT-X (PV-SUB)      48320006
483300                                    MR-ACTL-CARTON-CNT-X (PV-SUB) 48330006
483400                                    MR-DMG-CARTON-CNT-X (PV-SUB)  48340006
483500                                    MR-REC-CLERK (PV-SUB)         48350006
483600     ELSE                                                         48360006
483700         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      48370006
483800                                                   > SPACE        48380006
483900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 48390006
484000                                 TO MR-SELECTI (PV-SUB)           48400006
484100         ELSE                                                     48410006
484200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      48420006
484300                                 TO MR-SELECTI (PV-SUB)           48430006
484400         END-IF                                                   48440006
484500                                                                  48450006
484600         IF DP030-SET-CURSOR-TRAILER                              48460006
484700             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)48470006
484800                 > SPACE)                                         48480006
484900               OR (PV-SUB = 1))                                   48490006
485000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               48500006
485100                MOVE -1          TO MR-SELECTL (PV-SUB)           48510006
485200             END-IF                                               48520006
485300         END-IF                                                   48530006
485400                                                                  48540006
485500         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            48550006
485600             MOVE ASC-REC-SEQ-NBR (ASC-BLK-SUB ASC-ITEM-SUB)      48560006
485700                                 TO MR-REC-SEQ-NBR (PV-SUB)       48570006
485710*PS 10/16/2014 CHANGES STARTS                                     48571013
485800             MOVE ASC-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)           48580006
485900                                 TO PV-PO-NBR-N                   48590013
485910             MOVE PV-PO-NBR-N    TO MR-PO-NBR (PV-SUB)            48591013
485920*PS 10/16/2014 CHANGES ENDS                                       48592013
486000             MOVE ASC-PKGNG-CDE     (ASC-BLK-SUB ASC-ITEM-SUB)    48600006
486100                                 TO MR-PKGNG-CDE (PV-SUB)         48610006
486101* DMH - 4/27/2021 - END                                           48610121
486110             IF ASC-BULK-MULT-SKU-YES (ASC-BLK-SUB ASC-ITEM-SUB)  48611021
486140                 MOVE DP015-RED  TO MR-PKGNG-CDEC (PV-SUB)        48614021
486160             ELSE                                                 48616021
486170                 MOVE DP015-BLUE TO MR-PKGNG-CDEC (PV-SUB)        48617021
486190             END-IF                                               48619021
486191* DMH - 4/27/2021 - END                                           48619121
486200             MOVE ASC-SEA-NAME-DESC (ASC-BLK-SUB ASC-ITEM-SUB)    48620006
486300                                 TO MR-SEA-NAME-DESC (PV-SUB)     48630006
486400             MOVE ASC-ENT-NAME-DESC (ASC-BLK-SUB ASC-ITEM-SUB)    48640006
486500                                 TO MR-ENT-NAME-DESC (PV-SUB)     48650006
486600             MOVE ASC-OPER-SET-DESC (ASC-BLK-SUB ASC-ITEM-SUB)    48660006
486700                                 TO MR-OPER-SET-DESC (PV-SUB)     48670006
486800             MOVE ASC-MULT-IND (ASC-BLK-SUB ASC-ITEM-SUB)         48680006
486900                                 TO MR-MULTIPLE-IND (PV-SUB)      48690006
487000             MOVE ASC-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB)          48700006
487100                                 TO MR-CARTON-CNT (PV-SUB)        48710006
487200             MOVE ASC-ACTL-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB)     48720006
487300                                 TO MR-ACTL-CARTON-CNT (PV-SUB)   48730006
487400             MOVE ASC-DMG-CTN-CNT (ASC-BLK-SUB ASC-ITEM-SUB)      48740006
487500                                 TO MR-DMG-CARTON-CNT (PV-SUB)    48750006
487600             MOVE ASC-REC-CLK (ASC-BLK-SUB ASC-ITEM-SUB)          48760006
487700                                 TO MR-REC-CLERK (PV-SUB)         48770006
487800**** SET UP FIELDS TO INDICATE TROUBLE - HI-LITE IF NEEDED        48780006
487900             MOVE ASC-STOR-IND (ASC-BLK-SUB ASC-ITEM-SUB)         48790006
488000                                 TO MR-STOR-IND (PV-SUB)          48800006
488100             IF ASC-CURR-STOR-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)     48810006
488200                 MOVE DP015-PRO-BRT-OFF                           48820006
488300                                 TO MR-STOR-INDA (PV-SUB)         48830006
488400                 MOVE DP015-YELLOW                                48840006
488500                                 TO MR-STOR-INDC (PV-SUB)         48850006
488600             ELSE                                                 48860006
488700                 MOVE DP015-BLUE                                  48870006
488800                                 TO MR-STOR-INDC (PV-SUB)         48880006
488900             END-IF                                               48890006
489000             IF ASC-OTHER-TRBL (ASC-BLK-SUB ASC-ITEM-SUB)         48900006
489100                 MOVE DP015-PRO-BRT-OFF                           48910006
489200                                 TO MR-PO-NBRA (PV-SUB)           48920006
489300                                    MR-REC-SEQ-NBRA (PV-SUB)      48930006
489400                 MOVE DP015-YELLOW                                48940006
489500                                 TO MR-PO-NBRC (PV-SUB)           48950006
489600                                    MR-REC-SEQ-NBRC (PV-SUB)      48960006
489700                                    MR-REC-SEQ-NBRA (PV-SUB)      48970006
489800             ELSE                                                 48980006
489900                 MOVE DP015-BLUE                                  48990006
490000                                 TO MR-PO-NBRC (PV-SUB)           49000006
490100                                    MR-REC-SEQ-NBRC (PV-SUB)      49010006
490200             END-IF                                               49020006
490300         END-IF                                                   49030006
490400     END-IF.                                                      49040006
490500                                                                  49050006
490600     SUBTRACT +1 FROM ASC-ITEM-SUB                                49060006
490700                                                                  49070006
490800     IF  ASC-ITEM-SUB < +1                                        49080006
490900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  49090006
491000         MOVE +1                 TO ASC-BLK-SUB                   49100006
491100     END-IF.                                                      49110006
491200                                                                  49120006
491300/                                                                 49130006
491400******************************************************************49140006
491500** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **49150006
491600** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **49160006
491700** ISSUE A WARNING.                                             **49170006
491800******************************************************************49180006
491900                                                                  49190006
492000 4430-CHECK-FOR-BEGIN-AND-END.                                    49200006
492100                                                                  49210006
492200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       49220006
492300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     49230006
492400*            -- NO END-OF-RANGE SPECFIED ---                      49240006
492500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            49250006
492600             SET DP020-MSG-WARNING TO TRUE                        49260006
492700             PERFORM 4431-POSITION-AT-WARNING                     49270006
492800         END-IF                                                   49280006
492900     ELSE                                                         49290006
493000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     49300006
493100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                49310006
493200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            49320006
493300             SET DP020-MSG-WARNING TO TRUE                        49330006
493400             PERFORM 4431-POSITION-AT-WARNING                     49340006
493500         END-IF                                                   49350006
493600     END-IF.                                                      49360006
493700                                                                  49370006
493800                                                                  49380006
493900******************************************************************49390006
494000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **49400006
494100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **49410006
494200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **49420006
494300** POSITION THE CURSOR THERE.                                   **49430006
494400******************************************************************49440006
494500                                                                  49450006
494600 4431-POSITION-AT-WARNING.                                        49460006
494700                                                                  49470006
494800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 49480006
494900                    - PV-TOP-ITEM + 1.                            49490006
495000                                                                  49500006
495100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      49510006
495200         CONTINUE                                                 49520006
495300     ELSE                                                         49530006
495400         SET DP030-SET-CURSOR-APPL-1                              49540006
495500                                   TO TRUE                        49550006
495600         MOVE -1                   TO MR-SELECTL (PV-SUB)         49560006
495700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         49570006
495800         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         49580006
495900     END-IF.                                                      49590006
496000                                                                  49600006
496100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   49610006
496200                    - PV-TOP-ITEM + 1.                            49620006
496300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      49630006
496400         CONTINUE                                                 49640006
496500     ELSE                                                         49650006
496600         SET DP030-SET-CURSOR-APPL-1                              49660006
496700                                   TO TRUE                        49670006
496800         MOVE -1                   TO MR-SELECTL (PV-SUB)         49680006
496900         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         49690006
497000         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         49700006
497100     END-IF.                                                      49710006
497200/                                                                 49720006
497300*----------------------------------------------------------------*49730006
497400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *49740006
497500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *49750006
497600* FOR THE SELECTED ITEMS QUEUE.                                  *49760006
497700*                                                                *49770006
497800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *49780006
497900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *49790006
498000* THE ARRAY IS FULL.                                             *49800006
498100*----------------------------------------------------------------*49810006
498200                                                                  49820006
498300 5000-PREPARE-SEL-QUEUE.                                          49830006
498400                                                                  49840006
498500     MOVE +1                   TO  ASC-BLK-SUB.                   49850006
498600     PERFORM 5100-WRITE-TEMP-STORAGE.                             49860006
498700     ADD +1                    TO  ASC-BLK-SUB.                   49870006
498800     PERFORM 5100-WRITE-TEMP-STORAGE.                             49880006
498900                                                                  49890006
499000*** USE PC000- FIELDS FOR CREATING TROUBLE                        49900006
499100     IF DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)                     49910006
499200         MOVE ASC-SEL-QUEUE-NAME-OUT TO  PC000-SEL-QUEUE-NAME     49920006
499300     ELSE                                                         49930006
499400         MOVE ASC-SEL-QUEUE-NAME-OUT TO  RC015-SEL-QUEUE-NAME     49940006
499500     END-IF.                                                      49950006
499600     PERFORM 6010-DELETE-SEL-QUEUE.                               49960006
499700                                                                  49970006
499800     SET ASC-UPDATE-TSQ        TO  TRUE.                          49980006
499900                                                                  49990006
500000     SET RC013-IDX             TO  1.                             50000006
500100*** USE PC000- FIELDS FOR CREATING TROUBLE                        50010006
500200     IF DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)                     50020006
500300         MOVE ZERO             TO PC000-NUMBER-OF-TS-ITEMS        50030006
500400     ELSE                                                         50040006
500500         MOVE ZERO             TO RC015-NUMBER-OF-TS-ITEMS        50050006
500600     END-IF.                                                      50060006
500700     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        50070006
500800                                                                  50080006
500900     EVALUATE TRUE                                                50090006
501000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              50100006
501100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              50110006
501200             MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO                 50120006
501300                 PV-NUMBER-OF-SELECTED-ITEM                       50130006
501400             PERFORM 5300-SEARCH-FOR-SELECTION                    50140006
501500                 VARYING PV-ITEM  FROM 1 BY 1                     50150006
501600                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      50160006
501700             PERFORM 5015-SCREEN-CLEANUP                          50170006
501800         WHEN OTHER                                               50180006
501900             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   50190006
502000                 VARYING PV-ITEM  FROM 1 BY 1                     50200006
502100                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      50210006
502200     END-EVALUATE.                                                50220006
502300                                                                  50230006
502400     IF  RC013-IDX > 1                                            50240006
502500         PERFORM 5205-WRITE-SEL-QUEUE                             50250006
502600*** USE PC000- FIELDS FOR CREATING TROUBLE                        50260006
502700         IF DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)                 50270006
502800             ADD +1            TO PC000-NUMBER-OF-TS-ITEMS        50280006
502900         ELSE                                                     50290006
503000             ADD +1            TO RC015-NUMBER-OF-TS-ITEMS        50300006
503100         END-IF                                                   50310006
503200     END-IF.                                                      50320006
503300                                                                  50330006
503400 5015-SCREEN-CLEANUP.                                             50340006
503500                                                                  50350006
503600     INITIALIZE ASC-BLOCK-ENTRIES (1)                             50360006
503700                ASC-BLOCK-ENTRIES (2).                            50370006
503800     MOVE +1                     TO  ASC-BLK-SUB                  50380006
503900                                     PV-TOP-ITEM.                 50390006
504000                                                                  50400006
504100     MOVE ZERO                   TO  ASC-ITEM-SUB                 50410006
504200                                     ASC-NUMBER-OF-SELECTED-ITEMS 50420006
504300                                     ASC-START-OF-SELECTED-RANGE  50430006
504400                                     ASC-END-OF-SELECTED-RANGE    50440006
504500                                     ASC-ITEM-AT-TOP-OF-PANEL.    50450006
504600                                                                  50460006
504700     PERFORM 2050-DELETE-LIST-QUEUE.                              50470006
504800     MOVE ASC-KEY-OWNER-SCAC-ID TO DK-OWNER-SCAC-ID.              50480006
504900     MOVE ASC-KEY-VEH-NBR       TO DK-VEH-NBR.                    50490006
505000     MOVE ASC-KEY-TRIP-ID       TO DK-TRIP-ID.                    50500006
505100     PERFORM 4000-BUILD-INITIAL-PANEL.                            50510006
505200     PERFORM 4410-READ-TEMP-STORAGE.                              50520006
505300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        50530006
505400     PERFORM 3200-RESET-ATTRIBUTES.                               50540006
505500/                                                                 50550006
505600*----------------------------------------------------------------*50560006
505700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *50570006
505800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *50580006
505900*----------------------------------------------------------------*50590006
506000                                                                  50600006
506100 5100-WRITE-TEMP-STORAGE.                                         50610006
506200                                                                  50620006
506300     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     50630006
506400                                   TO PV-LIST-ITEM-NUMBER.        50640006
506500     COMPUTE PV-BLOCK-NUMBER =                                    50650006
506600         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    50660006
506700                                                                  50670006
506800     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             50680006
506900     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             50690006
507000         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      50700006
507100             PERFORM 5105-REWRITE-ASC-LISTQ                       50710006
507200         END-IF                                                   50720006
507300     ELSE                                                         50730006
507400         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       50740006
507500         ASC-HIGHEST-BLOCK-WRITTEN + 1                            50750006
507600         PERFORM 5110-WRITE-ASC-LISTQ                             50760006
507700         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   50770006
507800     END-IF.                                                      50780006
507900                                                                  50790006
508000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             50800006
508100                                                                  50810006
508200                                                                  50820006
508300******************************************************************50830006
508400** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **50840006
508500** SPECIFIC COMMAREA.                                           **50850006
508600******************************************************************50860006
508700 5105-REWRITE-ASC-LISTQ.                                          50870006
508800                                                                  50880006
508900     EXEC CICS                                                    50890006
509000         WRITEQ TS                                                50900006
509100             QUEUE (ASC-LIST-QUEUE-NAME)                          50910006
509200             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               50920006
509300             ITEM  (PV-BLOCK-NUMBER)                              50930006
509400             REWRITE                                              50940006
509500             RESP  (PV-CICS-RESP)                                 50950006
509600     END-EXEC.                                                    50960006
509700                                                                  50970006
509800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           50980006
509900         CONTINUE                                                 50990006
510000     ELSE                                                         51000006
510100         SET DP013-CICS-ABEND            TO TRUE                  51010006
510200         SET DP013-NO-ROLLBACK           TO TRUE                  51020006
510300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       51030006
510400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     51040006
510500                                         TO DP013-MESSAGE-TEXT(1) 51050006
510600         PERFORM DP013-0000-PROCESS-ABEND                         51060006
510700     END-IF.                                                      51070006
510800                                                                  51080006
510900                                                                  51090006
511000******************************************************************51100006
511100** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **51110006
511200** SPECIFIC COMMAREA.                                           **51120006
511300******************************************************************51130006
511400 5110-WRITE-ASC-LISTQ.                                            51140006
511500                                                                  51150006
511600     EXEC CICS                                                    51160006
511700         WRITEQ TS                                                51170006
511800             QUEUE (ASC-LIST-QUEUE-NAME)                          51180006
511900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               51190006
512000             ITEM  (PV-BLOCK-NUMBER)                              51200006
512100             RESP  (PV-CICS-RESP)                                 51210006
512200     END-EXEC.                                                    51220006
512300                                                                  51230006
512400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      51240006
512500         SET DP013-CICS-ABEND      TO TRUE                        51250006
512600         SET DP013-NO-ROLLBACK     TO TRUE                        51260006
512700         MOVE '5110-WRITE-ASC-LISTQ'                              51270006
512800                                   TO DP013-PARAGRAPH             51280006
512900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           51290006
513000                                   TO DP013-MESSAGE-TEXT(1)       51300006
513100         PERFORM DP013-0000-PROCESS-ABEND                         51310006
513200     END-IF.                                                      51320006
513300/                                                                 51330006
513400*----------------------------------------------------------------*51340006
513500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *51350006
513600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *51360006
513700*----------------------------------------------------------------*51370006
513800                                                                  51380006
513900 5200-FILL-SEL-QUEUE-RECORD.                                      51390006
514000                                                                  51400006
514100     PERFORM 6112-READ-LIST-QUEUE.                                51410006
514200                                                                  51420006
514300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       51430006
514400         PERFORM                                                  51440006
514500         VARYING LQW-IDX                                          51450006
514600         FROM 1 BY 1                                              51460006
514700         UNTIL LQW-IDX > PC-ITEMS-PER-PANEL                       51470006
514800         OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO                51480006
514900                                                                  51490006
515000             IF  LQW-SELECT (LQW-IDX)                             51500006
515100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              51510006
515200                                   TO RC013-ITEM (RC013-IDX)      51520006
515300                 MOVE LQW-PO-NBR (LQW-IDX) TO                     51530006
515400                     RC013-PO-NBR (RC013-IDX)                     51540006
515500                     RC015-PO-NBR                                 51550006
515600                 MOVE LQW-REC-SEQ-NBR (LQW-IDX) TO                51560006
515700                     RC013-REC-SEQ-NBR (RC013-IDX)                51570006
515800                     RC015-REC-SEQ-NBR                            51580006
515900                 MOVE LQW-SHIPT-ID (LQW-IDX) TO                   51590006
516000                     RC013-SHIPT-ID (RC013-IDX)                   51600006
516100                 MOVE LQW-OPER-UNT-ID (LQW-IDX) TO                51610006
516200                     RC013-OPER-UNT-ID (RC013-IDX)                51620006
516300                 MOVE LQW-FCLTY-ID (LQW-IDX) TO                   51630006
516400                     RC013-FCLTY-ID (RC013-IDX)                   51640006
516500                 SET RC013-IDX UP BY 1                            51650006
516600                 IF  RC013-IDX > RC013-MAX-ITEMS                  51660006
516700                     PERFORM 5205-WRITE-SEL-QUEUE                 51670006
516800*** USE PC000- FIELDS FOR CREATING TROUBLE                        51680006
516900                     IF DP020-FK-LOCAL-FUNC-05(DP020-SRC-AID)     51690006
517000                         ADD +1    TO PC000-NUMBER-OF-TS-ITEMS    51700006
517100                     ELSE                                         51710006
517200                         ADD +1    TO RC015-NUMBER-OF-TS-ITEMS    51720006
517300                     END-IF                                       51730006
517400                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         51740006
517500                     SET RC013-IDX TO  1                          51750006
517600                 END-IF                                           51760006
517700             END-IF                                               51770006
517800         END-PERFORM                                              51780006
517900     END-IF.                                                      51790006
518000                                                                  51800006
518100*----------------------------------------------------------------*51810006
518200*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *51820006
518300*----------------------------------------------------------------*51830006
518400                                                                  51840006
518500 5205-WRITE-SEL-QUEUE.                                            51850006
518600                                                                  51860006
518700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            51870006
518800                                   TO RC013-SELECTED-ITEMS.       51880006
518900                                                                  51890006
519000     EXEC CICS                                                    51900006
519100          WRITEQ TS                                               51910006
519200              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      51920006
519300              FROM  (RC013-DC-SELECT-RECORD)                      51930006
519400              ITEM  (PV-SEL-QUEUE-ITEM)                           51940006
519500              RESP  (PV-CICS-RESP)                                51950006
519600     END-EXEC.                                                    51960006
519700                                                                  51970006
519800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          51980006
519900         CONTINUE                                                 51990006
520000     ELSE                                                         52000006
520100         SET DP013-CICS-ABEND      TO TRUE                        52010006
520200         SET DP013-NO-ROLLBACK     TO TRUE                        52020006
520300         MOVE '5205-WRITE-SEL-QUEUE'                              52030006
520400                                   TO DP013-PARAGRAPH             52040006
520500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          52050006
520600                                   TO DP013-MESSAGE-TEXT(1)       52060006
520700         PERFORM DP013-0000-PROCESS-ABEND                         52070006
520800     END-IF.                                                      52080006
520900/                                                                 52090006
521000                                                                  52100006
521100 5300-SEARCH-FOR-SELECTION.                                       52110006
521200                                                                  52120006
521300     PERFORM 6112-READ-LIST-QUEUE.                                52130006
521400                                                                  52140006
521500     IF PV-CICS-RESP = DFHRESP (NORMAL)                           52150006
521600         PERFORM                                                  52160006
521700         VARYING LQW-IDX  FROM 1 BY 1                             52170006
521800         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  52180006
521900                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            52190006
522000                                                                  52200006
522100             IF LQW-SELECT (LQW-IDX)                              52210006
522200                 EVALUATE TRUE                                    52220006
522300                     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  52230006
522400                         PERFORM 2650-HEADER-ITEMS                52240006
522500                     WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)  52250006
522600                         PERFORM 2660-CARTON-ITEMS                52260006
522700                 END-EVALUATE                                     52270006
522800                 IF PC140-CRA-SUCCESSFUL                          52280006
522900*                   OR PC140-CRA-SUCCESSFUL                       52290006
523000                     SET LQW-DESELECT (LQW-IDX)                   52300006
523100                                     TO TRUE                      52310006
523200                     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS 52320006
523300                 END-IF                                           52330006
523400             END-IF                                               52340006
523500         END-PERFORM                                              52350006
523600     END-IF.                                                      52360006
523700                                                                  52370006
523800/                                                                 52380006
523900******************************************************************52390006
524000** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **52400006
524100** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **52410006
524200** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **52420006
524300** THE USER.                                                    **52430006
524400******************************************************************52440006
524500 6000-REFRESH-PANEL-FROM-TEMP.                                    52450006
524600                                                                  52460006
524700     IF  ASC-UPDATE-TSQ                                           52470006
524800         SET ASC-NO-TSQ-UPDATE TO TRUE                            52480006
524900         MOVE ZERO                 TO PV-SAVE-ITEM                52490006
525000                                      PV-SEL-QUEUE-ITEM           52500006
525100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        52510006
525200                                   TO PV-HOLD-SELECTED-ITEMS      52520006
525300         PERFORM 6100-UPDATE-TSQ                                  52530006
525400             UNTIL PV-ITEMS-PROCESSED >                           52540006
525500                                     ASC-NUMBER-OF-SELECTED-ITEMS 52550006
525600         PERFORM 6010-DELETE-SEL-QUEUE                            52560006
525700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         52570006
525800                    ASC-BLOCK-ENTRIES (2)                         52580006
525900     END-IF.                                                      52590006
526000                                                                  52600006
526100                                                                  52610006
526200*----------------------------------------------------------------*52620006
526300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *52630006
526400*----------------------------------------------------------------*52640006
526500 6010-DELETE-SEL-QUEUE.                                           52650006
526600                                                                  52660006
526700     EXEC CICS                                                    52670006
526800         DELETEQ TS                                               52680006
526900             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       52690006
527000             RESP  (PV-CICS-RESP)                                 52700006
527100     END-EXEC.                                                    52710006
527200                                                                  52720006
527300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      52730006
527400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         52740006
527500         CONTINUE                                                 52750006
527600     ELSE                                                         52760006
527700         SET DP013-CICS-ABEND TO TRUE                             52770006
527800         SET DP013-NO-ROLLBACK TO TRUE                            52780006
527900         MOVE '6010-DELETE-SEL-QUEUE'                             52790006
528000                        TO DP013-PARAGRAPH                        52800006
528100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         52810006
528200                        TO DP013-MESSAGE-TEXT (1)                 52820006
528300         PERFORM DP013-0000-PROCESS-ABEND                         52830006
528400     END-IF.                                                      52840006
528500                                                                  52850006
528600                                                                  52860006
528700*----------------------------------------------------------------*52870006
528800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *52880006
528900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *52890006
529000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *52900006
529100*    THE TEMP QUEUE.                                             *52910006
529200*----------------------------------------------------------------*52920006
529300                                                                  52930006
529400 6100-UPDATE-TSQ.                                                 52940006
529500                                                                  52950006
529600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             52960006
529700     PERFORM 6105-READ-SEL-QUEUE.                                 52970006
529800     PERFORM                                                      52980006
529900         VARYING RC013-IDX                                        52990006
530000         FROM 1 BY 1                                              53000006
530100         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     53010006
530200         OR (RC013-IDX > RC013-MAX-ITEMS))                        53020006
530300         IF  RC013-ACTION-SW (RC013-IDX) > SPACE                  53030006
530400             PERFORM 6110-PROCESS-ITEMS                           53040006
530500         END-IF                                                   53050006
530600         ADD +1                TO PV-ITEMS-PROCESSED              53060006
530700     END-PERFORM.                                                 53070006
530800     PERFORM 6111-WRITE-LIST-QUEUE.                               53080006
530900                                                                  53090006
531000                                                                  53100006
531100*----------------------------------------------------------------*53110006
531200*    READ THE LIST QUEUE RECORD.                                 *53120006
531300*----------------------------------------------------------------*53130006
531400                                                                  53140006
531500 6105-READ-SEL-QUEUE.                                             53150006
531600                                                                  53160006
531700     EXEC CICS                                                    53170006
531800          READQ TS                                                53180006
531900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      53190006
532000              INTO  (RC013-DC-SELECT-RECORD)                      53200006
532100              ITEM  (PV-SEL-QUEUE-ITEM)                           53210006
532200              RESP  (PV-CICS-RESP)                                53220006
532300     END-EXEC.                                                    53230006
532400                                                                  53240006
532500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          53250006
532600     OR  PV-CICS-RESP = DFHRESP (QIDERR)                          53260006
532700         CONTINUE                                                 53270006
532800     ELSE                                                         53280006
532900         SET DP013-CICS-ABEND      TO  TRUE                       53290006
533000         SET DP013-NO-ROLLBACK     TO  TRUE                       53300006
533100         MOVE '6105-READ-SEL-QUEUE'                               53310006
533200                                   TO  DP013-PARAGRAPH            53320006
533300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           53330006
533400                                   TO  DP013-MESSAGE-TEXT(1)      53340006
533500         PERFORM DP013-0000-PROCESS-ABEND                         53350006
533600     END-IF.                                                      53360006
533700/                                                                 53370006
533800*----------------------------------------------------------------*53380006
533900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*53390006
534000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY. CALCULATE *53400006
534100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *53410006
534200*----------------------------------------------------------------*53420006
534300                                                                  53430006
534400 6110-PROCESS-ITEMS.                                              53440006
534500                                                                  53450006
534600     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          53460006
534700                     / PC-ITEMS-PER-PANEL).                       53470006
534800                                                                  53480006
534900     IF  PV-ITEM NOT = PV-SAVE-ITEM                               53490006
535000         IF  PV-SAVE-ITEM NOT = ZERO                              53500006
535100             PERFORM 6111-WRITE-LIST-QUEUE                        53510006
535200         END-IF                                                   53520006
535300         MOVE PV-ITEM          TO PV-SAVE-ITEM                    53530006
535400                                                                  53540006
535500         PERFORM 6112-READ-LIST-QUEUE                             53550006
535600         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               53560006
535700             CONTINUE                                             53570006
535800         END-IF                                                   53580006
535900     END-IF.                                                      53590006
536000                                                                  53600006
536100     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     53610006
536200                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              53620006
536300     SET LQW-DESELECT (PV-SUB) TO    TRUE                         53630006
536400     MOVE LQW-SELECTED-SW (PV-SUB)                                53640006
536500                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  53650006
536600     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                53660006
536700/                                                                 53670006
536800*----------------------------------------------------------------*53680006
536900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN 6100.             *53690006
537000*----------------------------------------------------------------*53700006
537100                                                                  53710006
537200 6111-WRITE-LIST-QUEUE.                                           53720006
537300                                                                  53730006
537400     EXEC CICS                                                    53740006
537500         WRITEQ TS                                                53750006
537600             QUEUE (ASC-LIST-QUEUE-NAME)                          53760006
537700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     53770006
537800             ITEM  (PV-SAVE-ITEM)                                 53780006
537900             REWRITE                                              53790006
538000             RESP  (PV-CICS-RESP)                                 53800006
538100     END-EXEC.                                                    53810006
538200                                                                  53820006
538300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          53830006
538400     OR  PV-CICS-RESP = DFHRESP (ITEMERR)                         53840006
538500         CONTINUE                                                 53850006
538600     ELSE                                                         53860006
538700         SET DP013-CICS-ABEND  TO  TRUE                           53870006
538800         SET DP013-NO-ROLLBACK TO  TRUE                           53880006
538900         MOVE '6111-WRITE-LIST-QUEUE'                             53890006
539000                               TO  DP013-PARAGRAPH                53900006
539100         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  53910006
539200                               TO  DP013-MESSAGE-TEXT(1)          53920006
539300         PERFORM DP013-0000-PROCESS-ABEND                         53930006
539400     END-IF.                                                      53940006
539500                                                                  53950006
539600                                                                  53960006
539700*----------------------------------------------------------------*53970006
539800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*53980006
539900*----------------------------------------------------------------*53990006
540000                                                                  54000006
540100 6112-READ-LIST-QUEUE.                                            54010006
540200                                                                  54020006
540300     EXEC CICS                                                    54030006
540400         READQ TS                                                 54040006
540500             QUEUE (ASC-LIST-QUEUE-NAME)                          54050006
540600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     54060006
540700             ITEM  (PV-ITEM)                                      54070006
540800             RESP  (PV-CICS-RESP)                                 54080006
540900     END-EXEC.                                                    54090006
541000                                                                  54100006
541100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          54110006
541200         CONTINUE                                                 54120006
541300     ELSE                                                         54130006
541400         SET DP013-CICS-ABEND        TO TRUE                      54140006
541500         SET DP013-NO-ROLLBACK       TO TRUE                      54150006
541600         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           54160006
541700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    54170006
541800                                     TO DP013-MESSAGE-TEXT(1)     54180006
541900         PERFORM DP013-0000-PROCESS-ABEND                         54190006
542000     END-IF.                                                      54200006
542100/                                                                 54210006
542200*-----------------------------------------------------------------54220006
542300* CHECK TO SEE IF THIS DC IS DOWNLOADING ASN'S TO WMS             54230006
542400*-----------------------------------------------------------------54240006
542500 6300-CHECK-DC-OK-FOR-DWNLD.                                      54250006
542600                                                                  54260006
542700     SET PS-DWNLD-TO-WMS-NO   TO TRUE.                            54270006
542800     MOVE ASC-KEY-OPER-UNT-ID TO KRPRPM-LOC-ID.                   54280006
542900                                                                  54290006
543000     PERFORM                                                      54300006
543100         WITH TEST AFTER                                          54310006
543200         VARYING PV-RETRY-COUNTER                                 54320006
543300         FROM 1 BY 1                                              54330006
543400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               54340006
543500            OR (SQLCODE = +0)                                     54350006
543600            OR (SQLCODE = +100))                                  54360006
543700                                                                  54370006
543800         EXEC SQL                                                 54380006
543900              SELECT   FUNC_TXT                                   54390006
544000                    ,  FUNC_BEG_TMST                              54400006
544100                    ,  FUNC_END_TMST                              54410006
544200                INTO  :KRPRPM-FUNC-TXT                            54420006
544300                    , :KRPRPM-FUNC-BEG-TMST                       54430006
544400                    , :KRPRPM-FUNC-END-TMST                       54440006
544500                FROM                                              54450006
544600                      TKRPRPM A                                   54460006
544700                WHERE                                             54470006
544800                      LOC_ID            = :KRPRPM-LOC-ID          54480006
544900                  AND SYS_PRC_FUNC_CDE  = :PC-DWNLD-CDE           54490006
545000                  AND FUNC_PRC_STAT_CDE = 'AC'                    54500006
545100                  AND INTFC_SYS_CDE     = 'KHL'                   54510006
545200                  AND FUNC_BEG_TMST     <= CURRENT TIMESTAMP      54520006
545210                 WITH UR                                          54521008
545300         END-EXEC                                                 54530006
545400                                                                  54540006
545500         EVALUATE TRUE                                            54550006
545600             WHEN SQLCODE = +0                                    54560006
545700                  SET  PS-DWNLD-TO-WMS-YES TO  TRUE               54570006
545800             WHEN SQLCODE = +100                                  54580006
545810                  SET  PS-DWNLD-TO-WMS-NO  TO  TRUE               54581006
545820                                                                  54582006
545830             WHEN SQLWARN0 NOT = SPACES                           54583006
545840             WHEN SQLCODE < +0                                    54584006
545850             WHEN SQLCODE > +0                                    54585006
545860                  MOVE '6300-CHECK-DC-OK-FOR-DWNLD'               54586006
545870                                  TO DP013-PARAGRAPH              54587006
545880                  MOVE 'UNSUCCESSFUL SELECT ON TKRPRPM'           54588006
545890                                  TO DP013-MESSAGE-TEXT (1)       54589006
545900                  MOVE SQLCA      TO DP013-SQLCA                  54590006
546000                  MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)     54600006
546100                  SET DP013-DB2-ABEND                             54610006
546200                      DP013-XCTL-DISPLAY-RESTART                  54620006
546300                                  TO TRUE                         54630006
546400                  PERFORM DP013-0000-PROCESS-ABEND                54640006
546500         END-EVALUATE                                             54650006
546600     END-PERFORM.                                                 54660006
546700                                                                  54670006
546800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    54680006
546900         SQLCODE NOT = +0                                         54690006
547000         MOVE '6300-CHECK-DC-OK-FOR-DWNLD'                        54700006
547100                                  TO DP013-PARAGRAPH              54710006
547200         MOVE 'MAX RETRIES EXCEEDED ON SELECT TKRPRPM'            54720006
547300                                  TO DP013-MESSAGE-TEXT (1)       54730006
547400         MOVE SQLCA               TO DP013-SQLCA                  54740006
547500         MOVE 'TKRPRPM '          TO DP013-DB2-TABLE-NAME (1)     54750006
547600         SET DP013-DB2-ABEND                                      54760006
547700             DP013-XCTL-DISPLAY-RESTART                           54770006
547800                                  TO TRUE                         54780006
547900         PERFORM DP013-0000-PROCESS-ABEND                         54790006
548000     END-IF.                                                      54800006
548100                                                                  54810006
548200*-----------------------------------------------------------------54820006
548300* THIS OPENS A CURSOR ON THE HDR TBL, THEN A DWNLOAD TO WMS SWITCH54830006
548400* GETS SET IF THERE ARE RECEIVERS WHERE 1 OR MORE ARE TRANSCRIBED 54840006
548500*-----------------------------------------------------------------54850006
548600 6400-PROCESS-DWNLD.                                              54860006
548700                                                                  54870006
548800* JAK 05/07/07 - SET SWITCH TO NO TO BEGIN WITH                   54880006
548900*       SET PS-CALL-DWNLD-MODULE-YES TO TRUE.                     54890006
549000        SET PS-CALL-DWNLD-MODULE-NO  TO TRUE.                     54900006
549100                                                                  54910006
549200        PERFORM 6410-OPEN-HDR-CSR.                                54920006
549300        PERFORM 6420-FETCH-HDR-CSR                                54930006
549400          UNTIL PS-END-OF-HDR-CSR-YES.                            54940006
549500        PERFORM 6430-CLOSE-HDR-CSR.                               54950006
549600                                                                  54960006
549700*-----------------------------------------------------------------54970006
549800* OPEN HDR_CSR                                                    54980006
549900*-----------------------------------------------------------------54990006
550000 6410-OPEN-HDR-CSR.                                               55000006
550100                                                                  55010006
550200     PERFORM                                                      55020006
550300         WITH TEST AFTER                                          55030006
550400         VARYING PV-RETRY-COUNTER                                 55040006
550500         FROM 1 BY 1                                              55050006
550600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               55060006
550700            OR (SQLCODE = +0))                                    55070006
550800                                                                  55080006
550900         EXEC SQL                                                 55090006
551000              OPEN HDR_CSR                                        55100006
551100         END-EXEC                                                 55110006
551200                                                                  55120006
551300         EVALUATE TRUE                                            55130006
551400             WHEN SQLCODE = +0                                    55140006
551500                  SET PS-FIRST-RECORD-YES TO TRUE                 55150006
551600             WHEN SQLCODE = -904                                  55160006
551700             WHEN SQLCODE = -913                                  55170006
551800                  CONTINUE                                        55180006
551900             WHEN SQLWARN0 NOT = SPACE                            55190006
552000             WHEN SQLCODE  NOT = +0                               55200006
552100                  MOVE '6410-OPEN-HDR-CSR'                        55210006
552200                                   TO DP013-PARAGRAPH             55220006
552300                  MOVE 'OPEN XREF HDR CURSOR'                     55230006
552400                                   TO DP013-MESSAGE-TEXT (1)      55240006
552500                  MOVE SQLCA       TO DP013-SQLCA                 55250006
552600                  MOVE 'WST_SHPMT_XREF_HDR'                       55260006
552700                                   TO DP013-DB2-TABLE-NAME (1)    55270006
552800                  SET DP013-DB2-ABEND                             55280006
552900                                   TO TRUE                        55290006
553000                  PERFORM DP013-0000-PROCESS-ABEND                55300006
553100         END-EVALUATE                                             55310006
553200     END-PERFORM.                                                 55320006
553300                                                                  55330006
553400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    55340006
553500         SQLCODE NOT = +0                                         55350006
553600         MOVE '6410-OPEN-HDR-CSR'                                 55360006
553700                                   TO DP013-PARAGRAPH             55370006
553800         MOVE 'MAX RETRIES EXCEEDED FOR OPEN HDR CURSOR'          55380006
553900                                   TO DP013-MESSAGE-TEXT (1)      55390006
554000         MOVE SQLCA                TO DP013-SQLCA                 55400006
554100         SET DP013-DB2-ABEND       TO TRUE                        55410006
554200         PERFORM DP013-0000-PROCESS-ABEND                         55420006
554300     END-IF.                                                      55430006
554400                                                                  55440006
554500*-----------------------------------------------------------------55450006
554600* FETCH  HDR_CSR                                                  55460006
554700*-----------------------------------------------------------------55470006
554800 6420-FETCH-HDR-CSR.                                              55480006
554900                                                                  55490006
555000     EXEC SQL                                                     55500006
555100          FETCH HDR_CSR                                           55510006
555200          INTO                                                    55520006
555300                :WST00001-EXT-SHP-ID                              55530006
555400               ,:WST00001-RCPT-TMST                               55540006
555500     END-EXEC                                                     55550006
555600                                                                  55560006
555700     EVALUATE TRUE                                                55570006
555800         WHEN SQLCODE = +0                                        55580006
555900* JAK 05/07/07 - SET SWITCH TO YES IF ANY HEADER NOT RCVD         55590006
556000*             IF WST00001-RCPT-TMST = PC-DEFAULT-NINES            55600006
556100*                CONTINUE                                         55610006
556200*             ELSE                                                55620006
556300*                SET PS-CALL-DWNLD-MODULE-NO  TO TRUE             55630006
556400*             END-IF                                              55640006
556500              IF WST00001-RCPT-TMST = PC-DEFAULT-NINES            55650006
556510                 SET PS-CALL-DWNLD-MODULE-YES TO TRUE             55651006
556520              END-IF                                              55652006
556530              SET PS-FIRST-RECORD-NO          TO TRUE             55653006
556540         WHEN SQLCODE = +100                                      55654006
556550              SET PS-END-OF-HDR-CSR-YES TO TRUE                   55655006
556560* JAK 05/21/07 - IF NO RECORDS HAVE BEEN FOUND, SET CALL DWNLD    55656006
556570*                MODULE SWITCH ON                                 55657006
556580              IF PS-FIRST-RECORD-YES                              55658006
556590                 SET PS-CALL-DWNLD-MODULE-YES TO TRUE             55659006
556600              END-IF                                              55660006
556700         WHEN SQLWARN0 NOT = SPACE                                55670006
556800         WHEN SQLCODE < +0                                        55680006
556900         WHEN SQLCODE > +0                                        55690006
557000              MOVE '6420-FETCH-HDR-CSR'                           55700006
557100                                   TO DP013-PARAGRAPH             55710006
557200              MOVE 'FETCH HDR CURSOR'                             55720006
557300                                   TO DP013-MESSAGE-TEXT (1)      55730006
557400              MOVE SQLCA           TO DP013-SQLCA                 55740006
557500              MOVE 'WST_SHPMT_XREF_HDR'                           55750006
557600                                   TO DP013-DB2-TABLE-NAME (1)    55760006
557700              SET DP013-DB2-ABEND  TO TRUE                        55770006
557800              PERFORM DP013-0000-PROCESS-ABEND                    55780006
557900     END-EVALUATE.                                                55790006
558000                                                                  55800006
558100*-----------------------------------------------------------------55810006
558200* CLOSE HDR_CSR                                                   55820006
558300*-----------------------------------------------------------------55830006
558400 6430-CLOSE-HDR-CSR.                                              55840006
558500                                                                  55850006
558600     EXEC SQL                                                     55860006
558700          CLOSE HDR_CSR                                           55870006
558800     END-EXEC                                                     55880006
558900                                                                  55890006
559000     EVALUATE TRUE                                                55900006
559100         WHEN SQLCODE = +0                                        55910006
559200              CONTINUE                                            55920006
559300         WHEN SQLWARN0 NOT = SPACE                                55930006
559400         WHEN SQLCODE  NOT = +0                                   55940006
559500              MOVE '6430-CLOSE-HDR-CSR'                           55950006
559600                                   TO DP013-PARAGRAPH             55960006
559700              MOVE 'CLOSE HDR CURSOR'                             55970006
559800                                   TO DP013-MESSAGE-TEXT (1)      55980006
559900              MOVE SQLCA           TO DP013-SQLCA                 55990006
560000              MOVE 'WST_SHPMT_XREF_HDR'                           56000006
560100                                   TO DP013-DB2-TABLE-NAME (1)    56010006
560200              SET DP013-DB2-ABEND  TO TRUE                        56020006
560300              PERFORM DP013-0000-PROCESS-ABEND                    56030006
560400     END-EVALUATE.                                                56040006
560500                                                                  56050006
560600*-----------------------------------------------------------------56060006
560700* -CHECK FOR TRANSCRIBED RECEIVERS                                56070006
560800*-----------------------------------------------------------------56080006
560900 6500-CHECK-TRANSCRIBED-RCVRS.                                    56090006
561000                                                                  56100006
561100     MOVE 0 TO PV-TRANS-RCVRS-COUNT.                              56110006
561200                                                                  56120006
561300         EXEC SQL                                                 56130006
561400              SELECT  COUNT(*)                                    56140006
561500                INTO :PV-TRANS-RCVRS-COUNT                        56150006
561600                FROM  TSHIPMT A                                   56160006
561700                    , TSHPTPO B                                   56170006
561800                    , TPKSLIP C                                   56180006
561900               WHERE  A.TRIP_ID        = :ASC-KEY-TRIP-ID         56190006
562000                 AND  A.SHIPT_ID       = B.SHIPT_ID               56200006
562100                 AND  B.PO_NBR         = C.PO_NBR                 56210006
562200                 AND  B.REC_SEQ_NBR    = C.REC_SEQ_NBR            56220006
562300                 AND  C.VER_STAT_CDE   = 'A'                      56230006
562400                 AND  C.PKSL_STAT_CDE  = 'AC'                     56240006
562401               FETCH FIRST 1 ROW ONLY                             56240108
562410                WITH UR                                           56241008
562500         END-EXEC                                                 56250006
562600                                                                  56260006
562700         EVALUATE TRUE                                            56270006
562800             WHEN SQLCODE = +0                                    56280006
562900                  IF PV-TRANS-RCVRS-COUNT > 0                     56290006
563000                     SET  PS-TRANS-RCVRS TO TRUE                  56300006
563100                  END-IF                                          56310006
563200                                                                  56320006
563300             WHEN SQLWARN0 NOT = SPACES                           56330006
563400             WHEN SQLCODE < +0                                    56340006
563500             WHEN SQLCODE > +0                                    56350006
563600                  MOVE '6500-CHECK-TRANSCRIBED-RCVRS'             56360006
563700                                  TO DP013-PARAGRAPH              56370006
563800                  MOVE 'UNSUCCESSFUL SELECT ON TPKSLIP'           56380006
563900                                  TO DP013-MESSAGE-TEXT (1)       56390006
564000                  MOVE SQLCA      TO DP013-SQLCA                  56400006
564100                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     56410006
564200                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (2)     56420006
564300                  MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME (3)     56430006
564400                  SET DP013-DB2-ABEND                             56440006
564500                      DP013-XCTL-DISPLAY-RESTART                  56450006
564600                                  TO TRUE                         56460006
564700                  PERFORM DP013-0000-PROCESS-ABEND                56470006
564800         END-EVALUATE.                                            56480006
564900                                                                  56490006
565000*-----------------------------------------------------------------56500006
565100*  SET UP INPUT FIELDS FOR CONTROL MODULE TO DOWNLOAD TO WMS      56510006
565200*-----------------------------------------------------------------56520006
565300 6600-CALL-WMS-MODULE.                                            56530006
565400                                                                  56540006
565500     INITIALIZE WS001-FIELDS.                                     56550006
565600                                                                  56560006
565700     SET WS001-MANUAL-DOWNLOAD        TO TRUE.                    56570006
565800     MOVE ASC-KEY-TRIP-ID             TO WS001-TRIP-ID .          56580006
565900     MOVE +0                          TO WS001-KOHLS-SHIPT-ID.    56590006
566000     MOVE ASC-KEY-OPER-UNT-ID         TO WS001-OPER-UNT-ID.       56600006
566100     SET WS001-SOURCE-RCVNG           TO TRUE.                    56610006
566200     MOVE DP020-USERID                TO WS001-USER-ID.           56620006
566300     MOVE DP020-SRC-TASK-NUMBER       TO WS001-SRC-TASK-NUMBER.   56630006
566400     MOVE +0                          TO WS001-PO-LNE-NBR.        56640006
566500     MOVE +0                          TO WS001-PREPK-ID.          56650006
566600     MOVE  0                          TO WS001-SKU-NBR.           56660006
566700     MOVE  SPACE                      TO WS001-DTL-ASN-LEVEL-IND. 56670006
566800     MOVE PC-CURRENT-PROGRAM-NAME                                 56680006
566900                                  TO WS001-CALLING-PROGRAM-NAME.  56690006
567000     PERFORM 6650-CALL-WMS-MODULE.                                56700006
567100                                                                  56710006
567200*-----------------------------------------------------------------56720006
567300*  CALL CONTROL MODULE TO DOWNLOAD TO WMS                         56730006
567400*-----------------------------------------------------------------56740006
567500 6650-CALL-WMS-MODULE.                                            56750006
567600     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         56760006
567700                                                                  56770006
567800     EXEC CICS                                                    56780006
567900         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       56790006
568000              COMMAREA (WS001-FIELDS)                             56800006
568100              LENGTH   (PV-COMMAREA-LENGTH)                       56810006
568200     END-EXEC.                                                    56820006
568300                                                                  56830006
568400     EVALUATE TRUE                                                56840006
568500         WHEN WS001-SUCCESSFUL                                    56850006
568600              CONTINUE                                            56860006
568700         WHEN WS001-DATABASE-BUSY OR                              56870006
568800              WS001-INVALID-SQL                                   56880006
568900                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       56890006
569000                  SET DP020-MSG-WARNING TO TRUE                   56900006
569100                  SET DP030-OVERRIDE-GO TO TRUE                   56910006
569200                  SET PS-ERROR          TO TRUE                   56920006
569300                                                                  56930006
569400                                                                  56940006
569500              INITIALIZE PV-CICS-MSG-AREA                         56950006
569600              STRING 'RCKCS225-'                                  56960006
569700                     '6650-CALL-WMS-MODULE - '                    56970006
569800              DELIMITED BY SIZE                                   56980006
569900              INTO PV-CICS-MSG-AREA                               56990006
570000              PERFORM 9300-WRITE-CICS-LOG                         57000006
570100                                                                  57010006
570200              INITIALIZE PV-CICS-MSG-AREA                         57020006
570300              STRING 'RCKCS225-'                                  57030006
570400                     WS001-CRA-RET-MSG                            57040006
570500              DELIMITED BY SIZE                                   57050006
570600              INTO PV-CICS-MSG-AREA                               57060006
570700              PERFORM 9300-WRITE-CICS-LOG                         57070006
570800                                                                  57080006
570900                                                                  57090006
571000         WHEN WS001-ERROR                                         57100006
571100                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       57110006
571200                  SET DP020-MSG-WARNING TO TRUE                   57120006
571300                  SET DP030-OVERRIDE-GO TO TRUE                   57130006
571400                  SET PS-ERROR          TO TRUE                   57140006
571500                                                                  57150006
571600              INITIALIZE PV-CICS-MSG-AREA                         57160006
571700              STRING 'RCKCS225-'                                  57170006
571800                     '6650-CALL-WMS-MODULE - '                    57180006
571900              DELIMITED BY SIZE                                   57190006
572000              INTO PV-CICS-MSG-AREA                               57200006
572100              PERFORM 9300-WRITE-CICS-LOG                         57210006
572200                                                                  57220006
572300              INITIALIZE PV-CICS-MSG-AREA                         57230006
572400              STRING 'RCKCS225-'                                  57240006
572500                     WS001-CRA-RET-MSG                            57250006
572600              DELIMITED BY SIZE                                   57260006
572700              INTO PV-CICS-MSG-AREA                               57270006
572800              PERFORM 9300-WRITE-CICS-LOG                         57280006
572900                                                                  57290006
573000         WHEN OTHER                                               57300006
573100                                                                  57310006
573200              INITIALIZE PV-CICS-MSG-AREA                         57320006
573300              STRING 'RCKCS225-'                                  57330006
573400                     '6650-CALL-WMS-MODULE - '                    57340006
573500              DELIMITED BY SIZE                                   57350006
573600              INTO PV-CICS-MSG-AREA                               57360006
573700              PERFORM 9300-WRITE-CICS-LOG                         57370006
573800                                                                  57380006
573900              INITIALIZE PV-CICS-MSG-AREA                         57390006
574000              STRING 'RCKCS225-'                                  57400006
574100                     WS001-CRA-RET-MSG                            57410006
574200              DELIMITED BY SIZE                                   57420006
574300              INTO PV-CICS-MSG-AREA                               57430006
574400              PERFORM 9300-WRITE-CICS-LOG                         57440006
574500                                                                  57450006
574600             MOVE '6650-CALL-WMS-MODULE' TO DP013-PARAGRAPH       57460006
574700             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 57470006
574800                                         TO DP013-MESSAGE-TEXT (1)57480006
574900             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)57490006
575000             MOVE WS001-SQLCA            TO DP013-SQLCA           57500006
575100             SET DP013-DB2-ABEND                                  57510006
575200                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              57520006
575300             SET PS-ERROR                    TO TRUE              57530006
575400             PERFORM DP013-0000-PROCESS-ABEND                     57540006
575500                                                                  57550006
575600     END-EVALUATE.                                                57560006
575700                                                                  57570006
575800*-----------------------------------------------------------------57580006
575900* THIS OPENS A CURSOR ON THE HDR TBL, THEN A DWNLOAD TO WMS SWITCH57590006
576000* GETS SET IF THERE ARE RECEIVERS WHERE 1 OR MORE ARE TRANSCRIBED 57600006
576100*-----------------------------------------------------------------57610006
576200 6700-CHECK-FOR-TRBL-RECS.                                        57620006
576300                                                                  57630006
576400        SET PS-TRBL-DUMMY-NO         TO TRUE.                     57640006
576500                                                                  57650006
576600        PERFORM 6710-OPEN-TRBL-CSR.                               57660006
576700        PERFORM 6720-FETCH-TRBL-CSR                               57670006
576800          UNTIL PS-END-OF-TRBL-CSR-YES.                           57680006
576900        PERFORM 6730-CLOSE-TRBL-CSR.                              57690006
577000                                                                  57700006
577100*-----------------------------------------------------------------57710006
577200* OPEN TRBL_CSR                                                   57720006
577300*-----------------------------------------------------------------57730006
577400 6710-OPEN-TRBL-CSR.                                              57740006
577500                                                                  57750006
577600     PERFORM                                                      57760006
577700         WITH TEST AFTER                                          57770006
577800         VARYING PV-RETRY-COUNTER                                 57780006
577900         FROM 1 BY 1                                              57790006
578000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               57800006
578001            OR (SQLCODE = +0))                                    57800106
578002                                                                  57800206
578003         EXEC SQL                                                 57800306
578004              OPEN TRBL_CSR                                       57800406
578005         END-EXEC                                                 57800506
578006                                                                  57800606
578007         EVALUATE TRUE                                            57800706
578008             WHEN SQLCODE = +0                                    57800806
578009                  CONTINUE                                        57800906
578010             WHEN SQLCODE = -904                                  57801006
578011             WHEN SQLCODE = -913                                  57801106
578012                  CONTINUE                                        57801206
578013             WHEN SQLWARN0 NOT = SPACE                            57801306
578014             WHEN SQLCODE  NOT = +0                               57801406
578015                  MOVE '6710-OPEN-TRBL-CSR'                       57801506
578016                                   TO DP013-PARAGRAPH             57801606
578017                  MOVE 'OPEN XREF TRBL CURSOR'                    57801706
578018                                   TO DP013-MESSAGE-TEXT (1)      57801806
578019                  MOVE SQLCA       TO DP013-SQLCA                 57801906
578020                  MOVE 'WST_SHPMT_XREF_HDR'                       57802006
578021                                   TO DP013-DB2-TABLE-NAME (1)    57802106
578022                  MOVE 'WST_SHPMT_XREF_DTL'                       57802206
578023                                   TO DP013-DB2-TABLE-NAME (2)    57802306
578024                  SET DP013-DB2-ABEND                             57802406
578025                                   TO TRUE                        57802506
578026                  PERFORM DP013-0000-PROCESS-ABEND                57802606
578027         END-EVALUATE                                             57802706
578028     END-PERFORM.                                                 57802806
578029                                                                  57802906
578030     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    57803006
578031         SQLCODE NOT = +0                                         57803106
578032         MOVE '6710-OPEN-TRBL-CSR'                                57803206
578033                                   TO DP013-PARAGRAPH             57803306
578034         MOVE 'MAX RETRIES EXCEEDED FOR OPEN TRBL CURSOR'         57803406
578035                                   TO DP013-MESSAGE-TEXT (1)      57803506
578036         MOVE SQLCA                TO DP013-SQLCA                 57803606
578037         SET DP013-DB2-ABEND       TO TRUE                        57803706
578038         PERFORM DP013-0000-PROCESS-ABEND                         57803806
578039     END-IF.                                                      57803906
578040                                                                  57804006
578041*-----------------------------------------------------------------57804106
578042* FETCH  TRBL_CSR                                                 57804206
578043*-----------------------------------------------------------------57804306
578044 6720-FETCH-TRBL-CSR.                                             57804406
578045                                                                  57804506
578046     EXEC SQL                                                     57804606
578047          FETCH TRBL_CSR                                          57804706
578048          INTO                                                    57804806
578049                :WST00001-EXT-SHP-ID                              57804906
578050     END-EXEC                                                     57805006
578051                                                                  57805106
578052     EVALUATE TRUE                                                57805206
578053         WHEN SQLCODE = +0                                        57805306
578054              SET PS-TRBL-DUMMY-YES      TO TRUE                  57805406
578055              PERFORM 6740-CALL-WMS-MODULE                        57805506
578056         WHEN SQLCODE = +100                                      57805606
578057              SET PS-END-OF-TRBL-CSR-YES TO TRUE                  57805706
578058                                                                  57805806
578059         WHEN SQLWARN0 NOT = SPACE                                57805906
578060         WHEN SQLCODE < +0                                        57806006
578070         WHEN SQLCODE > +0                                        57807006
578071              MOVE '6720-FETCH-TRBL-CSR'                          57807106
578072                                   TO DP013-PARAGRAPH             57807206
578073              MOVE 'FETCH TRBL CURSOR'                            57807306
578074                                   TO DP013-MESSAGE-TEXT (1)      57807406
578075              MOVE SQLCA           TO DP013-SQLCA                 57807506
578076              MOVE 'WST_SHPMT_XREF_HDR'                           57807606
578077                                   TO DP013-DB2-TABLE-NAME (1)    57807706
578078              MOVE 'WST_SHPMT_XREF_DTL'                           57807806
578079                                   TO DP013-DB2-TABLE-NAME (2)    57807906
578080              SET DP013-DB2-ABEND  TO TRUE                        57808006
578081              PERFORM DP013-0000-PROCESS-ABEND                    57808106
578082     END-EVALUATE.                                                57808206
578083                                                                  57808306
578084*-----------------------------------------------------------------57808406
578085* CLOSE TRBL_CSR                                                  57808506
578086*-----------------------------------------------------------------57808606
578087 6730-CLOSE-TRBL-CSR.                                             57808706
578088                                                                  57808806
578089     EXEC SQL                                                     57808906
578090          CLOSE TRBL_CSR                                          57809006
578091     END-EXEC                                                     57809106
578092                                                                  57809206
578093     EVALUATE TRUE                                                57809306
578094         WHEN SQLCODE = +0                                        57809406
578095              CONTINUE                                            57809506
578096         WHEN SQLWARN0 NOT = SPACE                                57809606
578097         WHEN SQLCODE  NOT = +0                                   57809706
578098              MOVE '6730-CLOSE-TRBL-CSR'                          57809806
578099                                   TO DP013-PARAGRAPH             57809906
578100              MOVE 'CLOSE TRBL CURSOR'                            57810006
578101                                   TO DP013-MESSAGE-TEXT (1)      57810106
578102              MOVE SQLCA           TO DP013-SQLCA                 57810206
578103              MOVE 'WST_SHPMT_XREF_HDR'                           57810306
578104                                   TO DP013-DB2-TABLE-NAME (1)    57810406
578105              MOVE 'WST_SHPMT_XREF_DTL'                           57810506
578106                                   TO DP013-DB2-TABLE-NAME (2)    57810606
578107              SET DP013-DB2-ABEND  TO TRUE                        57810706
578108              PERFORM DP013-0000-PROCESS-ABEND                    57810806
578109     END-EVALUATE.                                                57810906
578110                                                                  57811006
578111*-----------------------------------------------------------------57811106
578112*  SET UP INPUT FIELDS FOR CONTROL MODULE TO CREATE DUMMY REC     57811206
578113*-----------------------------------------------------------------57811306
578114 6740-CALL-WMS-MODULE.                                            57811406
578115                                                                  57811506
578116     INITIALIZE WS001-FIELDS.                                     57811606
578117                                                                  57811706
578118     SET WS001-CREATE-DUMMY           TO TRUE.                    57811806
578119     MOVE WST00001-EXT-SHP-ID         TO WS001-EXT-SHP-ID.        57811906
578120     MOVE ASC-KEY-TRIP-ID             TO WS001-TRIP-ID.           57812006
578121     MOVE +0                          TO WS001-KOHLS-SHIPT-ID.    57812106
578122     MOVE ASC-KEY-OPER-UNT-ID         TO WS001-OPER-UNT-ID.       57812206
578123     SET WS001-SOURCE-RCVNG           TO TRUE.                    57812306
578124     MOVE DP020-USERID                TO WS001-USER-ID.           57812406
578125     MOVE DP020-SRC-TASK-NUMBER       TO WS001-SRC-TASK-NUMBER.   57812506
578126     MOVE +0                          TO WS001-PO-NBR.            57812606
578127     MOVE +0                          TO WS001-RCVR-NBR.          57812706
578128     MOVE +0                          TO WS001-PO-LNE-NBR.        57812806
578129     MOVE +0                          TO WS001-PREPK-ID.          57812906
578130     MOVE  0                          TO WS001-SKU-NBR.           57813006
578140     MOVE  SPACE                      TO WS001-DTL-ASN-LEVEL-IND. 57814006
578141     MOVE PC-CURRENT-PROGRAM-NAME                                 57814106
578142                                  TO WS001-CALLING-PROGRAM-NAME.  57814206
578143     PERFORM 6650-CALL-WMS-MODULE.                                57814306
578144                                                                  57814406
578145*----------------------------------------------------------------*57814506
578146*    FORMAT HEADER LABEL PRIOR TO PRINT REQUEST FORM ASC.        *57814606
578147*----------------------------------------------------------------*57814706
578148                                                                  57814806
578149 7000-SETUP-HDR-LABELS-ASC.                                       57814906
578150                                                                  57815006
578160     SET PC140-COMMON-HDR-LBL-NBR       TO TRUE.                  57816006
578170                                                                  57817006
578180     MOVE ASC-PRINTER-ID-N       TO PV-PRINTER-NO-9.              57818006
578190     MOVE PV-PRINTER-NO          TO PC140-HL-PRTR-ID.             57819006
578200     MOVE OPRSET-CNTL-DESC       TO PC140-HL-PRC-AREA-TX.         57820006
578300     MOVE ASC-KEY-TRIP-ID        TO PC140-HL-TRIP-ID.             57830006
578400     MOVE SPACES                 TO PC140-HL-PRC-AREA-CD.         57840006
578500                                                                  57850006
578600     IF  LQW-ACTL-CTN-CNT (LQW-IDX) > ZEROES                      57860006
578700         MOVE LQW-ACTL-CTN-CNT (LQW-IDX)                          57870006
578800                                 TO PC140-HL-CART-CT              57880006
578900     ELSE                                                         57890006
579000         MOVE LQW-CTN-CNT (LQW-IDX)                               57900006
579100                                 TO PC140-HL-CART-CT              57910006
579200     END-IF.                                                      57920006
579300                                                                  57930006
579400     IF LQW-ARRIVAL-DTE (LQW-IDX) = '090999'                      57940006
579500       AND LQW-ARRIVAL-DTE-CC (LQW-IDX) = '99'                    57950006
579600        MOVE 'ENROUTE'   TO PC140-HL-RCVD-MM-DD-YY                57960006
579700     ELSE                                                         57970006
579800        MOVE LQW-ARRIVAL-DTE (LQW-IDX)                            57980006
579900                                    TO PV-FORMAT-DATE             57990006
580000        STRING                                                    58000006
580100            PV-MM                                                 58010006
580200            '-'                                                   58020006
580300            PV-DD                                                 58030006
580400            '-'                                                   58040006
580500            PV-YY                                                 58050006
580600                DELIMITED BY SIZE                                 58060006
580700                                  INTO PC140-HL-RCVD-MM-DD-YY     58070006
580800     END-IF.                                                      58080006
580900     MOVE LQW-PO-NBR (LQW-IDX)                                    58090006
581000                                 TO PV-PO-NBR-8-POSITIONS.        58100006
581100     MOVE PV-PO-NBR-8-POSITIONS                                   58110006
581200                                 TO PC140-HL-PO-NBR.              58120006
581300     MOVE LQW-ENT-NAME-DESC (LQW-IDX)                             58130006
581400                                 TO PC140-HL-VEND-NAME.           58140006
581500     MOVE LQW-REC-SEQ-NBR (LQW-IDX)                               58150006
581600                                 TO PV-RCVR-SEQ-4-DGT.            58160006
581700     MOVE PV-RCVR-SEQ-3-X        TO PC140-HL-RCVR-SEQ-NBR-TX.     58170006
581800                                                                  58180006
581900                                                                  58190006
582000                                                                  58200006
582100     IF  LQW-AD-DATE (LQW-IDX) > SPACES                           58210006
582200         MOVE LQW-AD-DATE (LQW-IDX)                               58220006
582300                                 TO PV-FORMAT-DATE                58230006
582400         STRING                                                   58240006
582500             PV-MM                                                58250006
582600             '-'                                                  58260006
582700             PV-DD                                                58270006
582800             '-'                                                  58280006
582900             PV-YY                                                58290006
583000                 DELIMITED BY SIZE                                58300006
583100                               INTO PC140-HL-AD-MM-DD-YY          58310006
583200     ELSE                                                         58320006
583300         MOVE '  -  -  '         TO PC140-HL-AD-MM-DD-YY          58330006
583400     END-IF.                                                      58340006
583500                                                                  58350006
583600     EVALUATE LQW-AD-INFO (LQW-IDX)                               58360006
583700         WHEN '1'                                                 58370006
583800             MOVE 'HOT '         TO PC140-HL-PIC-TX               58380006
583900         WHEN '2'                                                 58390006
584000             MOVE 'PICT'         TO PC140-HL-PIC-TX               58400006
584100         WHEN '3'                                                 58410006
584200             MOVE 'PREP'         TO PC140-HL-PIC-TX               58420006
584300         WHEN '4'                                                 58430006
584400             MOVE 'RAIN'         TO PC140-HL-PIC-TX               58440006
584500         WHEN '5'                                                 58450006
584600             MOVE 'CUST'         TO PC140-HL-PIC-TX               58460006
584700         WHEN OTHER                                               58470006
584800             MOVE SPACES         TO PC140-HL-PIC-TX               58480006
584900     END-EVALUATE.                                                58490006
585000                                                                  58500006
585100     IF  LQW-MULT-IND (LQW-IDX) = 'M'                             58510006
585200         MOVE PC-MULTIPLE-SHIPMENTS                               58520006
585300                                 TO PC140-HL-MULT-SHIPMENTS-TX    58530006
585400     ELSE                                                         58540006
585500         MOVE SPACES             TO PC140-HL-MULT-SHIPMENTS-TX    58550006
585600     END-IF.                                                      58560006
585700                                                                  58570006
585800     MOVE LQW-PO-INSTR (LQW-IDX)                                  58580006
585900                                 TO PC140-HL-SPECIAL-TX.          58590006
586000                                                                  58600006
586100     IF  LQW-PRE-TKT-IND (LQW-IDX) = 'N' OR ' '                   58610006
586200         MOVE SPACES             TO PC140-HL-PRE-TKT-TX           58620006
586300     ELSE                                                         58630006
586400         MOVE PC-PRE-TICKETED    TO PC140-HL-PRE-TKT-TX           58640006
586500     END-IF.                                                      58650006
586600                                                                  58660006
586700     IF LQW-PACK-BY-ST-IND (LQW-IDX) = 'N' OR ' '                 58670006
586800         MOVE SPACES             TO PC140-HL-PACKED-BY-TX         58680006
586900     ELSE                                                         58690006
587000         MOVE PC-PACKED-BY-STORE TO PC140-HL-PACKED-BY-TX         58700006
587100     END-IF.                                                      58710006
587200                                                                  58720006
587300     IF  LQW-GOH-IND (LQW-IDX) = 'N' OR ' '                       58730006
587400         MOVE SPACES             TO PC140-HL-ON-HANGER-TX         58740006
587500     ELSE                                                         58750006
587600         MOVE PC-ON-HANGER       TO PC140-HL-ON-HANGER-TX         58760006
587700     END-IF.                                                      58770006
587800                                                                  58780006
587900     MOVE LQW-TKT-TYP (LQW-IDX)                                   58790006
588000                                 TO PC140-HL-TICKET-TYPE.         58800006
588100     MOVE LQW-DEPT (LQW-IDX)                                      58810006
588200                                 TO PC140-HL-DEPT.                58820006
588300     MOVE LQW-CLASS (LQW-IDX)                                     58830006
588400                                 TO PC140-HL-CLASS.               58840006
588500                                                                  58850006
588600     IF LQW-DETAIL-CHECK (LQW-IDX) = 'Y'                          58860006
588700         MOVE PC-DETAIL-CHECK    TO PC140-HL-DETAIL-CHECK         58870006
588800     ELSE                                                         58880006
588900         MOVE SPACES             TO PC140-HL-DETAIL-CHECK         58890006
589000     END-IF.                                                      58900006
589100                                                                  58910006
589200     MOVE DP072-PRTR-IP-ADDRESS  TO PC140-HL-IP-ADDRESS.          58920006
589300     MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                          58930006
589400                                 TO PC140-HL-OS-RLSE-CDE.         58940006
589500     MOVE DP072-PRTR-DATA-XFER-MODE-ID                            58950006
589600                                 TO PC140-HL-XFER-MODE-ID.        58960006
589700     MOVE DP072-XMIT-INTFC-CDE                                    58970006
589800                                 TO PC140-XMIT-INTFC-CDE.         58980006
589900     MOVE DP072-PRTR-OPER-UNT-ID TO PC-OPER-UNT-ID.               58990006
590000                                                                  59000006
590100                                                                  59010006
590200     PERFORM 7150-LINK-SOCKET-PRINT-ROUTINE.                      59020006
590300                                                                  59030006
590400                                                                  59040006
590500/                                                                 59050006
590600*----------------------------------------------------------------*59060006
590700*    FORMAT CARTON LABEL PRIOR TO PRINT REQUEST FROM ASC.        *59070006
590800*----------------------------------------------------------------*59080006
590900                                                                  59090006
591000 7010-SETUP-CTN-LABELS-ASC.                                       59100006
591100                                                                  59110006
591200     SET PC140-COMMON-CART-LBL-NBR      TO TRUE.                  59120006
591300                                                                  59130006
591400     MOVE ASC-PRINTER-ID-N       TO PV-PRINTER-NO-9.              59140006
591500     MOVE PV-PRINTER-NO          TO PC140-CL-PRTR-ID.             59150006
591600     MOVE OPRSET-CNTL-DESC       TO PC140-CL-PRC-AREA             59160006
591700                                    DK-CNTL-DESC.                 59170006
591800                                                                  59180006
591900     IF  LQW-ACTL-CTN-CNT (LQW-IDX) > ZEROES                      59190006
592000         MOVE LQW-ACTL-CTN-CNT (LQW-IDX)                          59200006
592100                                 TO PC140-CL-TOT-LBLS             59210006
592200     ELSE                                                         59220006
592300         MOVE LQW-CTN-CNT (LQW-IDX)                               59230006
592400                                 TO PC140-CL-TOT-LBLS             59240006
592500     END-IF.                                                      59250006
592600                                                                  59260006
592700     MOVE LQW-ARRIVAL-DTE (LQW-IDX)                               59270006
592800                                 TO PV-FORMAT-DATE.               59280006
592900     STRING                                                       59290006
593000         PV-MM                                                    59300006
593100         '-'                                                      59310006
593200         PV-DD                                                    59320006
593300         '-'                                                      59330006
593400         PV-YY                                                    59340006
593500             DELIMITED BY SIZE                                    59350006
593600                               INTO PC140-CL-RCVD-MM-DD-YY.       59360006
593700                                                                  59370006
593800     MOVE LQW-PO-NBR (LQW-IDX)                                    59380006
593900                                 TO PC140-CL-PO-NBR.              59390006
594000     MOVE LQW-REC-SEQ-NBR (LQW-IDX)                               59400006
594100                                 TO PC140-CL-RCVR-SEQ-NBR.        59410006
594200                                                                  59420006
594300     PERFORM 7070-FILL-PROCESS-AREA-CODE.                         59430006
594400                                                                  59440006
594500     IF  PC140-CRA-SUCCESSFUL                                     59450006
594600*        PERFORM 7080-ADD-MOD-10-CK-DGT                           59460006
594700         MOVE DP072-PRTR-IP-ADDRESS                               59470006
594800                                 TO PC140-CL-IP-ADDRESS           59480006
594900         MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                      59490006
595000                                 TO PC140-CL-OS-RLSE-CDE          59500006
595100         MOVE DP072-PRTR-DATA-XFER-MODE-ID                        59510006
595200                                 TO PC140-CL-XFER-MODE-ID         59520006
595300         MOVE DP072-XMIT-INTFC-CDE                                59530006
595400                                     TO PC140-XMIT-INTFC-CDE      59540006
595500         MOVE DP072-PRTR-OPER-UNT-ID TO PC-OPER-UNT-ID            59550006
595600                                                                  59560006
595700                                                                  59570006
595800             PERFORM 7150-LINK-SOCKET-PRINT-ROUTINE               59580006
595900     END-IF.                                                      59590006
596000                                                                  59600006
596100                                                                  59610006
596200/                                                                 59620006
596300*----------------------------------------------------------------*59630006
596400*    FORMAT HEADER LABEL PRIOR TO PRINT REQUEST FROM LIST QUEUE. *59640006
596500*----------------------------------------------------------------*59650006
596600                                                                  59660006
596700 7050-SETUP-LABELS-HEADER.                                        59670006
596800                                                                  59680006
596900     SET PC140-COMMON-HDR-LBL-NBR       TO TRUE.                  59690006
597000                                                                  59700006
597100     MOVE ASC-PRINTER-ID-N       TO PV-PRINTER-NO-9.              59710006
597200     MOVE PV-PRINTER-NO          TO PC140-HL-PRTR-ID.             59720006
597300     MOVE ASC-LOGL-UNIT-NAME     TO PC140-HL-PRTR-LU-NAME.        59730006
597400                                                                  59740006
597500     MOVE LQW-PO-NBR (LQW-IDX)   TO DK-PO-NBR.                    59750006
597600     MOVE LQW-REC-SEQ-NBR (LQW-IDX)                               59760006
597700                                 TO DK-REC-SEQ-NBR.               59770006
597800     MOVE ASC-KEY-OPER-UNT-ID    TO DK-OPER-UNT-ID.               59780006
597900     MOVE ASC-KEY-FCLTY-ID       TO DK-FCLTY-ID.                  59790006
598000     PERFORM 4380-GET-OPER-SET-DESC.                              59800006
598100                                                                  59810006
598200     MOVE OPRSET-CNTL-DESC       TO PC140-HL-PRC-AREA-TX.         59820006
598300     MOVE ASC-KEY-TRIP-ID        TO PC140-HL-TRIP-ID.             59830006
598400     MOVE SPACES                 TO PC140-HL-PRC-AREA-CD.         59840006
598500                                                                  59850006
598600     IF  LQW-ACTL-CTN-CNT (LQW-IDX) > ZEROES                      59860006
598700         MOVE LQW-ACTL-CTN-CNT (LQW-IDX)                          59870006
598800                                 TO PC140-HL-CART-CT              59880006
598900     ELSE                                                         59890006
599000         MOVE LQW-CTN-CNT (LQW-IDX)                               59900006
599100                                 TO PC140-HL-CART-CT              59910006
599200     END-IF.                                                      59920006
599300                                                                  59930006
599400     MOVE LQW-ARRIVAL-DTE (LQW-IDX)                               59940006
599500                                 TO PV-FORMAT-DATE.               59950006
599600     STRING                                                       59960006
599700         PV-MM                                                    59970006
599800         '-'                                                      59980006
599900         PV-DD                                                    59990006
600000         '-'                                                      60000006
600100         PV-YY                                                    60010006
600200             DELIMITED BY SIZE                                    60020006
600300                               INTO PC140-HL-RCVD-MM-DD-YY.       60030006
600400                                                                  60040006
600500     MOVE LQW-PO-NBR (LQW-IDX)   TO PC140-HL-PO-NBR.              60050006
600600     MOVE LQW-ENT-NAME-DESC (LQW-IDX)                             60060006
600700                                 TO PC140-HL-VEND-NAME.           60070006
600800     MOVE LQW-REC-SEQ-NBR (LQW-IDX)                               60080006
600900                                 TO PC140-HL-RCVR-NBR             60090006
601000                                    PC140-HL-RCVR-SEQ-NBR-TX.     60100006
601100                                                                  60110006
601200     IF  LQW-AD-DATE (LQW-IDX) > SPACES                           60120006
601300         MOVE LQW-AD-DATE (LQW-IDX)                               60130006
601400                                 TO PV-FORMAT-DATE                60140006
601500         STRING                                                   60150006
601600             PV-MM                                                60160006
601700             '-'                                                  60170006
601800             PV-DD                                                60180006
601900             '-'                                                  60190006
602000             PV-YY                                                60200006
602100                 DELIMITED BY SIZE                                60210006
602200                 INTO PC140-HL-AD-MM-DD-YY                        60220006
602300     ELSE                                                         60230006
602400         MOVE '  -  -  '         TO PC140-HL-AD-MM-DD-YY          60240006
602500     END-IF.                                                      60250006
602600                                                                  60260006
602700     EVALUATE LQW-AD-INFO (LQW-IDX)                               60270006
602800         WHEN '1'                                                 60280006
602900             MOVE 'HOT '         TO PC140-HL-PIC-TX               60290006
603000         WHEN '2'                                                 60300006
603100             MOVE 'PICT'         TO PC140-HL-PIC-TX               60310006
603200         WHEN '3'                                                 60320006
603300             MOVE 'PREP'         TO PC140-HL-PIC-TX               60330006
603400         WHEN '4'                                                 60340006
603500             MOVE 'RAIN'         TO PC140-HL-PIC-TX               60350006
603600         WHEN '5'                                                 60360006
603700             MOVE 'CUST'         TO PC140-HL-PIC-TX               60370006
603800         WHEN OTHER                                               60380006
603900             MOVE SPACES         TO PC140-HL-PIC-TX               60390006
604000     END-EVALUATE.                                                60400006
604100                                                                  60410006
604200     IF  LQW-MULT-IND (LQW-IDX) = 'M'                             60420006
604300         MOVE PC-MULTIPLE-SHIPMENTS                               60430006
604400                                 TO PC140-HL-MULT-SHIPMENTS-TX    60440006
604500     ELSE                                                         60450006
604600         MOVE SPACES             TO PC140-HL-MULT-SHIPMENTS-TX    60460006
604700     END-IF.                                                      60470006
604800                                                                  60480006
604900     MOVE LQW-PO-INSTR (LQW-IDX) TO PC140-HL-SPECIAL-TX.          60490006
605000                                                                  60500006
605100     IF  LQW-PRE-TKT-IND (LQW-IDX) = 'N' OR ' '                   60510006
605200         MOVE SPACES             TO PC140-HL-PRE-TKT-TX           60520006
605300     ELSE                                                         60530006
605400         MOVE PC-PRE-TICKETED    TO PC140-HL-PRE-TKT-TX           60540006
605500     END-IF.                                                      60550006
605600                                                                  60560006
605700     IF  LQW-PACK-BY-ST-IND (LQW-IDX) = 'N' OR ' '                60570006
605800         MOVE SPACES             TO PC140-HL-PACKED-BY-TX         60580006
605900     ELSE                                                         60590006
606000         MOVE PC-PACKED-BY-STORE TO PC140-HL-PACKED-BY-TX         60600006
606100     END-IF.                                                      60610006
606200                                                                  60620006
606300     IF  LQW-GOH-IND (LQW-IDX) = 'N' OR ' '                       60630006
606400         MOVE SPACES             TO PC140-HL-ON-HANGER-TX         60640006
606500     ELSE                                                         60650006
606600         MOVE PC-ON-HANGER       TO PC140-HL-ON-HANGER-TX         60660006
606700     END-IF.                                                      60670006
606800                                                                  60680006
606900     MOVE LQW-TKT-TYP (LQW-IDX)  TO PC140-HL-TICKET-TYPE.         60690006
607000     MOVE LQW-DEPT  (LQW-IDX)    TO PC140-HL-DEPT.                60700006
607100     MOVE LQW-CLASS (LQW-IDX)    TO PC140-HL-CLASS.               60710006
607200                                                                  60720006
607300     IF  LQW-DETAIL-CHECK (LQW-IDX) = 'Y'                         60730006
607400         MOVE PC-DETAIL-CHECK    TO PC140-HL-DETAIL-CHECK         60740006
607500     ELSE                                                         60750006
607600         MOVE SPACES             TO PC140-HL-DETAIL-CHECK         60760006
607700     END-IF.                                                      60770006
607800                                                                  60780006
607900                                                                  60790006
608000     PERFORM 7150-LINK-SOCKET-PRINT-ROUTINE.                      60800006
608100                                                                  60810006
608200                                                                  60820006
608300/                                                                 60830006
608400*----------------------------------------------------------------*60840006
608500*    FORMAT CARTON LABEL PRIOR TO PRINT REQUEST FROM LIST QUEUE. *60850006
608600*----------------------------------------------------------------*60860006
608700                                                                  60870006
608800 7060-SETUP-LABELS-CARTON.                                        60880006
608900                                                                  60890006
609000     SET PC140-COMMON-CART-LBL-NBR      TO TRUE.                  60900006
609100                                                                  60910006
609200     MOVE ASC-PRINTER-ID-N       TO PV-PRINTER-NO-9.              60920006
609300     MOVE PV-PRINTER-NO          TO PC140-CL-PRTR-ID.             60930006
609400     MOVE ASC-LOGL-UNIT-NAME     TO PC140-CL-PRTR-LU-NAME.        60940006
609500     MOVE OPRSET-CNTL-DESC       TO PC140-CL-PRC-AREA             60950006
609600                                    DK-CNTL-DESC.                 60960006
609700                                                                  60970006
609800     IF  LQW-ACTL-CTN-CNT (LQW-IDX) > ZEROES                      60980006
609900         MOVE LQW-ACTL-CTN-CNT (LQW-IDX)                          60990006
610000                                 TO PC140-CL-TOT-LBLS             61000006
610100     ELSE                                                         61010006
610200         MOVE LQW-CTN-CNT (LQW-IDX)                               61020006
610300                                 TO PC140-CL-TOT-LBLS             61030006
610400     END-IF.                                                      61040006
610500                                                                  61050006
610600     MOVE LQW-ARRIVAL-DTE (LQW-IDX)                               61060006
610700                                 TO PV-FORMAT-DATE.               61070006
610800     STRING                                                       61080006
610900         PV-MM                                                    61090006
611000         '-'                                                      61100006
611100         PV-DD                                                    61110006
611200         '-'                                                      61120006
611300         PV-YY                                                    61130006
611400             DELIMITED BY SIZE                                    61140006
611500                               INTO PC140-CL-RCVD-MM-DD-YY.       61150006
611600                                                                  61160006
611700     MOVE LQW-PO-NBR (LQW-IDX)   TO PC140-CL-PO-NBR.              61170006
611800     MOVE LQW-REC-SEQ-NBR (LQW-IDX)                               61180006
611900                                 TO PC140-CL-RCVR-SEQ-NBR.        61190006
612000                                                                  61200006
612100     PERFORM 7070-FILL-PROCESS-AREA-CODE.                         61210006
612200                                                                  61220006
612300     IF  PC140-CRA-SUCCESSFUL                                     61230006
612400         PERFORM 7150-LINK-SOCKET-PRINT-ROUTINE                   61240006
612500     END-IF.                                                      61250006
612600                                                                  61260006
612700                                                                  61270006
612800/                                                                 61280006
612900*----------------------------------------------------------------*61290006
613000*    FILL THE PROCESS AREA CODE FROM THE TPCLABL TABLE.          *61300006
613100*----------------------------------------------------------------*61310006
613200                                                                  61320006
613300 7070-FILL-PROCESS-AREA-CODE.                                     61330006
613400                                                                  61340006
613500                                                                  61350006
613600     PERFORM                                                      61360006
613700         WITH TEST AFTER                                          61370006
613800         VARYING PV-RETRY-COUNTER                                 61380006
613900         FROM 1 BY 1                                              61390006
614000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               61400006
614100                   OR (SQLCODE = +100)                            61410006
614200                   OR (SQLCODE = ZERO))                           61420006
614300                                                                  61430006
614400         EXEC SQL                                                 61440006
614500             SELECT LBL_TYP_CDE                                   61450006
614600                   ,CNTL_CDE                                      61460006
614700                   ,CNTL_DESC                                     61470006
614800                   ,REF_CDE                                       61480006
614900               INTO :PCLABL-LBL-TYP-CDE                           61490006
615000                   ,:PCLABL-CNTL-CDE                              61500006
615100                   ,:PCLABL-CNTL-DESC                             61510006
615200                   ,:PCLABL-REF-CDE                               61520006
615300               FROM TPCLABL                                       61530006
615400              WHERE CNTL_DESC  = :DK-CNTL-DESC                    61540006
615500                AND CNTL_CDE  ^= '000'                            61550006
615510               WITH UR                                            61551008
615600         END-EXEC                                                 61560006
615700                                                                  61570006
615800         EVALUATE TRUE                                            61580006
615900             WHEN SQLCODE = ZERO                                  61590006
616000                 MOVE PCLABL-CNTL-CDE TO PC140-CL-PRC-AREA        61600006
616100                                                                  61610006
616200             WHEN SQLCODE = +100                                  61620006
616300                 SET PC140-CRA-INVALID-PRT-FMT TO TRUE            61630006
616400                 SET DP020-MSG-FATAL  TO TRUE                     61640006
616500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              61650006
616600                 MOVE PC-TSYMSG-00390 TO DP020-MSG-NUMBER         61660006
616700                                                                  61670006
616800             WHEN SQLCODE = -904                                  61680006
616900             WHEN SQLCODE = -913                                  61690006
617000                 CONTINUE                                         61700006
617100                                                                  61710006
617200             WHEN SQLWARN0 NOT = SPACES                           61720006
617300             WHEN SQLCODE < ZERO                                  61730006
617400             WHEN SQLCODE > ZERO                                  61740006
617500                 MOVE '7070-FILL-PROCESS-AREA  '                  61750006
617600                                 TO DP013-PARAGRAPH               61760006
617700                 MOVE 'SELECT PROCESS CD'                         61770006
617800                                 TO DP013-MESSAGE-TEXT (1)        61780006
617900                 MOVE SQLCA      TO DP013-SQLCA                   61790006
618000                 MOVE 'TPCLABL'  TO DP013-DB2-TABLE-NAME (1)      61800006
618100                 SET DP013-DB2-ABEND                              61810006
618200                                 TO TRUE                          61820006
618300                 SET DP013-XCTL-DISPLAY-RESTART                   61830006
618400                                 TO TRUE                          61840006
618500                 PERFORM DP013-0000-PROCESS-ABEND                 61850006
618600         END-EVALUATE                                             61860006
618700     END-PERFORM.                                                 61870006
618800                                                                  61880006
618900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES AND                     61890006
619000         SQLCODE NOT = +0                                         61900006
619100         MOVE '7070-FILL-PROCESS-AREA  '                          61910006
619200                                 TO DP013-PARAGRAPH               61920006
619300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     61930006
619400                                 TO DP013-MESSAGE-TEXT (1)        61940006
619500         MOVE 'PROCESS CODE  '   TO DP013-MESSAGE-TEXT (2)        61950006
619600         MOVE SQLCA              TO DP013-SQLCA                   61960006
619700         MOVE 'TPCLABL'          TO DP013-DB2-TABLE-NAME (1)      61970006
619800         SET DP013-DB2-ABEND     TO TRUE                          61980006
619900         SET DP013-XCTL-DISPLAY-RESTART                           61990006
620000                                 TO TRUE                          62000006
620100         PERFORM DP013-0000-PROCESS-ABEND                         62010006
620200     END-IF.                                                      62020006
620300                                                                  62030006
620400/                                                                 62040006
620500*----------------------------------------------------------------*62050006
620600*  CALCULATES THE MODULUS 10 CHECK DIGIT FOR INTERLEVE 2 OF 5.   *62060006
620700*----------------------------------------------------------------*62070006
620800                                                                  62080006
620900 7080-ADD-MOD-10-CK-DGT.                                          62090006
621000                                                                  62100006
621100     COMPUTE                                                      62110006
621200         PV-X = (PV-CHAR(1) + PV-CHAR(3)) * 3 +  PV-CHAR(2)       62120006
621300     END-COMPUTE.                                                 62130006
621400                                                                  62140006
621500     DIVIDE PV-X BY 10                                            62150006
621600         GIVING PV-Q ROUNDED                                      62160006
621700         REMAINDER PV-R                                           62170006
621800     END-DIVIDE.                                                  62180006
621900                                                                  62190006
622000     COMPUTE                                                      62200006
622100         PV-MOD-10-CK-DGT = 10 - PV-R                             62210006
622200     END-COMPUTE.                                                 62220006
622300                                                                  62230006
622400/                                                                 62240006
622500*----------------------------------------------------------------*62250006
622600*    LINK TO HEADER LABEL PRINT PROGRAM.                         *62260006
622700*----------------------------------------------------------------*62270006
622800                                                                  62280006
622900                                                                  62290006
623000/                                                                 62300006
623100                                                                  62310006
623200 7150-LINK-SOCKET-PRINT-ROUTINE.                                  62320006
623300                                                                  62330006
623400     MOVE DP020-USERID           TO PC140-CRA-USERID.             62340006
623500     MOVE 400                    TO PV-COMMAREA-LENGTH.           62350006
623600                                                                  62360006
623700     EXEC CICS                                                    62370006
623800          LINK PROGRAM  ('PCKCS707')                              62380006
623900               COMMAREA (PC140-LABELMST)                          62390006
624000               LENGTH   (PV-COMMAREA-LENGTH)                      62400006
624100               RESP     (PV-CICS-RESP)                            62410006
624200     END-EXEC.                                                    62420006
624300                                                                  62430006
624400     EVALUATE TRUE                                                62440006
624500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     62450006
624600              CONTINUE                                            62460006
624700         WHEN OTHER                                               62470006
624800              PERFORM DP013-0000-PROCESS-ABEND                    62480006
624900     END-EVALUATE.                                                62490006
625000     IF PC140-CRA-SOCKET-COMM-ERROR                               62500006
625100         SET PS-ERROR            TO TRUE                          62510006
625200         SET DP020-MSG-FATAL     TO TRUE                          62520006
625300         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              62530006
625400         MOVE DP015-UNP-NUM-BRT-OFF                               62540006
625500                                 TO APRINTRA                      62550006
625600         MOVE DP015-RED          TO APRINTRC                      62560006
625700         MOVE DP015-REVERSE      TO APRINTRH                      62570006
625800         MOVE -1                 TO APRINTRL                      62580006
625900         SET DP030-SET-CURSOR-APPL-1                              62590006
626000                                 TO TRUE                          62600006
626100     ELSE                                                         62610006
626200     IF PC140-CRA-INVALID-PRT-FMT                                 62620006
626300         SET PS-ERROR            TO TRUE                          62630006
626400         SET DP020-MSG-FATAL     TO TRUE                          62640006
626500         MOVE DP015-UNP-NUM-BRT-OFF                               62650006
626600                                 TO APRINTRA                      62660006
626700         MOVE DP015-RED          TO APRINTRC                      62670006
626800         MOVE DP015-REVERSE      TO APRINTRH                      62680006
626900         MOVE -1                 TO APRINTRL                      62690006
627000         SET DP030-SET-CURSOR-APPL-1                              62700006
627100                                 TO TRUE                          62710006
627200         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                62720006
627300         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                62730006
627400         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            62740006
627500     ELSE                                                         62750006
627600         SET DP020-MSG-INFORMATIONAL TO TRUE                      62760006
627700         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              62770006
627800         MOVE -1                 TO APRINTRL                      62780006
627900         SET DP030-SET-CURSOR-APPL-1                              62790006
628000                                 TO TRUE                          62800006
628100     END-IF.                                                      62810006
628200/                                                                 62820006
628300*----------------------------------------------------------------*62830006
628400*    START TRANID FOR RCKCS226 (PRINT MANIFEST).                 *62840006
628500*----------------------------------------------------------------*62850006
628600 7200-FORMAT-COMMAREA.                                            62860006
628700                                                                  62870006
628800     MOVE ASC-KEY-OWNER-SCAC-ID  TO PV-CA-SCAC-CDE.               62880006
628900     MOVE ASC-KEY-VEH-NBR        TO PV-CA-TRLR-ID.                62890006
629000     MOVE ASC-KEY-ARRIVAL-DTE    TO PV-CA-ARRIVAL-DTE.            62900006
629100     MOVE ASC-PRINTER-ID         TO PV-CA-PRINTER.                62910006
629200     MOVE ASC-KEY-TRIP-ID        TO PV-TRIP-ID.                   62920006
629300     MOVE DP020-USERID           TO PV-CA-USERID.                 62930006
629400                                                                  62940006
629500     MOVE ASC-PRTR-AUTO-CUTTER-IND                                62950006
629600                                 TO  PV-CA-PRTR-AUTO-CUTTER-IND.  62960006
629700     MOVE ASC-PRTR-BARCODE-IND   TO  PV-CA-PRTR-BARCODE-IND.      62970006
629800     MOVE ASC-PRTR-PRTR-CNTL-IND TO  PV-CA-PRTR-PRTR-CNTL-IND.    62980006
629900     MOVE ASC-PRTR-TRACK-NBR     TO  PV-CA-PRTR-TRACK-NBR.        62990006
630000     SET  PV-NOT-PRINT-PACKAGE   TO  TRUE.                        63000006
630100                                                                  63010006
630200                                                                  63020006
630300                                                                  63030006
630400*----------------------------------------------------------------*63040006
630500*    START TRANID FOR RCKCS226 (PRINT MANIFEST).                 *63050006
630600*----------------------------------------------------------------*63060006
630700 7300-START-TRANID-E226.                                          63070006
630800                                                                  63080006
630900* ************************************************************** *63090006
631000* * PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *63100006
631100* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *63110006
631200* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *63120006
631300* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *63130006
631400* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *63140006
631500* ************************************************************** *63150006
631600     IF DP020-SRC-DB2-PKG-ARCHIVE                                 63160006
631700         EXEC CICS                                                63170006
631800              START TRANSID ('EC26')                              63180006
631900                   FROM     (PV-RCKCS226-COMMAREA)                63190006
632000         END-EXEC                                                 63200006
632100     ELSE                                                         63210006
632200         EXEC CICS                                                63220006
632300              START TRANSID ('E226')                              63230006
632400                   FROM     (PV-RCKCS226-COMMAREA)                63240006
632500         END-EXEC                                                 63250006
632600     END-IF.                                                      63260006
632700                                                                  63270006
632800/                                                                 63280006
632900 8000-UPDATE-TRIP-SHIPMENT-STAT.                                  63290006
633000                                                                  63300006
633100     PERFORM 8005-UPDATE-TVEHICL.                                 63310006
633200     PERFORM 8030-AUDIT-TVEHICL.                                  63320006
633300     MOVE ASC-KEY-TRIP-ID    TO DK-TRIP-ID.                       63330006
633400     PERFORM 8010-SELECT-TTRIPST.                                 63340006
633500     MOVE 'UN'               TO TRIPST-TRIP-STATUS-CDE.           63350006
633600     PERFORM 8020-INSERT-TTRIPST.                                 63360006
633700                                                                  63370006
633710     IF  ASC-RPA-MISDRCT-CK                                       63371018
633720         PERFORM 8210-RPA-MISDIRECT                               63372018
633730     END-IF.                                                      63373018
633740                                                                  63374018
633800     IF  PS-NO-ERROR                                              63380006
633900         MOVE 'N'            TO PS-SHIPMENT-CURSOR-SW             63390006
634000         PERFORM 8100-OPEN-SHIPMENT-CSR                           63400006
634100         PERFORM 8102-FETCH-SHIPMENT-CSR                          63410006
634200         PERFORM UNTIL PS-NO-MORE-SHIPMENTS                       63420006
634300             MOVE SHIPMT-SHIPT-ID                                 63430006
634400                             TO DK-SHIPT-ID                       63440006
634500             PERFORM 8110-SELECT-TSHIPST                          63450006
634600             MOVE 'UN'       TO SHIPST-SHIPT-STATUS-CDE           63460006
634700             PERFORM 8120-INSERT-TSHIPST                          63470006
634800             PERFORM 8102-FETCH-SHIPMENT-CSR                      63480006
634900         END-PERFORM                                              63490006
635000         PERFORM 8104-CLOSE-SHIPMENT-CSR                          63500006
635100     END-IF.                                                      63510006
635200                                                                  63520006
635300/                                                                 63530006
635400*----------------------------------------------------------------*63540006
635500*  UPDATE THE LOCATION AND STATUS OF THE VEHICLE                 *63550006
635600*----------------------------------------------------------------*63560006
635700 8005-UPDATE-TVEHICL.                                             63570006
635800                                                                  63580006
635900     MOVE 'UN' TO VEHICL-CURR-STATUS-CDE                          63590006
636000                                                                  63600006
636100                                                                  63610006
636200     PERFORM                                                      63620006
636300         WITH TEST AFTER                                          63630006
636400         VARYING PV-RETRY-COUNTER                                 63640006
636500         FROM 1 BY 1                                              63650006
636600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               63660006
636700             OR (SQLCODE = +0))                                   63670006
636800                                                                  63680006
636900         EXEC SQL                                                 63690006
637000           UPDATE TVEHICL                                         63700006
637100              SET LAST_UPD_DTE     = CURRENT DATE                 63710006
637200                 ,LAST_UPD_TME     = CURRENT TIME                 63720006
637300                 ,LAST_UPD_UID     = :DP020-USERID                63730006
637400                 ,CURR_STATUS_DTE  = CURRENT DATE                 63740006
637500                 ,CURR_STATUS_TME  = CURRENT TIME                 63750006
637600                 ,CURR_STATUS_CDE  = :VEHICL-CURR-STATUS-CDE      63760006
637700           WHERE  VEH_NBR       = :DK-VEH-NBR                     63770006
637800             AND  OWNER_SCAC_ID = :DK-OWNER-SCAC-ID               63780006
637900         END-EXEC                                                 63790006
638000                                                                  63800006
638100         EVALUATE TRUE                                            63810006
638200             WHEN SQLCODE = +0                                    63820006
638300             WHEN SQLCODE = -904                                  63830006
638400             WHEN SQLCODE = -913                                  63840006
638500                 CONTINUE                                         63850006
638600                                                                  63860006
638700             WHEN SQLWARN0 NOT = SPACES                           63870006
638800             WHEN SQLCODE < +0                                    63880006
638900             WHEN SQLCODE > +0                                    63890006
639000                 MOVE '8005-UPDATE-TVEHICL'                       63900006
639100                                   TO DP013-PARAGRAPH             63910006
639200                 MOVE 'UPDATE CURR INFO ON TVEHICL'               63920006
639300                                   TO DP013-MESSAGE-TEXT(1)       63930006
639400                 MOVE SQLCA        TO DP013-SQLCA                 63940006
639500                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    63950006
639600                 SET DP013-DB2-ABEND                              63960006
639700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           63970006
639800                 PERFORM DP013-0000-PROCESS-ABEND                 63980006
639900         END-EVALUATE                                             63990006
640000     END-PERFORM.                                                 64000006
640100                                                                  64010006
640200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    64020006
640300         SQLCODE NOT = +0                                         64030006
640400         MOVE '8005-UPDATE-TVEHICL'                               64040006
640500                                   TO DP013-PARAGRAPH             64050006
640600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              64060006
640700                                   TO DP013-MESSAGE-TEXT (1)      64070006
640800         MOVE 'TO UPDATE A TVEHICL ROW'                           64080006
640900                                   TO DP013-MESSAGE-TEXT (2)      64090006
641000         MOVE SQLCA                TO DP013-SQLCA                 64100006
641100         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    64110006
641200         SET DP013-DB2-ABEND                                      64120006
641300             DP013-XCTL-DISPLAY-RESTART                           64130006
641400                                   TO TRUE                        64140006
641500         PERFORM DP013-0000-PROCESS-ABEND                         64150006
641600     END-IF.                                                      64160006
641700                                                                  64170006
641800*----------------------------------------------------------------*64180006
641900*  SELECT CURRENT TRIP STATUS ROW                                *64190006
642000*----------------------------------------------------------------*64200006
642100 8010-SELECT-TTRIPST.                                             64210006
642200                                                                  64220006
642300     PERFORM                                                      64230006
642400         WITH TEST AFTER                                          64240006
642500         VARYING PV-RETRY-COUNTER                                 64250006
642600         FROM 1 BY 1                                              64260006
642700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               64270006
642800             OR (SQLCODE = +0))                                   64280006
642900                                                                  64290006
643000         EXEC SQL                                                 64300006
643100             SELECT  A.TRIP_ID                                    64310006
643200                    ,A.TRIP_STATUS_CDE                            64320006
643300                    ,A.STATUS_DTE                                 64330006
643400                    ,A.STATUS_TME                                 64340006
643500                    ,A.STATUS_UID                                 64350006
643600                    ,A.OPER_UNT_ID                                64360006
643700                    ,A.FCLTY_ID                                   64370006
643800                    ,A.FCLTY_AREA_ID                              64380006
643900              INTO   :TRIPST-TRIP-ID                              64390006
644000                    ,:TRIPST-TRIP-STATUS-CDE                      64400006
644100                    ,:TRIPST-STATUS-DTE                           64410006
644200                    ,:TRIPST-STATUS-TME                           64420006
644300                    ,:TRIPST-STATUS-UID                           64430006
644400                    ,:TRIPST-OPER-UNT-ID                          64440006
644500                    ,:TRIPST-FCLTY-ID                             64450006
644600                    ,:TRIPST-FCLTY-AREA-ID                        64460006
644700              FROM  TTRIPST A                                     64470006
644800                   ,TTRSTYP B                                     64480006
644900             WHERE  A.TRIP_ID          = :DK-TRIP-ID              64490006
645000               AND  A.TRIP_STATUS_CDE ^= 'DE'                     64500006
645100               AND  B.PRTY_CDE =                                  64510006
645200                  (SELECT MAX(D.PRTY_CDE)                         64520006
645300                     FROM TTRIPST C                               64530006
645400                         ,TTRSTYP D                               64540006
645500                    WHERE C.TRIP_ID         = A.TRIP_ID           64550006
645600                      AND C.TRIP_STATUS_CDE = D.TRIP_STATUS_CDE)  64560006
645700               AND  A.TRIP_STATUS_CDE = B.TRIP_STATUS_CDE         64570006
645800         END-EXEC                                                 64580006
645900                                                                  64590006
646000         EVALUATE TRUE                                            64600006
646100             WHEN SQLCODE = +0                                    64610006
646200             WHEN SQLCODE = -904                                  64620006
646300             WHEN SQLCODE = -913                                  64630006
646400                 CONTINUE                                         64640006
646500                                                                  64650006
646600             WHEN SQLWARN0 NOT = SPACES                           64660006
646700             WHEN SQLCODE < +0                                    64670006
646800             WHEN SQLCODE > +0                                    64680006
646900                 MOVE '8010-SELECT-TTRIPST'                       64690006
647000                                   TO DP013-PARAGRAPH             64700006
647100                 MOVE 'SELECT A ROW ON TTRIPST'                   64710006
647200                                   TO DP013-MESSAGE-TEXT(1)       64720006
647300                 MOVE SQLCA        TO DP013-SQLCA                 64730006
647400                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    64740006
647500                 MOVE DK-TRIP-ID   TO PV-DISPLAY-TRIP             64750006
647600                 STRING               DK-OWNER-SCAC-ID '/'        64760006
647700                                      DK-ARRIVAL-DTE '/'          64770006
647800                                      DK-VEH-NBR '/'              64780006
647900                                      PV-DISPLAY-TRIP '/'         64790006
648000                 DELIMITED BY SIZE                                64800006
648100                                 INTO DP013-MESSAGE-TEXT(2)       64810006
648200                 STRING                                           64820006
648300                                      DP020-STACK-TRAN-ID(1) '/'  64830006
648400                                      DP020-STACK-TRAN-ID(2) '/'  64840006
648500                                      DP020-STACK-TRAN-ID(3) '/'  64850006
648600                                      DP020-STACK-TRAN-ID(4) '/'  64860006
648700                                      DP020-STACK-TRAN-ID(5) '/'  64870006
648800                                      DP020-STACK-TRAN-ID(6) '/'  64880006
648900                                      DP020-STACK-TRAN-ID(7) '/'  64890006
649000                                      DP020-STACK-TRAN-ID(8) '/'  64900006
649100                                      DP020-STACK-TRAN-ID(9) '/'  64910006
649200                                      DP020-STACK-TRAN-ID(10)     64920006
649300                 DELIMITED BY SIZE                                64930006
649400                                 INTO DP013-MESSAGE-TEXT(3)       64940006
649500                 SET DP013-DB2-ABEND                              64950006
649600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           64960006
649700                 PERFORM DP013-0000-PROCESS-ABEND                 64970006
649800         END-EVALUATE                                             64980006
649900     END-PERFORM.                                                 64990006
650000                                                                  65000006
650100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    65010006
650200         SQLCODE NOT = +0                                         65020006
650300         MOVE '8010-SELECT-TTRIPST'                               65030006
650400                                   TO DP013-PARAGRAPH             65040006
650500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              65050006
650600                                   TO DP013-MESSAGE-TEXT (1)      65060006
650700         MOVE 'TO SELECT A TTRIPST ROW'                           65070006
650800                                   TO DP013-MESSAGE-TEXT (2)      65080006
650900         MOVE SQLCA                TO DP013-SQLCA                 65090006
651000         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    65100006
651100         SET DP013-DB2-ABEND                                      65110006
651200             DP013-XCTL-DISPLAY-RESTART                           65120006
651300                                   TO TRUE                        65130006
651400         PERFORM DP013-0000-PROCESS-ABEND                         65140006
651500     END-IF.                                                      65150006
651600                                                                  65160006
651700/                                                                 65170006
651800*----------------------------------------------------------------*65180006
651900*  INSERT A ROW ON THE VEHICLE TRIP STATUS TABLE                 *65190006
652000*----------------------------------------------------------------*65200006
652100 8020-INSERT-TTRIPST.                                             65210006
652200                                                                  65220006
652300     PERFORM                                                      65230006
652400         WITH TEST AFTER                                          65240006
652500         VARYING PV-RETRY-COUNTER                                 65250006
652600         FROM 1 BY 1                                              65260006
652700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               65270006
652800             OR (SQLCODE = +0)                                    65280006
652900             OR (SQLCODE = -803))                                 65290006
653000                                                                  65300006
653100         EXEC SQL                                                 65310006
653200             INSERT  INTO TTRIPST                                 65320006
653300                    (TRIP_ID                                      65330006
653400                    ,TRIP_STATUS_CDE                              65340006
653500                    ,STATUS_DTE                                   65350006
653600                    ,STATUS_TME                                   65360006
653700                    ,STATUS_UID                                   65370006
653800                    ,OPER_UNT_ID                                  65380006
653900                    ,FCLTY_ID                                     65390006
654000                    ,FCLTY_AREA_ID)                               65400006
654100            VALUES  (:TRIPST-TRIP-ID                              65410006
654200                    ,:TRIPST-TRIP-STATUS-CDE                      65420006
654300                    ,CURRENT DATE                                 65430006
654400                    ,CURRENT TIME                                 65440006
654500                    ,:DP020-USERID                                65450006
654600                    ,:TRIPST-OPER-UNT-ID                          65460006
654700                    ,:TRIPST-FCLTY-ID                             65470006
654800                    ,:TRIPST-FCLTY-AREA-ID)                       65480006
654900         END-EXEC                                                 65490006
655000                                                                  65500006
655100         EVALUATE TRUE                                            65510006
655200             WHEN SQLCODE = +0                                    65520006
655300                 CONTINUE                                         65530006
655400                                                                  65540006
655500             WHEN SQLCODE = -803                                  65550006
655600                 SET PS-ERROR                                     65560006
655700                     DP020-MSG-INFORMATIONAL                      65570006
655800                                        TO TRUE                   65580006
655900                 MOVE PC-TSYMSG-00417   TO DP020-MSG-NUMBER       65590006
656000                 SET DP030-SET-CURSOR-TRAILER                     65600006
656100                                        TO TRUE                   65610006
656200                                                                  65620006
656300             WHEN SQLCODE = -904                                  65630006
656400             WHEN SQLCODE = -913                                  65640006
656500                 CONTINUE                                         65650006
656600                                                                  65660006
656700             WHEN SQLWARN0 NOT = SPACES                           65670006
656800             WHEN SQLCODE < +0                                    65680006
656900             WHEN SQLCODE > +0                                    65690006
657000                 MOVE '8020-INSERT-TTRIPST'                       65700006
657100                                   TO DP013-PARAGRAPH             65710006
657200                 MOVE 'INSERT A ROW ON TTRIPST'                   65720006
657300                                   TO DP013-MESSAGE-TEXT(1)       65730006
657400                 MOVE SQLCA        TO DP013-SQLCA                 65740006
657500                 MOVE 'TTRIPST'    TO DP013-DB2-TABLE-NAME (1)    65750006
657600                 SET DP013-DB2-ABEND                              65760006
657700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           65770006
657800                 PERFORM DP013-0000-PROCESS-ABEND                 65780006
657900         END-EVALUATE                                             65790006
658000     END-PERFORM.                                                 65800006
658100                                                                  65810006
658200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    65820006
658300         SQLCODE NOT = +0                                         65830006
658400         MOVE '8020-INSERT-TTRIPST'                               65840006
658500                                   TO DP013-PARAGRAPH             65850006
658600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              65860006
658700                                   TO DP013-MESSAGE-TEXT (1)      65870006
658800         MOVE 'TO INSERT A TTRIPST ROW'                           65880006
658900                                   TO DP013-MESSAGE-TEXT (2)      65890006
659000         MOVE SQLCA                TO DP013-SQLCA                 65900006
659100         MOVE 'TTRIPST'            TO DP013-DB2-TABLE-NAME (1)    65910006
659200         SET DP013-DB2-ABEND                                      65920006
659300             DP013-XCTL-DISPLAY-RESTART                           65930006
659400                                   TO TRUE                        65940006
659500         PERFORM DP013-0000-PROCESS-ABEND                         65950006
659600     END-IF.                                                      65960006
659700                                                                  65970006
659800/                                                                 65980006
659900*----------------------------------------------------------------*65990006
660000*  TAKE A SNAPSHOT OF THE BEFORE IMAGE OF TVEHICL AND WRITE      *66000006
660100*  TO THE AUDIT TABLE.                                           *66010006
660200*----------------------------------------------------------------*66020006
660300 8030-AUDIT-TVEHICL.                                              66030006
660400                                                                  66040006
660500     INITIALIZE DCLTAUVHCL.                                       66050006
660600                                                                  66060006
660700     PERFORM                                                      66070006
660800         WITH TEST AFTER                                          66080006
660900         VARYING PV-RETRY-COUNTER                                 66090006
661000         FROM 1 BY 1                                              66100006
661100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               66110006
661200             OR (SQLCODE = +0))                                   66120006
661300                                                                  66130006
661400         EXEC SQL                                                 66140006
661500             SELECT  OWNER_SCAC_ID                                66150006
661600                    ,VEH_NBR                                      66160006
661700                    ,CRT_SRC_CDE                                  66170006
661800                    ,LAST_UPD_DTE                                 66180006
661900                    ,LAST_UPD_TME                                 66190006
662000                    ,LAST_UPD_UID                                 66200006
662100                    ,USAGE_CDE                                    66210006
662200                    ,VEH_TYP_CDE                                  66220006
662300                    ,CURR_STATUS_CDE                              66230006
662400                    ,CURR_STATUS_DTE                              66240006
662500                    ,CURR_STATUS_TME                              66250006
662600                    ,CURR_OPER_UNT_ID                             66260006
662700                    ,CURR_FCLTY_ID                                66270006
662800                    ,CURR_FAC_AREA_ID                             66280006
662900                    ,CURR_LOC_DTE                                 66290006
663000                    ,CURR_LOC_TME                                 66300006
663100                    ,CURR_TRIP_ID                                 66310006
663200                    ,VEH_SIZE_CDE                                 66320006
663300            INTO     :VEHICL-OWNER-SCAC-ID                        66330006
663400                    ,:VEHICL-VEH-NBR                              66340006
663500                    ,:VEHICL-CRT-SRC-CDE                          66350006
663600                    ,:VEHICL-LAST-UPD-DTE                         66360006
663700                    ,:VEHICL-LAST-UPD-TME                         66370006
663800                    ,:VEHICL-LAST-UPD-UID                         66380006
663900                    ,:VEHICL-USAGE-CDE                            66390006
664000                    ,:VEHICL-VEH-TYP-CDE                          66400006
664100                    ,:VEHICL-CURR-STATUS-CDE                      66410006
664200                    ,:VEHICL-CURR-STATUS-DTE                      66420006
664300                    ,:VEHICL-CURR-STATUS-TME                      66430006
664400                    ,:VEHICL-CURR-OPER-UNT-ID                     66440006
664500                    ,:VEHICL-CURR-FCLTY-ID                        66450006
664600                    ,:VEHICL-CURR-FAC-AREA-ID                     66460006
664700                    ,:VEHICL-CURR-LOC-DTE                         66470006
664800                    ,:VEHICL-CURR-LOC-TME                         66480006
664900                    ,:VEHICL-CURR-TRIP-ID                         66490006
665000                       :DN-CURR-TRIP-ID                           66500006
665100                    ,:VEHICL-VEH-SIZE-CDE                         66510006
665200           FROM   TVEHICL                                         66520006
665300           WHERE  VEH_NBR       = :DK-VEH-NBR                     66530006
665400             AND  OWNER_SCAC_ID = :DK-OWNER-SCAC-ID               66540006
665500         END-EXEC                                                 66550006
665600                                                                  66560006
665700         EVALUATE TRUE                                            66570006
665800             WHEN SQLCODE = +0                                    66580006
665900             WHEN SQLCODE = -904                                  66590006
666000             WHEN SQLCODE = -913                                  66600006
666100                 CONTINUE                                         66610006
666200                                                                  66620006
666300             WHEN SQLWARN0 NOT = SPACES                           66630006
666400             WHEN SQLCODE < +0                                    66640006
666500             WHEN SQLCODE > +0                                    66650006
666600                 MOVE '8030-AUDIT-TVEHICL'                        66660006
666700                                   TO DP013-PARAGRAPH             66670006
666800                 MOVE 'SELECT A TVEHICL ROW   '                   66680006
666900                                   TO DP013-MESSAGE-TEXT(1)       66690006
667000                 MOVE SQLCA        TO DP013-SQLCA                 66700006
667100                 MOVE 'TVEHICL'    TO DP013-DB2-TABLE-NAME (1)    66710006
667200                 SET DP013-DB2-ABEND                              66720006
667300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           66730006
667400                 PERFORM DP013-0000-PROCESS-ABEND                 66740006
667500         END-EVALUATE                                             66750006
667600     END-PERFORM.                                                 66760006
667700                                                                  66770006
667800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    66780006
667900         SQLCODE NOT = +0                                         66790006
668000         MOVE '8030-AUDIT-TVEHICL '                               66800006
668100                                   TO DP013-PARAGRAPH             66810006
668200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              66820006
668300                                   TO DP013-MESSAGE-TEXT (1)      66830006
668400         MOVE 'TO SELECT A TVEHICL ROW'                           66840006
668500                                   TO DP013-MESSAGE-TEXT (2)      66850006
668600         MOVE SQLCA                TO DP013-SQLCA                 66860006
668700         MOVE 'TVEHICL'            TO DP013-DB2-TABLE-NAME (1)    66870006
668800         SET DP013-DB2-ABEND                                      66880006
668900             DP013-XCTL-DISPLAY-RESTART                           66890006
669000                                   TO TRUE                        66900006
669100         PERFORM DP013-0000-PROCESS-ABEND                         66910006
669200     END-IF.                                                      66920006
669300                                                                  66930006
669400     PERFORM                                                      66940006
669500         WITH TEST AFTER                                          66950006
669600         VARYING PV-RETRY-COUNTER                                 66960006
669700         FROM 1 BY 1                                              66970006
669800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               66980006
669900             OR (SQLCODE = +0))                                   66990006
670000                                                                  67000006
670100         EXEC SQL                                                 67010006
670200             INSERT  INTO TAUVHCL                                 67020006
670300                    (OWNER_SCAC_ID                                67030006
670400                    ,VEH_NBR                                      67040006
670500                    ,CRT_SRC_CDE                                  67050006
670600                    ,LAST_UPD_DTE                                 67060006
670700                    ,LAST_UPD_TME                                 67070006
670800                    ,LAST_UPD_UID                                 67080006
670900                    ,USAGE_CDE                                    67090006
671000                    ,VEH_TYP_CDE                                  67100006
671100                    ,CURR_STATUS_CDE                              67110006
671200                    ,CURR_STATUS_DTE                              67120006
671300                    ,CURR_STATUS_TME                              67130006
671400                    ,CURR_OPER_UNT_ID                             67140006
671500                    ,CURR_FCLTY_ID                                67150006
671600                    ,CURR_FAC_AREA_ID                             67160006
671700                    ,CURR_LOC_DTE                                 67170006
671800                    ,CURR_LOC_TME                                 67180006
671900                    ,CURR_TRIP_ID                                 67190006
672000                    ,VEH_SIZE_CDE)                                67200006
672100            VALUES  (:VEHICL-OWNER-SCAC-ID                        67210006
672200                    ,:VEHICL-VEH-NBR                              67220006
672300                    ,:VEHICL-CRT-SRC-CDE                          67230006
672400                    ,:VEHICL-LAST-UPD-DTE                         67240006
672500                    ,:VEHICL-LAST-UPD-TME                         67250006
672600                    ,:VEHICL-LAST-UPD-UID                         67260006
672700                    ,:VEHICL-USAGE-CDE                            67270006
672800                    ,:VEHICL-VEH-TYP-CDE                          67280006
672900                    ,:VEHICL-CURR-STATUS-CDE                      67290006
673000                    ,:VEHICL-CURR-STATUS-DTE                      67300006
673100                    ,:VEHICL-CURR-STATUS-TME                      67310006
673200                    ,:VEHICL-CURR-OPER-UNT-ID                     67320006
673300                    ,:VEHICL-CURR-FCLTY-ID                        67330006
673400                    ,:VEHICL-CURR-FAC-AREA-ID                     67340006
673500                    ,:VEHICL-CURR-LOC-DTE                         67350006
673600                    ,:VEHICL-CURR-LOC-TME                         67360006
673700                    ,:VEHICL-CURR-TRIP-ID                         67370006
673800                       :DN-CURR-TRIP-ID                           67380006
673900                    ,:VEHICL-VEH-SIZE-CDE)                        67390006
674000         END-EXEC                                                 67400006
674100                                                                  67410006
674200         EVALUATE TRUE                                            67420006
674300             WHEN SQLCODE = +0                                    67430006
674400             WHEN SQLCODE = -904                                  67440006
674500             WHEN SQLCODE = -913                                  67450006
674600                 CONTINUE                                         67460006
674700                                                                  67470006
674800             WHEN SQLWARN0 NOT = SPACES                           67480006
674900             WHEN SQLCODE < +0                                    67490006
675000             WHEN SQLCODE > +0                                    67500006
675100                 MOVE '8030-AUDIT-TVEHICL '                       67510006
675200                                   TO DP013-PARAGRAPH             67520006
675300                 MOVE 'INSERT A ROW ON TAUVHCL'                   67530006
675400                                   TO DP013-MESSAGE-TEXT(1)       67540006
675500                 MOVE SQLCA        TO DP013-SQLCA                 67550006
675600                 MOVE 'TAUVHCL'    TO DP013-DB2-TABLE-NAME (1)    67560006
675700                 SET DP013-DB2-ABEND                              67570006
675800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           67580006
675900                 PERFORM DP013-0000-PROCESS-ABEND                 67590006
676000         END-EVALUATE                                             67600006
676100     END-PERFORM.                                                 67610006
676200                                                                  67620006
676300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    67630006
676400         SQLCODE NOT = +0                                         67640006
676500         MOVE '8030-AUDIT-TAUVHCL'                                67650006
676600                                   TO DP013-PARAGRAPH             67660006
676700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              67670006
676800                                   TO DP013-MESSAGE-TEXT (1)      67680006
676900         MOVE 'TO INSERT A TAUVHCL ROW'                           67690006
677000                                   TO DP013-MESSAGE-TEXT (2)      67700006
677100         MOVE SQLCA                TO DP013-SQLCA                 67710006
677200         MOVE 'TAUVHCL'            TO DP013-DB2-TABLE-NAME (1)    67720006
677300         SET DP013-DB2-ABEND                                      67730006
677400             DP013-XCTL-DISPLAY-RESTART                           67740006
677500                                   TO TRUE                        67750006
677600         PERFORM DP013-0000-PROCESS-ABEND                         67760006
677700     END-IF.                                                      67770006
677800                                                                  67780006
677900/                                                                 67790006
678000*----------------------------------------------------------------*67800006
678100* OPEN THE SHIPMENT CURSROR                                      *67810006
678200*----------------------------------------------------------------*67820006
678300                                                                  67830006
678400 8100-OPEN-SHIPMENT-CSR.                                          67840006
678500                                                                  67850006
678600     PERFORM                                                      67860006
678700         WITH TEST AFTER                                          67870006
678800         VARYING PV-RETRY-COUNTER                                 67880006
678900         FROM 1 BY 1                                              67890006
679000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               67900006
679100            OR (SQLCODE = +0))                                    67910006
679200                                                                  67920006
679300         EXEC SQL                                                 67930006
679400              OPEN SHIPMENT-CSR                                   67940006
679500         END-EXEC                                                 67950006
679600                                                                  67960006
679700         EVALUATE TRUE                                            67970006
679800             WHEN SQLCODE = +0                                    67980006
679900                  CONTINUE                                        67990006
680000             WHEN SQLCODE = -904                                  68000006
680100             WHEN SQLCODE = -913                                  68010006
680200                  CONTINUE                                        68020006
680300             WHEN SQLWARN0 NOT = SPACE                            68030006
680400             WHEN SQLCODE  NOT = +0                               68040006
680500                  MOVE '8100-OPEN-SHIPMENT-CSR'                   68050006
680600                                   TO DP013-PARAGRAPH             68060006
680700                  MOVE 'OPEN SHIPMENT CURSOR'                     68070006
680800                                   TO DP013-MESSAGE-TEXT (1)      68080006
680900                  MOVE SQLCA       TO DP013-SQLCA                 68090006
681000                  MOVE 'TSHIPMT'   TO DP013-DB2-TABLE-NAME (1)    68100006
681100                  SET DP013-DB2-ABEND                             68110006
681200                                   TO TRUE                        68120006
681300                  PERFORM DP013-0000-PROCESS-ABEND                68130006
681400         END-EVALUATE                                             68140006
681500     END-PERFORM.                                                 68150006
681600                                                                  68160006
681700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    68170006
681800         SQLCODE NOT = +0                                         68180006
681900         MOVE '8100-OPEN-SHIPMENT-CSR'                            68190006
682000                                   TO DP013-PARAGRAPH             68200006
682100         MOVE 'MAX RETRIES EXCEEDED FOR OPEN SHIPMENT CURSOR'     68210006
682200                                   TO DP013-MESSAGE-TEXT (1)      68220006
682300         MOVE SQLCA                TO DP013-SQLCA                 68230006
682400         SET DP013-DB2-ABEND       TO TRUE                        68240006
682500         PERFORM DP013-0000-PROCESS-ABEND                         68250006
682600     END-IF.                                                      68260006
682700                                                                  68270006
682800/                                                                 68280006
682900*----------------------------------------------------------------*68290006
683000*    FETCH A SHIPMENT ROW                                        *68300006
683100*----------------------------------------------------------------*68310006
683200                                                                  68320006
683300 8102-FETCH-SHIPMENT-CSR.                                         68330006
683400                                                                  68340006
683500     EXEC SQL                                                     68350006
683600          FETCH SHIPMENT-CSR                                      68360006
683700          INTO :SHIPMT-SHIPT-ID                                   68370006
683800     END-EXEC                                                     68380006
683900                                                                  68390006
684000     EVALUATE TRUE                                                68400006
684100         WHEN SQLCODE = +0                                        68410006
684200              CONTINUE                                            68420006
684300                                                                  68430006
684400         WHEN SQLCODE = +100                                      68440006
684500              SET PS-NO-MORE-SHIPMENTS TO TRUE                    68450006
684600                                                                  68460006
684700         WHEN SQLWARN0 NOT = SPACE                                68470006
684800         WHEN SQLCODE < +0                                        68480006
684900         WHEN SQLCODE > +0                                        68490006
685000              MOVE '8102-FETCH-SHIPMENT-CSR'                      68500006
685100                                   TO DP013-PARAGRAPH             68510006
685200              MOVE 'FETCH SHIPMENT CURSOR'                        68520006
685300                                   TO DP013-MESSAGE-TEXT (1)      68530006
685400              MOVE SQLCA           TO DP013-SQLCA                 68540006
685500              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (1)    68550006
685600              SET DP013-DB2-ABEND  TO TRUE                        68560006
685700              PERFORM DP013-0000-PROCESS-ABEND                    68570006
685800     END-EVALUATE.                                                68580006
685900                                                                  68590006
686000/                                                                 68600006
686100*----------------------------------------------------------------*68610006
686200* CLOSE THE SHIPMENT CURSOR                                      *68620006
686300*----------------------------------------------------------------*68630006
686400                                                                  68640006
686500 8104-CLOSE-SHIPMENT-CSR.                                         68650006
686600                                                                  68660006
686700     EXEC SQL                                                     68670006
686800          CLOSE SHIPMENT-CSR                                      68680006
686900     END-EXEC                                                     68690006
687000                                                                  68700006
687100     EVALUATE TRUE                                                68710006
687200         WHEN SQLCODE = +0                                        68720006
687300              CONTINUE                                            68730006
687400         WHEN SQLWARN0 NOT = SPACE                                68740006
687500         WHEN SQLCODE  NOT = +0                                   68750006
687600              MOVE '8104-CLOSE-SHIPMENT-CSR'                      68760006
687700                                   TO DP013-PARAGRAPH             68770006
687800              MOVE 'CLOSE SHIPMENT CURSOR'                        68780006
687900                                   TO DP013-MESSAGE-TEXT (1)      68790006
688000              MOVE SQLCA           TO DP013-SQLCA                 68800006
688100              MOVE 'TSHIPMT'       TO DP013-DB2-TABLE-NAME (1)    68810006
688200              SET DP013-DB2-ABEND  TO TRUE                        68820006
688300              PERFORM DP013-0000-PROCESS-ABEND                    68830006
688400     END-EVALUATE.                                                68840006
688500                                                                  68850006
688600/                                                                 68860006
688700*----------------------------------------------------------------*68870006
688800*  SELECT LATEST SHIPMENT STATUS ROW                             *68880006
688900*----------------------------------------------------------------*68890006
689000 8110-SELECT-TSHIPST.                                             68900006
689100                                                                  68910006
689200     PERFORM                                                      68920006
689300         WITH TEST AFTER                                          68930006
689400         VARYING PV-RETRY-COUNTER                                 68940006
689500         FROM 1 BY 1                                              68950006
689600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               68960006
689700             OR (SQLCODE = +0))                                   68970006
689800                                                                  68980006
689900         EXEC SQL                                                 68990006
690000             SELECT  A.SHIPT_ID                                   69000006
690100                    ,A.SHIPT_STATUS_CDE                           69010006
690200                    ,A.STATUS_DTE                                 69020006
690300                    ,A.STATUS_TME                                 69030006
690400                    ,A.STATUS_UID                                 69040006
690500                    ,A.DELAY_RSN_CDE                              69050006
690600                    ,A.CARR_STATUS_CDE                            69060006
690700                    ,A.TIME_ZONE_CDE                              69070006
690800                    ,A.CITY_NAME                                  69080006
690900                    ,A.STATE_CDE                                  69090006
691000             INTO    :SHIPST-SHIPT-ID                             69100006
691100                    ,:SHIPST-SHIPT-STATUS-CDE                     69110006
691200                    ,:SHIPST-STATUS-DTE                           69120006
691300                    ,:SHIPST-STATUS-TME                           69130006
691400                    ,:SHIPST-STATUS-UID                           69140006
691500                    ,:SHIPST-DELAY-RSN-CDE                        69150006
691600                    ,:SHIPST-CARR-STATUS-CDE                      69160006
691700                    ,:SHIPST-TIME-ZONE-CDE                        69170006
691800                    ,:SHIPST-CITY-NAME                            69180006
691900                    ,:SHIPST-STATE-CDE                            69190006
692000           FROM   TSHIPST A                                       69200006
692100                 ,TSHSTYP B                                       69210006
692200           WHERE  A.SHIPT_ID = :DK-SHIPT-ID                       69220006
692300             AND  B.PRTY_CDE =                                    69230006
692400                  (SELECT MAX(D.PRTY_CDE)                         69240006
692500                     FROM TSHIPST C                               69250006
692600                         ,TSHSTYP D                               69260006
692700                    WHERE C.SHIPT_ID         = A.SHIPT_ID         69270006
692800                      AND C.SHIPT_STATUS_CDE = D.SHIPT_STATUS_CDE)69280006
692900             AND  A.SHIPT_STATUS_CDE = B.SHIPT_STATUS_CDE         69290006
692910            WITH UR                                               69291008
693000         END-EXEC                                                 69300006
693100                                                                  69310006
693200         EVALUATE TRUE                                            69320006
693300             WHEN SQLCODE = +0                                    69330006
693400             WHEN SQLCODE = -904                                  69340006
693500             WHEN SQLCODE = -913                                  69350006
693600                 CONTINUE                                         69360006
693700                                                                  69370006
693800             WHEN SQLWARN0 NOT = SPACES                           69380006
693900             WHEN SQLCODE < +0                                    69390006
694000             WHEN SQLCODE > +0                                    69400006
694100                 MOVE '8110-SELECT-TSHIPST'                       69410006
694200                                   TO DP013-PARAGRAPH             69420006
694300                 MOVE 'SELECT A TSHIPST ROW   '                   69430006
694400                                   TO DP013-MESSAGE-TEXT(1)       69440006
694500                 MOVE SQLCA        TO DP013-SQLCA                 69450006
694600                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    69460006
694700                 SET DP013-DB2-ABEND                              69470006
694800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           69480006
694900                 PERFORM DP013-0000-PROCESS-ABEND                 69490006
695000         END-EVALUATE                                             69500006
695100     END-PERFORM.                                                 69510006
695200                                                                  69520006
695300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    69530006
695400         SQLCODE NOT = +0                                         69540006
695500         MOVE '8110-SELECT-TSHIPST'                               69550006
695600                                   TO DP013-PARAGRAPH             69560006
695700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              69570006
695800                                   TO DP013-MESSAGE-TEXT (1)      69580006
695900         MOVE 'TO SELECT A TSHIPST ROW'                           69590006
696000                                   TO DP013-MESSAGE-TEXT (2)      69600006
696100         MOVE SQLCA                TO DP013-SQLCA                 69610006
696200         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    69620006
696300         SET DP013-DB2-ABEND                                      69630006
696400             DP013-XCTL-DISPLAY-RESTART                           69640006
696500                                   TO TRUE                        69650006
696600         PERFORM DP013-0000-PROCESS-ABEND                         69660006
696700     END-IF.                                                      69670006
696800                                                                  69680006
696900/                                                                 69690006
697000*----------------------------------------------------------------*69700006
697100*  INSERT A SHIPMENT STATUS ROW                                  *69710006
697200*----------------------------------------------------------------*69720006
697300 8120-INSERT-TSHIPST.                                             69730006
697400                                                                  69740006
697500     PERFORM                                                      69750006
697600         WITH TEST AFTER                                          69760006
697700         VARYING PV-RETRY-COUNTER                                 69770006
697800         FROM 1 BY 1                                              69780006
697900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               69790006
698000             OR (SQLCODE = +0))                                   69800006
698100                                                                  69810006
698200         EXEC SQL                                                 69820006
698300             INSERT  INTO TSHIPST                                 69830006
698400                    (SHIPT_ID                                     69840006
698500                    ,SHIPT_STATUS_CDE                             69850006
698600                    ,STATUS_DTE                                   69860006
698700                    ,STATUS_TME                                   69870006
698800                    ,STATUS_UID                                   69880006
698900                    ,DELAY_RSN_CDE                                69890006
699000                    ,CARR_STATUS_CDE                              69900006
699100                    ,TIME_ZONE_CDE                                69910006
699200                    ,CITY_NAME                                    69920006
699300                    ,STATE_CDE )                                  69930006
699400            VALUES  (:SHIPST-SHIPT-ID                             69940006
699500                    ,:SHIPST-SHIPT-STATUS-CDE                     69950006
699600                    ,CURRENT DATE                                 69960006
699700                    ,CURRENT TIME                                 69970006
699800                    ,:DP020-USERID                                69980006
699900                    ,:SHIPST-DELAY-RSN-CDE                        69990006
700000                    ,:SHIPST-CARR-STATUS-CDE                      70000006
700100                    ,:SHIPST-TIME-ZONE-CDE                        70010006
700200                    ,:SHIPST-CITY-NAME                            70020006
700300                    ,:SHIPST-STATE-CDE )                          70030006
700400         END-EXEC                                                 70040006
700500                                                                  70050006
700600         EVALUATE TRUE                                            70060006
700700             WHEN SQLCODE = +0                                    70070006
700800             WHEN SQLCODE = -904                                  70080006
700900             WHEN SQLCODE = -913                                  70090006
701000                 CONTINUE                                         70100006
701100                                                                  70110006
701200             WHEN SQLWARN0 NOT = SPACES                           70120006
701300             WHEN SQLCODE < +0                                    70130006
701400             WHEN SQLCODE > +0                                    70140006
701500                 MOVE '8120-INSERT-TSHIPST'                       70150006
701600                                   TO DP013-PARAGRAPH             70160006
701700                 MOVE 'INSERT A ROW ON TSHIPST'                   70170006
701800                                   TO DP013-MESSAGE-TEXT(1)       70180006
701900                 MOVE SQLCA        TO DP013-SQLCA                 70190006
702000                 MOVE 'TSHIPST'    TO DP013-DB2-TABLE-NAME (1)    70200006
702100                 SET DP013-DB2-ABEND                              70210006
702200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           70220006
702300                 PERFORM DP013-0000-PROCESS-ABEND                 70230006
702400         END-EVALUATE                                             70240006
702500     END-PERFORM.                                                 70250006
702600                                                                  70260006
702700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    70270006
702800         SQLCODE NOT = +0                                         70280006
702900         MOVE '8120-INSERT-TSHIPST'                               70290006
703000                                   TO DP013-PARAGRAPH             70300006
703100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              70310006
703200                                   TO DP013-MESSAGE-TEXT (1)      70320006
703300         MOVE 'TO INSERT A TSHIPST ROW'                           70330006
703400                                   TO DP013-MESSAGE-TEXT (2)      70340006
703500         MOVE SQLCA                TO DP013-SQLCA                 70350006
703600         MOVE 'TSHIPST'            TO DP013-DB2-TABLE-NAME (1)    70360006
703700         SET DP013-DB2-ABEND                                      70370006
703800             DP013-XCTL-DISPLAY-RESTART                           70380006
703900                                   TO TRUE                        70390006
704000         PERFORM DP013-0000-PROCESS-ABEND                         70400006
704100     END-IF.                                                      70410006
704200                                                                  70420006
704300                                                                  70430018
704301*-----------------------------------------------------------------70430118
704302* CHECK PARM TABLE TO SEE IF CURRENT DC LOCATION TO SEE IF THE   *70430218
704303* DC IS USING RPA MIS-DIRECT PROCESS                             *70430318
704304*-----------------------------------------------------------------70430418
704305 8200-CHECK-RPAMSD.                                               70430518
704306                                                                  70430618
704307     SET ASC-NO-RPA-MISDRCT-CK TO TRUE.                           70430718
704308     MOVE ASC-KEY-OPER-UNT-ID  TO KRPRPM-LOC-ID.                  70430818
704309                                                                  70430918
704310     PERFORM                                                      70431018
704311         WITH TEST AFTER                                          70431118
704312         VARYING PV-RETRY-COUNTER                                 70431218
704313         FROM 1 BY 1                                              70431318
704314         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               70431418
704315            OR (SQLCODE = +0)                                     70431518
704316            OR (SQLCODE = +100))                                  70431618
704317                                                                  70431718
704318         EXEC SQL                                                 70431819
704319              SELECT FUNC_TXT                                     70431919
704320                INTO :KRPRPM-FUNC-TXT                             70432019
704321                FROM TKRPRPM                                      70432119
704322               WHERE LOC_ID            = :ASC-KEY-OPER-UNT-ID     70432219
704323                 AND INTFC_SYS_CDE     = 'KHL'                    70432319
704324                 AND SYS_PRC_FUNC_CDE  = 'RPAMSD'                 70432419
704325                 AND FUNC_PRC_STAT_CDE = 'AC'                     70432519
704326                 AND FUNC_BEG_TMST    <= CURRENT TIMESTAMP        70432619
704327                 AND FUNC_END_TMST    >= CURRENT TIMESTAMP        70432719
704328                 AND FUNC_TXT          = 'Y'                      70432819
704343                     WITH UR                                      70434319
704344         END-EXEC                                                 70434418
704345                                                                  70434518
704346         EVALUATE TRUE                                            70434618
704347             WHEN SQLCODE = +0                                    70434718
704348                  SET  ASC-RPA-MISDRCT-CK     TO  TRUE            70434818
704349             WHEN SQLCODE = +100                                  70434918
704350                  SET  ASC-NO-RPA-MISDRCT-CK  TO TRUE             70435018
704351                                                                  70435118
704352             WHEN SQLWARN0 NOT = SPACES                           70435218
704353             WHEN SQLCODE < +0                                    70435318
704354             WHEN SQLCODE > +0                                    70435418
704355                  MOVE '8200-CHECK-RPAMSD         '               70435518
704356                                  TO DP013-PARAGRAPH              70435618
704357                  MOVE 'UNSUCCESSFUL SELECT ON TKRPRPM'           70435718
704358                                  TO DP013-MESSAGE-TEXT (1)       70435818
704359                  MOVE SQLCA      TO DP013-SQLCA                  70435918
704360                  MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)     70436018
704361                  SET DP013-DB2-ABEND                             70436118
704362                      DP013-XCTL-DISPLAY-RESTART                  70436218
704363                                  TO TRUE                         70436318
704364                  PERFORM DP013-0000-PROCESS-ABEND                70436418
704365         END-EVALUATE                                             70436518
704366     END-PERFORM.                                                 70436618
704367                                                                  70436718
704368     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    70436818
704369         SQLCODE NOT = +0                                         70436918
704370         MOVE '8200-CHECK-RPAMSD         '                        70437018
704371                                  TO DP013-PARAGRAPH              70437118
704372         MOVE 'MAX RETRIES EXCEEDED ON SELECT TKRPRPM'            70437218
704373                                  TO DP013-MESSAGE-TEXT (1)       70437318
704374         MOVE SQLCA               TO DP013-SQLCA                  70437418
704375         MOVE 'TKRPRPM '          TO DP013-DB2-TABLE-NAME (1)     70437518
704376         SET DP013-DB2-ABEND                                      70437618
704377             DP013-XCTL-DISPLAY-RESTART                           70437718
704378                                  TO TRUE                         70437818
704379         PERFORM DP013-0000-PROCESS-ABEND                         70437918
704380     END-IF.                                                      70438018
704381                                                                  70438118
704382                                                                  70438218
704383*----------------------------------------------------------------*70438318
704384*  RPA MISDIRECT - START E838 (RCKCS838) TO CAPTURE MISDIRECT     70438418
704385*  RECEIVER INFORMATION                                           70438518
704386*----------------------------------------------------------------*70438618
704387 8210-RPA-MISDIRECT.                                              70438718
704388                                                                  70438818
704389     INITIALIZE RC077-UNLOADED-TRLR-COMMAREA.                     70438918
704390                                                                  70439018
704391     MOVE ASC-KEY-OPER-UNT-ID   TO RC077-OPER-UNT-ID              70439118
704392     MOVE ASC-KEY-OWNER-SCAC-ID TO RC077-SCAC                     70439218
704393     MOVE ASC-KEY-VEH-NBR       TO RC077-VEH-NBR                  70439318
704394     MOVE ASC-KEY-TRIP-ID       TO RC077-TRIP-ID                  70439418
704395     MOVE 'RCKCS225'            TO RC077-FROM-PROGRAM             70439518
704396                                                                  70439618
704397                                                                  70439718
704398     EXEC CICS                                                    70439818
704399         START TRANSID(PC-E838-RPAMSD)                            70439918
704400               FROM   (RC077-UNLOADED-TRLR-COMMAREA)              70440018
704401     END-EXEC.                                                    70440118
704402                                                                  70440218
704403                                                                  70440318
704410******************************************************************70441006
704500* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *70450006
704600******************************************************************70460006
704700 9100-READ-SEL-QUEUE.                                             70470006
704800     EXEC CICS                                                    70480006
704900         READQ TS                                                 70490006
705000             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        70500006
705100             INTO  (TR006-DOCK-SCHEDULE-REC)                      70510006
705200             ITEM  (ASC-SEL-ITEM)                                 70520006
705300             RESP  (PV-CICS-RESP)                                 70530006
705400     END-EXEC.                                                    70540006
705500                                                                  70550006
705600     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        70560006
705700         CONTINUE                                                 70570006
705800     ELSE                                                         70580006
705900         SET DP013-LOGIC-ABEND                                    70590006
706000             DP013-NO-ROLLBACK     TO TRUE                        70600006
706100         MOVE '9100-READ-SEL-QUEUE'                               70610006
706200                                   TO DP013-PARAGRAPH             70620006
706300         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    70630006
706400                                   TO DP013-MESSAGE-TEXT (1)      70640006
706500         PERFORM DP013-0000-PROCESS-ABEND                         70650006
706600     END-IF.                                                      70660006
706700                                                                  70670006
706800/                                                                 70680006
706900******************************************************************70690006
707000* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *70700006
707100******************************************************************70710006
707200 9200-REWRITE-LIST-QUEUE.                                         70720006
707300     EXEC CICS                                                    70730006
707400          WRITEQ TS                                               70740006
707500              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     70750006
707600              FROM    (TR006-DOCK-SCHEDULE-REC)                   70760006
707700              ITEM    (ASC-SEL-ITEM)                              70770006
707800              RESP    (PV-CICS-RESP)                              70780006
707900              REWRITE                                             70790006
708000     END-EXEC.                                                    70800006
708100                                                                  70810006
708200     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    70820006
708300         SET DP013-CICS-ABEND                                     70830006
708400             DP013-NO-ROLLBACK     TO TRUE                        70840006
708500         MOVE '9200-REWRITE-LIST-QUEUE'                           70850006
708600                                   TO DP013-PARAGRAPH             70860006
708700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   70870006
708800                                   TO DP013-MESSAGE-TEXT (1)      70880006
708900         PERFORM DP013-0000-PROCESS-ABEND                         70890006
709000     END-IF.                                                      70900006
709100                                                                  70910006
709200/                                                                 70920006
709300******************************************************************70930006
709400**  WRITE TO LOG                                                **70940006
709500******************************************************************70950006
709600 9300-WRITE-CICS-LOG.                                             70960006
709700                                                                  70970006
709800     MOVE LENGTH PV-CICS-MSG-AREA TO                              70980006
709900                                     PV-COMMAREA-LENGTH.          70990006
710000     EXEC CICS                                                    71000006
710010          WRITEQ TD                                               71001006
710020          QUEUE  ('CSSL')                                         71002006
710030          FROM  (PV-CICS-MSG-AREA)                                71003006
710040          LENGTH  (PV-COMMAREA-LENGTH)                            71004006
710050          RESP  (PV-CICS-RESP)                                    71005006
710060     END-EXEC.                                                    71006006
710070                                                                  71007006
710080     MOVE SPACES TO PV-CICS-MSG-AREA.                             71008006
710090                                                                  71009006
710100*----------------------------------------------------------------*71010006
710200*    ABEND PROCESSOR MODULE                                      *71020006
710300*----------------------------------------------------------------*71030006
710400                                                                  71040006
710500     COPY DPPD013.                                                71050006
