000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS237.                                         00020000
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  03/03/94.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080000
000900*  RCKCS237 - TRANID = E237                                      *00090000
001000*                                                                *00100000
001100*  THIS PROGRAM WILL PRINT INFORMATION FOR ITEMS OF A SPECIFIC   *00110000
001200*  RECEIPT THAT ARE BEING SHIPPED TO A SPECIFIC STORE.           *00120000
001300*                                                                *00130000
001400*  THIS PROGRAM USES CODE V LANGUAGE COMMANDS FOR THE MAGNUM     *00140000
001500*  CONTROLLER.  THIS CONTROLLER IS BEING USED IN A PRINTRONIX    *00150000
001600*  PRINTER.  THE COMMANDS USED IN THIS PROGRAM ARE USED ONLY     *00160000
001700*  TO CONTROL THE FONT SIZE (SIZE OF PRINT), AND FORM FEEDS.     *00170000
001800*  ALL CODE V LANGUAGE COMMANDS ARE OUTLINED IN THE QMS CODE V   *00180000
001900*  PROGRAMMING MANUAL.                                           *00190000
002000******************************************************************00200000
002100                                                                  00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300 DATA DIVISION.                                                   00230000
002400                                                                  00240000
002500/                                                                 00250000
002600 WORKING-STORAGE SECTION.                                         00260000
002700 01  FILLER                           PIC X(36)  VALUE            00270000
002800     'RCKCS237 WORKING STORAGE STARTS HERE'.                      00280000
002900                                                                  00290000
003000*                                                                 00300000
003100*----------------------------------------------------------------*00310000
003200*   LOGISTICS DOMAIN ITEM ACCESS MODULE COPYBOOK  * WR # 230ZZ   *00320000
003300*----------------------------------------------------------------*00330000
003400     COPY XLWS001.                                                00340000
003500*                                                                 00350000
003600*-----------------------------------------------------------------00360000
003700* COMMAREA FOR XLKUT086 - PERM PRICE MODULE                       00370000
003800*-----------------------------------------------------------------00380000
003900     COPY XLWS086.                                                00390000
004000/                                                                 00400000
004100*----------------------------------------------------------------*00410000
004200*   LOCATION TABLE ACCESS MODULE COPYBOOK                         00420000
004300*----------------------------------------------------------------*00430000
004400     COPY XLWS071.                                                00440000
004500*                                                                 00450000
004600*----------------------------------------------------------------*00460000
004700*   CHANGES MADE FOR WR # 230ZZ ENDS HERE.                       *00470000
004800*----------------------------------------------------------------*00480000
004900*                                                                 00490000
005000*  STANDARD ATTENTION IDENTIFIER LIST                             00500000
005100     COPY DFHAID.                                                 00510000
005200*                                                                 00520000
005300*  LAYOUT FOR DRS COMMAREA                                        00530000
005400     COPY DRRD001O.                                               00540000
005500*                                                                 00550000
005600*  LAYOUT FOR THE DYNAMIC REPORT DETAIL LINES                     00560000
005700     COPY DRRD002O.                                               00570000
005800*                                                                 00580000
005900*  LAYOUT FOR THE PRINT PACKAGE PRINTER CONTROL COMMANDS          00590000
006000*                                                                 00600000
006100     COPY DSWS004.                                                00610000
006200/                                                                 00620000
006300*                                                                 00630000
006400*  LAYOUT FOR THE PRINTER VALIDATION ROUTINE COMMAREA             00640000
006500*                                                                 00650000
006600     COPY DPWS072.                                                00660000
006700/                                                                 00670000
006800 01  DP122O-STANDRD-HEADER-122-COLS.                              00680000
006900     05  DP122O-LASER-NEW-PAGE-INDICATR    PIC X(02) VALUE SPACE. 00690000
007000     05  DP122O-RUN-DATE.                                         00700000
007100         10  DP122O-RUN-MONTH              PIC 9(02) VALUE ZERO.  00710000
007200         10  FILLER                        PIC X(01) VALUE '/'.   00720000
007300         10  DP122O-RUN-DAY                PIC 9(02) VALUE ZERO.  00730000
007400         10  FILLER                        PIC X(01) VALUE '/'.   00740000
007500         10  DP122O-RUN-YEAR               PIC 9(02) VALUE ZERO.  00750000
007600     05  FILLER                            PIC X(02) VALUE SPACE. 00760000
007700     05  DP122O-RUN-TIME.                                         00770000
007800         10  DP122O-RUN-HOUR               PIC 9(02) VALUE ZERO.  00780000
007900         10  FILLER                        PIC X(01) VALUE ':'.   00790000
008000         10  DP122O-RUN-MINUTE             PIC 9(02) VALUE ZERO.  00800000
008100     05  FILLER                            PIC X(27) VALUE SPACE. 00810000
008200     05  FILLER                            PIC X(45)              00820000
008300         VALUE 'K O H L S   D E P A R T M E N T   S T O R E S'.   00830000
008400     05  FILLER                            PIC X(10) VALUE SPACE. 00840000
008500     05  DP122O-PROGRAM-NAME               PIC X(08) VALUE SPACE. 00850000
008600     05  FILLER                            PIC X(01) VALUE '-'.   00860000
008700     05  DP122O-REPORT-NUMBER              PIC 9(01) VALUE ZERO.  00870000
008800     05  FILLER                            PIC X(02) VALUE SPACE. 00880000
008900     05  FILLER                            PIC X(05) VALUE 'PAGE'.00890000
009000     05  DP122O-PAGE-NUMBER                PIC ZZZZ9 VALUE ZERO.  00900000
009100                                                                  00910000
009200/                                                                 00920000
009300                                                                  00930000
009400 01  IE-DRS-ERROR-MSG.                                            00940000
009500     05  FILLER                       PIC X(41)  VALUE            00950000
009600     'A DRS ERROR HAS OCCURRED  - CONTACT DP - '.                 00960000
009700     05  FILLER                       PIC X(44)  VALUE            00970000
009800     'PROGRAM RCKCS237'.                                          00980000
009900     05  FILLER                       PIC X(11)  VALUE            00990000
010000     'FUNCTION = '.                                               01000000
010100     05  IE-DRS-FUNC                  PIC X(04)  VALUE SPACE.     01010000
010200     05  FILLER                       PIC X(14)  VALUE            01020000
010300     'RETURN CODE = '.                                            01030000
010400     05  IE-DRS-RC                    PIC X(04)  VALUE SPACES.    01040000
010500                                                                  01050000
010600 01  IE-DB2-ERROR-MSG.                                            01060000
010700     05  FILLER                       PIC X(41)  VALUE            01070000
010800     'AN DB2 ERROR HAS OCCURRED - CONTACT DP - '.                 01080000
010900     05  FILLER                       PIC X(44)  VALUE            01090000
011000     'PROGRAM RCKCS237'.                                          01100000
011100     05  IE-ATTEMPTED-ACTION          PIC X(80)  VALUE SPACE.     01110000
011200                                                                  01120000
011300/                                                                 01130000
011400*                                                                 01140000
011500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01150000
011600*                                                                 01160000
011700     COPY DPWS013.                                                01170000
011800/                                                                 01180000
011900                                                                  01190000
012000 01  H1-HEADING-LINE1.                                            01200000
012100     05  FILLER                       PIC X(60)  VALUE SPACES.    01210000
012200     05  FILLER                       PIC X(12)  VALUE            01220000
012300         'PACKING SLIP'.                                          01230000
012400     05  FILLER                       PIC X(50)  VALUE SPACES.    01240000
012500                                                                  01250000
012600 01  H2-HEADING-LINE2.                                            01260000
012700     05  FILLER                       PIC X(11)  VALUE SPACES.    01270000
012800     05  H2-STORE-NBR                 PIC X(04)  VALUE SPACES.    01280000
012900     05  FILLER                       PIC X(02)  VALUE '^-'.      01290000
013000                                                                  01300000
013100 01  H2-HEADING-LINE2-NO-BARCODE.                                 01310000
013200     05  FILLER                       PIC X(63)  VALUE SPACES.    01320000
013300     05  H2-STORE-NBR-NB              PIC X(04)  VALUE SPACES.    01330000
013400                                                                  01340000
013500 01  H3-HEADING-LINE3.                                            01350000
013600     05  FILLER                       PIC X(60)  VALUE SPACES.    01360000
013700     05  H3-STORE-NAME                PIC X(25)  VALUE SPACES.    01370000
013800     05  FILLER                       PIC X(37)  VALUE SPACES.    01380000
013900                                                                  01390000
014000 01  H4-HEADING-LINE4.                                            01400000
014100     05  FILLER                       PIC X(07)  VALUE            01410000
014200         '  PO - '.                                               01420000
014300     05  H4-PO-NBR                    PIC X(08)  VALUE SPACES.    01430000
014400     05  FILLER                       PIC X(02)  VALUE SPACES.    01440000
014500     05  FILLER                       PIC X(09)  VALUE            01450000
014600         'VENDOR - '.                                             01460000
014700     05  H4-INHOUSE-NBR               PIC X(03)  VALUE SPACES.    01470000
014800     05  FILLER                       PIC X(01)  VALUE SPACES.    01480000
014900     05  H4-VENDOR-NAME               PIC X(25)  VALUE SPACES.    01490000
015000     05  FILLER                       PIC X(01)  VALUE SPACES.    01500000
015100     05  FILLER                       PIC X(14)  VALUE            01510000
015200         'REC SEQ NBR - '.                                        01520000
015300     05  H4-REC-SEQ-NBR               PIC X(04)  VALUE SPACES.    01530000
015400     05  FILLER                       PIC X(02)  VALUE SPACES.    01540000
015500     05  FILLER                       PIC X(16)  VALUE            01550000
015600         'OPER SET DESC - '.                                      01560000
015700     05  H4-OPER-SET-DESC             PIC X(25)  VALUE SPACES.    01570000
015800                                                                  01580000
015900 01  H4A-HEADING-LINE4A.                                          01590000
016000     05  FILLER                       PIC X(02)  VALUE SPACES.    01600000
016100     05  FILLER                       PIC X(16)  VALUE            01610000
016200         'DELIVERY SCAC - '.                                      01620000
016300     05  H4A-DELIVERY-SCAC            PIC X(04)  VALUE SPACES.    01630000
016400     05  FILLER                       PIC X(04)  VALUE SPACES.    01640000
016500     05  FILLER                       PIC X(17)  VALUE            01650000
016600         'TRAILER NUMBER - '.                                     01660000
016700     05  H4A-TRAILER                  PIC X(10)  VALUE SPACES.    01670000
016800     05  FILLER                       PIC X(03)  VALUE SPACES.    01680000
016900     05  FILLER                       PIC X(10)  VALUE            01690000
017000         'TRIP ID - '.                                            01700000
017100     05  H4A-TRIP-ID                  PIC 9(09)  VALUE ZERO       01710000
017200                                              BLANK ZERO.         01720000
017300     05  FILLER                       PIC X(02)  VALUE SPACES.    01730000
017400*----------------------------------------------------------------*01740000
017500*    MOVED DEPT-NBR FROM D1-DETAIL-LINE1**      WR # 230ZZ       *01750000
017600*----------------------------------------------------------------*01760000
017700     05  FILLER                       PIC X(06)  VALUE            01770000
017800         'DEPT: '.                                                01780000
017900     05  H4A-DEPT-NBR                 PIC X(03)  VALUE SPACES.    01790000
018000*----------------------------------------------------------------*01800000
018100*    CHANGES MADE FOR WR # 230ZZ ENDS HERE.                       01810000
018200*----------------------------------------------------------------*01820000
018300     05  FILLER                       PIC X(10)  VALUE SPACES.    01830000
018400     05  FILLER                       PIC X(17)  VALUE            01840000
018500         'MARKER __________'.                                     01850000
018600     05  FILLER                       PIC X(08)  VALUE SPACES.    01860000
018700                                                                  01870000
018800 01  H5-HEADING-LINE5.                                            01880000
018900     05  FILLER                       PIC X(12)  VALUE SPACES.    01890000
019000     05  FILLER                       PIC X(04)  VALUE SPACES.    01900000
019100     05  FILLER                       PIC X(41)  VALUE            01910000
019200         ' UNIT        GROUP  OPEN TO INV  EXTENDED'.             01920000
019300     05  FILLER                       PIC X(16)  VALUE SPACES.    01930000
019400     05  FILLER                       PIC X(12)  VALUE            01940000
019500         'VENDOR STYLE'.                                          01950000
019600     05  FILLER                       PIC X(03)  VALUE SPACES.    01960000
019700     05  FILLER                       PIC X(05)  VALUE 'KOHLS'.   01970000
019800     05  FILLER                       PIC X(06)  VALUE SPACES.    01980000
019900     05  FILLER                       PIC X(05)  VALUE 'COLOR'.   01990000
020000     05  FILLER                       PIC X(05)  VALUE SPACES.    02000000
020100     05  FILLER                       PIC X(02)  VALUE 'PO'.      02010000
020200     05  FILLER                       PIC X(01)  VALUE SPACES.    02020000
020300     05  FILLER                       PIC X(04)  VALUE 'CERT'.    02030000
020400     05  FILLER                       PIC X(07)  VALUE SPACES.    02040000
020500                                                                  02050000
020600 01  H6-HEADING-LINE6.                                            02060000
020700     05  FILLER                       PIC X(12)  VALUE            02070000
020800         ' CL --SKU---'.                                          02080000
020900     05  FILLER                       PIC X(03)  VALUE SPACES.    02090000
021000     05  FILLER                       PIC X(53)  VALUE            02100000
021100         ' RETAIL UM    PRICE  RECEIVE QTY  RETAIL    UPC     '.  02110000
021200     05  FILLER                       PIC X(06)  VALUE SPACES.    02120000
021300     05  FILLER                       PIC X(38)  VALUE            02130000
021400         '/SKU DESC     STYLE      /SIZE    LINE'.                02140000
021500     05  FILLER                       PIC X(01)  VALUE SPACES.    02150000
021600     05  FILLER                       PIC X(03)  VALUE            02160000
021700         'REQ'.                                                   02170000
021800     05  FILLER                       PIC X(06)  VALUE SPACES.    02180000
021900                                                                  02190000
022000*----------------------------------------------------------------*02200000
022100*    REDECLARED D1-SKU-NBR TO PIC X(08)         **   WR # 230ZZ  *02210000
022200*                        FROM PIC X(03)                          *02220000
022300*    MOVED DEPT-NBR TO H4A-HEADING-LINE4A                        *02230000
022400*----------------------------------------------------------------*02240000
022500 01  D1-DETAIL-LINE1.                                             02250000
022600     05  FILLER                       PIC X(01)  VALUE SPACES.    02260000
022700     05  D1-CLASS-NBR                 PIC X(02)  VALUE SPACES.    02270000
022800     05  FILLER                       PIC X(01)  VALUE SPACES.    02280000
022900     05  D1-SKU-NBR                   PIC X(08)  VALUE SPACES.    02290000
023000*----------------------------------------------------------------*02300000
023100*    CHANGES MADE FOR WR # 230ZZ ENDS HERE.                       02310000
023200*----------------------------------------------------------------*02320000
023300     05  FILLER                       PIC X(01)  VALUE SPACES.    02330000
023400     05  D1-UNIT-RETAIL               PIC ZZ,ZZ9.99 VALUE ZEROES. 02340000
023500     05  FILLER                       PIC X(01)  VALUE SPACES.    02350000
023600     05  D1-UM                        PIC X(02)  VALUE SPACES.    02360000
023700     05  FILLER                       PIC X(01)  VALUE SPACES.    02370000
023800     05  D1-GROUP-PRICE               PIC X(10)  VALUE SPACES.    02380000
023900     05  FILLER                       PIC X(02)  VALUE SPACES.    02390000
024000     05  D1-ORD-QTY                   PIC ZZZ9   VALUE ZEROES.    02400000
024100     05  FILLER                       PIC X(01)  VALUE SPACES.    02410000
024200     05  D1-INV-QTY                   PIC ZZZ9   VALUE ZEROES.    02420000
024300     05  FILLER                       PIC X(01)  VALUE SPACES.    02430000
024400     05  D1-EXT-RETAIL               PIC ZZZ,ZZ9.99 VALUE ZEROES. 02440000
024500     05  FILLER                       PIC X(01)  VALUE SPACES.    02450000
024600     05  D1-UPC-NBR                   PIC X(15)  VALUE ZEROES.    02460000
024700     05  FILLER                       PIC X(01)  VALUE SPACES.    02470000
024800     05  D1-VENDOR-STYLE              PIC X(09)  VALUE ZEROES.    02480000
024900     05  FILLER                       PIC X(04)  VALUE SPACES.    02490000
025000     05  D1-KOHLS-STYLE               PIC X(05)  VALUE ZEROES.    02500000
025100     05  FILLER                       PIC X(04)  VALUE SPACES.    02510000
025200     05  D1-COLOR                     PIC X(10)  VALUE ZEROES.    02520000
025300     05  FILLER                       PIC X(01)  VALUE SPACES.    02530000
025400     05  D1-LINE                      PIC ZZZZ   VALUE ZEROES.    02540000
025500     05  FILLER                       PIC X(02)  VALUE SPACES.    02550000
025600     05  D1-CERT-REQ                  PIC X(01)  VALUE ZEROES.    02560000
025700     05  FILLER                       PIC X(08)  VALUE SPACES.    02570000
025800                                                                  02580000
025900 01  D2-DETAIL-LINE2.                                             02590000
026000     05  FILLER                       PIC X(59)  VALUE SPACES.    02600000
026100     05  D2-UPC-NBR                   PIC X(15)  VALUE ZEROES.    02610000
026200     05  FILLER                       PIC X(01)  VALUE SPACES.    02620000
026300     05  D2-SKU-DESC                  PIC X(21)  VALUE SPACES.    02630000
026400     05  FILLER                       PIC X(01)  VALUE SPACES.    02640000
026500     05  D2-SIZE                      PIC X(10)  VALUE ZEROES.    02650000
026600     05  FILLER                       PIC X(07)  VALUE SPACES.    02660000
026700     05  D2-CERT-REQ                  PIC X(01)  VALUE SPACES.    02670000
026800     05  FILLER                       PIC X(08)  VALUE SPACES.    02680000
026900                                                                  02690000
027000 01  D3-PEND-PRICE-LINE.                                          02700000
027100     05  FILLER                       PIC X(13)  VALUE SPACES.    02710000
027200     05  FILLER                       PIC X(15)  VALUE            02720000
027300                             'PEND PC DOC #: '.                   02730000
027400     05  D3-PPC-DOC-NBR               PIC 9(07)  BLANK ZEROES.    02740000
027500     05  FILLER                       PIC X(04)  VALUE SPACES.    02750000
027600     05  FILLER                       PIC X(06)  VALUE 'DATE: '.  02760000
027700     05  D3-PPC-DATE.                                             02770000
027800         10  D3-PPC-CHG-MONTH         PIC 99.                     02780000
027900         10  D3-SLASH-ONE             PIC X.                      02790000
028000         10  D3-PPC-CHG-DAY           PIC 99.                     02800000
028100         10  D3-SLASH-TWO             PIC X.                      02810000
028200         10  D3-PPC-CHG-YEAR          PIC 99.                     02820000
028300     05  FILLER                       PIC X(04)  VALUE SPACES.    02830000
028400     05  FILLER                       PIC X(06)  VALUE 'FROM: '.  02840000
028500     05  D3-PPC-OLD-RTL-AMT           PIC Z,ZZZ,ZZ9.99-.          02850000
028600     05  FILLER                       PIC X(03)  VALUE SPACES.    02860000
028700     05  FILLER                       PIC X(04)  VALUE 'TO: '.    02870000
028800     05  D3-PPC-NEW-RTL-AMT           PIC Z,ZZZ,ZZ9.99-.          02880000
028900                                                                  02890000
029000 01  D1-TOTAL-LINE1.                                              02900000
029100     05  FILLER                       PIC X(37)  VALUE SPACES.    02910000
029200     05  FILLER                       PIC X(04)  VALUE '----'.    02920000
029300     05  FILLER                       PIC X(01)  VALUE SPACES.    02930000
029400     05  FILLER                       PIC X(04)  VALUE '----'.    02940000
029500     05  FILLER                       PIC X(01)  VALUE SPACES.    02950000
029600     05  FILLER                       PIC X(10)  VALUE            02960000
029700         '----------'.                                            02970000
029800     05  FILLER                       PIC X(65)  VALUE SPACES.    02980000
029900                                                                  02990000
030000 01  D2-TOTAL-LINE2.                                              03000000
030100     05  FILLER                       PIC X(25)  VALUE SPACES.    03010000
030200     05  FILLER                       PIC X(06)  VALUE 'TOTAL:'.  03020000
030300     05  FILLER                       PIC X(06)  VALUE SPACES.    03030000
030400     05  D2-TOT-ORD-QTY               PIC ZZZ9   VALUE ZEROES.    03040000
030500     05  FILLER                       PIC X(01)  VALUE SPACES.    03050000
030600     05  D2-TOT-INV-QTY               PIC ZZZ9   VALUE ZEROES.    03060000
030700     05  FILLER                       PIC X(01)  VALUE SPACES.    03070000
030800     05  D2-TOT-EXT-RETAIL           PIC ZZZ,ZZ9.99 VALUE ZEROES. 03080000
030900     05  FILLER                       PIC X(65)  VALUE SPACES.    03090000
031000                                                                  03100000
031100 01  L1-LAST-LINE.                                                03110000
031200     05  FILLER                       PIC X(60)  VALUE SPACES.    03120000
031300     05  FILLER                       PIC X(19)  VALUE            03130000
031400         '** END OF REPORT **'.                                   03140000
031500     05  FILLER                       PIC X(43)  VALUE SPACES.    03150000
031600                                                                  03160000
031700 01  E1-ERROR-LINE.                                               03170000
031800     05  FILLER                       PIC X(26)  VALUE SPACES.    03180000
031900     05  FILLER                       PIC X(37)  VALUE            03190000
032000         '** NO RECEIVER DISTRIBUTION RECORD **'.                 03200000
032100     05  FILLER                       PIC X(59)  VALUE SPACES.    03210000
032200                                                                  03220000
032300 01  DK-DB2-KEYS.                                                 03230000
032400     05  DK-DEPT-NBR                  PIC X(03)  VALUE SPACES.    03240000
032500     05  DK-PO-LNE-NBR-B              PIC S9(09) COMP VALUE +0.   03250000
032600     05  DK-PO-LNE-NBR-E              PIC S9(09) COMP VALUE +0.   03260000
032700     05  DK-ORD-NBR                   PIC S9(09) COMP VALUE +0.   03270000
032800     05  DK-REC-SEQ-NBR               PIC S9(09) COMP VALUE +0.   03280000
032900     05  DK-STR-NBR-B                 PIC S9(04) COMP VALUE +0.   03290000
033000     05  DK-STR-NBR-E                 PIC S9(04) COMP VALUE +0.   03300000
033100     05  DK-STR-FCLTY-ID-B            PIC S9(04) COMP VALUE +0.   03310000
033200     05  DK-STR-FCLTY-ID-E            PIC S9(04) COMP VALUE +0.   03320000
033300     05  DN-VEH-NBR                   PIC S9(04) VALUE ZEROS      03330000
033400                                                     COMP.        03340000
033500                                                                  03350000
033600 01  PS-PROGRAM-SWITCHES.                                         03360000
033700     05  PS-EOF-PKSLIP-CSR-SW         PIC X(01)  VALUE 'N'.       03370000
033800         88  PS-EOF-PKSLIP-CSR                   VALUE 'Y'.       03380000
033900     05  PS-FIRST-PASS-SW             PIC X(01)  VALUE 'Y'.       03390000
034000         88  PS-FIRST-PASS                       VALUE 'Y'.       03400000
034100         88  PS-NOT-FIRST-PASS                   VALUE 'N'.       03410000
034200     05  PS-START-UPC-CSR-SW          PIC X(01)  VALUE 'N'.       03420000
034300         88  PS-START-UPC-CSR                    VALUE 'N'.       03430000
034400         88  PS-END-UPC-CSR                      VALUE 'Y'.       03440000
034500     05  PS-PRICE-CHANGE-SW           PIC X(01)  VALUE 'N'.       03450000
034600         88  PS-NO-PRICE-CHANGE                  VALUE 'N'.       03460000
034700         88  PS-YES-PRICE-CHANGE                 VALUE 'Y'.       03470000
034800     05  PS-TVNDAGR-FOUND-SW          PIC X(01)  VALUE SPACE.     03480000
034900         88  PS-TVNDAGR-FOUND                    VALUE 'Y'.       03490000
035000         88  PS-NO-TVNDAGR                       VALUE 'N'.       03500000
035100                                                                  03510000
035200*                                                                 03520000
035300 01  PM-PROGRAM-MESSAGES.                                         03530000
035400     05  PM-PROGRAM-MESSAGE-1.                                    03540000
035500         10  FILLER                   PIC X(54)  VALUE            03550000
035600         'ERROR DURING CICS RETRIEVE INTO- RCKCS237 CICS RESP = '.03560000
035700         10  PM-CICS-RESP-1           PIC 9(04)  VALUE ZEROS.     03570000
035800         10  FILLER                   PIC X(18)  VALUE SPACES.    03580000
035900                                                                  03590000
036000 01  PV-PROGRAM-VARIABLES.                                        03600000
036100     05  PV-PPCBEF-QTY                PIC  S9(9)  COMP.           03610000
036200     05  PV-PPCAFT-QTY                PIC  S9(9)  COMP.           03620000
036300     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE +0        03630000
036400                                                  COMP SYNC.      03640000
036500     05  PV-PRINTER                   PIC S9(04)  VALUE +0        03650000
036600                                                  COMP.           03660000
036700     05  PV-SUB1                      PIC S9(04)  VALUE +0        03670000
036800                                                  COMP.           03680000
036900     05  PV-DATE.                                                 03690000
037000         10  PV-CC                    PIC 99.                     03700000
037100         10  PV-YY                    PIC 99.                     03710000
037200         10  FILLER                   PIC X.                      03720000
037300         10  PV-MM                    PIC 99.                     03730000
037400         10  FILLER                   PIC X.                      03740000
037500         10  PV-DD                    PIC 99.                     03750000
037600     05  PV-DB2-CURRENT-DATE          PIC  X(10)  VALUE SPACES.   03760000
037700     05  PV-PRINT-LINE.                                           03770000
037800         10  PV-PL-HEADER.                                        03780000
037900             15  PV-PL-HDR-PRIM       PIC  X(05)  VALUE SPACES.   03790000
038000             15  PV-PL-HDR-SECN       PIC  X(04)  VALUE SPACES.   03800000
038100         10  PV-PL-DATA               PIC X(122)  VALUE SPACES.   03810000
038200                                                                  03820000
038300     05  PV-UPC-SPLIT                 PIC  9(15).                 03830000
038400     05  FILLER REDEFINES PV-UPC-SPLIT.                           03840000
038500         10  PV-UPC-X4                PIC  X(04).                 03850000
038600         10  FILLER                   PIC  X(11).                 03860000
038700                                                                  03870000
038800     05  PV-UPC-TABLE.                                            03880000
038900         10  PV-UPC-TBL OCCURS 100 TIMES INDEXED BY PV-IDX.       03890000
039000             15  PV-UPC               PIC   9(15).                03900000
039100             15  PV-UPC-CERT-IND      PIC   X(01).                03910000
039200                                                                  03920000
039300     05  PV-DRS-ABEND-DISPLAY-LINE1.                              03930000
039400         10  FILLER                      PIC  X(14)  VALUE        03940000
039500             'DRRB ID = DRRB'.                                    03950000
039600         10  FILLER                      PIC  X(02)  VALUE SPACE. 03960000
039700         10  FILLER                      PIC  X(12)  VALUE        03970000
039800             'DRRB FUNC = '.                                      03980000
039900         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 03990000
040000         10  FILLER                      PIC  X(02)  VALUE SPACE. 04000000
040100         10  FILLER                      PIC  X(11)  VALUE        04010000
040200             'DRRB RID = '.                                       04020000
040300         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 04030000
040400         10  FILLER                      PIC  X(02)  VALUE SPACE. 04040000
040500         10  FILLER                      PIC  X(15)  VALUE        04050000
040600             'DRRB OPTIONS = '.                                   04060000
040700         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 04070000
040800                                                                  04080000
040900     05  PV-DRS-ABEND-DISPLAY-LINE2.                              04090000
041000         10  FILLER                      PIC  X(10)  VALUE        04100000
041100             'DRRB RC = '.                                        04110000
041200         10  PV-DRS-DRRB-RC              PIC  9(04)  VALUE ZERO.  04120000
041300         10  FILLER                      PIC  X(02)  VALUE SPACE. 04130000
041400         10  FILLER                      PIC  X(18)  VALUE        04140000
041500             'DRRB ATTR-ERROR = '.                                04150000
041600         10  PV-DRS-ATTR-ERROR           PIC  9(02)  VALUE ZERO.  04160000
041700         10  FILLER                      PIC  X(02)  VALUE SPACE. 04170000
041800         10  FILLER                      PIC  X(12)  VALUE        04180000
041900             'DRRB DRDC = '.                                      04190000
042000         10  PV-DRS-DRRB-DRDC            PIC  9(04)  VALUE ZERO.  04200000
042100         10  FILLER                      PIC  X(02)  VALUE SPACE. 04210000
042200         10  FILLER                      PIC  X(13)  VALUE        04220000
042300             'DRRB LINES = '.                                     04230000
042400         10  PV-DRS-DRRB-LINES           PIC  9(04)  VALUE ZERO.  04240000
042500                                                                  04250000
042600     05  PV-STR-NBR                      PIC 9(04) VALUE ZEROES.  04260000
042700     05  PV-PREV-STR-NBR                 PIC 9(04) VALUE ZEROES.  04270000
042800     05  PV-PRINT-STR-NBR                PIC 9(04) VALUE ZEROES.  04280000
042900     05  PV-GP-QTY                       PIC  9(03)  VALUE ZEROS. 04290000
043000     05  PV-UNIT-RETAIL                  PIC S9(06)V99 COMP-3.    04300000
043100     05  PV-EXT-RETAIL                   PIC S9(08)V99 COMP-3.    04310000
043200     05  PV-FORMATTED-GROUP-PRICING.                              04320000
043300         10  PV-FORMATTED-GROUP-QUANTITY.                         04330000
043400             15  PV-GROUP-QUANTITY-X     PIC  X(01)  VALUE SPACE. 04340000
043500             15  PV-GROUP-QUANTITY  REDEFINES                     04350000
043600                     PV-GROUP-QUANTITY-X PIC  9(01).              04360000
043700             15  PV-GROUP-QUANTITY-SLASH PIC  X(01)  VALUE SPACE. 04370000
043800         10  PV-FORMATTED-GROUP-PRICE    PIC  X(08)  VALUE SPACE. 04380000
043900     05  PV-GROUP-PRICE-NUMERIC-EDIT     PIC ZZ,ZZZ.ZZ.           04390000
044000     05  PV-GROUP-PRICE-NUMERIC-EDIT-X  REDEFINES                 04400000
044100             PV-GROUP-PRICE-NUMERIC-EDIT PIC  X(09).              04410000
044200     05  PV-UNSTRING-SPACE-DELIMITER     PIC  X(01)  VALUE SPACE. 04420000
044300     05  PV-MAX-GROUP-PRICE-DIGITS       PIC  9(04)V9(02)         04430000
044400                                                     VALUE ZEROS. 04440000
044500                                                                  04450000
044600 01  PA-PROGRAM-ACCUMS.                                           04460000
044700     05  PA-PAGE-NBR                  PIC S9(05) VALUE +0.        04470000
044800     05  PA-LINE-CNT                  PIC S9(02) VALUE +99.       04480000
044900     05  PA-QTY-INV                   PIC S9(05) COMP-3 VALUE +0. 04490000
045000     05  PA-OPEN-TO-RECEIVE           PIC S9(05) COMP-3 VALUE +0. 04500000
045100     05  PA-TOT-ORD-QTY               PIC S9(05) COMP-3 VALUE +0. 04510000
045200     05  PA-TOT-INV-QTY               PIC S9(05) COMP-3 VALUE +0. 04520000
045300     05  PA-TOT-EXT-RETAIL            PIC S9(09)V99 VALUE +0      04530000
045400                                          COMP-3.                 04540000
045500                                                                  04550000
045600 01  IW-INTERMEDIATE-WORK-AREAS.                                  04560000
045700     05  IW-DATE.                                                 04570000
045800         10  IW-MONTH                 PIC 9(2)   VALUE ZERO.      04580000
045900         10  FILLER REDEFINES IW-MONTH.                           04590000
046000             15  IW-FIRST-DIGIT-OF-MONTH                          04600000
046100                                      PIC X.                      04610000
046200             15  IW-SECOND-DIGIT-OF-MONTH                         04620000
046300                                      PIC X.                      04630000
046400         10  FILLER                   PIC X      VALUE '/'.       04640000
046500         10  IW-DAY                   PIC X(2).                   04650000
046600         10  FILLER                   PIC X      VALUE '/'.       04660000
046700         10  IW-YEAR                  PIC X(2).                   04670000
046800     05  IW-TIME.                                                 04680000
046900         10  IW-ABSTIME               PIC S9(18) COMP SYNC.       04690000
047000         10  IW-TIME-EDIT.                                        04700000
047100             15  IW-TIME-HHMM         PIC X(5).                   04710000
047200             15  FILLER               PIC X(3).                   04720000
047300                                                                  04730000
047400 01  PC-PROGRAM-CONSTANTS.                                        04740000
047500     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'RCKCS237'.04750000
047600     05  PC-LOCATION-MODULE           PIC X(08)  VALUE 'XLKUT071'.04760000
047700     05  PC-DPKCS060                  PIC X(08)  VALUE 'DPKCS060'.04770000
047800     05  PC-OP-CO-NBR                 PIC X(02)  VALUE '03'.      04780000
047900     05  PC-0004                      PIC X(04)  VALUE '0004'.    04790000
048000     05  PC-01                        PIC X(02)  VALUE '01'.      04800000
048100     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         04810000
048200                                                 COMP SYNC.       04820000
048300     05  PC-COMM-AREA-LENGTH          PIC S9(04) VALUE +43        04830000
048400                                                 COMP.            04840000
048500     05  PC-LINE-MAX                  PIC S9(2)  VALUE +59.       04850000
048600     05  PC-OCC-LIMIT                 PIC S9(3)  VALUE +999       04860000
048700                                                 COMP-3.          04870000
048800     05  PC-MULTIPLE-UPC              PIC X(15)  VALUE            04880000
048900         'MULTIPLE UPC''S'.                                       04890000
049000     05  PC-NO-VENDOR-UPC             PIC X(15)  VALUE            04900000
049100         'NO VENDOR UPC  '.                                       04910000
049200     05  PC-FONT-CNTL-ON              PIC X(05)  VALUE '^PY^-'.   04920000
049300     05  PC-FONT-CNTL-OFF             PIC X(05)  VALUE '^PN^-'.   04930000
049400     05  PC-FONT-MED-4-BY-4           PIC X(09)  VALUE            04940000
049500                                                 '^M0404000'.     04950000
049600                                                                  04960000
049700*----------------------------------------------------------------*04970000
049800* INCLUDED NEW CONSTANTS PC-000 AND PC-999.          WR # 230ZZ  *04980000
049900*----------------------------------------------------------------*04990000
050000     05  PC-000                       PIC 9(03) VALUE 000.        05000000
050100     05  PC-999                       PIC 9(03) VALUE 999.        05010000
050200*----------------------------------------------------------------*05020000
050300* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *05030000
050400*----------------------------------------------------------------*05040000
050500/                                                                 05050000
050600*  PERMANENT PRICE CHANGE CONSTANTS                               05060000
050700     COPY PEWS049.                                                05070000
050800/                                                                 05080000
050900 01  CA-COMM-AREA.                                                05090000
051000     05  CA-PO-NBR                    PIC 9(08).                  05100000
051100     05  CA-REC-SEQ-NBR               PIC 9(03).                  05110000
051200     05  CA-PO-APP-LNE-NBR            PIC 9(04).                  05120000
051300     05  FILLER                       PIC X(03).                  05130000
051400     05  CA-PRINTER                   PIC X(08).                  05140000
051500     05  FILLER                       PIC X(17).                  05150000
051600     05  CA-PRTR-AUTO-CUTTER-IND      PIC X(01).                  05160000
051700     05  CA-PRTR-PRTR-BRCDE-IND       PIC X(01).                  05170000
051800     05  CA-PRTR-PRTR-CNTL-IND        PIC X(01).                  05180000
051900     05  CA-PRINT-PACKAGE-IND         PIC X(01).                  05190000
052000         88 CA-FROM-PRINT-PACKAGE     VALUE 'Y'.                  05200000
052100         88 CA-NOT-FROM-PRINT-PACKAGE VALUE 'N'.                  05210000
052200     05  CA-LINES-PER-INCH            PIC X(03).                  05220000
052300     05  FILLER                       PIC X(20).                  05230000
052400     05  CA-STR-NBR                   PIC 9(04).                  05240000
052500     05  CA-DRIB-AREA                 PIC X(264).                 05250000
052600                                                                  05260000
052700/                                                                 05270000
052800*---------------------------------------------------------------* 05280000
052900*    DB2 AREA FOR RECEIVER TABLE                                * 05290000
053000*---------------------------------------------------------------* 05300000
053100     EXEC SQL                                                     05310000
053200          INCLUDE TRECEIV                                         05320000
053300     END-EXEC.                                                    05330000
053400                                                                  05340000
053500/                                                                 05350000
053600*---------------------------------------------------------------* 05360000
053700*    DB2 AREA FOR RECEIVER DISTRIBUTION TABLE                   * 05370000
053800*---------------------------------------------------------------* 05380000
053900     EXEC SQL                                                     05390000
054000          INCLUDE TRECDIS                                         05400000
054100     END-EXEC.                                                    05410000
054200                                                                  05420000
054300/                                                                 05430000
054400*---------------------------------------------------------------* 05440000
054500*    DB2 AREA FOR PURCHASE ORDER TABLE                          * 05450000
054600*---------------------------------------------------------------* 05460000
054700     EXEC SQL                                                     05470000
054800          INCLUDE TPURCHS                                         05480000
054900     END-EXEC.                                                    05490000
055000                                                                  05500000
055100/                                                                 05510000
055200*---------------------------------------------------------------* 05520000
055300*    DB2 AREA FOR PURCHASE ORDER LINE ITEM                      * 05530000
055400*---------------------------------------------------------------* 05540000
055500     EXEC SQL                                                     05550000
055600          INCLUDE TPURITM                                         05560000
055700     END-EXEC.                                                    05570000
055800                                                                  05580000
055900/                                                                 05590000
056000*---------------------------------------------------------------* 05600000
056100*  DCLGEN FOR THE DB2 DEPARTMENT TABLE                            05610000
056200*---------------------------------------------------------------* 05620000
056300     EXEC SQL                                                     05630000
056400         INCLUDE TVNDDPT                                          05640000
056500     END-EXEC.                                                    05650000
056600                                                                  05660000
056700*---------------------------------------------------------------* 05670000
056800*  DCLGEN FOR THE DB2 ENTERPRISE NAME TABLE                       05680000
056900*---------------------------------------------------------------* 05690000
057000     EXEC SQL                                                     05700000
057100         INCLUDE TENTNME                                          05710000
057200     END-EXEC.                                                    05720000
057300                                                                  05730000
057400*---------------------------------------------------------------* 05740000
057500*  DCLGEN FOR THE DB2 VENDOR AGREEMENT TABLE                      05750000
057600*---------------------------------------------------------------* 05760000
057700     EXEC SQL                                                     05770000
057800         INCLUDE TVNDAGR                                          05780000
057900     END-EXEC.                                                    05790000
058000                                                                  05800000
058100*----------------------------------------------------------------*05810000
058200*    DB2 AREA FOR OPERATION SET TABLE                            *05820000
058300*----------------------------------------------------------------*05830000
058400                                                                  05840000
058500     EXEC SQL                                                     05850000
058600          INCLUDE TOPRSET                                         05860000
058700     END-EXEC.                                                    05870000
058800/                                                                 05880000
058900*----------------------------------------------------------------*05890000
059000*    DB2 AREA FOR WORK ORDER TABLE                               *05900000
059100*----------------------------------------------------------------*05910000
059200                                                                  05920000
059300     EXEC SQL                                                     05930000
059400          INCLUDE TWRKORD                                         05940000
059500     END-EXEC.                                                    05950000
059600                                                                  05960000
059700/                                                                 05970000
059800*----------------------------------------------------------------*05980000
059900*    DB2 AREA FOR LOGISTIC DOMAIN UPC VIEW                       *05990000
060000*----------------------------------------------------------------*06000000
060100                                                                  06010000
060200     EXEC SQL                                                     06020000
060300          INCLUDE XLV00003                                        06030000
060400     END-EXEC.                                                    06040000
060500                                                                  06050000
060600/                                                                 06060000
060700     EXEC SQL                                                     06070000
060800          INCLUDE TSHPTPO                                         06080000
060900     END-EXEC.                                                    06090000
061000/                                                                 06100000
061100     EXEC SQL                                                     06110000
061200          INCLUDE TSHIPMT                                         06120000
061300     END-EXEC.                                                    06130000
061400/                                                                 06140000
061500     EXEC SQL                                                     06150000
061600          INCLUDE TVHTRIP                                         06160000
061700     END-EXEC.                                                    06170000
061800/                                                                 06180000
061900*----------------------------------------------------------------*06190000
062000*    DB2 DCLGEN FOR TKRPRPM TABLE                                 06200000
062100*----------------------------------------------------------------*06210000
062200     EXEC SQL                                                     06220000
062300          INCLUDE TKRPRPM                                         06230000
062400     END-EXEC.                                                    06240000
062500/                                                                 06250000
062600*  PERMANENT PRICE CHANGE HEADER TABLE                            06260000
062700*                                                                 06270000
062800*    EXEC SQL                                                     06280000
062900*        INCLUDE TCENPPC                                          06290000
063000*    END-EXEC.                                                    06300000
063100*EJECT                                                            06310000
063200*                                                                 06320000
063300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PERMANENT          06330000
063400*  PRICE CHANGE DETAIL TABLE                                      06340000
063500*                                                                 06350000
063600*    EXEC SQL                                                     06360000
063700*        INCLUDE TCPPCDT                                          06370000
063800*    END-EXEC.                                                    06380000
063900*EJECT                                                            06390000
064000*---------------------------------------------------------------* 06400000
064100*  COMMUNICATION AREAS FOR DB2                                  * 06410000
064200*---------------------------------------------------------------* 06420000
064300     EXEC SQL                                                     06430000
064400         INCLUDE SQLCA                                            06440000
064500     END-EXEC.                                                    06450000
064600/                                                                 06460000
064700*---------------------------------------------------------------* 06470000
064800*  CURSOR TO SELECT PACKING SLIP INFO                           * 06480000
064900*---------------------------------------------------------------* 06490000
065000                                                                  06500000
065100     EXEC SQL                                                     06510000
065200          DECLARE PKSLIP-CSR CURSOR FOR                           06520000
065300          SELECT DISTINCT                                         06530000
065400                 A.PO_NBR                                         06540000
065500                ,A.DEPT_NBR                                       06550000
065600                ,A.ENT_ID                                         06560000
065700                ,B.SKU_SEQ_NBR                                    06570000
065800                ,B.CL_NBR                                         06580000
065900                ,B.VEND_STYL_NAME                                 06590000
066000                ,B.UNT_QTY                                        06600000
066100                ,B.UM_IND                                         06610000
066200                ,B.UNT_RTL_PR_AMT                                 06620000
066300                ,B.TOT_VAL_RTL_AMT                                06630000
066400                ,B.GP_RTL_AMT                                     06640000
066500                ,B.GP_QTY                                         06650000
066600                ,B.APP_PO_LNE_NBR                                 06660000
066700                ,B.ITM_NBR                                        06670000
066800                ,C.STR_NBR                                        06680000
066900                ,C.STR_FCLTY_ID                                   06690000
067000                ,C.EXPTED_ITM_QTY                                 06700000
067100                ,C.VERIFY_ITM_QTY                                 06710000
067200          FROM   TPURCHS A                                        06720000
067300                ,TPURITM B                                        06730000
067400                ,TRECDIS C                                        06740000
067500          WHERE  C.ORD_NBR         = :DK-ORD-NBR                  06750000
067600            AND  C.REC_SEQ_NBR     = :DK-REC-SEQ-NBR              06760000
067700            AND  A.VER_STATUS_CDE  = 'A'                          06770000
067800            AND  B.APP_PO_LNE_NBR  BETWEEN :DK-PO-LNE-NBR-B       06780000
067900                                       AND :DK-PO-LNE-NBR-E       06790000
068000            AND  C.STR_NBR         BETWEEN :DK-STR-NBR-B          06800000
068100                                       AND :DK-STR-NBR-E          06810000
068200            AND  C.STR_FCLTY_ID    = 1                            06820000
068300            AND  A.PO_NBR          = B.PO_NBR                     06830000
068400            AND  A.VER_STATUS_CDE  = B.VER_STATUS_CDE             06840000
068600            AND  B.PO_NBR          = C.ORD_NBR                    06860000
068700            AND  B.APP_PO_LNE_NBR  = C.ORD_LNE_NBR                06870000
068800          ORDER BY C.STR_NBR                                      06880000
068900                  ,C.STR_FCLTY_ID                                 06890000
069000                  ,B.APP_PO_LNE_NBR                               06900000
069100                  ,A.DEPT_NBR                                     06910000
069200                  ,B.SKU_SEQ_NBR                                  06920000
069300                  ,B.CL_NBR                                       06930000
069400     END-EXEC.                                                    06940000
069500                                                                  06950000
069600/                                                                 06960000
069700     EXEC SQL                                                     06970000
069800         DECLARE UPC-CSR CURSOR FOR                               06980000
069900         SELECT                                                   06990000
070000              UPC_NBR,                                            07000000
070100              CERTD_IND                                           07010000
070200          FROM XLV_UPC                                            07020000
070300         WHERE INTR_UPC_ID        = :XL001-INTR-UPC-ID            07030000
070400     END-EXEC.                                                    07040000
070500*                                                                 07050000
070600*  SQL PERMANENT PRICE CHANGE CURSOR DECLARATION                  07060000
070700*  NOTE !!!  WITHIN THE WHERE CLAUSE, THERE IS REFERENCE          07070000
070800*  MADE TO THE CURRENT DATE PLUS SIX DAYS.  THE SIX DAYS          07080000
070900*  REPRESENTS THE PRICE CHANGE WINDOW.  IF THE PRICE CHANGE       07090000
071000*  WINDOW CHANGES, THIS IS THE ONLY PLACE WHERE A CHANGE IS       07100000
071100*  REQUIRED.                                                      07110000
071200*                                                                 07120000
071300                                                                  07130000
071400*LMM EXEC SQL                                                     07140000
071500*         DECLARE PPC-CSR CURSOR FOR                              07150000
071600*          SELECT A.CENPPC_NBR,                                   07160000
071700*                 A.OLD_RTL_AMT,                                  07170000
071800*                 A.NEW_RTL_AMT,                                  07180000
071900*                 B.EFF_DTE                                       07190000
072000*            FROM TCPPCDT A,                                      07200000
072100*                 TCENPPC B                                       07210000
072200*           WHERE (                                               07220000
072300*                  A.OPERCO_NBR    = B.OPERCO_NBR                 07230000
072400*             AND  A.CENPPC_NBR    = B.CENPPC_NBR                 07240000
072500*             AND A.TSK_ITEM_NMBR = :PURITM-ITM-NBR               07250000
072600*             AND B.DOC_TYP_CDE = :PE049-CORPORATE-DOC-TYPE-CDE   07260000
072700*             AND (B.STATUS_CDE = :PE049-APPROVED-STATUS-CDE      07270000
072800*                  OR                                             07280000
072900*                  B.STATUS_CDE = :PE049-IN-PROCESS-STATUS-CDE)   07290000
073000*             AND  CHAR(DATE(B.EFF_DTE),ISO)                      07300000
073100*                  BETWEEN CHAR(CURRENT DATE, ISO)                07310000
073200*                      AND CHAR(CURRENT DATE + 6 DAYS, ISO)       07320000
073300*                 )                                               07330000
073400*        ORDER BY  B.EFF_DTE DESC                                 07340000
073500*    END-EXEC.                                                    07350000
073600*                                                                 07360000
073700/                                                                 07370000
073800******************************************************************07380000
073900 LINKAGE SECTION.                                                 07390000
074000******************************************************************07400000
074100                                                                  07410000
074200 01  DFHCOMMAREA                      PIC X(400).                 07420000
074300                                                                  07430000
074400/                                                                 07440000
074500******************************************************************07450000
074600 PROCEDURE DIVISION.                                              07460000
074700******************************************************************07470000
074800                                                                  07480000
074900 0000-MAINLINE.                                                   07490000
075000                                                                  07500000
150600     DISPLAY ' RCKCS237 MAINLINE'                                 07510000
075100     PERFORM 1000-INITIALIZATION.                                 07520000
075200                                                                  07530000
075300     PERFORM 2000-PRINT-PACKING-SLIP                              07540000
075400        UNTIL PS-EOF-PKSLIP-CSR.                                  07550000
075500                                                                  07560000
075600     PERFORM 7020-CLOSE-PKSLIP-CURSOR.                            07570000
075700     IF PA-LINE-CNT = +99                                         07580000
075800         PERFORM 1200-FORMAT-HEADER-LINES                         07590000
075900         MOVE '-'                    TO DRS01-COMM-CTL            07600000
076000         MOVE E1-ERROR-LINE          TO DRS01-COMM-DATA           07610000
076100         PERFORM 9000-LINK-TO-DRS                                 07620000
076200     ELSE                                                         07630000
076300         PERFORM 5000-PRINT-TOTAL-LINE                            07640000
076400     END-IF.                                                      07650000
076500     PERFORM 6000-PRINT-LAST-LINE.                                07660000
076600                                                                  07670000
076700*    IF THE PRINTER HAS AN AUTO CUTTER, SENT CUT COMMAND          07680000
076800     IF CA-NOT-FROM-PRINT-PACKAGE                                 07690000
076900         IF CA-PRTR-AUTO-CUTTER-IND = 'Y'                         07700000
077000             MOVE 'PUT'                  TO DRS01-DRRB-FUNC       07710000
077100             MOVE DS004-PLC-CUT-FORM     TO DRS01-COMM-DATA       07720000
077200             PERFORM 9000-LINK-TO-DRS                             07730000
077300         END-IF                                                   07740000
077400                                                                  07750000
077500         MOVE 'TERM'                     TO DRS01-DRRB-FUNC       07760000
077600         PERFORM 9000-LINK-TO-DRS                                 07770000
077700     END-IF.                                                      07780000
077800                                                                  07790000
077900     GOBACK.                                                      07800000
078000                                                                  07810000
078100/                                                                 07820000
078200 1000-INITIALIZATION.                                             07830000
078300                                                                  07840000
078400     EXEC CICS                                                    07850000
078500          RETRIEVE                                                07860000
078600          INTO   (CA-COMM-AREA)                                   07870000
078700          RESP   (PV-CICS-RESPONSE)                               07880000
078800     END-EXEC.                                                    07890000
078900                                                                  07900000
079000     EVALUATE TRUE                                                07910000
079100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07920000
079200             CONTINUE                                             07930000
079300         WHEN PV-CICS-RESPONSE = DFHRESP (ENDDATA)                07940000
079400             PERFORM 1050-MOVE-COMMAREA                           07950000
079500         WHEN OTHER                                               07960000
079600             SET DP013-LOGIC-ABEND   TO TRUE                      07970000
079700             SET DP013-NO-ROLLBACK   TO TRUE                      07980000
079800             MOVE '1000-INITIALIZATION'                           07990000
079900                                     TO DP013-PARAGRAPH           08000000
080000             MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-1            08010000
080100             MOVE PM-PROGRAM-MESSAGE-1                            08020000
080200                                     TO DP013-MESSAGE-TEXT(1)     08030000
080300             PERFORM 9999-ABEND                                   08040000
080400     END-EVALUATE.                                                08050000
080500                                                                  08060000
080600     IF CA-NOT-FROM-PRINT-PACKAGE                                 08070000
080700         MOVE 'INIT'             TO DRS01-DRRB-FUNC               08080000
080800         MOVE 'A'                TO DRS02-DRIB-CLASS              08090000
080900         MOVE 122                TO DRS02-DRIB-LRECL-1            08100000
081000                                    DRS02-DRIB-BLKSIZE-1          08110000
081100                                                                  08120000
081200         IF  CA-PRINTER = 'XXXXXXXX'                              08130000
081300             MOVE 'LOCAL'        TO DRS02-DRIB-DEST               08140000
081400         ELSE                                                     08150000
081500             MOVE CA-PRINTER     TO DRS02-DRIB-DEST               08160000
081600         END-IF                                                   08170000
081700                                                                  08180000
081800         MOVE DRS02-DRIB-HEADER  TO DRS01-COMM-DRIB-HDR           08190000
081900         MOVE DRS02-DRIB-ATTRIB  TO DRS01-COMM-DRIB-AT1           08200000
082000                                                                  08210000
082100         PERFORM 9000-LINK-TO-DRS                                 08220000
082200     END-IF.                                                      08230000
082300                                                                  08240000
082400     IF CA-PRTR-PRTR-CNTL-IND = 'P'                               08250000
082500         PERFORM 1100-LOAD-FORM-TO-DRS                            08260000
082600     END-IF.                                                      08270000
082700                                                                  08280000
082800     EXEC CICS                                                    08290000
082900         ASKTIME                                                  08300000
083000         ABSTIME(IW-ABSTIME)                                      08310000
083100     END-EXEC.                                                    08320000
083200                                                                  08330000
083300     EXEC CICS                                                    08340000
083400         FORMATTIME                                               08350000
083500         ABSTIME (IW-ABSTIME)                                     08360000
083600         MMDDYY  (DP122O-RUN-DATE)                                08370000
083700         DATESEP                                                  08380000
083800         TIME    (IW-TIME-EDIT)                                   08390000
083900         TIMESEP                                                  08400000
084000     END-EXEC.                                                    08410000
084100                                                                  08420000
084200     MOVE IW-TIME-HHMM           TO DP122O-RUN-TIME.              08430000
084300                                                                  08440000
084400     MOVE 'PUT'                  TO DRS01-DRRB-FUNC.              08450000
084500                                                                  08460000
084600     MOVE CA-PO-NBR              TO DK-ORD-NBR.                   08470000
084700     MOVE CA-REC-SEQ-NBR         TO DK-REC-SEQ-NBR.               08480000
084800                                                                  08490000
084900     IF  CA-STR-NBR > ZEROES                                      08500000
085000         MOVE CA-STR-NBR         TO DK-STR-NBR-B                  08510000
085100                                    DK-STR-NBR-E                  08520000
085200     ELSE                                                         08530000
085300         MOVE ZEROES             TO DK-STR-NBR-B                  08540000
085400         MOVE 9999               TO DK-STR-NBR-E                  08550000
085500     END-IF.                                                      08560000
085600                                                                  08570000
085700                                                                  08580000
085800                                                                  08590000
085900                                                                  08600000
086000                                                                  08610000
086100                                                                  08620000
086200                                                                  08630000
086300     IF  CA-PO-APP-LNE-NBR > ZEROES                               08640000
086400         MOVE CA-PO-APP-LNE-NBR  TO DK-PO-LNE-NBR-B               08650000
086500                                    DK-PO-LNE-NBR-E               08660000
086600     ELSE                                                         08670000
086700         MOVE ZEROES             TO DK-PO-LNE-NBR-B               08680000
086800         MOVE 9999               TO DK-PO-LNE-NBR-E               08690000
086900     END-IF.                                                      08700000
087000                                                                  08710000
087100     MOVE 'N'                    TO PS-EOF-PKSLIP-CSR-SW.         08720000
087200                                                                  08730000
087300     PERFORM 7000-OPEN-PKSLIP-CURSOR.                             08740000
087400     PERFORM 7010-FETCH-PKSLIP-CSR.                               08750000
087500                                                                  08760000
087600* * *  GET DEPT-NBR AND ENT-ID                                    08770000
087700     IF SQLCODE = +0                                              08780000
087800     IF NOT PS-EOF-PKSLIP-CSR                                     08790000
087900*        PERFORM 1020-GET-DEPT-NBR                                08800000
088000         PERFORM 1020-GET-TPURCHS-DATA                            08810000
088100     END-IF.                                                      08820000
088200                                                                  08830000
088300                                                                  08840000
088400 1050-MOVE-COMMAREA.                                              08850000
088500     INITIALIZE CA-COMM-AREA.                                     08860000
088600     MOVE DFHCOMMAREA           TO CA-COMM-AREA.                  08870000
088700*  THIS RESTORES THE DRIB WORK AREAS THAT WERE INITIALIZED        08880000
088800*  IN DSKCS606                                                    08890000
088900     MOVE CA-DRIB-AREA          TO DRS01-COMMAREA.                08900000
089000     MOVE DRS01-COMM-DRIB-HDR   TO DRS02-DRIB-HEADER.             08910000
089100     MOVE DRS01-COMM-DRIB-AT1   TO DRS02-DRIB-ATTRIB.             08920000
089200                                                                  08930000
089300***************************************************************   08940000
089400**  1100-LOAD-FORM-TO-DRS. -- CALL THE PRINT-PACKAGE PRINTER **   08950000
089500**  CONTROL MODULE TO GET THE FORM FOR SEND TO THE PRINTER.  **   08960000
089600**  THIS PARAGRAPH IS EXECUTED ONLY IF THE PRINTER ACCEPTS   **   08970000
089700**  PRINTER CONTROL COMMANDS                                 **   08980000
089800***************************************************************   08990000
089900 1100-LOAD-FORM-TO-DRS.                                           09000000
090000     INITIALIZE DP072-COMM-AREA.                                  09010000
090100     MOVE CA-PRINTER                 TO DP072-PRINTER-ID.         09020000
090200     MOVE PC-PROGRAM-NAME            TO DP072-RPT-PGM-NME.        09030000
090300     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     09040000
090400                                                                  09050000
090500     SET DP072-SELECT TO TRUE.                                    09060000
090600     PERFORM 1101-LINK-DPKCS060.                                  09070000
090700     MOVE DP072-PRTR-TRACK-NBR       TO DS004-PLC-LF-FORM-NBR.    09080000
090800     MOVE DS004-PES-8LPI             TO DS004-PLC-LF-LPI          09090000
090900                                        DS004-PLC-DI-LPI.         09100000
091000                                                                  09110000
091100     IF CA-NOT-FROM-PRINT-PACKAGE                                 09120000
091200         MOVE DS004-PLC-LOAD-FORM    TO DRS01-COMM-DATA           09130000
091300         MOVE 'PUT'                  TO DRS01-DRRB-FUNC           09140000
091400         PERFORM 9000-LINK-TO-DRS                                 09150000
091500     END-IF.                                                      09160000
091600                                                                  09170000
091700***************************************************************   09180000
091800**  1101-LINK-DPKCS060 -- LINK TO THE PRINT-PACKACGE PRINTER **   09190000
091900**  CONTROL MODULE (DPKCS060)                                **   09200000
092000***************************************************************   09210000
092100 1101-LINK-DPKCS060.                                              09220000
092200     EXEC CICS                                                    09230000
092300         LINK PROGRAM  (PC-DPKCS060)                              09240000
092400              COMMAREA (DP072-COMM-AREA)                          09250000
092500              RESP     (PV-CICS-RESPONSE)                         09260000
092600     END-EXEC.                                                    09270000
092700                                                                  09280000
092800     EVALUATE TRUE                                                09290000
092900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09300000
093000             CONTINUE                                             09310000
093100         WHEN OTHER                                               09320000
093200               MOVE '6301-LINK-DPKCS060'                          09330000
093300                                    TO DP013-PARAGRAPH            09340000
093400               MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT (1)    09350000
093500               MOVE SQLCA           TO DP013-SQLCA                09360000
093600               SET DP013-LINK-RETURN                              09370000
093700                   DP013-CICS-ABEND                               09380000
093800                   DP013-NO-ROLLBACK TO TRUE                      09390000
093900               PERFORM 9999-ABEND                                 09400000
094000     END-EVALUATE.                                                09410000
094100                                                                  09420000
094200/                                                                 09430000
094300*1020-GET-DEPT-NBR.                                               09440000
094400 1020-GET-TPURCHS-DATA.                                           09450000
094500                                                                  09460000
094600     EXEC SQL                                                     09470000
094700         SELECT DEPT_NBR,                                         09480000
094800                ENT_ID                                            09490000
094900          INTO  :PURCHS-DEPT-NBR,                                 09500000
095000                :PURCHS-ENT-ID                                    09510000
095100          FROM  TPURCHS                                           09520000
095200          WHERE PO_NBR         = :DK-ORD-NBR                      09530000
095300           AND  VER_STATUS_CDE = 'A'                              09540000
095400     END-EXEC.                                                    09550000
095500                                                                  09560000
095600     EVALUATE TRUE                                                09570000
095700         WHEN SQLCODE = +0                                        09580000
095800         WHEN SQLCODE = -904                                      09590000
095900         WHEN SQLCODE = -913                                      09600000
096000             CONTINUE                                             09610000
096100                                                                  09620000
096200         WHEN SQLWARN0 NOT = SPACE                                09630000
096300         WHEN SQLCODE < +0                                        09640000
096400         WHEN SQLCODE > +0                                        09650000
096500*            MOVE '1020-GET-DEPT-NBR   '                          09660000
096600             MOVE '1020-GET-TPURCHS-DATA'                         09670000
096700                             TO DP013-PARAGRAPH                   09680000
096800             MOVE 'SELECT ON TPURCHS      '                       09690000
096900                             TO DP013-MESSAGE-TEXT (1)            09700000
097000             MOVE SQLCA      TO DP013-SQLCA                       09710000
097100             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME (1)          09720000
097200             SET DP013-DB2-ABEND                                  09730000
097300                             TO TRUE                              09740000
097400             PERFORM 9999-ABEND                                   09750000
097500     END-EVALUATE.                                                09760000
097600                                                                  09770000
097700/                                                                 09780000
097800*----------------------------------------------------------------*09790000
097900* THIS MODULE FORMATS GROUP PRICING WHEN BOTH OPTIONAL            09800000
098000* UNITS AND OPTIONAL RETAIL EXIST, I.E. 3/16.00.                  09810000
098100*----------------------------------------------------------------*09820000
098200                                                                  09830000
098300 1110-FORMAT-GROUP-PRICING.                                       09840000
098400                                                                  09850000
098500     IF  PV-GP-QTY > 1                                            09860000
098600         MOVE PV-GP-QTY          TO PV-GROUP-QUANTITY             09870000
098700         MOVE '/'                TO PV-GROUP-QUANTITY-SLASH       09880000
098800         MOVE PV-MAX-GROUP-PRICE-DIGITS                           09890000
098900                                 TO PV-GROUP-PRICE-NUMERIC-EDIT   09900000
099000         UNSTRING PV-GROUP-PRICE-NUMERIC-EDIT-X                   09910000
099100             DELIMITED BY ALL SPACES                              09920000
099200                               INTO PV-UNSTRING-SPACE-DELIMITER   09930000
099300                                    PV-FORMATTED-GROUP-PRICE      09940000
099400     ELSE                                                         09950000
099500         MOVE SPACES TO PV-GROUP-QUANTITY-X                       09960000
099600                        PV-GROUP-QUANTITY-SLASH                   09970000
099700                        PV-FORMATTED-GROUP-PRICE                  09980000
099800     END-IF.                                                      09990000
099900                                                                  10000000
100000/                                                                 10010000
100100*----------------------------------------------------------------*10020000
100200*    FORMAT AND PRINT HEADING LINES                              *10030000
100300*----------------------------------------------------------------*10040000
100400                                                                  10050000
100500 1200-FORMAT-HEADER-LINES.                                        10060000
100600                                                                  10070000
100700     ADD 1                       TO PA-PAGE-NBR.                  10080000
100800     MOVE PA-PAGE-NBR            TO DP122O-PAGE-NUMBER.           10090000
100900     MOVE PC-PROGRAM-NAME        TO DP122O-PROGRAM-NAME.          10100000
101000     MOVE '1'                    TO DP122O-REPORT-NUMBER.         10110000
101100     MOVE '1'                    TO DRS01-COMM-CTL.               10120000
101200     MOVE DP122O-STANDRD-HEADER-122-COLS                          10130000
101300                                 TO DRS01-COMM-DATA.              10140000
101400     PERFORM 9000-LINK-TO-DRS.                                    10150000
101500                                                                  10160000
101600     MOVE ' '                    TO DRS01-COMM-CTL.               10170000
101700     MOVE H1-HEADING-LINE1       TO DRS01-COMM-DATA.              10180000
101800     PERFORM 9000-LINK-TO-DRS.                                    10190000
101900                                                                  10200000
102000*    IF THE PRINTER IS CAPABLE OF PRINTING BARCODES, PRINT THE    10210000
102100*    STORE LINE                                                   10220000
102200     IF CA-PRTR-PRTR-BRCDE-IND = 'Y'                              10230000
102300*        TURN ON CHARACTER CONTROL (MAGNUM CONTROL)               10240000
102400         MOVE DS004-PLC-ACTIVATE-IMAGE1                           10250000
102500                                     TO PV-PL-HDR-PRIM            10260000
102600         MOVE LOW-VALUES             TO PV-PL-HDR-SECN            10270000
102700         MOVE LOW-VALUES             TO PV-PL-DATA                10280000
102800         MOVE SPACE                  TO DRS01-COMM-CTL            10290000
102900         MOVE PV-PRINT-LINE          TO DRS01-COMM-DATA           10300000
103000         PERFORM 9000-LINK-TO-DRS                                 10310000
103100                                                                  10320000
103200*        IF THE PRINTER IS THE "FORMSPRO" USE ITS CONTROL CHARACTE10330000
103300         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           10340000
103400*            FREE-FORM CONTROL                                    10350000
103500             MOVE DS004-PLC-ACTIVATE-FF-PROC                      10360000
103600                                 TO PV-PL-HDR-PRIM                10370000
103700             MOVE LOW-VALUES     TO PV-PL-HDR-SECN                10380000
103800             MOVE LOW-VALUES     TO PV-PL-DATA                    10390000
103900             MOVE SPACE          TO DRS01-COMM-CTL                10400000
104000             MOVE PV-PRINT-LINE  TO DRS01-COMM-DATA               10410000
104100             PERFORM 9000-LINK-TO-DRS                             10420000
104200         END-IF                                                   10430000
104300                                                                  10440000
104400*        SET MEDIUM FONT (4 BY 4)                                 10450000
104500         MOVE PC-FONT-MED-4-BY-4     TO PV-PL-HEADER              10460000
104600*        MOVE RECDIS-STR-NBR         TO PV-STR-NBR                10470000
104700         MOVE PV-PRINT-STR-NBR       TO H2-STORE-NBR              10480000
104800         MOVE H2-HEADING-LINE2       TO PV-PL-DATA                10490000
104900         MOVE ' '                    TO DRS01-COMM-CTL            10500000
105000         MOVE PV-PRINT-LINE          TO DRS01-COMM-DATA           10510000
105100         PERFORM 9000-LINK-TO-DRS                                 10520000
105200                                                                  10530000
105300*        IF THE PRINTER IS THE "FORMSPRO" USE ITS CONTROL CHARACTE10540000
105400         IF CA-PRTR-PRTR-CNTL-IND = 'P'                           10550000
105500*            TURN OFF FREE-FORM CONTROL                           10560000
105600             MOVE DS004-PLC-DEACTIVATE-FF-PROC                    10570000
105700                                         TO PV-PL-HDR-PRIM        10580000
105800             MOVE LOW-VALUES             TO PV-PL-HDR-SECN        10590000
105900             MOVE LOW-VALUES             TO PV-PL-DATA            10600000
106000             MOVE PV-PRINT-LINE          TO DRS01-COMM-DATA       10610000
106100             PERFORM 9000-LINK-TO-DRS                             10620000
106200                                                                  10630000
106300*            TURN OFF CHARACTER CONTROL (MAGNUM CONTROL)          10640000
106400             MOVE DS004-PLC-DEACTIVATE-IMAGE                      10650000
106500                                         TO DRS01-COMM-DATA       10660000
106600             MOVE ' '                    TO DRS01-COMM-CTL        10670000
106700             PERFORM 9000-LINK-TO-DRS                             10680000
106800         ELSE                                                     10690000
106900*            TURN OFF CHARACTER CONTROL (MAGNUM CONTROL)          10700000
107000             MOVE '^PN^-'                TO PV-PL-HDR-PRIM        10710000
107100             MOVE LOW-VALUES             TO PV-PL-HDR-SECN        10720000
107200             MOVE LOW-VALUES             TO PV-PL-DATA            10730000
107300             MOVE PV-PRINT-LINE          TO DRS01-COMM-DATA       10740000
107400             PERFORM 9000-LINK-TO-DRS                             10750000
107500         END-IF                                                   10760000
107600     ELSE                                                         10770000
107700         MOVE PV-PRINT-STR-NBR   TO H2-STORE-NBR-NB               10780000
107800         MOVE H2-HEADING-LINE2-NO-BARCODE                         10790000
107900                                     TO DRS01-COMM-DATA           10800000
108000         MOVE ' '                    TO DRS01-COMM-CTL            10810000
108100         PERFORM 9000-LINK-TO-DRS                                 10820000
108200     END-IF.                                                      10830000
108300                                                                  10840000
108400     MOVE PV-PRINT-STR-NBR       TO H2-STORE-NBR                  10850000
108500     MOVE H2-STORE-NBR           TO XL071-LOCATION-NUMBER.        10860000
108600                                                                  10870000
108700     IF NOT PS-EOF-PKSLIP-CSR                                     10880000
108800         PERFORM 8000-GET-STORE-NAME                              10890000
108900     ELSE                                                         10900000
109000         INITIALIZE XL071-LOC-NM                                  10910000
109100     END-IF.                                                      10920000
109200                                                                  10930000
109300     MOVE XL071-LOC-NM           TO H3-STORE-NAME.                10940000
109400     MOVE ' '                    TO DRS01-COMM-CTL.               10950000
109500     MOVE H3-HEADING-LINE3       TO DRS01-COMM-DATA.              10960000
109600     PERFORM 9000-LINK-TO-DRS.                                    10970000
109700                                                                  10980000
109800     MOVE CA-PO-NBR              TO H4-PO-NBR.                    10990000
109900     MOVE PURCHS-DEPT-NBR        TO DK-DEPT-NBR.                  11000000
110000     MOVE XL001-DEPT-NBR-3CH     TO H4A-DEPT-NBR.                 11010000
110100     IF NOT PS-EOF-PKSLIP-CSR                                     11020000
110200         PERFORM 8010-GET-VENDOR-NAME                             11030000
110300     END-IF.                                                      11040000
110400                                                                  11050000
110500     MOVE VNDDPT-INHOUSE-NBR     TO H4-INHOUSE-NBR.               11060000
110600     MOVE ENTNME-ENT-NAME-DESC   TO H4-VENDOR-NAME.               11070000
110700     MOVE CA-PO-NBR              TO DK-ORD-NBR.                   11080000
110800     MOVE CA-REC-SEQ-NBR         TO H4-REC-SEQ-NBR                11090000
110900                                    DK-REC-SEQ-NBR.               11100000
111000     IF NOT PS-EOF-PKSLIP-CSR                                     11110000
111100         PERFORM 8040-GET-OPER-SET-DESC                           11120000
111200     END-IF.                                                      11130000
111300                                                                  11140000
111400     MOVE OPRSET-OPER-SET-DESC   TO H4-OPER-SET-DESC.             11150000
111500     MOVE '-'                    TO DRS01-COMM-CTL.               11160000
111600     MOVE H4-HEADING-LINE4       TO DRS01-COMM-DATA.              11170000
111700     PERFORM 9000-LINK-TO-DRS.                                    11180000
111800                                                                  11190000
111900     PERFORM 1201-GET-SHIPMENT-INFO.                              11200000
112000                                                                  11210000
112100     MOVE ' '                    TO DRS01-COMM-CTL.               11220000
112200     MOVE H4A-HEADING-LINE4A     TO DRS01-COMM-DATA.              11230000
112300     PERFORM 9000-LINK-TO-DRS.                                    11240000
112400                                                                  11250000
112500     MOVE '-'                    TO DRS01-COMM-CTL.               11260000
112600     MOVE H5-HEADING-LINE5       TO DRS01-COMM-DATA.              11270000
112700     PERFORM 9000-LINK-TO-DRS.                                    11280000
112800                                                                  11290000
112900     MOVE ' '                    TO DRS01-COMM-CTL.               11300000
113000     MOVE H6-HEADING-LINE6       TO DRS01-COMM-DATA.              11310000
113100     PERFORM 9000-LINK-TO-DRS.                                    11320000
113200                                                                  11330000
113300     MOVE 17                     TO PA-LINE-CNT.                  11340000
113400                                                                  11350000
113500 1201-GET-SHIPMENT-INFO.                                          11360000
113600                                                                  11370000
113700     EXEC SQL                                                     11380000
113800     SELECT  DISTINCT                                             11390000
113900         C.OWNER_SCAC_ID                                          11400000
114000       , C.VEH_NBR                                                11410000
114100       , C.TRIP_ID                                                11420000
114200       INTO                                                       11430000
114300         :VHTRIP-OWNER-SCAC-ID                                    11440000
114400        ,:VHTRIP-VEH-NBR :DN-VEH-NBR                              11450000
114500        ,:VHTRIP-TRIP-ID                                          11460000
114600       FROM   TSHPTPO A                                           11470000
114700            , TSHIPMT B                                           11480000
114800            , TVHTRIP C                                           11490000
114900       WHERE A.PO_NBR      = :DK-ORD-NBR                          11500000
115000       AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                        11510000
115100       AND A.PRIM_SHIPT_IND = 'Y'                                 11520000
115200       AND A.SHIPT_ID        = B.SHIPT_ID                         11530000
115300       AND B.TRIP_ID         = C.TRIP_ID                          11540000
115400     END-EXEC.                                                    11550000
115500                                                                  11560000
115600     EVALUATE TRUE                                                11570000
115700         WHEN SQLCODE = ZERO                                      11580000
115800         WHEN SQLCODE = -811                                      11590000
115900             IF DN-VEH-NBR = -1                                   11600000
116000                 MOVE SPACES           TO H4A-TRAILER             11610000
116100             ELSE                                                 11620000
116200                 MOVE VHTRIP-VEH-NBR   TO H4A-TRAILER             11630000
116300             END-IF                                               11640000
116400             MOVE VHTRIP-OWNER-SCAC-ID TO H4A-DELIVERY-SCAC       11650000
116500             MOVE VHTRIP-TRIP-ID       TO H4A-TRIP-ID             11660000
116600                                                                  11670000
116700         WHEN SQLCODE = +100                                      11680000
116800             MOVE SPACES               TO H4A-TRAILER             11690000
116900                                          H4A-DELIVERY-SCAC       11700000
117000             MOVE ZEROES               TO H4A-TRIP-ID             11710000
117100         WHEN SQLCODE = -904                                      11720000
117200         WHEN SQLCODE = -913                                      11730000
117300             CONTINUE                                             11740000
117400                                                                  11750000
117500         WHEN SQLWARN0 NOT = SPACE                                11760000
117600         WHEN SQLCODE < +0                                        11770000
117700         WHEN SQLCODE > +0                                        11780000
117800             MOVE '1201-GET-SHIPMENT-INFO'                        11790000
117900                                  TO DP013-PARAGRAPH              11800000
118000             MOVE 'SELECT SHIPMENT INFO'                          11810000
118100                                  TO DP013-MESSAGE-TEXT (1)       11820000
118200             MOVE DK-ORD-NBR      TO DP013-MESSAGE-TEXT (2)       11830000
118300             MOVE DK-REC-SEQ-NBR                                  11840000
118400                                  TO DP013-MESSAGE-TEXT (3)       11850000
118500             MOVE SQLCA      TO DP013-SQLCA                       11860000
118600             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)          11870000
118700             MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)          11880000
118800             MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (3)          11890000
118900             SET DP013-DB2-ABEND  TO TRUE                         11900000
119000             PERFORM 9999-ABEND                                   11910000
119100     END-EVALUATE.                                                11920000
119200/                                                                 11930000
119300*----------------------------------------------------------------*11940000
119400* PRINT REPORT                                                   *11950000
119500*----------------------------------------------------------------*11960000
119600                                                                  11970000
119700 2000-PRINT-PACKING-SLIP.                                         11980000
119800                                                                  11990000
119900*----------------------------------------------------------------*12000000
120000* ADDED LOGIC FOR XLKUT001 MODULE                    WR # 230ZZ  *12010000
120100*----------------------------------------------------------------*12020000
120200         IF PURITM-ITM-NBR < 0                                    12030000
120300              MOVE '2000-PRINT-PACKING-SLIP'                      12040000
120400                                   TO DP013-PARAGRAPH             12050000
120500              MOVE 'CHECKING ITM-NBR FOR LESS THAN ZERO'          12060000
120600                                   TO DP013-MESSAGE-TEXT (1)      12070000
120700              SET DP013-DB2-ABEND  TO TRUE                        12080000
120800              PERFORM 9999-ABEND                                  12090000
120900         ELSE                                                     12100000
121000              IF PURITM-ITM-NBR = 0                               12110000
121100                 IF PURITM-SKU-SEQ-NBR = PC-000                   12120000
121200                    MOVE '00000000' TO D1-SKU-NBR                 12130000
121300                 ELSE                                             12140000
121400                 IF PURITM-SKU-SEQ-NBR = PC-999                   12150000
121500                    MOVE '99999999' TO D1-SKU-NBR                 12160000
121600                 ELSE                                             12170000
121700                    MOVE '2000-PRINT-PACKING-SLIP'                12180000
121800                                         TO DP013-PARAGRAPH       12190000
121900                    MOVE 'CHECKING FOR DUMMY SKU'                 12200000
122000                                         TO DP013-MESSAGE-TEXT (1)12210000
122100                    SET DP013-DB2-ABEND  TO TRUE                  12220000
122200                    PERFORM 9999-ABEND                            12230000
122300                 END-IF                                           12240000
122400              ELSE                                                12250000
122500                 IF PURITM-ITM-NBR > 0                            12260000
122600                    IF  PS-EOF-PKSLIP-CSR-SW = 'N'        AND     12270000
122700                      ((PURITM-SKU-SEQ-NBR  NOT = PC-000) AND     12280000
122800                       (PURITM-SKU-SEQ-NBR  NOT = PC-999))        12290000
122900                          PERFORM 2100-CALL-XLKUT001              12300000
123000                    END-IF                                        12310000
123100                 END-IF                                           12320000
123200              END-IF                                              12330000
123300         END-IF                                                   12340000
123400*----------------------------------------------------------------*12350000
123500*     CHANGES MADE FOR WR # 230ZZ ENDS HERE.                     *12360000
123600*----------------------------------------------------------------*12370000
123700                                                                  12380000
123800     IF  RECDIS-STR-NBR = PV-PREV-STR-NBR                         12390000
123900         CONTINUE                                                 12400000
124000     ELSE                                                         12410000
124100         IF  PS-FIRST-PASS                                        12420000
124200             MOVE 'N'            TO PS-FIRST-PASS-SW              12430000
124300             MOVE RECDIS-STR-NBR TO PV-PRINT-STR-NBR              12440000
124400         ELSE                                                     12450000
124500             PERFORM 5000-PRINT-TOTAL-LINE                        12460000
124600             MOVE RECDIS-STR-NBR TO PV-PRINT-STR-NBR              12470000
124700             PERFORM 1200-FORMAT-HEADER-LINES                     12480000
124800         END-IF                                                   12490000
124900     END-IF.                                                      12500000
125000                                                                  12510000
125100     IF  PA-LINE-CNT > PC-LINE-MAX                                12520000
125200         PERFORM 1200-FORMAT-HEADER-LINES                         12530000
125300     END-IF.                                                      12540000
125400                                                                  12550000
125500     MOVE XL001-SUB-CL-NBR-2CH   TO D1-CLASS-NBR.                 12560000
125600     MOVE PURITM-UNT-RTL-PR-AMT  TO D1-UNIT-RETAIL.               12570000
125700     MOVE PURITM-UM-IND          TO D1-UM.                        12580000
125800                                                                  12590000
125900     INITIALIZE PV-FORMATTED-GROUP-PRICING                        12600000
126000                PV-GROUP-PRICE-NUMERIC-EDIT-X.                    12610000
126100                                                                  12620000
126200     MOVE PURITM-GP-QTY          TO PV-GP-QTY.                    12630000
126300     MOVE PURITM-GP-RTL-AMT      TO PV-MAX-GROUP-PRICE-DIGITS.    12640000
126400                                                                  12650000
126500     PERFORM 1110-FORMAT-GROUP-PRICING.                           12660000
126600     MOVE PV-FORMATTED-GROUP-PRICING                              12670000
126700                                 TO D1-GROUP-PRICE.               12680000
126800                                                                  12690000
126900     MOVE ZERO                   TO D1-ORD-QTY.                   12700000
127000     ADD  ZERO                   TO PA-TOT-ORD-QTY.               12710000
127100                                                                  12720000
127200     MOVE RECDIS-EXPTED-ITM-QTY  TO D1-INV-QTY.                   12730000
127300     ADD  RECDIS-EXPTED-ITM-QTY  TO PA-TOT-INV-QTY.               12740000
127400                                                                  12750000
127500     IF PURITM-GP-QTY > 1                                         12760000
127600         COMPUTE PV-UNIT-RETAIL =                                 12770000
127700                         PURITM-GP-RTL-AMT / PURITM-GP-QTY        12780000
127800         COMPUTE PV-EXT-RETAIL =                                  12790000
127900                 PV-UNIT-RETAIL * RECDIS-EXPTED-ITM-QTY           12800000
128000     ELSE                                                         12810000
128100         COMPUTE PV-EXT-RETAIL =                                  12820000
128200                 PURITM-UNT-RTL-PR-AMT * RECDIS-EXPTED-ITM-QTY    12830000
128300     END-IF.                                                      12840000
128400     MOVE PV-EXT-RETAIL          TO D1-EXT-RETAIL.                12850000
128500     ADD  PV-EXT-RETAIL          TO PA-TOT-EXT-RETAIL.            12860000
128600*    MOVE PURITM-TOT-VAL-RTL-AMT TO D1-EXT-RETAIL.                12870000
128700*    ADD  PURITM-TOT-VAL-RTL-AMT TO PA-TOT-EXT-RETAIL.            12880000
128800                                                                  12890000
128900     MOVE PURITM-VEND-STYL-NAME  TO D1-VENDOR-STYLE.              12900000
129000***  MOVE POCSTYLE               TO PWT-KOHLS-STYLE (PWT-INDX)    12910000
129100                                                                  12920000
129200                                                                  12930000
129300     PERFORM 8050-GET-CERT-INFO.                                  12940000
129400     INITIALIZE PV-UPC-TABLE.                                     12950000
129500     SET PV-IDX TO 1.                                             12960000
129600     SET PS-START-UPC-CSR TO TRUE.                                12970000
129700     PERFORM 8030-OPEN-SKU-CURSOR.                                12980000
129800     PERFORM 8035-FETCH-UPC-CSR                                   12990000
129900         UNTIL PS-END-UPC-CSR                                     13000000
130000            OR PV-IDX > 100.                                      13010000
130100     PERFORM 8037-CLOSE-SKU-CURSOR.                               13020000
130200                                                                  13030000
130300     IF PV-UPC (1) = ZERO                                         13040000
130400         MOVE PC-NO-VENDOR-UPC    TO D1-UPC-NBR                   13050000
130500*        MOVE SPACE               TO D1-CERT-REQ                  13060000
130600         IF PS-TVNDAGR-FOUND                                      13070000
130700             MOVE 'Y'             TO D1-CERT-REQ                  13080000
130800         ELSE                                                     13090000
130900             MOVE 'N'             TO D1-CERT-REQ                  13100000
131000         END-IF                                                   13110000
131100     ELSE                                                         13120000
131200         MOVE PV-UPC (1)          TO D1-UPC-NBR                   13130000
131300         MOVE PV-UPC-CERT-IND (1) TO D1-CERT-REQ                  13140000
131400     END-IF.                                                      13150000
131500                                                                  13160000
131600     MOVE PURITM-APP-PO-LNE-NBR   TO D1-LINE.                     13170000
131700                                                                  13180000
131800     MOVE '0'                     TO DRS01-COMM-CTL.              13190000
131900     MOVE D1-DETAIL-LINE1         TO DRS01-COMM-DATA.             13200000
132000     PERFORM 9000-LINK-TO-DRS.                                    13210000
132100                                                                  13220000
132200     IF PV-UPC (2) = ZERO                                         13230000
132300         MOVE SPACES              TO D2-UPC-NBR                   13240000
132400                                     D2-CERT-REQ                  13250000
132500     ELSE                                                         13260000
132600         MOVE PV-UPC (2)          TO D2-UPC-NBR                   13270000
132700         MOVE PV-UPC-CERT-IND (2) TO D2-CERT-REQ                  13280000
132800     END-IF.                                                      13290000
132900     MOVE ' '                     TO DRS01-COMM-CTL.              13300000
133000     MOVE D2-DETAIL-LINE2         TO DRS01-COMM-DATA.             13310000
133100     PERFORM 9000-LINK-TO-DRS.                                    13320000
133200                                                                  13330000
133300     ADD  3                       TO PA-LINE-CNT.                 13340000
133400                                                                  13350000
133500     MOVE RECDIS-STR-NBR          TO PV-PREV-STR-NBR.             13360000
133600                                                                  13370000
133700     MOVE SPACES                  TO D2-SKU-DESC                  13380000
133800                                     D2-SIZE.                     13390000
133900     PERFORM VARYING PV-IDX FROM 3 BY 1                           13400000
134000         UNTIL PV-UPC (PV-IDX) = ZERO                             13410000
134100            OR PV-IDX > 99                                        13420000
134200         MOVE PV-UPC (PV-IDX)         TO D2-UPC-NBR               13430000
134300         MOVE PV-UPC-CERT-IND (PV-IDX) TO D2-CERT-REQ             13440000
134400         MOVE ' '                     TO DRS01-COMM-CTL           13450000
134500         MOVE D2-DETAIL-LINE2         TO DRS01-COMM-DATA          13460000
134600         PERFORM 9000-LINK-TO-DRS                                 13470000
134700         ADD  1                       TO PA-LINE-CNT              13480000
134800     END-PERFORM.                                                 13490000
134900                                                                  13500000
135000     IF PV-IDX > 99                                               13510000
135100         MOVE 'MORE UPC''S '          TO D2-UPC-NBR               13520000
135200         MOVE ' '                     TO DRS01-COMM-CTL           13530000
135300         MOVE D2-DETAIL-LINE2         TO DRS01-COMM-DATA          13540000
135400         PERFORM 9000-LINK-TO-DRS                                 13550000
135500         ADD  1                       TO PA-LINE-CNT              13560000
135600     END-IF.                                                      13570000
135700                                                                  13580000
135800     PERFORM 2101-GET-BEFORE-PRICE-CHG-DAYS                       13590000
135900     PERFORM 2102-GET-AFTER-PRICE-CHG-DAYS                        13600000
136000                                                                  13610000
136100     PERFORM 2300-DETERMINE-IF-PPC.                               13620000
136200     IF  PS-YES-PRICE-CHANGE                                      13630000
136300         MOVE ' '                     TO DRS01-COMM-CTL           13640000
136400         MOVE D3-PEND-PRICE-LINE      TO DRS01-COMM-DATA          13650000
136500         PERFORM 9000-LINK-TO-DRS                                 13660000
136600         ADD  1                       TO PA-LINE-CNT              13670000
136700     END-IF.                                                      13680000
136800                                                                  13690000
136900                                                                  13700000
137000     PERFORM 7010-FETCH-PKSLIP-CSR.                               13710000
137100                                                                  13720000
137200 2100-CALL-XLKUT001.                                              13730000
137300                                                                  13740000
137400      INITIALIZE XL001-ITEM-COMMAREA.                             13750000
137500      MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR                  13760000
137600                                                                  13770000
137700      SET  XL001-BY-ITEM                                          13780000
137800*LMM ADD                                                          13790000
137900           XL001-SELECT-SKU-STR                                   13800000
138000           XL001-SELECT-VND-STYL                                  13810000
138100           XL001-SELECT-SKU TO TRUE.                              13820000
138200                                                                  13830000
138300      CALL XL001-VSM-PGM USING  DFHEIBLK                          13840000
138400                                XL001-COMMAREA                    13850000
138500                                XL001-ITEM-COMMAREA.              13860000
138600                                                                  13870000
138700      EVALUATE TRUE                                               13880000
138800          WHEN XL001-SKU-SQLCODE = +0                             13890000
138900                CONTINUE                                          13900000
139000          WHEN XL001-SKU-SQLCODE = +100                           13910000
139100                INITIALIZE XL001-SKU-NBR                          13920000
139200                           XL001-SKU-DESC                         13930000
139300                           XL001-SIZE-DESC                        13940000
139400                           XL001-CSTM-CLOR-DESC                   13950000
139500                           XL001-SHRT-CLOR-DESC                   13960000
139600*LMM ADD                                                          13970000
139700                           XL001-UNT-RTL-AMT                      13980000
139800                                                                  13990000
139900          WHEN XL001-SKU-CONTENTION                               14000000
140000                MOVE '2000-PRINT-PACKING-SLIP'                    14010000
140100                                  TO DP013-PARAGRAPH              14020000
140200                MOVE 'FETCH FROM XLV_SKU'                         14030000
140300                                  TO DP013-MESSAGE-TEXT (1)       14040000
140400                MOVE XL001-SQLCA  TO DP013-SQLCA                  14050000
140500                SET DP013-DB2-ABEND  TO TRUE                      14060000
140600                PERFORM 9999-ABEND                                14070000
140700                                                                  14080000
140800          WHEN OTHER                                              14090000
140900                MOVE '2000-PRINT-PACKING-SLIP'                    14100000
141000                                 TO DP013-PARAGRAPH               14110000
141100                MOVE 'INVALID RETURN'                             14120000
141200                                 TO DP013-MESSAGE-TEXT (1)        14130000
141300                MOVE XL001-SQLCA TO DP013-SQLCA                   14140000
141400                SET DP013-DB2-ABEND                               14150000
141500                                 TO TRUE                          14160000
141600                PERFORM 9999-ABEND                                14170000
141700      END-EVALUATE.                                               14180000
141800                                                                  14190000
141900      MOVE XL001-SKU-NBR         TO D1-SKU-NBR                    14200000
142000      MOVE XL001-SKU-DESC        TO D2-SKU-DESC                   14210000
142100      MOVE XL001-SIZE-DESC       TO D2-SIZE                       14220000
142200*LMM ADD                                                          14230000
142300      MOVE XL001-UNT-RTL-AMT     TO D3-PPC-OLD-RTL-AMT            14240000
142400      IF XL001-CSTM-CLOR-DESC NOT = SPACES                        14250000
142500         MOVE XL001-CSTM-CLOR-DESC TO D1-COLOR                    14260000
142600      ELSE                                                        14270000
142700         MOVE XL001-SHRT-CLOR-DESC TO D1-COLOR                    14280000
142800      END-IF                                                      14290000
142900                                                                  14300000
143000      EVALUATE TRUE                                               14310000
143100          WHEN XL001-VND-STYL-SQLCODE = +0                        14320000
143200                CONTINUE                                          14330000
143300          WHEN XL001-VND-STYL-SQLCODE = +100                      14340000
143400          WHEN XL001-VND-STYL-CONTENTION                          14350000
143500                MOVE PURCHS-DEPT-NBR TO XL001-DEPT-NBR-3CH        14360000
143600                MOVE PURITM-CL-NBR   TO XL001-SUB-CL-NBR-2CH      14370000
143700          WHEN OTHER                                              14380000
143800                MOVE '2000-PRINT-PACKING-SLIP'                    14390000
143900                                 TO DP013-PARAGRAPH               14400000
144000                MOVE 'INVALID RETURN 2'                           14410000
144100                                 TO DP013-MESSAGE-TEXT (1)        14420000
144200                MOVE XL001-SQLCA TO DP013-SQLCA                   14430000
144300                SET DP013-DB2-ABEND                               14440000
144400                                 TO TRUE                          14450000
144500                PERFORM 9999-ABEND                                14460000
144600      END-EVALUATE.                                               14470000
144700                                                                  14480000
144800/                                                                 14490000
144900 2101-GET-BEFORE-PRICE-CHG-DAYS.                                  14500000
145000      EXEC SQL                                                    14510000
145100          SELECT FUNC_QTY                                         14520000
145200            INTO  :PV-PPCBEF-QTY                                  14530000
145300            FROM TKRPRPM                                          14540000
145400           WHERE SYS_PRC_FUNC_CDE = 'PPCBEF'                      14550000
145500             WITH UR                                              14560000
145600      END-EXEC.                                                   14570000
145700                                                                  14580000
145800      EVALUATE TRUE                                               14590000
145900          WHEN SQLCODE = +0                                       14600000
146000*TEST ONLY    DISPLAY 'PARM PPCBEF VALUE = ' PV-PPCBEF-QTY        14610000
146100              CONTINUE                                            14620000
146200          WHEN SQLCODE = +100                                     14630000
146300              CONTINUE                                            14640000
146400          WHEN OTHER                                              14650000
146500              MOVE '2101-GET-BEFORE-PRICE-CHG-DAYS'               14660000
146600                  TO DP013-PARAGRAPH                              14670000
146700              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)14680000
146800              MOVE SQLCA   TO DP013-SQLCA                         14690000
146900              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         14700000
147000              SET DP013-DB2-ABEND                                 14710000
147100                  DP013-XCTL-DISPLAY-RESTART TO TRUE              14720000
147200              PERFORM 9999-ABEND                                  14730000
147300      END-EVALUATE.                                               14740000
147400                                                                  14750000
147500 2102-GET-AFTER-PRICE-CHG-DAYS.                                   14760000
147600      EXEC SQL                                                    14770000
147700          SELECT FUNC_QTY                                         14780000
147800            INTO  :PV-PPCAFT-QTY                                  14790000
147900            FROM TKRPRPM                                          14800000
148000           WHERE SYS_PRC_FUNC_CDE = 'PPCAFT'                      14810000
148100             WITH UR                                              14820000
148200      END-EXEC.                                                   14830000
148300                                                                  14840000
148400      EVALUATE TRUE                                               14850000
148500          WHEN SQLCODE = +0                                       14860000
148600*TEST ONLY    DISPLAY 'PARM PPCAFT VALUE = ' PV-PPCAFT-QTY        14870000
148700              CONTINUE                                            14880000
148800          WHEN SQLCODE = +100                                     14890000
148900              CONTINUE                                            14900000
149000          WHEN OTHER                                              14910000
149100              MOVE '2102-GET-AFTER-PRICE-CHG-DAYS'                14920000
149200                  TO DP013-PARAGRAPH                              14930000
149300              MOVE 'CHECKING PARM TABLE' TO DP013-MESSAGE-TEXT (1)14940000
149400              MOVE SQLCA   TO DP013-SQLCA                         14950000
149500              MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)         14960000
149600              SET DP013-DB2-ABEND                                 14970000
149700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              14980000
149800              PERFORM 9999-ABEND                                  14990000
149900      END-EVALUATE.                                               15000000
150000                                                                  15010000
150100*----------------------------------------------------------------*15020000
150200* CALL PERM PRICE CHANGE MODULE XLKUT086 - GET PRICE INFO        *15030000
150300* THIS MODULE DETERMINES IF THERE IS A PENDING PRICE CHANGE      *15040000
150400* FOR THE SKU BEING REPORTED ON.                                 *15050000
150500*----------------------------------------------------------------*15060000
150600 2300-DETERMINE-IF-PPC.                                           15070000
150600     DISPLAY ' RCKCS237 2300-DETERMINE-IF-PPC'                    15080000
150700                                                                  15090000
150800     INITIALIZE XL086-PR-CHG-COMMAREA.                            15100000
150900     MOVE XL001-ITM-NBR TO XL086-KEY-ITM-NBR                      15110000
151000     MOVE XL001-SKU-NBR TO XL086-KEY-SKU-NBR                      15120000
151100     MOVE PV-PPCBEF-QTY TO XL086-KEY-BEFORE-DAYS                  15130000
151200     MOVE PV-PPCAFT-QTY TO XL086-KEY-AFTER-DAYS                   15140000
151300                                                                  15150000
151400     CALL XL086-PR-CHG-PGM USING DFHEIBLK                         15160000
151500                                 XL086-COMMAREA                   15170000
151600                                 XL086-PR-CHG-COMMAREA.           15180000
151700                                                                  15190000
151800     EVALUATE TRUE                                                15200000
151900        WHEN XL086-SUCCESSFUL                                     15210000
152000           IF XL086-PPC-DOC-FOUND                                 15220000
152100              SET PS-YES-PRICE-CHANGE    TO TRUE                  15230000
                    DISPLAY 'TRAP1'                                     15240000
                    DISPLAY 'DOC = ' XL086-DOC-NBR                      15250000
                            ' DTE = ' XL086-EFF-DTE                     15260000
152200              MOVE XL086-DOC-NBR         TO D3-PPC-DOC-NBR        15270000
152300              MOVE XL086-EFF-DTE         TO PV-DATE               15280000
152400              MOVE PV-MM                 TO D3-PPC-CHG-MONTH      15290000
152500              MOVE PV-DD                 TO D3-PPC-CHG-DAY        15300000
152600              MOVE PV-YY                 TO D3-PPC-CHG-YEAR       15310000
152700              MOVE '/'                   TO D3-SLASH-ONE          15320000
152800                                            D3-SLASH-TWO          15330000
152900              MOVE XL086-NEW-RTL-AMT     TO D3-PPC-NEW-RTL-AMT    15340000
153000           ELSE                                                   15350000
153100              SET PS-NO-PRICE-CHANGE    TO TRUE                   15360000
153200           END-IF                                                 15370000
153300        WHEN XL086-SQL-ERROR                                      15380000
153400           SET PS-NO-PRICE-CHANGE       TO TRUE                   15390000
153500     END-EVALUATE.                                                15400000
153600/                                                                 15410000
153700                                                                  15420000
153800******************************************************************15430000
153900*  THIS MODULE DETERMINES IF THERE IS A PENDING PRICE CHANGE.     15440000
154000*  FOR THE SKU BEING REPORTED ON.                                 15450000
154100******************************************************************15460000
154200*2300-DETERMINE-IF-PPC.                                           15470000
154300*    PERFORM 7290-OPEN-PPC-CSR.                                   15480000
154400*    PERFORM 7300-FETCH-PPC-CSR.                                  15490000
154500*    IF PS-YES-PRICE-CHANGE                                       15500000
154600*        MOVE CPPCDT-CENPPC-NBR                                   15510000
154700*                              TO D3-PPC-DOC-NBR                  15520000
154800*        MOVE CENPPC-EFF-DTE   TO PV-DATE                         15530000
154900*        MOVE PV-MM            TO D3-PPC-CHG-MONTH                15540000
155000*        MOVE PV-DD            TO D3-PPC-CHG-DAY                  15550000
155100*        MOVE PV-YY            TO D3-PPC-CHG-YEAR                 15560000
155200*        MOVE '/'              TO D3-SLASH-ONE                    15570000
155300*                                 D3-SLASH-TWO                    15580000
155400*        MOVE CPPCDT-OLD-RTL-AMT                                  15590000
155500*                              TO D3-PPC-OLD-RTL-AMT              15600000
155600*        MOVE CPPCDT-NEW-RTL-AMT                                  15610000
155700*                              TO D3-PPC-NEW-RTL-AMT              15620000
155800*    END-IF.                                                      15630000
155900*                                                                 15640000
156000*    PERFORM 7310-CLOSE-PPC-CSR.                                  15650000
156100/                                                                 15660000
156200*----------------------------------------------------------------*15670000
156300*    PRINT TOTAL LINE                                            *15680000
156400*----------------------------------------------------------------*15690000
156500                                                                  15700000
156600 5000-PRINT-TOTAL-LINE.                                           15710000
156700                                                                  15720000
156800     IF PA-LINE-CNT > (PC-LINE-MAX - 5)                           15730000
156900         PERFORM 1200-FORMAT-HEADER-LINES                         15740000
157000     END-IF.                                                      15750000
157100                                                                  15760000
157200     MOVE '-'                    TO DRS01-COMM-CTL.               15770000
157300     MOVE D1-TOTAL-LINE1         TO DRS01-COMM-DATA.              15780000
157400     PERFORM 9000-LINK-TO-DRS.                                    15790000
157500                                                                  15800000
157600     MOVE PA-TOT-ORD-QTY         TO D2-TOT-ORD-QTY.               15810000
157700     MOVE PA-TOT-INV-QTY         TO D2-TOT-INV-QTY.               15820000
157800     MOVE PA-TOT-EXT-RETAIL      TO D2-TOT-EXT-RETAIL.            15830000
157900                                                                  15840000
158000     MOVE ' '                    TO DRS01-COMM-CTL.               15850000
158100     MOVE D2-TOTAL-LINE2         TO DRS01-COMM-DATA.              15860000
158200     PERFORM 9000-LINK-TO-DRS.                                    15870000
158300                                                                  15880000
158400     INITIALIZE PA-TOT-ORD-QTY                                    15890000
158500                PA-TOT-INV-QTY                                    15900000
158600                PA-TOT-EXT-RETAIL.                                15910000
158700                                                                  15920000
158800/                                                                 15930000
158900*----------------------------------------------------------------*15940000
159000*    PRINT END OF REPORT MESSAGE                                 *15950000
159100*----------------------------------------------------------------*15960000
159200                                                                  15970000
159300 6000-PRINT-LAST-LINE.                                            15980000
159400                                                                  15990000
159500     MOVE '-'                    TO DRS01-COMM-CTL.               16000000
159600     MOVE L1-LAST-LINE           TO DRS01-COMM-DATA.              16010000
159700     PERFORM 9000-LINK-TO-DRS.                                    16020000
159800                                                                  16030000
159900/                                                                 16040000
160000*----------------------------------------------------------------*16050000
160100* OPEN THE PACKING SLIP CURSOR                                   *16060000
160200*----------------------------------------------------------------*16070000
160300                                                                  16080000
160400 7000-OPEN-PKSLIP-CURSOR.                                         16090000
160500                                                                  16100000
160600     EXEC SQL                                                     16110000
160700         OPEN PKSLIP-CSR                                          16120000
160800     END-EXEC.                                                    16130000
160900                                                                  16140000
161000     EVALUATE TRUE                                                16150000
161100         WHEN SQLCODE = +0                                        16160000
161200              CONTINUE                                            16170000
161300                                                                  16180000
161400         WHEN SQLCODE = -904                                      16190000
161500         WHEN SQLCODE = -913                                      16200000
161600              CONTINUE                                            16210000
161700                                                                  16220000
161800         WHEN SQLWARN0 NOT = SPACE                                16230000
161900         WHEN SQLCODE  NOT = +0                                   16240000
162000              MOVE '7000-OPEN-PKSLIP-CURSOR'                      16250000
162100                                   TO DP013-PARAGRAPH             16260000
162200              MOVE 'OPEN PKSLIP-CSR CURSOR'                       16270000
162300                                   TO DP013-MESSAGE-TEXT (1)      16280000
162400              MOVE SQLCA           TO DP013-SQLCA                 16290000
162500              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    16300000
162600              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    16310000
162700              MOVE 'TRECDIS'       TO DP013-DB2-TABLE-NAME (3)    16320000
162800              SET DP013-DB2-ABEND  TO TRUE                        16330000
162900              PERFORM 9999-ABEND                                  16340000
163000     END-EVALUATE.                                                16350000
163100                                                                  16360000
163200/                                                                 16370000
163300*----------------------------------------------------------------*16380000
163400*    FETCH A PACKING SLIP ROW                                    *16390000
163500*----------------------------------------------------------------*16400000
163600                                                                  16410000
163700 7010-FETCH-PKSLIP-CSR.                                           16420000
163800                                                                  16430000
163900     EXEC SQL                                                     16440000
164000         FETCH PKSLIP-CSR                                         16450000
164100          INTO :PURCHS-PO-NBR                                     16460000
164200              ,:PURCHS-DEPT-NBR                                   16470000
164300              ,:PURCHS-ENT-ID                                     16480000
164400              ,:PURITM-SKU-SEQ-NBR                                16490000
164500              ,:PURITM-CL-NBR                                     16500000
164600              ,:PURITM-VEND-STYL-NAME                             16510000
164700              ,:PURITM-UNT-QTY                                    16520000
164800              ,:PURITM-UM-IND                                     16530000
164900              ,:PURITM-UNT-RTL-PR-AMT                             16540000
165000              ,:PURITM-TOT-VAL-RTL-AMT                            16550000
165100              ,:PURITM-GP-RTL-AMT                                 16560000
165200              ,:PURITM-GP-QTY                                     16570000
165300              ,:PURITM-APP-PO-LNE-NBR                             16580000
165400              ,:PURITM-ITM-NBR                                    16590000
165500              ,:RECDIS-STR-NBR                                    16600000
165600              ,:RECDIS-STR-FCLTY-ID                               16610000
165700              ,:RECDIS-EXPTED-ITM-QTY                             16620000
165800              ,:RECDIS-VERIFY-ITM-QTY                             16630000
165900     END-EXEC.                                                    16640000
166000                                                                  16650000
166100     EVALUATE TRUE                                                16660000
166200         WHEN SQLCODE = +0                                        16670000
166300              CONTINUE                                            16680000
166400                                                                  16690000
166500         WHEN SQLCODE = +100                                      16700000
166600              SET PS-EOF-PKSLIP-CSR TO TRUE                       16710000
166700                                                                  16720000
166800         WHEN SQLWARN0 NOT = SPACE                                16730000
166900         WHEN SQLCODE < +0                                        16740000
167000         WHEN SQLCODE > +0                                        16750000
167100              MOVE '7010-FETCH-PKSLIP-CSR'                        16760000
167200                                   TO DP013-PARAGRAPH             16770000
167300              MOVE 'FETCH PKSLIP CURSOR'                          16780000
167400                                   TO DP013-MESSAGE-TEXT (1)      16790000
167500              MOVE SQLCA           TO DP013-SQLCA                 16800000
167600              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    16810000
167700              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    16820000
167800              MOVE 'TRECDIS'       TO DP013-DB2-TABLE-NAME (3)    16830000
167900              SET DP013-DB2-ABEND  TO TRUE                        16840000
168000              PERFORM 9999-ABEND                                  16850000
168100     END-EVALUATE.                                                16860000
168200                                                                  16870000
168300 7020-CLOSE-PKSLIP-CURSOR.                                        16880000
168400                                                                  16890000
168500     EXEC SQL                                                     16900000
168600         CLOSE PKSLIP-CSR                                         16910000
168700     END-EXEC.                                                    16920000
168800                                                                  16930000
168900     EVALUATE TRUE                                                16940000
169000         WHEN SQLCODE = +0                                        16950000
169100              CONTINUE                                            16960000
169200                                                                  16970000
169300         WHEN SQLWARN0 NOT = SPACE                                16980000
169400         WHEN SQLCODE  NOT = +0                                   16990000
169500              MOVE '7020-CLOSE-PKSLIP-CURSOR'                     17000000
169600                                   TO DP013-PARAGRAPH             17010000
169700              MOVE 'CLOSE PKSLIP-CSR CURSOR'                      17020000
169800                                   TO DP013-MESSAGE-TEXT (1)      17030000
169900              MOVE SQLCA           TO DP013-SQLCA                 17040000
170000              MOVE 'TPURCHS'       TO DP013-DB2-TABLE-NAME (1)    17050000
170100              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    17060000
170200              MOVE 'TRECDIS'       TO DP013-DB2-TABLE-NAME (3)    17070000
170300              SET DP013-DB2-ABEND  TO TRUE                        17080000
170400              PERFORM 9999-ABEND                                  17090000
170500     END-EVALUATE.                                                17100000
170600                                                                  17110000
170700/                                                                 17120000
170800*7290-OPEN-PPC-CSR.                                               17130000
170900*    EXEC SQL                                                     17140000
171000*        OPEN PPC-CSR                                             17150000
171100*    END-EXEC.                                                    17160000
171200*                                                                 17170000
171300*    EVALUATE TRUE                                                17180000
171400*        WHEN SQLCODE = ZERO                                      17190000
171500*            CONTINUE                                             17200000
171600*        WHEN SQLWARN0 NOT = SPACE                                17210000
171700*        WHEN SQLCODE < ZERO                                      17220000
171800*        WHEN SQLCODE > ZERO                                      17230000
171900*            MOVE '7290-OPEN-PPC-CSR'                             17240000
172000*                TO DP013-PARAGRAPH                               17250000
172100*            MOVE 'OPEN THE PPC-CSR'                              17260000
172200*                TO DP013-MESSAGE-TEXT (1)                        17270000
172300*            MOVE SQLCA            TO DP013-SQLCA                 17280000
172400*            MOVE 'TCPPCDT'        TO DP013-DB2-TABLE-NAME (1)    17290000
172500*            MOVE 'TCENPPC'        TO DP013-DB2-TABLE-NAME (2)    17300000
172600*            MOVE 'TSK'            TO DP013-DB2-TABLE-NAME (3)    17310000
172700*            SET DP013-DB2-ABEND   TO TRUE                        17320000
172800*            SET DP013-NO-ROLLBACK TO TRUE                        17330000
172900*            PERFORM 9999-ABEND                                   17340000
173000*    END-EVALUATE.                                                17350000
173100*                                                                 17360000
173200*7300-FETCH-PPC-CSR.                                              17370000
173300*    INITIALIZE DCLTCPPCDT                                        17380000
173400*               DCLTCENPPC.                                       17390000
173500*                                                                 17400000
173600*    EXEC SQL                                                     17410000
173700*        FETCH  PPC-CSR                                           17420000
173800*         INTO  :CPPCDT-CENPPC-NBR,                               17430000
173900*               :CPPCDT-OLD-RTL-AMT,                              17440000
174000*               :CPPCDT-NEW-RTL-AMT,                              17450000
174100*               :CENPPC-EFF-DTE                                   17460000
174200*    END-EXEC.                                                    17470000
174300*                                                                 17480000
174400*    EVALUATE TRUE                                                17490000
174500*        WHEN SQLCODE = ZERO                                      17500000
174600*            SET PS-YES-PRICE-CHANGE TO TRUE                      17510000
174700*        WHEN SQLCODE = +100                                      17520000
174800*            SET PS-NO-PRICE-CHANGE  TO TRUE                      17530000
174900*        WHEN SQLWARN0 NOT = SPACE                                17540000
175000*        WHEN SQLCODE < ZERO                                      17550000
175100*        WHEN SQLCODE > ZERO                                      17560000
175200*            MOVE '7300-FETCH-PPC-CSR'                            17570000
175300*                TO DP013-PARAGRAPH                               17580000
175400*            MOVE 'ATTEMPTING TO FETCH A ROW OF THE RESULTS TABLE 17590000
175500*                 'FROM THE PPC-CSR'                              17600000
175600*              TO DP013-MESSAGE-TEXT (1)                          17610000
175700*            MOVE SQLCA            TO DP013-SQLCA                 17620000
175800*            MOVE 'TCPPCDT'        TO DP013-DB2-TABLE-NAME (1)    17630000
175900*            MOVE 'TCENPPC'        TO DP013-DB2-TABLE-NAME (2)    17640000
176000*            SET DP013-DB2-ABEND   TO TRUE                        17650000
176100*            SET DP013-NO-ROLLBACK TO TRUE                        17660000
176200*            PERFORM 9999-ABEND                                   17670000
176300*    END-EVALUATE.                                                17680000
176400*                                                                 17690000
176500*7310-CLOSE-PPC-CSR.                                              17700000
176600*    EXEC SQL                                                     17710000
176700*        CLOSE PPC-CSR                                            17720000
176800*    END-EXEC.                                                    17730000
176900*                                                                 17740000
177000*    EVALUATE TRUE                                                17750000
177100*        WHEN SQLCODE = ZERO                                      17760000
177200*            CONTINUE                                             17770000
177300*        WHEN SQLWARN0 NOT = SPACE                                17780000
177400*        WHEN SQLCODE < ZERO                                      17790000
177500*        WHEN SQLCODE > ZERO                                      17800000
177600*            MOVE '7310-CLOSE-PPC-CSR'                            17810000
177700*                TO DP013-PARAGRAPH                               17820000
177800*            MOVE 'CLOSE THE PPC-CSR'                             17830000
177900*                TO DP013-MESSAGE-TEXT (1)                        17840000
178000*            MOVE SQLCA            TO DP013-SQLCA                 17850000
178100*            MOVE 'TCPPCDT'        TO DP013-DB2-TABLE-NAME (1)    17860000
178200*            MOVE 'TCENPPC'        TO DP013-DB2-TABLE-NAME (2)    17870000
178300*            MOVE 'TSK'            TO DP013-DB2-TABLE-NAME (3)    17880000
178400*            SET DP013-DB2-ABEND   TO TRUE                        17890000
178500*            SET DP013-NO-ROLLBACK TO TRUE                        17900000
178600*            PERFORM 9999-ABEND                                   17910000
178700*    END-EVALUATE.                                                17920000
178800*    EJECT                                                        17930000
178900/                                                                 17940000
179000 8000-GET-STORE-NAME.                                             17950000
179100                                                                  17960000
179200* THE XLT_LOC TABLE WAS REMOVED BUT REPLACED WITH THE LOCATION    17970000
179300* HIERARCY DOMAIN TABLE XL00010        DMB 12/2004                17980000
179400                                                                  17990000
179500     INITIALIZE XL071-COMMAREA-REC.                               18000000
179600     CALL XL071-LOCATION-MODULE USING DFHEIBLK                    18010000
179700                                    XL071-COMMAREA                18020000
179800                                    XL071-COMMAREA-REC.           18030000
179900                                                                  18040000
180000     IF XL071-NO-ERRORS                                           18050000
180100          CONTINUE                                                18060000
180200     ELSE                                                         18070000
180300          MOVE SPACES TO XL071-LOC-NM                             18080000
180400     END-IF.                                                      18090000
180500                                                                  18100000
180600                                                                  18110000
180700 8010-GET-VENDOR-NAME.                                            18120000
180800                                                                  18130000
180900     EXEC SQL                                                     18140000
181000         SELECT B.INHOUSE_NBR                                     18150000
181100               ,C.ENT_NAME_DESC                                   18160000
181200          INTO  :VNDDPT-INHOUSE-NBR                               18170000
181300               ,:ENTNME-ENT-NAME-DESC                             18180000
181400          FROM  TPURCHS A                                         18190000
181500               ,TVNDDPT B                                         18200000
181600               ,TENTNME C                                         18210000
181700          WHERE A.PO_NBR         = :DK-ORD-NBR                    18220000
181800           AND  A.VER_STATUS_CDE = 'A'                            18230000
181900           AND  B.DEPT_NBR       = :DK-DEPT-NBR                   18240000
182000           AND  C.TYPE_CDE       = '01'                           18250000
182100           AND  A.ENT_ID = B.ENT_ID                               18260000
182200           AND  B.ENT_ID = C.ENT_ID                               18270000
182300     END-EXEC.                                                    18280000
182400                                                                  18290000
182500     EVALUATE TRUE                                                18300000
182600         WHEN SQLCODE = +0                                        18310000
182700         WHEN SQLCODE = -904                                      18320000
182800         WHEN SQLCODE = -913                                      18330000
182900             CONTINUE                                             18340000
183000                                                                  18350000
183100         WHEN SQLWARN0 NOT = SPACE                                18360000
183200         WHEN SQLCODE < +0                                        18370000
183300         WHEN SQLCODE > +0                                        18380000
183400             MOVE '8010-GET-VENDOR-NAME'                          18390000
183500                             TO DP013-PARAGRAPH                   18400000
183600             MOVE 'JOIN TO GET VENDOR NAME'                       18410000
183700                             TO DP013-MESSAGE-TEXT (1)            18420000
183800             MOVE SQLCA      TO DP013-SQLCA                       18430000
183900             MOVE 'TVNDDPT'  TO DP013-DB2-TABLE-NAME (1)          18440000
184000             MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME (1)          18450000
184100             SET DP013-DB2-ABEND                                  18460000
184200                             TO TRUE                              18470000
184300             PERFORM 9999-ABEND                                   18480000
184400     END-EVALUATE.                                                18490000
184500                                                                  18500000
184600/                                                                 18510000
184700 8030-OPEN-SKU-CURSOR.                                            18520000
184800                                                                  18530000
184900     EXEC SQL                                                     18540000
185000         OPEN UPC-CSR                                             18550000
185100     END-EXEC.                                                    18560000
185200                                                                  18570000
185300     EVALUATE TRUE                                                18580000
185400         WHEN SQLCODE = +0                                        18590000
185500              CONTINUE                                            18600000
185600                                                                  18610000
185700         WHEN SQLCODE = -904                                      18620000
185800         WHEN SQLCODE = -913                                      18630000
185900              CONTINUE                                            18640000
186000                                                                  18650000
186100         WHEN SQLWARN0 NOT = SPACE                                18660000
186200         WHEN SQLCODE  NOT = +0                                   18670000
186300              MOVE '8030-OPEN-SKU-CURSOR'                         18680000
186400                                   TO DP013-PARAGRAPH             18690000
186500              MOVE 'OPEN UPC-CSR CURSOR'                          18700000
186600                                   TO DP013-MESSAGE-TEXT (1)      18710000
186700              MOVE SQLCA           TO DP013-SQLCA                 18720000
186800              MOVE 'XLV_UPC'       TO DP013-DB2-TABLE-NAME (1)    18730000
186900              SET DP013-DB2-ABEND  TO TRUE                        18740000
187000              PERFORM 9999-ABEND                                  18750000
187100     END-EVALUATE.                                                18760000
187200                                                                  18770000
187300/                                                                 18780000
187400*----------------------------------------------------------------*18790000
187500*    FETCH A PACKING SLIP ROW                                    *18800000
187600*----------------------------------------------------------------*18810000
187700                                                                  18820000
187800 8035-FETCH-UPC-CSR.                                              18830000
187900                                                                  18840000
188000     EXEC SQL                                                     18850000
188100         FETCH UPC-CSR                                            18860000
188200          INTO :XLV00003-UPC-NBR                                  18870000
188300              ,:XLV00003-CERTD-IND                                18880000
188400     END-EXEC.                                                    18890000
188500                                                                  18900000
188600     EVALUATE TRUE                                                18910000
188700         WHEN SQLCODE = +0                                        18920000
188800              CONTINUE                                            18930000
188900                                                                  18940000
189000         WHEN SQLCODE = +100                                      18950000
189100              SET PS-END-UPC-CSR TO TRUE                          18960000
189200                                                                  18970000
189300         WHEN SQLWARN0 NOT = SPACE                                18980000
189400         WHEN SQLCODE < +0                                        18990000
189500         WHEN SQLCODE > +0                                        19000000
189600              MOVE '8035-FETCH-UPC-CSR'                           19010000
189700                                   TO DP013-PARAGRAPH             19020000
189800              MOVE 'FETCH SKU CURSOR'                             19030000
189900                                   TO DP013-MESSAGE-TEXT (1)      19040000
190000              MOVE SQLCA           TO DP013-SQLCA                 19050000
190100              MOVE 'XLV_UPC'       TO DP013-DB2-TABLE-NAME (1)    19060000
190200              SET DP013-DB2-ABEND  TO TRUE                        19070000
190300              PERFORM 9999-ABEND                                  19080000
190400     END-EVALUATE.                                                19090000
190500                                                                  19100000
190600     IF SQLCODE = +0                                              19110000
190700         MOVE XLV00003-UPC-NBR TO PV-UPC-SPLIT                    19120000
190800         IF PV-UPC-X4 = PC-0004                                   19130000
190900             CONTINUE                                             19140000
191000         ELSE                                                     19150000
191100             MOVE XLV00003-UPC-NBR TO PV-UPC (PV-IDX)             19160000
191200             IF  ((XLV00003-CERTD-IND NOT = 'Y')                  19170000
191300               AND PS-TVNDAGR-FOUND)                              19180000
191400                 MOVE 'Y' TO PV-UPC-CERT-IND (PV-IDX)             19190000
191500             ELSE                                                 19200000
191600                 MOVE 'N' TO PV-UPC-CERT-IND (PV-IDX)             19210000
191700             END-IF                                               19220000
191800             SET PV-IDX UP BY 1                                   19230000
191900         END-IF                                                   19240000
192000     END-IF.                                                      19250000
192100                                                                  19260000
192200 8037-CLOSE-SKU-CURSOR.                                           19270000
192300                                                                  19280000
192400     EXEC SQL                                                     19290000
192500         CLOSE UPC-CSR                                            19300000
192600     END-EXEC.                                                    19310000
192700                                                                  19320000
192800     EVALUATE TRUE                                                19330000
192900         WHEN SQLCODE = +0                                        19340000
193000              CONTINUE                                            19350000
193100                                                                  19360000
193200         WHEN SQLCODE = -904                                      19370000
193300         WHEN SQLCODE = -913                                      19380000
193400              CONTINUE                                            19390000
193500                                                                  19400000
193600         WHEN SQLWARN0 NOT = SPACE                                19410000
193700         WHEN SQLCODE  NOT = +0                                   19420000
193800              MOVE '8037-CLOSE-SKU-CURSOR'                        19430000
193900                                   TO DP013-PARAGRAPH             19440000
194000              MOVE 'CLOSE UPC-CSR CURSOR'                         19450000
194100                                   TO DP013-MESSAGE-TEXT (1)      19460000
194200              MOVE SQLCA           TO DP013-SQLCA                 19470000
194300              MOVE 'XLV_UPC'       TO DP013-DB2-TABLE-NAME (1)    19480000
194400              SET DP013-DB2-ABEND  TO TRUE                        19490000
194500              PERFORM 9999-ABEND                                  19500000
194600     END-EVALUATE.                                                19510000
194700                                                                  19520000
194800*----------------------------------------------------------------*19530000
194900*    RETRIEVE OPERATION SET DESCRIPTION                          *19540000
195000*----------------------------------------------------------------*19550000
195100 8040-GET-OPER-SET-DESC.                                          19560000
195200                                                                  19570000
195300     EXEC SQL                                                     19580000
195400        SELECT  B.OPER_SET_ID                                     19590000
195500               ,C.OPER_SET_DESC                                   19600000
195600          INTO :WRKORD-OPER-SET-ID                                19610000
195700              ,:OPRSET-OPER-SET-DESC                              19620000
195800          FROM  TRECEIV A                                         19630000
195900               ,TWRKORD B                                         19640000
196000               ,TOPRSET C                                         19650000
196100         WHERE  A.ORD_NBR        = :DK-ORD-NBR                    19660000
196200           AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                19670000
196300           AND  A.VER_STATUS_CDE = 'A'                            19680000
196400           AND  B.VER_STATUS_CDE = 'A'                            19690000
196500           AND  A.ORD_NBR        = B.ORD_NBR                      19700000
196600           AND  A.REC_SEQ_NBR    = B.RCVR_SEQ_NBR                 19710000
196700           AND  B.OPER_SET_ID    = C.OPER_SET_ID                  19720000
196710           AND  C.OPER_UNT_ID    = A.CURR_OPER_UNT_ID             19730000
196800     END-EXEC.                                                    19740000
196900                                                                  19750000
197000     EVALUATE TRUE                                                19760000
197100         WHEN SQLCODE = +0                                        19770000
197200         WHEN SQLCODE = +100                                      19780000
197300         WHEN SQLCODE = -904                                      19790000
197400         WHEN SQLCODE = -913                                      19800000
197500              CONTINUE                                            19810000
197600                                                                  19820000
197700         WHEN SQLCODE = -811                                      19830000
197800             MOVE SPACES TO OPRSET-OPER-SET-DESC                  19840000
197900         WHEN SQLWARN0 NOT = SPACES                               19850000
198000         WHEN SQLCODE < +0                                        19860000
198100         WHEN SQLCODE > +0                                        19870000
198200              MOVE '8040-GET-OPER-SET-DESC'                       19880000
198300                              TO DP013-PARAGRAPH                  19890000
198400              MOVE 'UNSUCCESSFUL SELECT ON TOPRSET  '             19900000
198500                              TO DP013-MESSAGE-TEXT (1)           19910000
198600              MOVE SQLCA      TO DP013-SQLCA                      19920000
198700              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)         19930000
198800              MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (2)         19940000
198900              MOVE 'TOPRSET ' TO DP013-DB2-TABLE-NAME (3)         19950000
199000              SET DP013-DB2-ABEND TO TRUE                         19960000
199100              PERFORM 9999-ABEND                                  19970000
199200     END-EVALUATE.                                                19980000
199300                                                                  19990000
199400/                                                                 20000000
199500 8050-GET-CERT-INFO.                                              20010000
199600     INITIALIZE PV-DB2-CURRENT-DATE.                              20020000
199700                                                                  20030000
199800     EXEC SQL                                                     20040000
199900         SELECT  CURRENT DATE                                     20050000
200000           INTO  :PV-DB2-CURRENT-DATE                             20060000
200100           FROM  TVNDAGR                                          20070000
200200          WHERE  (ENT_ID        =  :PURCHS-ENT-ID                 20080000
200300            AND   DEPT_NBR      =  :PURCHS-DEPT-NBR               20090000
200400            AND   AGRMT_TYP_ID  =  '4'                            20100000
200500            AND   TYP_CDE       =  3                              20110000
200600            AND  (CHAR(CURRENT DATE, ISO)                         20120000
200700                  BETWEEN                                         20130000
200800                  CHAR(EFFECTIVE_DATE,ISO)                        20140000
200900                      AND                                         20150000
201000                  CHAR(EXPIRATION_DATE,ISO)))                     20160000
201100     END-EXEC.                                                    20170000
201200     EVALUATE TRUE                                                20180000
201300         WHEN SQLCODE = ZERO                                      20190000
201400         WHEN SQLCODE = -811                                      20200000
201500             SET PS-TVNDAGR-FOUND TO TRUE                         20210000
201600         WHEN SQLCODE = +100                                      20220000
201700             SET PS-NO-TVNDAGR    TO TRUE                         20230000
201800         WHEN SQLWARN0 NOT = SPACES                               20240000
201900         WHEN SQLCODE < ZERO                                      20250000
202000         WHEN SQLCODE > ZERO                                      20260000
202100              MOVE '8050-GET-CERT-INFO'                           20270000
202200                                     TO  DP013-PARAGRAPH          20280000
202300              MOVE 'SELECT INFO FOR THE FOLLOWING ENT-ID/DEPT: '  20290000
202400                                     TO  DP013-MESSAGE-TEXT (1)   20300000
202500              MOVE PURCHS-ENT-ID     TO  DP013-MESSAGE-TEXT (2)   20310000
202600              MOVE PURCHS-DEPT-NBR   TO  DP013-MESSAGE-TEXT (3)   20320000
202700              MOVE SQLCA             TO  DP013-SQLCA              20330000
202800              MOVE 'TVNDAGR'         TO  DP013-DB2-TABLE-NAME (1) 20340000
202900              SET DP013-DB2-ABEND TO TRUE                         20350000
203000              PERFORM 9999-ABEND                                  20360000
203100     END-EVALUATE.                                                20370000
203200                                                                  20380000
203300*----------------------------------------------------------------*20390000
203400*    LINK TO DRS                                                 *20400000
203500*----------------------------------------------------------------*20410000
203600 9000-LINK-TO-DRS.                                                20420000
203700     CONTINUE.                                                    20430000
203800                                                                  20440000
203900     EXEC CICS                                                    20450000
204000         LINK                                                     20460000
204100             PROGRAM  ('DRS1INTC')                                20470000
204200             COMMAREA (DRS01-COMMAREA)                            20480000
204300     END-EXEC.                                                    20490000
204400                                                                  20500000
204500     EVALUATE TRUE                                                20510000
204600         WHEN DRS01-DRRB-RC = 0                                   20520000
204700             CONTINUE                                             20530000
204800                                                                  20540000
204900         WHEN OTHER                                               20550000
205000             MOVE '9000-LINK-TO-DRS'                              20560000
205100                                 TO DP013-PARAGRAPH               20570000
205200             SET DP013-OTHER-ABEND                                20580000
205300                                 TO TRUE                          20590000
205400             MOVE DRS01-DRRB-FUNC                                 20600000
205500                                 TO PV-DRS-DRRB-FUNC              20610000
205600             MOVE DRS01-DRRB-RID TO PV-DRS-DRRB-RID               20620000
205700             MOVE DRS01-DRRD-OPTIONS                              20630000
205800                                 TO PV-DRS-DRRB-OPTIONS           20640000
205900             MOVE DRS01-DRRB-RC  TO PV-DRS-DRRB-RC                20650000
206000             MOVE DRS01-DRRB-ATTR-ERROR                           20660000
206100                                 TO PV-DRS-ATTR-ERROR             20670000
206200             MOVE DRS01-DRRB-DRDC                                 20680000
206300                                 TO PV-DRS-DRRB-DRDC              20690000
206400             MOVE DRS01-DRRB01-LINES                              20700000
206500                                 TO PV-DRS-DRRB-LINES             20710000
206600             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      20720000
206700                                 TO DP013-MESSAGE-TEXT (1)        20730000
206800             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      20740000
206900                                 TO DP013-MESSAGE-TEXT (2)        20750000
207000             PERFORM 9999-ABEND                                   20760000
207100     END-EVALUATE.                                                20770000
207200                                                                  20780000
207300/                                                                 20790000
207400 9999-ABEND.                                                      20800000
207500                                                                  20810000
207600     MOVE 'RCKCS237'             TO DP013-PROGRAM.                20820000
207700     MOVE DFHEIBLK               TO DP013-DFHEIBLK.               20830000
207800                                                                  20840000
207900*    IF FROM THE PRINT PACKAGE, THE LINK-RETURN WILL RETURN       20850000
208000*    CONTROL FROM THE ABEND ROUTINE.  CONTROL WILL THEN BE        20860000
208100*    RETURNED TO THE PRINT PACKAGE WITH THE "RETURN" BELOW.  IF   20870000
208200*    NOT, THE RETURN WILL JUST RETURN TO NATIVE CICS              20880000
208300                                                                  20890000
208400     SET DP013-LINK-RETURN       TO TRUE.                         20900000
208500     SET DP013-NO-ROLLBACK       TO TRUE.                         20910000
208600                                                                  20920000
208700     INITIALIZE                     DP013-SRC-TASK-NUMBER         20930000
208800                                    DP013-STACK.                  20940000
208900                                                                  20950000
209000     EXEC CICS                                                    20960000
209100         LINK PROGRAM  (DP013-NAME)                               20970000
209200              COMMAREA (DP013-PARAMETERS)                         20980000
209300              LENGTH   (DP013-LENGTH)                             20990000
209400     END-EXEC.                                                    21000000
209500                                                                  21010000
209600     EXEC CICS                                                    21020000
209700         RETURN                                                   21030000
209800     END-EXEC.                                                    21040000
209900                                                                  21050000
