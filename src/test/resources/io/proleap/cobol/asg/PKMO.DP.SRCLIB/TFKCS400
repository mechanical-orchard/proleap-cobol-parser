      ******************************************************************00050099
       IDENTIFICATION DIVISION.                                         00060099
      ******************************************************************00070099
                                                                        00080099
       PROGRAM-ID.       TFKCS400.                                      00090099
       AUTHOR.           DAVE WELLER.                                   00100099
       INSTALLATION.     KOHLS.                                         00110099
       DATE-WRITTEN      OCTOBER, 2004.                                 00120099
       DATE-COMPILED.                                                   00130099
                                                                        00140099
      ******************************************************************00152099
      * THIS PROGRAM RECEIVES FROM AND SENDS DATA STREAMS TO A TELXON   00153099
      * PORTABLE TELE-TRANSACTION COMPUTER (PTC).  THE RECEIVED DATA    00154099
      * IS A REQUEST FOR INFORMATION REGARDING A PARTICULAR TRANSFER.   00155099
      * THE TRANSMIT DATA IS THE RESPONSE TO THAT REQUEST.              00156099
      ******************************************************************00157099
021605* 02/16/2005 DAVE WELLER STANDARDIZE USAGE OF TFWS007             00157199
021605******************************************************************00157299
051705*  DATE 05/17/05 RAY GRAF                                         00157399
051705*  REMOVE PHYSICAL INVENTORY LOGIC                                00157499
051705******************************************************************00157599
060110*  DATE 06/01/10 JACKIE HELING                                    00157699
060110*  BLOCK CERTAIN LOCATIONS FROM SENDING/RECEIVING TRANSFERS.      00157799
      ***************************************************************** 00157899
033111* WR39649 -  DAVID WELLER - 03/31/2011                            00157999
033111*            MLOF - DO NOT EXCLUDE LOCATIONS 807, 808 AND 809     00158099
033111***************************************************************** 00158199
022212* PR 3403 -  CHERI PARMLEY - 02/22/2012                           00158299
022212*            REMOVE TTFITRC NOT USED - COMPILE FOR TTFITEM        00158399
022212*            AND TTFITRC TABLE CHANGES                            00158499
022212***************************************************************** 00158599
                                                                        00158699
      ******************************************************************00159099
       ENVIRONMENT DIVISION.                                            00160099
      ******************************************************************00170099
                                                                        00180099
      ******************************************************************00190099
       DATA DIVISION.                                                   00200099
      ******************************************************************00210099
                                                                        00220099
      ******************************************************************00230099
       WORKING-STORAGE SECTION.                                         00240099
      ******************************************************************00250099
                                                                        00260099
      *                                                                 00270099
      *  RECORD LAYOUT BEING TRANSMITTED FROM THE PTC                   00280099
      *                                                                 00290099
           COPY TFRD047.                                                00300099
                                                                        00310099
      *                                                                 00320099
      *  RECORD LAYOUT BEING TRANSMITTED TO THE PTC                     00330099
      *                                                                 00340099
           COPY TFRD048.                                                00350099
                                                                        00360099
060110*                                                                 00361099
060110*  LIST OF LOCATION EXCLUSIONS                                    00362099
060110*                                                                 00363099
060110     COPY TFWS010.                                                00364099
                                                                        00365099
      *                                                                 00370099
      *  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00380099
      *                                                                 00390099
           COPY DPWS013.                                                00400099
                                                                        00410099
      *                                                                 00420099
      *  LISTENER QUEUE NAMES                                           00430099
      *                                                                 00440099
           COPY RFWS001.                                                00450099
                                                                        00460099
      *                                                                 00470099
      *  RECORD LAYOUT FOR SYSTEM MESSAGES FILE USED FOR CICS MESSAGES  00480099
      *                                                                 00490099
           COPY DPRD507I.                                               00500099
                                                                        00510099
      *                                                                 00520099
      *  FORMATS CICS SYSTEM MESSAGES FOR NON-ARCHITECTURE PROGRAMS     00530099
      *                                                                 00540099
           COPY DPWS011.                                                00550099
                                                                        00560099
      *                                                                 00570099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOC TABLE          00580099
      *                                                                 00590099
           EXEC SQL                                                     00600099
               INCLUDE XST00001                                         00610099
           END-EXEC.                                                    00620099
                                                                        00630099
      *                                                                 00640099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER RECEIPT   00650099
      *  TABLE                                                          00660099
      *                                                                 00670099
           EXEC SQL                                                     00680099
               INCLUDE TTFRCPT                                          00690099
           END-EXEC.                                                    00700099
                                                                        00710099
      *                                                                 00720099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER           00730099
      *  DISCREPANCY TABLE                                              00740099
      *                                                                 00750099
           EXEC SQL                                                     00760099
               INCLUDE TTFDSCP                                          00770099
           END-EXEC.                                                    00780099
                                                                        00790099
      *                                                                 00800099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER TABLE     00810099
      *                                                                 00820099
           EXEC SQL                                                     00830099
               INCLUDE TTFMSTR                                          00840099
           END-EXEC.                                                    00850099
                                                                        00860099
      *                                                                 00870099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER ITEM TABLE00880099
      *                                                                 00890099
           EXEC SQL                                                     00900099
               INCLUDE TTFITEM                                          00910099
           END-EXEC.                                                    00920099
                                                                        00930099
      *                                                                 00940099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER STATUS    00950099
      *  CODE TABLE                                                     00960099
      *                                                                 00970099
           EXEC SQL                                                     00980099
               INCLUDE TTFSTCD                                          00990099
           END-EXEC.                                                    01000099
                                                                        01010099
      *                                                                 01020099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER TYPE CODE 01030099
      *  TABLE                                                          01040099
      *                                                                 01050099
           EXEC SQL                                                     01060099
               INCLUDE TTFTYCD                                          01070099
           END-EXEC.                                                    01080099
                                                                        01090099
      *                                                                 01100099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER CONTAINER 01110099
      *  TYPE CODE TABLE                                                01120099
      *                                                                 01130099
           EXEC SQL                                                     01140099
               INCLUDE TTFSHCT                                          01150099
           END-EXEC.                                                    01160099
                                                                        01170099
      *                                                                 01180099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER STATUS    01190099
      *  CODE TABLE                                                     01200099
      *                                                                 01210099
           EXEC SQL                                                     01220099
               INCLUDE TTFSTAT                                          01230099
           END-EXEC.                                                    01240099
                                                                        01250099
      *                                                                 01260099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CUSTOMER TRANSFER  01270099
      *  TABLE                                                          01280099
      *                                                                 01290099
           EXEC SQL                                                     01300099
               INCLUDE TTFCUST                                          01310099
           END-EXEC.                                                    01320099
                                                                        01330099
      *                                                                 01420099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE TRANSFER           01430099
      *  CONTROL TABLE                                                  01440099
      *                                                                 01450099
051705*    EXEC SQL                                                     01460099
051705*        INCLUDE TTFCNTL                                          01470099
051705*    END-EXEC.                                                    01480099
                                                                        01490099
      *                                                                 01500099
      *  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INVENTORY          01510099
      *  PARAMETERS TABLE                                               01520099
      *                                                                 01530099
051705*    EXEC SQL                                                     01540099
051705*        INCLUDE TINVPAR                                          01550099
051705*    END-EXEC.                                                    01560099
                                                                        01570099
      *                                                                 01580099
      *  COMMUNICATIONS AREA FOR DB2                                    01590099
      *                                                                 01600099
           EXEC SQL                                                     01610099
               INCLUDE SQLCA                                            01620099
           END-EXEC.                                                    01630099
                                                                        01640099
       01  WS-MQCONN               PIC X(8)  VALUE 'CSQCCONN'.          01650099
       01  WS-MQOPEN               PIC X(8)  VALUE 'CSQCOPEN'.          01660099
       01  WS-MQINQ                PIC X(8)  VALUE 'CSQCINQ'.           01670099
       01  WS-MQGET                PIC X(8)  VALUE 'CSQCGET'.           01680099
       01  WS-MQPUT1               PIC X(8)  VALUE 'CSQCPUT1'.          01690099
       01  WS-MQPUT                PIC X(8)  VALUE 'CSQCPUT'.           01700099
       01  WS-MQBACK               PIC X(8)  VALUE 'CSQCBACK'.          01710099
       01  WS-MQCMIT               PIC X(8)  VALUE 'CSQCCOMM'.          01720099
       01  WS-MQCLOSE              PIC X(8)  VALUE 'CSQCCLOS'.          01730099
       01  WS-MQDISC               PIC X(8)  VALUE 'CSQCDISC'.          01740099
                                                                        01750099
      *    API CONTROL BLOCKS                                           01760099
                                                                        01770099
       01  MQM-OBJECT-DESCRIPTOR.                                       01780099
           COPY CMQODV.                                                 01790099
       01  MQM-MESSAGE-DESCRIPTOR.                                      01800099
           COPY CMQMDV.                                                 01810099
       01  MQM-GET-MESSAGE-OPTIONS.                                     01820099
           COPY CMQGMOV.                                                01830099
       01  MQM-PUT-MESSAGE-OPTIONS.                                     01840099
           COPY CMQPMOV.                                                01850099
                                                                        01860099
      *    MQV CONTAINS CONSTANTS (FOR FILLING IN THE CONTROL BLOCKS)   01870099
      *    AND RETURN CODES (FOR TESTING THE RESULT OF A CALL)          01880099
                                                                        01890099
       01  MQM-CONSTANTS.                                               01900099
           COPY CMQV.                                                   01910099
      *                                                                 01920099
      **---------------------------------------------------------------*01930099
      **  VARIABLES REQUIRED FOR THE USE OF THE LOG MESSAGE ROUTINE    *01940099
      **  (EPPD000)                                                    *01950099
      **---------------------------------------------------------------*01960099
                                                                        01970099
           COPY EPWS000.                                                01980099
021605     COPY TFWS007.                                                01981099
                                                                        01990099
      *                                                                 02000099
       01  DK-DB2-KEYS.                                                 02010099
           05  DK-LOC-NBR                      PIC S9(04)  VALUE ZEROS  02040099
                                                           COMP SYNC.   02050099
           05  DK-LOC-NBR-DISPLAY              PIC ZZZZ9   VALUE ZEROS. 02051099
           05  DK-FR-LOC-NBR                   PIC S9(04)  VALUE ZEROS  02060099
                                                           COMP SYNC.   02070099
           05  DK-XFER-SEQ-NBR                 PIC S9(09)  VALUE ZEROS  02080099
                                                           COMP SYNC.   02090099
      *                                                                 02100099
       01  PC-PROGRAM-CONSTANTS.                                        02110099
           05  PC-ERROR-CODE                   PIC  X(01)  VALUE 'E'.   02120099
           05  PC-DUMMY-UPC                    PIC  X(03)  VALUE '000'. 02130099
           05  PC-811                          PIC  9(04)  VALUE 0811.  02140099
           05  PC-801                          PIC  9(04)  VALUE 0801.  02150099
           05  PC-MENOMONEE-FALLS-DC           PIC  9(04)  VALUE 0085.  02160099
           05  PC-FINDLAY-DC                   PIC  9(04)  VALUE 0810.  02170099
           05  PC-COMPLETED                    PIC  X(02)  VALUE 'CM'.  02180099
           05  PC-ASSUMPTIVELY-RECEIVED        PIC  X(02)  VALUE 'AR'.  02190099
           05  PC-INTERMEDIATELY-RECEIVED      PIC  X(02)  VALUE 'IR'.  02200099
           05  PC-VOIDED                       PIC  X(02)  VALUE 'VD'.  02210099
           05  PC-HAND-CARRY                   PIC  X(02)  VALUE '05'.  02310099
           05  PC-YES                          PIC  X(01)  VALUE 'Y'.   02320099
           05  PC-NO                           PIC  X(01)  VALUE 'N'.   02330099
           05  PC-RTV                          PIC  X(02)  VALUE 'RV'.  02340099
           05  PC-DEPT-STR                     PIC  X(02)  VALUE 'DS'.  02350099
           05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        02370099
               'TFKCS400'.                                              02380099
051705*    05  PC-MAX-DATE                 PIC X(10) VALUE '9999-09-09'.02390099
051705*    05  PC-MIN-DATE                 PIC X(10) VALUE '0001-01-01'.02400099
           05  PC-MAX-ITEMS                    PIC S9(09)  VALUE        02410099
                                                           +1000000     02420099
                                                           COMP-3.      02430099
                                                                        02440099
           05  PC-TSYMSG-NUMBERS.                                       02450099
      *  RESOURCE IS UNAVAILABLE; PLEASE TRY AGAIN LATER                02460099
               10  PC-TSYMSG-01063             PIC  9(05)  VALUE  01063.02470099
      *  STORE NUMBER NOT FOUND                                         02480099
               10  PC-TSYMSG-00594             PIC  9(05)  VALUE  00594.02490099
      *  DATA IS UNAVAILABLE; PLEASE CONTACT THE IS HELP DESK           02500099
               10  PC-TSYMSG-01064             PIC  9(05)  VALUE  01064.02510099
      *  TRANSFER NOT FOUND                                             02520099
               10  PC-TSYMSG-01442             PIC  9(05)  VALUE  01442.02530099
      *  TRANSFER UNABLE TO BE RECEIVED...CURRENT STATUS IS &VAR        02540099
               10  PC-TSYMSG-01443             PIC  9(05)  VALUE  01443.02550099
      *  TRANSFER IS CURRENTLY BEING RECEIVED                           02560099
               10  PC-TSYMSG-01444             PIC  9(05)  VALUE  01444.02570099
060110*  TO STORE INVALID                                               02571099
060110         10  PC-TSYMSG-01479             PIC  9(05)  VALUE  01479.02572099
      *  THIS STORE CANNOT RECEIVE ITS OWN COMPLETED TRANSFER           02580099
               10  PC-TSYMSG-01516             PIC  9(05)  VALUE  01516.02590099
      *  YOU CANNOT RECEIVE OFFSITE STORAGE OF STORE &VAR               02600099
               10  PC-TSYMSG-01531             PIC  9(05)  VALUE  01531.02610099
060110*  YOU ARE NOT ALLOWED TO COMPLETE A TRANSFER IN THIS LOCATION    02611099
060110         10  PC-TSYMSG-01539             PIC  9(05)  VALUE  01539.02612099
      *  CANNOT PROCESS AFTER INVENTORY TRANSFER UNTIL AFTER: --        02620099
               10  PC-TSYMSG-01614             PIC  9(05)  VALUE  01614.02630099
      *  CANNOT PROCESS BEFORE INVENTORY TRANSFER - CALL INV CONTROL    02640099
               10  PC-TSYMSG-01615             PIC  9(05)  VALUE  01615.02650099
      *  CANNOT PROCESS AFTER INVENTORY TRANSFER - CALL INV CONTROL     02660099
               10  PC-TSYMSG-01660             PIC  9(05)  VALUE  01660.02670099
           05  PC-DUMMY-UPC-MSG                PIC  X(43)               02671099
               VALUE 'MUST RECEIVE TRANSFER WITH DUMMY UPC ON CRT'.     02672099
                                                                        02673099
       01  PH-PROGRAM-HOLD-VARIABLES.                                   02674099
           05  PH-COMPLETION-CODE          PIC  S9(09) BINARY.          02675099
           05  PH-REASON                   PIC  S9(09) BINARY.          02676099
      *                                                                 02677099
       01  PS-PROGRAM-SWITCHES.                                         02678099
           05  PS-XFER-FOUND-IND               PIC  X(01)  VALUE 'N'.   02679099
               88  PS-XFER-NOT-FOUND                       VALUE 'N'.   02680099
               88  PS-XFER-FOUND                           VALUE 'Y'.   02690099
           05  PS-END-OF-XFER-ITM-IND          PIC  X(01)  VALUE 'N'.   02700099
               88  PS-MORE-XFER-ITM-DATA                   VALUE 'N'.   02710099
               88  PS-END-OF-XFER-ITM-DATA                 VALUE 'Y'.   02720099
           05  PS-END-OF-DETAIL-DATA-IND       PIC  X(01)  VALUE 'N'.   02730099
               88  PS-MORE-DETAIL-DATA                     VALUE 'N'.   02740099
               88  PS-END-OF-DETAIL-DATA                   VALUE 'Y'.   02750099
           05  PS-FOUND-DUMMY-UPC-IND          PIC  X(01)  VALUE 'N'.   02760099
               88  PS-FOUND-DUMMY-UPC-N                    VALUE 'N'.   02770099
               88  PS-FOUND-DUMMY-UPC-Y                    VALUE 'Y'.   02780099
051705*    05  PS-INVENTORY-ERROR-IND          PIC  X(01)  VALUE 'N'.   02790099
051705*        88  PS-NO-INVENTORY-ERROR                   VALUE 'N'.   02800099
051705*        88  PS-INVENTORY-ERROR                      VALUE 'Y'.   02810099
           05  PS-MQPUT-SUCCESSFUL-IND         PIC  X(01)  VALUE 'N'.   02820099
               88 PS-MQPUT-SUCCESSFUL                      VALUE 'Y'.   02830099
      *                                                                 02840099
       01  PV-PROGRAM-VARIABLES.                                        02850099
           05  PV-QMGR-NAME            PIC X(04) VALUE SPACES.          02860099
               88  PV-PROD-QMGR-NAME             VALUE 'QKSP'.          02870099
               88  PV-TEST-QMGR-NAME             VALUE 'QKST'.          02880099
               88  PV-QA-QMGR-NAME               VALUE 'QKSQ'.          02890099
           05  PV-QM-NAME              PIC X(48).                       02900099
           05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        02910099
           05  PV-OPEN-OPTIONS         PIC S9(9) BINARY VALUE 0.        02920099
           05  PV-COMPLETION-CODE      PIC S9(9) BINARY VALUE 0.        02930099
           05  PV-REASON               PIC S9(9) BINARY VALUE 0.        02940099
           05  PV-CON-REASON           PIC S9(9) BINARY VALUE 0.        02950099
           05  PV-PQ-HANDLE            PIC S9(9) BINARY VALUE 0.        02960099
           05  PV-FMT-OPEN-OUTPUT-HNDL PIC S9(9) BINARY VALUE 0.        02970099
           05  PV-ERROR-MESSAGE        PIC X(48)  VALUE SPACES.         02980099
           05  PV-DATA-LENGTH          PIC S9(9) BINARY.                02990099
           05  PV-MSGBUFFER            PIC X(1000000) VALUE SPACES.     03000099
                                                                        03010099
           05  PV-CURRENT-TIMESTAMP            PIC  X(26)  VALUE SPACE. 03020099
           05  PV-TO-LOC-NBR                   PIC  9(05)  VALUE ZEROS. 03030099
           05  PV-NULL-IND                     PIC S9(04)  VALUE ZEROS  03040099
                                                           COMP SYNC.   03050099
           05  PV-XFER-TOT-QTY                 PIC S9(09)  VALUE ZEROS  03060099
                                                           COMP SYNC.   03070099
           05  PV-XFER-TOT-RTL                 PIC S9(07)V9(2)          03080099
                                                           VALUE ZEROS  03090099
                                                           COMP-3.      03100099
           05  PV-READ-COUNT                   PIC S9(09)  VALUE +0     03110099
                                                           COMP-3.      03110199
           05  PV-HOLD-UPC-NBR.                                         03110299
               10  FILLER                      PIC X(02).               03110399
               10  PV-KOHLS-UPC-DIGITS         PIC X(04).               03110499
               10  PV-KOHLS-DEPT               PIC X(03).               03110599
               10  PV-KOHLS-CL.                                         03110699
                   15  PV-KOHLS-CL-1           PIC X(01).               03110799
                   15  PV-KOHLS-CL-2           PIC X(01).               03110899
               10  PV-KOHLS-CL-9 REDEFINES PV-KOHLS-CL                  03110999
                                               PIC 9(02).               03111099
               10  PV-KOHLS-DUMMY-SKU          PIC X(03).               03112099
               10  PV-KOHLS-CHECKDIGIT         PIC X(01).               03113099
           05  PV-HOLD-UPC-NBR-9 REDEFINES PV-HOLD-UPC-NBR              03114099
                                               PIC 9(15).               03115099
           05  PV-DISPLAY-XFER-DOC-NBR.                                 03116099
               10  PV-DISPLAY-FR-LOC-NBR       PIC  9(05)  VALUE ZEROS. 03117099
               10  FILLER                      PIC  X(01)  VALUE '-'.   03118099
               10  PV-DISPLAY-FR-STR-SEQ-NBR   PIC  9(06)  VALUE ZEROS. 03119099
           05  PV-DISPLAY-XFER-DKEY-ID         PIC  9(09)  VALUE ZEROS. 03120099
           05  PV-DISPLAY-XFER-LNE-NBR         PIC  9(04)  VALUE ZEROS. 03140099
           05  PV-ITEM-NBR                     PIC S9(04)  VALUE ZEROS  03150099
                                                           COMP SYNC.   03160099
           05  PV-TSQ-LENGTH                   PIC S9(04)  VALUE ZEROS  03170099
                                                           COMP SYNC.   03180099
           05  PV-TSQ-NAME                     PIC  X(08)  VALUE        03190099
               'TCPIPPRQ'.                                              03200099
           05  PV-TCPIPPRQ-RECORD1.                                     03210099
               10  PV-NEXT-RECORD              PIC  9(08)  VALUE ZEROS. 03220099
               10  PV-TOTAL-RECORDS            PIC  9(08)  VALUE ZEROS. 03230099
               10  FILLER                      PIC X(4104) VALUE SPACE. 03240099
           05  PV-TCPIPPRQ-RECORD2.                                     03250099
               10  PV-CURRENT-RECORD           PIC  9(08)  VALUE ZEROS. 03260099
               10  FILLER                      PIC X(4112) VALUE SPACE. 03270099
           05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  03280099
                                                           COMP SYNC.   03290099
                                                                        03570099
           EXEC SQL                                                     03580099
               DECLARE TOT_QTY_RTL_CSR CURSOR FOR                       03590099
                   SELECT  XFER_PRIC_AMT,                               03600099
                           XFER_QTY                                     03610099
                     FROM  TTFITEM                                      03620099
                    WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID)      03630099
                    WITH UR                                             03631099
           END-EXEC.                                                    03640099
                                                                        03650099
      *                                                                 03660099
      *  SQL DB2 ITEM DETAIL CURSOR DECLARATION                         03670099
      *                                                                 03680099
           EXEC SQL                                                     03690099
               DECLARE ITM_DTL_CSR CURSOR FOR                           03700099
                   SELECT  XFER_LNE_NBR,                                03710099
                           SCN_UPC_NBR                                  03720099
                     FROM  TTFITEM                                      03730099
                    WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID)      03740099
                 ORDER BY  XFER_LNE_NBR                                 03750099
                 WITH UR                                                03751099
           END-EXEC.                                                    03760099
      *                                                                 03770099
      ******************************************************************03780099
       PROCEDURE DIVISION.                                              03790099
      ******************************************************************03800099
       0000-PROGRAM-MAINLINE.                                           03810099
           INITIALIZE TF048-XFER-TO-PTC-RECORD.                         03820099
                                                                        03830099
           PERFORM 1000-RETRIEVE-TEXT.                                  03840099
                                                                        03850099
           PERFORM 2000-PROCESS-PTC-REQUEST.                            03860099
                                                                        03870099
           GOBACK.                                                      03880099
      *                                                                 03890099
       1000-RETRIEVE-TEXT.                                              03900099
           EXEC CICS                                                    03910099
               RETRIEVE                                                 03920099
                   INTO  (TF047-XFER-FROM-PTC-RECORD)                   03930099
                   RESP  (PV-CICS-RESPONSE)                             03940099
           END-EXEC.                                                    03950099
                                                                        03960099
           EVALUATE TRUE                                                03970099
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03980099
                   CONTINUE                                             03990099
               WHEN OTHER                                               04000099
                   MOVE '1000-RETRIEVE-TEXT'                            04010099
                                   TO DP013-PARAGRAPH                   04011099
                   MOVE 'UNABLE TO RECEIVE TEXT'                        04020099
                                   TO DP013-MESSAGE-TEXT (1)            04030099
                   MOVE  TF047-XFER-FROM-PTC-RECORD                     04040099
                                   TO DP013-MESSAGE-TEXT (2)            04050099
                   SET DP013-CICS-ABEND                                 04060099
                       DP013-NO-ROLLBACK                                04070099
                                   TO TRUE                              04071099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      04080099
                   SET DP011-MSG-FATAL                                  04090099
                                   TO TRUE                              04091099
                   MOVE PC-TSYMSG-01064                                 04100099
                                   TO DP011-MSG-NUMBER                  04101099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      04110099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   04120099
           END-EVALUATE.                                                04130099
                                                                        04140099
           MOVE TF047-LISTENER-CODE                                     04150099
                                   TO PV-QUEUE-PARM.                    04151099
                                                                        04160099
           IF  PV-VALID-PARM                                            04170099
               MOVE PV-QUEUE-NAME(PV-QUEUE-PARM-N)                      04180099
                                   TO PV-TSQ-NAME                       04181099
                                                                        04190099
           ELSE                                                         04200099
               MOVE '1000-RETRIEVE-TEXT'                                04210099
                                   TO DP013-PARAGRAPH                   04211099
               MOVE 'INVALID PARM VALUE'                                04220099
                                   TO DP013-MESSAGE-TEXT (1)            04221099
               MOVE 'PARM VALUE = '                                     04230099
                                   TO DP013-MESSAGE-TEXT (2)            04231099
               MOVE TF047-LISTENER-CODE                                 04240099
                                   TO DP013-MESSAGE-TEXT (3)            04241099
                                                                        04250099
               SET DP013-LOGIC-ABEND                                    04260099
                   DP013-NO-ROLLBACK                                    04270099
                                   TO TRUE                              04271099
                                                                        04280099
               PERFORM 9999-WRITE-CICS-LOG-MSG                          04290099
                                                                        04300099
               SET DP011-MSG-FATAL TO TRUE                              04310099
                                                                        04320099
               MOVE PC-TSYMSG-01064                                     04330099
                                   TO DP011-MSG-NUMBER                  04331099
                                                                        04340099
               PERFORM 9000-FMT-ERR-MSG-TO-PTC                          04350099
               PERFORM 8000-SEND-DATA-TO-LISTENER                       04360099
           END-IF.                                                      04370099
      *                                                                 04380099
       2000-PROCESS-PTC-REQUEST.                                        04390099
           PERFORM 7000-SELECT-XFER.                                    04400099
                                                                        04410099
           IF PS-XFER-FOUND                                             04420099
               SET TF048-CONTINUE-PROCESSING                            04430099
                                   TO TRUE                              04431099
               PERFORM 2100-PROCESS-XFER                                04440099
           ELSE                                                         04450099
               SET DP011-MSG-FATAL TO TRUE                              04461099
               MOVE PC-TSYMSG-01442                                     04470099
                                   TO DP011-MSG-NUMBER                  04471099
               PERFORM 9000-FMT-ERR-MSG-TO-PTC                          04480099
           END-IF.                                                      04490099
                                                                        04500099
           PERFORM 8000-SEND-DATA-TO-LISTENER.                          04510099
      *                                                                 04520099
       2100-PROCESS-XFER.                                               04530099
      *************************************************************     04540099
      **** DO NOT ALLOW THE RECEIVING OF TRANSFER IF ANY                04550099
      **** DUMMY UPC'S EXIST.  INSTEAD, MUST RECEIVE ON CRT             04560099
      *************************************************************     04570099
           PERFORM 4010-OPEN-ITEM-DETAIL-CURSOR.                        04580099
           PERFORM 4300-READ-ITEMS-FROM-DB.                             04581099
           PERFORM 4020-CLOSE-ITEM-DETAIL-CURSOR.                       04582099
           IF PS-FOUND-DUMMY-UPC-Y                                      04583099
               MOVE SPACES         TO  TF048-PROCESSING-IND             04583199
               MOVE PC-ERROR-CODE  TO  TF048-ERR-TYP-IND                04583299
               MOVE PC-DUMMY-UPC-MSG                                    04583399
                                   TO  TF048-ERR-MSG                    04583499
               PERFORM 8000-SEND-DATA-TO-LISTENER                       04583599
           END-IF.                                                      04583699
                                                                        04583799
060110     MOVE TF047-LOC-NBR  TO  PV-LOC-EXCLUDE                       04583899
060110     IF PV-EXCLUDE                                                04583999
060110        SET DP011-MSG-FATAL  TO TRUE                              04584099
060110        MOVE PC-TSYMSG-01539 TO  DP011-MSG-NUMBER                 04584199
060110        PERFORM 9000-FMT-ERR-MSG-TO-PTC                           04584299
060110        PERFORM 8000-SEND-DATA-TO-LISTENER                        04584399
060110     END-IF.                                                      04584499
                                                                        04584599
               IF TF047-LOC-NBR  =  PC-FINDLAY-DC                       04630099
                   IF (TFMSTR-XFER-TYP-CDE  =                           04660099
021605                     TF007-DEFECTIVES-DAMAGES-SORT1               04670099
                       OR                                               04680099
                       TFMSTR-XFER-TYP-CDE  =                           04681099
021605                         TF007-DEFECTIVES-DAMAGES-SORT2           04682099
                       OR                                               04683099
021605                 TFMSTR-XFER-TYP-CDE  =  TF007-CALLBACK)          04684099
                       MOVE PC-811 TO  TF047-LOC-NBR                    04685099
                   END-IF                                               04686099
060110         END-IF.                                                  04687199
                                                                        04689099
021605     IF TFMSTR-XFER-TYP-CDE  =  TF007-OFFSITE-STORAGE             04690099
               IF TFMSTR-FR-STR-NBR  NOT =  TF047-LOC-NBR               04700099
                   MOVE TFMSTR-FR-STR-NBR                               04710099
                                   TO  DK-LOC-NBR-DISPLAY               04711099
                   MOVE DK-LOC-NBR-DISPLAY                              04720099
                                   TO  DP011-MSG-TEXT                   04721099
                   SET DP011-MSG-FATAL                                  04730099
                                   TO  TRUE                             04731099
                   MOVE PC-TSYMSG-01531                                 04740099
                                   TO  DP011-MSG-NUMBER                 04741099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      04750099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   04760099
               END-IF                                                   04770099
           ELSE                                                         04780099
               IF TFMSTR-FR-STR-NBR  =  TF047-LOC-NBR                   04790099
                   SET DP011-MSG-FATAL                                  04800099
                                   TO  TRUE                             04801099
                   MOVE PC-TSYMSG-01516                                 04810099
                                   TO  DP011-MSG-NUMBER                 04811099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      04820099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   04830099
               END-IF                                                   04840099
           END-IF.                                                      04850099
                                                                        04860099
           PERFORM 2110-CHK-XFER-STATUS.                                04870099
                                                                        04880099
           IF TFSTAT-XFER-STAT-CDE  NOT =  PC-ASSUMPTIVELY-RECEIVED     04890099
               PERFORM 2120-CHK-XFER-IN-USE                             04900099
           END-IF.                                                      04910099
                                                                        05230099
           PERFORM 7250-SELECT-CURRENT-TIMESTAMP.                       05240099
           PERFORM 7300-INSERT-XFER-RECEIPT-ROW.                        05250099
           PERFORM 7350-INSERT-XFER-IR-STAT-ROW.                        05260099
                                                                        05270099
           MOVE TFMSTR-TO-STR-NBR  TO  PV-TO-LOC-NBR.                   05350099
           IF TF047-LOC-NBR  NOT =  PV-TO-LOC-NBR                       05360099
               PERFORM 2130-PROCESS-DISCREPANCY                         05370099
           END-IF.                                                      05380099
                                                                        05390099
060110     MOVE TFMSTR-TO-STR-NBR  TO  PV-LOC-EXCLUDE                   05391099
060110     IF PV-EXCLUDE                                                05392099
060110        SET DP011-MSG-FATAL  TO TRUE                              05393199
060110        MOVE PC-TSYMSG-01479 TO  DP011-MSG-NUMBER                 05393399
060110        PERFORM 9000-FMT-ERR-MSG-TO-PTC                           05393599
060110        PERFORM 8000-SEND-DATA-TO-LISTENER                        05393699
060110     END-IF.                                                      05394099
                                                                        05395099
           IF (TF048-CONTINUE-PROCESSING                                05400099
                     OR                                                 05410099
               TF048-WARNING-PROCESSING)                                05420099
               PERFORM 2140-FILL-XFER-TO-PTC-RECORD                     05430099
           ELSE                                                         05440099
               MOVE TFMSTR-XFER-DKEY-ID                                 05450099
                                   TO  TF048-XFER-DKEY                  05451099
           END-IF.                                                      05460099
      *                                                                 05470099
       2110-CHK-XFER-STATUS.                                            05480099
           PERFORM 7050-SELECT-MAX-STAT-TMST.                           05490099
           PERFORM 7100-SELECT-CURRENT-STATUS.                          05500099
                                                                        05510099
           EVALUATE TFSTAT-XFER-STAT-CDE                                05520099
               WHEN PC-COMPLETED                                        05530099
               WHEN PC-INTERMEDIATELY-RECEIVED                          05540099
               WHEN PC-ASSUMPTIVELY-RECEIVED                            05550099
                   CONTINUE                                             05560099
               WHEN PC-VOIDED                                           05570099
                   SET TF048-VOID-PROCESSING                            05580099
                                   TO  TRUE                             05581099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   05590099
               WHEN OTHER                                               05600099
                   MOVE TFSTCD-XFER-STAT-DESC                           05610099
                                   TO  DP011-MSG-TEXT                   05611099
                   SET DP011-MSG-FATAL                                  05620099
                                   TO  TRUE                             05621099
                   MOVE PC-TSYMSG-01443                                 05630099
                                   TO  DP011-MSG-NUMBER                 05631099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      05640099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   05650099
           END-EVALUATE.                                                05660099
      *                                                                 05670099
       2120-CHK-XFER-IN-USE.                                            05680099
           PERFORM 7150-SELECT-MAX-RCPT-TMST.                           05690099
                                                                        05700099
           IF PV-NULL-IND IS NOT NEGATIVE                               05710099
               PERFORM 7200-SELECT-CURRENT-RCPT                         05720099
               IF TFRCPT-RCV-XFER-BEG-TMST  =  TFRCPT-RCV-XFER-END-TMST 05730099
                   SET  DP011-MSG-FATAL                                 05740099
                                   TO  TRUE                             05741099
                   MOVE PC-TSYMSG-01444                                 05750099
                                   TO  DP011-MSG-NUMBER                 05751099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      05760099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   05770099
               END-IF                                                   05780099
           END-IF.                                                      05790099
      *                                                                 05800099
       2130-PROCESS-DISCREPANCY.                                        05810099
           PERFORM 7500-INSERT-DISCREPANCY-ROW.                         05820099
                                                                        05830099
           EVALUATE TFMSTR-XFER-TYP-CDE                                 05840099
021605         WHEN TF007-DEFECTIVES-DAMAGES-SORT1                      05860099
021605         WHEN TF007-DEFECTIVES-DAMAGES-SORT2                      05870099
021605         WHEN TF007-CALLBACK                                      05880099
                   PERFORM 7550-SELECT-RECEIVING-LOC                    05890099
                   IF XST00001-LOC-TYP-CDE = PC-RTV                     05900099
                       SET TF048-WARNING-PROCESSING                     05910099
                                   TO  TRUE                             05911099
                   ELSE                                                 05920099
                       SET TF048-STOP-PROCESSING                        05930099
                                   TO  TRUE                             05931099
                   END-IF                                               05940099
021605         WHEN TF007-STOCK-BALANCE-CORPORATE                       05950099
021605         WHEN TF007-STOCK-BALANCE-STORE                           05960099
                   PERFORM 7550-SELECT-RECEIVING-LOC                    05970099
                   IF XST00001-LOC-TYP-CDE = PC-DEPT-STR                05980099
                       SET TF048-WARNING-PROCESSING                     05990099
                                   TO  TRUE                             05991099
                   ELSE                                                 06000099
                       SET TF048-STOP-PROCESSING                        06010099
                                   TO  TRUE                             06011099
                   END-IF                                               06020099
021605         WHEN TF007-CUSTOMER                                      06030099
021605         WHEN TF007-NON-RETAIL                                    06040099
021605         WHEN TF007-OFFSITE-STORAGE                               06050099
                   SET TF048-STOP-PROCESSING                            06060099
                                   TO  TRUE                             06061099
           END-EVALUATE.                                                06070099
      *                                                                 06080099
       2140-FILL-XFER-TO-PTC-RECORD.                                    06090099
           PERFORM 3000-COMPUTE-TOT-QTY-RTL.                            06100099
                                                                        06110099
           MOVE TFMSTR-XFER-DKEY-ID                                     06120099
                                   TO TF048-XFER-DKEY.                  06121099
           MOVE TFMSTR-XFER-TYP-CDE                                     06130099
                                   TO TF048-XFER-TYP-CDE-X.             06131099
           MOVE TFTYCD-TYP-1ST-LNE-DESC                                 06140099
                                   TO TF048-XFER-TYPE-DESC-LN1.         06141099
           MOVE TFTYCD-TYP-2ND-LNE-DESC                                 06150099
                                   TO TF048-XFER-TYPE-DESC-LN2.         06151099
           MOVE TFTYCD-PRIC-REQR-IND                                    06160099
                                   TO TF048-PRICE-REQ-IND.              06161099
           MOVE TFMSTR-FR-STR-NBR  TO TF048-FROM-LOC-NBR                06170099
                                             DK-LOC-NBR.                06180099
           PERFORM 7450-SELECT-5-CHAR-STR-NAME.                         06190099
           MOVE XST00001-LOC-5-ABBR-NM                                  06200099
                                   TO TF048-FROM-LOC-NAME.              06201099
           MOVE TFMSTR-TO-STR-NBR  TO TF048-TO-LOC-NBR                  06210099
                                             DK-LOC-NBR.                06220099
           PERFORM 7450-SELECT-5-CHAR-STR-NAME.                         06230099
           MOVE XST00001-LOC-5-ABBR-NM                                  06240099
                                   TO TF048-TO-LOC-NAME.                06241099
                                                                        06250099
           MOVE TFMSTR-CONTNR-TYP-CDE                                   06260099
                                   TO TF048-CONTAINER-TYP-CDE-X.        06261099
           IF TFSHCT-TRLR-IND = PC-YES                                  06270099
               SET TF048-TRAILER-TYPE                                   06280099
                                   TO TRUE                              06281099
           ELSE                                                         06290099
               SET TF048-CONTAINER-TYPE                                 06300099
                                   TO TRUE                              06301099
           END-IF.                                                      06310099
           MOVE TFMSTR-LG-TTE-1ST-SEAL-ID                               06320099
                                   TO TF048-LG-TOTE-SEAL-ONE.           06321099
           MOVE TFMSTR-LG-TTE-2ND-SEAL-ID                               06330099
                                   TO TF048-LG-TOTE-SEAL-TWO.           06331099
           MOVE TFMSTR-SM-TTE-BAG-SEAL-ID                               06340099
                                   TO TF048-SM-TOTE-BAG-SEAL.           06341099
           MOVE TFMSTR-TRLR-NBR    TO TF048-TRAILER-NBR.                06350099
           MOVE TFMSTR-TRLR-SEAL-ID                                     06360099
                                   TO TF048-TRAILER-SEAL-NBR.           06361099
           MOVE TFMSTR-CLBK-NBR    TO TF048-CALLBACK-NBR.               06370099
           MOVE TFMSTR-STK-BAL-APVL-NBR                                 06380099
                                   TO TF048-CORP-STK-BAL-APP-NBR.       06381099
           MOVE PV-XFER-TOT-QTY    TO TF048-TOT-QTY.                    06390099
           COMPUTE TF048-TOT-RTL  =                                     06400099
               (PV-XFER-TOT-RTL  *  100).                               06410099
           MOVE TFMSTR-RQSTR-INIT-1ST-NM                                06420099
                                   TO TF048-REQUESTED-BY-FIRST-INIT.    06430099
           MOVE TFMSTR-RQSTR-LAST-NM                                    06440099
                                   TO TF048-REQUESTED-BY-LAST-NAME.     06450099
           MOVE TFMSTR-ATTN-INIT-1ST-NM                                 06460099
                                   TO TF048-ATTN-TO-FIRST-INIT.         06470099
           MOVE TFMSTR-ATTN-LAST-NM                                     06480099
                                   TO TF048-ATTN-TO-LAST-NAME.          06490099
                                                                        06500099
021605     IF TFMSTR-XFER-TYP-CDE  =  TF007-CUSTOMER                    06510099
               PERFORM 7600-SELECT-CUSTOMER-DATA                        06520099
               MOVE TFCUST-CUST-NM TO  TF048-CUST-NAME                  06530099
               MOVE TFCUST-PHN-NBR TO  TF048-CUST-PHONE                 06540099
           END-IF.                                                      06550099
      *                                                                 06560099
       3000-COMPUTE-TOT-QTY-RTL.                                        06570099
           PERFORM 3010-OPEN-TOT-QTY-RTL-CSR.                           06580099
           PERFORM 7400-FETCH-TOT-QTY-RTL-CSR.                          06590099
                                                                        06600099
           PERFORM 3020-COMPUTE-QTY-RTL-TOTS                            06610099
               UNTIL  PS-END-OF-XFER-ITM-DATA.                          06620099
                                                                        06630099
           PERFORM 3030-CLOSE-TOT-QTY-RTL-CSR.                          06640099
      *                                                                 06650099
       3010-OPEN-TOT-QTY-RTL-CSR.                                       06660099
           EXEC SQL                                                     06670099
               OPEN TOT_QTY_RTL_CSR                                     06680099
           END-EXEC.                                                    06690099
                                                                        06700099
           EVALUATE SQLCODE                                             06710099
               WHEN ZERO                                                06711099
                   CONTINUE                                             06712099
               WHEN OTHER                                               06720099
                   MOVE '3010-OPEN-TOT-QTY-RTL-CSR'                     06750099
                                   TO DP013-PARAGRAPH                   06760099
                   MOVE 'OPEN THE TOT_QTY_RTL_CSR CURSOR'               06770099
                                   TO DP013-MESSAGE-TEXT (1)            06780099
                   MOVE SQLCA      TO DP013-SQLCA                       06790099
                   MOVE 'TTFITEM'  TO DP013-DB2-TABLE-NAME (1)          06800099
                   SET DP013-DB2-ABEND                                  06810099
                       DP013-ROLLBACK                                   06820099
                                   TO TRUE                              06821099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      06830099
                   SET  DP011-MSG-FATAL                                 06840099
                                   TO TRUE                              06841099
                   MOVE PC-TSYMSG-01064                                 06850099
                                   TO DP011-MSG-NUMBER                  06851099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      06860099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   06870099
           END-EVALUATE.                                                06900099
      *                                                                 06910099
       3020-COMPUTE-QTY-RTL-TOTS.                                       06920099
           COMPUTE PV-XFER-TOT-RTL  =                                   06930099
               (PV-XFER-TOT-RTL  +                                      06940099
                   (TFITEM-XFER-QTY  *  TFITEM-XFER-PRIC-AMT)).         06950099
                                                                        06960099
           COMPUTE PV-XFER-TOT-QTY  =                                   06970099
               PV-XFER-TOT-QTY  +  TFITEM-XFER-QTY.                     06980099
                                                                        06990099
           PERFORM 7400-FETCH-TOT-QTY-RTL-CSR.                          07000099
      *                                                                 07010099
       3030-CLOSE-TOT-QTY-RTL-CSR.                                      07020099
           EXEC SQL                                                     07030099
               CLOSE TOT_QTY_RTL_CSR                                    07040099
           END-EXEC.                                                    07050099
                                                                        07060099
           EVALUATE SQLCODE                                             07070099
               WHEN ZERO                                                07071099
                   CONTINUE                                             07072099
               WHEN OTHER                                               07080099
                   MOVE '3030-CLOSE-TOT-QTY-RTL-CSR'                    07110099
                                   TO DP013-PARAGRAPH                   07120099
                   MOVE 'CLOSE THE TOT_QTY_RTL_CSR CURSOR'              07130099
                                   TO DP013-MESSAGE-TEXT (1)            07140099
                   MOVE SQLCA      TO DP013-SQLCA                       07150099
                   MOVE 'TTFITEM'  TO DP013-DB2-TABLE-NAME (1)          07160099
                   SET DP013-DB2-ABEND                                  07170099
                       DP013-ROLLBACK                                   07180099
                                   TO TRUE                              07181099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      07190099
                   SET  DP011-MSG-FATAL                                 07200099
                                   TO TRUE                              07201099
                   MOVE PC-TSYMSG-01064                                 07210099
                                   TO DP011-MSG-NUMBER                  07211099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      07220099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   07230099
           END-EVALUATE.                                                07260099
                                                                        08670099
       4010-OPEN-ITEM-DETAIL-CURSOR.                                    08680099
           EXEC SQL                                                     08690099
               OPEN ITM_DTL_CSR                                         08691099
           END-EXEC.                                                    08691199
                                                                        08691299
           EVALUATE SQLCODE                                             08691399
               WHEN ZERO                                                08691499
                   CONTINUE                                             08691599
               WHEN OTHER                                               08691699
                   MOVE '4010-OPEN-ITEM-DETAIL-CURSOR'                  08691999
                                   TO DP013-PARAGRAPH                   08692099
                   MOVE 'OPEN ITEM DETAIL CURSOR'                       08692199
                                   TO DP013-MESSAGE-TEXT (1)            08692299
                   MOVE SQLCA      TO DP013-SQLCA                       08692399
                   MOVE 'TTFITEM'  TO DP013-DB2-TABLE-NAME (1)          08692499
                   SET DP013-DB2-ABEND                                  08692599
                       DP013-ROLLBACK                                   08692699
                                   TO TRUE                              08692799
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      08692899
                   SET  DP011-MSG-FATAL                                 08692999
                                   TO TRUE                              08693099
                   MOVE PC-TSYMSG-01064                                 08693199
                                   TO DP011-MSG-NUMBER                  08693299
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      08693399
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   08693499
           END-EVALUATE.                                                08693599
                                                                        08693699
       4020-CLOSE-ITEM-DETAIL-CURSOR.                                   08693799
           EXEC SQL                                                     08693899
               CLOSE ITM_DTL_CSR                                        08693999
           END-EXEC.                                                    08694099
                                                                        08694199
           EVALUATE SQLCODE                                             08694299
               WHEN ZERO                                                08694399
                   CONTINUE                                             08694499
               WHEN OTHER                                               08694599
                   MOVE '4020-CLOSE-ITEM-DETAIL-CURSOR'                 08697099
                                   TO DP013-PARAGRAPH                   08698099
                   MOVE 'CLOSE THE ITM_DTL_CSR CURSOR'                  08699099
                                   TO DP013-MESSAGE-TEXT (1)            08700099
                   MOVE SQLCA      TO DP013-SQLCA                       08700199
                   MOVE 'TTFITEM'  TO DP013-DB2-TABLE-NAME (1)          08700299
                   SET DP013-DB2-ABEND                                  08700399
                       DP013-ROLLBACK                                   08700499
                                   TO TRUE                              08700599
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      08700699
                   SET  DP011-MSG-FATAL                                 08700799
                                   TO TRUE                              08700899
                   MOVE PC-TSYMSG-01064                                 08700999
                                   TO DP011-MSG-NUMBER                  08701099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      08701199
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   08701299
           END-EVALUATE.                                                08701399
                                                                        08701499
       4300-READ-ITEMS-FROM-DB.                                         08701599
           PERFORM                                                      08701699
               VARYING PV-READ-COUNT                                    08701799
                  FROM 1 BY 1                                           08701899
                  UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                 08701999
                     OR (PS-END-OF-DETAIL-DATA))                        08702099
                                                                        08702199
               PERFORM 4310-FETCH                                       08702299
                                                                        08702399
           END-PERFORM.                                                 08702499
                                                                        08702599
                                                                        08702699
       4310-FETCH.                                                      08702799
           EXEC SQL                                                     08702899
               FETCH  ITM_DTL_CSR                                       08702999
                INTO  :TFITEM-XFER-LNE-NBR,                             08703099
                      :TFITEM-SCN-UPC-NBR                               08703199
           END-EXEC.                                                    08703299
                                                                        08703399
           EVALUATE SQLCODE                                             08703499
               WHEN ZERO                                                08703599
                   MOVE TFITEM-SCN-UPC-NBR                              08703699
                                   TO PV-HOLD-UPC-NBR-9                 08703799
                   IF (PV-KOHLS-UPC-DIGITS = '0400') AND                08703899
                      (PV-KOHLS-DUMMY-SKU  =  PC-DUMMY-UPC)             08703999
                          SET PS-END-OF-DETAIL-DATA                     08704099
                                   TO TRUE                              08704199
                          SET PS-FOUND-DUMMY-UPC-Y                      08704299
                                   TO TRUE                              08704399
                   END-IF                                               08704499
               WHEN +100                                                08704599
                   SET PS-END-OF-DETAIL-DATA                            08704699
                                   TO TRUE                              08704799
               WHEN OTHER                                               08704899
                   MOVE '4310-FETCH'                                    08704999
                                   TO DP013-PARAGRAPH                   08705099
                   MOVE 'FETCH ITM_DTL_CSR'                             08705199
                                   TO DP013-MESSAGE-TEXT (1)            08705299
                   MOVE SQLCA      TO DP013-SQLCA                       08705399
                   MOVE 'TTFITEM'  TO DP013-DB2-TABLE-NAME (1)          08705499
                   SET DP013-DB2-ABEND                                  08705599
                       DP013-ROLLBACK                                   08705699
                                   TO TRUE                              08705799
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      08705899
                   SET  DP011-MSG-FATAL                                 08705999
                                   TO TRUE                              08706099
                   IF (SQLCODE = -904  OR  SQLCODE = -913)              08706199
                       MOVE PC-TSYMSG-01063                             08706299
                                   TO DP011-MSG-NUMBER                  08706399
                   ELSE                                                 08706499
                       MOVE PC-TSYMSG-01064                             08706599
                                   TO DP011-MSG-NUMBER                  08706699
                   END-IF                                               08706799
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      08706899
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   08706999
           END-EVALUATE.                                                08707099
                                                                        08707199
       7000-SELECT-XFER.                                                08707299
           INITIALIZE DCLTTFMSTR                                        08707399
                      DCLTTFTYCD                                        08707499
                      DCLTTFSHCT.                                       08707599
                                                                        08707699
           MOVE TF047-XFER-FROM-LOC-NBR                                 08707799
                                   TO  DK-FR-LOC-NBR.                   08707899
           MOVE TF047-XFER-FROM-LOC-SEQ-NBR                             08708099
                                   TO  DK-XFER-SEQ-NBR.                 08708199
                                                                        08709099
           EXEC SQL                                                     08710099
               SELECT  A.XFER_DKEY_ID,                                  08720099
                       A.XFER_TYP_CDE,                                  08730099
                       A.CONTNR_TYP_CDE,                                08740099
                       A.FR_STR_NBR,                                    08750099
                       A.XFER_SEQ_NBR,                                  08760099
                       A.TO_STR_NBR,                                    08770099
                       A.CMPT_XFER_END_TMST,                            08780099
                       A.LG_TTE_1ST_SEAL_ID,                            08790099
                       A.LG_TTE_2ND_SEAL_ID,                            08800099
                       A.SM_TTE_BAG_SEAL_ID,                            08810099
                       A.TRLR_NBR,                                      08820099
                       A.TRLR_SEAL_ID,                                  08830099
                       A.CLBK_NBR,                                      08840099
                       A.STK_BAL_APVL_NBR,                              08850099
                       A.RQSTR_INIT_1ST_NM,                             08860099
                       A.RQSTR_LAST_NM,                                 08870099
                       A.ATTN_INIT_1ST_NM,                              08880099
                       A.ATTN_LAST_NM,                                  08890099
                       B.TYP_1ST_LNE_DESC,                              08900099
                       B.TYP_2ND_LNE_DESC,                              08910099
                       B.PRIC_REQR_IND,                                 08920099
                       C.TRLR_IND                                       08930099
                 INTO  :TFMSTR-XFER-DKEY-ID,                            08940099
                       :TFMSTR-XFER-TYP-CDE,                            08950099
                       :TFMSTR-CONTNR-TYP-CDE,                          08960099
                       :TFMSTR-FR-STR-NBR,                              08970099
                       :TFMSTR-XFER-SEQ-NBR,                            08980099
                       :TFMSTR-TO-STR-NBR,                              08990099
                       :TFMSTR-CMPT-XFER-END-TMST,                      09000099
                       :TFMSTR-LG-TTE-1ST-SEAL-ID,                      09010099
                       :TFMSTR-LG-TTE-2ND-SEAL-ID,                      09020099
                       :TFMSTR-SM-TTE-BAG-SEAL-ID,                      09030099
                       :TFMSTR-TRLR-NBR,                                09040099
                       :TFMSTR-TRLR-SEAL-ID,                            09050099
                       :TFMSTR-CLBK-NBR,                                09060099
                       :TFMSTR-STK-BAL-APVL-NBR,                        09070099
                       :TFMSTR-RQSTR-INIT-1ST-NM,                       09080099
                       :TFMSTR-RQSTR-LAST-NM,                           09090099
                       :TFMSTR-ATTN-INIT-1ST-NM,                        09100099
                       :TFMSTR-ATTN-LAST-NM,                            09110099
                       :TFTYCD-TYP-1ST-LNE-DESC,                        09120099
                       :TFTYCD-TYP-2ND-LNE-DESC,                        09130099
                       :TFTYCD-PRIC-REQR-IND,                           09140099
                       :TFSHCT-TRLR-IND                                 09150099
                 FROM  TTFMSTR   A,                                     09160099
                       TTFTYCD   B,                                     09170099
                       TTFSHCT   C                                      09180099
                WHERE  (A.FR_STR_NBR      =  :DK-FR-LOC-NBR             09190099
                  AND   A.XFER_SEQ_NBR    =  :DK-XFER-SEQ-NBR           09200099
                  AND   A.XFER_TYP_CDE    =  B.XFER_TYP_CDE             09210099
                  AND   A.CONTNR_TYP_CDE  =  C.CONTNR_TYP_CDE)          09220099
                WITH UR                                                 09221099
           END-EXEC.                                                    09230099
                                                                        09240099
           EVALUATE SQLCODE                                             09250099
               WHEN ZERO                                                09251099
                   SET PS-XFER-FOUND                                    09252099
                                   TO TRUE                              09252199
               WHEN +100                                                09253099
                   SET PS-XFER-NOT-FOUND                                09254099
                                   TO TRUE                              09255099
               WHEN -904                                                09260099
               WHEN -913                                                09270099
                   SET  DP011-MSG-FATAL                                 09280099
                                   TO TRUE                              09281099
                   MOVE PC-TSYMSG-01063                                 09290099
                                   TO DP011-MSG-NUMBER                  09291099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      09300099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   09310099
               WHEN OTHER                                               09340099
                   MOVE '7000-SELECT-XFER'                              09370099
                                   TO DP013-PARAGRAPH                   09380099
                   MOVE 'SELECT XFER: '                                 09390099
                                   TO DP013-MESSAGE-TEXT (1)            09391099
                   MOVE DK-FR-LOC-NBR                                   09400099
                                   TO PV-DISPLAY-FR-LOC-NBR             09401099
                   MOVE DK-XFER-SEQ-NBR                                 09410099
                                   TO PV-DISPLAY-FR-STR-SEQ-NBR         09420099
                   MOVE PV-DISPLAY-XFER-DOC-NBR                         09430099
                                   TO DP013-MESSAGE-TEXT (2)            09440099
                   MOVE SQLCA      TO DP013-SQLCA                       09450099
                   MOVE 'TTFMSTR'  TO DP013-DB2-TABLE-NAME (1)          09460099
                   MOVE 'TTFTYCD'  TO DP013-DB2-TABLE-NAME (2)          09470099
                   MOVE 'TTFSHCT'  TO DP013-DB2-TABLE-NAME (3)          09480099
                   SET DP013-DB2-ABEND                                  09490099
                       DP013-NO-ROLLBACK                                09500099
                                   TO TRUE                              09501099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      09510099
                   SET  DP011-MSG-FATAL                                 09520099
                                   TO TRUE                              09521099
                   MOVE PC-TSYMSG-01064                                 09530099
                                   TO DP011-MSG-NUMBER                  09531099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      09540099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   09550099
           END-EVALUATE.                                                09580099
      *                                                                 09590099
       7050-SELECT-MAX-STAT-TMST.                                       09600099
           INITIALIZE DCLTTFSTAT.                                       09610099
                                                                        09620099
           EXEC SQL                                                     09630099
               SELECT  MAX(XFER_STAT_TMST)                              09640099
                 INTO  :TFSTAT-XFER-STAT-TMST                           09650099
                 FROM  TTFSTAT                                          09660099
                WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID)          09670099
                WITH UR                                                 09671099
           END-EXEC.                                                    09680099
                                                                        09690099
           EVALUATE SQLCODE                                             09700099
               WHEN ZERO                                                09701099
                   CONTINUE                                             09702099
               WHEN -904                                                09710099
               WHEN -913                                                09720099
                   SET  DP011-MSG-FATAL                                 09730099
                                   TO TRUE                              09731099
                   MOVE PC-TSYMSG-01063                                 09740099
                                   TO DP011-MSG-NUMBER                  09741099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      09750099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   09760099
               WHEN OTHER                                               09770099
                   MOVE '7050-SELECT-MAX-STAT-TMST'                     09800099
                                   TO DP013-PARAGRAPH                   09810099
                   MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '       09820099
                                   TO DP013-MESSAGE-TEXT (1)            09830099
                   MOVE TFMSTR-XFER-DKEY-ID                             09840099
                                   TO PV-DISPLAY-XFER-DKEY-ID           09841099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         09850099
                                   TO DP013-MESSAGE-TEXT (2)            09860099
                   MOVE SQLCA      TO DP013-SQLCA                       09870099
                   MOVE 'TTFSTAT'  TO DP013-DB2-TABLE-NAME (1)          09880099
                   SET DP013-DB2-ABEND                                  09890099
                       DP013-NO-ROLLBACK                                09900099
                                   TO TRUE                              09901099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      09910099
                   SET  DP011-MSG-FATAL                                 09920099
                                   TO TRUE                              09921099
                   MOVE PC-TSYMSG-01064                                 09930099
                                   TO DP011-MSG-NUMBER                  09931099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      09940099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   09950099
           END-EVALUATE.                                                09980099
      *                                                                 09990099
       7100-SELECT-CURRENT-STATUS.                                      10000099
           EXEC SQL                                                     10010099
               SELECT  A.XFER_STAT_CDE,                                 10020099
                       B.XFER_STAT_DESC                                 10030099
                 INTO  :TFSTAT-XFER-STAT-CDE,                           10040099
                       :TFSTCD-XFER-STAT-DESC                           10050099
                 FROM  TTFSTAT  A,                                      10060099
                       TTFSTCD  B                                       10070099
                WHERE  (XFER_DKEY_ID     =  :TFMSTR-XFER-DKEY-ID        10080099
                  AND   XFER_STAT_TMST   =  :TFSTAT-XFER-STAT-TMST      10090099
                  AND   A.XFER_STAT_CDE  =  B.XFER_STAT_CDE)            10100099
                WITH UR                                                 10101099
           END-EXEC.                                                    10110099
                                                                        10120099
           EVALUATE SQLCODE                                             10130099
               WHEN ZERO                                                10131099
                   CONTINUE                                             10132099
               WHEN -904                                                10140099
               WHEN -913                                                10150099
                   SET  DP011-MSG-FATAL                                 10160099
                                   TO TRUE                              10161099
                   MOVE PC-TSYMSG-01063                                 10170099
                                   TO DP011-MSG-NUMBER                  10171099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      10180099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   10190099
               WHEN OTHER                                               10200099
                   MOVE '7100-SELECT-CURRENT-STATUS'                    10230099
                                   TO DP013-PARAGRAPH                   10240099
                   MOVE 'SELECT CURRENT STATUS FOR DATALESS KEY/TIMESTAM10250099
      -                 'P: '      TO DP013-MESSAGE-TEXT (1)            10260099
                   MOVE TFMSTR-XFER-DKEY-ID                             10270099
                                   TO PV-DISPLAY-XFER-DKEY-ID           10271099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         10280099
                                   TO DP013-MESSAGE-TEXT (2)            10290099
                   MOVE TFSTAT-XFER-STAT-TMST                           10300099
                                   TO DP013-MESSAGE-TEXT (3)            10310099
                   MOVE SQLCA      TO DP013-SQLCA                       10320099
                   MOVE 'TTFSTAT'  TO DP013-DB2-TABLE-NAME (1)          10330099
                   SET DP013-DB2-ABEND                                  10340099
                       DP013-NO-ROLLBACK                                10350099
                                   TO TRUE                              10351099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      10360099
                   SET  DP011-MSG-FATAL                                 10370099
                                   TO TRUE                              10371099
                   MOVE PC-TSYMSG-01064                                 10380099
                                   TO DP011-MSG-NUMBER                  10381099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      10390099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   10400099
           END-EVALUATE.                                                10430099
      *                                                                 10440099
       7150-SELECT-MAX-RCPT-TMST.                                       10450099
           EXEC SQL                                                     10460099
               SELECT  MAX(RCV_XFER_BEG_TMST)                           10470099
                 INTO  :TFRCPT-RCV-XFER-BEG-TMST                        10480099
                           :PV-NULL-IND                                 10490099
                 FROM  TTFRCPT                                          10500099
                WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID)          10510099
                WITH UR                                                 10511099
           END-EXEC.                                                    10520099
                                                                        10530099
           EVALUATE SQLCODE                                             10540099
               WHEN ZERO                                                10541099
                   CONTINUE                                             10542099
               WHEN -904                                                10550099
               WHEN -913                                                10560099
                   SET  DP011-MSG-FATAL                                 10570099
                                   TO TRUE                              10571099
                   MOVE PC-TSYMSG-01063                                 10580099
                                   TO DP011-MSG-NUMBER                  10581099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      10590099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   10600099
               WHEN OTHER                                               10610099
                   MOVE '7150-SELECT-MAX-RCPT-TMST'                     10640099
                                   TO DP013-PARAGRAPH                   10650099
                   MOVE 'SELECT MAX TIMESTAMP FOR DATALESS KEY: '       10660099
                                   TO DP013-MESSAGE-TEXT (1)            10670099
                   MOVE TFMSTR-XFER-DKEY-ID                             10680099
                                   TO PV-DISPLAY-XFER-DKEY-ID           10681099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         10690099
                                   TO DP013-MESSAGE-TEXT (2)            10700099
                   MOVE SQLCA      TO DP013-SQLCA                       10710099
                   MOVE 'TTFRCPT'  TO DP013-DB2-TABLE-NAME (1)          10720099
                   SET DP013-DB2-ABEND                                  10730099
                       DP013-NO-ROLLBACK                                10740099
                                   TO TRUE                              10741099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      10750099
                   SET  DP011-MSG-FATAL                                 10760099
                                   TO TRUE                              10761099
                   MOVE PC-TSYMSG-01064                                 10770099
                                   TO DP011-MSG-NUMBER                  10771099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      10780099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   10790099
           END-EVALUATE.                                                10820099
      *                                                                 10830099
       7200-SELECT-CURRENT-RCPT.                                        10840099
           EXEC SQL                                                     10850099
               SELECT  RCV_XFER_END_TMST                                10860099
                 INTO  :TFRCPT-RCV-XFER-END-TMST                        10870099
                 FROM  TTFRCPT                                          10880099
                WHERE  (XFER_DKEY_ID       =  :TFMSTR-XFER-DKEY-ID      10890099
                  AND   RCV_XFER_BEG_TMST  =  :TFRCPT-RCV-XFER-BEG-TMST)10900099
                WITH UR                                                 10901099
           END-EXEC.                                                    10910099
                                                                        10920099
           EVALUATE SQLCODE                                             10930099
               WHEN ZERO                                                10931099
                   CONTINUE                                             10932099
               WHEN -904                                                10940099
               WHEN -913                                                10950099
                   SET  DP011-MSG-FATAL                                 10960099
                                   TO TRUE                              10961099
                   MOVE PC-TSYMSG-01063                                 10970099
                                   TO DP011-MSG-NUMBER                  10971099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      10980099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   10990099
               WHEN OTHER                                               11000099
                   MOVE '7200-SELECT-CURRENT-RCPT'                      11030099
                                   TO DP013-PARAGRAPH                   11040099
                   MOVE 'SELECT CURRENT RECEIPT FOR DATALESS KEY/TIMESTA11050099
      -                 'MP: '     TO DP013-MESSAGE-TEXT (1)            11060099
                   MOVE TFMSTR-XFER-DKEY-ID                             11070099
                                   TO PV-DISPLAY-XFER-DKEY-ID           11071099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         11080099
                                   TO DP013-MESSAGE-TEXT (2)            11090099
                   MOVE TFRCPT-RCV-XFER-BEG-TMST                        11100099
                                   TO DP013-MESSAGE-TEXT (3)            11110099
                   MOVE SQLCA      TO DP013-SQLCA                       11120099
                   MOVE 'TTFRCPT'  TO DP013-DB2-TABLE-NAME (1)          11130099
                   SET DP013-DB2-ABEND                                  11140099
                       DP013-NO-ROLLBACK                                11150099
                                   TO TRUE                              11151099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      11160099
                   SET  DP011-MSG-FATAL                                 11170099
                                   TO TRUE                              11171099
                   MOVE PC-TSYMSG-01064                                 11180099
                                   TO DP011-MSG-NUMBER                  11181099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      11190099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   11200099
           END-EVALUATE.                                                11230099
      *                                                                 11240099
       7250-SELECT-CURRENT-TIMESTAMP.                                   11250099
                                                                        11260099
           EXEC SQL                                                     11270099
               SET  :PV-CURRENT-TIMESTAMP  =  CURRENT TIMESTAMP         11280099
           END-EXEC.                                                    11290099
                                                                        11300099
           EVALUATE SQLCODE                                             11310099
               WHEN ZERO                                                11311099
                   CONTINUE                                             11312099
               WHEN OTHER                                               11320099
                   MOVE '7250-SELECT-CURRENT-TIMESTAMP'                 11350099
                                   TO DP013-PARAGRAPH                   11360099
                   MOVE 'SELECT THE CURRENT TIMESTAMP'                  11370099
                                   TO DP013-MESSAGE-TEXT (1)            11380099
                   MOVE SQLCA      TO DP013-SQLCA                       11390099
                   SET DP013-DB2-ABEND                                  11400099
                       DP013-NO-ROLLBACK                                11410099
                                   TO TRUE                              11411099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      11420099
                   SET  DP011-MSG-FATAL                                 11430099
                                   TO TRUE                              11431099
                   MOVE PC-TSYMSG-01064                                 11440099
                                   TO DP011-MSG-NUMBER                  11441099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      11450099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   11460099
           END-EVALUATE.                                                11490099
      *                                                                 11500099
                                                                        11760099
       7300-INSERT-XFER-RECEIPT-ROW.                                    11770099
           MOVE TF047-LOC-NBR      TO  TFRCPT-STR-NBR.                  11780099
           MOVE PC-NO              TO TFRCPT-RCVG-PROB-IND.             11820099
                                                                        11840099
           EXEC SQL                                                     11850099
               INSERT INTO TTFRCPT                                      11860099
                   (XFER_DKEY_ID,                                       11870099
                    RCV_XFER_BEG_TMST,                                  11880099
                    ENTR_MTHD_TYP_CDE,                                  11890099
                    STR_NBR,                                            11900099
                    RCV_XFER_END_TMST,                                  11910099
                    RCVG_PROB_IND)                                      11920099
               VALUES                                                   11930099
                   (:TFMSTR-XFER-DKEY-ID,                               11940099
                    :PV-CURRENT-TIMESTAMP,                              11950099
                    '01',                                               11960099
                    :TFRCPT-STR-NBR,                                    11970099
                    :PV-CURRENT-TIMESTAMP,                              11980099
                    :TFRCPT-RCVG-PROB-IND)                              11990099
           END-EXEC.                                                    12000099
                                                                        12010099
           EVALUATE SQLCODE                                             12020099
               WHEN ZERO                                                12021099
                   CONTINUE                                             12022099
               WHEN -904                                                12030099
               WHEN -913                                                12040099
                   SET  DP011-MSG-FATAL                                 12050099
                                   TO TRUE                              12051099
                   MOVE PC-TSYMSG-01063                                 12060099
                                   TO DP011-MSG-NUMBER                  12061099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      12070099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   12080099
               WHEN OTHER                                               12090099
                   MOVE '7300-INSERT-XFER-RECEIPT-ROW'                  12120099
                                   TO DP013-PARAGRAPH                   12130099
                   MOVE 'INSERT A TRANSFER RECEIPT ROW FOR DATALESS KEY 12140099
      -                 'VALUE: '  TO DP013-MESSAGE-TEXT (1)            12150099
                   MOVE TFMSTR-XFER-DKEY-ID                             12160099
                                   TO PV-DISPLAY-XFER-DKEY-ID           12161099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         12170099
                                   TO DP013-MESSAGE-TEXT (2)            12180099
                   MOVE SQLCA      TO DP013-SQLCA                       12190099
                   MOVE 'TTFRCPT'  TO DP013-DB2-TABLE-NAME (1)          12200099
                   SET DP013-DB2-ABEND                                  12210099
                       DP013-NO-ROLLBACK                                12220099
                                   TO TRUE                              12221099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      12230099
                   SET  DP011-MSG-FATAL                                 12240099
                                   TO TRUE                              12241099
                   MOVE PC-TSYMSG-01064                                 12250099
                                   TO DP011-MSG-NUMBER                  12251099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      12260099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   12270099
           END-EVALUATE.                                                12300099
      *                                                                 12310099
      *                                                                 12710099
       7350-INSERT-XFER-IR-STAT-ROW.                                    12720099
           EXEC SQL                                                     12730099
               INSERT INTO TTFSTAT                                      12740099
                   (XFER_DKEY_ID,                                       12750099
                    XFER_STAT_TMST,                                     12760099
                    XFER_STAT_CDE)                                      12770099
               VALUES                                                   12780099
                   (:TFMSTR-XFER-DKEY-ID,                               12790099
                    :PV-CURRENT-TIMESTAMP,                              12800099
                    'IR')                                               12810099
           END-EXEC.                                                    12820099
                                                                        12830099
           EVALUATE SQLCODE                                             12840099
               WHEN ZERO                                                12841099
                   CONTINUE                                             12842099
               WHEN OTHER                                               12850099
                   MOVE '7350-INSERT-XFER-PR-STAT-ROW'                  12880099
                                   TO DP013-PARAGRAPH                   12890099
                   MOVE 'INSERT A TRANSFER STATUS ROW OF POSITIVELY'    12900099
                                   TO DP013-MESSAGE-TEXT (1)            12910099
                   MOVE 'RECEIVED FOR DATALESS KEY VALUE: '             12920099
                                   TO DP013-MESSAGE-TEXT (2)            12930099
                   MOVE TFMSTR-XFER-DKEY-ID                             12940099
                                   TO PV-DISPLAY-XFER-DKEY-ID           12941099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         12950099
                                   TO DP013-MESSAGE-TEXT (3)            12960099
                   MOVE SQLCA      TO DP013-SQLCA                       12970099
                   MOVE 'TTFSTAT'  TO DP013-DB2-TABLE-NAME (1)          12980099
                   SET DP013-DB2-ABEND                                  12990099
                       DP013-ROLLBACK                                   13000099
                                   TO TRUE                              13001099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      13010099
                   SET  DP011-MSG-FATAL                                 13020099
                                   TO TRUE                              13021099
                   IF (SQLCODE = -904  OR  SQLCODE = -913)              13030099
                       MOVE PC-TSYMSG-01063                             13040099
                                   TO DP011-MSG-NUMBER                  13041099
                   ELSE                                                 13050099
                       MOVE PC-TSYMSG-01064                             13060099
                                   TO DP011-MSG-NUMBER                  13061099
                   END-IF                                               13070099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      13080099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   13090099
           END-EVALUATE.                                                13120099
      *                                                                 13130099
       7400-FETCH-TOT-QTY-RTL-CSR.                                      13140099
           INITIALIZE DCLTTFITEM.                                       13150099
                                                                        13160099
           EXEC SQL                                                     13170099
               FETCH  TOT_QTY_RTL_CSR                                   13180099
                INTO  :TFITEM-XFER-PRIC-AMT,                            13190099
                      :TFITEM-XFER-QTY                                  13200099
           END-EXEC.                                                    13210099
                                                                        13220099
           EVALUATE SQLCODE                                             13230099
               WHEN ZERO                                                13231099
                   CONTINUE                                             13232099
               WHEN +100                                                13240099
                   SET PS-END-OF-XFER-ITM-DATA                          13250099
                                   TO TRUE                              13251099
               WHEN OTHER                                               13260099
                   MOVE '7400-FETCH-TOT-QTY-RTL-CSR'                    13290099
                                   TO DP013-PARAGRAPH                   13300099
                   MOVE 'FETCH TOT_QTY_RTL_CSR'                         13310099
                                   TO DP013-MESSAGE-TEXT (1)            13320099
                   MOVE SQLCA      TO DP013-SQLCA                       13330099
                   MOVE 'TTFITEM'  TO DP013-DB2-TABLE-NAME (1)          13340099
                   SET DP013-DB2-ABEND                                  13350099
                       DP013-ROLLBACK                                   13360099
                                   TO TRUE                              13361099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      13370099
                   SET  DP011-MSG-FATAL                                 13380099
                                   TO TRUE                              13381099
                   IF (SQLCODE = -904  OR  SQLCODE = -913)              13390099
                       MOVE PC-TSYMSG-01063                             13400099
                                   TO DP011-MSG-NUMBER                  13401099
                   ELSE                                                 13410099
                       MOVE PC-TSYMSG-01064                             13420099
                                   TO DP011-MSG-NUMBER                  13421099
                   END-IF                                               13430099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      13440099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   13450099
           END-EVALUATE.                                                13480099
      *                                                                 13490099
       7450-SELECT-5-CHAR-STR-NAME.                                     13500099
           INITIALIZE DCLXST00001.                                      13510099
                                                                        13520099
           EXEC SQL                                                     13530099
               SELECT  LOC_5_ABBR_NM                                    13540099
                 INTO  :XST00001-LOC-5-ABBR-NM                          13550099
                 FROM  XST_LOC                                          13560099
                WHERE  LOC_NBR  =  :DK-LOC-NBR                          13570099
                WITH UR                                                 13571099
           END-EXEC.                                                    13580099
                                                                        13590099
           EVALUATE SQLCODE                                             13600099
               WHEN ZERO                                                13601099
                   CONTINUE                                             13602099
               WHEN OTHER                                               13610099
                   MOVE '7450-SELECT-5-CHAR-STR-NAME'                   13640099
                                   TO DP013-PARAGRAPH                   13650099
                   MOVE 'SELECT 5 CHARACTER STORE NAME FOR STORE: '     13660099
                                   TO DP013-MESSAGE-TEXT (1)            13670099
                   MOVE DK-LOC-NBR TO DK-LOC-NBR-DISPLAY                13680099
                   MOVE DK-LOC-NBR-DISPLAY                              13690099
                                   TO DP013-MESSAGE-TEXT (2)            13691099
                   MOVE SQLCA      TO DP013-SQLCA                       13700099
                   MOVE 'XST_LOC'  TO DP013-DB2-TABLE-NAME (1)          13710099
                   SET DP013-DB2-ABEND                                  13720099
                       DP013-ROLLBACK                                   13730099
                                   TO TRUE                              13731099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      13740099
                   SET  DP011-MSG-FATAL                                 13750099
                                   TO TRUE                              13751099
                   IF (SQLCODE = -904  OR  SQLCODE = -913)              13760099
                       MOVE PC-TSYMSG-01063                             13770099
                                   TO DP011-MSG-NUMBER                  13771099
                   ELSE                                                 13780099
                       MOVE PC-TSYMSG-01064                             13790099
                                   TO DP011-MSG-NUMBER                  13791099
                   END-IF                                               13800099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      13810099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   13820099
           END-EVALUATE.                                                13850099
      *                                                                 13860099
       7500-INSERT-DISCREPANCY-ROW.                                     13870099
           MOVE TF047-LOC-NBR      TO  TFDSCP-RCVD-AT-STR-NBR.          13880099
                                                                        13890099
           EXEC SQL                                                     13900099
               INSERT INTO TTFDSCP                                      13910099
                   (XFER_DKEY_ID,                                       13920099
                    RCV_XFER_BEG_TMST,                                  13930099
                    RCVD_AT_STR_NBR)                                    13940099
               VALUES                                                   13950099
                   (:TFMSTR-XFER-DKEY-ID,                               13960099
                    :PV-CURRENT-TIMESTAMP,                              13970099
                    :TFDSCP-RCVD-AT-STR-NBR)                            13980099
           END-EXEC.                                                    13990099
                                                                        14000099
           EVALUATE SQLCODE                                             14010099
               WHEN ZERO                                                14011099
                   CONTINUE                                             14012099
               WHEN OTHER                                               14020099
                   MOVE '7500-INSERT-DISCREPANCY-ROW'                   14050099
                                   TO DP013-PARAGRAPH                   14060099
                   MOVE 'INSERT A DISCREPANCY ROW FOR DATALESS KEY VALUE14070099
      -                 ': '                                            14080099
                                   TO DP013-MESSAGE-TEXT (1)            14090099
                   MOVE TFRCPT-XFER-DKEY-ID                             14100099
                                   TO PV-DISPLAY-XFER-DKEY-ID           14101099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         14110099
                                   TO DP013-MESSAGE-TEXT (2)            14120099
                   MOVE SQLCA      TO DP013-SQLCA                       14130099
                   MOVE 'TTFDSCP'  TO DP013-DB2-TABLE-NAME (1)          14140099
                   SET DP013-DB2-ABEND                                  14150099
                       DP013-ROLLBACK                                   14160099
                                   TO TRUE                              14161099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      14170099
                   SET  DP011-MSG-FATAL                                 14180099
                                   TO TRUE                              14181099
                   IF (SQLCODE = -904  OR  SQLCODE = -913)              14190099
                       MOVE PC-TSYMSG-01063                             14200099
                                   TO DP011-MSG-NUMBER                  14201099
                   ELSE                                                 14210099
                       MOVE PC-TSYMSG-01064                             14220099
                                   TO DP011-MSG-NUMBER                  14221099
                   END-IF                                               14230099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      14240099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   14250099
           END-EVALUATE.                                                14280099
      *                                                                 14290099
       7550-SELECT-RECEIVING-LOC.                                       14300099
           INITIALIZE DCLXST00001.                                      14310099
                                                                        14320099
           MOVE TF047-LOC-NBR-X    TO  DK-LOC-NBR.                      14340099
                                                                        14350099
           EXEC SQL                                                     14360099
               SELECT  LOC_TYP_CDE                                      14370099
                 INTO  :XST00001-LOC-TYP-CDE                            14380099
                 FROM  XST_LOC                                          14390099
                WHERE  LOC_NBR      =  :DK-LOC-NBR                      14410099
                WITH UR                                                 14411099
           END-EXEC.                                                    14420099
                                                                        14430099
           EVALUATE SQLCODE                                             14440099
               WHEN ZERO                                                14441099
                   CONTINUE                                             14442099
               WHEN +100                                                14450099
                   SET  DP011-MSG-FATAL                                 14460099
                                   TO TRUE                              14461099
                   MOVE PC-TSYMSG-00594                                 14470099
                                   TO DP011-MSG-NUMBER                  14471099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      14480099
               WHEN OTHER                                               14490099
                   MOVE '7550-SELECT-RECEIVING-LOC'                     14520099
                                   TO DP013-PARAGRAPH                   14530099
                   MOVE 'SELECTING DATA FOR STORE: '                    14540099
                                   TO DP013-MESSAGE-TEXT (1)            14550099
                   MOVE DK-LOC-NBR TO DK-LOC-NBR-DISPLAY                14560099
                   MOVE DK-LOC-NBR-DISPLAY                              14570099
                                   TO DP013-MESSAGE-TEXT (2)            14571099
                   MOVE SQLCA      TO DP013-SQLCA                       14580099
                   MOVE 'XST_LOC'  TO DP013-DB2-TABLE-NAME (1)          14590099
                   SET DP013-DB2-ABEND                                  14600099
                       DP013-ROLLBACK                                   14610099
                                   TO TRUE                              14611099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      14620099
                   SET  DP011-MSG-FATAL                                 14630099
                                   TO TRUE                              14631099
                   IF (SQLCODE = -904  OR  SQLCODE = -913)              14640099
                       MOVE PC-TSYMSG-01063                             14650099
                                   TO DP011-MSG-NUMBER                  14651099
                   ELSE                                                 14660099
                       MOVE PC-TSYMSG-01064                             14670099
                                   TO DP011-MSG-NUMBER                  14671099
                   END-IF                                               14680099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      14690099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   14700099
           END-EVALUATE.                                                14730099
      *                                                                 14740099
       7600-SELECT-CUSTOMER-DATA.                                       14750099
           INITIALIZE DCLTTFCUST.                                       14760099
                                                                        14770099
           EXEC SQL                                                     14780099
               SELECT  CUST_NM,                                         14790099
                       PHN_NBR                                          14800099
                 INTO  :TFCUST-CUST-NM,                                 14810099
                       :TFCUST-PHN-NBR                                  14820099
                 FROM  TTFCUST                                          14830099
                WHERE  (XFER_DKEY_ID  =  :TFMSTR-XFER-DKEY-ID)          14840099
                WITH UR                                                 14841099
           END-EXEC.                                                    14850099
                                                                        14860099
           EVALUATE SQLCODE                                             14870099
               WHEN ZERO                                                14871099
                   CONTINUE                                             14872099
               WHEN OTHER                                               14880099
                   MOVE '7600-SELECT-CUSTOMER-DATA'                     14910099
                                   TO DP013-PARAGRAPH                   14920099
                   MOVE 'SELECT CUSTOMER DATA FOR XFER_DKEY_ID: '       14930099
                                   TO DP013-MESSAGE-TEXT (1)            14940099
                   MOVE TFMSTR-XFER-DKEY-ID                             14950099
                                   TO PV-DISPLAY-XFER-DKEY-ID           14951099
                   MOVE PV-DISPLAY-XFER-DKEY-ID                         14960099
                                   TO DP013-MESSAGE-TEXT (2)            14970099
                   MOVE SQLCA      TO DP013-SQLCA                       14980099
                   MOVE 'TTFCUST'  TO DP013-DB2-TABLE-NAME (1)          14990099
                   SET DP013-DB2-ABEND                                  15000099
                       DP013-ROLLBACK                                   15010099
                                   TO TRUE                              15011099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      15020099
                   SET  DP011-MSG-FATAL                                 15030099
                                   TO TRUE                              15031099
                   IF (SQLCODE = -904  OR  SQLCODE = -913)              15040099
                       MOVE PC-TSYMSG-01063                             15050099
                                   TO DP011-MSG-NUMBER                  15051099
                   ELSE                                                 15060099
                       MOVE PC-TSYMSG-01064                             15070099
                                   TO DP011-MSG-NUMBER                  15071099
                   END-IF                                               15080099
                   PERFORM 9000-FMT-ERR-MSG-TO-PTC                      15090099
                   PERFORM 8000-SEND-DATA-TO-LISTENER                   15100099
           END-EVALUATE.                                                15130099
      *                                                                 16720099
      ******************************************************************16730099
      *  CONNECT TO SOCKET WHICH WAS GIVEN TO US BY THE AL/SYSTEMS PTC  16740099
      *  PROGRAM.  CONNECT THE PATH (SOCKET).                           16750099
      ******************************************************************16760099
       8000-SEND-DATA-TO-LISTENER.                                      16770099
           IF TF047-MQ-INDICATOR-Y                                      16780099
               PERFORM 8500-MQ-SETUP                                    16790099
               PERFORM 8510-MQ-SETUP-REMOTE                             16800099
               PERFORM 8520-PUT-QUEUE                                   16810099
               PERFORM 8600-CLOSE-PUT-Q                                 16820099
               PERFORM 8610-DISCONNECT-QMGR                             16830099
               PERFORM 9100-EXEC-CICS-RETURN                            16840099
           ELSE                                                         16850099
               PERFORM 8110-ENQ-TCPIPPRQ                                16860099
               PERFORM 8120-READQ-TCPIPPRQ-RECORD1                      16870099
               PERFORM 8130-READQ-TCPIPPRQ-RECORD2                      16880099
                                                                        16890099
               PERFORM 8140-REWRITE-TCPIPPRQ-NEXT-REC                   16910099
               ADD 1               TO PV-NEXT-RECORD                    16930099
                                                                        16940099
               IF PV-NEXT-RECORD > PV-TOTAL-RECORDS                     16950099
                   MOVE 3          TO PV-NEXT-RECORD                    16960099
               END-IF                                                   16970099
                                                                        16980099
               PERFORM 8150-REWRITE-TCPIPPRQ-RECORD1                    16990099
               PERFORM 8160-DEQ-TCPIPPRQ                                17000099
                                                                        17010099
               PERFORM 9100-EXEC-CICS-RETURN                            17020099
           END-IF.                                                      17030099
      *                                                                 17040099
      ******************************************************************17050099
       8110-ENQ-TCPIPPRQ.                                               17060099
           EXEC CICS                                                    17070099
               ENQ                                                      17080099
                   RESOURCE  (PV-TSQ-NAME)                              17090099
                   RESP      (PV-CICS-RESPONSE)                         17100099
           END-EXEC.                                                    17110099
                                                                        17120099
           EVALUATE TRUE                                                17130099
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17140099
                   CONTINUE                                             17150099
               WHEN OTHER                                               17160099
                   MOVE '8110-ENQ-TCPIPPRQ'                             17170099
                                   TO DP013-PARAGRAPH                   17171099
                   MOVE 'UNABLE TO ENQ THE FOLLOWING TEMPORARY STORAGE Q17180099
      -                 'UEUE: '                                        17190099
                                   TO DP013-MESSAGE-TEXT (1)            17200099
                   MOVE PV-TSQ-NAME                                     17210099
                                   TO DP013-MESSAGE-TEXT (2)            17211099
                   SET DP013-CICS-ABEND                                 17220099
                       DP013-NO-ROLLBACK                                17230099
                                   TO TRUE                              17231099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      17240099
                   PERFORM 9100-EXEC-CICS-RETURN                        17250099
           END-EVALUATE.                                                17260099
      *                                                                 17270099
      ******************************************************************17280099
       8120-READQ-TCPIPPRQ-RECORD1.                                     17290099
           MOVE LENGTH OF PV-TCPIPPRQ-RECORD1                           17300099
                                   TO PV-TSQ-LENGTH.                    17301099
                                                                        17310099
           EXEC CICS                                                    17320099
               READQ TS                                                 17330099
                   QUEUE   (PV-TSQ-NAME)                                17340099
                   INTO    (PV-TCPIPPRQ-RECORD1)                        17350099
                   LENGTH  (PV-TSQ-LENGTH)                              17360099
                   ITEM    (1)                                          17370099
                   RESP    (PV-CICS-RESPONSE)                           17380099
           END-EXEC.                                                    17390099
                                                                        17400099
           EVALUATE TRUE                                                17410099
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17420099
                   CONTINUE                                             17430099
               WHEN OTHER                                               17440099
                   MOVE '8120-READQ-TCPIPPRQ-RECORD1'                   17450099
                                   TO DP013-PARAGRAPH                   17460099
                   MOVE 'UNABLE TO READ THE FOLLOWING TEMPORARY STORAGE 17470099
      -                 'QUEUE: '                                       17480099
                                   TO DP013-MESSAGE-TEXT (1)            17490099
                   MOVE PV-TSQ-NAME                                     17500099
                                   TO DP013-MESSAGE-TEXT (2)            17501099
                   SET DP013-CICS-ABEND                                 17510099
                       DP013-NO-ROLLBACK                                17520099
                                   TO TRUE                              17521099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      17530099
                   PERFORM 9100-EXEC-CICS-RETURN                        17540099
           END-EVALUATE.                                                17550099
      *                                                                 17560099
      ******************************************************************17570099
       8130-READQ-TCPIPPRQ-RECORD2.                                     17580099
           MOVE LENGTH OF PV-TCPIPPRQ-RECORD2                           17590099
                                   TO PV-TSQ-LENGTH.                    17591099
                                                                        17600099
           EXEC CICS                                                    17610099
               READQ TS                                                 17620099
                   QUEUE   (PV-TSQ-NAME)                                17630099
                   INTO    (PV-TCPIPPRQ-RECORD2)                        17640099
                   LENGTH  (PV-TSQ-LENGTH)                              17650099
                   ITEM    (2)                                          17660099
                   RESP    (PV-CICS-RESPONSE)                           17670099
           END-EXEC.                                                    17680099
                                                                        17690099
           EVALUATE TRUE                                                17700099
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17710099
                   CONTINUE                                             17720099
               WHEN OTHER                                               17730099
                   MOVE '8130-READQ-TCPIPPRQ-RECORD2'                   17740099
                                   TO DP013-PARAGRAPH                   17750099
                   MOVE 'UNABLE TO READ THE FOLLOWING TEMPORARY STORAGE 17760099
      -                 'QUEUE: '                                       17770099
                                   TO DP013-MESSAGE-TEXT (1)            17780099
                   MOVE PV-TSQ-NAME                                     17790099
                                   TO DP013-MESSAGE-TEXT (2)            17791099
                   SET DP013-CICS-ABEND                                 17800099
                       DP013-NO-ROLLBACK                                17810099
                                   TO TRUE                              17811099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      17820099
                   PERFORM 9100-EXEC-CICS-RETURN                        17830099
           END-EVALUATE.                                                17840099
      *                                                                 17850099
      ******************************************************************17860099
       8140-REWRITE-TCPIPPRQ-NEXT-REC.                                  17870099
           MOVE LENGTH OF TF048-XFER-TO-PTC-RECORD                      17880099
                                   TO  TF048-TOT-REC-LENGTH.            17890099
                                                                        17900099
           MOVE TF047-MATCHING-NBR-FIELD                                17910099
                                   TO  TF048-MATCHING-NBR-FIELD.        17911099
           MOVE PV-NEXT-RECORD     TO  PV-ITEM-NBR.                     17920099
                                                                        17930099
           EXEC CICS                                                    17940099
               WRITEQ TS                                                17950099
                   QUEUE   (PV-TSQ-NAME)                                17960099
                   FROM    (TF048-XFER-TO-PTC-RECORD)                   17970099
                   LENGTH  (PV-TSQ-LENGTH)                              17980099
                   ITEM    (PV-ITEM-NBR)                                17990099
                       REWRITE                                          18000099
                   RESP    (PV-CICS-RESPONSE)                           18010099
           END-EXEC.                                                    18020099
                                                                        18030099
           EVALUATE TRUE                                                18040099
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 18050099
                   CONTINUE                                             18060099
               WHEN OTHER                                               18070099
                   MOVE '8140-REWRITE-TCPIPPRQ-NEXT-REC'                18080099
                                   TO DP013-PARAGRAPH                   18090099
                   MOVE 'UNABLE TO REWRITE THE FOLLOWING TEMPORARY STORA18100099
      -                 'STORAGE QUEUE: '                               18110099
                                   TO DP013-MESSAGE-TEXT (1)            18120099
                   MOVE PV-TSQ-NAME                                     18130099
                                   TO DP013-MESSAGE-TEXT (2)            18131099
                   SET DP013-CICS-ABEND                                 18140099
                       DP013-NO-ROLLBACK                                18150099
                                   TO TRUE                              18151099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      18160099
                   PERFORM 9100-EXEC-CICS-RETURN                        18170099
           END-EVALUATE.                                                18180099
      *                                                                 18190099
      ******************************************************************18200099
       8150-REWRITE-TCPIPPRQ-RECORD1.                                   18210099
           MOVE LENGTH OF PV-TCPIPPRQ-RECORD1                           18220099
                                   TO PV-TSQ-LENGTH.                    18221099
           MOVE +1                 TO PV-ITEM-NBR.                      18230099
                                                                        18240099
           EXEC CICS                                                    18250099
               WRITEQ TS                                                18260099
                   QUEUE   (PV-TSQ-NAME)                                18270099
                   FROM    (PV-TCPIPPRQ-RECORD1)                        18280099
                   LENGTH  (PV-TSQ-LENGTH)                              18290099
                   ITEM    (PV-ITEM-NBR)                                18300099
                       REWRITE                                          18310099
                   RESP    (PV-CICS-RESPONSE)                           18320099
           END-EXEC.                                                    18330099
                                                                        18340099
           EVALUATE TRUE                                                18350099
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 18360099
                   CONTINUE                                             18370099
               WHEN OTHER                                               18380099
                   MOVE '8150-REWRITE-TCPIPPRQ-RECORD1'                 18390099
                                   TO DP013-PARAGRAPH                   18400099
                   MOVE 'UNABLE TO REWRITE A RECORD TO THE FOLLOWING'   18410099
                                   TO DP013-MESSAGE-TEXT (1)            18420099
                   MOVE 'TEMPORARY STORAGE QUEUE: '                     18430099
                                   TO DP013-MESSAGE-TEXT (2)            18440099
                   MOVE PV-TSQ-NAME                                     18450099
                                   TO DP013-MESSAGE-TEXT (3)            18451099
                   MOVE PV-TCPIPPRQ-RECORD1                             18460099
                                   TO DP013-MESSAGE-TEXT (4)            18461099
                   SET DP013-CICS-ABEND                                 18470099
                       DP013-NO-ROLLBACK                                18480099
                                   TO TRUE                              18481099
                   PERFORM 9999-WRITE-CICS-LOG-MSG                      18490099
                   PERFORM 9100-EXEC-CICS-RETURN                        18500099
           END-EVALUATE.                                                18510099
      *                                                                 18520099
      ******************************************************************18530099
       8160-DEQ-TCPIPPRQ.                                               18540099
           EXEC CICS                                                    18550099
               DEQ                                                      18560099
                   RESOURCE  (PV-TSQ-NAME)                              18570099
                   RESP      (PV-CICS-RESPONSE)                         18580099
           END-EXEC.                                                    18590099
                                                                        18600099
           EVALUATE TRUE                                                18610099
               WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 18620099
                   CONTINUE                                             18630099
               WHEN OTHER                                               18640099
                   MOVE '8160-DEQ-TCPIPPRQ'                             18650099
                                   TO DP013-PARAGRAPH                   18651099
                   MOVE 'UNABLE TO DEQ THE FOLLOWING TEMPORARY STORAGE Q18660099
      -                 'UEUE: '                                        18670099
                                   TO DP013-MESSAGE-TEXT (1)            18680099
                   MOVE PV-TSQ-NAME                                     18690099
                                   TO DP013-MESSAGE-TEXT (2)            18691099
                   SET DP013-CICS-ABEND                                 18700099
                       DP013-NO-ROLLBACK                                18710099
                                   TO TRUE                              18711099
                 PERFORM 9999-WRITE-CICS-LOG-MSG                        18720099
                 PERFORM 9100-EXEC-CICS-RETURN                          18730099
           END-EVALUATE.                                                18740099
                                                                        18750099
       8500-MQ-SETUP.                                                   18760099
                                                                        18770099
      * DETERMINE THE SYSTEM                                            18780099
                                                                        18790099
           PERFORM EP000-0000-INITIALIZE.                               18800099
           IF EP000-PV-KOHLS-PROD-SYSTEM                                18810099
               SET PV-PROD-QMGR-NAME                                    18820099
                                   TO TRUE                              18821099
           ELSE                                                         18830099
               IF EP000-PV-KOHLS-QA-SYSTEM                              18840099
                   SET PV-QA-QMGR-NAME                                  18850099
                                   TO TRUE                              18851099
               ELSE                                                     18860099
                   SET PV-TEST-QMGR-NAME                                18870099
                                   TO TRUE                              18880099
               END-IF                                                   18890099
           END-IF.                                                      18900099
                                                                        18910099
      ***************************************************************   18920099
      *    CONNECT TO THE QUEUE MANAGER                                 18930099
      ***************************************************************   18940099
                                                                        18950099
           MOVE PV-QMGR-NAME       TO PV-QM-NAME.                       18960099
           CALL WS-MQCONN USING PV-QM-NAME                              18970099
                                PV-HCONN                                18980099
                                PV-COMPLETION-CODE                      18990099
                                PV-REASON.                              19000099
                                                                        19010099
      ***************************************************************   19020099
      *    IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE              19030099
      *    AND EXIT                                                     19040099
      ***************************************************************   19050099
                                                                        19060099
           MOVE PV-REASON          TO PV-CON-REASON.                    19070099
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   19080099
               MOVE 'MQCONN ERROR' TO PV-ERROR-MESSAGE                  19090099
               MOVE '8500-MQ-SETUP'                                     19100099
                                   TO DP013-PARAGRAPH                   19101099
               MOVE  PV-ERROR-MESSAGE                                   19110099
                                   TO DP013-MESSAGE-TEXT (1)            19111099
               MOVE  PV-COMPLETION-CODE                                 19120099
                                   TO DP013-MESSAGE-TEXT (2)            19121099
               MOVE  PV-REASON     TO DP013-MESSAGE-TEXT (3)            19130099
               SET DP013-CICS-ABEND                                     19140099
                   DP013-NO-ROLLBACK                                    19150099
                                   TO TRUE                              19151099
               PERFORM 9999-WRITE-CICS-LOG-MSG                          19160099
               PERFORM 9100-EXEC-CICS-RETURN                            19170099
           END-IF.                                                      19180099
                                                                        19190099
                                                                        19200099
       8510-MQ-SETUP-REMOTE.                                            19210099
      ***************************************************************   19220099
      *    OPEN THE RF.RESPONSE.Q QUEUE FOR OUTPUT.                     19230099
      *    THIS IS A REMOTE QUEUE.                                      19240099
      ***************************************************************   19250099
                                                                        19260099
           COMPUTE PV-OPEN-OPTIONS = MQOO-OUTPUT +                      19270099
                                     MQOO-FAIL-IF-QUIESCING.            19280099
                                                                        19290099
           MOVE TF047-REPLYTOQ     TO MQOD-OBJECTNAME.                  19300099
           MOVE TF047-REPLYTOQMGR  TO MQOD-OBJECTQMGRNAME.              19310099
                                                                        19320099
           CALL WS-MQOPEN USING PV-HCONN                                19330099
                                MQM-OBJECT-DESCRIPTOR                   19340099
                                PV-OPEN-OPTIONS                         19350099
                                PV-PQ-HANDLE                            19360099
                                PV-COMPLETION-CODE                      19370099
                                PV-REASON.                              19380099
                                                                        19390099
      ********************************************************          19400099
      *    IF OPEN FAILED THEN DISPLAY ERROR MESSAGE                    19410099
      *    AND EXIT.                                                    19420099
      ********************************************************          19430099
      *                                                                 19440099
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   19450099
               PERFORM 8600-CLOSE-PUT-Q                                 19460099
               PERFORM 8610-DISCONNECT-QMGR                             19470099
               MOVE 'MQOPEN WRITE Q'                                    19480099
                                   TO PV-ERROR-MESSAGE                  19481099
               MOVE '8510-MQ-SETUP-REMOTE'                              19490099
                                   TO DP013-PARAGRAPH                   19491099
               MOVE  PV-ERROR-MESSAGE                                   19500099
                                   TO DP013-MESSAGE-TEXT (1)            19501099
               MOVE  PV-COMPLETION-CODE                                 19510099
                                   TO DP013-MESSAGE-TEXT (2)            19511099
               MOVE  PV-REASON     TO DP013-MESSAGE-TEXT (3)            19520099
               SET DP013-CICS-ABEND                                     19530099
                   DP013-NO-ROLLBACK                                    19540099
                                   TO TRUE                              19541099
               PERFORM 9999-WRITE-CICS-LOG-MSG                          19550099
               PERFORM 9100-EXEC-CICS-RETURN                            19560099
           END-IF.                                                      19570099
           MOVE PV-PQ-HANDLE       TO PV-FMT-OPEN-OUTPUT-HNDL.          19580099
      *                                                                 19590099
      ******************************************************************19600099
       8520-PUT-QUEUE.                                                  19610099
           MOVE TF047-REPLYTOQMGR  TO MQOD-OBJECTQMGRNAME.              19620099
           MOVE TF047-REPLYTOQ     TO MQOD-OBJECTNAME.                  19630099
           MOVE TF047-MSGID        TO MQMD-CORRELID.                    19640099
           MOVE MQMI-NONE          TO MQMD-MSGID.                       19650099
           MOVE MQFMT-STRING       TO MQMD-FORMAT.                      19660099
           MOVE 5000               TO MQMD-EXPIRY.                      19670099
           MOVE LENGTH OF TF048-XFER-TO-PTC-RECORD                      19680099
                                   TO PV-DATA-LENGTH.                   19690099
           MOVE TF048-XFER-TO-PTC-RECORD                                19700099
                                   TO PV-MSGBUFFER.                     19701099
           MOVE MQPER-PERSISTENT   TO MQMD-PERSISTENCE.                 19710099
                                                                        19720099
           COMPUTE MQPMO-CONTEXT  =  PV-PQ-HANDLE.                      19730099
                                                                        19740099
                                                                        19750099
                                                                        19760099
           CALL WS-MQPUT USING PV-HCONN                                 19770099
                               PV-FMT-OPEN-OUTPUT-HNDL                  19780099
                               MQM-MESSAGE-DESCRIPTOR                   19790099
                               MQM-PUT-MESSAGE-OPTIONS                  19800099
                               PV-DATA-LENGTH                           19810099
                               PV-MSGBUFFER                             19820099
                               PV-COMPLETION-CODE                       19830099
                               PV-REASON.                               19840099
                                                                        19850099
      ***********************************************************       19860099
      *        IF PUT FAILED THEN DISPLAY ERROR MESSAGE                 19870099
      *        AND BREAK OUT OF LOOP                                    19880099
      ***********************************************************       19890099
                                                                        19900099
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   19910099
                  MOVE PV-COMPLETION-CODE                               19920099
                                   TO PH-COMPLETION-CODE                19921099
                  MOVE PV-REASON   TO PH-REASON                         19930099
                  PERFORM 8600-CLOSE-PUT-Q                              19940099
                  PERFORM 8610-DISCONNECT-QMGR                          19950099
                  MOVE 'MQPUT ERR' TO PV-ERROR-MESSAGE                  19960099
                  MOVE '8520-PUT-QUEUE'                                 19970099
                                   TO DP013-PARAGRAPH                   19971099
                  MOVE PV-ERROR-MESSAGE                                 19980099
                                   TO DP013-MESSAGE-TEXT (1)            19981099
                  MOVE PH-COMPLETION-CODE                               19990099
                                   TO DP013-MESSAGE-TEXT (2)            19991099
                  MOVE PH-REASON   TO DP013-MESSAGE-TEXT (3)            20000099
                  SET DP013-CICS-ABEND                                  20010099
                      DP013-NO-ROLLBACK                                 20020099
                                   TO TRUE                              20021099
                  PERFORM 9999-WRITE-CICS-LOG-MSG                       20030099
                  PERFORM 9100-EXEC-CICS-RETURN                         20040099
           ELSE                                                         20050099
              SET PS-MQPUT-SUCCESSFUL                                   20060099
                                   TO TRUE                              20061099
           END-IF.                                                      20070099
      *                                                                 20080099
      ******************************************************************20090099
       8600-CLOSE-PUT-Q.                                                20100099
           CALL WS-MQCLOSE USING PV-HCONN                               20110099
                                 PV-PQ-HANDLE                           20120099
                                 MQCO-NONE                              20130099
                                 PV-COMPLETION-CODE                     20140099
                                 PV-REASON.                             20150099
           IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   20160099
               MOVE 'MQCLOSE PQ HANDLE'                                 20170099
                                   TO PV-ERROR-MESSAGE                  20171099
               MOVE '8600-CLOSE-PUT-Q'                                  20180099
                                   TO DP013-PARAGRAPH                   20181099
               MOVE  PV-ERROR-MESSAGE                                   20190099
                                   TO DP013-MESSAGE-TEXT (1)            20191099
               MOVE  PV-COMPLETION-CODE                                 20200099
                                   TO DP013-MESSAGE-TEXT (2)            20201099
               MOVE  PV-REASON     TO DP013-MESSAGE-TEXT (3)            20210099
               SET DP013-CICS-ABEND                                     20220099
                   DP013-NO-ROLLBACK                                    20230099
                                   TO TRUE                              20231099
               PERFORM 9999-WRITE-CICS-LOG-MSG                          20240099
               PERFORM 9100-EXEC-CICS-RETURN                            20250099
           END-IF.                                                      20260099
      *                                                                 20270099
      ******************************************************************20280099
       8610-DISCONNECT-QMGR.                                            20290099
                                                                        20300099
           IF PV-CON-REASON IS NOT EQUAL                                20310099
                                   TO MQRC-ALREADY-CONNECTED            20311099
              CALL WS-MQDISC USING PV-HCONN                             20320099
                                   PV-COMPLETION-CODE                   20330099
                                   PV-REASON                            20340099
              IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                20350099
                  MOVE 'MQDISC'    TO PV-ERROR-MESSAGE                  20360099
                  MOVE '8610-DISCONNECT'                                20370099
                                   TO DP013-PARAGRAPH                   20371099
                  MOVE PV-ERROR-MESSAGE                                 20380099
                                   TO DP013-MESSAGE-TEXT (1)            20381099
                  MOVE PV-COMPLETION-CODE                               20390099
                                   TO DP013-MESSAGE-TEXT (2)            20391099
                  MOVE PV-REASON   TO DP013-MESSAGE-TEXT (3)            20400099
                  SET DP013-CICS-ABEND                                  20410099
                      DP013-NO-ROLLBACK                                 20420099
                                   TO TRUE                              20421099
                  PERFORM 9999-WRITE-CICS-LOG-MSG                       20430099
                  PERFORM 9100-EXEC-CICS-RETURN                         20440099
              END-IF                                                    20450099
           END-IF.                                                      20460099
                                                                        20470099
      *                                                                 20480099
      ******************************************************************20490099
      *    LINK TO THE MESSAGE FORMAT SUB-ROUTINE FOR NON-CICS          20500099
      *    ARCHITECTURE PROGRAMS.  THIS MESSAGE IS PASSED IN THE DATA   20510099
      *    STREAM BEING SENT BACK TO THE PTC.                           20520099
      ******************************************************************20530099
       9000-FMT-ERR-MSG-TO-PTC.                                         20540099
           PERFORM DP011-0000-FORMAT-MSG-LINES.                         20550099
           MOVE DP011-MSG-LEVEL    TO  TF048-ERR-TYP-IND.               20560099
           MOVE DP011-MSG-TEXT     TO  TF048-ERR-MSG.                   20570099
      *                                                                 20580099
       9100-EXEC-CICS-RETURN.                                           20590099
           EXEC CICS                                                    20600099
               RETURN                                                   20610099
           END-EXEC.                                                    20620099
      *                                                                 20630099
       9999-WRITE-CICS-LOG-MSG.                                         20640099
           MOVE PC-CURRENT-PROGRAM-NAME                                 20650099
                                   TO  DP013-PROGRAM.                   20651099
           MOVE DFHEIBLK           TO  DP013-DFHEIBLK.                  20660099
                                                                        20670099
           INITIALIZE DP013-SRC-TASK-NUMBER                             20680099
                      DP013-STACK.                                      20690099
                                                                        20700099
           SET DP013-LINK-RETURN   TO  TRUE.                            20710099
                                                                        20720099
           EXEC CICS                                                    20730099
               LINK                                                     20740099
                   PROGRAM   (DP013-NAME)                               20750099
                   COMMAREA  (DP013-PARAMETERS)                         20760099
                   LENGTH    (DP013-LENGTH)                             20770099
           END-EXEC.                                                    20780099
                                                                        20790099
      *                                                                 20800099
      *    NON-CICS ARCHITECTURE SYSTEM MESSAGE FORMAT MODULE           20810099
      *                                                                 20820099
                                                                        20830099
           COPY DPPD011.                                                20840099
      *                                                                 20850099
      *    NON-CICS ARCHITECTURE ABEND ROUTINE CALL                     20860099
      *                                                                 20870099
                                                                        20880099
           COPY DPPD014.                                                20890099
                                                                        20900099
           COPY EPPD000.                                                20910099
