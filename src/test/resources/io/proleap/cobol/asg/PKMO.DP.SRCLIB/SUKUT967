000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'CREATE DIVERT RECORD FROM DEMATIC FILE-OWDC '             00020000
000210***********************************************************       00021002
000220* AFTER OWDC OPENING - D334 & D337 WEREN'T SENDING DIVERTS*       00022002
000221***********************************************************       00022103
000222* 02/22/2010                                              *       00022203
000223* AFTER OWDC PUT IN RESOURCE DIRECTOR - THEY FOUND THAT   *       00022303
000224* CARTON DIVERTS FOR 4 DOORS WERE NOT SENT.  THIS JOB     *       00022403
000225* WILL CONVERT THE FILE FROM DEMATIC IN SURD014 FORMAT    *       00022503
000226* THE FILE WILL THEN BE FED INTO SUKUT557 TO CREATE THE   *       00022603
000227* CARTON DIVERT RECORD                                    *       00022703
000230***********************************************************       00023002
000300                                                                  00030000
000400 PROGRAM-ID.             SUKUT967.                                00040000
000500 AUTHOR.                 DENISE HAHN.                             00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            AUGUST, 2008.                            00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000                                                                  00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200                                                                  00120000
001300 CONFIGURATION SECTION.                                           00130000
001400                                                                  00140000
001500 SOURCE-COMPUTER.        IBM-3090.                                00150000
001600 OBJECT-COMPUTER.        IBM-3090.                                00160000
001700                                                                  00170000
001800 INPUT-OUTPUT SECTION.                                            00180000
001900                                                                  00190000
002000 FILE-CONTROL.                                                    00200000
002100                                                                  00210000
002200                                                                  00220000
002210     SELECT SU-DIVERT-FILE-IN           ASSIGN TO IN01.           00221000
002211     SELECT SU-DIVERT-FILE-OUT          ASSIGN TO OUT01.          00221100
002212                                                                  00221200
002213 DATA DIVISION.                                                   00221300
002214 FILE SECTION.                                                    00221400
002215                                                                  00221500
002216                                                                  00221600
002217 FD  SU-DIVERT-FILE-IN                                            00221700
002218     RECORDING MODE IS F                                          00221800
002219     LABEL RECORDS ARE STANDARD                                   00221901
002220     BLOCK CONTAINS 0 RECORDS.                                    00222001
002230 01  SU-DIVERT-RECORD-IN.                                         00223000
002237     05  SU-DIVERT-TIME               PIC X(12).                  00223704
002238     05  SU-DIVERT-TIME-R REDEFINES SU-DIVERT-TIME.               00223800
002239         10  SU-DIVERT-HOUR           PIC 9(02).                  00223900
002240         10  FILLER                   PIC X(01).                  00224000
002241         10  SU-DIVERT-MIN            PIC 9(02).                  00224100
002242         10  FILLER                   PIC X(01).                  00224200
002243         10  SU-DIVERT-SEC            PIC 9(02).                  00224300
002244         10  FILLER                   PIC X(01).                  00224403
002245         10  SU-DIVERT-MICRO          PIC 9(03).                  00224503
002246     05  SU-FILLER-1                  PIC X(01).                  00224603
002247     05  SU-DIVERT-DATE               PIC X(10).                  00224700
002248     05  SU-DIVERT-DATE-R REDEFINES SU-DIVERT-DATE.               00224800
002251         10  SU-DIVERT-MM             PIC 9(02).                  00225100
002252         10  FILLER                   PIC X(01).                  00225200
002253         10  SU-DIVERT-DD             PIC 9(02).                  00225300
002254         10  FILLER                   PIC X(01).                  00225403
002255         10  SU-DIVERT-YY             PIC 9(04).                  00225503
002257     05  SU-FILLER-2                  PIC X(01).                  00225703
002260     05  SU-SML-NUMBER                PIC X(20).                  00226003
002261     05  SU-SML-NUMBER-R REDEFINES SU-SML-NUMBER.                 00226103
002262         10  FILLER                   PIC X(05).                  00226203
002263         10  SU-STORE-NBR             PIC 9(04).                  00226303
002264         10  FILLER                   PIC 9(11).                  00226403
002266                                                                  00226600
002267 FD  SU-DIVERT-FILE-OUT                                           00226700
002268     RECORDING MODE IS F                                          00226800
002269     LABEL RECORDS ARE STANDARD                                   00226900
002270     BLOCK CONTAINS 0 RECORDS.                                    00227000
002271 01  SU-DIVERT-RECORD-OUT             PIC X(57).                  00227100
002272                                                                  00227200
002273                                                                  00227300
002274                                                                  00227400
002275 WORKING-STORAGE SECTION.                                         00227500
002276 01  PS-SWITCHES.                                                 00227600
002277     05  PS-EOF-INPUT-SW              PIC X(01) VALUE 'N'.        00227700
002280         88 PS-NOT-EOF-INPUT                    VALUE 'N'.        00228000
002290         88 PS-EOF-INPUT                        VALUE 'Y'.        00229000
002300                                                                  00230000
002400 01  PV-VARIABLES.                                                00240000
002500     05  PV-INPUT-COUNT               PIC  9(09) VALUE ZEROES.    00250000
002600     05  PV-OUTPUT-COUNT              PIC  9(09) VALUE ZEROES.    00260000
002700     05  PV-UNKNOWN-COUNT             PIC  9(09) VALUE ZEROES.    00270000
002800     05  PV-DATE.                                                 00280000
002900         10  PV-DIVERT-YY             PIC 9(04).                  00290000
002910         10  PV-DIVERT-MM             PIC 9(02).                  00291000
002920         10  PV-DIVERT-DD             PIC 9(02).                  00292000
002930     05  PV-TIME.                                                 00293000
002940         10  PV-DIVERT-HOUR           PIC 9(02).                  00294000
002950         10  PV-DIVERT-MIN            PIC 9(02).                  00295000
002951         10  PV-DIVERT-SEC            PIC 9(02).                  00295100
002952                                                                  00295200
002953     COPY SURD014.                                                00295300
002954                                                                  00295400
002955 PROCEDURE DIVISION.                                              00295500
002956     PERFORM 1000-INITIALIZE.                                     00295600
002957     PERFORM 2000-PROCESS UNTIL PS-EOF-INPUT.                     00295700
002958     PERFORM 9000-EOJ.                                            00295800
002959     GOBACK.                                                      00295900
002960                                                                  00296000
002970 1000-INITIALIZE.                                                 00297000
002980                                                                  00298000
002990     OPEN INPUT  SU-DIVERT-FILE-IN                                00299000
003000          OUTPUT SU-DIVERT-FILE-OUT.                              00300000
003100                                                                  00310000
003200     PERFORM 1200-READ-INPUT.                                     00320000
003300                                                                  00330000
003400 1200-READ-INPUT.                                                 00340000
003500                                                                  00350000
003600     READ SU-DIVERT-FILE-IN                                       00360000
003700     AT END                                                       00370000
003800         SET PS-EOF-INPUT   TO TRUE                               00380000
003900     NOT AT END                                                   00390000
004000         ADD 1              TO PV-INPUT-COUNT                     00400000
004100     END-READ.                                                    00410000
004200                                                                  00420000
004300 2000-PROCESS.                                                    00430000
004400                                                                  00440000
004500     INITIALIZE  SU014-CONV-DIVERT-RECORD.                        00450000
004600     MOVE  890               TO  SU014-DC-NUMBER.                 00460000
004700     MOVE  0                 TO  SU014-MESSAGE-SEQ-NUMBER.        00470000
004800     MOVE  SU-SML-NUMBER     TO  SU014-BAR-CODE.                  00480000
004900                                                                  00490000
005000     MOVE  SU-DIVERT-YY      TO  PV-DIVERT-YY.                    00500000
005100     MOVE  SU-DIVERT-MM      TO  PV-DIVERT-MM.                    00510000
005200     MOVE  SU-DIVERT-DD      TO  PV-DIVERT-DD.                    00520000
005300                                                                  00530000
005400     MOVE  SU-DIVERT-HOUR    TO  PV-DIVERT-HOUR.                  00540000
005410     MOVE  SU-DIVERT-MIN     TO  PV-DIVERT-MIN.                   00541000
005420     MOVE  SU-DIVERT-SEC     TO  PV-DIVERT-SEC.                   00542000
005430                                                                  00543000
005440     MOVE  PV-DATE           TO  SU014-DATE.                      00544000
005450     MOVE  PV-TIME           TO  SU014-TIME.                      00545000
005460     MOVE  ';'               TO  SU014-CARRIAGE-RETURN.           00546000
005470                                                                  00547000
005480     IF  SU-STORE-NBR            =   78                           00548003
005500         MOVE   2            TO  SU014-DIVERT-NUMBER              00550003
005600         MOVE   'D209'       TO  SU014-DOOR-NUMBER                00560003
005700         PERFORM 8000-WRITE-EXTRACT-RECORD                        00570000
005800         ADD  1  TO  PV-OUTPUT-COUNT                              00580000
005900     ELSE                                                         00590000
005901     IF  SU-STORE-NBR            =   99                           00590103
005903         MOVE   3            TO  SU014-DIVERT-NUMBER              00590303
005904         MOVE   'D210'       TO  SU014-DOOR-NUMBER                00590403
005905         PERFORM 8000-WRITE-EXTRACT-RECORD                        00590500
005906         ADD  1  TO  PV-OUTPUT-COUNT                              00590600
005907     ELSE                                                         00590703
005908     IF  SU-STORE-NBR            =   347                          00590803
005909         MOVE   4            TO  SU014-DIVERT-NUMBER              00590903
005910         MOVE   'D211'       TO  SU014-DOOR-NUMBER                00591003
005920         PERFORM 8000-WRITE-EXTRACT-RECORD                        00592003
005930         ADD  1  TO  PV-OUTPUT-COUNT                              00593003
005940     ELSE                                                         00594003
005950     IF  SU-STORE-NBR            =   218                          00595003
005960         MOVE   5            TO  SU014-DIVERT-NUMBER              00596003
005970         MOVE   'D212'       TO  SU014-DOOR-NUMBER                00597003
005980         PERFORM 8000-WRITE-EXTRACT-RECORD                        00598003
005990         ADD  1  TO  PV-OUTPUT-COUNT                              00599003
006208     ELSE                                                         00620800
006209         ADD  1  TO  PV-UNKNOWN-COUNT                             00620900
006210         DISPLAY SU-DIVERT-RECORD-IN                              00621000
006220     END-IF.                                                      00622000
006230                                                                  00623000
006240     PERFORM 1200-READ-INPUT.                                     00624000
006250                                                                  00625000
006260                                                                  00626000
006270 8000-WRITE-EXTRACT-RECORD.                                       00627000
006280     WRITE SU-DIVERT-RECORD-OUT                                   00628000
006290      FROM SU014-CONV-DIVERT-RECORD.                              00629000
006300                                                                  00630000
006400/                                                                 00640000
006500 9000-EOJ.                                                        00650000
006600                                                                  00660000
006700     CLOSE SU-DIVERT-FILE-IN                                      00670000
006800           SU-DIVERT-FILE-OUT.                                    00680000
006900                                                                  00690000
007000     DISPLAY 'SUKUT967'.                                          00700000
007100     DISPLAY 'INPUT COUNT   - ' PV-INPUT-COUNT.                   00710000
007200     DISPLAY 'OUTPUT COUNT  - ' PV-OUTPUT-COUNT.                  00720000
007300     DISPLAY 'UNKNOWN COUNT - ' PV-UNKNOWN-COUNT.                 00730000
007400                                                                  00740000
