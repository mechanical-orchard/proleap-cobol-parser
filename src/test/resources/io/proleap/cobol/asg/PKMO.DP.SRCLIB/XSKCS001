       IDENTIFICATION DIVISION.                                         00010030
       PROGRAM-ID.         XSKCS001.                                    00060030
       AUTHOR.             STEVE KRIEG.                                 00070030
       INSTALLATION.       KOHLS DEPARTMENT STORES.                     00080030
       DATE-WRITTEN.       FEBRUARY 2003.                               00090030
                                                                        00100030
      ****************************************************************  00020030
      *  XSKCS001 - WRAPPER FOR XSKUT061 PRICE DETERMINATION PROCESS    00030030
      *             FOR JAVA PROGRAMS USING MQSERIES.                   00040030
      ****************************************************************  00050030
      ******************************************************************        
      * 07/14/03  - KARI HAAK   -  WR21770                             *        
      * - INITIALIZED THE NEW START AND END TIMESTAMPS AND ADDED THEM  *        
      *   TO THE DISPLAY LOGIC.                                        *        
      ******************************************************************        
      * 07/21/03  - KARI HAAK   -  WR21770                             *        
      * - MODIFIED 2300-POST-REPLY TO ACCOMMODATE THE NEW TIMESTAMPS.  *        
      *   NOW MOVING 830 TO PV-MSGLENGTH INSTEAD OF 570 AND CHANGED    *        
      *   PV-MSGBUFFER(1:570) TO PV-MSGBUFFER(1:830)                   *        
      ******************************************************************        
      * 09/17/03  - KARI HAAK   -  WR21770                             *        
      * - MODIFIED 2300-POST-REPLY TO ACCOMMODATE EBOGO.               *        
      *   NOW MOVING 895 TO PV-MSGLENGTH INSTEAD OF 830 AND CHANGED    *        
      *   PV-MSGBUFFER(1:830) TO PV-MSGBUFFER(1:895)                   *        
      ******************************************************************        
      * 01/12/03  - KARI HAAK   -  WR25854                             *        
      * - MODIFIED 2300-POST-REPLY TO ACCOMMODATE EBOGO $ AND %.       *        
      *   NOW MOVING 910 TO PV-MSGLENGTH INSTEAD OF 895 AND CHANGED    *        
      *   PV-MSGBUFFER(1:895) TO PV-MSGBUFFER(1:910)                   *        
      ******************************************************************        
      ****************************************************************  00110030
      * ENVIRONMENT DIVISION                                            00120030
      ****************************************************************  00130030
       ENVIRONMENT DIVISION.                                            00140030
       CONFIGURATION SECTION.                                           00150030
       SOURCE-COMPUTER.    IBM.                                         00160030
       OBJECT-COMPUTER.    IBM.                                         00170030
                                                                        00180030
      ****************************************************************  00190030
      * DATA DIVISION                                                   00200030
      ****************************************************************  00210030
       DATA DIVISION.                                                   00220030
       WORKING-STORAGE SECTION.                                         00230030
       01  PC-BEGIN-STORAGE                PIC X(36)  VALUE             00240030
                                 'XSKCS001 WORKING-STORAGE BEGINS HERE'.00250030
                                                                        00260030
      ****************************************************************  00270030
      * PROGRAM CONSTANTS                                               00280030
      ****************************************************************  00290030
       01  PC-PROGRAM-CONSTANTS.                                        00300030
           05  PC-PGM-NAME             PIC X(08) VALUE 'XSKCS001'.      00310030
           05  PC-PRICE-DET-ENGINE     PIC X(08) VALUE 'XSKUT061'.      00320030
           05  PC-QMGR-NAME            PIC X(48) VALUE 'QKST'.          00330030
               88  PC-QMGR-PROD                  VALUE 'QKSP'.          00340030
               88  PC-QMGR-QA                    VALUE 'QKSQ'.          00350030
               88  PC-QMGR-TEST                  VALUE 'QKST'.          00360030
           05  PC-DATA-COLLECT-QNAME   PIC X(48) VALUE                  00370030
                          'XS.PRICE.DETERMINATION.REQUEST.Q'.           00380030
           05  PC-FIFTY-STARS          PIC X(50) VALUE ALL '*'.         00390030
           05  PC-ABEND-4020           PIC S9(4) COMP SYNC VALUE +4020. 00400030
                                                                        00410030
      ****************************************************************  00420030
      * PRICE DETERMINATION RECORD LAYOUT COPYBOOK                      00430030
      ****************************************************************  00440030
           COPY XSRD047.                                                00450030
                                                                        00460030
      ****************************************************************  00470030
      * MQSERIES COMPLETION CODES COPYBOOK                              00480030
      ****************************************************************  00490030
           COPY ISWS005.                                                00500030
                                                                        00510030
      ****************************************************************  00520030
      * PROGRAM VARIBLES                                                00530030
      ****************************************************************  00540030
       01  PV-PROGRAM-VARIABLES.                                        00550030
           05  PV-SUB                  PIC S9(4) COMP SYNC              00720030
                                                 VALUE ZEROES.                  
           05  PV-NUM-EDIT             PIC ZZZZZZZ.ZZZ.                 00560030
           05  PV-QM-NAME              PIC X(48).                       00560030
           05  PV-DATA-COLLECT-QNAME   PIC X(48).                       00570030
           05  PV-HCONN                PIC S9(9) BINARY VALUE 0.        00580030
           05  PV-OPEN-OPTIONS         PIC S9(9) BINARY.                00590030
           05  PV-HANDLE               PIC S9(9) BINARY VALUE 0.        00600030
           05  PV-COMPLETION-CODE      PIC S9(9) BINARY.                00610030
           05  PV-REASON               PIC S9(9) BINARY.                00620030
           05  PV-CON-REASON           PIC S9(9) BINARY.                00630030
           05  PV-MSGBUFFER.                                            00640030
               10  PV-MSGBUFFER-ARRAY  PIC X(1) OCCURS 1000 TIMES.      00650030
           05  PV-MSGLENGTH            PIC S9(9) BINARY VALUE 1000.     00660030
           05  PV-DATA-LENGTH          PIC S9(9) BINARY.                00670030
           05  PV-ACTION               PIC X(60)        VALUE SPACES.   00680030
           05  PV-SYSID                PIC X(4).                        00690030
           05  PV-REQUESTS             PIC S9(9) COMP-3 VALUE ZERO.     00700030
           05  PV-DISPLAY-REQUESTS     PIC ZZZ,ZZZ,ZZ9.                 00710030
           05  PV-ABEND-CODE           PIC S9(4) COMP SYNC VALUE 4020.  00720030
                                                                        00730030
      ****************************************************************  00740030
      * MQ CALLED PROGRAMS                                              00750030
      ****************************************************************  00760030
       01  WS-MQCONN                   PIC X(8)  VALUE 'CSQCCONN'.      00770030
       01  WS-MQOPEN                   PIC X(8)  VALUE 'CSQCOPEN'.      00780030
       01  WS-MQINQ                    PIC X(8)  VALUE 'CSQCINQ'.       00790030
       01  WS-MQGET                    PIC X(8)  VALUE 'CSQCGET'.       00800030
       01  WS-MQPUT                    PIC X(8)  VALUE 'CSQCPUT'.       00810030
       01  WS-MQPUT1                   PIC X(8)  VALUE 'CSQCPUT1'.      00820030
       01  WS-MQCLOSE                  PIC X(8)  VALUE 'CSQCCLOS'.      00830030
       01  WS-MQDISC                   PIC X(8)  VALUE 'CSQCDISC'.      00840030
                                                                        00850030
      ****************************************************************  00860030
      * MQ API CONTROL BLOCKS                                           00870030
      ****************************************************************  00880030
       01  MQM-OBJECT-DESCRIPTOR.                                       00890030
           COPY CMQODV.                                                 00900030
                                                                        00910030
       01  MQM-MESSAGE-DESCRIPTOR.                                      00920030
           COPY CMQMDV.                                                 00930030
                                                                        00940030
       01  MQM-PUT-MESSAGE-OPTIONS.                                     00950030
           COPY CMQPMOV.                                                00960030
                                                                        00970030
       01  MQM-GET-MESSAGE-OPTIONS.                                     00980030
           COPY CMQGMOV.                                                00990030
                                                                        01000030
       01  MQM-CONSTANTS.                                               01010030
           COPY CMQV.                                                   01020030
                                                                        01030030
      **************************************************************    01040030
       01  PC-END-STORAGE.                                              01050030
           05  FILLER                         PIC X(34)    VALUE        01060030
                                   'XSKCS001 WORKING-STORAGE ENDS HERE'.01070030
       LINKAGE SECTION.                                                 01080030
       01  DFHCOMMAREA.                                                         
           05  FILLER                         OCCURS 1 TO 4072 TIMES            
                                              DEPENDING ON EIBCALEN.            
               10  FILLER                     PIC X(01).                        
                                                                                
      **************************************************************    01090030
      *         P R O C E D U R E   D I V I S I O N                *    01100030
      **************************************************************    01110030
       PROCEDURE DIVISION.                                              01120030
       0000-MAINLINE.                                                   01130030
                                                                        01140030
               MOVE SPACES TO PV-ACTION.                                01150030
               STRING 'START OF PROGRAM '                               01160030
                      PV-QM-NAME                                        01170030
                      DELIMITED BY SIZE INTO PV-ACTION.                 01180030
               PERFORM 4000-LOG-MESSAGE.                                01190030
                                                                        01200030
           PERFORM 1000-SETUP.                                          01210030
           PERFORM 2000-PROCESS-INCOMING-MESSAGE.                       01220030
           PERFORM 3000-CLEANUP.                                        01230030
                                                                        01240030
           GOBACK.                                                      01250030
                                                                        01260030
      **************************************************************    01270030
      * PROGRAM SETUP                                                   01280030
      **************************************************************    01290030
       1000-SETUP.                                                      01300030
                                                                        01310030
           EXEC CICS ASSIGN                                             01320030
               SYSID (PV-SYSID)                                         01330030
           END-EXEC.                                                    01340030
                                                                        01350030
           IF PV-SYSID(3:1) = 'P'                                       01360030
               SET PC-QMGR-PROD TO TRUE                                 01370030
           ELSE                                                         01380030
               IF PV-SYSID(3:1) = 'Q'                                   01390030
                   SET PC-QMGR-QA TO TRUE                               01400030
               ELSE                                                     01410030
                   SET PC-QMGR-TEST TO TRUE.                            01420030
                                                                        01430030
               MOVE SPACES TO PV-ACTION.                                01440030
               STRING 'ABOUT TO CONNECT TO MQ'                          01450030
                      PV-QM-NAME                                        01460030
                      DELIMITED BY SIZE INTO PV-ACTION.                 01470030
               PERFORM 4000-LOG-MESSAGE.                                01480030
                                                                        01490030
           PERFORM 1100-MQSERIES-CONNECT.                               01500030
                                                                        01510030
               MOVE SPACES TO PV-ACTION.                                01520030
               STRING 'ABOUT TO OPEN MQ '                               01530030
                      PV-QM-NAME                                        01540030
                      DELIMITED BY SIZE INTO PV-ACTION.                 01550030
               PERFORM 4000-LOG-MESSAGE.                                01560030
                                                                        01570030
           PERFORM 1200-MQSERIES-OPEN.                                  01580030
                                                                        01590030
      **************************************************************    01600030
      * CONNECT TO MQ SERIES MANAGER                                    01610030
      **************************************************************    01620030
       1100-MQSERIES-CONNECT.                                           01630030
                                                                        01640030
           MOVE PC-QMGR-NAME TO PV-QM-NAME                              01650030
           CALL WS-MQCONN USING PV-QM-NAME                              01660030
                                PV-HCONN                                01670030
                                PV-COMPLETION-CODE                      01680030
                                PV-REASON.                              01690030
                                                                        01700030
           MOVE PV-REASON TO PV-CON-REASON.                             01710030
                                                                        01720030
      * IF CONNECTION FAILS, LOG ERROR MESSAGE                          01730030
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        01740030
               STRING 'CONNECT - ' PV-QM-NAME                           01750030
                      DELIMITED BY SIZE INTO PV-ACTION                  01760030
               PERFORM 9001-MQSERIES-ERROR                              01770030
           END-IF.                                                      01780030
                                                                        01790030
           MOVE SPACES TO PV-ACTION.                                    01800030
           STRING 'MQCONN SUCCESSFUL TO ' PV-QM-NAME                    01810030
                  DELIMITED BY SIZE INTO PV-ACTION.                     01820030
                                                                        01830030
           PERFORM 4000-LOG-MESSAGE.                                    01840030
                                                                        01850030
      **************************************************************    01860030
      * OPEN MQ SERIES MANAGER                                          01870030
      **************************************************************    01880030
       1200-MQSERIES-OPEN.                                              01890030
                                                                        01900030
           COMPUTE PV-OPEN-OPTIONS        = MQOO-INPUT-SHARED           01910030
                                          + MQOO-FAIL-IF-QUIESCING.     01920030
           MOVE MQOT-Q                   TO MQOD-OBJECTTYPE.            01930030
           MOVE PV-QM-NAME               TO MQOD-OBJECTQMGRNAME.        01940030
           MOVE PC-DATA-COLLECT-QNAME    TO MQOD-OBJECTNAME.            01950030
                                                                        01960030
           CALL WS-MQOPEN USING PV-HCONN                                01970030
                                MQM-OBJECT-DESCRIPTOR                   01980030
                                PV-OPEN-OPTIONS                         01990030
                                PV-HANDLE                               02000030
                                PV-COMPLETION-CODE                      02010030
                                PV-REASON.                              02020030
                                                                        02030030
      * IF CONNECTION FAILS, LOG ERROR MESSAGE                          02040030
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        02050030
               STRING 'OPEN - ' PC-DATA-COLLECT-QNAME                   02060030
                      DELIMITED BY SIZE INTO PV-ACTION                  02070030
               PERFORM 9001-MQSERIES-ERROR                              02080030
           END-IF.                                                      02090030
                                                                        02100030
           MOVE SPACES TO PV-ACTION.                                    02110030
           STRING 'MQOPEN SUCCESSFUL FOR '                              02120030
                  PC-DATA-COLLECT-QNAME                                 02130030
                  DELIMITED BY SIZE INTO PV-ACTION.                     02140030
                                                                        02150030
           PERFORM 4000-LOG-MESSAGE.                                    02160030
                                                                        02170030
      **************************************************************    02180030
      * MAIN BODY OF PROGRAM                                            02190030
      **************************************************************    02200030
       2000-PROCESS-INCOMING-MESSAGE.                                   02210030
                                                                        02220030
           PERFORM 2100-GET-INCOMING-MESSAGE.                           02230030
                                                                        02240030
           PERFORM UNTIL PV-COMPLETION-CODE NOT = MQCC-OK               02250030
               PERFORM 2200-CALL-PRICE-DETERMINATION                    02260030
               PERFORM 2300-POST-REPLY                                  02270030
               PERFORM 2100-GET-INCOMING-MESSAGE                        02280030
           END-PERFORM.                                                 02290030
                                                                        02300030
      **************************************************************    02310030
      * GET MQ MESSAGES                                                 02320030
      **************************************************************    02330030
       2100-GET-INCOMING-MESSAGE.                                       02340030
                                                                        02350030
           MOVE MQMI-NONE       TO MQMD-MSGID.                          02360030
           MOVE MQCI-NONE       TO MQMD-CORRELID.                       02370030
                                                                        02380030
      * PROD: WAIT 50 MINUTES (3,000,000 MILLISECONDS) FOR MESSAGES     02390030
      * OTHER: WAIT ONLY 30 MINUTES (1,800,000 MILLISECONDS) FOR MESSAGE02400030
      * OTHER: WAIT ONLY 10 MINUTES (600,000 MILLISECONDS) FOR MESSAGES 02410030
      * OTHER: WAIT ONLY 2 MINUTES (120,000 MILLISECONDS) FOR MESSAGES  02420030
      * THIS WILL ALLOW FOR QUICKER DEVELOPMENT TURN AROUND TIME        02430030
           IF PV-SYSID (3:1) = 'P'                                      02440030
               MOVE 3000000     TO MQGMO-WAITINTERVAL                   02450030
           ELSE                                                         02460030
      ******   MOVE 1800000     TO MQGMO-WAITINTERVAL                   02470030
               MOVE 600000      TO MQGMO-WAITINTERVAL                   02480030
      ******   MOVE 120000      TO MQGMO-WAITINTERVAL                   02490030
           END-IF.                                                      02500030
                                                                        02510030
           MOVE 1000            TO PV-MSGLENGTH.                        02520030
           COMPUTE MQGMO-OPTIONS = MQGMO-NO-SYNCPOINT                   02530030
                                 + MQGMO-WAIT                           02540030
                                 + MQGMO-CONVERT                        02550030
                                 + MQGMO-FAIL-IF-QUIESCING.             02560030
                                                                        02570030
               MOVE SPACES TO PV-ACTION.                                02580030
               STRING 'ABOUT TO GET MESSAGE '                           02590030
                      PV-QM-NAME                                        02600030
                      DELIMITED BY SIZE INTO PV-ACTION.                 02610030
               PERFORM 4000-LOG-MESSAGE.                                02620030
                                                                        02630030
           CALL WS-MQGET USING PV-HCONN                                 02640030
                               PV-HANDLE                                02650030
                               MQM-MESSAGE-DESCRIPTOR                   02660030
                               MQM-GET-MESSAGE-OPTIONS                  02670030
                               PV-MSGLENGTH                             02680030
                               PV-MSGBUFFER                             02690030
                               PV-DATA-LENGTH                           02700030
                               PV-COMPLETION-CODE                       02710030
                               PV-REASON.                               02720030
                                                                        02730030
               MOVE SPACES TO PV-ACTION.                                02740030
               STRING 'GET MESSAGE COMPLETE'                            02750030
                      PV-QM-NAME                                        02760030
                      DELIMITED BY SIZE INTO PV-ACTION.                 02770030
               PERFORM 4000-LOG-MESSAGE.                                02780030
                                                                        02790030
      * IF GET FAILS, LOG ERROR MESSAGE                                 02800030
           IF (PV-COMPLETION-CODE = MQCC-OK) OR                         02810030
              (PV-REASON          = MQRC-NO-MSG-AVAILABLE)              02820030
               CONTINUE                                                 02830030
           ELSE                                                         02840030
               STRING 'GET - ' PC-DATA-COLLECT-QNAME                    02850030
                      DELIMITED BY SIZE INTO PV-ACTION                  02860030
                                                                        02870030
               PERFORM 9001-MQSERIES-ERROR                              02880030
           END-IF.                                                      02890030
                                                                        02900030
      **************************************************************    02910030
      * CALL PRICE DETERMINATION ENGINE                                 02920030
      **************************************************************    02930030
       2200-CALL-PRICE-DETERMINATION.                                   02940030
                                                                        02950030
           INITIALIZE XS047-PRICE-DETERMINATION.                        02960030
                                                                        02970030
           MOVE PV-MSGBUFFER(1:76)  TO XS047-PRICE-DETERMINATION.       02980030
                                                                        02990030
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS047 LINKAGE: '                                     0030    
                  XS047-PRICE-DETERMINATION                             0030    
                  PV-QM-NAME                                            0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           PERFORM 4100-DISPLAY-PARMS.                                          
           PERFORM 4200-INITIALIZE-RETURN-VALUES.                               
                                                                        03270030
           CALL PC-PRICE-DET-ENGINE   USING DFHEIBLK                    03280030
                                            XS047-COMMAREA                      
                                            XS047-PRICE-DETERMINATION.          
                                                                        03300030
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'PDE RETURNED DATA'                                   0030    
                  PV-QM-NAME                                            0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                        03360030
           PERFORM 4300-DISPLAY-PARMS2.                                         
                                                                        04040030
      **************************************************************    04050030
      * POST MQ MESSAGE                                                 04060030
      **************************************************************    04070030
       2300-POST-REPLY.                                                 04080030
                                                                        04090030
           MOVE MQMD-REPLYTOQMGR     TO MQOD-OBJECTQMGRNAME.            04100030
           MOVE MQMD-REPLYTOQ        TO MQOD-OBJECTNAME.                04110030
           MOVE MQMD-MSGID           TO MQMD-CORRELID.                  04120030
           MOVE MQMI-NONE            TO MQMD-MSGID.                     04130030
           MOVE MQMT-REPLY           TO MQMD-MSGTYPE.                   04140030
           MOVE MQFMT-STRING         TO MQMD-FORMAT.                    04150030
           MOVE 3000000              TO MQMD-EXPIRY.                    04160030
           MOVE 910                  TO PV-MSGLENGTH.                   04170030
                                                                        04180030
           MOVE XS047-PRICE-DETERMINATION TO PV-MSGBUFFER.              04190030
                                                                        04200030
           MOVE MQPER-PERSISTENT     TO MQMD-PERSISTENCE.               04210030
           COMPUTE MQPMO-OPTIONS      = MQPMO-NO-SYNCPOINT              04220030
                                      + MQPMO-FAIL-IF-QUIESCING.        04230030
                                                                        04240030
           CALL WS-MQPUT1 USING PV-HCONN                                04250030
                                MQM-OBJECT-DESCRIPTOR                   04260030
                                MQM-MESSAGE-DESCRIPTOR                  04270030
                                MQM-PUT-MESSAGE-OPTIONS                 04280030
                                PV-MSGLENGTH                            04290030
                                PV-MSGBUFFER(1:910)                     04300030
                                PV-COMPLETION-CODE                      04310030
                                PV-REASON.                              04320030
                                                                        04330030
      * IF PUT1 FAILS, LOG ERROR MESSAGE                                04340030
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        04350030
               INSPECT MQOD-OBJECTQMGRNAME                              04360030
                   REPLACING ALL SPACE BY LOW-VALUE                     04370030
               INSPECT MQOD-OBJECTNAME                                  04380030
                   REPLACING ALL SPACE BY LOW-VALUE                     04390030
                                                                        04400030
               STRING 'PUT1 - ' MQMD-REPLYTOQMGR                        04410030
                      ' / ' MQMD-REPLYTOQ                               04420030
                      DELIMITED BY LOW-VALUE INTO PV-ACTION             04430030
                                                                        04440030
               PERFORM 9001-MQSERIES-ERROR                              04450030
                                                                        04460030
           END-IF.                                                      04470030
                                                                        04480030
           ADD 1 TO PV-REQUESTS.                                        04490030
                                                                        04500030
      **************************************************************    04510030
      * CLOSE AND CLEAN UP PROGRAM                                      04520030
      **************************************************************    04530030
       3000-CLEANUP.                                                    04540030
                                                                        04550030
           PERFORM 3100-MQSERIES-CLOSE.                                 04560030
           PERFORM 3200-MQSERIES-DISCONNECT.                            04570030
                                                                        04580030
           MOVE SPACES TO PV-ACTION.                                    04590030
           MOVE PV-REQUESTS TO PV-DISPLAY-REQUESTS.                     04600030
                                                                        04610030
           STRING PV-DISPLAY-REQUESTS                                   04620030
                  ' PRICE DETERMINATION REQUESTS PROCESSED.'            04630030
                  DELIMITED BY SIZE INTO PV-ACTION.                     04640030
                                                                        04650030
           PERFORM 4000-LOG-MESSAGE.                                    04660030
                                                                        04670030
      **************************************************************    04680030
      * CLOSE MQ SERIES MANAGER                                         04690030
      **************************************************************    04700030
       3100-MQSERIES-CLOSE.                                             04710030
                                                                        04720030
           CALL WS-MQCLOSE USING PV-HCONN                               04730030
                                 PV-HANDLE                              04740030
                                 MQCO-NONE                              04750030
                                 PV-COMPLETION-CODE                     04760030
                                 PV-REASON.                             04770030
                                                                        04780030
           IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        04790030
               STRING 'CLOSE - ' PC-DATA-COLLECT-QNAME                  04800030
                      DELIMITED BY SIZE INTO PV-ACTION                  04810030
                                                                        04820030
               PERFORM 9001-MQSERIES-ERROR                              04830030
           END-IF.                                                      04840030
                                                                        04850030
           MOVE SPACES TO PV-ACTION.                                    04860030
           STRING 'MQCLOSE SUCCESSFUL FOR '                             04870030
                  PC-DATA-COLLECT-QNAME                                 04880030
                  DELIMITED BY SIZE INTO PV-ACTION.                     04890030
                                                                        04900030
           PERFORM 4000-LOG-MESSAGE.                                    04910030
                                                                        04920030
      **************************************************************    04930030
      * DISCONNECT MQ SERIES MANAGER                                    04940030
      **************************************************************    04950030
       3200-MQSERIES-DISCONNECT.                                        04960030
                                                                        04970030
           IF PV-CON-REASON NOT = MQRC-ALREADY-CONNECTED                04980030
               CALL WS-MQDISC USING PV-HCONN                            04990030
                                    PV-COMPLETION-CODE                  05000030
                                    PV-REASON                           05010030
                                                                        05020030
               IF (PV-COMPLETION-CODE NOT = MQCC-OK)                    05030030
                   STRING 'DISCONNECT - ' PC-QMGR-NAME                  05040030
                          DELIMITED BY SIZE INTO PV-ACTION              05050030
                                                                        05060030
                   PERFORM 9001-MQSERIES-ERROR                          05070030
               END-IF                                                   05080030
                                                                        05090030
               MOVE SPACES TO PV-ACTION                                 05100030
               STRING 'MQDISC SUCCESSFUL FROM '                         05110030
                      PV-QM-NAME                                        05120030
                      DELIMITED BY SIZE INTO PV-ACTION                  05130030
                                                                        05140030
               PERFORM 4000-LOG-MESSAGE                                 05150030
           END-IF.                                                      05160030
                                                                        05170030
      ************************************************************      05180030
      * LOG MESSAGES ON MAINFRAME                                       05190030
      ************************************************************      05200030
       4000-LOG-MESSAGE.                                                05210030
                                                                        05220030
           EXEC CICS ASKTIME                                            05230030
               ABSTIME (IS-ABSTIME)                                     05240030
           END-EXEC.                                                    05250030
                                                                        05260030
           EXEC CICS FORMATTIME                                         05270030
               ABSTIME  (IS-ABSTIME)                                    05280030
               MMDDYYYY (IS-LOG-DATE)                                   05290030
               DATESEP                                                  05300030
               TIME     (IS-LOG-TIME)                                   05310030
               TIMESEP                                                  05320030
           END-EXEC.                                                    05330030
                                                                        05340030
           STRING ' ' PC-PGM-NAME                                       05350030
                  ' ' IS-LOG-DATE                                       05360030
                  ' ' IS-LOG-TIME                                       05370030
                  ' ' PV-ACTION                                         05380030
                  DELIMITED BY SIZE INTO IS-LOG-LINE.                   05390030
                                                                        05400030
           PERFORM 9002-ENQUEUE.                                        05410030
           PERFORM 9003-WRITEQ-TD.                                      05420030
           PERFORM 9004-DEQUEUE.                                        05430030
                                                                        05440030
      ************************************************************      05450030
      * ERROR MESSAGE HANDLER                                           05460030
      ************************************************************      05470030
           COPY ISPD005.                                                05480030
                                                                        05490030
       4100-DISPLAY-PARMS.                                                      
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 STORE:  '                                      0030    
                  XS047-STR                                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 DATE:   '                                      0030    
                  XS047-DTE                                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 TIME:   '                                      0030    
                  XS047-TM                                              0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PROMO-ID:  '                                   0030    
                  XS047-PROMO-ID                                        0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 INTR UPC ID:  '                                0030    
                  XS047-INTR-UPC-ID                                     0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 SKU:  '                                        0030    
                  XS047-SKU                                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 UPC:  '                                        0030    
                  XS047-UPC                                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 UNAD SW:  '                                    0030    
                  XS047-INCLD-UNADVERTISED-SW                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PART DAY SW:  '                                0030    
                  XS047-INCLD-PARTIAL-DAY-SW                            0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GOLDSTAR SW:  '                                0030    
                  XS047-INCLD-GOLDSTAR-SW                               0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 LST 6 WK:  '                                   0030    
                  XS047-INCLD-LST-SIX-WK-PRIC-SW                        0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GRP PRICE SW:  '                               0030    
                  XS047-INCLD-PROMO-GRP-PRIC-SW                         0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GWP SW:  '                                     0030    
                  XS047-INCLD-GWP-PWP-PROMO-SW                          0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 TIERED SW:  '                                  0030    
                  XS047-INCLD-TIERED-PROMO-SW                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 INCLD ADD SW:  '                               0030    
                  XS047-INCLD-ADD-PCT-AMT-OFF-SW                        0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 CALLING APP:  '                                0030    
                  XS047-CALLING-APPL-IDENTIFIER                         0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
       4300-DISPLAY-PARMS2.                                                     
                                                                                
           MOVE SPACES TO PV-ACTION.                                    03000030
           STRING 'XS061 SUCCESS COMPLETE:  '                           0030    
                  XS047-SUCCESSFUL-COMPLETE-IND                         0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 INVALID INPUT CD:  '                           0030    
                  XS047-INVALID-INPUT-CODE                              0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 ERROR SQL CODE:  '                             0030    
                  XS047-ERROR-SQL-CODE                                  0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 ERROR SECTION NAME:  '                         0030    
                  XS047-ERROR-SECTION-NAME                              0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-RGLR-PRICE TO PV-NUM-EDIT.                                
           STRING 'XS061 REGULAR PRICE:  '                              0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-PRICE-DET-PRICE TO PV-NUM-EDIT.                           
           STRING 'XS061 PRICE DET PRICE:  '                            0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PRICE DET PR TYP CDE:  '                       0030    
                  XS047-PRICE-DET-PRICG-TYP-CDE                         0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PRICE DET PROMO ID:  '                         0030    
                  XS047-PRICE-DET-PROMO-ID                              0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PRICE DET STRT TMST:  '                        0030    
                  XS047-PRICE-DET-STRT-TMST                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PRICE DET END TMST:  '                         0030    
                  XS047-PRICE-DET-END-TMST                              0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 REG GRP PRICG QTY:  '                          0030    
                  XS047-REG-GRP-PRICG-QTY                               0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-REG-GRP-PRICG-DLR TO PV-NUM-EDIT.                         
           STRING 'XS061 REG GRP PRICG AMT:  '                          0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-PCT-OFF-REG-GRP-PRIC-PCT TO PV-NUM-EDIT.                  
           STRING 'XS061 PCT OFF REG GRP PRC PCT:  '                    0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-PCT-OFF-REG-GRP-PRIC-AMT TO PV-NUM-EDIT.                  
           STRING 'XS061 PCT OFF REG GRP PRC AMT:  '                    0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PROMO GRP PRICG QTY:  '                        0030    
                  XS047-PROMO-GRP-PRICG-QTY                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-PROMO-GRP-PRICG-DLR TO PV-NUM-EDIT.                       
           STRING 'XS061 PROMO GRP PRICG AMT:  '                        0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PROMO GRP PRICG TYP CDE:  '                    0030    
                  XS047-PROMO-GRP-PRICG-TYP-CDE                         0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PROMO GRP PROMO ID:  '                         0030    
                  XS047-PROMO-GRP-PROMO-ID                              0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PROMO GRP STRT TMST:  '                        0030    
                  XS047-PROMO-GRP-STRT-TMST                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 PROMO GRP END TMST:  '                         0030    
                  XS047-PROMO-GRP-END-TMST                              0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-ADDL-PCT-OFF-DISC-PCT TO PV-NUM-EDIT.                     
           STRING 'XS061 ADDL PCT OFF DISC PCT:  '                      0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-ADDL-DLR-OFF-AMT TO PV-NUM-EDIT.                          
           STRING 'XS061 ADDL DLR OFF AMT:  '                           0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 ADDL PCT DLR PRIC TYP CDE:  '                  0030    
                  XS047-ADD-PCT-DLR-PRIC-TYP-CDE                        0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 ADDL PCT DLR PROMO ID:  '                      0030    
                  XS047-ADDL-PCT-DLR-PROMO-ID                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 ADDL PCT DLR STRT TMST:  '                     0030    
                  XS047-ADDL-PCT-DLR-STRT-TMST                          0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 ADDL PCT DLR END TMST:  '                      0030    
                  XS047-ADDL-PCT-DLR-END-TMST                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GWP PWP IND:  '                                0030    
                  XS047-GWP-PWP-IND                                     0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-GWP-PWP-AMT TO PV-NUM-EDIT.                               
           STRING 'XS061 GWP PWP AMT:  '                                0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GWP PWP PRICG TYP CDE:  '                      0030    
                  XS047-GWP-PWP-PRICG-TYP-CDE                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GWP PWP PROMO ID:  '                           0030    
                  XS047-GWP-PWP-PROMO-ID                                0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GWP PWP STRT TMST:  '                          0030    
                  XS047-GWP-PWP-STRT-TMST                               0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 GWP PWP END TMST:  '                           0030    
                  XS047-GWP-PWP-END-TMST                                0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 TIERED PRICG TYP CDE:  '                       0030    
                  XS047-TIERED-PRICG-TYP-CDE                            0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 TIERED PROMO ID:  '                            0030    
                  XS047-TIERED-PROMO-ID                                 0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 TIERED STRT TMST:  '                           0030    
                  XS047-TIERED-STRT-TMST                                0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 TIERED END TMST:  '                            0030    
                  XS047-TIERED-END-TMST                                 0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 EBOGO PRICG TYP CDE:  '                        0030    
                  XS047-EBOGO-PRICG-TYP-CDE                             0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 EBOGO PROMO ID:  '                             0030    
                  XS047-EBOGO-PROMO-ID                                  0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 EBOGO STRT TMST:  '                            0030    
                  XS047-EBOGO-STRT-TMST                                 0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 EBOGO END TMST:  '                             0030    
                  XS047-EBOGO-END-TMST                                  0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           STRING 'XS061 EBOGO PRICG QTY:  '                            0030    
                  XS047-EBOGO-PRICG-QTY                                 0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
           MOVE SPACES TO PV-ACTION.                                    0030    
           MOVE ZEROES TO PV-NUM-EDIT.                                          
           MOVE XS047-EBOGO-DISC-PRICG-AMT TO PV-NUM-EDIT.                      
           STRING 'XS061 EBOGO DISC PRICG AMT:  '                       0030    
                  PV-NUM-EDIT                                           0030    
                  DELIMITED BY SIZE INTO PV-ACTION.                     0030    
           PERFORM 4000-LOG-MESSAGE.                                    0030    
                                                                                
      ****************************************************************  00020030
      *  4200-INITIALIZE-RETURN-VALUES                                  00030030
      ****************************************************************  00050030
       4200-INITIALIZE-RETURN-VALUES.                                           
                                                                                
           MOVE SPACES TO XS047-SUCCESSFUL-COMPLETE-IND                         
                          XS047-INVALID-INPUT-CODE                              
                          XS047-ERROR-SECTION-NAME                              
                          XS047-PRICE-DET-PRICG-TYP-CDE                         
                          XS047-PRICE-DET-STRT-TMST                             
                          XS047-PRICE-DET-END-TMST                              
                          XS047-PROMO-GRP-PRICG-TYP-CDE                         
                          XS047-PROMO-GRP-STRT-TMST                             
                          XS047-PROMO-GRP-END-TMST                              
                          XS047-ADD-PCT-DLR-PRIC-TYP-CDE                        
                          XS047-ADDL-PCT-DLR-STRT-TMST                          
                          XS047-ADDL-PCT-DLR-END-TMST                           
                          XS047-GWP-PWP-IND                                     
                          XS047-GWP-PWP-PRICG-TYP-CDE                           
                          XS047-GWP-PWP-STRT-TMST                               
                          XS047-GWP-PWP-END-TMST                                
                          XS047-TIERED-PRICG-TYP-CDE                            
                          XS047-TIERED-STRT-TMST                                
                          XS047-TIERED-END-TMST                                 
                          XS047-EBOGO-PRICG-TYP-CDE                             
                          XS047-EBOGO-STRT-TMST                                 
                          XS047-EBOGO-END-TMST.                                 
                                                                                
           MOVE ZEROES TO XS047-ERROR-SQL-CODE                                  
                          XS047-RGLR-PRICE                                      
                          XS047-PRICE-DET-PRICE                                 
                          XS047-PRICE-DET-PROMO-ID                              
                          XS047-REG-GRP-PRICG-QTY                               
                          XS047-REG-GRP-PRICG-DLR                               
                          XS047-PCT-OFF-REG-GRP-PRIC-PCT                .       
                          XS047-PCT-OFF-REG-GRP-PRIC-AMT                .       
                          XS047-PROMO-GRP-PRICG-QTY                             
                          XS047-PROMO-GRP-PRICG-DLR                             
                          XS047-PROMO-GRP-PROMO-ID                              
                          XS047-LWST-SIX-WEEK-PRICE                             
                          XS047-ADDL-PCT-OFF-DISC-PCT                           
                          XS047-ADDL-DLR-OFF-AMT                                
                          XS047-ADDL-PCT-DLR-PROMO-ID                           
                          XS047-GWP-PWP-AMT                                     
                          XS047-GWP-PWP-PROMO-ID                                
                          XS047-TIERED-PROMO-ID                                 
                          XS047-EBOGO-PROMO-ID                                  
                          XS047-EBOGO-PRICG-QTY                                 
                          XS047-EBOGO-DISC-PRICG-AMT.                           
                                                                                
           PERFORM                                                              
             VARYING PV-SUB FROM 1 BY 1                                         
             UNTIL PV-SUB > 10                                                  
               MOVE ZEROES TO XS047-BUY-QTY(PV-SUB)                             
                              XS047-BUY-DLR(PV-SUB)                             
                              XS047-GET-PCT(PV-SUB)                             
                              XS047-GET-DLR(PV-SUB)                             
           END-PERFORM.                                                         
                                                                                
