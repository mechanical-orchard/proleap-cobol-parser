000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    MLKUT620.                                         00020000
000300 AUTHOR.        B. GRAHAM.                                        00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  04-23-07.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*                                                                 00080000
000900* MLKUT620 - CREATE THE DATA INTEGRITY EXTRACT FILE FOR           00090000
001000*            MLT_WKLY_SUM.                                        00100000
001010*                                                                 00101000
001014* THIS PROGRAM WILL TAKE THE SORTED MLT_WKLY_SUM FILE AND FORMAT  00101100
001015* THE DATA TO DATA INTEGRITY EXTRACT COPYBOOK MLRD211 AND CREATE  00101200
001016* DATA INTEGRITY EXTRACT FILE.                                    00101300
001070*                                                                 00101400
001080*CHANGE HISTORY:                                                  00101500
001090* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00101600
001100* ------- ---------- ----------- -------------------------------- 00101700
001200* WR21764 11-26-2004 ROD JANSSEN MERCH LEDGER DETAIL LEDGER TBLS  00101800
028582* 28582   02-08-2007 ROD JANSSEN DI ISSUE WITH WEEKLY TABLES....  00101900
028582*B28582   04-23-2007 B. GRAHAM COPIED FROM MLKUT614 FOR USE IN    00102000
028582*B28582              DOING DI AGAINST BRAND VENDOR (F) MONTHLY    00102100
028582*B28582              TABLES.                                      00102200
001300******************************************************************00102300
001400                                                                  00102400
001500 ENVIRONMENT DIVISION.                                            00102500
001600 CONFIGURATION SECTION.                                           00102600
001700 SOURCE-COMPUTER.        IBM-3090.                                00102700
001800 OBJECT-COMPUTER.        IBM-3090.                                00102800
001900 INPUT-OUTPUT SECTION.                                            00102900
002000 FILE-CONTROL.                                                    00103000
002100                                                                  00104000
002200     SELECT DATA-INTEGRITY-CTL-FILE                               00105000
002300         ASSIGN TO INP01.                                         00106000
002400                                                                  00107000
002500     SELECT DATA-INTEGRITY-EXTR-FILE                              00108000
002600         ASSIGN TO OUT01.                                         00109000
002700                                                                  00110000
002800 DATA DIVISION.                                                   00120000
002900 FILE SECTION.                                                    00130000
003000                                                                  00140000
003100 FD  DATA-INTEGRITY-CTL-FILE                                      00150000
003200     LABEL RECORDS ARE STANDARD                                   00160000
003300     RECORDING MODE IS F                                          00170000
003400     BLOCK CONTAINS 0 RECORDS.                                    00180000
003500 01  DATA-INTEGRITY-CTL-REC      PIC X(349).                      00190000
003600                                                                  00200000
003700 FD  DATA-INTEGRITY-EXTR-FILE                                     00210000
003800     RECORDING MODE IS F                                          00220000
003900     LABEL RECORDS ARE STANDARD                                   00230000
004000     BLOCK CONTAINS 0 RECORDS.                                    00240000
004100                                                                  00250000
004200 01  DATA-INTEGRITY-EXTR-REC     PIC X(200).                      00260000
004300                                                                  00270000
004400******************************************************************00280000
004500 WORKING-STORAGE SECTION.                                         00290000
004600******************************************************************00300000
004700                                                                  00310000
004800 01  PS-PROGRAM-SWITCHES.                                         00320000
004810     05  PS-END-OF-INPUT-SW      PIC X       VALUE 'N'.           00330000
004820         88  PS-END-OF-INPUT                 VALUE 'Y'.           00340000
004830         88  PS-END-OF-INPUT-NO              VALUE 'N'.           00350000
004900     05  PS-MLT00005-DONE        PIC X       VALUE 'N'.           00360000
005000         88  PS-MLT00005-IS-DONE             VALUE 'Y'.           00370000
005100         88  PS-MLT00005-IS-NOT-DONE         VALUE 'N'.           00380000
005200                                                                  00390000
005300 01  PV-PROGRAM-VARIABLES.                                        00400000
R28582     05  PV-PREV-FSCL-MN-END-DTE PIC X(10) VALUE SPACE.           00410000
R28582     05  PV-PREV-DEPT-NBR        PIC S9(4)V COMP-3 VALUE ZEROS.   00420000
B28582     05  PV-PREV-ML-LO-MDSE-LVL-ID                                00430000
B28582                                 PIC  S9(9) COMP VALUE ZEROS.     00440000
005400     05  PV-OPN-MONTH-FIRST-WEEK PIC X(10).                       00450000
005500     05  PV-DEPT-NBR             PIC 9(03)  VALUE ZEROS.          00460000
005600     05  PV-MAJ-CL-NBR           PIC 9(02)  VALUE ZEROS.          00470000
005700     05  PV-SUB-CL-NBR           PIC 9(02)  VALUE ZEROS.          00480000
005800     05  PV-LOC-NBR              PIC 9(04)  VALUE ZEROS.          00490000
005900     05  PV-FSCL-DTE             PIC X(10).                       00500000
005910     05  PV-FSCL-MN-END-DTE      PIC X(10).                       00510000
006000     05  PV-FSCL-MN-NBR          PIC X(02).                       00520000
006100     05  PV-PARTN-NBR            PIC S9(4)V COMP.                 00530000
006200                                                                  00540000
006210     05  PV-DKEY-NBR.                                             00550000
006230         10  PV-DKEY-WK-NBR      PIC X(02).                       00560000
006240         10  PV-DKEY-MN-NBR      PIC X(02).                       00570000
006250         10  FILLER              PIC X(11).                       00580000
006260                                                                  00590000
006300 01  PA-PROGRAM-ACCUMULATORS.                                     00600000
006301     05  PA-INPUT-FILES           PIC S9(13) VALUE ZEROS.         00610000
006310     05  PA-MLT00005-ROWS-FETCHED PIC S9(13) VALUE ZEROS.         00620000
006320     05  PA-TDTATTR-ROWS-SELECTED PIC S9(13) VALUE ZEROS.         00621000
006330     05  PA-OUTPUT-RECS-WRITTEN   PIC S9(13) VALUE ZEROS.         00622000
006340                                                                  00623000
006350 01  PC-PROGRAM-CONSTANTS.                                        00624000
006360     05  PC-MAX-TBL-ROWS         PIC S9(03)  VALUE +120.          00625000
006360     05  PC-Y                    PIC X       VALUE 'Y'.           00626000
006370                                                                  00627000
006380 01  TABLE-FOR-MONTH-DATA.                                        00628000
006390     05  TABLE-WEEKEND-ENTRIES   OCCURS 450 TIMES                 00629000
006400                                 INDEXED BY MTH-IDX.              00630000
006410         10  TBL-FSCL-DTE        PIC X(10).                       00631000
006420         10  TBL-MONTHEND-DTE    PIC X(10).                       00632000
006430         10  TBL-MONTHEND-NBR    PIC X(02).                       00633000
006440                                                                  00634000
006450 01  CD-COUNTER-DISPLAY.                                          00635000
006460     05  CD-COUNT-HOLD1          PIC Z,ZZZ,ZZZ,ZZZ,ZZ9.           00636000
006470                                                                  00637000
006480 01 ABEND-AREAS.                                                  00638000
006490     05 ABEND-CODE               PIC S9(04)  VALUE ZEROS          00639000
006500                                             COMP SYNC.           00640000
006600         88  AC-BAD-DATA                     VALUE +4003.         00641000
006700         88  AC-DB2-ERROR                    VALUE +4013.         00642000
006800     05  AA-ABEND-LIT            PIC X(40)   VALUE                00643000
006900             '*****       ABEND'.                                 00644000
007000     05  AA-PROGRAM-LIT          PIC X(40)   VALUE                00645000
007100             '*****   PROGRAM: MLKUT620'.                         00646000
007200     05  AA-PARAGRAPH-LIT.                                        00647000
007300         10  FILLER              PIC X(17)   VALUE                00648000
007400             '***** PARAGRAPH: '.                                 00649000
007500         10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        00650000
007600     05  AA-MESSAGE-LINE.                                         00660000
007700         10  FILLER              PIC X(06)   VALUE '*****'.       00670000
007800         10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        00680000
007900     05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                00690000
008000             '*****    DB2 ERROR'.                                00700000
008100     05  AA-DB2-OPERATION-LIT.                                    00710000
008200         10  FILLER              PIC X(17)   VALUE                00720000
008300             '***** OPERATION: '.                                 00730000
008400         10  AA-DB2-OPERATION.                                    00740000
008500             15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        00750000
008600             15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        00760000
008700     05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        00770000
008800     05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        00780000
008900     05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        00790000
009000     05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        00800000
009100                                                                  00810000
009200 EJECT                                                            00820000
009600                                                                  00830000
009800*** DATA INTEGRITY MLT_WKLY_SUM EXTRACT FILE                      00840000
009900     COPY MLRD211.                                                00850000
010000                                                                  00860000
010100 EJECT                                                            00870000
010200                                                                  00880000
010300******************************************************************00890000
010400*  DB2 ERROR MESSAGES FORMAT AREA.                                00900000
010500******************************************************************00910000
010600     COPY DPWS004.                                                00920000
010700                                                                  00930000
010800******************************************************************00940000
010900*  DB2 ERRORS                                                     00950000
011000******************************************************************00960000
011100     COPY SQLCA2.                                                 00970000
011200                                                                  00980000
011300******************************************************************00990000
011400*  DB2 COMMUNICATION AREA                                         01000000
011500******************************************************************01010000
011600     EXEC SQL                                                     01020000
011700          INCLUDE SQLCA                                           01030000
011800     END-EXEC.                                                    01040000
011900                                                                  01050000
012000******************************************************************01060000
012100*  M/L DETAIL TABLE - PARTITION BALANCING TABLE                   01070000
012200******************************************************************01080000
012300     EXEC SQL                                                     01090000
012400         INCLUDE MLT00002                                         01100000
012410     END-EXEC.                                                    01110000
012420*                                                                 01120000
012430******************************************************************01130000
012440*  M/L DETAIL TABLE - PARTITION CONTROL TABLE                     01140000
012450******************************************************************01150000
012460     EXEC SQL                                                     01160000
012470         INCLUDE MLT00003                                         01170000
012480     END-EXEC.                                                    01180000
012490*                                                                 01190000
012500******************************************************************01200000
012600*  DB2 MLT_WKLY_SUM TABLE LAYOUT                                  01210000
012700******************************************************************01220000
012800     EXEC SQL                                                     01230000
012900          INCLUDE MLT00005                                        01240000
013000     END-EXEC.                                                    01250000
013100*                                                                 01260000
013200******************************************************************01270000
013210*  DB2 TDTATTR TABLE LAYOUT                                       01280000
013220******************************************************************01290000
013230     EXEC SQL                                                     01300000
013231          INCLUDE TDTATTR                                         01310000
013232     END-EXEC.                                                    01320000
013233                                                                  01321000
015710 EJECT                                                            01322000
015730******************************************************************01323000
015740 PROCEDURE DIVISION.                                              01324000
015750******************************************************************01325000
015760                                                                  01326000
015770******************************************************************01327000
015780 0000-MAINLINE-MLKUT620.                                          01328000
015790******************************************************************01329000
015800*                                                                 01330000
015900     PERFORM 1000-INITIALIZATION.                                 01340000
016000                                                                  01350000
016100     PERFORM 2000-MAIN-PROCESS.                                   01360000
016200                                                                  01370000
016300     PERFORM 8000-EOJ.                                            01380000
016400                                                                  01390000
016500     STOP RUN.                                                    01400000
016600                                                                  01410000
016700 EJECT                                                            01420000
016800                                                                  01430000
016900******************************************************************01440000
017000 1000-INITIALIZATION.                                             01450000
017100******************************************************************01460000
017200*                                                                 01470000
017300     OPEN INPUT  DATA-INTEGRITY-CTL-FILE.                         01480000
017400     OPEN OUTPUT DATA-INTEGRITY-EXTR-FILE.                        01490000
017500                                                                  01500000
017600     PERFORM 4000-READ-INPUT-FILE.                                01510000
017700                                                                  01520000
018200*    MOVE ZEROS TO MLT00005-PARTN-NBR.                            01530000
018300*    MOVE ZEROS TO MLT00005-DEPT-NBR.                             01540000
018400*    MOVE ZEROS TO MLT00005-MAJ-CL-NBR.                           01550000
018500*    MOVE ZEROS TO MLT00005-SUB-CL-NBR.                           01560000
018600*    MOVE ZEROS TO MLT00005-LOC-NBR.                              01570000
018700                                                                  01580000
018800     INITIALIZE PA-PROGRAM-ACCUMULATORS.                          01590000
018900     INITIALIZE PV-PROGRAM-VARIABLES.                             01600000
019000     INITIALIZE TABLE-FOR-MONTH-DATA.                             01610000
019100                                                                  01620000
019210*                                                                 01630000
019220 EJECT                                                            01640000
019230                                                                  01650000
019240******************************************************************01660000
019250 2000-MAIN-PROCESS.                                               01670000
019260******************************************************************01680000
019270*                                                                 01690000
019500     PERFORM                                                      01700000
019600       UNTIL PS-END-OF-INPUT                                      01710000
019700         PERFORM 2100-GET-MONTH-DATA                              01720000
019800         PERFORM 5000-WRITE-EXTRACT                               01730000
019900         PERFORM 4000-READ-INPUT-FILE                             01740000
020000         ADD  1           TO PA-INPUT-FILES                       01750000
020100     END-PERFORM.                                                 01760000
020300                                                                  01770000
020400 EJECT                                                            01780000
020500                                                                  01790000
020600******************************************************************01800000
020700 2100-GET-MONTH-DATA.                                             01810000
020800******************************************************************01820000
020900                                                                  01830000
021000     SET MTH-IDX                 TO 1.                            01840000
021100     SEARCH TABLE-WEEKEND-ENTRIES                                 01850000
021200         AT END                                                   01860000
021210             PERFORM 7400-SELECT-TDTATTR                          01870000
021220             ADD 1               TO PA-TDTATTR-ROWS-SELECTED      01880000
021230             MOVE MLT00005-FSCL-WK-END-DTE                        01890000
021240                                 TO PV-FSCL-DTE                   01900000
021241             MOVE DTATTR-FSCL-MN-END-DTE                          01910000
021242                                 TO PV-FSCL-MN-END-DTE            01920000
021250             MOVE DTATTR-FSCL-MN-NBR                              01930000
021260                                 TO PV-FSCL-MN-NBR                01940000
021270             IF PA-TDTATTR-ROWS-SELECTED > PC-MAX-TBL-ROWS        01950000
021280                 CONTINUE                                         01960000
021290             ELSE                                                 01970000
021300                 SET MTH-IDX     TO PA-TDTATTR-ROWS-SELECTED      01980000
021303                 MOVE MLT00005-FSCL-WK-END-DTE                    01990000
021304                                 TO TBL-FSCL-DTE     (MTH-IDX)    02000000
021305                 MOVE DTATTR-FSCL-MN-END-DTE                      02010000
021306                                 TO TBL-MONTHEND-DTE (MTH-IDX)    02020000
021307                 MOVE DTATTR-FSCL-MN-NBR                          02030000
021308                                 TO TBL-MONTHEND-NBR (MTH-IDX)    02040000
021309             END-IF                                               02050000
021311         WHEN TBL-FSCL-DTE  (MTH-IDX) = MLT00005-FSCL-WK-END-DTE  02060000
021312             MOVE TBL-MONTHEND-DTE (MTH-IDX)                      02070000
021313                                 TO PV-FSCL-MN-END-DTE            02080000
021314             MOVE TBL-MONTHEND-NBR (MTH-IDX)                      02090000
021315                                 TO PV-FSCL-MN-NBR                02100000
021316     END-SEARCH.                                                  02110000
021317                                                                  02120000
021318 EJECT                                                            02130000
021319                                                                  02131000
021320******************************************************************02131100
021321 4000-READ-INPUT-FILE.                                            02131200
021322******************************************************************02131300
021323*                                                                 02131400
021330     READ DATA-INTEGRITY-CTL-FILE                                 02131500
021340       INTO DCLMLT00005                                           02131600
021350         AT END                                                   02131700
021360             SET PS-END-OF-INPUT    TO TRUE.                      02131800
021700                                                                  02131900
021700                                                                  02132000
021800 EJECT                                                            02133000
021900                                                                  02134000
022000******************************************************************02135000
022100 5000-WRITE-EXTRACT.                                              02136000
022200******************************************************************02137000
022300*                                                                 02138000
022400     MOVE PV-FSCL-MN-END-DTE       TO ML211-FSCL-MN-END-DTE.      02139000
022500     MOVE PV-FSCL-MN-NBR           TO ML211-FSCL-MN-NBR.          02140000
022600     MOVE MLT00005-DEPT-NBR        TO PV-DEPT-NBR.                02150000
022700     MOVE PV-DEPT-NBR              TO ML211-DEPT-NBR.             02160000
022800     MOVE MLT00005-MAJ-CL-NBR      TO PV-MAJ-CL-NBR.              02170000
022900     MOVE PV-MAJ-CL-NBR            TO ML211-MAJ-CL-NBR.           02180000
023000     MOVE MLT00005-SUB-CL-NBR      TO PV-SUB-CL-NBR.              02190000
023100     MOVE PV-SUB-CL-NBR            TO ML211-SUB-CL-NBR.           02200000
023200     MOVE MLT00005-LOC-NBR         TO PV-LOC-NBR.                 02210000
023300     MOVE PV-LOC-NBR               TO ML211-STR-NBR.              02220000
023400                                                                  02230000
023500     COMPUTE ML211-SLS-RTL-AMT  = MLT00005-SLS-REG-RTL-AMT        02240000
023600                                + MLT00005-SLS-PROMO-RTL-AMT      02250000
023700                                + MLT00005-SLS-PROCLR-RTL-AMT     02260000
023800                                + MLT00005-SLS-CLR-RTL-AMT        02270000
023900                                + MLT00005-SLS-OTH-RTL-AMT.       02280000
024000     COMPUTE ML211-MKDN-RTL-AMT = MLT00005-MKDN-PLU-RTL-AMT       02290000
024010                                + MLT00005-MKDN-RGST-RTL-AMT      02300000
024020                                + MLT00005-MKDN-UMTCH-RTL-AMT     02310000
024030                                + MLT00005-MKDN-BYR-RTL-AMT       02320000
024040                                + MLT00005-MKDN-STR-RTL-AMT.      02330000
024050     MOVE MLT00005-MKUP-RTL-AMT     TO ML211-MKUP-RTL-AMT.        02340000
024060     MOVE MLT00005-XFER-IN-RTL-AMT  TO ML211-XFER-IN-RTL-AMT.     02350000
024070     MOVE MLT00005-XFER-OUT-RTL-AMT TO ML211-XFER-OUT-RTL-AMT.    02360000
024080     MOVE MLT00005-RCPT-RTL-AMT     TO ML211-RCPT-RTL-AMT.        02370000
024090     MOVE MLT00005-RCPT-NET-COST-AMT                              02380000
024100                                    TO ML211-RCPT-NET-COST-AMT.   02390000
024200     MOVE MLT00005-PADJ-RTL-AMT     TO ML211-PADJ-RTL-AMT.        02400000
024300     MOVE MLT00005-PADJ-NET-COST-AMT                              02410000
024400                                    TO ML211-PADJ-NET-COST-AMT.   02420000
024500     MOVE MLT00005-INV-ADJ-RTL-AMT  TO ML211-INV-ADJ-RTL-AMT.     02430000
024600     MOVE MLT00005-SHNK-RTL-AMT     TO ML211-SHNK-RTL-AMT.        02440000
R28582                                                                  02450000
R28582*    ENDING INVENTORY IS ONLY FILLED IN ON THE RECORD FOR THE     02460000
R28582*    FIRST (MOST RECENT) FISCAL WEEK IN THE FISCAL MONTH.         02460100
R28582*    (THE FISCAL WEEKS ARE PROCESSED IN DESCENDING SEQUENCE.)     02460200
R28582     IF  PV-FSCL-MN-END-DTE      = PV-PREV-FSCL-MN-END-DTE        02460300
R28582     AND MLT00005-DEPT-NBR       = PV-PREV-DEPT-NBR               02460400
B28582     AND MLT00005-ML-LO-MDSE-LVL-ID                               02460500
B28582                                 = PV-PREV-ML-LO-MDSE-LVL-ID      02460600
R28582         MOVE ZEROS                  TO ML211-END-INV-RTL-AMT     02460700
B28582                                        ML211-END-INV-COST1-AMT   02460800
B28582                                        ML211-END-INV-COST2-AMT   02460900
R28582     ELSE                                                         02461000
R28582         MOVE MLT00005-END-INV-RTL-AMT TO ML211-END-INV-RTL-AMT   02461100
B28582         MOVE MLT00005-END-INV-COST1-AMT                          02461200
B28582                                      TO ML211-END-INV-COST1-AMT  02461300
B28582         MOVE MLT00005-END-INV-COST2-AMT                          02461400
B28582                                      TO ML211-END-INV-COST2-AMT  02461500
R28582         MOVE PV-FSCL-MN-END-DTE     TO PV-PREV-FSCL-MN-END-DTE   02461600
R28582         MOVE MLT00005-DEPT-NBR      TO PV-PREV-DEPT-NBR          02461700
B28582         MOVE MLT00005-ML-LO-MDSE-LVL-ID                          02461800
B28582                                     TO PV-PREV-ML-LO-MDSE-LVL-ID 02461900
R28582     END-IF.                                                      02462000
R28582                                                                  02462100
B28582     MOVE MLT00005-ADJ-GRO-MRGN-AMT  TO ML211-ADJ-GRO-MRGN-AMT.   02462200
024730     MOVE MLT00005-ML-LO-MDSE-LVL-ID TO ML211-DKEY-NBR.           02462300
024800                                                                  02462400
024900     WRITE DATA-INTEGRITY-EXTR-REC                                02462500
025000         FROM ML211-DATA-INTEGRITY-EXTR-REC.                      02462600
025100     ADD 1                         TO PA-OUTPUT-RECS-WRITTEN.     02462700
025200                                                                  02462800
025300 EJECT                                                            02462900
025400                                                                  02463000
031200******************************************************************02464000
031300 7400-SELECT-TDTATTR.                                             02465000
031400******************************************************************02466000
031500*                                                                 02467000
031610     MOVE MLT00005-FSCL-WK-END-DTE TO PV-FSCL-DTE.                02468000
031700                                                                  02469000
031800     EXEC SQL                                                     02470000
031900         SELECT DISTINCT                                          02480000
031910                FSCL_MN_NBR                                       02490000
032000               ,FSCL_MN_END_DTE                                   02500000
032100               ,FSCL_WK_NBR                                       02510000
032200               ,FSCL_WK_END_DTE                                   02520000
032300         INTO  :DTATTR-FSCL-MN-NBR                                02530000
032400              ,:DTATTR-FSCL-MN-END-DTE                            02540000
032410              ,:DTATTR-FSCL-WK-NBR                                02550000
032420              ,:DTATTR-FSCL-WK-END-DTE                            02560000
032430         FROM  MLT_PARTN_CNTL A                                   02570000
032440               ,TDTATTR B                                         02580000
032450         WHERE A.FSCL_DTE = :PV-FSCL-DTE                          02590000
032451           AND A.FSCL_DTE = B.KY_DTE                              02600000
032470           AND A.TBL_TM_LVL_CDE = 'W'                             02610000
032500         WITH UR                                                  02620000
032501     END-EXEC.                                                    02630000
032502                                                                  02640000
032503     EVALUATE TRUE                                                02650000
032504         WHEN SQLCODE = 0                                         02660000
032505             CONTINUE                                             02670000
032506         WHEN OTHER                                               02680000
032507             MOVE '7400-SELECT-TDTATTR'                           02690000
032508                                 TO AA-PARAGRAPH-NAME             02700000
032509             MOVE 'TDTATTR ROW NOT FOUND'                         02710000
032510                                 TO AA-MESSAGE                    02720000
032511             MOVE 'SELECT'       TO AA-DB2-OPERATION              02730000
032512             PERFORM Z998-SQL-ERROR                               02740000
032513     END-EVALUATE.                                                02750000
032514                                                                  02760000
032515 EJECT                                                            02770000
032516                                                                  02780000
032517******************************************************************02790000
032518 8000-EOJ.                                                        02800000
032519******************************************************************02810000
032520*                                                                 02820000
032530     DISPLAY ' '.                                                 02830000
032540     DISPLAY '  PROGRAM MLKUT620 PROCESSING SUMMARY'.             02840000
032550     DISPLAY '  -----------------------------------'.             02850000
032560     DISPLAY ' '.                                                 02860000
032570*                                                                 02870000
032700     MOVE PA-OUTPUT-RECS-WRITTEN TO CD-COUNT-HOLD1.               02880000
032800     DISPLAY 'EXTRACT RECORDS WRITTEN =   ' CD-COUNT-HOLD1.       02890000
032900*                                                                 02900000
033000     DISPLAY ' '.                                                 02910000
033100                                                                  02920000
033200     CLOSE DATA-INTEGRITY-CTL-FILE.                               02930000
033300     CLOSE DATA-INTEGRITY-EXTR-FILE.                              02940000
033400                                                                  02950000
033500 EJECT                                                            02960000
033600                                                                  02970000
033700******************************************************************02980000
033800 Z990-COMMON-ABEND-ROUTINE.                                       02990000
033900******************************************************************03000000
034000*                                                                 03010000
034100     DISPLAY AA-ABEND-LIT.                                        03020000
034200     DISPLAY AA-PROGRAM-LIT.                                      03030000
034300     DISPLAY AA-PARAGRAPH-LIT.                                    03040000
034400     DISPLAY AA-MESSAGE-LINE.                                     03050000
034500     DISPLAY ABEND-CODE.                                          03060000
034600                                                                  03070000
034700     CALL 'ILBOABN0' USING ABEND-CODE.                            03080000
034800                                                                  03090000
034900 EJECT                                                            03100000
035000                                                                  03110000
035100******************************************************************03120000
035200 Z998-SQL-ERROR.                                                  03130000
035300******************************************************************03140000
035400*                                                                 03150000
035500     CLOSE DATA-INTEGRITY-CTL-FILE                                03160000
035600           DATA-INTEGRITY-EXTR-FILE.                              03170000
035700                                                                  03180000
035800     DISPLAY AA-ABEND-LIT.                                        03190000
035900     DISPLAY AA-DB2-ERROR-LIT.                                    03200000
036000     DISPLAY AA-PROGRAM-LIT.                                      03210000
036100     DISPLAY AA-PARAGRAPH-LIT.                                    03220000
036200     DISPLAY AA-MESSAGE-LINE.                                     03230000
036300     DISPLAY AA-DB2-OPERATION-LIT.                                03240000
036400     SET AC-DB2-ERROR TO TRUE.                                    03250000
036500     MOVE +4013                  TO ABEND-CODE.                   03260000
036600                                                                  03270000
036700     COPY DPPD004.                                                03280000
036800     CALL 'ILBOABN0' USING ABEND-CODE.                            03290000
036900                                                                  03300000
