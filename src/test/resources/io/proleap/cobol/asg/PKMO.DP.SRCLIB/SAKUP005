000100 IDENTIFICATION DIVISION.                                         00010050
000200                                                                  00020050
000300 PROGRAM-ID.      SAKUP005.                                       00030050
000400 AUTHOR.          STEVEN NOWAK.                                   00040050
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050050
000600 DATE-WRITTEN.    04/15/09.                                       00060050
000700 DATE-COMPILED.                                                   00070050
000800                                                                  00080050
000900******************************************************************00090050
001000*  MODULE TYPE:   COBOL2 DB2 BATCH.                               00100050
001100*                                                                 00110050
001200*  DESCRIPTION: PROGRAM UPDATES THE TSAADSU TABLE WITH THE DATA   00120050
001300*               PULLED IN PROGRAM SAKUT047                        00130050
001400*                                                                 00140050
001500*========================== CHANGE LOG ===========================00150050
001600*  AUTH             BY          DATE     DESCRIPTION              00160060
001700*=================================================================00170050
001800* WR36527         TKMA409   04-15-09   CREATE PROGRAM             00180060
001900*                                                                 00190050
260107* CHG0260107   JIM HUNTER   08-16-21   ADD COPYBOOK DPWS991 TO    00194065
260107*                                      MAKE DPKUT901 CALL DYNAMIC.00195064
002000******************************************************************00200050
002100                                                                  00210050
002200 ENVIRONMENT DIVISION.                                            00220050
002300 CONFIGURATION SECTION.                                           00230050
002400                                                                  00240050
002500 SOURCE-COMPUTER.    IBM-3090.                                    00250050
002600 OBJECT-COMPUTER.    IBM-3090.                                    00260050
002700                                                                  00270050
002800 INPUT-OUTPUT SECTION.                                            00280050
002900 FILE-CONTROL.                                                    00290050
003000                                                                  00300050
003100 DATA DIVISION.                                                   00310050
003200 FILE SECTION.                                                    00320050
003300                                                                  00330050
003400                                                                  00340050
003500***************************************************************** 00350050
003600*                       WORKING STORAGE                           00360050
003700***************************************************************** 00370050
003800 WORKING-STORAGE SECTION.                                         00380050
003900                                                                  00390050
004000 01  W-START                          PIC  X(40)                  00400050
004100     VALUE 'SAKUP005 - WORKING STORAGE BEGINS HERE'.              00410050
004200                                                                  00420050
004300                                                                  00430050
004400***************************************************************** 00440050
004500*                         SWITCHES                                00450050
004600***************************************************************** 00460050
004700 01  PROGRAM-SWITCHES.                                            00470050
004800     05  PS-RESTART-REQUIRED-SW       PIC  X(01) VALUE 'N'.       00480050
004900         88  PS-RESTART-REQUIRED                 VALUE 'Y'.       00490050
005000         88  PS-RESTART-NOT-REQUIRED             VALUE 'N'.       00500050
005100                                                                  00510050
005200******************************************************************00520050
005300*                       ACCUMULATORS                              00530050
005400******************************************************************00540050
005500 01  PROGRAM-ACCUM.                                               00550050
005600     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00560050
005700                                                                  00570050
005800******************************************************************00580050
005900*                           CONSTANTS                             00590050
006000******************************************************************00600050
006100 01  PROGRAM-CONSTANTS.                                           00610050
006200     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         00620050
006300                                                 COMP SYNC.       00630050
006400     05  PC-MAX-DEADLOCKS             PIC S9(04) VALUE +3         00640050
006500                                                 COMP SYNC.       00650050
006600                                                                  00660050
006700     05  PC-CKPT-JOB-NAME             PIC  X(08) VALUE 'SAK051  '.00670050
006800     05  PC-CKPT-PLAN-NAME            PIC  X(08) VALUE 'SAKUP005'.00680050
006900     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'SAKUP005'.00690050
007000                                                                  00700050
007100     05  PC-TRAN-PRES-FUNC-CODES.                                 00710050
007200         10  PC-TRAN-PRES-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00720050
007300         10  PC-TRAN-PRES-FUNC-TRANS  PIC  X(05) VALUE 'TRANS'.   00730050
007400         10  PC-TRAN-PRES-FUNC-RSTRT  PIC  X(05) VALUE 'RSTRT'.   00740050
007500         10  PC-TRAN-PRES-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00750050
007600                                                                  00760050
007700     05  PC-MINUS-ONE                 PIC S9(01) VALUE -1.        00770050
007800     05  PC-SYSTEM                    PIC  X(08) VALUE 'SYSTEM  '.00780050
007900                                                                  00790050
008000******************************************************************00800050
008100*                          VARIABLES                              00810050
008200******************************************************************00820050
008300 01  PROGRAM-VARIABLES.                                           00830050
008400     05  PV-SQL-SUB                   PIC  9(03) VALUE ZERO.      00840050
008500     05  PV-DEADLOCK-COUNTER          PIC  9(03) VALUE ZERO.      00850050
008600     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     00860050
008700     05  PV-DB2-OPER-ATTEMPTED        PIC  X(30) VALUE SPACE.     00870050
008800     05  PV-OPERATION-MSG             PIC  X(35) VALUE SPACE.     00880050
008900     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     00890050
009000                                                                  00900050
009100******************************************************************00910050
009200*               SYSTEM TIME AND DATE VARIABLES                    00920050
009300******************************************************************00930050
009400 01  SYS-DATE-TIME.                                               00940050
009500     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    00950050
009600     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    00960050
009700                                                                  00970050
009800 01  ST-BEG-TIME.                                                 00980050
009900     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     00990050
010000     05  FILLER                       PIC  X(01) VALUE ':'.       01000050
010100     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     01010050
010200                                                                  01020050
010300 01  ST-END-TIME.                                                 01030050
010400     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     01040050
010500     05  FILLER                       PIC  X(01) VALUE ':'.       01050050
010600     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     01060050
010700                                                                  01070050
010800 01  SD-EDIT-DATE.                                                01080050
010900     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01090050
011000     05  FILLER                       PIC  X(01) VALUE '-'.       01100050
011100     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01110050
011200     05  FILLER                       PIC  X(01) VALUE '-'.       01120050
011300     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01130050
011400     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01140050
011500                                                                  01150050
011600******************************************************************01160050
011700*                        ERROR HANDLING                           01170050
011800******************************************************************01180050
011900 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01190050
012000                                                 COMP SYNC.       01200050
012100     88  ABEND-4002-READ-ERROR                   VALUE +4002.     01210050
012200     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     01220050
012300     88  ABEND-4019-CAL-SUB-ERROR                VALUE +4019.     01230050
012400                                                                  01240050
012500                                                                  01250050
012600******************************************************************01260050
012700*  TSAADSU - STORE TOTALS RECORD LAYOUT                           01270050
012800******************************************************************01280050
012900     COPY SARD007.                                                01290050
013000                                                                  01300050
013100******************************************************************01310050
013200*  DB2 FORMATTED ERROR MESSAGE                                    01320050
013300******************************************************************01330050
013400     COPY DPWS004.                                                01340050
013500                                                                  01350050
013600******************************************************************01360050
013700*  SQL COMMUNICATIONS WORK AREA                                   01370050
013800******************************************************************01380050
013900     COPY SQLCA2.                                                 01390050
014000                                                                  01400050
014100******************************************************************01410050
014200*  COMMUNICATIONS AREA FOR DB2                                    01420050
014300******************************************************************01430050
014400     EXEC SQL                                                     01440050
014500         INCLUDE SQLCA                                            01450050
014600     END-EXEC.                                                    01460050
014700                                                                  01470050
014800******************************************************************01480050
014900*  DB2 TABLE TSAADSU - STORE TOTALS TABLE                         01490050
015000******************************************************************01500050
015100     EXEC SQL                                                     01510050
015200          INCLUDE TSAADSU                                         01520050
015300     END-EXEC.                                                    01530050
015400                                                                  01540050
015500******************************************************************01550050
015600*  TRANSACTION PREPARATION MODULE COMMUNICATIONS AREA             01560050
015700******************************************************************01570050
260107     COPY DPWS991.                                                01571064
015900                                                                  01572053
015900     COPY DPLS001.                                                01580054
015900     05  WORK-STORAGE-PASSED.                                     01590050
015900                                                                  01590153
016000******************************************************************01600050
016100*PA - PROGRAM ACCUMULATORS                                        01610050
016200******************************************************************01620050
016300         10  PROGRAM-ACCUMULATORS.                                01630050
016400             15  PA-ROWS-INSERTED PIC S9(11)           VALUE ZERO 01640050
016500                                                       COMP-3.    01650050
016600                                                                  01660050
016700 01  FILLER                          PIC X(4096)  VALUE SPACE.    01670050
016800                                                                  01680050
016900                                                                  01690050
017000                                                                  01700050
017100 PROCEDURE DIVISION.                                              01710050
017200******************************************************************01720050
017300* MAINLINE-PROCESSING                                             01730050
017400******************************************************************01740050
017500                                                                  01750050
017600     PERFORM A100-INITIALIZE.                                     01760050
017700                                                                  01770050
017800     PERFORM B100-PROCESS-UPDATE-RECORDS                          01780050
017900       UNTIL DP001-PREP-TRANS-EOF.                                01790050
018000                                                                  01800050
018100     PERFORM Z990-EOJ-ROUTINE.                                    01810050
018200                                                                  01820050
018300     GOBACK.                                                      01830050
018400                                                                  01840050
018500                                                                  01850050
018600******************************************************************01860050
018700* PREFORMS TASK INITIATION                                        01870050
018800******************************************************************01880050
018900 A100-INITIALIZE.                                                 01890050
019000                                                                  01900050
019100     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01910050
019200                                                                  01920050
019300     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01930050
019400     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01940050
019500                                                                  01950050
019600     MOVE SYS-DATE (1:2) TO SD-CENT.                              01960050
019700     MOVE SYS-DATE (3:2) TO SD-YEAR.                              01970050
019800     MOVE SYS-DATE (5:2) TO SD-MONTH.                             01980050
019900     MOVE SYS-DATE (7:2) TO SD-DAY.                               01990050
020000                                                                  02000050
020100     MOVE PC-TRAN-PRES-FUNC-OPEN TO DP001-FUNC-CODE.              02010050
020200                                                                  02020050
020300     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      02030050
020400                                                                  02040050
020500                                                                  02050050
020600******************************************************************02060050
020700* PROCESS UPDATE RECORDS                                          02070050
020800******************************************************************02080050
020900 B100-PROCESS-UPDATE-RECORDS.                                     02090050
021000                                                                  02100050
021100     SET PS-RESTART-NOT-REQUIRED TO TRUE.                         02110050
021200                                                                  02120050
021300     PERFORM C100-UPDATE-FIELDS.                                  02130050
021400                                                                  02140050
021500*----------------------------------------------------------------*02150050
021600*  IF A RESTART IS REQUIRED, ISSUE A RESTART CALL RATHER THAN A  *02160050
021700*  TRANS CALL.  THIS WILL ALLOW PROCESSING TO RESUME WITH THE    *02170050
021800*  FIRST TRANSACTION AFTER THE LAST COMMIT.                      *02180050
021900*----------------------------------------------------------------*02190050
022000     IF  PS-RESTART-REQUIRED                                      02200050
022100         MOVE PC-TRAN-PRES-FUNC-RSTRT TO DP001-FUNC-CODE          02210050
022200     ELSE                                                         02220050
022300         MOVE PC-TRAN-PRES-FUNC-TRANS TO DP001-FUNC-CODE          02230050
022400     END-IF.                                                      02240050
022500                                                                  02250050
022600     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      02260050
022700                                                                  02270050
022800     ADD 1 TO PA-READ.                                            02280050
022900                                                                  02290050
023000                                                                  02300050
023100******************************************************************02310050
023200* UPDATES THE TSAADSU FIELDS                                      02320050
023300******************************************************************02330050
023400 C100-UPDATE-FIELDS.                                              02340050
023500                                                                  02350050
023600     MOVE SA007-SLS-DTE        TO SAADSU-SLS-DTE.                 02360050
023700     MOVE SA007-STR-NBR        TO SAADSU-STR-NBR.                 02370050
023800     MOVE SA007-SUM-CTG-CDE    TO SAADSU-SUM-CTG-CDE.             02380050
023900     MOVE SA007-ORIG-AMT       TO SAADSU-ORIG-AMT.                02390050
024000     MOVE SA007-ADJ-AMT        TO SAADSU-ADJ-AMT.                 02400050
024100     MOVE SA007-ADJ-IND        TO SAADSU-ADJ-IND.                 02410050
024200                                                                  02420050
024300     PERFORM WITH TEST AFTER                                      02430050
024400         VARYING PV-SQL-SUB                                       02440050
024500         FROM 1 BY 1                                              02450050
024600         UNTIL (PV-SQL-SUB > PC-MAX-RETRIES                       02460050
024700                OR SQLCODE = -911                                 02470050
024800                OR SQLCODE = 0)                                   02480050
024900                                                                  02490050
025000         EXEC SQL                                                 02500050
025100             INSERT  INTO TSAADSU                                 02510050
025200                  (  SLS_DTE                                      02520050
025300                  ,  STR_NBR                                      02530050
025400                  ,  SUM_CTG_CDE                                  02540050
025500                  ,  ORIG_AMT                                     02550050
025600                  ,  ADJ_AMT                                      02560050
025700                  ,  ADJ_IND)                                     02570050
025800              VALUES                                              02580050
025900                  (  :SAADSU-SLS-DTE                              02590050
026000                  ,  :SAADSU-STR-NBR                              02600050
026100                  ,  :SAADSU-SUM-CTG-CDE                          02610050
026200                  ,  :SAADSU-ORIG-AMT                             02620050
026300                  ,  :SAADSU-ADJ-AMT                              02630050
026400                  ,  :SAADSU-ADJ-IND)                             02640050
026500         END-EXEC                                                 02650050
026600                                                                  02660050
026700         EVALUATE TRUE                                            02670050
026800             WHEN SQLCODE = 0                                     02680050
026900                 ADD +1 TO PA-ROWS-INSERTED                       02690050
027000                                                                  02700050
027100             WHEN SQLCODE = -911                                  02710050
027200                 ADD +1 TO PV-DEADLOCK-COUNTER                    02720050
027300                                                                  02730050
027400                 DISPLAY '                   '                    02740050
027500                 DISPLAY 'DEADLOCK INCOUNTERED -911'              02750050
027600                 DISPLAY 'DEADLOCK-COUNTER = ' PV-DEADLOCK-COUNTER02760050
027700                                                                  02770050
027800                 IF PV-DEADLOCK-COUNTER > PC-MAX-DEADLOCKS        02780050
027900                     MOVE 'C100-UPDATE-FIELDS'                    02790050
028000                                      TO PV-PARAGRAPH-NAME        02800050
028100                     MOVE 'MAXIMUM DEADLOCKS EXCEEDED    '        02810050
028200                                      TO PV-DB2-OPER-ATTEMPTED    02820050
028300                     PERFORM Z200-SQL-ABEND                       02830050
028400                                                                  02840050
028500                 ELSE                                             02850050
028600                     SET PS-RESTART-REQUIRED TO TRUE              02860050
028700                 END-IF                                           02870050
028800                                                                  02880050
028900             WHEN OTHER                                           02890050
029000                 DISPLAY '                   '                    02900050
029100                 DISPLAY 'SQLCODE = ' SQLCODE                     02910050
029200                 DISPLAY 'DP001-FUNC-CODE = ' DP001-FUNC-CODE     02920050
029300                 DISPLAY 'DP001-RET-CODE  = ' DP001-RET-CODE      02930050
029400                 DISPLAY '                   '                    02940050
029500                 DISPLAY 'UPDATE ABENDED ON: '                    02950050
029600                 DISPLAY 'SLS-DTE  = ' SAADSU-SLS-DTE             02960050
029700                 DISPLAY 'STR-NBR  = ' SAADSU-STR-NBR             02970050
029800                 DISPLAY 'SUM-CTG  = ' SAADSU-SUM-CTG-CDE         02980050
029900                 DISPLAY 'ORIG-AMT = ' SAADSU-ORIG-AMT            02990050
030000                 DISPLAY 'ADJ-AMT  = ' SAADSU-ADJ-AMT             03000050
030100                 DISPLAY 'ADJ-IND  = ' SAADSU-ADJ-IND             03010050
030200                                                                  03020050
030300                 MOVE 'C100-UPDATE-FIELDS'                        03030050
030400                                        TO PV-PARAGRAPH-NAME      03040050
030500                 MOVE 'TSAADSU INSERT'                            03050050
030600                                        TO PV-DB2-OPER-ATTEMPTED  03060050
030700                                                                  03070050
030800                 PERFORM Z200-SQL-ABEND                           03080050
030900         END-EVALUATE                                             03090050
031000     END-PERFORM.                                                 03100050
031100                                                                  03110050
031200                                                                  03120050
031300     IF PV-SQL-SUB > PC-MAX-RETRIES                               03130050
031400         MOVE 'C100-UPDATE-FIELDS'      TO PV-PARAGRAPH-NAME      03140050
031500         MOVE 'VERIFY RETRIES EXCEEDED' TO PV-DB2-OPER-ATTEMPTED  03150050
031600         PERFORM Z200-SQL-ABEND                                   03160050
031700     END-IF.                                                      03170050
031800                                                                  03171062
031900                                                                  03190050
032000******************************************************************03200050
032100* BUILD THE COMMUNICATION AREA FOR A CALL TO THE TRANSACTION      03210050
032200* PRESENTATION MODULE                                             03220050
032300******************************************************************03230050
032400 X100-BUILD-COMM-AREA-TRAN-PRES.                                  03240050
032500                                                                  03250050
032600     MOVE LENGTH OF                                               03260050
032700          WORK-STORAGE-PASSED TO DP001-WORK-STRG-LENGTH.          03270050
032800     MOVE PC-CKPT-JOB-NAME    TO DP001-JOB-NAME.                  03280050
032900     MOVE PC-CKPT-PLAN-NAME   TO DP001-PLAN-NAME.                 03290050
033000                                                                  03300050
033100     PERFORM X200-CALL-TRANS-PRES-MODULE.                         03310050
033200                                                                  03320050
033300     MOVE DP001-TRANS-RECORD  TO SA007-TSAADSU-REC.               03330050
033400                                                                  03340050
033500     IF  DP001-CKPT-TAKEN                                         03350050
033700         DISPLAY '*** CHECKPOINT TAKEN ON REC: '                  03360050
033800                                       PA-ROWS-INSERTED '  '      03370050
033900                                       SAADSU-SUM-CTG-CDE         03380050
033910         DISPLAY '                             '                  03390050
034000         INITIALIZE PV-DEADLOCK-COUNTER                           03400050
034100     END-IF.                                                      03410050
034200                                                                  03420050
034300                                                                  03430050
034400******************************************************************03440050
034500* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03450050
034600******************************************************************03460050
034700 X200-CALL-TRANS-PRES-MODULE.                                     03470050
034800                                                                  03480050
034900     PERFORM Z900-CALL-TRANS-PRES-MODULE.                         03490050
035000                                                                  03500050
035100     IF  DP001-GOOD-RET-CODE                                      03510050
035200     OR  DP001-CKPT-TAKEN                                         03520050
035300     OR  DP001-RESTART                                            03530050
035400         CONTINUE                                                 03540050
035500                                                                  03550050
035600     ELSE                                                         03560050
035700         MOVE 'X200-CALL-TRANS-PRES-MODULE' TO PV-PARAGRAPH-NAME  03570050
035800         MOVE '** BAD CALL TO TRANS PREP MODULE **'               03580050
035900                                            TO PV-OPERATION-MSG   03590050
036000         MOVE DP001-RET-CODE                TO PV-RET-CODE        03600050
036100                                                                  03610050
036200         SET ABEND-4019-CAL-SUB-ERROR TO TRUE                     03620050
036300                                                                  03630050
036400         PERFORM Z100-ABEND                                       03640050
036500     END-IF.                                                      03650050
036600                                                                  03660050
036700                                                                  03670050
036800******************************************************************03680050
036900* NON-DB2 ABEND                                                   03690050
037000******************************************************************03700050
037100 Z100-ABEND.                                                      03710050
037200                                                                  03720050
037300     PERFORM Z999-CONTROLS.                                       03730050
037400                                                                  03740050
037500     DISPLAY '                     '.                             03750050
037600     DISPLAY '** ABEND           **'.                             03760050
037700     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03770050
037800     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03780050
037900     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03790050
038000     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              03800050
038100                                                                  03810050
038200     CALL 'ILBOABN0' USING ABEND-CODE.                            03820050
038300                                                                  03830050
038400                                                                  03840050
038500******************************************************************03850050
038600* ABEND THE PROGRAM IN THE EVENT THAT A SQL ERROR OR WARNING      03860050
038700* CODE OCCURS.                                                    03870050
038800******************************************************************03880050
038900 Z200-SQL-ABEND.                                                  03890050
039000                                                                  03900050
039100     PERFORM Z999-CONTROLS.                                       03910050
039200                                                                  03920050
039300     DISPLAY '** ABEND     **'.                                   03930050
039400     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                03940050
039500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              03950050
039600     DISPLAY '** OPERATION ** = ' PV-DB2-OPER-ATTEMPTED.          03960050
039700                                                                  03970050
039800******************************************************************03980050
039900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    03990050
040000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04000050
040100* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04010050
040200* FORMAT.                                                         04020050
040300******************************************************************04030050
040400     COPY DPPD004.                                                04040050
040500                                                                  04050050
040600     SET ABEND-4013-DB2-ERROR TO TRUE.                            04060050
040700                                                                  04070050
040800     CALL 'ILBOABN0' USING ABEND-CODE.                            04080050
040900                                                                  04090050
041000                                                                  04100050
041100******************************************************************04110050
041200* PREFORMS TASK TERMINATION PROCESSING                            04120050
041300******************************************************************04130050
041400 Z990-EOJ-ROUTINE.                                                04140050
041500                                                                  04150050
041600     MOVE PC-TRAN-PRES-FUNC-CLOSE TO DP001-FUNC-CODE.             04160050
041700                                                                  04170050
041800     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      04180050
041900                                                                  04190050
042000     PERFORM Z999-CONTROLS.                                       04200050
042100                                                                  04210050
042200                                                                  04220050
042300******************************************************************04230050
042400* DISPLAY CONTROLS FROM THE PROGRAM                               04240050
042500******************************************************************04250050
042600 Z999-CONTROLS.                                                   04260050
042700                                                                  04270050
042800     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04280050
042900                                                                  04290050
043000     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04300050
043100     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04310050
043200                                                                  04320050
043300     DISPLAY '                    '.                              04330050
043400     DISPLAY '**********************'.                            04340050
043500     DISPLAY '   SAKUP005 CONTROLS  '.                            04350050
043600     DISPLAY '**********************'.                            04360050
043700     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04370050
043800     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04380050
043900     DISPLAY 'END TIME  = ' ST-END-TIME.                          04390050
044000     DISPLAY '======================'.                            04400050
044100     DISPLAY 'RECORDS READ  = ' PA-READ.                          04410050
044200     DISPLAY '                '.                                  04420050
044300     DISPLAY 'ROWS INSERTED = ' PA-ROWS-INSERTED.                 04430050
044400     DISPLAY '                '.                                  04440050
044500                                                                  04450050
044600                                                                  04460050
044700******************************************************************04470050
044800* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04480050
044900* MENTS THAT ARE REQUIRED TO INVOKE THE TRANSACTION PRESENTATION  04490050
045000* MODULE (DPKUT901) OF THE DB2 CHECKPOINT RESTART SYSTEM.         04500050
045100******************************************************************04510050
045200     COPY DPPD001.                                                04520061
045300                                                                  04530050
045400                                                                  04540050
