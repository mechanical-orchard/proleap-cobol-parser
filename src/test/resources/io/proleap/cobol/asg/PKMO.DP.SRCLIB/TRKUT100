000100 IDENTIFICATION DIVISION.                                         00010074
000200                                                                  00020074
000300 PROGRAM-ID.    TRKUT100.                                         00030074
000400 AUTHOR.        SUE PARI.                                         00040074
000500 DATE-WRITTEN.  08/03/99.                                         00050074
000600 DATE-COMPILED.                                                   00060074
000700                                                                  00070074
000800******************************************************************00080074
000900*  THIS PROGRAM REFORMATS THE UNIX 4010 214 FILE INTO A FORMAT   *00090074
001000*  THAT CAN BE USED IN TRK010.                                   *00100074
001100*                                                                *00110074
001200*  01/06/2003   VISWA KARUTURI                                   *00120074
001300*                         CHANGED TO NEW LAYOUTS ETRD018 AND     *00130074
001400*                         TRRD001, SKIP SSR STATUSES AND CREATE  *00140074
001500*                         FILE ONLY FOR LEGACY PROCESS.          *00150074
001600*                                                                 00160074
001700*  12/20/11 CHRISTINE TWIEHAUS WR40574                            00170075
001800*           ADDED CAN (CARR-AUTH-ID) FROM ETRD018, TYPE 02,       00180074
001900*           HEADER QUALIFIER 06.  MOVING ET214-L11-HEADER-REF     00190074
002000*                                     TO TR001-B1001-CAN.         00200074
002100******************************************************************00210074
002200                                                                  00220074
002300 ENVIRONMENT DIVISION.                                            00230074
002400                                                                  00240074
002500 CONFIGURATION SECTION.                                           00250074
002600                                                                  00260074
002700 INPUT-OUTPUT SECTION.                                            00270074
002800                                                                  00280074
002900 FILE-CONTROL.                                                    00290074
003000                                                                  00300074
003100     SELECT INPUT-FILE                                            00310074
003200         ASSIGN TO IN01.                                          00320074
003300                                                                  00330074
003400     SELECT OUTPUT-FILE                                           00340074
003500         ASSIGN TO OUT01.                                         00350074
003600                                                                  00360074
003700                                                                  00370074
003800 DATA DIVISION.                                                   00380074
003900                                                                  00390074
004000 FILE SECTION.                                                    00400074
004100                                                                  00410074
004200 FD  INPUT-FILE                                                   00420074
004300     LABEL RECORDS ARE STANDARD                                   00430074
004400     RECORD CONTAINS 400 CHARACTERS                               00440074
004500     DATA RECORD IS ET214-SHIP-STATUS-RECORD.                     00450074
004600                                                                  00460074
004700     COPY ETRD018.                                                00470074
004800                                                                  00480074
004900                                                                  00490074
005000 FD  OUTPUT-FILE                                                  00500074
005100     LABEL RECORDS ARE STANDARD                                   00510074
005200     RECORD CONTAINS 350 CHARACTERS                               00520074
005300     DATA RECORD IS TR001-SHIPT-STATUS-MSG-RECORD.                00530074
005400                                                                  00540074
005500     COPY TRRD001.                                                00550074
005600                                                                  00560074
005700                                                                  00570074
005800 WORKING-STORAGE SECTION.                                         00580074
005900                                                                  00590074
006000                                                                  00600074
006100 01  WS-DATE-CCYYMMDD          PIC X(8)    VALUE SPACES.          00610074
006200 01  WS-SHORT-DATE REDEFINES WS-DATE-CCYYMMDD.                    00620074
006300     05  WS-DATE-CC            PIC X(2).                          00630074
006400     05  WS-DATE-YYMMDD        PIC X(6).                          00640074
006500                                                                  00650074
006600 01  WS-WEIGHT                 PIC 9(8)    VALUE ZERO.            00660074
006700                                                                  00670074
006800 01  SUB1                      PIC 9(3)    VALUE ZERO.            00680074
006900 01  SUB2                      PIC 9(3)    VALUE ZERO.            00690074
007000 01  SUB3                      PIC 9(3)    VALUE ZERO.            00700074
007100 01  WS-STATUS-REC-COUNT       PIC 9(3)    VALUE ZERO.            00710074
007200 01  WS-PO-REC-COUNT           PIC 9(4)    VALUE ZERO.            00720074
007300 01  WS-SUMMARY-REC-COUNT      PIC 9(3)    VALUE ZERO.            00730074
007400                                                                  00740074
007500 01  WS-OUTPUT-TABLE.                                             00750074
007600     05  WS-OUTPUT-ST          PIC X(350)  VALUE SPACES.          00760074
007700     05  WS-OUTPUT-B10         PIC X(350)  VALUE SPACES.          00770074
007800     05  WS-OUTPUT-N9-MA       PIC X(350)  VALUE SPACES.          00780074
007900     05  WS-OUTPUT-N9-PO-TABLE OCCURS 100 TIMES.                  00790074
008000         10  WS-OUTPUT-N9-PO   PIC X(350).                        00800074
008100     05  WS-OUTPUT-N1-SH       PIC X(350)  VALUE SPACES.          00810074
008200     05  WS-OUTPUT-N1-ST       PIC X(350)  VALUE SPACES.          00820074
008300     05  WS-OUTPUT-Q5-TABLE OCCURS 200 TIMES.                     00830074
008400         10  WS-OUTPUT-Q5      PIC X(350).                        00840074
008500     05  WS-OUTPUT-Q6          PIC X(350)  VALUE SPACES.          00850074
008600     05  WS-OUTPUT-SE          PIC X(350)  VALUE SPACES.          00860074
008700                                                                  00870074
008800 01  END-OF-INPUT-FILE-SW      PIC X(1)    VALUE 'N'.             00880074
008900     88  END-OF-INPUT-FILE                 VALUE 'Y'.             00890074
009000                                                                  00900074
009100 01  SKIP-SUMMARY-REC-SW       PIC X(1)    VALUE 'N'.             00910074
009200     88  SKIP-SUMMARY-REC                  VALUE 'Y'.             00920074
009300     88  SKIP-SUMMARY-REC-NO               VALUE 'N'.             00930074
009400                                                                  00940074
009500 01  SKIP-PO-REC-SW            PIC X(1)    VALUE 'N'.             00950074
009600     88  SKIP-PO-REC                       VALUE 'Y'.             00960074
009700     88  SKIP-PO-REC-NO                    VALUE 'N'.             00970074
009800                                                                  00980074
009900 01  SKIP-STATUS-REC-SW        PIC X(1)    VALUE 'N'.             00990074
010000     88  SKIP-STATUS-REC                   VALUE 'Y'.             01000074
010100     88  SKIP-STATUS-REC-NO                VALUE 'N'.             01010074
010200                                                                  01020074
010300 01  STATUS-REC-SENT-SW        PIC X(1)    VALUE 'N'.             01030074
010400     88  STATUS-REC-SENT                   VALUE 'Y'.             01040074
010500     88  STATUS-REC-NOT-SENT               VALUE 'N'.             01050074
010600                                                                  01060074
010700 01  STATUS-REC-LOADED-SW      PIC X(1)    VALUE 'N'.             01070074
010800     88  STATUS-REC-LOADED                 VALUE 'Y'.             01080074
010900     88  STATUS-REC-NOT-LOADED             VALUE 'N'.             01090074
011000                                                                  01100074
011100                                                                  01110074
011200 PROCEDURE DIVISION.                                              01120074
011300                                                                  01130074
011400     OPEN INPUT  INPUT-FILE.                                      01140074
011500     OPEN OUTPUT OUTPUT-FILE.                                     01150074
011600     INITIALIZE  WS-OUTPUT-TABLE.                                 01160074
011700                                                                  01170074
011800     PERFORM 6000-READ-INPUT-FILE                                 01180074
011900        THRU 6000-READ-INPUT-FILE-EXIT.                           01190074
012000                                                                  01200074
012100     PERFORM 1000-REFORMAT-FILE                                   01210074
012200        THRU 1000-REFORMAT-FILE-EXIT                              01220074
012300           UNTIL END-OF-INPUT-FILE.                               01230074
012400                                                                  01240074
012500     IF WS-OUTPUT-ST = SPACES OR LOW-VALUES                       01250074
012600         CONTINUE                                                 01260074
012700     ELSE                                                         01270074
012800         IF STATUS-REC-LOADED    OR                               01280074
012900             STATUS-REC-NOT-SENT                                  01290074
013000             PERFORM 7000-WRITE-OUTPUT-FILE                       01300074
013100                THRU 7000-WRITE-OUTPUT-FILE-EXIT                  01310074
013200         END-IF                                                   01320074
013300     END-IF.                                                      01330074
013400                                                                  01340074
013500     CLOSE INPUT-FILE.                                            01350074
013600     CLOSE OUTPUT-FILE.                                           01360074
013700                                                                  01370074
013800     STOP RUN.                                                    01380074
013900                                                                  01390074
014000                                                                  01400074
014100 1000-REFORMAT-FILE.                                              01410074
014200                                                                  01420074
014300     IF ET214-HEADER-RECORD                                       01430074
014400         PERFORM 2000-PROCESS-HEADER-REC                          01440074
014500            THRU 2000-PROCESS-HEADER-REC-EXIT.                    01450074
014600                                                                  01460074
014700     IF ET214-MAN-CAN-RECORD                                      01470074
014800         PERFORM 2500-PROCESS-MAN-CAN-REC                         01480074
014900            THRU 2500-PROCESS-MAN-CAN-REC-EXIT.                   01490074
015000                                                                  01500074
015100     IF ET214-STATUS-RECORD       AND                             01510074
015200        SKIP-STATUS-REC-NO        AND                             01520074
015300        WS-SUMMARY-REC-COUNT < 10                                 01530074
015400         PERFORM 3000-PROCESS-DETAIL-REC                          01540074
015500            THRU 3000-PROCESS-DETAIL-REC-EXIT.                    01550074
015600                                                                  01560074
015700     IF ET214-SUMMARY-RECORD      AND                             01570074
015800        WS-SUMMARY-REC-COUNT < 10                                 01580074
015900         PERFORM 4000-PROCESS-SUMMARY-REC                         01590074
016000            THRU 4000-PROCESS-SUMMARY-REC-EXIT.                   01600074
016100                                                                  01610074
016200     IF ET214-PO-RECORD           AND                             01620074
016300        SKIP-PO-REC-NO            AND                             01630074
016400        WS-SUMMARY-REC-COUNT < 10                                 01640074
016500          PERFORM 5000-PROCESS-PO-REC                             01650074
016600             THRU 5000-PROCESS-PO-REC-EXIT.                       01660074
016700                                                                  01670074
016800     PERFORM 6000-READ-INPUT-FILE                                 01680074
016900        THRU 6000-READ-INPUT-FILE-EXIT.                           01690074
017000                                                                  01700074
017100 1000-REFORMAT-FILE-EXIT.                                         01710074
017200     EXIT.                                                        01720074
017300                                                                  01730074
017400                                                                  01740074
017500 2000-PROCESS-HEADER-REC.                                         01750074
017600                                                                  01760074
017700     IF WS-OUTPUT-ST = SPACES OR LOW-VALUES                       01770074
017800         CONTINUE                                                 01780074
017900     ELSE                                                         01790074
018000         IF STATUS-REC-LOADED    OR                               01800074
018100            STATUS-REC-NOT-SENT                                   01810074
018200             PERFORM 7000-WRITE-OUTPUT-FILE                       01820074
018300                THRU 7000-WRITE-OUTPUT-FILE-EXIT                  01830074
018400         END-IF                                                   01840074
018500     END-IF.                                                      01850074
018600                                                                  01860074
018700     INITIALIZE WS-OUTPUT-TABLE.                                  01870074
018800     MOVE ZERO                     TO SUB1                        01880074
018900                                      SUB2                        01890074
019000                                      WS-STATUS-REC-COUNT         01900074
019100                                      WS-PO-REC-COUNT             01910074
019200                                      WS-SUMMARY-REC-COUNT.       01920074
019300     SET STATUS-REC-NOT-SENT       TO TRUE                        01930074
019400     SET STATUS-REC-NOT-LOADED     TO TRUE                        01940074
019500     SET SKIP-SUMMARY-REC-NO       TO TRUE                        01950074
019600     SET SKIP-PO-REC-NO            TO TRUE                        01960074
019700     SET SKIP-STATUS-REC-NO        TO TRUE                        01970074
019800                                                                  01980074
019900     MOVE SPACES                   TO                             01990074
020000                                    TR001-SHIPT-STATUS-MSG-RECORD.02000074
020100     MOVE 'ST '                    TO TR001-REC-TYP-CDE.          02010074
020200     MOVE ET214-ST-CONTROL-NUMBER  TO                             02020074
020300                                    TR001-TRANS-SET-HDR-CNTL-NBR. 02030074
020400     MOVE ET214-ISA-CONTROL-NUMBER TO TR001-ISA-CNTL-NBR.         02040074
020500     MOVE ET214-GS-CONTROL-NUMBER  TO TR001-GS-CNTL-NBR.          02050074
020600     MOVE ET214-TIMESTAMP          TO TR001-TIMESTAMP.            02060074
020700     MOVE ET214-SESSION-NUMBER     TO TR001-SESSION-NBR.          02070074
020800     MOVE ET214-ISA-ID-QUAL        TO TR001-ISA-ID-QUAL.          02080074
020900     MOVE ET214-ISA-ID             TO TR001-ISA-ID.               02090074
021000     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           02100074
021100                                   TO WS-OUTPUT-ST.               02110074
021200                                                                  02120074
021300     MOVE SPACES                   TO                             02130074
021400                                    TR001-SHIPT-STATUS-MSG-RECORD.02140074
021500     MOVE 'B10'                    TO TR001-B10-ID.               02150074
021600     MOVE ET214-PRO-NUMBER         TO TR001-B1001-PRO-NBR.        02160074
021700     IF ET214-SHIPMENT-ID-NUMBER = SPACES                         02170074
021800         MOVE 'N/A'                TO TR001-B1002-BOL-NBR         02180074
021900     ELSE                                                         02190074
022000         MOVE ET214-SHIPMENT-ID-NUMBER TO TR001-B1002-BOL-NBR     02200074
022100     END-IF.                                                      02210074
022200     MOVE ET214-SCAC-CODE          TO TR001-B1003-CARR-SCAC.      02220074
022300     MOVE ET214-INQ-REQ-NUMBER     TO TR001-B1004-INQ-REQ-NBR.    02230074
022400     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           02240074
022500                                   TO WS-OUTPUT-B10.              02250074
022600                                                                  02260074
022700     PERFORM VARYING SUB3 FROM 1 BY 1                             02270074
022800         UNTIL SUB3 > 5                                           02280074
022900           EVALUATE TRUE                                          02290074
023000              WHEN ET214-SHIP-FROM(SUB3)                          02300074
023100                  MOVE SPACES     TO TR001-SHIPT-STATUS-MSG-RECORD02310074
023200                  MOVE 'N1 '      TO TR001-N1-ID                  02320074
023300                  MOVE 'SH'       TO TR001-N101-ID-CDE            02330074
023400                  MOVE ET214-N1-ENTITY-NAME(SUB3)                 02340074
023500                                  TO TR001-N102-SHIPR-NAME        02350074
023600                  MOVE SPACES     TO TR001-N103-ID-QUAL-CDE       02360074
023700                  MOVE SPACES     TO TR001-N104-OPER-UNT-ID       02370074
023800                  MOVE TR001-SHIPT-STATUS-MSG-RECORD              02380074
023900                                  TO WS-OUTPUT-N1-SH              02390074
024000              WHEN ET214-SHIP-TO(SUB3)                            02400074
024100                  MOVE SPACES     TO TR001-SHIPT-STATUS-MSG-RECORD02410074
024200                  MOVE 'N1 '      TO TR001-N1-ID                  02420074
024300                  MOVE 'ST'       TO TR001-N101-ID-CDE            02430074
024400                  MOVE ET214-N1-ENTITY-NAME(SUB3)                 02440074
024500                                  TO TR001-N102-SHIPR-NAME        02450074
024600                  MOVE '94'       TO TR001-N103-ID-QUAL-CDE       02460074
024700                  MOVE ET214-N1-STORE-DC-NUMBER(SUB3)             02470074
024800                                  TO TR001-N104-OPER-UNT-ID       02480074
024900                  MOVE TR001-SHIPT-STATUS-MSG-RECORD              02490074
025000                                  TO WS-OUTPUT-N1-ST              02500074
025100           END-EVALUATE                                           02510074
025200     END-PERFORM.                                                 02520074
025300                                                                  02530074
025400     MOVE SPACES                  TO                              02540074
025500                                    TR001-SHIPT-STATUS-MSG-RECORD.02550074
025600     MOVE 'SE '                   TO TR001-REC-TYP-CDE.           02560074
025700     MOVE ET214-ST-CONTROL-NUMBER TO TR001-TRANS-SET-TRL-CNTL-NBR.02570074
025800     MOVE TR001-SHIPT-STATUS-MSG-RECORD                           02580074
025900                                  TO WS-OUTPUT-SE.                02590074
026000                                                                  02600074
026100 2000-PROCESS-HEADER-REC-EXIT.                                    02610074
026200     EXIT.                                                        02620074
026300                                                                  02630074
026400                                                                  02640074
026500 2500-PROCESS-MAN-CAN-REC.                                        02650074
026600                                                                  02660074
026700     IF ET214-MANIFEST                                            02670074
026800        MOVE SPACES               TO TR001-SHIPT-STATUS-MSG-RECORD02680074
026900         MOVE 'N9 '               TO TR001-N9-ID                  02690074
027000         MOVE 'MA'                TO TR001-N901-REF-NBR-QUAL      02700074
027100         MOVE ET214-L11-HEADER-REF TO TR001-N902-REF-NBR          02710074
027200         MOVE SPACES              TO TR001-N903-PO-EXPTED-CART-CNT02720074
027300         MOVE TR001-SHIPT-STATUS-MSG-RECORD                       02730074
027400                                  TO WS-OUTPUT-N9-MA              02740074
027401     END-IF.                                                      02740174
027402                                                                  02740274
027403* CLT 12-20-2011 WR40574 START                                    02740374
027420     IF ET214-CAN-NUMBER                                          02742075
027430        MOVE SPACES               TO TR001-SHIPT-STATUS-MSG-RECORD02743074
027440         MOVE 'N9 '               TO TR001-N9-ID                  02744074
027450         MOVE 'CN'                TO TR001-N901-REF-NBR-QUAL      02745074
027460         MOVE ET214-L11-HEADER-REF TO TR001-N902-REF-NBR          02746074
027470         MOVE SPACES              TO TR001-N903-PO-EXPTED-CART-CNT02747074
027480         MOVE TR001-SHIPT-STATUS-MSG-RECORD                       02748074
027490                                  TO WS-OUTPUT-N9-MA              02749077
027500     END-IF.                                                      02750074
027510* CLT 12-20-2011 WR40574 END                                      02751074
027600                                                                  02760074
027700 2500-PROCESS-MAN-CAN-REC-EXIT.                                   02770074
027800     EXIT.                                                        02780074
027900                                                                  02790074
028000                                                                  02800074
028100 3000-PROCESS-DETAIL-REC.                                         02810074
028200                                                                  02820074
028300     SET STATUS-REC-SENT TO TRUE.                                 02830074
028400                                                                  02840074
028500     IF WS-STATUS-REC-COUNT < 20                                  02850074
028600         IF (ET214-STATUS-CODE = 'X1' OR 'X3' OR 'B6') OR         02860074
028700            (ET214-APPT-STATUS-CODE = 'AB')                       02870074
028800             CONTINUE                                             02880074
028900         ELSE                                                     02890074
029000             MOVE SPACES     TO TR001-SHIPT-STATUS-MSG-RECORD     02900074
029100             MOVE 'Q5 '      TO TR001-Q5-ID                       02910074
029200             EVALUATE ET214-STATUS-CODE                           02920074
029300                 WHEN 'D1'                                        02930074
029400                   MOVE 'D ' TO TR001-Q501-SHIPT-STATUS-CDE       02940074
029500                 WHEN 'L1'                                        02950074
029600                   MOVE 'L ' TO TR001-Q501-SHIPT-STATUS-CDE       02960074
029700                 WHEN 'P1'                                        02970074
029800                   MOVE 'P ' TO TR001-Q501-SHIPT-STATUS-CDE       02980074
029900                 WHEN 'S1'                                        02990074
030000                   MOVE 'S ' TO TR001-Q501-SHIPT-STATUS-CDE       03000074
030100                 WHEN 'X4'                                        03010074
030200                   MOVE 'A ' TO TR001-Q501-SHIPT-STATUS-CDE       03020074
030300                 WHEN OTHER                                       03030074
030400                   MOVE ET214-STATUS-CODE                         03040074
030500                             TO TR001-Q501-SHIPT-STATUS-CDE       03050074
030600             END-EVALUATE                                         03060074
030700             MOVE ET214-DATE         TO WS-DATE-CCYYMMDD          03070074
030800             MOVE WS-DATE-YYMMDD     TO TR001-Q502-STATUS-DATE    03080074
030900             MOVE ET214-TIME         TO TR001-Q503-STATUS-TIME    03090074
031000             MOVE ET214-TIME-CODE    TO TR001-Q504-TIME-ZONE      03100074
031100             MOVE ET214-REASON-CODE  TO TR001-Q505-DELAY-RSN-CDE  03110074
031200             IF ET214-APPT-STATUS-CODE = 'AA'                     03120074
031300                 MOVE ET214-APPT-REASON-CODE                      03130074
031400                                     TO TR001-Q505-DELAY-RSN-CDE  03140074
031500                 MOVE ET214-APPT-STATUS-CODE                      03150074
031600                                    TO TR001-Q501-SHIPT-STATUS-CDE03160074
031700             END-IF                                               03170074
031800             MOVE ET214-CITY         TO TR001-Q506-CITY           03180074
031900             MOVE ET214-STATE        TO TR001-Q507-STATE          03190074
032000             MOVE ET214-CARRIER-SCAC TO TR001-Q509-LSD-CARR-ID    03200074
032100             MOVE ET214-EQUIPMENT-NUMBER TO TR001-Q510-VEH-NBR    03210074
032200             ADD 1 TO SUB1                                        03220074
032300             MOVE TR001-SHIPT-STATUS-MSG-RECORD                   03230074
032400                                     TO WS-OUTPUT-Q5(SUB1)        03240074
032500             ADD 1 TO WS-STATUS-REC-COUNT                         03250074
032600             SET STATUS-REC-LOADED   TO TRUE                      03260074
032700         END-IF                                                   03270074
032800     ELSE                                                         03280074
032900         DISPLAY 'MORE THAN 20 STATUS RECORDS PER SUMMARY RECORD' 03290074
033000         SET SKIP-STATUS-REC         TO TRUE                      03300074
033100     END-IF.                                                      03310074
033200                                                                  03320074
033300 3000-PROCESS-DETAIL-REC-EXIT.                                    03330074
033400     EXIT.                                                        03340074
033500                                                                  03350074
033600                                                                  03360074
033700 4000-PROCESS-SUMMARY-REC.                                        03370074
033800                                                                  03380074
033900     MOVE ZERO                  TO WS-STATUS-REC-COUNT.           03390074
034000     ADD  1                     TO WS-SUMMARY-REC-COUNT.          03400074
034100     SET SKIP-STATUS-REC-NO     TO TRUE.                          03410074
034200     IF WS-PO-REC-COUNT > 0                                       03420074
034300         SET SKIP-PO-REC        TO TRUE                           03430074
034400     END-IF.                                                      03440074
034500     IF SKIP-SUMMARY-REC-NO                                       03450074
034600         MOVE SPACES            TO TR001-SHIPT-STATUS-MSG-RECORD  03460074
034700         MOVE 'Q6 '             TO TR001-Q6-ID                    03470074
034800         MOVE ET214-WEIGHT      TO WS-WEIGHT                      03480074
034900         MOVE WS-WEIGHT         TO TR001-Q601-EXPTED-GRO-WGHT     03490074
035000         MOVE ET214-LADING-QUANTITY                               03500074
035100                                TO TR001-Q604-EXPTED-PKG-QTY      03510074
035200         MOVE 'CTN'             TO TR001-Q605-PKG-TYP-CDE         03520074
035300         MOVE SPACES            TO TR001-Q606-FRGT-TERMS-CDE      03530074
035400         IF ET214-CHARGE-SIGN = '-'                               03540074
035500             COMPUTE TR001-Q607-FRGT-CHG-AMT = 0 - ET214-CHARGE   03550074
035600         ELSE                                                     03560074
035700             MOVE ET214-CHARGE  TO TR001-Q607-FRGT-CHG-AMT        03570074
035800         END-IF                                                   03580074
035900         MOVE TR001-SHIPT-STATUS-MSG-RECORD                       03590074
036000                                TO WS-OUTPUT-Q6                   03600074
036100         SET SKIP-SUMMARY-REC   TO TRUE                           03610074
036200     END-IF.                                                      03620074
036300                                                                  03630074
036400 4000-PROCESS-SUMMARY-REC-EXIT.                                   03640074
036500     EXIT.                                                        03650074
036600                                                                  03660074
036700                                                                  03670074
036800 5000-PROCESS-PO-REC.                                             03680074
036900                                                                  03690074
037000     IF WS-PO-REC-COUNT < 100                                     03700074
037100         MOVE SPACES             TO TR001-SHIPT-STATUS-MSG-RECORD 03710074
037200         MOVE 'N9 '              TO TR001-N9-ID                   03720074
037300         MOVE 'PO'               TO TR001-N901-REF-NBR-QUAL       03730074
037400         MOVE ET214-PO-NUMBER    TO TR001-N902-REF-NBR            03740074
037500         IF ET214-QUANTITY = ZERO                                 03750074
037600             MOVE SPACES         TO TR001-N903-PO-EXPTED-CART-CNT 03760074
037700         ELSE                                                     03770074
037800             MOVE ET214-QUANTITY TO TR001-N903-PO-EXPTED-CART-CNT 03780074
037900         END-IF                                                   03790074
038000         ADD 1 TO SUB2                                            03800074
038100         MOVE TR001-SHIPT-STATUS-MSG-RECORD                       03810074
038200                                 TO WS-OUTPUT-N9-PO(SUB2)         03820074
038300         ADD 1 TO WS-PO-REC-COUNT                                 03830074
038400     ELSE                                                         03840074
038500         DISPLAY 'MORE THAN 100 PO NUMBERS SENT. ONE OF THE PO #  03850074
038600-                   ' IS ' ET214-PO-NUMBER                        03860074
038700         SET SKIP-PO-REC         TO TRUE                          03870074
038800     END-IF.                                                      03880074
038900                                                                  03890074
039000 5000-PROCESS-PO-REC-EXIT.                                        03900074
039100     EXIT.                                                        03910074
039200                                                                  03920074
039300                                                                  03930074
039400 6000-READ-INPUT-FILE.                                            03940074
039500                                                                  03950074
039600     READ INPUT-FILE                                              03960074
039700        AT END                                                    03970074
039800           SET END-OF-INPUT-FILE TO TRUE.                         03980074
039900                                                                  03990074
040000 6000-READ-INPUT-FILE-EXIT.                                       04000074
040100     EXIT.                                                        04010074
040200                                                                  04020074
040300                                                                  04030074
040400 7000-WRITE-OUTPUT-FILE.                                          04040074
040500                                                                  04050074
040600     WRITE TR001-SHIPT-STATUS-MSG-RECORD FROM WS-OUTPUT-ST.       04060074
040700     WRITE TR001-SHIPT-STATUS-MSG-RECORD FROM WS-OUTPUT-B10.      04070074
040800                                                                  04080074
040900     IF WS-OUTPUT-N9-MA = SPACES OR LOW-VALUES                    04090074
041000         CONTINUE                                                 04100074
041100     ELSE                                                         04110074
041200         WRITE TR001-SHIPT-STATUS-MSG-RECORD                      04120074
041300                                 FROM WS-OUTPUT-N9-MA             04130074
041400     END-IF.                                                      04140074
041500                                                                  04150074
041600     PERFORM VARYING SUB2 FROM 1 BY 1                             04160074
041700          UNTIL (WS-OUTPUT-N9-PO(SUB2) = SPACES OR LOW-VALUES)    04170074
041800             OR (SUB2 > 100)                                      04180074
041900              WRITE TR001-SHIPT-STATUS-MSG-RECORD                 04190074
042000                                 FROM WS-OUTPUT-N9-PO(SUB2)       04200074
042100     END-PERFORM.                                                 04210074
042200                                                                  04220074
042300     IF WS-OUTPUT-N1-SH = SPACES OR LOW-VALUES                    04230074
042400         CONTINUE                                                 04240074
042500     ELSE                                                         04250074
042600         WRITE TR001-SHIPT-STATUS-MSG-RECORD                      04260074
042700                                 FROM WS-OUTPUT-N1-SH             04270074
042800     END-IF.                                                      04280074
042900                                                                  04290074
043000     IF WS-OUTPUT-N1-ST = SPACES OR LOW-VALUES                    04300074
043100         CONTINUE                                                 04310074
043200     ELSE                                                         04320074
043300         WRITE TR001-SHIPT-STATUS-MSG-RECORD                      04330074
043400                                 FROM WS-OUTPUT-N1-ST             04340074
043500     END-IF.                                                      04350074
043600                                                                  04360074
043700     PERFORM VARYING SUB1 FROM 1 BY 1                             04370074
043800          UNTIL (WS-OUTPUT-Q5(SUB1) = SPACES OR LOW-VALUES)       04380074
043900             OR SUB1 > 200                                        04390074
044000              WRITE TR001-SHIPT-STATUS-MSG-RECORD                 04400074
044100                                 FROM WS-OUTPUT-Q5(SUB1)          04410074
044200     END-PERFORM.                                                 04420074
044300                                                                  04430074
044400     IF WS-OUTPUT-Q6 = SPACES OR LOW-VALUES                       04440074
044500         MOVE SPACES            TO TR001-SHIPT-STATUS-MSG-RECORD  04450074
044600         MOVE 'Q6 '             TO TR001-Q6-ID                    04460074
044700         MOVE 'CTN'             TO TR001-Q605-PKG-TYP-CDE         04470074
044800         MOVE ZEROS             TO TR001-Q601-EXPTED-GRO-WGHT     04480074
044900                                   TR001-Q607-FRGT-CHG-AMT        04490074
045000                                   TR001-Q604-EXPTED-PKG-QTY      04500074
045100         MOVE SPACES            TO TR001-Q606-FRGT-TERMS-CDE      04510074
045200         MOVE TR001-SHIPT-STATUS-MSG-RECORD                       04520074
045300                                TO WS-OUTPUT-Q6                   04530074
045400     END-IF.                                                      04540074
045500                                                                  04550074
045600     WRITE TR001-SHIPT-STATUS-MSG-RECORD FROM WS-OUTPUT-Q6        04560074
045700     WRITE TR001-SHIPT-STATUS-MSG-RECORD FROM WS-OUTPUT-SE.       04570074
045800                                                                  04580074
045900 7000-WRITE-OUTPUT-FILE-EXIT.                                     04590074
046000     EXIT.                                                        04600074
