000010******************************************************************00001006
000020 IDENTIFICATION DIVISION.                                         00002006
000030******************************************************************00003006
000040*   THIS VERSION IS SENDING FORM AND DATA                         00004006
000050******************************************************************00005006
000060                                                                  00006006
000070 PROGRAM-ID.             SUKRF502.                                00007006
000080 AUTHOR.                 LARRY SCHLEICHER.                        00008006
000090 INSTALLATION.           KOHLS.                                   00009006
000100 DATE-WRITTEN.           JUNE, 1996.                              00010006
000110 DATE-COMPILED.                                                   00011006
000120                                                                  00012006
000130******************************************************************00013006
000140* THIS PROGRAM DISPLAYS THE SCAN CARTON SCREEN ON THE LRT (LASER  00014006
000150* RADIO TERMINAL).  IT WILL ACCEPT THE ENTRY OF THE CARTON NUMBER.00015006
000160******************************************************************00016006
000170* 11/06/2008  CHRISTINE TWIEHAUS                                 *00017006
000180*             DUEL FEED PRINT AND APPLY WITH AUTO CONVEYOR       *00018006
000190*             DETERMINE IF DUAL FEED IS ENABLED, FORMAT CALL TO  *00019006
000200*             DIRECTIVE GENERATOR, DETERMINE DIVERTS TO          *00020006
000210*             PRINT AND APPLY STATION LINE AND DC                *00021006
000220* 11/28/2008  DAVID MEDICI                                       *00022006
000230*             CORRECTIONS PER UNIT TESTING OF 11/06/2008 MODS    *00023006
000240* 06/07/2010  PRASANTHI BADUKONDA      TKID: TKMAW45             *00024006
000250*             MODIFIED TO SCAN THE IMPORT REPLENISHMENT CARTONS  *00025006
000260*             AT DC THROUGH THE RF GUN AND TO MAKE SURE THAT     *00026006
000270*             IR CARTONS WITH SML'S DO NOT GET DIVERTED AND      *00027006
000280*             TRAVEL TO TAKEAWAY WITH A NEW LABEL BEING PRINTED. *00028006
000290*             ADDED NEW PARAGRAPHS 7710-SELECT-OTBND-CART ,      *00029006
000300*             7720-SELECT-OTBND-UPC , 7730-CHECK-INBND-TRIP-ID , *00030006
000310*             7740-PROCESS-WHSE-REPLN-LABEL AND DCLGEN FOR THE   *00031006
000320*             NEW TABLE SUT_TRLR_RPLN_CART.                      *00032006
000330*             CHANGES TAGGED AS PB 06/07/2010                    *00033006
000340* 07/02/2010  EKTA AGRAWAL             TKID: TKMAV49             *00034006
000350*             MODIFIED TO CALL THE NEW PROGRAM PCKUT790 TO UPDATE*00035006
000360*             THE SUMMARY WORKED DATABASE FOR THE IR CARTONS THAT*00036006
000370*             HAS BEEN SCANNED AND INSERTED TO THE OUTBOUND      *00037006
000380*             LOCATION TABLE.                                    *00038006
000390*             CHANGES TAGGED AS EA 07/02/2010                    *00039006
000400* 04/23/2013  CHERI PARMLEY            TKID: TKMAF76             *00040006
000410*             MODIFIED FOR THE RFID PROJECT #5148B. THIS CHANGE  *00041006
000420*             WILL MARK EACH SML OR P2L LABEL AS RFID BY SETTING *00042006
000430*             THE PRC_MSG_CDE TO 'RD' ON THE TLBPTDA TABLE.      *00043006
000440*             NEW RFID SUBROUTINE (SUKUT149) IS CALLED TO        *00044006
000450*             DETERMINE IF RFID WHICH IS EXECUTED IN PARA 6010-. *00045006
000460*             SUBROUTINE ALSO SETS DIRECTIVE AND IF RFID SHOULD  *00046006
000470*             PRINT ON LABEL. THESE NEW VALUES ARE USED THRU OUT *00047006
000480*             THE PROGRAM TO MAKE A DECISION.                    *00048006
000490*             OUTBOUND LABELS NOW IF RFID WILL NOW DISPLAY       *00049006
000500*            'REPL RFID' ON THEM.                                *00050006
000510*             CHANGES TAGGED AS CLP 04/23/13 PR5148B             *00051006
000520*                                           CHG0055296           *00052006
000530* 07/19/13 RLK BEG                                                00053006
000540* 07/17/2013  RICH KELLEN  CHG0058309  TKID: TKMAA71             *00054006
000550*             CHANGE TO ADD CREATION OF NEW DESTINATION AND       00055006
000560*             MESSAGE LABELS FOR SOME NON-AUTO CONVEYOR DC'S.     00056006
000570*             THE DC'S USING THE NEW LABEL TYPES WILL BE          00057006
000580*             BY A NEW ROW TYPE ON THE TKRPRPM TABLE.             00058006
000590* 07/19/13 RLK END                                                00059006
000600* 09/23/13 SB BEG                                                 00060006
000610* 09/23/2013  SHOBHIT BAIJAL CHG0063318     TKID: TKMALR7        *00061006
000620*             CHANGE TO ADD LOGIC TO CHECK CARTONS FOR IMPORT     00062006
000630*             REPLEN AND ONLY IF THAT IS TRUE, THEN CHECK FOR     00063006
000640*             RFID TAGGING.                                       00064006
000650* 09/23/13 SB END                                                 00065006
000660* 10/24/13    CHERI PARMLEY  CHG0068598     TKID: TKMAF76        *00066006
000670*             ADD LOGIC FOR RFID AUDIT-RECEIVING CAN NOW HAVE A   00067006
000680*             COMBINATION OF AUDITS. EITHER QC OR RFID OR COMBO.  00068006
000690*             ALSO INCLUDED LOGIC TO PASS FIELDS TO THE RFID      00069006
000700*             MODULE FOR IR PROCESSING. THE MODULE WILL NOW TELL  00070006
000710*             IF THE IR FACILITY IS NOW TAGGING BY DEPT.          00071006
000720*             --------------------------------------------------- 00072076
000730*             WITHIN 6020-SET-DIRECT-AND-LABEL NEW PARA 6030- IS  00073006
000740*             EXECUTED TO CHECK IF RFID AUDIT IS NEEDED. NEW      00074006
000750*             PROGRAM IS BEING CALLED SUKCS720 TO DETERMINE THIS. 00075006
000760*             COMING BACK FROM THIS PROGRAM NEW SWITCHES ARE SET  00076006
000770*             IN THE SURD021 COPY WHICH REFLECTS THE RESULTS OF   00077006
000780*             THE AUDIT. THESE SWITCHES ARE USED THRU OUT THE     00078006
000790*             PROGRAM TO SEE WHAT STATUS THE RFID AUDIT IS IN.    00079006
000800*             SU021-RFID-AUDIT-VALIDATION-SW AND ITS 88 LEVELS    00080006
000810*             HAVE BEEN ADDED.                                    00081006
000820*             ----------------------------------------------------00082006
000830*             NEW VALUES SU006-RFID-QC-AUDIT-IND AND              00083006
000840*                        SU006-RFID-QC-AUD-CMB-IND HAVE BEEN      00084006
000850*             INTRODUCED TO BE USED AS PASSING WHAT TYPE OF AUDIT 00085006
000860*             IS BEING DONE WHERE QC, RFID OR COMBO. THIS IS USED 00086006
000870*             WHEN EXECUTING SUKRF534 AUDIT DEF PROMPT PGM.       00087006
000880*             ----------------------------------------------------00088006
000890*             WITHIN 6010-CALL-RFID-DETERMINATION THERE IS NEW    00089006
000900*             LOGIC SU093-IR-CHK-IN-YES IS SET AND THEN SUKUT149  00090006
000910*             IS CALLED TO SEE IF THE IR FACILITY IS TAGGING.     00091006
000920*             IF IR TAGGING THEN THE DIRECTIVE IS SET TO NO AND   00092006
000930*             THE PRINT OF RFID ON LABELS IS SET TO NO. THIS IS   00093006
000940*             SET WITHIN 6020- AFTER CHECKING THE SWITCHES COMING 00094006
000950*             BACK FROM THE SUKUT149 MODULE.                      00095006
000960*             ----------------------------------------------------00096006
000970*             MORE DESCRIPTION WAS ADDED TO SOME OF THE ABEND     00097006
000980*             CSSL FOR MORE CLEARER UNDERSTANDING OF WHY ABEND    00098006
000990*             OCCURED.                                            00099006
001000*                                                                 00100006
001010*             ALL CHANGES ARE TAGGED WITH 'CLP 10/24/13'          00101006
001020*             ----------------------------------------------------00102006
001030* 04/14/14    CHERI PARMLEY  CHG0079586     TKID: TKMAF76        *00103006
001040*             ADD LOGIC FOR IR CARTON CHECKING COMING BACK FROM   00104006
001050*             THE RFID MODULE IN 6020-.                           00105006
001060*             ADDED 5003- BEFORE THE 6000A- DONE FOR IR TO        00106006
001070*             DETERMINE THE CONVEYOR SWITCH. USE THIS WHEN        00107006
001080*             CHECKING THE DIRECTIVE IN 6000A-. ADDED CHECK OF    00108006
001090*             WHAT TYPE OF CONVEYOR BEFORE CREATING A DIRECTIVE   00109006
001100*             WHEN IR CARTON.                                     00110006
001110*                                                                 00111006
001120*             ALL CHANGES ARE TAGGED WITH 'CLP 04/14/14'          00112006
001130*             ----------------------------------------------------00113006
001140* 09/25/14    CHERI PARMLEY  CHG0094517     TKID: TKMAF76        *00114006
001150*             CHANGED PO# FROM 7 DIGITS TO 8 DIGITS               00115006
001160*                                                                 00116006
001170*             ALL CHANGES ARE TAGGED WITH 'CLP 09/25/2014'        00117006
001180*             ----------------------------------------------------00118006
001190* 07/06/15    CHERI PARMLEY  CHG0120422     TKID: TKMAF76        *00119014
001200*             CHANGES INCLUDE USING BRAND INSTEAD OF MDSE_PGM_DESC00120008
001210*             NEW COLUMN ADDED LBL_MSG_TXT IS NOW BEING USED      00121008
001220*             IT IS A COMBINATION OF BUSINESS AREA DESC AND BRAND 00122008
001230*             DESC ITS ON THE TLBPTDA AND TLBVRDA TABLES          00123008
001240*             ALL CHANGES ARE TAGGED WITH 'CLP 07/06/2015'        00124008
001250*             ---------------------------------------------------*00125068
001260* 07/10/17    BARB SCHULTZ   CHG0176459     TKID: TKMA555        *00126070
001270*             THESE CHANGES ARE FOR THE RFID TAG YOUR STORE      *00127068
001280*             (SHORT TERM SOLUTION) PROJECT. ALL CHANGES ARE     *00128068
001290*             TAGGED WITH 'BARB'.                                *00129068
001300*             ---------------------------------------------------*00130075
001310* 09/26/17    GERMAN BANDA   CHG0178877                          *00131075
001320*             CHANGED 6020- PARAGRAPH TO ALSO CHECK IF           *00132075
001330*             SU093-LABEL-PRINT-IND = SPACES BEFORE SETTING      *00133075
001340*             PS-DIRECTIVE-NO TO TRUE.                           *00134075
263968*---------------------------------------------------------------* 00135182
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00135282
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00135382
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00135482
001350******************************************************************00135583
001360                                                                  00136019
001370                                                                  00137019
001380******************************************************************00138019
001390 ENVIRONMENT DIVISION.                                            00139019
001400******************************************************************00140019
001410                                                                  00141019
001420******************************************************************00142019
001430 DATA DIVISION.                                                   00143019
001440******************************************************************00144019
001450                                                                  00145019
001460******************************************************************00146019
001470 WORKING-STORAGE SECTION.                                         00147019
001480******************************************************************00148019
001490*                                                                 00149019
001500*----------------------------------------------------------------*00150019
001510*  DB2 KEYS                                                      *00151019
001520*----------------------------------------------------------------*00152019
001530 01  DK-DB2-KEYS.                                                 00153019
001540     05  DK-CTN                          PIC  S9(18)V COMP-3.     00154019
001550     05  DK-CURR-OPER-UNT-ID             PIC  S9(04)  COMP.       00155019
001560     05  DK-DEST-OPER-UNT-ID             PIC  S9(04)  COMP.       00156006
001570     05  DK-OPER-UNT-ID                  PIC  S9(04)  COMP.       00157006
001580     05  DK-FCLTY-ID                     PIC  S9(04)  COMP.       00158006
001590     05  DK-MANIFEST                     PIC  S9(09)  COMP.       00159006
001600     05  DK-BATCH-NUMBER                 PIC  S9(04)  COMP.       00160006
001610     05  DK-PO                           PIC  S9(09)  COMP.       00161006
001620     05  DK-STORE                        PIC  S9(04)  COMP.       00162006
001630*    05  DK-REC-SEQ-NBR                  PIC  S9(03)  COMP.       00163006
001640     05  DK-REC-SEQ-NBR                  PIC  S9(09)  COMP.       00164006
001650     05  DK-PO-LNE-NBR                   PIC  S9(09)  COMP.       00165006
001660     05  DK-PREPK-ID                     PIC  S9(04)  COMP.       00166006
001670     05  DK-OUTER-QTY                    PIC  S9(04)  COMP.       00167006
001680     05  DK-BARCODE-NBR                  PIC  X(22).              00168006
001690     05  DK-CART-LBL-TYP-CDE             PIC  X(01).              00169006
001700     05  DK-ERR-MSG-CDE                  PIC  X(01).              00170006
001710                                                                  00171006
001720*----------------------------------------------------------------*00172076
001730* LAYOUT FOR 20 & 22 DIGIT BARCODES                               00173076
001740*----------------------------------------------------------------*00174076
002700     COPY PCWS160.                                                00270006
002710                                                                  00271076
002800*----------------------------------------------------------------*00280006
002810* HELP SCREEN COMMAREA                                            00281006
002811*----------------------------------------------------------------*00281176
002820     COPY PCWS192.                                                00282006
002821                                                                  00282176
002830*----------------------------------------------------------------*00283006
002840* HELP SCREEN WORK AREA                                           00284006
002841*----------------------------------------------------------------*00284176
002850     COPY PCWS188.                                                00285006
002851                                                                  00285176
002860*---------------------------------------------------------------* 00286006
002870* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 00287006
002880*---------------------------------------------------------------* 00288006
002890     COPY XLWS001.                                                00289006
002900                                                                  00290006
002910/                                                                 00291006
002920*---------------------------------------------------------------* 00292006
002930*  RECORD LAYOUTS FOR THE TROUBLE CREATION ROUTINE                00293006
002940*---------------------------------------------------------------* 00294006
002950     COPY TMWS500.                                                00295006
002960                                                                  00296006
002970*---------------------------------------------------------------* 00297006
002980*  RECORD LAYOUTS FOR THE FREE ASTRAY HANDLER MODULE              00298006
002990*---------------------------------------------------------------* 00299006
003000     COPY SUWS044.                                                00300006
003010                                                                  00301006
003020*---------------------------------------------------------------* 00302006
003030*  RECORD LAYOUTS FOR THE AUTO VERF PARM CHECK MODULE             00303006
003040*---------------------------------------------------------------* 00304006
003050     COPY RCWS040.                                                00305006
003060                                                                  00306006
003070* JAK WR41309 - ADD COPYBOOK FOR CALL TO SUKUT149                 00307006
003080*---------------------------------------------------------------* 00308006
003090*  RECORD LAYOUTS FOR RFID DETERMINATION MODULE                   00309006
003100*---------------------------------------------------------------* 00310006
003110     COPY SUWS093.                                                00311006
003120* JAK WR41309 - END                                               00312006
003130                                                                  00313006
003140*---------------------------------------------------------------* 00314006
003150*  RECORD LAYOUTS FOR THE AUTO CONFIRMATION MODULE                00315006
003160*---------------------------------------------------------------* 00316006
003170     COPY RCWS041.                                                00317006
003180                                                                  00318006
003190*---------------------------------------------------------------* 00319006
003200*  COMMUNICATION AREA FOR THE ASSIGNMENT DATA                     00320006
003210*  USED IN THE DLX LABOR SYSTEM (DLKUP001)                        00321006
003220*---------------------------------------------------------------* 00322006
003230     COPY DLWS001.                                                00323006
003240                                                                  00324006
003250*---------------------------------------------------------------* 00325006
003260*  COMMUNICATION AREA FOR THE ASSIGNMENT DATA                     00326006
003270*  USED IN THE DLX LABOR SYSTEM (DLKUT001)                        00327006
003280*---------------------------------------------------------------* 00328006
003290     COPY DLWS003.                                                00329006
003300                                                                  00330006
003310*---------------------------------------------------------------* 00331006
003320*  COMMUNICATION AREA PASSED TO WRITE INFORMATION                 00332006
003330*  TO THE EAI EXPORT TABLES (XLKUP033)                            00333006
003340*---------------------------------------------------------------* 00334006
003350     COPY XLWS072.                                                00335006
003360                                                                  00336006
003370*---------------------------------------------------------------* 00337006
003380*  LAYOUT WHICH DEFINES THE DATA ELEMENTS                         00338006
003390*  FOUND WITHIN THE DTL_TXT                                       00339006
003400*---------------------------------------------------------------* 00340006
003410     COPY SUWS050.                                                00341006
003420                                                                  00342006
003430*----------------------------------------------------------------*00343006
003440* CT 11/06/08 BEGIN                                              *00344006
003450*    COPYBOOK USED BY TO SEND DIRECTIVE TO SUKUT129              *00345006
003460*----------------------------------------------------------------*00346006
003470                                                                  00347006
003480     COPY SUWS090.                                                00348006
003490                                                                  00349006
003500* CT 11/06/08 END                                                *00350006
003510* * *  COMMAREA TO PCKRF901                                       00351006
003520 01  PC056-COMMAREA.                                              00352006
003530     COPY PCWS056.                                                00353006
003540                                                                  00354006
003550* EA 07/02/2010                                                  *00355006
003560*----------------------------------------------------------------*00356006
003570*    COPYBOOK FOR UNIT WORK MODULE - PCKUT790                    *00357006
003580*----------------------------------------------------------------*00358006
003590                                                                  00359006
003600     COPY PCWS260.                                                00360006
003610                                                                  00361006
003620* EA 07/02/2010                                                  *00362006
003630*----------------------------------------------------------------*00363006
003640*  PROGRAM CONSTANTS                                             *00364006
003650*----------------------------------------------------------------*00365006
003660 01  PC-PROGRAM-CONSTANTS.                                        00366006
003670     05  PC-TRANID                       PIC  X(04)  VALUE 'S502'.00367006
003680     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00368006
003690                                                     COMP SYNC.   00369006
003700     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00370006
003710                                                     COMP SYNC.   00371006
003730     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00373006
003740                                                     COMP SYNC.   00374006
003750     05  PC-MF-FORM-LENGTH               PIC S9(04)  VALUE +207   00375006
003760                                                     COMP SYNC.   00376006
003830     05  PC-MF-DATA-LENGTH               PIC S9(04)  VALUE +30    00383006
003840                                                     COMP SYNC.   00384006
003850     05  PC-FI-DATA-LENGTH               PIC S9(04)  VALUE +200   00385006
003860                                                     COMP SYNC.   00386006
003870     05  PC-FI-FORM-LENGTH               PIC S9(04)  VALUE +244   00387006
003880                                                     COMP SYNC.   00388006
003890     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00389006
003900                                                     COMP SYNC.   00390006
003910     05  PC-RECEIVE-LENGTH-DISPLAY       PIC 9(8)    VALUE ZERO.  00391006
004080     05  PC-MENO-FALLS                   PIC S9(04)  VALUE +85    00408006
004090                                                     COMP SYNC.   00409006
004100     05  PC-FINLDAY                      PIC S9(04)  VALUE +810   00410006
004110                                                     COMP SYNC.   00411006
004120     05  PC-RECV                         PIC  X(04)  VALUE 'RECV'.00412006
004130     05  PC-RFDC                         PIC  X(04)  VALUE 'RFDC'.00413006
004140     05  PC-RFDF                         PIC  X(04)  VALUE 'RFDF'.00414006
004150     05  PC-PBSA                         PIC  X(04)  VALUE 'PBSA'.00415006
004160     05  PC-PBSB                         PIC  X(04)  VALUE 'PBSB'.00416006
004170     05  PC-PBSC                         PIC  X(04)  VALUE 'PBSC'.00417006
004180     05  PC-PBSD                         PIC  X(04)  VALUE 'PBSD'.00418006
004190     05  PC-PBSE                         PIC  X(04)  VALUE 'PBSE'.00419006
004200     05  PC-FLAT                         PIC  X(04)  VALUE 'FLAT'.00420006
004210     05  PC-N                            PIC  X(01)  VALUE 'N'.   00421006
004220     05  PC-PO                           PIC  X(02)  VALUE 'PO'.  00422006
004230     05  PC-RCV                          PIC  X(03)  VALUE 'RCV'. 00423006
004240     05  PC-0                            PIC  X(01)  VALUE '0'.   00424006
004250     05  PC-4                            PIC  X(01)  VALUE '4'.   00425006
004260     05  PC-5                            PIC  X(01)  VALUE '5'.   00426006
004270     05  PC-00                           PIC  9(02)  VALUE 00.    00427006
004280     05  PC-COLON                        PIC  X(01)  VALUE ':'.   00428006
004290     05  PC-A                            PIC  X(01)  VALUE 'A'.   00429006
004300     05  PC-B                            PIC  X(01)  VALUE 'B'.   00430006
004310     05  PC-C                            PIC  X(01)  VALUE 'C'.   00431006
004320     05  PC-E                            PIC  X(01)  VALUE 'E'.   00432006
004330     05  PC-P                            PIC  X(01)  VALUE 'P'.   00433006
004340     05  PC-R                            PIC  X(01)  VALUE 'R'.   00434006
004350     05  PC-S                            PIC  X(01)  VALUE 'S'.   00435006
004360     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   00436006
004370     05  PC-DS                           PIC  X(02)  VALUE 'DS'.  00437006
004380     05  PC-PS                           PIC  X(02)  VALUE 'PS'.  00438006
004390     05  PC-PP                           PIC  X(02)  VALUE 'PP'.  00439006
004400     05  PC-BC                           PIC  X(02)  VALUE 'BC'.  00440006
004410*CLP 10/24/13 - BEGIN                                             00441006
004420     05  PC-RF                           PIC  X(02)  VALUE 'RF'.  00442006
004430*CLP 10/24/13 -   END                                             00443006
004440     05  PC-FA                           PIC  X(02)  VALUE 'FA'.  00444006
004450     05  PC-ASN                          PIC  X(03)  VALUE 'ASN'. 00445006
004460     05  PC-0-9                          PIC  9(01)  VALUE 0.     00446006
004470     05  PC-ACTIVE                       PIC  X(01)  VALUE 'A'.   00447006
004480     05  PC-M                            PIC  X(01)  VALUE 'M'.   00448006
004490     05  PC-I                            PIC  X(01)  VALUE 'I'.   00449006
004500     05  PC-SPACE                        PIC  X(01)  VALUE ' '.   00450006
004510     05  PC-18                           PIC S9(04)  VALUE 18     00451006
004520                                                     COMP SYNC.   00452006
004530     05  PC-19                           PIC S9(04)  VALUE 19     00453006
004540                                                     COMP SYNC.   00454006
004550     05  PC-20                           PIC S9(04)  VALUE 20     00455006
004560                                                     COMP SYNC.   00456006
004570     05  PC-NEG-9                        PIC S9(09)  VALUE        00457006
004580                                                      -999999999. 00458006
004590     05  PC-FKEYS                        PIC X(19)   VALUE        00459006
004600                                         'F4-PRT SML F5-AUDIT'.   00460006
004610     05  PC-F5-AUDIT-FKEY                PIC X(19)   VALUE        00461006
004620                                         'F5-AUDIT           '.   00462006
004630     05  PC-FKEY2                        PIC X(19)   VALUE        00463006
004640                                         'F9-CTNAUST F6-POLOC'.   00464006
004650     05  PC-MULTI-LINE                   PIC  X(04)  VALUE 'MULT'.00465006
004660     05  PC-NOLNE-LINE                   PIC  X(04)  VALUE 'NOLN'.00466006
004670     05  PC-MULT-SKU                     PIC  X(11)  VALUE        00467006
004680                                          '**MULT SKU*'.          00468006
004690     05  PC-NO-SKU-NUM                   PIC  X(11)  VALUE        00469006
004700                                          '*NO SKU NM*'.          00470006
004710     05  PC-ONE                          PIC  9(04)  VALUE 1      00471006
004720                                                     COMP.        00472006
004730     05  PC-DEFAULT-TIME                 PIC  X(26)  VALUE        00473006
004740                                 '9999-09-09-09.09.09.999999'.    00474006
004750**PACK BY STORE TROUBLE CODES                                     00475006
004760     05  PC-QTY-ERR-TRBL-CODE-350       PIC S9(04) COMP VALUE 350.00476006
004770     05  PC-UPC-NOT-ON-PO-TRBL-351      PIC S9(04) COMP VALUE 351.00477006
004780     05  PC-LNE-ZERO-TRBL-CODE-352      PIC S9(04) COMP VALUE 352.00478006
004790     05  PC-UPC-CRTN-TRBL-CODE-353      PIC S9(04) COMP VALUE 353.00479006
004800     05  PC-UPC-PKSL-TRBL-CODE-354      PIC S9(04) COMP VALUE 354.00480006
004810*----------------------------------------------------------------*00481006
004820* PROGRAM NAMES                                                  *00482006
004830*----------------------------------------------------------------*00483006
004840     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)  VALUE 'SUKRF502'. 00484006
004850     05  PC-SU-TRAILER-PGM          PIC  X(08)  VALUE 'SUKRF501'. 00485006
004860     05  PC-SHIPPING-UNIT-PGM       PIC  X(08)  VALUE 'SUKRF502'. 00486006
004870     05  PC-TRAILER-STOP-PGM        PIC  X(08)  VALUE 'SUKRF503'. 00487006
004880     05  PC-SU-DUPLICATE-PGM        PIC  X(08)  VALUE 'SUKRF504'. 00488006
004890     05  PC-SU-NOT-FOUND-PGM        PIC  X(08)  VALUE 'SUKRF505'. 00489006
004900     05  PC-SU-ADD-PGM              PIC  X(08)  VALUE 'SUKRF506'. 00490006
004910     05  PC-SU-WRONG-FCLTY-PGM      PIC  X(08)  VALUE 'SUKRF507'. 00491006
004920     05  PC-SU-LBL-PRT-PGM          PIC  X(08)  VALUE 'SUKRF527'. 00492006
004930     05  PC-SU-LBL-NEED-PGM         PIC  X(08)  VALUE 'SUKRF528'. 00493006
004940     05  PC-SU-MESSAGE-PGM          PIC  X(08)  VALUE 'SUKRF530'. 00494006
004950     05  PC-SU-CARTON-AUDIT-PGM     PIC  X(08)  VALUE 'SUKRF509'. 00495006
004960     05  PC-SU-AUDIT-STATUS-PGM     PIC  X(08)  VALUE 'SUKRF536'. 00496006
004970     05  PC-SU-AUDIT-DEF-PRMPT-PGM  PIC  X(08)  VALUE 'SUKRF534'. 00497006
004980     05  PC-SU-CARTON-AUDIT-STATUS  PIC  X(08)  VALUE 'SUKRF538'. 00498006
004990     05  PC-TROUBLE-WTR             PIC  X(08)  VALUE 'TMKCS521'. 00499006
005000     05  PC-FA-HANDLER-PGM          PIC  X(08)  VALUE 'SUKUT705'. 00500006
005010     05  PC-AUTOVE-DETERMIN-PGM     PIC  X(08)  VALUE 'RCKUT127'. 00501006
005020     05  PC-LINE-LOCATION-PGM       PIC  X(08)  VALUE 'PCKRF901'. 00502006
005030     05  PC-TROUBLE-LENGTH          PIC S9(04)  COMP VALUE +600.  00503006
005040     05  PC-SU-LBL-PRT-TRANS        PIC  X(08)  VALUE 'S527'.     00504006
005050     05  PC-SU-CRTN-VERIF-TRIGGER   PIC  X(08)  VALUE 'S764'.     00505006
005060     05  PC-CONTAINER-UPD-TRAN      PIC  X(04)  VALUE 'I210'.     00506006
005070                                                                  00507006
005080                                                                  00508006
005090*----------------------------------------------------------------*00509006
005100* ERROR MESSAGES                                                 *00510006
005110*----------------------------------------------------------------*00511006
005120     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19) VALUE               00512006
005130                                           'DB2 ACCESS ERROR   '. 00513006
005140     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00514006
005150                                           'UNRECOGNIZED PF KEY'. 00515006
005160     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00516006
005170                                           'ENTER THROUGH MENU '. 00517006
005180     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00518006
005190                                           'TRANS NOT AVAILABLE'. 00519006
005200     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               00520006
005210                                           'PLEASE ENTER FIELD '. 00521006
005220     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00522006
005230                                           'MUST BE NUMERIC    '. 00523006
005240     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               00524006
005250                                           'MUST BE > ZERO     '. 00525006
005260     05  PC-MUST-BE-PBS-MSG         PIC X(19) VALUE               00526006
005270                                           'RCVR NOT PK-BY-STR '. 00527006
005280     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               00528006
005290                                           'FIRST DIGIT NOT 0  '. 00529006
005300     05  PC-TOO-MANY-DIGITS         PIC X(19) VALUE               00530006
005310                                           'TOO MANY DIGITS    '. 00531006
005320     05  PC-STR-NOT-XCRIBED-MSG     PIC X(19) VALUE               00532006
005330                                           'STR NOT TRANSCRIBED'. 00533006
005340     05  PC-CICS-ERR-MSG            PIC X(19) VALUE               00534006
005350                                           'CICS ACCESS ERROR  '. 00535006
005360     05  PC-WRONG-FACILITY          PIC X(19) VALUE               00536006
005370                                           'WRG FCLTY - F2 CONF'. 00537006
005380     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               00538006
005390                                           'MORE DIGITS REQUIRD'. 00539006
005400     05  PC-INVALID-CHECK-DIGIT     PIC X(19) VALUE               00540006
005410                                           'INVALID CHECK DIGIT'. 00541006
005420     05  PC-INVALID-BARCODE         PIC X(19) VALUE               00542006
005430                                           'INVALID BARCODE    '. 00543006
005440     05  PC-PACK-BY-STORE-ERROR     PIC X(19) VALUE               00544006
005450                                           'PACK BY STORE ERROR'. 00545006
005460     05  PC-VERFD-LINES-IN-CRTN     PIC X(19) VALUE               00546006
005470                                           'CRTN HAS VRFD LINES'. 00547006
005480                                                                  00548006
005490*----------------------------------------------------------------*00549006
005500* LABEL MESSAGES                                                 *00550006
005510*----------------------------------------------------------------*00551006
005520     05  PC-DEFAULT-LABEL-MSG       PIC X(35) VALUE               00552006
005530                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 00553006
005540     05  PC-NOT-ATTACHED-RCVR-MSG   PIC X(35) VALUE               00554006
005550                           'CARTON NOT ATTACHED TO A RECEIVER  '. 00555006
005560     05  PC-NOT-FOUND-MSG           PIC X(35) VALUE               00556006
005570                           ' *** NO ITEM INFORMATION FOUND *** '. 00557006
005580     05  PC-FREE-ASTRAY-MSG         PIC X(35) VALUE               00558006
005590                           '* * * * *   FREE ASTRAY   * * * * *'. 00559006
005600     05  PC-FREE-ASTRY-NO-RCVR-MSG  PIC X(35) VALUE               00560006
005610                           'CARTON NOT ATTACHED TO A RECEIVER  '. 00561006
005620     05  PC-FREE-ASTRY-NO-TRIP-MSG  PIC X(35) VALUE               00562006
005630                           'RECEIVER NOT ATTACHED TO SCAC-TRLR '. 00563006
005640     05  PC-DUPLICATE-SCAN-MSG      PIC X(35) VALUE               00564006
005650                           '* * * * * DUPLICATE SCAN  * * * * *'. 00565006
005660     05  PC-DETAIL-CK-NEED-MSG      PIC X(35) VALUE               00566006
005670                           '* * * * DETAIL CHECK NEEDED * * * *'. 00567006
005680     05  PC-MISDIRECT-MSG          PIC X(35) VALUE                00568006
005690                           '* * *  M I S  -  D I R E C T * * * '. 00569006
005700                                                                  00570006
005710*----------------------------------------------------------------*00571006
005720                                                                  00572006
005730*----------------------------------------------------------------*00573006
005740*  PROGRAM SWITCHES                                              *00574006
005750*----------------------------------------------------------------*00575006
005760 01  PS-PROGRAM-SWITCHES.                                         00576006
005770     05  PS-FLOWBACK-BYPASS-AUDIT-SW     PIC  X(01)  VALUE 'N'.   00577006
005780         88  PS-FLOWBACK-BYPASS-AUDIT                VALUE 'Y'.   00578006
005790         88  PS-NO-FLOWBACK-BYPASS-AUDIT             VALUE 'N'.   00579006
005800     05  PS-DUPLICATE-CARTON-SW          PIC  X(01)  VALUE 'N'.   00580006
005810         88  PS-DUPLICATE-CARTON                     VALUE 'Y'.   00581006
005820         88  PS-NO-DUPLICATE-CARTON                  VALUE 'N'.   00582006
005830     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   00583006
005840         88  PS-VALID-INPUT                          VALUE 'Y'.   00584006
005850         88  PS-INVALID-INPUT                        VALUE 'N'.   00585006
005860     05  PS-DUPLICATE-SW                 PIC  X(01)  VALUE 'N'.   00586006
005870         88  PS-DUPLICATE-FOUND                      VALUE 'Y'.   00587006
005880         88  PS-NO-DUPLICATE-FOUND                   VALUE 'N'.   00588006
005890     05  PS-WRONG-FCLTY-SW               PIC  X(01)  VALUE 'N'.   00589006
005900         88  PS-WRONG-FCLTY                          VALUE 'Y'.   00590006
005910     05  PS-NOT-FOUND-SW                 PIC  X(01)  VALUE 'Y'.   00591006
005920         88  PS-FOUND                                VALUE 'Y'.   00592006
005930         88  PS-NOT-FOUND                            VALUE 'N'.   00593006
005940     05  PS-SULBXF-RECORD-FOUND-SW       PIC  X(01)  VALUE 'Y'.   00594006
005950         88  PS-SULBXF-RECORD-FOUND                  VALUE 'Y'.   00595006
005960         88  PS-SULBXF-RECORD-NOT-FOUND              VALUE 'N'.   00596006
005970     05  PS-ACTIVE-XREF-ROW-FOUND-SW     PIC  X(01)  VALUE 'Y'.   00597006
005980         88  PS-ACTIVE-XREF-ROW-FOUND                VALUE 'Y'.   00598006
005990         88  PS-ACTIVE-XREF-ROW-NOT-FOUND            VALUE 'N'.   00599006
006000     05  PS-XREF-PBS-FOUND-SW            PIC  X(01)  VALUE 'N'.   00600006
006010         88  PS-XREF-PBS-FOUND                       VALUE 'Y'.   00601006
006020         88  PS-XREF-PBS-NOT-FOUND                   VALUE 'N'.   00602006
006030     05  PS-CHECK-DIGIT-IND              PIC  X(01)  VALUE 'N'.   00603006
006040         88  PS-VALID-CHECK-DIGIT                    VALUE 'Y'.   00604006
006050         88  PS-INVALID-CHECK-DIGIT                  VALUE 'N'.   00605006
006060     05  PS-SCANNED-DATA-IND             PIC  X(01)  VALUE 'Y'.   00606006
006070         88  PS-NOT-SCANNED-DATA                     VALUE 'N'.   00607006
006080         88  PS-SCANNED-DATA                         VALUE 'Y'.   00608006
006090     05  PS-OPER-IS-DC-STORE-SW          PIC  X(01)  VALUE ' '.   00609006
006100         88  PS-OPER-IS-DC                           VALUE 'D'.   00610006
006110         88  PS-OPER-IS-STORE                        VALUE 'S'.   00611006
006120         88  PS-OPER-IS-ECOMM-STORE                  VALUE 'E'.   00612006
006130     05  PS-OPER-IS-ECOMM-DC-SW          PIC  X(01)  VALUE 'N'.   00613006
006140         88  PS-OPER-NOT-ECOMM-DC                    VALUE 'N'.   00614006
006150         88  PS-OPER-IS-ECOMM-DC                     VALUE 'Y'.   00615006
006160     05  PS-OPER-IS-ECOMM-DS-SW          PIC  X(01)  VALUE 'N'.   00616006
006170         88  PS-OPER-NOT-ECOMM-DS                    VALUE 'N'.   00617006
006180         88  PS-OPER-IS-ECOMM-DS                     VALUE 'Y'.   00618006
006190     05  PS-NEW-STORE-FIXTURE-IND        PIC X(1)    VALUE 'N'.   00619006
006200         88  PS-NO-NEW-STORE-FIXTURE                 VALUE 'N'.   00620006
006210         88  PS-NEW-STORE-FIXTURE                    VALUE 'Y'.   00621006
006220     05  PS-REPRINT-FORM-SW              PIC  X(01)  VALUE 'N'.   00622006
006230         88  PS-REPRINT-FORM                         VALUE 'Y'.   00623006
006240         88  PS-NOT-REPRINT-FORM                     VALUE 'N'.   00624006
006250     05  PS-MSG-1-SW                     PIC  X(01)  VALUE 'N'.   00625006
006260         88  PS-NO-MSG-1                             VALUE 'N'.   00626006
006270         88  PS-YES-MSG-1                            VALUE 'Y'.   00627006
006280     05  PS-MSG-2-SW                     PIC  X(01)  VALUE 'N'.   00628006
006290         88  PS-NO-MSG-2                             VALUE 'N'.   00629006
006300         88  PS-YES-MSG-2                            VALUE 'Y'.   00630006
006310     05  PS-CARTON-EXISTS-SW             PIC  X(01)  VALUE 'Y'.   00631006
006320         88  PS-CARTON-EXISTS                        VALUE 'Y'.   00632006
006330         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   00633006
006340     05  PS-EO-UNITS-CSR-SW              PIC  X(01)  VALUE 'N'.   00634006
006350         88  PS-EO-UNITS-CSR                         VALUE 'Y'.   00635006
006360         88  PS-NOT-EO-UNITS-CSR                     VALUE 'N'.   00636006
006370     05  PS-EO-PREPK-CSR-SW              PIC  X(01)  VALUE 'N'.   00637006
006380         88  PS-EO-PREPK-CSR                         VALUE 'Y'.   00638006
006390         88  PS-NOT-EO-PREPK-CSR                     VALUE 'N'.   00639006
006400     05  PS-END-OF-VRTL-LBL-CSR-SW       PIC  X(01)  VALUE 'N'.   00640006
006410         88  PS-END-OF-VRTL-LBL-CSR                  VALUE 'Y'.   00641006
006420         88  PS-NOT-END-OF-VRTL-LBL-CSR              VALUE 'N'.   00642006
006430     05  PS-END-OF-REPRINT-CSR-SW        PIC  X(01)  VALUE 'N'.   00643006
006440         88  PS-END-OF-REPRINT-CSR                   VALUE 'Y'.   00644006
006450         88  PS-NOT-END-OF-REPRINT-CSR               VALUE 'N'.   00645006
006460     05  PS-END-OF-UPC-UNLOAD-CSR-SW     PIC  X(01)  VALUE 'N'.   00646006
006470         88  PS-END-OF-UPC-UNLOAD-CSR                VALUE 'Y'.   00647006
006480         88  PS-NOT-END-OF-UPC-UNLOAD-CSR            VALUE 'N'.   00648006
006490     05  PS-LABEL-DATA-FOUND-SW          PIC  X(01)  VALUE 'N'.   00649006
006500         88  PS-LABEL-DATA-FOUND                     VALUE 'Y'.   00650006
006510         88  PS-LABEL-DATA-NOT-FOUND                 VALUE 'N'.   00651006
006520     05  PS-DISPLAY-SUKRF530-SW          PIC  X(01)  VALUE 'N'.   00652006
006530         88  PS-DISPLAY-SUKRF530                     VALUE 'Y'.   00653006
006540         88  PS-DONT-DISPLAY-SUKRF530                VALUE 'N'.   00654006
006550     05  PS-SUCCESSFUL-UPDATE-SW         PIC  X(01)  VALUE 'N'.   00655006
006560         88  PS-SUCCESSFUL-UPDATE                    VALUE 'Y'.   00656006
006570         88  PS-NOT-SUCCESSFUL-UPDATE                VALUE 'N'.   00657006
006580     05  PS-DONE-SW                      PIC  X(01)  VALUE 'N'.   00658006
006590         88  PS-DONE                                 VALUE 'Y'.   00659006
006600         88  PS-NOT-DONE                             VALUE 'N'.   00660006
006610     05  PS-FOUND-ON-CURSOR-SW           PIC  X(01)  VALUE 'Y'.   00661006
006620         88  PS-FOUND-ON-CURSOR                      VALUE 'Y'.   00662006
006630         88  PS-NOT-FOUND-ON-CURSOR                  VALUE 'N'.   00663006
006640     05  PS-REPRINT-DUP-SW               PIC  X(01)  VALUE 'N'.   00664006
006650         88  PS-REPRINT-DUP                          VALUE 'Y'.   00665006
006660         88  PS-NOT-REPRINT-DUP                      VALUE 'N'.   00666006
006670     05  PS-TRNGLE-TRANS-SW              PIC  X(01)  VALUE 'N'.   00667006
006680         88  PS-TRNGLE-TRANS                         VALUE 'Y'.   00668006
006690         88  PS-NOT-TRNGLE-TRANS                     VALUE 'N'.   00669006
006700     05  PS-FIRST-PO-LINE-SW             PIC  X(01)  VALUE 'Y'.   00670006
006710         88  PS-FIRST-PO-LINE-FOR-CTN                VALUE 'Y'.   00671006
006720         88  PS-NOT-FIRST-PO-LINE-FOR-CTN            VALUE 'N'.   00672006
006730     05  PS-PRINT-AUDIT-LABEL-SW         PIC  X(01)  VALUE 'N'.   00673006
006740         88  PS-PRINT-AUDIT-LABEL                    VALUE 'Y'.   00674006
006750         88  PS-DONT-PRINT-AUDIT-LABEL               VALUE 'N'.   00675006
006760     05  PS-FIRST-ODD-UNTS-FETCH-SW      PIC  X(01)  VALUE 'Y'.   00676006
006770         88  PS-FIRST-ODD-UNTS-FETCH                 VALUE 'Y'.   00677006
006780         88  PS-NOT-FIRST-ODD-UNTS-FETCH             VALUE 'N'.   00678006
006790     05  PS-FOUND-ON-ODD-UNTS-CSR-SW     PIC  X(01)  VALUE 'Y'.   00679006
006800         88  PS-FOUND-ON-ODD-UNTS-CSR                VALUE 'Y'.   00680006
006810         88  PS-EO-ODD-UNTS-CSR                      VALUE 'N'.   00681006
006820     05  PS-ODD-UNT-CRTN-FOUND-SW        PIC  X(01)  VALUE 'N'.   00682006
006830         88  PS-ODD-UNT-CRTN-FOUND                   VALUE 'Y'.   00683006
006840         88  PS-NOT-ODD-UNT-CRTN-FOUND               VALUE 'N'.   00684006
006850     05  PS-FIRST-PREPK-SW               PIC  X(01)  VALUE 'Y'.   00685006
006860         88  PS-FIRST-PREPK                          VALUE 'Y'.   00686006
006870         88  PS-NOT-FIRST-PREPK                      VALUE 'N'.   00687006
006880     05  PS-HANG-FOLD-CSR-SW             PIC  X(01)  VALUE 'N'.   00688006
006890         88  PS-EO-HANG-FOLD-CSR                     VALUE 'Y'.   00689006
006900         88  PS-NOT-EO-HANG-FOLD-CSR                 VALUE 'N'.   00690006
006910     05  PS-EO-WEIGHTS-MSRS-CSR-SW       PIC  X(01)  VALUE 'N'.   00691006
006920         88  PS-EO-WEIGHTS-MSRS-CSR                  VALUE 'Y'.   00692006
006930         88  PS-NOT-EO-WEIGHTS-MSRS-CSR              VALUE 'N'.   00693006
006940     05  PS-HANG-FOLD-MIXED-SW           PIC  X(01)  VALUE 'N'.   00694006
006950         88  PS-HANG-FOLD-MIXED                      VALUE 'Y'.   00695006
006960         88  PS-NOT-HANG-FOLD-MIXED                  VALUE 'N'.   00696006
006970     05  PS-FIRST-UPC-CALL-SW            PIC  X(01)  VALUE 'N'.   00697006
006980         88  PS-FIRST-UPC-CALL                       VALUE 'Y'.   00698006
006990         88  PS-NOT-FIRST-UPC-CALL                   VALUE 'N'.   00699006
007000     05  PS-CARTON-STATUS-SW             PIC  X(01)  VALUE 'N'.   00700006
007010         88  PS-INACTV-CRTN-FND                      VALUE 'Y'.   00701006
007020         88  PS-ACTV-CRTN-FND                        VALUE 'N'.   00702006
007030     05  PS-INVALID-CREATE-SOURCE-SW     PIC  X(01)  VALUE 'N'.   00703006
007040         88  PS-INVALID-CRE-SOURCE                   VALUE 'Y'.   00704006
007050         88  PS-NOT-INVALID-CRE-SOURCE               VALUE 'N'.   00705006
007060     05  PS-BLND-RECV-SIMPL-LOC-SW       PIC  X(01)  VALUE 'N'.   00706006
007070         88  PS-BLND-RECV-SIMPL-LOC-FND              VALUE 'Y'.   00707006
007080         88  PS-BLND-RECV-SIMPL-LOC-NOT-FND          VALUE 'N'.   00708006
007090     05  PS-MISDIRECT-PACK-BY-STORE-SW   PIC  X(01)  VALUE 'N'.   00709006
007100         88  PS-MISDIRECT-PACK-BY-STORE              VALUE 'Y'.   00710006
007110         88  PS-MISDIRECT-PACK-BY-STORE-NO           VALUE 'N'.   00711006
007120     05  PS-INACTV-PBS-CARTON-FOUND-SW   PIC  X(01)  VALUE 'N'.   00712006
007130         88  PS-INACTV-PBS-CARTON-YES                VALUE 'Y'.   00713006
007140         88  PS-INACTV-PBS-CARTON-NO                 VALUE 'N'.   00714006
007150     05  PS-CASEPACK-LBL-PRINT-SW        PIC  X(01)  VALUE 'Y'.   00715006
007160         88  PS-CASEPK-FOUND                         VALUE 'Y'.   00716006
007170         88  PS-NO-CASEPK-FND                        VALUE 'N'.   00717006
007180     05  PS-PBS-TROUBLE-FOUND-SW         PIC  X(01)  VALUE 'N'.   00718006
007190         88  PS-TROUBLE-FOUND                        VALUE 'Y'.   00719006
007200         88  PS-NO-TROUBLE-FOUND                     VALUE 'N'.   00720006
007210     05  PS-PBS-RTV-ALLOC-SW             PIC  X(02)  VALUE '  '.  00721006
007220         88  PS-PBS-RTV-ALLOC                        VALUE 'RA'.  00722006
007230         88  PS-PBS-RTV-NO-ALLOC                     VALUE 'RN'.  00723006
007240     05  PS-AUDIT-PROMPT-CHECK-SW        PIC  X(01)  VALUE 'N'.   00724006
007250         88  PS-AUDIT-PROMPT-CHECK-YES               VALUE 'Y'.   00725006
007260         88  PS-AUDIT-PROMPT-CHECK-NO                VALUE 'N'.   00726006
007270     05  PS-INPK-AUD-INLINE-REQUIRED-SW  PIC  X(01)  VALUE 'Y'.   00727006
007280         88  PS-INPK-AUD-INLINE-YES                  VALUE 'Y'.   00728006
007290         88  PS-INPK-AUD-INLINE-NO                   VALUE 'N'.   00729006
007300     05  PS-PBS-CRTN-RCVR-MISMTCH-SW     PIC  X(01)  VALUE 'N'.   00730006
007310         88  PS-PBS-CRTN-RCVR-MISMTCH-YES            VALUE 'Y'.   00731006
007320         88  PS-PBS-CRTN-RCVR-MISMTCH-NO             VALUE 'N'.   00732006
007330     05  PS-FREE-ASTRAY-PROCESS-SW       PIC  X(01)  VALUE 'N'.   00733006
007340         88  PS-FREE-ASTRAY-PROCESS                  VALUE 'Y'.   00734006
007350         88  PS-FREE-ASTRAY-PROCESS-NO               VALUE 'N'.   00735006
007360     05  PS-SML-CREATION-SW              PIC  X(01)  VALUE 'N'.   00736006
007370         88  PS-CARTON-SML-CREATED                   VALUE 'S'.   00737006
007380         88  PS-CARTON-P2L-CREATED                   VALUE 'P'.   00738006
007390         88  PS-NO-CARTON-SML-CREATED                VALUE 'N'.   00739006
007400     05  PS-SULBXF-ROW-FOUND-SW          PIC  X(01)  VALUE 'N'.   00740006
007410         88  PS-SULBXF-ROW-FOUND                     VALUE 'Y'.   00741006
007420         88  PS-NO-SULBXF-ROW-FOUND                  VALUE 'N'.   00742006
007430     05  PS-RCVR-DATA-FOUND-SW           PIC  X(01)  VALUE 'Y'.   00743006
007440         88  PS-RCVR-DATA-FOUND-YES                  VALUE 'Y'.   00744006
007450         88  PS-RCVR-DATA-FOUND-NO                   VALUE 'N'.   00745006
007460     05  PS-UCC128-PKSLIP-ERROR-SW       PIC  X(01)  VALUE 'N'.   00746006
007470         88  PS-UCC128-PKSLIP-ERROR-YES              VALUE 'Y'.   00747006
007480         88  PS-UCC128-PKSLIP-ERROR-NO               VALUE 'N'.   00748006
007490     05  PS-FREE-ASTRAY-MSG-LBL-SW       PIC  X(01)  VALUE 'N'.   00749006
007500         88  PS-FREE-ASTRAY-MSG-LBL-YES              VALUE 'Y'.   00750006
007510         88  PS-FREE-ASTRAY-MSG-LBL-NO               VALUE 'N'.   00751006
007520     05  PS-WEIGHTS-MEAUSURES-CHECK-SW   PIC  X(01)  VALUE 'N'.   00752006
007530         88  PS-WEIGHTS-MEAUSURES-CHECK              VALUE 'Y'.   00753006
007540         88  PS-WEIGHTS-MEAUSURES-CHECK-NO           VALUE 'N'.   00754006
007550     05  PS-RECITM-VERIFIED-LINES-SW     PIC  X(01)  VALUE 'N'.   00755006
007560         88  PS-RECITM-VERIFIED-LINES-YES            VALUE 'Y'.   00756006
007570         88  PS-RECITM-VERIFIED-LINES-NO             VALUE 'N'.   00757006
007580     05  PS-ECOMM-STORE-WRONG-FCLTY-SW   PIC  X(01)  VALUE ' '.   00758006
007590         88  PS-ECOMM-STORE-NO-RCVR                  VALUE 'N'.   00759006
007600     05  PS-HANG-FOLD-IND-FOUND-SW       PIC  X(01)  VALUE 'N'.   00760006
007610         88  PS-HANG-FOLD-IND-FOUND-YES              VALUE 'Y'.   00761006
007620         88  PS-HANG-FOLD-IND-FOUND-NO               VALUE 'N'.   00762006
007630     05  PS-EAS-TAG-IND-FOUND-SW         PIC  X(01)  VALUE 'N'.   00763006
007640         88  PS-EAS-TAG-IND-FOUND-YES                VALUE 'Y'.   00764006
007650         88  PS-EAS-TAG-IND-FOUND-NO                 VALUE 'N'.   00765006
007660*CLP 07/06/2015 START                                             00766006
007670     05  PS-BRAND-FOUND-SW            PIC  X(01)  VALUE 'N'.      00767006
007680         88  PS-BRAND-FOUND-YES                   VALUE 'Y'.      00768006
007690         88  PS-BRAND-FOUND-NO                    VALUE 'N'.      00769006
007700*CLP 07/06/2015 END                                               00770006
007710* CT 11/06/08 BEGIN                                               00771006
007720     05  PS-AUTO-CONVEY-LVL-SW           PIC  X(03)  VALUE SPACE. 00772006
007730         88  PS-AUTO-CONVEY-NO-CRTNS                 VALUE 'NNE'. 00773006
007740         88  PS-AUTO-CONVEY-EXCPT-CRTNS              VALUE 'EXC'. 00774006
007750         88  PS-AUTO-CONVEY-ALL-CRTNS                VALUE 'ALL'. 00775006
007760     05  PS-PROCESSING-ERROR-SW          PIC  X(01)  VALUE 'N'.   00776006
007770         88  PS-PROCESSING-ERROR-YES                 VALUE 'Y'.   00777006
007780         88  PS-PROCESSING-ERROR-NO                  VALUE 'N'.   00778006
007790* CT 11/06/08 END                                                 00779006
007800* EA 07/02/2010                                                  *00780006
007810     05  PS-OTBND-LOC-ENTRY-SW           PIC  X(01)  VALUE 'N'.   00781006
007820         88  PS-OTBND-LOC-ENTRY-EXIST                VALUE 'Y'.   00782006
007830         88  PS-OTBND-LOC-ENTRY-NOT-EXIST            VALUE 'N'.   00783006
007840* EA 07/02/2010                                                  *00784006
007850* CLP 04/23/13 PR5148B START                                      00785006
007860     05  PS-DIRECTIVE-SW                 PIC  X(01)  VALUE 'N'.   00786006
007870         88  PS-DIRECTIVE-YES                        VALUE 'Y'.   00787006
007880         88  PS-DIRECTIVE-NO                         VALUE 'N'.   00788006
007890     05  PS-RFID-ON-LABEL-SW             PIC  X(01)  VALUE 'N'.   00789006
007900         88  PS-RFID-ON-LABEL-YES                    VALUE 'Y'.   00790006
007910         88  PS-RFID-ON-LABEL-NO                     VALUE 'N'.   00791006
007920* CLP 04/23/13 PR5148B END                                        00792006
007930* 07/19/13 RLK BEG                                                00793006
007940     05  PS-DC-USE-RFID-CART-LBL-SW      PIC  X(01)  VALUE 'N'.   00794006
007950         88  PS-DC-USE-RFID-CART-LBL-YES             VALUE 'Y'.   00795006
007960         88  PS-DC-USE-RFID-CART-LBL-NO              VALUE 'N'.   00796006
007970     05  PS-CRTN-LBL-TSHUNLO-CREATED-SW  PIC  X(01)  VALUE 'N'.   00797006
007980         88  PS-CRTN-LBL-TSHUNLO-CREATED             VALUE 'Y'.   00798006
007990         88  PS-CRTN-LBL-TSHUNLO-NOT-CRTED           VALUE 'N'.   00799006
008000* 07/09/17 gb beg                                                 00800069
008010     05  PS-RFID-DEPT-LEVEL-CHK-SW       PIC  X(01)  VALUE 'N'.   00801069
008020         88  PS-RFID-DEPT-LEVEL-YES                  VALUE 'Y'.   00802069
008030         88  PS-RFID-DEPT-LEVEL-NO                   VALUE 'N'.   00803069
008040     05  PS-RFID-CALL-AUDIT-SW           PIC  X(01)  VALUE 'N'.   00804069
008050         88  PS-RFID-AUDIT-YES                       VALUE 'Y'.   00805069
008060         88  PS-RFID-AUDIT-NO                        VALUE 'N'.   00806069
008070* 07/09/17 gb end                                                 00807069
008080     05  PS-LABEL-PARM-FOUND-SW          PIC  X(01)  VALUE 'N'.   00808068
008090         88  PS-LABEL-PARM-FOUND                     VALUE 'Y'.   00809068
008100         88  PS-LABEL-PARM-NOT-FOUND                 VALUE 'N'.   00810068
008101     05  PS-USE-LAST-4-FROM-TMST-SW      PIC  X(01)  VALUE 'N'.   00810181
008102         88  PS-USE-LAST-4-FROM-TMST                 VALUE 'Y'.   00810281
008103         88  PS-USE-LAST-4-ZEROS                     VALUE 'N'.   00810381
008110                                                                  00811006
008120                                                                  00812006
008130*----------------------------------------------------------------*00813006
008140*  PROGRAM VARIABLES                                             *00814006
008150*----------------------------------------------------------------*00815006
008160 01  PV-PROGRAM-VARIABLES.                                        00816006
008170* CLP 04/23/13 PR5148B START                                      00817006
008180     05  PV-CARTON-CNT18                 PIC 9(18)    VALUE ZEROS.00818006
008190     05  PV-UNIT                         PIC 9(04)    VALUE ZEROS.00819006
008200     05  PV-TRIP                         PIC 9(09)    VALUE ZEROS.00820006
008210     05  PV-STORE1                       PIC 9(04)    VALUE ZEROS.00821006
008220     05  PV-AUDIT                        PIC 9(09)    VALUE ZEROS.00822006
008230     05  PV-AUDITR                       PIC 9(09)    VALUE ZEROS.00823006
008240     05  PV-PO-XNUM                      PIC 9(09)    VALUE ZEROS.00824006
008250     05  PV-PO-RCVR-SEQ-NO               PIC 9(09)    VALUE ZEROS.00825006
008260* CLP 04/23/13 PR5148B END                                        00826006
008270*CLP 07/06/2015 START                                             00827008
008280     05  PV-BUS-AREA-BRAND        PIC  X(35)    VALUE SPACES.     00828006
008290     05  PV-DESC-LEN              PIC S9(04) VALUE +0             00829015
008300                                                COMP.             00830015
008310     05  PV-BUS-AREA-DESC-9       PIC  X(09)    VALUE SPACES.     00831015
008320*CLP 07/06/2015 END                                               00832008
008330     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   00833006
008340                                                     COMP SYNC.   00834006
008350     05  PV-NULL-CRE-TMST                PIC S9(4)   VALUE ZERO   00835006
008360                                                     COMP SYNC.   00836006
008370     05  PV-NULL-E-BUS-IND               PIC S9(4)   VALUE ZERO   00837006
008380                                                     COMP SYNC.   00838006
008390     05  PV-CICS-MSG-AREA-A.                                      00839006
008400         10  FILLER                      PIC  X(01)  VALUE SPACE. 00840006
008410         10  PV-CICS-MSG-AREA-B          PIC  X(80)  VALUE SPACE. 00841006
008420     05  PV-CICS-MSG-AREA.                                        00842006
008430         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 00843006
008440         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 00844006
008450         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 00845006
008460         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 00846006
008470         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 00847006
008480         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 00848006
008490         10  PV-CICS-MSG-AREA7           PIC  X(80)  VALUE SPACE. 00849006
008500         10  PV-CICS-MSG-AREA8           PIC  X(80)  VALUE SPACE. 00850006
008510         10  PV-CICS-MSG-AREA9           PIC  X(80)  VALUE SPACE. 00851006
008520         10  PV-CICS-MSG-AREA10          PIC  X(80)  VALUE SPACE. 00852006
008530         10  PV-CICS-MSG-AREA11          PIC  X(80)  VALUE SPACE. 00853006
008540         10  PV-CICS-MSG-AREA12          PIC  X(80)  VALUE SPACE. 00854006
008550         10  PV-CICS-MSG-AREA13          PIC  X(80)  VALUE SPACE. 00855006
008560         10  PV-CICS-MSG-AREA14          PIC  X(80)  VALUE SPACE. 00856006
008570         10  PV-CICS-MSG-AREA15          PIC  X(80)  VALUE SPACE. 00857006
008580         10  PV-CICS-MSG-AREA16          PIC  X(80)  VALUE SPACE. 00858006
008590         10  PV-CICS-MSG-AREA17          PIC  X(80)  VALUE SPACE. 00859006
008600         10  PV-CICS-MSG-AREA18          PIC  X(80)  VALUE SPACE. 00860006
008610         10  PV-CICS-MSG-AREA19          PIC  X(80)  VALUE SPACE. 00861006
008620         10  PV-CICS-MSG-AREA20          PIC  X(80)  VALUE SPACE. 00862006
008630     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00863006
008640     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  00864006
008650                                                     COMP SYNC.   00865006
008660     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 00866006
008670     05  PV-ERROR-TEXT                   PIC  X(100) VALUE SPACE. 00867006
008680     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 00868006
008690     05  PV-REPRINT-CSR-CNT              PIC S9(04)  VALUE ZEROS  00869006
008700                                                     COMP SYNC.   00870006
008710     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  00871006
008720                                                     COMP SYNC.   00872006
008730     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  00873006
008740                                                     COMP SYNC.   00874006
008750     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  00875006
008760                                                     COMP SYNC.   00876006
008770     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  00877006
008780                                                     COMP SYNC.   00878006
008790     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  00879006
008800                                                     COMP SYNC.   00880006
008810     05  PV-VERIF-RECITM-COUNT           PIC S9(04)  VALUE ZEROS  00881006
008820                                                     COMP SYNC.   00882006
008830     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 00883006
008840     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 00884006
008850     05  PV-TOTAL                        PIC  9(04).              00885006
008860     05  FILLER REDEFINES PV-TOTAL.                               00886006
008870         10  FILLER                      PIC  9(03).              00887006
008880         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              00888006
008890     05  PV-CHECK-DIGIT                  PIC  9(01).              00889006
008900     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    00890006
008910                                                     COMP SYNC.   00891006
008920     05  PV-RBA                          PIC S9(08)  VALUE +0     00892006
008930                                                     COMP SYNC.   00893006
008940     05  PV-9999-9                       PIC  9(04)  VALUE 0000.  00894006
008950     05  PV-9999-X REDEFINES PV-9999-9.                           00895006
008960         10  PV-9999-1-2                 PIC  X(02).              00896006
008970         10  PV-9999-3-4                 PIC  X(02).              00897006
008980     05  PV-CTN-X                        PIC  X(18).              00898006
008990     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              00899006
009000     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          00900006
009010         10  PV-CTN-9-1                  PIC  9(01).              00901006
009020         10  PV-CTN-9-2                  PIC  9(01).              00902006
009030         10  PV-CTN-9-3                  PIC  9(01).              00903006
009040         10  PV-CTN-9-4                  PIC  9(01).              00904006
009050         10  PV-CTN-9-5                  PIC  9(01).              00905006
009060         10  PV-CTN-9-6                  PIC  9(01).              00906006
009070         10  PV-CTN-9-7                  PIC  9(01).              00907006
009080         10  PV-CTN-9-8                  PIC  9(01).              00908006
009090         10  PV-CTN-9-9                  PIC  9(01).              00909006
009100         10  PV-CTN-9-10                 PIC  9(01).              00910006
009110         10  PV-CTN-9-11                 PIC  9(01).              00911006
009120         10  PV-CTN-9-12                 PIC  9(01).              00912006
009130         10  PV-CTN-9-13                 PIC  9(01).              00913006
009140         10  PV-CTN-9-14                 PIC  9(01).              00914006
009150         10  PV-CTN-9-15                 PIC  9(01).              00915006
009160         10  PV-CTN-9-16                 PIC  9(01).              00916006
009170         10  PV-CTN-9-17                 PIC  9(01).              00917006
009180         10  PV-CTN-9-18                 PIC  9(01).              00918006
009190     05  PV-128-CARTON.                                           00919006
009200         10  PV-128-CARTON-13            PIC  9(13).              00920006
009210         10  PV-128-CARTON-5             PIC  9(05).              00921006
009220* 07/19/13 RLK BEG                                                00922006
009230     05  PV-RFID-DIVERT-CDE              PIC X(4).                00923006
009240     05  PV-RFID-DIVERT-CDE-N REDEFINES PV-RFID-DIVERT-CDE        00924006
009250                                         PIC 9(4).                00925006
009260     05  PV-22-DIGIT-BARCODE.                                     00926006
009270         10  PV-22-CRTN-TYPE-IND              PIC 9(01).          00927006
009280         10  PV-22-CRTN-DIVERT-CDE            PIC X(04).          00928006
009290         10  PV-22-CRTN-PO-NBR                PIC 9(08).          00929006
009300         10  PV-22-CTRN-RCVR-SEQ-NBR          PIC 9(02).          00930006
009310         10  PV-22-CRTN-PO-LNE-NBR            PIC 9(03).          00931006
009320         10  PV-22-CRTN-CART-NBR              PIC 9(04).          00932006
009330* 07/19/13 RLK END                                                00933006
009340     05  PV-DB2-CURRENT-DATE             PIC X(10)    VALUE SPACE.00934006
009350     05  PV-DB2-COUNT                    PIC S9(09)   VALUE +0    00935006
009360                                                      COMP-3.     00936006
009370     05  PV-DB2-PKSLIP-COUNT             PIC S9(09)   VALUE +0    00937006
009380                                                      COMP-3.     00938006
009390     05  PV-DB2-COUNT-PBS                PIC S9(09)   VALUE +0    00939006
009400                                                      COMP-3.     00940006
009410     05  PV-DB2-ALLOC-COUNT              PIC S9(09)   VALUE +0    00941006
009420                                                      COMP-3.     00942006
009430     05  PV-DB2-RTV-COUNT                PIC S9(09)   VALUE +0    00943006
009440                                                      COMP-3.     00944006
009450     05  PV-DB2-LINE-COUNT               PIC S9(09)   VALUE +0    00945006
009460                                                      COMP-3.     00946006
009470     05  PV-PBS-SCN-LOC-ID               PIC   X(4).              00947006
009480     05  PV-UCC128-DAT-USG-CDE           PIC   X(1) VALUE SPACES. 00948006
009490                                                                  00949006
009500     05  PV-STORE-9-4                    PIC 9(04)    VALUE ZEROS.00950006
009510     05  PV-STORE-X   REDEFINES PV-STORE-9-4.                     00951006
009520         10  PV-STORE-X-4                PIC X(04).               00952006
009570     05  PV-STORE-NBR.                                            00957006
009580         10  PV-STORE-NBR-PFX            PIC 9(01) VALUE ZEROS.   00958006
009590         10  PV-STORE-NBR-4              PIC 9(04) VALUE ZEROS.   00959006
009600                                                                  00960006
009610     05  PV-STORE-NBR-PFX-HOLD           PIC 9(01) VALUE ZEROS.   00961006
009620                                                                  00962006
009630     05  PV-SCAC-TRLR.                                            00963006
009640         10  PV-VEH-SCAC                 PIC  X(04).              00964006
009650         10  FILLER                      PIC  X(01) VALUE SPACES. 00965006
009660         10  PV-VEH-TRLR                 PIC  X(10).              00966006
009670*                                                                 00967006
009680     05  PV-PRC-AREA-ID-X                PIC X(03).               00968006
009690     05  PV-PRC-AREA-9 REDEFINES PV-PRC-AREA-ID-X                 00969006
009700                                         PIC 9(03).               00970006
009710     05  PV-PRC-AREA-ID                  PIC S9(03) COMP.         00971006
009720                                                                  00972006
009730     05  PV-RCVR-SEQ-NBR                 PIC S9(09)   VALUE ZEROS 00973006
009740                                                      COMP.       00974006
009750     05  PV-CRTN-TRIP-ID                 PIC  S9(9)   VALUE ZEROS 00975006
009760                                                      COMP.       00976006
009770     05  PV-MAX-USER-BATCH               PIC S9(04)   VALUE ZEROS 00977006
009780                                                      COMP.       00978006
009790     05  PV-VEND-STYL-NAME               PIC  X(20) VALUE SPACES. 00979006
009800     05  PV-DEPT-NUMBER                  PIC  X(03) VALUE SPACES. 00980006
009810     05  PV-DEPT-NUMBER-N                PIC  9(04).              00981040
009820     05  PV-CL-NBR                       PIC  X(02) VALUE SPACES. 00982006
009830     05  PV-SKU.                                                  00983006
009840         10  PV-DEPT-NBR                 PIC  X(03) VALUE SPACES. 00984006
009850         10  PV-SKU-DASH-1               PIC  X(01) VALUE SPACE.  00985006
009860         10  PV-CLASS-NBR                PIC  X(02) VALUE SPACES. 00986006
009870         10  PV-SKU-DASH-2               PIC  X(01) VALUE SPACE.  00987006
009880         10  PV-SKU-NBR                  PIC  X(03) VALUE SPACES. 00988006
009890     05  PV-SKU-OUT                      PIC  X(08).              00989006
009900     05  PV-SKU-OUT-9 REDEFINES PV-SKU-OUT                        00990006
009910                                         PIC  9(08).              00991006
009920     05  PV-SKU-LBL.                                              00992006
009930         10  FILLER                      PIC  X(01) VALUE '('.    00993006
009940         10  PV-DEPT-NUMBER-LBL          PIC  X(03) VALUE SPACES. 00994006
009950         10  FILLER                      PIC  X(01) VALUE '-'.    00995006
009960         10  PV-CL-NBR-LBL               PIC  X(02) VALUE SPACES. 00996006
009970         10  FILLER                      PIC  X(01) VALUE ')'.    00997006
009980         10  PV-SKU-NBR-LBL              PIC  9(08) VALUE ZERO.   00998006
009990     05  PV-CARTON-CNT                   PIC 9(04)    VALUE ZEROS.00999006
010000     05  PV-CARTON-CNT-X REDEFINES PV-CARTON-CNT.                 01000006
010010         10  PV-CARTON-CNT-LBL           PIC X(04).               01001006
010020*                                                                 01002006
010030     05  PV-MULTIPLE                     PIC  9(04)  VALUE ZEROS. 01003006
010040     05  PV-HOLD-MULTIPLE                PIC  9(04)  VALUE ZEROS. 01004006
010050     05  PV-REMAINDER                    PIC  9(04)  VALUE ZEROS. 01005006
010060*                                                                 01006006
010070     05  PV-INNR-PACK-QTY                PIC  S9(5) VALUE ZEROES  01007006
010080                                                    COMP.         01008006
010090     05  PV-OUTR-PACK-QTY                PIC  S9(5) VALUE ZEROES  01009006
010100                                                    COMP.         01010006
010110     05  PV-SHIPPED-QTY                  PIC  S9(9) VALUE ZEROES  01011006
010120                                                    COMP.         01012006
010130     05  PV-SHPD-QTY-TOTAL               PIC  S9(9) VALUE ZEROES  01013006
010140                                                    COMP.         01014006
010150     05  PV-WRKR-USR-ID                  PIC  X(08) VALUE ZEROES. 01015006
010160     05  PV-SESSION-ID                   PIC  X(08) VALUE ZEROES. 01016006
010170     05  PV-PREPK-ID                     PIC  S9(4) COMP.         01017006
010180     05  PV-PREPK-RATO-QTY               PIC  S9(4) COMP.         01018006
010190     05  PV-PREPK-UNT-QTY                PIC  S9(4) COMP.         01019006
010200     05  PV-CSE-PK-QTY                   PIC  S9(4) COMP.         01020006
010210     05  PV-ODD-CART-IND                 PIC   X(1).              01021006
010220     05  PV-SEASET-NM                    PIC   X(25).             01022006
010230     05  PV-PRNT-CART-SEQ-ID             PIC   S9(4) COMP.        01023006
010240*                                                                 01024006
010250     05  PV-UNION-TYPE                   PIC  X(01).              01025006
010260     05  PV-PREV-FETCH                   PIC  X(01).              01026006
010270     05  PV-PREV-LINE                    PIC  S9(9) COMP.         01027006
010280                                                                  01028006
010290     05  PV-BAR-CODE                     PIC  X(22) VALUE ZEROES. 01029006
010300     05  PV-BAR-CODE-N  REDEFINES  PV-BAR-CODE.                   01030006
010310         10 FILLER                       PIC  9(02).              01031006
010320         10 PV-BAR-CODE-OTBND            PIC  9(18).              01032006
010330         10 FILLER                       PIC  9(02).              01033006
010340     05  PV-BAR-CODE-R  REDEFINES  PV-BAR-CODE.                   01034006
010350         10 PV-BAR-CODE-DIVERT-PFX       PIC  9(01).              01035006
010360         10 PV-BAR-CODE-STORE-NBR        PIC  9(04).              01036006
010370         10 PV-BAR-CODE-OPER-UNIT        PIC  9(04).              01037006
010380         10 PV-BAR-CODE-POS-10-15        PIC  9(06).              01038006
010390         10 PV-BAR-CODE-LBL-MANIFEST     PIC  9(07).              01039006
010400     05  PV-DISPLAY-MANIFEST             PIC  9(09) VALUE ZEROES. 01040006
010410     05  PV-DISPLAY-CARTON               PIC  9(18) VALUE ZEROES. 01041006
010420     05  PV-DISPLAY-STORE                PIC  9(04) VALUE ZEROES. 01042006
010430     05  PV-DISPLAY-DEPT                 PIC  9(04) VALUE ZEROES. 01043006
010440     05  PV-DISPLAY-DC                   PIC  9(04) VALUE ZEROES. 01044006
010450     05  PV-DISPLAY-ITM-NBR              PIC  9(15) VALUE ZEROES. 01045006
010460     05  PV-DISPLAY-PO                   PIC  9(09) VALUE ZEROES. 01046006
010470     05  PV-DISPLAY-PO-RCVR              PIC  9(09) VALUE ZEROES. 01047006
010480     05  PV-DISPLAY-PO-LNE-NBR           PIC  9(09) VALUE ZEROES. 01048006
010490     05  PV-DISPLAY-ERROR-NBR            PIC  9(02) VALUE ZEROES. 01049006
010500     05  PV-DISPLAY-PACK-SKU             PIC  9(02) VALUE ZEROES. 01050006
010510     05  PV-DISPLAY-RET-CODE             PIC  9(02) VALUE ZEROES. 01051006
010520     05  PV-DISPLAY-CLASS                PIC  9(05) VALUE ZEROES. 01052006
010530     05  PV-DISPLAY-TRAN                 PIC  9(09) VALUE ZEROES. 01053006
010540     05  PV-DISPLAY-LINE                 PIC  9(09) VALUE ZEROES. 01054006
010550     05  PV-DISPLAY-PREPK                PIC  9(04) VALUE ZEROES. 01055006
010560     05  PV-DISPLAY-SQLCODE              PIC S9(04) VALUE ZEROES. 01056006
010570     05  PV-SQLCODE                      PIC S9(09) VALUE ZEROES. 01057006
010580     05  PV-PRINTER-ID.                                           01058006
010590         10  PV-PRINTER-ID-1-3           PIC  X(03) VALUE ZEROES. 01059006
010600         10  PV-PRINTER-ID-4-8           PIC  X(03) VALUE ZEROES. 01060006
010610     05  PV-LBL-MANIFEST-NBR             PIC  9(09) VALUE ZEROES. 01061006
010620     05  PV-LBL-MANIFEST-INCREMENT       PIC S9(09) VALUE +1      01062006
010630                                                     COMP.        01063006
010640     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01064006
010650                                                    COMP SYNC.    01065006
010660     05  PV-DEPT-DESC                   PIC   X(25) VALUE SPACES. 01066006
010670     05  PV-MAJ-CL-DESC                 PIC   X(25) VALUE SPACES. 01067006
010680     05  PV-TRN-LNE-NBR                 PIC  S9(9) COMP.          01068006
010690     05  PV-HOLD-TRN-LNE-NBR            PIC  S9(9) COMP.          01069006
010700     05  PV-OPER-UNT-ID                 PIC  S9(04)  COMP.        01070006
010710     05  PV-CURR-OPER-UNT-ID            PIC  S9(04)  COMP.        01071006
010720     05  PV-REPURP-COUNT                PIC S9(09)  VALUE +0      01072006
010730                                                     COMP-3.      01073006
010740     05  PV-FIXTURE-ID                  PIC  X(10) VALUE SPACES.  01074006
010750                                                                  01075006
010760     05  PV-PCKCS721                  PIC X(08)  VALUE 'PCKCS721'.01076006
010770     05  PV-SUKCS583                  PIC X(08)  VALUE 'SUKCS583'.01077006
010780* CLP 10/24/13 BEGIN PR#5148D                                     01078006
010790     05  PV-SUKCS720                  PIC X(08)  VALUE 'SUKCS720'.01079006
010800* CLP 10/24/13   END PR#5148D                                     01080006
010810* PB 06/07/2010 BEG                                               01081006
010820     05  PV-DONE-PROCESSING-SW        PIC X(01)  VALUE 'N'.       01082006
010830         88  PV-DONE-PROCESSING                  VALUE 'Y'.       01083006
010840* PB 06/07/2010 BEG                                               01084006
010850     05  PV-PULL-NBR                  PIC  S9(9) VALUE +0 COMP.   01085006
010860     05  PV-PULL-LNE-NBR              PIC  S9(9) VALUE +0 COMP.   01086006
010870     05  PV-OTBND-CART-YES            PIC  X(01) VALUE 'N'.       01087006
010880     05  PV-WHSE-CART-EXIST           PIC  X(01).                 01088006
010890* PB 06/07/2010 END                                               01089006
010900                                                                  01090006
010910 01  PV-COUNTERS.                                                 01091006
010920     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.01092006
010930     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      01093006
010940                                                 COMP.            01094006
010950     05  PV-DPKUT038-CICS-RESP        PIC S9(04) VALUE +0         01095006
010960                                                 COMP SYNC.       01096006
010970     05  PV-DPKUT038-DATE             PIC X(06)  VALUE SPACES.    01097006
010980     05  PV-DPKUT038-DATE-R REDEFINES PV-DPKUT038-DATE.           01098006
010990         10 PV-DPKUT038-YY               PIC  X(02).              01099006
011000         10 PV-DPKUT038-MM               PIC  X(02).              01100006
011010         10 PV-DPKUT038-DD               PIC  X(02).              01101006
011020     05  PV-DPKUT038-MJR-CL.                                      01102006
011030         10 FILLER                       PIC  X(01) VALUE SPACE.  01103006
011040         10 PV-DPKUT038-MJR-CL-2         PIC  X(01) VALUE SPACE.  01104006
011050*                                                                 01105006
011060     05  PV-CURRENT-DATE                 PIC X(10)  VALUE SPACES. 01106006
011070     05  PV-CURRENT-DATE-R REDEFINES     PV-CURRENT-DATE.         01107006
011080         10 PV-CURRENT-CC                PIC  9(02).              01108006
011090         10 PV-CURRENT-YY                PIC  9(02).              01109006
011100         10 FILLER                       PIC  X(01).              01110006
011110         10 PV-CURRENT-MM                PIC  9(02).              01111006
011120         10 FILLER                       PIC  X(01).              01112006
011130         10 PV-CURRENT-DD                PIC  9(02).              01113006
011140     05  PV-CURRENT-TIME                 PIC X(08)  VALUE SPACES. 01114006
011150     05  PV-CURRENT-TIME-R REDEFINES     PV-CURRENT-TIME.         01115006
011160         10 PV-CURRENT-HR                PIC  9(02).              01116006
011170         10 FILLER                       PIC  X(01).              01117006
011180         10 PV-CURRENT-MN                PIC  9(02).              01118006
011190         10 FILLER                       PIC  X(03).              01119006
011200*                                                                 01120006
011210     05  PV-BEGIN-TIME                   PIC X(26)  VALUE SPACES. 01121006
011220     05  PV-END-TIME                     PIC X(26)  VALUE SPACES. 01122006
011230*                                                                 01123006
011231     05  PV-CURRENT-TMST                 PIC X(26)  VALUE SPACES. 01123178
011232     05  PV-CURRENT-TMST-R.                                       01123278
011233         10 FILLER                       PIC  X(22) VALUE SPACES. 01123380
011234         10 PV-CURRENT-TMST-R-LAST-4     PIC  9(04) VALUE ZEROS.  01123480
011239*                                                                 01123978
011240     05  PV-TSHUNLO-CRE-TMST             PIC X(26)  VALUE SPACES. 01124006
011250     05  PV-TSHUNLO-TMST-EAI             PIC X(26)  VALUE SPACES. 01125006
011260     05  PV-TSHUNLO-PBS-CRE-TMST         PIC X(26)  VALUE SPACES. 01126006
011270     05  PV-TSHUNLO-PBS-TMST-R.                                   01127006
011280         10 PV-PBS-YYYY-MM-DD            PIC  X(10).              01128006
011290         10 PV-PBS-TMST-SPACE            PIC  X(01)  VALUE SPACES.01129006
011300         10 PV-PBS-HH                    PIC  X(02).              01130006
011310         10 PV-PBS-TMST-COLON            PIC  X(01)  VALUE ':'.   01131006
011320         10 PV-PBS-MM                    PIC  X(02).              01132006
011330         10 PV-PBS-TMST-SPACE-2          PIC  X(10)  VALUE SPACES.01133006
011340                                                                  01134006
011350     05  PV-SYSTEM-ID.                                            01135006
011360         10  FILLER              PIC  X(04)  VALUE SPACE.         01136006
011370         10  PV-REGION-IND       PIC  X(01).                      01137006
011380             88  PV-TEST-CICS                VALUE 'T'.           01138006
011390             88  PV-QA-CICS                  VALUE 'Q'.           01139006
011400             88  PV-PROD-CICS                VALUE 'P'.           01140006
011410             88  PV-LEARN-CICS               VALUE 'L'.           01141006
011420         10  FILLER              PIC  X(03)  VALUE SPACES.        01142006
011430*                                                                 01143006
011440*----------------------------------------------------------------*01144006
011450*                                                                *01145006
011460*----------------------------------------------------------------*01146006
011470*CLP 09/25/2014 - START                                           01147006
011480     05  PV-PROGRAM-DATA.                                         01148006
011490         10  PV-PO                       PIC  X(08)  VALUE SPACE. 01149006
011500         10  PV-PO-N REDEFINES PV-PO     PIC  ZZZZZZZ9.           01150006
011510*                                                                 01151006
011520         10  PV-PO-RCVR.                                          01152006
011530             15 PV-PO-OUT                PIC  9(08).              01153006
011540             15 FILLER                   PIC  X(01)  VALUE '-'.   01154006
011550             15 PV-RCVR-OUT              PIC 9(03).               01155006
011560*CLP 09/25/2014 - END                                             01156006
011570*                                                                 01157006
011580                                                                  01158006
011590         10  PV-PO-LINE-N                  PIC 9(09).             01159006
011600         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 01160006
011610             15 FILLER                     PIC X(05).             01161006
011620             15 PV-PO-LINE-OUT             PIC X(04).             01162006
011630                                                                  01163006
011640         10  PV-DRIVER-LINE-NO             PIC 9(09).             01164006
011650                                                                  01165006
011660         10  PV-PO-LINE-LBL.                                      01166006
011670             15  PV-LINE-LBL-1           PIC 9(01).               01167006
011680             15  PV-LINE-LBL-3           PIC 9(03).               01168006
011690                                                                  01169006
011700         10  PV-STORE                    PIC  X(04)  VALUE SPACE. 01170006
011710         10  PV-STORE-N REDEFINES PV-STORE PIC ZZZ9.              01171006
011720                                                                  01172006
011730         10  PV-CTN.                                              01173006
011740             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              01174006
011750             15  PV-CTN-LAST-17          PIC  X(17).              01175006
011760             15  PV-CTN-FILLER           PIC  X(02).              01176006
011770         10  FILLER REDEFINES PV-CTN.                             01177006
011780             15  PV-CTN-SCAN-00          PIC  X(02).              01178006
011790             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              01179006
011800             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              01180006
011810         10  FILLER REDEFINES PV-CTN.                             01181006
011820             15  PV-CTN-SCAN-00          PIC  X(02).              01182006
011830             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              01183006
011840                                                                  01184006
011850         10  PV-BUS-AREA-ID              PIC  S9(2)V VALUE ZEROES 01185006
011860                                                     COMP-3.      01186006
011870*                                                                 01187006
011880         10  PV-HNG-FOLD-SEQ-NBR         PIC  S9(4) COMP.         01188006
011890         10  PV-PREV-HANG-FOLD-IND       PIC  X(01) VALUE SPACE.  01189006
011900         10  PV-HANG-FOLD-IND            PIC  X(01) VALUE SPACE.  01190006
011910*                                                                 01191006
011920         10  PV-TROUBLE-COUNT            PIC S9(09)  COMP.        01192006
011930         10  PV-TROUBLE-COUNT-REPUR      PIC S9(09)  COMP.        01193006
011940         10  PV-TROUBLE-CNT-REPUR-INNR   PIC S9(09)  COMP.        01194006
011950         10  PV-SHPD-PK-QTY              PIC S9(09)  COMP.        01195006
011960* 09/23/13 SB BEG                                                 01196006
011970     05  PV-FUNC-TXT                     PIC  X(01) VALUE SPACES. 01197072
011980     05  PV-20-DIGIT-BARCODE             PIC X(18) VALUE ZEROES.  01198006
011990     05  PV-20-DIGIT-BARCODE-R REDEFINES PV-20-DIGIT-BARCODE.     01199006
012000*        10  PV-20-SML-CONTAINER-CDE     PIC 9(02).               01200006
012010         10  PV-20-SML-PACKAGING-TYP     PIC 9(01).               01201006
012020             88  PV-20-SML-INTERNAL-LBL      VALUE 4.             01202006
012030         10  PV-20-SML-SOFTWARE-SRC      PIC 9(01).               01203006
012040             88  PV-20-SML-FROM-KOHLS        VALUE 1.             01204006
012050             88  PV-20-SML-FROM-REPLEN       VALUE 2.             01205006
012060         10  PV-20-SML-BC-DIVERT.                                 01206006
012070             15  PV-20-SML-BC-DIVERT-PFX PIC 9(01).               01207006
012080             15  PV-20-SML-BC-DIVERT-CDE PIC 9(04).               01208006
012090         10  PV-20-SML-BC-DC-ORIGIN      PIC 9(03).               01209006
012100         10  PV-20-SML-BC-MNFST-NBR      PIC 9(08).               01210006
012110     05  PV-RFID-REPLEN-CHK-SW           PIC X(01) VALUE SPACE.   01211006
012120         88  PV-RFID-REPLEN-YES                    VALUE 'Y'.     01212006
012130         88  PV-RFID-REPLEN-NO                     VALUE 'N'.     01213006
012140* 09/23/13 SB END                                                 01214006
012150*----------------------------------------------------------------*01215006
012160*  GENERATED DSECT FOR THE SUKM502 MAPSET                         01216006
012170*----------------------------------------------------------------*01217006
012180     COPY SUKM502.                                                01218006
012190                                                                  01219006
012200*----------------------------------------------------------------*01220006
012210*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01221006
012220*----------------------------------------------------------------*01222006
012230     COPY DPWS010I.                                               01223006
012240                                                                  01224006
012250*----------------------------------------------------------------*01225006
012260*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01226006
012270*----------------------------------------------------------------*01227006
012280     COPY DPWS015.                                                01228006
012290                                                                  01229006
012300/                                                                 01230006
012310*----------------------------------------------------------------*01231006
012320*  COPYBOOK FOR CALLED MODULE TO RETURN BUSINESS AREA ID          01232006
012330*  VSM INTERFACE                                                  01233006
012340*----------------------------------------------------------------*01234006
012350     COPY XLWS073.                                                01235006
012360/                                                                 01236006
012370*----------------------------------------------------------------*01237006
012380*  COPYBOOK FOR CALLED MODULE TO RETURN SEASONAL SET AND FIXTURE  01238006
012390*  DATA                                                           01239006
012400*----------------------------------------------------------------*01240006
012410     COPY PCWS240.                                                01241006
012420/                                                                 01242006
012430*----------------------------------------------------------------*01243006
012440*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01244006
012450*----------------------------------------------------------------*01245006
012460     COPY DFHAID.                                                 01246006
012470                                                                  01247006
012480*----------------------------------------------------------------*01248006
012490*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *01249006
012500*----------------------------------------------------------------*01250006
012510     COPY DPWS003.                                                01251006
012520                                                                  01252006
012530*----------------------------------------------------------------*01253006
012540 01  CA-COMMAREA.                                                 01254006
012550*----------------------------------------------------------------*01255006
012560*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT           *01256006
012570*----------------------------------------------------------------*01257006
012580     COPY SUWS001.                                                01258006
012590                                                                  01259006
012600*----------------------------------------------------------------*01260006
012610*  COMMAREA LAYOUT FOR THE AUDIT CHECK MODULE (SUKCS583)         *01261006
012620*----------------------------------------------------------------*01262006
012630     COPY SURD021.                                                01263006
012640                                                                  01264006
012650*----------------------------------------------------------------*01265006
012660*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01266006
012670*----------------------------------------------------------------*01267006
012680     COPY DPWS013.                                                01268006
012690                                                                  01269006
012700*----------------------------------------------------------------*01270006
012710 01  CA-COMMAREA-CRTN-AUD.                                        01271006
012720*----------------------------------------------------------------*01272006
012730*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT           *01273006
012740*----------------------------------------------------------------*01274006
012750     COPY SUWS006.                                                01275006
012760                                                                  01276006
012770*----------------------------------------------------------------*01277006
012780*    STORE MANIFEST LAYOUT.                                       01278006
012790*----------------------------------------------------------------*01279006
012800     COPY PCWS187.                                                01280006
012810                                                                  01281006
012820*----------------------------------------------------------------*01282006
012830*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      01283006
012840*  TABLE                                                          01284006
012850*----------------------------------------------------------------*01285006
012860     EXEC SQL                                                     01286006
012870         INCLUDE TSHPUNT                                          01287006
012880     END-EXEC.                                                    01288006
012890                                                                  01289006
012900*---------------------------------------------------------------* 01290006
012910*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TABLE                 * 01291006
012920*---------------------------------------------------------------* 01292006
012930     EXEC SQL                                                     01293006
012940         INCLUDE TSUATRN                                          01294006
012950     END-EXEC.                                                    01295006
012960*----------------------------------------------------------------*01296006
012970*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  01297006
012980*  TABLE                                                          01298006
012990*----------------------------------------------------------------*01299006
013000     EXEC SQL                                                     01300006
013010         INCLUDE TSHUUPC                                          01301006
013020     END-EXEC.                                                    01302006
013030                                                                  01303006
013040*----------------------------------------------------------------*01304006
013050*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT UNIT      01305006
013060*  LOCATION TABLE                                                 01306006
013070*----------------------------------------------------------------*01307006
013080     EXEC SQL                                                     01308006
013090         INCLUDE TSHUNLO                                          01309006
013100     END-EXEC.                                                    01310006
013110                                                                  01311006
013120*----------------------------------------------------------------*01312006
013130*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI PACKSLI01313006
013140*  VENDOR SHIPMENT UNIT ASSOCIATION TABLE                         01314006
013150*----------------------------------------------------------------*01315006
013160     EXEC SQL                                                     01316006
013170         INCLUDE TINPKSU                                          01317006
013180     END-EXEC.                                                    01318006
013190                                                                  01319006
013200*----------------------------------------------------------------*01320006
013210*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       01321006
013220*  LOCATION MASTER TABLE (XLT_LOC)                                01322006
013230*----------------------------------------------------------------*01323006
013240     EXEC SQL                                                     01324006
013250         INCLUDE XLT00010                                         01325006
013260     END-EXEC.                                                    01326006
013270                                                                  01327006
013280*----------------------------------------------------------------*01328006
013290*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PO TABLE           01329006
013300*----------------------------------------------------------------*01330006
013310     EXEC SQL                                                     01331006
013320         INCLUDE TPURCHS                                          01332006
013330     END-EXEC.                                                    01333006
013340                                                                  01334006
013350*----------------------------------------------------------------*01335006
013360*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEAR TABLE       01336006
013370*----------------------------------------------------------------*01337006
013380     EXEC SQL                                                     01338006
013390         INCLUDE TMDSEAR                                          01339006
013400     END-EXEC.                                                    01340006
013410                                                                  01341006
013420*----------------------------------------------------------------*01342006
013430*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEDP TABLE       01343006
013440*----------------------------------------------------------------*01344006
013450     EXEC SQL                                                     01345006
013460         INCLUDE TMDSEDP                                          01346006
013470     END-EXEC.                                                    01347006
013480                                                                  01348006
013490*----------------------------------------------------------------*01349006
013500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STORE ZONE TABLE   01350006
013510*----------------------------------------------------------------*01351006
013520     EXEC SQL                                                     01352006
013530         INCLUDE TSTRZN                                           01353006
013540     END-EXEC.                                                    01354006
013550                                                                  01355006
013560*----------------------------------------------------------------*01356006
013570*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL PRINT DATA  *01357006
013580*  TABLE                                                         *01358006
013590*----------------------------------------------------------------*01359006
013600     EXEC SQL                                                     01360006
013610         INCLUDE TLBPTDA                                          01361006
013620     END-EXEC.                                                    01362006
013630                                                                  01363006
013640*----------------------------------------------------------------*01364006
013650*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VIRTUAL LABEL     *01365006
013660*  TABLE                                                         *01366006
013670*----------------------------------------------------------------*01367006
013680     EXEC SQL                                                     01368006
013690         INCLUDE TLBVRDA                                          01369006
013700     END-EXEC.                                                    01370006
013710                                                                  01371006
013720*----------------------------------------------------------------*01372006
013730*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01373006
013740*----------------------------------------------------------------*01374006
013750     EXEC SQL                                                     01375006
013760         INCLUDE TVHTRIP                                          01376006
013770     END-EXEC.                                                    01377006
013780                                                                  01378006
013790*----------------------------------------------------------------*01379006
013800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01380006
013810*----------------------------------------------------------------*01381006
013820     EXEC SQL                                                     01382006
013830         INCLUDE TSHIPMT                                          01383006
013840     END-EXEC.                                                    01384006
013850                                                                  01385006
013860*----------------------------------------------------------------*01386006
013870*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01387006
013880*----------------------------------------------------------------*01388006
013890     EXEC SQL                                                     01389006
013900         INCLUDE TSHPTPO                                          01390006
013910     END-EXEC.                                                    01391006
013920                                                                  01392006
013930*----------------------------------------------------------------*01393006
013940*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01394006
013950*----------------------------------------------------------------*01395006
013960     EXEC SQL                                                     01396006
013970         INCLUDE TRECEIV                                          01397006
013980     END-EXEC.                                                    01398006
013990                                                                  01399006
014000*----------------------------------------------------------------*01400006
014010*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01401006
014020*----------------------------------------------------------------*01402006
014030     EXEC SQL                                                     01403006
014040         INCLUDE TPKSLIP                                          01404006
014050     END-EXEC.                                                    01405006
014060                                                                  01406006
014070*----------------------------------------------------------------*01407006
014080*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01408006
014090*----------------------------------------------------------------*01409006
014100     EXEC SQL                                                     01410006
014110         INCLUDE TRECITM                                          01411006
014120     END-EXEC.                                                    01412006
014130                                                                  01413006
014140*----------------------------------------------------------------*01414006
014150*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01415006
014160*----------------------------------------------------------------*01416006
014170     EXEC SQL                                                     01417006
014180         INCLUDE TRECDIS                                          01418006
014190     END-EXEC.                                                    01419006
014200                                                                  01420006
014210*----------------------------------------------------------------*01421006
014220*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01422006
014230*----------------------------------------------------------------*01423006
014240     EXEC SQL                                                     01424006
014250         INCLUDE TPURITM                                          01425006
014260     END-EXEC.                                                    01426006
014270                                                                  01427006
014280*----------------------------------------------------------------*01428006
014290*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01429006
014300*----------------------------------------------------------------*01430006
014310     EXEC SQL                                                     01431006
014320         INCLUDE TVNDDPT                                          01432006
014330     END-EXEC.                                                    01433006
014340                                                                  01434006
014350*----------------------------------------------------------------*01435006
014360*  DCLGEN LAYOUT AND COBOL DECLARATION FOR SEASONAL SET TABLE    *01436006
014370*----------------------------------------------------------------*01437006
014380     EXEC SQL                                                     01438006
014390         INCLUDE TSEASET                                          01439006
014400     END-EXEC.                                                    01440006
014410                                                                  01441006
014420*----------------------------------------------------------------*01442006
014430*  DCLGEN LAYOUT AND COBOL DECLARATION FOR MESSAGE TABLE         *01443006
014440*----------------------------------------------------------------*01444006
014450     EXEC SQL                                                     01445006
014460         INCLUDE TLBVRMG                                          01446006
014470     END-EXEC.                                                    01447006
014480                                                                  01448006
014490*----------------------------------------------------------------*01449006
014500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR CARTON/LABEL CROSS REF*01450006
014510*----------------------------------------------------------------*01451006
014520     EXEC SQL                                                     01452006
014530         INCLUDE TSULBXF                                          01453006
014540     END-EXEC.                                                    01454006
014550                                                                  01455006
014560*----------------------------------------------------------------*01456006
014570*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01457006
014580*----------------------------------------------------------------*01458006
014590     EXEC SQL                                                     01459006
014600         INCLUDE TDISTHD                                          01460006
014610     END-EXEC.                                                    01461006
014620                                                                  01462006
014630*----------------------------------------------------------------*01463006
014640*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01464006
014650*----------------------------------------------------------------*01465006
014660     EXEC SQL                                                     01466006
014670         INCLUDE TP2LMOD                                          01467006
014680     END-EXEC.                                                    01468006
014690                                                                  01469006
014700*----------------------------------------------------------------*01470006
014710*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01471006
014720*----------------------------------------------------------------*01472006
014730     EXEC SQL                                                     01473006
014740         INCLUDE TCOCNTL                                          01474006
014750     END-EXEC.                                                    01475006
014760                                                                  01476006
014770*----------------------------------------------------------------*01477006
014780*  DCLGEN LAYOUT AND COBOL DECLARATION                           *01478006
014790*----------------------------------------------------------------*01479006
014800     EXEC SQL                                                     01480006
014810         INCLUDE TKRPRPM                                          01481006
014820     END-EXEC.                                                    01482006
014830                                                                  01483006
014840*----------------------------------------------------------------*01484006
014850*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND SHIPT CARTON         01485006
014860*   (SUT_OTBND_CART)                                             *01486006
014870*----------------------------------------------------------------*01487006
014880     EXEC SQL                                                     01488006
014890         INCLUDE SUT00024                                         01489006
014900     END-EXEC.                                                    01490006
014910                                                                  01491006
014920* JAK WR41309 - ADD DCLGEN FOR SUT00094                           01492006
014930*---------------------------------------------------------------* 01493006
014940* DCLGEN FOR SUT_PRC_MSG_CNTL                                     01494006
014950*---------------------------------------------------------------* 01495006
014960     EXEC SQL                                                     01496006
014970         INCLUDE SUT00094                                         01497006
014980     END-EXEC.                                                    01498006
014990* JAK WR41309 - END                                               01499006
015000                                                                  01500006
015010*----------------------------------------------------------------*01501006
015020*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND SHIPT CARTON UPC     01502006
015030*   (SUT_OTBND_UPC)                                             * 01503006
015040*----------------------------------------------------------------*01504006
015050     EXEC SQL                                                     01505006
015060         INCLUDE SUT00028                                         01506006
015070     END-EXEC.                                                    01507006
015080                                                                  01508006
015090*----------------------------------------------------------------*01509006
015100*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND LOCATION TABLE       01510006
015110*   (SUT_OTBND_LOC)                                             * 01511006
015120*----------------------------------------------------------------*01512006
015130     EXEC SQL                                                     01513006
015140         INCLUDE SUT00027                                         01514006
015150     END-EXEC.                                                    01515006
015160                                                                  01516006
015170*----------------------------------------------------------------*01517006
015180*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND VENDOR  TABLE        01518006
015190*   (SUT_OTBND_VND)                                             * 01519006
015200*----------------------------------------------------------------*01520006
015210     EXEC SQL                                                     01521006
015220         INCLUDE SUT00026                                         01522006
015230     END-EXEC.                                                    01523006
015240                                                                  01524006
015250*---------------------------------------------------------------* 01525006
015260*      -TROUBLE NOTIFICATION TABLE                              * 01526006
015270*---------------------------------------------------------------* 01527006
015280     EXEC SQL                                                     01528006
015290          INCLUDE TTRBNTF                                         01529006
015300     END-EXEC.                                                    01530006
015310                                                                  01531006
015320                                                                  01532006
015330*---------------------------------------------------------------* 01533006
015340*      -TROUBLE REASON CODES TABLE                              * 01534006
015350*---------------------------------------------------------------* 01535006
015360     EXEC SQL                                                     01536006
015370          INCLUDE TTRBRSN                                         01537006
015380     END-EXEC.                                                    01538006
015390                                                                  01539006
015400*---------------------------------------------------------------* 01540006
015410*      -TROUBLE REASON CODES TABLE  - PROGRAM ID LEVEL          * 01541006
015420*---------------------------------------------------------------* 01542006
015430     EXEC SQL                                                     01543006
015440          INCLUDE TTRBRCN                                         01544006
015450     END-EXEC.                                                    01545006
015460                                                                  01546006
015470*---------------------------------------------------------------* 01547006
015480*   QC -PO AUDIT REQUEST TABLE                                  * 01548006
015490*---------------------------------------------------------------* 01549006
015500     EXEC SQL                                                     01550006
015510          INCLUDE SUT00015                                        01551006
015520     END-EXEC.                                                    01552006
015530                                                                  01553006
015540*---------------------------------------------------------------* 01554006
015550* CT 11/06/08 BEGIN                                             * 01555006
015560*   SUT_PNA_STA                                                 * 01556006
015570*---------------------------------------------------------------* 01557006
015580     EXEC SQL                                                     01558006
015590          INCLUDE SUT00107                                        01559006
015600     END-EXEC.                                                    01560006
015610                                                                  01561006
015620*---------------------------------------------------------------* 01562006
015630*   SUT_PNA_STA_DIVERT                                          * 01563006
015640*---------------------------------------------------------------* 01564006
015650     EXEC SQL                                                     01565006
015660          INCLUDE SUT00108                                        01566006
015670     END-EXEC.                                                    01567006
015680                                                                  01568006
015690*---------------------------------------------------------------* 01569006
015700*   SUT_PNA_STA_DOOR                                            * 01570006
015710*---------------------------------------------------------------* 01571006
015720     EXEC SQL                                                     01572006
015730          INCLUDE SUT00109                                        01573006
015740     END-EXEC.                                                    01574006
015750                                                                  01575006
015760* CT 11/06/08 END                                               * 01576006
015770*---------------------------------------------------------------* 01577006
015780*   TRIP STATUS TABLE                                           * 01578006
015790*---------------------------------------------------------------* 01579006
015800     EXEC SQL                                                     01580006
015810          INCLUDE TTRIPST                                         01581006
015820     END-EXEC.                                                    01582006
015830                                                                  01583006
015840*---------------------------------------------------------------* 01584006
015850*   OUTBOUND PACK TABLE (SUT_OTBND_PK)                          * 01585006
015860*---------------------------------------------------------------* 01586006
015870     EXEC SQL                                                     01587006
015880          INCLUDE SUT00041                                        01588006
015890     END-EXEC.                                                    01589006
015900                                                                  01590006
015910*---------------------------------------------------------------* 01591006
015920*   PO PREPACK TABLE (TPOPRPK)                                  * 01592006
015930*---------------------------------------------------------------* 01593006
015940     EXEC SQL                                                     01594006
015950          INCLUDE TPOPRPK                                         01595006
015960     END-EXEC.                                                    01596006
015970                                                                  01597006
015980*----------------------------------------------------------------*01598006
015990* DCLGEN FOR EAS MDSE TAG LOOKUP  (SFT_EAS_TG_MDSE)              *01599006
016000*----------------------------------------------------------------*01600006
016010     EXEC SQL                                                     01601006
016020          INCLUDE SFT00000                                        01602006
016030     END-EXEC.                                                    01603006
016040                                                                  01604006
016050*----------------------------------------------------------------*01605006
016060* DC DOOR TABLE                                                  *01606006
016070*----------------------------------------------------------------*01607006
016080     EXEC SQL                                                     01608006
016090          INCLUDE TCNDCDR                                         01609006
016100     END-EXEC.                                                    01610006
016110                                                                  01611006
016120*----------------------------------------------------------------*01612006
016130* DC DOOR TO STORE TABLE                                         *01613006
016140*----------------------------------------------------------------*01614006
016150     EXEC SQL                                                     01615006
016160          INCLUDE TCNDRST                                         01616006
016170     END-EXEC.                                                    01617006
016180                                                                  01618006
016190*CLP 07/06/2015 - START                                           01619008
016200*----------------------------------------------------------------*01620006
016210* SKU TABLE (XLT_SKU)                                             01621006
016220*----------------------------------------------------------------*01622006
016230     EXEC SQL                                                     01623006
016240          INCLUDE XLT00003                                        01624006
016250     END-EXEC.                                                    01625006
016260                                                                  01626006
016270*----------------------------------------------------------------*01627006
016280* VENDOR STYLE TABLE (XLT_VND_STYL)                               01628006
016290*----------------------------------------------------------------*01629006
016300     EXEC SQL                                                     01630006
016310          INCLUDE XLT00004                                        01631006
016320     END-EXEC.                                                    01632006
016330                                                                  01633006
016340*----------------------------------------------------------------*01634006
016350* BRAND TABLE (XLT_BRND)                                          01635006
016360*----------------------------------------------------------------*01636006
016370     EXEC SQL                                                     01637006
016380          INCLUDE XLT00043                                        01638006
016390     END-EXEC.                                                    01639006
016400                                                                  01640006
016410*CLP 07/06/2015 - END                                             01641008
016420*----------------------------------------------------------------*01642006
016430*    DB2 DCLGEN FOR THE WST_INTGRTN_TYP TABLE                     01643006
016440*----------------------------------------------------------------*01644006
016450     EXEC SQL                                                     01645006
016460          INCLUDE WST00008                                        01646006
016470     END-EXEC.                                                    01647006
016480/                                                                 01648006
016490*----------------------------------------------------------------*01649006
016500*    DB2 DCLGEN FOR THE WST_ATTR_DEFN TABLE                       01650006
016510*----------------------------------------------------------------*01651006
016520     EXEC SQL                                                     01652006
016530          INCLUDE WST00009                                        01653006
016540     END-EXEC.                                                    01654006
016550/                                                                 01655006
016560*----------------------------------------------------------------*01656006
016570*    DB2 DCLGEN FOR THE WST_ATTR_ELEM TABLE                       01657006
016580*----------------------------------------------------------------*01658006
016590     EXEC SQL                                                     01659006
016600          INCLUDE WST00010                                        01660006
016610     END-EXEC.                                                    01661006
016620* PB 06/07/2010 BEG                                               01662006
016630*                                                                 01663006
016640*----------------------------------------------------------------*01664006
016650*    DB2 DCLGEN FOR THE SUT_TRLR_RPLN_CART TABLE                  01665006
016660*----------------------------------------------------------------*01666006
016670     EXEC SQL                                                     01667006
016680         INCLUDE SUT00113                                         01668006
016690     END-EXEC.                                                    01669006
016700*                                                                 01670006
016710* PB 06/07/2010 END                                               01671006
016720/                                                                 01672006
016730*----------------------------------------------------------------*01673006
016740*  COMMUNICATIONS AREA FOR DB2                                    01674006
016750*----------------------------------------------------------------*01675006
016760     EXEC SQL                                                     01676006
016770         INCLUDE SQLCA                                            01677006
016780     END-EXEC.                                                    01678006
016790*----------------------------------------------------------------*01679006
016800*  CURSOR TO SELECT THE LINE(S), LINE NUMBER, PREPACK ID        * 01680006
016810*  AND SHIPPED QUANTITY                                         * 01681006
016820*---------------------------------------------------------------* 01682006
016830                                                                  01683006
016840                                                                  01684006
016850     EXEC SQL                                                     01685006
016860          DECLARE PREPK-CSR CURSOR FOR                            01686006
016870          SELECT A.TRN_NBR                                        01687006
016880                ,D.ORD_LNE_NBR                                    01688006
016890                ,D.PREPK_ID                                       01689006
016900                ,D.PREPK_RATO_QTY                                 01690006
016910                ,A.SHPD_QTY                                       01691006
016920                ,E.PREPK_LNE_PRC_CDE                              01692006
016930                ,E.UCC128_DAT_USG_CDE                             01693006
016940                ,E.PRC_AREA_MODU_ID                               01694006
016950          FROM   TSHUUPC A                                        01695006
016960               , TINPKSU B                                        01696006
016970               , TPKSLIP C                                        01697006
016980               , TRECITM D                                        01698006
016990               , TDISTHD E                                        01699006
017000          WHERE A.SHIPT_UNT_ID = :DK-CTN                          01700006
017010          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    01701006
017020          AND  B.PO_NBR       = C.PO_NBR                          01702006
017030          AND  B.SEQ_NBR      = C.SEQ_NBR                         01703006
017040          AND  C.VER_STAT_CDE = 'A'                               01704006
017050          AND  C.PO_NBR       = D.ORD_NBR                         01705006
017060          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     01706006
017070          AND  C.REC_SEQ_NBR  = :PV-RCVR-SEQ-NBR                  01707006
017080          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     01708006
017090          AND  E.ORD_NBR      = C.PO_NBR                          01709006
017100          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     01710006
017110          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     01711006
017120          AND  E.TOT_CART_CNT > 0                                 01712006
017130     END-EXEC                                                     01713006
017140                                                                  01714006
017150*---------------------------------------------------------------* 01715006
017160*  CURSOR TO SELECT THE BARCODES FOR A CARTON, USED FOR A REPRINT 01716006
017170*---------------------------------------------------------------* 01717006
017180     EXEC SQL                                                     01718006
017190        DECLARE REPRINT-CSR CURSOR FOR                            01719006
017200        SELECT   BRCDE_NBR                                        01720006
017210        FROM TSULBXF A                                            01721006
017220        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                01722006
017230          AND  A.STAT_CDE              =   'A'                    01723006
017240     END-EXEC                                                     01724006
017250                                                                  01725006
017260*---------------------------------------------------------------* 01726006
017270*  CURSOR TO SELECT THE LINE(S) AND NUMBER OF UNITS WITHIN A    * 01727006
017280*  CARTON                                                       * 01728006
017290*---------------------------------------------------------------* 01729006
017300     EXEC SQL                                                     01730006
017310          DECLARE UNITS-CSR CURSOR FOR                            01731006
017320          SELECT SHPD_QTY                                         01732006
017330                ,TRN_LNE_NBR                                      01733006
017340                ,UCC128_DAT_USG_CDE                               01734006
017350                ,PRC_AREA_MODU_ID                                 01735006
017360          FROM   TSHUUPC A                                        01736006
017370                ,TDISTHD B                                        01737006
017380          WHERE SHIPT_UNT_ID  = :DK-CTN                           01738006
017390            AND A.TRN_NBR     =  B.ORD_NBR                        01739006
017400            AND A.TRN_LNE_NBR =  B.ORD_LNE_NBR                    01740006
017410            AND B.RCVR_SEQ_NBR = :PV-RCVR-SEQ-NBR                 01741006
017420            AND B.TOT_CART_CNT > 0                                01742006
017430          ORDER BY 2                                              01743006
017440     END-EXEC                                                     01744006
017450                                                                  01745006
017460                                                                  01746006
017470     EXEC SQL                                                     01747006
017480        DECLARE VRTL-LBL-PRT-CSR CURSOR FOR                       01748006
017490        SELECT   CART_LBL_TYP_CDE                                 01749006
017500                ,PREPK_PRCG_LNE_NBR                               01750006
017510                ,INPK_UNT_QTY                                     01751006
017520                ,PREPK_RATO_QTY                                   01752006
017530                ,DEST_OPER_UNT_ID                                 01753006
017540                ,CSE_PK_QTY                                       01754006
017550                ,ODD_CART_IND                                     01755006
017560                ,INPK_CNVYB_IND                                   01756006
017570                ,LBL_TYP_LBL_SEQ_ID                               01757006
017580                ,LBL_TYP_TOT_QTY                                  01758006
017590                ,BRCDE_NBR                                        01759006
017600                ,STR_ZN_ID                                        01760006
017610                ,MODU_DESC                                        01761006
017620                ,ITM_NBR                                          01762006
017630                ,DEPT_DESC                                        01763006
017640                ,MAJ_CL_DESC                                      01764006
017650                ,SEASET_NM                                        01765006
017660                ,FIXT_ID                                          01766006
017670                ,LBL_TYP_CDE                                      01767006
017680                ,PRNT_CART_SEQ_ID                                 01768006
017690                ,STRG_AREA_CDE                                    01769006
017700                ,OTPK_UNT_QTY                                     01770006
017710                ,EAS_TAG_IND                                      01771006
017720                ,DOOR_ID                                          01772006
017730                ,HNG_FOLD_SEQ_NBR                                 01773006
017740                ,MDSE_PGM_DESC                                    01774006
017750*CLP 07/06/2015 START                                             01775008
017760                ,LBL_MSG_TXT                                      01776008
017770*CLP 07/06/2015 END                                               01777008
017780        FROM TLBVRDA A                                            01778006
017790        WHERE  A.PO_NBR                =   :DK-PO                 01779006
017800          AND  A.RCVR_SEQ_NBR          =   :DK-REC-SEQ-NBR        01780006
017810          AND  A.PO_LNE_NBR            =   :DK-PO-LNE-NBR         01781006
017820          AND  A.PREPK_ID              =   :DK-PREPK-ID           01782006
017830          AND  A.OTPK_UNT_QTY          =   :DK-OUTER-QTY          01783006
017840          AND  A.LBL_ASG_IND           =   'N'                    01784006
017850          AND  A.PRNT_CART_SEQ_ID      =   :LBVRDA-LBL-ASG-SEQ-NBR01785006
017860        ORDER BY LBL_TYP_LBL_SEQ_ID                               01786006
017870     END-EXEC                                                     01787006
017880*---------------------------------------------------------------* 01788006
017890*  CURSOR TO DETERMINE ODD UNITS IN A PREPACK                   * 01789006
017900*  CARTON                                                       * 01790006
017910*---------------------------------------------------------------* 01791006
017920     EXEC SQL                                                     01792006
017930          DECLARE ODD-UNITS-CSR CURSOR FOR                        01793006
017940           SELECT 'A',                                            01794006
017950                  TRN_LNE_NBR,                                    01795006
017960                  0                                               01796006
017970           FROM TSHUUPC                                           01797006
017980           WHERE SHIPT_UNT_ID = :DK-CTN                           01798006
017990           UNION                                                  01799006
018000           SELECT 'B', B.ORD_LNE_NBR, A.PREPK_ID                  01800006
018010           FROM  TRECITM A                                        01801006
018020               , TSHUUPC                                          01802006
018030               , TRECITM B                                        01803006
018040           WHERE A.ORD_NBR        = TRN_NBR                       01804006
018050               AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR               01805006
018060               AND A.ORD_LNE_NBR  = TRN_LNE_NBR                   01806006
018070               AND SHIPT_UNT_ID   = :DK-CTN                       01807006
018080               AND B.ORD_NBR      = A.ORD_NBR                     01808006
018090               AND B.REC_SEQ_NBR  = A.REC_SEQ_NBR                 01809006
018100               AND B.PREPK_ID     = A.PREPK_ID                    01810006
018110           ORDER BY 2, 1                                          01811006
018120**         ORDER BY 2, 3, 1                                       01812006
018130**GB 3/5/02  REMOVE  AND A.ORD_NBR      = :DK-PO                  01813006
018140     END-EXEC                                                     01814006
018150*---------------------------------------------------------------* 01815006
018160*  CURSOR TO DETERMINE MERCHANDISE PRESENTATION                 * 01816006
018170*  HANG, FOLD OR MIXED                                          * 01817006
018180*---------------------------------------------------------------* 01818006
018190     EXEC SQL                                                     01819006
018200          DECLARE HANG_FOLD_CSR CURSOR FOR                        01820006
018210           SELECT DISTINCT(UPC_NBR)                               01821006
018220                , TRN_LNE_NBR                                     01822006
018230           FROM TSHUUPC                                           01823006
018240           WHERE SHIPT_UNT_ID = :DK-CTN                           01824006
018250     END-EXEC                                                     01825006
018260*---------------------------------------------------------------* 01826006
018270*  CURSOR TO DETERMINE IF ECOMM UPC NEEDS WEIGHTS MEASURES      * 01827006
018280*  CHECK                                                        * 01828006
018290*---------------------------------------------------------------* 01829006
018300     EXEC SQL                                                     01830006
018310          DECLARE WGHTS_MSRS_CSR CURSOR FOR                       01831006
018320           SELECT DISTINCT(UPC_NBR)                               01832006
018330           FROM TSHUUPC                                           01833006
018340           WHERE SHIPT_UNT_ID = :DK-CTN                           01834006
018350     END-EXEC                                                     01835006
018360*---------------------------------------------------------------* 01836006
018370*  CURSOR TO SELECT UPC FOR EACH CARTON TO POPULATE             * 01837006
018380*  THE OUTBOUND CARTON UPC TABLE                                * 01838006
018390*---------------------------------------------------------------* 01839006
018400     EXEC SQL                                                     01840006
018410          DECLARE UPC_UNLOAD_CSR CURSOR FOR                       01841006
018420           SELECT DISTINCT(UPC_NBR)                               01842006
018430                , TRN_NBR                                         01843006
018440                , TRN_LNE_NBR                                     01844006
018450                , TRN_TYP_CDE                                     01845006
018460                , SHPD_QTY                                        01846006
018470           FROM TSHUUPC                                           01847006
018480           WHERE SHIPT_UNT_ID = :DK-CTN                           01848006
018490     END-EXEC                                                     01849006
018500***************************************************************** 01850006
018510 LINKAGE SECTION.                                                 01851006
018520******************************************************************01852006
018530 01  DFHCOMMAREA.                                                 01853006
018540     05  FILLER                       OCCURS 1 TO 4072 TIMES      01854006
018550                                      DEPENDING ON EIBCALEN.      01855006
018560         10  FILLER                   PIC X.                      01856006
018570                                                                  01857006
018580******************************************************************01858006
018590 PROCEDURE DIVISION.                                              01859006
018600******************************************************************01860006
018610 0000-PROGRAM-MAINLINE.                                           01861006
018620                                                                  01862006
018630     MOVE DFHCOMMAREA TO CA-COMMAREA.                             01863006
018640                                                                  01864006
018650* * * WHEN COMING BACK FROM PCKRF901                              01865006
018660     IF EIBTRNID = 'G901'                                         01866006
018670         MOVE DFHCOMMAREA          TO PC056-COMMAREA              01867006
018680         MOVE PC056-HOST-SAVE-AREA TO SU001-COMMON-DATA           01868006
018690     END-IF                                                       01869006
018700                                                                  01870006
018710     EXEC CICS                                                    01871006
018720         ASSIGN USERID  (SU001-USER-ID)                           01872006
018730                RESP    (PV-CICS-RESPONSE)                        01873006
018740                NETNAME (SU001-SESSION-ID)                        01874006
018750     END-EXEC.                                                    01875006
018760                                                                  01876006
018770     EXEC CICS                                                    01877006
018780         ASSIGN                                                   01878006
018790             APPLID(PV-SYSTEM-ID)                                 01879006
018800     END-EXEC.                                                    01880006
018820                                                                  01882006
018830     EVALUATE TRUE                                                01883006
018840         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01884006
018850             MOVE  SU001-USER-ID    TO  SU001-USER-ID-USE         01885006
018860         WHEN OTHER                                               01886006
018870            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       01887006
018880            MOVE 'SUKRF502 - UNABLE TO ASSIGN USER-ID'            01888006
018890              TO DP013-MESSAGE-TEXT (1)                           01889006
018900            SET DP013-LOGIC-ABEND        TO TRUE                  01890006
018910            SET DP013-ROLLBACK           TO TRUE                  01891006
018920            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                01892006
018930     END-EVALUATE.                                                01893006
018940                                                                  01894006
018950     EVALUATE TRUE                                                01895006
018960         WHEN EIBCALEN = ZERO                                     01896006
018970             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    01897006
018980             PERFORM 8300-RETURN                                  01898006
018990                                                                  01899006
019000****************************************************************  01900006
019010* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        01901006
019020****************************************************************  01902006
019030         WHEN EIBTRNID = 'Z278'                                   01903006
019040             MOVE DFHCOMMAREA          TO PC192-COMMAREA          01904006
019050             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             01905006
019060             SET SU001-PROCESS-SCREEN  TO TRUE                    01906006
019070             INITIALIZE PV-PROGRAM-DATA                           01907006
019080             MOVE SPACES TO APORCVRO                              01908006
019090             MOVE SPACES TO ASTRO                                 01909006
019100             MOVE SPACES TO ALNEO                                 01910006
019110             MOVE SPACES TO AITEMO                                01911006
019120             MOVE SPACES TO ACARTNO                               01912006
019130             MOVE -1     TO ACARTNL                               01913006
019140             PERFORM 8000-SEND-MAP                                01914006
019150             PERFORM 8200-RETURN-TRANID                           01915006
019160                                                                  01916006
019170         WHEN SU001-INITIALIZE-SCREEN                             01917006
019180         WHEN EIBAID = DFHCLEAR                                   01918006
019190             SET SU001-PROCESS-SCREEN TO TRUE                     01919006
019200             PERFORM 1000-INITIALIZE                              01920006
019210             MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM   01921006
019220             PERFORM 8000-SEND-MAP                                01922006
019230             PERFORM 8200-RETURN-TRANID                           01923006
019240                                                                  01924006
019250         WHEN EIBAID = DFHENTER                                   01925006
019260             IF PV-TEST-CICS OR PV-QA-CICS                        01926006
019270                EXEC SQL                                          01927006
019280                    SET :PV-BEGIN-TIME = CURRENT TIMESTAMP        01928006
019290                END-EXEC                                          01929006
019300             END-IF                                               01930006
019310                                                                  01931006
019320             MOVE  SPACES             TO SU001-DUPLICATE-IND      01932006
019330                                         SU001-REPRINT-IND        01933006
019340                                         SU001-LBL-REPRINT-IND    01934006
019350             SET PS-VALID-INPUT                                   01935006
019360                 PS-VALID-CHECK-DIGIT                             01936006
019370                 PS-DONT-DISPLAY-SUKRF530 TO TRUE                 01937006
019380             PERFORM 2000-PROCESS-SCREEN-FIELDS                   01938006
019390                                                                  01939006
019400             IF PS-VALID-INPUT AND PS-DONT-DISPLAY-SUKRF530       01940006
019410                 MOVE -1                 TO ACARTNL               01941006
019420                 IF  SU001-BATCH-PRINTER OR                       01942006
019430                     SU001-PRINT-AND-PEEL                         01943006
019440                     MOVE  PC-FKEYS  TO  AFKEYO                   01944006
019450                 ELSE                                             01945006
019460                     MOVE  PC-F5-AUDIT-FKEY TO AFKEYO             01946006
019470                 END-IF                                           01947006
019480                 MOVE PC-FKEY2       TO AFKEY2O                   01948006
019490                 MOVE SU001-CARTON   TO PV-CTN                    01949006
019500                                        PV-CTN-N                  01950006
019510                 MOVE SU001-PO       TO PV-PO-N                   01951006
019520                                        PV-PO-OUT                 01952006
019530                 IF SU044-NEW-REC-SEQ-NBR > 0                     01953006
019540                    MOVE SU044-NEW-REC-SEQ-NBR TO PV-RCVR-OUT     01954006
019550                    MOVE PV-PO-RCVR            TO APORCVRO        01955006
019560                 ELSE                                             01956006
019570                    MOVE SU001-RCVR-SEQ-NBR TO PV-RCVR-OUT        01957006
019580                    MOVE PV-PO-RCVR         TO APORCVRO           01958006
019590                 END-IF                                           01959006
019600                 IF SU001-P2L-LBL-CREATED                         01960006
019610                    MOVE SPACES      TO PV-STORE-X                01961006
019620                    MOVE 'P2L'       TO PV-STORE-X-4              01962006
019630                    MOVE PV-STORE-X  TO ASTRO                     01963006
019640                 ELSE                                             01964006
019650                    MOVE SU001-STORE    TO PV-STORE-N             01965006
019660                    MOVE PV-STORE       TO ASTRO                  01966006
019670                 END-IF                                           01967006
019680                                                                  01968006
019690                 EVALUATE TRUE                                    01969006
019700                    WHEN SU001-PREPK-ID > 0                       01970006
019710                       MOVE 'PCK:'      TO ALNEHDGO               01971006
019720                       MOVE SU001-PREPK-ID TO PV-PO-LINE-N        01972006
019730                    WHEN SU001-MULTI-LINE                         01973006
019740                       MOVE PC-MULTI-LINE TO PV-PO-LINE-OUT       01974006
019750                       MOVE  'MLT ITMS'   TO  PV-SKU-OUT          01975006
019760                    WHEN  SU001-NO-LINE                           01976006
019770                        MOVE PC-NOLNE-LINE TO PV-PO-LINE-OUT      01977006
019780                    WHEN  OTHER                                   01978006
019790                        CONTINUE                                  01979006
019800                 END-EVALUATE                                     01980006
019810                 MOVE PV-SKU-OUT        TO AITEMO                 01981006
019820                 MOVE PV-PO-LINE-OUT    TO ALNEO                  01982006
019830                 MOVE PV-CTN-X          TO ACARTNO                01983006
019840                                                                  01984006
019850                 IF PV-TEST-CICS OR PV-QA-CICS                    01985006
019860                    EXEC SQL                                      01986006
019870                       SET :PV-END-TIME = CURRENT TIMESTAMP       01987006
019880                    END-EXEC                                      01988006
019890                    MOVE SPACES TO PV-CICS-MSG-AREA-A             01989006
019900                    STRING 'SUKRF502 BEG TIME '  DELIMITED BY SIZE01990006
019910                         PV-BEGIN-TIME           DELIMITED BY SIZE01991006
019920                                           INTO PV-CICS-MSG-AREA-B01992006
019930                    MOVE LENGTH OF PV-CICS-MSG-AREA-A             01993006
019940                                           TO PV-COMMAREA-LENGTH  01994006
019950                    PERFORM 9998-WRITE-TO-CSSL                    01995006
019960                                                                  01996006
019970                    MOVE SPACES TO PV-CICS-MSG-AREA-A             01997006
019980                    STRING  'SUKRF502 END TIME ' DELIMITED BY SIZE01998006
019990                             PV-END-TIME         DELIMITED BY SIZE01999006
020000                           'NO XCTL '            DELIMITED BY SIZE02000006
020010                                        INTO PV-CICS-MSG-AREA-B   02001006
020020                    MOVE LENGTH OF PV-CICS-MSG-AREA-A             02002006
020030                                             TO PV-COMMAREA-LENGTH02003006
020040                    PERFORM 9998-WRITE-TO-CSSL                    02004006
020050                 END-IF                                           02005006
020060                 PERFORM 8000-SEND-MAP                            02006006
020070                 PERFORM 8200-RETURN-TRANID                       02007006
020080             ELSE                                                 02008006
020090*************                                                     02009006
020100             IF PS-RECITM-VERIFIED-LINES-YES                      02010006
020110                MOVE PC-VERFD-LINES-IN-CRTN TO AMSGLNO            02011006
020120                MOVE -1  TO ACARTNL                               02012006
020130                MOVE SU001-PO       TO PV-PO-N                    02013006
020140                                       PV-PO-OUT                  02014006
020150                MOVE SU001-RCVR-SEQ-NBR TO PV-RCVR-OUT            02015006
020160                MOVE PV-PO-RCVR         TO APORCVRO               02016006
020170                PERFORM 8100-SEND-DATA-ONLY                       02017006
020180                PERFORM 8200-RETURN-TRANID                        02018006
020190             ELSE                                                 02019006
020200             IF PS-DUPLICATE-FOUND                                02020006
020210                 MOVE PC-SU-DUPLICATE-PGM                         02021006
020220                                TO PV-TRANSFER-PROGRAM            02022006
020230                 PERFORM 4000-XCTL-LRT-MENU                       02023006
020240             ELSE                                                 02024006
020250             IF PS-WRONG-FCLTY                                    02025006
020260                 MOVE PV-STORE TO SU001-STORE                     02026006
020270                 MOVE PV-CTN-N TO SU001-CARTON                    02027006
020280                 MOVE PC-SU-WRONG-FCLTY-PGM                       02028006
020290                               TO PV-TRANSFER-PROGRAM             02029006
020300                 PERFORM 4000-XCTL-LRT-MENU                       02030006
020310             ELSE                                                 02031006
020320             IF PS-NOT-FOUND                                      02032006
020330                 IF PS-INVALID-CHECK-DIGIT                        02033006
020340                     MOVE PC-INVALID-CHECK-DIGIT                  02034006
020350                                     TO AMSGLNO                   02035006
020360                     MOVE -1  TO ACARTNL                          02036006
020370                     PERFORM 8100-SEND-DATA-ONLY                  02037006
020380                     PERFORM 8200-RETURN-TRANID                   02038006
020390                 ELSE                                             02039006
020400                   IF PS-INACTV-CRTN-FND                          02040006
020410                       SET SU001-INACTV-CRTN-MESSAGE TO TRUE      02041006
020420                       MOVE PC-SU-MESSAGE-PGM                     02042006
020430                                      TO PV-TRANSFER-PROGRAM      02043006
020440                       PERFORM 4000-XCTL-LRT-MENU                 02044006
020450                   ELSE                                           02045006
020460*BARCODE FOUND ON TSHPUNT, BUT NOT CREATED BY VENDOR ASN          02046006
020470                       IF PS-INVALID-CRE-SOURCE                   02047006
020480                          MOVE PC-INVALID-BARCODE                 02048006
020490                                       TO AMSGLNO                 02049006
020500                          MOVE -1  TO ACARTNL                     02050006
020510                          PERFORM 8100-SEND-DATA-ONLY             02051006
020520                          PERFORM 8200-RETURN-TRANID              02052006
020530                       ELSE                                       02053006
020540                          IF PS-INACTV-PBS-CARTON-YES             02054006
020550                             MOVE PC-PACK-BY-STORE-ERROR          02055006
020560                                          TO AMSGLNO              02056006
020570                             MOVE -1  TO ACARTNL                  02057006
020580                             PERFORM 8100-SEND-DATA-ONLY          02058006
020590                             PERFORM 8200-RETURN-TRANID           02059006
020600                          ELSE                                    02060006
020610                             MOVE PV-CTN-N TO SU001-CARTON        02061006
020620                             MOVE PC-SU-NOT-FOUND-PGM             02062006
020630                                        TO PV-TRANSFER-PROGRAM    02063006
020640                             PERFORM 4000-XCTL-LRT-MENU           02064006
020650                          END-IF                                  02065006
020660                       END-IF                                     02066006
020670                   END-IF                                         02067006
020680                 END-IF                                           02068006
020690             ELSE                                                 02069006
020700                 IF PS-DISPLAY-SUKRF530                           02070006
020710                     MOVE PC-SU-MESSAGE-PGM                       02071006
020720                                    TO PV-TRANSFER-PROGRAM        02072006
020730                     PERFORM 4000-XCTL-LRT-MENU                   02073006
020740                 ELSE                                             02074006
020750                     MOVE -1  TO ACARTNL                          02075006
020760                     PERFORM 8100-SEND-DATA-ONLY                  02076006
020770                     PERFORM 8200-RETURN-TRANID                   02077006
020780                 END-IF                                           02078006
020790             END-IF                                               02079006
020800             END-IF                                               02080006
020810             END-IF                                               02081006
020820             END-IF                                               02082006
020830             END-IF                                               02083006
020840                                                                  02084006
020850         WHEN EIBAID = DFHPF1                                     02085006
020860              PERFORM 1200-HELP-SCREEN                            02086006
020870                                                                  02087006
020880         WHEN EIBAID = DFHPF3                                     02088006
020890             IF  SU001-ROWS-INSERTED  >  ZERO                     02089006
020900                 MOVE PC-SU-LBL-NEED-PGM  TO PV-TRANSFER-PROGRAM  02090006
020910             ELSE                                                 02091006
020920                 MOVE PC-TRAILER-STOP-PGM TO PV-TRANSFER-PROGRAM  02092006
020930             END-IF                                               02093006
020940             PERFORM 4000-XCTL-LRT-MENU                           02094006
020950                                                                  02095006
020960         WHEN EIBAID = DFHPF4                                     02096006
020970             IF  SU001-BATCH-PRINTER OR                           02097006
020980                 SU001-PRINT-AND-PEEL                             02098006
020990                 SET  SU001-INITIALIZE-SCREEN TO TRUE             02099006
021000                 MOVE PC-SU-LBL-PRT-PGM TO PV-TRANSFER-PROGRAM    02100006
021010                 PERFORM 4000-XCTL-LRT-MENU                       02101006
021020             ELSE                                                 02102006
021030                MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO        02103006
021040                MOVE -1                         TO ACARTNL        02104006
021050                PERFORM 8100-SEND-DATA-ONLY                       02105006
021060                PERFORM 8200-RETURN-TRANID                        02106006
021070             END-IF                                               02107006
021080                                                                  02108006
021090         WHEN EIBAID = DFHPF5                                     02109006
021100             INITIALIZE CA-COMMAREA-CRTN-AUD                      02110006
021110             MOVE PC-SU-CARTON-AUDIT-PGM  TO PV-TRANSFER-PROGRAM  02111006
021120             MOVE SU001-OPER-UNT-ID  TO SU006-OPER-UNT-ID         02112006
021130             MOVE SU001-USER-ID      TO SU006-USERID              02113006
021140             MOVE SU001-COMMON-DATA  TO SU006-HOST-SAVE-AREA      02114006
021150                                                                  02115006
021160             PERFORM 4100-XCTL-CRTN-AUDIT                         02116006
021170                                                                  02117006
021180         WHEN EIBAID = DFHPF8                                     02118006
021310                MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO        02131006
021320                MOVE -1                         TO ACARTNL        02132006
021330                PERFORM 8100-SEND-DATA-ONLY                       02133006
021340                PERFORM 8200-RETURN-TRANID                        02134006
021360                                                                  02136006
021370                                                                  02137006
021380         WHEN EIBAID = DFHPF9                                     02138006
021390             MOVE PC-SU-CARTON-AUDIT-STATUS                       02139006
021400                                          TO PV-TRANSFER-PROGRAM  02140006
021410             PERFORM 4000-XCTL-LRT-MENU                           02141006
021420                                                                  02142006
021430         WHEN EIBAID = DFHPF6                                     02143006
021440             PERFORM 4300-XCTL-TO-PCKRF901                        02144006
021450                                                                  02145006
021460         WHEN OTHER                                               02146006
021470             MOVE -1                         TO ACARTNL           02147006
021480             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           02148006
021490             PERFORM 8100-SEND-DATA-ONLY                          02149006
021500             PERFORM 8200-RETURN-TRANID                           02150006
021510     END-EVALUATE.                                                02151006
021520                                                                  02152006
021530     GOBACK.                                                      02153006
021540                                                                  02154006
021550 0500-CHECK-IF-DC.                                                02155006
021560                                                                  02156006
021570     EXEC SQL                                                     02157006
021580          SELECT LOC_TYP_CDE                                      02158006
021590               , LOC_10_ABBR_NM                                   02159006
021600               , E_BUS_IND                                        02160006
021610          INTO  :XLT00010-LOC-TYP-CDE                             02161006
021620               ,:XLT00010-LOC-10-ABBR-NM                          02162006
021630               ,:XLT00010-E-BUS-IND                               02163006
021640          FROM   XLT_LOC                                          02164006
021650          WHERE  LOC_NBR   = :SHPUNT-DEST-OPER-UNT-ID             02165006
021660     END-EXEC.                                                    02166006
021670                                                                  02167006
021680     EVALUATE TRUE                                                02168006
021690         WHEN SQLCODE = ZERO                                      02169006
021700            IF XLT00010-LOC-TYP-CDE = 'DC'                        02170006
021710              SET PS-OPER-IS-DC TO TRUE                           02171006
021720            ELSE                                                  02172006
021730                IF XLT00010-LOC-TYP-CDE = 'DS'                    02173006
021740                  IF XLT00010-E-BUS-IND = 'Y'                     02174006
021750                     SET PS-OPER-IS-ECOMM-STORE TO TRUE           02175006
021760                  ELSE                                            02176006
021770                     SET PS-OPER-IS-STORE TO TRUE                 02177006
021780                  END-IF                                          02178006
021790                END-IF                                            02179006
021800            END-IF                                                02180006
021810         WHEN SQLCODE = +100                                      02181006
021820         WHEN SQLCODE = -305                                      02182006
021830              CONTINUE                                            02183006
021840         WHEN SQLWARN0 NOT = SPACES                               02184006
021850         WHEN SQLCODE NOT EQUAL ZERO                              02185006
021860             MOVE '0500-CHECK-IF-DC'                              02186006
021870                             TO DP013-PARAGRAPH                   02187006
021880             MOVE 'SUKRF502 - CHECK IF OPER IS DC'                02188006
021890                             TO DP013-MESSAGE-TEXT(1)             02189006
021900             MOVE SHPUNT-DEST-OPER-UNT-ID                         02190006
021910                             TO DP013-MESSAGE-TEXT(2)             02191006
021920             MOVE SQLCA      TO DP013-SQLCA                       02192006
021930             MOVE 'XLT00010' TO DP013-DB2-TABLE-NAME(1)           02193006
021940             SET DP013-DB2-ABEND                                  02194006
021950                             TO TRUE                              02195006
021960             SET DP013-ROLLBACK                                   02196006
021970                             TO TRUE                              02197006
021980             SET DP013-XCTL-DISPLAY-RESTART                       02198006
021990                             TO TRUE                              02199006
022000             PERFORM DP014-0000-PROCESS-ABEND                     02200006
022010     END-EVALUATE.                                                02201006
022020                                                                  02202006
022030 1000-INITIALIZE.                                                 02203006
022040                                                                  02204006
022050     IF  SU001-BATCH-PRINTER OR                                   02205006
022060         SU001-PRINT-AND-PEEL                                     02206006
022070         MOVE  PC-FKEYS  TO  AFKEYO                               02207006
022080     ELSE                                                         02208006
022090         MOVE  PC-F5-AUDIT-FKEY TO AFKEYO                         02209006
022100     END-IF.                                                      02210006
022110     MOVE PC-FKEY2       TO AFKEY2O.                              02211006
022120     MOVE SU001-OWNER-SCAC-ID TO PV-VEH-SCAC                      02212006
022130     MOVE SU001-VEH-NBR       TO PV-VEH-TRLR                      02213006
022140     MOVE PV-SCAC-TRLR        TO ASCACO.                          02214006
022150     EVALUATE TRUE                                                02215006
022160         WHEN SU001-LAST-PROGRAM = PC-SU-TRAILER-PGM              02216006
022170             INITIALIZE PV-PROGRAM-DATA                           02217006
022180             MOVE SPACES TO APORCVRO                              02218006
022190             MOVE SPACES TO ASTRO                                 02219006
022200             MOVE SPACES TO ALNEO                                 02220006
022210             MOVE SPACES TO AITEMO                                02221006
022220             MOVE SPACES TO ACARTNO                               02222006
022230             MOVE -1     TO ACARTNL                               02223006
022240         WHEN SU001-LAST-PROGRAM = PC-SU-DUPLICATE-PGM AND        02224006
022250             SU001-DUPLICATE-IND = PC-Y                           02225006
022260**  DO NOT INSERT ANOTHER ROW INTO THE TSHUNLO TABLE FOR A        02226006
022270**  DUPLICATE SCAN - WR25013                                      02227006
022280**           MOVE SU001-CARTON       TO SHPUNT-SHIPT-UNT-ID       02228006
022290**           PERFORM 2270-INSERT-TSHUNLO                          02229006
022300**  CREATE A DUP CRTN LABEL                                       02230006
022310             SET PS-DUPLICATE-CARTON                              02231006
022320                 PS-REPRINT-DUP      TO TRUE                      02232006
022330             PERFORM 1100-GET-ZONE-DESC                           02233006
022340             PERFORM 7235-GET-OUTER-PACK                          02234006
022350             PERFORM 7230-GET-DEPT-CL-SKU                         02235006
022360             PERFORM 7400-GET-DEPT-NAME                           02236006
022370             PERFORM 5005-PRINT-MESSAGE-LABELS                    02237006
022380             MOVE SU001-CARTON   TO PV-CTN                        02238006
022390                                    PV-CTN-N                      02239006
022400             MOVE SU001-PO       TO PV-PO-N                       02240006
022410                                    PV-PO-OUT                     02241006
022420             MOVE SU001-RCVR-SEQ-NBR                              02242006
022430                                 TO PV-RCVR-OUT                   02243006
022440             MOVE PV-PO-RCVR     TO APORCVRO                      02244006
022450             IF SU001-P2L-LBL-CREATED                             02245006
022460                MOVE SPACES      TO PV-STORE-X                    02246006
022470                MOVE 'P2L'       TO PV-STORE-X-4                  02247006
022480             ELSE                                                 02248006
022490                MOVE SU001-STORE    TO PV-STORE-N                 02249006
022500                MOVE PV-STORE       TO ASTRO                      02250006
022510             END-IF                                               02251006
022520             IF SU001-PREPK-ID > 0                                02252006
022530                MOVE 'PCK:'      TO ALNEHDGO                      02253006
022540                MOVE SU001-PREPK-ID TO PV-PO-LINE-N               02254006
022550             END-IF                                               02255006
022560             MOVE PV-PO-LINE-OUT    TO ALNEO                      02256006
022570             MOVE PV-CTN-X          TO ACARTNO                    02257006
022580             MOVE PV-SKU-OUT        TO AITEMO                     02258006
022590                                                                  02259006
022600         WHEN SU001-LAST-PROGRAM = PC-SU-DUPLICATE-PGM AND        02260006
022610            SU001-DUPLICATE-IND = PC-N AND                        02261006
022620            SU001-LABEL-IND     = PC-Y                            02262006
022630         WHEN SU001-LAST-PROGRAM = PC-SU-AUDIT-STATUS-PGM         02263006
022640         WHEN SU001-LAST-PROGRAM = PC-SU-AUDIT-DEF-PRMPT-PGM      02264006
022650            MOVE SU001-RCVR-SEQ-NBR TO PV-RCVR-SEQ-NBR            02265006
022660            SET  SU001-LBL-REPRINT  TO  TRUE                      02266006
022670            SET  PS-REPRINT-DUP     TO TRUE                       02267006
022680            IF (NOT  SU001-NO-PRINTER)                            02268006
022690               PERFORM 2425-CHECK-VERIFIED-LINES                  02269006
022700               IF PS-RECITM-VERIFIED-LINES-NO                     02270006
022710                MOVE PC-R  TO  LBPTDA-RPRT-IND                    02271006
022720                 IF SU001-PACK-BY-STORE                           02272006
022730                    IF SU001-WRONG-FCLTY                          02273006
022740                       SET PS-MISDIRECT-PACK-BY-STORE TO TRUE     02274006
022750                    ELSE                                          02275006
022760                       SET PS-MISDIRECT-PACK-BY-STORE-NO TO TRUE  02276006
022770                    END-IF                                        02277006
022780                    MOVE SPACES TO SU001-WRONG-FCLTY-IND          02278006
022790                    PERFORM 1100-GET-ZONE-DESC                    02279006
022800                    PERFORM 7235-GET-OUTER-PACK                   02280006
022810                    PERFORM 7230-GET-DEPT-CL-SKU                  02281006
022820                    PERFORM 7400-GET-DEPT-NAME                    02282006
022830                    PERFORM 7210-GET-STORE-INFO                   02283006
022840                    MOVE SU001-PO-LINE-NBR TO PV-PO-LINE-OUT      02284006
022850                    MOVE SU001-CARTON      TO SHPUNT-SHIPT-UNT-ID 02285006
022860*GB 8/15/2004                                                     02286006
022870                   IF SU001-ECOMM-DC-REPURPOSE                    02287006
022880                      PERFORM 5005-PRINT-MESSAGE-LABELS           02288006
022890*SLH 05/06/08 CHANGED END-IF TO AN ELSE                           02289006
022900                   ELSE                                           02290006
022910                   IF PS-MISDIRECT-PACK-BY-STORE-NO               02291006
022920                                                                  02292006
022930                    PERFORM 2265-CHECK-INACTV-PBS                 02293006
022940                    IF PS-INACTV-PBS-CARTON-YES                   02294006
022950                       IF SU001-CRTN-ATT-TO-RCVR OR               02295006
022960                          SU001-CRTN-ATT-TO-TRIP                  02296006
022970                          PERFORM 4500-CREATE-TROUBLE             02297006
022980                       END-IF                                     02298006
022990                       PERFORM 5005-PRINT-MESSAGE-LABELS          02299006
023000                    ELSE                                          02300006
023010                       SET PS-NO-TROUBLE-FOUND TO TRUE            02301006
023020                       IF SU001-RCVR-SEQ-NBR > 0                  02302006
023030                          PERFORM 4450-CHECK-TROUBLE              02303006
023040                       END-IF                                     02304006
023050                       IF PS-TROUBLE-FOUND                        02305006
023060                          PERFORM 4460-CHECK-PO-AUD-REQ           02306006
023070                          IF PS-AUDIT-PROMPT-CHECK-YES            02307006
023080                             PERFORM 5000-PRINT-LABEL             02308006
023090                          ELSE                                    02309006
023100                             PERFORM 5005-PRINT-MESSAGE-LABELS    02310006
023110                          END-IF                                  02311006
023120                       ELSE                                       02312006
023130                          PERFORM 4510-PROCESS-CHECK-RTV          02313006
023140                          IF PS-PBS-RTV-ALLOC OR                  02314006
023150                                  PS-PBS-RTV-NO-ALLOC             02315006
023160                           IF SU001-AUTO-VE-YES AND               02316006
023170                             PS-PBS-RTV-ALLOC                     02317006
023180                             PERFORM 3690-CHECK-SULBXF-FOR-ACTIVE 02318006
023190                             IF PS-SULBXF-RECORD-NOT-FOUND        02319006
023200                                PERFORM 7590-CREATE-RTV-OTBND     02320006
023210                             END-IF                               02321006
023220                           END-IF                                 02322006
023230                           PERFORM 5005-PRINT-MESSAGE-LABELS      02323006
023240                          ELSE                                    02324006
023250                             PERFORM 5000-PRINT-LABEL             02325006
023260                          END-IF                                  02326006
023270                       END-IF                                     02327006
023280                    END-IF                                        02328006
023290                   ELSE                                           02329006
023300*MISDIRECT PBS AND NOT REPURPOSE LABEL                            02330006
023310                      IF SU001-ECOMM-DC-REPURPOSE-NO              02331006
023320                         PERFORM 5005-PRINT-MESSAGE-LABELS        02332006
023330                      END-IF                                      02333006
023340                   END-IF                                         02334006
023350                   END-IF                                         02335006
023360                 ELSE                                             02336006
023370                  IF SU001-WRONG-FCLTY OR                         02337006
023380                     SU001-ECOMM-DC-REPURPOSE                     02338006
023390                     PERFORM 1100-GET-ZONE-DESC                   02339006
023400                     PERFORM 7235-GET-OUTER-PACK                  02340006
023410                     PERFORM 7230-GET-DEPT-CL-SKU                 02341006
023420                     PERFORM 7400-GET-DEPT-NAME                   02342006
023430                     PERFORM 5005-PRINT-MESSAGE-LABELS            02343006
023440                  ELSE                                            02344006
023450                    IF SU001-RCVR-SEQ-NBR = 0                     02345006
023460                       SET SU001-NOT-CRTN-ATT-TO-RCVR TO TRUE     02346006
023470                       PERFORM 7235-GET-OUTER-PACK                02347006
023480                       PERFORM 7210-GET-STORE-INFO                02348006
023490                       PERFORM 5005-PRINT-MESSAGE-LABELS          02349006
023500                       SET SU001-UCC128-NO-RCVR TO TRUE           02350006
023510                       PERFORM 3600-CHECK-MESSAGE-TABLE           02351006
023520                    ELSE                                          02352006
023530                      PERFORM 3685-CHECK-UCC128-USE               02353006
023540                      IF DISTHD-TOT-CART-CNT > 0                  02354006
023550                         SET PS-SULBXF-RECORD-FOUND TO TRUE       02355006
023560                         PERFORM 3690-CHECK-SULBXF-FOR-ACTIVE     02356006
023570                       IF PS-SULBXF-RECORD-FOUND                  02357006
023580                          SET PS-NO-FLOWBACK-BYPASS-AUDIT  TO TRUE02358006
023590                          IF PS-ACTIVE-XREF-ROW-FOUND             02359006
023600                             SET SU001-LBL-REPRINT TO TRUE        02360006
023610                             MOVE SU001-PREPK-ID  TO DK-PREPK-ID  02361006
023620                             MOVE SU001-STORE     TO DK-STORE     02362006
023630                             MOVE SU001-PKGNG-CDE TO              02363006
023640                                                 RECEIV-PKGNG-CDE 02364006
023650                             PERFORM 7210-GET-STORE-INFO          02365006
023660                             SET PS-NO-FLOWBACK-BYPASS-AUDIT      02366006
023670                                                           TO TRUE02367006
023680                             PERFORM 2245-BULK-LABEL-ROUTINE      02368006
023690                          ELSE                                    02369006
023700                             SET SU001-NOT-LBL-REPRINT            02370006
023710                                 SU001-NOT-REPRINT     TO TRUE    02371006
023720                             MOVE SU001-PKGNG-CDE TO              02372006
023730                                                 RECEIV-PKGNG-CDE 02373006
023740                             PERFORM 2245-BULK-LABEL-ROUTINE      02374006
023750                          END-IF                                  02375006
023760                       ELSE                                       02376006
023770                            EVALUATE TRUE                         02377006
023780                              WHEN DISTHD-UCC128-DAT-USG-CDE = 'I'02378006
023790                                SET SU001-UCC128-IGNORED TO TRUE  02379006
023800                                PERFORM 3600-CHECK-MESSAGE-TABLE  02380006
023810                                SET PS-NO-CASEPK-FND TO TRUE      02381006
023820                                PERFORM 5005-PRINT-MESSAGE-LABELS 02382006
023830                              WHEN DISTHD-UCC128-DAT-USG-CDE = 'N'02383006
023840                              WHEN DISTHD-UCC128-DAT-USG-CDE = ' '02384006
023850                                SET SU001-UCC128-NOT-AVAILABLE    02385006
023860                                                        TO TRUE   02386006
023870                                PERFORM 3600-CHECK-MESSAGE-TABLE  02387006
023880                                SET PS-NO-CASEPK-FND TO TRUE      02388006
023890                                PERFORM 5005-PRINT-MESSAGE-LABELS 02389006
023900                              WHEN DISTHD-UCC128-DAT-USG-CDE = 'U'02390006
023910                                 SET SU001-NOT-LBL-REPRINT        02391006
023920                                     SU001-NOT-REPRINT TO TRUE    02392006
023930                                 MOVE SU001-PKGNG-CDE TO          02393006
023940                                              RECEIV-PKGNG-CDE    02394006
023950                                 SET PS-NO-FLOWBACK-BYPASS-AUDIT  02395006
023960                                                           TO TRUE02396006
023970                                 PERFORM 2245-BULK-LABEL-ROUTINE  02397006
023980                            END-EVALUATE                          02398006
023990                       END-IF                                     02399006
024000                      ELSE                                        02400006
024010                        IF SU001-RECEIV-PBS-IND = 'Y'             02401006
024020                            SET SU001-UCC128-PBS-RCVR TO TRUE     02402006
024030                            PERFORM 3600-CHECK-MESSAGE-TABLE      02403006
024040                        ELSE                                      02404006
024050                            SET PS-NO-CASEPK-FND TO TRUE          02405006
024060                            PERFORM 5005-PRINT-MESSAGE-LABELS     02406006
024070                            SET SU001-UCC128-GENERAL-MESS TO TRUE 02407006
024080                            PERFORM 3600-CHECK-MESSAGE-TABLE      02408006
024090                        END-IF                                    02409006
024100                      END-IF                                      02410006
024110                    END-IF                                        02411006
024120                    IF PS-DISPLAY-SUKRF530                        02412006
024130                        MOVE PC-SU-MESSAGE-PGM                    02413006
024140                                       TO PV-TRANSFER-PROGRAM     02414006
024150                        PERFORM 4000-XCTL-LRT-MENU                02415006
024160                    END-IF                                        02416006
024170                  END-IF                                          02417006
024180                 END-IF                                           02418006
024190               ELSE                                               02419006
024200                 MOVE PC-VERFD-LINES-IN-CRTN  TO AMSGLNO          02420006
024210                 SET SU001-PROCESS-SCREEN TO TRUE                 02421006
024220                 PERFORM 8000-SEND-MAP                            02422006
024230                 PERFORM 8200-RETURN-TRANID                       02423006
024240               END-IF                                             02424006
024250             END-IF                                               02425006
024260                                                                  02426006
024270         WHEN SU001-LAST-PROGRAM = PC-SU-ADD-PGM AND              02427006
024280              SU001-ADD-NOT-FOUND                                 02428006
024290             MOVE SU001-CARTON     TO SHPUNT-SHIPT-UNT-ID         02429006
024300                                      SHPUNT-NEXT-SHIPT-UNT-ID    02430006
024310             IF SU001-MISDIRECT                                   02431006
024320                 MOVE SU001-OPER-UNT-ID                           02432006
024330                                   TO SHPUNT-ORGN-OPER-UNT-ID     02433006
024340                 MOVE 1            TO SHPUNT-ORGN-FCLTY-ID        02434006
024350                 MOVE ZERO         TO SHPUNT-DEST-OPER-UNT-ID     02435006
024360                                      SHPUNT-DEST-FCLTY-ID        02436006
024370                                      PV-STORE-N                  02437006
024380             ELSE                                                 02438006
024390                 MOVE SU001-STORE-OPER-UNT-ID                     02439006
024400                                   TO SHPUNT-ORGN-OPER-UNT-ID     02440006
024410                 MOVE SU001-STORE  TO SHPUNT-DEST-OPER-UNT-ID     02441006
024420                                      PV-STORE-N                  02442006
024430                 MOVE 1            TO SHPUNT-ORGN-FCLTY-ID        02443006
024440                 MOVE 1            TO SHPUNT-DEST-FCLTY-ID        02444006
024450             END-IF                                               02445006
024460             MOVE PC-RCV           TO SHPUNT-SHIPT-UNT-SRC-ID     02446006
024470             MOVE PC-0             TO SHPUNT-HIER-LVL-CDE         02447006
024480             MOVE PC-0-9           TO SHPUNT-ORIG-SHIPT-UNT-ID    02448006
024490             MOVE PC-ACTIVE        TO SHPUNT-ACTV-IND             02449006
024500             MOVE SU001-USER-ID    TO SHPUNT-CRE-USR-ID           02450006
024510             MOVE PC-CURRENT-PROGRAM-NAME                         02451006
024520                                   TO SHPUNT-CRE-PGM-NM           02452006
024530                                                                  02453006
024540             PERFORM 2290-INSERT-TSHPUNT                          02454006
024550             PERFORM 2270-INSERT-TSHUNLO                          02455006
024560             MOVE SU001-CARTON     TO PV-CTN                      02456006
024570                                      PV-CTN-N                    02457006
024580             MOVE SU001-CARTON     TO SHUUPC-SHIPT-UNT-ID         02458006
024590             IF  SU001-MISDIRECT                                  02459006
024600                 MOVE PC-NEG-9     TO SHUUPC-TRN-NBR              02460006
024610                                      PV-PO-N                     02461006
024620                                      PV-PO-OUT                   02462006
024630             ELSE                                                 02463006
024640                 MOVE SU001-PO        TO SHUUPC-TRN-NBR           02464006
024650                                         PV-PO-OUT                02465006
024660                                         PV-PO-N                  02466006
024670             END-IF                                               02467006
024680             MOVE ZERO      TO SHUUPC-TRN-LNE-NBR                 02468006
024690             MOVE PC-PO     TO SHUUPC-TRN-TYP-CDE                 02469006
024700             MOVE ZERO      TO SHUUPC-UPC-NBR                     02470006
024710             MOVE ZERO      TO SHUUPC-SHPD-QTY                    02471006
024720             PERFORM 2300-INSERT-TSHUUPC                          02472006
024730             MOVE PV-PO-RCVR     TO APORCVRO                      02473006
024740             MOVE PV-STORE       TO ASTRO                         02474006
024750             MOVE PV-PO-LINE-OUT TO ALNEO                         02475006
024760             MOVE PV-CTN-X       TO ACARTNO                       02476006
024770             MOVE PV-SKU-OUT     TO AITEMO                        02477006
024780*            IF (NOT  SU001-NO-PRINTER)                           02478006
024790*               AND SHPUNT-ORGN-OPER-UNT-ID NOT =                 02479006
024800*                              SHPUNT-DEST-OPER-UNT-ID AND        02480006
024810*               PS-OPER-IS-STORE AND                              02481006
024820*               NOT SU001-MISDIRECT AND                           02482006
024830*               SU001-OPER-UNT-IND = SPACES                       02483006
024840*                PERFORM 5005-PRINT-MESSAGE-LABELS                02484006
024850*            END-IF                                               02485006
024860             MOVE SPACES TO SU001-REC-NOT-FOUND-IND               02486006
024870                            SU001-OPER-UNT-IND                    02487006
024880                                                                  02488006
024890         WHEN SU001-LAST-PROGRAM = PC-SU-WRONG-FCLTY-PGM AND      02489006
024900            SU001-LABEL-IND     = PC-Y                            02490006
024910***          MOVE SU001-CARTON   TO SHPUNT-SHIPT-UNT-ID           02491060
024920**GB         PERFORM 2270-INSERT-TSHUNLO                          02492006
024930             MOVE SU001-CARTON   TO PV-CTN                        02493006
024940                                    PV-CTN-N                      02494006
024950             MOVE SU001-PO       TO PV-PO-N                       02495006
024960                                    PV-PO-OUT                     02496006
024970             MOVE SU001-RCVR-SEQ-NBR                              02497006
024980                                 TO PV-RCVR-OUT                   02498006
024990             MOVE PV-PO-RCVR     TO APORCVRO                      02499006
025000             PERFORM 7235-GET-OUTER-PACK                          02500006
025010             PERFORM 7230-GET-DEPT-CL-SKU                         02501006
025020             PERFORM 7400-GET-DEPT-NAME                           02502006
025030             PERFORM 5005-PRINT-MESSAGE-LABELS                    02503006
025040             IF SU001-P2L-LBL-CREATED                             02504006
025050                MOVE SPACES      TO PV-STORE-X                    02505006
025060                MOVE 'P2L'       TO PV-STORE-X-4                  02506006
025070             ELSE                                                 02507006
025080                MOVE SU001-STORE    TO PV-STORE-N                 02508006
025090                MOVE PV-STORE       TO ASTRO                      02509006
025100             END-IF                                               02510006
025110             IF   SU001-PREPK-ID > 0                              02511006
025120                  MOVE SU001-PREPK-ID TO PV-PO-LINE-N             02512006
025130                  MOVE 'PCK:'    TO ALNEHDGO                      02513006
025140             END-IF                                               02514006
025150             MOVE PV-PO-LINE-OUT    TO ALNEO                      02515006
025160             MOVE PV-CTN-X       TO ACARTNO                       02516006
025170             MOVE PV-SKU-OUT     TO AITEMO                        02517006
025180             MOVE SPACES         TO SU001-WRONG-FCLTY-IND         02518006
025190                                                                  02519006
025200         WHEN SU001-LAST-PROGRAM = PC-SU-CARTON-AUDIT-PGM         02520006
025210         WHEN SU001-LAST-PROGRAM = PC-LINE-LOCATION-PGM           02521006
025220             MOVE SU001-CARTON   TO ACARTNI                       02522006
025230             MOVE SU001-PO       TO PV-PO-N                       02523006
025240                                    PV-PO-OUT                     02524006
025250             MOVE SU001-RCVR-SEQ-NBR                              02525006
025260                                 TO PV-RCVR-OUT                   02526006
025270             MOVE PV-PO-RCVR     TO APORCVRO                      02527006
025280             MOVE SU001-STORE    TO PV-STORE                      02528006
025290             MOVE PV-STORE       TO ASTRO                         02529006
025300             MOVE SU001-PO-LINE-NBR                               02530006
025310                                 TO PV-PO-LINE-OUT                02531006
025320             MOVE PV-PO-LINE-OUT TO ALNEO                         02532006
025330             MOVE SPACES         TO AMSGLNO                       02533006
025340         WHEN SU001-LAST-PROGRAM = PC-SU-MESSAGE-PGM AND          02534006
025350              SU001-FREE-ASTRY-TRIP-MESS                          02535006
025360              MOVE SPACES TO SU001-SUKRF530-MESSAGE               02536006
025370              MOVE SU001-CARTON  TO PV-CTN-N                      02537006
025380              PERFORM 2240-CHECK-TABLES                           02538006
025390              IF SU001-AUTO-VE-YES AND                            02539006
025400                 PS-NO-SULBXF-ROW-FOUND AND PS-DUPLICATE-FOUND    02540006
025410                 MOVE PC-SU-DUPLICATE-PGM                         02541006
025420                                TO PV-TRANSFER-PROGRAM            02542006
025430                 PERFORM 4000-XCTL-LRT-MENU                       02543006
025440              END-IF                                              02544006
025450                                                                  02545006
025460              IF PS-WRONG-FCLTY                                   02546006
025470                  MOVE PV-STORE TO SU001-STORE                    02547006
025480                  MOVE PV-CTN-N TO SU001-CARTON                   02548006
025490                  MOVE PC-SU-WRONG-FCLTY-PGM                      02549006
025500                                TO PV-TRANSFER-PROGRAM            02550006
025510                  PERFORM 4000-XCTL-LRT-MENU                      02551006
025520              END-IF                                              02552006
025530                                                                  02553006
025540              EVALUATE TRUE                                       02554006
025550                 WHEN SU001-PREPK-ID > 0                          02555006
025560                    MOVE 'PCK:'      TO ALNEHDGO                  02556006
025570                    MOVE SU001-PREPK-ID TO PV-PO-LINE-N           02557006
025580                 WHEN SU001-MULTI-LINE                            02558006
025590                    MOVE PC-MULTI-LINE TO PV-PO-LINE-OUT          02559006
025600                    MOVE  'MLT ITMS'   TO  PV-SKU-OUT             02560006
025610                 WHEN  SU001-NO-LINE                              02561006
025620                     MOVE PC-NOLNE-LINE TO PV-PO-LINE-OUT         02562006
025630                 WHEN  OTHER                                      02563006
025640                     MOVE SU001-PO-LINE-NBR TO PV-PO-LINE-OUT     02564006
025650              END-EVALUATE                                        02565006
025660              MOVE SU001-CARTON   TO ACARTNI                      02566006
025670              MOVE SU001-PO       TO PV-PO-N                      02567006
025680                                     PV-PO-OUT                    02568006
025690              IF SU044-NEW-REC-SEQ-NBR > 0                        02569006
025700                 MOVE SU044-NEW-REC-SEQ-NBR TO PV-RCVR-OUT        02570006
025710              ELSE                                                02571006
025720                 MOVE SU001-RCVR-SEQ-NBR TO PV-RCVR-OUT           02572006
025730              END-IF                                              02573006
025740              MOVE PV-PO-RCVR     TO APORCVRO                     02574006
025750              MOVE SU001-STORE    TO PV-STORE                     02575006
025760              MOVE PV-STORE       TO ASTRO                        02576006
025770              MOVE PV-PO-LINE-OUT TO ALNEO                        02577006
025780              MOVE PV-SKU-OUT     TO AITEMO                       02578006
025790              MOVE SPACES         TO AMSGLNO                      02579006
025800         WHEN SU001-LAST-PROGRAM = PC-SU-NOT-FOUND-PGM            02580006
025810              SET PS-CARTON-DOESNT-EXIST TO TRUE                  02581006
025820              PERFORM 5005-PRINT-MESSAGE-LABELS                   02582006
025830         WHEN OTHER                                               02583006
025840             MOVE SPACES TO SU001-WRONG-FCLTY-IND                 02584006
025850             MOVE SPACES TO SU001-REC-NOT-FOUND-IND               02585006
025860                            SU001-OPER-UNT-IND                    02586006
025870             MOVE SPACES TO ASTRO                                 02587006
025880             MOVE SPACES TO ALNEO                                 02588006
025890             MOVE SPACES TO AITEMO                                02589006
025900             MOVE SPACES TO ACARTNO                               02590006
025910     END-EVALUATE.                                                02591006
025920     MOVE -1                     TO ACARTNL.                      02592006
025930                                                                  02593006
025940                                                                  02594006
025950 1100-GET-ZONE-DESC.                                              02595006
025960                                                                  02596006
025970         MOVE SU001-PO   TO PURCHS-PO-NBR.                        02597006
025980                                                                  02598006
025990         EXEC SQL                                                 02599006
026000              SELECT C.STR_ZN_ID                                  02600006
026010              INTO   :MDSEDP-STR-ZN-ID                            02601006
026020              FROM   TPURCHS A,                                   02602006
026030                     TMDSEAR B,                                   02603006
026040                     TMDSEDP C                                    02604006
026050              WHERE  A.PO_NBR   = :PURCHS-PO-NBR                  02605006
026060                AND  A.VER_STATUS_CDE = 'A'                       02606006
026070                AND  A.DEPT_NBR = B.DEPT_NBR                      02607006
026080                AND  B.MDSELV_CDE = 'DPT'                         02608006
026090                AND  B.OPERCO_NBR = '03'                          02609006
026100                AND (B.STRT_DTE <= CURRENT DATE AND               02610006
026110                     B.END_DTE > CURRENT DATE)                    02611006
026120                AND  B.MDSEAR_DKEY = C.MDSEAR_DKEY                02612006
026130         END-EXEC                                                 02613006
026140                                                                  02614006
026150     EVALUATE TRUE                                                02615006
026160         WHEN SQLCODE = ZERO                                      02616006
026170             MOVE MDSEDP-STR-ZN-ID TO LBPTDA-STR-ZN-ID            02617006
026220         WHEN SQLCODE = +100                                      02622006
026230             MOVE SPACES TO LBPTDA-STR-ZN-ID                      02623006
026280         WHEN SQLWARN0 NOT = SPACES                               02628006
026290         WHEN SQLCODE NOT EQUAL ZERO                              02629006
026300             MOVE '1100-GET-ZONE-DESC'                            02630006
026310                             TO DP013-PARAGRAPH                   02631006
026320             MOVE 'SUKRF502 - GET ZONE DESC '                     02632006
026330                             TO DP013-MESSAGE-TEXT(1)             02633006
026340             MOVE PURCHS-PO-NBR                                   02634006
026350                             TO DP013-MESSAGE-TEXT(2)             02635006
026360             MOVE SQLCA      TO DP013-SQLCA                       02636006
026370             MOVE 'TMDSEDP'  TO DP013-DB2-TABLE-NAME(1)           02637006
026380             SET DP013-DB2-ABEND                                  02638006
026390                             TO TRUE                              02639006
026400             SET DP013-ROLLBACK                                   02640006
026410                             TO TRUE                              02641006
026420             SET DP013-XCTL-DISPLAY-RESTART                       02642006
026430                             TO TRUE                              02643006
026440             PERFORM DP014-0000-PROCESS-ABEND                     02644006
026450     END-EVALUATE.                                                02645006
026460                                                                  02646006
026470 1200-HELP-SCREEN.                                                02647006
026480     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      02648006
026490     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       02649006
026500     COPY PCPD188.                                                02650006
026510     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      02651006
026520     PERFORM 4200-XCTL-TO-HELP.                                   02652006
026530                                                                  02653006
026540                                                                  02654006
026550 2000-PROCESS-SCREEN-FIELDS.                                      02655006
026560                                                                  02656006
026570     PERFORM 2100-RECEIVE-MAP.                                    02657006
026580     PERFORM 2200-EDIT-INPUT.                                     02658006
026590                                                                  02659006
026600                                                                  02660006
026610 2100-RECEIVE-MAP.                                                02661006
026620                                                                  02662006
026630     EXEC CICS                                                    02663006
026640         RECEIVE MAP    ('SU502A')                                02664006
026650                 MAPSET ('SUKM502')                               02665006
026660                 RESP   (PV-CICS-RESPONSE)                        02666006
026670     END-EXEC.                                                    02667006
026680                                                                  02668006
026690     EVALUATE TRUE                                                02669006
026700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02670006
026710             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   02671006
026720         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                02672006
026730             CONTINUE                                             02673006
026740         WHEN OTHER                                               02674006
026750            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       02675006
026760            MOVE 'SUKRF502 - UNABLE TO RECEIVE MAP'               02676006
026770                                         TO DP013-MESSAGE-TEXT (1)02677006
026780            SET DP013-LOGIC-ABEND        TO TRUE                  02678006
026790            SET DP013-ROLLBACK           TO TRUE                  02679006
026800            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                02680006
026810     END-EVALUATE.                                                02681006
026820                                                                  02682006
026830                                                                  02683006
026840 2110-RECEIVE-SCREEN-FIELDS.                                      02684006
026850                                                                  02685006
026860     IF  ACARTNL > ZERO                                           02686006
026870         MOVE ACARTNI TO PV-CTN                                   02687006
026880     ELSE                                                         02688006
026890         IF ACARTNA = DP015-ERASE-EOF                             02689006
026900             MOVE SPACES TO PV-CTN                                02690006
026910         END-IF                                                   02691006
026920     END-IF.                                                      02692006
026930                                                                  02693006
026940                                                                  02694006
026950                                                                  02695006
026960 2200-EDIT-INPUT.                                                 02696006
026970                                                                  02697006
026980     PERFORM 2210-INIT-ATTR.                                      02698006
026990     PERFORM 2230-EDIT-CTN.                                       02699006
027000                                                                  02700006
027010                                                                  02701006
027020 2210-INIT-ATTR.                                                  02702006
027030                                                                  02703006
027040     MOVE DP015-UNP-ALP-NOR-MDT      TO ACARTNA.                  02704006
027050                                                                  02705006
027060     MOVE PV-PO-RCVR     TO APORCVRO.                             02706006
027070     MOVE PV-STORE       TO ASTRO.                                02707006
027080     MOVE PV-CTN         TO ACARTNO.                              02708006
027090     MOVE PV-PO-LINE-OUT TO ALNEO.                                02709006
027100     MOVE PV-SKU-OUT     TO AITEMO.                               02710006
027110     MOVE SU001-OWNER-SCAC-ID TO PV-VEH-SCAC                      02711006
027120     MOVE SU001-VEH-NBR       TO PV-VEH-TRLR                      02712006
027130     MOVE PV-SCAC-TRLR        TO ASCACO.                          02713006
027140     MOVE SPACES         TO AMSGLNO.                              02714006
027150                                                                  02715006
027160                                                                  02716006
027170 2230-EDIT-CTN.                                                   02717006
027180     MOVE 0 TO PV-CHAR-COUNT.                                     02718006
027190     SET SU001-GOOD-CHECK-DIGIT TO TRUE.                          02719006
027200     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         02720006
027210                 BEFORE INITIAL SPACE.                            02721006
027220     EVALUATE TRUE                                                02722006
027230         WHEN PV-CTN = SPACES                                     02723006
027240             SET PS-INVALID-INPUT        TO TRUE                  02724006
027250             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               02725006
027260             MOVE -1                     TO ACARTNL               02726006
027270             MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO               02727006
027280*        WHEN PV-CHAR-COUNT = PC-18 AND                           02728006
027290*           ((PV-CTN-FIRST-DIGIT NOT =  PC-0) AND                 02729006
027300*            (PV-CTN-FIRST-DIGIT NOT =  PC-4) AND                 02730006
027310*            (PV-CTN-FIRST-DIGIT NOT =  PC-5))                    02731006
027320*            SET PS-INVALID-INPUT        TO TRUE                  02732006
027330*            MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               02733006
027340*            MOVE -1                     TO ACARTNL               02734006
027350*            MOVE PC-FIRST-1-NOT-0-MSG   TO AMSGLNO               02735006
027360         WHEN PV-CHAR-COUNT < PC-18                               02736006
027370             SET PS-INVALID-INPUT        TO TRUE                  02737006
027380             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               02738006
027390             MOVE -1                     TO ACARTNL               02739006
027400             MOVE PC-MORE-DIGITS-REQD    TO AMSGLNO               02740006
027410         WHEN OTHER                                               02741006
027420             SET DP010I-NEGATIVE-NOT-ALLOWED                      02742006
027430                 PS-NOT-SCANNED-DATA TO TRUE                      02743006
027440             IF PV-CHAR-COUNT = PC-18                             02744006
027450                 MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD02745006
027460             ELSE                                                 02746006
027470                 IF PV-CHAR-COUNT < PC-18                         02747006
027480                     MOVE PV-CTN          TO DP010I-UNEDITED-FIELD02748006
027490                 ELSE                                             02749006
027500                     MOVE PV-CTN-SCAN-LAST-17                     02750006
027510                                          TO DP010I-UNEDITED-FIELD02751006
027520                     SET PS-SCANNED-DATA TO TRUE                  02752006
027530                 END-IF                                           02753006
027540             END-IF                                               02754006
027550             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 02755006
027560             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               02756006
027570                                                                  02757006
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     02758182
263968                  USING DP010I-NUMERIC-EDIT-AREA                  02758282
027590                                                                  02759006
027600             IF  DP010I-ERROR-DETECTED                            02760006
027610                 SET PS-INVALID-INPUT        TO TRUE              02761006
027620                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           02762006
027630                 MOVE -1                     TO ACARTNL           02763006
027640                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           02764006
027650             ELSE                                                 02765006
027660                 IF DP010I-NUMERIC-FIELD = ZEROES                 02766006
027670                     SET PS-INVALID-INPUT        TO TRUE          02767006
027680                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       02768006
027690                     MOVE -1                     TO ACARTNL       02769006
027700                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       02770006
027710                 ELSE                                             02771006
027720                     MOVE  SPACES  TO  SU001-NOT-FOUND-IND        02772006
027730                                       SU001-MISDIRECT-IND        02773006
027740                                       SU001-FREE-ASTRAY-IND      02774006
027750                                       SU001-SHPUNT-NOT-FND-IND   02775006
027760                                       SU001-WRONG-FCLTY-IND      02776006
027770                      COMPUTE SU001-CARTON      ROUNDED =         02777006
027780                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         02778006
027790                      COMPUTE PV-CTN-N          ROUNDED =         02779006
027800                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         02780006
027810                      SET PS-NOT-TRNGLE-TRANS   TO TRUE           02781006
027820                      EVALUATE TRUE                               02782006
027830                         WHEN PV-CHAR-COUNT = PC-20               02783006
027840                               MOVE PV-CTN-SCAN-LAST-18 TO        02784006
027850                                                   PV-CTN-N       02785006
027860                                                   SU001-CARTON   02786006
027870                         WHEN PV-CHAR-COUNT = PC-18               02787006
027880                               MOVE PV-CTN  TO PV-CTN-N           02788006
027890                               MOVE PV-CTN-N TO SU001-CARTON      02789006
027900                      END-EVALUATE                                02790006
027910                     MOVE PV-CTN-N              TO ACARTNO        02791006
027920                     IF  SU001-BATCH-PRINTER OR                   02792006
027930                                     SU001-PRINT-AND-PEEL         02793006
027940                         IF  SU001-BATCH-NUMBER = ZEROES          02794006
027950                             PERFORM 2400-GET-BATCH-NUMBER        02795006
027960                             ADD  1  TO  PV-MAX-USER-BATCH        02796006
027970                                 GIVING  SU001-BATCH-NUMBER       02797006
027980                         END-IF                                   02798006
027990                     END-IF                                       02799006
028000                     PERFORM 2240-CHECK-TABLES                    02800006
028010                 END-IF                                           02801006
028020             END-IF                                               02802006
028030     END-EVALUATE.                                                02803006
028040                                                                  02804006
028050                                                                  02805006
028060 2240-CHECK-TABLES.                                               02806006
028070                                                                  02807006
028080     INITIALIZE SU001-PREPK-ID.                                   02808006
028090                                                                  02809006
028100     MOVE PV-CTN-N  TO SHPUNT-SHIPT-UNT-ID                        02810006
028110                       SHUUPC-SHIPT-UNT-ID                        02811006
028120                       DK-CTN.                                    02812006
028130     PERFORM 2250-SELECT-SHPUNT.                                  02813006
028140     SET SU001-NOT-PACK-BY-STORE                                  02814006
028150         SU001-NOT-MULTI-LINE                                     02815006
028160         SU001-LINE-FND                                           02816006
028170         PS-MISDIRECT-PACK-BY-STORE-NO                            02817006
028180         PS-INACTV-PBS-CARTON-NO                                  02818006
028190         PS-NOT-INVALID-CRE-SOURCE                                02819006
028200         SU001-ECOMM-DC-REPURPOSE-NO                              02820006
028210         SU001-AUTO-VE-NO          TO TRUE                        02821006
028220                                                                  02822006
028230                                                                  02823006
028240     IF XLT00010-LOC-TYP-CDE = 'DS'                               02824006
028250        SET SU001-PACK-BY-STORE TO TRUE                           02825006
028260        PERFORM 2265-CHECK-INACTV-PBS                             02826006
028270     END-IF                                                       02827006
028280                                                                  02828006
028290     IF PS-CARTON-EXISTS                                          02829006
028300        IF SHPUNT-SHIPT-UNT-SRC-ID EQUAL 'ASN' OR 'RCV'           02830006
028310             CONTINUE                                             02831006
028320        ELSE                                                      02832006
028330            SET PS-CARTON-DOESNT-EXIST                            02833006
028340                PS-INVALID-CRE-SOURCE   TO TRUE                   02834006
028350        END-IF                                                    02835006
028360     END-IF                                                       02836006
028370                                                                  02837006
028380     IF PS-CARTON-EXISTS                                          02838006
028390        PERFORM 2255-SELECT-SHUUPC                                02839006
028400        PERFORM 2410-DETERMINE-RECEIVER                           02840006
028410                                                                  02841006
028420        IF PKSLIP-ORIG-PKSL-SEQ-NBR > 0                           02842006
028430           SET SU044-FA-PKSLIP-CREATE TO TRUE                     02843006
028440        ELSE                                                      02844006
028450           SET SU044-ASN-PKSLIP-CREATE TO TRUE                    02845006
028460        END-IF                                                    02846006
028470                                                                  02847006
028480        PERFORM 3805-CHECK-TKRPRPM-AUTOVE                         02848006
028490                                                                  02849006
028500        IF SHPUNT-ORGN-OPER-UNT-ID = SU001-OPER-UNT-ID            02850006
028510           CONTINUE                                               02851006
028520        ELSE                                                      02852006
028530           IF RECEIV-CURR-OPER-UNT-ID = SU001-OPER-UNT-ID         02853006
028540              CONTINUE                                            02854006
028550           ELSE                                                   02855006
028560              SET SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE              02856006
028570              IF RC040-PROCESS-MSDIRCT-NO                         02857006
028580                  SET SU001-WRONG-FCLTY     TO TRUE               02858006
028590              END-IF                                              02859006
028600           END-IF                                                 02860006
028610        END-IF                                                    02861006
028620                                                                  02862006
028630        IF SU001-CRTN-ATT-TO-TRIP AND SU001-CRTN-ATT-TO-RCVR      02863006
028640           MOVE RECEIV-OPER-UNT-ID TO DK-OPER-UNT-ID              02864006
028650           PERFORM 7215-GET-ECOMM-DC-INFO                         02865006
028660        END-IF                                                    02866006
028670                                                                  02867006
028680        IF SU001-PACK-BY-STORE AND PS-RCVR-DATA-FOUND-YES         02868006
028690           IF RECEIV-PACK-BY-ST-IND = 'Y'                         02869006
028700              SET PS-PBS-CRTN-RCVR-MISMTCH-NO TO TRUE             02870006
028710              PERFORM 2241-PROCESS-VALID-CARTONS                  02871006
028720           ELSE                                                   02872006
028730              IF PS-OPER-IS-ECOMM-DC                              02873006
028740                 PERFORM 2241-PROCESS-VALID-CARTONS               02874006
028750              ELSE                                                02875006
028760                 SET PS-PBS-CRTN-RCVR-MISMTCH-YES TO TRUE         02876006
028770                 PERFORM 5005-PRINT-MESSAGE-LABELS                02877006
028780              END-IF                                              02878006
028790           END-IF                                                 02879006
028800        ELSE                                                      02880006
028810           IF PS-UCC128-PKSLIP-ERROR-YES                          02881006
028820              PERFORM 5005-PRINT-MESSAGE-LABELS                   02882006
028830           ELSE                                                   02883006
028840              PERFORM 2241-PROCESS-VALID-CARTONS                  02884006
028850           END-IF                                                 02885006
028860        END-IF                                                    02886006
028870     ELSE                                                         02887006
028880* PB 06/07/2010 BEG                                               02888006
028890*                                                                 02889006
028900* CHECK IF THE PROCESSED FREIGHT (IR) CARTON IS PRESENT ON        02890006
028910* OUTBOUND CARTON AND OUTBOUND UPC TABLES. IF AVAILABLE,          02891006
028920* INSERT THE RECORD FOR THE SCANNED CARTON TO THE OUTBOUND        02892006
028930* LOCATION TABLE. PRINT THE WHSE REPLN MESSAGE LABEL FOR THE      02893006
028940* SCANNED IR CARTON.                                              02894006
028950*                                                                 02895006
028960        PERFORM 7710-SELECT-OTBND-CART                            02896006
028970        IF PV-OTBND-CART-YES = 'Y'                                02897006
028980           PERFORM 7720-SELECT-OTBND-UPC                          02898006
028990           PERFORM 7730-CHECK-INBND-TRIP-ID                       02899006
029000        ELSE                                                      02900006
029010           SET PS-INVALID-INPUT                                   02901006
029020           PS-NOT-FOUND                                           02902006
029030           SU001-NOT-FOUND            TO TRUE                     02903006
029040        END-IF                                                    02904006
029050*        SET PS-INVALID-INPUT                                     02905006
029060*            PS-NOT-FOUND                                         02906006
029070*            SU001-NOT-FOUND            TO TRUE                   02907006
029080* PB 06/07/2010 END                                               02908006
029090     END-IF.                                                      02909006
029100******************************************************************02910006
029110 2241-PROCESS-VALID-CARTONS.                                      02911006
029120         IF SHPUNT-SHIPT-UNT-SRC-ID EQUAL PC-RCV                  02912006
029130             SET SU001-SHPUNT-NOT-FND TO TRUE                     02913006
029140         ELSE                                                     02914006
029150            IF NOT SU001-WRONG-FCLTY                              02915006
029160              IF  SU001-NOT-CRTN-ATT-TO-TRIP OR                   02916006
029170                 SU001-NOT-CRTN-ATT-TO-RCVR                       02917006
029180                    PERFORM 3610-CHECK-LBVRMG-FREE-ASTR           02918006
029190                 IF PS-DISPLAY-SUKRF530                           02919006
029200                    SET SU001-FREE-ASTRY-TRIP-MESS TO TRUE        02920006
029210                    MOVE PC-SU-MESSAGE-PGM                        02921006
029220                                    TO PV-TRANSFER-PROGRAM        02922006
029230                       PERFORM 4000-XCTL-LRT-MENU                 02923006
029240                 END-IF                                           02924006
029250              END-IF                                              02925006
029260            END-IF                                                02926006
029270         END-IF                                                   02927006
029280                                                                  02928006
029290** SLH 05/08                                                      02929006
029300         IF SU001-CRTN-ATT-TO-TRIP AND SU001-CRTN-ATT-TO-RCVR     02930006
029310            AND PS-OPER-IS-ECOMM-DC                               02931006
029320            IF RECEIV-CURR-OPER-UNT-ID = RECEIV-OPER-UNT-ID       02932006
029330               CONTINUE                                           02933006
029340            ELSE                                                  02934006
029350               INITIALIZE PV-REPURP-COUNT                         02935006
029360               PERFORM 3806-CHECK-FOR-REPURP                      02936006
029370*              IF PV-REPURP-COUNT > 0                             02937006
029380               PERFORM 6750-CHECK-ECOMM-REPURPOSE                 02938006
029390*              END-IF                                             02939006
029400            END-IF                                                02940006
029410         END-IF                                                   02941006
029420                                                                  02942006
029430         PERFORM 2260-SELECT-TSHUNLO                              02943006
029440                                                                  02944006
029450         IF SU001-ASGMT-STRT-DTE  > SPACES                        02945006
029460            PERFORM 2285-CALL-DLKUP001-ASGMT-MOD                  02946006
029470         END-IF                                                   02947006
029480                                                                  02948006
029490         PERFORM 2425-CHECK-VERIFIED-LINES                        02949006
029500         SET PS-NO-FLOWBACK-BYPASS-AUDIT   TO TRUE                02950006
029510***GB 9/28/04                                                     02951006
029520         IF PV-DB2-COUNT = 0                                      02952006
029530            PERFORM 2270-INSERT-TSHUNLO                           02953006
029540            IF SU001-NO-PRINTER AND SU001-ASGMT-STRT-DTE > SPACES 02954006
029550               PERFORM 5700-CALL-XLKUP033-EAI                     02955006
029560            END-IF                                                02956006
029570***GB 8/15/04                                                     02957006
029580            IF (NOT  SU001-NO-PRINTER)                            02958006
029590               IF SU001-ECOMM-DC-REPURPOSE                        02959006
029600                  PERFORM 5005-PRINT-MESSAGE-LABELS               02960006
029610               END-IF                                             02961006
029620            END-IF                                                02962006
029630***GB 8/15/04                                                     02963006
029640                                                                  02964006
029650            IF SU001-ECOMM-DC-REPURPOSE-NO                        02965006
029660              IF ((SHPUNT-ORGN-OPER-UNT-ID = SU001-OPER-UNT-ID) OR02966006
029670                 (RECEIV-CURR-OPER-UNT-ID = SU001-OPER-UNT-ID))   02967006
029680                 AND PS-RECITM-VERIFIED-LINES-NO                  02968006
029690*CHANGE TO PROCESS PACK BY STORE MISDIRECTS                       02969006
029700                 OR  RC040-PROCESS-MSDIRCT-YES                    02970006
029710*GB 6/28/05                                                       02971006
029720                 IF SU001-PACK-BY-STORE                           02972006
029730                    PERFORM 2242-PACK-BY-STORE-PROCESS            02973006
029740                 ELSE                                             02974006
029750                    IF (NOT  SU001-NO-PRINTER)                    02975006
029760                        PERFORM 2245-BULK-LABEL-ROUTINE           02976006
029770                        IF PS-DISPLAY-SUKRF530                    02977006
029780                            MOVE PC-SU-MESSAGE-PGM                02978006
029790                                       TO PV-TRANSFER-PROGRAM     02979006
029800                            PERFORM 4000-XCTL-LRT-MENU            02980006
029810                        END-IF                                    02981006
029820                    ELSE                                          02982006
029830                        PERFORM 7230-GET-DEPT-CL-SKU              02983006
029840                    END-IF                                        02984006
029850                 END-IF                                           02985006
029860              ELSE                                                02986006
029870                  SET PS-INVALID-INPUT  TO TRUE                   02987006
029880                  SET PS-WRONG-FCLTY                              02988006
029890                  SU001-WRONG-FCLTY     TO TRUE                   02989006
029900              END-IF                                              02990006
029910            END-IF                                                02991006
029920         ELSE                                                     02992006
029930            IF (SU001-CRTN-ATT-TO-TRIP AND SU001-CRTN-ATT-TO-RCVR 02993006
029940               AND PS-RECITM-VERIFIED-LINES-NO) OR                02994006
029950               RC040-PROCESS-MSDIRCT-YES                          02995006
029960               PERFORM 2280-SELECT-STORE-FROM-XREF                02996006
029970               IF PKSLIP-CRE-SRC-CDE = PC-FA AND                  02997006
029980                                         PS-NO-SULBXF-ROW-FOUND   02998006
029990                 IF SHUNLO-TRIP-ID = SU001-MANIFEST               02999006
030000                    IF SU001-PACK-BY-STORE                        03000006
030010                       PERFORM 2242-PACK-BY-STORE-PROCESS         03001006
030020                    ELSE                                          03002006
030030                       PERFORM 2245-BULK-LABEL-ROUTINE            03003006
030040                    END-IF                                        03004006
030050                 ELSE                                             03005006
030060                    SET PS-DUPLICATE-FOUND                        03006006
030070                        PS-INVALID-INPUT TO TRUE                  03007006
030080                 END-IF                                           03008006
030090               ELSE                                               03009006
030100                  PERFORM 7220-SELECT-TPURCHS                     03010006
030110                  SET PS-NO-FLOWBACK-BYPASS-AUDIT TO TRUE         03011006
030120                  IF SU001-FLOWBACK-YES AND                       03012006
030130                     PS-NO-SULBXF-ROW-FOUND AND                   03013006
030140                     PV-DB2-COUNT = 1 AND                         03014006
030150                    (PURCHS-PO-TYP-CDE = 'FB' OR                  03015006
030160                     PURCHS-PO-TYP-CDE = 'IF')                    03016006
030170                      SET PS-FLOWBACK-BYPASS-AUDIT TO TRUE        03017006
030180                      PERFORM 2245-BULK-LABEL-ROUTINE             03018006
030190                  ELSE                                            03019006
030200                      SET PS-DUPLICATE-FOUND                      03020006
030210                          PS-INVALID-INPUT TO TRUE                03021006
030220                  END-IF                                          03022006
030230               END-IF                                             03023006
030240            ELSE                                                  03024006
030250              IF ((SHPUNT-ORGN-OPER-UNT-ID = SU001-OPER-UNT-ID) OR03025006
030260                  (RECEIV-CURR-OPER-UNT-ID = SU001-OPER-UNT-ID))  03026006
030270                  AND  PS-RECITM-VERIFIED-LINES-NO                03027006
030280                  PERFORM 2280-SELECT-STORE-FROM-XREF             03028006
030290                  IF SU001-AUTO-VE-YES AND PS-NO-SULBXF-ROW-FOUND 03029006
030300                     IF SHUNLO-TRIP-ID = SU001-MANIFEST           03030006
030310                        IF SU001-PACK-BY-STORE                    03031006
030320                           PERFORM 2242-PACK-BY-STORE-PROCESS     03032006
030330                        ELSE                                      03033006
030340                           PERFORM 2245-BULK-LABEL-ROUTINE        03034006
030350                        END-IF                                    03035006
030360                     ELSE                                         03036006
030370                          SET PS-DUPLICATE-FOUND                  03037006
030380                              PS-INVALID-INPUT TO TRUE            03038006
030390                     END-IF                                       03039006
030400                  ELSE                                            03040006
030410                     SET PS-DUPLICATE-FOUND                       03041006
030420                         PS-INVALID-INPUT TO TRUE                 03042006
030430                  END-IF                                          03043006
030440              ELSE                                                03044006
030450                     SET PS-DUPLICATE-FOUND                       03045006
030460                         PS-INVALID-INPUT                         03046006
030470                         SU001-WRONG-FCLTY TO TRUE                03047006
030480              END-IF                                              03048006
030490            END-IF                                                03049006
030500         END-IF.                                                  03050006
030510                                                                  03051006
030520 2242-PACK-BY-STORE-PROCESS.                                      03052006
030530******************************************************************03053006
030540       PERFORM  7230-GET-DEPT-CL-SKU                              03054006
030550       IF PS-INACTV-PBS-CARTON-YES                                03055006
030560          PERFORM 4500-CREATE-TROUBLE                             03056006
030570       END-IF                                                     03057006
030580       IF (NOT  SU001-NO-PRINTER)                                 03058006
030590          MOVE SHPUNT-DEST-OPER-UNT-ID                            03059006
030600                           TO SU001-STORE                         03060006
030610                              SU001-BAR-CODE-STORE                03061006
030620          IF PS-INACTV-PBS-CARTON-YES                             03062006
030630             PERFORM 7235-GET-OUTER-PACK                          03063006
030640             PERFORM 5005-PRINT-MESSAGE-LABELS                    03064006
030650          ELSE                                                    03065006
030660             SET PS-NO-TROUBLE-FOUND TO TRUE                      03066006
030670             IF SU001-RCVR-SEQ-NBR > 0                            03067006
030680                PERFORM 4450-CHECK-TROUBLE                        03068006
030690             END-IF                                               03069006
030700             IF PS-TROUBLE-FOUND                                  03070006
030710                PERFORM 4460-CHECK-PO-AUD-REQ                     03071006
030720                IF PS-AUDIT-PROMPT-CHECK-YES                      03072006
030730                   IF SU001-CRTN-ATT-TO-TRIP AND                  03073006
030740                                      SU001-CRTN-ATT-TO-RCVR      03074006
030750                      PERFORM 5000-PRINT-LABEL                    03075006
030760                   ELSE                                           03076006
030770                      PERFORM 4510-PROCESS-CHECK-RTV              03077006
030780                      IF PS-PBS-RTV-ALLOC OR PS-PBS-RTV-NO-ALLOC  03078006
030790                         IF SU001-AUTO-VE-YES AND PS-PBS-RTV-ALLOC03079006
030800                            PERFORM 7590-CREATE-RTV-OTBND         03080006
030810                         END-IF                                   03081006
030820                      ELSE                                        03082006
030830                         IF SU001-AUTO-VE-YES                     03083006
030840                            PERFORM 4250-LINK-TO-FRASTY-HANDLER   03084006
030850                         END-IF                                   03085006
030860                      END-IF                                      03086006
030870                      PERFORM 5005-PRINT-MESSAGE-LABELS           03087006
030880                   END-IF                                         03088006
030890                ELSE                                              03089006
030900                  IF SU001-RCVR-SEQ-NBR = 0 AND SU001-AUTO-VE-YES 03090006
030910                     IF PS-OPER-IS-ECOMM-STORE                    03091006
030920                        SET PS-ECOMM-STORE-NO-RCVR TO TRUE        03092006
030930                     ELSE                                         03093006
030940                        PERFORM 4250-LINK-TO-FRASTY-HANDLER       03094006
030950                     END-IF                                       03095006
030960                  END-IF                                          03096006
030970                  PERFORM 5005-PRINT-MESSAGE-LABELS               03097006
030980                END-IF                                            03098006
030990             ELSE                                                 03099006
031000                IF SU001-RCVR-SEQ-NBR = 0 AND SU001-AUTO-VE-YES   03100006
031010                   IF PS-OPER-IS-ECOMM-STORE                      03101006
031020                      SET PS-ECOMM-STORE-NO-RCVR TO TRUE          03102006
031030                   ELSE                                           03103006
031040                      PERFORM 4250-LINK-TO-FRASTY-HANDLER         03104006
031050                   END-IF                                         03105006
031060                   PERFORM 5005-PRINT-MESSAGE-LABELS              03106006
031070                ELSE                                              03107006
031080                   PERFORM 4510-PROCESS-CHECK-RTV                 03108006
031090                   IF PS-PBS-RTV-ALLOC OR PS-PBS-RTV-NO-ALLOC     03109006
031100                      IF SU001-AUTO-VE-YES AND PS-PBS-RTV-ALLOC   03110006
031110                         PERFORM 7590-CREATE-RTV-OTBND            03111006
031120                      END-IF                                      03112006
031130                      PERFORM 5005-PRINT-MESSAGE-LABELS           03113006
031140                   ELSE                                           03114006
031150                      IF SU001-CRTN-ATT-TO-TRIP AND               03115006
031160                                         SU001-CRTN-ATT-TO-RCVR   03116006
031170                         PERFORM 5000-PRINT-LABEL                 03117006
031180                      ELSE                                        03118006
031190                         IF SU001-AUTO-VE-YES                     03119006
031200                            PERFORM 4250-LINK-TO-FRASTY-HANDLER   03120006
031210                         END-IF                                   03121006
031220                         PERFORM 5005-PRINT-MESSAGE-LABELS        03122006
031230                      END-IF                                      03123006
031240                   END-IF                                         03124006
031250                END-IF                                            03125006
031260             END-IF                                               03126006
031270          END-IF                                                  03127006
031280       END-IF.                                                    03128006
031290******************************************************************03129006
031300 2245-BULK-LABEL-ROUTINE.                                         03130006
031310******************************************************************03131006
031320     INITIALIZE PV-MULTI-LINE-COUNT                               03132006
031330                DK-OUTER-QTY                                      03133006
031340                PV-TRN-LNE-NBR                                    03134006
031350                PV-HOLD-TRN-LNE-NBR.                              03135006
031360                                                                  03136006
031370     SET PS-NOT-FOUND-ON-CURSOR                                   03137006
031380         PS-FIRST-PO-LINE-FOR-CTN TO TRUE.                        03138006
031390                                                                  03139006
031400     IF (NOT  SU001-NO-PRINTER)                                   03140006
031410       IF SU001-AUTO-VE-YES AND SU001-RCVR-SEQ-NBR = 0            03141006
031420          PERFORM 4250-LINK-TO-FRASTY-HANDLER                     03142006
031430          SET PS-NOT-FOUND-ON-CURSOR TO TRUE                      03143006
031440       ELSE                                                       03144006
031450          IF RECEIV-PKGNG-CDE = PC-M OR PC-I                      03145006
031460            PERFORM 3685-CHECK-UCC128-USE                         03146006
031470            IF (DISTHD-TOT-CART-CNT > 0)   AND                    03147006
031480                  (DISTHD-UCC128-DAT-USG-CDE = 'U')               03148006
031490                PERFORM 2335-OPEN-ODD-UNITS-CSR                   03149006
031500                PERFORM 2340-FETCH-ODD-UNITS-CSR                  03150006
031510                  UNTIL PS-EO-ODD-UNTS-CSR OR                     03151006
031520                                PS-ODD-UNT-CRTN-FOUND             03152006
031530                PERFORM 2345-CLOSE-ODD-UNITS-CSR                  03153006
031540                MOVE 'PCK:' TO ALNEHDGO                           03154006
031550                IF PS-ODD-UNT-CRTN-FOUND                          03155006
031560                  CONTINUE                                        03156006
031570                ELSE                                              03157006
031580                  PERFORM 2350-OPEN-PREPK-CSR                     03158006
031590                  PERFORM 2360-FETCH-PREPK-CSR                    03159006
031600                    UNTIL PS-EO-PREPK-CSR OR                      03160006
031610                              PS-ODD-UNT-CRTN-FOUND               03161006
031620                  PERFORM 2370-CLOSE-PREPK-CSR                    03162006
031630                END-IF                                            03163006
031640            END-IF                                                03164006
031650          ELSE                                                    03165006
031660             PERFORM 2450-OPEN-UNITS-CSR                          03166006
031670             PERFORM 2460-FETCH-LINE-AND-UNITS                    03167006
031680               UNTIL PS-EO-UNITS-CSR                              03168006
031690             PERFORM 2470-CLOSE-UNITS-CSR                         03169006
031700          END-IF                                                  03170006
031710       END-IF                                                     03171006
031720                                                                  03172006
031730                                                                  03173006
031740       IF PS-ODD-UNT-CRTN-FOUND                                   03174006
031750        CONTINUE                                                  03175006
031760       ELSE                                                       03176006
031770       IF PS-FOUND-ON-CURSOR                                      03177006
031780             EVALUATE TRUE                                        03178006
031790             WHEN DISTHD-UCC128-DAT-USG-CDE = 'I'                 03179006
031800                 SET SU001-UCC128-IGNORED TO TRUE                 03180006
031810                 PERFORM 3600-CHECK-MESSAGE-TABLE                 03181006
031820                 SET PS-NO-CASEPK-FND TO TRUE                     03182006
031830                 PERFORM 5005-PRINT-MESSAGE-LABELS                03183006
031840             WHEN DISTHD-UCC128-DAT-USG-CDE = 'N'                 03184006
031850             WHEN DISTHD-UCC128-DAT-USG-CDE = ' '                 03185006
031860                 SET PS-NO-CASEPK-FND TO TRUE                     03186006
031870                 SET SU001-UCC128-NOT-AVAILABLE                   03187006
031880                                           TO TRUE                03188006
031890                 PERFORM 3600-CHECK-MESSAGE-TABLE                 03189006
031900                 PERFORM 5005-PRINT-MESSAGE-LABELS                03190006
031910                                                                  03191006
031920             WHEN DISTHD-UCC128-DAT-USG-CDE = 'U'                 03192006
031930                 IF SU001-LBL-REPRINT                             03193006
031940                    PERFORM 3655-REPRINT-LABELS                   03194006
031950                 ELSE                                             03195006
031960                    PERFORM 3500-GET-VIRTUAL-LABEL-DATA           03196006
031970                    IF PS-LABEL-DATA-FOUND                        03197006
031980                       IF PS-FREE-ASTRAY-MSG-LBL-NO               03198006
031990                         IF LBVRDA-CART-LBL-TYP-CDE = 'C' OR 'E'  03199006
032000                            PERFORM 3800-CHECK-RDM-BLIND-RCVNG    03200006
032010                         END-IF                                   03201006
032020                         PERFORM 3700-PRINT-VIRTUAL-LABELS        03202006
032030                       END-IF                                     03203006
032040                    ELSE                                          03204006
032050                       IF SU001-UCC128-NO-LABEL-DATA              03205006
032060                           CONTINUE                               03206006
032070                       ELSE                                       03207006
032080                         SET SU001-UCC128-UNABLE-TO-ASSIGN TO TRUE03208006
032090                         PERFORM 3600-CHECK-MESSAGE-TABLE         03209006
032100                       END-IF                                     03210006
032110                       SET PS-NO-CASEPK-FND TO TRUE               03211006
032120                       PERFORM 5005-PRINT-MESSAGE-LABELS          03212006
032130                    END-IF                                        03213006
032140                 END-IF                                           03214006
032150             END-EVALUATE                                         03215006
032160       ELSE                                                       03216006
032170******* NOT FOUND ON CURSOR, NO CSEPK PERFORMED                   03217006
032180          SET PS-NO-CASEPK-FND TO TRUE                            03218006
032190          PERFORM 7235-GET-OUTER-PACK                             03219006
032200          SET SU001-UCC128-GENERAL-MESS TO TRUE                   03220006
032210          PERFORM 5005-PRINT-MESSAGE-LABELS                       03221006
032220          PERFORM 3600-CHECK-MESSAGE-TABLE                        03222006
032230       END-IF                                                     03223006
032240     END-IF.                                                      03224006
032250                                                                  03225006
032260 2250-SELECT-SHPUNT.                                              03226006
032270                                                                  03227006
032280                                                                  03228006
032290     EXEC SQL                                                     03229006
032300         SELECT ORGN_OPER_UNT_ID,                                 03230006
032310                DEST_OPER_UNT_ID,                                 03231006
032320                SHIPT_UNT_SRC_ID,                                 03232006
032330                ACTV_IND                                          03233006
032340         INTO   :SHPUNT-ORGN-OPER-UNT-ID,                         03234006
032350                :SHPUNT-DEST-OPER-UNT-ID,                         03235006
032360                :SHPUNT-SHIPT-UNT-SRC-ID,                         03236006
032370                :SHPUNT-ACTV-IND                                  03237006
032380         FROM   TSHPUNT                                           03238006
032390         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             03239006
032400     END-EXEC.                                                    03240006
032410                                                                  03241006
032420     EVALUATE TRUE                                                03242006
032430         WHEN SQLCODE = ZERO                                      03243006
032440            IF SHPUNT-ACTV-IND = 'I'                              03244006
032450               SET PS-INACTV-CRTN-FND                             03245006
032460                   PS-CARTON-DOESNT-EXIST TO TRUE                 03246006
032470            ELSE                                                  03247006
032480              SET PS-CARTON-EXISTS TO TRUE                        03248006
032490            END-IF                                                03249006
032500                                                                  03250006
032510            IF SHPUNT-DEST-OPER-UNT-ID = 0                        03251006
032520                  MOVE SHPUNT-ORGN-OPER-UNT-ID TO                 03252006
032530                                        SHPUNT-DEST-OPER-UNT-ID   03253006
032540                                        PV-STORE                  03254006
032550                                        SU001-STORE               03255006
032560            ELSE                                                  03256006
032570                  MOVE SHPUNT-DEST-OPER-UNT-ID TO PV-STORE        03257006
032580                                                  SU001-STORE     03258006
032590            END-IF                                                03259006
032600            MOVE SHPUNT-ORGN-OPER-UNT-ID TO                       03260006
032610                                      SU001-ORIGIN-OPER-UNT-ID    03261006
032620            PERFORM 0500-CHECK-IF-DC                              03262006
032630         WHEN SQLCODE = +100                                      03263006
032640              SET PS-CARTON-DOESNT-EXIST TO TRUE                  03264006
032650              MOVE ZEROES TO SU001-PO                             03265006
032660                             SU001-RCVR-SEQ-NBR                   03266006
032670                             SU001-PO-LINE-NBR                    03267006
032680         WHEN SQLWARN0 NOT = SPACES                               03268006
032690         WHEN SQLCODE NOT EQUAL ZERO                              03269006
032700             MOVE '2250-SELECT-SHPUNT'                            03270006
032710                             TO DP013-PARAGRAPH                   03271006
032720             MOVE 'SUKRF502 - CHECK VALID CARTON'                 03272006
032730                             TO DP013-MESSAGE-TEXT(1)             03273006
032740             MOVE SHPUNT-SHIPT-UNT-ID                             03274006
032750                             TO DP013-MESSAGE-TEXT(2)             03275006
032760             MOVE SQLCA      TO DP013-SQLCA                       03276006
032770             MOVE 'TSHPUNT'  TO DP013-DB2-TABLE-NAME(1)           03277006
032780             SET DP013-DB2-ABEND                                  03278006
032790                             TO TRUE                              03279006
032800             SET DP013-ROLLBACK                                   03280006
032810                             TO TRUE                              03281006
032820             SET DP013-XCTL-DISPLAY-RESTART                       03282006
032830                             TO TRUE                              03283006
032840             PERFORM DP014-0000-PROCESS-ABEND                     03284006
032850     END-EVALUATE.                                                03285006
032860                                                                  03286006
032870                                                                  03287006
032880 2255-SELECT-SHUUPC.                                              03288006
032890                                                                  03289006
032900     EXEC SQL                                                     03290006
032910         SELECT DISTINCT                                          03291006
032920                TRN_NBR                                           03292006
032930              , TRN_LNE_NBR                                       03293006
032940         INTO   :SHUUPC-TRN-NBR                                   03294006
032950              , :SHUUPC-TRN-LNE-NBR                               03295006
032960         FROM   TSHUUPC                                           03296006
032970         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             03297006
032980     END-EXEC.                                                    03298006
032990*                                                                 03299006
033000     EVALUATE TRUE                                                03300006
033010         WHEN SQLCODE = ZERO                                      03301006
033020             MOVE SHUUPC-TRN-NBR     TO SU001-PO                  03302006
033030                                        PV-PO-N                   03303006
033040             MOVE SHUUPC-TRN-LNE-NBR TO SU001-PO-LINE-NBR         03304006
033050                                        PV-PO-LINE-N              03305006
033060                                        DK-PO-LNE-NBR             03306006
033070         WHEN SQLCODE = -811                                      03307006
033080             MOVE SHUUPC-TRN-NBR     TO SU001-PO                  03308006
033090             MOVE SHUUPC-TRN-LNE-NBR TO SU001-PO-LINE-NBR         03309006
033100             SET  SU001-MULTI-LINE   TO TRUE                      03310006
033110         WHEN SQLCODE = +100                                      03311006
033120             SET  SU001-NO-LINE           TO  TRUE                03312006
033130         WHEN SQLWARN0 NOT = SPACES                               03313006
033140         WHEN SQLCODE NOT EQUAL ZERO                              03314006
033150             MOVE '2255-SELECT-SHUUPC'                            03315006
033160                             TO DP013-PARAGRAPH                   03316006
033170             MOVE 'SUKRF502 - GET PO NBR        '                 03317006
033180                             TO DP013-MESSAGE-TEXT(1)             03318006
033190             MOVE SHPUNT-SHIPT-UNT-ID                             03319006
033200                             TO DP013-MESSAGE-TEXT(2)             03320006
033210             MOVE SQLCA      TO DP013-SQLCA                       03321006
033220             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           03322006
033230             SET DP013-DB2-ABEND                                  03323006
033240                             TO TRUE                              03324006
033250             SET DP013-ROLLBACK                                   03325006
033260                             TO TRUE                              03326006
033270             SET DP013-XCTL-DISPLAY-RESTART                       03327006
033280                             TO TRUE                              03328006
033290             PERFORM DP014-0000-PROCESS-ABEND                     03329006
033300     END-EVALUATE.                                                03330006
033310                                                                  03331006
033320                                                                  03332006
033330 2260-SELECT-TSHUNLO.                                             03333006
033340                                                                  03334006
033350     INITIALIZE PV-DB2-COUNT.                                     03335006
033360                                                                  03336006
033370     EXEC SQL                                                     03337006
033380         SELECT  TRIP_ID                                          03338006
033390         INTO   :SHUNLO-TRIP-ID                                   03339006
033400         FROM   TSHUNLO                                           03340006
033410         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             03341006
033420           AND  SCN_LOC_ID     = :PC-RECV                         03342006
033430     END-EXEC.                                                    03343006
033440                                                                  03344006
033450     EVALUATE TRUE                                                03345006
033460         WHEN SQLCODE = ZERO                                      03346006
033470         WHEN SQLCODE = -811                                      03347006
033480              MOVE +1 TO PV-DB2-COUNT                             03348006
033490         WHEN SQLCODE = +100                                      03349006
033500              CONTINUE                                            03350006
033510         WHEN SQLWARN0 NOT = SPACES                               03351006
033520         WHEN SQLCODE NOT EQUAL ZERO                              03352006
033530             MOVE '2260-SELECT-TSHUNLO'                           03353006
033540                             TO DP013-PARAGRAPH                   03354006
033550             MOVE 'SUKRF502 - CHECK VALID CARTON'                 03355006
033560                             TO DP013-MESSAGE-TEXT(1)             03356006
033570             MOVE SHPUNT-SHIPT-UNT-ID                             03357006
033580                             TO DP013-MESSAGE-TEXT(2)             03358006
033590             MOVE SQLCA      TO DP013-SQLCA                       03359006
033600             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           03360006
033610             SET DP013-DB2-ABEND                                  03361006
033620                             TO TRUE                              03362006
033630             SET DP013-ROLLBACK                                   03363006
033640                             TO TRUE                              03364006
033650             SET DP013-XCTL-DISPLAY-RESTART                       03365006
033660                             TO TRUE                              03366006
033670             PERFORM DP014-0000-PROCESS-ABEND                     03367006
033680     END-EVALUATE.                                                03368006
033690                                                                  03369006
033700* 07/19/13 RLK BEG                                                03370006
033710 2262-SELECT-CRTN-LBL-TSHUNLO.                                    03371006
033720                                                                  03372006
033730                                                                  03373006
033740     EXEC SQL                                                     03374006
033750         SELECT  TRIP_ID                                          03375006
033760                ,SCN_LOC_ID                                       03376006
033770         INTO   :SHUNLO-TRIP-ID                                   03377006
033780               ,:SHUNLO-SCN-LOC-ID                                03378006
033790         FROM   TSHUNLO A                                         03379006
033800         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             03380006
033810           AND A.SCN_LOC_ID  LIKE ('RFD%')                        03381006
033820           AND A.ACTV_CDE  = :PC-I                                03382006
033830           AND A.CRE_TMST =                                       03383006
033840              (SELECT MAX(B.CRE_TMST)                             03384006
033850               FROM TSHUNLO B                                     03385006
033860               WHERE  B.SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID     03386006
033870                 AND  B.ACTV_CDE  =:PC-I                          03387006
033880                 AND B.SCN_LOC_ID  LIKE ('RFD%'))                 03388006
033890     END-EXEC.                                                    03389006
033900                                                                  03390006
033910     EVALUATE TRUE                                                03391006
033920         WHEN SQLCODE = ZERO                                      03392006
033930             SET PS-CRTN-LBL-TSHUNLO-CREATED TO TRUE              03393006
033940         WHEN SQLCODE = -811                                      03394006
033950              CONTINUE                                            03395006
033960         WHEN SQLCODE = +100                                      03396006
033970             MOVE SPACE TO SHUNLO-SCN-LOC-ID                      03397006
033980         WHEN SQLWARN0 NOT = SPACES                               03398006
033990         WHEN SQLCODE NOT EQUAL ZERO                              03399006
034000             MOVE '2262-SELECT-CRTN-LBL-TSHUNLO'                  03400006
034010                             TO DP013-PARAGRAPH                   03401006
034020             MOVE 'SUKRF502 - CHECK VALID CARTON'                 03402006
034030                             TO DP013-MESSAGE-TEXT(1)             03403006
034040             MOVE SHPUNT-SHIPT-UNT-ID                             03404006
034050                             TO DP013-MESSAGE-TEXT(2)             03405006
034060             MOVE SQLCA      TO DP013-SQLCA                       03406006
034070             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           03407006
034080             SET DP013-DB2-ABEND                                  03408006
034090                             TO TRUE                              03409006
034100             SET DP013-ROLLBACK                                   03410006
034110                             TO TRUE                              03411006
034120             SET DP013-XCTL-DISPLAY-RESTART                       03412006
034130                             TO TRUE                              03413006
034140             PERFORM DP014-0000-PROCESS-ABEND                     03414006
034150     END-EVALUATE.                                                03415006
034160* 07/19/13 RLK END                                                03416006
034170                                                                  03417006
034180                                                                  03418006
034190 2265-CHECK-INACTV-PBS.                                           03419006
034200                                                                  03420006
034210                                                                  03421006
034220     EXEC SQL                                                     03422006
034230         SELECT  CRE_TMST                                         03423006
034240               , SCN_LOC_ID                                       03424006
034250         INTO   :PV-TSHUNLO-PBS-CRE-TMST :PV-NULL-CRE-TMST        03425006
034260               ,:PV-PBS-SCN-LOC-ID                                03426006
034270         FROM   TSHUNLO                                           03427006
034280         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             03428006
034290           AND  SCN_LOC_ID                                        03429006
034300                       IN ('PBSA','PBSB','PBSC','PBSD','PBSE')    03430006
034310     END-EXEC.                                                    03431006
034320                                                                  03432006
034330     EVALUATE TRUE                                                03433006
034340         WHEN SQLCODE = ZERO                                      03434006
034350         WHEN SQLCODE = -811                                      03435006
034360             IF PV-NULL-CRE-TMST = -1                             03436006
034370                SET PS-INACTV-PBS-CARTON-NO TO TRUE               03437006
034380             ELSE                                                 03438006
034390                SET PS-INACTV-PBS-CARTON-YES TO TRUE              03439006
034400                MOVE PV-TSHUNLO-PBS-CRE-TMST TO                   03440006
034410                                            PV-TSHUNLO-PBS-TMST-R 03441006
034420                MOVE SPACES          TO PV-PBS-TMST-SPACE         03442006
034430                                        PV-PBS-TMST-SPACE-2       03443006
034440                MOVE PC-COLON        TO PV-PBS-TMST-COLON         03444006
034450             END-IF                                               03445006
034460         WHEN SQLCODE = +100                                      03446006
034470                SET PS-INACTV-PBS-CARTON-NO TO TRUE               03447006
034480         WHEN SQLWARN0 NOT = SPACES                               03448006
034490         WHEN SQLCODE NOT EQUAL ZERO                              03449006
034500             MOVE '2265-CHECK-INACTV-PBS'                         03450006
034510                             TO DP013-PARAGRAPH                   03451006
034520             MOVE 'SUKRF502 - CHECK INACTV CARTON'                03452006
034530                             TO DP013-MESSAGE-TEXT(1)             03453006
034540             MOVE SHPUNT-SHIPT-UNT-ID                             03454006
034550                             TO DP013-MESSAGE-TEXT(2)             03455006
034560             MOVE SQLCA      TO DP013-SQLCA                       03456006
034570             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           03457006
034580             SET DP013-DB2-ABEND                                  03458006
034590                             TO TRUE                              03459006
034600             SET DP013-ROLLBACK                                   03460006
034610                             TO TRUE                              03461006
034620             SET DP013-XCTL-DISPLAY-RESTART                       03462006
034630                             TO TRUE                              03463006
034640             PERFORM DP014-0000-PROCESS-ABEND                     03464006
034650     END-EVALUATE.                                                03465006
034660                                                                  03466006
034670 2270-INSERT-TSHUNLO.                                             03467006
034680                                                                  03468006
034690     MOVE  SU001-FCLTY-ID       TO  DK-FCLTY-ID.                  03469006
034700     MOVE  SU001-MANIFEST       TO  DK-MANIFEST.                  03470006
034710     MOVE  SU001-BATCH-NUMBER   TO  DK-BATCH-NUMBER.              03471006
034720     MOVE  SU001-PRINTER-IND    TO  SHUNLO-PRTR-TYP-CDE.          03472006
034730                                                                  03473006
034740** 9/22/99 BEGIN                                                  03474006
034750*                                                                 03475006
034760* IF CARTON BEING PROCESSED IS MISD-DIRECT OR BULK NO LABEL       03476006
034770* WILL BE PROCESSED - PRTR-TYP-CDE SHOULD BE 'N'                  03477006
034780*                                                                 03478006
034790     IF  (NOT  SU001-NO-PRINTER)   AND                            03479006
034800          NOT SU001-MISDIRECT                                     03480006
034810             CONTINUE                                             03481006
034820     ELSE                                                         03482006
034830         MOVE  PC-N             TO  SHUNLO-PRTR-TYP-CDE           03483006
034840     END-IF.                                                      03484006
034850*                                                                 03485006
034860** 9/22/99 END                                                    03486006
034870                                                                  03487006
034880     MOVE PC-A                  TO  SHUNLO-ACTV-CDE               03488006
034890     MOVE PC-RECV               TO  SHUNLO-SCN-LOC-ID             03489006
034900                                                                  03490006
034910                                                                  03491006
034920     EXEC SQL                                                     03492006
034930         INSERT INTO TSHUNLO                                      03493006
034940               (SHIPT_UNT_ID                                      03494006
034950              , OPER_UNT_ID                                       03495006
034960              , FCLTY_ID                                          03496006
034970              , SCN_LOC_ID                                        03497006
034980              , CRE_USR_ID                                        03498006
034990              , CRE_TMST                                          03499006
035000              , TRIP_ID                                           03500006
035010              , PRTR_TYP_CDE                                      03501006
035020              , LBL_PRT_BTCH_ID                                   03502006
035030              , ACTV_CDE)                                         03503006
035040         VALUES (:SHPUNT-SHIPT-UNT-ID                             03504006
035050               , :SU001-OPER-UNT-ID                               03505006
035060               , :DK-FCLTY-ID                                     03506006
035070               , :PC-RECV                                         03507006
035080               , :SU001-USER-ID                                   03508006
035090               , CURRENT TIMESTAMP                                03509006
035100               , :DK-MANIFEST                                     03510006
035110               , :SHUNLO-PRTR-TYP-CDE                             03511006
035120               , :DK-BATCH-NUMBER                                 03512006
035130               , :SHUNLO-ACTV-CDE)                                03513006
035140     END-EXEC.                                                    03514006
035150                                                                  03515006
035160     EVALUATE TRUE                                                03516006
035170         WHEN SQLCODE = ZERO                                      03517006
035180             PERFORM 3569-SEL-MAX-CHECK-IN-TMST                   03518006
035190         WHEN SQLWARN0 NOT = SPACES                               03519006
035200         WHEN SQLCODE NOT EQUAL ZERO                              03520006
035210             MOVE '2270-INSERT-TSHUNLO'                           03521006
035220                             TO DP013-PARAGRAPH                   03522006
035230             MOVE 'SUKRF502 - INSERT SU LOCATION'                 03523006
035240                             TO DP013-MESSAGE-TEXT(1)             03524006
035250             MOVE SHPUNT-SHIPT-UNT-ID                             03525006
035260                             TO DP013-MESSAGE-TEXT(2)             03526006
035270             MOVE SQLCA      TO DP013-SQLCA                       03527006
035280             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           03528006
035290             SET DP013-DB2-ABEND                                  03529006
035300                             TO TRUE                              03530006
035310             SET DP013-ROLLBACK                                   03531006
035320                             TO TRUE                              03532006
035330             SET DP013-XCTL-DISPLAY-RESTART                       03533006
035340                             TO TRUE                              03534006
035350             PERFORM DP014-0000-PROCESS-ABEND                     03535006
035360     END-EVALUATE.                                                03536006
035370                                                                  03537006
035380* 07/19/13 RLK BEG                                                03538006
035390 2275-INSERT-CRTN-LBL-TSHUNLO.                                    03539006
035400                                                                  03540006
035410     MOVE  1                    TO  DK-FCLTY-ID.                  03541006
035420     MOVE  SU001-MANIFEST       TO  DK-MANIFEST.                  03542006
035430     MOVE  SU001-BATCH-NUMBER   TO  DK-BATCH-NUMBER.              03543006
035440     MOVE PC-N                  TO  SHUNLO-PRTR-TYP-CDE.          03544006
035450     MOVE  999999999999         TO  DK-MANIFEST.                  03545006
035460     MOVE PC-I                  TO  SHUNLO-ACTV-CDE               03546006
035470     MOVE PC-RFDC               TO  SHUNLO-SCN-LOC-ID             03547006
035480     MOVE 0                     TO  DK-BATCH-NUMBER.              03548006
035490                                                                  03549006
035500                                                                  03550006
035510     EXEC SQL                                                     03551006
035520         INSERT INTO TSHUNLO                                      03552006
035530               (SHIPT_UNT_ID                                      03553006
035540              , OPER_UNT_ID                                       03554006
035550              , FCLTY_ID                                          03555006
035560              , SCN_LOC_ID                                        03556006
035570              , CRE_USR_ID                                        03557006
035580              , CRE_TMST                                          03558006
035590              , TRIP_ID                                           03559006
035600              , PRTR_TYP_CDE                                      03560006
035610              , LBL_PRT_BTCH_ID                                   03561006
035620              , ACTV_CDE)                                         03562006
035630         VALUES (:SHPUNT-SHIPT-UNT-ID                             03563006
035640               , :SU001-OPER-UNT-ID                               03564006
035650               , :DK-FCLTY-ID                                     03565006
035660               , :SHUNLO-SCN-LOC-ID                               03566006
035670               , :SU001-USER-ID                                   03567006
035680               , CURRENT TIMESTAMP                                03568006
035690               , :DK-MANIFEST                                     03569006
035700               , :SHUNLO-PRTR-TYP-CDE                             03570006
035710               , :DK-BATCH-NUMBER                                 03571006
035720               , :SHUNLO-ACTV-CDE)                                03572006
035730     END-EXEC.                                                    03573006
035740                                                                  03574006
035750     EVALUATE TRUE                                                03575006
035760         WHEN SQLCODE = ZERO                                      03576006
035770             CONTINUE                                             03577006
035780         WHEN SQLWARN0 NOT = SPACES                               03578006
035790         WHEN SQLCODE NOT EQUAL ZERO                              03579006
035800             MOVE '2275-INSERT-CRTN-LBL-TSHUNLO'                  03580006
035810                             TO DP013-PARAGRAPH                   03581006
035820             MOVE 'SUKRF502 - INSERT SU LOCATION'                 03582006
035830                             TO DP013-MESSAGE-TEXT(1)             03583006
035840             MOVE SHPUNT-SHIPT-UNT-ID                             03584006
035850                             TO DP013-MESSAGE-TEXT(2)             03585006
035860             MOVE SQLCA      TO DP013-SQLCA                       03586006
035870             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           03587006
035880             SET DP013-DB2-ABEND                                  03588006
035890                             TO TRUE                              03589006
035900             SET DP013-ROLLBACK                                   03590006
035910                             TO TRUE                              03591006
035920             SET DP013-XCTL-DISPLAY-RESTART                       03592006
035930                             TO TRUE                              03593006
035940             PERFORM DP014-0000-PROCESS-ABEND                     03594006
035950     END-EVALUATE.                                                03595006
035960* 07/19/13 RLK END                                                03596006
035970                                                                  03597006
035980******************************************************************03598006
035990 2280-SELECT-STORE-FROM-XREF.                                     03599006
036000******************************************************************03600006
036010                                                                  03601006
036020                                                                  03602006
036030     EXEC SQL                                                     03603006
036040         SELECT  DEST_OPER_UNT_ID                                 03604006
036050         INTO   :SULBXF-DEST-OPER-UNT-ID                          03605006
036060         FROM   TSULBXF                                           03606006
036070         WHERE  SHIPT_UNT_ID   = :DK-CTN                          03607006
036080           AND  STAT_CDE       = 'A'                              03608006
036090     END-EXEC.                                                    03609006
036100                                                                  03610006
036110     EVALUATE TRUE                                                03611006
036120         WHEN SQLCODE = ZERO                                      03612006
036130         WHEN SQLCODE = -811                                      03613006
036140             MOVE SULBXF-DEST-OPER-UNT-ID TO SU001-STORE          03614006
036150             SET PS-SULBXF-ROW-FOUND TO TRUE                      03615006
036160         WHEN SQLCODE = +100                                      03616006
036170             SET PS-NO-SULBXF-ROW-FOUND TO TRUE                   03617006
036180         WHEN SQLWARN0 NOT = SPACES                               03618006
036190         WHEN SQLCODE NOT EQUAL ZERO                              03619006
036200             MOVE '2280-SELECT-STORE-FROM-XREF'                   03620006
036210                             TO DP013-PARAGRAPH                   03621006
036220             MOVE 'SUKRF502 - CHECK VALID CARTON'                 03622006
036230                             TO DP013-MESSAGE-TEXT(1)             03623006
036240             MOVE SHPUNT-SHIPT-UNT-ID                             03624006
036250                             TO DP013-MESSAGE-TEXT(2)             03625006
036260             MOVE SQLCA      TO DP013-SQLCA                       03626006
036270             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           03627006
036280             SET DP013-DB2-ABEND                                  03628006
036290                             TO TRUE                              03629006
036300             SET DP013-ROLLBACK                                   03630006
036310                             TO TRUE                              03631006
036320             SET DP013-XCTL-DISPLAY-RESTART                       03632006
036330                             TO TRUE                              03633006
036340             PERFORM DP014-0000-PROCESS-ABEND                     03634006
036350     END-EVALUATE.                                                03635006
036360                                                                  03636006
036370                                                                  03637006
036380                                                                  03638006
036390 2285-CALL-DLKUP001-ASGMT-MOD.                                    03639006
036400                                                                  03640006
036410     INITIALIZE DL001-ASGMT-COMMAREA.                             03641006
036420     SET DL001-BY-ASGMT-KEY                                       03642006
036430         DL001-COMMIT-UPDATE                                      03643006
036440         DL001-FIND-NEXT-ASGMT    TO TRUE.                        03644006
036450     MOVE SU001-ASGMT-STRT-DTE    TO DL001-KEY-START-DTE.         03645006
036460     MOVE SU001-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT.           03646006
036470     MOVE SU001-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR.       03647006
036480     MOVE +1                      TO DL001-NBR-OF-NBRS-NEED-QTY.  03648006
036490     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   03649006
036500                                                                  03650006
036510     CALL DL001-USER-PGM USING DFHEIBLK                           03651006
036520                              DL001-COMMAREA                      03652006
036530                              DL001-ASGMT-COMMAREA.               03653006
036540                                                                  03654006
036550     EVALUATE TRUE                                                03655006
036560         WHEN DL001-SUCCESSFUL                                    03656006
036570              MOVE DL001-SEQ-START-NBR                            03657006
036580                                   TO SU001-SEQ-START-NBR         03658006
036590              IF DL001-ASGMT-NEXT-USED                            03659006
036600                 MOVE DL001-NXT-START-DTE                         03660006
036610                               TO SU001-ASGMT-STRT-DTE            03661006
036620                 MOVE DL001-NXT-NBR-TXT                           03662006
036630                               TO SU001-ASGMT-NBR-TXT             03663006
036640                 MOVE DL001-NXT-NBR-SEQ-NBR                       03664006
036650                               TO SU001-ASGMT-NBR-SEQ-NBR         03665006
036660                 PERFORM 2286-CALL-DLKUT001                       03666006
036670                 IF DL003-ASGMT-FOUND                             03667006
036680                     CONTINUE                                     03668006
036690                 ELSE                                             03669006
036700                     SET SU001-ASGMT-CLOSED-RETURN TO TRUE        03670006
036710                     MOVE SPACES TO SU001-ASGMT-STRT-DTE          03671006
036720                     MOVE PC-SU-MESSAGE-PGM                       03672006
036730                                   TO PV-TRANSFER-PROGRAM         03673006
036740                     PERFORM 4000-XCTL-LRT-MENU                   03674006
036750                 END-IF                                           03675006
036760              END-IF                                              03676006
036770         WHEN DL001-ASGMT-CLOSED-RETURN                           03677006
036780              SET SU001-ASGMT-CLOSED-RETURN TO TRUE               03678006
036790              MOVE SPACES TO SU001-ASGMT-STRT-DTE                 03679006
036800              MOVE PC-SU-MESSAGE-PGM                              03680006
036810                                  TO PV-TRANSFER-PROGRAM          03681006
036820              PERFORM 4000-XCTL-LRT-MENU                          03682006
036830         WHEN OTHER                                               03683006
036840              SET PV-DONE-PROCESSING          TO TRUE             03684006
036850              MOVE DL001-RETURN-SQLCODES TO PV-SQLCODE            03685006
036860              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      03686006
036870               '2285-CALL-DLKUP001-ASGMT ' DELIMITED BY SIZE      03687006
036880                     'DL001-RETURN-CODE-'  DELIMITED BY SIZE      03688006
036890                     DL001-RETURN-CODE     DELIMITED BY SIZE      03689006
036900                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      03690006
036910                       PV-SQLCODE          DELIMITED BY SIZE      03691006
036920                                      INTO PV-CICS-MSG-AREA       03692006
036930              MOVE LENGTH OF PV-CICS-MSG-AREA                     03693006
036940                                        TO PV-COMMAREA-LENGTH     03694006
036950              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03695006
036960                                                                  03696006
036970              MOVE  '2285-CALL-DLKUP001-ASGMT '                   03697006
036980                              TO DP013-PARAGRAPH                  03698006
036990              MOVE 'CALL TO DLKUP001'                             03699006
037000                              TO DP013-MESSAGE-TEXT(1)            03700006
037010              MOVE 'CHECK CSSL FOR MORE DETAIL     '              03701006
037020                                TO DP013-MESSAGE-TEXT (2)         03702006
037030              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         03703006
037040              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           03704006
037050              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            03705006
037060              STRING ' TRIP - '           DELIMITED BY SIZE       03706006
037070                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       03707006
037080                     '  CARTON - '        DELIMITED BY SIZE       03708006
037090                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       03709006
037100                     '  STORE - '         DELIMITED BY SIZE       03710006
037110                     PV-DISPLAY-STORE     DELIMITED BY SIZE       03711006
037120                              INTO DP013-MESSAGE-TEXT (3)         03712006
037130              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      03713006
037140               '2285-CALL-DLKUP001-ASGMT ' DELIMITED BY SIZE      03714006
037150                     'DL001-RETURN-CODE-'  DELIMITED BY SIZE      03715006
037160                     DL001-RETURN-CODE     DELIMITED BY SIZE      03716006
037170                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      03717006
037180                       PV-SQLCODE          DELIMITED BY SIZE      03718006
037190                              INTO DP013-MESSAGE-TEXT (4)         03719006
037200              MOVE DL001-SQLCA    TO DP013-SQLCA                  03720006
037210              SET DP013-DB2-ABEND                                 03721006
037220                              TO TRUE                             03722006
037230              SET DP013-ROLLBACK                                  03723006
037240                              TO TRUE                             03724006
037250              SET DP013-XCTL-DISPLAY-RESTART                      03725006
037260                              TO TRUE                             03726006
037270              PERFORM DP014-0000-PROCESS-ABEND                    03727006
037280     END-EVALUATE.                                                03728006
037290                                                                  03729006
037300*-----------------------------------------------------------------03730006
037310*  CALL DLKUT001 TO DETERMINE IF THE REQUESTED ASSOCIATE IS      *03731006
037320*  CURRENTLY ACTIVE ON AN ACTIVE ASSIGNMENT.                     *03732006
037330*-----------------------------------------------------------------03733006
037340 2286-CALL-DLKUT001.                                              03734006
037350                                                                  03735006
037360     INITIALIZE  DL003-ASGMT-COMMAREA.                            03736006
037370                                                                  03737006
037380     MOVE SU001-USER-ID             TO DL003-KEY-USER-ID.         03738006
037390     MOVE PC-CURRENT-PROGRAM-NAME   TO DL003-ORIG-CALLING-PGM-NM. 03739006
037400     SET DL003-BY-USER-KEY TO TRUE.                               03740006
037410                                                                  03741006
037420     CALL DL003-USER-PGM USING DFHEIBLK                           03742006
037430                               DL003-COMMAREA                     03743006
037440                               DL003-ASGMT-COMMAREA.              03744006
037450                                                                  03745006
037460     EVALUATE TRUE                                                03746006
037470         WHEN DL003-SUCCESSFUL                                    03747006
037480             CONTINUE                                             03748006
037490         WHEN OTHER                                               03749006
037500              SET PV-DONE-PROCESSING          TO TRUE             03750006
037510              MOVE DL001-RETURN-SQLCODES TO PV-SQLCODE            03751006
037520              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      03752006
037530               '2286-CALL-DLKUT001-ASGMT ' DELIMITED BY SIZE      03753006
037540                     'DL003-RETURN-CODE-'  DELIMITED BY SIZE      03754006
037550                     DL003-RETURN-CODE     DELIMITED BY SIZE      03755006
037560                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      03756006
037570                       PV-SQLCODE          DELIMITED BY SIZE      03757006
037580                                      INTO PV-CICS-MSG-AREA       03758006
037590              MOVE LENGTH OF PV-CICS-MSG-AREA                     03759006
037600                                        TO PV-COMMAREA-LENGTH     03760006
037610              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03761006
037620                                                                  03762006
037630              MOVE  '2286-CALL-DLKUT001-ASGMT '                   03763006
037640                              TO DP013-PARAGRAPH                  03764006
037650              MOVE 'CALL TO DLKUT001'                             03765006
037660                              TO DP013-MESSAGE-TEXT(1)            03766006
037670              MOVE 'CHECK CSSL FOR MORE DETAIL     '              03767006
037680                                TO DP013-MESSAGE-TEXT (2)         03768006
037690              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         03769006
037700              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           03770006
037710              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            03771006
037720              STRING ' TRIP - '           DELIMITED BY SIZE       03772006
037730                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       03773006
037740                     '  CARTON - '        DELIMITED BY SIZE       03774006
037750                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       03775006
037760                     '  STORE - '         DELIMITED BY SIZE       03776006
037770                     PV-DISPLAY-STORE     DELIMITED BY SIZE       03777006
037780                              INTO DP013-MESSAGE-TEXT (3)         03778006
037790              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      03779006
037800               '2286-CALL-DLKUT001-ASGMT ' DELIMITED BY SIZE      03780006
037810                     'DL003-RETURN-CODE-'  DELIMITED BY SIZE      03781006
037820                     DL003-RETURN-CODE     DELIMITED BY SIZE      03782006
037830                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      03783006
037840                       PV-SQLCODE          DELIMITED BY SIZE      03784006
037850                              INTO DP013-MESSAGE-TEXT (4)         03785006
037860              MOVE DL001-SQLCA    TO DP013-SQLCA                  03786006
037870              SET DP013-DB2-ABEND                                 03787006
037880                              TO TRUE                             03788006
037890              SET DP013-ROLLBACK                                  03789006
037900                              TO TRUE                             03790006
037910              SET DP013-XCTL-DISPLAY-RESTART                      03791006
037920                              TO TRUE                             03792006
037930              PERFORM DP014-0000-PROCESS-ABEND                    03793006
037940     END-EVALUATE.                                                03794006
037950                                                                  03795006
037960 2290-INSERT-TSHPUNT.                                             03796006
037970                                                                  03797006
037980     EXEC SQL                                                     03798006
037990         INSERT INTO TSHPUNT                                      03799006
038000               (SHIPT_UNT_ID,                                     03800006
038010                ORGN_OPER_UNT_ID,                                 03801006
038020                ORGN_FCLTY_ID,                                    03802006
038030                DEST_OPER_UNT_ID,                                 03803006
038040                DEST_FCLTY_ID,                                    03804006
038050                SHIPT_UNT_SRC_ID,                                 03805006
038060                HIER_LVL_CDE,                                     03806006
038070                NEXT_SHIPT_UNT_ID,                                03807006
038080                ORIG_SHIPT_UNT_ID,                                03808006
038090                ACTV_IND,                                         03809006
038100                CRE_DTE,                                          03810006
038110                CRE_TM,                                           03811006
038120                CRE_USR_ID,                                       03812006
038130                CRE_PGM_NM)                                       03813006
038140         VALUES                                                   03814006
038150               (:SHPUNT-SHIPT-UNT-ID,                             03815006
038160                :SHPUNT-ORGN-OPER-UNT-ID,                         03816006
038170                :SHPUNT-ORGN-FCLTY-ID,                            03817006
038180                :SHPUNT-DEST-OPER-UNT-ID,                         03818006
038190                :SHPUNT-DEST-FCLTY-ID,                            03819006
038200                :SHPUNT-SHIPT-UNT-SRC-ID,                         03820006
038210                :SHPUNT-HIER-LVL-CDE,                             03821006
038220                :SHPUNT-NEXT-SHIPT-UNT-ID,                        03822006
038230                :SHPUNT-ORIG-SHIPT-UNT-ID,                        03823006
038240                :SHPUNT-ACTV-IND,                                 03824006
038250                CURRENT DATE,                                     03825006
038260                CURRENT TIME,                                     03826006
038270                :SHPUNT-CRE-USR-ID,                               03827006
038280                :SHPUNT-CRE-PGM-NM)                               03828006
038290     END-EXEC.                                                    03829006
038300                                                                  03830006
038310     EVALUATE TRUE                                                03831006
038320         WHEN SQLCODE = ZERO                                      03832006
038330             CONTINUE                                             03833006
038340         WHEN SQLWARN0 NOT = SPACES                               03834006
038350         WHEN SQLCODE NOT EQUAL ZERO                              03835006
038360             MOVE '2290-INSERT-TSHPUNT'                           03836006
038370                             TO DP013-PARAGRAPH                   03837006
038380             MOVE 'SUKRF502 - INSERT SHIPPING UNIT'               03838006
038390                             TO DP013-MESSAGE-TEXT(1)             03839006
038400             MOVE SHPUNT-SHIPT-UNT-ID                             03840006
038410                             TO DP013-MESSAGE-TEXT(2)             03841006
038420             MOVE SQLCA      TO DP013-SQLCA                       03842006
038430             MOVE 'TSHPUNT'  TO DP013-DB2-TABLE-NAME(1)           03843006
038440             SET DP013-DB2-ABEND                                  03844006
038450                             TO TRUE                              03845006
038460             SET DP013-ROLLBACK                                   03846006
038470                             TO TRUE                              03847006
038480             SET DP013-XCTL-DISPLAY-RESTART                       03848006
038490                             TO TRUE                              03849006
038500             PERFORM DP014-0000-PROCESS-ABEND                     03850006
038510     END-EVALUATE.                                                03851006
038520                                                                  03852006
038530                                                                  03853006
038540 2300-INSERT-TSHUUPC.                                             03854006
038550                                                                  03855006
038560     EXEC SQL                                                     03856006
038570         INSERT INTO TSHUUPC                                      03857006
038580               (SHIPT_UNT_ID,                                     03858006
038590                TRN_NBR,                                          03859006
038600                TRN_LNE_NBR,                                      03860006
038610                TRN_TYP_CDE,                                      03861006
038620                UPC_NBR,                                          03862006
038630                SHPD_QTY)                                         03863006
038640         VALUES                                                   03864006
038650               (:SHUUPC-SHIPT-UNT-ID,                             03865006
038660                :SHUUPC-TRN-NBR,                                  03866006
038670                :SHUUPC-TRN-LNE-NBR,                              03867006
038680                :SHUUPC-TRN-TYP-CDE,                              03868006
038690                :SHUUPC-UPC-NBR,                                  03869006
038700                :SHUUPC-SHPD-QTY)                                 03870006
038710     END-EXEC.                                                    03871006
038720                                                                  03872006
038730     EVALUATE TRUE                                                03873006
038740         WHEN SQLCODE = ZERO                                      03874006
038750             CONTINUE                                             03875006
038760         WHEN SQLWARN0 NOT = SPACES                               03876006
038770         WHEN SQLCODE NOT EQUAL ZERO                              03877006
038780             MOVE '2300-INSERT-TSHUUPC'                           03878006
038790                             TO DP013-PARAGRAPH                   03879006
038800             MOVE 'SUKRF502 - INSERT SHIP UNT UPC '               03880006
038810                             TO DP013-MESSAGE-TEXT(1)             03881006
038820             MOVE SHUUPC-SHIPT-UNT-ID                             03882006
038830                             TO DP013-MESSAGE-TEXT(2)             03883006
038840             MOVE SQLCA      TO DP013-SQLCA                       03884006
038850             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           03885006
038860             SET DP013-DB2-ABEND                                  03886006
038870                             TO TRUE                              03887006
038880             SET DP013-ROLLBACK                                   03888006
038890                             TO TRUE                              03889006
038900             SET DP013-XCTL-DISPLAY-RESTART                       03890006
038910                             TO TRUE                              03891006
038920             PERFORM DP014-0000-PROCESS-ABEND                     03892006
038930     END-EVALUATE.                                                03893006
038940                                                                  03894006
038950******************************************************************03895006
038960 2335-OPEN-ODD-UNITS-CSR.                                         03896006
038970     SET PS-NOT-ODD-UNT-CRTN-FOUND TO TRUE.                       03897006
038980     MOVE SU001-RCVR-SEQ-NBR  TO DK-REC-SEQ-NBR.                  03898006
038990                                                                  03899006
039000         EXEC SQL                                                 03900006
039010              OPEN ODD-UNITS-CSR                                  03901006
039020         END-EXEC                                                 03902006
039030                                                                  03903006
039040                                                                  03904006
039050         EVALUATE TRUE                                            03905006
039060             WHEN SQLCODE = ZERO                                  03906006
039070                 CONTINUE                                         03907006
039080             WHEN SQLWARN0 NOT = SPACES                           03908006
039090             WHEN SQLCODE < ZERO                                  03909006
039100             WHEN SQLCODE > ZERO                                  03910006
039110                 MOVE '2335-OPEN-ODD-UNITS-CSR'                   03911006
039120                                   TO DP013-PARAGRAPH             03912006
039130                 MOVE 'OPEN ODD UNITS CSR - '                     03913006
039140                                   TO DP013-MESSAGE-TEXT (1)      03914006
039150                 MOVE SQLCA        TO DP013-SQLCA                 03915006
039160                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    03916006
039170                 SET DP013-DB2-ABEND                              03917006
039180                     DP013-XCTL-DISPLAY-RESTART TO TRUE           03918006
039190                 SET DP013-ROLLBACK                               03919006
039200                                   TO TRUE                        03920006
039210                 PERFORM DP014-0000-PROCESS-ABEND                 03921006
039220         END-EVALUATE.                                            03922006
039230                                                                  03923006
039240 EJECT                                                            03924006
039250*----------------------------------------------------------------*03925006
039260*                                                                *03926006
039270*----------------------------------------------------------------*03927006
039280 2340-FETCH-ODD-UNITS-CSR.                                        03928006
039290                                                                  03929006
039300                                                                  03930006
039310     EXEC SQL                                                     03931006
039320        FETCH   ODD-UNITS-CSR                                     03932006
039330        INTO   :PV-UNION-TYPE                                     03933006
039340              ,:PV-TRN-LNE-NBR                                    03934006
039350              ,:RECITM-PREPK-ID                                   03935006
039360     END-EXEC.                                                    03936006
039370* PREPACK SHOULD BE ON BOTH TSHUUPC('A' UNION) AND TRECITM('B')   03937006
039380* THE FETCH SHOULD ALWAYS RETURN AN ROW FROM 'A' FOLLOWED BY A    03938006
039390* ROW FROM 'B'                                                    03939006
039400                                                                  03940006
039410     EVALUATE TRUE                                                03941006
039420       WHEN SQLCODE = ZEROS                                       03942006
039430            SET PS-FOUND-ON-ODD-UNTS-CSR TO TRUE                  03943006
039440                                                                  03944006
039450            IF PS-FIRST-ODD-UNTS-FETCH                            03945006
039460* FIRST CARTON CANNOT BE A 'B'                                    03946006
039470               IF PV-UNION-TYPE = 'B'                             03947006
039480                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               03948006
039490                  PERFORM 5005-PRINT-MESSAGE-LABELS               03949006
039500               ELSE                                               03950006
039510                  MOVE PV-UNION-TYPE TO PV-PREV-FETCH             03951006
039520                  MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE             03952006
039530                  SET PS-NOT-FIRST-ODD-UNTS-FETCH TO TRUE         03953006
039540               END-IF                                             03954006
039550            ELSE                                                  03955006
039560              IF PV-UNION-TYPE = PV-PREV-FETCH                    03956006
039570                 SET PS-ODD-UNT-CRTN-FOUND TO TRUE                03957006
039580                 PERFORM 5005-PRINT-MESSAGE-LABELS                03958006
039590              ELSE                                                03959006
039600                 IF PV-TRN-LNE-NBR = PV-PREV-LINE                 03960006
039610                     MOVE PV-UNION-TYPE  TO PV-PREV-FETCH         03961006
039620                     MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE          03962006
039630                 ELSE                                             03963006
039640** CHECK CASE WHERE 'A' FOLLOWED BY 'B' ARE THE SAME LINE         03964006
039650** THE LINE NUMBER SHOULD ONLY CHANGE WHEN THE PREV-FETCH = 'B'   03965006
039660                     IF PV-PREV-FETCH = 'A'                       03966006
039670                        SET PS-ODD-UNT-CRTN-FOUND TO TRUE         03967006
039680                        PERFORM 5005-PRINT-MESSAGE-LABELS         03968006
039690                     ELSE                                         03969006
039700                        MOVE PV-UNION-TYPE  TO PV-PREV-FETCH      03970006
039710                        MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE       03971006
039720                     END-IF                                       03972006
039730                 END-IF                                           03973006
039740              END-IF                                              03974006
039750            END-IF                                                03975006
039760                                                                  03976006
039770       WHEN SQLCODE = +100                                        03977006
039780                SET  PS-EO-ODD-UNTS-CSR  TO TRUE                  03978006
039790*CHECK TO SEE IF LAST PREPACK IS AN 'A' WITH NO 'B'               03979006
039800                IF PV-UNION-TYPE  = 'A'                           03980006
039810                   SET PS-ODD-UNT-CRTN-FOUND TO TRUE              03981006
039820                   PERFORM 5005-PRINT-MESSAGE-LABELS              03982006
039830                END-IF                                            03983006
039840       WHEN OTHER                                                 03984006
039850             MOVE '2340-FETCH-ODD-UNITS-CSR'                      03985006
039860                             TO DP013-PARAGRAPH                   03986006
039870             MOVE 'SUKRF502 - CHECK FOR NOT FOUND       '         03987006
039880                             TO DP013-MESSAGE-TEXT(1)             03988006
039890             MOVE SU001-PO                                        03989006
039900                             TO DP013-MESSAGE-TEXT(2)             03990006
039910             MOVE SU001-CARTON                                    03991006
039920                             TO DP013-MESSAGE-TEXT(3)             03992006
039930             MOVE SQLCA      TO DP013-SQLCA                       03993006
039940             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           03994006
039950             SET DP013-DB2-ABEND                                  03995006
039960                             TO TRUE                              03996006
039970             SET DP013-ROLLBACK                                   03997006
039980                             TO TRUE                              03998006
039990             SET DP013-XCTL-DISPLAY-RESTART                       03999006
040000                             TO TRUE                              04000006
040010             PERFORM DP014-0000-PROCESS-ABEND                     04001006
040020     END-EVALUATE.                                                04002006
040030                                                                  04003006
040040                                                                  04004006
040050 2345-CLOSE-ODD-UNITS-CSR.                                        04005006
040060                                                                  04006006
040070         EXEC SQL                                                 04007006
040080             CLOSE ODD-UNITS-CSR                                  04008006
040090         END-EXEC                                                 04009006
040100                                                                  04010006
040110                                                                  04011006
040120         EVALUATE TRUE                                            04012006
040130             WHEN SQLCODE = ZERO                                  04013006
040140                 CONTINUE                                         04014006
040150             WHEN SQLWARN0 NOT = SPACES                           04015006
040160             WHEN SQLCODE < ZERO                                  04016006
040170             WHEN SQLCODE > ZERO                                  04017006
040180                 MOVE '2370-CLOSE-ODD-UNITS-CSR'                  04018006
040190                                   TO DP013-PARAGRAPH             04019006
040200                 MOVE 'CLOSE ODD UNITS CSR - '                    04020006
040210                                   TO DP013-MESSAGE-TEXT (1)      04021006
040220                 MOVE SQLCA        TO DP013-SQLCA                 04022006
040230                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    04023006
040240                 SET DP013-DB2-ABEND                              04024006
040250                     DP013-XCTL-DISPLAY-RESTART TO TRUE           04025006
040260                 SET DP013-ROLLBACK                               04026006
040270                                   TO TRUE                        04027006
040280                 PERFORM DP014-0000-PROCESS-ABEND                 04028006
040290         END-EVALUATE.                                            04029006
040300                                                                  04030006
040310                                                                  04031006
040320 EJECT                                                            04032006
040330******************************************************************04033006
040340 2350-OPEN-PREPK-CSR.                                             04034006
040350                                                                  04035006
040360         EXEC SQL                                                 04036006
040370              OPEN PREPK-CSR                                      04037006
040380         END-EXEC                                                 04038006
040390                                                                  04039006
040400                                                                  04040006
040410         EVALUATE TRUE                                            04041006
040420             WHEN SQLCODE = ZERO                                  04042006
040430                 CONTINUE                                         04043006
040440             WHEN SQLWARN0 NOT = SPACES                           04044006
040450             WHEN SQLCODE < ZERO                                  04045006
040460             WHEN SQLCODE > ZERO                                  04046006
040470                 MOVE '2350-OPEN-PREPK-CSR'                       04047006
040480                                   TO DP013-PARAGRAPH             04048006
040490                 MOVE 'OPEN PREPK  CURSOR - '                     04049006
040500                                   TO DP013-MESSAGE-TEXT (1)      04050006
040510                 MOVE SQLCA        TO DP013-SQLCA                 04051006
040520                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    04052006
040530                 SET DP013-DB2-ABEND                              04053006
040540                     DP013-XCTL-DISPLAY-RESTART TO TRUE           04054006
040550                 SET DP013-ROLLBACK                               04055006
040560                                   TO TRUE                        04056006
040570                 PERFORM DP014-0000-PROCESS-ABEND                 04057006
040580         END-EVALUATE.                                            04058006
040590                                                                  04059006
040600 EJECT                                                            04060006
040610*----------------------------------------------------------------*04061006
040620*                                                                *04062006
040630*----------------------------------------------------------------*04063006
040640 2360-FETCH-PREPK-CSR.                                            04064006
040650                                                                  04065006
040660     MOVE  SU001-CARTON TO DK-CTN.                                04066006
040670     MOVE  ZERO   TO    DK-PO-LNE-NBR.                            04067006
040680                                                                  04068006
040690     EXEC SQL                                                     04069006
040700        FETCH   PREPK-CSR                                         04070006
040710        INTO   :SHUUPC-TRN-NBR                                    04071006
040720              ,:DISTHD-ORD-LNE-NBR                                04072006
040730              ,:RECITM-PREPK-ID                                   04073006
040740              ,:RECITM-PREPK-RATO-QTY                             04074006
040750              ,:SHUUPC-SHPD-QTY                                   04075006
040760              ,:DISTHD-PREPK-LNE-PRC-CDE                          04076006
040770              ,:DISTHD-UCC128-DAT-USG-CDE                         04077006
040780              ,:DISTHD-PRC-AREA-MODU-ID                           04078006
040790     END-EXEC.                                                    04079006
040800                                                                  04080006
040810     EVALUATE TRUE                                                04081006
040820       WHEN SQLCODE = ZEROS                                       04082006
040830            SET PS-FOUND-ON-CURSOR TO TRUE                        04083006
040840            IF DISTHD-UCC128-DAT-USG-CDE  = 'U'                   04084006
040850               DIVIDE SHUUPC-SHPD-QTY BY RECITM-PREPK-RATO-QTY    04085006
040860                      GIVING PV-MULTIPLE REMAINDER PV-REMAINDER   04086006
040870               IF PV-REMAINDER = 0                                04087006
040880                  IF PS-FIRST-PREPK                               04088006
040890                     MOVE PV-MULTIPLE TO PV-HOLD-MULTIPLE         04089006
040900                     SET PS-NOT-FIRST-PREPK TO TRUE               04090006
040910                  END-IF                                          04091006
040920               ELSE                                               04092006
040930                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               04093006
040940                  PERFORM 5005-PRINT-MESSAGE-LABELS               04094006
040950               END-IF                                             04095006
040960               IF PV-MULTIPLE NOT EQUAL PV-HOLD-MULTIPLE          04096006
040970                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               04097006
040980                  PERFORM 5005-PRINT-MESSAGE-LABELS               04098006
040990               END-IF                                             04099006
041000            END-IF                                                04100006
041010                                                                  04101006
041020            IF DISTHD-PREPK-LNE-PRC-CDE  = 'D'                    04102006
041030               MOVE DISTHD-ORD-LNE-NBR  TO  SU001-PO-LINE-NBR     04103006
041040                                            PV-PO-LINE-N          04104006
041050               PERFORM  7230-GET-DEPT-CL-SKU                      04105006
041060               PERFORM  7235-GET-OUTER-PACK                       04106006
041070***PV-OUTR-PACK-QTY POPULATES TLBPTDA AND DK-OUTER-QTY            04107006
041080***IS THE DRIVER LINE SHP-QTY USED IN SQL                         04108006
041090               MOVE SHUUPC-SHPD-QTY     TO  DK-OUTER-QTY          04109006
041100            END-IF                                                04110006
041110                                                                  04111006
041120            SET  SU001-MULTI-LINE    TO  TRUE                     04112006
041130            MOVE SHUUPC-TRN-NBR      TO  SU001-PO                 04113006
041140            MOVE RECITM-PREPK-ID     TO  SU001-PREPK-ID           04114006
041150                                         PV-PO-LINE-N             04115006
041160                                         DK-PREPK-ID              04116006
041170       WHEN SQLCODE = +100                                        04117006
041180                SET  PS-EO-PREPK-CSR TO TRUE                      04118006
041190       WHEN OTHER                                                 04119006
041200             MOVE '2360-FETCH-PREPK-CSR '                         04120006
041210                             TO DP013-PARAGRAPH                   04121006
041220             MOVE 'SUKRF502 - CHECK FOR NOT FOUND       '         04122006
041230                             TO DP013-MESSAGE-TEXT(1)             04123006
041240             MOVE SU001-PO                                        04124006
041250                             TO DP013-MESSAGE-TEXT(2)             04125006
041260             MOVE SU001-CARTON                                    04126006
041270                             TO DP013-MESSAGE-TEXT(3)             04127006
041280             MOVE SQLCA      TO DP013-SQLCA                       04128006
041290             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           04129006
041300             SET DP013-DB2-ABEND                                  04130006
041310                             TO TRUE                              04131006
041320             SET DP013-ROLLBACK                                   04132006
041330                             TO TRUE                              04133006
041340             SET DP013-XCTL-DISPLAY-RESTART                       04134006
041350                             TO TRUE                              04135006
041360             PERFORM DP014-0000-PROCESS-ABEND                     04136006
041370     END-EVALUATE.                                                04137006
041380                                                                  04138006
041390                                                                  04139006
041400 2370-CLOSE-PREPK-CSR.                                            04140006
041410                                                                  04141006
041420         EXEC SQL                                                 04142006
041430             CLOSE PREPK-CSR                                      04143006
041440         END-EXEC                                                 04144006
041450                                                                  04145006
041460                                                                  04146006
041470         EVALUATE TRUE                                            04147006
041480             WHEN SQLCODE = ZERO                                  04148006
041490                 CONTINUE                                         04149006
041500             WHEN SQLWARN0 NOT = SPACES                           04150006
041510             WHEN SQLCODE < ZERO                                  04151006
041520             WHEN SQLCODE > ZERO                                  04152006
041530                 MOVE '2370-CLOSE-UNITS-CSR'                      04153006
041540                                   TO DP013-PARAGRAPH             04154006
041550                 MOVE 'CLOSE PREPK  CURSOR - '                    04155006
041560                                   TO DP013-MESSAGE-TEXT (1)      04156006
041570                 MOVE SQLCA        TO DP013-SQLCA                 04157006
041580                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    04158006
041590                 SET DP013-DB2-ABEND                              04159006
041600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           04160006
041610                 SET DP013-ROLLBACK                               04161006
041620                                   TO TRUE                        04162006
041630                 PERFORM DP014-0000-PROCESS-ABEND                 04163006
041640         END-EVALUATE.                                            04164006
041650                                                                  04165006
041660                                                                  04166006
041670 2380-SELECT-PREPAK-INFO.                                         04167006
041680                                                                  04168006
041690     EXEC SQL                                                     04169006
041700          SELECT                                                  04170006
041710                 E.ORD_LNE_NBR                                    04171006
041720                ,D.PREPK_ID                                       04172006
041730          INTO  :DISTHD-ORD-LNE-NBR                               04173006
041740              , :RECITM-PREPK-ID                                  04174006
041750          FROM   TSHUUPC A                                        04175006
041760               , TINPKSU B                                        04176006
041770               , TPKSLIP C                                        04177006
041780               , TRECITM D                                        04178006
041790               , TDISTHD E                                        04179006
041800          WHERE A.SHIPT_UNT_ID = :DK-CTN                          04180006
041810          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    04181006
041820          AND  B.PO_NBR       = C.PO_NBR                          04182006
041830          AND  B.SEQ_NBR      = C.SEQ_NBR                         04183006
041840          AND  C.VER_STAT_CDE = 'A'                               04184006
041850          AND  C.PO_NBR       = D.ORD_NBR                         04185006
041860          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     04186006
041870          AND  C.REC_SEQ_NBR  = :PV-RCVR-SEQ-NBR                  04187006
041880          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     04188006
041890          AND  E.ORD_NBR      = C.PO_NBR                          04189006
041900          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     04190006
041910          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     04191006
041920          AND  E.TOT_CART_CNT > 0                                 04192006
041930          AND  E.PREPK_LNE_PRC_CDE  = 'D'                         04193006
041940     END-EXEC                                                     04194006
041950                                                                  04195006
041960     EVALUATE TRUE                                                04196006
041970       WHEN SQLCODE = ZEROS                                       04197006
041980               MOVE DISTHD-ORD-LNE-NBR  TO  PV-DRIVER-LINE-NO     04198006
041990       WHEN SQLCODE = +100                                        04199006
042000               MOVE +0                  TO  PV-DRIVER-LINE-NO     04200006
042010                                            RECITM-PREPK-ID       04201006
042020       WHEN OTHER                                                 04202006
042030             MOVE '2380-SELECT-PREPAK-INFO'                       04203006
042040                             TO DP013-PARAGRAPH                   04204006
042050             MOVE 'SUKRF502 - GET PREPACK INFO          '         04205006
042060                             TO DP013-MESSAGE-TEXT(1)             04206006
042070             MOVE SU001-PO                                        04207006
042080                             TO DP013-MESSAGE-TEXT(2)             04208006
042090             MOVE SU001-CARTON                                    04209006
042100                             TO DP013-MESSAGE-TEXT(3)             04210006
042110             MOVE SQLCA      TO DP013-SQLCA                       04211006
042120             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           04212006
042130             SET DP013-DB2-ABEND                                  04213006
042140                             TO TRUE                              04214006
042150             SET DP013-ROLLBACK                                   04215006
042160                             TO TRUE                              04216006
042170             SET DP013-XCTL-DISPLAY-RESTART                       04217006
042180                             TO TRUE                              04218006
042190             PERFORM DP014-0000-PROCESS-ABEND                     04219006
042200     END-EVALUATE.                                                04220006
042210                                                                  04221006
042220 EJECT                                                            04222006
042230*----------------------------------------------------------------*04223006
042240*  GET LABEL BATCH NUMBER                                        *04224006
042250*----------------------------------------------------------------*04225006
042260 2400-GET-BATCH-NUMBER.                                           04226006
042270                                                                  04227006
042280     MOVE  SU001-MANIFEST    TO  DK-MANIFEST.                     04228006
042290                                                                  04229006
042300     EXEC SQL                                                     04230006
042310         SELECT MAX(LBL_PRT_BTCH_ID)                              04231006
042320         INTO   :PV-MAX-USER-BATCH                                04232006
042330          FROM  TLBPTDA                                           04233006
042340          WHERE TRIP_ID           = :DK-MANIFEST                  04234006
042350            AND CRE_USR_ID        = :SU001-USER-ID                04235006
042360     END-EXEC.                                                    04236006
042370                                                                  04237006
042380     EVALUATE TRUE                                                04238006
042390         WHEN SQLCODE = ZERO                                      04239006
042400             IF  PV-MAX-USER-BATCH  >  ZERO                       04240006
042410                 CONTINUE                                         04241006
042420             ELSE                                                 04242006
042430                 MOVE  ZEROES  TO  PV-MAX-USER-BATCH              04243006
042440             END-IF                                               04244006
042450         WHEN SQLCODE = -305                                      04245006
042460             MOVE  ZEROES  TO  PV-MAX-USER-BATCH                  04246006
042470         WHEN SQLWARN0 NOT = SPACES                               04247006
042480         WHEN SQLCODE NOT EQUAL ZERO                              04248006
042490             MOVE '2400-GET-BATCH-NUMBER'                         04249006
042500                             TO DP013-PARAGRAPH                   04250006
042510             MOVE                                                 04251006
042520                'SUKRF502-GET HIGHEST BATCH NUMBER FOR TRIP/USER' 04252006
042530                             TO DP013-MESSAGE-TEXT(1)             04253006
042540             MOVE SU001-MANIFEST                                  04254006
042550                             TO DP013-MESSAGE-TEXT(2)             04255006
042560             MOVE SU001-USER-ID                                   04256006
042570                             TO DP013-MESSAGE-TEXT(3)             04257006
042580             MOVE SQLCA      TO DP013-SQLCA                       04258006
042590             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           04259006
042600             SET DP013-DB2-ABEND                                  04260006
042610                             TO TRUE                              04261006
042620             SET DP013-ROLLBACK                                   04262006
042630                             TO TRUE                              04263006
042640             SET DP013-XCTL-DISPLAY-RESTART                       04264006
042650                             TO TRUE                              04265006
042660             PERFORM DP014-0000-PROCESS-ABEND                     04266006
042670     END-EVALUATE.                                                04267006
042680                                                                  04268006
042690                                                                  04269006
042700*----------------------------------------------------------------*04270006
042710*  DETERMINE RECEIVER                                            *04271006
042720*----------------------------------------------------------------*04272006
042730 2410-DETERMINE-RECEIVER.                                         04273006
042740                                                                  04274006
042750     MOVE  PV-CTN-N  TO  DK-CTN.                                  04275006
042760     MOVE  ZEROES    TO  SU001-RCVR-SEQ-NBR.                      04276006
042770     MOVE  SU001-PO  TO  DK-PO.                                   04277006
042780                                                                  04278006
042790     INITIALIZE  PV-RCVR-SEQ-NBR                                  04279006
042800                 PV-CRTN-TRIP-ID                                  04280006
042810                 VHTRIP-OWNER-SCAC-ID                             04281006
042820                 VHTRIP-VEH-NBR                                   04282006
042830                 RECEIV-PACK-BY-ST-IND                            04283006
042840                 RECEIV-PKGNG-CDE                                 04284006
042850                 RECEIV-CURR-OPER-UNT-ID.                         04285006
042860                                                                  04286006
042870                                                                  04287006
042880     EXEC SQL                                                     04288006
042890         SELECT DISTINCT                                          04289006
042900                C.REC_SEQ_NBR                                     04290006
042910              , A.TRIP_ID                                         04291006
042920              , A.OWNER_SCAC_ID                                   04292006
042930              , A.VEH_NBR                                         04293006
042940              , D.PACK_BY_ST_IND                                  04294006
042950              , D.PKGNG_CDE                                       04295006
042960              , D.OPER_UNT_ID                                     04296006
042970              , D.CURR_OPER_UNT_ID                                04297006
042980              , D.CRE_OPER_UNT_ID                                 04298006
042990              , E.CRE_SRC_CDE                                     04299006
043000              , F.SEQ_NBR                                         04300006
043010              , E.ORIG_PKSL_SEQ_NBR                               04301006
043020              , E.PKSL_STAT_CDE                                   04302006
043030         INTO   :PV-RCVR-SEQ-NBR                                  04303006
043040              , :PV-CRTN-TRIP-ID                                  04304006
043050              , :VHTRIP-OWNER-SCAC-ID                             04305006
043060              , :VHTRIP-VEH-NBR         :PV-NULL-IND              04306006
043070              , :RECEIV-PACK-BY-ST-IND                            04307006
043080              , :RECEIV-PKGNG-CDE                                 04308006
043090              , :RECEIV-OPER-UNT-ID                               04309006
043100              , :RECEIV-CURR-OPER-UNT-ID                          04310006
043110              , :RECEIV-CRE-OPER-UNT-ID                           04311006
043120              , :PKSLIP-CRE-SRC-CDE                               04312006
043130              , :INPKSU-SEQ-NBR                                   04313006
043140              , :PKSLIP-ORIG-PKSL-SEQ-NBR                         04314006
043150              , :PKSLIP-PKSL-STAT-CDE                             04315006
043160          FROM  TVHTRIP A                                         04316006
043170              , TSHIPMT B                                         04317006
043180              , TSHPTPO C                                         04318006
043190              , TRECEIV D                                         04319006
043200              , TPKSLIP E                                         04320006
043210              , TINPKSU F                                         04321006
043220              , TSHPUNT G                                         04322006
043230          WHERE A.TRIP_ID           = B.TRIP_ID                   04323006
043240            AND C.SHIPT_ID          = B.SHIPT_ID                  04324006
043250            AND C.PO_NBR            = :DK-PO                      04325006
043260            AND C.PO_NBR            = D.ORD_NBR                   04326006
043270            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               04327006
043280            AND D.VER_STATUS_CDE    = 'A'                         04328006
043290            AND E.VER_STAT_CDE      = 'A'                         04329006
043300            AND C.PO_NBR            = E.PO_NBR                    04330006
043310            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               04331006
043320            AND E.PO_NBR            = F.PO_NBR                    04332006
043330            AND E.SEQ_NBR           = F.SEQ_NBR                   04333006
043340            AND F.SHIPT_UNT_ID      = :DK-CTN                     04334006
043350            AND F.SHIPT_UNT_ID      = G.SHIPT_UNT_ID              04335006
043360            AND G.ACTV_IND          = 'A'                         04336006
043370     END-EXEC.                                                    04337006
043380                                                                  04338006
043390     EVALUATE TRUE                                                04339006
043400         WHEN SQLCODE = ZERO                                      04340006
043410             SET   SU001-CRTN-ATT-TO-RCVR                         04341006
043420                   PS-RCVR-DATA-FOUND-YES                         04342006
043430                   SU044-UPDATE-RCVR-PKSLIP TO TRUE               04343006
043440             IF  PV-RCVR-SEQ-NBR  >  ZERO                         04344006
043450                 MOVE  PV-RCVR-SEQ-NBR  TO  SU001-RCVR-SEQ-NBR    04345006
043460                                            PV-RCVR-OUT           04346006
043470                 IF PKSLIP-PKSL-STAT-CDE = 'IN'                   04347006
043480                    SET   SU001-NOT-CRTN-ATT-TO-TRIP              04348006
043490                          SU044-UPDATE-PKSLIP-ONLY   TO TRUE      04349006
043500                 ELSE                                             04350006
043510                    IF  PV-CRTN-TRIP-ID  =  SU001-MANIFEST        04351006
043520                        SET   SU001-CRTN-ATT-TO-TRIP TO TRUE      04352006
043530                    ELSE                                          04353006
043540                        SET   SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE  04354006
043550                    END-IF                                        04355006
043560                 END-IF                                           04356006
043570             ELSE                                                 04357006
043580                 MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR             04358006
043590                                            PV-RCVR-OUT           04359006
043600                 SET   SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE         04360006
043610             END-IF                                               04361006
043620             MOVE RECEIV-PKGNG-CDE   TO  SU001-PKGNG-CDE          04362006
043630             MOVE RECEIV-PACK-BY-ST-IND TO                        04363006
043640                                         SU001-RECEIV-PBS-IND     04364006
043650             MOVE INPKSU-SEQ-NBR     TO  SU001-PKSL-SEQ-NBR       04365006
043660         WHEN SQLCODE = +100                                      04366006
043670             MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR                 04367006
043680             PERFORM 2420-CHECK-TPKSLIP-EXISTS                    04368006
043690             IF PV-DB2-PKSLIP-COUNT > 0                           04369006
043700                SET PS-UCC128-PKSLIP-ERROR-NO TO TRUE             04370006
043710             ELSE                                                 04371006
043720                SET PS-UCC128-PKSLIP-ERROR-YES TO TRUE            04372006
043730             END-IF                                               04373006
043740                                                                  04374006
043750             SET   SU001-NOT-CRTN-ATT-TO-RCVR                     04375006
043760                   SU001-NOT-CRTN-ATT-TO-TRIP                     04376006
043770                   PS-RCVR-DATA-FOUND-NO      TO TRUE             04377006
043780             SET   SU044-UPDATE-PKSLIP-ONLY   TO TRUE             04378006
043790         WHEN SQLCODE = -811                                      04379006
043800             PERFORM 2415-DETERMINE-RECEIVER-2                    04380006
043810                                                                  04381006
043820         WHEN SQLWARN0 NOT = SPACES                               04382006
043830         WHEN SQLCODE NOT EQUAL ZERO                              04383006
043840             MOVE '2410-DETERMINE-RECEIVER'                       04384006
043850                             TO DP013-PARAGRAPH                   04385006
043860             MOVE 'SUKRF502 - DETERMINE RECEIVER NUMBER '         04386006
043870                             TO DP013-MESSAGE-TEXT(1)             04387006
043880             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         04388006
043890             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           04389006
043900             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            04390006
043910             STRING ' TRIP - '            DELIMITED BY SIZE       04391006
043920                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       04392006
043930                    '  CARTON - '         DELIMITED BY SIZE       04393006
043940                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       04394006
043950                    '  STORE - '          DELIMITED BY SIZE       04395006
043960                    PV-DISPLAY-STORE      DELIMITED BY SIZE       04396006
043970                             INTO DP013-MESSAGE-TEXT (2)          04397006
043980             MOVE  SU001-PO       TO  PV-DISPLAY-PO               04398006
043990             STRING ' PO - '             DELIMITED BY SIZE        04399006
044000                    PV-DISPLAY-PO         DELIMITED BY SIZE       04400006
044010                    '  USERID - '         DELIMITED BY SIZE       04401006
044020                    SU001-USER-ID         DELIMITED BY SIZE       04402006
044030                             INTO DP013-MESSAGE-TEXT(3)           04403006
044040             MOVE SQLCA      TO DP013-SQLCA                       04404006
044050             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           04405006
044060             SET DP013-DB2-ABEND                                  04406006
044070                             TO TRUE                              04407006
044080             SET DP013-ROLLBACK                                   04408006
044090                             TO TRUE                              04409006
044100             SET DP013-XCTL-DISPLAY-RESTART                       04410006
044110                             TO TRUE                              04411006
044120             PERFORM DP014-0000-PROCESS-ABEND                     04412006
044130     END-EVALUATE.                                                04413006
044140                                                                  04414006
044150                                                                  04415006
044160*----------------------------------------------------------------*04416006
044170*  DETERMINE RECEIVER - SPECIFIC TRAILER                         *04417006
044180*----------------------------------------------------------------*04418006
044190 2415-DETERMINE-RECEIVER-2.                                       04419006
044200                                                                  04420006
044210     MOVE  PV-CTN-N       TO  DK-CTN.                             04421006
044220     MOVE  ZEROES         TO  SU001-RCVR-SEQ-NBR.                 04422006
044230     MOVE  SU001-PO       TO  DK-PO.                              04423006
044240     MOVE  SU001-MANIFEST TO  DK-MANIFEST.                        04424006
044250                                                                  04425006
044260     INITIALIZE  PV-RCVR-SEQ-NBR                                  04426006
044270                 PV-CRTN-TRIP-ID                                  04427006
044280                 VHTRIP-OWNER-SCAC-ID                             04428006
044290                 VHTRIP-VEH-NBR                                   04429006
044300                 RECEIV-PACK-BY-ST-IND                            04430006
044310                 RECEIV-PKGNG-CDE.                                04431006
044320                                                                  04432006
044330     EXEC SQL                                                     04433006
044340         SELECT DISTINCT                                          04434006
044350                C.REC_SEQ_NBR                                     04435006
044360              , A.TRIP_ID                                         04436006
044370              , A.OWNER_SCAC_ID                                   04437006
044380              , A.VEH_NBR                                         04438006
044390              , D.PACK_BY_ST_IND                                  04439006
044400              , D.PKGNG_CDE                                       04440006
044410              , F.SEQ_NBR                                         04441006
044420              , E.ORIG_PKSL_SEQ_NBR                               04442006
044430              , E.PKSL_STAT_CDE                                   04443006
044440         INTO   :PV-RCVR-SEQ-NBR                                  04444006
044450              , :PV-CRTN-TRIP-ID                                  04445006
044460              , :VHTRIP-OWNER-SCAC-ID                             04446006
044470              , :VHTRIP-VEH-NBR         :PV-NULL-IND              04447006
044480              , :RECEIV-PACK-BY-ST-IND                            04448006
044490              , :RECEIV-PKGNG-CDE                                 04449006
044500              , :INPKSU-SEQ-NBR                                   04450006
044510              , :PKSLIP-ORIG-PKSL-SEQ-NBR                         04451006
044520              , :PKSLIP-PKSL-STAT-CDE                             04452006
044530          FROM  TVHTRIP A                                         04453006
044540              , TSHIPMT B                                         04454006
044550              , TSHPTPO C                                         04455006
044560              , TRECEIV D                                         04456006
044570              , TPKSLIP E                                         04457006
044580              , TINPKSU F                                         04458006
044590              , TSHPUNT G                                         04459006
044600          WHERE A.TRIP_ID           = :DK-MANIFEST                04460006
044610            AND A.TRIP_ID           = B.TRIP_ID                   04461006
044620            AND C.SHIPT_ID          = B.SHIPT_ID                  04462006
044630            AND C.PO_NBR            = :DK-PO                      04463006
044640            AND C.PO_NBR            = D.ORD_NBR                   04464006
044650            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               04465006
044660            AND D.VER_STATUS_CDE    = 'A'                         04466006
044670            AND E.VER_STAT_CDE      = 'A'                         04467006
044680            AND C.PO_NBR            = E.PO_NBR                    04468006
044690            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               04469006
044700            AND E.PO_NBR            = F.PO_NBR                    04470006
044710            AND E.SEQ_NBR           = F.SEQ_NBR                   04471006
044720            AND F.SHIPT_UNT_ID      = :DK-CTN                     04472006
044730            AND F.SHIPT_UNT_ID      = G.SHIPT_UNT_ID              04473006
044740            AND G.ACTV_IND          = 'A'                         04474006
044750     END-EXEC.                                                    04475006
044760                                                                  04476006
044770     EVALUATE TRUE                                                04477006
044780         WHEN SQLCODE = ZERO                                      04478006
044790             SET   SU001-CRTN-ATT-TO-RCVR                         04479006
044800                   PS-RCVR-DATA-FOUND-YES                         04480006
044810                   SU044-UPDATE-RCVR-PKSLIP TO TRUE               04481006
044820             IF  PV-RCVR-SEQ-NBR  >  ZERO                         04482006
044830                 MOVE  PV-RCVR-SEQ-NBR  TO  SU001-RCVR-SEQ-NBR    04483006
044840                                            PV-RCVR-OUT           04484006
044850                 IF PKSLIP-PKSL-STAT-CDE = 'IN'                   04485006
044860                    SET   SU001-NOT-CRTN-ATT-TO-TRIP              04486006
044870                          SU044-UPDATE-PKSLIP-ONLY   TO TRUE      04487006
044880                 ELSE                                             04488006
044890                    IF  PV-CRTN-TRIP-ID  =  SU001-MANIFEST        04489006
044900                        SET SU001-CRTN-ATT-TO-TRIP TO TRUE        04490006
044910                    ELSE                                          04491006
044920                        SET SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE    04492006
044930                    END-IF                                        04493006
044940                 END-IF                                           04494006
044950             ELSE                                                 04495006
044960                 MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR             04496006
044970                                   PV-RCVR-OUT                    04497006
044980                 SET   SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE         04498006
044990             END-IF                                               04499006
045000             MOVE   RECEIV-PKGNG-CDE   TO  SU001-PKGNG-CDE        04500006
045010             MOVE   RECEIV-PACK-BY-ST-IND TO                      04501006
045020                                         SU001-RECEIV-PBS-IND     04502006
045030             MOVE INPKSU-SEQ-NBR     TO  SU001-PKSL-SEQ-NBR       04503006
045040                                                                  04504006
045050         WHEN SQLCODE = +100                                      04505006
045060             MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR                 04506006
045070             PERFORM 2420-CHECK-TPKSLIP-EXISTS                    04507006
045080             IF PV-DB2-PKSLIP-COUNT > 0                           04508006
045090                SET PS-UCC128-PKSLIP-ERROR-NO TO TRUE             04509006
045100             ELSE                                                 04510006
045110                SET PS-UCC128-PKSLIP-ERROR-YES TO TRUE            04511006
045120             END-IF                                               04512006
045130                                                                  04513006
045140             SET   SU001-NOT-CRTN-ATT-TO-RCVR                     04514006
045150                   SU001-NOT-CRTN-ATT-TO-TRIP                     04515006
045160                   PS-RCVR-DATA-FOUND-NO      TO TRUE             04516006
045170             SET   SU044-UPDATE-PKSLIP-ONLY   TO TRUE             04517006
045180         WHEN SQLWARN0 NOT = SPACES                               04518006
045190         WHEN SQLCODE NOT EQUAL ZERO                              04519006
045200             MOVE '2415-DETERMINE-RECEIVER-2'                     04520006
045210                             TO DP013-PARAGRAPH                   04521006
045220             MOVE 'SUKRF502 - DETERMINE RCVR NBR FOR MLT TRIPS'   04522006
045230                             TO DP013-MESSAGE-TEXT(1)             04523006
045240             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         04524006
045250             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           04525006
045260             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            04526006
045270             STRING ' TRIP - '            DELIMITED BY SIZE       04527006
045280                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       04528006
045290                    '  CARTON - '         DELIMITED BY SIZE       04529006
045300                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       04530006
045310                    '  STORE - '          DELIMITED BY SIZE       04531006
045320                    PV-DISPLAY-STORE      DELIMITED BY SIZE       04532006
045330                             INTO DP013-MESSAGE-TEXT (2)          04533006
045340             MOVE  SU001-PO       TO  PV-DISPLAY-PO               04534006
045350             STRING ' PO - '             DELIMITED BY SIZE        04535006
045360                    PV-DISPLAY-PO         DELIMITED BY SIZE       04536006
045370                    '  USERID - '         DELIMITED BY SIZE       04537006
045380                    SU001-USER-ID         DELIMITED BY SIZE       04538006
045390                             INTO DP013-MESSAGE-TEXT(3)           04539006
045400             MOVE SQLCA      TO DP013-SQLCA                       04540006
045410             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           04541006
045420             SET DP013-DB2-ABEND                                  04542006
045430                             TO TRUE                              04543006
045440             SET DP013-ROLLBACK                                   04544006
045450                             TO TRUE                              04545006
045460             SET DP013-XCTL-DISPLAY-RESTART                       04546006
045470                             TO TRUE                              04547006
045480             PERFORM DP014-0000-PROCESS-ABEND                     04548006
045490     END-EVALUATE.                                                04549006
045500                                                                  04550006
045510                                                                  04551006
045520 2420-CHECK-TPKSLIP-EXISTS.                                       04552006
045530                                                                  04553006
045540     MOVE ZEROES  TO PV-DB2-PKSLIP-COUNT.                         04554006
045550                                                                  04555006
045560     EXEC SQL                                                     04556006
045570         SELECT COUNT(*)                                          04557006
045580         INTO   :PV-DB2-PKSLIP-COUNT                              04558006
045590         FROM   TPKSLIP A                                         04559006
045600             ,  TINPKSU B                                         04560006
045610         WHERE B.SHIPT_UNT_ID  = :DK-CTN                          04561006
045620           AND A.PO_NBR        = :DK-PO                           04562006
045630           AND A.SEQ_NBR       = B.SEQ_NBR                        04563006
045640           AND A.VER_STAT_CDE  = 'A'                              04564006
045650     END-EXEC.                                                    04565006
045660                                                                  04566006
045670         EVALUATE TRUE                                            04567006
045680             WHEN SQLCODE = ZERO                                  04568006
045690             WHEN SQLCODE = +100                                  04569006
045700                  CONTINUE                                        04570006
045710             WHEN SQLWARN0 NOT = SPACES                           04571006
045720             WHEN SQLCODE < ZERO                                  04572006
045730             WHEN SQLCODE > ZERO                                  04573006
045740                 MOVE '2420-CHECK-TPKSLIP-EXISTS'                 04574006
045750                                   TO DP013-PARAGRAPH             04575006
045760                 MOVE 'SELECT FROM TABLE  - '                     04576006
045770                                   TO DP013-MESSAGE-TEXT (1)      04577006
045780                 MOVE SQLCA        TO DP013-SQLCA                 04578006
045790                 MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)    04579006
045800                 SET DP013-DB2-ABEND                              04580006
045810                     DP013-XCTL-DISPLAY-RESTART TO TRUE           04581006
045820                 SET DP013-ROLLBACK                               04582006
045830                                   TO TRUE                        04583006
045840                 PERFORM DP014-0000-PROCESS-ABEND                 04584006
045850         END-EVALUATE.                                            04585006
045860                                                                  04586006
045870                                                                  04587006
045880*----------------------------------------------------------------*04588006
045890*  CHECK IF THE CARTON HAS ANY LINES THAT HAVE BEEN VERIFIED     *04589006
045900*----------------------------------------------------------------*04590006
045910 2425-CHECK-VERIFIED-LINES.                                       04591006
045920                                                                  04592006
045930     SET  PS-RECITM-VERIFIED-LINES-NO  TO TRUE.                   04593006
045940     MOVE ZEROES               TO PV-VERIF-RECITM-COUNT.          04594006
045950     MOVE SU001-RCVR-SEQ-NBR   TO RECITM-REC-SEQ-NBR.             04595006
045960     MOVE SU001-CARTON         TO DK-CTN.                         04596006
045970                                                                  04597006
045980     EXEC SQL                                                     04598006
045990         SELECT COUNT(*)                                          04599006
046000         INTO   :PV-VERIF-RECITM-COUNT                            04600006
046010          FROM  TSHUUPC A                                         04601006
046020              , TRECITM B                                         04602006
046030          WHERE  A.SHIPT_UNT_ID    = :DK-CTN                      04603006
046040          AND    A.TRN_NBR     =  B.ORD_NBR                       04604006
046050          AND    A.TRN_LNE_NBR =  B.ORD_LNE_NBR                   04605006
046060          AND    B.REC_SEQ_NBR =  :RECITM-REC-SEQ-NBR             04606006
046070          AND    B.STATUS_CDE  =  'VE'                            04607006
046080          AND    B.VER_STATUS_CDE = 'A'                           04608006
046090     END-EXEC.                                                    04609006
046100                                                                  04610006
046110     EVALUATE TRUE                                                04611006
046120         WHEN SQLCODE = ZERO                                      04612006
046130         WHEN SQLCODE = +100                                      04613006
046140              IF PV-VERIF-RECITM-COUNT > 0                        04614006
046150                 SET PS-RECITM-VERIFIED-LINES-YES                 04615006
046160                     PS-ACTIVE-XREF-ROW-NOT-FOUND TO TRUE         04616006
046170                 PERFORM 3690-CHECK-SULBXF-FOR-ACTIVE             04617006
046180                 IF PS-ACTIVE-XREF-ROW-FOUND                      04618006
046190                    SET PS-RECITM-VERIFIED-LINES-NO TO TRUE       04619006
046200                 END-IF                                           04620006
046210              END-IF                                              04621006
046220         WHEN SQLWARN0 NOT = SPACES                               04622006
046230         WHEN SQLCODE NOT EQUAL ZERO                              04623006
046240             MOVE '2425-CHECK-VERIFIED-LINES'                     04624006
046250                             TO DP013-PARAGRAPH                   04625006
046260             MOVE 'SUKRF502 - CHECK FOR VERIFIED LINES '          04626006
046270                             TO DP013-MESSAGE-TEXT(1)             04627006
046280             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         04628006
046290             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           04629006
046300             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            04630006
046310             STRING ' TRIP - '            DELIMITED BY SIZE       04631006
046320                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       04632006
046330                    '  CARTON - '         DELIMITED BY SIZE       04633006
046340                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       04634006
046350                    '  STORE - '          DELIMITED BY SIZE       04635006
046360                    PV-DISPLAY-STORE      DELIMITED BY SIZE       04636006
046370                             INTO DP013-MESSAGE-TEXT (2)          04637006
046380             MOVE  SU001-PO       TO  PV-DISPLAY-PO               04638006
046390             STRING ' PO - '             DELIMITED BY SIZE        04639006
046400                    PV-DISPLAY-PO         DELIMITED BY SIZE       04640006
046410                    '  USERID - '         DELIMITED BY SIZE       04641006
046420                    SU001-USER-ID         DELIMITED BY SIZE       04642006
046430                             INTO DP013-MESSAGE-TEXT(3)           04643006
046440             MOVE SQLCA      TO DP013-SQLCA                       04644006
046450             MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(1)           04645006
046460             SET DP013-DB2-ABEND                                  04646006
046470                             TO TRUE                              04647006
046480             SET DP013-ROLLBACK                                   04648006
046490                             TO TRUE                              04649006
046500             SET DP013-XCTL-DISPLAY-RESTART                       04650006
046510                             TO TRUE                              04651006
046520             PERFORM DP014-0000-PROCESS-ABEND                     04652006
046530     END-EVALUATE.                                                04653006
046540                                                                  04654006
046550                                                                  04655006
046560 2450-OPEN-UNITS-CSR.                                             04656006
046570                                                                  04657006
046580     MOVE  SU001-CARTON TO DK-CTN.                                04658006
046590                                                                  04659006
046600     EXEC SQL                                                     04660006
046610          OPEN UNITS-CSR                                          04661006
046620     END-EXEC                                                     04662006
046630                                                                  04663006
046640                                                                  04664006
046650     EVALUATE TRUE                                                04665006
046660         WHEN SQLCODE = ZERO                                      04666006
046670             CONTINUE                                             04667006
046680         WHEN SQLWARN0 NOT = SPACES                               04668006
046690         WHEN SQLCODE < ZERO                                      04669006
046700         WHEN SQLCODE > ZERO                                      04670006
046710             MOVE '2450-OPEN-UNITS-CSR'                           04671006
046720                               TO DP013-PARAGRAPH                 04672006
046730             MOVE 'OPEN UNITS  CURSOR - '                         04673006
046740                               TO DP013-MESSAGE-TEXT (1)          04674006
046750             MOVE SQLCA        TO DP013-SQLCA                     04675006
046760             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        04676006
046770             SET DP013-DB2-ABEND                                  04677006
046780                 DP013-XCTL-DISPLAY-RESTART TO TRUE               04678006
046790             SET DP013-ROLLBACK                                   04679006
046800                               TO TRUE                            04680006
046810             PERFORM DP014-0000-PROCESS-ABEND                     04681006
046820     END-EVALUATE.                                                04682006
046830                                                                  04683006
046840 EJECT                                                            04684006
046850*----------------------------------------------------------------*04685006
046860*                                                                *04686006
046870*----------------------------------------------------------------*04687006
046880 2460-FETCH-LINE-AND-UNITS.                                       04688006
046890                                                                  04689006
046900     EXEC SQL                                                     04690006
046910        FETCH   UNITS-CSR                                         04691006
046920        INTO   :SHUUPC-SHPD-QTY                                   04692006
046930             , :PV-TRN-LNE-NBR                                    04693006
046940             , :DISTHD-UCC128-DAT-USG-CDE                         04694006
046950             , :DISTHD-PRC-AREA-MODU-ID                           04695006
046960                                                                  04696006
046970     END-EXEC.                                                    04697006
046980                                                                  04698006
046990     EVALUATE TRUE                                                04699006
047000       WHEN SQLCODE = ZEROS                                       04700006
047010            SET PS-FOUND-ON-CURSOR TO TRUE                        04701006
047020            PERFORM  7230-GET-DEPT-CL-SKU                         04702006
047030            ADD  SHUUPC-SHPD-QTY     TO  PV-SHPD-QTY-TOTAL        04703006
047040            IF PS-FIRST-PO-LINE-FOR-CTN                           04704006
047050               ADD +1 TO PV-MULTI-LINE-COUNT                      04705006
047060               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         04706006
047070               SET  PS-NOT-FIRST-PO-LINE-FOR-CTN TO TRUE          04707006
047080            END-IF                                                04708006
047090            IF PV-TRN-LNE-NBR = PV-HOLD-TRN-LNE-NBR               04709006
047100               CONTINUE                                           04710006
047110            ELSE                                                  04711006
047120               ADD +1 TO PV-MULTI-LINE-COUNT                      04712006
047130               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         04713006
047140            END-IF                                                04714006
047150       WHEN SQLCODE = +100                                        04715006
047160            EVALUATE TRUE                                         04716006
047170               WHEN PV-MULTI-LINE-COUNT = 0                       04717006
047180                 SET SU001-NO-LINE           TO  TRUE             04718006
047190               WHEN PV-MULTI-LINE-COUNT > 1                       04719006
047200                 SET  SU001-MULTI-LINE       TO  TRUE             04720006
047210               WHEN OTHER                                         04721006
047220                 CONTINUE                                         04722006
047230            END-EVALUATE                                          04723006
047240            SET  PS-EO-UNITS-CSR   TO TRUE                        04724006
047250            MOVE PV-SHPD-QTY-TOTAL TO SU001-OUTR-PACK-QTY         04725006
047260                                      PV-OUTR-PACK-QTY            04726006
047270                                      DK-OUTER-QTY                04727006
047280            MOVE ZEROES            TO PV-SHPD-QTY-TOTAL           04728006
047290       WHEN OTHER                                                 04729006
047300             MOVE '2460-FETCH-LINE-AND-UNITS'                     04730006
047310                             TO DP013-PARAGRAPH                   04731006
047320             MOVE 'SUKRF502 - CHECK FOR NOT FOUND       '         04732006
047330                             TO DP013-MESSAGE-TEXT(1)             04733006
047340             MOVE SU001-PO                                        04734006
047350                             TO DP013-MESSAGE-TEXT(2)             04735006
047360             MOVE SU001-CARTON                                    04736006
047370                             TO DP013-MESSAGE-TEXT(3)             04737006
047380             MOVE SQLCA      TO DP013-SQLCA                       04738006
047390             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           04739006
047400             SET DP013-DB2-ABEND                                  04740006
047410                             TO TRUE                              04741006
047420             SET DP013-ROLLBACK                                   04742006
047430                             TO TRUE                              04743006
047440             SET DP013-XCTL-DISPLAY-RESTART                       04744006
047450                             TO TRUE                              04745006
047460             PERFORM DP014-0000-PROCESS-ABEND                     04746006
047470     END-EVALUATE.                                                04747006
047480                                                                  04748006
047490                                                                  04749006
047500 2470-CLOSE-UNITS-CSR.                                            04750006
047510                                                                  04751006
047520     EXEC SQL                                                     04752006
047530         CLOSE UNITS-CSR                                          04753006
047540     END-EXEC                                                     04754006
047550                                                                  04755006
047560                                                                  04756006
047570     EVALUATE TRUE                                                04757006
047580         WHEN SQLCODE = ZERO                                      04758006
047590             CONTINUE                                             04759006
047600         WHEN SQLWARN0 NOT = SPACES                               04760006
047610         WHEN SQLCODE < ZERO                                      04761006
047620         WHEN SQLCODE > ZERO                                      04762006
047630             MOVE '2470-CLOSE-UNITS-CSR'                          04763006
047640                               TO DP013-PARAGRAPH                 04764006
047650             MOVE 'CLOSE UNITS  CURSOR - '                        04765006
047660                               TO DP013-MESSAGE-TEXT (1)          04766006
047670             MOVE SQLCA        TO DP013-SQLCA                     04767006
047680             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        04768006
047690             SET DP013-DB2-ABEND                                  04769006
047700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               04770006
047710             SET DP013-ROLLBACK                                   04771006
047720                               TO TRUE                            04772006
047730             PERFORM DP014-0000-PROCESS-ABEND                     04773006
047740     END-EVALUATE.                                                04774006
047750                                                                  04775006
047760                                                                  04776006
047770 EJECT                                                            04777006
047780**********************************************************        04778006
047790 3500-GET-VIRTUAL-LABEL-DATA.                                     04779006
047800**********************************************************        04780006
047810                                                                  04781006
047820     PERFORM                                                      04782006
047830         WITH TEST AFTER                                          04783006
047840         VARYING PV-RETRY-COUNTER                                 04784006
047850         FROM 1 BY 1                                              04785006
047860         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               04786006
047870                   OR PS-SUCCESSFUL-UPDATE                        04787006
047880                   OR PS-DONE)                                    04788006
047890                                                                  04789006
047900     EXEC SQL                                                     04790006
047910        SELECT   PREPK_ID                                         04791006
047920                ,LBL_ASG_SEQ_NBR                                  04792006
047930                ,CART_LBL_TYP_CDE                                 04793006
047940                ,PREPK_PRCG_LNE_NBR                               04794006
047950                ,INPK_UNT_QTY                                     04795006
047960                ,PREPK_RATO_QTY                                   04796006
047970                ,PREPK_UNT_QTY                                    04797006
047980                ,DEST_OPER_UNT_ID                                 04798006
047990                ,CSE_PK_QTY                                       04799006
048000                ,ODD_CART_IND                                     04800006
048010                ,INPK_CNVYB_IND                                   04801006
048020                ,LBL_TYP_LBL_SEQ_ID                               04802006
048030                ,LBL_TYP_TOT_QTY                                  04803006
048040                ,BRCDE_NBR                                        04804006
048050                ,STR_ZN_ID                                        04805006
048060                ,MODU_DESC                                        04806006
048070                ,ITM_NBR                                          04807006
048080                ,DEPT_DESC                                        04808006
048090                ,MAJ_CL_DESC                                      04809006
048100                ,SEASET_NM                                        04810006
048110                ,FIXT_ID                                          04811006
048120                ,LBL_TYP_CDE                                      04812006
048130                ,PRNT_CART_SEQ_ID                                 04813006
048140                ,STRG_AREA_CDE                                    04814006
048150                ,OTPK_UNT_QTY                                     04815006
048160                ,EAS_TAG_IND                                      04816006
048170                ,DOOR_ID                                          04817006
048180                ,HNG_FOLD_SEQ_NBR                                 04818006
048190                ,MDSE_PGM_DESC                                    04819006
048200*CLP 07/06/2105 START                                             04820008
048210                ,LBL_MSG_TXT                                      04821008
048220*CLP 07/06/2105 END                                               04822008
048230        INTO     :LBVRDA-PREPK-ID                                 04823006
048240                ,:LBVRDA-LBL-ASG-SEQ-NBR                          04824006
048250                ,:LBVRDA-CART-LBL-TYP-CDE                         04825006
048260                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       04826006
048270                ,:LBVRDA-INPK-UNT-QTY                             04827006
048280                ,:LBVRDA-PREPK-RATO-QTY                           04828006
048290                ,:LBVRDA-PREPK-UNT-QTY                            04829006
048300                ,:LBVRDA-DEST-OPER-UNT-ID                         04830006
048310                ,:LBVRDA-CSE-PK-QTY                               04831006
048320                ,:LBVRDA-ODD-CART-IND                             04832006
048330                ,:LBVRDA-INPK-CNVYB-IND                           04833006
048340                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       04834006
048350                ,:LBVRDA-LBL-TYP-TOT-QTY                          04835006
048360                ,:LBVRDA-BRCDE-NBR                                04836006
048370                ,:LBVRDA-STR-ZN-ID                                04837006
048380                ,:LBVRDA-MODU-DESC                                04838006
048390                ,:LBVRDA-ITM-NBR                                  04839006
048400                ,:LBVRDA-DEPT-DESC                                04840006
048410                ,:LBVRDA-MAJ-CL-DESC                              04841006
048420                ,:LBVRDA-SEASET-NM                                04842006
048430                ,:LBVRDA-FIXT-ID                                  04843006
048440                ,:LBVRDA-LBL-TYP-CDE                              04844006
048450                ,:LBVRDA-PRNT-CART-SEQ-ID                         04845006
048460                ,:LBVRDA-STRG-AREA-CDE                            04846006
048470                ,:LBVRDA-OTPK-UNT-QTY                             04847006
048480                ,:LBVRDA-EAS-TAG-IND                              04848006
048490                ,:LBVRDA-DOOR-ID                                  04849006
048500                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         04850006
048510                ,:LBVRDA-MDSE-PGM-DESC                            04851006
048520*CLP 07/06/2105 START                                             04852008
048530                ,:LBVRDA-LBL-MSG-TXT                              04853008
048540*CLP 07/06/2105 END                                               04854008
048550        FROM TLBVRDA A                                            04855006
048560        WHERE  A.PO_NBR                =  :DK-PO                  04856006
048570          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         04857006
048580          AND  A.PO_LNE_NBR            =  :DK-PO-LNE-NBR          04858006
048590          AND  A.PREPK_ID              =  :DK-PREPK-ID            04859006
048600          AND  A.OTPK_UNT_QTY          =  :DK-OUTER-QTY           04860006
048610          AND  A.LBL_ASG_IND           =  'N'                     04861006
048620          AND  A.LBL_TYP_CDE           =  'M'                     04862006
048630          AND  A.LBL_ASG_SEQ_NBR =                                04863006
048640             (SELECT  MIN(LBL_ASG_SEQ_NBR)                        04864006
048650                 FROM   TLBVRDA B                                 04865006
048660              WHERE B.PO_NBR            = A.PO_NBR                04866006
048670                    AND  B.RCVR_SEQ_NBR = A.RCVR_SEQ_NBR          04867006
048680                    AND  B.PO_LNE_NBR   = A.PO_LNE_NBR            04868006
048690                    AND  B.PREPK_ID     = A.PREPK_ID              04869006
048700                    AND  B.OTPK_UNT_QTY = A.OTPK_UNT_QTY          04870006
048710                    AND  B.LBL_ASG_IND  = A.LBL_ASG_IND           04871006
048720                    AND  A.LBL_TYP_CDE  = B.LBL_TYP_CDE)          04872006
048730     END-EXEC                                                     04873006
048740                                                                  04874006
048750         EVALUATE TRUE                                            04875006
048760             WHEN SQLCODE = ZERO                                  04876006
048770                PERFORM 3520-PROCESS-TLBVRDA                      04877006
048780             WHEN SQLCODE = +100                                  04878006
048790                SET SU001-UCC128-NO-LABEL-DATA TO TRUE            04879006
048800                PERFORM 3600-CHECK-MESSAGE-TABLE                  04880006
048810             WHEN SQLCODE = -904                                  04881006
048820             WHEN SQLCODE = -913                                  04882006
048830                 CONTINUE                                         04883006
048840             WHEN SQLWARN0 NOT = SPACES                           04884006
048850             WHEN SQLCODE < ZERO                                  04885006
048860             WHEN SQLCODE > ZERO                                  04886006
048870                 MOVE '3500-GET-VIRTUAL-LABEL-DATA'               04887006
048880                                   TO DP013-PARAGRAPH             04888006
048890                 MOVE 'UPDATE TABLE       - '                     04889006
048900                                   TO DP013-MESSAGE-TEXT (1)      04890006
048910                 MOVE SQLCA        TO DP013-SQLCA                 04891006
048920                 MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)    04892006
048930                 SET DP013-DB2-ABEND                              04893006
048940                     DP013-XCTL-DISPLAY-RESTART TO TRUE           04894006
048950                 SET DP013-ROLLBACK                               04895006
048960                                   TO TRUE                        04896006
048970                 PERFORM DP014-0000-PROCESS-ABEND                 04897006
048980         END-EVALUATE                                             04898006
048990     END-PERFORM.                                                 04899006
049000                                                                  04900006
049010 3520-PROCESS-TLBVRDA.                                            04901006
049020      SET PS-LABEL-DATA-FOUND                                     04902006
049030          PS-FREE-ASTRAY-MSG-LBL-NO TO TRUE.                      04903006
049040      IF SU001-CRTN-ATT-TO-TRIP AND SU001-CRTN-ATT-TO-RCVR        04904006
049050         PERFORM 3550-CONSUME-TABLE-ROW                           04905006
049060         IF PS-SUCCESSFUL-UPDATE                                  04906006
049070            MOVE LBVRDA-DEST-OPER-UNT-ID TO SU001-STORE           04907006
049080            PERFORM 7210-GET-STORE-INFO                           04908006
049090         END-IF                                                   04909006
049100      ELSE                                                        04910006
049110         SET PS-FREE-ASTRAY-MSG-LBL-YES                           04911006
049120             PS-DONE                    TO TRUE                   04912006
049130         IF SU001-AUTO-VE-YES                                     04913006
049140            SET PS-FREE-ASTRAY-PROCESS TO TRUE                    04914006
049150            PERFORM 4250-LINK-TO-FRASTY-HANDLER                   04915006
049160            PERFORM 5005-PRINT-MESSAGE-LABELS                     04916006
049170         ELSE                                                     04917006
049180            PERFORM 5005-PRINT-MESSAGE-LABELS                     04918006
049190         END-IF                                                   04919006
049200      END-IF.                                                     04920006
049210**********************************************************        04921006
049220 3550-CONSUME-TABLE-ROW.                                          04922006
049230**********************************************************        04923006
049240     EXEC SQL                                                     04924006
049250         UPDATE TLBVRDA                                           04925006
049260           SET LBL_ASG_IND     = 'Y'                              04926006
049270         WHERE PO_NBR          = :DK-PO                           04927006
049280           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  04928006
049290           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   04929006
049300           AND PREPK_ID        = :DK-PREPK-ID                     04930006
049310           AND LBL_ASG_SEQ_NBR = :LBVRDA-LBL-ASG-SEQ-NBR          04931006
049320           AND LBL_ASG_IND     = 'N'                              04932006
049330     END-EXEC.                                                    04933006
049340                                                                  04934006
049350                                                                  04935006
049360         EVALUATE TRUE                                            04936006
049370             WHEN SQLCODE = ZERO                                  04937006
049380                SET PS-SUCCESSFUL-UPDATE TO TRUE                  04938006
049390                MOVE LBVRDA-BRCDE-NBR  TO                         04939006
049400                                          DK-BARCODE-NBR          04940006
049410                MOVE LBVRDA-CART-LBL-TYP-CDE TO                   04941006
049420                                          DK-CART-LBL-TYP-CDE     04942006
049430                MOVE LBVRDA-DEST-OPER-UNT-ID TO                   04943006
049440                                          DK-DEST-OPER-UNT-ID     04944006
049450                MOVE LBVRDA-EAS-TAG-IND TO                        04945006
049460                                        PS-EAS-TAG-IND-FOUND-SW   04946006
049470                MOVE SU001-OPER-UNT-ID TO DK-OPER-UNT-ID          04947006
049480                PERFORM 7215-GET-ECOMM-DC-INFO                    04948006
049490                PERFORM 3560-CHECK-FOR-NEW-PO-LINE                04949006
049500                PERFORM 3570-POPULATE-CRTN-LBL-XREF               04950006
049510             WHEN SQLCODE = +100                                  04951006
049520                SET PS-NOT-SUCCESSFUL-UPDATE TO TRUE              04952006
049530             WHEN SQLCODE = -904                                  04953006
049540             WHEN SQLCODE = -913                                  04954006
049550                 CONTINUE                                         04955006
049560             WHEN SQLWARN0 NOT = SPACES                           04956006
049570             WHEN SQLCODE < ZERO                                  04957006
049580             WHEN SQLCODE > ZERO                                  04958006
049590                 MOVE '3550-CONSUME-TABLE-ROW'                    04959006
049600                                   TO DP013-PARAGRAPH             04960006
049610                 MOVE 'UPDATE TABLE       - '                     04961006
049620                                   TO DP013-MESSAGE-TEXT (1)      04962006
049630                 MOVE SQLCA        TO DP013-SQLCA                 04963006
049640                 MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)    04964006
049650                 SET DP013-DB2-ABEND                              04965006
049660                     DP013-XCTL-DISPLAY-RESTART TO TRUE           04966006
049670                 SET DP013-ROLLBACK                               04967006
049680                                   TO TRUE                        04968006
049690                 PERFORM DP014-0000-PROCESS-ABEND                 04969006
049700         END-EVALUATE.                                            04970006
049710                                                                  04971006
049720                                                                  04972006
049730 EJECT                                                            04973006
049740**********************************************************        04974006
049750 3560-CHECK-FOR-NEW-PO-LINE.                                      04975006
049760**********************************************************        04976006
049770     MOVE SU001-PO         TO   DK-PO.                            04977006
049780     MOVE SU001-MANIFEST   TO   DK-MANIFEST.                      04978006
049790     MOVE SU001-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                   04979006
049800     MOVE 'Q'              TO   DK-ERR-MSG-CDE.                   04980006
049810                                                                  04981006
049820     EXEC SQL                                                     04982006
049830         SELECT PO_NBR                                            04983006
049840              , CRE_TMST                                          04984006
049850         INTO   :LBVRMG-PO-NBR                                    04985006
049860              , :LBVRMG-CRE-TMST                                  04986006
049870         FROM   TLBVRMG                                           04987006
049880         WHERE PO_NBR          = :DK-PO                           04988006
049890           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  04989006
049900           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   04990006
049910           AND PREPK_ID        = :DK-PREPK-ID                     04991006
049920           AND TRIP_ID         = :DK-MANIFEST                     04992006
049930           AND ERR_MSG_CDE     = :DK-ERR-MSG-CDE                  04993006
049940     END-EXEC.                                                    04994006
049950                                                                  04995006
049960         EVALUATE TRUE                                            04996006
049970             WHEN SQLCODE = ZERO                                  04997006
049980                SET PS-DONT-PRINT-AUDIT-LABEL TO TRUE             04998006
049990             WHEN SQLCODE = +100                                  04999006
050000**GB 2/26/01 AFTER '2002-03-18' UNCOMMENT AND ONLY POPULATE       05000006
050010** WITH 'Q' ERRORS FOR ECOMM                                      05001006
050020*                                                                 05002006
050030*               IF PS-OPER-IS-ECOMM-DC                            05003006
050040                   PERFORM 3650-UPDATE-MESSAGE-TABLE              05004006
050050*               END-IF                                            05005006
050060                MOve ZEROES TO LBVRMG-CRE-TMST                    05006006
050070                                                                  05007006
050080*** dmh 2/14/14 - changed set of PS-PRINT-AUDIT-LABEL             05008006
050090*** to not be done if innerpack conveyable                        05009006
050100** this was causing an audit label to print without an            05010006
050110** audit number when the DC's were processing INPK CNBYVY         05011006
050120*** for patio                                                     05012006
050130*                                                                 05013006
050140                  IF  LBVRDA-INPK-CNVYB-IND = 'Y'                 05014006
050150                      CONTINUE                                    05015006
050160                  ELSE                                            05016006
050170                      SET PS-PRINT-AUDIT-LABEL TO TRUE            05017006
050180                  END-IF                                          05018006
050190                                                                  05019006
050200             whEN SQLWARN0 NOT = SPACES                           05020006
050210             WHEN SQLCODE < ZERO                                  05021006
050220             WHEN SQLCODE > ZERO                                  05022006
050230                 MOVE '3600-CHECK-MESSAGE-TABLE'                  05023006
050240                                   TO DP013-PARAGRAPH             05024006
050250                 MOVE 'SELECT FROM TABLE  - '                     05025006
050260                                   TO DP013-MESSAGE-TEXT (1)      05026006
050270                 MOVE SQLCA        TO DP013-SQLCA                 05027006
050280                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    05028006
050290                 SET DP013-DB2-ABEND                              05029006
050300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05030006
050310                 SET DP013-ROLLBACK                               05031006
050320                                   TO TRUE                        05032006
050330                 PERFORM DP014-0000-PROCESS-ABEND                 05033006
050340         END-EVALUATE.                                            05034006
050350                                                                  05035006
050360 EJECT                                                            05036006
050370**********************************************************        05037006
050380 3569-SEL-MAX-CHECK-IN-TMST.                                      05038006
050390**********************************************************        05039006
050400                                                                  05040006
050410     MOVE SU001-CARTON        TO DK-CTN.                          05041006
050420                                                                  05042006
050430     EXEC SQL                                                     05043006
050440         SELECT MAX(CRE_TMST)                                     05044006
050450           INTO :PV-TSHUNLO-CRE-TMST                              05045006
050460           FROM TSHUNLO                                           05046006
050470         WHERE SHIPT_UNT_ID = :DK-CTN                             05047006
050480     END-EXEC                                                     05048006
050490                                                                  05049006
050500                                                                  05050006
050510     EVALUATE TRUE                                                05051006
050520         WHEN SQLCODE = ZERO                                      05052006
050530            MOVE PV-TSHUNLO-CRE-TMST TO PV-TSHUNLO-TMST-EAI       05053006
050540         WHEN SQLWARN0 NOT = SPACES                               05054006
050550         WHEN SQLCODE < ZERO                                      05055006
050560         WHEN SQLCODE > ZERO                                      05056006
050570             MOVE '3569-SEL-MAX-CHECK-IN-TMST'                    05057006
050580                               TO DP013-PARAGRAPH                 05058006
050590             MOVE 'SELECT FROM TABLE  - '                         05059006
050600                               TO DP013-MESSAGE-TEXT (1)          05060006
050610             MOVE 'CHECK CSSL FOR MORE DETAIL     '               05061006
050620                                TO DP013-MESSAGE-TEXT (2)         05062006
050630             MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST          05063006
050640             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            05064006
050650             MOVE SU001-STORE    TO  PV-DISPLAY-STORE             05065006
050660             STRING ' TRIP - '           DELIMITED BY SIZE        05066006
050670                    PV-DISPLAY-MANIFEST  DELIMITED BY SIZE        05067006
050680                    '  CARTON - '        DELIMITED BY SIZE        05068006
050690                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        05069006
050700                     '  STORE - '         DELIMITED BY SIZE       05070006
050710                    PV-DISPLAY-STORE     DELIMITED BY SIZE        05071006
050720                              INTO DP013-MESSAGE-TEXT (3)         05072006
050730             MOVE SQLCA        TO DP013-SQLCA                     05073006
050740             MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)        05074006
050750             SET DP013-DB2-ABEND                                  05075006
050760                 DP013-XCTL-DISPLAY-RESTART TO TRUE               05076006
050770             SET DP013-ROLLBACK                                   05077006
050780                               TO TRUE                            05078006
050790             PERFORM DP014-0000-PROCESS-ABEND                     05079006
050800     END-EVALUATE.                                                05080006
050810                                                                  05081006
050820 EJECT                                                            05082006
050830******************************************************************05083006
050840**********************************************************        05084006
050850 3570-POPULATE-CRTN-LBL-XREF.                                     05085006
050860**********************************************************        05086006
050870                                                                  05087006
050880     PERFORM 3569-SEL-MAX-CHECK-IN-TMST.                          05088006
050890                                                                  05089006
050900     EXEC SQL                                                     05090006
050910         INSERT INTO TSULBXF                                      05091006
050920               ( SHIPT_UNT_ID                                     05092006
050930                ,BRCDE_NBR                                        05093006
050940                ,CART_LBL_TYP_CDE                                 05094006
050950                ,DEST_OPER_UNT_ID                                 05095006
050960                ,STAT_CDE                                         05096006
050970                ,LAST_STAT_CHG_TMST                               05097006
050980                ,CRE_TMST)                                        05098006
050990         VALUES (:DK-CTN                                          05099006
051000               , :DK-BARCODE-NBR                                  05100006
051010               , :DK-CART-LBL-TYP-CDE                             05101006
051020               , :DK-DEST-OPER-UNT-ID                             05102006
051030               , :PC-A                                            05103006
051040               ,  CURRENT TIMESTAMP                               05104006
051050               , :PV-TSHUNLO-CRE-TMST)                            05105006
051060     END-EXEC                                                     05106006
051070                                                                  05107006
051080         EVALUATE TRUE                                            05108006
051090             WHEN SQLCODE = ZERO                                  05109006
051100                SET PS-DONE TO TRUE                               05110006
051110                IF DK-CART-LBL-TYP-CDE = 'P'                      05111006
051120                   SET PS-CARTON-P2L-CREATED TO TRUE              05112006
051130                ELSE                                              05113006
051140                   PERFORM 7600-PROCESS-INSERTS-TO-OTBND          05114006
051150                END-IF                                            05115006
051160             WHEN SQLWARN0 NOT = SPACES                           05116006
051170             WHEN SQLCODE < ZERO                                  05117006
051180             WHEN SQLCODE > ZERO                                  05118006
051190                 MOVE '3570-POPULATE-CRTN-LBL-XREF'               05119006
051200                                   TO DP013-PARAGRAPH             05120006
051210                 MOVE 'INSERT INTO TABLE  - '                     05121006
051220                                   TO DP013-MESSAGE-TEXT (1)      05122006
051230                 MOVE SQLCA        TO DP013-SQLCA                 05123006
051240                 MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)    05124006
051250                 SET DP013-DB2-ABEND                              05125006
051260                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05126006
051270                 SET DP013-ROLLBACK                               05127006
051280                                   TO TRUE                        05128006
051290                 PERFORM DP014-0000-PROCESS-ABEND                 05129006
051300         END-EVALUATE.                                            05130006
051310                                                                  05131006
051320 EJECT                                                            05132006
051330**********************************************************        05133006
051340 3580-INACTIVATE-XREF.                                            05134006
051350**********************************************************        05135006
051360**IF THE DIVERT STATUS HAS BEEN CHANGED SINCE THE CARTON *        05136006
051370**WAS ORIGINALLY SCANNED, INACTIVATE THE ORIGINAL ROW    *        05137006
051380**AND CONTINUE TO PROCESS TO INSERT A NEW ROW            *        05138006
051390**********************************************************        05139006
051400                                                                  05140006
051410     EXEC SQL                                                     05141006
051420          UPDATE TSULBXF                                          05142006
051430             SET                                                  05143006
051440                  STAT_CDE           = :PC-I                      05144006
051450                , LAST_STAT_CHG_TMST = CURRENT TIMESTAMP          05145006
051460          WHERE  SHIPT_UNT_ID        = :DK-CTN                    05146006
051470            AND  BRCDE_NBR           = :SULBXF-BRCDE-NBR          05147006
051480     END-EXEC                                                     05148006
051490                                                                  05149006
051500         EVALUATE TRUE                                            05150006
051510             WHEN SQLCODE = ZERO                                  05151006
051520                CONTINUE                                          05152006
051530             WHEN SQLWARN0 NOT = SPACES                           05153006
051540             WHEN SQLCODE < ZERO                                  05154006
051550             WHEN SQLCODE > ZERO                                  05155006
051560                 MOVE '3580-INACTIVATE-XREF'                      05156006
051570                                   TO DP013-PARAGRAPH             05157006
051580                 MOVE 'UPDATE XREF TABLE  - '                     05158006
051590                                   TO DP013-MESSAGE-TEXT (1)      05159006
051600                 MOVE SQLCA        TO DP013-SQLCA                 05160006
051610                 MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)    05161006
051620                 SET DP013-DB2-ABEND                              05162006
051630                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05163006
051640                 SET DP013-ROLLBACK                               05164006
051650                                   TO TRUE                        05165006
051660                 PERFORM DP014-0000-PROCESS-ABEND                 05166006
051670         END-EVALUATE.                                            05167006
051680                                                                  05168006
051690 EJECT                                                            05169006
051700**********************************************************        05170006
051710 3581-INACTIVATE-OTBND-CART.                                      05171006
051720**********************************************************        05172006
051730**IF THE DIVERT STATUS HAS BEEN CHANGED SINCE THE CARTON *        05173006
051740**WAS ORIGINALLY SCANNED, INACTIVATE THE OUTBOUND ROW    *        05174006
051750**AND CONTINUE TO PROCESS TO INSERT A NEW ROW            *        05175006
051760**********************************************************        05176006
051770                                                                  05177006
051780     MOVE SULBXF-BRCDE-NBR       TO PV-BAR-CODE.                  05178006
051790     MOVE PV-BAR-CODE-OTBND      TO SUT00024-SHIPT-UNT-ID.        05179006
051800                                                                  05180006
051810     EXEC SQL                                                     05181006
051820          UPDATE SUT_OTBND_CART                                   05182006
051830             SET                                                  05183006
051840                  ACTV_IND           = 'N'                        05184006
051850          WHERE  ORIG_CART_ID        = :DK-CTN                    05185006
051860            AND  SHIPT_UNT_ID        = :SUT00024-SHIPT-UNT-ID     05186006
051870            AND  ACTV_IND            = 'Y'                        05187006
051880     END-EXEC                                                     05188006
051890                                                                  05189006
051900         EVALUATE TRUE                                            05190006
051910             WHEN SQLCODE = ZERO                                  05191006
051920             WHEN SQLCODE = +100                                  05192006
051930                CONTINUE                                          05193006
051940             WHEN SQLWARN0 NOT = SPACES                           05194006
051950             WHEN SQLCODE < ZERO                                  05195006
051960             WHEN SQLCODE > ZERO                                  05196006
051970                 MOVE '3581-INACTIVATE-OTBND-CART'                05197006
051980                                   TO DP013-PARAGRAPH             05198006
051990                 MOVE 'UPDATE OTBND TABLE  - '                    05199006
052000                                   TO DP013-MESSAGE-TEXT (1)      05200006
052010                 MOVE SQLCA        TO DP013-SQLCA                 05201006
052020                 MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)05202006
052030                 SET DP013-DB2-ABEND                              05203006
052040                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05204006
052050                 SET DP013-ROLLBACK                               05205006
052060                                   TO TRUE                        05206006
052070                 PERFORM DP014-0000-PROCESS-ABEND                 05207006
052080         END-EVALUATE.                                            05208006
052090                                                                  05209006
052100 EJECT                                                            05210006
052110**********************************************************        05211006
052120 3600-CHECK-MESSAGE-TABLE.                                        05212006
052130**********************************************************        05213006
052140     MOVE SU001-PO         TO   DK-PO.                            05214006
052150     MOVE SU001-MANIFEST   TO   DK-MANIFEST.                      05215006
052160     MOVE SU001-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                   05216006
052170     PERFORM 3605-CHECK-ERROR-MESSAGE-CODE.                       05217006
052180                                                                  05218006
052190     EXEC SQL                                                     05219006
052200         SELECT PO_NBR                                            05220006
052210         INTO   :LBVRMG-PO-NBR                                    05221006
052220         FROM   TLBVRMG                                           05222006
052230         WHERE PO_NBR          = :DK-PO                           05223006
052240           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  05224006
052250           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   05225006
052260           AND WRKR_USR_ID     = :SU001-USER-ID                   05226006
052270           AND CICS_SESS_ID    = :SU001-SESSION-ID                05227006
052280           AND TRIP_ID         = :DK-MANIFEST                     05228006
052290           AND ERR_MSG_CDE     = :DK-ERR-MSG-CDE                  05229006
052300     END-EXEC.                                                    05230006
052310                                                                  05231006
052320         EVALUATE TRUE                                            05232006
052330             WHEN SQLCODE = ZERO                                  05233006
052340                SET PS-DONE TO TRUE                               05234006
052350                SET PS-DONT-DISPLAY-SUKRF530 TO TRUE              05235006
052360             WHEN SQLCODE = +100                                  05236006
052370                PERFORM 3650-UPDATE-MESSAGE-TABLE                 05237006
052380                SET PS-DISPLAY-SUKRF530 TO TRUE                   05238006
052390             WHEN SQLWARN0 NOT = SPACES                           05239006
052400             WHEN SQLCODE < ZERO                                  05240006
052410             WHEN SQLCODE > ZERO                                  05241006
052420                 MOVE '3600-CHECK-MESSAGE-TABLE'                  05242006
052430                                   TO DP013-PARAGRAPH             05243006
052440                 MOVE 'SELECT FROM TABLE  - '                     05244006
052450                                   TO DP013-MESSAGE-TEXT (1)      05245006
052460                 MOVE SQLCA        TO DP013-SQLCA                 05246006
052470                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    05247006
052480                 SET DP013-DB2-ABEND                              05248006
052490                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05249006
052500                 SET DP013-ROLLBACK                               05250006
052510                                   TO TRUE                        05251006
052520                 PERFORM DP014-0000-PROCESS-ABEND                 05252006
052530         END-EVALUATE.                                            05253006
052540                                                                  05254006
052550 EJECT                                                            05255006
052560******************************************************************05256006
052570 3605-CHECK-ERROR-MESSAGE-CODE.                                   05257006
052580******************************************************************05258006
052590     EVALUATE TRUE                                                05259006
052600       WHEN SU001-UCC128-IGNORED                                  05260006
052610            MOVE 'I' TO DK-ERR-MSG-CDE                            05261006
052620                                                                  05262006
052630       WHEN SU001-UCC128-NOT-AVAILABLE                            05263006
052640            MOVE 'N' TO DK-ERR-MSG-CDE                            05264006
052650                                                                  05265006
052660       WHEN SU001-UCC128-NO-LABEL-DATA                            05266006
052670            MOVE 'L' TO DK-ERR-MSG-CDE                            05267006
052680                                                                  05268006
052690       WHEN SU001-UCC128-UNABLE-TO-ASSIGN                         05269006
052700            MOVE 'X' TO DK-ERR-MSG-CDE                            05270006
052710                                                                  05271006
052720       WHEN SU001-UCC128-CENTRAL-STOCK                            05272006
052730            MOVE 'C' TO DK-ERR-MSG-CDE                            05273006
052740                                                                  05274006
052750       WHEN SU001-UCC128-DUP-CTN                                  05275006
052760            MOVE 'D' TO DK-ERR-MSG-CDE                            05276006
052770                                                                  05277006
052780       WHEN SU001-UCC128-PREPK-ORD                                05278006
052790            MOVE 'P' TO DK-ERR-MSG-CDE                            05279006
052800                                                                  05280006
052810       WHEN SU001-UCC128-PBS-RCVR                                 05281006
052820            MOVE 'A' TO DK-ERR-MSG-CDE                            05282006
052830                                                                  05283006
052840       WHEN SU001-UCC128-NO-RCVR                                  05284006
052850            MOVE 'B' TO DK-ERR-MSG-CDE                            05285006
052860                                                                  05286006
052870       WHEN OTHER                                                 05287006
052880            MOVE 'G' TO DK-ERR-MSG-CDE                            05288006
052890       END-EVALUATE.                                              05289006
052900                                                                  05290006
052910**********************************************************        05291006
052920 3610-CHECK-LBVRMG-FREE-ASTR.                                     05292006
052930**********************************************************        05293006
052940     MOVE SU001-PO           TO   DK-PO.                          05294006
052950     MOVE SU001-MANIFEST     TO   DK-MANIFEST.                    05295006
052960     MOVE SU001-RCVR-SEQ-NBR TO   DK-REC-SEQ-NBR.                 05296006
052970     MOVE 'T'                TO   DK-ERR-MSG-CDE.                 05297006
052980                                                                  05298006
052990     EXEC SQL                                                     05299006
053000         SELECT PO_NBR                                            05300006
053010         INTO   :LBVRMG-PO-NBR                                    05301006
053020         FROM   TLBVRMG                                           05302006
053030         WHERE PO_NBR          = :DK-PO                           05303006
053040           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  05304006
053050           AND WRKR_USR_ID     = :SU001-USER-ID                   05305006
053060           AND CICS_SESS_ID    = :SU001-SESSION-ID                05306006
053070           AND TRIP_ID         = :DK-MANIFEST                     05307006
053080           AND ERR_MSG_CDE     = :DK-ERR-MSG-CDE                  05308006
053090     END-EXEC.                                                    05309006
053100                                                                  05310006
053110         EVALUATE TRUE                                            05311006
053120             WHEN SQLCODE = ZERO                                  05312006
053130             WHEN SQLCODE = -811                                  05313006
053140                SET PS-DONT-DISPLAY-SUKRF530 TO TRUE              05314006
053150             WHEN SQLCODE = +100                                  05315006
053160                SET PS-DISPLAY-SUKRF530 TO TRUE                   05316006
053170             WHEN SQLWARN0 NOT = SPACES                           05317006
053180             WHEN SQLCODE < ZERO                                  05318006
053190             WHEN SQLCODE > ZERO                                  05319006
053200                 MOVE '3610-CHECK-LBVRMG-FREE-ASTR'               05320006
053210                                   TO DP013-PARAGRAPH             05321006
053220                 MOVE 'SELECT FROM TABLE  - '                     05322006
053230                                   TO DP013-MESSAGE-TEXT (1)      05323006
053240                 MOVE SQLCA        TO DP013-SQLCA                 05324006
053250                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    05325006
053260                 SET DP013-DB2-ABEND                              05326006
053270                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05327006
053280                 SET DP013-ROLLBACK                               05328006
053290                                   TO TRUE                        05329006
053300                 PERFORM DP014-0000-PROCESS-ABEND                 05330006
053310         END-EVALUATE.                                            05331006
053320                                                                  05332006
053330 EJECT                                                            05333006
053340**********************************************************        05334006
053350 3650-UPDATE-MESSAGE-TABLE.                                       05335006
053360**********************************************************        05336006
053370     EXEC SQL                                                     05337006
053380         INSERT INTO TLBVRMG                                      05338006
053390               ( PO_NBR                                           05339006
053400                ,RCVR_SEQ_NBR                                     05340006
053410                ,PO_LNE_NBR                                       05341006
053420                ,PREPK_ID                                         05342006
053430                ,WRKR_USR_ID                                      05343006
053440                ,TRIP_ID                                          05344006
053450                ,CICS_SESS_ID                                     05345006
053460                ,CRE_TMST                                         05346006
053470                ,ERR_MSG_CDE)                                     05347006
053480         VALUES (:DK-PO                                           05348006
053490               , :DK-REC-SEQ-NBR                                  05349006
053500               , :DK-PO-LNE-NBR                                   05350006
053510               , :DK-PREPK-ID                                     05351006
053520               , :SU001-USER-ID                                   05352006
053530               , :DK-MANIFEST                                     05353006
053540               , :SU001-SESSION-ID                                05354006
053550               , CURRENT TIMESTAMP                                05355006
053560               , :DK-ERR-MSG-CDE)                                 05356006
053570     END-EXEC.                                                    05357006
053580                                                                  05358006
053590         EVALUATE TRUE                                            05359006
053600             WHEN SQLCODE = ZERO                                  05360006
053610                SET PS-SUCCESSFUL-UPDATE TO TRUE                  05361006
053620             WHEN SQLCODE = +100                                  05362006
053630             WHEN SQLWARN0 NOT = SPACES                           05363006
053640             WHEN SQLCODE < ZERO                                  05364006
053650             WHEN SQLCODE > ZERO                                  05365006
053660                 MOVE '3650-UPDATE-MESSAGE-TABLE'                 05366006
053670                                   TO DP013-PARAGRAPH             05367006
053680                 MOVE 'UPDATE TABLE       - '                     05368006
053690                                   TO DP013-MESSAGE-TEXT (1)      05369006
053700                 MOVE SQLCA        TO DP013-SQLCA                 05370006
053710                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    05371006
053720                 SET DP013-DB2-ABEND                              05372006
053730                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05373006
053740                 SET DP013-ROLLBACK                               05374006
053750                                   TO TRUE                        05375006
053760                 PERFORM DP014-0000-PROCESS-ABEND                 05376006
053770         END-EVALUATE.                                            05377006
053780                                                                  05378006
053790 EJECT                                                            05379006
053800 3655-REPRINT-LABELS.                                             05380006
053810                                                                  05381006
053820     PERFORM 3660-OPEN-REPRINT-CSR.                               05382006
053830                                                                  05383006
053840     INITIALIZE PV-REPRINT-CSR-CNT.                               05384006
053850     PERFORM 3670-FETCH-REPRINT-CSR.                              05385006
053860                                                                  05386006
053870     PERFORM UNTIL PS-END-OF-REPRINT-CSR                          05387006
053880        PERFORM 3680-GET-REPRINT-LBVRDA                           05388006
053890        IF PV-REPRINT-CSR-CNT = 0                                 05389006
053900           SET PS-NO-CASEPK-FND TO TRUE                           05390006
053910           PERFORM 5005-PRINT-MESSAGE-LABELS                      05391006
053920        ELSE                                                      05392006
053930           PERFORM 5000-PRINT-LABEL                               05393006
053940           PERFORM 3670-FETCH-REPRINT-CSR                         05394006
053950        END-IF                                                    05395006
053960     END-PERFORM.                                                 05396006
053970                                                                  05397006
053980     PERFORM 3675-CLOSE-REPRINT-CSR.                              05398006
053990*IF NOT FOUND ON TSULBXF OR TLBVRDA  COUNT = 0                    05399006
054000     IF PV-REPRINT-CSR-CNT = 0                                    05400006
054010           SET SU001-UCC128-NO-LABEL-DATA TO TRUE                 05401006
054020           PERFORM 3600-CHECK-MESSAGE-TABLE                       05402006
054030     ELSE                                                         05403006
054040        IF SU001-ROWS-INSERTED >=                                 05404006
054050           SU001-PRT-LBL-ON-SCN-CNT                               05405006
054060             MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE       05406006
054070             MOVE  SU001-PRINTER-ID  TO SU001-PRINTER-ID-USE      05407006
054080             PERFORM 7300-START-LABEL-PRINT                       05408006
054090             PERFORM 2400-GET-BATCH-NUMBER                        05409006
054100             ADD  1  TO  PV-MAX-USER-BATCH                        05410006
054110                 GIVING  SU001-BATCH-NUMBER                       05411006
054120             MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE       05412006
054130             MOVE  ZEROES             TO SU001-ROWS-INSERTED      05413006
054140        END-IF                                                    05414006
054150     END-IF.                                                      05415006
054160                                                                  05416006
054170 3660-OPEN-REPRINT-CSR.                                           05417006
054180                                                                  05418006
054190         EXEC SQL                                                 05419006
054200              OPEN REPRINT-CSR                                    05420006
054210         END-EXEC                                                 05421006
054220                                                                  05422006
054230                                                                  05423006
054240         EVALUATE TRUE                                            05424006
054250             WHEN SQLCODE = ZERO                                  05425006
054260                 CONTINUE                                         05426006
054270             WHEN SQLWARN0 NOT = SPACES                           05427006
054280             WHEN SQLCODE < ZERO                                  05428006
054290             WHEN SQLCODE > ZERO                                  05429006
054300                 MOVE '3660-OPEN-REPRINT-CSR'                     05430006
054310                                   TO DP013-PARAGRAPH             05431006
054320                 MOVE 'OPEN REPRINT-CSR     '                     05432006
054330                                   TO DP013-MESSAGE-TEXT (1)      05433006
054340                 MOVE DK-CTN                                      05434006
054350                                   TO DP013-MESSAGE-TEXT (2)      05435006
054360                 MOVE SQLCA        TO DP013-SQLCA                 05436006
054370                 MOVE 'TSULBXF'    TO DP013-DB2-TABLE-NAME (1)    05437006
054380                 SET DP013-DB2-ABEND                              05438006
054390                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05439006
054400                 SET DP013-ROLLBACK                               05440006
054410                                   TO TRUE                        05441006
054420                 PERFORM DP014-0000-PROCESS-ABEND                 05442006
054430         END-EVALUATE.                                            05443006
054440                                                                  05444006
054450 3670-FETCH-REPRINT-CSR.                                          05445006
054460                                                                  05446006
054470      EXEC SQL                                                    05447006
054480        FETCH REPRINT-CSR                                         05448006
054490        INTO     :SULBXF-BRCDE-NBR                                05449006
054500         END-EXEC                                                 05450006
054510                                                                  05451006
054520     EVALUATE TRUE                                                05452006
054530         WHEN SQLCODE = ZERO                                      05453006
054540              ADD +1 TO PV-REPRINT-CSR-CNT                        05454006
054550         WHEN SQLCODE = +100                                      05455006
054560              SET PS-END-OF-REPRINT-CSR TO TRUE                   05456006
054570         WHEN SQLWARN0 NOT = SPACE                                05457006
054580         WHEN SQLCODE NOT = ZERO                                  05458006
054590              MOVE '3370-FETCH-REPRINT-CSR'                       05459006
054600                               TO DP013-PARAGRAPH                 05460006
054610              MOVE 'FETCH REPRINT-CSR      '                      05461006
054620                               TO DP013-MESSAGE-TEXT (1)          05462006
054630              MOVE SQLCA       TO DP013-SQLCA                     05463006
054640              SET DP013-DB2-ABEND                                 05464006
054650                               TO TRUE                            05465006
054660                 SET DP013-ROLLBACK                               05466006
054670                                   TO TRUE                        05467006
054680              PERFORM DP014-0000-PROCESS-ABEND                    05468006
054690     END-EVALUATE.                                                05469006
054700                                                                  05470006
054710 3675-CLOSE-REPRINT-CSR.                                          05471006
054720                                                                  05472006
054730         EXEC SQL                                                 05473006
054740              CLOSE REPRINT-CSR                                   05474006
054750         END-EXEC                                                 05475006
054760                                                                  05476006
054770                                                                  05477006
054780         EVALUATE TRUE                                            05478006
054790             WHEN SQLCODE = ZERO                                  05479006
054800                 CONTINUE                                         05480006
054810             WHEN SQLWARN0 NOT = SPACES                           05481006
054820             WHEN SQLCODE < ZERO                                  05482006
054830             WHEN SQLCODE > ZERO                                  05483006
054840                 MOVE '3675-CLOSE-REPRINT-CSR'                    05484006
054850                                   TO DP013-PARAGRAPH             05485006
054860                 MOVE 'CLOSE REPRINT CSR    '                     05486006
054870                                   TO DP013-MESSAGE-TEXT (1)      05487006
054880                 MOVE DK-CTN                                      05488006
054890                                   TO DP013-MESSAGE-TEXT (2)      05489006
054900                 MOVE SQLCA        TO DP013-SQLCA                 05490006
054910                 MOVE 'TSULBXF'    TO DP013-DB2-TABLE-NAME (1)    05491006
054920                 SET DP013-DB2-ABEND                              05492006
054930                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05493006
054940                 SET DP013-ROLLBACK                               05494006
054950                                   TO TRUE                        05495006
054960                 PERFORM DP014-0000-PROCESS-ABEND                 05496006
054970         END-EVALUATE.                                            05497006
054980                                                                  05498006
054990 3680-GET-REPRINT-LBVRDA.                                         05499006
055000                                                                  05500006
055010     EXEC SQL                                                     05501006
055020        SELECT   PREPK_ID                                         05502006
055030                ,LBL_ASG_SEQ_NBR                                  05503006
055040                ,CART_LBL_TYP_CDE                                 05504006
055050                ,PREPK_PRCG_LNE_NBR                               05505006
055060                ,INPK_UNT_QTY                                     05506006
055070                ,PREPK_RATO_QTY                                   05507006
055080                ,PREPK_UNT_QTY                                    05508006
055090                ,DEST_OPER_UNT_ID                                 05509006
055100                ,CSE_PK_QTY                                       05510006
055110                ,ODD_CART_IND                                     05511006
055120                ,INPK_CNVYB_IND                                   05512006
055130                ,LBL_TYP_LBL_SEQ_ID                               05513006
055140                ,LBL_TYP_TOT_QTY                                  05514006
055150                ,BRCDE_NBR                                        05515006
055160                ,STR_ZN_ID                                        05516006
055170                ,MODU_DESC                                        05517006
055180                ,ITM_NBR                                          05518006
055190                ,DEPT_DESC                                        05519006
055200                ,MAJ_CL_DESC                                      05520006
055210                ,SEASET_NM                                        05521006
055220                ,FIXT_ID                                          05522006
055230                ,STRG_AREA_CDE                                    05523006
055240                ,OTPK_UNT_QTY                                     05524006
055250                ,EAS_TAG_IND                                      05525006
055260                ,DOOR_ID                                          05526006
055270                ,HNG_FOLD_SEQ_NBR                                 05527006
055280                ,MDSE_PGM_DESC                                    05528006
055290*CLP 07/06/2015 START                                             05529008
055300                ,LBL_MSG_TXT                                      05530008
055310*CLP 07/06/2015 END                                               05531008
055320        INTO     :LBVRDA-PREPK-ID                                 05532006
055330                ,:LBVRDA-LBL-ASG-SEQ-NBR                          05533006
055340                ,:LBVRDA-CART-LBL-TYP-CDE                         05534006
055350                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       05535006
055360                ,:LBVRDA-INPK-UNT-QTY                             05536006
055370                ,:LBVRDA-PREPK-RATO-QTY                           05537006
055380                ,:LBVRDA-PREPK-UNT-QTY                            05538006
055390                ,:LBVRDA-DEST-OPER-UNT-ID                         05539006
055400                ,:LBVRDA-CSE-PK-QTY                               05540006
055410                ,:LBVRDA-ODD-CART-IND                             05541006
055420                ,:LBVRDA-INPK-CNVYB-IND                           05542006
055430                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       05543006
055440                ,:LBVRDA-LBL-TYP-TOT-QTY                          05544006
055450                ,:LBVRDA-BRCDE-NBR                                05545006
055460                ,:LBVRDA-STR-ZN-ID                                05546006
055470                ,:LBVRDA-MODU-DESC                                05547006
055480                ,:LBVRDA-ITM-NBR                                  05548006
055490                ,:LBVRDA-DEPT-DESC                                05549006
055500                ,:LBVRDA-MAJ-CL-DESC                              05550006
055510                ,:LBVRDA-SEASET-NM                                05551006
055520                ,:LBVRDA-FIXT-ID                                  05552006
055530                ,:LBVRDA-STRG-AREA-CDE                            05553006
055540                ,:LBVRDA-OTPK-UNT-QTY                             05554006
055550                ,:LBVRDA-EAS-TAG-IND                              05555006
055560                ,:LBVRDA-DOOR-ID                                  05556006
055570                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         05557006
055580                ,:LBVRDA-MDSE-PGM-DESC                            05558006
055590*CLP 07/06/2015 START                                             05559008
055600                ,:LBVRDA-LBL-MSG-TXT                              05560008
055610*CLP 07/06/2015 END                                               05561008
055620        FROM TLBVRDA A                                            05562006
055630        WHERE  A.PO_NBR                =  :DK-PO                  05563006
055640          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         05564006
055650          AND  A.PO_LNE_NBR            =  :DK-PO-LNE-NBR          05565006
055660          AND  A.PREPK_ID              =  :DK-PREPK-ID            05566006
055670          AND  A.BRCDE_NBR             =  :SULBXF-BRCDE-NBR       05567006
055680     END-EXEC                                                     05568006
055690                                                                  05569006
055700      EVALUATE TRUE                                               05570006
055710          WHEN SQLCODE = ZERO                                     05571006
055720              MOVE  LBVRDA-DEST-OPER-UNT-ID TO SU001-STORE        05572006
055730              PERFORM 7210-GET-STORE-INFO                         05573006
055740          WHEN SQLCODE = +100                                     05574006
055750             SET PS-END-OF-REPRINT-CSR TO TRUE                    05575006
055760             INITIALIZE PV-REPRINT-CSR-CNT                        05576006
055770          WHEN SQLWARN0 NOT = SPACES                              05577006
055780          WHEN SQLCODE < ZERO                                     05578006
055790          WHEN SQLCODE > ZERO                                     05579006
055800              MOVE '3500-GET-VIRTUAL-LABEL-DATA'                  05580006
055810                                TO DP013-PARAGRAPH                05581006
055820              MOVE 'UPDATE TABLE       - '                        05582006
055830                                TO DP013-MESSAGE-TEXT (1)         05583006
055840              MOVE SQLCA        TO DP013-SQLCA                    05584006
055850              MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)       05585006
055860              SET DP013-DB2-ABEND                                 05586006
055870                  DP013-XCTL-DISPLAY-RESTART TO TRUE              05587006
055880              SET DP013-ROLLBACK                                  05588006
055890                                TO TRUE                           05589006
055900              PERFORM DP014-0000-PROCESS-ABEND                    05590006
055910      END-EVALUATE.                                               05591006
055920                                                                  05592006
055930**********************************************************        05593006
055940 3685-CHECK-UCC128-USE.                                           05594006
055950**********************************************************        05595006
055960                                                                  05596006
055970     MOVE SU001-PO            TO DK-PO.                           05597006
055980     MOVE SU001-RCVR-SEQ-NBR  TO DK-REC-SEQ-NBR.                  05598006
055990     MOVE SU001-PO-LINE-NBR   TO DK-PO-LNE-NBR                    05599006
056000                                 PV-PO-LINE-N.                    05600006
056010                                                                  05601006
056020     EXEC SQL                                                     05602006
056030        SELECT   UCC128_DAT_USG_CDE                               05603006
056040                ,TOT_CART_CNT                                     05604006
056050        INTO     :DISTHD-UCC128-DAT-USG-CDE                       05605006
056060                ,:DISTHD-TOT-CART-CNT                             05606006
056070        FROM TDISTHD A                                            05607006
056080        WHERE  A.ORD_NBR               =  :DK-PO                  05608006
056090          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         05609006
056100          AND  A.ORD_LNE_NBR           =  :DK-PO-LNE-NBR          05610006
056110     END-EXEC                                                     05611006
056120                                                                  05612006
056130      EVALUATE TRUE                                               05613006
056140          WHEN SQLCODE = ZERO                                     05614006
056150             MOVE DISTHD-UCC128-DAT-USG-CDE                       05615006
056160                                TO PV-UCC128-DAT-USG-CDE          05616006
056170          WHEN SQLCODE = +100                                     05617006
056180             MOVE SPACES TO PV-UCC128-DAT-USG-CDE                 05618006
056190          WHEN SQLWARN0 NOT = SPACES                              05619006
056200          WHEN SQLCODE < ZERO                                     05620006
056210          WHEN SQLCODE > ZERO                                     05621006
056220              MOVE '3685-CHECK-UCC128-USE'                        05622006
056230                                TO DP013-PARAGRAPH                05623006
056240              MOVE 'UPDATE TABLE       - '                        05624006
056250                                TO DP013-MESSAGE-TEXT (1)         05625006
056260              MOVE SQLCA        TO DP013-SQLCA                    05626006
056270              MOVE 'TDISTHD '   TO DP013-DB2-TABLE-NAME (1)       05627006
056280              SET DP013-DB2-ABEND                                 05628006
056290                  DP013-XCTL-DISPLAY-RESTART TO TRUE              05629006
056300              SET DP013-ROLLBACK                                  05630006
056310                                TO TRUE                           05631006
056320              PERFORM DP014-0000-PROCESS-ABEND                    05632006
056330      END-EVALUATE.                                               05633006
056340                                                                  05634006
056350**********************************************************        05635006
056360**********************************************************        05636006
056370 3690-CHECK-SULBXF-FOR-ACTIVE.                                    05637006
056380**********************************************************        05638006
056390                                                                  05639006
056400     MOVE SU001-CARTON        TO DK-CTN.                          05640006
056410                                                                  05641006
056420     EXEC SQL                                                     05642006
056430        SELECT   BRCDE_NBR                                        05643006
056440        INTO   :SULBXF-BRCDE-NBR                                  05644006
056450        FROM TSULBXF A                                            05645006
056460        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                05646006
056470          AND  A.STAT_CDE              =   'A'                    05647006
056480     END-EXEC                                                     05648006
056490                                                                  05649006
056500      EVALUATE TRUE                                               05650006
056510          WHEN SQLCODE = ZERO                                     05651006
056520          WHEN SQLCODE = -811                                     05652006
056530             SET PS-ACTIVE-XREF-ROW-FOUND  TO TRUE                05653006
056540          WHEN SQLCODE = +100                                     05654006
056550             PERFORM 3695-CHECK-SULBXF-2                          05655006
056560          WHEN SQLWARN0 NOT = SPACES                              05656006
056570          WHEN SQLCODE < ZERO                                     05657006
056580          WHEN SQLCODE > ZERO                                     05658006
056590              MOVE '3690-CHECK-SULBXF-FOR-ACTIVE'                 05659006
056600                                TO DP013-PARAGRAPH                05660006
056610              MOVE 'SELECT FROM TABLE  - '                        05661006
056620                                TO DP013-MESSAGE-TEXT (1)         05662006
056630              MOVE SQLCA        TO DP013-SQLCA                    05663006
056640              MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)       05664006
056650              SET DP013-DB2-ABEND                                 05665006
056660                  DP013-XCTL-DISPLAY-RESTART TO TRUE              05666006
056670              SET DP013-ROLLBACK                                  05667006
056680                                TO TRUE                           05668006
056690              PERFORM DP014-0000-PROCESS-ABEND                    05669006
056700      END-EVALUATE.                                               05670006
056710                                                                  05671006
056720**********************************************************        05672006
056730 3695-CHECK-SULBXF-2.                                             05673006
056740**********************************************************        05674006
056750                                                                  05675006
056760     EXEC SQL                                                     05676006
056770        SELECT  BRCDE_NBR                                         05677006
056780        INTO   :SULBXF-BRCDE-NBR                                  05678006
056790        FROM   TSULBXF A                                          05679006
056800        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                05680006
056810          AND  A.STAT_CDE              =   'I'                    05681006
056820     END-EXEC                                                     05682006
056830                                                                  05683006
056840      EVALUATE TRUE                                               05684006
056850          WHEN SQLCODE = ZERO                                     05685006
056860          WHEN SQLCODE = -811                                     05686006
056870             SET PS-ACTIVE-XREF-ROW-NOT-FOUND TO TRUE             05687006
056880          WHEN SQLCODE = +100                                     05688006
056890             SET PS-SULBXF-RECORD-NOT-FOUND TO TRUE               05689006
056900          WHEN SQLWARN0 NOT = SPACES                              05690006
056910          WHEN SQLCODE < ZERO                                     05691006
056920          WHEN SQLCODE > ZERO                                     05692006
056930              MOVE '3695-CHECK-SULBXF-2  '                        05693006
056940                                TO DP013-PARAGRAPH                05694006
056950              MOVE 'SELECT FROM TABLE  - '                        05695006
056960                                TO DP013-MESSAGE-TEXT (1)         05696006
056970              MOVE SQLCA        TO DP013-SQLCA                    05697006
056980              MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)       05698006
056990              SET DP013-DB2-ABEND                                 05699006
057000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              05700006
057010              SET DP013-ROLLBACK                                  05701006
057020                                TO TRUE                           05702006
057030              PERFORM DP014-0000-PROCESS-ABEND                    05703006
057040      END-EVALUATE.                                               05704006
057050                                                                  05705006
057060**********************************************************        05706006
057070 3696-CHECK-SULBXF-FOR-PBS.                                       05707006
057080**********************************************************        05708006
057090                                                                  05709006
057100     MOVE SU001-CARTON        TO DK-CTN.                          05710006
057110                                                                  05711006
057120     EXEC SQL                                                     05712006
057130        SELECT   BRCDE_NBR                                        05713006
057140        INTO   :SULBXF-BRCDE-NBR                                  05714006
057150        FROM TSULBXF A                                            05715006
057160        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                05716006
057170          AND  A.STAT_CDE              =   'A'                    05717006
057180     END-EXEC                                                     05718006
057190                                                                  05719006
057200      EVALUATE TRUE                                               05720006
057210          WHEN SQLCODE = ZERO                                     05721006
057220          WHEN SQLCODE = -811                                     05722006
057230             SET PS-XREF-PBS-FOUND         TO TRUE                05723006
057240          WHEN SQLCODE = +100                                     05724006
057250             SET PS-XREF-PBS-NOT-FOUND    TO TRUE                 05725006
057260          WHEN SQLWARN0 NOT = SPACES                              05726006
057270          WHEN SQLCODE < ZERO                                     05727006
057280          WHEN SQLCODE > ZERO                                     05728006
057290              MOVE '3696-CHECK-SULBXF-FOR-ACTIVE'                 05729006
057300                                TO DP013-PARAGRAPH                05730006
057310              MOVE 'SELECT FROM TABLE  - '                        05731006
057320                                TO DP013-MESSAGE-TEXT (1)         05732006
057330              MOVE DK-CTN       TO DP013-MESSAGE-TEXT (2)         05733006
057340              MOVE SQLCA        TO DP013-SQLCA                    05734006
057350              MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)       05735006
057360              SET DP013-DB2-ABEND                                 05736006
057370                  DP013-XCTL-DISPLAY-RESTART TO TRUE              05737006
057380              SET DP013-ROLLBACK                                  05738006
057390                                TO TRUE                           05739006
057400              PERFORM DP014-0000-PROCESS-ABEND                    05740006
057410      END-EVALUATE.                                               05741006
057420                                                                  05742006
057430**********************************************************        05743006
057440 3700-PRINT-VIRTUAL-LABELS.                                       05744006
057450**********************************************************        05745006
057460                                                                  05746006
057470                                                                  05747006
057480     EVALUATE TRUE                                                05748006
057490         WHEN LBVRDA-INPK-CNVYB-IND = 'N'                         05749006
057500            PERFORM 5000-PRINT-LABEL                              05750006
057510                                                                  05751006
057520         WHEN LBVRDA-INPK-CNVYB-IND = 'Y'                         05752006
057530            SET PS-INPK-AUD-INLINE-NO TO TRUE                     05753006
057540            PERFORM 5000-PRINT-LABEL                              05754006
057550                                                                  05755006
057560            PERFORM 3710-OPEN-INPK-CSR                            05756006
057570            PERFORM 3720-FETCH-INPK-CSR                           05757006
057580                                                                  05758006
057590            PERFORM UNTIL PS-END-OF-VRTL-LBL-CSR                  05759006
057600               IF PS-PRINT-AUDIT-LABEL                            05760006
057610                  CONTINUE                                        05761006
057620               ELSE                                               05762006
057630***                                                               05763006
057640* THE CALL TO INTERFACE LABOR DATA OCCURS IN THE 5000-PRINT PARA  05764006
057650* SET PS-NO-CARTON-SML-CREATED SO THE CALL WILL OCCUR             05765006
057660* ONLY ONCE FOR EACH VEND CARTON, EVEN IF INPK CONVEYABLES EXIST  05766006
057670***                                                               05767006
057680                  SET PS-NO-CARTON-SML-CREATED TO TRUE            05768006
057690                  PERFORM 5000-PRINT-LABEL                        05769006
057700               END-IF                                             05770006
057710                PERFORM 3720-FETCH-INPK-CSR                       05771006
057720***             PERFORM 3705-WAIT-1-SECOND                        05772006
057730            END-PERFORM                                           05773006
057740            PERFORM 3735-CONSUME-INPK-ROWS                        05774006
057750            IF PS-INPK-AUD-INLINE-YES                             05775006
057760               MOVE PC-SU-AUDIT-DEF-PRMPT-PGM                     05776006
057770                                          TO PV-TRANSFER-PROGRAM  05777006
057780               MOVE PC-N TO SU001-DUPLICATE-IND                   05778006
057790               MOVE PC-Y TO SU001-LABEL-IND                       05779006
057800               MOVE SU001-COMMON-DATA  TO SU006-HOST-SAVE-AREA    05780006
057810               PERFORM 4100-XCTL-CRTN-AUDIT                       05781006
057820                                                                  05782006
057830            END-IF                                                05783006
057840            IF SU001-ROWS-INSERTED >=                             05784006
057850               SU001-PRT-LBL-ON-SCN-CNT                           05785006
057860                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   05786006
057870                 MOVE  SU001-PRINTER-ID  TO SU001-PRINTER-ID-USE  05787006
057880                 PERFORM 7300-START-LABEL-PRINT                   05788006
057890                 PERFORM 2400-GET-BATCH-NUMBER                    05789006
057900                 ADD  1  TO  PV-MAX-USER-BATCH                    05790006
057910                     GIVING  SU001-BATCH-NUMBER                   05791006
057920                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   05792006
057930                 MOVE  ZEROES             TO SU001-ROWS-INSERTED  05793006
057940            END-IF                                                05794006
057950            PERFORM 3730-CLOSE-INPK-CSR                           05795006
057960     END-EVALUATE.                                                05796006
057970                                                                  05797006
057980                                                                  05798006
057990******************************************************************05799006
058000* THE PORTABLE PRINTERS GET OVERLOADED IF TOO MANY LABELS ARE     05800006
058010* REQUESTED.  THIS PARAGRAPH WILL FORCE A 1 SECOND DELAY BETWEEN  05801006
058020* REQUESTS.                                                       05802006
058030******************************************************************05803006
058040 3705-WAIT-1-SECOND.                                              05804006
058050                                                                  05805006
058060     EXEC CICS                                                    05806006
058070          DELAY FOR SECONDS (03)                                  05807006
058080                    RESP    (PV-CICS-RESPONSE)                    05808006
058090     END-EXEC.                                                    05809006
058100                                                                  05810006
058110     EVALUATE TRUE                                                05811006
058120         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05812006
058130              CONTINUE                                            05813006
058140         WHEN OTHER                                               05814006
058150            MOVE '3705-WAIT-1-SECOND   ' TO DP013-PARAGRAPH       05815006
058160            MOVE 'SUKRF502 - DELAY INPK PRINT 1 SECOND'           05816006
058170              TO DP013-MESSAGE-TEXT (1)                           05817006
058180            SET DP013-LOGIC-ABEND        TO TRUE                  05818006
058190            SET DP013-ROLLBACK           TO TRUE                  05819006
058200            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                05820006
058210     END-EVALUATE.                                                05821006
058220                                                                  05822006
058230                                                                  05823006
058240*----------------------------------------------------------------*05824006
058250* OPEN THE VIRTUAL LABEL PRINT CURSOR                            *05825006
058260*----------------------------------------------------------------*05826006
058270                                                                  05827006
058280 3710-OPEN-INPK-CSR.                                              05828006
058290     PERFORM                                                      05829006
058300         WITH TEST AFTER                                          05830006
058310         VARYING PV-RETRY-COUNTER                                 05831006
058320         FROM 1 BY 1                                              05832006
058330         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               05833006
058340                   OR (SQLCODE = ZERO))                           05834006
058350                 EXEC SQL                                         05835006
058360                      OPEN VRTL-LBL-PRT-CSR                       05836006
058370                 END-EXEC                                         05837006
058380                                                                  05838006
058390                                                                  05839006
058400         EVALUATE TRUE                                            05840006
058410             WHEN SQLCODE = ZERO                                  05841006
058420             WHEN SQLCODE = -904                                  05842006
058430             WHEN SQLCODE = -913                                  05843006
058440                 CONTINUE                                         05844006
058450             WHEN SQLWARN0 NOT = SPACES                           05845006
058460             WHEN SQLCODE < ZERO                                  05846006
058470             WHEN SQLCODE > ZERO                                  05847006
058480                 MOVE '4010-OPEN-EXPCTD-CURSOR'                   05848006
058490                                   TO DP013-PARAGRAPH             05849006
058500                 MOVE 'OPEN VRTL-LBL-PRT-CSR'                     05850006
058510                                   TO DP013-MESSAGE-TEXT (1)      05851006
058520                 MOVE SQLCA        TO DP013-SQLCA                 05852006
058530                 MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)    05853006
058540                 SET DP013-DB2-ABEND                              05854006
058550                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05855006
058560                 SET DP013-ROLLBACK                               05856006
058570                                   TO TRUE                        05857006
058580                 PERFORM DP014-0000-PROCESS-ABEND                 05858006
058590         END-EVALUATE                                             05859006
058600     END-PERFORM.                                                 05860006
058610                                                                  05861006
058620     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    05862006
058630         SQLCODE NOT = ZERO                                       05863006
058640         MOVE '3710-OPEN-CURSOR'   TO DP013-PARAGRAPH             05864006
058650         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   05865006
058660                                   TO DP013-MESSAGE-TEXT (1)      05866006
058670         MOVE SQLCA                TO DP013-SQLCA                 05867006
058680         MOVE 'TLBVRDA '           TO DP013-DB2-TABLE-NAME (1)    05868006
058690         SET DP013-DB2-ABEND                                      05869006
058700             DP013-XCTL-DISPLAY-RESTART                           05870006
058710                                   TO TRUE                        05871006
058720                 SET DP013-ROLLBACK                               05872006
058730                                   TO TRUE                        05873006
058740         PERFORM DP014-0000-PROCESS-ABEND                         05874006
058750     END-IF.                                                      05875006
058760                                                                  05876006
058770 EJECT                                                            05877006
058780******************************************************************05878006
058790 3720-FETCH-INPK-CSR.                                             05879006
058800                                                                  05880006
058810      EXEC SQL                                                    05881006
058820        FETCH VRTL-LBL-PRT-CSR                                    05882006
058830        INTO     :LBVRDA-CART-LBL-TYP-CDE                         05883006
058840                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       05884006
058850                ,:LBVRDA-INPK-UNT-QTY                             05885006
058860                ,:LBVRDA-PREPK-RATO-QTY                           05886006
058870                ,:LBVRDA-DEST-OPER-UNT-ID                         05887006
058880                ,:LBVRDA-CSE-PK-QTY                               05888006
058890                ,:LBVRDA-ODD-CART-IND                             05889006
058900                ,:LBVRDA-INPK-CNVYB-IND                           05890006
058910                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       05891006
058920                ,:LBVRDA-LBL-TYP-TOT-QTY                          05892006
058930                ,:LBVRDA-BRCDE-NBR                                05893006
058940                ,:LBVRDA-STR-ZN-ID                                05894006
058950                ,:LBVRDA-MODU-DESC                                05895006
058960                ,:LBVRDA-ITM-NBR                                  05896006
058970                ,:LBVRDA-DEPT-DESC                                05897006
058980                ,:LBVRDA-MAJ-CL-DESC                              05898006
058990                ,:LBVRDA-SEASET-NM                                05899006
059000                ,:LBVRDA-FIXT-ID                                  05900006
059010                ,:LBVRDA-LBL-TYP-CDE                              05901006
059020                ,:LBVRDA-PRNT-CART-SEQ-ID                         05902006
059030                ,:LBVRDA-STRG-AREA-CDE                            05903006
059040                ,:LBVRDA-OTPK-UNT-QTY                             05904006
059050                ,:LBVRDA-EAS-TAG-IND                              05905006
059060                ,:LBVRDA-DOOR-ID                                  05906006
059070                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         05907006
059080                ,:LBVRDA-MDSE-PGM-DESC                            05908006
059090*CLP 07/06/2015 START                                             05909008
059100                ,:LBVRDA-LBL-MSG-TXT                              05910008
059110*CLP 07/06/2015 END                                               05911008
059120         END-EXEC                                                 05912006
059130                                                                  05913006
059140     EVALUATE TRUE                                                05914006
059150         WHEN SQLCODE = ZERO                                      05915006
059160              MOVE  LBVRDA-BRCDE-NBR TO DK-BARCODE-NBR            05916006
059170              MOVE  LBVRDA-CART-LBL-TYP-CDE TO                    05917006
059180                                        DK-CART-LBL-TYP-CDE       05918006
059190              MOVE  LBVRDA-DEST-OPER-UNT-ID  TO                   05919006
059200                                        DK-DEST-OPER-UNT-ID       05920006
059210                                        SU001-STORE               05921006
059220              MOVE LBVRDA-EAS-TAG-IND TO                          05922006
059230                                        PS-EAS-TAG-IND-FOUND-SW   05923006
059240              PERFORM 3570-POPULATE-CRTN-LBL-XREF                 05924006
059250              PERFORM 7210-GET-STORE-INFO                         05925006
059260         WHEN SQLCODE = +100                                      05926006
059270              SET PS-END-OF-VRTL-LBL-CSR TO TRUE                  05927006
059280         WHEN SQLWARN0 NOT = SPACE                                05928006
059290         WHEN SQLCODE NOT = ZERO                                  05929006
059300              MOVE '3720-FETCH-INPK-CSR'                          05930006
059310                               TO DP013-PARAGRAPH                 05931006
059320              MOVE 'FETCH VIRTUAL PRINT CSR'                      05932006
059330                               TO DP013-MESSAGE-TEXT (1)          05933006
059340              MOVE SQLCA       TO DP013-SQLCA                     05934006
059350              SET DP013-DB2-ABEND                                 05935006
059360                               TO TRUE                            05936006
059370                 SET DP013-ROLLBACK                               05937006
059380                                   TO TRUE                        05938006
059390              PERFORM DP014-0000-PROCESS-ABEND                    05939006
059400     END-EVALUATE.                                                05940006
059410******************************************************************05941006
059420*  CLOSE VIRTUAL LABEL PRINT CURSOR                            * *05942006
059430******************************************************************05943006
059440 3730-CLOSE-INPK-CSR.                                             05944006
059450         EXEC SQL                                                 05945006
059460             CLOSE VRTL-LBL-PRT-CSR                               05946006
059470         END-EXEC                                                 05947006
059480                                                                  05948006
059490     EVALUATE TRUE                                                05949006
059500         WHEN SQLCODE = ZERO                                      05950006
059510             CONTINUE                                             05951006
059520         WHEN SQLWARN0 NOT = SPACES                               05952006
059530         WHEN SQLCODE < ZERO                                      05953006
059540         WHEN SQLCODE > ZERO                                      05954006
059550             MOVE '3730-CLOSE-CURSOR'                             05955006
059560                               TO DP013-PARAGRAPH                 05956006
059570             MOVE 'CLOSE VRTL PRT CURSOR'                         05957006
059580                               TO DP013-MESSAGE-TEXT (1)          05958006
059590             MOVE SQLCA        TO DP013-SQLCA                     05959006
059600             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        05960006
059610             SET DP013-DB2-ABEND                                  05961006
059620                 DP013-XCTL-DISPLAY-RESTART TO TRUE               05962006
059630                 SET DP013-ROLLBACK                               05963006
059640                                   TO TRUE                        05964006
059650             PERFORM DP014-0000-PROCESS-ABEND                     05965006
059660     END-EVALUATE.                                                05966006
059670                                                                  05967006
059680******************************************************************05968006
059690*  UPDATE ALL THE INNER PACK VIRTUAL ROWS TO CONSUMED          * *05969006
059700******************************************************************05970006
059710 3735-CONSUME-INPK-ROWS.                                          05971006
059720                                                                  05972006
059730     EXEC SQL                                                     05973006
059740        UPDATE TLBVRDA                                            05974006
059750          SET  LBL_ASG_IND           =   'Y'                      05975006
059760        WHERE  PO_NBR                =   :DK-PO                   05976006
059770          AND  RCVR_SEQ_NBR          =   :DK-REC-SEQ-NBR          05977006
059780          AND  PO_LNE_NBR            =   :DK-PO-LNE-NBR           05978006
059790          AND  PREPK_ID              =   :DK-PREPK-ID             05979006
059800          AND  OTPK_UNT_QTY          =   :DK-OUTER-QTY            05980006
059810          AND  LBL_ASG_IND           =   'N'                      05981006
059820          AND  PRNT_CART_SEQ_ID      =   :LBVRDA-LBL-ASG-SEQ-NBR  05982006
059830     END-EXEC                                                     05983006
059840                                                                  05984006
059850     EVALUATE TRUE                                                05985006
059860         WHEN SQLCODE = ZERO                                      05986006
059870             CONTINUE                                             05987006
059880         WHEN SQLWARN0 NOT = SPACES                               05988006
059890         WHEN SQLCODE < ZERO                                      05989006
059900         WHEN SQLCODE > ZERO                                      05990006
059910             MOVE '3735-CONSUME-INPK-ROWS'                        05991006
059920                               TO DP013-PARAGRAPH                 05992006
059930             MOVE 'UPDATE TO TLBVRDA    '                         05993006
059940                               TO DP013-MESSAGE-TEXT (1)          05994006
059950             MOVE SQLCA        TO DP013-SQLCA                     05995006
059960             MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)        05996006
059970             SET DP013-DB2-ABEND                                  05997006
059980                 DP013-XCTL-DISPLAY-RESTART TO TRUE               05998006
059990                 SET DP013-ROLLBACK                               05999006
060000                                   TO TRUE                        06000006
060010             PERFORM DP014-0000-PROCESS-ABEND                     06001006
060020     END-EVALUATE.                                                06002006
060030                                                                  06003006
060040 EJECT                                                            06004006
060050*----------------------------------------------------------------*06005006
060060*  CHECK IF THERE ARE CS OR ECOMMERCE LOCATIONS USING             06006006
060070*  BLIND RECEIVING FOR RDM                                        06007006
060080*----------------------------------------------------------------*06008006
060090 3800-CHECK-RDM-BLIND-RCVNG.                                      06009006
060100                                                                  06010006
060110                                                                  06011006
060120     EXEC SQL                                                     06012006
060130          SELECT FUNC_END_TMST                                    06013006
060140          INTO  :KRPRPM-FUNC-END-TMST                             06014006
060150          FROM   TKRPRPM                                          06015006
060160          WHERE  SYS_PRC_FUNC_CDE  = 'RDMRCV'                     06016006
060170            AND  INTFC_SYS_CDE     = 'RDM'                        06017006
060180            AND  FUNC_PRC_STAT_CDE = 'AC'                         06018006
060190            AND  FUNC_TXT          = 'Y'                          06019006
060200            AND  LOC_ID            =  :LBVRDA-DEST-OPER-UNT-ID    06020006
060210     END-EXEC.                                                    06021006
060220                                                                  06022006
060230                                                                  06023006
060240     EVALUATE TRUE                                                06024006
060250         WHEN SQLCODE = ZERO                                      06025006
060260             SET PS-BLND-RECV-SIMPL-LOC-FND TO TRUE               06026006
060270         WHEN SQLCODE = +100                                      06027006
060280             SET PS-BLND-RECV-SIMPL-LOC-NOT-FND TO TRUE           06028006
060290         WHEN SQLWARN0 NOT = SPACES                               06029006
060300         WHEN SQLCODE < ZERO                                      06030006
060310         WHEN SQLCODE > ZERO                                      06031006
060320             MOVE '3800-CHECK-RDM-BLIND-RCVNG'                    06032006
060330                             TO DP013-PARAGRAPH                   06033006
060340             MOVE 'SUKRF502 - CHECK RDM BLND RCVNG'               06034006
060350                             TO DP013-MESSAGE-TEXT(1)             06035006
060360             MOVE LBVRDA-DEST-OPER-UNT-ID                         06036006
060370                             TO DP013-MESSAGE-TEXT(2)             06037006
060380             MOVE SQLCA      TO DP013-SQLCA                       06038006
060390             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           06039006
060400             SET DP013-DB2-ABEND                                  06040006
060410                             TO TRUE                              06041006
060420             SET DP013-ROLLBACK                                   06042006
060430                             TO TRUE                              06043006
060440             SET DP013-XCTL-DISPLAY-RESTART                       06044006
060450                             TO TRUE                              06045006
060460             PERFORM DP014-0000-PROCESS-ABEND                     06046006
060470                                                                  06047006
060480     END-EVALUATE.                                                06048006
060490*----------------------------------------------------------------*06049006
060500*  CHECK IF THE PO FOR THE DC IS AUTOVE                           06050006
060510*----------------------------------------------------------------*06051006
060520 3805-CHECK-TKRPRPM-AUTOVE.                                       06052006
060530                                                                  06053006
060540     INITIALIZE RC040-FIELDS.                                     06054006
060550     MOVE SU001-PO                 TO RC040-PO-NBR                06055006
060560     MOVE SU001-RCVR-SEQ-NBR       TO RC040-PO-RCVR               06056006
060570                                                                  06057006
060580     IF SU001-RCVR-SEQ-NBR > 0                                    06058006
060590        SET RC040-RCVR-EXISTS         TO TRUE                     06059006
060600     ELSE                                                         06060006
060610        SET RC040-NO-RCVR-EXISTS      TO TRUE                     06061006
060620     END-IF                                                       06062006
060630                                                                  06063006
060640     IF ((SHPUNT-ORGN-OPER-UNT-ID = SU001-OPER-UNT-ID) OR         06064006
060650         (RECEIV-CURR-OPER-UNT-ID = SU001-OPER-UNT-ID))           06065006
060660             CONTINUE                                             06066006
060670     ELSE                                                         06067006
060680         IF SU001-PACK-BY-STORE AND PS-INACTV-PBS-CARTON-NO       06068006
060690            SET RC040-CHCK-MSDIRCT-YES    TO TRUE                 06069006
060700         END-IF                                                   06070006
060710     END-IF                                                       06071006
060720                                                                  06072006
060730     MOVE SU001-OPER-UNT-ID        TO RC040-SIGNON-LOCATION.      06073006
060740                                                                  06074006
060750     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  06075006
060760                                        RC040-COMMAREA            06076006
060770                                        RC040-FIELDS.             06077006
060780                                                                  06078006
060790     EVALUATE TRUE                                                06079006
060800         WHEN RC040-SUCCESSFUL                                    06080006
060810             IF RC040-AUTO-VE-YES                                 06081006
060820                SET SU001-AUTO-VE-YES  TO TRUE                    06082006
060830             ELSE                                                 06083006
060840                SET SU001-AUTO-VE-NO   TO TRUE                    06084006
060850             END-IF                                               06085006
060860         WHEN OTHER                                               06086006
060870              SET PV-DONE-PROCESSING          TO TRUE             06087006
060880              MOVE SQLCODE              TO PV-SQLCODE             06088006
060890              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      06089006
060900                     '3805-CHECK-TKRPRPM ' DELIMITED BY SIZE      06090006
060910                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      06091006
060920                     RC040-CRA-RET-MSG     DELIMITED BY SIZE      06092006
060930                                      INTO PV-CICS-MSG-AREA       06093006
060940              MOVE LENGTH OF PV-CICS-MSG-AREA                     06094006
060950                                        TO PV-COMMAREA-LENGTH     06095006
060960              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              06096006
060970                                                                  06097006
060980              MOVE '3805-CHECK-TKRPRPM   '                        06098006
060990                              TO DP013-PARAGRAPH                  06099006
061000              MOVE 'CALL TO RCKUT127               '              06100006
061010                              TO DP013-MESSAGE-TEXT(1)            06101006
061020              STRING 'MSG - '            DELIMITED BY SIZE        06102006
061030                     RC040-CRA-RET-MSG   DELIMITED BY SIZE        06103006
061040                              INTO DP013-MESSAGE-TEXT (2)         06104006
061050              MOVE 'CHECK CSSL FOR MORE DETAIL     '              06105006
061060                                TO DP013-MESSAGE-TEXT (3)         06106006
061070              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         06107006
061080              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           06108006
061090              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            06109006
061100              STRING ' TRIP - '           DELIMITED BY SIZE       06110006
061110                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       06111006
061120                     '  CARTON - '        DELIMITED BY SIZE       06112006
061130                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       06113006
061140                     '  STORE - '         DELIMITED BY SIZE       06114006
061150                     PV-DISPLAY-STORE     DELIMITED BY SIZE       06115006
061160                              INTO DP013-MESSAGE-TEXT (4)         06116006
061170              MOVE RC040-SQLCA    TO DP013-SQLCA                  06117006
061180              SET DP013-DB2-ABEND                                 06118006
061190                              TO TRUE                             06119006
061200              SET DP013-ROLLBACK                                  06120006
061210                              TO TRUE                             06121006
061220              SET DP013-XCTL-DISPLAY-RESTART                      06122006
061230                              TO TRUE                             06123006
061240              PERFORM DP014-0000-PROCESS-ABEND                    06124006
061250     END-EVALUATE.                                                06125006
061260                                                                  06126006
061270** SLH - BEGIN - 04/24/08                                         06127006
061280******************************************************************06128006
061290 3806-CHECK-FOR-REPURP.                                           06129006
061300                                                                  06130006
061310     MOVE RECEIV-OPER-UNT-ID      TO PV-OPER-UNT-ID.              06131006
061320     MOVE RECEIV-CURR-OPER-UNT-ID TO PV-CURR-OPER-UNT-ID.         06132006
061330                                                                  06133006
061340         EXEC SQL                                                 06134006
061350            SELECT   COUNT(*)                                     06135006
061360              INTO :PV-REPURP-COUNT                               06136006
061370              FROM                                                06137006
061380                    WST_INTGRTN_TYP  A                            06138006
061390                 ,  WST_ATTR_DEFN    B                            06139006
061400                 ,  WST_ATTR_ELEM    C                            06140006
061410                 ,  WST_ATTR_ELEM    D                            06141006
061420                 ,  WST_ATTR_ELEM    E                            06142006
061430                 ,  WST_ATTR_ELEM    F                            06143006
061440                 ,  WST_ATTR_ELEM    G                            06144006
061450              WHERE                                               06145006
061460                    A.INTGRTN_TYP_CDE   = 'EFCREPURP'             06146006
061470                AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE       06147006
061480                AND B.ATTR_DEFN_SEQ_NBR = 1                       06148006
061490                AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE       06149006
061500                AND C.ATTR_DEFN_SEQ_NBR = 1                       06150006
061510                AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE       06151006
061520                AND D.ATTR_DEFN_SEQ_NBR = 2                       06152006
061530                AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE       06153006
061540                AND E.ATTR_DEFN_SEQ_NBR = 3                       06154006
061550                AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE       06155006
061560                AND F.ATTR_DEFN_SEQ_NBR = 4                       06156006
061570                AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE       06157006
061580                AND G.ATTR_DEFN_SEQ_NBR = 5                       06158006
061590                AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR     06159006
061600                AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR     06160006
061610                AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR     06161006
061620                AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR     06162006
061630                AND C.ATTR_ELEM_NBR     = :PV-CURR-OPER-UNT-ID    06163006
061640                AND D.ATTR_ELEM_NBR     = :PV-OPER-UNT-ID         06164006
061650                AND E.ATTR_ELEM_TXT     = 'Y'                     06165006
061660                AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP       06166006
061670             AND G.ATTR_ELEM_TMST = '9999-09-09-23.59.59.999999'  06167006
061680         END-EXEC.                                                06168006
061690                                                                  06169006
061700***  C.ATTR_ELEM_NBR = 1 = DC NUMBER                              06170006
061710***  D.ATTR_ELEM_NBR = 2 = EFC NUMBER                             06171006
061720                                                                  06172006
061730***  WHEN 810 PROCESING FOR 870, CURR OPER = 810, OPER = 870      06173006
061740                                                                  06174006
061750         EVALUATE TRUE                                            06175006
061760             WHEN SQLCODE = +0                                    06176006
061770             WHEN SQLCODE = +100                                  06177006
061780             WHEN SQLCODE = -904                                  06178006
061790             WHEN SQLCODE = -913                                  06179006
061800                  CONTINUE                                        06180006
061810                                                                  06181006
061820             WHEN SQLWARN0 NOT = SPACES                           06182006
061830             WHEN SQLCODE < +0                                    06183006
061840             WHEN SQLCODE > +0                                    06184006
061850                  MOVE '3806-CHECK-FOR-REPURP'                    06185006
061860                                  TO DP013-PARAGRAPH              06186006
061870                  MOVE 'UNSUCCESSFUL SELECT ON WST_INTGRTN_TYP'   06187006
061880                                  TO DP013-MESSAGE-TEXT (1)       06188006
061890                  MOVE SQLCA      TO DP013-SQLCA                  06189006
061900                  MOVE 'WST_INTGRTN_TYP'                          06190006
061910                                  TO DP013-DB2-TABLE-NAME (1)     06191006
061920                  MOVE 'WST_ATTR_DEFN'                            06192006
061930                                  TO DP013-DB2-TABLE-NAME (2)     06193006
061940                  MOVE 'WST_ATTR_ELEM'                            06194006
061950                                  TO DP013-DB2-TABLE-NAME (3)     06195006
061960                  SET DP013-DB2-ABEND                             06196006
061970                      DP013-XCTL-DISPLAY-RESTART                  06197006
061980                                  TO TRUE                         06198006
061990              PERFORM DP014-0000-PROCESS-ABEND                    06199006
062000         END-EVALUATE.                                            06200006
062010                                                                  06201006
062020*----------------------------------------------------------------*06202068
062030*  DETERMINE CARTON LABEL                                         06203068
062040*----------------------------------------------------------------*06204068
062050 3807-DETERMINE-CRTN-LBL.                                         06205068
062060                                                                  06206068
062070     IF SU093-PRINT-RFID                                          06207068
062080        PERFORM 3808-TKRPRPM-RFID-LBL-INFO                        06208068
062090     ELSE                                                         06209068
062100        IF SU093-PRINT-EAS                                        06210068
062110           PERFORM 3809-TKRPRPM-EAS-LBL-INFO                      06211068
062120        ELSE                                                      06212068
062130           PERFORM 3810-TKRPRPM-RFEACR-LBL-INFO                   06213068
062140        END-IF                                                    06214068
062150     END-IF.                                                      06215068
062160                                                                  06216068
062170* 07/19/13 RLK BEG                                                06217022
062180*----------------------------------------------------------------*06218021
062190*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR RFID LABELS    06219021
062200*----------------------------------------------------------------*06220021
062210 3808-TKRPRPM-RFID-LBL-INFO.                                      06221021
062220                                                                  06222021
062230                                                                  06223021
062240     EXEC SQL                                                     06224021
062250          SELECT FUNC_TXT                                         06225006
062260          INTO  :KRPRPM-FUNC-TXT                                  06226006
062270          FROM   TKRPRPM                                          06227006
062280          WHERE  SYS_PRC_FUNC_CDE  = 'RFDCRT'                     06228006
062290            AND  INTFC_SYS_CDE     = 'KHL'                        06229006
062300            AND  FUNC_PRC_STAT_CDE = 'AC'                         06230006
062310            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         06231006
062320     END-EXEC.                                                    06232006
062330                                                                  06233006
062340                                                                  06234006
062350     EVALUATE TRUE                                                06235006
062360         WHEN SQLCODE = ZERO                                      06236006
062370             SET PS-LABEL-PARM-FOUND     TO TRUE                  06237068
062380                                                                  06238068
062390         WHEN SQLCODE = +100                                      06239006
062400             SET PS-LABEL-PARM-NOT-FOUND TO TRUE                  06240068
062410                                                                  06241068
062420         WHEN SQLWARN0 NOT = SPACES                               06242006
062430         WHEN SQLCODE < ZERO                                      06243006
062440         WHEN SQLCODE > ZERO                                      06244006
062450             MOVE '3808-TKRPRPM-RFID-LBL-INFO'                    06245006
062460                             TO DP013-PARAGRAPH                   06246006
062470             MOVE 'SUKRF502 - CHECK RFID LBL PARM'                06247006
062480                             TO DP013-MESSAGE-TEXT(1)             06248006
062490             MOVE LBVRDA-DEST-OPER-UNT-ID                         06249062
062500                             TO DP013-MESSAGE-TEXT(2)             06250062
062510             MOVE LBPTDA-OPER-UNT-ID                              06251068
062520                             TO DP013-MESSAGE-TEXT(3)             06252068
062530             MOVE SQLCA      TO DP013-SQLCA                       06253006
062540             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           06254006
062550             SET DP013-DB2-ABEND                                  06255006
062560                             TO TRUE                              06256006
062570             SET DP013-ROLLBACK                                   06257006
062580                             TO TRUE                              06258006
062590             SET DP013-XCTL-DISPLAY-RESTART                       06259006
062600                             TO TRUE                              06260006
062610             PERFORM DP014-0000-PROCESS-ABEND                     06261006
062620                                                                  06262006
062630     END-EVALUATE.                                                06263006
062640                                                                  06264006
062650*----------------------------------------------------------------*06265068
062660*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR EAS LABELS     06266068
062670*----------------------------------------------------------------*06267068
062680 3809-TKRPRPM-EAS-LBL-INFO.                                       06268068
062690                                                                  06269068
062700                                                                  06270068
062710     EXEC SQL                                                     06271068
062720          SELECT FUNC_TXT                                         06272068
062730          INTO  :KRPRPM-FUNC-TXT                                  06273068
062740          FROM   TKRPRPM                                          06274068
062750          WHERE  SYS_PRC_FUNC_CDE  = 'EASCRT'                     06275068
062760            AND  INTFC_SYS_CDE     = 'KHL'                        06276068
062770            AND  FUNC_PRC_STAT_CDE = 'AC'                         06277068
062780            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         06278068
062790     END-EXEC.                                                    06279068
062800                                                                  06280068
062810                                                                  06281068
062820     EVALUATE TRUE                                                06282068
062830         WHEN SQLCODE = ZERO                                      06283068
062840             SET PS-LABEL-PARM-FOUND     TO TRUE                  06284068
062850                                                                  06285068
062860         WHEN SQLCODE = +100                                      06286068
062870             SET PS-LABEL-PARM-NOT-FOUND TO TRUE                  06287068
062880                                                                  06288068
062890         WHEN SQLWARN0 NOT = SPACES                               06289068
062900         WHEN SQLCODE < ZERO                                      06290068
062910         WHEN SQLCODE > ZERO                                      06291068
062920             MOVE '3809-TKRPRPM-EAS-LBL-INFO'                     06292068
062930                             TO DP013-PARAGRAPH                   06293068
062940             MOVE 'SUKRF502 - CHECK RFID LBL PARM'                06294068
062950                             TO DP013-MESSAGE-TEXT(1)             06295068
062960             MOVE LBVRDA-DEST-OPER-UNT-ID                         06296068
062970                             TO DP013-MESSAGE-TEXT(2)             06297068
062980             MOVE LBPTDA-OPER-UNT-ID                              06298068
062990                             TO DP013-MESSAGE-TEXT(3)             06299068
063000             MOVE SQLCA      TO DP013-SQLCA                       06300068
063010             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           06301068
063020             SET DP013-DB2-ABEND                                  06302068
063030                             TO TRUE                              06303068
063040             SET DP013-ROLLBACK                                   06304068
063050                             TO TRUE                              06305068
063060             SET DP013-XCTL-DISPLAY-RESTART                       06306068
063070                             TO TRUE                              06307068
063080             PERFORM DP014-0000-PROCESS-ABEND                     06308068
063090                                                                  06309068
063100     END-EVALUATE.                                                06310068
063110                                                                  06311068
063120*----------------------------------------------------------------*06312068
063130*  GET PARM THAT PROVIDES TEXT AND DIVERT CODE FOR RF & EAS LABELS06313068
063140*----------------------------------------------------------------*06314068
063150 3810-TKRPRPM-RFEACR-LBL-INFO.                                    06315068
063160                                                                  06316068
063170                                                                  06317068
063180     EXEC SQL                                                     06318068
063190          SELECT FUNC_TXT                                         06319068
063200          INTO  :KRPRPM-FUNC-TXT                                  06320068
063210          FROM   TKRPRPM                                          06321068
063220          WHERE  SYS_PRC_FUNC_CDE  = 'RFEACR'                     06322068
063230            AND  INTFC_SYS_CDE     = 'KHL'                        06323068
063240            AND  FUNC_PRC_STAT_CDE = 'AC'                         06324068
063250            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         06325068
063260     END-EXEC.                                                    06326068
063270                                                                  06327068
063280                                                                  06328068
063290     EVALUATE TRUE                                                06329068
063300         WHEN SQLCODE = ZERO                                      06330068
063310             SET PS-LABEL-PARM-FOUND     TO TRUE                  06331068
063320                                                                  06332068
063330         WHEN SQLCODE = +100                                      06333068
063340             SET PS-LABEL-PARM-NOT-FOUND TO TRUE                  06334068
063350                                                                  06335068
063360         WHEN SQLWARN0 NOT = SPACES                               06336068
063370         WHEN SQLCODE < ZERO                                      06337068
063380         WHEN SQLCODE > ZERO                                      06338068
063390             MOVE '3810-TKRPRPM-RFEACR-LBL-INFO'                  06339068
063400                             TO DP013-PARAGRAPH                   06340068
063410             MOVE 'SUKRF502 - CHECK RFID LBL PARM'                06341068
063420                             TO DP013-MESSAGE-TEXT(1)             06342068
063430             MOVE LBVRDA-DEST-OPER-UNT-ID                         06343068
063440                             TO DP013-MESSAGE-TEXT(2)             06344068
063450             MOVE LBPTDA-OPER-UNT-ID                              06345068
063460                             TO DP013-MESSAGE-TEXT(3)             06346068
063470             MOVE SQLCA      TO DP013-SQLCA                       06347068
063480             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           06348068
063490             SET DP013-DB2-ABEND                                  06349068
063500                             TO TRUE                              06350068
063510             SET DP013-ROLLBACK                                   06351068
063520                             TO TRUE                              06352068
063530             SET DP013-XCTL-DISPLAY-RESTART                       06353068
063540                             TO TRUE                              06354068
063550             PERFORM DP014-0000-PROCESS-ABEND                     06355068
063560                                                                  06356068
063570     END-EVALUATE.                                                06357068
063580                                                                  06358068
063581******************************************************************06358179
063583* THE FOLLOWING IS GOING TO GET THE CURRENT TIMESTAMP AND         06358379
063584* THEN USE THE LAST 4 DIGITS OF THE NANO SECONDS TO PLUG          06358479
063585* INTO THE LAST 4 DIGITS OF THE 22 DIGIT BARCODE FOR RFID         06358579
063586* LABELS TO MAKE THE NUMBER AS UNIQUE AS POSSIBLE.                06358679
063587*                                                                 06358779
063588* THIS WAS DONE DUE TO A DUPLICATE BARCODE ISSUE BEING            06358879
063589* SEEN AT THE DC'S DUE TO THE ZERO IN THE LAST 4 DIGITS           06358979
063590* OF THE 22 DIGIT BARCODE NUMBER.                                 06359079
063591*                                                                 06359179
063592* ALSO ADDED LOGIC THAT IF THE LAST 4 DIGITS OF THE TIMESTAMP     06359279
063593* IS A VALUE LESS THAN 1000, THEN ADDED 1000 TO THE VALUE -       06359379
063594* WANTED TO MAKE SURE THAT IF THIS BARCODE EVER GOT INTO PACK-    06359479
063595* TO-LIGHT, IT COULD NOT BE USED TO LAUNCH THE LIGHTS ON THE      06359579
063596* MOD FOR A DISTRIBUTION.                                         06359679
063597*                                                                 06359779
063598******************************************************************06359879
063599                                                                  06359979
063600 3811-GET-LAST-4-OF-BARCODE.                                      06360079
063601                                                                  06360179
063602     EXEC SQL                                                     06360279
063603          SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                06360379
063604     END-EXEC.                                                    06360479
063605                                                                  06360579
063606     MOVE PV-CURRENT-TMST TO PV-CURRENT-TMST-R.                   06360679
063607                                                                  06360779
063608     IF PV-CURRENT-TMST-R-LAST-4 < 1000                           06360879
063609        COMPUTE PV-CURRENT-TMST-R-LAST-4 =                        06360979
063610                PV-CURRENT-TMST-R-LAST-4 + 1000                   06361079
063611     END-IF.                                                      06361179
063612                                                                  06361279
063613                                                                  06361379
063614******************************************************************06361481
063615* THIS PARAGRAPH WILL CHECK PARM RFIDMS TO SEE IF THE LAST 4      06361581
063616* DIGITS OF THE MICRO SECONDS FROM A TIMESTAMP SHOULD BE          06361681
063617* POPULATED TO THE LAST 4 DIGITS OF THE RFID LABEL BARCODE OR IF  06361781
063618* WE JUST POPULATE ZEROS.                                         06361881
063620******************************************************************06362081
063621                                                                  06362181
063622 3812-LAST-4-OF-BARCODE-PARM.                                     06362281
063623                                                                  06362381
063624     EXEC SQL                                                     06362481
063625          SELECT FUNC_END_TMST                                    06362581
063626          INTO  :KRPRPM-FUNC-END-TMST                             06362681
063629          FROM   TKRPRPM                                          06362981
063630          WHERE  SYS_PRC_FUNC_CDE  = 'RFIDMS'                     06363081
063631            AND  INTFC_SYS_CDE     = 'KHL'                        06363181
063632            AND  FUNC_PRC_STAT_CDE = 'AC'                         06363281
063633            AND  FUNC_TXT          = 'Y'                          06363381
063634            AND  LOC_ID            =  :LBPTDA-OPER-UNT-ID         06363481
063635     END-EXEC.                                                    06363581
063636                                                                  06363681
063637                                                                  06363781
063638     EVALUATE TRUE                                                06363881
063639         WHEN SQLCODE = ZERO                                      06363981
063640             SET PS-USE-LAST-4-FROM-TMST TO TRUE                  06364081
063641         WHEN SQLCODE = +100                                      06364181
063642             SET PS-USE-LAST-4-ZEROS TO TRUE                      06364281
063643         WHEN SQLWARN0 NOT = SPACES                               06364381
063644         WHEN SQLCODE < ZERO                                      06364481
063645         WHEN SQLCODE > ZERO                                      06364581
063646             MOVE '3812-LAST-4-OF-BARCODE-PARM'                   06364681
063647                             TO DP013-PARAGRAPH                   06364781
063648             MOVE 'SUKRF502 - CHECK LAST 4 DIGIT RFID USE'        06364881
063649                             TO DP013-MESSAGE-TEXT(1)             06364981
063650             MOVE LBVRDA-DEST-OPER-UNT-ID                         06365081
063651                             TO DP013-MESSAGE-TEXT(2)             06365181
063652             MOVE SQLCA      TO DP013-SQLCA                       06365281
063653             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           06365381
063654             SET DP013-DB2-ABEND                                  06365481
063655                             TO TRUE                              06365581
063656             SET DP013-ROLLBACK                                   06365681
063657                             TO TRUE                              06365781
063658             SET DP013-XCTL-DISPLAY-RESTART                       06365881
063659                             TO TRUE                              06365981
063660             PERFORM DP014-0000-PROCESS-ABEND                     06366081
063661                                                                  06366181
063662     END-EVALUATE.                                                06366281
063663******************************************************************06366379
063664******************************************************************06366479
063665 4000-XCTL-LRT-MENU.                                              06366579
063666******************************************************************06366606
063667******************************************************************06366706
063668             IF PV-TEST-CICS OR PV-QA-CICS                        06366806
063669                EXEC SQL                                          06366906
063670                   SET :PV-END-TIME = CURRENT TIMESTAMP           06367006
063671                END-EXEC                                          06367106
063680                MOVE SPACES TO PV-CICS-MSG-AREA-A                 06368006
063690                STRING 'SUKRF502 BEG TIME '  DELIMITED BY SIZE    06369006
063700                     PV-BEGIN-TIME           DELIMITED BY SIZE    06370006
063710                                        INTO PV-CICS-MSG-AREA-B   06371006
063720                MOVE LENGTH OF PV-CICS-MSG-AREA-A                 06372006
063730                                        TO PV-COMMAREA-LENGTH     06373006
063740                PERFORM 9998-WRITE-TO-CSSL                        06374006
063750*                                                                 06375006
063760                MOVE SPACES TO PV-CICS-MSG-AREA-A                 06376006
063770                STRING 'SUKRF502 END TIME '    DELIMITED BY SIZE  06377006
063780                         PV-END-TIME         DELIMITED BY SIZE    06378006
063790                       ' - '                 DELIMITED BY SIZE    06379006
063800                       PV-TRANSFER-PROGRAM   DELIMITED BY SIZE    06380006
063810                                        INTO PV-CICS-MSG-AREA-B   06381006
063820                MOVE LENGTH OF PV-CICS-MSG-AREA-A                 06382006
063830                                        TO PV-COMMAREA-LENGTH     06383006
063840                PERFORM 9998-WRITE-TO-CSSL                        06384006
063850             END-IF                                               06385006
063860******************************************************************06386006
063870     SET SU001-INITIALIZE-SCREEN  TO TRUE.                        06387006
063880     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          06388006
063890                                                                  06389006
063900     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           06390006
063910     EXEC CICS                                                    06391006
063920         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    06392006
063930               COMMAREA  (CA-COMMAREA)                            06393006
063940               LENGTH    (PV-COMMAREA-LENGTH)                     06394006
063950               RESP      (PV-CICS-RESPONSE)                       06395006
063960     END-EXEC.                                                    06396006
063970                                                                  06397006
063980     EVALUATE TRUE                                                06398006
063990         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06399006
064000             CONTINUE                                             06400006
064010         WHEN OTHER                                               06401006
064020             MOVE '4000-XCTL-TO-LRT-MENU'                         06402006
064030                 TO DP013-PARAGRAPH                               06403006
064040             MOVE 'SUKRF502 - UNABLE TO XCTL TO PROGRAM: '        06404006
064050                 TO DP013-MESSAGE-TEXT (1)                        06405006
064060             MOVE PV-TRANSFER-PROGRAM                             06406006
064070                 TO DP013-MESSAGE-TEXT (2)                        06407006
064080             SET DP013-CICS-ABEND  TO TRUE                        06408006
064090             SET DP013-ROLLBACK TO TRUE                           06409006
064100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06410006
064110             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             06411006
064120             SET SU001-PROCESS-SCREEN TO TRUE                     06412006
064130             PERFORM 8000-SEND-MAP                                06413006
064140             PERFORM 8200-RETURN-TRANID                           06414006
064150     END-EVALUATE.                                                06415006
064160                                                                  06416006
064170******************************************************************06417006
064180******************************************************************06418006
064190 4100-XCTL-CRTN-AUDIT.                                            06419006
064200                                                                  06420006
064210     IF PV-TEST-CICS OR PV-QA-CICS                                06421006
064220        MOVE SPACE TO PV-CICS-MSG-AREA-A                          06422006
064230        STRING ' SUKRF502: 4100- '                                06423006
064240             ' RFID-QC IND = '                                    06424006
064250               SU006-RFID-QC-AUDIT-IND                            06425006
064260             ' RFID-QC COMB IND = '                               06426006
064270             SU006-RFID-QC-AUD-CMB-IND                            06427006
064280             ' XCTL TO '                                          06428006
064290             PV-TRANSFER-PROGRAM                                  06429006
064300            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             06430006
064310            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     06431006
064320                                           TO PV-COMMAREA-LENGTH  06432006
064330       EXEC CICS WRITEQ TD                                        06433006
064340                      QUEUE('CSSL')                               06434006
064350                      FROM(PV-CICS-MSG-AREA-A)                    06435006
064360                      LENGTH(PV-COMMAREA-LENGTH)                  06436006
064370                      RESP (PV-CICS-RESPONSE)                     06437006
064380       END-EXEC                                                   06438006
064390     END-IF.                                                      06439006
064400                                                                  06440006
064410     IF PV-TEST-CICS OR PV-QA-CICS                                06441006
064420            MOVE SPACE TO PV-CICS-MSG-AREA-A                      06442006
064430            MOVE SU021-AUDIT-NUMBER TO PV-AUDIT                   06443006
064440            MOVE SU021-RFID-AUDIT-NUMBER TO PV-AUDITR             06444006
064450            MOVE SU001-CARTON TO PV-CARTON-CNT18                  06445006
064460            STRING ' 502: 4100- '                                 06446006
064470             ' AUD-NO='                                           06447006
064480               PV-AUDIT                                           06448006
064490             ' RAUD-NO='                                          06449006
064500               PV-AUDITR                                          06450006
064510             ' CN ='                                              06451006
064520             PV-CARTON-CNT18                                      06452006
064530            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             06453006
064540            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     06454006
064550                                            TO PV-COMMAREA-LENGTH 06455006
064560            EXEC CICS WRITEQ TD                                   06456006
064570                      QUEUE('CSSL')                               06457006
064580                      FROM(PV-CICS-MSG-AREA-A)                    06458006
064590                      LENGTH(PV-COMMAREA-LENGTH)                  06459006
064600                      RESP (PV-CICS-RESPONSE)                     06460006
064610            END-EXEC                                              06461006
064620     END-IF.                                                      06462006
064630                                                                  06463006
064640     SET  SU006-INITIALIZE-SCREEN TO TRUE.                        06464006
064650     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM           06465006
064660                                     SU006-LAST-PROGRAM           06466006
064670     MOVE LENGTH OF CA-COMMAREA-CRTN-AUD                          06467006
064680                                  TO PV-COMMAREA-LENGTH           06468006
064690     EXEC CICS                                                    06469006
064700         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    06470006
064710               COMMAREA  (CA-COMMAREA-CRTN-AUD)                   06471006
064720               LENGTH    (PV-COMMAREA-LENGTH)                     06472006
064730               RESP      (PV-CICS-RESPONSE)                       06473006
064740     END-EXEC.                                                    06474006
064750                                                                  06475006
064760     EVALUATE TRUE                                                06476006
064770         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06477006
064780             CONTINUE                                             06478006
064790         WHEN OTHER                                               06479006
064800             MOVE '4100-XCTL-CRTN-AUDIT '                         06480006
064810                 TO DP013-PARAGRAPH                               06481006
064820             MOVE 'SUKRF502 - UNABLE TO XCTL TO PROGRAM: '        06482006
064830                 TO DP013-MESSAGE-TEXT (1)                        06483006
064840             MOVE PV-TRANSFER-PROGRAM                             06484006
064850                 TO DP013-MESSAGE-TEXT (2)                        06485006
064860             SET DP013-CICS-ABEND  TO TRUE                        06486006
064870             SET DP013-ROLLBACK TO TRUE                           06487006
064880             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06488006
064890             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             06489006
064900             SET SU001-PROCESS-SCREEN TO TRUE                     06490006
064910             PERFORM 8000-SEND-MAP                                06491006
064920             PERFORM 8200-RETURN-TRANID                           06492006
064930     END-EVALUATE.                                                06493006
064940*                                                                 06494006
064950 4200-XCTL-TO-HELP.                                               06495006
064960                                                                  06496006
064970     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      06497006
064980     SET  SU001-INITIALIZE-SCREEN     TO TRUE.                    06498006
064990     MOVE SU001-COMMON-DATA           TO PC192-HOST-SAVE-AREA.    06499006
065000                                                                  06500006
065010     EXEC CICS                                                    06501006
065020         XCTL                                                     06502006
065030             PROGRAM   (PV-TRANSFER-PROGRAM)                      06503006
065040             COMMAREA  (PC192-COMMAREA)                           06504006
065050             LENGTH    (PV-COMMAREA-LENGTH)                       06505006
065060             RESP      (PV-CICS-RESPONSE)                         06506006
065070     END-EXEC.                                                    06507006
065080                                                                  06508006
065090     EVALUATE TRUE                                                06509006
065100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06510006
065110              CONTINUE                                            06511006
065120         WHEN OTHER                                               06512006
065130             MOVE '4200-XCTL-TO-HELP '                            06513006
065140                 TO DP013-PARAGRAPH                               06514006
065150             MOVE 'SUKRF502 - UNABLE TO XCTL TO PROGRAM: '        06515006
065160                 TO DP013-MESSAGE-TEXT (1)                        06516006
065170             MOVE PV-TRANSFER-PROGRAM                             06517006
065180                 TO DP013-MESSAGE-TEXT (2)                        06518006
065190             SET DP013-CICS-ABEND  TO TRUE                        06519006
065200             SET DP013-ROLLBACK TO TRUE                           06520006
065210             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06521006
065220             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             06522006
065230             SET SU001-PROCESS-SCREEN TO TRUE                     06523006
065240             PERFORM 8000-SEND-MAP                                06524006
065250             PERFORM 8200-RETURN-TRANID                           06525006
065260     END-EVALUATE.                                                06526006
065270                                                                  06527006
065280 4250-LINK-TO-FRASTY-HANDLER.                                     06528006
065290                                                                  06529006
065300                                                                  06530006
065310*    INITIALIZE SU044-COMM-AREA.                                  06531006
065320     MOVE SU001-CARTON             TO SU044-SHIPT-UNT-ID.         06532006
065330     MOVE SU001-PO                 TO SU044-PO.                   06533006
065340     MOVE SU001-RCVR-SEQ-NBR       TO SU044-ORIG-REC-SEQ-NBR.     06534006
065350     MOVE SU001-OPER-UNT-ID        TO SU044-OPER-UNT-ID.          06535006
065360     MOVE SU001-FCLTY-ID           TO SU044-FCLTY-ID.             06536006
065370     MOVE SU001-OWNER-SCAC-ID      TO SU044-SCAC-ID.              06537006
065380     MOVE SU001-MANIFEST           TO SU044-TRIP-ID.              06538006
065390     MOVE SU001-VEH-NBR            TO SU044-VEH-NBR.              06539006
065400     MOVE SU001-ORIGIN-OPER-UNT-ID TO SU044-CRTN-OPER-UNT-ID.     06540006
065410     MOVE PC-CURRENT-PROGRAM-NAME  TO SU044-PROGRAM-NAME.         06541006
065420     MOVE SU001-USER-ID            TO SU044-SIGNON-USER-ID.       06542006
065430     SET  SU044-SRC-CHECKIN        TO TRUE.                       06543006
065440     IF SU001-PACK-BY-STORE                                       06544006
065450        SET SU044-RCVR-PBS         TO TRUE                        06545006
065460        MOVE SU001-STORE           TO SU044-DEST-STR-NBR          06546006
065470     ELSE                                                         06547006
065480        MOVE ZEROES                TO SU044-DEST-STR-NBR          06548006
065490        IF RECEIV-PKGNG-CDE  = PC-M OR PC-I                       06549006
065500           SET SU044-RCVR-PREPK    TO TRUE                        06550006
065510        ELSE                                                      06551006
065520           SET SU044-RCVR-BULK     TO TRUE                        06552006
065530        END-IF                                                    06553006
065540     END-IF                                                       06554006
065550                                                                  06555006
065560     MOVE LENGTH OF SU044-COMM-AREA TO  PV-COMMAREA-LENGTH.       06556006
065570                                                                  06557006
065580     EXEC CICS                                                    06558006
065590         LINK PROGRAM  (PC-FA-HANDLER-PGM)                        06559006
065600              COMMAREA (SU044-COMM-AREA)                          06560006
065610              LENGTH   (PV-COMMAREA-LENGTH)                       06561006
065620     END-EXEC.                                                    06562006
065630                                                                  06563006
065640                                                                  06564006
065650     EVALUATE TRUE                                                06565006
065660         WHEN SU044-SUCCESSFUL                                    06566006
065670              CONTINUE                                            06567006
065680         WHEN OTHER                                               06568006
065690              SET PV-DONE-PROCESSING          TO TRUE             06569006
065700              MOVE SQLCODE              TO PV-SQLCODE             06570006
065710              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      06571006
065720                     '4250-LINK-SUKUT705 ' DELIMITED BY SIZE      06572006
065730                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      06573006
065740                     SU044-CRA-RET-MSG     DELIMITED BY SIZE      06574006
065750                     '  PARA-'             DELIMITED BY SIZE      06575006
065760                     SU044-CRA-REQ-ID      DELIMITED BY SIZE      06576006
065770                                      INTO PV-CICS-MSG-AREA       06577006
065780              MOVE LENGTH OF PV-CICS-MSG-AREA                     06578006
065790                                        TO PV-COMMAREA-LENGTH     06579006
065800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              06580006
065810                                                                  06581006
065820              MOVE '4250-LINK-SUKUT705   '                        06582006
065830                              TO DP013-PARAGRAPH                  06583006
065840              MOVE 'LINK TO SUKUT705               '              06584006
065850                              TO DP013-MESSAGE-TEXT(1)            06585006
065860              STRING 'MSG - '            DELIMITED BY SIZE        06586006
065870                     SU044-CRA-RET-MSG   DELIMITED BY SIZE        06587006
065880                              INTO DP013-MESSAGE-TEXT (2)         06588006
065890              MOVE 'CHECK CSSL FOR MORE DETAIL     '              06589006
065900                                TO DP013-MESSAGE-TEXT (3)         06590006
065910              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         06591006
065920              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           06592006
065930              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            06593006
065940              STRING ' TRIP - '           DELIMITED BY SIZE       06594006
065950                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       06595006
065960                     '  CARTON - '        DELIMITED BY SIZE       06596006
065970                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       06597006
065980                     '  STORE - '         DELIMITED BY SIZE       06598006
065990                     PV-DISPLAY-STORE     DELIMITED BY SIZE       06599006
066000                              INTO DP013-MESSAGE-TEXT (4)         06600006
066010              MOVE SQLCA     TO DP013-SQLCA                       06601006
066020              SET DP013-DB2-ABEND                                 06602006
066030                              TO TRUE                             06603006
066040              SET DP013-ROLLBACK                                  06604006
066050                              TO TRUE                             06605006
066060              SET DP013-XCTL-DISPLAY-RESTART                      06606006
066070                              TO TRUE                             06607006
066080              PERFORM DP014-0000-PROCESS-ABEND                    06608006
066090     END-EVALUATE.                                                06609006
066100                                                                  06610006
066110 4300-XCTL-TO-PCKRF901.                                           06611006
066120     MOVE PC-CURRENT-PROGRAM-NAME  TO SU001-LAST-PROGRAM          06612006
066130                                      PC056-LAST-PROGRAM.         06613006
066140     SET SU001-INITIALIZE-SCREEN   TO TRUE                        06614006
066150     IF SU001-PO > ZERO                                           06615006
066160         SET PC056-FROM-SUKRF002-WITH-DATA                        06616006
066170                                   TO TRUE                        06617006
066180         MOVE SU001-CURR-OPER-UNT-ID                              06618006
066190                                   TO PC056-OPER-UNT-ID           06619006
066200                                      PC056-SIGNON-OPER-UNT       06620006
066210         MOVE SU001-CARTON         TO PC056-CARTON                06621006
066220         MOVE SU001-PO             TO PC056-PO                    06622006
066230         MOVE SU001-RCVR-SEQ-NBR   TO PC056-RCVR-SEQ-NBR          06623006
066240     END-IF                                                       06624006
066250     MOVE SU001-COMMON-DATA        TO PC056-HOST-SAVE-AREA.       06625006
066260     MOVE LENGTH OF PC056-COMMAREA TO PV-COMMAREA-LENGTH.         06626006
066270     EXEC CICS                                                    06627006
066280         XCTL  PROGRAM   (PC-LINE-LOCATION-PGM)                   06628006
066290               COMMAREA  (PC056-COMMAREA)                         06629006
066300               LENGTH    (PV-COMMAREA-LENGTH)                     06630006
066310               RESP      (PV-CICS-RESPONSE)                       06631006
066320     END-EXEC.                                                    06632006
066330                                                                  06633006
066340*----------------------------------------------------------------*06634006
066350* CHECK IF PO/RECEIVER IS IN TROUBLE                             *06635006
066360* EXCEPTIONS ARE STORAGE TROUBLE (999,301,998,)  AND             *06636006
066370* PBS EDIT TROUBLE  (350,351,352,353,354)                        *06637006
066380*----------------------------------------------------------------*06638006
066390 4450-CHECK-TROUBLE.                                              06639006
066400     MOVE SU001-RCVR-SEQ-NBR       TO DK-REC-SEQ-NBR.             06640006
066410     MOVE ZEROES                   TO PV-TROUBLE-COUNT.           06641006
066420                                                                  06642006
066430     EXEC SQL                                                     06643006
066440        SELECT COUNT(*)                                           06644006
066450          INTO :PV-TROUBLE-COUNT                                  06645006
066460          FROM TTRBNTF A                                          06646006
066470              ,TTRBRSN C                                          06647006
066480         WHERE A.PO_NBR       =  :DK-PO                           06648006
066490           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  06649006
066500           AND A.RESOLVED_IND IN ('N','I','R')                    06650006
066510           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    06651006
066520           AND C.NOTIF_IND    =  'T'                              06652006
066530           AND NOT EXISTS                                         06653006
066540              ( SELECT *                                          06654006
066550                FROM  TTRBRCN B                                   06655006
066560                WHERE B.RPT_PGM_NM  = 'SUKRF502'                  06656006
066570                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         06657006
066580     END-EXEC                                                     06658006
066590                                                                  06659006
066600     EVALUATE TRUE                                                06660006
066610         WHEN SQLCODE = ZERO                                      06661006
066620             IF PV-TROUBLE-COUNT > +0                             06662006
066630                SET PS-TROUBLE-FOUND TO TRUE                      06663006
066640             ELSE                                                 06664006
066650                SET PS-NO-TROUBLE-FOUND TO TRUE                   06665006
066660             END-IF                                               06666006
066670         WHEN SQLCODE = +100                                      06667006
066680             SET PS-NO-TROUBLE-FOUND TO TRUE                      06668006
066690         WHEN SQLWARN0 NOT = SPACES                               06669006
066700         WHEN SQLCODE < ZERO                                      06670006
066710         WHEN SQLCODE > ZERO                                      06671006
066720             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            06672006
066730             MOVE DK-PO          TO  PV-DISPLAY-PO                06673006
066740             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           06674006
066750             MOVE '4450-CHECK-TROUBLE      '                      06675006
066760                             TO DP013-PARAGRAPH                   06676006
066770             MOVE 'SUKRF502 - CHECK FOR TROUBLE   '               06677006
066780                             TO DP013-MESSAGE-TEXT(1)             06678006
066790             STRING '  CARTON - '        DELIMITED BY SIZE        06679006
066800                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        06680006
066810                    ' PO, RCVR   '       DELIMITED BY SIZE        06681006
066820                    PV-DISPLAY-PO        DELIMITED BY SIZE        06682006
066830                    ' '                  DELIMITED BY SIZE        06683006
066840                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        06684006
066850                    ' '                  DELIMITED BY SIZE        06685006
066860                             INTO DP013-MESSAGE-TEXT (2)          06686006
066870             MOVE SQLCA      TO DP013-SQLCA                       06687006
066880             MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME(1)           06688006
066890             SET DP013-DB2-ABEND                                  06689006
066900                             TO TRUE                              06690006
066910             SET DP013-ROLLBACK                                   06691006
066920                             TO TRUE                              06692006
066930             SET DP013-XCTL-DISPLAY-RESTART                       06693006
066940                             TO TRUE                              06694006
066950             PERFORM DP014-0000-PROCESS-ABEND                     06695006
066960                                                                  06696006
066970     END-EVALUATE.                                                06697006
066980                                                                  06698006
066990/                                                                 06699006
067000*----------------------------------------------------------------*06700006
067010* CHECK IF THE PBS PO/RCVR THAT IS IN TROUBLE NEEDS TO CONTINUE  *06701006
067020* TO BE CHECKED FOR QC AUDIT                                     *06702006
067030*----------------------------------------------------------------*06703006
067040 4460-CHECK-PO-AUD-REQ.                                           06704006
067050     MOVE SU001-PO                 TO SUT00015-PO-NBR.            06705006
067060     MOVE SU001-RCVR-SEQ-NBR       TO SUT00015-RCVR-SEQ-NBR.      06706006
067070                                                                  06707006
067080     EXEC SQL                                                     06708006
067090         SELECT CART_PRMPT_CDE                                    06709006
067100         INTO   :SUT00015-CART-PRMPT-CDE                          06710006
067110         FROM  SUT_PO_AUD_REQ                                     06711006
067120         WHERE  PO_NBR           =  :SUT00015-PO-NBR              06712006
067130          AND   RCVR_SEQ_NBR     =  :SUT00015-RCVR-SEQ-NBR        06713006
067140     END-EXEC                                                     06714006
067150                                                                  06715006
067160     EVALUATE TRUE                                                06716006
067170         WHEN SQLCODE = ZERO                                      06717006
067180              IF SUT00015-CART-PRMPT-CDE = 'C'                    06718006
067190                 SET PS-AUDIT-PROMPT-CHECK-YES TO TRUE            06719006
067200              ELSE                                                06720006
067210                 SET PS-AUDIT-PROMPT-CHECK-NO TO TRUE             06721006
067220              END-IF                                              06722006
067230         WHEN SQLCODE = +100                                      06723006
067240              SET PS-AUDIT-PROMPT-CHECK-YES TO TRUE               06724006
067250         WHEN SQLWARN0 NOT = SPACES                               06725006
067260         WHEN SQLCODE < ZERO                                      06726006
067270         WHEN SQLCODE > ZERO                                      06727006
067280             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            06728006
067290             MOVE DK-PO          TO  PV-DISPLAY-PO                06729006
067300             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           06730006
067310             MOVE '4460-CHECK-PO-AUD-REQ   '                      06731006
067320                             TO DP013-PARAGRAPH                   06732006
067330             MOVE 'SUKRF502 - CHECK FOR AUDIT REQ '               06733006
067340                             TO DP013-MESSAGE-TEXT(1)             06734006
067350             STRING '  CARTON - '        DELIMITED BY SIZE        06735006
067360                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        06736006
067370                    ' PO, RCVR   '       DELIMITED BY SIZE        06737006
067380                    PV-DISPLAY-PO        DELIMITED BY SIZE        06738006
067390                    ' '                  DELIMITED BY SIZE        06739006
067400                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        06740006
067410                    ' '                  DELIMITED BY SIZE        06741006
067420                             INTO DP013-MESSAGE-TEXT (2)          06742006
067430             MOVE SQLCA      TO DP013-SQLCA                       06743006
067440             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           06744006
067450             SET DP013-DB2-ABEND                                  06745006
067460                             TO TRUE                              06746006
067470             SET DP013-ROLLBACK                                   06747006
067480                             TO TRUE                              06748006
067490             SET DP013-XCTL-DISPLAY-RESTART                       06749006
067500                             TO TRUE                              06750006
067510             PERFORM DP014-0000-PROCESS-ABEND                     06751006
067520                                                                  06752006
067530     END-EVALUATE.                                                06753006
067540                                                                  06754006
067550/                                                                 06755006
067560 4500-CREATE-TROUBLE.                                             06756006
067570                                                                  06757006
067580     SET  TM500-ADD-DETAILS                                       06758006
067590          TM500-CREATE-AUTO        TO TRUE.                       06759006
067600                                                                  06760006
067610     EVALUATE TRUE                                                06761006
067620       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSA                          06762006
067630            MOVE PC-QTY-ERR-TRBL-CODE-350  TO TM500-TRBL-RSN-CDE  06763006
067640       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSB                          06764006
067650            MOVE PC-UPC-NOT-ON-PO-TRBL-351 TO TM500-TRBL-RSN-CDE  06765006
067660       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSC                          06766006
067670            MOVE PC-LNE-ZERO-TRBL-CODE-352 TO TM500-TRBL-RSN-CDE  06767006
067680       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSD                          06768006
067690            MOVE PC-UPC-CRTN-TRBL-CODE-353 TO TM500-TRBL-RSN-CDE  06769006
067700       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSE                          06770006
067710            MOVE PC-UPC-PKSL-TRBL-CODE-354 TO TM500-TRBL-RSN-CDE  06771006
067720     END-EVALUATE                                                 06772006
067730                                                                  06773006
067740                                                                  06774006
067750     MOVE SU001-PO                 TO TM500-PO-NBR.               06775006
067760     MOVE SU001-OPER-UNT-ID        TO TM500-OPER-UNT-ID.          06776006
067770     MOVE SU001-FCLTY-ID           TO TM500-FCLTY-ID.             06777006
067780     MOVE SU001-RCVR-SEQ-NBR       TO TM500-REC-SEQ-NBR.          06778006
067790     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            06779006
067800                                                                  06780006
067810                                                                  06781006
067820     EXEC CICS                                                    06782006
067830         LINK PROGRAM  (PC-TROUBLE-WTR)                           06783006
067840              COMMAREA (TM500-FIELDS)                             06784006
067850              LENGTH   (PC-TROUBLE-LENGTH)                        06785006
067860     END-EXEC.                                                    06786006
067870                                                                  06787006
067880                                                                  06788006
067890     EVALUATE TRUE                                                06789006
067900         WHEN TM500-CALL-SUCCESSFUL                               06790006
067910         WHEN TM500-DUPLICATE-TROUBLE                             06791006
067920              CONTINUE                                            06792006
067930         WHEN OTHER                                               06793006
067940             MOVE 'SUKRF502 - 4500-CREATE-TROUBLE'                06794006
067950                                      TO DP013-PARAGRAPH          06795006
067960             STRING TM500-RETURN-CODE    DELIMITED BY SIZE        06796006
067970                    ' / '                DELIMITED BY SIZE        06797006
067980                    TM500-RETURN-MSG     DELIMITED BY '  '        06798006
067990                    ' SQLCODE:'          DELIMITED BY SIZE        06799006
068000                    TM500-SQLCODE        DELIMITED BY SIZE        06800006
068010                                     INTO DP013-MESSAGE-TEXT (1)  06801006
068020             MOVE  TM500-SQLCA         TO DP013-MESSAGE-TEXT (2)  06802006
068030             MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON             06803006
068040             MOVE  SU001-PO      TO PV-DISPLAY-PO                 06804006
068050             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       06805006
068060             STRING '  CARTON - '        DELIMITED BY SIZE        06806006
068070                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        06807006
068080                    ' PO, RCVR   '       DELIMITED BY SIZE        06808006
068090                    PV-DISPLAY-PO        DELIMITED BY SIZE        06809006
068100                    ' '                  DELIMITED BY SIZE        06810006
068110                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        06811006
068120                    ' '                  DELIMITED BY SIZE        06812006
068130                             INTO DP013-MESSAGE-TEXT (3)          06813006
068140             SET DP013-OTHER-ABEND                                06814006
068150                 DP013-ROLLBACK    TO TRUE                        06815006
068160             PERFORM DP014-0000-PROCESS-ABEND                     06816006
068170     END-EVALUATE.                                                06817006
068180                                                                  06818006
068190******************************************************************06819006
068200**CHECK IF THE PBS ORDER IS RTV WHERE THERE ARE NO ALLOCATIONS   *06820006
068210**FOR A STORE OR THE ALLOCATIONS ARE 'DC' OR 'RV'                *06821006
068220**FORMAT A MESSAGE LABEL IN THESE CASES (PBS RTV OR NO ALLOC)    *06822006
068230******************************************************************06823006
068240 4510-PROCESS-CHECK-RTV.                                          06824006
068250     MOVE SPACE TO PS-PBS-RTV-ALLOC-SW.                           06825006
068260     PERFORM 4520-CHECK-PBS-STORE-ALLOC.                          06826006
068270     IF PV-DB2-ALLOC-COUNT >  0                                   06827006
068280        CONTINUE                                                  06828006
068290     ELSE                                                         06829006
068300        PERFORM 4530-CHECK-RTV-ALLOC                              06830006
068310        IF PV-DB2-RTV-COUNT >  0                                  06831006
068320           SET PS-PBS-RTV-ALLOC TO TRUE                           06832006
068330        ELSE                                                      06833006
068340           SET PS-PBS-RTV-NO-ALLOC TO TRUE                        06834006
068350        END-IF                                                    06835006
068360     END-IF.                                                      06836006
068370******************************************************************06837006
068380 4520-CHECK-PBS-STORE-ALLOC.                                      06838006
068390     MOVE SU001-STORE              TO RECDIS-STR-NBR.             06839006
068400     MOVE ZEROES                   TO PV-DB2-ALLOC-COUNT.         06840006
068410                                                                  06841006
068420     EXEC SQL                                                     06842006
068430         SELECT COUNT(*)                                          06843006
068440           INTO :PV-DB2-ALLOC-COUNT                               06844006
068450           FROM TRECDIS A                                         06845006
068460          WHERE A.ORD_NBR         =  :DK-PO                       06846006
068470            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              06847006
068480            AND A.STR_NBR         =  :RECDIS-STR-NBR              06848006
068490            AND A.VERIFY_ITM_QTY  >  0                            06849006
068500     END-EXEC                                                     06850006
068510                                                                  06851006
068520     EVALUATE TRUE                                                06852006
068530         WHEN SQLCODE = ZERO                                      06853006
068540         WHEN SQLCODE = +100                                      06854006
068550             CONTINUE                                             06855006
068560         WHEN SQLWARN0 NOT = SPACES                               06856006
068570         WHEN SQLCODE < ZERO                                      06857006
068580         WHEN SQLCODE > ZERO                                      06858006
068590             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            06859006
068600             MOVE DK-PO          TO  PV-DISPLAY-PO                06860006
068610             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           06861006
068620             MOVE '4520-CHECK-PBS-STORE-ALLOC'                    06862006
068630                             TO DP013-PARAGRAPH                   06863006
068640             MOVE 'SUKRF502 - CHECK PBS ALLOCATION'               06864006
068650                             TO DP013-MESSAGE-TEXT(1)             06865006
068660             STRING '  CARTON - '        DELIMITED BY SIZE        06866006
068670                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        06867006
068680                    ' PO, RCVR   '       DELIMITED BY SIZE        06868006
068690                    PV-DISPLAY-PO        DELIMITED BY SIZE        06869006
068700                    ' '                  DELIMITED BY SIZE        06870006
068710                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        06871006
068720                    ' '                  DELIMITED BY SIZE        06872006
068730                             INTO DP013-MESSAGE-TEXT (2)          06873006
068740             MOVE SQLCA      TO DP013-SQLCA                       06874006
068750             MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME(1)           06875006
068760             SET DP013-DB2-ABEND                                  06876006
068770                             TO TRUE                              06877006
068780             SET DP013-ROLLBACK                                   06878006
068790                             TO TRUE                              06879006
068800             SET DP013-XCTL-DISPLAY-RESTART                       06880006
068810                             TO TRUE                              06881006
068820             PERFORM DP014-0000-PROCESS-ABEND                     06882006
068830                                                                  06883006
068840     END-EVALUATE.                                                06884006
068850                                                                  06885006
068860******************************************************************06886006
068870 4530-CHECK-RTV-ALLOC.                                            06887006
068880     MOVE ZEROES                   TO PV-DB2-RTV-COUNT.           06888006
068890                                                                  06889006
068900     EXEC SQL                                                     06890006
068910         SELECT COUNT(*)                                          06891006
068920           INTO :PV-DB2-RTV-COUNT                                 06892006
068930           FROM TRECDIS A                                         06893006
068940              , XLT_LOC B                                         06894006
068950          WHERE A.ORD_NBR         =  :DK-PO                       06895006
068960            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              06896006
068970            AND A.STR_NBR         =  B.LOC_NBR                    06897006
068980            AND B.LOC_TYP_CDE     IN  ('DC' , 'RV')               06898006
068990            AND A.VERIFY_ITM_QTY  >  0                            06899006
069000     END-EXEC                                                     06900006
069010                                                                  06901006
069020     EVALUATE TRUE                                                06902006
069030         WHEN SQLCODE = ZERO                                      06903006
069040             CONTINUE                                             06904006
069050         WHEN SQLWARN0 NOT = SPACES                               06905006
069060         WHEN SQLCODE < ZERO                                      06906006
069070         WHEN SQLCODE > ZERO                                      06907006
069080             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            06908006
069090             MOVE DK-PO          TO  PV-DISPLAY-PO                06909006
069100             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           06910006
069110             MOVE '4530-CHECK-RTV-ALLOC    '                      06911006
069120                             TO DP013-PARAGRAPH                   06912006
069130             MOVE 'SUKRF502 - CHECK RTV ALLOCATION'               06913006
069140                             TO DP013-MESSAGE-TEXT(1)             06914006
069150             STRING '  CARTON - '        DELIMITED BY SIZE        06915006
069160                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        06916006
069170                    ' PO, RCVR   '       DELIMITED BY SIZE        06917006
069180                    PV-DISPLAY-PO        DELIMITED BY SIZE        06918006
069190                    ' '                  DELIMITED BY SIZE        06919006
069200                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        06920006
069210                    ' '                  DELIMITED BY SIZE        06921006
069220                             INTO DP013-MESSAGE-TEXT (2)          06922006
069230             MOVE SQLCA      TO DP013-SQLCA                       06923006
069240             MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME(1)           06924006
069250             SET DP013-DB2-ABEND                                  06925006
069260                             TO TRUE                              06926006
069270             SET DP013-ROLLBACK                                   06927006
069280                             TO TRUE                              06928006
069290             SET DP013-XCTL-DISPLAY-RESTART                       06929006
069300                             TO TRUE                              06930006
069310             PERFORM DP014-0000-PROCESS-ABEND                     06931006
069320                                                                  06932006
069330     END-EVALUATE.                                                06933006
069340                                                                  06934006
069350******************************************************************06935006
069360 5000-PRINT-LABEL.                                                06936006
069370******************************************************************06937006
069380* CT 11/06/08 BEGIN                                               06938006
069390                                                                  06939006
069400         IF PV-TEST-CICS OR PV-QA-CICS                            06940006
069410            MOVE SPACE TO PV-CICS-MSG-AREA-A                      06941006
069420            STRING ' SUKRF502: 5000-print-label'                  06942006
069430            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             06943006
069440            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     06944006
069450                                           TO PV-COMMAREA-LENGTH  06945006
069460            EXEC CICS WRITEQ TD                                   06946006
069470                      QUEUE('CSSL')                               06947006
069480                      FROM(PV-CICS-MSG-AREA-A)                    06948006
069490                      LENGTH(PV-COMMAREA-LENGTH)                  06949006
069500                      RESP (PV-CICS-RESPONSE)                     06950006
069510            END-EXEC                                              06951006
069520          END-IF.                                                 06952006
069530                                                                  06953006
069540*    SELECT FUNC_TXT HAS DIRECTIVE MODE DATA                      06954006
069550     PERFORM 5003-SELECT-FUNC-TXT.                                06955006
069560                                                                  06956006
069570* CT 11/06/08 END                                                 06957006
069580                                                                  06958006
069600                                                                  06960006
069610*****FILL BAR CODE FOR SHIPPING LABEL - PACK BY STORE             06961006
069620     IF SU001-PACK-BY-STORE                                       06962006
069630** SU001-DUPLICATE-IND (TRUE DUPLICATE FLAG)                      06963006
069640       IF SU001-DUPLICATE-IND  = 'Y'                              06964006
069650          SET PS-XREF-PBS-NOT-FOUND TO TRUE                       06965006
069660       ELSE                                                       06966006
069670          PERFORM 3696-CHECK-SULBXF-FOR-PBS                       06967006
069680       END-IF                                                     06968006
069690        IF PS-XREF-PBS-FOUND                                      06969006
069700           MOVE SULBXF-BRCDE-NBR TO PC160-BTCH-BARCODE            06970006
069710           MOVE PC160-BTCH-SML-BC-MNFST-NBR TO                    06971006
069720                                    PV-LBL-MANIFEST-NBR           06972006
069730           MOVE PC160-BTCH-SML-BC-DIVERT-PFX  TO                  06973006
069740                                    PV-STORE-NBR-PFX-HOLD         06974006
069750        ELSE                                                      06975006
069760           MOVE SU001-STORE           TO PC187-STR-NBR            06976006
069770           MOVE  +1                   TO PC187-NO-OF-LBLS         06977006
069780           PERFORM 7250-LINK-PCKCS721                             06978006
069790           MOVE PC187-START-MFST-NBR TO PV-LBL-MANIFEST-NBR       06979006
069800        END-IF                                                    06980006
069810        MOVE PV-LBL-MANIFEST-NBR TO SU001-LBL-MANIFEST-NBR        06981006
069820        MOVE 'K'                 TO DK-CART-LBL-TYP-CDE           06982006
069830        PERFORM 7210-GET-STORE-INFO                               06983006
069840        MOVE SU001-OPER-UNT-ID TO DK-OPER-UNT-ID                  06984006
069850        PERFORM 7215-GET-ECOMM-DC-INFO                            06985006
069860        PERFORM 1100-GET-ZONE-DESC                                06986006
069870        PERFORM 5060-CALL-SEA-SET-MODULE                          06987006
069880                                                                  06988006
069890                                                                  06989006
069900        PERFORM 7400-GET-DEPT-NAME                                06990006
069910        PERFORM 7235-GET-OUTER-PACK                               06991006
069920        MOVE ZEROES             TO PC160-BTCH-SML-CONTAINER-CDE   06992006
069930                                   PC160-PORT-SML-TXT-CONTANR-CDE 06993006
069940        SET  PC160-BTCH-SML-INTERNAL-LBL                          06994006
069950             PC160-BTCH-SML-FROM-KOHLS                            06995006
069960             PC160-PORT-SML-TXT-INTERNL-LBL                       06996006
069970             PC160-PORT-SML-TXT-FROM-KOHLS   TO TRUE              06997006
069980        MOVE SU001-STORE           TO PV-STORE-9-4                06998006
069990                                      DK-DEST-OPER-UNT-ID         06999006
070000        MOVE PV-STORE-X-4          TO PV-STORE-NBR-4              07000006
070010        MOVE PV-STORE-NBR          TO PC160-BTCH-SML-BC-DIVERT    07001006
070020                                      PC160-PORT-SML-TXT-DIVERT   07002006
070030        MOVE SU001-CURR-OPER-UNT-ID                               07003006
070040                                   TO PC160-BTCH-SML-BC-DC-ORIGIN 07004006
070050                                      PC160-PORT-SML-TXT-DC-ORIGIN07005006
070060                                      PV-BAR-CODE-OPER-UNIT       07006006
070070        MOVE SU001-LBL-MANIFEST-NBR TO                            07007006
070080                                      PC160-BTCH-SML-BC-MNFST-NBR 07008006
070090                                      PC160-PORT-SML-TXT-MNFST-NBR07009006
070100                                      PV-BAR-CODE-LBL-MANIFEST    07010006
070110                                                                  07011006
070120        MOVE PC160-BTCH-BARCODE    TO DK-BARCODE-NBR              07012006
070170        PERFORM 6400-DETERMINE-HANG-FOLD                          07017006
070180        PERFORM 7234-GET-CURRENT-DOOR                             07018006
070190*       MOVE PV-HANG-FOLD-IND TO LBPTDA-HNG-FOLD-SEQ-NBR          07019006
070200*       MOVE PS-EAS-TAG-IND-FOUND-SW                              07020006
070210*                                 TO LBPTDA-EAS-TAG-IND           07021006
070220*       MOVE CNDCDR-DOOR-ID       TO LBPTDA-DOOR-ID               07022006
070230*       IF PS-BRAND-FOUND-YES                                     07023006
070240*          MOVE 35 TO LBPTDA-MDSE-PGM-DESC-LEN                    07024006
070250*          MOVE XLT00040-MDSE-PGM-DESC                            07025006
070260*                            TO LBPTDA-MDSE-PGM-DESC-TEXT         07026006
070270*       END-IF                                                    07027006
070280                                                                  07028006
070290        IF PS-NOT-REPRINT-DUP                                     07029006
070300           PERFORM 3570-POPULATE-CRTN-LBL-XREF                    07030006
070310        ELSE                                                      07031006
070320           IF PS-XREF-PBS-FOUND                                   07032006
070330**THE CARTON HAS BEEN PREVIOUSLY BEEN SCANNED, BUT THE DIVERT PREF07033006
070340**HAS BEEN CHANGED                                                07034006
070350**GB 3/8/02 BEG                                                   07035006
070360              IF PV-STORE-NBR-PFX-HOLD = PV-STORE-NBR-PFX         07036006
070370                 CONTINUE                                         07037006
070380              ELSE                                                07038006
070390                 PERFORM 3580-INACTIVATE-XREF                     07039006
070400                 PERFORM 3581-INACTIVATE-OTBND-CART               07040006
070410                 PERFORM 3570-POPULATE-CRTN-LBL-XREF              07041006
070420**GB 3/8/02 END                                                   07042006
070430           ELSE                                                   07043006
070440              PERFORM 3570-POPULATE-CRTN-LBL-XREF                 07044006
070450           END-IF                                                 07045006
070460        END-IF                                                    07046006
070470     ELSE                                                         07047006
070640        MOVE LBVRDA-BRCDE-NBR      TO PC160-DEST-BARCODE-TEXT     07064006
070650                                      PC160-BTCH-BARCODE          07065006
070660     END-IF.                                                      07066006
070670                                                                  07067006
070680     SET SU001-NO-P2L-LBL-CREATED TO TRUE.                        07068006
070690                                                                  07069006
070700                                                                  07070006
070710     IF PV-TEST-CICS OR PV-QA-CICS                                07071006
070720         MOVE SPACE TO PV-CICS-MSG-AREA-A                         07072006
070730         STRING ' SUKRF502: BEFORE BATCH PRINTER CHECK '          07073006
070740         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A                07074006
070750         MOVE LENGTH OF PV-CICS-MSG-AREA-A                        07075006
070760                                    TO PV-COMMAREA-LENGTH         07076006
070770            EXEC CICS WRITEQ TD                                   07077006
070780                   QUEUE('CSSL')                                  07078006
070790                   FROM(PV-CICS-MSG-AREA-A)                       07079006
070800                   LENGTH(PV-COMMAREA-LENGTH)                     07080006
070810                  RESP (PV-CICS-RESPONSE)                         07081006
070820           END-EXEC                                               07082006
070830     END-IF.                                                      07083006
070840                                                                  07084006
070850     IF SU001-BATCH-PRINTER OR SU001-PRINT-AND-PEEL               07085006
070860         SET SU021-AUDIT-IS-COMPLETE                              07086006
070870*CLP 10/24/13 - BEGIN                                             07087006
070880             SU021-RFID-AUDIT-IS-COMPLETE                         07088006
070890*CLP 10/24/13 - END                                               07089006
070900             PS-OPER-NOT-ECOMM-DC    TO TRUE                      07090006
070910         MOVE SU001-OPER-UNT-ID TO DK-OPER-UNT-ID                 07091006
070920         PERFORM 7215-GET-ECOMM-DC-INFO                           07092006
070930                                                                  07093006
070940         IF PV-TEST-CICS OR PV-QA-CICS                            07094006
070950            MOVE SPACE TO PV-CICS-MSG-AREA-A                      07095006
070960            STRING ' SUKRF502: 5000-'                             07096006
070970             ' DC SW= '                                           07097006
070980               PS-OPER-IS-ECOMM-DC-SW                             07098006
070990             ' MIS= '                                             07099006
071000               SU001-MISDIRECT-IND                                07100006
071010            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             07101006
071020            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     07102006
071030                                           TO PV-COMMAREA-LENGTH  07103006
071040            EXEC CICS WRITEQ TD                                   07104006
071050                      QUEUE('CSSL')                               07105006
071060                      FROM(PV-CICS-MSG-AREA-A)                    07106006
071070                      LENGTH(PV-COMMAREA-LENGTH)                  07107006
071080                      RESP (PV-CICS-RESPONSE)                     07108006
071090            END-EXEC                                              07109006
071100         END-IF                                                   07110006
071110                                                                  07111006
071120         IF PS-OPER-NOT-ECOMM-DC                                  07112006
071130            IF SU001-MISDIRECT                                    07113006
071140               OR PS-ODD-UNT-CRTN-FOUND                           07114006
071150               OR SU001-NOT-CRTN-ATT-TO-RCVR                      07115006
071160               OR PS-MISDIRECT-PACK-BY-STORE                      07116006
071170               OR LBVRDA-INPK-CNVYB-IND = 'Y'                     07117006
071180*12/18/14                                                         07118006
071190               IF PV-TEST-CICS OR PV-QA-CICS                      07119006
071200                  MOVE SPACE TO PV-CICS-MSG-AREA-A                07120006
071210                  STRING ' SUKRF502: did not go to 7000-'         07121006
071220                  DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A       07122006
071230                  MOVE LENGTH OF PV-CICS-MSG-AREA-A               07123006
071240                                           TO PV-COMMAREA-LENGTH  07124006
071250                  EXEC CICS WRITEQ TD                             07125006
071260                       QUEUE('CSSL')                              07126006
071270                       FROM(PV-CICS-MSG-AREA-A)                   07127006
071280                       LENGTH(PV-COMMAREA-LENGTH)                 07128006
071290                       RESP (PV-CICS-RESPONSE)                    07129006
071300                  END-EXEC                                        07130006
071310*****             CONTINUE                                        07131006
071320               END-IF                                             07132006
071330            ELSE                                                  07133006
071340               PERFORM 7000-AUDIT-CHECK-PROCESSING                07134006
071350            END-IF                                                07135006
071360         END-IF                                                   07136006
071370                                                                  07137006
071380         IF SU001-PACK-BY-STORE                                   07138006
071390             MOVE 'N' TO LBVRDA-INPK-CNVYB-IND                    07139006
071400             PERFORM 7200-GATHER-LABEL-INFO                       07140006
071410         ELSE                                                     07141006
071420             PERFORM 7500-POPULATE-TLBPTDA-BULK                   07142006
071430         END-IF                                                   07143006
071440**GB 4/21/02 BYPASS THE CALLED MODULES WHEN CREATING AN AUDIT     07144006
071450**LABEL AS THE INDICATORS DON'T APPEAR ON THE AUDIT LABEL         07145006
071460***      - 6010- IS PERFORMED AFTER THIS (BUT MAY BE DONE PRIOR)  07146006
071470***      - NO BUSINESS AREA ON THE QC OR COMBINED TLBPTDA ROW     07147006
071480***      - ITS ON THE RFID ONLY ROW                               07148006
071490                                                                  07149006
071500         IF  SU021-AUDIT-REQUIRED OR                              07150006
071510*CLP 10/24/13 BEGIN                                               07151006
071520             SU021-RFID-AUDIT-REQUIRED                            07152006
071530*CLP 10/24/13 END                                                 07153006
071540             MOVE ZEROES  TO  PV-HNG-FOLD-SEQ-NBR                 07154006
071550                              PV-BUS-AREA-ID                      07155006
071560         ELSE                                                     07156006
071570                                                                  07157006
071580             IF PV-DEPT-NUMBER > SPACES                           07158006
071590                PERFORM 6700-LINK-XLKUT073                        07159006
071600             ELSE                                                 07160006
071610                MOVE ZEROES TO PV-BUS-AREA-ID                     07161006
071620             END-IF                                               07162006
071630         END-IF                                                   07163006
071640                                                                  07164006
071650         INITIALIZE SU093-ITEM-COMMAREA                           07165006
071660* CLP 04/23/13 PR5148B START                                      07166006
071670         SET SU093-RFID-NO TO TRUE                                07167006
071680         PERFORM 6010-CALL-RFID-DETERMINATION                     07168006
071690                                                                  07169006
071700         IF PV-TEST-CICS OR PV-QA-CICS                            07170006
071710            MOVE SPACE TO PV-CICS-MSG-AREA-A                      07171006
071720            STRING ' SUKRF502: 5000-'                             07172006
071730             ' AUTO SW=   '                                       07173006
071740               PS-AUTO-CONVEY-LVL-SW                              07174006
071750             ' ERROR SW= '                                        07175006
071760               PS-PROCESSING-ERROR-SW                             07176006
071770             ' CNVYB IND= '                                       07177006
071780               LBVRDA-INPK-CNVYB-IND                              07178006
071790             ' LBL REPR IND= '                                    07179006
071800               SU001-LBL-REPRINT-IND                              07180006
071810            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             07181006
071820            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     07182006
071830                                           TO PV-COMMAREA-LENGTH  07183006
071840            EXEC CICS WRITEQ TD                                   07184006
071850                      QUEUE('CSSL')                               07185006
071860                      FROM(PV-CICS-MSG-AREA-A)                    07186006
071870                      LENGTH(PV-COMMAREA-LENGTH)                  07187006
071880                      RESP (PV-CICS-RESPONSE)                     07188006
071890            END-EXEC                                              07189006
071900*                                                                 07190006
071910            MOVE SPACE TO PV-CICS-MSG-AREA-A                      07191006
071920            MOVE SU001-PO TO PV-PO-XNUM                           07192006
071930            MOVE SU001-RCVR-SEQ-NBR TO PV-PO-RCVR-SEQ-NO          07193006
071940            STRING ' SUKRF502: XXX '                              07194006
071950             ' PO# = '                                            07195006
071960               PV-PO-XNUM                                         07196006
071970             ' RCVR# = '                                          07197006
071980               PV-PO-RCVR-SEQ-NO                                  07198006
071990             ' RFID-SW = '                                        07199006
072000               PS-RFID-ON-LABEL-SW                                07200006
072010             ' SML CREATE-SW= '                                   07201006
072020               PS-SML-CREATION-SW                                 07202006
072030            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             07203006
072040            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     07204006
072050                                           TO PV-COMMAREA-LENGTH  07205006
072060            EXEC CICS WRITEQ TD                                   07206006
072070                      QUEUE('CSSL')                               07207006
072080                      FROM(PV-CICS-MSG-AREA-A)                    07208006
072090                      LENGTH(PV-COMMAREA-LENGTH)                  07209006
072100                      RESP (PV-CICS-RESPONSE)                     07210006
072110            END-EXEC                                              07211006
072120*                                                                 07212006
072130         END-IF                                                   07213006
072140* CLP 04/23/13 PR5148B END                                        07214006
072150                                                                  07215006
072160         EVALUATE TRUE                                            07216006
072170*** DMH 1/28/13 - BEGIN                                           07217006
072180             WHEN LBVRDA-INPK-CNVYB-IND = 'Y'                     07218006
072190                CONTINUE                                          07219006
072200*** DMH 1/28/13 END                                               07220006
072210             WHEN PS-AUTO-CONVEY-NO-CRTNS                         07221006
072220* CLP 04/23/13 PR5148B START                                      07222006
072230                 IF PS-RFID-ON-LABEL-SW = 'Y'                     07223006
072240                    IF SU001-LBL-REPRINT                          07224006
072250                       CONTINUE                                   07225006
072260                    ELSE                                          07226006
072270                       IF PS-PROCESSING-ERROR-NO AND              07227006
072280                          PS-CARTON-SML-CREATED                   07228006
072290                          PERFORM 6800-INSERT-PROCESS-MSG         07229006
072300                       END-IF                                     07230006
072310                    END-IF                                        07231006
072320                END-IF                                            07232006
072330* CLP 04/23/13 PR5148B END                                        07233006
072340                CONTINUE                                          07234006
072350             WHEN PS-AUTO-CONVEY-ALL-CRTNS                        07235006
072360                PERFORM 6000-FORMAT-DIRECTIVE-CALL                07236006
072370             WHEN PS-AUTO-CONVEY-EXCPT-CRTNS                      07237006
072380                IF SU001-LBL-REPRINT                              07238006
072390                    CONTINUE                                      07239006
072400                ELSE                                              07240006
072410                   IF PS-PROCESSING-ERROR-NO                      07241006
072420                       PERFORM 6000-FORMAT-DIRECTIVE-CALL         07242006
072430                   END-IF                                         07243006
072440                END-IF                                            07244006
072450* CLP 04/23/13 PR5148B START                                      07245006
072460         END-EVALUATE                                             07246006
072470         IF PV-TEST-CICS OR PV-QA-CICS                            07247006
072480            MOVE SPACE TO PV-CICS-MSG-AREA-A                      07248006
072490            STRING ' SUKRF502: abcd '                             07249006
072500            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             07250006
072510            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     07251006
072520                                           TO PV-COMMAREA-LENGTH  07252006
072530            EXEC CICS WRITEQ TD                                   07253006
072540                      QUEUE('CSSL')                               07254006
072550                      FROM(PV-CICS-MSG-AREA-A)                    07255006
072560                      LENGTH(PV-COMMAREA-LENGTH)                  07256006
072570                      RESP (PV-CICS-RESPONSE)                     07257006
072580            END-EXEC                                              07258006
072590*                                                                 07259006
072600*                                                                 07260006
072610         END-IF                                                   07261006
072620                                                                  07262006
072630         PERFORM 7205-INSERT-LABEL-TABLE                          07263006
072640                                                                  07264006
072650         IF SU001-ASGMT-STRT-DTE  > SPACES                        07265006
072660            AND (PS-CARTON-SML-CREATED OR PS-CARTON-P2L-CREATED)  07266006
072670            PERFORM 5700-CALL-XLKUP033-EAI                        07267006
072680         END-IF                                                   07268006
072690*CLP 10/24/13 - START                                             07269006
072700         IF (SU021-AUDIT-REQUIRED OR SU021-RFID-AUDIT-REQUIRED)   07270006
072710         AND SU001-PROMPT-IND = 'Y'                               07271006
072720*CLP 10/24/13 - END                                               07272006
072730             IF LBVRDA-INPK-CNVYB-IND = 'Y'                       07273006
072740                 SET PS-INPK-AUD-INLINE-YES TO TRUE               07274006
072750             ELSE                                                 07275006
072760               MOVE SU001-ASGMT-STRT-DTE TO SU006-ASGMT-STRT-DTE  07276006
072770               MOVE SU001-ASGMT-NBR-TXT  TO SU006-ASGMT-NBR-TXT   07277006
072780               MOVE SU001-ASGMT-NBR-SEQ-NBR TO                    07278006
072790                                        SU006-ASGMT-NBR-SEQ-NBR   07279006
072800               MOVE PC-SU-AUDIT-DEF-PRMPT-PGM                     07280006
072810                                          TO PV-TRANSFER-PROGRAM  07281006
072820               MOVE PC-N TO SU001-DUPLICATE-IND                   07282006
072830               MOVE PC-Y TO SU001-LABEL-IND                       07283006
072840                                                                  07284006
072850               MOVE SU001-COMMON-DATA  TO SU006-HOST-SAVE-AREA    07285006
072860               PERFORM 4100-XCTL-CRTN-AUDIT                       07286006
072870             END-IF                                               07287006
072880         END-IF                                                   07288006
072890                                                                  07289006
072900         IF ((SU001-ROWS-INSERTED >=                              07290006
072910            SU001-PRT-LBL-ON-SCN-CNT)                             07291006
072920            AND LBVRDA-INPK-CNVYB-IND = 'N')                      07292006
072930                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   07293006
072940                 MOVE  SU001-PRINTER-ID  TO SU001-PRINTER-ID-USE  07294006
072950                 PERFORM 7300-START-LABEL-PRINT                   07295006
072960                 PERFORM 2400-GET-BATCH-NUMBER                    07296006
072970                 ADD  1  TO  PV-MAX-USER-BATCH                    07297006
072980                     GIVING  SU001-BATCH-NUMBER                   07298006
072990                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   07299006
073000                 MOVE  ZEROES             TO SU001-ROWS-INSERTED  07300006
073010         END-IF                                                   07301006
073020******************************************************************07302006
073030*** MODULE TO SEE IF LAST CARTON SCANNED AND CONF/VERIF CAN       07303006
073040*** BE STARTED                                                    07304006
073050******************************************************************07305006
073060         IF SU001-AUTO-VE-YES                                     07306006
073070            IF LBPTDA-CART-LBL-TYP-CDE = 'P'                      07307006
073080               CONTINUE                                           07308006
073090            ELSE                                                  07309006
073100               PERFORM 7350-START-VERIF-TRIGGER                   07310006
073110            END-IF                                                07311006
073120         END-IF                                                   07312006
073130                                                                  07313006
073140     ELSE                                                         07314006
073150        IF PS-NOT-REPRINT-DUP                                     07315006
073160          EVALUATE TRUE                                           07316006
073170               WHEN PS-PRINT-AUDIT-LABEL                          07317006
073180               WHEN LBVRDA-CART-LBL-TYP-CDE  = 'C'                07318006
073190               WHEN LBVRDA-CART-LBL-TYP-CDE  = 'E'                07319006
073200               WHEN SU001-NOT-CRTN-ATT-TO-TRIP                    07320006
073210               WHEN SU001-NOT-CRTN-ATT-TO-RCVR                    07321006
073220               WHEN SU001-WRONG-FCLTY                             07322006
073230                  PERFORM 5005-PRINT-MESSAGE-LABELS               07323006
073240               WHEN OTHER                                         07324006
073250                  CONTINUE                                        07325006
073270          END-EVALUATE                                            07327006
073280        ELSE                                                      07328006
073290           IF LBVRDA-CART-LBL-TYP-CDE  =  'C' OR                  07329006
073300              LBVRDA-CART-LBL-TYP-CDE  =  'E'                     07330006
073310                PERFORM 5005-PRINT-MESSAGE-LABELS                 07331006
073340           END-IF                                                 07334006
073350        END-IF                                                    07335006
073360     END-IF.                                                      07336006
073370                                                                  07337006
073380* CT 11/06/08 BEGIN                                               07338006
073390******************************************************************07339006
073400* DETERMINE WHAT LEVEL THE DC IS TURNED ON FOR DUAL FEED P&A     *07340006
073410******************************************************************07341006
073420 5003-SELECT-FUNC-TXT.                                            07342006
073430                                                                  07343006
073440     MOVE SU001-OPER-UNT-ID TO DK-OPER-UNT-ID.                    07344006
073450                                                                  07345006
073460     EXEC SQL                                                     07346006
073470        SELECT                                                    07347006
073480            FUNC_TXT                                              07348006
073490        INTO                                                      07349006
073500            :KRPRPM-FUNC-TXT                                      07350006
073510        FROM                                                      07351006
073520            TKRPRPM                                               07352006
073530        WHERE SYS_PRC_FUNC_CDE = 'AUTOCY'                         07353006
073540          AND LOC_ID            = :DK-OPER-UNT-ID                 07354006
073550          AND CURRENT TIMESTAMP > FUNC_BEG_TMST                   07355006
073560     END-EXEC.                                                    07356006
073570                                                                  07357006
073580     MOVE KRPRPM-FUNC-TXT TO PS-AUTO-CONVEY-LVL-SW.               07358006
073590                                                                  07359006
073600                                                                  07360006
073610     EVALUATE TRUE                                                07361006
073620         WHEN SQLCODE = ZERO                                      07362006
073630             CONTINUE                                             07363006
073640         WHEN SQLCODE = +100                                      07364006
073650             MOVE 'NNE' TO PS-AUTO-CONVEY-LVL-SW                  07365006
073660         WHEN SQLWARN0 NOT = SPACES                               07366006
073670         WHEN SQLCODE NOT EQUAL ZERO                              07367006
073680             MOVE '5003-SELECT-FUNC-TXT'                          07368006
073690                             TO DP013-PARAGRAPH                   07369006
073700             MOVE 'SUKRF502 - CHECK OPER-UNT-ID FOR CURR TS'      07370006
073710                             TO DP013-MESSAGE-TEXT(1)             07371006
073720             MOVE DK-OPER-UNT-ID                                  07372006
073730                             TO DP013-MESSAGE-TEXT(2)             07373006
073740             MOVE SQLCA      TO DP013-SQLCA                       07374006
073750             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           07375006
073760             SET DP013-DB2-ABEND            TO TRUE               07376006
073770             SET DP013-ROLLBACK             TO TRUE               07377006
073780             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               07378006
073790             PERFORM DP014-0000-PROCESS-ABEND                     07379006
073800     END-EVALUATE.                                                07380006
073810                                                                  07381006
073820* CAN TAKE OUT PARA -                                             07382006
073830* 09/23/13 SB BEG                                                 07383006
073840******************************************************************07384006
073850* CHECK FOR IMPORT REPLEN CARTONS                                *07385006
073860******************************************************************07386006
073870*5004-SELECT-FUNC-TXT.                                            07387006
073880                                                                  07388006
073890*    INITIALIZE DCLTKRPRPM                                        07389006
073900*               PV-20-DIGIT-BARCODE.                              07390006
073910*    SET  PV-RFID-REPLEN-NO      TO TRUE.                         07391006
073920*    MOVE PV-CTN-N               TO PV-20-DIGIT-BARCODE.          07392006
073930*    MOVE PV-20-SML-BC-DC-ORIGIN TO KRPRPM-LOC-ID.                07393006
073940*                                                                 07394006
073950*    EXEC SQL                                                     07395006
073960*       SELECT                                                    07396006
073970*           FUNC_TXT                                              07397006
073980*       INTO                                                      07398006
073990*           :PV-RFID-REPLEN-CHK-SW                                07399006
074000*       FROM                                                      07400006
074010*           TKRPRPM                                               07401006
074020*       WHERE SYS_PRC_FUNC_CDE = 'CIIRRT'                         07402006
074030*         AND LOC_ID            = :KRPRPM-LOC-ID                  07403006
074040*         AND CURRENT TIMESTAMP > FUNC_BEG_TMST                   07404006
074050*    END-EXEC.                                                    07405006
074060                                                                  07406006
074070*    EVALUATE TRUE                                                07407006
074080*        WHEN SQLCODE = ZERO                                      07408006
074090*        WHEN SQLCODE = +100                                      07409006
074100*            CONTINUE                                             07410006
074110*        WHEN SQLWARN0 NOT = SPACES                               07411006
074120*        WHEN SQLCODE NOT EQUAL ZERO                              07412006
074130*            MOVE '5004-SELECT-FUNC-TXT'                          07413006
074140*                            TO DP013-PARAGRAPH                   07414006
074150*            MOVE 'SUKRF502 - CHECK OPER-UNT-ID FOR CURR TS'      07415006
074160*                            TO DP013-MESSAGE-TEXT(1)             07416006
074170*            MOVE DK-OPER-UNT-ID                                  07417006
074180*                            TO DP013-MESSAGE-TEXT(2)             07418006
074190*            MOVE SQLCA      TO DP013-SQLCA                       07419006
074200*            MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           07420006
074210*            SET DP013-DB2-ABEND            TO TRUE               07421006
074220*            SET DP013-ROLLBACK             TO TRUE               07422006
074230*            SET DP013-XCTL-DISPLAY-RESTART TO TRUE               07423006
074240*            PERFORM DP014-0000-PROCESS-ABEND                     07424006
074250*    END-EVALUATE.                                                07425006
074260* 09/23/13 SB END                                                 07426006
074270                                                                  07427006
074280******************************************************************07428006
074290* CT 11/04/08 END                                                 07429006
074300                                                                  07430006
074310******************************************************************07431006
074320 5005-PRINT-MESSAGE-LABELS.                                       07432006
074330******************************************************************07433006
074340**                                                                07434006
074350     IF SU001-BATCH-PRINTER OR SU001-PRINT-AND-PEEL               07435006
074360         SET SU021-AUDIT-IS-COMPLETE TO TRUE                      07436006
074370*CLP 10/24/13 -START                                              07437006
074380         SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE                 07438006
074390*CLP 10/24/13 -END                                                07439006
074400         MOVE  3  TO PV-HNG-FOLD-SEQ-NBR                          07440006
074410         MOVE  0  TO PV-BUS-AREA-ID                               07441006
074420**WILL NOT CALL HANG FOLD MODULE AS INDICATOR DOES NOT APPEAR ON  07442006
074430**THE MESSAGE LABEL, HOWEVER, A VALUE IS REQUIRED FOR INSERT TO   07443006
074440**TLBPTDA FIELD GB 2/1/02                                         07444006
074450*******  PERFORM 6400-DETERMINE-HANG-FOLD                         07445006
074460**GB 8/15/04                                                      07446006
074470         IF SU001-ECOMM-DC-REPURPOSE                              07447006
074480            PERFORM 6560-DETERMINE-WEIGHTS-MSRS                   07448006
074490         END-IF                                                   07449006
074500                                                                  07450006
074510         EVALUATE TRUE                                            07451006
074520             WHEN SU001-MULTI-LINE                                07452006
074530                MOVE PC-MULTI-LINE           TO PV-PO-LINE-OUT    07453006
074540                MOVE  '*MULTIPLE LINES*'     TO  PV-VEND-STYL-NAME07454006
074550             WHEN  SU001-NO-LINE                                  07455006
074560                MOVE PC-NOLNE-LINE           TO PV-PO-LINE-OUT    07456006
074570                MOVE  '** NO LINE NUMBER **' TO  PV-VEND-STYL-NAME07457006
074580             WHEN  OTHER                                          07458006
074590                 CONTINUE                                         07459006
074600         END-EVALUATE                                             07460006
074610         MOVE 'N' TO LBVRDA-INPK-CNVYB-IND                        07461006
074620         IF PS-CARTON-EXISTS                                      07462006
074630            PERFORM 7235-GET-OUTER-PACK                           07463006
074640            PERFORM 7230-GET-DEPT-CL-SKU                          07464006
074650            PERFORM 7400-GET-DEPT-NAME                            07465006
074660         END-IF                                                   07466006
074670         SET PS-EAS-TAG-IND-FOUND-NO TO TRUE                      07467006
074680         IF PV-OTBND-CART-YES = 'Y'                               07468006
074690*CLP 04/14/14 - START                                             07469006
074700            PERFORM 5003-SELECT-FUNC-TXT                          07470006
074710*CLP 04/14/14 - END                                               07471006
074720            PERFORM 6000A-FORMAT-DIR-CALL-IR                      07472006
074730         END-IF                                                   07473006
074740         PERFORM 7200-GATHER-LABEL-INFO                           07474006
074750         PERFORM 7205-INSERT-LABEL-TABLE                          07475006
074760                                                                  07476006
074770         IF PS-NOT-REPRINT-DUP                                    07477006
074780            IF PS-UCC128-PKSLIP-ERROR-NO AND                      07478006
074790               PS-PBS-CRTN-RCVR-MISMTCH-NO AND                    07479006
074800               PS-CARTON-EXISTS                                   07480006
074810               IF SU001-ASGMT-STRT-DTE  > SPACES                  07481006
074820                  PERFORM 5700-CALL-XLKUP033-EAI                  07482006
074830               END-IF                                             07483006
074840            END-IF                                                07484006
074850         END-IF                                                   07485006
074860*****************************************************             07486006
074870** GB 10/2/12 IMPORT REPLEN CHANGES FOR RFID BEG                  07487006
074880*****************************************************             07488006
074890*        IF PV-OTBND-CART-YES = 'Y' AND                           07489006
074900*              PS-OTBND-LOC-ENTRY-NOT-EXIST                       07490006
074910*           PERFORM 5003-SELECT-FUNC-TXT                          07491006
074920*           EVALUATE TRUE                                         07492006
074930*               WHEN PS-AUTO-CONVEY-NO-CRTNS                      07493006
074940*                  CONTINUE                                       07494006
074950*               WHEN PS-AUTO-CONVEY-ALL-CRTNS                     07495006
074960*               WHEN PS-AUTO-CONVEY-EXCPT-CRTNS                   07496006
074970*                  PERFORM 6000A-FORMAT-DIR-CALL-IR               07497006
074980*           END-EVALUATE                                          07498006
074990*        END-IF                                                   07499006
075000*****************************************************             07500006
075010** GB 10/2/12 IMPORT REPLEN CHANGES FOR RFID END                  07501006
075020*****************************************************             07502006
075030         IF ((SU001-ROWS-INSERTED >=                              07503006
075040            SU001-PRT-LBL-ON-SCN-CNT)                             07504006
075050            AND LBVRDA-INPK-CNVYB-IND = 'N')                      07505006
075060                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   07506006
075070                 MOVE  SU001-PRINTER-ID  TO SU001-PRINTER-ID-USE  07507006
075080                 PERFORM 7300-START-LABEL-PRINT                   07508006
075090                 PERFORM 2400-GET-BATCH-NUMBER                    07509006
075100                 ADD  1  TO  PV-MAX-USER-BATCH                    07510006
075110                     GIVING  SU001-BATCH-NUMBER                   07511006
075120                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   07512006
075130                 MOVE  ZEROES             TO SU001-ROWS-INSERTED  07513006
075140         END-IF                                                   07514006
075150     ELSE                                                         07515006
075160         CONTINUE                                                 07516006
075290     END-IF.                                                      07529006
077390                                                                  07739006
077400                                                                  07740006
077410 5060-CALL-SEA-SET-MODULE.                                        07741006
077420                                                                  07742006
077430     INITIALIZE PC240-ITEM-COMMAREA                               07743006
077440     MOVE SU001-CARTON                TO PC240-KEY-CARTON-ID      07744006
077450     MOVE SU001-PO                    TO PC240-KEY-PO             07745006
077460     MOVE SU001-STORE                 TO PC240-KEY-DEST-LOC       07746006
077470     SET  PC240-CHECK-IN              TO TRUE                     07747006
077480     CALL PC240-VSM-PGM USING DFHEIBLK                            07748006
077490                              PC240-COMMAREA                      07749006
077500                              PC240-ITEM-COMMAREA                 07750006
077510     EVALUATE TRUE                                                07751006
077520         WHEN PC240-SUCCESSFUL                                    07752006
077530             MOVE PC240-DIVERT-PFX-NBR TO PV-STORE-NBR-PFX        07753006
077540                                          PV-BAR-CODE-DIVERT-PFX  07754006
077550             MOVE PC240-SEASET-NM      TO SEASET-SEASET-NM        07755006
077560             IF PC240-FIXT-ID  > SPACES                           07756006
077570                MOVE PC240-FIXT-ID    TO PV-FIXTURE-ID            07757006
077620             END-IF                                               07762006
077630         WHEN PC240-ITEM-NOT-FOUND                                07763006
077640                MOVE PC-00 TO PV-STORE-NBR-PFX                    07764006
077650                              PV-BAR-CODE-DIVERT-PFX              07765006
077660         WHEN PC240-SQL-ERROR                                     07766006
077670         WHEN PC240-INVALID-ACCESS                                07767006
077680             MOVE '5060-CALL-SEA-SET-MODULE'                      07768006
077690                             TO DP013-PARAGRAPH                   07769006
077700             MOVE 'SUKRF502 - CHECK SEASONAL SET'                 07770006
077710                             TO DP013-MESSAGE-TEXT(1)             07771006
077720             MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON             07772006
077730             MOVE  SU001-PO      TO PV-DISPLAY-PO                 07773006
077740             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       07774006
077750             MOVE  PC240-RETURN-CODE  TO PV-DISPLAY-RET-CODE      07775006
077760             MOVE  PC240-ERROR-NBR   TO PV-DISPLAY-ERROR-NBR      07776006
077770             STRING '  CARTON - '        DELIMITED BY SIZE        07777006
077780                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        07778006
077790                    ' PO, RCVR, LINE '   DELIMITED BY SIZE        07779006
077800                    PV-DISPLAY-PO        DELIMITED BY SIZE        07780006
077810                    ' '                  DELIMITED BY SIZE        07781006
077820                    PV-DISPLAY-RET-CODE  DELIMITED BY SIZE        07782006
077830                    ' '                  DELIMITED BY SIZE        07783006
077840                    PV-DISPLAY-ERROR-NBR                          07784006
077850                                         DELIMITED BY SIZE        07785006
077860                             INTO DP013-MESSAGE-TEXT (2)          07786006
077870             MOVE PC240-SQLCA  TO DP013-SQLCA                     07787006
077880             SET DP013-DB2-ABEND                                  07788006
077890                             TO TRUE                              07789006
077900             SET DP013-ROLLBACK                                   07790006
077910                             TO TRUE                              07791006
077920             SET DP013-XCTL-DISPLAY-RESTART                       07792006
077930                             TO TRUE                              07793006
077940             PERFORM DP014-0000-PROCESS-ABEND                     07794006
077950                                                                  07795006
077960         WHEN OTHER                                               07796006
077970             MOVE '5060-CALL-SEA-SET-MODULE'                      07797006
077980                             TO DP013-PARAGRAPH                   07798006
077990             MOVE 'SUKRF502 - CHECK SEASONAL SET'                 07799006
078000                             TO DP013-MESSAGE-TEXT(1)             07800006
078010             MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON             07801006
078020             MOVE  SU001-PO      TO PV-DISPLAY-PO                 07802006
078030             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       07803006
078040             MOVE  PC240-RETURN-CODE  TO PV-DISPLAY-RET-CODE      07804006
078050             MOVE  PC240-ERROR-NBR   TO PV-DISPLAY-ERROR-NBR      07805006
078060             STRING '  CARTON - '        DELIMITED BY SIZE        07806006
078070                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        07807006
078080                    ' PO, RCVR, LINE '   DELIMITED BY SIZE        07808006
078090                    PV-DISPLAY-PO        DELIMITED BY SIZE        07809006
078100                    ' '                  DELIMITED BY SIZE        07810006
078110                    PV-DISPLAY-RET-CODE  DELIMITED BY SIZE        07811006
078120                    ' '                  DELIMITED BY SIZE        07812006
078130                    PV-DISPLAY-ERROR-NBR                          07813006
078140                                         DELIMITED BY SIZE        07814006
078150                             INTO DP013-MESSAGE-TEXT (2)          07815006
078160             MOVE PC240-SQLCA  TO DP013-SQLCA                     07816006
078170             SET DP013-DB2-ABEND                                  07817006
078180                             TO TRUE                              07818006
078190             SET DP013-ROLLBACK                                   07819006
078200                             TO TRUE                              07820006
078210             SET DP013-XCTL-DISPLAY-RESTART                       07821006
078220                             TO TRUE                              07822006
078230             PERFORM DP014-0000-PROCESS-ABEND                     07823006
078240     END-EVALUATE.                                                07824006
078250                                                                  07825006
078260                                                                  07826076
085260*----------------------------------------------------------------*08526006
085270 5700-CALL-XLKUP033-EAI.                                          08527006
085280*----------------------------------------------------------------*08528006
085290     IF PV-TSHUNLO-TMST-EAI > SPACES                              08529006
085300        CONTINUE                                                  08530006
085310     ELSE                                                         08531006
085320        PERFORM 3569-SEL-MAX-CHECK-IN-TMST                        08532006
085330     END-IF                                                       08533006
085340                                                                  08534006
085350     INITIALIZE XL072-EAI-EXPORT-COMMAREA                         08535006
085360                SU050-DTL-TXT-AREA.                               08536006
085370     SET XL072-SU-APP-ID                                          08537006
085380         XL072-DO-NOT-COMMIT-UPDATE  TO TRUE.                     08538006
085390                                                                  08539006
085400                                                                  08540006
085410     MOVE 'CARTON'                TO XL072-EVNT-OBJ-TXT.          08541006
085420     MOVE 'CHECKIN'               TO XL072-EVNT-OBJ-ACTN-TXT.     08542006
085430     MOVE SU001-USER-ID           TO XL072-CRE-BY-USR-ID.         08543006
085440     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            08544006
085450                                                                  08545006
085460     MOVE SU001-CARTON            TO XL072-EVNT-KY-1-NBR.         08546006
085470     MOVE SU001-MANIFEST          TO XL072-EVNT-KY-2-NBR.         08547006
085480     MOVE PV-TSHUNLO-TMST-EAI     TO XL072-EVNT-KY-1-TMST.        08548006
085490                                                                  08549006
085500     SET XL072-SUWS050-COPYBOOK   TO TRUE.                        08550006
085510     SET SU050-CRTN-CHECK-IN      TO TRUE.                        08551006
085520     MOVE SU001-ASGMT-STRT-DTE    TO SU050-AB-ASGMT-STRT-DTE.     08552006
085530     MOVE SU001-ASGMT-NBR-TXT     TO SU050-AB-ASGMT-NBR-TXT.      08553006
085540     MOVE SU001-ASGMT-NBR-SEQ-NBR TO SU050-AB-ASGMT-NBR-SEQ-NBR.  08554006
085550                                                                  08555006
085560     MOVE SU001-SEQ-START-NBR     TO SU050-AB-ASGMT-SEQ-DTL-NBR.  08556006
085570     MOVE SU001-DOOR-ID           TO SU050-AB-DOOR-NBR.           08557006
085580     MOVE ZEROES                  TO SU050-AB-CRTN-DEST-LOC-NBR.  08558006
085590                                                                  08559006
085600     IF SU021-100-PC-AUDIT-REQD OR SU021-REWORK                   08560006
085610*CLP 10/24/13 -START                                              08561006
085620         OR SU021-RFID-100-PC-AUDIT-REQD OR SU021-RFID-REWORK     08562006
085630*CLP 10/24/13 -END                                                08563006
085640                                                                  08564006
085650         SET SU050-AB-CRTN-AUDIT-NEEDED TO TRUE                   08565006
085660     ELSE                                                         08566006
085670         SET SU050-AB-CRTN-ACTN-NONE    TO TRUE                   08567006
085680     END-IF                                                       08568006
085690                                                                  08569006
085700     EVALUATE TRUE                                                08570006
085710        WHEN PS-CARTON-SML-CREATED                                08571006
085720           IF LBVRDA-INPK-CNVYB-IND = 'Y'                         08572006
085730              SET SU050-AB-CRTN-TO-MULT-LOC TO TRUE               08573006
085740           ELSE                                                   08574006
085750              SET SU050-AB-CRTN-TO-LOC  TO TRUE                   08575006
085760           END-IF                                                 08576006
085770           MOVE SU001-STORE          TO SU050-AB-CRTN-DEST-LOC-NBR08577006
085780        WHEN PS-CARTON-P2L-CREATED                                08578006
085790           SET SU050-AB-CRTN-TO-P2L  TO TRUE                      08579006
085800           MOVE LBVRDA-STR-ZN-ID TO SU050-AB-STR-ZN-ID            08580006
085810           MOVE LBVRDA-MODU-DESC TO SU050-AB-P2L-MODU-DESC        08581006
085820        WHEN SU001-NO-PRINTER                                     08582006
085830        WHEN PS-NO-CASEPK-FND                                     08583006
085840        WHEN SU001-ECOMM-DC-REPURPOSE                             08584006
085850           SET SU050-AB-CRTN-TO-NONE TO TRUE                      08585006
085860        WHEN OTHER                                                08586006
085870           SET SU050-AB-CRTN-FREE-ASTRAY TO TRUE                  08587006
085880     END-EVALUATE                                                 08588006
085890                                                                  08589006
085900     MOVE SU050-DTL-TXT-AREA             TO XL072-DTL-TXT         08590006
085910                                                                  08591006
085920     CALL XL072-USER-PGM USING DFHEIBLK                           08592006
085930                              XL072-COMMAREA                      08593006
085940                              XL072-EAI-EXPORT-COMMAREA.          08594006
085950                                                                  08595006
085960     EVALUATE TRUE                                                08596006
085970         WHEN XL072-SUCCESSFUL                                    08597006
085980              CONTINUE                                            08598006
085990         WHEN OTHER                                               08599006
086000              SET PV-DONE-PROCESSING          TO TRUE             08600006
086010              MOVE XL072-RETURN-CODE     TO PV-SQLCODE            08601006
086020              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      08602006
086030               '5700-CALL-XLKUP033-EAI '   DELIMITED BY SIZE      08603006
086040                     'XL072-RETURN-CODE-'  DELIMITED BY SIZE      08604006
086050                     PV-SQLCODE            DELIMITED BY SIZE      08605006
086060                                      INTO PV-CICS-MSG-AREA       08606006
086070              MOVE LENGTH OF PV-CICS-MSG-AREA                     08607006
086080                                        TO PV-COMMAREA-LENGTH     08608006
086090              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              08609006
086100                                                                  08610006
086110              MOVE  '5700-CALL-XLKUP033-EAI '                     08611006
086120                              TO DP013-PARAGRAPH                  08612006
086130              MOVE 'CALL TO XLKUP033'                             08613006
086140                              TO DP013-MESSAGE-TEXT(1)            08614006
086150              MOVE 'CHECK CSSL FOR MORE DETAIL     '              08615006
086160                                TO DP013-MESSAGE-TEXT (2)         08616006
086170              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         08617006
086180              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           08618006
086190              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            08619006
086200              STRING ' TRIP - '           DELIMITED BY SIZE       08620006
086210                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       08621006
086220                     '  CARTON - '        DELIMITED BY SIZE       08622006
086230                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       08623006
086240                     '  STORE - '         DELIMITED BY SIZE       08624006
086250                     PV-DISPLAY-STORE     DELIMITED BY SIZE       08625006
086260                              INTO DP013-MESSAGE-TEXT (3)         08626006
086270              MOVE XL072-SQLCA    TO DP013-SQLCA                  08627006
086280              SET DP013-DB2-ABEND                                 08628006
086290                              TO TRUE                             08629006
086300              SET DP013-ROLLBACK                                  08630006
086310                              TO TRUE                             08631006
086320              SET DP013-XCTL-DISPLAY-RESTART                      08632006
086330                              TO TRUE                             08633006
086340              PERFORM DP014-0000-PROCESS-ABEND                    08634006
086350     END-EVALUATE.                                                08635006
086360* CT 11/06/08 BEGIN                                               08636006
086370                                                                  08637006
086380*----------------------------------------------------------------*08638006
086390 6000-FORMAT-DIRECTIVE-CALL.                                      08639006
086400*----------------------------------------------------------------*08640006
086410      INITIALIZE SU090-DG-REQUEST-COMMAREA.                       08641006
086420                                                                  08642006
086430      MOVE SU001-OPER-UNT-ID            TO SU090-OPER-UNT-ID.     08643006
086440      SET  SU090-CARTON-DIRECTIVE       TO TRUE.                  08644006
086450      SET  SU090-ONLINE                 TO TRUE.                  08645006
086460                                                                  08646006
086470      PERFORM 6001-GET-PO-AUD-REQ-INFO.                           08647006
086480                                                                  08648006
086490      EVALUATE TRUE                                               08649006
086500* JAK WR41309 - ADD WHEN CLAUSE FOR RFID CHECK                    08650006
086510* CLP 10/24/13                                                    08651006
086520        WHEN SU021-AUDIT-IS-COMPLETE AND                          08652006
086530             SU021-RFID-AUDIT-IS-COMPLETE                         08653006
086540* CLP 04/23/13 PR5148B START                                      08654006
086550             IF PS-DIRECTIVE-YES                                  08655006
086560                MOVE 'RFD'              TO SU090-DIRV-RSN-CDE     08656006
086570                MOVE 'R'                TO SU090-AUD-STAT-CDE     08657006
086580                MOVE  ZERO              TO SU021-AUDIT-NUMBER     08658006
086590             END-IF                                               08659006
086600        WHEN PS-DIRECTIVE-YES                                     08660006
086610* CLP 04/23/13 PR5148B END                                        08661006
086620             MOVE 'RFD'               TO SU090-DIRV-RSN-CDE       08662006
086630             MOVE 'R'                 TO SU090-AUD-STAT-CDE       08663006
086640* JAK WR41309 - END                                               08664006
086650        WHEN SU021-AUDIT-REQUIRED                                 08665006
086660        WHEN SU021-RFID-AUDIT-REQUIRED                            08666006
086670             MOVE 'AUQ'                 TO SU090-DIRV-RSN-CDE     08667006
086680             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     08668006
086690        WHEN SU021-AUDIT-PENDING                                  08669006
086700        WHEN SU021-RFID-AUDIT-PENDING                             08670006
086710             MOVE 'AUU'                 TO SU090-DIRV-RSN-CDE     08671006
086720             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     08672006
086730        WHEN SU021-100-PC-AUDIT-REQD                              08673006
086740        WHEN SU021-RFID-100-PC-AUDIT-REQD                         08674006
086750             MOVE 'AU%'                 TO SU090-DIRV-RSN-CDE     08675006
086760             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     08676006
086770        WHEN SU021-REWORK                                         08677006
086780             EVALUATE TRUE                                        08678006
086790                WHEN SUT00015-DIRV-RLSE-IND = ' '                 08679006
086800                WHEN SUT00015-DIRV-RLSE-IND = 'N'                 08680006
086810                   MOVE 'AUR'           TO SU090-DIRV-RSN-CDE     08681006
086820                WHEN PS-AUTO-CONVEY-ALL-CRTNS                     08682006
086830                WHEN PS-AUTO-CONVEY-EXCPT-CRTNS                   08683006
086840                   MOVE 'BRC'           TO SU090-DIRV-RSN-CDE     08684006
086850                   SET SU021-AUDIT-IS-COMPLETE TO TRUE            08685006
086860             END-EVALUATE                                         08686006
086870             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     08687006
086880        WHEN SU021-RFID-REWORK                                    08688006
086890             EVALUATE TRUE                                        08689006
086900                WHEN SUT00015-DIRV-RLSE-IND = ' '                 08690006
086910                WHEN SUT00015-DIRV-RLSE-IND = 'N'                 08691006
086920                   MOVE 'AUR'           TO SU090-DIRV-RSN-CDE     08692006
086930                WHEN PS-AUTO-CONVEY-ALL-CRTNS                     08693006
086940                WHEN PS-AUTO-CONVEY-EXCPT-CRTNS                   08694006
086950                   MOVE 'BRC'           TO SU090-DIRV-RSN-CDE     08695006
086960                   SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE       08696006
086970             END-EVALUATE                                         08697006
086980             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     08698006
086990*CLP 10/24/13                                                     08699006
087000        WHEN OTHER                                                08700006
087010             MOVE 'BRC'                 TO SU090-DIRV-RSN-CDE     08701006
087020             MOVE SUT00015-AUD-STAT-CDE TO SU090-AUD-STAT-CDE     08702006
087030      END-EVALUATE.                                               08703006
087040                                                                  08704006
087050      EVALUATE TRUE                                               08705006
087060         WHEN PS-CARTON-SML-CREATED                               08706006
087070            SET  SU090-SML-BARCODE     TO TRUE                    08707006
087080            MOVE SUT00024-SHIPT-UNT-ID TO SU090-SML-BRCDE-NBR     08708006
087090            MOVE SU001-STORE           TO SU090-STR-NBR           08709006
087100* JAK WR41309 - ADD CALL TO INSERT TO SUT_PRC_MSG_CNTL            08710006
087110* CLP 04/23/13 PR5148B START                                      08711006
087120            IF PS-RFID-ON-LABEL-YES                               08712006
087130* CLP 04/23/13 PR5148B END                                        08713006
087140                PERFORM 6800-INSERT-PROCESS-MSG                   08714006
087150            END-IF                                                08715006
087160* JAK WR41309 - END                                               08716006
087170         WHEN PS-CARTON-P2L-CREATED                               08717006
087180            SET  SU090-P2L-BARCODE     TO TRUE                    08718006
087190            MOVE DK-BARCODE-NBR        TO SU090-P2L-BRCDE-NBR     08719006
087200            MOVE SU001-STORE           TO SU090-STR-NBR           08720006
087210      END-EVALUATE.                                               08721006
087220                                                                  08722006
087230      MOVE SU001-PO                    TO SU090-PO-NBR.           08723006
087240                                                                  08724006
087250      IF RECEIV-PACK-BY-ST-IND = 'Y'                              08725006
087260          MOVE +0                      TO SU090-PO-PREPK-ID       08726006
087270                                          SU090-PO-LNE-NBR        08727006
087280      ELSE                                                        08728006
087290          IF LBPTDA-PREPK-ID > 0                                  08729006
087300              MOVE LBPTDA-PREPK-ID     TO SU090-PO-PREPK-ID       08730006
087310              MOVE +0                  TO SU090-PO-LNE-NBR        08731006
087320          ELSE                                                    08732006
087330              MOVE SU001-PO-LINE-NBR   TO SU090-PO-LNE-NBR        08733006
087340              MOVE +0                  TO SU090-PO-PREPK-ID       08734006
087350          END-IF                                                  08735006
087360      END-IF.                                                     08736006
087370                                                                  08737006
087380      MOVE SU001-RCVR-SEQ-NBR          TO SU090-RCVR-SEQ-NBR.     08738006
087390******MOVE SU021-AUDIT-VALIDATION-SW   TO SU090-CASI-CDE.         08739006
087400      SET  SU090-ACTIVE-CART           TO TRUE.                   08740006
087410                                                                  08741006
087420*CLP 10/24/13 -                                                   08742006
087430     EVALUATE TRUE                                                08743006
087440      WHEN NOT SU021-AUDIT-IS-COMPLETE                            08744006
087450          MOVE SU021-AUDIT-NUMBER      TO SU090-AUD-CNTL-NBR      08745006
087460          MOVE SU021-AUDIT-VALIDATION-SW   TO SU090-CASI-CDE      08746006
087470**gb 2/12/14                                                      08747006
087480          IF SUT00015-AUD-STAT-CDE = 'F' AND                      08748006
087490             SU021-RFID-AUDIT-REQUIRED                            08749006
087500             MOVE 'AUR'                 TO SU090-DIRV-RSN-CDE     08750006
087510          END-IF                                                  08751006
087520**gb 2/12/14                                                      08752006
087530      WHEN NOT SU021-RFID-AUDIT-IS-COMPLETE                       08753006
087540          MOVE SU021-RFID-AUDIT-NUMBER TO SU090-AUD-CNTL-NBR      08754006
087550          MOVE SU021-RFID-AUDIT-VALIDATION-SW TO SU090-CASI-CDE   08755006
087560     END-EVALUATE.                                                08756006
087570                                                                  08757006
087580      MOVE LBPTDA-STR-ZN-ID            TO SU090-STR-ZN.           08758006
087590*CLP 10/24/13 START                                               08759006
087600      IF PC240-SEASET-SHRT-NM > SPACES OR                         08760006
087610         LBVRDA-SEASET-NM > SPACES                                08761006
087620*CLP 10/24/13 END                                                 08762006
087630         PERFORM 7220-SELECT-TPURCHS                              08763006
087640         MOVE PURCHS-SEASET-SHRT-NM    TO SU090-SEASET-CDE        08764006
087650         MOVE PURCHS-SEASET-YR         TO SU090-SEASET-YR         08765006
087660      ELSE                                                        08766006
087670         MOVE SPACES                   TO SU090-SEASET-CDE        08767006
087680                                          SU090-SEASET-YR         08768006
087690      END-IF.                                                     08769006
087700                                                                  08770006
087710      MOVE SU001-USER-ID               TO SU090-ASSOC-ID.         08771006
087720                                                                  08772006
087730      EVALUATE TRUE                                               08773006
087740          ALSO SU090-DIRV-RSN-CDE                                 08774006
087750         WHEN PS-AUTO-CONVEY-EXCPT-CRTNS                          08775006
087760         ALSO 'BRC'                                               08776006
087770            SET SU090-DELETE-ACTION TO TRUE                       08777006
087780         WHEN OTHER                                               08778006
087790            SET SU090-ADD-ACTION    TO TRUE                       08779006
087800      END-EVALUATE.                                               08780006
087810                                                                  08781006
087820      IF SUT00015-DIRV-RLSE-IND = 'Y'                             08782006
087830* JAK WR41309 - ADD RFID CHECK                                    08783006
087840         AND SU093-RFID-NO                                        08784006
087850          CONTINUE                                                08785006
087860      ELSE                                                        08786006
087870          IF SU021-AUDIT-IS-COMPLETE AND                          08787006
087880*CLP 10/24/13 PR5148B START                                       08788006
087890             SU021-RFID-AUDIT-IS-COMPLETE AND                     08789006
087900*CLP 10/24/13 PR5148B   END                                       08790006
087910*CLP 04/23/13 PR5148B START                                       08791006
087920            (SU093-RFID-NO OR SU093-DPT-STR-P2L-FIRST-YES OR      08792006
087930             PS-DIRECTIVE-NO)                                     08793006
087940*CLP 04/23/13 PR5148B END                                         08794006
087950              CONTINUE                                            08795006
087960          ELSE                                                    08796006
087970              PERFORM 6100-CALL-DIRECTIVE-GEN-129                 08797006
087980          END-IF                                                  08798006
087990      END-IF.                                                     08799006
088000                                                                  08800006
088010 6000A-FORMAT-DIR-CALL-IR.                                        08801006
088020*----------------------------------------------------------------*08802006
088030                                                                  08803006
088040                                                                  08804006
088050      INITIALIZE SU093-ITEM-COMMAREA.                             08805006
088060      SET SU093-RFID-NO TO TRUE                                   08806006
088070      PERFORM 6010-CALL-RFID-DETERMINATION                        08807006
088080                                                                  08808006
088090* CLP 04/23/13 PR5148B START                                      08809006
088100* CLP 04/14/14 ADDED PS-AUTO-CONVEY-EXCPT-CRTNS CHECK             08810006
088110      IF PS-DIRECTIVE-YES AND PS-AUTO-CONVEY-EXCPT-CRTNS          08811006
088120* CLP 04/23/13 PR5148B END                                        08812006
088130         INITIALIZE SU090-DG-REQUEST-COMMAREA                     08813006
088140         MOVE SU001-OPER-UNT-ID         TO SU090-OPER-UNT-ID      08814006
088150         SET  SU090-CARTON-DIRECTIVE                              08815006
088160              SU090-ONLINE                                        08816006
088170              SU090-ADD-ACTION                                    08817006
088180              SU090-SML-BARCODE         TO TRUE                   08818006
088190         MOVE 'RFD'                 TO SU090-DIRV-RSN-CDE         08819006
088200         MOVE 'R'                   TO SU090-AUD-STAT-CDE         08820006
088210                                                                  08821006
088220         MOVE SPACES                TO SU090-ERR-PROGRAM          08822006
088230                                       SU090-ERR-PARAGRAPH        08823006
088240                                       SU090-SQLCA                08824006
088250                                       SU090-MQ-REAS-TXT          08825006
088260         MOVE ZEROES                TO SU090-SQLCODE              08826006
088270                                       SU090-MQ-COND-CODE         08827006
088280                                       SU090-MQ-REAS-CODE         08828006
088290                                                                  08829006
088300         MOVE 'SUKRF502'            TO SU090-CALLING-PGM          08830006
088310         MOVE SPACES                TO SU090-P2L-BRCDE-NBR        08831006
088320         MOVE ZEROS                    TO SU090-AUD-CNTL-NBR      08832006
088330         MOVE SU001-CARTON             TO SU090-SML-BRCDE-NBR     08833006
088340         MOVE SU001-PO                 TO SU090-PO-NBR            08834006
088350         MOVE ZEROS                    TO SU090-RCVR-SEQ-NBR      08835006
088360         MOVE SU001-PO-LINE-NBR        TO SU090-PO-LNE-NBR        08836006
088370         MOVE ZEROS                    TO SU090-PO-PREPK-ID       08837006
088380         MOVE SU001-STORE              TO SU090-STR-NBR           08838006
088390         MOVE SPACES                   TO SU090-CASI-CDE          08839006
088400         SET  SU090-ACTIVE-CART        TO TRUE                    08840006
088410         MOVE SPACES                   TO SU090-AUD-FAIL-RSN      08841006
088420         MOVE SPACES                   TO SU090-STR-ZN            08842006
088430         MOVE SPACES                   TO SU090-SEASET-YR         08843006
088440         MOVE SPACES                   TO SU090-SEASET-CDE        08844006
088450         MOVE SU001-USER-ID            TO SU090-ASSOC-ID          08845006
088460                                                                  08846006
088470         SET SU090-SUCCESS             TO TRUE                    08847006
088480         IF  PS-OTBND-LOC-ENTRY-NOT-EXIST                         08848006
088490             PERFORM 6100-CALL-DIRECTIVE-GEN-129                  08849006
088500         END-IF                                                   08850006
088510      END-IF.                                                     08851006
088520                                                                  08852006
088530* GET RLSE IND TO DETERMINE DIRV REASON CODE                      08853006
088540* AND AUDIT STATUS CODE                                           08854006
088550 6001-GET-PO-AUD-REQ-INFO.                                        08855006
088560                                                                  08856006
088570     MOVE SU021-AUDIT-NUMBER TO SUT00015-AUD-CNTL-NBR.            08857006
088580     MOVE SU021-PO-NUMBER    TO SUT00015-PO-NBR.                  08858006
088590                                                                  08859006
088600     EXEC SQL                                                     08860006
088610        SELECT DIRV_RLSE_IND                                      08861006
088620              ,AUD_STAT_CDE                                       08862006
088630        INTO  :SUT00015-DIRV-RLSE-IND                             08863006
088640             ,:SUT00015-AUD-STAT-CDE                              08864006
088650        FROM   SUT_PO_AUD_REQ                                     08865006
088660        WHERE  PO_NBR       = :SUT00015-PO-NBR                    08866006
088670          AND  AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR              08867006
088680     END-EXEC.                                                    08868006
088690                                                                  08869006
088700     EVALUATE TRUE                                                08870006
088710       WHEN SQLCODE = ZERO                                        08871006
088720           CONTINUE                                               08872006
088730       WHEN SQLCODE = +100                                        08873006
088740           INITIALIZE SUT00015-DIRV-RLSE-IND                      08874006
088750                      SUT00015-AUD-STAT-CDE                       08875006
088760       WHEN SQLWARN0 NOT = SPACES                                 08876006
088770       WHEN SQLCODE NOT EQUAL ZERO                                08877006
088780           MOVE '6001-GET-PO-AUD-REQ-INFO'                        08878006
088790                                        TO DP013-PARAGRAPH        08879006
088800           MOVE 'SUKRF502 - PO-NBR AND AUD-CNTL-NBR'              08880006
088810                                        TO DP013-MESSAGE-TEXT(1)  08881006
088820           MOVE SUT00015-PO-NBR         TO DP013-MESSAGE-TEXT(2)  08882006
088830           MOVE SUT00015-AUD-CNTL-NBR   TO DP013-MESSAGE-TEXT(3)  08883006
088840           MOVE SQLCA                   TO DP013-SQLCA            08884006
088850           MOVE 'SUT_PO_AUD_REQ'        TO DP013-DB2-TABLE-NAME(1)08885006
088860           SET DP013-DB2-ABEND            TO TRUE                 08886006
088870           SET DP013-ROLLBACK             TO TRUE                 08887006
088880           SET DP013-XCTL-DISPLAY-RESTART TO TRUE                 08888006
088890           PERFORM DP014-0000-PROCESS-ABEND                       08889006
088900     END-EVALUATE.                                                08890006
088910                                                                  08891006
088920 6002-CHECK-RF-AUDIT-STAT.                                        08892006
088930                                                                  08893006
088940     EXEC SQL                                                     08894006
088950     SELECT B.AUD_STAT_CDE                                        08895006
088960        INTO :SUT00015-AUD-STAT-CDE                               08896006
088970       FROM TSUATRN A                                             08897006
088980           ,SUT_PO_AUD_REQ B                                      08898006
088990     WHERE  A.SHIPT_UNT_ID  = :DK-CTN                             08899006
089000       AND  A.AUD_CNTL_NBR  = B.AUD_CNTL_NBR                      08900006
089010       AND  B.PKGNG_TYP_CDE = 'RF'                                08901006
089020     END-EXEC.                                                    08902006
089030                                                                  08903006
089040     EVALUATE TRUE                                                08904006
089050       WHEN SQLCODE = ZERO                                        08905006
089060             IF SUT00015-AUD-STAT-CDE = 'P' OR                    08906006
089070                SUT00015-AUD-STAT-CDE = 'N'                       08907006
089080                 SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE         08908006
089090             ELSE                                                 08909006
089100                 IF SUT00015-AUD-STAT-CDE = 'F'                   08910006
089110                     SET SU021-RFID-REWORK  TO TRUE               08911006
089120                 ELSE                                             08912006
089130***    SUT00015-AUD-STAT-CDE = 'I'                                08913006
089140                     SET SU021-RFID-AUDIT-PENDING TO TRUE         08914006
089150                 END-IF                                           08915006
089160             END-IF                                               08916006
089170       WHEN SQLCODE = +100                                        08917006
089180           CONTINUE                                               08918006
089190       WHEN SQLWARN0 NOT = SPACES                                 08919006
089200       WHEN SQLCODE NOT EQUAL ZERO                                08920006
089210           MOVE '6002-CHECK-RF-AUDIT-STAT'                        08921006
089220                                        TO DP013-PARAGRAPH        08922006
089230           MOVE 'SUKRF502 - PO-NBR AND AUD-CNTL-NBR'              08923006
089240                                        TO DP013-MESSAGE-TEXT(1)  08924006
089250           MOVE SUT00015-PO-NBR         TO DP013-MESSAGE-TEXT(2)  08925006
089260           MOVE SUT00015-AUD-CNTL-NBR   TO DP013-MESSAGE-TEXT(3)  08926006
089270           MOVE SQLCA                   TO DP013-SQLCA            08927006
089280           MOVE 'SUT_PO_AUD_REQ'        TO DP013-DB2-TABLE-NAME(1)08928006
089290           SET DP013-DB2-ABEND            TO TRUE                 08929006
089300           SET DP013-ROLLBACK             TO TRUE                 08930006
089310           SET DP013-XCTL-DISPLAY-RESTART TO TRUE                 08931006
089320           PERFORM DP014-0000-PROCESS-ABEND                       08932006
089330     END-EVALUATE.                                                08933006
089340                                                                  08934006
089350                                                                  08935006
089360* JAK WR41309 - ADD PARAGRAM FOR CALL TO SUKUT149                 08936006
089370* CALL SUKUT149 TO DETERMINE IF CARTON IS RFID                    08937006
089380 6010-CALL-RFID-DETERMINATION.                                    08938006
089390                                                                  08939006
089400* CLP 04/23/13 PR5148B START                                      08940006
089410        IF PV-TEST-CICS OR PV-QA-CICS                             08941006
089420            MOVE SPACE TO PV-CICS-MSG-AREA-A                      08942006
089430            MOVE SU001-OPER-UNT-ID TO PV-UNIT                     08943006
089440            MOVE SU001-STORE TO PV-STORE1                         08944006
089450            MOVE SU001-CARTON TO PV-CARTON-CNT18                  08945006
089460            STRING ' SUKRF502: 6010-'                             08946006
089470             ' OT-CRT='                                           08947006
089480               PV-OTBND-CART-YES                                  08948006
089490             ' DC='                                               08949006
089500             PV-UNIT                                              08950006
089510             ' ST = '                                             08951006
089520             PV-STORE1                                            08952006
089530             ' CT ='                                              08953006
089540             PV-CARTON-CNT18                                      08954006
089550             ' P2L='                                              08955006
089560             SU001-P2L-LBL-IND                                    08956006
089570             ' IR ='                                              08957006
089580             PV-20-SML-BC-DC-ORIGIN                               08958006
089590            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             08959006
089600            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     08960006
089610                                           TO PV-COMMAREA-LENGTH  08961006
089620            EXEC CICS WRITEQ TD                                   08962006
089630                      QUEUE('CSSL')                               08963006
089640                      FROM(PV-CICS-MSG-AREA-A)                    08964006
089650                      LENGTH(PV-COMMAREA-LENGTH)                  08965006
089660                      RESP (PV-CICS-RESPONSE)                     08966006
089670            END-EXEC                                              08967006
089680     END-IF.                                                      08968006
089690                                                                  08969006
089700                                                                  08970006
089710     INITIALIZE SU093-ITEM-COMMAREA.                              08971006
089720     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   08972006
089730     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   08973006
089740     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE.                   08974006
089750     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE.                   08975006
089760     SET SU093-DC-DEPT-TAGS-NO         TO TRUE.                   08976006
089770     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   08977006
089780     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   08978006
089790     SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE.                   08979006
089800*CLP 10/24/13 - START                                             08980006
089810     SET SU093-IR-CHK-IN-NO            TO TRUE.                   08981006
089820*CLP 10/24/13 - END                                               08982006
089830                                                                  08983006
089840     SET SU093-P2L-CHK-IN-NO                   TO TRUE.           08984006
089850     IF PV-OTBND-CART-YES = 'Y'                                   08985006
089860          SET SU093-OUTBOUND-CTN                TO TRUE           08986006
089870          SET SU093-CARTON-STATUS               TO TRUE           08987006
089880          SET SU093-CHECK-BY-DEPT-SUBCLS-YES    TO TRUE           08988006
089890          SET SU093-CHECK-BY-DEPT-IN-STR-YES    TO TRUE           08989006
089900          SET SU093-RFID-STR-CHK-NEEDED-YES     TO TRUE           08990006
089910          SET SU093-CHECK-BY-DC                 TO TRUE           08991006
089920          MOVE SU001-OPER-UNT-ID         TO SU093-KEY-OPER-UNT-ID 08992006
089930          MOVE SU001-STORE               TO SU093-KEY-DEST-LOC    08993006
089940          MOVE SU001-CARTON              TO SU093-KEY-CARTON-ID   08994006
089950*CLP 10/24/13                                                     08995006
089960          INITIALIZE PV-20-DIGIT-BARCODE                          08996006
089970          SET  PV-RFID-REPLEN-NO         TO TRUE                  08997006
089980          MOVE PV-CTN-N                  TO PV-20-DIGIT-BARCODE   08998006
089990*         THIS IS THE FACILITY                                    08999006
090000          MOVE PV-20-SML-BC-DC-ORIGIN    TO SU093-KEY-IR-NBR      09000006
090010          SET SU093-IR-CHK-IN-YES        TO TRUE                  09001006
090020     ELSE                                                         09002006
090030          SET SU093-CHECK-IN                    TO TRUE           09003006
090040          IF SU001-P2L-LBL-IND = 'Y'                              09004006
090050             SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE           09005006
090060             SET SU093-CHECK-BY-DEPT-IN-STR-NO  TO TRUE           09006006
090070             SET SU093-RFID-STR-CHK-NEEDED-NO   TO TRUE           09007006
090080             SET SU093-CHECK-BY-DC              TO TRUE           09008006
090090             SET SU093-P2L-CHK-IN-YES           TO TRUE           09009006
090100             MOVE SU001-OPER-UNT-ID       TO SU093-KEY-OPER-UNT-ID09010006
090110             MOVE SU001-CARTON            TO SU093-KEY-CARTON-ID  09011006
090120          ELSE                                                    09012006
090130             SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE           09013006
090140             SET SU093-CHECK-BY-DEPT-IN-STR-YES TO TRUE           09014006
090150             SET SU093-RFID-STR-CHK-NEEDED-YES  TO TRUE           09015006
090160             SET SU093-CHECK-BY-DC              TO TRUE           09016006
090170             MOVE SU001-OPER-UNT-ID      TO SU093-KEY-OPER-UNT-ID 09017006
090180             MOVE SU001-STORE            TO SU093-KEY-DEST-LOC    09018006
090190             MOVE SU001-CARTON           TO SU093-KEY-CARTON-ID   09019006
090200     END-IF.                                                      09020006
090210                                                                  09021006
090220     CALL SU093-RFID-PGM       USING DFHEIBLK                     09022006
090230                                     SU093-COMMAREA               09023006
090240                                     SU093-ITEM-COMMAREA.         09024006
090250                                                                  09025006
090260     IF PV-TEST-CICS OR PV-QA-CICS                                09026006
090270         MOVE SPACE TO PV-CICS-MSG-AREA-A                         09027006
090280         MOVE SU093-KEY-CARTON-ID TO PV-CARTON-CNT18              09028006
090290         STRING ' SUKRF502: AFTER SUB CALL '                      09029006
090300             ' RETURN CODE   '                                    09030006
090310              SU093-RETURN-CODE                                   09031006
090320             ' RFID-IND=  '                                       09032006
090330             SU093-RFID-IND                                       09033006
090340             ' ERROR-NBR  '                                       09034006
090350             SU093-ERROR-NBR                                      09035006
090360            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-a             09036006
090370         EXEC CICS WRITEQ TD                                      09037006
090380                      QUEUE('CSSL')                               09038006
090390                      FROM(PV-CICS-MSG-AREA-A)                    09039006
090400                      LENGTH(PV-COMMAREA-LENGTH)                  09040006
090410                      RESP (PV-CICS-RESPONSE)                     09041006
090420         END-EXEC                                                 09042006
090430     END-IF.                                                      09043006
090440                                                                  09044006
090450                                                                  09045006
090460     IF PV-TEST-CICS OR PV-QA-CICS                                09046006
090470        MOVE SPACE TO PV-CICS-MSG-AREA-A                          09047006
090480        STRING ' SUKRF502: SW= '                                  09048006
090490             ' COMP= '                                            09049006
090500               SU093-VNDR-DPT-RFID-COMPLI-SW                      09050006
090510             ' RFID-TAG= '                                        09051006
090520             SU093-VNDR-DPT-RFID-TAGS-SW                          09052006
090530             ' #DC-DPT-TAGS='                                     09053006
090540             SU093-DC-DEPT-TAGS-SW                                09054006
090550             ' CART='                                             09055006
090560             SU093-DC-USE-RFID-CART-LBL-SW                        09056006
090570             ' AUTO= '                                            09057006
090580             SU093-RFID-DC-AUTO-CONVEYR-SW                        09058006
090590             ' P2L='                                              09059006
090600             SU093-DPT-STR-P2L-FIRST-SW                           09060006
090610             ' IR ='                                              09061006
090620             SU093-IR-CHK-IN-SW                                   09062006
090630            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             09063006
090640            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     09064006
090650                                           TO PV-COMMAREA-LENGTH  09065006
090660       EXEC CICS WRITEQ TD                                        09066006
090670                      QUEUE('CSSL')                               09067006
090680                      FROM(PV-CICS-MSG-AREA-A)                    09068006
090690                      LENGTH(PV-COMMAREA-LENGTH)                  09069006
090700                      RESP (PV-CICS-RESPONSE)                     09070006
090710       END-EXEC                                                   09071006
090720     END-IF.                                                      09072006
090730                                                                  09073006
090740     EVALUATE TRUE                                                09074006
090750       WHEN SU093-SUCCESSFUL                                      09075006
090760           IF SU093-RFID-IND = 'Y'                                09076006
090770               PERFORM 6020-SET-DIRECT-AND-LABEL                  09077006
090780           END-IF                                                 09078006
090790* CLP 04/23/13 PR5148B END                                        09079006
090800       WHEN OTHER                                                 09080006
090810            MOVE  SU093-KEY-OPER-UNT-ID TO  PV-DISPLAY-DC         09081006
090820            MOVE  SU093-KEY-DEST-LOC    TO  PV-DISPLAY-STORE      09082006
090830            MOVE  SU093-KEY-CARTON-ID   TO  PV-DISPLAY-CARTON     09083006
090840            MOVE  SU093-SQLCODE         TO  PV-DISPLAY-SQLCODE    09084006
090850            DISPLAY ' SUKRF502 - 6010 - '                         09085006
090860                     ' UNSUCCESSFUL CALL TO SUKUT149'             09086006
090870                     ' RFID DIRECTIVE MODULE'                     09087006
090880                                                                  09088006
090890             DISPLAY 'SUKRF502-6010-'                             09089006
090900                      SU093-ITEM-COMMAREA                         09090006
090910                                                                  09091006
090920             STRING                                               09092006
090930                  'RC:'   SU093-RETURN-CODE                       09093006
090940                  ':'      PV-DISPLAY-SQLCODE                     09094006
090950                  ':'      SU093-ERROR-NBR                        09095006
090960                  ':'      PV-DISPLAY-DC                          09096006
090970                  ':'      PV-DISPLAY-STORE                       09097006
090980                  ':'      PV-DISPLAY-CARTON                      09098006
090990                  ':'                                             09099006
091000                                         DELIMITED BY SIZE        09100006
091010                                    INTO PV-ERROR-TEXT            09101006
091020             DISPLAY 'SUKRF502-6010- ' PV-ERROR-TEXT              09102006
091030     END-EVALUATE.                                                09103006
091040* JAK WR41309 - END                                               09104006
091050                                                                  09105006
091060 6020-SET-DIRECT-AND-LABEL.                                       09106006
091070* **************************************************************  09107006
091080* ONCE COMING BACK FROM ROUTINE AND YOU KNOW ITS RFID YOU      *  09108006
091090* STILL NEED TO CHECK THE FOLLOWING SWITCHES TO DETERMINE IF   *  09109006
091100* RFID IS PRINTED ON THE LABEL AND ALSO IF THERE IS A DIRECTIVE*  09110006
091110* **************************************************************  09111006
091120* * ALSO SETS CARTON LABEL                                     *  09112006
091130* **************************************************************  09113006
091140* * ALSO CHECK FOR P2L AND NOT AUTO CONVEYOR TURN DIRECTIVE OFF*  09114006
091150* **************************************************************  09115006
091160* * ALSO CHECK IF IR FACILITY IS TAGGING                       *  09116006
091170* **************************************************************  09117006
091180                                                                  09118006
091190     SET PS-DIRECTIVE-NO              TO TRUE.                    09119006
091200     SET PS-RFID-ON-LABEL-NO          TO TRUE.                    09120006
091210*CLP 10/24/13                                                     09121006
091220     SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE.                    09122006
091230                                                                  09123006
091240     IF SU093-VNDR-DPT-RFID-COMPLI-YES                            09124006
091250*       Means no directive and no RFID on labels                  09125006
091260        SET PS-DIRECTIVE-NO     TO TRUE                           09126006
091270        SET PS-RFID-ON-LABEL-NO TO TRUE                           09127006
091280     ELSE                                                         09128006
091290        IF SU093-VNDR-DPT-RFID-TAGS-YES AND                       09129006
091300            SU093-DC-DEPT-TAGS-NO                                 09130006
091310*           Means no directive and no RFID on labels              09131006
091320            SET PS-DIRECTIVE-NO      TO TRUE                      09132006
091330            SET PS-RFID-ON-LABEL-NO  TO TRUE                      09133006
091340        ELSE                                                      09134006
091350            IF SU093-VNDR-DPT-RFID-TAGS-NO AND                    09135006
091360              SU093-DC-DEPT-TAGS-YES                              09136006
091370              AND SU093-RFID-KOHL-DPT-IN-STR-YES                  09137006
091380*             generate directive and yes TO RFID on labels        09138006
091390              SET PS-DIRECTIVE-YES     TO TRUE                    09139006
091400              SET PS-RFID-ON-LABEL-YES TO TRUE                    09140006
091410* 07/19/13 RLK BEG                                                09141006
091420              IF SU093-DC-USE-RFID-CART-LBL-YES                   09142006
091430              AND SU093-LABEL-PRINT-IND > SPACES                  09143068
091440                SET PS-DC-USE-RFID-CART-LBL-YES TO TRUE           09144006
091450              ELSE                                                09145006
091460                SET PS-DC-USE-RFID-CART-LBL-NO TO TRUE            09146006
091470              END-IF                                              09147006
091480* 07/19/13 RLK END                                                09148006
091490            ELSE                                                  09149006
091500              IF SU093-VNDR-DPT-RFID-TAGS-NO AND                  09150006
091510                 SU093-DC-DEPT-TAGS-NO                            09151006
091520*                NO DIRECTIVE AND NO RFID on labels               09152006
091530                 SET PS-DIRECTIVE-NO     TO TRUE                  09153006
091540                 SET PS-RFID-ON-LABEL-NO TO TRUE                  09154006
091550              ELSE                                                09155006
091560                  IF SU093-VNDR-DPT-RFID-TAGS-YES AND             09156006
091570                     SU093-DC-DEPT-TAGS-YES                       09157006
091580**07/15/17 gb        AND SU093-RFID-KOHL-DPT-IN-STR-YES           09158071
091590* 10/24/13 CLP BEG   NO DIRECTIVE AND NO RFID ON LABELS -         09159034
091600*                    CHANGE MADE WITH AUDIT CHANGES               09160034
091610* 10/24/13 CLP END                                                09161034
091620                     SET PS-DIRECTIVE-NO     TO TRUE              09162034
091630                     SET PS-RFID-ON-LABEL-NO  TO TRUE             09163034
091640                     SET PS-DC-USE-RFID-CART-LBL-NO  TO TRUE      09164071
091650                     PERFORM 6025-CHECK-RFID-AUDITING-LVL         09165068
091660                     IF PS-RFID-DEPT-LEVEL-YES                    09166068
091670                        PERFORM 6028-RFID-AUDITING-DEPT           09167057
091680                        IF PS-RFID-AUDIT-YES                      09168068
091690                          PERFORM 6030-CHECK-FOR-RFID-AUDIT       09169057
091700                        END-IF                                    09170057
091710                     END-IF                                       09171057
091720                  END-IF                                          09172006
091730              END-IF                                              09173006
091740            END-IF                                                09174006
091750        END-IF                                                    09175006
091760     END-IF.                                                      09176006
091770                                                                  09177006
091780                                                                  09178068
091790*    ONLY CHECK THE AUTO CONVEYR IF ITS P2L (NOT SML)             09179006
091800** gb 7/1/13 added check to not send directive                    09180006
091810**         when   SU093-DPT-STR-P2L-FIRST-YES                     09181006
091820     IF SU001-P2L-LBL-IND = 'Y'                                   09182006
091830         IF SU093-RFID-DC-AUTO-CONVEYR-NO OR                      09183006
091840            SU093-LABEL-PRINT-IND = SPACES OR                     09184075
091850            SU093-DPT-STR-P2L-FIRST-YES                           09185006
091860              SET PS-DIRECTIVE-NO TO TRUE                         09186074
091870         END-IF                                                   09187006
091880     END-IF.                                                      09188006
091890                                                                  09189037
091900     IF SU093-PRINT-EAS OR SU093-PRINT-RFID-EAS                   09190068
091910        SET PS-RFID-ON-LABEL-YES TO TRUE                          09191056
091920        SET PS-DIRECTIVE-YES    TO TRUE                           09192046
091930        IF SU093-DC-USE-RFID-CART-LBL-YES                         09193068
091940           SET PS-DC-USE-RFID-CART-LBL-YES TO TRUE                09194068
091950        END-IF                                                    09195068
091960        IF SU001-P2L-LBL-IND = 'Y'                                09196048
091970           SET SU093-DPT-STR-P2L-FIRST-NO TO TRUE                 09197048
091980        END-IF                                                    09198048
091990     END-IF.                                                      09199068
092000                                                                  09200006
092010*CLP 10/24/13 BEG                                                 09201006
092020*    ADDED CHECK FOR IR FACILITY TAGGING                          09202006
092030     IF  PV-OTBND-CART-YES = 'Y'                                  09203006
092040        IF SU093-IR-NEEDS-DC-TAGGING-NO AND                       09204006
092050           SU093-IR-CHK-IN-YES                                    09205006
092060*          Means no directive and no RFID on labels               09206006
092070           SET PS-DIRECTIVE-NO     TO TRUE                        09207006
092080           SET PS-RFID-ON-LABEL-NO TO TRUE                        09208006
092090        END-IF                                                    09209006
092100*CLP 04/14/14 START                                               09210006
092110        IF SU093-IR-NEEDS-DC-TAGGING-YES AND                      09211006
092120           SU093-IR-CHK-IN-YES                                    09212006
092130*          Means directive and yes RFID on labels                 09213006
092140           SET PS-DIRECTIVE-yes     TO TRUE                       09214006
092150           SET PS-RFID-ON-LABEL-yes TO TRUE                       09215006
092160        END-IF                                                    09216006
092170     END-IF.                                                      09217006
092180*CLP 04/14/14 END                                                 09218006
092190                                                                  09219006
092200*    IF QC AUDIT WAS CREATED IT WOULD HAVE BEEN DONE              09220006
092210*    AT THIS POINT SO SET THE SWITCHES FOR SU006- WHICH           09221006
092220*    GET PASSED TO THE PROMPTED AUDIT PROGRAM SUKRF534            09222006
092230*                                                                 09223006
092240     IF SU021-AUDIT-NUMBER IS NOT NUMERIC                         09224006
092250         MOVE 0 TO SU021-AUDIT-NUMBER                             09225006
092260     END-IF.                                                      09226006
092270     IF SU021-RFID-AUDIT-NUMBER IS NOT NUMERIC                    09227006
092280         MOVE 0 TO SU021-RFID-AUDIT-NUMBER                        09228006
092290     END-IF.                                                      09229006
092300                                                                  09230006
092310     IF SU021-AUDIT-NUMBER > 0                                    09231006
092320        IF SU021-RFID-AUDIT-NUMBER > 0                            09232006
092330*          COMBINED - QC AND RFID                                 09233006
092340              MOVE SU021-RFID-AUDIT-NUMBER TO                     09234006
092350                  SU006-RFID-AUDIT-CNTL-NBR                       09235006
092360              SET SU006-QC-AND-RFID-AUD TO TRUE                   09236006
092370              SET SU006-QC-AUDIT        TO TRUE                   09237006
092380        ELSE                                                      09238006
092390*          JUST QC                                                09239006
092400              SET SU006-QC-AUD-ONLY TO TRUE                       09240006
092410              SET SU006-QC-AUDIT    TO TRUE                       09241006
092420        END-IF                                                    09242006
092430     ELSE                                                         09243006
092440        IF SU021-RFID-AUDIT-NUMBER > 0                            09244006
092450*           JUST RFID                                             09245006
092460             SET SU006-RFID-AUD-ONLY TO TRUE                      09246006
092470             SET SU006-RFID-AUDIT    TO TRUE                      09247006
092480        ELSE                                                      09248006
092490*          NO AUDIT                                               09249006
092500           CONTINUE                                               09250006
092510        END-IF                                                    09251006
092520     END-IF.                                                      09252006
092530                                                                  09253006
092540     IF PV-TEST-CICS OR PV-QA-CICS                                09254006
092550        MOVE SPACE TO PV-CICS-MSG-AREA-A                          09255006
092560        STRING ' SUKRF502: 6020- '                                09256006
092570             ' RFID-QC IND = '                                    09257006
092580               SU006-RFID-QC-AUDIT-IND                            09258006
092590             ' RFID-QC COMB IND = '                               09259006
092600             SU006-RFID-QC-AUD-CMB-IND                            09260006
092610            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             09261006
092620            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     09262006
092630                                           TO PV-COMMAREA-LENGTH  09263006
092640       EXEC CICS WRITEQ TD                                        09264006
092650                      QUEUE('CSSL')                               09265006
092660                      FROM(PV-CICS-MSG-AREA-A)                    09266006
092670                      LENGTH(PV-COMMAREA-LENGTH)                  09267006
092680                      RESP (PV-CICS-RESPONSE)                     09268006
092690       END-EXEC                                                   09269006
092700     END-IF.                                                      09270006
092710*CLP 10/24/13 END                                                 09271006
092720                                                                  09272006
092730     IF PV-TEST-CICS OR PV-QA-CICS                                09273006
092740        MOVE SPACE TO PV-CICS-MSG-AREA-A                          09274006
092750        STRING ' SUKRF502: 6020- '                                09275006
092760             ' CD = '                                             09276006
092770              SU093-RETURN-CODE                                   09277006
092780             ' RF = '                                             09278006
092790             SU093-RFID-IND                                       09279006
092800             ' DV = '                                             09280006
092810             PS-DIRECTIVE-SW                                      09281006
092820             ' PT = '                                             09282006
092830             PS-RFID-ON-LABEL-SW                                  09283006
092840             ' LB = '                                             09284006
092850             PS-DC-USE-RFID-CART-LBL-SW                           09285006
092860             ' SW = '                                             09286006
092870             SU093-RFID-KOHL-DPT-IN-STR-SW                        09287006
092880             ' IR = '                                             09288006
092890             SU093-IR-NEEDS-DC-TAGGING-SW                         09289045
092900             ' RF/EA/BTH = '                                      09290072
092910             SU093-LABEL-PRINT-IND                                09291072
092920            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             09292006
092930            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     09293006
092940                                           TO PV-COMMAREA-LENGTH  09294006
092950            EXEC CICS WRITEQ TD                                   09295006
092960                      QUEUE('CSSL')                               09296006
092970                      FROM(PV-CICS-MSG-AREA-A)                    09297006
092980                      LENGTH(PV-COMMAREA-LENGTH)                  09298006
092990                      RESP (PV-CICS-RESPONSE)                     09299006
093000            END-EXEC                                              09300006
093010     END-IF.                                                      09301006
093020                                                                  09302006
093030****************************************************************  09303072
093040* CHECK AT THE DC LEVEL IF AN ADDITIONAL CHECK SHOULD             09304072
093050* BE MADE AT THE DEPARTMENT LEVEL FOR RFID AUDITING               09305072
093060****************************************************************  09306072
093070 6025-CHECK-RFID-AUDITING-LVL.                                    09307072
093080                                                                  09308072
093090     MOVE SU001-OPER-UNT-ID      TO KRPRPM-LOC-ID.                09309072
093100                                                                  09310072
093110     EXEC SQL                                                     09311072
093120          SELECT FUNC_END_TMST                                    09312072
093130          INTO  :KRPRPM-FUNC-END-TMST                             09313072
093140          FROM   TKRPRPM                                          09314072
093150          WHERE  SYS_PRC_FUNC_CDE  = 'AUDPMT'                     09315072
093160            AND  INTFC_SYS_CDE     = 'KHL'                        09316072
093170            AND  FUNC_PRC_STAT_CDE = 'AC'                         09317072
093180            AND  FUNC_TXT          = 'Y'                          09318072
093190            AND  LOC_ID            =  :KRPRPM-LOC-ID              09319072
093200     END-EXEC.                                                    09320072
093210                                                                  09321072
093220     EVALUATE TRUE                                                09322072
093230         WHEN SQLCODE = ZERO                                      09323072
093240             SET PS-RFID-DEPT-LEVEL-YES TO TRUE                   09324072
093250                                                                  09325072
093260         WHEN SQLCODE = +100                                      09326072
093270             SET PS-RFID-DEPT-LEVEL-NO TO TRUE                    09327072
093280                                                                  09328072
093290         WHEN SQLWARN0 NOT = SPACES                               09329072
093300         WHEN SQLCODE < ZERO                                      09330072
093310         WHEN SQLCODE > ZERO                                      09331072
093320             MOVE '6025-CHECK-RFID-AUDITING-LVL'                  09332072
093330                             TO DP013-PARAGRAPH                   09333072
093340             MOVE 'SUKRF502 - CHECK AUDITING LEVEL'               09334072
093350                             TO DP013-MESSAGE-TEXT(1)             09335072
093360             MOVE SU001-OPER-UNT-ID                               09336072
093370                             TO DP013-MESSAGE-TEXT(2)             09337072
093380             MOVE KRPRPM-LOC-ID                                   09338072
093390                             TO DP013-MESSAGE-TEXT(3)             09339072
093400             MOVE SQLCA      TO DP013-SQLCA                       09340072
093410             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           09341072
093420             SET DP013-DB2-ABEND                                  09342072
093430                             TO TRUE                              09343072
093440             SET DP013-ROLLBACK                                   09344072
093450                             TO TRUE                              09345072
093460             SET DP013-XCTL-DISPLAY-RESTART                       09346072
093470                             TO TRUE                              09347072
093480             PERFORM DP014-0000-PROCESS-ABEND                     09348072
093490     END-EVALUATE.                                                09349072
093500                                                                  09350072
093510****************************************************************  09351072
093520* CHECK AT THE DC DEPARMENT LEVEL IF THE AUDIT MODULE             09352072
093530* SHOULD BE CALLED                                                09353072
093540****************************************************************  09354072
093550 6028-RFID-AUDITING-DEPT.                                         09355072
093560                                                                  09356072
093570     MOVE SU001-OPER-UNT-ID      TO KRPRPM-LOC-ID.                09357072
093580     MOVE PV-DEPT-NUMBER         TO WST00010-ATTR-ELEM-NBR.       09358072
093590                                                                  09359072
093600     EXEC SQL                                                     09360072
093610       SELECT   E.ATTR_ELEM_TXT                                   09361072
093620        INTO   :PV-FUNC-TXT                                       09362072
093630        FROM                                                      09363072
093640              WST_INTGRTN_TYP  A                                  09364072
093650           ,  WST_ATTR_DEFN    B                                  09365072
093660           ,  WST_ATTR_ELEM    C                                  09366072
093670           ,  WST_ATTR_ELEM    D                                  09367072
093680           ,  WST_ATTR_ELEM    E                                  09368072
093690           ,  WST_ATTR_ELEM    F                                  09369072
093700           ,  WST_ATTR_ELEM    G                                  09370072
093710       WHERE                                                      09371072
093720             A.INTGRTN_TYP_CDE   = 'RFDAUDDPT'                    09372072
093730         AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE              09373072
093740         AND B.ATTR_DEFN_SEQ_NBR = 1                              09374072
093750         AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE              09375072
093760         AND C.ATTR_DEFN_SEQ_NBR = 1                              09376072
093770         AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE              09377072
093780         AND D.ATTR_DEFN_SEQ_NBR = 2                              09378072
093790         AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE              09379072
093800         AND E.ATTR_DEFN_SEQ_NBR = 3                              09380072
093810         AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE              09381072
093820         AND F.ATTR_DEFN_SEQ_NBR = 4                              09382072
093830         AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE              09383072
093840         AND G.ATTR_DEFN_SEQ_NBR = 5                              09384072
093850         AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR            09385072
093860         AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR            09386072
093870         AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR            09387072
093880         AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR            09388072
093890         AND C.ATTR_ELEM_NBR     = :SU001-OPER-UNT-ID             09389072
093900         AND D.ATTR_ELEM_NBR     = :WST00010-ATTR-ELEM-NBR        09390072
093910         AND E.ATTR_ELEM_TXT     =  'Y'                           09391072
093920         AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP             09392072
093930         AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP             09393072
093940     END-EXEC.                                                    09394072
093950                                                                  09395072
093960     EVALUATE TRUE                                                09396072
093970         WHEN SQLCODE = ZERO                                      09397072
093980             SET PS-RFID-AUDIT-YES TO TRUE                        09398072
093990                                                                  09399072
094000         WHEN SQLCODE = +100                                      09400072
094010             SET PS-RFID-AUDIT-NO  TO TRUE                        09401072
094020                                                                  09402072
094030         WHEN SQLWARN0 NOT = SPACES                               09403072
094040         WHEN SQLCODE < ZERO                                      09404072
094050         WHEN SQLCODE > ZERO                                      09405072
094060             MOVE '6028-RFID-AUDITING-DEPT'                       09406072
094070                             TO DP013-PARAGRAPH                   09407072
094080             MOVE 'SUKRF502 - CHECK AUDIT DEPT'                   09408072
094090                             TO DP013-MESSAGE-TEXT(1)             09409072
094100             MOVE SU001-OPER-UNT-ID                               09410072
094110                             TO DP013-MESSAGE-TEXT(2)             09411072
094120             MOVE PV-DEPT-NUMBER                                  09412073
094130                             TO DP013-MESSAGE-TEXT(3)             09413072
094140             MOVE SQLCA      TO DP013-SQLCA                       09414072
094150             MOVE 'WST_INTGRTN_TYP'                               09415072
094160                             TO DP013-DB2-TABLE-NAME(1)           09416072
094170             MOVE 'WST_ATTR_DEFN'                                 09417072
094180                             TO DP013-DB2-TABLE-NAME(2)           09418072
094190             MOVE 'WST_ATTR_ELEM'                                 09419072
094200                             TO DP013-DB2-TABLE-NAME(3)           09420072
094210             SET DP013-DB2-ABEND                                  09421072
094220                             TO TRUE                              09422072
094230             SET DP013-ROLLBACK                                   09423072
094240                             TO TRUE                              09424072
094250             SET DP013-XCTL-DISPLAY-RESTART                       09425072
094260                             TO TRUE                              09426072
094270             PERFORM DP014-0000-PROCESS-ABEND                     09427072
094280     END-EVALUATE.                                                09428072
094290                                                                  09429072
094300*----------------------------------------------------------------*09430040
094310*  CALL TO RFID AUDIT MODULE TO CHECK CARTON AUDIT STATUS        *09431040
094320*----------------------------------------------------------------*09432040
094330 6030-CHECK-FOR-RFID-AUDIT.                                       09433040
094340                                                                  09434040
094350      SET  SU021-CARTON-CHECK-IN                                  09435040
094360           SU021-RFID-AUDIT-IS-COMPLETE  TO TRUE.                 09436040
094370      MOVE SU001-PROMPT-IND    TO SU021-DEFERRED-AUDIT-IND.       09437040
094380      MOVE +0              TO SU021-DRIVER-LINE-NBR               09438040
094390                                  SU021-PRE-PACK-ID               09439040
094400                                  SU001-PRE-PACK-ID.              09440040
094410      MOVE PC-RF               TO SU021-PACKAGE-TYPE-CODE.        09441040
094420      MOVE SU001-PO            TO SU021-PO-NUMBER                 09442006
094430      MOVE SU001-PO-LINE-NBR   TO SU021-LINE-NBR                  09443006
094440                                     RECITM-PREPK-ID              09444006
094450      MOVE SU001-OPER-UNT-ID   TO SU021-OPER-UNT-ID               09445006
094460      MOVE SU001-RCVR-SEQ-NBR  TO SU021-REC-SEQ-NBR               09446006
094470      MOVE SU001-MANIFEST      TO SU021-INBOUND-TRIP-ID           09447006
094480      MOVE SU001-CARTON        TO SU021-SHIPT-UNT-ID              09448006
094490      MOVE SU001-USER-ID       TO SU021-USER-ID                   09449006
094500      PERFORM 7265-LINK-SUKCS720.                                 09450006
094510*                                                                 09451006
094520      IF PV-TEST-CICS OR PV-QA-CICS                               09452006
094530            MOVE SPACE TO PV-CICS-MSG-AREA-A                      09453006
094540            MOVE SU021-AUDIT-NUMBER TO PV-AUDIT                   09454006
094550            MOVE SU021-RFID-AUDIT-NUMBER TO PV-AUDITR             09455006
094560            MOVE SU001-CARTON TO PV-CARTON-CNT18                  09456006
094570            STRING ' 502: 720- '                                  09457006
094580             ' AUD-NO='                                           09458006
094590               PV-AUDIT                                           09459006
094600             ' RAUD-NO='                                          09460006
094610               PV-AUDITR                                          09461006
094620             ' CN ='                                              09462006
094630             PV-CARTON-CNT18                                      09463006
094640             ' SW ='                                              09464006
094650             SU021-AUDIT-VALIDATION-SW                            09465006
094660             ' RSW='                                              09466006
094670             SU021-RFID-AUDIT-VALIDATION-SW                       09467006
094680            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             09468006
094690            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     09469006
094700                                            TO PV-COMMAREA-LENGTH 09470006
094710            EXEC CICS WRITEQ TD                                   09471006
094720                      QUEUE('CSSL')                               09472006
094730                      FROM(PV-CICS-MSG-AREA-A)                    09473006
094740                      LENGTH(PV-COMMAREA-LENGTH)                  09474006
094750                      RESP (PV-CICS-RESPONSE)                     09475006
094760            END-EXEC                                              09476006
094770      END-IF.                                                     09477006
094780                                                                  09478006
094790      IF SU021-AUDIT-NUMBER > 0 AND SU021-AUDIT-REQUIRED          09479006
094800*        CONTINUE TO USE QC AUDIT NUMBER                          09480006
094810         CONTINUE                                                 09481006
094820      ELSE                                                        09482006
094830         MOVE SU021-RFID-AUDIT-NUMBER TO SU001-AUDIT-CNTL-NBR     09483006
094840      END-IF.                                                     09484006
094850                                                                  09485006
094860*CLP 10/24/13 - END     PR#5148D                                  09486006
094870                                                                  09487006
094880* CALL SUKUT129 DIRECTIVE GENERATOR                               09488006
094890 6100-CALL-DIRECTIVE-GEN-129.                                     09489006
094900                                                                  09490006
094910     INSPECT SU090-DG-REQUEST-COMMAREA                            09491006
094920         REPLACING ALL LOW-VALUES BY '?'.                         09492006
094930                                                                  09493006
094940     MOVE PC-CURRENT-PROGRAM-NAME TO SU090-CALLING-PGM.           09494006
094950     CALL SU090-DIRV-GEN-PGM   USING DFHEIBLK                     09495006
094960                                     SU090-COMMAREA               09496006
094970                                     SU090-DG-REQUEST-COMMAREA.   09497006
094980     EVALUATE TRUE                                                09498006
094990       WHEN SU090-SUCCESS                                         09499006
095000           CONTINUE                                               09500006
095010       WHEN OTHER                                                 09501006
095020            SET PS-PROCESSING-ERROR-YES TO TRUE                   09502006
095030            EVALUATE TRUE                                         09503006
095040               WHEN SU090-PARAMETER-ERROR                         09504006
095050                  PERFORM 6110-DIRV-GEN-PARM-ERROR                09505006
095060               WHEN SU090-DB2-ERROR                               09506006
095070                  PERFORM 6120-DIRV-GEN-DB2-ERROR                 09507006
095080               WHEN SU090-MQ-ERROR                                09508006
095090                  PERFORM 6130-DIRV-GEN-MQ-ERROR                  09509006
095100               WHEN SU090-OTHER-ERROR                             09510006
095110                  PERFORM 6140-DIRV-GEN-OTHER-ERROR               09511006
095120            END-EVALUATE                                          09512006
095130     END-EVALUATE.                                                09513006
095140                                                                  09514006
095150* CT 11/06/08 END                                                 09515006
095160                                                                  09516006
095170* DM 11/28/08 BEGIN                                               09517006
095180                                                                  09518006
095190 6110-DIRV-GEN-PARM-ERROR.                                        09519006
095200                                                                  09520006
095210**** WRITE AN ERROR MESSAGE TO THE CSSL                           09521006
095220                                                                  09522006
095230     MOVE LENGTH OF PV-CICS-MSG-AREA-A TO PV-COMMAREA-LENGTH.     09523006
095240                                                                  09524006
095250     INITIALIZE                           PV-CICS-MSG-AREA-A.     09525006
095260     STRING PC-CURRENT-PROGRAM-NAME DELIMITED BY SIZE             09526006
095270            ' '                     DELIMITED BY SIZE             09527006
095280            '6100-CALL-DIRECTIVE-GEN-129'                         09528006
095290                                    DELIMITED BY SIZE             09529006
095300                                     INTO PV-CICS-MSG-AREA-B      09530006
095310     END-STRING.                                                  09531006
095320     PERFORM 9998-WRITE-TO-CSSL.                                  09532006
095330                                                                  09533006
095340     INITIALIZE                           PV-CICS-MSG-AREA-A.     09534006
095350     MOVE 'DIRECTIVE GENERATOR PARAMENTER ERROR.'                 09535006
095360                                       TO PV-CICS-MSG-AREA-B.     09536006
095370     PERFORM 9998-WRITE-TO-CSSL.                                  09537006
095380                                                                  09538006
095390     PERFORM 6190-WRITE-DG-COMM-AREA.                             09539006
095400                                                                  09540006
095410**** WRITE AN ERROR MESSAGE TO THE CICS LOG                       09541006
095420                                                                  09542006
095430     SET  DP013-LOGIC-ABEND             TO TRUE.                  09543006
095440     SET  DP013-NO-ROLLBACK             TO TRUE.                  09544006
095450     MOVE PC-CURRENT-PROGRAM-NAME       TO DP013-PROGRAM.         09545006
095460     MOVE '6100-CALL-DIRECTIVE-GEN-129' TO DP013-PARAGRAPH.       09546006
095470     MOVE 'ERROR IN DIRECTIVE GENERATOR.'                         09547006
095480                                        TO DP013-MESSAGE-TEXT(1). 09548006
095490     MOVE 'DIRECTIVE GENERATOR PARM ERROR.'                       09549006
095500                                        TO DP013-MESSAGE-TEXT(2). 09550006
095510     MOVE 'CHECK CSSL FOR MORE DETAIL.   '                        09551006
095520                                        TO DP013-MESSAGE-TEXT(3). 09552006
095530                                                                  09553006
095540     MOVE  SU090-SML-BRCDE-NBR TO PV-DISPLAY-CARTON.              09554006
095550     MOVE  SU090-PO-NBR        TO PV-DISPLAY-PO.                  09555006
095560     MOVE  SU090-RCVR-SEQ-NBR  TO PV-DISPLAY-PO-RCVR.             09556006
095570     MOVE  SU090-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR.          09557006
095580                                                                  09558006
095590     STRING '  CARTON - '         DELIMITED BY SIZE               09559006
095600            PV-DISPLAY-CARTON     DELIMITED BY SIZE               09560006
095610            ' '                   DELIMITED BY SIZE               09561006
095620            'PO, RCVR, LINE, AUDIT -'                             09562006
095630                                  DELIMITED BY SIZE               09563006
095640            ' '                   DELIMITED BY SIZE               09564006
095650            PV-DISPLAY-PO         DELIMITED BY SIZE               09565006
095660            ', '                  DELIMITED BY SIZE               09566006
095670            PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE               09567006
095680            ', '                  DELIMITED BY SIZE               09568006
095690            PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE               09569006
095700            ', '                  DELIMITED BY SIZE               09570006
095710            SU090-AUD-CNTL-NBR    DELIMITED BY SIZE               09571006
095720                             INTO DP013-MESSAGE-TEXT(4)           09572006
095730     END-STRING.                                                  09573006
095740                                                                  09574006
095750     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG.                      09575006
095760                                                                  09576006
095770 6120-DIRV-GEN-DB2-ERROR.                                         09577006
095780                                                                  09578006
095790     MOVE LENGTH OF PV-CICS-MSG-AREA-A TO PV-COMMAREA-LENGTH.     09579006
095800                                                                  09580006
095810     INITIALIZE                           PV-CICS-MSG-AREA-A.     09581006
095820     STRING PC-CURRENT-PROGRAM-NAME DELIMITED BY SIZE             09582006
095830            ' '                     DELIMITED BY SIZE             09583006
095840            '6100-CALL-DIRECTIVE-GEN-129'                         09584006
095850                                    DELIMITED BY SIZE             09585006
095860                                     INTO PV-CICS-MSG-AREA-B      09586006
095870     END-STRING.                                                  09587006
095880     PERFORM 9998-WRITE-TO-CSSL.                                  09588006
095890                                                                  09589006
095900     INITIALIZE                           PV-CICS-MSG-AREA-A.     09590006
095910     MOVE 'ERROR PUTTING DIRECTIVE TO DB2.'                       09591006
095920                                       TO PV-CICS-MSG-AREA-B.     09592006
095930     PERFORM 9998-WRITE-TO-CSSL.                                  09593006
095940                                                                  09594006
095950     INITIALIZE                           PV-CICS-MSG-AREA-A.     09595006
095960     MOVE SU090-SQLCODE                TO PV-DISPLAY-SQLCODE.     09596006
095970     STRING 'DB2-SQL-CODE    = '    DELIMITED BY SIZE             09597006
095980            PV-DISPLAY-SQLCODE      DELIMITED BY SIZE             09598006
095990                                     INTO PV-CICS-MSG-AREA-B      09599006
096000     END-STRING.                                                  09600006
096010     PERFORM 9998-WRITE-TO-CSSL.                                  09601006
096020                                                                  09602006
096030     PERFORM 6190-WRITE-DG-COMM-AREA.                             09603006
096040                                                                  09604006
096050**** WRITE AN ERROR MESSAGE TO THE CICS LOG                       09605006
096060                                                                  09606006
096070     SET  DP013-LOGIC-ABEND             TO TRUE.                  09607006
096080     SET  DP013-NO-ROLLBACK             TO TRUE.                  09608006
096090     MOVE PC-CURRENT-PROGRAM-NAME       TO DP013-PROGRAM.         09609006
096100     MOVE '6100-CALL-DIRECTIVE-GEN-129' TO DP013-PARAGRAPH.       09610006
096110     MOVE 'ERROR IN DIRECTIVE GENERATOR.'                         09611006
096120                                        TO DP013-MESSAGE-TEXT(1). 09612006
096130     MOVE 'DIRECTIVE GENERATOR DB2 ERROR.'                        09613006
096140                                        TO DP013-MESSAGE-TEXT(2). 09614006
096150     MOVE 'CHECK CSSL FOR MORE DETAIL.   '                        09615006
096160                                        TO DP013-MESSAGE-TEXT(3). 09616006
096170                                                                  09617006
096180     MOVE  SU090-SML-BRCDE-NBR TO PV-DISPLAY-CARTON.              09618006
096190     MOVE  SU090-PO-NBR        TO PV-DISPLAY-PO.                  09619006
096200     MOVE  SU090-RCVR-SEQ-NBR  TO PV-DISPLAY-PO-RCVR.             09620006
096210     MOVE  SU090-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR.          09621006
096220                                                                  09622006
096230     STRING '  CARTON - '         DELIMITED BY SIZE               09623006
096240            PV-DISPLAY-CARTON     DELIMITED BY SIZE               09624006
096250            ' '                   DELIMITED BY SIZE               09625006
096260            'PO, RCVR, LINE, AUDIT -'                             09626006
096270                                  DELIMITED BY SIZE               09627006
096280            ' '                   DELIMITED BY SIZE               09628006
096290            PV-DISPLAY-PO         DELIMITED BY SIZE               09629006
096300            ', '                  DELIMITED BY SIZE               09630006
096310            PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE               09631006
096320            ', '                  DELIMITED BY SIZE               09632006
096330            PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE               09633006
096340            ', '                  DELIMITED BY SIZE               09634006
096350            SU090-AUD-CNTL-NBR    DELIMITED BY SIZE               09635006
096360                             INTO DP013-MESSAGE-TEXT(4)           09636006
096370     END-STRING.                                                  09637006
096380                                                                  09638006
096390     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG.                      09639006
096400                                                                  09640006
096410 6130-DIRV-GEN-MQ-ERROR.                                          09641006
096420                                                                  09642006
096430**** WRITE AN ERROR MESSAGE TO THE CSSL                           09643006
096440                                                                  09644006
096450     MOVE LENGTH OF PV-CICS-MSG-AREA-A TO PV-COMMAREA-LENGTH.     09645006
096460                                                                  09646006
096470     INITIALIZE                           PV-CICS-MSG-AREA-A.     09647006
096480     STRING PC-CURRENT-PROGRAM-NAME DELIMITED BY SIZE             09648006
096490            ' '                     DELIMITED BY SIZE             09649006
096500            '6100-CALL-DIRECTIVE-GEN-129'                         09650006
096510                                    DELIMITED BY SIZE             09651006
096520                                     INTO PV-CICS-MSG-AREA-B      09652006
096530     END-STRING.                                                  09653006
096540     PERFORM 9998-WRITE-TO-CSSL.                                  09654006
096550                                                                  09655006
096560     INITIALIZE                           PV-CICS-MSG-AREA-A.     09656006
096570     MOVE 'ERROR PUTTING DIRECTIVE TO MQ.' TO PV-CICS-MSG-AREA-B. 09657006
096580     PERFORM 9998-WRITE-TO-CSSL.                                  09658006
096590                                                                  09659006
096600     INITIALIZE                           PV-CICS-MSG-AREA-A.     09660006
096610     MOVE SU090-MQ-COND-CODE           TO PV-DISPLAY-SQLCODE.     09661006
096620     STRING 'MQ-COND-CODE    = '    DELIMITED BY SIZE             09662006
096630            PV-DISPLAY-SQLCODE      DELIMITED BY SIZE             09663006
096640                                     INTO PV-CICS-MSG-AREA-B      09664006
096650     END-STRING.                                                  09665006
096660     PERFORM 9998-WRITE-TO-CSSL.                                  09666006
096670                                                                  09667006
096680     INITIALIZE                           PV-CICS-MSG-AREA-A.     09668006
096690     MOVE SU090-MQ-REAS-CODE           TO PV-DISPLAY-SQLCODE.     09669006
096700     STRING 'MQ-REAS-CODE    = '    DELIMITED BY SIZE             09670006
096710            PV-DISPLAY-SQLCODE      DELIMITED BY SIZE             09671006
096720                                     INTO PV-CICS-MSG-AREA-B      09672006
096730     END-STRING.                                                  09673006
096740     PERFORM 9998-WRITE-TO-CSSL.                                  09674006
096750                                                                  09675006
096760     INITIALIZE                           PV-CICS-MSG-AREA-A.     09676006
096770     STRING 'MQ-REAS-TXT     = '    DELIMITED BY SIZE             09677006
096780            SU090-MQ-REAS-TXT       DELIMITED BY SIZE             09678006
096790                                     INTO PV-CICS-MSG-AREA-B      09679006
096800     END-STRING.                                                  09680006
096810     PERFORM 9998-WRITE-TO-CSSL.                                  09681006
096820                                                                  09682006
096830     PERFORM 6190-WRITE-DG-COMM-AREA.                             09683006
096840                                                                  09684006
096850**** WRITE AN ERROR MESSAGE TO THE CICS LOG                       09685006
096860                                                                  09686006
096870     SET  DP013-LOGIC-ABEND             TO TRUE.                  09687006
096880     SET  DP013-NO-ROLLBACK             TO TRUE.                  09688006
096890     MOVE PC-CURRENT-PROGRAM-NAME       TO DP013-PROGRAM.         09689006
096900     MOVE '6100-CALL-DIRECTIVE-GEN-129' TO DP013-PARAGRAPH.       09690006
096910     MOVE 'ERROR IN DIRECTIVE GENERATOR.'                         09691006
096920                                        TO DP013-MESSAGE-TEXT(1). 09692006
096930     MOVE 'DIRECTIVE GENERATOR MQ ERROR.'                         09693006
096940                                        TO DP013-MESSAGE-TEXT(2). 09694006
096950     MOVE 'CHECK CSSL FOR MORE DETAIL.   '                        09695006
096960                                        TO DP013-MESSAGE-TEXT(3). 09696006
096970                                                                  09697006
096980     MOVE  SU090-SML-BRCDE-NBR TO PV-DISPLAY-CARTON.              09698006
096990     MOVE  SU090-PO-NBR        TO PV-DISPLAY-PO.                  09699006
097000     MOVE  SU090-RCVR-SEQ-NBR  TO PV-DISPLAY-PO-RCVR.             09700006
097010     MOVE  SU090-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR.          09701006
097020                                                                  09702006
097030     STRING '  CARTON - '         DELIMITED BY SIZE               09703006
097040            PV-DISPLAY-CARTON     DELIMITED BY SIZE               09704006
097050            ' '                   DELIMITED BY SIZE               09705006
097060            'PO, RCVR, LINE, AUDIT -'                             09706006
097070                                  DELIMITED BY SIZE               09707006
097080            ' '                   DELIMITED BY SIZE               09708006
097090            PV-DISPLAY-PO         DELIMITED BY SIZE               09709006
097100            ', '                  DELIMITED BY SIZE               09710006
097110            PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE               09711006
097120            ', '                  DELIMITED BY SIZE               09712006
097130            PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE               09713006
097140            ', '                  DELIMITED BY SIZE               09714006
097150            SU090-AUD-CNTL-NBR    DELIMITED BY SIZE               09715006
097160                             INTO DP013-MESSAGE-TEXT(4)           09716006
097170     END-STRING.                                                  09717006
097180                                                                  09718006
097190     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG.                      09719006
097200                                                                  09720006
097210 6140-DIRV-GEN-OTHER-ERROR.                                       09721006
097220                                                                  09722006
097230**** WRITE AN ERROR MESSAGE TO THE CSSL                           09723006
097240                                                                  09724006
097250     MOVE LENGTH OF PV-CICS-MSG-AREA-A TO PV-COMMAREA-LENGTH.     09725006
097260                                                                  09726006
097270     INITIALIZE                           PV-CICS-MSG-AREA-A.     09727006
097280     STRING PC-CURRENT-PROGRAM-NAME DELIMITED BY SIZE             09728006
097290            ' '                     DELIMITED BY SIZE             09729006
097300            '6100-CALL-DIRECTIVE-GEN-129'                         09730006
097310                                    DELIMITED BY SIZE             09731006
097320                                     INTO PV-CICS-MSG-AREA-B      09732006
097330     END-STRING.                                                  09733006
097340     PERFORM 9998-WRITE-TO-CSSL.                                  09734006
097350                                                                  09735006
097360     INITIALIZE                           PV-CICS-MSG-AREA-A.     09736006
097370     MOVE 'UNKNOWN ERROR.'             TO PV-CICS-MSG-AREA-B.     09737006
097380     PERFORM 9998-WRITE-TO-CSSL.                                  09738006
097390                                                                  09739006
097400     PERFORM 6190-WRITE-DG-COMM-AREA.                             09740006
097410                                                                  09741006
097420**** WRITE AN ERROR MESSAGE TO THE CICS LOG                       09742006
097430                                                                  09743006
097440     SET  DP013-LOGIC-ABEND             TO TRUE.                  09744006
097450     SET  DP013-NO-ROLLBACK             TO TRUE.                  09745006
097460     MOVE PC-CURRENT-PROGRAM-NAME       TO DP013-PROGRAM.         09746006
097470     MOVE '6100-CALL-DIRECTIVE-GEN-129' TO DP013-PARAGRAPH.       09747006
097480     MOVE 'ERROR IN DIRECTIVE GENERATOR.'                         09748006
097490                                        TO DP013-MESSAGE-TEXT(1). 09749006
097500     MOVE 'DIRECTIVE GENERATOR MQ ERROR.'                         09750006
097510                                        TO DP013-MESSAGE-TEXT(2). 09751006
097520     MOVE 'CHECK CSSL FOR MORE DETAIL.   '                        09752006
097530                                        TO DP013-MESSAGE-TEXT(3). 09753006
097540                                                                  09754006
097550     MOVE  SU090-SML-BRCDE-NBR TO PV-DISPLAY-CARTON.              09755006
097560     MOVE  SU090-PO-NBR        TO PV-DISPLAY-PO.                  09756006
097570     MOVE  SU090-RCVR-SEQ-NBR  TO PV-DISPLAY-PO-RCVR.             09757006
097580     MOVE  SU090-PO-LNE-NBR    TO PV-DISPLAY-PO-LNE-NBR.          09758006
097590                                                                  09759006
097600     STRING '  CARTON - '         DELIMITED BY SIZE               09760006
097610            PV-DISPLAY-CARTON     DELIMITED BY SIZE               09761006
097620            ' '                   DELIMITED BY SIZE               09762006
097630            'PO, RCVR, LINE, AUDIT -'                             09763006
097640                                  DELIMITED BY SIZE               09764006
097650            ' '                   DELIMITED BY SIZE               09765006
097660            PV-DISPLAY-PO         DELIMITED BY SIZE               09766006
097670            ', '                  DELIMITED BY SIZE               09767006
097680            PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE               09768006
097690            ', '                  DELIMITED BY SIZE               09769006
097700            PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE               09770006
097710            ', '                  DELIMITED BY SIZE               09771006
097720            SU090-AUD-CNTL-NBR    DELIMITED BY SIZE               09772006
097730                             INTO DP013-MESSAGE-TEXT(4)           09773006
097740     END-STRING.                                                  09774006
097750                                                                  09775006
097760     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG.                      09776006
097770                                                                  09777006
097780 6190-WRITE-DG-COMM-AREA.                                         09778006
097790                                                                  09779006
097800     INITIALIZE                           PV-CICS-MSG-AREA-A.     09780006
097810     MOVE 'DIRECTIVE GENERATOR COMMUNICATION AREA:'               09781006
097820                                       TO PV-CICS-MSG-AREA-B      09782006
097830     PERFORM 9998-WRITE-TO-CSSL.                                  09783006
097840                                                                  09784006
097850     INITIALIZE                           PV-CICS-MSG-AREA-A.     09785006
097860     STRING 'SU090-ERR-PROGRAM       = '       DELIMITED BY SIZE  09786006
097870             SU090-ERR-PROGRAM                 DELIMITED BY SIZE  09787006
097880                                     INTO PV-CICS-MSG-AREA-B      09788006
097890     END-STRING.                                                  09789006
097900     PERFORM 9998-WRITE-TO-CSSL.                                  09790006
097910                                                                  09791006
097920     INITIALIZE                           PV-CICS-MSG-AREA-A.     09792006
097930     STRING 'SU090-ERR-PARAGRAPH     = '       DELIMITED BY SIZE  09793006
097940             SU090-ERR-PARAGRAPH               DELIMITED BY SIZE  09794006
097950                                     INTO PV-CICS-MSG-AREA-B      09795006
097960     END-STRING.                                                  09796006
097970     PERFORM 9998-WRITE-TO-CSSL.                                  09797006
097980                                                                  09798006
097990     INITIALIZE                           PV-CICS-MSG-AREA-A.     09799006
098000     STRING 'SU090-BATCH-ONLINE-IND  = '       DELIMITED BY SIZE  09800006
098010             SU090-BATCH-ONLINE-IND            DELIMITED BY SIZE  09801006
098020                                     INTO PV-CICS-MSG-AREA-B      09802006
098030     END-STRING.                                                  09803006
098040     PERFORM 9998-WRITE-TO-CSSL.                                  09804006
098050                                                                  09805006
098060     INITIALIZE                           PV-CICS-MSG-AREA-A.     09806006
098070     STRING 'SU090-OPER-UNT-ID       = '       DELIMITED BY SIZE  09807006
098080             SU090-OPER-UNT-ID                 DELIMITED BY SIZE  09808006
098090                                     INTO PV-CICS-MSG-AREA-B      09809006
098100     END-STRING.                                                  09810006
098110     PERFORM 9998-WRITE-TO-CSSL.                                  09811006
098120                                                                  09812006
098130     INITIALIZE                           PV-CICS-MSG-AREA-A.     09813006
098140     STRING 'SU090-ACTN-CDE          = '       DELIMITED BY SIZE  09814006
098150             SU090-ACTN-CDE                    DELIMITED BY SIZE  09815006
098160                                     INTO PV-CICS-MSG-AREA-B      09816006
098170     END-STRING.                                                  09817006
098180     PERFORM 9998-WRITE-TO-CSSL.                                  09818006
098190                                                                  09819006
098200     INITIALIZE                           PV-CICS-MSG-AREA-A.     09820006
098210     STRING 'SU090-DIRECTIVE-LVL-CDE = '       DELIMITED BY SIZE  09821006
098220             SU090-DIRECTIVE-LVL-CDE           DELIMITED BY SIZE  09822006
098230                                     INTO PV-CICS-MSG-AREA-B      09823006
098240     END-STRING.                                                  09824006
098250     PERFORM 9998-WRITE-TO-CSSL.                                  09825006
098260                                                                  09826006
098270     INITIALIZE                           PV-CICS-MSG-AREA-A.     09827006
098280     STRING 'SU090-DIRV-RSN-CDE      = '       DELIMITED BY SIZE  09828006
098290             SU090-DIRV-RSN-CDE                DELIMITED BY SIZE  09829006
098300                                     INTO PV-CICS-MSG-AREA-B      09830006
098310     END-STRING.                                                  09831006
098320     PERFORM 9998-WRITE-TO-CSSL.                                  09832006
098330                                                                  09833006
098340     INITIALIZE                           PV-CICS-MSG-AREA-A.     09834006
098350     STRING 'SU090-BRCDE-TYP-CDE     = '       DELIMITED BY SIZE  09835006
098360             SU090-BRCDE-TYP-CDE               DELIMITED BY SIZE  09836006
098370                                     INTO PV-CICS-MSG-AREA-B      09837006
098380     END-STRING.                                                  09838006
098390     PERFORM 9998-WRITE-TO-CSSL.                                  09839006
098400                                                                  09840006
098410     INITIALIZE                           PV-CICS-MSG-AREA-A.     09841006
098420     STRING 'SU090-SML-BRCDE-NBR     = '       DELIMITED BY SIZE  09842006
098430             SU090-SML-BRCDE-NBR               DELIMITED BY SIZE  09843006
098440                                     INTO PV-CICS-MSG-AREA-B      09844006
098450     END-STRING.                                                  09845006
098460     PERFORM 9998-WRITE-TO-CSSL.                                  09846006
098470                                                                  09847006
098480     INITIALIZE                           PV-CICS-MSG-AREA-A.     09848006
098490     STRING 'SU090-P2L-BRCDE-NBR     = '       DELIMITED BY SIZE  09849006
098500             SU090-P2L-BRCDE-NBR               DELIMITED BY SIZE  09850006
098510                                     INTO PV-CICS-MSG-AREA-B      09851006
098520     END-STRING.                                                  09852006
098530     PERFORM 9998-WRITE-TO-CSSL.                                  09853006
098540                                                                  09854006
098550     INITIALIZE                           PV-CICS-MSG-AREA-A.     09855006
098560     STRING 'SU090-PO-NBR            = '       DELIMITED BY SIZE  09856006
098570             SU090-PO-NBR                      DELIMITED BY SIZE  09857006
098580                                     INTO PV-CICS-MSG-AREA-B      09858006
098590     END-STRING.                                                  09859006
098600     PERFORM 9998-WRITE-TO-CSSL.                                  09860006
098610                                                                  09861006
098620     INITIALIZE                           PV-CICS-MSG-AREA-A.     09862006
098630     STRING 'SU090-PO-LNE-NBR        = '       DELIMITED BY SIZE  09863006
098640             SU090-PO-LNE-NBR                  DELIMITED BY SIZE  09864006
098650                                     INTO PV-CICS-MSG-AREA-B      09865006
098660     END-STRING.                                                  09866006
098670     PERFORM 9998-WRITE-TO-CSSL.                                  09867006
098680                                                                  09868006
098690     INITIALIZE                           PV-CICS-MSG-AREA-A.     09869006
098700     STRING 'SU090-PO-PREPK-ID       = '       DELIMITED BY SIZE  09870006
098710             SU090-PO-PREPK-ID                 DELIMITED BY SIZE  09871006
098720                                     INTO PV-CICS-MSG-AREA-B      09872006
098730     END-STRING.                                                  09873006
098740     PERFORM 9998-WRITE-TO-CSSL.                                  09874006
098750                                                                  09875006
098760     INITIALIZE                           PV-CICS-MSG-AREA-A.     09876006
098770     STRING 'SU090-RCVR-SEQ-NBR      = '       DELIMITED BY SIZE  09877006
098780             SU090-RCVR-SEQ-NBR                DELIMITED BY SIZE  09878006
098790                                     INTO PV-CICS-MSG-AREA-B      09879006
098800     END-STRING.                                                  09880006
098810     PERFORM 9998-WRITE-TO-CSSL.                                  09881006
098820                                                                  09882006
098830     INITIALIZE                           PV-CICS-MSG-AREA-A.     09883006
098840     STRING 'SU090-CASI-CDE          = '       DELIMITED BY SIZE  09884006
098850             SU090-CASI-CDE                    DELIMITED BY SIZE  09885006
098860                                     INTO PV-CICS-MSG-AREA-B      09886006
098870     END-STRING.                                                  09887006
098880     PERFORM 9998-WRITE-TO-CSSL.                                  09888006
098890                                                                  09889006
098900     INITIALIZE                           PV-CICS-MSG-AREA-A.     09890006
098910     STRING 'SU090-CART-STAT-CDE     = '       DELIMITED BY SIZE  09891006
098920             SU090-CART-STAT-CDE               DELIMITED BY SIZE  09892006
098930                                     INTO PV-CICS-MSG-AREA-B      09893006
098940     END-STRING.                                                  09894006
098950     PERFORM 9998-WRITE-TO-CSSL.                                  09895006
098960                                                                  09896006
098970     INITIALIZE                           PV-CICS-MSG-AREA-A.     09897006
098980     STRING 'SU090-AUD-CNTL-NBR      = '       DELIMITED BY SIZE  09898006
098990             SU090-AUD-CNTL-NBR                DELIMITED BY SIZE  09899006
099000                                     INTO PV-CICS-MSG-AREA-B      09900006
099010     END-STRING.                                                  09901006
099020     PERFORM 9998-WRITE-TO-CSSL.                                  09902006
099030                                                                  09903006
099040     INITIALIZE                           PV-CICS-MSG-AREA-A.     09904006
099050     STRING 'SU090-AUD-STAT-CDE      = '       DELIMITED BY SIZE  09905006
099060             SU090-AUD-STAT-CDE                DELIMITED BY SIZE  09906006
099070                                     INTO PV-CICS-MSG-AREA-B      09907006
099080     END-STRING.                                                  09908006
099090     PERFORM 9998-WRITE-TO-CSSL.                                  09909006
099100                                                                  09910006
099110     INITIALIZE                           PV-CICS-MSG-AREA-A.     09911006
099120     STRING 'SU090-AUD-FAIL-RSN      = '       DELIMITED BY SIZE  09912006
099130             SU090-AUD-FAIL-RSN                DELIMITED BY SIZE  09913006
099140                                     INTO PV-CICS-MSG-AREA-B      09914006
099150     END-STRING.                                                  09915006
099160     PERFORM 9998-WRITE-TO-CSSL.                                  09916006
099170                                                                  09917006
099180     INITIALIZE                           PV-CICS-MSG-AREA-A.     09918006
099190     STRING 'SU090-STR-ZN            = '       DELIMITED BY SIZE  09919006
099200             SU090-STR-ZN                      DELIMITED BY SIZE  09920006
099210                                     INTO PV-CICS-MSG-AREA-B      09921006
099220     END-STRING.                                                  09922006
099230     PERFORM 9998-WRITE-TO-CSSL.                                  09923006
099240                                                                  09924006
099250     INITIALIZE                           PV-CICS-MSG-AREA-A.     09925006
099260     STRING 'SU090-SEASET-YR         = '       DELIMITED BY SIZE  09926006
099270             SU090-SEASET-YR                   DELIMITED BY SIZE  09927006
099280                                     INTO PV-CICS-MSG-AREA-B      09928006
099290     END-STRING.                                                  09929006
099300     MOVE LENGTH OF PV-CICS-MSG-AREA-A                            09930006
099310                                     TO PV-COMMAREA-LENGTH.       09931006
099320     PERFORM 9998-WRITE-TO-CSSL.                                  09932006
099330                                                                  09933006
099340     INITIALIZE                           PV-CICS-MSG-AREA-A.     09934006
099350     STRING 'SU090-SEASET-CDE        = '       DELIMITED BY SIZE  09935006
099360             SU090-SEASET-CDE                  DELIMITED BY SIZE  09936006
099370                                     INTO PV-CICS-MSG-AREA-B      09937006
099380     END-STRING.                                                  09938006
099390     MOVE LENGTH OF PV-CICS-MSG-AREA-A                            09939006
099400                                     TO PV-COMMAREA-LENGTH.       09940006
099410     PERFORM 9998-WRITE-TO-CSSL.                                  09941006
099420                                                                  09942006
099430     INITIALIZE                           PV-CICS-MSG-AREA-A.     09943006
099440     STRING 'SU090-STR-NBR           = '       DELIMITED BY SIZE  09944006
099450             SU090-STR-NBR                     DELIMITED BY SIZE  09945006
099460                                     INTO PV-CICS-MSG-AREA-B      09946006
099470     END-STRING.                                                  09947006
099480     MOVE LENGTH OF PV-CICS-MSG-AREA-A                            09948006
099490                                     TO PV-COMMAREA-LENGTH.       09949006
099500     PERFORM 9998-WRITE-TO-CSSL.                                  09950006
099510                                                                  09951006
099520     INITIALIZE                           PV-CICS-MSG-AREA-A.     09952006
099530     STRING 'SU090-ASSOC-ID          = '       DELIMITED BY SIZE  09953006
099540             SU090-ASSOC-ID                    DELIMITED BY SIZE  09954006
099550                                     INTO PV-CICS-MSG-AREA-B      09955006
099560     END-STRING.                                                  09956006
099570     MOVE LENGTH OF PV-CICS-MSG-AREA-A                            09957006
099580                                     TO PV-COMMAREA-LENGTH.       09958006
099590     PERFORM 9998-WRITE-TO-CSSL.                                  09959006
099600                                                                  09960006
099610* DM 11/28/08 END                                                 09961006
099620                                                                  09962006
100390                                                                  10039006
100400 6400-DETERMINE-HANG-FOLD.                                        10040006
100410      INITIALIZE PV-HNG-FOLD-SEQ-NBR                              10041006
100420                 PV-PREV-HANG-FOLD-IND                            10042006
100430                 PV-HANG-FOLD-IND.                                10043006
100440                                                                  10044006
100450      SET PS-NOT-EO-HANG-FOLD-CSR                                 10045006
100460          PS-NOT-HANG-FOLD-MIXED                                  10046006
100470          PS-FIRST-UPC-CALL                                       10047006
100480          PS-HANG-FOLD-IND-FOUND-NO                               10048006
100490          PS-EAS-TAG-IND-FOUND-NO  TO TRUE                        10049006
100500                                                                  10050006
100510      PERFORM 6450-OPEN-HANG-FOLD-CSR                             10051006
100520      PERFORM 6500-FETCH-HANG-FOLD-CSR                            10052006
100530        UNTIL PS-EO-HANG-FOLD-CSR OR                              10053006
100540              PS-HANG-FOLD-MIXED                                  10054006
100550      PERFORM 6550-CLOSE-HANG-FOLD-CSR.                           10055006
100560                                                                  10056006
100570******************************************************************10057006
100580 6450-OPEN-HANG-FOLD-CSR.                                         10058006
100590                                                                  10059006
100600         EXEC SQL                                                 10060006
100610              OPEN HANG_FOLD_CSR                                  10061006
100620         END-EXEC                                                 10062006
100630                                                                  10063006
100640                                                                  10064006
100650         EVALUATE TRUE                                            10065006
100660             WHEN SQLCODE = ZERO                                  10066006
100670                 CONTINUE                                         10067006
100680             WHEN SQLWARN0 NOT = SPACES                           10068006
100690             WHEN SQLCODE < ZERO                                  10069006
100700             WHEN SQLCODE > ZERO                                  10070006
100710                 MOVE '6450-OPEN-HANG-FOLD-CSR'                   10071006
100720                                   TO DP013-PARAGRAPH             10072006
100730                 MOVE 'OPEN HANG FOLD CSR - '                     10073006
100740                                   TO DP013-MESSAGE-TEXT (1)      10074006
100750                 MOVE SQLCA        TO DP013-SQLCA                 10075006
100760                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    10076006
100770                 SET DP013-DB2-ABEND                              10077006
100780                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10078006
100790                 SET DP013-ROLLBACK                               10079006
100800                                   TO TRUE                        10080006
100810                 PERFORM DP014-0000-PROCESS-ABEND                 10081006
100820         END-EVALUATE.                                            10082006
100830                                                                  10083006
100840 EJECT                                                            10084006
100850*----------------------------------------------------------------*10085006
100860*                                                                *10086006
100870*----------------------------------------------------------------*10087006
100880 6500-FETCH-HANG-FOLD-CSR.                                        10088006
100890                                                                  10089006
100900                                                                  10090006
100910     EXEC SQL                                                     10091006
100920        FETCH   HANG_FOLD_CSR                                     10092006
100930        INTO   :SHUUPC-UPC-NBR                                    10093006
100940             , :SHUUPC-TRN-LNE-NBR                                10094006
100950     END-EXEC.                                                    10095006
100960                                                                  10096006
100970     EVALUATE TRUE                                                10097006
100980       WHEN SQLCODE = ZEROS                                       10098006
100990            PERFORM 7245-CALL-XLKUT-DOMAIN-BY-UPC                 10099006
101000            IF XL001-UPC-NOT-FOUND                                10100006
101010               CONTINUE                                           10101006
101020            ELSE                                                  10102006
101030               IF PS-EAS-TAG-IND-FOUND-NO                         10103006
101040                  MOVE SHUUPC-TRN-LNE-NBR TO PURITM-PO-LNE-NBR    10104006
101050                  PERFORM 7225-SELECT-TPURITM                     10105006
101060                  PERFORM 7233-CHECK-EAS-TAG                      10106006
101070               END-IF                                             10107006
101080                                                                  10108006
101090               IF PS-HANG-FOLD-IND-FOUND-NO                       10109006
101100                  MOVE XL001-HNG-FOLD-CDE TO PV-HANG-FOLD-IND     10110006
101110                  EVALUATE TRUE                                   10111006
101120                    WHEN PV-HANG-FOLD-IND = 'H'                   10112006
101130                       MOVE 1 TO  PV-HNG-FOLD-SEQ-NBR             10113006
101140                       SET PS-HANG-FOLD-IND-FOUND-YES TO TRUE     10114006
101150                    WHEN PV-HANG-FOLD-IND = 'F'                   10115006
101160                       MOVE 2 TO  PV-HNG-FOLD-SEQ-NBR             10116006
101170                       SET PS-HANG-FOLD-IND-FOUND-YES TO TRUE     10117006
101180                    WHEN OTHER                                    10118006
101190                       MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR             10119006
101200                  END-EVALUATE                                    10120006
101210               END-IF                                             10121006
101220                                                                  10122006
101230               IF PS-BRAND-FOUND-NO                               10123006
101240                  PERFORM 7236-CHECK-BRAND                        10124006
101250               END-IF                                             10125006
101260                                                                  10126006
101270               IF PS-EAS-TAG-IND-FOUND-YES AND                    10127006
101280                  PS-HANG-FOLD-IND-FOUND-YES AND                  10128006
101290                  PS-BRAND-FOUND-YES                              10129006
101300                     SET PS-EO-HANG-FOLD-CSR TO TRUE              10130006
101310               END-IF                                             10131006
101320            END-IF                                                10132006
101330                                                                  10133006
101340       WHEN SQLCODE = +100                                        10134006
101350                SET  PS-EO-HANG-FOLD-CSR TO TRUE                  10135006
101360       WHEN OTHER                                                 10136006
101370             MOVE '6500-FETCH-HANG-FOLD-CSR'                      10137006
101380                             TO DP013-PARAGRAPH                   10138006
101390             MOVE 'SUKRF502 - CHECK FOR NOT FOUND       '         10139006
101400                             TO DP013-MESSAGE-TEXT(1)             10140006
101410             MOVE SU001-PO                                        10141006
101420                             TO DP013-MESSAGE-TEXT(2)             10142006
101430             MOVE SU001-CARTON                                    10143006
101440                             TO DP013-MESSAGE-TEXT(3)             10144006
101450             MOVE SQLCA      TO DP013-SQLCA                       10145006
101460             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           10146006
101470             SET DP013-DB2-ABEND                                  10147006
101480                             TO TRUE                              10148006
101490             SET DP013-ROLLBACK                                   10149006
101500                             TO TRUE                              10150006
101510             SET DP013-XCTL-DISPLAY-RESTART                       10151006
101520                             TO TRUE                              10152006
101530             PERFORM DP014-0000-PROCESS-ABEND                     10153006
101540     END-EVALUATE.                                                10154006
101550                                                                  10155006
101560 6550-CLOSE-HANG-FOLD-CSR.                                        10156006
101570                                                                  10157006
101580         EXEC SQL                                                 10158006
101590             CLOSE HANG_FOLD_CSR                                  10159006
101600         END-EXEC                                                 10160006
101610                                                                  10161006
101620                                                                  10162006
101630         EVALUATE TRUE                                            10163006
101640             WHEN SQLCODE = ZERO                                  10164006
101650                 CONTINUE                                         10165006
101660             WHEN SQLWARN0 NOT = SPACES                           10166006
101670             WHEN SQLCODE < ZERO                                  10167006
101680             WHEN SQLCODE > ZERO                                  10168006
101690                 MOVE '6550-CLOSE-HANG-FOLD-CSR'                  10169006
101700                                   TO DP013-PARAGRAPH             10170006
101710                 MOVE 'CLOSE HANG FOLD CSR - '                    10171006
101720                                   TO DP013-MESSAGE-TEXT (1)      10172006
101730                 MOVE SQLCA        TO DP013-SQLCA                 10173006
101740                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    10174006
101750                 SET DP013-DB2-ABEND                              10175006
101760                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10176006
101770                 SET DP013-ROLLBACK                               10177006
101780                                   TO TRUE                        10178006
101790                 PERFORM DP014-0000-PROCESS-ABEND                 10179006
101800         END-EVALUATE.                                            10180006
101810                                                                  10181006
101820                                                                  10182006
101830 EJECT                                                            10183006
101840                                                                  10184006
101850 6560-DETERMINE-WEIGHTS-MSRS.                                     10185006
101860                                                                  10186006
101870      SET PS-NOT-EO-WEIGHTS-MSRS-CSR                              10187006
101880          PS-WEIGHTS-MEAUSURES-CHECK-NO TO TRUE                   10188006
101890                                                                  10189006
101900      PERFORM 6570-OPEN-WEIGHTS-MSRS-CSR                          10190006
101910      PERFORM 6580-FETCH-WEIGHTS-MSRS-CSR                         10191006
101920        UNTIL PS-EO-WEIGHTS-MSRS-CSR OR                           10192006
101930              PS-WEIGHTS-MEAUSURES-CHECK.                         10193006
101940      PERFORM 6590-CLOSE-WEIGHTS-MSRS-CSR.                        10194006
101950                                                                  10195006
101960******************************************************************10196006
101970 6570-OPEN-WEIGHTS-MSRS-CSR.                                      10197006
101980                                                                  10198006
101990         EXEC SQL                                                 10199006
102000              OPEN WGHTS_MSRS_CSR                                 10200006
102010         END-EXEC                                                 10201006
102020                                                                  10202006
102030                                                                  10203006
102040         EVALUATE TRUE                                            10204006
102050             WHEN SQLCODE = ZERO                                  10205006
102060                 CONTINUE                                         10206006
102070             WHEN SQLWARN0 NOT = SPACES                           10207006
102080             WHEN SQLCODE < ZERO                                  10208006
102090             WHEN SQLCODE > ZERO                                  10209006
102100                 MOVE '6570-OPEN-WEIGHTS-MSRS-CSR'                10210006
102110                                   TO DP013-PARAGRAPH             10211006
102120                 MOVE 'OPEN WGHTS MSURES CSR '                    10212006
102130                                   TO DP013-MESSAGE-TEXT (1)      10213006
102140                 MOVE SQLCA        TO DP013-SQLCA                 10214006
102150                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    10215006
102160                 SET DP013-DB2-ABEND                              10216006
102170                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10217006
102180                 SET DP013-ROLLBACK                               10218006
102190                                   TO TRUE                        10219006
102200                 PERFORM DP014-0000-PROCESS-ABEND                 10220006
102210         END-EVALUATE.                                            10221006
102220                                                                  10222006
102230 EJECT                                                            10223006
102240*----------------------------------------------------------------*10224006
102250*                                                                *10225006
102260*----------------------------------------------------------------*10226006
102270 6580-FETCH-WEIGHTS-MSRS-CSR.                                     10227006
102280                                                                  10228006
102290                                                                  10229006
102300     EXEC SQL                                                     10230006
102310        FETCH   WGHTS_MSRS_CSR                                    10231006
102320        INTO   :SHUUPC-UPC-NBR                                    10232006
102330     END-EXEC.                                                    10233006
102340                                                                  10234006
102350     EVALUATE TRUE                                                10235006
102360       WHEN SQLCODE = ZEROS                                       10236006
102370            PERFORM 7245-CALL-XLKUT-DOMAIN-BY-UPC                 10237006
102380            IF XL001-SHIP-WD-QTY = 0 OR                           10238006
102390               XL001-SHIP-DPTH-QTY = 0 OR                         10239006
102400               XL001-SHIP-HT-QTY = 0 OR                           10240006
102410               XL001-SHIP-WT-QTY = 0                              10241006
102420                    SET PS-WEIGHTS-MEAUSURES-CHECK TO TRUE        10242006
102430            END-IF                                                10243006
102440       WHEN SQLCODE = +100                                        10244006
102450                SET  PS-EO-WEIGHTS-MSRS-CSR TO TRUE               10245006
102460       WHEN OTHER                                                 10246006
102470             MOVE '6580-FETCH-WEIGHTS-MSRS-CSR'                   10247006
102480                             TO DP013-PARAGRAPH                   10248006
102490             MOVE 'SUKRF502 - CHECK FOR NOT FOUND       '         10249006
102500                             TO DP013-MESSAGE-TEXT(1)             10250006
102510             MOVE SU001-PO                                        10251006
102520                             TO DP013-MESSAGE-TEXT(2)             10252006
102530             MOVE SU001-CARTON                                    10253006
102540                             TO DP013-MESSAGE-TEXT(3)             10254006
102550             MOVE SQLCA      TO DP013-SQLCA                       10255006
102560             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           10256006
102570             SET DP013-DB2-ABEND                                  10257006
102580                             TO TRUE                              10258006
102590             SET DP013-ROLLBACK                                   10259006
102600                             TO TRUE                              10260006
102610             SET DP013-XCTL-DISPLAY-RESTART                       10261006
102620                             TO TRUE                              10262006
102630             PERFORM DP014-0000-PROCESS-ABEND                     10263006
102640     END-EVALUATE.                                                10264006
102650                                                                  10265006
102660 6590-CLOSE-WEIGHTS-MSRS-CSR.                                     10266006
102670                                                                  10267006
102680         EXEC SQL                                                 10268006
102690             CLOSE WGHTS_MSRS_CSR                                 10269006
102700         END-EXEC                                                 10270006
102710                                                                  10271006
102720                                                                  10272006
102730         EVALUATE TRUE                                            10273006
102740             WHEN SQLCODE = ZERO                                  10274006
102750                 CONTINUE                                         10275006
102760             WHEN SQLWARN0 NOT = SPACES                           10276006
102770             WHEN SQLCODE < ZERO                                  10277006
102780             WHEN SQLCODE > ZERO                                  10278006
102790                 MOVE '6590-CLOSE-WEIGHTS-MSRS-CSR'               10279006
102800                                   TO DP013-PARAGRAPH             10280006
102810                 MOVE 'CLOSE WGHTS MSURES CSR'                    10281006
102820                                   TO DP013-MESSAGE-TEXT (1)      10282006
102830                 MOVE SQLCA        TO DP013-SQLCA                 10283006
102840                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    10284006
102850                 SET DP013-DB2-ABEND                              10285006
102860                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10286006
102870                 SET DP013-ROLLBACK                               10287006
102880                                   TO TRUE                        10288006
102890                 PERFORM DP014-0000-PROCESS-ABEND                 10289006
102900         END-EVALUATE.                                            10290006
102910                                                                  10291006
102920 6700-LINK-XLKUT073.                                              10292006
102930                                                                  10293006
102940     INITIALIZE XL073-COMMAREA-REC                                10294006
102950     MOVE PV-DEPT-NUMBER              TO XL073-DEPT-NBR           10295006
102960     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     10296006
102970                                     XL073-COMMAREA               10297006
102980                                     XL073-COMMAREA-REC           10298006
102990     EVALUATE TRUE                                                10299006
103000         WHEN XL073-NO-ERRORS                                     10300006
103010             MOVE XL073-BUS-AREA-ID  TO PV-BUS-AREA-ID            10301006
103020         WHEN XL073-DEPT-NOT-FND                                  10302006
103030             MOVE ZEROES TO PV-BUS-AREA-ID                        10303006
103040         WHEN OTHER                                               10304006
103050              SET PV-DONE-PROCESSING          TO TRUE             10305006
103060              MOVE XL073-SQLCODE        TO PV-SQLCODE             10306006
103070              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      10307006
103080                     '6700-LINK-XLKUT073 ' DELIMITED BY SIZE      10308006
103090                     ' TABLE  '            DELIMITED BY SIZE      10309006
103100                     XL073-DB2-TABLE                              10310006
103110                                           DELIMITED BY SIZE      10311006
103120                                      INTO PV-CICS-MSG-AREA       10312006
103130              MOVE LENGTH OF PV-CICS-MSG-AREA                     10313006
103140                                        TO PV-COMMAREA-LENGTH     10314006
103150              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              10315006
103160                                                                  10316006
103170              MOVE '6700-LINK-XLKUT073'                           10317006
103180                              TO DP013-PARAGRAPH                  10318006
103190              MOVE 'LINK TO XLKUT004               '              10319006
103200                              TO DP013-MESSAGE-TEXT(1)            10320006
103210              MOVE 'CHECK CSSL FOR MORE DETAIL     '              10321006
103220                                TO DP013-MESSAGE-TEXT (3)         10322006
103230              MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON            10323006
103240              MOVE  SU001-PO      TO PV-DISPLAY-PO                10324006
103250              MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR      10325006
103260              MOVE  PV-PO-LINE-N      TO PV-DISPLAY-PO-LNE-NBR    10326006
103270              MOVE  PV-DEPT-NUMBER    TO PV-DISPLAY-DEPT          10327006
103280              STRING '  CARTON - '        DELIMITED BY SIZE       10328006
103290                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       10329006
103300                     ' PO, RCVR, DEPT '   DELIMITED BY SIZE       10330006
103310                     PV-DISPLAY-PO        DELIMITED BY SIZE       10331006
103320                     ' '                  DELIMITED BY SIZE       10332006
103330                     PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE       10333006
103340                     ' '                  DELIMITED BY SIZE       10334006
103350                     PV-DISPLAY-DEPT DELIMITED BY SIZE            10335006
103360                              INTO DP013-MESSAGE-TEXT (4)         10336006
103370              MOVE SQLCA     TO DP013-SQLCA                       10337006
103380              SET DP013-DB2-ABEND                                 10338006
103390                              TO TRUE                             10339006
103400              SET DP013-ROLLBACK                                  10340006
103410                              TO TRUE                             10341006
103420              SET DP013-XCTL-DISPLAY-RESTART                      10342006
103430                              TO TRUE                             10343006
103440              PERFORM DP014-0000-PROCESS-ABEND                    10344006
103450     END-EVALUATE.                                                10345006
103460                                                                  10346006
103470******************************************************************10347006
103480 6750-CHECK-ECOMM-REPURPOSE.                                      10348006
103490******************************************************************10349006
103500*      --REPURPOSE--                                              10350006
103510     SET SU001-ECOMM-DC-REPURPOSE-NO TO TRUE                      10351006
103520     MOVE ZEROES             TO LBVRDA-PREPK-ID                   10352006
103530     PERFORM 6760-CHECK-TROUBLE-REPURP.                           10353006
103540     IF PV-TROUBLE-COUNT-REPUR > +0                               10354006
103550        SET SU001-ECOMM-DC-REPURPOSE TO TRUE                      10355006
103560        PERFORM 7220-SELECT-TPURCHS                               10356006
103570        IF PURCHS-PKGNG-CDE = PC-M OR PC-I                        10357006
103580           MOVE SU001-PO-LINE-NBR  TO PURITM-PO-LNE-NBR           10358006
103590           PERFORM 7225-SELECT-TPURITM                            10359006
103600           MOVE PURITM-PO-PREPK-ID TO SU001-PREPK-ID              10360006
103610        END-IF                                                    10361006
103620     ELSE                                                         10362006
103630*SLH 05/08 - ADDED REPURP CHECK                                   10363006
103640* PV-REPURP-COUNT > 0 MEANS THE DC IS TURNED ON TO REPURP FOR EFC 10364006
103650        IF PV-REPURP-COUNT > 0                                    10365006
103660          IF SU001-PKGNG-CDE = PC-B OR PC-C                       10366006
103670             PERFORM 7220-SELECT-TPURCHS                          10367006
103680             IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-SPACE       10368006
103690                IF PURCHS-PKGNG-CDE = PC-M OR PC-I                10369006
103700                   MOVE SU001-PO-LINE-NBR  TO PURITM-PO-LNE-NBR   10370006
103710                   PERFORM 7225-SELECT-TPURITM                    10371006
103720                   MOVE PURITM-PO-PREPK-ID TO SU001-PREPK-ID      10372006
103730                END-IF                                            10373006
103740                SET SU001-ECOMM-DC-REPURPOSE TO TRUE              10374006
103750             ELSE                                                 10375006
103760                PERFORM 6770-CHCK-TRBL-REPUR-INNR                 10376006
103770                IF PV-TROUBLE-CNT-REPUR-INNR > +0                 10377006
103780                   SET SU001-ECOMM-DC-REPURPOSE TO TRUE           10378006
103790                END-IF                                            10379006
103800             END-IF                                               10380006
103810          END-IF                                                  10381006
103820       END-IF                                                     10382006
103830     END-IF.                                                      10383006
103840*----------------------------------------------------------------*10384006
103850* CHECK IF PO/RECEIVER IS IN TROUBLE                             *10385006
103860* CHECK IF TROUBLE 405 WAS CREATED. FLAG FOR REPURPOSE EVEN IF THE10386006
103870* TROUBLE HAS BEEN ACKNOWLEDGED.                                 *10387006
103880*----------------------------------------------------------------*10388006
103890 6760-CHECK-TROUBLE-REPURP.                                       10389006
103900     MOVE SU001-RCVR-SEQ-NBR       TO DK-REC-SEQ-NBR.             10390006
103910     MOVE ZEROES                   TO PV-TROUBLE-COUNT-REPUR.     10391006
103920                                                                  10392006
103930     EXEC SQL                                                     10393006
103940        SELECT COUNT(*)                                           10394006
103950          INTO :PV-TROUBLE-COUNT-REPUR                            10395006
103960          FROM TTRBNTF A                                          10396006
103970              ,TTRBRSN C                                          10397006
103980         WHERE A.PO_NBR       =  :DK-PO                           10398006
103990           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  10399006
104000           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    10400006
104010           AND C.NOTIF_IND    =  'T'                              10401006
104020           AND EXISTS                                             10402006
104030              ( SELECT *                                          10403006
104040                FROM  TTRBRCN B                                   10404006
104050                WHERE B.RPT_PGM_NM  = 'SUKEC502'                  10405006
104060                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         10406006
104070     END-EXEC                                                     10407006
104080                                                                  10408006
104090     EVALUATE TRUE                                                10409006
104100         WHEN SQLCODE = ZERO                                      10410006
104110         WHEN SQLCODE = +100                                      10411006
104120             CONTINUE                                             10412006
104130         WHEN SQLWARN0 NOT = SPACES                               10413006
104140         WHEN SQLCODE < ZERO                                      10414006
104150         WHEN SQLCODE > ZERO                                      10415006
104160             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            10416006
104170             MOVE DK-PO          TO  PV-DISPLAY-PO                10417006
104180             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           10418006
104190             MOVE '6760-CHECK-TROUBLE-REPURP '                    10419006
104200                             TO DP013-PARAGRAPH                   10420006
104210             MOVE 'SUKRF502 - CHECK FOR TRBL REPUR'               10421006
104220                             TO DP013-MESSAGE-TEXT(1)             10422006
104230             STRING '  CARTON - '        DELIMITED BY SIZE        10423006
104240                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        10424006
104250                    ' PO, RCVR   '       DELIMITED BY SIZE        10425006
104260                    PV-DISPLAY-PO        DELIMITED BY SIZE        10426006
104270                    ' '                  DELIMITED BY SIZE        10427006
104280                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        10428006
104290                    ' '                  DELIMITED BY SIZE        10429006
104300                             INTO DP013-MESSAGE-TEXT (2)          10430006
104310             MOVE SQLCA      TO DP013-SQLCA                       10431006
104320             MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME(1)           10432006
104330             SET DP013-DB2-ABEND                                  10433006
104340                             TO TRUE                              10434006
104350             SET DP013-ROLLBACK                                   10435006
104360                             TO TRUE                              10436006
104370             SET DP013-XCTL-DISPLAY-RESTART                       10437006
104380                             TO TRUE                              10438006
104390             PERFORM DP014-0000-PROCESS-ABEND                     10439006
104400                                                                  10440006
104410     END-EVALUATE.                                                10441006
104420                                                                  10442006
104430*----------------------------------------------------------------*10443006
104440* CHECK IF PO/RECEIVER IS IN TROUBLE                             *10444006
104450* CHECK IF TROUBLE 406 WAS CREATED. TROUBLE CREATED WHEN CURRENT  10445006
104460* LOCATION ANY DC OTHER THAN 870 ECOMM AND CREATED FOR LOCATION  *10446006
104470* IS 870, AND THE INNER CRTN QTY IS > 1                           10447006
104480*----------------------------------------------------------------*10448006
104490 6770-CHCK-TRBL-REPUR-INNR.                                       10449006
104500     MOVE SU001-RCVR-SEQ-NBR       TO DK-REC-SEQ-NBR.             10450006
104510     MOVE ZEROES                   TO PV-TROUBLE-CNT-REPUR-INNR.  10451006
104520                                                                  10452006
104530     EXEC SQL                                                     10453006
104540        SELECT COUNT(*)                                           10454006
104550          INTO :PV-TROUBLE-CNT-REPUR-INNR                         10455006
104560          FROM TTRBNTF A                                          10456006
104570              ,TTRBRSN C                                          10457006
104580         WHERE A.PO_NBR       =  :DK-PO                           10458006
104590           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  10459006
104600           AND A.RESOLVED_IND IN ('N','I','R')                    10460006
104610           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    10461006
104620           AND C.NOTIF_IND    =  'T'                              10462006
104630           AND EXISTS                                             10463006
104640              ( SELECT *                                          10464006
104650                FROM  TTRBRCN B                                   10465006
104660                WHERE B.RPT_PGM_NM  = 'SUEC1502'                  10466006
104670                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         10467006
104680     END-EXEC                                                     10468006
104690                                                                  10469006
104700     EVALUATE TRUE                                                10470006
104710         WHEN SQLCODE = ZERO                                      10471006
104720         WHEN SQLCODE = +100                                      10472006
104730             CONTINUE                                             10473006
104740         WHEN SQLWARN0 NOT = SPACES                               10474006
104750         WHEN SQLCODE < ZERO                                      10475006
104760         WHEN SQLCODE > ZERO                                      10476006
104770             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            10477006
104780             MOVE DK-PO          TO  PV-DISPLAY-PO                10478006
104790             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           10479006
104800             MOVE '6770-CHCK-TRBL-REPUR-INNR '                    10480006
104810                             TO DP013-PARAGRAPH                   10481006
104820             MOVE 'SUKRF502 - CHECK FOR TRBL REPUR'               10482006
104830                             TO DP013-MESSAGE-TEXT(1)             10483006
104840             STRING '  CARTON - '        DELIMITED BY SIZE        10484006
104850                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        10485006
104860                    ' PO, RCVR   '       DELIMITED BY SIZE        10486006
104870                    PV-DISPLAY-PO        DELIMITED BY SIZE        10487006
104880                    ' '                  DELIMITED BY SIZE        10488006
104890                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        10489006
104900                    ' '                  DELIMITED BY SIZE        10490006
104910                             INTO DP013-MESSAGE-TEXT (2)          10491006
104920             MOVE SQLCA      TO DP013-SQLCA                       10492006
104930             MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME(1)           10493006
104940             SET DP013-DB2-ABEND                                  10494006
104950                             TO TRUE                              10495006
104960             SET DP013-ROLLBACK                                   10496006
104970                             TO TRUE                              10497006
104980             SET DP013-XCTL-DISPLAY-RESTART                       10498006
104990                             TO TRUE                              10499006
105000             PERFORM DP014-0000-PROCESS-ABEND                     10500006
105010                                                                  10501006
105020     END-EVALUATE.                                                10502006
105030                                                                  10503006
105040* JAK WR41309 - ADD PARAGRAPH 6800 TO INSERT TO SUT00024          10504006
105050 6800-INSERT-PROCESS-MSG.                                         10505006
105060                                                                  10506006
105070     MOVE SUT00024-SHIPT-UNT-ID TO SUT00094-SHIPT-UNT-ID          10507006
105080     MOVE SU001-STORE           TO SUT00094-DEST-LOC-NBR          10508006
105090                                                                  10509072
105100     IF SU093-PRINT-RFID                                          10510068
105110        MOVE 'RD'               TO SUT00094-PRC-MSG-CDE           10511068
105120     ELSE                                                         10512068
105130        IF SU093-PRINT-EAS                                        10513068
105140           MOVE 'EA'            TO SUT00094-PRC-MSG-CDE           10514068
105150        ELSE                                                      10515068
105160           IF SU093-PRINT-RFID-EAS                                10516068
105170              MOVE 'RE'         TO SUT00094-PRC-MSG-CDE           10517068
105180           END-IF                                                 10518068
105190        END-IF                                                    10519068
105200     END-IF.                                                      10520068
105210                                                                  10521072
105220     MOVE SU001-PO              TO SUT00094-PO-NBR                10522027
105230     MOVE SU001-PO-LINE-NBR     TO SUT00094-RCVR-LNE-NBR          10523006
105240     MOVE SU001-RCVR-SEQ-NBR    TO SUT00094-RCVR-SEQ-NBR          10524006
105250                                                                  10525006
105260     EXEC SQL                                                     10526006
105270         INSERT INTO SUT_PRC_MSG_CNTL                             10527006
105280               (PO_NBR                                            10528006
105290              , RCVR_LNE_NBR                                      10529006
105300              , RCVR_SEQ_NBR                                      10530006
105310              , DEST_LOC_NBR                                      10531006
105320              , SHIPT_UNT_ID                                      10532006
105330              , CRE_TMST                                          10533006
105340              , PRC_MSG_CDE )                                     10534006
105350         VALUES                                                   10535006
105360              (:SUT00094-PO-NBR                                   10536006
105370             , :SUT00094-RCVR-LNE-NBR                             10537006
105380             , :SUT00094-RCVR-SEQ-NBR                             10538006
105390             , :SUT00094-DEST-LOC-NBR                             10539006
105400             , :SUT00094-SHIPT-UNT-ID                             10540006
105410             ,  CURRENT TIMESTAMP                                 10541006
105420             , :SUT00094-PRC-MSG-CDE )                            10542006
105430     END-EXEC.                                                    10543006
105440                                                                  10544006
105450     EVALUATE TRUE                                                10545006
105460         WHEN SQLCODE = ZERO                                      10546006
105470         WHEN SQLCODE = -803                                      10547006
105480             CONTINUE                                             10548006
105490         WHEN SQLWARN0 NOT = SPACES                               10549006
105500         WHEN SQLCODE < ZERO                                      10550006
105510         WHEN SQLCODE > ZERO                                      10551006
105520             MOVE '6800-INSERT-PROCESS-MSG'                       10552006
105530                             TO DP013-PARAGRAPH                   10553006
105540             MOVE 'SUKRF502 - INSERT SUT_PRC_MSG_CNTL'            10554006
105550                             TO DP013-MESSAGE-TEXT(1)             10555006
105560             MOVE SUT00024-SHIPT-UNT-ID                           10556006
105570                             TO DP013-MESSAGE-TEXT(2)             10557006
105580             MOVE SQLCA      TO DP013-SQLCA                       10558006
105590             MOVE 'SUT_PRC_MSG_CNTL'  TO DP013-DB2-TABLE-NAME(1)  10559006
105600             SET DP013-DB2-ABEND                                  10560006
105610                             TO TRUE                              10561006
105620             SET DP013-ROLLBACK                                   10562006
105630                             TO TRUE                              10563006
105640             SET DP013-XCTL-DISPLAY-RESTART                       10564006
105650                             TO TRUE                              10565006
105660             PERFORM DP014-0000-PROCESS-ABEND                     10566006
105670                                                                  10567006
105680     END-EVALUATE.                                                10568006
105690* JAK WR41309 - END                                               10569006
105700                                                                  10570006
105710*----------------------------------------------------------------*10571006
105720******************************************************************10572006
105730* TEMPORARY CODE TO CHECK IF AUDITS LABELS HAD BEEN REQUESTED    *10573006
105740* PRIOR TO THE CHANGES FOR AUDIT PROMPTING.                     **10574006
105750* IF AN AUDIT LABEL HAD BEEN PREVIOUSLY PRINTED FOR BULK/CASEPACK,10575006
105760* OR IF CARTONS HAVE BEEN PREVIOULSY CHECKED IN FOR A PO/TRIP FOR*10576006
105770* PACK BY STORE, THE NEW AUDIT MODULE WILL NOT BE CALLED.       **10577006
105780* 2002-03-18 DATE TWO WEEKS AFTER INSTALL                       **10578006
105790******************************************************************10579006
105800 7000-AUDIT-CHECK-PROCESSING.                                     10580006
105810                                                                  10581006
105820         IF PV-TEST-CICS OR PV-QA-CICS                            10582006
105830            MOVE SPACE TO PV-CICS-MSG-AREA-A                      10583006
105840            STRING ' SUKRF502: 7000-top of para'                  10584006
105850            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             10585006
105860            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     10586006
105870                                           TO PV-COMMAREA-LENGTH  10587006
105880            EXEC CICS WRITEQ TD                                   10588006
105890                      QUEUE('CSSL')                               10589006
105900                      FROM(PV-CICS-MSG-AREA-A)                    10590006
105910                      LENGTH(PV-COMMAREA-LENGTH)                  10591006
105920                      RESP (PV-CICS-RESPONSE)                     10592006
105930            END-EXEC                                              10593006
105940          END-IF.                                                 10594006
105950                                                                  10595006
105960     IF SU001-FLOWBACK-YES                                        10596006
105970        PERFORM 7220-SELECT-TPURCHS                               10597006
105980        IF (PURCHS-PO-TYP-CDE = 'FB' OR                           10598006
105990            PURCHS-PO-TYP-CDE = 'IF') AND                         10599006
106000            PS-ACTIVE-XREF-ROW-FOUND AND                          10600006
106010            SU001-LBL-REPRINT                                     10601006
106020         SET PS-FLOWBACK-BYPASS-AUDIT TO TRUE                     10602006
106030        END-IF                                                    10603006
106040     END-IF                                                       10604006
106050                                                                  10605006
106060     PERFORM 7405-GET-CURRENT-DATE                                10606006
106070     IF PS-FLOWBACK-BYPASS-AUDIT OR                               10607006
106080        PS-SULBXF-ROW-FOUND                                       10608006
106090         CONTINUE                                                 10609006
106100         IF PV-TEST-CICS OR PV-QA-CICS                            10610006
106110            MOVE SPACE TO PV-CICS-MSG-AREA-A                      10611006
106120            STRING ' SUKRF502: flowback or sulbxf row found'      10612006
106130            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             10613006
106140            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     10614006
106150                                           TO PV-COMMAREA-LENGTH  10615006
106160            EXEC CICS WRITEQ TD                                   10616006
106170                      QUEUE('CSSL')                               10617006
106180                      FROM(PV-CICS-MSG-AREA-A)                    10618006
106190                      LENGTH(PV-COMMAREA-LENGTH)                  10619006
106200                      RESP (PV-CICS-RESPONSE)                     10620006
106210            END-EXEC                                              10621006
106220         END-IF                                                   10622006
106230     ELSE                                                         10623006
106240         PERFORM 7100-CHECK-CRTN-AUDIT-STATUS                     10624006
106250     END-IF.                                                      10625006
106260     SET PS-DONT-PRINT-AUDIT-LABEL  TO TRUE.                      10626006
106270                                                                  10627006
106280******************************************************************10628006
106290*CHECK INSTALL DATE FROM THE PARM TABLE                           10629006
106300******************************************************************10630006
106310 7050-CHECK-TKRPRPM.                                              10631006
106320                                                                  10632006
106330                                                                  10633006
106340     EXEC SQL                                                     10634006
106350          SELECT FUNC_BEG_TMST                                    10635006
106360          INTO  :KRPRPM-FUNC-BEG-TMST                             10636006
106370          FROM   TKRPRPM                                          10637006
106380          WHERE  LOC_ID            =  90                          10638006
106390            AND  SYS_PRC_FUNC_CDE  = 'BEGAUD'                     10639006
106400     END-EXEC.                                                    10640006
106410                                                                  10641006
106420                                                                  10642006
106430     EVALUATE TRUE                                                10643006
106440         WHEN SQLCODE = ZERO                                      10644006
106450             CONTINUE                                             10645006
106460         WHEN SQLCODE = +100                                      10646006
106470             MOVE ZEROES TO KRPRPM-FUNC-BEG-TMST                  10647006
106480         WHEN SQLWARN0 NOT = SPACES                               10648006
106490         WHEN SQLCODE < ZERO                                      10649006
106500         WHEN SQLCODE > ZERO                                      10650006
106510             MOVE '7050-CHECK-TKRPRPM'                            10651006
106520                             TO DP013-PARAGRAPH                   10652006
106530             MOVE 'SUKRF502 - CHECK VALID CARTON'                 10653006
106540                             TO DP013-MESSAGE-TEXT(1)             10654006
106550             MOVE SHPUNT-SHIPT-UNT-ID                             10655006
106560                             TO DP013-MESSAGE-TEXT(2)             10656006
106570             MOVE SQLCA      TO DP013-SQLCA                       10657006
106580             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           10658006
106590             SET DP013-DB2-ABEND                                  10659006
106600                             TO TRUE                              10660006
106610             SET DP013-ROLLBACK                                   10661006
106620                             TO TRUE                              10662006
106630             SET DP013-XCTL-DISPLAY-RESTART                       10663006
106640                             TO TRUE                              10664006
106650             PERFORM DP014-0000-PROCESS-ABEND                     10665006
106660                                                                  10666006
106670     END-EVALUATE.                                                10667006
106680******************************************************************10668006
106690*SELECT DIVERT LOCATION BARCODE  FOR REPURPOSE                    10669006
106700******************************************************************10670006
106710 7055-CHECK-TKRPRPM-REPURP-LOC.                                   10671006
106720                                                                  10672006
106730     MOVE SU001-CURR-OPER-UNT-ID TO KRPRPM-LOC-ID.                10673006
106740                                                                  10674006
106750     EXEC SQL                                                     10675006
106760          SELECT FUNC_TXT                                         10676006
106770          INTO  :KRPRPM-FUNC-TXT                                  10677006
106780          FROM   TKRPRPM                                          10678006
106790          WHERE  LOC_ID            =  :KRPRPM-LOC-ID              10679006
106800            AND  SYS_PRC_FUNC_CDE  = 'ECRPRP'                     10680006
106810     END-EXEC.                                                    10681006
106820                                                                  10682006
106830                                                                  10683006
106840     EVALUATE TRUE                                                10684006
106850         WHEN SQLCODE = ZERO                                      10685006
106860             CONTINUE                                             10686006
106870         WHEN SQLWARN0 NOT = SPACES                               10687006
106880         WHEN SQLCODE < ZERO                                      10688006
106890         WHEN SQLCODE > ZERO                                      10689006
106900             MOVE '77055-CHECK-TKRPRPM-REPURP-LOC'                10690006
106910                             TO DP013-PARAGRAPH                   10691006
106920             MOVE 'SUKRF502 - CHECK REPURP BRCDE'                 10692006
106930                             TO DP013-MESSAGE-TEXT(1)             10693006
106940             MOVE SHPUNT-SHIPT-UNT-ID                             10694006
106950                             TO DP013-MESSAGE-TEXT(2)             10695006
106960             MOVE SQLCA      TO DP013-SQLCA                       10696006
106970             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           10697006
106980             SET DP013-DB2-ABEND                                  10698006
106990                             TO TRUE                              10699006
107000             SET DP013-ROLLBACK                                   10700006
107010                             TO TRUE                              10701006
107020             SET DP013-XCTL-DISPLAY-RESTART                       10702006
107030                             TO TRUE                              10703006
107040             PERFORM DP014-0000-PROCESS-ABEND                     10704006
107050                                                                  10705006
107060     END-EVALUATE.                                                10706006
107070******************************************************************10707006
107080*CHECK FOR PREVIOUSLY CHECKED CARTONS                             10708006
107090******************************************************************10709006
107100 7070-CHECK-PREV-CKED-CRTNS.                                      10710006
107110                                                                  10711006
107120                                                                  10712006
107130     EXEC SQL                                                     10713006
107140         SELECT  MIN(B.CRE_TMST)                                  10714006
107150         INTO   :SHUNLO-CRE-TMST :PV-NULL-CRE-TMST                10715006
107160         FROM   TSHUUPC A                                         10716006
107170              , TSHUNLO B                                         10717006
107180         WHERE  A.SHIPT_UNT_ID   =  B.SHIPT_UNT_ID                10718006
107190           AND  A.TRN_NBR        = :SU001-PO                      10719006
107200           AND  B.TRIP_ID        = :SU001-MANIFEST                10720006
107210     END-EXEC.                                                    10721006
107220                                                                  10722006
107230     EVALUATE TRUE                                                10723006
107240         WHEN SQLCODE = ZERO                                      10724006
107250             IF PV-NULL-CRE-TMST = -1                             10725006
107260                MOVE PC-DEFAULT-TIME TO SHUNLO-CRE-TMST           10726006
107270             END-IF                                               10727006
107280         WHEN SQLCODE = +100                                      10728006
107290             MOVE ZEROES TO SHUNLO-CRE-TMST                       10729006
107300         WHEN SQLWARN0 NOT = SPACES                               10730006
107310         WHEN SQLCODE NOT EQUAL ZERO                              10731006
107320             MOVE '7070-CHECK-PREV-CKED-CRTNS'                    10732006
107330                             TO DP013-PARAGRAPH                   10733006
107340             MOVE 'SUKRF502 - CHECK VALID CARTON'                 10734006
107350                             TO DP013-MESSAGE-TEXT(1)             10735006
107360             MOVE SU001-CARTON                                    10736006
107370                             TO DP013-MESSAGE-TEXT(2)             10737006
107380             MOVE SU001-MANIFEST                                  10738006
107390                             TO DP013-MESSAGE-TEXT(3)             10739006
107400             MOVE SQLCA      TO DP013-SQLCA                       10740006
107410             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           10741006
107420             SET DP013-DB2-ABEND                                  10742006
107430                             TO TRUE                              10743006
107440             SET DP013-ROLLBACK                                   10744006
107450                             TO TRUE                              10745006
107460             SET DP013-XCTL-DISPLAY-RESTART                       10746006
107470                             TO TRUE                              10747006
107480             PERFORM DP014-0000-PROCESS-ABEND                     10748006
107490     END-EVALUATE.                                                10749006
107500                                                                  10750006
107510*----------------------------------------------------------------*10751006
107520*  CALL TO AUDIT MODULE TO CHECK CARTON AUDIT STATUS             *10752006
107530*----------------------------------------------------------------*10753006
107540 7100-CHECK-CRTN-AUDIT-STATUS.                                    10754006
107550      INITIALIZE SU021-CARTON-AUDIT-RECORD.                       10755006
107560                                                                  10756006
107570      SET  SU021-CARTON-CHECK-IN                                  10757006
107580           SU021-AUDIT-IS-COMPLETE                                10758006
107590*CLP 10/24/13 - START                                             10759006
107600           SU021-RFID-AUDIT-IS-COMPLETE  TO TRUE.                 10760006
107610*CLP 10/24/13 - END                                               10761006
107620      MOVE SU001-PROMPT-IND  TO SU021-DEFERRED-AUDIT-IND.         10762006
107630                                                                  10763006
107640      MOVE SU001-PO            TO SU021-PO-NUMBER                 10764006
107650      MOVE SU001-PO-LINE-NBR   TO SU021-LINE-NBR                  10765006
107660                                     RECITM-PREPK-ID              10766006
107670      IF SU001-RECEIV-PBS-IND = 'Y'                               10767006
107680          MOVE +0              TO SU021-DRIVER-LINE-NBR           10768006
107690                                  SU021-PRE-PACK-ID               10769006
107700                                  SU001-PRE-PACK-ID               10770006
107710          MOVE PC-PS       TO SU021-PACKAGE-TYPE-CODE             10771006
107720      ELSE                                                        10772006
107730          IF SU001-PKGNG-CDE  = PC-M OR PC-I                      10773006
107740              PERFORM 2380-SELECT-PREPAK-INFO                     10774006
107750              MOVE PC-PP           TO SU021-PACKAGE-TYPE-CODE     10775006
107760              MOVE PV-DRIVER-LINE-NO                              10776006
107770                                   TO SU021-DRIVER-LINE-NBR       10777006
107780              MOVE RECITM-PREPK-ID TO SU021-PRE-PACK-ID           10778006
107790                                      SU001-PRE-PACK-ID           10779006
107800          ELSE                                                    10780006
107810              MOVE +0              TO SU021-DRIVER-LINE-NBR       10781006
107820                                      SU021-PRE-PACK-ID           10782006
107830                                      SU001-PRE-PACK-ID           10783006
107840              MOVE PC-BC       TO SU021-PACKAGE-TYPE-CODE         10784006
107850          END-IF                                                  10785006
107860      END-IF.                                                     10786006
107870      MOVE SU001-OPER-UNT-ID   TO SU021-OPER-UNT-ID               10787006
107880      MOVE SU001-RCVR-SEQ-NBR  TO SU021-REC-SEQ-NBR               10788006
107890      MOVE SU001-MANIFEST      TO SU021-INBOUND-TRIP-ID           10789006
107900      MOVE SU001-CARTON        TO SU021-SHIPT-UNT-ID              10790006
107910      MOVE SU001-USER-ID       TO SU021-USER-ID                   10791006
107920      IF PV-TEST-CICS OR PV-QA-CICS                               10792006
107930            MOVE SPACE TO PV-CICS-MSG-AREA-A                      10793006
107940            MOVE SU021-oper-unt-id to pv-unit                     10794006
107950            move su021-po-number to pv-po-xnum                    10795006
107960            move su021-rec-seq-nbr to PV-PO-RCVR-SEQ-NO           10796006
107970            move su021-inbound-trip-id to pv-trip                 10797006
107980            move su021-shipt-unt-id to pv-carton-cnt18            10798006
107990*CLP 12/18/14                                                     10799006
108000            STRING ' 502b 7260 '                                  10800006
108010             ' opr='                                              10801006
108020               PV-unit                                            10802006
108030             ' po ='                                              10803006
108040             PV-po-xnum                                           10804006
108050             ' sq ='                                              10805006
108060             PV-PO-RCVR-SEQ-NO                                    10806006
108070             ' trp='                                              10807006
108080             pv-trip                                              10808006
108090             ' car='                                              10809006
108100             pv-carton-cnt18                                      10810006
108110            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             10811006
108120            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     10812006
108130                                            TO PV-COMMAREA-LENGTH 10813006
108140            EXEC CICS WRITEQ TD                                   10814006
108150                      QUEUE('CSSL')                               10815006
108160                      FROM(PV-CICS-MSG-AREA-A)                    10816006
108170                      LENGTH(PV-COMMAREA-LENGTH)                  10817006
108180                      RESP (PV-CICS-RESPONSE)                     10818006
108190            END-EXEC                                              10819006
108200      END-IF.                                                     10820006
108210      PERFORM 7260-LINK-SUKCS583.                                 10821006
108220*01/23/14                                                         10822006
108230        IF PV-TEST-CICS OR PV-QA-CICS                             10823006
108240            MOVE SPACE TO PV-CICS-MSG-AREA-A                      10824006
108250            MOVE SU021-AUDIT-NUMBER TO PV-AUDIT                   10825006
108260            MOVE SU001-CARTON TO PV-CARTON-CNT18                  10826006
108270            STRING ' 502: 583- '                                  10827006
108280             ' AUD-NO='                                           10828006
108290               PV-AUDIT                                           10829006
108300             ' CT ='                                              10830006
108310             PV-CARTON-CNT18                                      10831006
108320             ' SW ='                                              10832006
108330             SU021-AUDIT-VALIDATION-SW                            10833006
108340             ' RSW='                                              10834006
108350             SU021-RFID-AUDIT-VALIDATION-SW                       10835006
108360            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             10836006
108370            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     10837006
108380                                            TO PV-COMMAREA-LENGTH 10838006
108390            EXEC CICS WRITEQ TD                                   10839006
108400                      QUEUE('CSSL')                               10840006
108410                      FROM(PV-CICS-MSG-AREA-A)                    10841006
108420                      LENGTH(PV-COMMAREA-LENGTH)                  10842006
108430                      RESP (PV-CICS-RESPONSE)                     10843006
108440            END-EXEC                                              10844006
108450     END-IF.                                                      10845006
108460                                                                  10846006
108470      MOVE SU021-AUDIT-NUMBER  TO SU001-AUDIT-CNTL-NBR.           10847006
108480*----------------------------------------------------------------*10848006
108490*  GATHER LABEL INFORMATION                                      *10849006
108500*----------------------------------------------------------------*10850006
108510 7200-GATHER-LABEL-INFO.                                          10851006
108520                                                                  10852006
108530     INITIALIZE DCLTLBPTDA.                                       10853006
108540                                                                  10854006
108550     MOVE  ZEROES                 TO  LBPTDA-PREPK-ID             10855006
108560                                      LBPTDA-PREPK-RATO-QTY       10856006
108570                                      LBPTDA-PREPK-UNT-QTY        10857006
108580                                      LBPTDA-CSE-PK-QTY           10858006
108590                                      LBPTDA-LBL-TYP-LBL-SEQ-ID   10859006
108600                                      LBPTDA-LBL-TYP-TOT-QTY      10860006
108610                                      LBPTDA-ITM-NBR.             10861006
108620     MOVE  SPACES                 TO  LBPTDA-MODU-DESC            10862006
108630                                      LBPTDA-ODD-CART-IND         10863006
108640                                      LBPTDA-STRG-AREA-CDE.       10864006
108650***                                                               10865006
108660     MOVE  SEASET-SEASET-NM        TO  LBPTDA-SEASET-NM.          10866006
108670     MOVE  PV-FIXTURE-ID           TO  LBPTDA-FIXT-ID.            10867006
108680     MOVE  'N'                     TO  LBPTDA-INPK-CNVYB-IND.     10868006
108690     MOVE  'S'                     TO  LBPTDA-CART-LBL-TYP-CDE.   10869006
108700     MOVE  PV-DEPT-DESC            TO  LBPTDA-DEPT-DESC.          10870006
108710     MOVE  PV-MAJ-CL-DESC          TO  LBPTDA-MAJ-CL-DESC.        10871006
108720     MOVE  PV-INNR-PACK-QTY        TO  LBPTDA-INPK-UNT-QTY.       10872006
108730     MOVE  PC160-BTCH-BARCODE      TO  LBPTDA-BRCDE-NBR.          10873006
108740*************************************                             10874006
108750     MOVE PV-HNG-FOLD-SEQ-NBR      TO  LBPTDA-HNG-FOLD-SEQ-NBR    10875006
108760     MOVE PS-EAS-TAG-IND-FOUND-SW                                 10876006
108770                               TO LBPTDA-EAS-TAG-IND              10877006
108780     MOVE CNDCDR-DOOR-ID       TO LBPTDA-DOOR-ID                  10878006
108790*CLP 07/06/2015 START                                             10879006
108800     IF PS-BRAND-FOUND-YES                                        10880006
108810*       GET THE BUSINESS AREA DESC FIRST                          10881015
108820        PERFORM 6700-LINK-XLKUT073                                10882012
108830        MOVE 35 TO LBPTDA-LBL-MSG-TXT-LEN                         10883006
108840        PERFORM 7207-INSPECT-BUS-AREA                             10884006
108850        MOVE PV-BUS-AREA-BRAND TO LBPTDA-LBL-MSG-TXT-TEXT         10885006
108860*CLP 07/06/2015 END                                               10886006
108870     END-IF                                                       10887006
108880*************************************                             10888006
108890** SLH 04/24/08  ADDED PV-REPURP-COUNT > 0 CHECK                  10889006
108900     IF SU001-NOT-MULTI-LINE                                      10890006
108910        IF PS-OPER-IS-ECOMM-DS                                    10891006
108920               MOVE  'E'           TO  LBPTDA-CART-LBL-TYP-CDE    10892006
108930               MOVE   PV-SKU-OUT-9 TO  LBPTDA-ITM-NBR             10893006
108940        END-IF                                                    10894006
108950     ELSE                                                         10895006
108960        IF PS-OPER-IS-ECOMM-DC AND                                10896006
108970             PS-OPER-IS-ECOMM-DS AND                              10897006
108980               PV-REPURP-COUNT > 0                                10898006
108990               MOVE  PC-FLAT  TO XLT00010-LOC-10-ABBR-NM          10899006
109000     END-IF                                                       10900006
109010                                                                  10901006
109020                                                                  10902006
109030     IF PS-ODD-UNT-CRTN-FOUND                                     10903006
109040        MOVE RECITM-PREPK-ID       TO LBPTDA-PREPK-ID             10904006
109050     END-IF                                                       10905006
109060                                                                  10906006
109070                                                                  10907006
109080     IF PS-REPRINT-DUP                                            10908006
109090        IF SU001-NO-LINE                                          10909006
109100           MOVE  '** NO LINE NUMBER **' TO  PV-VEND-STYL-NAME     10910006
109110        ELSE                                                      10911006
109120           PERFORM 7230-GET-DEPT-CL-SKU                           10912006
109130        END-IF                                                    10913006
109140     END-IF.                                                      10914006
109150                                                                  10915006
109160     IF SU001-MULTI-LINE                                          10916006
109170        MOVE  '*MULTIPLE LINES*' TO  PV-VEND-STYL-NAME            10917006
109180     END-IF.                                                      10918006
109190*----------------------------------------------------------------*10919006
109200*  INSERT ROW INTO LABEL TABLE FOR BATCH LABEL OPTION            *10920006
109210*----------------------------------------------------------------*10921006
109220 7205-INSERT-LABEL-TABLE.                                         10922006
109230                                                                  10923006
109240* CLP 04/23/13 PR5148B START                                      10924006
109250                                                                  10925006
109260     IF PS-RFID-ON-LABEL-YES                                      10926006
109270       IF SU093-PRINT-RFID                                        10927068
109280         MOVE 'RD'                TO  LBPTDA-PRC-MSG-CDE          10928068
109290       ELSE                                                       10929068
109300         IF SU093-PRINT-EAS                                       10930068
109310           MOVE 'EA'              TO  LBPTDA-PRC-MSG-CDE          10931068
109320         ELSE                                                     10932068
109330           IF SU093-PRINT-RFID-EAS                                10933068
109340             MOVE 'RE'            TO  LBPTDA-PRC-MSG-CDE          10934068
109350           ELSE                                                   10935068
109360             MOVE SPACE           TO  LBPTDA-PRC-MSG-CDE          10936068
109370           END-IF                                                 10937068
109380         END-IF                                                   10938068
109390       END-IF                                                     10939068
109400     END-IF.                                                      10940068
109410                                                                  10941006
109420* CLP 04/23/13 PR5148B END                                        10942006
109430                                                                  10943006
109440     MOVE  SU001-CARTON           TO  LBPTDA-SHIPT-UNT-ID.        10944006
109450     MOVE  SU001-MANIFEST         TO  LBPTDA-TRIP-ID.             10945006
109460     MOVE  SU001-BATCH-NUMBER     TO  LBPTDA-LBL-PRT-BTCH-ID.     10946006
109470     MOVE  SU001-CURR-OPER-UNT-ID TO  LBPTDA-OPER-UNT-ID.         10947006
109480     MOVE  SU001-FCLTY-ID         TO  LBPTDA-FCLTY-ID.            10948006
109490     MOVE  SU001-PO               TO  LBPTDA-PO-NBR.              10949006
109500     IF SU001-AUTO-VE-YES AND SU044-NEW-REC-SEQ-NBR > 0           10950006
109510        MOVE SU044-NEW-REC-SEQ-NBR TO LBPTDA-RCVR-SEQ-NBR         10951006
109520     ELSE                                                         10952006
109530        MOVE SU001-RCVR-SEQ-NBR   TO  LBPTDA-RCVR-SEQ-NBR         10953006
109540     END-IF                                                       10954006
109550     MOVE  SU001-PO-LINE-NBR      TO  LBPTDA-PO-LNE-NBR.          10955006
109560     MOVE  SU001-STORE            TO  LBPTDA-DEST-OPER-UNT-ID.    10956006
109570     MOVE  SU001-OPER-UNT-ID      TO  LBPTDA-MISDIR-OPER-UNT-ID.  10957006
109580     MOVE  PV-OUTR-PACK-QTY       TO  LBPTDA-OTPK-UNT-QTY.        10958006
109590     MOVE  PV-HNG-FOLD-SEQ-NBR    TO  LBPTDA-HNG-FOLD-SEQ-NBR.    10959006
109600                                                                  10960006
109610* CLP 10/24/13 PR5148D START                                      10961006
109620*    IF CASEPACK WAS NOT DONE PRIOR - VALUES ARE NOT INITIALIZED  10962006
109630                                                                  10963006
109640     IF SU021-AUDIT-NUMBER IS NOT NUMERIC                         10964006
109650         MOVE 0 TO SU021-AUDIT-NUMBER                             10965006
109660     END-IF.                                                      10966006
109670     IF SU021-RFID-AUDIT-NUMBER IS NOT NUMERIC                    10967006
109680         MOVE 0 TO SU021-RFID-AUDIT-NUMBER                        10968006
109690     END-IF.                                                      10969006
109700                                                                  10970006
109710        IF PV-TEST-CICS OR PV-QA-CICS                             10971006
109720            MOVE SPACE TO PV-CICS-MSG-AREA-A                      10972006
109730            MOVE SU021-AUDIT-NUMBER TO PV-AUDIT                   10973006
109740            MOVE SU021-RFID-AUDIT-NUMBER TO PV-AUDITR             10974006
109750            MOVE SU001-CARTON TO PV-CARTON-CNT18                  10975006
109760            STRING ' 502:7205- '                                  10976006
109770             'AUD-NO='                                            10977006
109780               PV-AUDIT                                           10978006
109790             ' RAUD-NO='                                          10979006
109800               PV-AUDITR                                          10980006
109810             ' CT='                                               10981006
109820             PV-CARTON-CNT18                                      10982006
109830             ' SW ='                                              10983006
109840             SU021-AUDIT-VALIDATION-SW                            10984006
109850             ' RSW='                                              10985006
109860             SU021-RFID-AUDIT-VALIDATION-SW                       10986006
109870            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             10987006
109880            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     10988006
109890                                            TO PV-COMMAREA-LENGTH 10989006
109900            EXEC CICS WRITEQ TD                                   10990006
109910                      QUEUE('CSSL')                               10991006
109920                      FROM(PV-CICS-MSG-AREA-A)                    10992006
109930                      LENGTH(PV-COMMAREA-LENGTH)                  10993006
109940                      RESP (PV-CICS-RESPONSE)                     10994006
109950            END-EXEC                                              10995006
109960     END-IF.                                                      10996006
109970*                                                                 10997006
109980     MOVE  SU021-AUDIT-VALIDATION-SW                              10998006
109990                                  TO  LBPTDA-CART-ACTN-CDE        10999006
110000     EVALUATE TRUE                                                11000006
110010       WHEN SU021-AUDIT-REQUIRED  AND SU021-RFID-AUDIT-REQUIRED   11001006
110020         MOVE 'Q' TO LBPTDA-CART-ACTN-CDE                         11002006
110030         MOVE 'QR' TO LBPTDA-PRC-MSG-CDE                          11003006
110040       WHEN SU021-AUDIT-REQUIRED                                  11004006
110050           MOVE  SU021-AUDIT-VALIDATION-SW                        11005006
110060                                     TO  LBPTDA-CART-ACTN-CDE     11006006
110070       WHEN SU021-RFID-AUDIT-REQUIRED                             11007006
110080            MOVE 'RA' TO LBPTDA-PRC-MSG-CDE                       11008006
110090            MOVE  SU021-RFID-AUDIT-VALIDATION-SW                  11009006
110100                                     TO  LBPTDA-CART-ACTN-CDE     11010006
110110       WHEN NOT SU021-AUDIT-IS-COMPLETE                           11011006
110120           MOVE  SU021-AUDIT-VALIDATION-SW                        11012006
110130                                  TO  LBPTDA-CART-ACTN-CDE        11013006
110140       WHEN NOT SU021-RFID-AUDIT-IS-COMPLETE                      11014006
110150           MOVE  SU021-RFID-AUDIT-VALIDATION-SW                   11015006
110160                                  TO  LBPTDA-CART-ACTN-CDE        11016006
110170                                                                  11017006
110180     END-EVALUATE.                                                11018006
110190* CLP 10/24/13 PR5148D END                                        11019006
110200                                                                  11020006
110210     MOVE  PV-BUS-AREA-ID         TO  LBPTDA-BUS-AREA-ID.         11021006
110220     MOVE  PV-SKU-NBR-LBL         TO  LBPTDA-SKU-NBR.             11022006
110230                                                                  11023006
110240     IF SU001-MULTI-LINE                                          11024006
110250         IF LBVRDA-PREPK-ID > 0 OR                                11025006
110260            SU001-ECOMM-DC-REPURPOSE                              11026006
110270            CONTINUE                                              11027006
110280         ELSE                                                     11028006
110290            MOVE ZEROES               TO  LBPTDA-PO-LNE-NBR       11029006
110300                                          XL001-SKU-NBR           11030006
110310                                          LBPTDA-SKU-NBR          11031006
110320            MOVE SPACES               TO  PV-DEPT-NUMBER          11032006
110330                                          PV-CL-NBR               11033006
110340                                          XL001-DEPT-NBR-3CH      11034006
110350                                          XL001-SUB-CL-NBR-2CH    11035006
110360         END-IF                                                   11036006
110370     END-IF.                                                      11037006
110380                                                                  11038006
110390     MOVE  SPACE                 TO  LBPTDA-SU-FRE-ASTRA-IND      11039006
110400     IF PS-DUPLICATE-CARTON                                       11040006
110410         MOVE 'F'               TO  LBPTDA-CART-LBL-TYP-CDE       11041006
110420         MOVE 'DUP CARTN'       TO  LBPTDA-BRCDE-NBR              11042006
110430     ELSE                                                         11043006
110440     IF  SU001-NOT-CRTN-ATT-TO-RCVR                               11044006
110450          IF SU044-NEW-REC-SEQ-NBR > 0 OR                         11045006
110460             PKSLIP-CRE-SRC-CDE = PC-FA                           11046006
110470             MOVE 'C'               TO  LBPTDA-SU-FRE-ASTRA-IND   11047006
110480          ELSE                                                    11048006
110490             MOVE 'R'               TO  LBPTDA-SU-FRE-ASTRA-IND   11049006
110500          END-IF                                                  11050006
110510          MOVE 'F'               TO  LBPTDA-CART-LBL-TYP-CDE      11051006
110520          IF RC040-PROCESS-MSDIRCT-YES                            11052006
110530             MOVE 'PBS MSDRT'       TO  LBPTDA-BRCDE-NBR          11053006
110540          ELSE                                                    11054006
110550             MOVE 'FREE ASTY'       TO  LBPTDA-BRCDE-NBR          11055006
110560          END-IF                                                  11056006
110570     ELSE                                                         11057006
110580     IF  SU001-NOT-CRTN-ATT-TO-TRIP                               11058006
110590          IF SU044-NEW-REC-SEQ-NBR > 0 OR                         11059006
110600             PKSLIP-CRE-SRC-CDE = PC-FA                           11060006
110610             MOVE 'A'               TO  LBPTDA-SU-FRE-ASTRA-IND   11061006
110620          ELSE                                                    11062006
110630             MOVE 'T'               TO  LBPTDA-SU-FRE-ASTRA-IND   11063006
110640          END-IF                                                  11064006
110650          MOVE 'F'               TO  LBPTDA-CART-LBL-TYP-CDE      11065006
110660          IF RC040-PROCESS-MSDIRCT-YES                            11066006
110670             MOVE 'PBS MSDRT'       TO  LBPTDA-BRCDE-NBR          11067006
110680          ELSE                                                    11068006
110690             MOVE 'FREE ASTY'       TO  LBPTDA-BRCDE-NBR          11069006
110700          END-IF                                                  11070006
110710     END-IF                                                       11071006
110720     END-IF                                                       11072006
110730     END-IF.                                                      11073006
110740                                                                  11074006
110750     EVALUATE TRUE                                                11075006
110760        WHEN SU001-ECOMM-DC-REPURPOSE                             11076006
110770          PERFORM 1100-GET-ZONE-DESC                              11077006
110780          PERFORM 7055-CHECK-TKRPRPM-REPURP-LOC                   11078006
110790          MOVE KRPRPM-FUNC-TXT        TO  LBPTDA-BRCDE-NBR        11079006
110800          MOVE 'R'                    TO  LBPTDA-CART-LBL-TYP-CDE 11080006
110810          MOVE 'EC REPR'              TO  LBPTDA-MODU-DESC        11081006
110820          IF PS-WEIGHTS-MEAUSURES-CHECK                           11082006
110830             MOVE 'M'                 TO  LBPTDA-SU-MSSG-DAT-IND  11083006
110840          END-IF                                                  11084006
110850          MOVE SU001-PREPK-ID         TO  LBPTDA-PREPK-ID         11085006
110860        WHEN PS-CARTON-DOESNT-EXIST                               11086006
110870          MOVE 'F'               TO  LBPTDA-CART-LBL-TYP-CDE      11087006
110880          MOVE 'D'                    TO  LBPTDA-SU-FRE-ASTRA-IND 11088006
110890          MOVE 'NOT FOUND'            TO  LBPTDA-BRCDE-NBR        11089006
110900* PB 06/07/2010 BEG                                               11090006
110910* STORE 'WHSE REPLN' AS THE BAR CODE NUMBER IN THE MESSAGE LABEL. 11091006
110920*                                                                 11092006
110930          IF PV-OTBND-CART-YES = 'Y'                              11093006
110940* CLP 04/23/13 PR5148B START                                      11094006
110950             IF PS-RFID-ON-LABEL-YES                              11095006
110960                MOVE 'REPL RFID ' TO LBPTDA-BRCDE-NBR             11096006
110970                MOVE ' '          TO LBPTDA-SU-FRE-ASTRA-IND      11097006
110980             ELSE                                                 11098006
110990                MOVE 'WHSE REPLN' TO LBPTDA-BRCDE-NBR             11099006
111000                MOVE ' '          TO LBPTDA-SU-FRE-ASTRA-IND      11100006
111010             END-IF                                               11101006
111020* CLP 04/23/13 PR5148B END                                        11102006
111030          END-IF                                                  11103006
111040* PB 06/07/2010 END                                               11104006
111050        WHEN PS-UCC128-PKSLIP-ERROR-YES                           11105006
111060          MOVE 'D'                    TO  LBPTDA-SU-FRE-ASTRA-IND 11106006
111070          MOVE '128 ERROR'            TO  LBPTDA-BRCDE-NBR        11107006
111080        WHEN PS-INACTV-PBS-CARTON-YES                             11108006
111090          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 11109006
111100                                          LBPTDA-SU-MSSG-DAT-IND  11110006
111110          IF  SU001-NOT-CRTN-ATT-TO-RCVR OR                       11111006
111120              SU001-NOT-CRTN-ATT-TO-TRIP                          11112006
111130                MOVE 'F/A PBS E'            TO  LBPTDA-BRCDE-NBR  11113006
111140          ELSE                                                    11114006
111150                MOVE 'PBS ERROR'            TO  LBPTDA-BRCDE-NBR  11115006
111160          END-IF                                                  11116006
111170                                                                  11117006
111180          MOVE '*** INACTIVATED ***'  TO  LBPTDA-DEPT-DESC        11118006
111190          MOVE  PV-TSHUNLO-PBS-TMST-R TO  LBPTDA-MAJ-CL-DESC      11119006
111200        WHEN PS-TROUBLE-FOUND                                     11120006
111210          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 11121006
111220          MOVE 'PBS TRBL '            TO  LBPTDA-BRCDE-NBR        11122006
111230                                                                  11123006
111240        WHEN PS-PBS-RTV-ALLOC                                     11124006
111250          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 11125006
111260          MOVE 'PBS RTV  '            TO  LBPTDA-BRCDE-NBR        11126006
111270        WHEN PS-PBS-RTV-NO-ALLOC                                  11127006
111280          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 11128006
111290          MOVE 'NO ALLOC '            TO  LBPTDA-BRCDE-NBR        11129006
111300                                                                  11130006
111310        WHEN PS-PBS-CRTN-RCVR-MISMTCH-YES                         11131006
111320          MOVE 'K'                    TO  LBPTDA-CART-LBL-TYP-CDE 11132006
111330          MOVE 'RC NT PBS'            TO  LBPTDA-BRCDE-NBR        11133006
111340                                                                  11134006
111350        WHEN PS-NO-CASEPK-FND                                     11135006
111360          IF SU001-PKGNG-CDE  = PC-M OR PC-I                      11136006
111370             IF SU001-PREPK-ID > 0                                11137006
111380                MOVE SU001-PREPK-ID  TO  LBPTDA-PREPK-ID          11138006
111390             ELSE                                                 11139006
111400                MOVE SU001-PO-LINE-NBR  TO PURITM-PO-LNE-NBR      11140006
111410                PERFORM 7225-SELECT-TPURITM                       11141006
111420                MOVE PURITM-PO-PREPK-ID TO  LBPTDA-PREPK-ID       11142006
111430             END-IF                                               11143006
111440          END-IF                                                  11144006
111450          MOVE 'NO CASEPK'         TO  LBPTDA-BRCDE-NBR           11145006
111460          MOVE 'I'                    TO  LBPTDA-CART-LBL-TYP-CDE 11146006
111470          MOVE SU001-SUKRF530-MESSAGE TO  LBPTDA-SU-MSSG-DAT-IND  11147006
111480*                                                                 11148006
111490        WHEN PS-PRINT-AUDIT-LABEL                                 11149006
111500          MOVE 'Q'               TO  LBPTDA-CART-LBL-TYP-CDE      11150006
111510*CLP 10/24/13 - START                                             11151006
111520          IF LBPTDA-PRC-MSG-CDE = 'QR'                            11152006
111530              MOVE 'COMBO    '       TO  LBPTDA-BRCDE-NBR         11153006
111540          ELSE                                                    11154006
111550              IF LBPTDA-PRC-MSG-CDE = 'RA'                        11155006
111560                 MOVE 'RF ONLY  '    TO  LBPTDA-BRCDE-NBR         11156006
111570              ELSE                                                11157006
111580                 MOVE 'QCAUDIT '     TO  LBPTDA-BRCDE-NBR         11158006
111590              END-IF                                              11159006
111600          END-IF                                                  11160006
111610*CLP 10/24/13 - END                                               11161006
111620                                                                  11162006
111630        WHEN SU001-WRONG-FCLTY                                    11163006
111640        WHEN PS-ECOMM-STORE-NO-RCVR                               11164006
111650          MOVE 'W'               TO  LBPTDA-CART-LBL-TYP-CDE      11165006
111660          MOVE 'MISDIRECT'       TO  LBPTDA-BRCDE-NBR             11166006
111670     END-EVALUATE                                                 11167006
111680                                                                  11168006
111690     IF PS-ODD-UNT-CRTN-FOUND                                     11169006
111700          MOVE 'O'               TO  LBPTDA-CART-LBL-TYP-CDE      11170006
111710          MOVE 'ODD UNITS'       TO  LBPTDA-BRCDE-NBR             11171006
111720          MOVE 'Y'               TO  LBPTDA-ODD-CART-IND          11172006
111730          MOVE SPACES            TO  PV-VEND-STYL-NAME            11173006
111740     END-IF                                                       11174006
111750                                                                  11175006
111760*CLP 10/24/13 - BEGIN PR#5418D                                    11176006
111770     IF SU021-AUDIT-REQUIRED OR                                   11177006
111780        SU021-RFID-AUDIT-REQUIRED                                 11178006
111790        MOVE  'S'                TO  LBPTDA-CART-LBL-TYP-CDE      11179006
111800                                                                  11180006
111810        MOVE  SU021-AUDIT-NUMBER TO  LBPTDA-BRCDE-NBR             11181006
111820        IF NOT SU021-AUDIT-REQUIRED AND                           11182006
111830                SU021-RFID-AUDIT-REQUIRED                         11183006
111840            MOVE  SU021-RFID-AUDIT-NUMBER TO  LBPTDA-BRCDE-NBR    11184006
111850        END-IF                                                    11185006
111860                                                                  11186006
111870     END-IF                                                       11187006
111880*CLP 10/24/13 -     END PR#5418D                                  11188006
111890                                                                  11189006
111900     IF  SU001-REPRINT                                            11190006
111910           MOVE SU001-REPRINT-IND TO  LBPTDA-RPRT-IND.            11191006
111920* 07/19/13 RLK BEG                                                11192006
111930* IF DC USES RFID CARTON LABEL INSTEAD OF NORMAL SML LABEL        11193006
111940* ANOTHER ROW IS WRITTEN TO THE TLBPTDA TABLE. THIS ROW WILL      11194006
111950* BE PRINTED BY SUKRF527. THE SML ROW CREATED ABOVE WILL BE       11195006
111960* PRINTED BY THE 'FINAL LABEL' PROCESS WHEN THE CARTON LEAVES     11196006
111970* THE FLAT AREA AFTER RFID TAGGING TO DIRECT IT TO THE DOCK.      11197006
111980     IF PV-OTBND-CART-YES = 'Y'                                   11198006
111990       NEXT SENTENCE                                              11199006
112000     ELSE                                                         11200006
112010*CLP 10/24/13 BEGIN                                               11201006
112020     IF SU021-AUDIT-REQUIRED OR                                   11202006
112030        SU021-RFID-AUDIT-REQUIRED                                 11203006
112040*CLP 10/24/13 END                                                 11204006
112050       IF PS-DC-USE-RFID-CART-LBL-YES                             11205006
112060        SET PS-CRTN-LBL-TSHUNLO-NOT-CRTED TO TRUE                 11206006
112070        MOVE SU001-CARTON       TO SHPUNT-SHIPT-UNT-ID            11207006
112080        PERFORM 2262-SELECT-CRTN-LBL-TSHUNLO                      11208006
112090         IF PS-CRTN-LBL-TSHUNLO-NOT-CRTED                         11209006
112100           AND  PV-OTBND-CART-YES = 'N'                           11210006
112110           PERFORM 2275-INSERT-CRTN-LBL-TSHUNLO                   11211006
112120         END-IF                                                   11212006
112130       END-IF                                                     11213006
112140     ELSE                                                         11214006
112150     IF  SU001-REPRINT                                            11215006
112160        MOVE SU001-CARTON       TO SHPUNT-SHIPT-UNT-ID            11216006
112170        SET PS-CRTN-LBL-TSHUNLO-NOT-CRTED TO TRUE                 11217006
112180        PERFORM 2262-SELECT-CRTN-LBL-TSHUNLO                      11218006
112190       IF SHUNLO-SCN-LOC-ID = PC-RFDC                             11219006
112200         PERFORM 3807-DETERMINE-CRTN-LBL                          11220068
112210**       PERFORM 3808-TKRPRPM-RFID-LBL-INFO                       11221068
112220         MOVE KRPRPM-FUNC-TXT (1:6) TO LBPTDA-MODU-DESC           11222006
112230         MOVE KRPRPM-FUNC-TXT (7:4) TO PV-RFID-DIVERT-CDE         11223006
112240         MOVE PV-RFID-DIVERT-CDE    TO PV-22-CRTN-DIVERT-CDE      11224006
112250         MOVE 0                     TO PV-22-CRTN-TYPE-IND        11225006
112260         MOVE SU001-PO              TO PV-22-CRTN-PO-NBR          11226006
112270         MOVE SU001-RCVR-SEQ-NBR    TO PV-22-CTRN-RCVR-SEQ-NBR    11227006
112280         MOVE SU001-PO-LINE-NBR     TO PV-22-CRTN-PO-LNE-NBR      11228006
112281         PERFORM 3812-LAST-4-OF-BARCODE-PARM                      11228181
112282         IF  PS-USE-LAST-4-FROM-TMST                              11228281
112283             PERFORM 3811-GET-LAST-4-OF-BARCODE                   11228381
112290             MOVE PV-CURRENT-TMST-R-LAST-4                        11229081
112291                                    TO PV-22-CRTN-CART-NBR        11229179
112292         ELSE                                                     11229281
112293             MOVE 0000 TO PV-22-CRTN-CART-NBR                     11229381
112294         END-IF                                                   11229481
112300         MOVE SU001-CARTON          TO DK-CTN                     11230006
112310         MOVE PV-22-DIGIT-BARCODE TO LBPTDA-BRCDE-NBR             11231006
112320                                     DK-BARCODE-NBR               11232006
112330         MOVE 'D'                   TO LBPTDA-CART-LBL-TYP-CDE    11233006
112340                                       DK-CART-LBL-TYP-CDE        11234006
112350         MOVE LBPTDA-DEST-OPER-UNT-ID TO DK-DEST-OPER-UNT-ID      11235006
112360       END-IF                                                     11236006
112370     ELSE                                                         11237006
112380     MOVE SU001-CARTON            TO SHPUNT-SHIPT-UNT-ID          11238069
112390     PERFORM 3807-DETERMINE-CRTN-LBL                              11239069
112400     IF  PS-LABEL-PARM-FOUND                                      11240069
112410     AND PS-DC-USE-RFID-CART-LBL-YES                              11241060
112420***    MOVE SU001-CARTON       TO SHPUNT-SHIPT-UNT-ID             11242060
112430***    PERFORM 3808-TKRPRPM-RFID-LBL-INFO                         11243068
112440***    PERFORM 3807-DETERMINE-CRTN-LBL                            11244068
112450       MOVE KRPRPM-FUNC-TXT (1:6) TO LBPTDA-MODU-DESC             11245006
112460       MOVE KRPRPM-FUNC-TXT (7:4) TO PV-RFID-DIVERT-CDE           11246006
112470       MOVE PV-RFID-DIVERT-CDE-N  TO PV-22-CRTN-DIVERT-CDE        11247006
112480       MOVE 0                     TO PV-22-CRTN-TYPE-IND          11248006
112490       MOVE SU001-PO              TO PV-22-CRTN-PO-NBR            11249006
112500       MOVE SU001-RCVR-SEQ-NBR    TO PV-22-CTRN-RCVR-SEQ-NBR      11250006
112510       MOVE SU001-PO-LINE-NBR     TO PV-22-CRTN-PO-LNE-NBR        11251006
112511       PERFORM 3812-LAST-4-OF-BARCODE-PARM                        11251181
112512       IF  PS-USE-LAST-4-FROM-TMST                                11251281
112513           PERFORM 3811-GET-LAST-4-OF-BARCODE                     11251381
112514           MOVE PV-CURRENT-TMST-R-LAST-4                          11251481
112515                                    TO PV-22-CRTN-CART-NBR        11251581
112516       ELSE                                                       11251681
112517           MOVE 0000 TO PV-22-CRTN-CART-NBR                       11251781
112518       END-IF                                                     11251881
112530       MOVE SU001-CARTON          TO DK-CTN                       11253006
112540       MOVE PV-22-DIGIT-BARCODE TO LBPTDA-BRCDE-NBR               11254006
112550                                   DK-BARCODE-NBR                 11255006
112560       MOVE 'D'                   TO LBPTDA-CART-LBL-TYP-CDE      11256006
112570                                     DK-CART-LBL-TYP-CDE          11257006
112580       MOVE LBPTDA-DEST-OPER-UNT-ID TO DK-DEST-OPER-UNT-ID        11258006
112590        SET PS-CRTN-LBL-TSHUNLO-NOT-CRTED TO TRUE                 11259006
112600        MOVE SU001-CARTON       TO SHPUNT-SHIPT-UNT-ID            11260006
112610        PERFORM 2262-SELECT-CRTN-LBL-TSHUNLO                      11261006
112620        IF PS-CRTN-LBL-TSHUNLO-NOT-CRTED                          11262006
112630          PERFORM 2275-INSERT-CRTN-LBL-TSHUNLO                    11263006
112640        END-IF                                                    11264006
112650     END-IF                                                       11265006
112660     END-IF                                                       11266006
112670     END-IF                                                       11267006
112680     END-IF.                                                      11268006
112690* 07/19/13 RLK END                                                11269006
112700                                                                  11270006
112710     EXEC SQL                                                     11271006
112720         INSERT INTO TLBPTDA                                      11272006
112730                ( TRIP_ID                                         11273006
112740                , CRE_USR_ID                                      11274006
112750                , LBL_PRT_BTCH_ID                                 11275006
112760                , SHIPT_UNT_ID                                    11276006
112770                , OPER_UNT_ID                                     11277006
112780                , FCLTY_ID                                        11278006
112790                , CRE_TMST                                        11279006
112800                , OWNR_SCAC_ID                                    11280006
112810                , VEH_NBR                                         11281006
112820                , RPRT_IND                                        11282006
112830                , SU_DUP_LBL_IND                                  11283006
112840                , SU_FRE_ASTRA_IND                                11284006
112850                , SU_MSSG_DAT_IND                                 11285006
112860                , SU_MISDIR_IND                                   11286006
112870                , MISDIR_OPER_UNT_ID                              11287006
112880                , PO_NBR                                          11288006
112890                , RCVR_SEQ_NBR                                    11289006
112900                , PO_LNE_NBR                                      11290006
112910                , DEST_OPER_UNT_ID                                11291006
112920                , STR_NM                                          11292006
112930                , STR_ZN_ID                                       11293006
112940                , SKU_DEPT_NBR                                    11294006
112950                , SKU_CL_NBR                                      11295006
112960                , VS_NBR                                          11296006
112970                , OTPK_UNT_QTY                                    11297006
112980                , INPK_UNT_QTY                                    11298006
112990                , PRTR_ID                                         11299006
113000                , BRCDE_NBR                                       11300006
113010                , DC_PRTD_AT_CDE                                  11301006
113020                , INVLD_DAT_ERR_CDE                               11302006
113030                , PREPK_ID                                        11303006
113040                , PREPK_RATO_QTY                                  11304006
113050                , PREPK_UNT_QTY                                   11305006
113060                , CSE_PK_QTY                                      11306006
113070                , ODD_CART_IND                                    11307006
113080                , INPK_CNVYB_IND                                  11308006
113090                , LBL_TYP_LBL_SEQ_ID                              11309006
113100                , LBL_TYP_TOT_QTY                                 11310006
113110                , MODU_DESC                                       11311006
113120                , ITM_NBR                                         11312006
113130                , DEPT_DESC                                       11313006
113140                , MAJ_CL_DESC                                     11314006
113150                , SEASET_NM                                       11315006
113160                , FIXT_ID                                         11316006
113170                , CART_LBL_TYP_CDE                                11317006
113180                , STRG_AREA_CDE                                   11318006
113190                , CART_ACTN_CDE                                   11319006
113200                , HNG_FOLD_SEQ_NBR                                11320006
113210                , BUS_AREA_ID                                     11321006
113220                , SKU_NBR                                         11322006
113230*CLP 07/06/2015 START                                             11323008
113240                , LBL_MSG_TXT                                     11324006
113250*CLP 07/06/2015 END                                               11325008
113260                , EAS_TAG_IND                                     11326006
113270                , DOOR_ID                                         11327006
113280*CLP 04/23/13 PR5148B START                                       11328006
113290                , PRC_MSG_CDE )                                   11329006
113300*CLP 04/23/13 PR5148B START                                       11330006
113310         VALUES                                                   11331006
113320                ( :LBPTDA-TRIP-ID                                 11332006
113330                , :SU001-USER-ID                                  11333006
113340                , :LBPTDA-LBL-PRT-BTCH-ID                         11334006
113350                , :LBPTDA-SHIPT-UNT-ID                            11335006
113360                , :LBPTDA-OPER-UNT-ID                             11336006
113370                , :LBPTDA-FCLTY-ID                                11337006
113380                ,  CURRENT TIMESTAMP                              11338006
113390                , :SU001-OWNER-SCAC-ID                            11339006
113400                , :SU001-VEH-NBR                                  11340006
113410                , :LBPTDA-RPRT-IND                                11341006
113420                , :SU001-DUPLICATE-IND                            11342006
113430                , :LBPTDA-SU-FRE-ASTRA-IND                        11343006
113440                , :LBPTDA-SU-MSSG-DAT-IND                         11344006
113450                , :SU001-MISDIRECT-IND                            11345006
113460                , :LBPTDA-MISDIR-OPER-UNT-ID                      11346006
113470                , :LBPTDA-PO-NBR                                  11347006
113480                , :LBPTDA-RCVR-SEQ-NBR                            11348006
113490                , :LBPTDA-PO-LNE-NBR                              11349006
113500                , :LBPTDA-DEST-OPER-UNT-ID                        11350006
113510                , :XLT00010-LOC-10-ABBR-NM                        11351006
113520                , :LBPTDA-STR-ZN-ID                               11352006
113530                , :XL001-DEPT-NBR-3CH                             11353006
113540                , :XL001-SUB-CL-NBR-2CH                           11354006
113550                , :PV-VEND-STYL-NAME                              11355006
113560                , :LBPTDA-OTPK-UNT-QTY                            11356006
113570                , :LBPTDA-INPK-UNT-QTY                            11357006
113580                , :SU001-PRINTER-ID                               11358006
113590                , :LBPTDA-BRCDE-NBR                               11359006
113600                , :SU001-DC-PRTD-AT-CDE                           11360006
113610                , :LBPTDA-INVLD-DAT-ERR-CDE                       11361006
113620                , :LBPTDA-PREPK-ID                                11362006
113630                , :LBPTDA-PREPK-RATO-QTY                          11363006
113640                , :LBPTDA-PREPK-UNT-QTY                           11364006
113650                , :LBPTDA-CSE-PK-QTY                              11365006
113660                , :LBPTDA-ODD-CART-IND                            11366006
113670                , :LBPTDA-INPK-CNVYB-IND                          11367006
113680                , :LBPTDA-LBL-TYP-LBL-SEQ-ID                      11368006
113690                , :LBPTDA-LBL-TYP-TOT-QTY                         11369006
113700                , :LBPTDA-MODU-DESC                               11370006
113710                , :LBPTDA-ITM-NBR                                 11371006
113720                , :LBPTDA-DEPT-DESC                               11372006
113730                , :LBPTDA-MAJ-CL-DESC                             11373006
113740                , :LBPTDA-SEASET-NM                               11374006
113750                , :LBPTDA-FIXT-ID                                 11375006
113760                , :LBPTDA-CART-LBL-TYP-CDE                        11376006
113770                , :LBPTDA-STRG-AREA-CDE                           11377006
113780                , :LBPTDA-CART-ACTN-CDE                           11378006
113790                , :LBPTDA-HNG-FOLD-SEQ-NBR                        11379006
113800                , :LBPTDA-BUS-AREA-ID                             11380006
113810                , :LBPTDA-SKU-NBR                                 11381006
113820*CLP 07/06/2015 START                                             11382008
113830                , :LBPTDA-LBL-MSG-TXT                             11383006
113840*CLP 07/06/2015 END                                               11384008
113850                , :LBPTDA-EAS-TAG-IND                             11385006
113860                , :LBPTDA-DOOR-ID                                 11386006
113870*CLP 04/23/13 PR5148B START                                       11387006
113880                , :LBPTDA-PRC-MSG-CDE )                           11388006
113890*CLP 04/23/13 PR5148B END                                         11389006
113900     END-EXEC.                                                    11390006
113910                                                                  11391006
113920     EVALUATE TRUE                                                11392006
113930         WHEN SQLCODE = ZERO                                      11393006
113940              ADD  1  TO  SU001-ROWS-INSERTED                     11394006
113950         IF PV-TEST-CICS OR PV-QA-CICS                            11395068
113960            MOVE SPACE TO PV-CICS-MSG-AREA-A                      11396068
113970            STRING ' SUKRF502: SUCCESSFUL INSERT INTO TLBPTDA '   11397068
113980                   ' SUKRF502: FUNC-TXT ' KRPRPM-FUNC-TXT         11398068
113990            DELIMITED BY SIZE INTO PV-CICS-MSG-AREA-A             11399068
114000            MOVE LENGTH OF PV-CICS-MSG-AREA-A                     11400068
114010                                    TO PV-COMMAREA-LENGTH         11401068
114020            EXEC CICS WRITEQ TD                                   11402068
114030                   QUEUE('CSSL')                                  11403068
114040                   FROM(PV-CICS-MSG-AREA-A)                       11404068
114050                   LENGTH(PV-COMMAREA-LENGTH)                     11405068
114060                  RESP (PV-CICS-RESPONSE)                         11406068
114070           END-EXEC                                               11407068
114080         END-IF                                                   11408068
114090                                                                  11409029
114100         WHEN SQLWARN0 NOT = SPACES                               11410029
114110         WHEN SQLCODE NOT EQUAL ZERO                              11411006
114120                                                                  11412006
114130             MOVE '7205-INSERT-LABEL-TABLE'                       11413006
114140                                       TO DP013-PARAGRAPH         11414006
114150             MOVE ' SUKRF502 - INSERT INTO LABEL PRINT DATA TBL'  11415006
114160                                       TO DP013-MESSAGE-TEXT(1)   11416006
114170             MOVE  SQLCODE             TO  PV-SQLCODE             11417006
114180             STRING ' SQLCODE - '         DELIMITED BY SIZE       11418006
114190                    PV-SQLCODE            DELIMITED BY SIZE       11419006
114200                                     INTO DP013-MESSAGE-TEXT(2)   11420006
114210             MOVE SQLCA                TO DP013-SQLCA             11421006
114220             MOVE 'TLBPTDA'            TO DP013-DB2-TABLE-NAME(1) 11422006
114230             SET  DP013-DB2-ABEND      TO TRUE                    11423006
114240             SET  DP013-ROLLBACK       TO TRUE                    11424006
114250             SET  DP013-XCTL-DISPLAY-RESTART                      11425006
114260                                       TO TRUE                    11426006
114270             PERFORM DP014-0000-PROCESS-ABEND                     11427006
114280                                                                  11428006
114290     END-EVALUATE.                                                11429006
114300                                                                  11430006
114310                                                                  11431006
114320*CLP 07/06/2015 START                                             11432006
114330***************************************************************** 11433006
114340* ONLY BRING BACK AS MANY CHARACTERS UP TO 9 FOR THE BUSINESS     11434006
114350* AREA DESCRIPTION                                                11435006
114360***************************************************************** 11436006
114370 7207-INSPECT-BUS-AREA.                                           11437006
114380                                                                  11438015
114390     MOVE XL073-BUS-AREA-DESC(1:9) TO PV-BUS-AREA-DESC-9.         11439015
114400                                                                  11440015
114410     MOVE +0                               TO PV-DESC-LEN.        11441015
114420     MOVE LENGTH OF PV-BUS-AREA-DESC-9     TO PV-DESC-LEN.        11442015
114430                                                                  11443015
114440     PERFORM                                                      11444015
114450       UNTIL PV-BUS-AREA-DESC-9(PV-DESC-LEN:1) > SPACES OR        11445015
114460         PV-DESC-LEN = +0                                         11446015
114470       COMPUTE PV-DESC-LEN   = PV-DESC-LEN - 1                    11447015
114480     END-PERFORM.                                                 11448015
114490                                                                  11449006
114500     MOVE SPACES  TO  PV-BUS-AREA-BRAND.                          11450006
114510                                                                  11451006
114520     EVALUATE TRUE                                                11452015
114530        WHEN  PV-DESC-LEN   =  9                                  11453015
114540            STRING   PV-BUS-AREA-DESC-9(1:9)                      11454015
114550                                 '-'                              11455015
114560                     XLT00043-BRND-DESC DELIMITED BY SIZE         11456015
114570            INTO  PV-BUS-AREA-BRAND                               11457015
114580        WHEN  PV-DESC-LEN   =  8                                  11458015
114590            STRING   PV-BUS-AREA-DESC-9(1:8)                      11459015
114600                                 '-'                              11460015
114610                     XLT00043-BRND-DESC DELIMITED BY SIZE         11461015
114620            INTO  PV-BUS-AREA-BRAND                               11462015
114630        WHEN  PV-DESC-LEN   =  7                                  11463015
114640            STRING   PV-BUS-AREA-DESC-9(1:7)                      11464015
114650                                 '-'                              11465015
114660                     XLT00043-BRND-DESC DELIMITED BY SIZE         11466015
114670            INTO  PV-BUS-AREA-BRAND                               11467015
114680        WHEN  PV-DESC-LEN   =  6                                  11468015
114690            STRING   PV-BUS-AREA-DESC-9(1:6)                      11469015
114700                                 '-'                              11470015
114710                     XLT00043-BRND-DESC DELIMITED BY SIZE         11471015
114720            INTO  PV-BUS-AREA-BRAND                               11472015
114730        WHEN  PV-DESC-LEN   =  5                                  11473015
114740            STRING   PV-BUS-AREA-DESC-9(1:5)                      11474016
114750                                 '-'                              11475015
114760                     XLT00043-BRND-DESC DELIMITED BY SIZE         11476015
114770            INTO  PV-BUS-AREA-BRAND                               11477015
114780        WHEN  PV-DESC-LEN   =  4                                  11478015
114790            STRING   PV-BUS-AREA-DESC-9(1:4)                      11479015
114800                                 '-'                              11480015
114810                     XLT00043-BRND-DESC DELIMITED BY SIZE         11481015
114820            INTO  PV-BUS-AREA-BRAND                               11482015
114830        WHEN  PV-DESC-LEN   =  3                                  11483015
114840            STRING   PV-BUS-AREA-DESC-9(1:3)                      11484015
114850                                 '-'                              11485015
114860                     XLT00043-BRND-DESC DELIMITED BY SIZE         11486015
114870            INTO  PV-BUS-AREA-BRAND                               11487015
114880        WHEN  PV-DESC-LEN   =  2                                  11488015
114890            STRING   PV-BUS-AREA-DESC-9(1:2)                      11489015
114900                                 '-'                              11490015
114910                     XLT00043-BRND-DESC DELIMITED BY SIZE         11491015
114920            INTO  PV-BUS-AREA-BRAND                               11492015
114930        WHEN  PV-DESC-LEN   =  1                                  11493015
114940            STRING   PV-BUS-AREA-DESC-9(1:1)                      11494015
114950                                 '-'                              11495015
114960                     XLT00043-BRND-DESC DELIMITED BY SIZE         11496015
114970            INTO  PV-BUS-AREA-BRAND                               11497015
114980        WHEN  OTHER                                               11498015
114990*           NO BUSINESS AREA AVAILABLE                            11499015
115000            STRING   PV-BUS-AREA-DESC-9(1:9)                      11500015
115010                                 '-'                              11501015
115020                     XLT00043-BRND-DESC DELIMITED BY SIZE         11502015
115030            INTO  PV-BUS-AREA-BRAND                               11503015
115040     END-EVALUATE.                                                11504015
115050                                                                  11505009
115060*CLP 07/06/15 END                                                 11506008
115070*----------------------------------------------------------------*11507006
115080*                                                                *11508006
115090*----------------------------------------------------------------*11509006
115100 7210-GET-STORE-INFO.                                             11510006
115110                                                                  11511006
115120     MOVE  SU001-STORE TO  DK-STORE.                              11512006
115130                                                                  11513006
115140     EXEC SQL                                                     11514006
115150          SELECT  LOC_10_ABBR_NM                                  11515006
115160                , LOC_TYP_CDE                                     11516006
115170                , E_BUS_IND                                       11517006
115180          INTO    :XLT00010-LOC-10-ABBR-NM                        11518006
115190                , :XLT00010-LOC-TYP-CDE                           11519006
115200                , :XLT00010-E-BUS-IND :PV-NULL-E-BUS-IND          11520006
115210          FROM   XLT_LOC                                          11521006
115220          WHERE  LOC_NBR   = :DK-STORE                            11522006
115230     END-EXEC.                                                    11523006
115240                                                                  11524006
115250     EVALUATE TRUE                                                11525006
115260         WHEN SQLCODE = ZERO                                      11526006
115270           IF PV-NULL-E-BUS-IND = -1                              11527006
115280              MOVE 'N' TO XLT00010-E-BUS-IND                      11528006
115290           END-IF                                                 11529006
115300                                                                  11530006
115310           IF XLT00010-LOC-TYP-CDE = 'DS' AND                     11531006
115320              XLT00010-E-BUS-IND    = 'Y'                         11532006
115330                SET PS-OPER-IS-ECOMM-DS TO TRUE                   11533006
115340           END-IF                                                 11534006
115350                                                                  11535006
115360           IF XLT00010-LOC-TYP-CDE = 'DC' AND                     11536006
115370              XLT00010-E-BUS-IND    = 'Y'                         11537006
115380                SET PS-OPER-IS-ECOMM-DC TO TRUE                   11538006
115390           END-IF                                                 11539006
115400                                                                  11540006
115410         WHEN SQLCODE = +100                                      11541006
115420              MOVE 'INVALID   ' TO  XLT00010-LOC-10-ABBR-NM       11542006
115430                                                                  11543006
115440         WHEN SQLWARN0 NOT = SPACES                               11544006
115450         WHEN SQLCODE NOT EQUAL ZERO                              11545006
115460             MOVE '7210-GET-STORE-INFO'                           11546006
115470                             TO DP013-PARAGRAPH                   11547006
115480             MOVE 'SUKRF502 - GET STORE INFOMATION'               11548006
115490                             TO DP013-MESSAGE-TEXT(1)             11549006
115500             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         11550006
115510             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           11551006
115520             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            11552006
115530             STRING ' TRIP - '            DELIMITED BY SIZE       11553006
115540                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       11554006
115550                    '  CARTON - '         DELIMITED BY SIZE       11555006
115560                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       11556006
115570                    '  STORE - '          DELIMITED BY SIZE       11557006
115580                    PV-DISPLAY-STORE      DELIMITED BY SIZE       11558006
115590                             INTO DP013-MESSAGE-TEXT (2)          11559006
115600             MOVE SQLCA      TO DP013-SQLCA                       11560006
115610             MOVE 'XLT00010' TO DP013-DB2-TABLE-NAME(1)           11561006
115620             SET DP013-DB2-ABEND                                  11562006
115630                             TO TRUE                              11563006
115640             SET DP013-ROLLBACK                                   11564006
115650                             TO TRUE                              11565006
115660             SET DP013-XCTL-DISPLAY-RESTART                       11566006
115670                             TO TRUE                              11567006
115680             PERFORM DP014-0000-PROCESS-ABEND                     11568006
115690     END-EVALUATE.                                                11569006
115700                                                                  11570006
115710                                                                  11571006
115720*----------------------------------------------------------------*11572006
115730*                                                                *11573006
115740*----------------------------------------------------------------*11574006
115750 7215-GET-ECOMM-DC-INFO.                                          11575006
115760                                                                  11576006
115770     EXEC SQL                                                     11577006
115780          SELECT  LOC_TYP_CDE                                     11578006
115790                , E_BUS_IND                                       11579006
115800          INTO    :XLT00010-LOC-TYP-CDE                           11580006
115810                , :XLT00010-E-BUS-IND :PV-NULL-E-BUS-IND          11581006
115820          FROM   XLT_LOC                                          11582006
115830          WHERE  LOC_NBR   = :DK-OPER-UNT-ID                      11583006
115840     END-EXEC.                                                    11584006
115850                                                                  11585006
115860     EVALUATE TRUE                                                11586006
115870         WHEN SQLCODE = ZERO                                      11587006
115880           IF PV-NULL-E-BUS-IND = -1                              11588006
115890              MOVE 'N' TO XLT00010-E-BUS-IND                      11589006
115900           END-IF                                                 11590006
115910           IF XLT00010-LOC-TYP-CDE = 'DC' AND                     11591006
115920              XLT00010-E-BUS-IND    = 'Y'                         11592006
115930                SET PS-OPER-IS-ECOMM-DC TO TRUE                   11593006
115940           END-IF                                                 11594006
115950                                                                  11595006
115960           IF XLT00010-LOC-TYP-CDE = 'DS' AND                     11596006
115970              XLT00010-E-BUS-IND    = 'Y'                         11597006
115980                SET PS-OPER-IS-ECOMM-DS TO TRUE                   11598006
115990           END-IF                                                 11599006
116000                                                                  11600006
116010         WHEN SQLCODE = +100                                      11601006
116020              MOVE 'INVALID   ' TO  XLT00010-LOC-10-ABBR-NM       11602006
116030                                                                  11603006
116040         WHEN SQLWARN0 NOT = SPACES                               11604006
116050         WHEN SQLCODE NOT EQUAL ZERO                              11605006
116060             MOVE '7215-GET-ECOMM-DC-INFO'                        11606006
116070                             TO DP013-PARAGRAPH                   11607006
116080             MOVE 'SUKRF502 - GET STORE INFOMATION'               11608006
116090                             TO DP013-MESSAGE-TEXT(1)             11609006
116100             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         11610006
116110             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           11611006
116120             MOVE  SU001-OPER-UNT-ID  TO  PV-DISPLAY-STORE        11612006
116130             STRING ' TRIP - '            DELIMITED BY SIZE       11613006
116140                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       11614006
116150                    '  CARTON - '         DELIMITED BY SIZE       11615006
116160                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       11616006
116170                    '  STORE - '          DELIMITED BY SIZE       11617006
116180                    PV-DISPLAY-STORE      DELIMITED BY SIZE       11618006
116190                             INTO DP013-MESSAGE-TEXT (2)          11619006
116200             MOVE SQLCA      TO DP013-SQLCA                       11620006
116210             MOVE 'XLT00010' TO DP013-DB2-TABLE-NAME(1)           11621006
116220             SET DP013-DB2-ABEND                                  11622006
116230                             TO TRUE                              11623006
116240             SET DP013-ROLLBACK                                   11624006
116250                             TO TRUE                              11625006
116260             SET DP013-XCTL-DISPLAY-RESTART                       11626006
116270                             TO TRUE                              11627006
116280             PERFORM DP014-0000-PROCESS-ABEND                     11628006
116290     END-EVALUATE.                                                11629006
116300                                                                  11630006
116310                                                                  11631006
116320 7218-SELECT-RCVR-CRE-OPER.                                       11632006
116330                                                                  11633006
116340     MOVE SU001-PO             TO DK-PO.                          11634006
116350     MOVE SU001-RCVR-SEQ-NBR   TO DK-REC-SEQ-NBR.                 11635006
116360                                                                  11636006
116370     EXEC SQL                                                     11637006
116380         SELECT  OPER_UNT_ID                                      11638006
116390         INTO   :RECEIV-OPER-UNT-ID                               11639006
116400         FROM   TRECEIV                                           11640006
116410         WHERE  ORD_NBR        = :DK-PO                           11641006
116420           AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  11642006
116430     END-EXEC.                                                    11643006
116440                                                                  11644006
116450     EVALUATE TRUE                                                11645006
116460         WHEN SQLCODE = ZERO                                      11646006
116470         WHEN SQLCODE = +100                                      11647006
116480             CONTINUE                                             11648006
116490         WHEN SQLWARN0 NOT = SPACES                               11649006
116500         WHEN SQLCODE NOT EQUAL ZERO                              11650006
116510             MOVE '7218-SELECT-RCVR-CRE-OPER'                     11651006
116520                             TO DP013-PARAGRAPH                   11652006
116530             MOVE 'SUKRF502 - CHECK TRECEIV '                     11653006
116540                             TO DP013-MESSAGE-TEXT(1)             11654006
116550             MOVE SHPUNT-SHIPT-UNT-ID                             11655006
116560                             TO DP013-MESSAGE-TEXT(2)             11656006
116570             MOVE SQLCA      TO DP013-SQLCA                       11657006
116580             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           11658006
116590             SET DP013-DB2-ABEND                                  11659006
116600                             TO TRUE                              11660006
116610             SET DP013-ROLLBACK                                   11661006
116620                             TO TRUE                              11662006
116630             SET DP013-XCTL-DISPLAY-RESTART                       11663006
116640                             TO TRUE                              11664006
116650             PERFORM DP014-0000-PROCESS-ABEND                     11665006
116660     END-EVALUATE.                                                11666006
116670                                                                  11667006
116680                                                                  11668006
116690 7220-SELECT-TPURCHS.                                             11669006
116700                                                                  11670006
116710     EXEC SQL                                                     11671006
116720         SELECT  PKGNG_CDE                                        11672006
116730               , PO_TYP_CDE                                       11673006
116740               , SEASET_YR                                        11674006
116750               , SEASET_SHRT_NM                                   11675006
116760         INTO    :PURCHS-PKGNG-CDE                                11676006
116770               , :PURCHS-PO-TYP-CDE                               11677006
116780               , :PURCHS-SEASET-YR                                11678006
116790               , :PURCHS-SEASET-SHRT-NM                           11679006
116800         FROM   TPURCHS                                           11680006
116810         WHERE  PO_NBR         = :DK-PO                           11681006
116820           AND  VER_STATUS_CDE = 'A'                              11682006
116830     END-EXEC.                                                    11683006
116840                                                                  11684006
116850     EVALUATE TRUE                                                11685006
116860         WHEN SQLCODE = ZERO                                      11686006
116870             CONTINUE                                             11687006
116880         WHEN SQLWARN0 NOT = SPACES                               11688006
116890         WHEN SQLCODE NOT EQUAL ZERO                              11689006
116900             MOVE '7220-SELECT-TPURCHS'                           11690006
116910                             TO DP013-PARAGRAPH                   11691006
116920             MOVE 'SUKRF502 - CHECK TPURCHS '                     11692006
116930                             TO DP013-MESSAGE-TEXT(1)             11693006
116940             MOVE SHPUNT-SHIPT-UNT-ID                             11694006
116950                             TO DP013-MESSAGE-TEXT(2)             11695006
116960             MOVE SQLCA      TO DP013-SQLCA                       11696006
116970             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME(1)           11697006
116980             SET DP013-DB2-ABEND                                  11698006
116990                             TO TRUE                              11699006
117000             SET DP013-ROLLBACK                                   11700006
117010                             TO TRUE                              11701006
117020             SET DP013-XCTL-DISPLAY-RESTART                       11702006
117030                             TO TRUE                              11703006
117040             PERFORM DP014-0000-PROCESS-ABEND                     11704006
117050     END-EVALUATE.                                                11705006
117060                                                                  11706006
117070                                                                  11707006
117080                                                                  11708006
117090                                                                  11709006
117100 7225-SELECT-TPURITM.                                             11710006
117110                                                                  11711006
117120     EXEC SQL                                                     11712006
117130         SELECT  PO_PREPK_ID                                      11713006
117140               , UNT_RTL_PR_AMT                                   11714006
117150         INTO   :PURITM-PO-PREPK-ID                               11715006
117160              , :PURITM-UNT-RTL-PR-AMT                            11716006
117170         FROM   TPURITM                                           11717006
117180         WHERE  PO_NBR            = :DK-PO                        11718006
117190           AND  APP_PO_LNE_NBR    = :PURITM-PO-LNE-NBR            11719006
117200           AND  VER_STATUS_CDE    = 'A'                           11720006
117210     END-EXEC.                                                    11721006
117220                                                                  11722006
117230     EVALUATE TRUE                                                11723006
117240         WHEN SQLCODE = ZERO                                      11724006
117250         WHEN SQLCODE = +100                                      11725006
117260             CONTINUE                                             11726006
117270         WHEN SQLWARN0 NOT = SPACES                               11727006
117280         WHEN SQLCODE NOT EQUAL ZERO                              11728006
117290             MOVE '7225-SELECT-TPURITM'                           11729006
117300                             TO DP013-PARAGRAPH                   11730006
117310             MOVE 'SUKRF502 - CHECK TPURITM '                     11731006
117320                             TO DP013-MESSAGE-TEXT(1)             11732006
117330             MOVE SHPUNT-SHIPT-UNT-ID                             11733006
117340                             TO DP013-MESSAGE-TEXT(2)             11734006
117350             MOVE SQLCA      TO DP013-SQLCA                       11735006
117360             MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME(1)           11736006
117370             SET DP013-DB2-ABEND                                  11737006
117380                             TO TRUE                              11738006
117390             SET DP013-ROLLBACK                                   11739006
117400                             TO TRUE                              11740006
117410             SET DP013-XCTL-DISPLAY-RESTART                       11741006
117420                             TO TRUE                              11742006
117430             PERFORM DP014-0000-PROCESS-ABEND                     11743006
117440     END-EVALUATE.                                                11744006
117450                                                                  11745006
117460                                                                  11746006
117470                                                                  11747006
117480                                                                  11748006
117490                                                                  11749006
117500*----------------------------------------------------------------*11750006
117510 7230-GET-DEPT-CL-SKU.                                            11751006
117520     INITIALIZE       PV-DEPT-NUMBER-LBL                          11752006
117530                      PV-INNR-PACK-QTY                            11753006
117540                      PV-CL-NBR-LBL                               11754006
117550                      PV-SKU-NBR-LBL.                             11755006
117560*                     PV-VEND-STYL-NAME.                          11756006
117570                                                                  11757006
117580     MOVE  SU001-PO           TO DK-PO.                           11758006
117590     MOVE  SU001-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                  11759006
117600     MOVE  SU001-PO-LINE-NBR  TO DK-PO-LNE-NBR.                   11760006
117610                                                                  11761006
117620     EXEC SQL                                                     11762006
117630         SELECT A.DEPT_NBR                                        11763006
117640               ,C.INNR_PACK_QTY                                   11764006
117650               ,C.ITM_NBR                                         11765006
117660               ,D.CL_NBR                                          11766006
117670               ,D.VEND_STYL_NAME                                  11767006
117680               ,D.PO_PREPK_ID                                     11768006
117690           INTO :PV-DEPT-NUMBER,                                  11769006
117700                :PV-INNR-PACK-QTY,                                11770006
117710                :RECITM-ITM-NBR,                                  11771006
117720                :PV-CL-NBR,                                       11772006
117730                :PV-VEND-STYL-NAME ,                              11773006
117740                :PURITM-PO-PREPK-ID                               11774006
117750           FROM TPURCHS A                                         11775006
117760               ,TVNDDPT B                                         11776006
117770               ,TRECITM C                                         11777006
117780               ,TPURITM D                                         11778006
117790          WHERE A.PO_NBR         =  :DK-PO                        11779006
117800            AND A.VER_STATUS_CDE =  'A'                           11780006
117810            AND A.ENT_ID         =  B.ENT_ID                      11781006
117820            AND A.DEPT_NBR       =  B.DEPT_NBR                    11782006
117830            AND C.ORD_NBR        =  A.PO_NBR                      11783006
117840            AND C.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR               11784006
117850            AND C.ORD_NBR        =  D.PO_NBR                      11785006
117860            AND C.ORD_LNE_NBR    =  :DK-PO-LNE-NBR                11786006
117870            AND C.ORD_LNE_NBR    =  D.APP_PO_LNE_NBR              11787006
117880            AND C.VER_STATUS_CDE =  'A'                           11788006
117890            AND C.PO_VER_NBR     =  D.VER_NBR                     11789006
117900     END-EXEC                                                     11790006
117910                                                                  11791006
117920     EVALUATE TRUE                                                11792006
117930         WHEN SQLCODE = ZERO                                      11793006
117940              PERFORM 7240-CALL-XLKUT-DOMAIN                      11794006
117950              MOVE  XL001-DEPT-NBR-3CH   TO PV-DEPT-NUMBER-LBL    11795006
117960              MOVE  XL001-SUB-CL-NBR-2CH TO PV-CL-NBR-LBL         11796006
117970              MOVE  XL001-SKU-NBR        TO PV-SKU-NBR-LBL        11797006
117980                                            PV-SKU-OUT-9          11798006
117990         WHEN SQLCODE = +100                                      11799006
118000              SET  SU001-INVLD-MTCH-PO-LNE TO TRUE                11800006
118010              MOVE  'NO ITM#'       TO  PV-SKU-OUT                11801006
118020                                                                  11802006
118030         WHEN SQLWARN0 NOT = SPACES                               11803006
118040         WHEN SQLCODE NOT EQUAL ZERO                              11804006
118050             MOVE '7230-GET-DEPT-CL-SKU'                          11805006
118060                             TO DP013-PARAGRAPH                   11806006
118070             MOVE 'SUKRF502 - GET DEPT/CL/SKU/INPK INFO'          11807006
118080                             TO DP013-MESSAGE-TEXT(1)             11808006
118090             MOVE  SU001-PO         TO  PV-DISPLAY-PO             11809006
118100             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       11810006
118110             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     11811006
118120             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       11812006
118130                    PV-DISPLAY-PO         DELIMITED BY SIZE       11813006
118140                    ' - '                 DELIMITED BY SIZE       11814006
118150                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       11815006
118160                    ' - '                 DELIMITED BY SIZE       11816006
118170                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       11817006
118180                             INTO DP013-MESSAGE-TEXT (2)          11818006
118190             MOVE SQLCA      TO DP013-SQLCA                       11819006
118200             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME(1)           11820006
118210             MOVE 'TVNDDPT'  TO DP013-DB2-TABLE-NAME(2)           11821006
118220             SET DP013-DB2-ABEND                                  11822006
118230                             TO TRUE                              11823006
118240             SET DP013-ROLLBACK                                   11824006
118250                             TO TRUE                              11825006
118260             SET DP013-XCTL-DISPLAY-RESTART                       11826006
118270                             TO TRUE                              11827006
118280             PERFORM DP014-0000-PROCESS-ABEND                     11828006
118290     END-EVALUATE.                                                11829006
118300                                                                  11830006
118310                                                                  11831006
118320*----------------------------------------------------------------*11832006
118330*                                                                *11833006
118340*----------------------------------------------------------------*11834006
118350 7233-CHECK-EAS-TAG.                                              11835006
118360                                                                  11836006
118370                                                                  11837006
118380     MOVE PURITM-UNT-RTL-PR-AMT TO SFT00000-BEG-PRPT-AMT.         11838006
118390                                                                  11839006
118400     EXEC SQL                                                     11840006
118410          SELECT DEPT_NBR                                         11841006
118420          INTO  :SFT00000-DEPT-NBR                                11842006
118430          FROM   SFT_EAS_TG_MDSE                                  11843006
118440          WHERE ( DEPT_NBR        = :XL001-DEPT-NBR               11844006
118450                AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR             11845006
118460                AND SUB_CL_NBR    = :XL001-SUB-CL-NBR )           11846006
118470            OR  ( DEPT_NBR        = :XL001-DEPT-NBR               11847006
118480                AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR             11848006
118490                AND SUB_CL_NBR IS NULL )                          11849006
118500            AND BEG_PRPT_AMT      <= :SFT00000-BEG-PRPT-AMT       11850006
118510     END-EXEC.                                                    11851006
118520                                                                  11852006
118530     EVALUATE TRUE                                                11853006
118540         WHEN SQLCODE = ZERO                                      11854006
118550              SET PS-EAS-TAG-IND-FOUND-YES TO TRUE                11855006
118560         WHEN SQLCODE = +100                                      11856006
118570              SET PS-EAS-TAG-IND-FOUND-NO  TO TRUE                11857006
118580         WHEN SQLWARN0 NOT = SPACES                               11858006
118590         WHEN SQLCODE NOT EQUAL ZERO                              11859006
118600             MOVE XL001-DEPT-NBR  TO PV-DISPLAY-DEPT              11860006
118610             MOVE XL001-MAJ-CL-NBR TO PV-DISPLAY-CLASS            11861006
118620             MOVE '7233-CHECK-EAS-TAG '                           11862006
118630                             TO DP013-PARAGRAPH                   11863006
118640             MOVE 'SUKRF502 - GET EAS TAG IND   '                 11864006
118650                             TO DP013-MESSAGE-TEXT(1)             11865006
118660             MOVE  SU001-PO         TO  PV-DISPLAY-PO             11866006
118670             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       11867006
118680             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     11868006
118690             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       11869006
118700                    PV-DISPLAY-PO         DELIMITED BY SIZE       11870006
118710                    '-'                   DELIMITED BY SIZE       11871006
118720                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       11872006
118730                    '-'                   DELIMITED BY SIZE       11873006
118740                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       11874006
118750                    '  DPT/CL/SKU - '     DELIMITED BY SIZE       11875006
118760                    PV-DISPLAY-DEPT       DELIMITED BY SIZE       11876006
118770                    '-'                   DELIMITED BY SIZE       11877006
118780                    PV-DISPLAY-CLASS      DELIMITED BY SIZE       11878006
118790                             INTO DP013-MESSAGE-TEXT (2)          11879006
118800             MOVE SQLCA      TO DP013-SQLCA                       11880006
118810             MOVE 'SFT_EAS_TG_MDSE'  TO DP013-DB2-TABLE-NAME(1)   11881006
118820             SET DP013-DB2-ABEND                                  11882006
118830                             TO TRUE                              11883006
118840             SET DP013-ROLLBACK                                   11884006
118850                             TO TRUE                              11885006
118860             SET DP013-XCTL-DISPLAY-RESTART                       11886006
118870                             TO TRUE                              11887006
118880             PERFORM DP014-0000-PROCESS-ABEND                     11888006
118890     END-EVALUATE.                                                11889006
118900                                                                  11890006
118910*----------------------------------------------------------------*11891006
118920*                                                                *11892006
118930*----------------------------------------------------------------*11893006
118940 7234-GET-CURRENT-DOOR.                                           11894006
118950                                                                  11895006
118960     MOVE SU001-STORE TO CNDRST-STR-NBR.                          11896006
118970     MOVE SU001-OPER-UNT-ID TO CNDCDR-OPER-UNT-ID.                11897006
118980                                                                  11898006
118990     EXEC SQL                                                     11899006
119000          SELECT A.DOOR_ID                                        11900006
119010          INTO   :CNDCDR-DOOR-ID                                  11901006
119020          FROM   TCNDCDR A                                        11902006
119030               , TCNDRST B                                        11903006
119040          WHERE  A.DOOR_ID         = B.DOOR_ID                    11904006
119050            AND  A.OPER_UNT_ID     = :CNDCDR-OPER-UNT-ID          11905006
119060            AND  A.OPER_UNT_ID     = B.OPER_UNT_ID                11906006
119070            AND  A.DOOR_TYP_CDE    = 'SH'                         11907006
119080            AND  B.STR_NBR         = :CNDRST-STR-NBR              11908006
119090            AND  B.END_TMST        = '9999-09-09-09.09.09.999999' 11909006
119100            AND  NOT   (DOOR_LOC_DESC  LIKE  '%UPS%'     OR       11910006
119110                        DOOR_LOC_DESC  LIKE  '%VIRTUAL%' OR       11911006
119120                        DOOR_LOC_DESC  LIKE  '%RE-OPEN%'          11912006
119130                       )                                          11913006
119140     END-EXEC.                                                    11914006
119150                                                                  11915006
119160     EVALUATE TRUE                                                11916006
119170         WHEN SQLCODE = ZERO                                      11917006
119180              CONTINUE                                            11918006
119190         WHEN SQLCODE = +100                                      11919006
119200         WHEN SQLCODE = -811                                      11920006
119210              MOVE SPACES TO CNDCDR-DOOR-ID                       11921006
119220         WHEN SQLWARN0 NOT = SPACES                               11922006
119230         WHEN SQLCODE NOT EQUAL ZERO                              11923006
119240             MOVE '7234-GET-CURRENT-DOOR '                        11924006
119250                             TO DP013-PARAGRAPH                   11925006
119260             MOVE 'SUKRF502 - SEL CURRENT DOOR ID '               11926006
119270                             TO DP013-MESSAGE-TEXT(1)             11927006
119280             MOVE  SU001-PO         TO  PV-DISPLAY-PO             11928006
119290             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       11929006
119300             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     11930006
119310             MOVE  SU001-STORE       TO PV-DISPLAY-STORE          11931006
119320             STRING ' PO/RCVR/STORE'      DELIMITED BY SIZE       11932006
119330                    PV-DISPLAY-PO         DELIMITED BY SIZE       11933006
119340                    '-'                   DELIMITED BY SIZE       11934006
119350                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       11935006
119360                    '-'                   DELIMITED BY SIZE       11936006
119370                    PV-DISPLAY-STORE      DELIMITED BY SIZE       11937006
119380                             INTO DP013-MESSAGE-TEXT (2)          11938006
119390             MOVE SQLCA      TO DP013-SQLCA                       11939006
119400             MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME(1)           11940006
119410             SET DP013-DB2-ABEND                                  11941006
119420                             TO TRUE                              11942006
119430             SET DP013-ROLLBACK                                   11943006
119440                             TO TRUE                              11944006
119450             SET DP013-XCTL-DISPLAY-RESTART                       11945006
119460                             TO TRUE                              11946006
119470             PERFORM DP014-0000-PROCESS-ABEND                     11947006
119480     END-EVALUATE.                                                11948006
119490                                                                  11949006
119500*----------------------------------------------------------------*11950006
119510*                                                                *11951006
119520*----------------------------------------------------------------*11952006
119530 7235-GET-OUTER-PACK.                                             11953006
119540                                                                  11954006
119550     MOVE SU001-CARTON           TO   DK-CTN.                     11955006
119560                                                                  11956006
119570     EXEC SQL                                                     11957006
119580          SELECT  SUM(SHPD_QTY)                                   11958006
119590            INTO :PV-SHIPPED-QTY                                  11959006
119600            FROM  TSHUUPC                                         11960006
119610           WHERE  SHIPT_UNT_ID  = :DK-CTN                         11961006
119620     END-EXEC                                                     11962006
119630                                                                  11963006
119640     EVALUATE TRUE                                                11964006
119650         WHEN SQLCODE = ZERO                                      11965006
119660              MOVE PV-SHIPPED-QTY  TO  PV-OUTR-PACK-QTY           11966006
119670                                                                  11967006
119680         WHEN SQLWARN0 NOT = SPACES                               11968006
119690         WHEN SQLCODE NOT EQUAL ZERO                              11969006
119700             MOVE '7235-GET-OUTER-PACK'                           11970006
119710                             TO DP013-PARAGRAPH                   11971006
119720             MOVE 'SUKRF502 - GET OUTER PACK QTY'                 11972006
119730                             TO DP013-MESSAGE-TEXT(1)             11973006
119740             MOVE  SU001-PO         TO  PV-DISPLAY-PO             11974006
119750             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       11975006
119760             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     11976006
119770             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       11977006
119780                    PV-DISPLAY-PO         DELIMITED BY SIZE       11978006
119790                    '-'                   DELIMITED BY SIZE       11979006
119800                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       11980006
119810                    '-'                   DELIMITED BY SIZE       11981006
119820                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       11982006
119830                    '  DPT/CL/SKU - '     DELIMITED BY SIZE       11983006
119840                    PV-DEPT-NUMBER        DELIMITED BY SIZE       11984006
119850                    '-'                   DELIMITED BY SIZE       11985006
119860                    PV-CL-NBR             DELIMITED BY SIZE       11986006
119870                             INTO DP013-MESSAGE-TEXT (2)          11987006
119880             MOVE SQLCA      TO DP013-SQLCA                       11988006
119890             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           11989006
119900             SET DP013-DB2-ABEND                                  11990006
119910                             TO TRUE                              11991006
119920             SET DP013-ROLLBACK                                   11992006
119930                             TO TRUE                              11993006
119940             SET DP013-XCTL-DISPLAY-RESTART                       11994006
119950                             TO TRUE                              11995006
119960             PERFORM DP014-0000-PROCESS-ABEND                     11996006
119970     END-EVALUATE.                                                11997006
119980                                                                  11998006
119990*----------------------------------------------------------------*11999006
120000*                                                                *12000006
120010*----------------------------------------------------------------*12001006
120020*CLP 07/06/2015 START                                             12002006
120030 7236-CHECK-BRAND.                                                12003006
120040                                                                  12004006
120050     MOVE XL001-SKU-NBR TO XLT00003-SKU-NBR.                      12005006
120060                                                                  12006006
120070     EXEC SQL                                                     12007006
120080        SELECT  BRND_DESC                                         12008006
120090         INTO   :XLT00043-BRND-DESC                               12009006
120100          FROM  XLT_SKU      A                                    12010006
120110             ,  XLT_VND_STYL B                                    12011006
120120             ,  XLT_BRND     C                                    12012006
120130         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            12013006
120140           AND  A.STYL_ID         =  B.STYL_ID                    12014006
120150           AND  B.BRND_ID         =  C.BRND_ID                    12015006
120160           AND  C.BRND_ID         >  0                            12016018
120170         WITH UR                                                  12017006
120180     END-EXEC.                                                    12018006
120190                                                                  12019006
120200     EVALUATE TRUE                                                12020006
120210         WHEN SQLCODE = ZERO                                      12021006
120220              SET PS-BRAND-FOUND-YES TO TRUE                      12022006
120230         WHEN SQLCODE = +100                                      12023006
120240              SET PS-BRAND-FOUND-NO TO TRUE                       12024006
120250         WHEN SQLWARN0 NOT = SPACES                               12025006
120260         WHEN SQLCODE NOT EQUAL ZERO                              12026006
120270             MOVE '7236-CHECK-BRAND '                             12027006
120280                             TO DP013-PARAGRAPH                   12028006
120290             MOVE 'SUKRF502 - GET OUTER PACK QTY'                 12029006
120300                             TO DP013-MESSAGE-TEXT(1)             12030006
120310             MOVE  SU001-PO         TO  PV-DISPLAY-PO             12031006
120320             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       12032006
120330             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     12033006
120340             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       12034006
120350                    PV-DISPLAY-PO         DELIMITED BY SIZE       12035006
120360                    '-'                   DELIMITED BY SIZE       12036006
120370                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       12037006
120380                    '-'                   DELIMITED BY SIZE       12038006
120390                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       12039006
120400                    '  DPT/CL/SKU - '     DELIMITED BY SIZE       12040006
120410                    PV-DEPT-NUMBER        DELIMITED BY SIZE       12041006
120420                    '-'                   DELIMITED BY SIZE       12042006
120430                    PV-CL-NBR             DELIMITED BY SIZE       12043006
120440                             INTO DP013-MESSAGE-TEXT (2)          12044006
120450             MOVE SQLCA      TO DP013-SQLCA                       12045006
120460             MOVE 'XLT_BRND        '  TO DP013-DB2-TABLE-NAME(1)  12046006
120470             SET DP013-DB2-ABEND                                  12047006
120480                             TO TRUE                              12048006
120490             SET DP013-ROLLBACK                                   12049006
120500                             TO TRUE                              12050006
120510             SET DP013-XCTL-DISPLAY-RESTART                       12051006
120520                             TO TRUE                              12052006
120530             PERFORM DP014-0000-PROCESS-ABEND                     12053006
120540     END-EVALUATE.                                                12054006
120550*CLP 07/06/2015 END                                               12055006
120560                                                                  12056006
120570                                                                  12057006
120580 7240-CALL-XLKUT-DOMAIN.                                          12058006
120590     INITIALIZE XL001-ITEM-COMMAREA.                              12059006
120600                                                                  12060006
120610     MOVE RECITM-ITM-NBR        TO XL001-KEY-ITM-NBR.             12061006
120620                                                                  12062006
120630     SET  XL001-BY-ITEM                                           12063006
120640          XL001-SELECT-SKU                                        12064006
120650          XL001-SELECT-VND-STYL TO TRUE.                          12065006
120660                                                                  12066006
120670     CALL XL001-VSM-PGM USING  DFHEIBLK                           12067006
120680                               XL001-COMMAREA                     12068006
120690                               XL001-ITEM-COMMAREA.               12069006
120700     EVALUATE TRUE                                                12070006
120710                                                                  12071006
120720         WHEN XL001-SKU-SQLCODE = +0                              12072009
120730             CONTINUE                                             12073006
120740                                                                  12074006
120750         WHEN XL001-SKU-SQLCODE = +100                            12075006
120760             MOVE SPACES              TO XL001-DEPT-NBR-3CH       12076006
120770                                         XL001-SUB-CL-NBR-2CH     12077006
120780             MOVE ZEROES              TO XL001-SKU-NBR            12078006
120790                                                                  12079006
120800         WHEN XL001-INVALID-ACCESS                                12080006
120810             MOVE '7240-CALL-XLKUT-DOMAIN'                        12081006
120820                             TO DP013-PARAGRAPH                   12082006
120830             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            12083006
120840                             TO DP013-MESSAGE-TEXT (1)            12084006
120850             MOVE RECITM-ITM-NBR                                  12085006
120860                             TO PV-DISPLAY-ITM-NBR                12086006
120870             MOVE PV-DISPLAY-ITM-NBR                              12087006
120880                             TO DP013-MESSAGE-TEXT (2)            12088006
120890             MOVE SQLCA      TO DP013-SQLCA                       12089006
120900             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          12090006
120910             SET DP013-DB2-ABEND                                  12091006
120920                 DP013-XCTL-DISPLAY-RESTART                       12092006
120930                             TO TRUE                              12093006
120940             PERFORM DP014-0000-PROCESS-ABEND                     12094006
120950                                                                  12095006
120960         WHEN OTHER                                               12096006
120970             MOVE '7240-CALL-XLKUT-DOMAIN'                        12097006
120980                             TO DP013-PARAGRAPH                   12098006
120990             MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'                12099006
121000                             TO DP013-MESSAGE-TEXT (1)            12100006
121010             MOVE RECITM-ITM-NBR                                  12101006
121020                             TO PV-DISPLAY-ITM-NBR                12102006
121030             MOVE PV-DISPLAY-ITM-NBR                              12103006
121040                             TO DP013-MESSAGE-TEXT (2)            12104006
121050             MOVE XL001-SKU-SQLCODE                               12105006
121060                             TO SQLCODE                           12106006
121070             MOVE SQLCA      TO DP013-SQLCA                       12107006
121080             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          12108006
121090             SET DP013-DB2-ABEND                                  12109006
121100                 DP013-XCTL-DISPLAY-RESTART                       12110006
121110                             TO TRUE                              12111006
121120             PERFORM DP014-0000-PROCESS-ABEND                     12112006
121130     END-EVALUATE.                                                12113006
121140                                                                  12114006
121150*----------------------------------------------------------------*12115006
121160 7245-CALL-XLKUT-DOMAIN-BY-UPC.                                   12116006
121170     INITIALIZE XL001-ITEM-COMMAREA.                              12117006
121180                                                                  12118006
121190     MOVE SHUUPC-UPC-NBR        TO XL001-KEY-UPC-NBR.             12119006
121200                                                                  12120006
121210     SET  XL001-BY-UPC-NBR                                        12121006
121220          XL001-SELECT-SKU                                        12122006
121230          XL001-SELECT-VND-STYL TO TRUE.                          12123006
121240                                                                  12124006
121250     IF SU001-ECOMM-DC-REPURPOSE                                  12125006
121260        SET XL001-SELECT-WEB-SKU TO TRUE                          12126006
121270     END-IF                                                       12127006
121280                                                                  12128006
121290     CALL XL001-VSM-PGM USING  DFHEIBLK                           12129006
121300                               XL001-COMMAREA                     12130006
121310                               XL001-ITEM-COMMAREA.               12131006
121320     EVALUATE TRUE                                                12132006
121330                                                                  12133006
121340         WHEN XL001-SUCCESSFUL                                    12134006
121350             CONTINUE                                             12135006
121360         WHEN XL001-UPC-NOT-FOUND                                 12136006
121370                MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR                    12137006
121380                SET  PS-EO-HANG-FOLD-CSR                          12138006
121390                     PS-WEIGHTS-MEAUSURES-CHECK TO TRUE           12139006
121400         WHEN XL001-WEB-ITEM-NOT-FOUND                            12140006
121410                SET  PS-WEIGHTS-MEAUSURES-CHECK TO TRUE           12141006
121420         WHEN XL001-INVALID-ACCESS                                12142006
121430             MOVE '7245-CALL-XLKUT-DOMAIN-BY-UPC'                 12143006
121440                             TO DP013-PARAGRAPH                   12144006
121450             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            12145006
121460                             TO DP013-MESSAGE-TEXT (1)            12146006
121470             MOVE SHUUPC-UPC-NBR                                  12147006
121480                             TO PV-DISPLAY-ITM-NBR                12148006
121490             MOVE PV-DISPLAY-ITM-NBR                              12149006
121500                             TO DP013-MESSAGE-TEXT (2)            12150006
121510             MOVE SQLCA      TO DP013-SQLCA                       12151006
121520             MOVE 'XLV_UPC'  TO DP013-DB2-TABLE-NAME (1)          12152006
121530             SET DP013-DB2-ABEND                                  12153006
121540                 DP013-XCTL-DISPLAY-RESTART                       12154006
121550                             TO TRUE                              12155006
121560             PERFORM DP014-0000-PROCESS-ABEND                     12156006
121570                                                                  12157006
121580         WHEN OTHER                                               12158006
121590             MOVE '7245-CALL-XLKUT-DOMAIN-BY-UPC'                 12159006
121600                             TO DP013-PARAGRAPH                   12160006
121610             MOVE 'UNSUCCESSFUL SELECT ON XLV_UPC'                12161006
121620                             TO DP013-MESSAGE-TEXT (1)            12162006
121630             MOVE SHUUPC-UPC-NBR                                  12163006
121640                             TO PV-DISPLAY-ITM-NBR                12164006
121650             MOVE PV-DISPLAY-ITM-NBR                              12165006
121660                             TO DP013-MESSAGE-TEXT (2)            12166006
121670             MOVE XL001-SKU-SQLCODE                               12167006
121680                             TO SQLCODE                           12168006
121690             MOVE SQLCA      TO DP013-SQLCA                       12169006
121700             MOVE 'XLV_UPC'  TO DP013-DB2-TABLE-NAME (1)          12170006
121710             SET DP013-DB2-ABEND                                  12171006
121720                 DP013-XCTL-DISPLAY-RESTART                       12172006
121730                             TO TRUE                              12173006
121740             PERFORM DP014-0000-PROCESS-ABEND                     12174006
121750     END-EVALUATE.                                                12175006
121760                                                                  12176006
121770*----------------------------------------------------------------*12177006
121780*  GET MANIFEST FROM PCKCS721.                                   *12178006
121790*----------------------------------------------------------------*12179006
121800 7250-LINK-PCKCS721.                                              12180006
121810                                                                  12181006
121820     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   12182006
121830                                                                  12183006
121840     EXEC CICS                                                    12184006
121850         LINK PROGRAM  (PV-PCKCS721)                              12185006
121860              COMMAREA (PC187-COMMAREA-REC)                       12186006
121870              LENGTH   (PV-COMMAREA-LENGTH)                       12187006
121880              RESP     (PV-CICS-RESPONSE)                         12188006
121890     END-EXEC.                                                    12189006
121900                                                                  12190006
121910     EVALUATE TRUE                                                12191006
121920         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12192006
121930              IF  PC187-CRA-SUCCESSFUL                            12193006
121940                  CONTINUE                                        12194006
121950              ELSE                                                12195006
121960                  SET PV-DONE-PROCESSING          TO TRUE         12196006
121970                  MOVE SQLCODE              TO PV-SQLCODE         12197006
121980                  STRING ' PCKCS707 - '        DELIMITED BY SIZE  12198006
121990                         '7250-LINK-PCKCS721 ' DELIMITED BY SIZE  12199006
122000                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  12200006
122010                         PC187-CRA-RET-MSG     DELIMITED BY SIZE  12201006
122020                         '  PARA-'             DELIMITED BY SIZE  12202006
122030                         PC187-CRA-REQ-ID      DELIMITED BY SIZE  12203006
122040                                          INTO PV-CICS-MSG-AREA   12204006
122050                  MOVE LENGTH OF PV-CICS-MSG-AREA                 12205006
122060                                            TO PV-COMMAREA-LENGTH 12206006
122070                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          12207006
122080                                                                  12208006
122090                  MOVE '7250-LINK-PCKCS721   '                    12209006
122100                                  TO DP013-PARAGRAPH              12210006
122110                  MOVE 'LINK TO PCKCS721               '          12211006
122120                                  TO DP013-MESSAGE-TEXT(1)        12212006
122130                  STRING 'MSG - '        DELIMITED BY SIZE        12213006
122140                         PC187-CRA-RET-MSG DELIMITED BY SIZE      12214006
122150                                  INTO DP013-MESSAGE-TEXT (2)     12215006
122160                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          12216006
122170                                    TO DP013-MESSAGE-TEXT (3)     12217006
122180                  MOVE SU001-MANIFEST TO PV-DISPLAY-MANIFEST      12218006
122190                  MOVE SU001-CARTON TO PV-DISPLAY-CARTON          12219006
122200                  MOVE SU001-STORE TO PV-DISPLAY-STORE            12220006
122210                  STRING ' TRIP - '       DELIMITED BY SIZE       12221006
122220                         PV-DISPLAY-MANIFEST DELIMITED BY SIZE    12222006
122230                         '  CARTON - '    DELIMITED BY SIZE       12223006
122240                         PV-DISPLAY-CARTON DELIMITED BY SIZE      12224006
122250                         '  STORE - '     DELIMITED BY SIZE       12225006
122260                         PV-DISPLAY-STORE DELIMITED BY SIZE       12226006
122270                                  INTO DP013-MESSAGE-TEXT (4)     12227006
122280                  MOVE SQLCA TO DP013-SQLCA                       12228006
122290                  SET DP013-DB2-ABEND                             12229006
122300                                  TO TRUE                         12230006
122310                  SET DP013-ROLLBACK                              12231006
122320                                  TO TRUE                         12232006
122330                  SET DP013-XCTL-DISPLAY-RESTART                  12233006
122340                                  TO TRUE                         12234006
122350                  PERFORM DP014-0000-PROCESS-ABEND                12235006
122360              END-IF                                              12236006
122370         WHEN OTHER                                               12237006
122380              SET PV-DONE-PROCESSING          TO TRUE             12238006
122390              MOVE SQLCODE              TO PV-SQLCODE             12239006
122400              STRING ' PCKCS707 (OTHER) -' DELIMITED BY SIZE      12240006
122410                     '7250-LINK-PCKCS721 ' DELIMITED BY SIZE      12241006
122420                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      12242006
122430                     PC187-CRA-RET-MSG     DELIMITED BY SIZE      12243006
122440                     '  PARA-'             DELIMITED BY SIZE      12244006
122450                     PC187-CRA-REQ-ID      DELIMITED BY SIZE      12245006
122460                                      INTO PV-CICS-MSG-AREA       12246006
122470              MOVE LENGTH OF PV-CICS-MSG-AREA                     12247006
122480                                        TO PV-COMMAREA-LENGTH     12248006
122490              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12249006
122500                                                                  12250006
122510              MOVE '7250-LINK-PCKCS721   '                        12251006
122520                              TO DP013-PARAGRAPH                  12252006
122530              MOVE 'LINK TO PCKCS721               '              12253006
122540                              TO DP013-MESSAGE-TEXT(1)            12254006
122550              STRING 'MSG - '            DELIMITED BY SIZE        12255006
122560                     PC187-CRA-RET-MSG   DELIMITED BY SIZE        12256006
122570                              INTO DP013-MESSAGE-TEXT (2)         12257006
122580              MOVE 'CHECK CSSL FOR MORE DETAIL     '              12258006
122590                                TO DP013-MESSAGE-TEXT (3)         12259006
122600              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         12260006
122610              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           12261006
122620              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            12262006
122630              STRING ' TRIP - '           DELIMITED BY SIZE       12263006
122640                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       12264006
122650                     '  CARTON - '        DELIMITED BY SIZE       12265006
122660                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       12266006
122670                     '  STORE - '         DELIMITED BY SIZE       12267006
122680                     PV-DISPLAY-STORE     DELIMITED BY SIZE       12268006
122690                              INTO DP013-MESSAGE-TEXT (4)         12269006
122700              MOVE SQLCA     TO DP013-SQLCA                       12270006
122710              SET DP013-DB2-ABEND                                 12271006
122720                              TO TRUE                             12272006
122730              SET DP013-ROLLBACK                                  12273006
122740                              TO TRUE                             12274006
122750              SET DP013-XCTL-DISPLAY-RESTART                      12275006
122760                              TO TRUE                             12276006
122770              PERFORM DP014-0000-PROCESS-ABEND                    12277006
122780     END-EVALUATE.                                                12278006
122790                                                                  12279006
122800                                                                  12280006
122810*----------------------------------------------------------------*12281006
122820*  LINK TO SUKCS583 TO DETERMINE IF THE CARTON NEEDS TO BE AUDITED12282006
122830*----------------------------------------------------------------*12283006
122840 7260-LINK-SUKCS583.                                              12284006
122850                                                                  12285006
122860     MOVE LENGTH OF SU021-CARTON-AUDIT-RECORD                     12286006
122870                                   TO PV-COMMAREA-LENGTH.         12287006
122880                                                                  12288006
122890     EXEC CICS                                                    12289006
122900         LINK PROGRAM  (PV-SUKCS583)                              12290006
122910              COMMAREA (SU021-CARTON-AUDIT-RECORD)                12291006
122920              LENGTH   (PV-COMMAREA-LENGTH)                       12292006
122930              RESP     (PV-CICS-RESPONSE)                         12293006
122940     END-EXEC.                                                    12294006
122950                                                                  12295006
122960     EVALUATE TRUE                                                12296006
122970         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12297006
122980              IF  SU021-INVALID-REQUEST OR                        12298006
122990                  SU021-DB2-ERROR                                 12299006
123000                  SET PV-DONE-PROCESSING          TO TRUE         12300006
123010                  MOVE SQLCODE              TO PV-SQLCODE         12301006
123020                  STRING ' SUKRF502 - '        DELIMITED BY SIZE  12302006
123030                         '7260-LINK-SUKCS583 ' DELIMITED BY SIZE  12303006
123040                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  12304006
123050                         SU021-AUDIT-VALIDATION-SW                12305006
123060                                               DELIMITED BY SIZE  12306006
123070                                          INTO PV-CICS-MSG-AREA   12307006
123080                  MOVE LENGTH OF PV-CICS-MSG-AREA                 12308006
123090                                            TO PV-COMMAREA-LENGTH 12309006
123100                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          12310006
123110                                                                  12311006
123120                                                                  12312006
123130                  MOVE '7260-LINK-SUKCS583'                       12313006
123140                                  TO DP013-PARAGRAPH              12314006
123150                  MOVE 'LINK TO SUKCS583               '          12315006
123160                                  TO DP013-MESSAGE-TEXT(1)        12316006
123170                  STRING 'MSG - '            DELIMITED BY SIZE    12317006
123180                         SU021-AUDIT-VALIDATION-SW                12318006
123190                                             DELIMITED BY SIZE    12319006
123200                                  INTO DP013-MESSAGE-TEXT (2)     12320006
123210                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          12321006
123220                                    TO DP013-MESSAGE-TEXT (3)     12322006
123230                  MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON        12323006
123240                  MOVE  SU001-PO      TO PV-DISPLAY-PO            12324006
123250                  MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR  12325006
123260                  MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR12326006
123270                  STRING '  CARTON - '        DELIMITED BY SIZE   12327006
123280                         PV-DISPLAY-CARTON    DELIMITED BY SIZE   12328006
123290                         ' PO, RCVR, LINE '   DELIMITED BY SIZE   12329006
123300                         PV-DISPLAY-PO        DELIMITED BY SIZE   12330006
123310                         ' '                  DELIMITED BY SIZE   12331006
123320                         PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE   12332006
123330                         ' '                  DELIMITED BY SIZE   12333006
123340                         PV-DISPLAY-PO-LNE-NBR                    12334006
123350                                              DELIMITED BY SIZE   12335006
123360                                  INTO DP013-MESSAGE-TEXT (4)     12336006
123370                  MOVE SQLCA     TO DP013-SQLCA                   12337006
123380                  SET DP013-DB2-ABEND                             12338006
123390                                  TO TRUE                         12339006
123400                  SET DP013-ROLLBACK                              12340006
123410                                  TO TRUE                         12341006
123420                  SET DP013-XCTL-DISPLAY-RESTART                  12342006
123430                                  TO TRUE                         12343006
123440                  PERFORM DP014-0000-PROCESS-ABEND                12344006
123450              END-IF                                              12345006
123460         WHEN OTHER                                               12346006
123470              SET PV-DONE-PROCESSING          TO TRUE             12347006
123480              MOVE SQLCODE              TO PV-SQLCODE             12348006
123490              STRING ' PCKCS707 (OTHER) -' DELIMITED BY SIZE      12349006
123500                     '7260-LINK-SUKCS583 ' DELIMITED BY SIZE      12350006
123510                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      12351006
123520                     SU021-AUDIT-VALIDATION-SW                    12352006
123530                                           DELIMITED BY SIZE      12353006
123540                                      INTO PV-CICS-MSG-AREA       12354006
123550              MOVE LENGTH OF PV-CICS-MSG-AREA                     12355006
123560                                        TO PV-COMMAREA-LENGTH     12356006
123570              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12357006
123580                                                                  12358006
123590              MOVE '7260-LINK-SUKCS583'                           12359006
123600                              TO DP013-PARAGRAPH                  12360006
123610              MOVE 'LINK TO SUKCS583               '              12361006
123620                              TO DP013-MESSAGE-TEXT(1)            12362006
123630              STRING 'MSG - '            DELIMITED BY SIZE        12363006
123640                     SU021-AUDIT-VALIDATION-SW                    12364006
123650                                         DELIMITED BY SIZE        12365006
123660                              INTO DP013-MESSAGE-TEXT (2)         12366006
123670              MOVE 'CHECK CSSL FOR MORE DETAIL     '              12367006
123680                                TO DP013-MESSAGE-TEXT (3)         12368006
123690              MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON            12369006
123700              MOVE  SU001-PO      TO PV-DISPLAY-PO                12370006
123710              MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR      12371006
123720              MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR    12372006
123730              STRING '  CARTON - '        DELIMITED BY SIZE       12373006
123740                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       12374006
123750                     ' PO, RCVR, LINE '   DELIMITED BY SIZE       12375006
123760                     PV-DISPLAY-PO        DELIMITED BY SIZE       12376006
123770                     ' '                  DELIMITED BY SIZE       12377006
123780                     PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE       12378006
123790                     ' '                  DELIMITED BY SIZE       12379006
123800                     PV-DISPLAY-PO-LNE-NBR                        12380006
123810                                          DELIMITED BY SIZE       12381006
123820                              INTO DP013-MESSAGE-TEXT (4)         12382006
123830              MOVE SQLCA     TO DP013-SQLCA                       12383006
123840              SET DP013-DB2-ABEND                                 12384006
123850                              TO TRUE                             12385006
123860              SET DP013-ROLLBACK                                  12386006
123870                              TO TRUE                             12387006
123880              SET DP013-XCTL-DISPLAY-RESTART                      12388006
123890                              TO TRUE                             12389006
123900              PERFORM DP014-0000-PROCESS-ABEND                    12390006
123910     END-EVALUATE.                                                12391006
123920                                                                  12392006
123930                                                                  12393006
123940*CLP 10/24/13 - BEGIN PR#5148D                                    12394006
123950*----------------------------------------------------------------*12395006
123960*  LINK TO SUKCS720 TO DETERMINE IF THE CARTON NEEDS TO BE RFID   12396006
123970*  AUDITED                                                        12397006
123980*----------------------------------------------------------------*12398006
123990 7265-LINK-SUKCS720.                                              12399006
124000                                                                  12400006
124010     MOVE LENGTH OF SU021-CARTON-AUDIT-RECORD                     12401006
124020                                   TO PV-COMMAREA-LENGTH.         12402006
124030                                                                  12403006
124040     EXEC CICS                                                    12404006
124050         LINK PROGRAM  (PV-SUKCS720)                              12405006
124060              COMMAREA (SU021-CARTON-AUDIT-RECORD)                12406006
124070              LENGTH   (PV-COMMAREA-LENGTH)                       12407006
124080              RESP     (PV-CICS-RESPONSE)                         12408006
124090     END-EXEC.                                                    12409006
124100                                                                  12410006
124110     EVALUATE TRUE                                                12411006
124120         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12412006
124130              IF  SU021-RFID-INVALID-REQUEST OR                   12413006
124140                  SU021-RFID-DB2-ERROR                            12414006
124150                  SET PV-DONE-PROCESSING          TO TRUE         12415006
124160                  MOVE SQLCODE              TO PV-SQLCODE         12416006
124170                  STRING ' SUKRF502 - '        DELIMITED BY SIZE  12417006
124180                         '7265-LINK-SUKCS720 ' DELIMITED BY SIZE  12418006
124190                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  12419006
124200                         SU021-RFID-AUDIT-VALIDATION-SW           12420006
124210                                               DELIMITED BY SIZE  12421006
124220                                          INTO PV-CICS-MSG-AREA   12422006
124230                  MOVE LENGTH OF PV-CICS-MSG-AREA                 12423006
124240                                            TO PV-COMMAREA-LENGTH 12424006
124250                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          12425006
124260                                                                  12426006
124270                                                                  12427006
124280                  MOVE '7265-LINK-SUKCS720'                       12428006
124290                                  TO DP013-PARAGRAPH              12429006
124300                  MOVE 'LINK TO SUKCS720               '          12430006
124310                                  TO DP013-MESSAGE-TEXT(1)        12431006
124320                  STRING 'MSG - '            DELIMITED BY SIZE    12432006
124330                         SU021-RFID-AUDIT-VALIDATION-SW           12433006
124340                                             DELIMITED BY SIZE    12434006
124350                                  INTO DP013-MESSAGE-TEXT (2)     12435006
124360                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          12436006
124370                                    TO DP013-MESSAGE-TEXT (3)     12437006
124380                  MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON        12438006
124390                  MOVE  SU001-PO      TO PV-DISPLAY-PO            12439006
124400                  MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR  12440006
124410                  MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR12441006
124420                  STRING '  CARTON - '        DELIMITED BY SIZE   12442006
124430                         PV-DISPLAY-CARTON    DELIMITED BY SIZE   12443006
124440                         ' PO, RCVR, LINE '   DELIMITED BY SIZE   12444006
124450                         PV-DISPLAY-PO        DELIMITED BY SIZE   12445006
124460                         ' '                  DELIMITED BY SIZE   12446006
124470                         PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE   12447006
124480                         ' '                  DELIMITED BY SIZE   12448006
124490                         PV-DISPLAY-PO-LNE-NBR                    12449006
124500                                              DELIMITED BY SIZE   12450006
124510                                  INTO DP013-MESSAGE-TEXT (4)     12451006
124520                  MOVE SQLCA     TO DP013-SQLCA                   12452006
124530                  SET DP013-DB2-ABEND                             12453006
124540                                  TO TRUE                         12454006
124550                  SET DP013-ROLLBACK                              12455006
124560                                  TO TRUE                         12456006
124570                  SET DP013-XCTL-DISPLAY-RESTART                  12457006
124580                                  TO TRUE                         12458006
124590                  PERFORM DP014-0000-PROCESS-ABEND                12459006
124600              END-IF                                              12460006
124610         WHEN OTHER                                               12461006
124620              SET PV-DONE-PROCESSING          TO TRUE             12462006
124630              MOVE SQLCODE              TO PV-SQLCODE             12463006
124640              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      12464006
124650                     '7265-LINK-SUKCS720 ' DELIMITED BY SIZE      12465006
124660                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      12466006
124670                     SU021-RFID-AUDIT-VALIDATION-SW               12467006
124680                                           DELIMITED BY SIZE      12468006
124690                                      INTO PV-CICS-MSG-AREA       12469006
124700              MOVE LENGTH OF PV-CICS-MSG-AREA                     12470006
124710                                        TO PV-COMMAREA-LENGTH     12471006
124720              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12472006
124730                                                                  12473006
124740              MOVE '7265-LINK-SUKCS720'                           12474006
124750                              TO DP013-PARAGRAPH                  12475006
124760              MOVE 'LINK TO SUKCS720               '              12476006
124770                              TO DP013-MESSAGE-TEXT(1)            12477006
124780              STRING 'MSG - '            DELIMITED BY SIZE        12478006
124790                     SU021-RFID-AUDIT-VALIDATION-SW               12479006
124800                                         DELIMITED BY SIZE        12480006
124810                              INTO DP013-MESSAGE-TEXT (2)         12481006
124820              MOVE 'CHECK CSSL FOR MORE DETAIL     '              12482006
124830                                TO DP013-MESSAGE-TEXT (3)         12483006
124840              MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON            12484006
124850              MOVE  SU001-PO      TO PV-DISPLAY-PO                12485006
124860              MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR      12486006
124870              MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR    12487006
124880              STRING '  CARTON - '        DELIMITED BY SIZE       12488006
124890                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       12489006
124900                     ' PO, RCVR, LINE '   DELIMITED BY SIZE       12490006
124910                     PV-DISPLAY-PO        DELIMITED BY SIZE       12491006
124920                     ' '                  DELIMITED BY SIZE       12492006
124930                     PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE       12493006
124940                     ' '                  DELIMITED BY SIZE       12494006
124950                     PV-DISPLAY-PO-LNE-NBR                        12495006
124960                                          DELIMITED BY SIZE       12496006
124970                              INTO DP013-MESSAGE-TEXT (4)         12497006
124980              MOVE SQLCA     TO DP013-SQLCA                       12498006
124990              SET DP013-DB2-ABEND                                 12499006
125000                              TO TRUE                             12500006
125010              SET DP013-ROLLBACK                                  12501006
125020                              TO TRUE                             12502006
125030              SET DP013-XCTL-DISPLAY-RESTART                      12503006
125040                              TO TRUE                             12504006
125050              PERFORM DP014-0000-PROCESS-ABEND                    12505006
125060     END-EVALUATE.                                                12506006
125070*CLP 10/24/13 -     END PR#5148D                                  12507006
125080*----------------------------------------------------------------*12508006
125090* AUTOMATIC START OF LABEL PRINT TRANSACTION                     *12509006
125100*----------------------------------------------------------------*12510006
125110 7300-START-LABEL-PRINT.                                          12511006
125120                                                                  12512006
125130     SET  SU001-LBL-PRT-AT-SCAN TO TRUE.                          12513006
125140                                                                  12514006
125150     EXEC CICS                                                    12515006
125160          START TRANSID (PC-SU-LBL-PRT-TRANS)                     12516006
125170               FROM (SU001-COMMON-DATA)                           12517006
125180     END-EXEC.                                                    12518006
125190                                                                  12519006
125200     SET  SU001-PROCESS-SCREEN TO TRUE.                           12520006
125210                                                                  12521006
125220*----------------------------------------------------------------*12522006
125230* AUTOMATIC START OF CHECK FOR TRIGGER OF                        *12523006
125240* CONFIRMATION/VERIFICATION  (SUKUT707)                          *12524006
125250*----------------------------------------------------------------*12525006
125260 7350-START-VERIF-TRIGGER.                                        12526006
125270      INITIALIZE RC041-FIELDS.                                    12527006
125280      MOVE SU001-PO           TO RC041-PO-NBR                     12528006
125290      MOVE SU001-RCVR-SEQ-NBR TO RC041-REC-SEQ-NBR                12529006
125300      MOVE SU001-CURR-OPER-UNT-ID TO RC041-OPER-UNT-ID            12530006
125310      MOVE SU001-USER-ID      TO RC041-USER-ID                    12531006
125320      MOVE PC-CURRENT-PROGRAM-NAME TO RC041-PROGRAM-NAME          12532006
125330                                                                  12533006
125340      MOVE SU001-PO-LINE-NBR  TO RC041-PO-LNE-NBR                 12534006
125350      MOVE SU001-PREPK-ID     TO RC041-PREPACK-ID                 12535006
125360                                                                  12536006
125370      IF SU001-PACK-BY-STORE                                      12537006
125380         SET RC041-PBS TO TRUE                                    12538006
125390      ELSE                                                        12539006
125400         MOVE SU001-PKGNG-CDE TO RC041-PKGNG-CDE                  12540006
125410      END-IF                                                      12541006
125420                                                                  12542006
125430     EXEC CICS                                                    12543006
125440          START TRANSID (PC-SU-CRTN-VERIF-TRIGGER)                12544006
125450               FROM (RC041-FIELDS)                                12545006
125460     END-EXEC.                                                    12546006
125470                                                                  12547006
125480                                                                  12548006
125490*----------------------------------------------------------------*12549006
125500* GET DEPT NAME & MAJOR CLASS DESCRIPTION                         12550006
125510*----------------------------------------------------------------*12551006
125520 7400-GET-DEPT-NAME.                                              12552006
125530     PERFORM 7405-GET-CURRENT-DATE.                               12553006
125540                                                                  12554006
125550     SET DP003-MCL-LOOKUP              TO TRUE.                   12555006
125560     SET DP003-DPT-LOOKUP              TO TRUE.                   12556006
125570     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      12557006
125580     MOVE '03'                         TO DP003-OP-CO-NMBR.       12558006
125590     MOVE PV-CURRENT-YY                TO PV-DPKUT038-YY.         12559006
125600     MOVE PV-CURRENT-MM                TO PV-DPKUT038-MM.         12560006
125610     MOVE PV-CURRENT-DD                TO PV-DPKUT038-DD          12561006
125620     MOVE PV-DPKUT038-DATE             TO DP003-CURRENT-DATE      12562006
125630                                          DP003-EFF-DATE.         12563006
125640                                                                  12564006
125650     MOVE PV-DEPT-NUMBER               TO DP003-DPT-INPUT.        12565006
125660     MOVE PV-CL-NBR                    TO PV-DPKUT038-MJR-CL.     12566006
125670     MOVE ZERO                         TO PV-DPKUT038-MJR-CL-2.   12567006
125680     MOVE PV-DPKUT038-MJR-CL           TO DP003-MCL-INPUT.        12568006
125690                                                                  12569006
125700     EXEC CICS                                                    12570006
125710         LINK PROGRAM  (PV-DPKUT038)                              12571006
125720              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              12572006
125730              LENGTH   (PV-DPKUT038-CA-LENGTH)                    12573006
125740              RESP     (PV-DPKUT038-CICS-RESP)                    12574006
125750     END-EXEC.                                                    12575006
125760                                                                  12576006
125770     EVALUATE TRUE                                                12577006
125780         WHEN PV-DPKUT038-CICS-RESP = DFHRESP (NORMAL)            12578006
125790              MOVE DP003-DPT-DESCRIPTION TO PV-DEPT-DESC          12579006
125800              MOVE DP003-MCL-DESCRIPTION TO PV-MAJ-CL-DESC        12580006
125840         WHEN OTHER                                               12584006
125850              MOVE SPACES          TO   PV-DEPT-DESC              12585006
125860                                        PV-MAJ-CL-DESC            12586006
125890     END-EVALUATE.                                                12589006
125900*-----------------------------------------------------------------12590006
125910*  GET CURRENT DATE                                               12591006
125920*-----------------------------------------------------------------12592006
125930 7405-GET-CURRENT-DATE.                                           12593006
125940                                                                  12594006
125950     EXEC SQL                                                     12595006
125960         SELECT  CURRENT DATE                                     12596006
125970                ,CURRENT TIME                                     12597006
125980           INTO  :PV-CURRENT-DATE                                 12598006
125990                ,:PV-CURRENT-TIME                                 12599006
126000           FROM  TCOCNTL                                          12600006
126010          WHERE  OPER_UNT_ID = 90                                 12601006
126020     END-EXEC.                                                    12602006
126030                                                                  12603006
126040                                                                  12604006
126050*----------------------------------------------------------------*12605006
126060* POPULATE TLBPTDA PRIOR TO INSERT TO TABLE                       12606006
126070*----------------------------------------------------------------*12607006
126080 7500-POPULATE-TLBPTDA-BULK.                                      12608006
126090                                                                  12609006
126100     INITIALIZE  DCLTLBPTDA.                                      12610006
126110                                                                  12611006
126120     IF PS-PRINT-AUDIT-LABEL                                      12612006
126130        MOVE 'Q'                    TO LBPTDA-CART-LBL-TYP-CDE    12613006
126140     ELSE                                                         12614006
126150        MOVE LBVRDA-CART-LBL-TYP-CDE TO LBPTDA-CART-LBL-TYP-CDE   12615006
126160     END-IF                                                       12616006
126170                                                                  12617006
126180     IF LBVRDA-CART-LBL-TYP-CDE = 'P'                             12618006
126190        SET SU001-P2L-LBL-CREATED   TO TRUE                       12619006
126200     END-IF.                                                      12620006
126210     MOVE LBVRDA-DEST-OPER-UNT-ID   TO PV-STORE.                  12621006
126220     MOVE LBVRDA-PREPK-ID           TO LBPTDA-PREPK-ID            12622006
126230     MOVE LBVRDA-PREPK-RATO-QTY     TO LBPTDA-PREPK-RATO-QTY.     12623006
126240     MOVE LBVRDA-PREPK-UNT-QTY      TO LBPTDA-PREPK-UNT-QTY.      12624006
126250     MOVE LBVRDA-INPK-UNT-QTY       TO LBPTDA-INPK-UNT-QTY.       12625006
126260     MOVE LBVRDA-CSE-PK-QTY         TO LBPTDA-CSE-PK-QTY.         12626006
126270     MOVE LBVRDA-ODD-CART-IND       TO LBPTDA-ODD-CART-IND.       12627006
126280     MOVE LBVRDA-INPK-CNVYB-IND     TO LBPTDA-INPK-CNVYB-IND.     12628006
126290     MOVE LBVRDA-LBL-TYP-LBL-SEQ-ID TO LBPTDA-LBL-TYP-LBL-SEQ-ID. 12629006
126300     MOVE LBVRDA-LBL-TYP-TOT-QTY    TO LBPTDA-LBL-TYP-TOT-QTY.    12630006
126310     MOVE LBVRDA-MODU-DESC          TO LBPTDA-MODU-DESC.          12631006
126320     MOVE LBVRDA-ITM-NBR            TO LBPTDA-ITM-NBR.            12632006
126330     MOVE LBVRDA-DEPT-DESC          TO LBPTDA-DEPT-DESC.          12633006
126340     MOVE LBVRDA-MAJ-CL-DESC        TO LBPTDA-MAJ-CL-DESC.        12634006
126350     MOVE LBVRDA-SEASET-NM          TO LBPTDA-SEASET-NM.          12635006
126360     MOVE LBVRDA-FIXT-ID            TO LBPTDA-FIXT-ID.            12636006
126370     MOVE LBVRDA-BRCDE-NBR          TO LBPTDA-BRCDE-NBR.          12637006
126380     MOVE LBVRDA-STR-ZN-ID          TO LBPTDA-STR-ZN-ID.          12638006
126390     MOVE LBVRDA-STRG-AREA-CDE      TO LBPTDA-STRG-AREA-CDE.      12639006
126400                                                                  12640006
126410     MOVE LBVRDA-HNG-FOLD-SEQ-NBR   TO PV-HNG-FOLD-SEQ-NBR.       12641006
126420     MOVE LBVRDA-EAS-TAG-IND        TO LBPTDA-EAS-TAG-IND.        12642006
126430     MOVE LBVRDA-DOOR-ID            TO LBPTDA-DOOR-ID.            12643006
126440*CLP 07/06/2015 START                                             12644006
126450     MOVE 35                        TO LBPTDA-LBL-MSG-TXT-LEN.    12645006
126460     MOVE LBVRDA-LBL-MSG-TXT-TEXT   TO LBPTDA-LBL-MSG-TXT-TEXT.   12646006
126470*CLP 07/06/2015 END                                               12647006
126480*----------------------------------------------------------------*12648006
126490 7590-CREATE-RTV-OTBND.                                           12649006
126500      MOVE SU001-CURR-OPER-UNT-ID TO PC187-STR-NBR                12650006
126510      MOVE  +1                    TO PC187-NO-OF-LBLS             12651006
126520      PERFORM 7250-LINK-PCKCS721                                  12652006
126530      MOVE PC187-START-MFST-NBR TO PV-LBL-MANIFEST-NBR            12653006
126540      MOVE PV-LBL-MANIFEST-NBR  TO SU001-LBL-MANIFEST-NBR         12654006
126550      MOVE 'K'                  TO DK-CART-LBL-TYP-CDE            12655006
126560      MOVE ZEROES               TO PC160-BTCH-SML-CONTAINER-CDE   12656006
126570      SET  PC160-BTCH-SML-INTERNAL-LBL                            12657006
126580           PC160-BTCH-SML-FROM-KOHLS                              12658006
126590           PC160-PORT-SML-TXT-INTERNL-LBL                         12659006
126600           PC160-PORT-SML-TXT-FROM-KOHLS   TO TRUE                12660006
126610      MOVE SU001-CURR-OPER-UNT-ID TO PV-STORE-9-4                 12661006
126620      MOVE PV-STORE-X-4           TO PV-STORE-NBR-4               12662006
126630      MOVE PV-STORE-NBR           TO PC160-BTCH-SML-BC-DIVERT     12663006
126640      MOVE SU001-CURR-OPER-UNT-ID                                 12664006
126650                                 TO PC160-BTCH-SML-BC-DC-ORIGIN   12665006
126660                                    DK-DEST-OPER-UNT-ID           12666006
126670      MOVE SU001-LBL-MANIFEST-NBR TO                              12667006
126680                                    PC160-BTCH-SML-BC-MNFST-NBR   12668006
126690      MOVE PC160-BTCH-BARCODE    TO DK-BARCODE-NBR.               12669006
126700      SET PS-EAS-TAG-IND-FOUND-NO  TO TRUE.                       12670006
126710      PERFORM 3570-POPULATE-CRTN-LBL-XREF.                        12671006
126720      PERFORM 7350-START-VERIF-TRIGGER.                           12672006
126730                                                                  12673006
126740*----------------------------------------------------------------*12674006
126750 7600-PROCESS-INSERTS-TO-OTBND.                                   12675006
126760      PERFORM 7610-INSERT-OTBND-CART.                             12676006
126770      PERFORM 7620-SELECT-CRTN-UPC.                               12677006
126780      PERFORM 7645-INSERT-OTBND-LOC.                              12678006
126790      IF SU001-AUTO-VE-NO                                         12679006
126800         PERFORM 7650-INSERT-OTBND-VND                            12680006
126810      ELSE                                                        12681006
126820          IF SU001-PKGNG-CDE  = PC-M OR PC-I                      12682006
126830             PERFORM 7680-SELECT-PK-SKU-NBR                       12683006
126840             PERFORM 7685-INSERT-OTBND-PACK                       12684006
126850          END-IF                                                  12685006
126860      END-IF.                                                     12686006
126870*----------------------------------------------------------------*12687006
126880*----------------------------------------------------------------*12688006
126890 7610-INSERT-OTBND-CART.                                          12689006
126900*----------------------------------------------------------------*12690006
126910                                                                  12691006
126920      MOVE DK-BARCODE-NBR          TO PV-BAR-CODE.                12692006
126930      MOVE PV-BAR-CODE-OTBND       TO SUT00024-SHIPT-UNT-ID       12693006
126940                                      SUT00024-PRNT-CART-ID.      12694006
126950      MOVE SU001-CURR-OPER-UNT-ID  TO SUT00024-ORGN-LOC-NBR.      12695006
126960      MOVE DK-DEST-OPER-UNT-ID     TO SUT00024-DEST-LOC-NBR.      12696006
126970      MOVE 'ASN'                   TO SUT00024-CART-SRC-CDE.      12697006
126980      MOVE  SU001-USER-ID          TO SUT00024-CRE-USR-ID.        12698006
126990      MOVE PC-CURRENT-PROGRAM-NAME TO SUT00024-CRE-PGM-NM.        12699006
127000      MOVE 'N'                     TO SUT00024-MSTR-CART-IND.     12700006
127010      MOVE SU001-CARTON            TO SUT00024-ORIG-CART-ID.      12701006
127020      MOVE 'Y'                     TO SUT00024-ACTV-IND.          12702006
127030      IF LBVRDA-INPK-CNVYB-IND  = 'Y'                             12703006
127040         MOVE PC-I                 TO SUT00024-CART-TYP-CDE       12704006
127050      ELSE                                                        12705006
127060         MOVE DK-CART-LBL-TYP-CDE  TO SUT00024-CART-TYP-CDE       12706006
127070      END-IF                                                      12707006
127080                                                                  12708006
127090      MOVE PS-EAS-TAG-IND-FOUND-SW TO SUT00024-EAS-TAG-IND.       12709006
127100                                                                  12710006
127110     EXEC SQL                                                     12711006
127120         INSERT INTO SUT_OTBND_CART                               12712006
127130             ( SHIPT_UNT_ID                                       12713006
127140              ,ORGN_LOC_NBR                                       12714006
127150              ,DEST_LOC_NBR                                       12715006
127160              ,CART_SRC_CDE                                       12716006
127170              ,CRE_DTE                                            12717006
127180              ,CRE_TM                                             12718006
127190              ,CRE_USR_ID                                         12719006
127200              ,CRE_PGM_NM                                         12720006
127210              ,MSTR_CART_IND                                      12721006
127220              ,PRNT_CART_ID                                       12722006
127230              ,ORIG_CART_ID                                       12723006
127240              ,CART_TYP_CDE                                       12724006
127250              ,LBL_PRT_SEQ_NBR                                    12725006
127260              ,CART_RVSN_NBR                                      12726006
127270              ,OTBND_TRIP_ID                                      12727006
127280              ,ACTV_IND                                           12728006
127290              ,EAS_TAG_IND)                                       12729006
127300         VALUES (:SUT00024-SHIPT-UNT-ID                           12730006
127310                ,:SUT00024-ORGN-LOC-NBR                           12731006
127320                ,:SUT00024-DEST-LOC-NBR                           12732006
127330                ,:SUT00024-CART-SRC-CDE                           12733006
127340                , CURRENT DATE                                    12734006
127350                , CURRENT TIME                                    12735006
127360                ,:SUT00024-CRE-USR-ID                             12736006
127370                ,:SUT00024-CRE-PGM-NM                             12737006
127380                ,:SUT00024-MSTR-CART-IND                          12738006
127390                ,:SUT00024-PRNT-CART-ID                           12739006
127400                ,:SUT00024-ORIG-CART-ID                           12740006
127410                ,:SUT00024-CART-TYP-CDE                           12741006
127420                , 0                                               12742006
127430                , 0                                               12743006
127440                , NULL                                            12744006
127450                ,:SUT00024-ACTV-IND                               12745006
127460                ,:SUT00024-EAS-TAG-IND)                           12746006
127470     END-EXEC                                                     12747006
127480                                                                  12748006
127490         EVALUATE TRUE                                            12749006
127500             WHEN SQLCODE = ZERO                                  12750006
127510                SET PS-DONE                                       12751006
127520                    PS-CARTON-SML-CREATED TO TRUE                 12752006
127530                                                                  12753006
127540* DMH 11/29/02 - BEGIN - TEMPORARY FIX UNTIL RECLAIM REDONE       12754006
127550             WHEN SQLCODE = -803                                  12755006
127560                  PERFORM 7660-DELETE-OTBD-UPC                    12756006
127570                  PERFORM 7665-DELETE-OTBD-VND                    12757006
127580                  PERFORM 7670-UPDATE-OTBD-CART                   12758006
127590                  SET PS-CARTON-SML-CREATED TO TRUE               12759006
127600* DMH 11/29/02 - END                                              12760006
127610                                                                  12761006
127620             WHEN SQLWARN0 NOT = SPACES                           12762006
127630             WHEN SQLCODE < ZERO                                  12763006
127640             WHEN SQLCODE > ZERO                                  12764006
127650                 MOVE '7610-INSERT-OTBND-CART'                    12765006
127660                                   TO DP013-PARAGRAPH             12766006
127670                 MOVE 'INSERT INTO TABLE  - '                     12767006
127680                                   TO DP013-MESSAGE-TEXT (1)      12768006
127690                 MOVE SQLCA        TO DP013-SQLCA                 12769006
127700                 MOVE 'SUT_OTBND_CART '                           12770006
127710                                   TO DP013-DB2-TABLE-NAME (1)    12771006
127720                 SET DP013-DB2-ABEND                              12772006
127730                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12773006
127740                 SET DP013-ROLLBACK                               12774006
127750                                   TO TRUE                        12775006
127760                 PERFORM DP014-0000-PROCESS-ABEND                 12776006
127770         END-EVALUATE.                                            12777006
127780                                                                  12778006
127790 EJECT                                                            12779006
127800*----------------------------------------------------------------*12780006
127810 7620-SELECT-CRTN-UPC.                                            12781006
127820      SET PS-NOT-END-OF-UPC-UNLOAD-CSR TO TRUE.                   12782006
127830      PERFORM 7625-OPEN-UPC-UNLOAD-CSR.                           12783006
127840      PERFORM 7630-FETCH-UPC-UNLOAD-CSR                           12784006
127850            UNTIL PS-END-OF-UPC-UNLOAD-CSR.                       12785006
127860      PERFORM 7640-CLOSE-UPC-UNLOAD-CSR.                          12786006
127870*----------------------------------------------------------------*12787006
127880 7625-OPEN-UPC-UNLOAD-CSR.                                        12788006
127890******************************************************************12789006
127900                                                                  12790006
127910         EXEC SQL                                                 12791006
127920              OPEN UPC_UNLOAD_CSR                                 12792006
127930         END-EXEC                                                 12793006
127940                                                                  12794006
127950                                                                  12795006
127960         EVALUATE TRUE                                            12796006
127970             WHEN SQLCODE = ZERO                                  12797006
127980                 CONTINUE                                         12798006
127990             WHEN SQLWARN0 NOT = SPACES                           12799006
128000             WHEN SQLCODE < ZERO                                  12800006
128010             WHEN SQLCODE > ZERO                                  12801006
128020                 MOVE '7625-OPEN-UPC-UNLOAD-CSR'                  12802006
128030                                   TO DP013-PARAGRAPH             12803006
128040                 MOVE 'OPEN UPC UNLOAD CSR- '                     12804006
128050                                   TO DP013-MESSAGE-TEXT (1)      12805006
128060                 MOVE SQLCA        TO DP013-SQLCA                 12806006
128070                 MOVE 'SUT_OTBND_UPC ' TO DP013-DB2-TABLE-NAME (1)12807006
128080                 SET DP013-DB2-ABEND                              12808006
128090                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12809006
128100                 SET DP013-ROLLBACK                               12810006
128110                                   TO TRUE                        12811006
128120                 PERFORM DP014-0000-PROCESS-ABEND                 12812006
128130         END-EVALUATE.                                            12813006
128140                                                                  12814006
128150 EJECT                                                            12815006
128160*----------------------------------------------------------------*12816006
128170 7630-FETCH-UPC-UNLOAD-CSR.                                       12817006
128180*----------------------------------------------------------------*12818006
128190                                                                  12819006
128200     EXEC SQL                                                     12820006
128210        FETCH UPC_UNLOAD_CSR                                      12821006
128220        INTO   :SUT00028-UPC-NBR                                  12822006
128230              ,:SUT00028-TRN-NBR                                  12823006
128240              ,:SUT00028-TRN-LNE-NBR                              12824006
128250              ,:SUT00028-TRN-TYP-CDE                              12825006
128260              ,:SUT00028-SHPD-UNT-QTY                             12826006
128270     END-EXEC.                                                    12827006
128280                                                                  12828006
128290     EVALUATE TRUE                                                12829006
128300       WHEN SQLCODE = ZEROS                                       12830006
128310            PERFORM 7635-INSERT-OTBND-UPC                         12831006
128320       WHEN SQLCODE = +100                                        12832006
128330                SET  PS-END-OF-UPC-UNLOAD-CSR TO TRUE             12833006
128340       WHEN OTHER                                                 12834006
128350             MOVE '7630-FETCH-UPC-UNLOAD-CSR'                     12835006
128360                             TO DP013-PARAGRAPH                   12836006
128370             MOVE 'INSERT TO OTBND UPC TABLE      '               12837006
128380                             TO DP013-MESSAGE-TEXT(1)             12838006
128390             MOVE SU001-PO                                        12839006
128400                             TO DP013-MESSAGE-TEXT(2)             12840006
128410             MOVE SU001-CARTON                                    12841006
128420                             TO DP013-MESSAGE-TEXT(3)             12842006
128430             MOVE SQLCA      TO DP013-SQLCA                       12843006
128440             MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME(1)      12844006
128450             SET DP013-DB2-ABEND                                  12845006
128460                             TO TRUE                              12846006
128470             SET DP013-ROLLBACK                                   12847006
128480                             TO TRUE                              12848006
128490             SET DP013-XCTL-DISPLAY-RESTART                       12849006
128500                             TO TRUE                              12850006
128510             PERFORM DP014-0000-PROCESS-ABEND                     12851006
128520     END-EVALUATE.                                                12852006
128530                                                                  12853006
128540*----------------------------------------------------------------*12854006
128550 7635-INSERT-OTBND-UPC.                                           12855006
128560*----------------------------------------------------------------*12856006
128570                                                                  12857006
128580     MOVE SUT00024-SHIPT-UNT-ID    TO SUT00028-SHIPT-UNT-ID.      12858006
128590                                                                  12859006
128600     IF SU001-AUTO-VE-YES                                         12860006
128610        MOVE SU001-RCVR-SEQ-NBR       TO SUT00028-RCVR-SEQ-NBR    12861006
128620     ELSE                                                         12862006
128630        MOVE ZEROES                   TO SUT00028-RCVR-SEQ-NBR    12863006
128640     END-IF                                                       12864006
128650                                                                  12865006
128660     IF LBVRDA-INPK-CNVYB-IND = 'Y'                               12866006
128670        IF SU001-PKGNG-CDE  = PC-M OR PC-I                        12867006
128680           PERFORM 7695-SELECT-PREPK-RATIO                        12868006
128690           MOVE RECITM-PREPK-RATO-QTY TO SUT00028-SHPD-UNT-QTY    12869006
128700        ELSE                                                      12870006
128710           MOVE LBVRDA-INPK-UNT-QTY  TO SUT00028-SHPD-UNT-QTY     12871006
128720        END-IF                                                    12872006
128730     END-IF                                                       12873006
128740                                                                  12874006
128750     EXEC SQL                                                     12875006
128760         INSERT INTO SUT_OTBND_UPC                                12876006
128770             ( SHIPT_UNT_ID                                       12877006
128780              ,TRN_NBR                                            12878006
128790              ,RCVR_SEQ_NBR                                       12879006
128800              ,TRN_LNE_NBR                                        12880006
128810              ,TRN_TYP_CDE                                        12881006
128820              ,UPC_NBR                                            12882006
128830              ,SHPD_UNT_QTY)                                      12883006
128840         VALUES (:SUT00028-SHIPT-UNT-ID                           12884006
128850                ,:SUT00028-TRN-NBR                                12885006
128860                ,:SUT00028-RCVR-SEQ-NBR                           12886006
128870                ,:SUT00028-TRN-LNE-NBR                            12887006
128880                ,:SUT00028-TRN-TYP-CDE                            12888006
128890                ,:SUT00028-UPC-NBR                                12889006
128900                ,:SUT00028-SHPD-UNT-QTY)                          12890006
128910     END-EXEC                                                     12891006
128920                                                                  12892006
128930         EVALUATE TRUE                                            12893006
128940             WHEN SQLCODE = ZERO                                  12894006
128950             WHEN SQLCODE = +100                                  12895006
128960                CONTINUE                                          12896006
128970             WHEN SQLWARN0 NOT = SPACES                           12897006
128980             WHEN SQLCODE < ZERO                                  12898006
128990             WHEN SQLCODE > ZERO                                  12899006
129000                 MOVE '7635-INSERT-OTBND-UPC '                    12900006
129010                                   TO DP013-PARAGRAPH             12901006
129020                 MOVE 'INSERT INTO TABLE  - '                     12902006
129030                                   TO DP013-MESSAGE-TEXT (1)      12903006
129040                 MOVE SQLCA        TO DP013-SQLCA                 12904006
129050                 MOVE 'SUT_OTBND_UPC  '                           12905006
129060                                   TO DP013-DB2-TABLE-NAME (1)    12906006
129070                 SET DP013-DB2-ABEND                              12907006
129080                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12908006
129090                 SET DP013-ROLLBACK                               12909006
129100                                   TO TRUE                        12910006
129110                 PERFORM DP014-0000-PROCESS-ABEND                 12911006
129120         END-EVALUATE.                                            12912006
129130                                                                  12913006
129140 EJECT                                                            12914006
129150*----------------------------------------------------------------*12915006
129160 7640-CLOSE-UPC-UNLOAD-CSR.                                       12916006
129170*----------------------------------------------------------------*12917006
129180                                                                  12918006
129190         EXEC SQL                                                 12919006
129200             CLOSE UPC_UNLOAD_CSR                                 12920006
129210         END-EXEC                                                 12921006
129220                                                                  12922006
129230                                                                  12923006
129240         EVALUATE TRUE                                            12924006
129250             WHEN SQLCODE = ZERO                                  12925006
129260                 CONTINUE                                         12926006
129270             WHEN SQLWARN0 NOT = SPACES                           12927006
129280             WHEN SQLCODE < ZERO                                  12928006
129290             WHEN SQLCODE > ZERO                                  12929006
129300                 MOVE '7640-CLOSE-UPC-UNLOAD-CSR'                 12930006
129310                                   TO DP013-PARAGRAPH             12931006
129320                 MOVE 'CLOSE UPC UNLOAD CSR- '                    12932006
129330                                   TO DP013-MESSAGE-TEXT (1)      12933006
129340                 MOVE SQLCA        TO DP013-SQLCA                 12934006
129350                 MOVE 'SUT_OTBND_UPC ' TO DP013-DB2-TABLE-NAME (1)12935006
129360                 SET DP013-DB2-ABEND                              12936006
129370                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12937006
129380                 SET DP013-ROLLBACK                               12938006
129390                                   TO TRUE                        12939006
129400                 PERFORM DP014-0000-PROCESS-ABEND                 12940006
129410         END-EVALUATE.                                            12941006
129420                                                                  12942006
129430*----------------------------------------------------------------*12943006
129440 7645-INSERT-OTBND-LOC.                                           12944006
129450*----------------------------------------------------------------*12945006
129460     MOVE SUT00024-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID.        12946006
129470     MOVE SU001-CURR-OPER-UNT-ID TO SUT00027-LOC-NBR.             12947006
129480     MOVE SU001-STORE            TO SUT00024-DEST-LOC-NBR.        12948006
129490     MOVE 'RECV'                 TO SUT00027-SCN-CDE.             12949006
129500     MOVE  SU001-USER-ID         TO SUT00027-CRE-USR-ID.          12950006
129510     MOVE  'A'                   TO SUT00027-ACTV-CDE.            12951006
129520     MOVE SU001-MANIFEST         TO SUT00027-INBD-TRIP-ID.        12952006
129530                                                                  12953006
129540                                                                  12954006
129550     EXEC SQL                                                     12955006
129560         INSERT INTO SUT_OTBND_LOC                                12956006
129570             ( SHIPT_UNT_ID                                       12957006
129580              ,CRE_TMST                                           12958006
129590              ,OTBND_TRIP_ID                                      12959006
129600              ,LOC_NBR                                            12960006
129610              ,SCN_CDE                                            12961006
129620              ,CRE_USR_ID                                         12962006
129630              ,ACTV_CDE                                           12963006
129640              ,INBD_TRIP_ID)                                      12964006
129650        VALUES (:SUT00027-SHIPT-UNT-ID                            12965006
129660               , CURRENT TIMESTAMP                                12966006
129670               , NULL                                             12967006
129680               ,:SUT00027-LOC-NBR                                 12968006
129690               ,:SUT00027-SCN-CDE                                 12969006
129700               ,:SUT00027-CRE-USR-ID                              12970006
129710               ,:SUT00027-ACTV-CDE                                12971006
129720               ,:SUT00027-INBD-TRIP-ID)                           12972006
129730     END-EXEC                                                     12973006
129740                                                                  12974006
129750         EVALUATE TRUE                                            12975006
129760             WHEN SQLCODE = ZERO                                  12976006
129770             WHEN SQLCODE = +100                                  12977006
129780                CONTINUE                                          12978006
129790             WHEN SQLWARN0 NOT = SPACES                           12979006
129800             WHEN SQLCODE < ZERO                                  12980006
129810             WHEN SQLCODE > ZERO                                  12981006
129820                 MOVE '7645-INSERT-OTBND-LOC '                    12982006
129830                                   TO DP013-PARAGRAPH             12983006
129840                 MOVE 'INSERT INTO TABLE  - '                     12984006
129850                                   TO DP013-MESSAGE-TEXT (1)      12985006
129860                 MOVE SQLCA        TO DP013-SQLCA                 12986006
129870                 MOVE 'SUT_OTBND_LOC  '                           12987006
129880                                   TO DP013-DB2-TABLE-NAME (1)    12988006
129890                 SET DP013-DB2-ABEND                              12989006
129900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           12990006
129910                 SET DP013-ROLLBACK                               12991006
129920                                   TO TRUE                        12992006
129930                 PERFORM DP014-0000-PROCESS-ABEND                 12993006
129940         END-EVALUATE.                                            12994006
129950                                                                  12995006
129960                                                                  12996006
129970 EJECT                                                            12997006
129980*----------------------------------------------------------------*12998006
129990 7650-INSERT-OTBND-VND.                                           12999006
130000*----------------------------------------------------------------*13000006
130010     MOVE SU001-CARTON TO INPKSU-SHIPT-UNT-ID.                    13001006
130020                                                                  13002006
130030     EXEC SQL                                                     13003006
130040         SELECT PO_NBR                                            13004006
130050               ,SEQ_NBR                                           13005006
130060          INTO :INPKSU-PO-NBR                                     13006006
130070              ,:INPKSU-SEQ-NBR                                    13007006
130080          FROM  TINPKSU                                           13008006
130090         WHERE  SHIPT_UNT_ID = :INPKSU-SHIPT-UNT-ID               13009006
130100     END-EXEC                                                     13010006
130110                                                                  13011006
130120         EVALUATE TRUE                                            13012006
130130             WHEN SQLCODE = ZERO                                  13013006
130140                CONTINUE                                          13014006
130150             WHEN SQLCODE = +100                                  13015006
130160                MOVE '7650-INSERT-OTBND-VND' TO DP013-PARAGRAPH   13016006
130170                MOVE 'SUKRF502 - CARTON NOT FOUND INPKSU '        13017006
130180                                   TO DP013-MESSAGE-TEXT (1)      13018006
130190                MOVE SUT00024-SHIPT-UNT-ID                        13019006
130200                                   TO DP013-MESSAGE-TEXT (2)      13020006
130210                MOVE INPKSU-SHIPT-UNT-ID                          13021006
130220                                   TO DP013-MESSAGE-TEXT (3)      13022006
130230                SET DP013-LOGIC-ABEND        TO TRUE              13023006
130240                SET DP013-ROLLBACK           TO TRUE              13024006
130250                PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG            13025006
130260             WHEN SQLWARN0 NOT = SPACES                           13026006
130270             WHEN SQLCODE < ZERO                                  13027006
130280             WHEN SQLCODE > ZERO                                  13028006
130290                 MOVE '7650-INSERT-OTBND-VND '                    13029006
130300                                   TO DP013-PARAGRAPH             13030006
130310                 MOVE 'SELECT TINPKSU     - '                     13031006
130320                                   TO DP013-MESSAGE-TEXT (1)      13032006
130330                 MOVE SQLCA        TO DP013-SQLCA                 13033006
130340                 MOVE 'TINPKSU  '                                 13034006
130350                                   TO DP013-DB2-TABLE-NAME (1)    13035006
130360                 SET DP013-DB2-ABEND                              13036006
130370                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13037006
130380                 SET DP013-ROLLBACK                               13038006
130390                                   TO TRUE                        13039006
130400                 PERFORM DP014-0000-PROCESS-ABEND                 13040006
130410         END-EVALUATE.                                            13041006
130420                                                                  13042006
130430     MOVE SUT00024-SHIPT-UNT-ID  TO SUT00026-SHIPT-UNT-ID.        13043006
130440     MOVE INPKSU-PO-NBR          TO SUT00026-PO-NBR.              13044006
130450     MOVE INPKSU-SEQ-NBR         TO SUT00026-PKSL-SEQ-NBR.        13045006
130460                                                                  13046006
130470     EXEC SQL                                                     13047006
130480         INSERT INTO SUT_OTBND_VND                                13048006
130490             ( SHIPT_UNT_ID                                       13049006
130500              ,PO_NBR                                             13050006
130510              ,PKSL_SEQ_NBR)                                      13051006
130520         VALUES (:SUT00026-SHIPT-UNT-ID                           13052006
130530                ,:SUT00026-PO-NBR                                 13053006
130540                ,:SUT00026-PKSL-SEQ-NBR)                          13054006
130550     END-EXEC                                                     13055006
130560                                                                  13056006
130570                                                                  13057006
130580         EVALUATE TRUE                                            13058006
130590             WHEN SQLCODE = ZERO                                  13059006
130600             WHEN SQLCODE = +100                                  13060006
130610                CONTINUE                                          13061006
130620             WHEN SQLWARN0 NOT = SPACES                           13062006
130630             WHEN SQLCODE < ZERO                                  13063006
130640             WHEN SQLCODE > ZERO                                  13064006
130650                 MOVE '7650-INSERT-OTBND-VND '                    13065006
130660                                   TO DP013-PARAGRAPH             13066006
130670                 MOVE 'INSERT INTO TABLE  - '                     13067006
130680                                   TO DP013-MESSAGE-TEXT (1)      13068006
130690                 MOVE SQLCA        TO DP013-SQLCA                 13069006
130700                 MOVE 'SUT_OTBND_VND  '                           13070006
130710                                   TO DP013-DB2-TABLE-NAME (1)    13071006
130720                 SET DP013-DB2-ABEND                              13072006
130730                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13073006
130740                 SET DP013-ROLLBACK                               13074006
130750                                   TO TRUE                        13075006
130760                 PERFORM DP014-0000-PROCESS-ABEND                 13076006
130770         END-EVALUATE.                                            13077006
130780                                                                  13078006
130790                                                                  13079006
130800 7660-DELETE-OTBD-UPC.                                            13080006
130810                                                                  13081006
130820     EXEC SQL                                                     13082006
130830          DELETE FROM SUT_OTBND_UPC                               13083006
130840           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         13084006
130850     END-EXEC.                                                    13085006
130860                                                                  13086006
130870     EVALUATE TRUE                                                13087006
130880       WHEN SQLCODE = ZEROS                                       13088006
130890       WHEN SQLCODE = +100                                        13089006
130900            CONTINUE                                              13090006
130910       WHEN OTHER                                                 13091006
130920             MOVE '7660-DELETE-OTBD-UPC     '                     13092006
130930                             TO DP013-PARAGRAPH                   13093006
130940             MOVE 'DELETE OUTOUND UPC TABLE       '               13094006
130950                             TO DP013-MESSAGE-TEXT(1)             13095006
130960             MOVE SUT00024-SHIPT-UNT-ID                           13096006
130970                             TO DP013-MESSAGE-TEXT(2)             13097006
130980             MOVE SQLCA      TO DP013-SQLCA                       13098006
130990             MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME(1)      13099006
131000             SET DP013-DB2-ABEND                                  13100006
131010                             TO TRUE                              13101006
131020             SET DP013-ROLLBACK                                   13102006
131030                             TO TRUE                              13103006
131040             SET DP013-XCTL-DISPLAY-RESTART                       13104006
131050                             TO TRUE                              13105006
131060             PERFORM DP014-0000-PROCESS-ABEND                     13106006
131070     END-EVALUATE.                                                13107006
131080                                                                  13108006
131090                                                                  13109006
131100 7665-DELETE-OTBD-VND.                                            13110006
131110                                                                  13111006
131120     EXEC SQL                                                     13112006
131130          DELETE FROM SUT_OTBND_VND                               13113006
131140           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         13114006
131150     END-EXEC.                                                    13115006
131160                                                                  13116006
131170     EVALUATE TRUE                                                13117006
131180       WHEN SQLCODE = ZEROS                                       13118006
131190       WHEN SQLCODE = +100                                        13119006
131200            CONTINUE                                              13120006
131210       WHEN OTHER                                                 13121006
131220             MOVE '7665-DELETE-OTBD-VND     '                     13122006
131230                             TO DP013-PARAGRAPH                   13123006
131240             MOVE 'DELETE OUTOUND VND TABLE       '               13124006
131250                             TO DP013-MESSAGE-TEXT(1)             13125006
131260             MOVE SUT00024-SHIPT-UNT-ID                           13126006
131270                             TO DP013-MESSAGE-TEXT(2)             13127006
131280             MOVE SQLCA      TO DP013-SQLCA                       13128006
131290             MOVE 'SUT_OTBND_VND' TO DP013-DB2-TABLE-NAME(1)      13129006
131300             SET DP013-DB2-ABEND                                  13130006
131310                             TO TRUE                              13131006
131320             SET DP013-ROLLBACK                                   13132006
131330                             TO TRUE                              13133006
131340             SET DP013-XCTL-DISPLAY-RESTART                       13134006
131350                             TO TRUE                              13135006
131360             PERFORM DP014-0000-PROCESS-ABEND                     13136006
131370     END-EVALUATE.                                                13137006
131380                                                                  13138006
131390                                                                  13139006
131400 7670-UPDATE-OTBD-CART.                                           13140006
131410                                                                  13141006
131420     EXEC SQL                                                     13142006
131430         UPDATE SUT_OTBND_CART                                    13143006
131440            SET                                                   13144006
131450               ORGN_LOC_NBR     =  :SUT00024-ORGN-LOC-NBR         13145006
131460              ,DEST_LOC_NBR     =  :SUT00024-DEST-LOC-NBR         13146006
131470              ,CART_SRC_CDE     =  :SUT00024-CART-SRC-CDE         13147006
131480              ,CRE_DTE          =   CURRENT DATE                  13148006
131490              ,CRE_TM           =   CURRENT TIME                  13149006
131500              ,CRE_USR_ID       =  :SUT00024-CRE-USR-ID           13150006
131510              ,CRE_PGM_NM       =  :SUT00024-CRE-PGM-NM           13151006
131520              ,MSTR_CART_IND    =  :SUT00024-MSTR-CART-IND        13152006
131530              ,PRNT_CART_ID     =  :SUT00024-PRNT-CART-ID         13153006
131540              ,ORIG_CART_ID     =  :SUT00024-ORIG-CART-ID         13154006
131550              ,CART_TYP_CDE     =  :SUT00024-CART-TYP-CDE         13155006
131560              ,LBL_PRT_SEQ_NBR  =   0                             13156006
131570              ,CART_RVSN_NBR    =   0                             13157006
131580              ,OTBND_TRIP_ID    =   NULL                          13158006
131590              ,ACTV_IND         =  :SUT00024-ACTV-IND             13159006
131600          WHERE                                                   13160006
131610               SHIPT_UNT_ID     =  :SUT00024-SHIPT-UNT-ID         13161006
131620     END-EXEC.                                                    13162006
131630                                                                  13163006
131640         EVALUATE TRUE                                            13164006
131650             WHEN SQLCODE = ZERO                                  13165006
131660                SET PS-DONE TO TRUE                               13166006
131670                                                                  13167006
131680             WHEN SQLWARN0 NOT = SPACES                           13168006
131690             WHEN SQLCODE < ZERO                                  13169006
131700             WHEN SQLCODE > ZERO                                  13170006
131710                 MOVE '7670-UPDATE-OTBD-CART '                    13171006
131720                                   TO DP013-PARAGRAPH             13172006
131730                 MOVE 'UPDATE INTO TABLE  - '                     13173006
131740                                   TO DP013-MESSAGE-TEXT (1)      13174006
131750                 MOVE SQLCA        TO DP013-SQLCA                 13175006
131760                 MOVE 'SUT_OTBND_CART '                           13176006
131770                                   TO DP013-DB2-TABLE-NAME (1)    13177006
131780                 SET DP013-DB2-ABEND                              13178006
131790                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13179006
131800                 SET DP013-ROLLBACK                               13180006
131810                                   TO TRUE                        13181006
131820                 PERFORM DP014-0000-PROCESS-ABEND                 13182006
131830         END-EVALUATE.                                            13183006
131840                                                                  13184006
131850                                                                  13185006
131860 7680-SELECT-PK-SKU-NBR.                                          13186006
131870                                                                  13187006
131880     EXEC SQL                                                     13188006
131890          SELECT PK_SKU_NBR                                       13189006
131900          INTO  :POPRPK-PK-SKU-NBR                                13190006
131910          FROM   TPOPRPK                                          13191006
131920          WHERE  PO_NBR         = :SUT00028-TRN-NBR               13192006
131930          AND    PO_PREPK_ID    = :LBVRDA-PREPK-ID                13193006
131940          AND    PREPK_STAT_CDE =  'A'                            13194006
131950     END-EXEC.                                                    13195006
131960                                                                  13196006
131970     EVALUATE TRUE                                                13197006
131980         WHEN SQLCODE = ZERO                                      13198006
131990              CONTINUE                                            13199006
132000         WHEN SQLCODE = +100                                      13200006
132010             CONTINUE                                             13201006
132020         WHEN SQLWARN0 NOT = SPACES                               13202006
132030         WHEN SQLCODE NOT EQUAL ZERO                              13203006
132040             MOVE SUT00028-TRN-NBR TO PV-DISPLAY-TRAN             13204006
132050             MOVE LBVRDA-PREPK-ID  TO PV-DISPLAY-PREPK            13205006
132060             MOVE '7680-SELECT-PK-SKU-NBR'                        13206006
132070                             TO DP013-PARAGRAPH                   13207006
132080             MOVE 'SUKRF502 - SELECT PK SKU NUMBER'               13208006
132090                             TO DP013-MESSAGE-TEXT(1)             13209006
132100             MOVE SUT00024-SHIPT-UNT-ID                           13210006
132110                             TO DP013-MESSAGE-TEXT(2)             13211006
132120             MOVE PV-DISPLAY-TRAN                                 13212006
132130                             TO DP013-MESSAGE-TEXT(3)             13213006
132140             MOVE PV-DISPLAY-PREPK                                13214006
132150                             TO DP013-MESSAGE-TEXT(4)             13215006
132160             MOVE SQLCA      TO DP013-SQLCA                       13216006
132170             MOVE 'TPOPRPK ' TO DP013-DB2-TABLE-NAME(1)           13217006
132180             SET DP013-DB2-ABEND                                  13218006
132190                             TO TRUE                              13219006
132200             SET DP013-ROLLBACK                                   13220006
132210                             TO TRUE                              13221006
132220             SET DP013-XCTL-DISPLAY-RESTART                       13222006
132230                             TO TRUE                              13223006
132240             PERFORM DP014-0000-PROCESS-ABEND                     13224006
132250     END-EVALUATE.                                                13225006
132260                                                                  13226006
132270*----------------------------------------------------------------*13227006
132280 7685-INSERT-OTBND-PACK.                                          13228006
132290*----------------------------------------------------------------*13229006
132300     MOVE ZEROES                 TO PV-SHPD-PK-QTY.               13230006
132310     MOVE SU001-RCVR-SEQ-NBR     TO SUT00041-RCVR-SEQ-NBR.        13231006
132320     COMPUTE PV-SHPD-PK-QTY =                                     13232006
132330                 (LBVRDA-OTPK-UNT-QTY / LBVRDA-PREPK-RATO-QTY )   13233006
132340     MOVE PV-SHPD-PK-QTY TO SUT00041-SHPD-PK-QTY.                 13234006
132350                                                                  13235006
132360     EXEC SQL                                                     13236006
132370         INSERT INTO SUT_OTBND_PK                                 13237006
132380             ( SHIPT_UNT_ID                                       13238006
132390              ,TRN_NBR                                            13239006
132400              ,RCVR_SEQ_NBR                                       13240006
132410              ,TRN_TYP_CDE                                        13241006
132420              ,PK_SKU_NBR                                         13242006
132430              ,SHPD_PK_QTY )                                      13243006
132440        VALUES (:SUT00024-SHIPT-UNT-ID                            13244006
132450               ,:SUT00028-TRN-NBR                                 13245006
132460               ,:SUT00041-RCVR-SEQ-NBR                            13246006
132470               ,'PO'                                              13247006
132480               ,:POPRPK-PK-SKU-NBR                                13248006
132490               ,:SUT00041-SHPD-PK-QTY)                            13249006
132500     END-EXEC                                                     13250006
132510                                                                  13251006
132520     EVALUATE TRUE                                                13252006
132530         WHEN SQLCODE = ZERO                                      13253006
132540         WHEN SQLCODE = +100                                      13254006
132550             CONTINUE                                             13255006
132560         WHEN SQLCODE = -803                                      13256006
132570             PERFORM 7690-DELETE-OTBND-PACK                       13257006
132580         WHEN SQLWARN0 NOT = SPACES                               13258006
132590         WHEN SQLCODE < ZERO                                      13259006
132600         WHEN SQLCODE > ZERO                                      13260006
132610              MOVE SQLCODE               TO PV-DISPLAY-SQLCODE    13261006
132620              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISPLAY-CARTON     13262006
132630              MOVE SUT00028-TRN-NBR      TO PV-DISPLAY-PO         13263006
132640              MOVE SUT00041-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR    13264006
132650              MOVE POPRPK-PK-SKU-NBR     TO PV-DISPLAY-PACK-SKU   13265006
132660              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      13266006
132670               '7685-INSERT-OTBND-PACK'    DELIMITED BY SIZE      13267006
132680                                      INTO PV-CICS-MSG-AREA-B     13268006
132690              MOVE LENGTH OF PV-CICS-MSG-AREA-A                   13269006
132700                                        TO PV-COMMAREA-LENGTH     13270006
132710              PERFORM 9998-WRITE-TO-CSSL                          13271006
132720              MOVE SPACES TO PV-CICS-MSG-AREA-A                   13272006
132730              STRING 'RET CODE '           DELIMITED BY SIZE      13273006
132740                   PV-DISPLAY-SQLCODE      DELIMITED BY SIZE      13274006
132750                     'CARTON ID '          DELIMITED BY SIZE      13275006
132760                       PV-DISPLAY-CARTON   DELIMITED BY SIZE      13276006
132770                     'PO/RCVR '            DELIMITED BY SIZE      13277006
132780                       PV-DISPLAY-PO       DELIMITED BY SIZE      13278006
132790                       ' - '               DELIMITED BY SIZE      13279006
132800                       PV-DISPLAY-PO-RCVR  DELIMITED BY SIZE      13280006
132810                     'PACK SKU '           DELIMITED BY SIZE      13281006
132820                       PV-DISPLAY-PACK-SKU DELIMITED BY SIZE      13282006
132830                                      INTO PV-CICS-MSG-AREA-B     13283006
132840              MOVE LENGTH OF PV-CICS-MSG-AREA-A                   13284006
132850                                        TO PV-COMMAREA-LENGTH     13285006
132860              PERFORM 9998-WRITE-TO-CSSL                          13286006
132870             MOVE '7685-INSERT-OTBND-PACK'                        13287006
132880                               TO DP013-PARAGRAPH                 13288006
132890             MOVE 'INSERT INTO TABLE  - '                         13289006
132900                               TO DP013-MESSAGE-TEXT (1)          13290006
132910             MOVE SQLCA        TO DP013-SQLCA                     13291006
132920             MOVE 'SUT_OTBND_PK   '                               13292006
132930                               TO DP013-DB2-TABLE-NAME (1)        13293006
132940             SET DP013-DB2-ABEND                                  13294006
132950                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13295006
132960             SET DP013-ROLLBACK                                   13296006
132970                               TO TRUE                            13297006
132980             PERFORM DP014-0000-PROCESS-ABEND                     13298006
132990     END-EVALUATE.                                                13299006
133000                                                                  13300006
133010                                                                  13301006
133020 EJECT                                                            13302006
133030                                                                  13303006
133040 7690-DELETE-OTBND-PACK.                                          13304006
133050                                                                  13305006
133060                                                                  13306006
133070     EXEC SQL                                                     13307006
133080          DELETE FROM SUT_OTBND_PK                                13308006
133090           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         13309006
133100             AND TRN_NBR         = :SUT00028-TRN-NBR              13310006
133110             AND RCVR_SEQ_NBR    = :SUT00041-RCVR-SEQ-NBR         13311006
133120             AND TRN_TYP_CDE     = 'PO'                           13312006
133130             AND PK_SKU_NBR      = :POPRPK-PK-SKU-NBR             13313006
133140     END-EXEC.                                                    13314006
133150                                                                  13315006
133160     EVALUATE TRUE                                                13316006
133170         WHEN SQLCODE = ZERO                                      13317006
133180         WHEN SQLCODE = +100                                      13318006
133190             CONTINUE                                             13319006
133200         WHEN SQLWARN0 NOT = SPACES                               13320006
133210         WHEN SQLCODE < ZERO                                      13321006
133220         WHEN SQLCODE > ZERO                                      13322006
133230              MOVE SQLCODE               TO PV-SQLCODE            13323006
133240              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISPLAY-CARTON     13324006
133250              MOVE SUT00028-TRN-NBR      TO PV-DISPLAY-PO         13325006
133260              MOVE SUT00041-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR    13326006
133270              MOVE POPRPK-PK-SKU-NBR     TO PV-DISPLAY-PACK-SKU   13327006
133280              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      13328006
133290               '7690-DELETE-OTBND-PACK   ' DELIMITED BY SIZE      13329006
133300                     'RETURN-CODE-'        DELIMITED BY SIZE      13330006
133310                     PV-SQLCODE            DELIMITED BY SIZE      13331006
133320                     'CARTON ID '          DELIMITED BY SIZE      13332006
133330                       PV-DISPLAY-CARTON   DELIMITED BY SIZE      13333006
133340                     'PO NUMBER '          DELIMITED BY SIZE      13334006
133350                       PV-DISPLAY-PO       DELIMITED BY SIZE      13335006
133360                     'RCVR '               DELIMITED BY SIZE      13336006
133370                       PV-DISPLAY-PO-RCVR  DELIMITED BY SIZE      13337006
133380                     'PACK SKU '           DELIMITED BY SIZE      13338006
133390                       PV-DISPLAY-PACK-SKU DELIMITED BY SIZE      13339006
133400                                      INTO PV-CICS-MSG-AREA       13340006
133410              MOVE LENGTH OF PV-CICS-MSG-AREA                     13341006
133420                                        TO PV-COMMAREA-LENGTH     13342006
133430              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13343006
133440             MOVE '7690-DELETE-OTBND-PACK'                        13344006
133450                               TO DP013-PARAGRAPH                 13345006
133460             MOVE 'DELETE FROM TABLE  - '                         13346006
133470                               TO DP013-MESSAGE-TEXT (1)          13347006
133480             MOVE SQLCA        TO DP013-SQLCA                     13348006
133490             MOVE 'SUT_OTBND_PK   '                               13349006
133500                               TO DP013-DB2-TABLE-NAME (1)        13350006
133510             SET DP013-DB2-ABEND                                  13351006
133520                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13352006
133530             SET DP013-ROLLBACK                                   13353006
133540                               TO TRUE                            13354006
133550             PERFORM DP014-0000-PROCESS-ABEND                     13355006
133560     END-EVALUATE.                                                13356006
133570                                                                  13357006
133580 7695-SELECT-PREPK-RATIO.                                         13358006
133590                                                                  13359006
133600     MOVE SU001-RCVR-SEQ-NBR           TO RECITM-REC-SEQ-NBR      13360006
133610     MOVE SUT00028-TRN-NBR             TO RECITM-ORD-NBR          13361006
133620     MOVE SUT00028-TRN-LNE-NBR         TO RECITM-ORD-LNE-NBR      13362006
133630                                                                  13363006
133640     EXEC SQL                                                     13364006
133650          SELECT PREPK_RATO_QTY                                   13365006
133660          INTO  :RECITM-PREPK-RATO-QTY                            13366006
133670          FROM   TRECITM                                          13367006
133680          WHERE  ORD_NBR        = :RECITM-ORD-NBR                 13368006
133690          AND    ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR             13369006
133700          AND    REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR             13370006
133710          AND    VER_STATUS_CDE = 'A'                             13371006
133720     END-EXEC.                                                    13372006
133730                                                                  13373006
133740     EVALUATE TRUE                                                13374006
133750         WHEN SQLCODE = ZERO                                      13375006
133760              CONTINUE                                            13376006
133770         WHEN SQLWARN0 NOT = SPACES                               13377006
133780         WHEN SQLCODE NOT EQUAL ZERO                              13378006
133790             MOVE SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR        13379006
133800             MOVE SUT00028-TRN-NBR   TO PV-DISPLAY-TRAN           13380006
133810             MOVE SUT00028-TRN-LNE-NBR TO PV-DISPLAY-LINE         13381006
133820             MOVE '7695-SELECT-PREPK-RATIO'                       13382006
133830                             TO DP013-PARAGRAPH                   13383006
133840             MOVE 'SUKRF502 - SELECT PREPK RATO QTY '             13384006
133850                             TO DP013-MESSAGE-TEXT(1)             13385006
133860             MOVE PV-DISPLAY-PO-RCVR                              13386006
133870                             TO DP013-MESSAGE-TEXT(2)             13387006
133880             MOVE PV-DISPLAY-TRAN                                 13388006
133890                             TO DP013-MESSAGE-TEXT(3)             13389006
133900             MOVE PV-DISPLAY-LINE                                 13390006
133910                             TO DP013-MESSAGE-TEXT(4)             13391006
133920             MOVE SQLCA      TO DP013-SQLCA                       13392006
133930             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME(1)           13393006
133940             SET DP013-DB2-ABEND                                  13394006
133950                             TO TRUE                              13395006
133960             SET DP013-ROLLBACK                                   13396006
133970                             TO TRUE                              13397006
133980             SET DP013-XCTL-DISPLAY-RESTART                       13398006
133990                             TO TRUE                              13399006
134000             PERFORM DP014-0000-PROCESS-ABEND                     13400006
134010     END-EVALUATE.                                                13401006
134020                                                                  13402006
134030                                                                  13403006
134040* PB 06/07/2010 BEG                                               13404006
134050*                                                                 13405006
134060* CHECK IF THE PROCESSED FREIGHT CARTON IS PRESENT ON THE         13406006
134070* OUTBOUND CARTON TABLE AND THE SOURCE CODE IS 'RDM'              13407006
134080*                                                                 13408006
134090 7710-SELECT-OTBND-CART.                                          13409006
134100                                                                  13410006
134110     MOVE SU001-CARTON TO SUT00024-SHIPT-UNT-ID.                  13411006
134120     MOVE 'N'          TO PV-OTBND-CART-YES.                      13412006
134130                                                                  13413006
134140     EXEC SQL                                                     13414006
134150          SELECT DEST_LOC_NBR                                     13415006
134160          INTO   :SUT00024-DEST-LOC-NBR                           13416006
134170          FROM   SUT_OTBND_CART                                   13417006
134180          WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID          13418006
134190           AND   ACTV_IND       = 'Y'                             13419006
134200           AND   CART_SRC_CDE   = 'RDM'                           13420006
134210     END-EXEC.                                                    13421006
134220                                                                  13422006
134230     EVALUATE TRUE                                                13423006
134240         WHEN SQLCODE = ZERO                                      13424006
134250              MOVE 'Y' TO PV-OTBND-CART-YES                       13425006
134260              MOVE SUT00024-DEST-LOC-NBR TO SU001-STORE           13426006
134270         WHEN SQLCODE = +100                                      13427006
134280              CONTINUE                                            13428006
134290         WHEN SQLWARN0 NOT = SPACES                               13429006
134300         WHEN SQLCODE  NOT EQUAL ZERO                             13430006
134310             MOVE SU001-CARTON TO PV-DISPLAY-CARTON               13431006
134320             MOVE SU001-OPER-UNT-ID TO PV-DISPLAY-DC              13432006
134330             MOVE SU001-PO          TO PV-DISPLAY-PO              13433006
134340              MOVE '7710-SELECT-OTBND-CART'                       13434006
134350                             TO DP013-PARAGRAPH                   13435006
134360              MOVE 'SUKRF502 - SELECT '                           13436006
134370                             TO DP013-MESSAGE-TEXT(1)             13437006
134380              MOVE PV-DISPLAY-CARTON                              13438006
134390                             TO DP013-MESSAGE-TEXT(2)             13439006
134400              MOVE PV-DISPLAY-DC                                  13440006
134410                             TO DP013-MESSAGE-TEXT(3)             13441006
134420              MOVE PV-DISPLAY-PO                                  13442006
134430                             TO DP013-MESSAGE-TEXT(4)             13443006
134440              MOVE SQLCA     TO DP013-SQLCA                       13444006
134450              MOVE 'SUT_OTBND_CART '                              13445006
134460                             TO DP013-DB2-TABLE-NAME(1)           13446006
134470              SET DP013-DB2-ABEND                                 13447006
134480                             TO TRUE                              13448006
134490              SET DP013-ROLLBACK                                  13449006
134500                             TO TRUE                              13450006
134510              SET DP013-XCTL-DISPLAY-RESTART                      13451006
134520                             TO TRUE                              13452006
134530              PERFORM DP014-0000-PROCESS-ABEND                    13453006
134540     END-EVALUATE.                                                13454006
134550                                                                  13455006
134560*                                                                 13456006
134570* CHECK IF THE PROCESSED FREIGHT CARTON IS PRESENT ON THE         13457006
134580* OUTBOUND UPC TABLE.                                             13458006
134590*                                                                 13459006
134600                                                                  13460006
134610 7720-SELECT-OTBND-UPC.                                           13461006
134620                                                                  13462006
134630     MOVE SU001-CARTON TO SUT00028-SHIPT-UNT-ID.                  13463006
134640     INITIALIZE PV-PULL-NBR                                       13464006
134650                PV-PULL-LNE-NBR.                                  13465006
134660                                                                  13466006
134670     EXEC SQL                                                     13467006
134680          SELECT TRN_NBR,                                         13468006
134690                 TRN_LNE_NBR                                      13469006
134700          INTO  :SUT00028-TRN-NBR,                                13470006
134710                :SUT00028-TRN-LNE-NBR                             13471006
134720          FROM   SUT_OTBND_UPC                                    13472006
134730          WHERE  SHIPT_UNT_ID   = :SUT00028-SHIPT-UNT-ID          13473006
134740     END-EXEC.                                                    13474006
134750                                                                  13475006
134760     EVALUATE TRUE                                                13476006
134770         WHEN SQLCODE = ZERO                                      13477006
134780              MOVE SUT00028-TRN-NBR     TO PV-PULL-NBR            13478006
134790              MOVE SUT00028-TRN-LNE-NBR TO PV-PULL-LNE-NBR        13479006
134800         WHEN SQLCODE = -811                                      13480006
134810              SET SU001-MULTI-LINE      TO TRUE                   13481006
134820              MOVE SUT00028-TRN-NBR     TO PV-PULL-NBR            13482006
134830              MOVE SUT00028-TRN-LNE-NBR TO PV-PULL-LNE-NBR        13483006
134840         WHEN SQLCODE = +100                                      13484006
134850              SET SU001-NO-LINE         TO TRUE                   13485006
134860         WHEN SQLWARN0 NOT = SPACES                               13486006
134870         WHEN SQLCODE  NOT EQUAL ZERO                             13487006
134880             MOVE SU001-CARTON TO PV-DISPLAY-CARTON               13488006
134890             MOVE SU001-OPER-UNT-ID TO PV-DISPLAY-DC              13489006
134900             MOVE SU001-PO          TO PV-DISPLAY-PO              13490006
134910              MOVE '7720-SELECT-OTBND-UPC '                       13491006
134920                                        TO DP013-PARAGRAPH        13492006
134930              MOVE 'SUKRF502 - SELECT ' TO DP013-MESSAGE-TEXT(1)  13493006
134940              MOVE PV-DISPLAY-CARTON                              13494006
134950                             TO DP013-MESSAGE-TEXT(2)             13495006
134960              MOVE PV-DISPLAY-DC                                  13496006
134970                             TO DP013-MESSAGE-TEXT(3)             13497006
134980              MOVE PV-DISPLAY-PO                                  13498006
134990                             TO DP013-MESSAGE-TEXT(4)             13499006
135000              MOVE SQLCA                TO DP013-SQLCA            13500006
135010              MOVE 'SUT_OTBND_UPC '     TO DP013-DB2-TABLE-NAME(1)13501006
135020              SET DP013-DB2-ABEND       TO TRUE                   13502006
135030              SET DP013-ROLLBACK        TO TRUE                   13503006
135040              SET DP013-XCTL-DISPLAY-RESTART                      13504006
135050                                        TO TRUE                   13505006
135060              PERFORM DP014-0000-PROCESS-ABEND                    13506006
135070     END-EVALUATE.                                                13507006
135080                                                                  13508006
135090*                                                                 13509006
135100* CHECK IF THE INBOUND TRIP ID MATCHES WITH THE MANIFEST ON       13510006
135110* SCREEN. IF THERE IS A MATCH A NEW WHSE REPLN MESSAGE LABEL      13511006
135120* WILL BE PRINTED FOR THE PROCESSED FREIGHT CARTONS ELSE A        13512006
135130* CALL TO TABLE TLBVRMG WILL BE MADE TO CHECK IF THE CARTON HAS   13513006
135140* BEEN SCANNED EARLIER. IF THE CARTON IS SCANNED AGAIN,           13514006
135150* MESSAGE LABEL WILL BE PRINTED ELSE SUKRF530 WILL BE CALLED.     13515006
135160*                                                                 13516006
135170                                                                  13517006
135180 7730-CHECK-INBND-TRIP-ID.                                        13518006
135190                                                                  13519006
135200     MOVE SU001-CARTON      TO SUT00113-SHIPT-UNT-ID.             13520006
135210     MOVE SU001-OPER-UNT-ID TO SUT00113-OPER-UNT-ID.              13521006
135220                                                                  13522006
135230     EXEC SQL                                                     13523006
135240          SELECT  INBND_TRIP_ID                                   13524006
135250          INTO   :SUT00113-INBND-TRIP-ID                          13525006
135260          FROM    SUT_TRLR_RPLN_CART                              13526006
135270          WHERE   SHIPT_UNT_ID   = :SUT00113-SHIPT-UNT-ID         13527006
135280           AND    OPER_UNT_ID    = :SUT00113-OPER-UNT-ID          13528006
135290           AND    INBND_TRIP_ID  > 0                              13529006
135300     END-EXEC.                                                    13530006
135310                                                                  13531006
135320     EVALUATE TRUE                                                13532006
135330         WHEN SQLCODE = ZERO                                      13533006
135340              CONTINUE                                            13534006
135350         WHEN SQLCODE = +100                                      13535006
135360              MOVE 0         TO SUT00113-INBND-TRIP-ID            13536006
135370         WHEN SQLWARN0 NOT = SPACES                               13537006
135380         WHEN SQLCODE NOT EQUAL ZERO                              13538006
135390              MOVE SU001-CARTON TO PV-DISPLAY-CARTON              13539006
135400              MOVE SU001-OPER-UNT-ID TO PV-DISPLAY-DC             13540006
135410              MOVE SU001-PO          TO PV-DISPLAY-PO             13541006
135420              MOVE '7730-CHECK-INBND-TRIP-ID'                     13542006
135430                             TO DP013-PARAGRAPH                   13543006
135440              MOVE 'SUKRF502 - SELECT INBND_TRIP_ID'              13544006
135450                             TO DP013-MESSAGE-TEXT(1)             13545006
135460              MOVE PV-DISPLAY-CARTON                              13546006
135470                             TO DP013-MESSAGE-TEXT(2)             13547006
135480              MOVE PV-DISPLAY-DC                                  13548006
135490                             TO DP013-MESSAGE-TEXT(3)             13549006
135500              MOVE PV-DISPLAY-PO                                  13550006
135510                             TO DP013-MESSAGE-TEXT(4)             13551006
135520              MOVE SQLCA     TO DP013-SQLCA                       13552006
135530              MOVE 'SUT_TRLR_RPLN_CART'                           13553006
135540                             TO DP013-DB2-TABLE-NAME(1)           13554006
135550              SET DP013-DB2-ABEND                                 13555006
135560                             TO TRUE                              13556006
135570              SET DP013-ROLLBACK                                  13557006
135580                             TO TRUE                              13558006
135590              SET DP013-XCTL-DISPLAY-RESTART                      13559006
135600                             TO TRUE                              13560006
135610              PERFORM DP014-0000-PROCESS-ABEND                    13561006
135620     END-EVALUATE.                                                13562006
135630                                                                  13563006
135640     IF SUT00113-INBND-TRIP-ID = SU001-MANIFEST                   13564006
135650        OR SUT00113-INBND-TRIP-ID = 0                             13565006
135660          PERFORM 7740-PROCESS-WHSE-REPLN-LABEL                   13566006
135670     ELSE                                                         13567006
135680          PERFORM 3610-CHECK-LBVRMG-FREE-ASTR                     13568006
135690          IF PS-DISPLAY-SUKRF530                                  13569006
135700             SET SU001-FREE-ASTRY-TRIP-MESS TO TRUE               13570006
135710             MOVE PC-SU-MESSAGE-PGM         TO PV-TRANSFER-PROGRAM13571006
135720             PERFORM 4000-XCTL-LRT-MENU                           13572006
135730          ELSE                                                    13573006
135740             PERFORM 7740-PROCESS-WHSE-REPLN-LABEL                13574006
135750          END-IF                                                  13575006
135760     END-IF.                                                      13576006
135770                                                                  13577006
135780*                                                                 13578006
135790* PRINT THE WHSE REPLN MESSAGE LABEL.                             13579006
135800*                                                                 13580006
135810                                                                  13581006
135820 7740-PROCESS-WHSE-REPLN-LABEL.                                   13582006
135830                                                                  13583006
135840* EA 07/02/2010                                                  *13584006
135850      PERFORM 7644-SELECT-OTBND-LOC                               13585006
135860      PERFORM 7645-SELECT-OTPK-QTY                                13586006
135870      IF PS-OTBND-LOC-ENTRY-NOT-EXIST                             13587006
135880         PERFORM 7645-INSERT-OTBND-LOC                            13588006
135890         PERFORM 7646-CALL-UNT-WKD-MODULE                         13589006
135900      END-IF                                                      13590006
135910*     PERFORM 7645-INSERT-OTBND-LOC.                              13591006
135920*     PERFORM 7646-CALL-UNT-WKD-MODULE.                           13592006
135930* EA 07/02/2010                                                  *13593006
135940      MOVE 'WHSE REPLN'    TO PC160-BTCH-BARCODE.                 13594006
135950      MOVE SPACES          TO CNDCDR-DOOR-ID.                     13595006
135960      MOVE PV-PULL-NBR     TO SU001-PO.                           13596006
135970      MOVE PV-PULL-LNE-NBR TO SU001-PO-LINE-NBR.                  13597006
135980      MOVE ZEROS           TO SU001-RCVR-SEQ-NBR.                 13598006
135990      PERFORM 5005-PRINT-MESSAGE-LABELS.                          13599006
136000                                                                  13600006
136010* PB 06/07/2010 END                                               13601006
136020                                                                  13602006
136030* EA 07/02/2010                                                  *13603006
136040******************************************************************13604006
136050 7644-SELECT-OTBND-LOC.                                           13605006
136060******************************************************************13606006
136070                                                                  13607006
136080     INITIALIZE PV-WHSE-CART-EXIST.                               13608006
136090                                                                  13609006
136100     EXEC SQL                                                     13610006
136110         SELECT 'Y'                                               13611006
136120          INTO :PV-WHSE-CART-EXIST                                13612006
136130          FROM SUT_OTBND_LOC A                                    13613006
136140              ,SUT_OTBND_CART B                                   13614006
136150          WHERE A.SHIPT_UNT_ID = :DK-CTN                          13615006
136160           AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    13616006
136170           AND B.CART_SRC_CDE = 'RDM'                             13617006
136180           AND A.SCN_CDE  = 'RECV'                                13618006
136190          WITH UR                                                 13619006
136200     END-EXEC.                                                    13620006
136210                                                                  13621006
136220     EVALUATE TRUE                                                13622006
136230         WHEN SQLCODE = +0                                        13623006
136240              SET PS-OTBND-LOC-ENTRY-EXIST TO TRUE                13624006
136250         WHEN SQLCODE = +100                                      13625006
136260              SET PS-OTBND-LOC-ENTRY-NOT-EXIST TO TRUE            13626006
136270         WHEN SQLWARN0 NOT = SPACES                               13627006
136280         WHEN SQLCODE NOT EQUAL ZERO                              13628006
136290             MOVE ' 7644-SELECT-OTBND-LOC      '                  13629006
136300                                         TO DP013-PARAGRAPH       13630006
136310             MOVE SQLCA        TO DP013-SQLCA                     13631006
136320             MOVE DK-CTN       TO PV-DISPLAY-CARTON               13632006
136330             MOVE SU001-OPER-UNT-ID TO PV-DISPLAY-DC              13633006
136340             MOVE SU001-PO          TO PV-DISPLAY-PO              13634006
136350             MOVE 'SUKRF502 - CHECK OTBND LOC '                   13635006
136360                             TO DP013-MESSAGE-TEXT(1)             13636006
136370             MOVE PV-DISPLAY-CARTON                               13637006
136380                             TO DP013-MESSAGE-TEXT(2)             13638006
136390             MOVE PV-DISPLAY-DC                                   13639006
136400                             TO DP013-MESSAGE-TEXT(3)             13640006
136410             MOVE PV-DISPLAY-PO                                   13641006
136420                             TO DP013-MESSAGE-TEXT(4)             13642006
136430             MOVE 'SUT_OTBND_LOC'  TO DP013-DB2-TABLE-NAME(1)     13643006
136440             SET DP013-DB2-ABEND                                  13644006
136450                            TO TRUE                               13645006
136460             SET DP013-ROLLBACK                                   13646006
136470                            TO TRUE                               13647006
136480             SET DP013-XCTL-DISPLAY-RESTART                       13648006
136490                            TO TRUE                               13649006
136500             PERFORM DP014-0000-PROCESS-ABEND                     13650006
136510     END-EVALUATE.                                                13651006
136520                                                                  13652006
136530******************************************************************13653006
136540 7645-SELECT-OTPK-QTY.                                            13654006
136550******************************************************************13655006
136560                                                                  13656006
136570     EXEC SQL                                                     13657006
136580         SELECT SUM(SHPD_UNT_QTY)                                 13658006
136590          INTO :PV-OUTR-PACK-QTY                                  13659006
136600          FROM SUT_OTBND_UPC                                      13660006
136610          WHERE SHIPT_UNT_ID = :DK-CTN                            13661006
136620          WITH UR                                                 13662006
136630     END-EXEC.                                                    13663006
136640                                                                  13664006
136650     EVALUATE TRUE                                                13665006
136660         WHEN SQLCODE = +0                                        13666006
136670              CONTINUE                                            13667006
136680         WHEN SQLCODE = +100                                      13668006
136690              MOVE +0 TO PV-OUTR-PACK-QTY                         13669006
136700         WHEN SQLWARN0 NOT = SPACES                               13670006
136710         WHEN SQLCODE NOT EQUAL ZERO                              13671006
136720             MOVE ' 7645-SELECT-OTPK-QTY       '                  13672006
136730                                         TO DP013-PARAGRAPH       13673006
136740             MOVE SQLCA        TO DP013-SQLCA                     13674006
136750             MOVE DK-CTN       TO PV-DISPLAY-CARTON               13675006
136760             MOVE SU001-OPER-UNT-ID TO PV-DISPLAY-DC              13676006
136770             MOVE SU001-PO          TO PV-DISPLAY-PO              13677006
136780             MOVE 'SUKRF502 - CHECK OTBND UPC '                   13678006
136790                             TO DP013-MESSAGE-TEXT(1)             13679006
136800             MOVE PV-DISPLAY-CARTON                               13680006
136810                             TO DP013-MESSAGE-TEXT(2)             13681006
136820             MOVE PV-DISPLAY-DC                                   13682006
136830                             TO DP013-MESSAGE-TEXT(3)             13683006
136840             MOVE PV-DISPLAY-PO                                   13684006
136850                             TO DP013-MESSAGE-TEXT(4)             13685006
136860             MOVE 'SUT_OTBND_UPC'  TO DP013-DB2-TABLE-NAME(1)     13686006
136870             SET DP013-DB2-ABEND                                  13687006
136880                            TO TRUE                               13688006
136890             SET DP013-ROLLBACK                                   13689006
136900                            TO TRUE                               13690006
136910             SET DP013-XCTL-DISPLAY-RESTART                       13691006
136920                            TO TRUE                               13692006
136930             PERFORM DP014-0000-PROCESS-ABEND                     13693006
136940     END-EVALUATE.                                                13694006
136950                                                                  13695006
136960 7646-CALL-UNT-WKD-MODULE.                                        13696006
136970                                                                  13697006
136980     INITIALIZE PC260-COMM-AREA.                                  13698006
136990     MOVE SU001-CARTON                TO PC260-SHIPT-UNT-ID       13699006
137000     MOVE SU001-CURR-OPER-UNT-ID      TO PC260-OPER-UNT-ID        13700006
137010     MOVE 'REPLEN'                    TO PC260-PRCG-AREA-CDE      13701006
137020     SET PC260-TRANS-LINE-VERIFY      TO TRUE.                    13702006
137030     SET PC260-MOD-SUCCESSFUL         TO TRUE.                    13703006
137040                                                                  13704006
137050*    CALL PC260-VSM-PGM USING PC260-COMM-AREA.                    13705006
137060*    CALL 'PCKUT790' USING PC260-COMM-AREA.                       13706006
137070                                                                  13707006
137080     CALL PC260-VSM-PGM USING  DFHEIBLK                           13708006
137090                               PC260-COMMAREA                     13709006
137100                               PC260-COMM-AREA.                   13710006
137110     EVALUATE TRUE                                                13711006
137120         WHEN PC260-MOD-SUCCESSFUL                                13712006
137130             DISPLAY ' UNIT WORKED DATA UPDATED'                  13713006
137140         WHEN OTHER                                               13714006
137150             MOVE PC260-BAD-SQL-CDE    TO PV-SQLCODE              13715006
137160              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      13716006
137170               '7646-CALL-UNT-WKD-MODULE ' DELIMITED BY SIZE      13717006
137180                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      13718006
137190                       PV-SQLCODE          DELIMITED BY SIZE      13719006
137200                                      INTO PV-CICS-MSG-AREA       13720006
137210              MOVE LENGTH OF PV-CICS-MSG-AREA                     13721006
137220                                        TO PV-COMMAREA-LENGTH     13722006
137230              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13723006
137240                                                                  13724006
137250              MOVE  '7646-CALL-UNT-WKD-MODULE'                    13725006
137260                              TO DP013-PARAGRAPH                  13726006
137270              MOVE PC260-PARAGRAPH                                13727006
137280                              TO DP013-MESSAGE-TEXT(1)            13728006
137290              MOVE PC260-MESSAGE-TEXT                             13729006
137300                                TO DP013-MESSAGE-TEXT (2)         13730006
137310              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           13731006
137320              STRING '  CARTON - '        DELIMITED BY SIZE       13732006
137330                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       13733006
137340                              INTO DP013-MESSAGE-TEXT (3)         13734006
137350              STRING ' SUKRF502 (OTHER) -' DELIMITED BY SIZE      13735006
137360               '7646-CALL-UNT-WKD-MODULE ' DELIMITED BY SIZE      13736006
137370                 'DL-RETURN-SQLCODES '     DELIMITED BY SIZE      13737006
137380                       PV-SQLCODE          DELIMITED BY SIZE      13738006
137390                              INTO DP013-MESSAGE-TEXT (4)         13739006
137400              SET DP013-DB2-ABEND                                 13740006
137410                              TO TRUE                             13741006
137420              SET DP013-ROLLBACK                                  13742006
137430                              TO TRUE                             13743006
137440              SET DP013-XCTL-DISPLAY-RESTART                      13744006
137450                              TO TRUE                             13745006
137460              PERFORM DP014-0000-PROCESS-ABEND                    13746006
137470     END-EVALUATE.                                                13747006
137480*                                                                 13748006
137490* EA 07/02/2010                                                  *13749006
137500 8000-SEND-MAP.                                                   13750006
137510                                                                  13751006
137520     EXEC CICS                                                    13752006
137530         SEND MAP       ('SU502A')                                13753006
137540              MAPSET    ('SUKM502')                               13754006
137550              ERASE                                               13755006
137560              CURSOR                                              13756006
137570              RESP      (PV-CICS-RESPONSE)                        13757006
137580     END-EXEC.                                                    13758006
137590                                                                  13759006
137600     EVALUATE TRUE                                                13760006
137610         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13761006
137620             CONTINUE                                             13762006
137630         WHEN OTHER                                               13763006
137640             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         13764006
137650             MOVE 'SUKRF502 - UNABLE TO SEND MAP'                 13765006
137660                                       TO DP013-MESSAGE-TEXT (1)  13766006
137670             SET DP013-CICS-ABEND      TO TRUE                    13767006
137680             SET DP013-ROLLBACK        TO TRUE                    13768006
137690             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13769006
137700     END-EVALUATE.                                                13770006
137710                                                                  13771006
137720 8100-SEND-DATA-ONLY.                                             13772006
137730                                                                  13773006
137740     EXEC CICS                                                    13774006
137750         SEND MAP       ('SU502A')                                13775006
137760              MAPSET    ('SUKM502')                               13776006
137770              CURSOR                                              13777006
137780              DATAONLY                                            13778006
137790              RESP      (PV-CICS-RESPONSE)                        13779006
137800     END-EXEC.                                                    13780006
137810                                                                  13781006
137820     EVALUATE TRUE                                                13782006
137830         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13783006
137840             CONTINUE                                             13784006
137850         WHEN OTHER                                               13785006
137860             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        13786006
137870             MOVE 'SUKRF502 - UNABLE TO SEND DATA'                13787006
137880                                        TO DP013-MESSAGE-TEXT (1) 13788006
137890             SET DP013-CICS-ABEND       TO TRUE                   13789006
137900             SET DP013-ROLLBACK         TO TRUE                   13790006
137910             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13791006
137920     END-EVALUATE.                                                13792006
137930                                                                  13793006
137940 8200-RETURN-TRANID.                                              13794006
137950                                                                  13795006
137960*LMM                                                              13796006
137970     MOVE LENGTH OF CA-COMMAREA  TO PV-COMMAREA-LENGTH            13797006
137980     EXEC CICS                                                    13798006
137990         RETURN TRANSID  (PC-TRANID)                              13799006
138000                COMMAREA (CA-COMMAREA)                            13800006
138010                LENGTH   (PV-COMMAREA-LENGTH)                     13801006
138020                RESP     (PV-CICS-RESPONSE)                       13802006
138030     END-EXEC.                                                    13803006
138040                                                                  13804006
138050     EVALUATE TRUE                                                13805006
138060         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13806006
138070             CONTINUE                                             13807006
138080         WHEN OTHER                                               13808006
138090             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        13809006
138100             MOVE 'SUKRF502 - UNABLE TO RETURN TO TRANID'         13810006
138110                 TO DP013-MESSAGE-TEXT (1)                        13811006
138120             SET DP013-CICS-ABEND       TO TRUE                   13812006
138130             SET DP013-ROLLBACK         TO TRUE                   13813006
138140             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13814006
138150     END-EVALUATE.                                                13815006
138160                                                                  13816006
138170 8300-RETURN.                                                     13817006
138180                                                                  13818006
138190     EXEC CICS                                                    13819006
138200         SEND FROM (PV-MESSAGE-AREA)                              13820006
138210              LENGTH (19)                                         13821006
138220              ERASE                                               13822006
138230     END-EXEC.                                                    13823006
138240                                                                  13824006
138250     EXEC CICS                                                    13825006
138260         RETURN                                                   13826006
138270     END-EXEC.                                                    13827006
138280                                                                  13828006
138290                                                                  13829006
138300*9100-SYNCPOINT.                                                  13830006
138310*                                                                 13831006
138320*    EXEC CICS                                                    13832006
138330*        SYNCPOINT                                                13833006
138340*    END-EXEC.                                                    13834006
138350                                                                  13835006
138360 9998-WRITE-TO-CSSL.                                              13836006
138370        EXEC CICS                                                 13837006
138380            WRITEQ TD                                             13838006
138390                QUEUE   ('CSSL')                                  13839006
138400                FROM    (PV-CICS-MSG-AREA-A)                      13840006
138410                LENGTH  (PV-COMMAREA-LENGTH)                      13841006
138420                RESP    (PV-CICS-RESPONSE)                        13842006
138430        END-EXEC.                                                 13843006
138440                                                                  13844006
138450 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  13845006
138460                                                                  13846006
138470     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              13847006
138480     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             13848006
138490     INITIALIZE DP013-SRC-TASK-NUMBER                             13849006
138500                DP013-STACK.                                      13850006
138510     SET DP013-LINK-RETURN TO TRUE.                               13851006
138520                                                                  13852006
138530     EXEC CICS                                                    13853006
138540         LINK                                                     13854006
138550             PROGRAM   (DP013-NAME)                               13855006
138560             COMMAREA  (DP013-PARAMETERS)                         13856006
138570             LENGTH    (DP013-LENGTH)                             13857006
138580     END-EXEC.                                                    13858006
138590                                                                  13859006
138600*----------------------------------------------------------------*13860006
138610*    ABEND PROCESSOR MODULE                                      *13861006
138620*----------------------------------------------------------------*13862006
138630                                                                  13863006
138640     COPY DPPD014.                                                13864006
138650                                                                  13865006
