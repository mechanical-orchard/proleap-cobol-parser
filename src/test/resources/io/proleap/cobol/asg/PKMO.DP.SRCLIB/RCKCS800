000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.    RCKCS800.                                         00020099
000300 AUTHOR.        KAREN WALL                                        00030099
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040099
000500 DATE-WRITTEN.  08-12-99.                                         00050099
000600 DATE-COMPILED.                                                   00060099
000700                                                                  00070099
000800*---------------------------------------------------------------* 00080099
000900*    E800 - RECEIVER PACK LIST PROGRAM                          * 00090099
001000*                                                               * 00100099
001100*    THIS PROGRAM GENERATES A LIST OF PACKS INFORMATION FOR A   * 00110099
001200*    SPECIFIC  RECEIVER.                                        * 00120099
001300*                                                               * 00130099
001310***************************************************************** 00131099
001320*  CHANGED 10/20/2014 BY CHERI PARMLEY                          * 00132099
001330*   CHG# 0094517  EXPANDED PO FROM 7 TO 8 DIGITS                * 00133099
001331*                 ONLY TO WRITE TO CICS LOG IF ERROR            * 00133199
001332***************************************************************** 00133299
001400*---------------------------------------------------------------* 00140099
001500* MAINTENANCE:                                                  * 00150099
001600*---------------------------------------------------------------* 00160099
001610* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00161099
001620* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00162099
001630* MAKING THE CALL DYNAMIC VS STATIC.                              00163099
001640*---------------------------------------------------------------* 00164099
001700/                                                                 00170099
001800 ENVIRONMENT DIVISION.                                            00180099
001900                                                                  00190099
002000 DATA DIVISION.                                                   00200099
002100                                                                  00210099
002200 WORKING-STORAGE SECTION.                                         00220099
002300                                                                  00230099
002400 01  DK-DB2-KEYS.                                                 00240099
002500*    REQUIRED FIELDS                                              00250099
002600     05  DK-ORD-NBR                     PIC S9(09)  COMP.         00260099
002700     05  DK-RCVR-SEQ-NBR                PIC S9(09)  COMP.         00270099
002800     05  DK-PACK-ID                     PIC S9(03)  COMP.         00280099
002900     05  DK-LINE-NBR                    PIC S9(04)  COMP.         00290099
003000     05  DK-OPR-ID                      PIC S9(04)  COMP.         00300099
003100     05  DK-FACT                        PIC S9(04)  COMP.         00310099
003200                                                                  00320099
003300 01  PC-PROGRAM-CONSTANTS.                                        00330099
003400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00340099
003500                                                    'RC800A  '.   00350099
003600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00360099
003700                                                    'RCKM800 '.   00370099
003800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00380099
003900                                                    'RCKCS800'.   00390099
004000     05  PC-CURRENT-PROGRAM-ERROR       PIC  X(03) VALUE '800'.   00400099
004010     05  PC-WMS-CONTROL-MOD           PIC X(8)  VALUE  'WSKCS305'.00401099
004100     05  PC-APPL-MAP                    PIC S9(04)  VALUE  +1     00410099
004200                                                    COMP.         00420099
004300     05  PC-AUDIT-RTN                   PIC X(08)  VALUE          00430099
004400                                                       'RCKCS290'.00440099
004500     05  PC-AUDIT-RTN-LENGTH          PIC S9(4) VALUE +300        00450099
004600                                                COMP SYNC.        00460099
004700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00470099
004800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00480099
004900     05  PC-INTER-APPL-CODES.                                     00490099
005000         10 PC-INTER-APPL-CRIT-SPEC     PIC  X(01)  VALUE '1'.    00500099
005100         10 PC-INTER-APPL-PKSL-LIST     PIC  X(01)  VALUE '2'.    00510099
005200     05  PC-WORK-ORDER-DIST-SHEET       PIC  9(03)  VALUE 001.    00520099
005300     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +9      00530099
005400                                                    COMP SYNC.    00540099
005500     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00550099
005600                                                    COMP SYNC.    00560099
005700     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00570099
005800                                                    +1000000      00580099
005900                                                    COMP-3.       00590099
006000     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00600099
006100                                                    COMP SYNC.    00610099
006200     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE +3      00620099
006300                                                    COMP-3.       00630099
006400     05  PC-DEFAULT-TMST                PIC  X(26)  VALUE         00640099
006500                                   '9999-09-09-09.09.09.999999'.  00650099
006600     05  PC-DEFAULT-DATE                PIC  X(10)  VALUE         00660099
006700                                                  '9999-09-09'.   00670099
006800                                                                  00680099
006900     05  PC-TROUBLE-RTN                 PIC X(08)  VALUE          00690099
007000                                                       'TMKCS520'.00700099
007100     05  PC-TROUBLE-RTN-LENGTH          PIC S9(04) VALUE +600     00710099
007200                                                   COMP.          00720099
007300     05  PC-INACTIVE                    PIC X(01)  VALUE 'I'.     00730099
007400     05  PC-A                           PIC  X(01)  VALUE 'A'.    00740099
007500     05  PC-I                           PIC  X(01)  VALUE 'I'.    00750099
007600     05  PC-N                           PIC  X(01)  VALUE 'N'.    00760099
007700     05  PC-R                           PIC  X(01)  VALUE 'R'.    00770099
007800     05  PC-T                           PIC  X(01)  VALUE 'T'.    00780099
007900     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00790099
008000                                                                  00800099
008100     05  PC-OP-CO-NBR                   PIC  X(02)  VALUE '03'.   00810099
008200     05  PC-BULK                        PIC  X(01)  VALUE 'B'.    00820099
008300     05  PC-CASE                        PIC  X(01)  VALUE 'C'.    00830099
008400     05  PC-MULTIPLE                    PIC  X(01)  VALUE 'M'.    00840099
008500     05  PC-INNER                       PIC  X(01)  VALUE 'I'.    00850099
008600     05  PC-SINGLE                      PIC  X(01)  VALUE 'S'.    00860099
008700     05  PC-PKG-TYP-NOT-FOUND           PIC  X(01)  VALUE 'X'.    00870099
008800                                                                  00880099
008900     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00890099
009000     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00900099
009100     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00910099
009200     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00920099
009300     05  PC-VE                          PIC  X(02)  VALUE 'VE'.   00930099
009400     05  PC-MULTI-SKU-PACK-DESC         PIC  X(12)  VALUE         00940099
009500         'M MULTI PACK'.                                          00950099
009600     05  PC-SINGLE-SKU-PACK-DESC        PIC  X(12)  VALUE         00960099
009700         'S SINGLE SKU'.                                          00970099
009800     05  PC-INNER-PACK-DESC             PIC  X(12)  VALUE         00980099
009900         'I INNER PACK'.                                          00990099
010000     05  PC-BULK-PACK-DESC              PIC  X(11)  VALUE         01000099
010100         'B BULK PACK'.                                           01010099
010200     05  PC-CASE-PACK-DESC              PIC  X(11)  VALUE         01020099
010300         'C CASE PACK'.                                           01030099
010400     05  PC-PKG-TYP-NOT-FOUND-DESC      PIC  X(19)  VALUE         01040099
010500         'PACK TYPE NOT FOUND'.                                   01050099
010600                                                                  01060099
010700     05  PC-TSYMSG-NUMBERS.                                       01070099
010800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01080099
010900         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01090099
011000         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01100099
011100         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01110099
011200         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01120099
011300         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01130099
011400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01140099
011500         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01150099
011600         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01160099
011700         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01170099
011800         10  PC-TSYMSG-00059            PIC  9(05)  VALUE 00059.  01180099
011900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01190099
012000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01200099
012100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01210099
012200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01220099
012300         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01230099
012400         10  PC-TSYMSG-00815            PIC  9(05)  VALUE 00815.  01240099
012500*            P.O. NUMBER REQUIRED                                 01250099
012600         10  PC-TSYMSG-00736            PIC  9(05)  VALUE 00736.  01260099
012700*            RECEIVER SEQUENCE NBR REQUIRED                       01270099
012800         10  PC-TSYMSG-00737            PIC  9(05)  VALUE 00737.  01280099
012900         10  PC-TSYMSG-00928            PIC  9(05)  VALUE 00928.  01290099
013000         10  PC-TSYMSG-00929            PIC  9(05)  VALUE 00929.  01300099
013100         10  PC-TSYMSG-00937            PIC  9(05)  VALUE 00937.  01310099
013200*            UNABLE TO REDISTRO DUE TO TROUBLE                    01320099
013300         10  PC-TSYMSG-00941            PIC  9(05)  VALUE 00941.  01330099
013400*            REDISTRO SUCCESSFUL BUT TROUBLE CREATED              01340099
013500         10  PC-TSYMSG-01196            PIC  9(05)  VALUE 01196.  01350099
013600         10  PC-TSYMSG-01570            PIC  9(05)  VALUE 01570.  01360099
013700* SYSTEM ERROR, CONTACT HELP DESK                                 01370099
013800         10  PC-TSYMSG-01793            PIC  9(05)  VALUE 01793.  01380099
013900         10  PC-TSYMSG-02106            PIC  9(05)  VALUE 02106.  01390099
014000         10  PC-TSYMSG-02165            PIC  9(05)  VALUE 02165.  01400099
014020         10  PC-TSYMSG-03138            PIC  9(05)  VALUE 03138.  01402099
014100         10  PC-TSYMSG-02166            PIC  9(05)  VALUE 02166.  01410099
014200*  ONLY PO WITH PKGNG CODE OF "I" OR "M" CAN USE PACK LIST        01420099
014300         10  PC-TSYMSG-02174            PIC  9(05)  VALUE 02174.  01430099
014400         10  PC-TSYMSG-02180          PIC 9(05)  VALUE 02180.     01440099
014500* PRESS F2 TO CONFIRM DELETE OF ENTIRE PACK                       01450099
014600         10  PC-TSYMSG-02195            PIC  9(05)  VALUE 02195.  01460099
014700* UNTIED LINES, CAN'T UPDATE SEE ANALYST.                         01470099
014800         10  PC-TSYMSG-02229            PIC  9(05)  VALUE 02229.  01480099
014900* A PREPACK SYSTEM ERROR HAS OCCURRED (&VAR). PLEASE CONTACT HELP 01490099
015000         10  PC-TSYMSG-02330            PIC  9(05)  VALUE 02330.  01500099
015100* REDISTRO WAS NOT SUCCESSFUL FOR ALL PACKS DUE TO TROUBLE        01510099
015200         10  PC-TSYMSG-02452            PIC  9(05)  VALUE 02452.  01520099
015300*  ALLOCATION IS INCORRECT; PLEASE REVIEW DISTRO                  01530099
015400         10  PC-TSYMSG-03244            PIC  9(05)  VALUE 03244.  01540099
015500*  PACKSLIP EXISTS, DELETION OF LINES/PACKS IS NOT ALLOWED        01550099
015510         10  PC-TSYMSG-03394            PIC  9(05)  VALUE 03394.  01551099
015520*  UNABLE TO REDISTRO - MANIFESTED CARTONS EXIST FOR PO/RCVR/LNE  01552099
015530         10  PC-TSYMSG-03538            PIC  9(05)  VALUE 03538.  01553099
015540*  UNABLE TO DELETE LINE FROM PACK, RCVG HAS BEGUN IN WMS         01554099
015541* JAK 05/2007 - ADD NEW MESSAGES FOR WMS                          01554199
015550         10  PC-TSYMSG-03546            PIC  9(05)  VALUE 03546.  01555099
015560*  ERROR IN WMS DOWNLOAD MOD - CONTACT HELP DESK                  01556099
015561         10  PC-TSYMSG-03568            PIC  9(05)  VALUE 03568.  01556199
015562*  REDISTRO SUCCESSFUL AND ASN WILL BE DOWNLOADED TO WMS          01556299
015570         10  PC-TSYMSG-03569            PIC  9(05)  VALUE 03569.  01557099
015580*  REDISTRO SUCCESSFUL, ASN WILL BE DWNLD TO WMS, BUT TROUBLE     01558099
015581         10  PC-TSYMSG-03578            PIC  9(05)  VALUE 03578.  01558199
015582*  DELETE SUCCESSFUL AND WMOS WILL BE UPDATED ACCORDINGLY         01558299
015590* JAK 05/2007 - END                                               01559099
015600                                                                  01560099
015700 01  PS-PROGRAM-SWITCHES.                                         01570099
015800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01580099
015900         88  PS-NO-ERROR                            VALUE 'Y'.    01590099
016000         88  PS-ERROR                               VALUE 'N'.    01600099
016100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01610099
016200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01620099
016300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01630099
016400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01640099
016500         88  PS-DONE                                VALUE 'Y'.    01650099
016600         88  PS-NOT-DONE                            VALUE 'N'.    01660099
016700     05  PS-VERIFIED-RECEIVER-SW        PIC  X(01)  VALUE 'N'.    01670099
016800         88  PS-VERIFIED-RECEIVER                   VALUE 'Y'.    01680099
016900     05  PS-LINE-VERIFIED-SW          PIC X(01)  VALUE 'N'.       01690099
017000         88  PS-LINE-VERIFIED                    VALUE 'Y'.       01700099
017100     05  PS-EMPTY-PACK-SW               PIC  X(01)  VALUE 'N'.    01710099
017200         88  PS-EMPTY-PACK                          VALUE 'Y'.    01720099
017300         88  PS-PACK-NOT-EMPTY                      VALUE 'N'.    01730099
017400     05  PS-UNTIED-PACK-SW              PIC  X(01)  VALUE 'N'.    01740099
017500         88  PS-UNTIED-PACK                         VALUE 'Y'.    01750099
017600         88  PS-TIED-PACK                           VALUE 'N'.    01760099
017700     05  PS-ACTION-LINES-SW           PIC X(01)  VALUE ' '.       01770099
017800         88  PS-DELETE-RECDIS                    VALUE 'D'.       01780099
017900         88  PS-UPDATE-RECITM                    VALUE 'U'.       01790099
018000         88  PS-DONT-DELETE-LINES                VALUE ' '.       01800099
018100     05  PS-REDISTRO-SW               PIC X(01)  VALUE 'N'.       01810099
018200         88  PS-REDISTRO-OK                      VALUE 'Y'.       01820099
018300         88  PS-REDISTRO-NOT-OK                  VALUE 'N'.       01830099
018400     05  PS-PACK-BY-ST-SW             PIC X(01)    VALUE SPACE.   01840099
018500         88  PS-PACK-BY-ST-SW-YES                  VALUE 'Y'.     01850099
018510     05  PS-ASNS-TO-WMS-SW            PIC X(01) VALUE 'N'.        01851099
018520         88  PS-ASNS-TO-WMS-YES                 VALUE 'Y'.        01852099
018530         88  PS-ASNS-TO-WMS-NO                  VALUE 'N'.        01853099
018540     05  PS-RECEIVING-SW              PIC X(01) VALUE 'N'.        01854099
018550         88  PS-RECEIVING-BEGUN-YES             VALUE 'Y'.        01855099
018560         88  PS-RECEIVING-BEGUN-NO              VALUE 'N'.        01856099
018600                                                                  01860099
018700 01  PV-PROGRAM-VARIABLES.                                        01870099
018800     05  PV-SUB                         PIC S9(04)  VALUE +0      01880099
018900                                                    COMP SYNC.    01890099
019000     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01900099
019100                                                    COMP SYNC.    01910099
019200     05  PV-NULL-IND                    PIC S9(02)  VALUE +0      01920099
019300                                                    COMP.         01930099
019400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01940099
019500                                                    COMP-3.       01950099
019600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01960099
019700                                                    COMP-3.       01970099
019800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01980099
019900                                                    COMP-3.       01990099
019901     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01990199
019902                                                     COMP SYNC.   01990299
019910     05  PV-CICS-MSG-AREA             PIC X(75)  VALUE SPACE.     01991099
020000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02000099
020100                                                    COMP-3.       02010099
020200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02020099
020300                                                    COMP-3.       02030099
020400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02040099
020500                                                    COMP-3.       02050099
020600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02060099
020700                                                    COMP-3.       02070099
020800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02080099
020900                                                    COMP SYNC.    02090099
021000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02100099
021100                                                    COMP SYNC.    02110099
021200     05  PV-ITEM                        PIC S9(04)  VALUE +0      02120099
021300                                                    COMP SYNC.    02130099
021400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02140099
021500                                                    COMP SYNC.    02150099
021600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02160099
021700                                                    COMP SYNC.    02170099
021800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02180099
021900                                                    COMP SYNC.    02190099
022000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02200099
022100                                                    COMP SYNC.    02210099
022200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02220099
022300                                                    COMP SYNC.    02230099
022400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02240099
022500                                                    COMP SYNC.    02250099
022600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02260099
022700                                                    COMP SYNC.    02270099
022800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02280099
022900                                                    COMP SYNC.    02290099
023000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02300099
023100                                                    COMP SYNC.    02310099
023200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02320099
023300                                                    COMP SYNC.    02330099
023400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02340099
023500                                                    COMP SYNC.    02350099
023600     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      02360099
023700                                                    COMP-3.       02370099
023800     05  PV-LN-UNRSLVD-TRBL-CNT      PIC S9(09)  VALUE ZERO       02380099
023900                                                    COMP-3.       02390099
024000     05  PV-LN-RSLVD-TRBL-CNT        PIC S9(09)  VALUE ZERO       02400099
024100                                                    COMP-3.       02410099
024200     05  PV-PK-UNRSLVD-TRBL-CNT       PIC S9(09)  VALUE ZERO      02420099
024300                                                    COMP-3.       02430099
024400     05  PV-PK-RSLVD-TRBL-CNT         PIC S9(09)  VALUE ZERO      02440099
024500                                                    COMP-3.       02450099
024600     05  PV-AP-VERIFY-ITM-QTY         PIC S9(05)  VALUE +0        02460099
024700                                                    COMP.         02470099
024800     05  PV-PO-NBR                    PIC S9(09)   COMP           02480099
024900                                                   VALUE ZERO.    02490099
025000     05  PV-REC-SEQ-NBR               PIC S9(09)   COMP           02500099
025100                                                   VALUE ZERO.    02510099
025200     05  PV-PACK-ID                   PIC S9(02)   COMP           02520099
025300                                                   VALUE ZERO.    02530099
025400     05  PV-PACK-LINE-COUNT           PIC S9(04)   VALUE +0       02540099
025500                                                    COMP.         02550099
025600     05  PV-PACKSLIP-COUNT            PIC S9(04)   VALUE +0       02560099
025700                                                    COMP.         02570099
025800     05  PV-PACK-DTL-CK-ITM-QTY       PIC S9(05)   VALUE +0       02580099
025900                                                    COMP.         02590099
026000     05  PV-PACK-ODD-UNITS-QTY        PIC S9(05)   VALUE +0       02600099
026100                                                    COMP.         02610099
026200     05  PV-PACK-RATIO-QTY            PIC S9(04)   VALUE +0       02620099
026300                                                   COMP.          02630099
026400     05  PV-PO-PACK-RATIO-QTY         PIC S9(04)   VALUE +0       02640099
026500                                                   COMP.          02650099
026600     05  PV-PACK-PKSL-ITM-QTY         PIC S9(05)   VALUE +0       02660099
026700                                                    COMP.         02670099
026800     05  PV-FOUND-LINE-STATUS-IP      PIC X(01)    VALUE 'N'.     02680099
026900     05  PV-FOUND-LINE-STATUS-CM      PIC X(01)    VALUE 'N'.     02690099
027000     05  PV-FOUND-LINE-STATUS-VE      PIC X(01)    VALUE 'N'.     02700099
027100     05  PV-PREV-PACK-ID              PIC S9(02)  COMP            02710099
027200                                                  VALUE +0.       02720099
027300     05  PV-CURR-PACK-ID              PIC S9(03)  COMP            02730099
027400                                                  VALUE +0.       02740099
027500     05  PV-PO-LNE-NBR                PIC S9(9) COMP VALUE +0.    02750099
027600     05  PV-OPER-UNT-ID               PIC S9(4) COMP.             02760099
027700     05  PV-FCLTY-ID                  PIC S9(4) COMP.             02770099
027800     05  PV-CRE-TMST.                                             02780099
027900         10  FILLER                     PIC X(02).                02790099
028000         10  PV-CRE-YY                  PIC X(02).                02800099
028100         10  FILLER                     PIC X(01).                02810099
028200         10  PV-CRE-MM                  PIC X(02).                02820099
028300         10  FILLER                     PIC X(01).                02830099
028400         10  PV-CRE-DD                  PIC X(02).                02840099
028500         10  FILLER                     PIC X(01).                02850099
028600         10  PV-CRE-HRS                 PIC X(02).                02860099
028700         10  FILLER                     PIC X(01).                02870099
028800         10  PV-CRE-MIN                 PIC X(02).                02880099
028900         10  FILLER                     PIC X(10).                02890099
029000     05  PV-CREATE-DTE.                                           02900099
029100         10  PV-CREATE-MM               PIC X(02).                02910099
029200         10  FILLER                     PIC X(01) VALUE '/'.      02920099
029300         10  PV-CREATE-DD               PIC X(02).                02930099
029400         10  FILLER                     PIC X(01) VALUE '/'.      02940099
029500         10  PV-CREATE-YY               PIC X(02).                02950099
029600     05  PV-CREATE-TME.                                           02960099
029700         10  PV-CREATE-HRS              PIC X(02).                02970099
029800         10  FILLER                     PIC X(01) VALUE ':'.      02980099
029900         10  PV-CREATE-MIN              PIC X(02).                02990099
030000     05  PV-CURRENT-TIMESTAMP           PIC  X(26).               03000099
030100     05  PV-NBR-OF-PIC-AD               PIC S9(04) COMP.          03010099
030200     05  PV-TOTAL-LINES-VERIFIED        PIC S9(03) COMP VALUE +0. 03020099
030300     05  PV-TOTAL-CASEPACK              PIC S9(03) COMP VALUE +0. 03030099
030310*CLP 10/20/14                                                     03031099
030400     05  PV-DISP-PO-NBR                 PIC 9(8).                 03040099
030500     05  PV-DISP-REC-SEQ-NBR            PIC 9(4).                 03050099
030600     05  PV-DISP-PO-LNE-NBR             PIC 9(3).                 03060099
030700     05  PV-DISP-OPER-UNT-ID            PIC 9(4).                 03070099
030800     05  PV-DISP-FCLTY-ID               PIC 9(4).                 03080099
030900     05  PV-DISP-PACK-ID                PIC 9(4).                 03090099
031000                                                                  03100099
031100     05  PV-PO-NBR-PIC9               PIC S9(11) VALUE +0.        03110099
031200     05  PV-REC-SEQ-NBR-PIC9          PIC S9(11) VALUE +0.        03120099
031300     05  PV-PO-LNE-NBR-PIC9           PIC S9(11) VALUE +0.        03130099
031400                                                                  03140099
031500*---------------------------------------------------------------* 03150099
031600*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 03160099
031700*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 03170099
031800*   APPLICATION-SPECIFIC COMMAREA.                              * 03180099
031900*---------------------------------------------------------------* 03190099
032000 01  LQW-LIST-QUEUE-WORK-AREA.                                    03200099
032100     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  03210099
032200     05  LQW-ITEM-ENTRIES               OCCURS 9 TIMES            03220099
032300                                        INDEXED BY LQW-IDX.       03230099
032400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03240099
032500         10  LQW-TEMP-SELECTED-SW       PIC X(01).                03250099
032600         10  LQW-SELECTED-SW            PIC X(01).                03260099
032700             88  LQW-SELECT                         VALUE 'S'.    03270099
032800             88  LQW-DESELECT                       VALUE ' '.    03280099
032900         10  LQW-ACTION                 PIC X(3).                 03290099
033000         10  LQW-PACK-ID                PIC 9(3).                 03300099
033100         10  LQW-DETAIL-PACK            PIC 9(5).                 03310099
033200         10  LQW-DETAIL-PACK-N          REDEFINES                 03320099
033300             LQW-DETAIL-PACK            PIC ZZZZ9.                03330099
033400         10  LQW-REC-STATUS             PIC X(2).                 03340099
033500         10  LQW-OTR-PACK               PIC 9(5).                 03350099
033600         10  LQW-OTR-PACK-N             REDEFINES                 03360099
033700             LQW-OTR-PACK               PIC ZZZZ9.                03370099
033800         10  LQW-PKSL-PACK              PIC 9(5).                 03380099
033900         10  LQW-PKSL-PACK-N            REDEFINES                 03390099
034000             LQW-PKSL-PACK              PIC ZZZZ9.                03400099
034100         10  LQW-ODD-UNITS              PIC 9(5).                 03410099
034200         10  LQW-ODD-UNITS-N            REDEFINES                 03420099
034300             LQW-ODD-UNITS              PIC ZZZZ9.                03430099
034400         10  LQW-VERIFY-PACK            PIC 9(5).                 03440099
034500         10  LQW-APRON-DTE              PIC X(8).                 03450099
034600         10  LQW-TROUBLE                PIC X(14).                03460099
034700         10  LQW-PKITEM-CREAT-UID       PIC X(8).                 03470099
034800         10  LQW-PACK-TROUBLE-LONG      PIC X(20).                03480099
034900         10  LQW-PACK-OTR-QTY           PIC S9(09) COMP-3.        03490099
035000         10  LQW-TOT-RATIO-QTY          PIC S9(04) COMP.          03500099
035100         10  LQW-TOT-PO-RATIO-QTY       PIC S9(04) COMP.          03510099
035200         10  LQW-PURITM-GP-QTY          PIC S9(04) COMP.          03520099
035300         10  LQW-LINE-TRBL-SW           PIC X(01).                03530099
035400         10  LQW-LINE-ERROR-SW          PIC X(01).                03540099
035500             88  LQW-LINE-ERROR                       VALUE 'Y'.  03550099
035600             88  LQW-LINE-NOT-IN-ERROR                VALUE 'N'.  03560099
035700                                                                  03570099
035800                                                                  03580099
035900/                                                                 03590099
036000*---------------------------------------------------------------* 03600099
036100*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 03610099
036200*---------------------------------------------------------------* 03620099
036300                                                                  03630099
036400     COPY PCWS017.                                                03640099
036500     COPY PCWS016.                                                03650099
036600                                                                  03660099
036700*---------------------------------------------------------------* 03670099
036800*  RECORD LAYOUT FOR THE PACKSLIP SELECTION TEMP STORAGE QUEUE. * 03680099
036900*---------------------------------------------------------------* 03690099
037000                                                                  03700099
037100     COPY RCWS013.                                                03710099
037200                                                                  03720099
037300                                                                  03730099
037400*---------------------------------------------------------------* 03740099
037500*  TEMP STORAGE FOR TRECITM AUDIT TABLE.                        * 03750099
037600*---------------------------------------------------------------* 03760099
037700                                                                  03770099
037800     COPY RCWS031.                                                03780099
037900/                                                                 03790099
037910***************************************************************** 03791099
037920* COPYBOOK FOR WMS VENDOR SHIPMENT CONTROL MODULE               * 03792099
037930***************************************************************** 03793099
037940     COPY WSWS001.                                                03794099
038000/                                                                 03800099
038100*---------------------------------------------------------------* 03810099
038200*  RECORD LAYOUT FOR THE TROUBLE ROUTINE                          03820099
038300*---------------------------------------------------------------* 03830099
038400                                                                  03840099
038500     COPY TMWS500.                                                03850099
038600                                                                  03860099
038700/                                                                 03870099
038800*---------------------------------------------------------------* 03880099
038900*    MAP LAYOUT                                                 * 03890099
039000*---------------------------------------------------------------* 03900099
039100                                                                  03910099
039200     COPY RCKM800.                                                03920099
039300/                                                                 03930099
039400 01  MR-OCCURS-LAYOUT                   REDEFINES  RC800AO.       03940099
039500     05  FILLER                         PIC X(124).               03950099
039600     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          03960099
039700         10  MR-SELECTL                 PIC S9(04) COMP.          03970099
039800         10  MR-SELECTA                 PIC  X(01).               03980099
039900         10  MR-SELECTC                 PIC  X(01).               03990099
040000         10  MR-SELECTH                 PIC  X(01).               04000099
040100         10  MR-SELECT                  PIC  X(01).               04010099
040200                                                                  04020099
040300         10  MR-PACK-IDL                PIC S9(04) COMP.          04030099
040400         10  MR-PACK-IDA                PIC  X(01).               04040099
040500         10  MR-PACK-IDC                PIC  X(01).               04050099
040600         10  MR-PACK-IDH                PIC  X(01).               04060099
040700         10  MR-PACK-ID.                                          04070099
040800             15 MR-PACK-ID-N            PIC  ZZ9.                 04080099
040900                                                                  04090099
041000         10  MR-DETAIL-PACKL            PIC S9(04) COMP.          04100099
041100         10  MR-DETAIL-PACKA            PIC  X(01).               04110099
041200         10  MR-DETAIL-PACKC            PIC  X(01).               04120099
041300         10  MR-DETAIL-PACKH            PIC  X(01).               04130099
041400         10  MR-DETAIL-PACK.                                      04140099
041500             15  MR-DETAIL-PACK-N       PIC  ZZZZ9.               04150099
041600                                                                  04160099
041700         10  MR-STATUSL                 PIC S9(04) COMP.          04170099
041800         10  MR-STATUSA                 PIC  X(01).               04180099
041900         10  MR-STATUSC                 PIC  X(01).               04190099
042000         10  MR-STATUSH                 PIC  X(01).               04200099
042100         10  MR-STATUS                  PIC  X(02).               04210099
042200                                                                  04220099
042300         10  MR-OTR-PACKL               PIC S9(04) COMP.          04230099
042400         10  MR-OTR-PACKA               PIC  X(01).               04240099
042500         10  MR-OTR-PACKC               PIC  X(01).               04250099
042600         10  MR-OTR-PACKH               PIC  X(01).               04260099
042700         10  MR-OTR-PACK                PIC  X(05).               04270099
042800                                                                  04280099
042900         10  MR-PKSL-PACKL              PIC S9(04) COMP.          04290099
043000         10  MR-PKSL-PACKA              PIC  X(01).               04300099
043100         10  MR-PKSL-PACKC              PIC  X(01).               04310099
043200         10  MR-PKSL-PACKH              PIC  X(01).               04320099
043300         10  MR-PKSL-PACK.                                        04330099
043400             15  MR-PKSL-PACK-N         PIC  ZZZZ9.               04340099
043500                                                                  04350099
043600         10  MR-ODD-UNITSL              PIC S9(04) COMP.          04360099
043700         10  MR-ODD-UNITSA              PIC  X(01).               04370099
043800         10  MR-ODD-UNITSC              PIC  X(01).               04380099
043900         10  MR-ODD-UNITSH              PIC  X(01).               04390099
044000         10  MR-ODD-UNITS.                                        04400099
044100             15  MR-ODD-UNITS-N         PIC  ZZZZ9.               04410099
044200                                                                  04420099
044300         10  MR-VERIFY-PACKL            PIC S9(04) COMP.          04430099
044400         10  MR-VERIFY-PACKA            PIC  X(01).               04440099
044500         10  MR-VERIFY-PACKC            PIC  X(01).               04450099
044600         10  MR-VERIFY-PACKH            PIC  X(01).               04460099
044700         10  MR-VERIFY-PACK.                                      04470099
044800             15  MR-VERIFY-PACK-N       PIC  ZZZZ9.               04480099
044900                                                                  04490099
045000         10  MR-APRON-DATEL             PIC S9(04) COMP.          04500099
045100         10  MR-APRON-DATEA             PIC  X(01).               04510099
045200         10  MR-APRON-DATEC             PIC  X(01).               04520099
045300         10  MR-APRON-DATE-H            PIC  X(01).               04530099
045400         10  MR-APRON-DATE              PIC  X(05).               04540099
045500                                                                  04550099
045600         10  MR-TROUBLEL                PIC S9(04) COMP.          04560099
045700         10  MR-TROUBLEA                PIC  X(01).               04570099
045800         10  MR-TROUBLEC                PIC  X(01).               04580099
045900         10  MR-TROUBLE-H               PIC  X(01).               04590099
046000         10  MR-TROUBLE                 PIC  X(13).               04600099
046100                                                                  04610099
046200         10  MR-PKITEM-CRE-UIDL         PIC S9(04) COMP.          04620099
046300         10  MR-PKITEM-CRE-UIDA         PIC  X(01).               04630099
046400         10  MR-PKITEM-CRE-UIDC         PIC  X(01).               04640099
046500         10  MR-PKITEM-CRE-UIDH         PIC  X(01).               04650099
046600         10  MR-PKITEM-CRE-UID          PIC  X(08).               04660099
046700                                                                  04670099
046710     05  FILLER                         PIC  X(12).               04671099
046800     EJECT                                                        04680099
046900*---------------------------------------------------------------* 04690099
047000*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04700099
047100*---------------------------------------------------------------* 04710099
047200                                                                  04720099
047300     COPY DPWS015.                                                04730099
047400                                                                  04740099
047500*---------------------------------------------------------------* 04750099
047600*    FUNCTION KEYS COPYBOOK.                                    * 04760099
047700*---------------------------------------------------------------* 04770099
047800     COPY DPWS016.                                                04780099
047900                                                                  04790099
048000*---------------------------------------------------------------* 04800099
048100*    NUMERIC EDIT LAYOUT.                                       * 04810099
048200*---------------------------------------------------------------* 04820099
048300     COPY DPWS010I.                                               04830099
048400/                                                                 04840099
048500******************************************************************04850099
048600** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **04860099
048610** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **04861099
048700******************************************************************04870099
048800                                                                  04880099
048900     COPY DPWS030.                                                04890099
048910     COPY DPWS930.                                                04891099
049000                                                                  04900099
049100/                                                                 04910099
049200*---------------------------------------------------------------* 04920099
049300*    STANDARD COMMAREA.                                         * 04930099
049400*---------------------------------------------------------------* 04940099
049500                                                                  04950099
049600     COPY DPWS020.                                                04960099
049700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04970099
049800                                                                  04980099
049900*---------------------------------------------------------------* 04990099
050000* INTER-APPLICATION COMMAREA.                                   * 05000099
050100* RCWS012 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP UPDT  * 05010099
050200* RCWS015 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP LIST  * 05020099
050300*---------------------------------------------------------------* 05030099
050400                                                                  05040099
050500         10  INTER-APPL-COMM-AREA       PIC X(200).               05050099
050600     COPY PCWS000.                                                05060099
050700     COPY POWS017.                                                05070099
050800     COPY RCWS012.                                                05080099
050900     COPY RCWS015.                                                05090099
051000     COPY RCWS800.                                                05100099
051100                                                                  05110099
051200*---------------------------------------------------------------* 05120099
051300*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05130099
051400*---------------------------------------------------------------* 05140099
051500         10  ASC-SPECIFIC-COMMAREA.                               05150099
051600             15  ASC-LIST-KEYS.                                   05160099
051700                 20  ASC-PO-NBR             PIC 9(08).            05170099
051800                 20  ASC-REC-SEQ-NBR        PIC 9(03).            05180099
051900                 20  ASC-STAT               PIC X(02).            05190099
052000                 20  ASC-OPR-ID             PIC ZZZ9.             05200099
052100                 20  ASC-FACT               PIC ZZZ9.             05210099
052200             15  ASC-OTHER-TOP-OF-SCREEN-DATA.                    05220099
052300                 20  ASC-TROUB-STATUS                 PIC X(11).  05230099
052400                 20  ASC-TRECEIV-EXPTD-CART-QTY       PIC 9(5).   05240099
052500                 20  ASC-TRECEIV-ACTL-CART-QTY        PIC 9(5).   05250099
052600                 20  ASC-PACKAGE-TYPE-CDE             PIC X(1).   05260099
052700                 20  ASC-PREPACK-DESC                 PIC X(36).  05270099
052800                 20  ASC-PURITM-VEND-STYL-NAME        PIC X(08).  05280099
052900                 20  ASC-INNER-PACK-QTY               PIC 9(03).  05290099
053000             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           05300099
053100                 20  ASC-BLOCK-MODIFIED-SW                        05310099
053200                                        PIC X(01).                05320099
053300                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     05330099
053400                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     05340099
053500                                                                  05350099
053600                 20  ASC-ITEM-ARRAY.                              05360099
053700                     25  ASC-ITEM-ENTRIES OCCURS 9 TIMES.         05370099
053800                         30  ASC-LIST-ITEM-NUMBER                 05380099
053900                                        PIC S9(09) COMP-3.        05390099
054000                         30  ASC-TEMP-SELECTED-SW                 05400099
054100                                        PIC X(01).                05410099
054200                             88  ASC-VALID-SELECT  VALUE ' '      05420099
054300                                                         'S'      05430099
054400                                                         'B'      05440099
054500                                                         'E'.     05450099
054600                             88  ASC-TEMP-NO-SELECT               05460099
054700                                                   VALUE ' '.     05470099
054800                             88  ASC-TEMP-SELECT   VALUE 'S'.     05480099
054900                             88  ASC-TEMP-BEGIN    VALUE 'B'.     05490099
055000                             88  ASC-TEMP-END      VALUE 'E'.     05500099
055100                         30  ASC-SELECTED-SW                      05510099
055200                                        PIC X(01).                05520099
055300                             88  ASC-NO-SELECT     VALUE ' '.     05530099
055400                             88  ASC-SELECT        VALUE 'S'.     05540099
055500                             88  ASC-BEGIN         VALUE 'B'.     05550099
055600                             88  ASC-END           VALUE 'E'.     05560099
055700                         30  ASC-ACTION            PIC X(3).      05570099
055800                         30  ASC-PACK-ID           PIC 9(03).     05580099
055900                         30  ASC-DETAIL-PACK       PIC ZZZZ9.     05590099
056000                         30  ASC-REC-STATUS        PIC X(02).     05600099
056100                         30  ASC-OTR-PACK          PIC ZZZZ9.     05610099
056200                         30  ASC-PKSL-PACK         PIC ZZZZ9.     05620099
056300                         30  ASC-ODD-UNITS         PIC ZZZZ9.     05630099
056400                         30  ASC-VERIFY-PACK       PIC ZZZZ9.     05640099
056500                         30  ASC-APRON-DTE         PIC X(8).      05650099
056600                         30  ASC-PACK-TROUBLE-SHORT               05660099
056700                                                   PIC X(14).     05670099
056800                         30  ASC-PKITEM-CRE-UID    PIC X(8).      05680099
056900                         30  ASC-FIELDS-TO-BE-PASSED.             05690099
057000                             35  ASC-PACK-TROUBLE-LONG            05700099
057100                                                   PIC X(20).     05710099
057200                             35  ASC-PACK-OTR-QTY  PIC S9(09)     05720099
057300                                                       COMP-3.    05730099
057400                             35  ASC-TOT-RATIO-QTY PIC S9(04)     05740099
057500                                                     COMP.        05750099
057600                             35  ASC-TOT-PO-RATIO-QTY             05760099
057700                                                   PIC S9(04)     05770099
057800                                                     COMP.        05780099
057900                             35  ASC-PURITM-GP-QTY PIC S9(04)     05790099
058000                                                       COMP.      05800099
058100                         30  ASC-LINE-TRBL-SW                     05810099
058200                                        PIC X(01).                05820099
058300                             88  ASC-LINE-IN-TROUBLE  VALUE 'Y'.  05830099
058400                             88  ASC-LINE-DISTRO-TRBL VALUE 'D'.  05840099
058500                             88  ASC-LINE-PACK-TRBL   VALUE 'P'.  05850099
058600                             88  ASC-NO-LINE-TRBL     VALUE ' '.  05860099
058700                         30  ASC-LINE-ERROR-SW                    05870099
058800                                        PIC X(01).                05880099
058900                             88  ASC-LINE-ERROR       VALUE 'Y'.  05890099
059000                             88  ASC-LINE-NOT-IN-ERROR            05900099
059100                                                      VALUE 'N'.  05910099
059200                                                                  05920099
059300                                                                  05930099
059400             15  ASC-CASEPACK-SPLIT-SW  PIC X(01).                05940099
059500                 88  ASC-CASEPACK-SPLIT-YES           VALUE 'Y'.  05950099
059600                 88  ASC-CASEPACK-SPLIT-NO            VALUE 'N'.  05960099
059610             15  ASC-CARTONS-SW             PIC X(01).            05961099
059620                 88  ASC-CARTONS-FOUND                 VALUE 'Y'. 05962099
059630                 88  ASC-CARTONS-NOT-FOUND             VALUE 'N'. 05963099
059700             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     05970099
059800             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     05980099
059900             15  ASC-SEL-SUB            PIC S9(04) COMP.          05990099
060000             15  ASC-SEL-ITEM           PIC S9(04) COMP.          06000099
060100             15  ASC-NUMBER-OF-ITEMS-READ                         06010099
060200                                        PIC S9(09) COMP-3.        06020099
060300             15  ASC-NUMBER-OF-SELECTED-ITEMS                     06030099
060400                                        PIC S9(09) COMP-3.        06040099
060500             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        06050099
060600             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        06060099
060700             15  ASC-ITEM-AT-TOP-OF-PANEL                         06070099
060800                                        PIC S9(09) COMP-3.        06080099
060900             15  ASC-ITEM-AT-BOT-OF-PANEL                         06090099
061000                                        PIC S9(09) COMP-3.        06100099
061100             15  ASC-HIGHEST-BLOCK-WRITTEN                        06110099
061200                                        PIC S9(04) COMP SYNC.     06120099
061300             15  ASC-START-OF-SELECTED-RANGE                      06130099
061400                                        PIC S9(09) COMP-3.        06140099
061500             15  ASC-END-OF-SELECTED-RANGE                        06150099
061600                                        PIC S9(09) COMP-3.        06160099
061700             15  ASC-ITEMS-LEFT-INDICATOR                         06170099
061800                                        PIC X(01).                06180099
061900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06190099
062000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06200099
062100             15  ASC-TEMP-QUEUE-UPDATE-SW                         06210099
062200                                        PIC X(01).                06220099
062300                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     06230099
062400                 88  ASC-UPDATE-TSQ2               VALUE '2'.     06240099
062500                 88  ASC-UPDATE-TSQ3               VALUE '3'.     06250099
062600                 88  ASC-UPDATE-TSQ4               VALUE '4'.     06260099
062700                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     06270099
062800             15  ASC-LIST-QUEUE-NAME.                             06280099
062900                 20  ASC-LIST-TERM-ID   PIC X(04).                06290099
063000                 20  ASC-LIST-TASK-NUMBER                         06300099
063100                                        PIC S9(05) COMP-3.        06310099
063200                 20  ASC-LIST-SEQ       PIC 9(01).                06320099
063300             15  ASC-SEL-QUEUE-NAME-IN   PIC X(08).               06330099
063400             15  ASC-SEL-QUEUE-NAME-OUT.                          06340099
063500                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               06350099
063600                 20  ASC-SEL-TASK-NUMBER-OUT                      06360099
063700                                         PIC S9(05) COMP-3.       06370099
063800                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               06380099
063900                                                                  06390099
064000             15  ASC-START-ITEM-REQUEST.                          06400099
064100                 20  ASC-START-ITEM-REQUEST-N  PIC 9(07).         06410099
064200             15  ASC-USE-SELECTION-QUEUE-IND   PIC X(01).         06420099
064300                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         06430099
064400             15  ASC-HOLD-INTER-APPL           PIC X(200).        06440099
064500             15  ASC-INTER-APPL-CODE-IND       PIC X(01).         06450099
064600                 88 ASC-INTER-APPL-PKSL-LIST   VALUE 'P'.         06460099
064700             15  ASC-FUNCTION-SELECT-SW        PIC X(01).         06470099
064800                 88 ASC-REDISTRO-FUNCTION      VALUE 'R'.         06480099
064900                 88 ASC-NOT-REDISTRO-FUNCTION  VALUE ' '.         06490099
065000             15  ASC-EDIT-ERROR-SW             PIC X(01).         06500099
065100                 88 ASC-EDIT-ERROR             VALUE 'Y'.         06510099
065200                 88 ASC-NO-EDIT-ERROR          VALUE 'N'.         06520099
065300             15  ASC-DELETE-PENDING-SW         PIC X(01).         06530099
065400                 88 ASC-DELETE-PENDING         VALUE 'Y'.         06540099
065500                 88 ASC-DELETE-NOT-PENDING     VALUE 'N'.         06550099
065600             15  ASC-REDISTRO-SW               PIC X(01).         06560099
065700                 88  ASC-REDISTRO-OK           VALUE 'Y'.         06570099
065800                 88  ASC-REDISTRO-NOT-OK       VALUE 'N'.         06580099
065900             15  ASC-NINETY-NINE-CK-SW         PIC X(01).         06590099
066000                 88  ASC-NINETY-NINE-CK        VALUE 'Y'.         06600099
066100                 88  ASC-PO-PACK-MADE          VALUE 'N'.         06610099
066200                                                                  06620099
066300                                                                  06630099
066400/                                                                 06640099
066500*---------------------------------------------------------------* 06650099
066600* RCWS801 - TEMP STORAGE AREA FOR PACK AND RECEIVER             * 06660099
066700*---------------------------------------------------------------* 06670099
066800     COPY RCWS801.                                                06680099
066900                                                                  06690099
067000*---------------------------------------------------------------* 06700099
067100*    ABEND PROCESSING COPYBOOK.                                 * 06710099
067200*---------------------------------------------------------------* 06720099
067300                                                                  06730099
067400     COPY DPWS013.                                                06740099
067500/                                                                 06750099
067600*---------------------------------------------------------------* 06760099
067700*    OPEN TO RECEIVE COPYBOOK.                                  * 06770099
067800*---------------------------------------------------------------* 06780099
067900                                                                  06790099
068000     COPY PCWS020.                                                06800099
068001                                                                  06800199
068010******************************************************************06801099
068020*    CARTON MASTER      SUT_OTBND_CART                            06802099
068030******************************************************************06803099
068040     EXEC SQL                                                     06804099
068050         INCLUDE SUT00024                                         06805099
068060     END-EXEC.                                                    06806099
068070/                                                                 06807099
068080******************************************************************06808099
068090*    CARTON UPC        SUT_OTBND_UPC                              06809099
068091******************************************************************06809199
068092     EXEC SQL                                                     06809299
068093         INCLUDE SUT00028                                         06809399
068094     END-EXEC.                                                    06809499
068095/                                                                 06809599
068100/                                                                 06810099
068200*---------------------------------------------------------------* 06820099
068300*    DB2 AREA FOR THE RECEIVER                                  * 06830099
068400*---------------------------------------------------------------* 06840099
068500     EXEC SQL                                                     06850099
068600          INCLUDE TRECEIV                                         06860099
068700     END-EXEC.                                                    06870099
068800                                                                  06880099
068900/                                                                 06890099
069000*---------------------------------------------------------------* 06900099
069100*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 06910099
069200*---------------------------------------------------------------* 06920099
069300     EXEC SQL                                                     06930099
069400          INCLUDE TPURCHS                                         06940099
069500     END-EXEC.                                                    06950099
069510/                                                                 06951099
069520*---------------------------------------------------------------* 06952099
069530*    DB2 AREA                                                     06953099
069540*---------------------------------------------------------------* 06954099
069550     EXEC SQL                                                     06955099
069560          INCLUDE TKRPRPM                                         06956099
069570     END-EXEC.                                                    06957099
069580/                                                                 06958099
069590*---------------------------------------------------------------* 06959099
069591*    DB2 AREA                                                     06959199
069592*---------------------------------------------------------------* 06959299
069593     EXEC SQL                                                     06959399
069594          INCLUDE TSHPTPO                                         06959499
069595     END-EXEC.                                                    06959599
069596/                                                                 06959699
069597*---------------------------------------------------------------* 06959799
069598*    DB2 AREA                                                     06959899
069599*---------------------------------------------------------------* 06959999
069600     EXEC SQL                                                     06960099
069601          INCLUDE TSHIPMT                                         06960199
069602     END-EXEC.                                                    06960299
069610                                                                  06961099
069700/                                                                 06970099
069800*---------------------------------------------------------------* 06980099
069900*    DB2 AREA FOR THE PURCHASE ORDER ITEM TABLE                 * 06990099
070000*---------------------------------------------------------------* 07000099
070100*    EXEC SQL                                                     07010099
070200*         INCLUDE TPURITM                                         07020099
070300*    END-EXEC.                                                    07030099
070400                                                                  07040099
070500/                                                                 07050099
070600*---------------------------------------------------------------* 07060099
070700*    DB2 AREA FOR THE PURCHASE ORDER PREPACK TABLE              * 07070099
070800*---------------------------------------------------------------* 07080099
070900     EXEC SQL                                                     07090099
071000          INCLUDE TPOPRPK                                         07100099
071100     END-EXEC.                                                    07110099
071200                                                                  07120099
071300/                                                                 07130099
071400*---------------------------------------------------------------* 07140099
071500*    DB2 AREA FOR THE RECEIPT ITEM TABLE                        * 07150099
071600*---------------------------------------------------------------* 07160099
071700*    EXEC SQL                                                     07170099
071800*         INCLUDE TRECITM                                         07180099
071900*    END-EXEC.                                                    07190099
072000                                                                  07200099
072100/                                                                 07210099
072200*---------------------------------------------------------------* 07220099
072300*    DB2 AREA FOR THE TRECDIS TABLE                             * 07230099
072400*---------------------------------------------------------------* 07240099
072500*    EXEC SQL                                                     07250099
072600*         INCLUDE TRECDIS                                         07260099
072700*    END-EXEC.                                                    07270099
072800                                                                  07280099
072900/                                                                 07290099
073000*----------------------------------------------------------------*07300099
073100*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                07310099
073200*----------------------------------------------------------------*07320099
073300     EXEC SQL                                                     07330099
073400          INCLUDE TTRBNTF                                         07340099
073500     END-EXEC.                                                    07350099
073600                                                                  07360099
073700/                                                                 07370099
073800*----------------------------------------------------------------*07380099
073900*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      07390099
074000*----------------------------------------------------------------*07400099
074100     EXEC SQL                                                     07410099
074200          INCLUDE TTRBRSN                                         07420099
074300     END-EXEC.                                                    07430099
074400                                                                  07440099
074500/                                                                 07450099
074600*---------------------------------------------------------------* 07460099
074700*    DB2 AREA FOR THE PACKSLIP TABLE                            * 07470099
074800*---------------------------------------------------------------* 07480099
074900     EXEC SQL                                                     07490099
075000          INCLUDE TPKSLIP                                         07500099
075100     END-EXEC.                                                    07510099
075200                                                                  07520099
075300/                                                                 07530099
075400*---------------------------------------------------------------* 07540099
075500*    DB2 AREA FOR THE PACKITEM TABLE                            * 07550099
075600*---------------------------------------------------------------* 07560099
075700     EXEC SQL                                                     07570099
075800          INCLUDE TPKITEM                                         07580099
075900     END-EXEC.                                                    07590099
076000                                                                  07600099
076100                                                                  07610099
076200*---------------------------------------------------------------* 07620099
076300*    DC-DISTRIBUTION TRANSACTION HEADER                         * 07630099
076400*---------------------------------------------------------------* 07640099
076500     EXEC SQL                                                     07650099
076600          INCLUDE TDISTHD                                         07660099
076700     END-EXEC.                                                    07670099
076800                                                                  07680099
076900/                                                                 07690099
077000*---------------------------------------------------------------* 07700099
077100*    DB2 AREA FOR THE TWRKORD                                   * 07710099
077200*---------------------------------------------------------------* 07720099
077300     EXEC SQL                                                     07730099
077400          INCLUDE TWRKORD                                         07740099
077500     END-EXEC.                                                    07750099
077600                                                                  07760099
077700/                                                                 07770099
077800/                                                                 07780099
077900*---------------------------------------------------------------* 07790099
078000*    DB2 AREA FOR THE TWKORIN                                   * 07800099
078100*---------------------------------------------------------------* 07810099
078200     EXEC SQL                                                     07820099
078300          INCLUDE TWKORIN                                         07830099
078400     END-EXEC.                                                    07840099
078500                                                                  07850099
078600/                                                                 07860099
079500*---------------------------------------------------------------* 07950099
079600*    DB2 AREA FOR THE ODD UNIT TABLE                            * 07960099
079700*---------------------------------------------------------------* 07970099
079800     EXEC SQL                                                     07980099
079900          INCLUDE RCT00009                                        07990099
080000     END-EXEC.                                                    08000099
080100                                                                  08010099
080200/                                                                 08020099
080210*---------------------------------------------------------------* 08021099
080220*    DB2 AREA FOR THE SHIPMT XREF                               * 08022099
080230*---------------------------------------------------------------* 08023099
080240     EXEC SQL                                                     08024099
080250          INCLUDE WST00001                                        08025099
080260     END-EXEC.                                                    08026099
080270                                                                  08027099
080280/                                                                 08028099
080300*---------------------------------------------------------------* 08030099
080400*    DB2 AREA FOR COMMUNICATIONS                                * 08040099
080500*---------------------------------------------------------------* 08050099
080600     EXEC SQL                                                     08060099
080700          INCLUDE SQLCA                                           08070099
080800     END-EXEC.                                                    08080099
080900                                                                  08090099
081000/                                                                 08100099
081100*---------------------------------------------------------------* 08110099
081200*  CURSOR TO LIST TPURITM                                       * 08120099
081300*---------------------------------------------------------------* 08130099
081400                                                                  08140099
081500     EXEC SQL                                                     08150099
081600          DECLARE TPURITM-CSR CURSOR FOR                          08160099
081700           SELECT DISTINCT                                        08170099
081800                  A.PO_NBR                                        08180099
081900                , A.VER_NBR                                       08190099
082000                , A.ITM_NBR                                       08200099
082100                , A.APP_PO_LNE_NBR                                08210099
082200                , A.VEND_STYL_NAME                                08220099
082300                , A.UNT_QTY                                       08230099
082400                , A.UNT_RTL_PR_AMT                                08240099
082500                , A.GP_RTL_AMT                                    08250099
082600                , A.GP_QTY                                        08260099
082700                , A.PO_LNE_NBR                                    08270099
082800                , D.PREPK_ID                                      08280099
082900                , B.PREPK_DESC                                    08290099
083000                , D.ORD_LNE_NBR                                   08300099
083100                , D.CASE_PACK_QTY                                 08310099
083200                , D.STATUS_CDE                                    08320099
083300                , D.PREPK_ODD_UNT_QTY                             08330099
083400                , D.PREPK_DRV_LNE_CDE                             08340099
083500           FROM   TPURITM A                                       08350099
083600                , TPOPRPK B                                       08360099
083700                , TRECEIV C                                       08370099
083800                , TRECITM D                                       08380099
083900           WHERE  A.PO_NBR          = :DK-ORD-NBR                 08390099
084000             AND  A.VER_STATUS_CDE  = 'A'                         08400099
084100             AND  C.ORD_NBR         = A.PO_NBR                    08410099
084200             AND  C.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR            08420099
084300             AND  C.VER_STATUS_CDE  = 'A'                         08430099
084400             AND  C.OPER_UNT_ID     = :DK-OPR-ID                  08440099
084500             AND  C.FCLTY_ID        = :DK-FACT                    08450099
084600             AND  D.ORD_NBR         = C.ORD_NBR                   08460099
084700             AND  D.REC_SEQ_NBR     = C.REC_SEQ_NBR               08470099
084800             AND  D.ORD_LNE_NBR     = A.APP_PO_LNE_NBR            08480099
084900             AND  B.PO_PREPK_ID   NOT IN (99)                     08490099
085000             AND  B.PO_PREPK_ID    = A.PO_PREPK_ID                08500099
085100                AND  D.PREPK_ID       = A.PO_PREPK_ID             08510099
085200                AND  B.PO_NBR         = A.PO_NBR                  08520099
085300             AND  D.VER_STATUS_CDE  = 'A'                         08530099
085400             AND  D.OPER_UNT_ID     = C.OPER_UNT_ID               08540099
085500             AND  D.FCLTY_ID        = C.FCLTY_ID                  08550099
085600         ORDER BY D.PREPK_ID                                      08560099
085700     END-EXEC.                                                    08570099
085800                                                                  08580099
085900     EXEC SQL                                                     08590099
086000          DECLARE PK-NINETY-NINE-CSR CURSOR FOR                   08600099
086100           SELECT DISTINCT                                        08610099
086200                  A.PO_NBR                                        08620099
086300                , A.VER_NBR                                       08630099
086400                , A.ITM_NBR                                       08640099
086500                , A.APP_PO_LNE_NBR                                08650099
086600                , A.VEND_STYL_NAME                                08660099
086700                , A.UNT_QTY                                       08670099
086800                , A.UNT_RTL_PR_AMT                                08680099
086900                , A.GP_RTL_AMT                                    08690099
087000                , A.GP_QTY                                        08700099
087100                , A.PO_LNE_NBR                                    08710099
087200                , D.PREPK_ID                                      08720099
087300                , D.ORD_LNE_NBR                                   08730099
087400                , D.CASE_PACK_QTY                                 08740099
087500                , D.STATUS_CDE                                    08750099
087600                , D.PREPK_ODD_UNT_QTY                             08760099
087700                , D.PREPK_DRV_LNE_CDE                             08770099
087800            FROM  TRECEIV C                                       08780099
087900                , TRECITM D                                       08790099
088000                , TPURITM A                                       08800099
088100           WHERE  C.ORD_NBR         = :DK-ORD-NBR                 08810099
088200             AND  C.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR            08820099
088300             AND  C.VER_STATUS_CDE  = 'A'                         08830099
088400             AND  C.OPER_UNT_ID     = :DK-OPR-ID                  08840099
088500             AND  C.FCLTY_ID        = :DK-FACT                    08850099
088600             AND  C.VER_STATUS_CDE  = 'A'                         08860099
088700             AND  A.PO_NBR          = C.ORD_NBR                   08870099
088800             AND  A.VER_STATUS_CDE  = 'A'                         08880099
088900             AND  D.ORD_NBR         = C.ORD_NBR                   08890099
089000             AND  D.REC_SEQ_NBR     = C.REC_SEQ_NBR               08900099
089100             AND  D.ORD_LNE_NBR     = A.APP_PO_LNE_NBR            08910099
089200             AND  D.PREPK_ID       = 99                           08920099
089300             AND  D.VER_STATUS_CDE  = 'A'                         08930099
089400             AND  D.OPER_UNT_ID     = C.OPER_UNT_ID               08940099
089500             AND  D.FCLTY_ID        = C.FCLTY_ID                  08950099
089600         ORDER BY D.PREPK_ID                                      08960099
089700     END-EXEC.                                                    08970099
089800                                                                  08980099
089900                                                                  08990099
090000     EXEC SQL                                                     09000099
090100          DECLARE PACK-LINE-CSR CURSOR FOR                        09010099
090200           SELECT A.PO_NBR                                        09020099
090300                , A.APP_PO_LNE_NBR                                09030099
090400                , A.PO_LNE_NBR                                    09040099
090500                , A.PREPK_RATO_QTY                                09050099
090600                , B.ORD_LNE_NBR                                   09060099
090700                , B.DTL_CK_ITM_QTY                                09070099
090800                , B.PKSL_ITM_QTY                                  09080099
090900                , B.PREPK_RATO_QTY                                09090099
091000                , CURRENT TIMESTAMP                               09100099
091100           FROM   TPURITM A                                       09110099
091200                , TRECITM B                                       09120099
091300         WHERE    A.PO_NBR         = :DK-ORD-NBR                  09130099
091400             AND  A.VER_STATUS_CDE = 'A'                          09140099
091500             AND  B.ORD_NBR        = A.PO_NBR                     09150099
091600             AND  B.ORD_LNE_NBR    = A.APP_PO_LNE_NBR             09160099
091700             AND  B.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             09170099
091800             AND  B.PREPK_ID       = :DK-PACK-ID                  09180099
091900             AND (B.PREPK_RATO_QTY > 0  OR                        09190099
092000                 (B.PREPK_RATO_QTY = 0  AND                       09200099
092100                  B.DTL_CK_ITM_QTY > 0) OR                        09210099
092200                  B.PREPK_ID       = 99)                          09220099
092300             AND  B.VER_STATUS_CDE = 'A'                          09230099
092400             AND  B.OPER_UNT_ID    = :DK-OPR-ID                   09240099
092500             AND  B.FCLTY_ID       = :DK-FACT                     09250099
092600         ORDER BY APP_PO_LNE_NBR                                  09260099
092700     END-EXEC.                                                    09270099
092800                                                                  09280099
092900     COPY DPWS277.                                                09290099
093000/                                                                 09300099
093100/                                                                 09310099
093200 LINKAGE SECTION.                                                 09320099
093300                                                                  09330099
093400 01  DFHCOMMAREA.                                                 09340099
093500     05  FILLER                         OCCURS  1 TO 4072 TIMES   09350099
093600                                        DEPENDING ON EIBCALEN.    09360099
093700         10  FILLER                     PIC X.                    09370099
093800                                                                  09380099
093900/                                                                 09390099
094000 PROCEDURE DIVISION.                                              09400099
094100*---------------------------------------------------------------* 09410099
094200*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 09420099
094300*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 09430099
094400*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 09440099
094500*---------------------------------------------------------------* 09450099
094600 0000-MAIN-MODULE.                                                09460099
094700                                                                  09470099
094800     INITIALIZE DP030-CICS-API-FIELDS.                            09480099
094900                                                                  09490099
095000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09500099
095100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09510099
095200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09520099
095300                                                                  09530099
095400     SET DP030-RECEIVE-APPL-MAP                                   09540099
095500         DP030-OVERRIDE-APPL-ERROR TO TRUE.                       09550099
095600                                                                  09560099
095700     MOVE LENGTH OF RC800AI        TO DP030-MAP-LENGTH (1).       09570099
095800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09580099
095900                                                                  09590099
096000     PERFORM 0001-CALL-CICS-ARCH-API.                             09600099
096100     PERFORM 1000-CONTROL-PROCESSING                              09610099
096200                                                                  09620099
096300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09630099
096400     PERFORM 0001-CALL-CICS-ARCH-API.                             09640099
096500                                                                  09650099
096600                                                                  09660099
096700*---------------------------------------------------------------* 09670099
096800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 09680099
096900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 09690099
097000*---------------------------------------------------------------* 09700099
097100 0001-CALL-CICS-ARCH-API.                                         09710099
097210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09721099
097300                                    DFHCOMMAREA                   09730099
097400                                    DP030-CICS-API-FIELDS         09740099
097500                                    DP020-STANDARD-COMMAREA       09750099
097600                                    RC800AI.                      09760099
097700                                                                  09770099
097800     IF  DP030-RC-CALL-SUCCESSFUL OR                              09780099
097900         DP030-RC-APPL-ERROR                                      09790099
098000         CONTINUE                                                 09800099
098100     ELSE                                                         09810099
098200         SET DP013-NO-ROLLBACK                                    09820099
098300             DP013-XCTL-DISPLAY-RESTART                           09830099
098400             DP013-CICS-ABEND      TO TRUE                        09840099
098500         MOVE '0001-CALL-CICS-ARCH-API'                           09850099
098600                                   TO DP013-PARAGRAPH             09860099
098620         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O09862099
098630-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09863099
098900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      09890099
099000         PERFORM DP013-0000-PROCESS-ABEND                         09900099
099100     END-IF.                                                      09910099
099200                                                                  09920099
099300*----------------------------------------------------------------*09930099
099400* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09940099
099500* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09950099
099600*                                                                *09960099
099700* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09970099
099800*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09980099
099900*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09990099
100000*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10000099
100100*----------------------------------------------------------------*10010099
100200                                                                  10020099
100300 1000-CONTROL-PROCESSING.                                         10030099
100400                                                                  10040099
100500     EVALUATE TRUE                                                10050099
100600         WHEN DP020-NEXT-ACT-INITIAL                              10060099
100700             INITIALIZE ASC-SPECIFIC-COMMAREA                     10070099
100800             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10080099
100900                                      ASC-SEL-TERM-ID-OUT         10090099
101000             MOVE DP020-SRC-TASK-NUMBER                           10100099
101100                                   TO ASC-LIST-TASK-NUMBER        10110099
101200                                      ASC-SEL-TASK-NUMBER-OUT     10120099
101300             MOVE PC-LIST-QUEUE-SEQ                               10130099
101400                                   TO ASC-LIST-SEQ                10140099
101500             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             10150099
101600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10160099
101700             IF  PS-COMMAREA-NOT-VALID OR                         10170099
101800                 PS-ERROR                                         10180099
101900                 SET DP020-MSG-FATAL                              10190099
102000                     DP020-NEXT-ACT-APPL-ERROR TO TRUE            10200099
102100             ELSE                                                 10210099
102200                 MOVE INTER-APPL-COMM-AREA                        10220099
102300                                   TO ASC-HOLD-INTER-APPL         10230099
102400                 PERFORM 4000-BUILD-INITIAL-PANEL                 10240099
102500             END-IF                                               10250099
102600                                                                  10260099
102700         WHEN DP020-NEXT-ACT-READ-MAP                             10270099
102800             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10280099
102900                                   TO PV-TOP-ITEM                 10290099
103000             PERFORM 2000-PROCESS-PANEL                           10300099
103100                                                                  10310099
103200         WHEN DP020-NEXT-ACT-RETURN                               10320099
103300              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10330099
103400                                   TO PV-TOP-ITEM                 10340099
103500              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    10350099
103600              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                10360099
103700              PERFORM 4100-PREPARE-CURSOR                         10370099
103800              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  10380099
103900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10390099
104000                                                                  10400099
104100         WHEN OTHER                                               10410099
104200             SET DP013-LOGIC-ABEND TO TRUE                        10420099
104300             SET DP013-NO-ROLLBACK TO TRUE                        10430099
104400             MOVE '1000-CONTROL-PROCESSING'                       10440099
104500                                   TO DP013-PARAGRAPH             10450099
104600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10460099
104700                                   TO DP013-MESSAGE-TEXT(1)       10470099
104800             PERFORM DP013-0000-PROCESS-ABEND                     10480099
104900     END-EVALUATE.                                                10490099
105000                                                                  10500099
105100/                                                                 10510099
105200*----------------------------------------------------------------*10520099
105300* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *10530099
105400*----------------------------------------------------------------*10540099
105500                                                                  10550099
105600 1100-PROCESS-INTER-APPL-COMM.                                    10560099
105700                                                                  10570099
105800     SET PS-COMMAREA-VALID          TO TRUE.                      10580099
105900     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    10590099
106000     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND.   10600099
106100                                                                  10610099
106200     EVALUATE DP020-INT-APPL-FORMAT-IND                           10620099
106300                                                                  10630099
106400         WHEN PC-INTER-APPL-CRIT-SPEC                             10640099
106500             IF  RC012-PO-NBR        = ZEROES                     10650099
106600                 MOVE PC-TSYMSG-00736  TO DP020-MSG-NUMBER        10660099
106700                 SET PS-ERROR                                     10670099
106800                     PS-COMMAREA-NOT-VALID                        10680099
106900                     DP020-NEXT-ACT-APPL-ERROR                    10690099
107000                     DP020-MSG-FATAL   TO TRUE                    10700099
107100             END-IF                                               10710099
107200             IF  RC012-REC-SEQ-NBR = ZEROES                       10720099
107300                 MOVE PC-TSYMSG-00737  TO DP020-MSG-NUMBER        10730099
107400                 SET PS-ERROR                                     10740099
107500                     PS-COMMAREA-NOT-VALID                        10750099
107600                     DP020-NEXT-ACT-APPL-ERROR                    10760099
107700                     DP020-MSG-FATAL   TO TRUE                    10770099
107800             END-IF                                               10780099
107900             IF  RC012-OPER-UNT-ID = ZEROES                       10790099
108000             AND RC012-FCLTY-ID    = ZEROES                       10800099
108100                 MOVE PC-TSYMSG-00815                             10810099
108200                                         TO DP020-MSG-NUMBER      10820099
108300                 SET PS-ERROR                                     10830099
108400                     DP020-MSG-FATAL                              10840099
108500                     PS-COMMAREA-NOT-VALID                        10850099
108600                     DP020-NEXT-ACT-APPL-ERROR                    10860099
108700                                         TO TRUE                  10870099
108800             END-IF                                               10880099
108900             IF  PS-NO-ERROR                                      10890099
109000                 MOVE RC012-PO-NBR       TO  ASC-PO-NBR           10900099
109100                                             DK-ORD-NBR           10910099
109200                 MOVE RC012-REC-SEQ-NBR  TO  ASC-REC-SEQ-NBR      10920099
109300                                             DK-RCVR-SEQ-NBR      10930099
109400                 MOVE RC012-OPER-UNT-ID  TO  ASC-OPR-ID           10940099
109500                                             DK-OPR-ID            10950099
109600                 MOVE RC012-FCLTY-ID     TO  ASC-FACT             10960099
109700                                             DK-FACT              10970099
109800* CHECK THE PACKAGING CODE                                        10980099
109900                 PERFORM 1110-DETERMINE-PGKG-CODE                 10990099
110000                 IF RECEIV-PKGNG-CDE NOT = 'M' AND 'I'            11000099
110100                    SET PS-ERROR                                  11010099
110200                        DP020-MSG-FATAL                           11020099
110300                        DP020-NEXT-ACT-APPL-ERROR                 11030099
110400                                         TO TRUE                  11040099
110500                       MOVE PC-TSYMSG-02166 TO DP020-MSG-NUMBER   11050099
110600                 END-IF                                           11060099
110700             END-IF                                               11070099
110800                                                                  11080099
110900         WHEN PC-INTER-APPL-PKSL-LIST                             11090099
111000              SET ASC-USE-SELECTION-QUEUE                         11100099
111100                                   TO TRUE                        11110099
111200              MOVE RC015-NUMBER-OF-SELECTED-ITEMS                 11120099
111300                                   TO ASC-NUMBER-OF-SELECTED-ITEMS11130099
111400              MOVE RC015-NUMBER-OF-TS-ITEMS                       11140099
111500                                   TO ASC-NUMBER-OF-TS-ITEMS      11150099
111600              MOVE RC015-SEL-QUEUE-NAME                           11160099
111700                                   TO ASC-SEL-QUEUE-NAME-IN       11170099
111800              PERFORM 1130-PREPARE-PKSL-LIST-ENTRY                11180099
111900                                                                  11190099
112000         WHEN OTHER                                               11200099
112100             IF  RC800-REC-NBR-N     = ZEROES                     11210099
112200                 MOVE PC-TSYMSG-00736  TO DP020-MSG-NUMBER        11220099
112300                 SET PS-ERROR                                     11230099
112400                     PS-COMMAREA-NOT-VALID                        11240099
112500                     DP020-NEXT-ACT-APPL-ERROR                    11250099
112600                     DP020-MSG-FATAL   TO TRUE                    11260099
112700             END-IF                                               11270099
112800             IF  RC800-REC-SEQ-NBR-N = ZEROES                     11280099
112900                 MOVE PC-TSYMSG-00737  TO DP020-MSG-NUMBER        11290099
113000                 SET PS-ERROR                                     11300099
113100                     PS-COMMAREA-NOT-VALID                        11310099
113200                     DP020-NEXT-ACT-APPL-ERROR                    11320099
113300                     DP020-MSG-FATAL   TO TRUE                    11330099
113400             END-IF                                               11340099
113500             IF  RC800-OPER-UNIT-ID = ZEROES                      11350099
113600             AND RC800-FACILITY-ID    = ZEROES                    11360099
113700                 MOVE PC-TSYMSG-00815    TO DP020-MSG-NUMBER      11370099
113800                 SET PS-ERROR                                     11380099
113900                     DP020-MSG-FATAL                              11390099
114000                     PS-COMMAREA-NOT-VALID                        11400099
114100                     DP020-NEXT-ACT-APPL-ERROR                    11410099
114200                                         TO TRUE                  11420099
114300             END-IF                                               11430099
114400             IF  PS-NO-ERROR                                      11440099
114500                 MOVE RC800-REC-NBR-N    TO  ASC-PO-NBR           11450099
114600                                             DK-ORD-NBR           11460099
114700                 MOVE RC800-REC-SEQ-NBR-N                         11470099
114800                                         TO  ASC-REC-SEQ-NBR      11480099
114900                                             DK-RCVR-SEQ-NBR      11490099
115000                 MOVE RC800-OPER-UNIT-ID TO  ASC-OPR-ID           11500099
115100                                             DK-OPR-ID            11510099
115200                 MOVE RC800-FACILITY-ID  TO  ASC-FACT             11520099
115300                                             DK-FACT              11530099
115400* CHECK THE PACKAGING CODE                                        11540099
115500                 PERFORM 1110-DETERMINE-PGKG-CODE                 11550099
115600                 IF RECEIV-PKGNG-CDE NOT = 'M' AND 'I'            11560099
115700                    SET PS-ERROR                                  11570099
115800                        DP020-MSG-FATAL                           11580099
115900                        DP020-NEXT-ACT-APPL-ERROR                 11590099
116000                                         TO TRUE                  11600099
116100                       MOVE PC-TSYMSG-02166 TO DP020-MSG-NUMBER   11610099
116200                 END-IF                                           11620099
116300             END-IF                                               11630099
116400                                                                  11640099
116500     END-EVALUATE.                                                11650099
116600                                                                  11660099
116700*----------------------------------------------------------------*11670099
116800*  IF THE PACKAGING CODE IS NOT = 'M' OR 'I', THE PROGRAM SHOULD *11680099
116900*  STOP PROCESSING AND RETURN AN ERROR MESSAGE.                  *11690099
117000*----------------------------------------------------------------*11700099
117100                                                                  11710099
117200 1110-DETERMINE-PGKG-CODE.                                        11720099
117300                                                                  11730099
117400     EXEC SQL                                                     11740099
117500          SELECT PKGNG_CDE                                        11750099
117600            INTO :RECEIV-PKGNG-CDE                                11760099
117700            FROM TRECEIV                                          11770099
117800           WHERE ORD_NBR         =  :DK-ORD-NBR                   11780099
117900             AND REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              11790099
118000             AND OPER_UNT_ID     =  :DK-OPR-ID                    11800099
118100             AND FCLTY_ID        =  :DK-FACT                      11810099
118200             AND VER_STATUS_CDE  =  'A'                           11820099
118300     END-EXEC.                                                    11830099
118400                                                                  11840099
118500     EVALUATE TRUE                                                11850099
118600         WHEN SQLCODE = ZERO                                      11860099
118700              CONTINUE                                            11870099
118800         WHEN SQLCODE = +100                                      11880099
118900              MOVE  SPACES     TO RECEIV-PKGNG-CDE                11890099
119000         WHEN SQLCODE = -904                                      11900099
119100         WHEN SQLCODE = -911                                      11910099
119200         WHEN SQLCODE = -913                                      11920099
119300              PERFORM 9900-SOFT-ABORT                             11930099
119400                                                                  11940099
119500         WHEN OTHER                                               11950099
119600              MOVE '1110-DETERMINE-PKGNG-CDE'                     11960099
119700                               TO DP013-PARAGRAPH                 11970099
119800              MOVE 'SELECT TRECEIV'                               11980099
119900                               TO DP013-MESSAGE-TEXT (1)          11990099
120000              MOVE SQLCA       TO DP013-SQLCA                     12000099
120100              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        12010099
120200              PERFORM 9950-FORMAT-ERROR-MSG                       12020099
120300              SET DP013-DB2-ABEND                                 12030099
120400                               TO TRUE                            12040099
120500              PERFORM DP013-0000-PROCESS-ABEND                    12050099
120600     END-EVALUATE.                                                12060099
120700/                                                                 12070099
120800                                                                  12080099
120900                                                                  12090099
121000*----------------------------------------------------------------*12100099
121100*  ENTRY IS FROM PACK SLIP LIST. GET THE KEYS FROM THE TEMP      *12110099
121200*  STORAGE QUEUE PASSED FROM THE LIST.                           *12120099
121300*----------------------------------------------------------------*12130099
121400                                                                  12140099
121500 1130-PREPARE-PKSL-LIST-ENTRY.                                    12150099
121600                                                                  12160099
121700      MOVE RC801-MAX-ITEMS         TO ASC-SEL-SUB.                12170099
121800      MOVE ZERO                    TO ASC-SEL-ITEM.               12180099
121900                                                                  12190099
122000      PERFORM 2400-GET-NEXT-PKSL-RECORD.                          12200099
122100                                                                  12210099
122200/                                                                 12220099
122300*----------------------------------------------------------------*12230099
122400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *12240099
122500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *12250099
122600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *12260099
122700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12270099
122800* FUNCTION KEYS CAN GET THIS FAR.                                *12280099
122900*----------------------------------------------------------------*12290099
123000                                                                  12300099
123100 2000-PROCESS-PANEL.                                              12310099
123200     SET ASC-NOT-REDISTRO-FUNCTION TO TRUE.                       12320099
123300                                                                  12330099
123400     EVALUATE TRUE                                                12340099
123500         WHEN DP020-SRC-AID = DP016-CLEAR                         12350099
123600             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12360099
123700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12370099
123800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12380099
123900                                                                  12390099
124000         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12400099
124100             PERFORM 2050-DELETE-LIST-QUEUE                       12410099
124200             PERFORM 4000-BUILD-INITIAL-PANEL                     12420099
124300                                                                  12430099
124400         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   12440099
124500             PERFORM 2140-DESELECT-ALL-ITEMS                      12450099
124600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12460099
124700                                                                  12470099
124800         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 12480099
124900              PERFORM 2150-SELECT-ALL-ITEMS                       12490099
125000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                12500099
125100                                                                  12510099
125200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12520099
125300             IF ASC-USE-SELECTION-QUEUE                           12530099
125400                 PERFORM 6200-DEL-LIST-QUEUE                      12540099
125500                 IF ASC-INTER-APPL-PKSL-LIST                      12550099
125600                     PERFORM 2400-GET-NEXT-PKSL-RECORD            12560099
125700                 ELSE                                             12570099
125800                     PERFORM 2300-GET-NEXT-RECORD                 12580099
125900                 END-IF                                           12590099
126000                 PERFORM 4000-BUILD-INITIAL-PANEL                 12600099
126100             ELSE                                                 12610099
126200*                --- BOTTOM OF LIST ---                           12620099
126300                 MOVE PC-TSYMSG-00070                             12630099
126400                                   TO DP020-MSG-NUMBER            12640099
126500                 SET DP020-MSG-INFORMATIONAL                      12650099
126600                                   TO TRUE                        12660099
126700             END-IF                                               12670099
126800                                                                  12680099
126900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12690099
127000             IF ASC-USE-SELECTION-QUEUE                           12700099
127100                 PERFORM 6200-DEL-LIST-QUEUE                      12710099
127200                 IF ASC-INTER-APPL-PKSL-LIST                      12720099
127300                     PERFORM 2410-GET-PREV-PKSL-RECORD            12730099
127400                 ELSE                                             12740099
127500                     PERFORM 2310-GET-PREV-RECORD                 12750099
127600                 END-IF                                           12760099
127700                 PERFORM 4000-BUILD-INITIAL-PANEL                 12770099
127800             ELSE                                                 12780099
127900*                --- TOP OF LIST ---                              12790099
128000                 MOVE PC-TSYMSG-00069                             12800099
128100                                   TO DP020-MSG-NUMBER            12810099
128200                 SET DP020-MSG-INFORMATIONAL                      12820099
128300                                   TO TRUE                        12830099
128400             END-IF                                               12840099
128500         WHEN OTHER                                               12850099
128600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12860099
128700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12870099
128800             IF  PS-NO-ERROR                                      12880099
128900                 SET DP030-CONTINUE-GO TO TRUE                    12890099
129000                 PERFORM 2100-CHECK-FUNCTION-KEY                  12900099
129100             ELSE                                                 12910099
129200                 SET DP030-OVERRIDE-GO TO TRUE                    12920099
129300             END-IF                                               12930099
129400     END-EVALUATE.                                                12940099
129500                                                                  12950099
129600/                                                                 12960099
129700*----------------------------------------------------------------*12970099
129800*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12980099
129900*----------------------------------------------------------------*12990099
130000 2050-DELETE-LIST-QUEUE.                                          13000099
130100                                                                  13010099
130200     EXEC CICS                                                    13020099
130300         DELETEQ TS                                               13030099
130400           QUEUE (ASC-LIST-QUEUE-NAME)                            13040099
130500            RESP (PV-CICS-RESP)                                   13050099
130600     END-EXEC.                                                    13060099
130700                                                                  13070099
130800     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       13080099
130900        (PV-CICS-RESP = DFHRESP(QIDERR))                          13090099
131000         CONTINUE                                                 13100099
131100     ELSE                                                         13110099
131200         SET DP013-CICS-ABEND      TO TRUE                        13120099
131300         SET DP013-NO-ROLLBACK     TO TRUE                        13130099
131400                                                                  13140099
131500         MOVE '2050-DELETE-LIST-QUEUE'                            13150099
131600                                   TO DP013-PARAGRAPH             13160099
131700         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13170099
131800                                   TO DP013-MESSAGE-TEXT (1)      13180099
131900         PERFORM DP013-0000-PROCESS-ABEND                         13190099
132000     END-IF.                                                      13200099
132100                                                                  13210099
132200     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13220099
132300                                                                  13230099
132400/                                                                 13240099
132500*----------------------------------------------------------------*13250099
132600* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13260099
132700* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13270099
132800* CICS ARCHITECTURE API.                                         *13280099
132900*----------------------------------------------------------------*13290099
133000 2100-CHECK-FUNCTION-KEY.                                         13300099
133100                                                                  13310099
133200     SET ASC-NOT-REDISTRO-FUNCTION                                13320099
133300         ASC-NO-EDIT-ERROR         TO TRUE.                       13330099
133400                                                                  13340099
133500     EVALUATE TRUE                                                13350099
133600                                                                  13360099
133700*** GO TO PACK UPDATE SCREEN (RCUPKIT)                            13370099
133800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13380099
133900                IF ASC-STAT = PC-VE                               13390099
134000                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          13400099
134100                    MOVE PC-TSYMSG-01196                          13410099
134200                                   TO DP020-MSG-NUMBER            13420099
134300                    SET PS-ERROR                                  13430099
134400                        DP020-MSG-FATAL                           13440099
134500                        DP030-OVERRIDE-GO                         13450099
134600                                   TO TRUE                        13460099
134700                ELSE                                              13470099
134800                   PERFORM 5000-PREPARE-SEL-QUEUE                 13480099
134900                   IF  PS-EMPTY-PACK                              13490099
135000                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       13500099
135100                       MOVE PC-TSYMSG-02106                       13510099
135200                                      TO DP020-MSG-NUMBER         13520099
135300                       SET PS-ERROR                               13530099
135400                           DP030-OVERRIDE-GO                      13540099
135500                           DP020-MSG-FATAL                        13550099
135600                                      TO TRUE                     13560099
135700                   ELSE                                           13570099
135800                   IF  RC800-NUMBER-OF-SELECTED-ITEMS = 0         13580099
135900                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       13590099
136000                       SET DP030-OVERRIDE-GO                      13600099
136100                                   TO TRUE                        13610099
136200                       MOVE PC-TSYMSG-00057                       13620099
136300                                   TO DP020-MSG-NUMBER            13630099
136400                       SET  PS-ERROR                              13640099
136500                            DP020-MSG-FATAL                       13650099
136600                                   TO TRUE                        13660099
136700                   ELSE                                           13670099
136800                      PERFORM 7000-FORMAT-COMMAREA                13680099
136900                   END-IF                                         13690099
137000                END-IF                                            13700099
137100             END-IF                                               13710099
137200                                                                  13720099
137300                                                                  13730099
137400*** GO TO  PURCHASE LINE SUMMARY (POLINLN)                        13740099
137500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13750099
137600             SET ASC-UPDATE-TSQ3  TO TRUE                         13760099
137700             MOVE ASC-PO-NBR      TO PO017-PO-NBR                 13770099
137800                                                                  13780099
137900*** GO TO RECEIVER PACK DETAIL LIST (PCMPKDTL)                    13790099
138000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              13800099
138100             PERFORM 5000-PREPARE-SEL-QUEUE                       13810099
138200             IF  RC800-NUMBER-OF-SELECTED-ITEMS = 0               13820099
138300                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              13830099
138400                 SET DP030-OVERRIDE-GO                            13840099
138500                                   TO TRUE                        13850099
138600                 MOVE PC-TSYMSG-00057                             13860099
138700                                   TO DP020-MSG-NUMBER            13870099
138800                 SET  PS-ERROR                                    13880099
138900                      DP020-MSG-FATAL                             13890099
139000                                   TO TRUE                        13900099
139100             ELSE                                                 13910099
139200                 PERFORM 7000-FORMAT-COMMAREA                     13920099
139300             END-IF                                               13930099
139400                                                                  13940099
139500*** GO TO PACK PRINT APRON                                        13950099
139600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              13960099
139700              SET ASC-UPDATE-TSQ3  TO TRUE                        13970099
139800              PERFORM 5000-PREPARE-SEL-QUEUE                      13980099
139900              IF PS-UNTIED-PACK                                   13990099
140000                MOVE PC-TSYMSG-02195  TO DP020-MSG-NUMBER         14000099
140100                SET PS-ERROR                                      14010099
140200                    DP030-OVERRIDE-GO                             14020099
140300                    DP020-MSG-FATAL  TO TRUE                      14030099
140400                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14040099
140500              ELSE                                                14050099
140600                IF  PS-EMPTY-PACK                                 14060099
140700                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          14070099
140800                    MOVE PC-TSYMSG-02106  TO DP020-MSG-NUMBER     14080099
140900                    SET PS-ERROR                                  14090099
141000                        DP030-OVERRIDE-GO                         14100099
141100                        DP020-MSG-FATAL  TO TRUE                  14110099
141200                  ELSE                                            14120099
141300                    IF PC000-NUMBER-OF-SELECTED-ITEMS = 0         14130099
141400                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       14140099
141500                       MOVE PC-TSYMSG-00057                       14150099
141600                                   TO DP020-MSG-NUMBER            14160099
141700                       SET PS-ERROR                               14170099
141800                           DP030-OVERRIDE-GO                      14180099
141900                           DP020-MSG-FATAL                        14190099
142000                                   TO TRUE                        14200099
142100                    ELSE                                          14210099
142200                       MOVE ASC-PO-NBR                            14220099
142300                                   TO PC000-PO-NBR-N              14230099
142400                       MOVE ASC-REC-SEQ-NBR                       14240099
142500                                   TO PC000-REC-SEQ-NBR-N         14250099
142600                       MOVE ASC-OPR-ID                            14260099
142700                                   TO PC000-OPERATING-UNIT-ID     14270099
142800                       MOVE ASC-FACT                              14280099
142900                                   TO PC000-FACILITY-ID           14290099
143000                    END-IF                                        14300099
143100                  END-IF                                          14310099
143200             END-IF                                               14320099
143300                                                                  14330099
143400*** GO TO STORE DISTRO BY PACK                                    14340099
143500         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              14350099
143600            SET ASC-UPDATE-TSQ2  TO TRUE                          14360099
143700            PERFORM 5000-PREPARE-SEL-QUEUE                        14370099
143800            IF  PS-EMPTY-PACK                                     14380099
143900                MOVE PC-TSYMSG-02106  TO DP020-MSG-NUMBER         14390099
144000                SET PS-ERROR                                      14400099
144100                    DP030-OVERRIDE-GO                             14410099
144200                    DP020-MSG-FATAL  TO TRUE                      14420099
144300                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14430099
144400             ELSE                                                 14440099
144500             IF RC800-NUMBER-OF-SELECTED-ITEMS = 0                14450099
144600                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14460099
144700                 MOVE PC-TSYMSG-00057                             14470099
144800                                   TO DP020-MSG-NUMBER            14480099
144900                 SET PS-ERROR                                     14490099
145000                     DP030-OVERRIDE-GO                            14500099
145100                      DP020-MSG-FATAL                             14510099
145200                                   TO TRUE                        14520099
145300             ELSE                                                 14530099
145400                 PERFORM 7000-FORMAT-COMMAREA                     14540099
145500             END-IF                                               14550099
145600             END-IF                                               14560099
145700                                                                  14570099
145800*  ADD PACK                                                       14580099
145900         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              14590099
146000              SET ASC-UPDATE-TSQ3      TO TRUE                    14600099
146100              IF ASC-STAT = 'VE'                                  14610099
146200                 SET DP030-OVERRIDE-GO TO TRUE                    14620099
146300                 MOVE PC-TSYMSG-01196                             14630099
146400                                  TO DP020-MSG-NUMBER             14640099
146500                 SET PS-ERROR                                     14650099
146600                     DP020-MSG-FATAL                              14660099
146700                                  TO TRUE                         14670099
146800              ELSE                                                14680099
146900                 PERFORM 5000-PREPARE-SEL-QUEUE                   14690099
147000                 MOVE ASC-NUMBER-OF-ITEMS-READ                    14700099
147100                           TO RC800-NUMBER-OF-SELECTED-ITEMS      14710099
147200                 PERFORM 7000-FORMAT-COMMAREA                     14720099
147300              END-IF                                              14730099
147400                                                                  14740099
147500*** GOTO TROUBLE LIST (TMLDCLNE)                                  14750099
147600          WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)             14760099
147700             SET ASC-UPDATE-TSQ4      TO TRUE                     14770099
147800             PERFORM 5000-PREPARE-SEL-QUEUE                       14780099
147900             IF PC000-NUMBER-OF-SELECTED-ITEMS = 0                14790099
148000                PERFORM 4400-MOVE-COMMAREA-TO-SCREEN              14800099
148100                SET DP030-OVERRIDE-GO TO TRUE                     14810099
148200                MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER         14820099
148300                SET  PS-ERROR                                     14830099
148400                     DP020-MSG-FATAL  TO TRUE                     14840099
148500             END-IF                                               14850099
148600                                                                  14860099
148700*** CREATE TROUBLE (TRBLCRE)                                      14870099
148800         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              14880099
148900              SET ASC-UPDATE-TSQ2     TO TRUE                     14890099
149000              PERFORM 5000-PREPARE-SEL-QUEUE                      14900099
149100              IF RC800-NUMBER-OF-SELECTED-ITEMS = 0               14910099
149200                 PERFORM 4100-PREPARE-CURSOR                      14920099
149300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14930099
149400                 SET DP030-OVERRIDE-GO TO TRUE                    14940099
149500                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        14950099
149600                 SET PS-ERROR                                     14960099
149700                     DP020-MSG-FATAL  TO TRUE                     14970099
149800              ELSE                                                14980099
149900                 PERFORM 7000-FORMAT-COMMAREA                     14990099
150000              END-IF                                              15000099
150100                                                                  15010099
150200                                                                  15020099
150300*** REDISTRO PACK                                                 15030099
150400         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              15040099
150500              SET ASC-REDISTRO-FUNCTION                           15050099
150600                                        TO TRUE                   15060099
150700              PERFORM 2170-CHECK-PACK-BY-STORE                    15070099
150800              IF PS-PACK-BY-ST-SW-YES                             15080099
150900                 MOVE PC-TSYMSG-00928    TO DP020-MSG-NUMBER      15090099
151000                 SET PS-ERROR                                     15100099
151100                     DP030-OVERRIDE-GO                            15110099
151200                     ASC-REDISTRO-OK                              15120099
151300                     DP020-MSG-FATAL     TO TRUE                  15130099
151400                 PERFORM 4100-PREPARE-CURSOR                      15140099
151500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             15150099
151600              ELSE                                                15160099
151700                IF ASC-STAT   = 'VE'                              15170099
151800                   MOVE PC-TSYMSG-01196       TO DP020-MSG-NUMBER 15180099
151900                    SET PS-ERROR                                  15190099
152000                        DP030-OVERRIDE-GO                         15200099
152100                        ASC-REDISTRO-OK                           15210099
152200                        DP020-MSG-FATAL     TO TRUE               15220099
152300                    PERFORM 4100-PREPARE-CURSOR                   15230099
152400                    PERFORM 4400-MOVE-COMMAREA-TO-SCREEN          15240099
152500                 ELSE                                             15250099
152600                   PERFORM 5000-PREPARE-SEL-QUEUE                 15260099
152700                   IF PS-EMPTY-PACK                               15270099
152800                      MOVE PC-TSYMSG-02106  TO DP020-MSG-NUMBER   15280099
152900                      SET PS-ERROR                                15290099
153000                          DP030-OVERRIDE-GO                       15300099
153100                          ASC-REDISTRO-OK                         15310099
153200                          DP020-MSG-FATAL   TO TRUE               15320099
153300                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        15330099
153400                   ELSE                                           15340099
153500                   IF RC800-NUMBER-OF-SELECTED-ITEMS = 0          15350099
153600                      MOVE PC-TSYMSG-00057                        15360099
153700                                          TO DP020-MSG-NUMBER     15370099
153800                      SET DP030-OVERRIDE-GO                       15380099
153900                          PS-ERROR                                15390099
154000                          ASC-REDISTRO-OK                         15400099
154100                          DP020-MSG-FATAL TO TRUE                 15410099
154200                      PERFORM 4100-PREPARE-CURSOR                 15420099
154300                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        15430099
154400                   ELSE                                           15440099
154500                      IF RC800-NUMBER-OF-SELECTED-ITEMS > 1 AND   15450099
154600                         ASC-REDISTRO-NOT-OK                      15460099
154700                         MOVE PC-TSYMSG-02330                     15470099
154800                                          TO DP020-MSG-NUMBER     15480099
154900                         SET DP030-OVERRIDE-GO                    15490099
155000                             ASC-REDISTRO-OK                      15500099
155100                             DP020-MSG-INFORMATIONAL              15510099
155200                             PS-ERROR     TO TRUE                 15520099
155300                         PERFORM 4100-PREPARE-CURSOR              15530099
155400                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     15540099
155500                     ELSE                                         15550099
155600                         PERFORM 2050-DELETE-LIST-QUEUE           15560099
155700                         PERFORM 4000-BUILD-INITIAL-PANEL         15570099
155800                     END-IF                                       15580099
155900                   END-IF                                         15590099
156000                   END-IF                                         15600099
156100              END-IF                                              15610099
156200            END-IF                                                15620099
156300                                                                  15630099
156400*** DELETE PACK                                                   15640099
156500                                                                  15650099
156600         WHEN DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID) OR           15660099
156700              (ASC-DELETE-PENDING AND                             15670099
156800               DP020-FK-CONFIRM (DP020-SRC-AID))                  15680099
156810               PERFORM 3600-CHECK-WMS                             15681099
156850               IF PS-RECEIVING-BEGUN-NO                           15685099
156900                  PERFORM 2165-DETERMINE-IF-PKSLIP-EXIST          15690099
157000                  IF PV-PACKSLIP-COUNT > 0                        15700099
157100                     MOVE PC-TSYMSG-03244  TO DP020-MSG-NUMBER    15710099
157200                     SET PS-ERROR                                 15720099
157300                         DP030-OVERRIDE-GO                        15730099
157400                         ASC-DELETE-NOT-PENDING                   15740099
157500                         DP020-MSG-FATAL                          15750099
157600                         ASC-DELETE-NOT-PENDING                   15760099
157700                                              TO TRUE             15770099
157800                         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN     15780099
157900                  ELSE                                            15790099
158000                     IF DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)    15800099
158100                        SET ASC-DELETE-NOT-PENDING                15810099
158200                                              TO TRUE             15820099
158300                     END-IF                                       15830099
158400                     SET PS-UPDATE-RECITM     TO TRUE             15840099
158500                     PERFORM 5000-PREPARE-SEL-QUEUE               15850099
158600                    IF ASC-NO-EDIT-ERROR                          15860099
158700                       IF NOT DP020-FK-CONFIRM (DP020-SRC-AID)    15870099
158710                                   AND                            15871099
158800                          ASC-DELETE-NOT-PENDING                  15880099
158900                          SET ASC-DELETE-PENDING         TO TRUE  15890099
159000                       ELSE                                       15900099
159100                         IF DP020-FK-CONFIRM (DP020-SRC-AID) AND  15910099
159200                            ASC-DELETE-PENDING                    15920099
159300                            SET ASC-DELETE-NOT-PENDING TO TRUE    15930099
159400                         END-IF                                   15940099
159500                       END-IF                                     15950099
159600                    END-IF                                        15960099
159700                    IF PS-EMPTY-PACK                              15970099
159800                       MOVE PC-TSYMSG-02106  TO DP020-MSG-NUMBER  15980099
159900                       SET PS-ERROR                               15990099
160000                           DP030-OVERRIDE-GO                      16000099
160100                           ASC-DELETE-NOT-PENDING                 16010099
160200                           DP020-MSG-FATAL   TO TRUE              16020099
160300                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       16030099
160400                    ELSE                                          16040099
160500                       IF RC800-NUMBER-OF-SELECTED-ITEMS = 0      16050099
160600                          SET PS-ERROR                            16060099
160700                              DP030-OVERRIDE-GO                   16070099
160800                              ASC-DELETE-NOT-PENDING              16080099
160900                              DP020-MSG-FATAL                     16090099
161000                                             TO TRUE              16100099
161100                          MOVE PC-TSYMSG-00057                    16110099
161200                                             TO DP020-MSG-NUMBER  16120099
161300                          PERFORM 4100-PREPARE-CURSOR             16130099
161400                          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN    16140099
161500                       ELSE                                       16150099
161600                         IF ASC-DELETE-NOT-PENDING                16160099
161700                            PERFORM 2050-DELETE-LIST-QUEUE        16170099
161800                            PERFORM 4000-BUILD-INITIAL-PANEL      16180099
161900                         ELSE                                     16190099
162000                            PERFORM 4100-PREPARE-CURSOR           16200099
162100                            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN  16210099
162200                         END-IF                                   16220099
162300                       END-IF                                     16230099
162400                    END-IF                                        16240099
162500                  END-IF                                          16250099
162600               ELSE                                               16260099
162601                  MOVE PC-TSYMSG-03538  TO DP020-MSG-NUMBER       16260199
162602                  SET PS-ERROR                                    16260299
162603                      DP030-OVERRIDE-GO                           16260399
162604                      ASC-DELETE-NOT-PENDING                      16260499
162605                      DP020-MSG-FATAL                             16260599
162606                      ASC-DELETE-NOT-PENDING                      16260699
162607                                           TO TRUE                16260799
162608                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        16260899
162610               END-IF                                             16261099
162700* DISPLAY ERROR MESSAGE IF USER HITS F2-CONFIRM WITHOUT DELETING  16270099
162800* FIRST                                                           16280099
162900         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    16290099
163000          AND  NOT ASC-DELETE-PENDING                             16300099
163100*     INVALID FUNCTION KEY                                        16310099
163200               MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER          16320099
163300               SET PS-ERROR                                       16330099
163400                   DP030-OVERRIDE-GO                              16340099
163500                   DP020-MSG-FATAL   TO TRUE                      16350099
163600             PERFORM 4100-PREPARE-CURSOR                          16360099
163700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16370099
163800                                                                  16380099
163900                                                                  16390099
164000         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  16400099
164100             MOVE +1               TO PV-TOP-ITEM                 16410099
164200             PERFORM 4100-PREPARE-CURSOR                          16420099
164300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16430099
164400                                                                  16440099
164500         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   16450099
164600             PERFORM 2110-BROWSE-BACKWARD                         16460099
164700             PERFORM 4100-PREPARE-CURSOR                          16470099
164800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16480099
164900                                                                  16490099
165000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   16500099
165100             PERFORM 2120-BROWSE-FORWARD                          16510099
165200             PERFORM 4100-PREPARE-CURSOR                          16520099
165300               MOVE +1                   TO ASC-BLK-SUB           16530099
165400               PERFORM 4410-READ-TEMP-STORAGE                     16540099
165500               MOVE 2                TO ASC-BLK-SUB               16550099
165600               PERFORM 4410-READ-TEMP-STORAGE                     16560099
165700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16570099
165800                                                                  16580099
165900         WHEN DP020-SRC-AID = DP016-ENTER                         16590099
166000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   16600099
166100             IF  PS-ERROR                                         16610099
166200                 CONTINUE                                         16620099
166300             ELSE                                                 16630099
166400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             16640099
166500             END-IF                                               16650099
166600                                                                  16660099
166700         WHEN OTHER                                               16670099
166800             PERFORM 2050-DELETE-LIST-QUEUE                       16680099
166900             PERFORM 4100-PREPARE-CURSOR                          16690099
167000             PERFORM 4000-BUILD-INITIAL-PANEL                     16700099
167100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 16710099
167200     END-EVALUATE.                                                16720099
167300                                                                  16730099
167400/                                                                 16740099
167500*----------------------------------------------------------------*16750099
167600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *16760099
167700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *16770099
167800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *16780099
167900*    MESSAGE.                                                    *16790099
168000*----------------------------------------------------------------*16800099
168100                                                                  16810099
168200 2110-BROWSE-BACKWARD.                                            16820099
168300                                                                  16830099
168400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    16840099
168500         GIVING PV-TOP-ITEM.                                      16850099
168600                                                                  16860099
168700     IF  ((PV-TOP-ITEM < +1)                                      16870099
168800       OR (PV-TOP-ITEM = +1))                                     16880099
168900         MOVE +1                   TO PV-TOP-ITEM                 16890099
169000*        -- TOP OF LIST --                                        16900099
169100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16910099
169200         SET DP020-MSG-INFORMATIONAL                              16920099
169300                                   TO TRUE                        16930099
169400     END-IF.                                                      16940099
169500                                                                  16950099
169600/                                                                 16960099
169700*----------------------------------------------------------------*16970099
169800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *16980099
169900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *16990099
170000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *17000099
170100*----------------------------------------------------------------*17010099
170200                                                                  17020099
170300 2120-BROWSE-FORWARD.                                             17030099
170400                                                                  17040099
170500     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              17050099
170600         GIVING PV-TOP-ITEM.                                      17060099
170700                                                                  17070099
170800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   17080099
170900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17090099
171000                                   TO PV-TOP-ITEM                 17100099
171100*        -- BOTTOM OF LIST --                                     17110099
171200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            17120099
171300         SET DP020-MSG-INFORMATIONAL                              17130099
171400                                   TO TRUE                        17140099
171500     ELSE                                                         17150099
171600         COMPUTE PV-BOTTOM-ITEM =                                 17160099
171700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 17170099
171800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            17180099
171900*            -- BOTTOM OF LIST --                                 17190099
172000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            17200099
172100             SET DP020-MSG-INFORMATIONAL                          17210099
172200                                   TO TRUE                        17220099
172300         END-IF                                                   17230099
172400     END-IF.                                                      17240099
172500                                                                  17250099
172600/                                                                 17260099
172700*----------------------------------------------------------------*17270099
172800*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *17280099
172900*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *17290099
173000*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *17300099
173100*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *17310099
173200*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *17320099
173300*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *17330099
173400*----------------------------------------------------------------*17340099
173500                                                                  17350099
173600 2130-CHECK-FOR-JUMP-BROWSE.                                      17360099
173700                                                                  17370099
173800     SET PS-NO-ERROR               TO TRUE.                       17380099
173900     IF (ASC-START-ITEM-REQUEST = SPACE)                          17390099
174000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17400099
174100                                   TO PV-TOP-ITEM                 17410099
174200     ELSE                                                         17420099
174300         MOVE ASC-START-ITEM-REQUEST                              17430099
174400                                   TO DP010I-UNEDITED-FIELD       17440099
174500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       17450099
174600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     17460099
174700         SET DP010I-NEGATIVE-NOT-ALLOWED                          17470099
174800                                   TO TRUE                        17480099
174900         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17490099
174910              USING DP010I-NUMERIC-EDIT-AREA                      17491099
175000                                                                  17500099
175100         IF  NOT DP010I-ERROR-DETECTED                            17510099
175200             MOVE DP010I-NUMERIC-FIELD                            17520099
175300                                   TO ASC-START-ITEM-REQUEST-N    17530099
175400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  17540099
175500                 IF  ASC-START-ITEM-REQUEST-N >                   17550099
175600                                          ASC-NUMBER-OF-ITEMS-READ17560099
175700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         17570099
175800                     COMPUTE PV-TOP-ITEM =                        17580099
175900                             ASC-NUMBER-OF-ITEMS-READ             17590099
176000                             - PC-ITEMS-PER-PANEL + 1             17600099
176100                     IF  PV-TOP-ITEM < +1                         17610099
176200                         MOVE +1   TO PV-TOP-ITEM                 17620099
176300                         MOVE PC-TSYMSG-00070                     17630099
176400                                   TO DP020-MSG-NUMBER            17640099
176500                         SET DP020-MSG-INFORMATIONAL              17650099
176600                                   TO TRUE                        17660099
176700                     END-IF                                       17670099
176800                 ELSE                                             17680099
176900                     MOVE ASC-START-ITEM-REQUEST-N                17690099
177000                                   TO PV-TOP-ITEM                 17700099
177100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      17710099
177200                     COMPUTE PV-BOTTOM-ITEM =                     17720099
177300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     17730099
177400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ17740099
177500*                        -- BOTTOM OF LIST --                     17750099
177600                         MOVE PC-TSYMSG-00070                     17760099
177700                                   TO DP020-MSG-NUMBER            17770099
177800                         SET DP020-MSG-INFORMATIONAL              17780099
177900                                   TO TRUE                        17790099
178000                     END-IF                                       17800099
178100                 END-IF                                           17810099
178200             ELSE                                                 17820099
178300*                --- VALUE OUT OF RANGE ----                      17830099
178400                 MOVE PC-TSYMSG-00101                             17840099
178500                                   TO DP020-MSG-NUMBER            17850099
178600                 MOVE -1           TO ASTRTITL                    17860099
178700                 SET DP030-SET-CURSOR-APPL-1                      17870099
178800                                   TO TRUE                        17880099
178900                 MOVE DP015-REVERSE                               17890099
179000                                   TO ASTRTITH                    17900099
179100                 MOVE DP015-RED    TO ASTRTITC                    17910099
179200                 MOVE DP015-UNP-NUM-BRT-MDT                       17920099
179300                                   TO ASTRTITA                    17930099
179400                 SET DP020-MSG-FATAL                              17940099
179500                                   TO TRUE                        17950099
179600                 SET PS-ERROR      TO TRUE                        17960099
179700             END-IF                                               17970099
179800                                                                  17980099
179900         ELSE                                                     17990099
180000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            18000099
180100             MOVE -1               TO ASTRTITL                    18010099
180200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  18020099
180300             MOVE DP015-REVERSE    TO ASTRTITH                    18030099
180400             MOVE DP015-RED        TO ASTRTITC                    18040099
180500             MOVE DP015-UNP-NUM-BRT-MDT                           18050099
180600                                   TO ASTRTITA                    18060099
180700             SET DP020-MSG-FATAL   TO TRUE                        18070099
180800             SET PS-ERROR          TO TRUE                        18080099
180900         END-IF                                                   18090099
181000     END-IF.                                                      18100099
181100                                                                  18110099
181200/                                                                 18120099
181300*----------------------------------------------------------------*18130099
181400*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *18140099
181500*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *18150099
181600*----------------------------------------------------------------*18160099
181700 2140-DESELECT-ALL-ITEMS.                                         18170099
181800                                                                  18180099
181900     MOVE +1                       TO ASC-BLK-SUB.                18190099
182000                                                                  18200099
182100     PERFORM 2141-CLEAR-SELECTED-INDS                             18210099
182200         VARYING ASC-ITEM-SUB                                     18220099
182300         FROM 1 BY 1                                              18230099
182400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18240099
182500                                                                  18250099
182600     ADD +1                        TO ASC-BLK-SUB.                18260099
182700                                                                  18270099
182800     PERFORM 2141-CLEAR-SELECTED-INDS                             18280099
182900         VARYING ASC-ITEM-SUB                                     18290099
183000         FROM 1 BY 1                                              18300099
183100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 18310099
183200                                                                  18320099
183300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               18330099
183400                                   TO PV-LIST-ITEM-NUMBER.        18340099
183500                                                                  18350099
183600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            18360099
183700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    18370099
183800                                                                  18380099
183900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     18390099
184000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      18400099
184100         MOVE +1                   TO ASC-BLK-SUB                 18410099
184200                                                                  18420099
184300         PERFORM 5100-WRITE-TEMP-STORAGE                          18430099
184400                                                                  18440099
184500         MOVE +1                   TO PV-BLOCK-NUMBER             18450099
184600                                                                  18460099
184700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18470099
184800             PV-FIRST-BLOCK-IN-ARRAY - 1                          18480099
184900                                                                  18490099
185000         PERFORM                                                  18500099
185100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       18510099
185200                                                                  18520099
185300             PERFORM 4410-READ-TEMP-STORAGE                       18530099
185400                                                                  18540099
185500             PERFORM 2141-CLEAR-SELECTED-INDS                     18550099
185600                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 18560099
185700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18570099
185800                                                                  18580099
185900             PERFORM 5100-WRITE-TEMP-STORAGE                      18590099
186000                                                                  18600099
186100             ADD +1                TO PV-BLOCK-NUMBER             18610099
186200                                                                  18620099
186300         END-PERFORM                                              18630099
186400                                                                  18640099
186500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18650099
186600             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18660099
186700                                                                  18670099
186800         PERFORM                                                  18680099
186900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18690099
187000                   ASC-HIGHEST-BLOCK-WRITTEN                      18700099
187100                                                                  18710099
187200             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18720099
187300                                   TO PV-BLOCK-NUMBER             18730099
187400                                                                  18740099
187500             PERFORM 4410-READ-TEMP-STORAGE                       18750099
187600                                                                  18760099
187700             PERFORM 2141-CLEAR-SELECTED-INDS                     18770099
187800                 VARYING ASC-ITEM-SUB                             18780099
187900                 FROM 1 BY 1                                      18790099
188000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18800099
188100                                                                  18810099
188200             PERFORM 5100-WRITE-TEMP-STORAGE                      18820099
188300                                                                  18830099
188400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18840099
188500                                                                  18850099
188600         END-PERFORM                                              18860099
188700                                                                  18870099
188800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18880099
188900                                   TO PV-BLOCK-NUMBER             18890099
189000                                                                  18900099
189100         PERFORM 4410-READ-TEMP-STORAGE                           18910099
189200     END-IF.                                                      18920099
189300                                                                  18930099
189400     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS18940099
189500     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.18950099
189600     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  18960099
189700                                                                  18970099
189800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18980099
189900                                                                  18990099
190000/                                                                 19000099
190100*----------------------------------------------------------------*19010099
190200*    MARK EACH ITEM AS BEING NOT SELECTED.                       *19020099
190300*----------------------------------------------------------------*19030099
190400                                                                  19040099
190500 2141-CLEAR-SELECTED-INDS.                                        19050099
190600                                                                  19060099
190700     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          19070099
190800             NOT EQUAL ZERO                                       19080099
190900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19090099
191000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          19100099
191100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    19110099
191200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  19120099
191300                                   TO TRUE                        19130099
191400         END-IF                                                   19140099
191500     END-IF.                                                      19150099
191600                                                                  19160099
191700/                                                                 19170099
191800*----------------------------------------------------------------*19180099
191900*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *19190099
192000*  FOR ALL ITEMS.                                                *19200099
192100*----------------------------------------------------------------*19210099
192200                                                                  19220099
192300 2150-SELECT-ALL-ITEMS.                                           19230099
192400                                                                  19240099
192500     MOVE +1                       TO ASC-BLK-SUB.                19250099
192600                                                                  19260099
192700     PERFORM 2151-SET-SELECTED-INDS                               19270099
192800         VARYING ASC-ITEM-SUB                                     19280099
192900         FROM 1 BY 1                                              19290099
193000         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19300099
193100                                                                  19310099
193200     ADD +1                        TO ASC-BLK-SUB.                19320099
193300                                                                  19330099
193400     PERFORM 2151-SET-SELECTED-INDS                               19340099
193500         VARYING ASC-ITEM-SUB                                     19350099
193600         FROM 1 BY 1                                              19360099
193700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19370099
193800                                                                  19380099
193900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19390099
194000                                   TO PV-LIST-ITEM-NUMBER.        19400099
194100                                                                  19410099
194200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19420099
194300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    19430099
194400                                                                  19440099
194500     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     19450099
194600        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    19460099
194700         MOVE +1                   TO ASC-BLK-SUB                 19470099
194800                                                                  19480099
194900         PERFORM 5100-WRITE-TEMP-STORAGE                          19490099
195000                                                                  19500099
195100         MOVE +1                   TO PV-BLOCK-NUMBER             19510099
195200                                                                  19520099
195300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         19530099
195400             PV-FIRST-BLOCK-IN-ARRAY - 1                          19540099
195500                                                                  19550099
195600         PERFORM                                                  19560099
195700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       19570099
195800                                                                  19580099
195900             PERFORM 4410-READ-TEMP-STORAGE                       19590099
196000                                                                  19600099
196100             PERFORM 2151-SET-SELECTED-INDS                       19610099
196200                 VARYING ASC-ITEM-SUB                             19620099
196300                 FROM 1 BY 1                                      19630099
196400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19640099
196500                                                                  19650099
196600             PERFORM 5100-WRITE-TEMP-STORAGE                      19660099
196700                                                                  19670099
196800             ADD +1                TO PV-BLOCK-NUMBER             19680099
196900         END-PERFORM                                              19690099
197000                                                                  19700099
197100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         19710099
197200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     19720099
197300                                                                  19730099
197400         PERFORM                                                  19740099
197500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       19750099
197600                   ASC-HIGHEST-BLOCK-WRITTEN                      19760099
197700                                                                  19770099
197800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          19780099
197900                                   TO PV-BLOCK-NUMBER             19790099
198000                                                                  19800099
198100             PERFORM 4410-READ-TEMP-STORAGE                       19810099
198200                                                                  19820099
198300             PERFORM 2151-SET-SELECTED-INDS                       19830099
198400                 VARYING ASC-ITEM-SUB                             19840099
198500                 FROM 1 BY 1                                      19850099
198600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          19860099
198700                                                                  19870099
198800             PERFORM 5100-WRITE-TEMP-STORAGE                      19880099
198900                                                                  19890099
199000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      19900099
199100         END-PERFORM                                              19910099
199200                                                                  19920099
199300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             19930099
199400                                   TO PV-BLOCK-NUMBER             19940099
199500                                                                  19950099
199600         PERFORM 4410-READ-TEMP-STORAGE                           19960099
199700     END-IF.                                                      19970099
199800                                                                  19980099
199900     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             19990099
200000          ASC-NUMBER-OF-SELECTED-ITEMS.                           20000099
200100                                                                  20010099
200200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        20020099
200300                                                                  20030099
200400/                                                                 20040099
200500*----------------------------------------------------------------*20050099
200600*    MARK EACH ITEM AS BEING SELECTED.                           *20060099
200700*----------------------------------------------------------------*20070099
200800                                                                  20080099
200900 2151-SET-SELECTED-INDS.                                          20090099
201000                                                                  20100099
201100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           20110099
201200             NOT EQUAL ZERO                                       20120099
201300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20130099
201400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             20140099
201500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        20150099
201600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  20160099
201700                                   TO TRUE                        20170099
201800         END-IF                                                   20180099
201900     END-IF.                                                      20190099
202000                                                                  20200099
202100                                                                  20210099
202200                                                                  20220099
202300*----------------------------------------------------------------*20230099
202400*    IF THERE ARE NO LINES WITHIN THE PACK, CERTAIN FKEYS WILL   *20240099
202500*    BE INVALID.                                                 *20250099
202600*----------------------------------------------------------------*20260099
202700                                                                  20270099
202800 2160-DETERMINE-IF-PACK.                                          20280099
202900     MOVE +0                      TO PV-PACK-LINE-COUNT.          20290099
203000                                                                  20300099
203100     EXEC SQL                                                     20310099
203200         SELECT COUNT(*)                                          20320099
203300         INTO :PV-PACK-LINE-COUNT                                 20330099
203400         FROM TRECITM A                                           20340099
203500         WHERE     A.ORD_NBR          = :DK-ORD-NBR               20350099
203600               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          20360099
203700               AND A.OPER_UNT_ID      = :DK-OPR-ID                20370099
203800               AND A.FCLTY_ID         = :DK-FACT                  20380099
203900               AND A.ORD_LNE_NBR      > 0                         20390099
204000               AND A.PREPK_ID         = :DK-PACK-ID               20400099
204100               AND A.PREPK_RATO_QTY   > 0                         20410099
204200     END-EXEC.                                                    20420099
204300                                                                  20430099
204400     EVALUATE TRUE                                                20440099
204500         WHEN SQLCODE = ZERO                                      20450099
204600         WHEN SQLCODE = +100                                      20460099
204700             CONTINUE                                             20470099
204800         WHEN SQLCODE = -904                                      20480099
204900         WHEN SQLCODE = -911                                      20490099
205000         WHEN SQLCODE = -913                                      20500099
205100              PERFORM 9900-SOFT-ABORT                             20510099
205200         WHEN OTHER                                               20520099
205300             MOVE '2160-DETERMINE-IF-PACK'                        20530099
205400                                 TO DP013-PARAGRAPH               20540099
205500             MOVE 'SELECT ON TRECITM'                             20550099
205600                                 TO DP013-MESSAGE-TEXT (1)        20560099
205700             MOVE SQLCA          TO DP013-SQLCA                   20570099
205800             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      20580099
205900             PERFORM 9950-FORMAT-ERROR-MSG                        20590099
206000             SET DP013-DB2-ABEND                                  20600099
206100                             TO TRUE                              20610099
206200             SET DP013-XCTL-DISPLAY-RESTART                       20620099
206300                             TO TRUE                              20630099
206400             PERFORM DP013-0000-PROCESS-ABEND                     20640099
206500     END-EVALUATE.                                                20650099
206600                                                                  20660099
206700*************************************************************     20670099
206800* COUNT HOW MANY LINES CAME IN ON AN ASN TO DETERMINE IF    *     20680099
206900* A DELETE OF PACK CAN BE DONE.                             *     20690099
207000*************************************************************     20700099
207100 2165-DETERMINE-IF-PKSLIP-EXIST.                                  20710099
207200     MOVE +0                      TO PV-PACKSLIP-COUNT.           20720099
207300                                                                  20730099
207400     EXEC SQL                                                     20740099
207500         SELECT COUNT(*)                                          20750099
207600         INTO :PV-PACKSLIP-COUNT                                  20760099
207700         FROM TRECITM A                                           20770099
207800         WHERE     A.ORD_NBR          = :DK-ORD-NBR               20780099
207900               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          20790099
208000               AND A.OPER_UNT_ID      = :DK-OPR-ID                20800099
208100               AND A.FCLTY_ID         = :DK-FACT                  20810099
208200               AND A.ORD_LNE_NBR      > 0                         20820099
208300               AND A.PKSL_ITM_QTY     > 0                         20830099
208400               AND A.PREPK_ID         = :DK-PACK-ID               20840099
208500               AND A.PREPK_RATO_QTY   > 0                         20850099
208600     END-EXEC.                                                    20860099
208700                                                                  20870099
208800     EVALUATE TRUE                                                20880099
208900         WHEN SQLCODE = ZERO                                      20890099
209000         WHEN SQLCODE = +100                                      20900099
209100             CONTINUE                                             20910099
209200         WHEN SQLCODE = -904                                      20920099
209300         WHEN SQLCODE = -911                                      20930099
209400         WHEN SQLCODE = -913                                      20940099
209500              PERFORM 9900-SOFT-ABORT                             20950099
209600         WHEN OTHER                                               20960099
209700             MOVE '2165-DETERMINE-IF-PKSLIP-EXIST'                20970099
209800                                 TO DP013-PARAGRAPH               20980099
209900             MOVE 'SELECT COUNT ON RECITM'                        20990099
210000                                 TO DP013-MESSAGE-TEXT (1)        21000099
210100             MOVE SQLCA          TO DP013-SQLCA                   21010099
210200             MOVE 'TRECITM'      TO DP013-DB2-TABLE-NAME (1)      21020099
210300             PERFORM 9950-FORMAT-ERROR-MSG                        21030099
210400             SET DP013-DB2-ABEND                                  21040099
210500                             TO TRUE                              21050099
210600             SET DP013-XCTL-DISPLAY-RESTART                       21060099
210700                             TO TRUE                              21070099
210800             PERFORM DP013-0000-PROCESS-ABEND                     21080099
210900     END-EVALUATE.                                                21090099
211000                                                                  21100099
211100*----------------------------------------------------------------*21110099
211200*    CHECK PACK BY STORE                                         *21120099
211300*----------------------------------------------------------------*21130099
211400 2170-CHECK-PACK-BY-STORE.                                        21140099
211500     PERFORM 4100-PREPARE-CURSOR.                                 21150099
211600                                                                  21160099
211700     EXEC SQL                                                     21170099
211800          SELECT PACK_BY_ST_IND                                   21180099
211900            INTO :PS-PACK-BY-ST-SW                                21190099
212000            FROM TRECEIV                                          21200099
212100           WHERE ORD_NBR         =  :DK-ORD-NBR                   21210099
212200             AND REC_SEQ_NBR     =  :DK-RCVR-SEQ-NBR              21220099
212300             AND OPER_UNT_ID     =  :DK-OPR-ID                    21230099
212400             AND FCLTY_ID        =  :DK-FACT                      21240099
212500             AND VER_STATUS_CDE  =  'A'                           21250099
212600     END-EXEC.                                                    21260099
212700                                                                  21270099
212800     EVALUATE TRUE                                                21280099
212900         WHEN SQLCODE = ZERO                                      21290099
213000              CONTINUE                                            21300099
213100         WHEN SQLCODE = -904                                      21310099
213200         WHEN SQLCODE = -911                                      21320099
213300         WHEN SQLCODE = -913                                      21330099
213400              PERFORM 9900-SOFT-ABORT                             21340099
213500                                                                  21350099
213600         WHEN OTHER                                               21360099
213700              MOVE '2160-CHECK-PACK-BY-STORE'                     21370099
213800                               TO DP013-PARAGRAPH                 21380099
213900              MOVE 'SELECT TRECEIV'                               21390099
214000                               TO DP013-MESSAGE-TEXT (1)          21400099
214100              MOVE SQLCA       TO DP013-SQLCA                     21410099
214200              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        21420099
214300              PERFORM 9950-FORMAT-ERROR-MSG                       21430099
214400              SET DP013-DB2-ABEND                                 21440099
214500                               TO TRUE                            21450099
214600              PERFORM DP013-0000-PROCESS-ABEND                    21460099
214700     END-EVALUATE.                                                21470099
214800                                                                  21480099
214900                                                                  21490099
215000*----------------------------------------------------------------*21500099
215100*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *21510099
215200*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *21520099
215300*----------------------------------------------------------------*21530099
215400 2200-MOVE-SCREEN-TO-COMMAREA.                                    21540099
215500                                                                  21550099
215600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             21560099
215700     MOVE +1                       TO PV-SUB.                     21570099
215800                                                                  21580099
215900     PERFORM 3100-SET-SUBSCRIPTS.                                 21590099
216000                                                                  21600099
216100     IF  ASTRTITL > ZERO                                          21610099
216200         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      21620099
216300     ELSE                                                         21630099
216400         IF  ASTRTITF = DP015-ERASE-EOF                           21640099
216500             INITIALIZE ASC-START-ITEM-REQUEST                    21650099
216600         END-IF                                                   21660099
216700     END-IF.                                                      21670099
216800                                                                  21680099
216900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          21690099
217000         VARYING PV-SUB                                           21700099
217100         FROM 1 BY 1                                              21710099
217200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      21720099
217300                                                                  21730099
217400/                                                                 21740099
217500*----------------------------------------------------------------*21750099
217600*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *21760099
217700*----------------------------------------------------------------*21770099
217800 2210-MOVE-LINES-TO-COMMAREA.                                     21780099
217900                                                                  21790099
218000     IF  MR-SELECTL (PV-SUB) > ZERO                               21800099
218100         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     21810099
218200                                   TO TRUE                        21820099
218300         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        21830099
218400                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21840099
218500     ELSE                                                         21850099
218600         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                21860099
218700             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         21870099
218800             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        21880099
218900                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      21890099
219000         END-IF                                                   21900099
219100     END-IF.                                                      21910099
219200                                                                  21920099
219300     ADD +1                        TO ASC-ITEM-SUB.               21930099
219400                                                                  21940099
219500     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        21950099
219600         ADD +1                    TO ASC-BLK-SUB                 21960099
219700         MOVE +1                   TO ASC-ITEM-SUB                21970099
219800     END-IF.                                                      21980099
219900                                                                  21990099
220000/                                                                 22000099
220100******************************************************************22010099
220200* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *22020099
220300* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *22030099
220400******************************************************************22040099
220500 2300-GET-NEXT-RECORD.                                            22050099
220600                                                                  22060099
220700     ADD +1                        TO ASC-SEL-SUB.                22070099
220800     IF ASC-SEL-SUB > RC801-MAX-ITEMS                             22080099
220900         ADD +1                    TO ASC-SEL-ITEM                22090099
221000         MOVE +1                   TO ASC-SEL-SUB                 22100099
221100     END-IF.                                                      22110099
221200     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 22120099
221300         PERFORM 9100-READ-SEL-QUEUE                              22130099
221400         IF RC801-ITEM (ASC-SEL-SUB) > ZERO                       22140099
221500             INITIALIZE ASC-LIST-KEYS                             22150099
221600             MOVE RC800-REC-NBR-N                  TO ASC-PO-NBR  22160099
221700                                                      DK-ORD-NBR  22170099
221800             MOVE RC800-REC-SEQ-NBR-N               TO            22180099
221900                  ASC-REC-SEQ-NBR                                 22190099
222000                  DK-RCVR-SEQ-NBR                                 22200099
222100             MOVE RC800-OPER-UNIT-ID               TO             22210099
222200                  ASC-OPR-ID                                      22220099
222300                  DK-OPR-ID                                       22230099
222400             MOVE RC800-FACILITY-ID                TO             22240099
222500                  ASC-FACT                                        22250099
222600                  DK-FACT                                         22260099
222700             SET RC801-INQ (ASC-SEL-SUB)           TO TRUE        22270099
222800             PERFORM 9200-REWRITE-LIST-QUEUE                      22280099
222900         ELSE                                                     22290099
223000             SUBTRACT +1 FROM ASC-SEL-SUB                         22300099
223100*            --- BOTTOM OF LIST ---                               22310099
223200             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            22320099
223300             SET DP020-MSG-INFORMATIONAL                          22330099
223400                                   TO TRUE                        22340099
223500         END-IF                                                   22350099
223600     ELSE                                                         22360099
223700         SUBTRACT +1 FROM ASC-SEL-ITEM                            22370099
223800         MOVE RC801-MAX-ITEMS      TO ASC-SEL-SUB                 22380099
223900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            22390099
224000         SET DP020-MSG-INFORMATIONAL                              22400099
224100                                   TO TRUE                        22410099
224200     END-IF.                                                      22420099
224300                                                                  22430099
224400/                                                                 22440099
224500******************************************************************22450099
224600* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *22460099
224700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *22470099
224800******************************************************************22480099
224900 2310-GET-PREV-RECORD.                                            22490099
225000                                                                  22500099
225100     SUBTRACT +1 FROM ASC-SEL-SUB.                                22510099
225200     IF ASC-SEL-SUB < +1                                          22520099
225300         SUBTRACT +1 FROM ASC-SEL-ITEM                            22530099
225400         MOVE RC801-MAX-ITEMS      TO ASC-SEL-SUB                 22540099
225500     END-IF.                                                      22550099
225600                                                                  22560099
225700     IF ASC-SEL-ITEM > ZERO                                       22570099
225800         PERFORM 9100-READ-SEL-QUEUE                              22580099
225900         INITIALIZE ASC-LIST-KEYS                                 22590099
226000         MOVE RC800-REC-NBR-N           TO ASC-PO-NBR             22600099
226100         MOVE RC800-REC-SEQ-NBR-N       TO ASC-REC-SEQ-NBR        22610099
226200         MOVE RC800-OPER-UNIT-ID        TO ASC-OPR-ID             22620099
226300                                           DK-OPR-ID              22630099
226400         MOVE RC800-FACILITY-ID         TO ASC-FACT               22640099
226500                                           DK-FACT                22650099
226600     ELSE                                                         22660099
226700         MOVE +1                   TO ASC-SEL-ITEM                22670099
226800                                      ASC-SEL-SUB                 22680099
226900*        --- TOP OF LIST ---                                      22690099
227000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            22700099
227100         SET DP020-MSG-INFORMATIONAL                              22710099
227200                                   TO TRUE                        22720099
227300     END-IF.                                                      22730099
227400                                                                  22740099
227500/                                                                 22750099
227600******************************************************************22760099
227700* GET THE KEYS OF THE NEXT SELECTED PACKSLIP OBJECT FROM THE     *22770099
227800* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *22780099
227900******************************************************************22790099
228000 2400-GET-NEXT-PKSL-RECORD.                                       22800099
228100                                                                  22810099
228200     ADD +1                        TO ASC-SEL-SUB.                22820099
228300     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             22830099
228400         ADD +1                    TO ASC-SEL-ITEM                22840099
228500         MOVE +1                   TO ASC-SEL-SUB                 22850099
228600     END-IF.                                                      22860099
228700     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 22870099
228800         PERFORM 9300-READ-PKSL-SEL-QUEUE                         22880099
228900         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       22890099
229000             INITIALIZE ASC-LIST-KEYS                             22900099
229100             MOVE RC013-PO-NBR       (ASC-SEL-SUB) TO ASC-PO-NBR  22910099
229200                                                      DK-ORD-NBR  22920099
229300             MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO             22930099
229400                  ASC-REC-SEQ-NBR                                 22940099
229500                  DK-RCVR-SEQ-NBR                                 22950099
229600             MOVE RC013-OPER-UNT-ID (ASC-SEL-SUB)  TO             22960099
229700                  ASC-OPR-ID                                      22970099
229800                  DK-OPR-ID                                       22980099
229900             MOVE RC013-FCLTY-ID (ASC-SEL-SUB)     TO             22990099
230000                  ASC-FACT                                        23000099
230100                  DK-FACT                                         23010099
230200             SET RC013-INQ (ASC-SEL-SUB)           TO TRUE        23020099
230300             PERFORM 9400-REWRITE-PKSL-LIST-QUEUE                 23030099
230400* CHECK THE PACKAGING CODE                                        23040099
230500             PERFORM 1110-DETERMINE-PGKG-CODE                     23050099
230600             IF RECEIV-PKGNG-CDE NOT = 'M' AND 'I'                23060099
230700                SET PS-ERROR                                      23070099
230800                    DP020-MSG-FATAL                               23080099
230900                    DP020-NEXT-ACT-APPL-ERROR                     23090099
231000                                         TO TRUE                  23100099
231100                    MOVE PC-TSYMSG-02166 TO DP020-MSG-NUMBER      23110099
231200             END-IF                                               23120099
231300         ELSE                                                     23130099
231400             SUBTRACT +1 FROM ASC-SEL-SUB                         23140099
231500*            --- BOTTOM OF LIST ---                               23150099
231600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            23160099
231700             SET DP020-MSG-INFORMATIONAL                          23170099
231800                                   TO TRUE                        23180099
231900         END-IF                                                   23190099
232000     ELSE                                                         23200099
232100         SUBTRACT +1 FROM ASC-SEL-ITEM                            23210099
232200         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 23220099
232300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            23230099
232400         SET DP020-MSG-INFORMATIONAL                              23240099
232500                                   TO TRUE                        23250099
232600     END-IF.                                                      23260099
232700                                                                  23270099
232800/                                                                 23280099
232900******************************************************************23290099
233000* GET THE KEYS OF THE PREVIOUS SELECTED PACK SLIP OBJECT FROM THE*23300099
233100* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *23310099
233200******************************************************************23320099
233300 2410-GET-PREV-PKSL-RECORD.                                       23330099
233400                                                                  23340099
233500     SUBTRACT +1 FROM ASC-SEL-SUB.                                23350099
233600     IF ASC-SEL-SUB < +1                                          23360099
233700         SUBTRACT +1 FROM ASC-SEL-ITEM                            23370099
233800         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 23380099
233900     END-IF.                                                      23390099
234000                                                                  23400099
234100     IF ASC-SEL-ITEM > ZERO                                       23410099
234200         PERFORM 9300-READ-PKSL-SEL-QUEUE                         23420099
234300         INITIALIZE ASC-LIST-KEYS                                 23430099
234400         MOVE RC015-PO-NBR                     TO ASC-PO-NBR      23440099
234500         MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO                 23450099
234600              ASC-REC-SEQ-NBR                                     23460099
234700         MOVE RC015-OPER-UNT-ID                TO ASC-OPR-ID      23470099
234800                                                  DK-OPR-ID       23480099
234900         MOVE RC015-FCLTY-ID                   TO ASC-FACT        23490099
235000                                                  DK-FACT         23500099
235100     ELSE                                                         23510099
235200         MOVE +1                   TO ASC-SEL-ITEM                23520099
235300                                      ASC-SEL-SUB                 23530099
235400*        --- TOP OF LIST ---                                      23540099
235500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            23550099
235600         SET DP020-MSG-INFORMATIONAL                              23560099
235700                                   TO TRUE                        23570099
235800     END-IF.                                                      23580099
235900                                                                  23590099
236000/                                                                 23600099
236100                                                                  23610099
236200/                                                                 23620099
236300*----------------------------------------------------------------*23630099
236400*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *23640099
236500*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *23650099
236600*----------------------------------------------------------------*23660099
236700 3000-EDIT-DATA-IN-COMMAREA.                                      23670099
236800                                                                  23680099
236900     SET PS-NO-ERROR               TO TRUE.                       23690099
237000     PERFORM 3200-RESET-ATTRIBUTES.                               23700099
237100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     23710099
237200**                                                                23720099
237300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              23730099
237400* EDITTING IS DONE FROM THE BOTTOM UP.                            23740099
237500**                                                                23750099
237600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       23760099
237700         ASC-ITEMS-DISPLAYED - 1.                                 23770099
237800                                                                  23780099
237900     PERFORM 3100-SET-SUBSCRIPTS.                                 23790099
238000     PERFORM 3300-EDIT-SELECTIONS                                 23800099
238100         VARYING PV-SUB                                           23810099
238200         FROM PV-SUB BY -1                                        23820099
238300         UNTIL PV-SUB < +1.                                       23830099
238400                                                                  23840099
238500/                                                                 23850099
238600*----------------------------------------------------------------*23860099
238700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *23870099
238800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*23880099
238900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *23890099
239000*                                                                *23900099
239100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *23910099
239200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *23920099
239300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *23930099
239400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *23940099
239500*----------------------------------------------------------------*23950099
239600                                                                  23960099
239700 3100-SET-SUBSCRIPTS.                                             23970099
239800                                                                  23980099
239900     COMPUTE ASC-ITEM-SUB =                                       23990099
240000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        24000099
240100                                                                  24010099
240200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         24020099
240300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            24030099
240400                                                                  24040099
240500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              24050099
240600                                   TO ASC-BLK-SUB                 24060099
240700     ELSE                                                         24070099
240800         MOVE +1                   TO ASC-BLK-SUB                 24080099
240900     END-IF.                                                      24090099
241000                                                                  24100099
241100*----------------------------------------------------------------*24110099
241200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *24120099
241300*----------------------------------------------------------------*24130099
241400                                                                  24140099
241500 3200-RESET-ATTRIBUTES.                                           24150099
241600                                                                  24160099
241700     MOVE DP015-UNP-ALP-NOR-OFF       TO ASTRTITA.                24170099
241800     MOVE DP015-GREEN                 TO ASTRTITC.                24180099
241900     MOVE DP015-UNDERLINE             TO ASTRTITH.                24190099
242000                                                                  24200099
242100     PERFORM                                                      24210099
242200        VARYING PV-SUB                                            24220099
242300        FROM 1 BY 1                                               24230099
242400          UNTIL PV-SUB > PC-ITEMS-PER-PANEL                       24240099
242500            MOVE DP015-UNP-ALP-NOR-OFF                            24250099
242600                                      TO MR-SELECTA (PV-SUB)      24260099
242700            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      24270099
242800            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      24280099
242900     END-PERFORM.                                                 24290099
243000                                                                  24300099
243100/                                                                 24310099
243200*----------------------------------------------------------------*24320099
243300*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *24330099
243400*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *24340099
243500*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *24350099
243600*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *24360099
243700*----------------------------------------------------------------*24370099
243800 3300-EDIT-SELECTIONS.                                            24380099
243900                                                                  24390099
244000     EVALUATE TRUE                                                24400099
244100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24410099
244200             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         24420099
244300                 CONTINUE                                         24430099
244400                                                                  24440099
244500         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         24450099
244600             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        24460099
244700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS24470099
244800                 MOVE ASC-TEMP-SELECTED-SW                        24480099
244900                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24490099
245000                                   TO ASC-SELECTED-SW             24500099
245100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24510099
245200             END-IF                                               24520099
245300                                                                  24530099
245400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     24540099
245500                 = SPACE                                          24550099
245600             EVALUATE TRUE                                        24560099
245700                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       24570099
245800                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS24580099
245900                     MOVE SPACE    TO ASC-SELECTED-SW             24590099
246000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24600099
246100                                                                  24610099
246200                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        24620099
246300                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 24630099
246400                     MOVE SPACE    TO ASC-SELECTED-SW             24640099
246500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24650099
246600                                                                  24660099
246700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          24670099
246800                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   24680099
246900                     MOVE SPACE    TO ASC-SELECTED-SW             24690099
247000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24700099
247100             END-EVALUATE                                         24710099
247200                                                                  24720099
247300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           24730099
247400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24740099
247500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24750099
247600             END-IF                                               24760099
247700             PERFORM 3310-EDIT-RANGE                              24770099
247800                                                                  24780099
247900         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             24790099
248000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24800099
248100                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    24810099
248200             END-IF                                               24820099
248300             PERFORM 3310-EDIT-RANGE                              24830099
248400                                                                  24840099
248500         WHEN OTHER                                               24850099
248600             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            24860099
248700             SET DP020-MSG-FATAL   TO TRUE                        24870099
248800             MOVE -1               TO MR-SELECTL (PV-SUB)         24880099
248900             SET DP030-SET-CURSOR-APPL-1                          24890099
249000                                   TO TRUE                        24900099
249100             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         24910099
249200             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         24920099
249300             SET PS-ERROR          TO TRUE                        24930099
249400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            24940099
249500                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     24950099
249600                 MOVE SPACE        TO ASC-SELECTED-SW             24960099
249700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   24970099
249800             END-IF                                               24980099
249900     END-EVALUATE.                                                24990099
250000                                                                  25000099
250100     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             25010099
250200     SUBTRACT +1 FROM ASC-ITEM-SUB.                               25020099
250300                                                                  25030099
250400     IF  ASC-ITEM-SUB < 1                                         25040099
250500         SUBTRACT +1 FROM ASC-BLK-SUB                             25050099
250600         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                25060099
250700     END-IF.                                                      25070099
250800                                                                  25080099
250900*----------------------------------------------------------------*25090099
251000*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *25100099
251100*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *25110099
251200*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *25120099
251300*  THE ENDING.                                                   *25130099
251400*----------------------------------------------------------------*25140099
251500 3310-EDIT-RANGE.                                                 25150099
251600                                                                  25160099
251700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                25170099
251800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   25180099
251900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)25190099
252000                                   TO ASC-SELECTED-SW             25200099
252100                                        (ASC-BLK-SUB ASC-ITEM-SUB)25210099
252200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 25220099
252300         ELSE                                                     25230099
252400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     25240099
252500                 CONTINUE                                         25250099
252600             ELSE                                                 25260099
252700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        25270099
252800                 MOVE PC-TSYMSG-00054                             25280099
252900                                   TO DP020-MSG-NUMBER            25290099
253000                 SET DP020-MSG-FATAL                              25300099
253100                                   TO TRUE                        25310099
253200                 MOVE -1           TO MR-SELECTL (PV-SUB)         25320099
253300                 SET DP030-SET-CURSOR-APPL-1                      25330099
253400                                   TO TRUE                        25340099
253500                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         25350099
253600                 MOVE DP015-UNDERLINE                             25360099
253700                                   TO MR-SELECTH (PV-SUB)         25370099
253800                 SET PS-ERROR      TO TRUE                        25380099
253900             END-IF                                               25390099
254000         END-IF                                                   25400099
254100     ELSE                                                         25410099
254200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     25420099
254300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 25430099
254400                                   TO ASC-SELECTED-SW             25440099
254500                                     (ASC-BLK-SUB ASC-ITEM-SUB)   25450099
254600             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   25460099
254700         ELSE                                                     25470099
254800             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       25480099
254900                 CONTINUE                                         25490099
255000             ELSE                                                 25500099
255100*                -- ONLY ONE END-OF-RANGE ALLOWED --              25510099
255200                 MOVE PC-TSYMSG-00055                             25520099
255300                                   TO DP020-MSG-NUMBER            25530099
255400                 SET DP020-MSG-FATAL                              25540099
255500                                   TO TRUE                        25550099
255600                 MOVE -1           TO MR-SELECTL (PV-SUB)         25560099
255700                 SET DP030-SET-CURSOR-APPL-1                      25570099
255800                                   TO TRUE                        25580099
255900                 SET PS-ERROR      TO TRUE                        25590099
256000             END-IF                                               25600099
256100         END-IF                                                   25610099
256200     END-IF.                                                      25620099
256300                                                                  25630099
256400*----------------------------------------------------------------*25640099
256500*  IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,     *25650099
256600*  MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.   *25660099
256700*----------------------------------------------------------------*25670099
256800 3400-CHECK-RANGE-SEQUENCE.                                       25680099
256900                                                                  25690099
257000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       25700099
257100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      25710099
257200       AND  ASC-START-OF-SELECTED-RANGE >                         25720099
257300                                         ASC-END-OF-SELECTED-RANGE25730099
257400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                25740099
257500         MOVE PC-TSYMSG-00052      TO DP020-MSG-NUMBER            25750099
257600         SET DP020-MSG-FATAL       TO TRUE                        25760099
257700         SET PS-ERROR              TO TRUE                        25770099
257800         PERFORM 3410-POSITION-AT-ERROR                           25780099
257900     END-IF.                                                      25790099
258000                                                                  25800099
258100*----------------------------------------------------------------*25810099
258200*  BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE     *25820099
258300*  PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR  *25830099
258400*  SHOULD BE POSITIONED ON A RANGE ERROR.                        *25840099
258500*----------------------------------------------------------------*25850099
258600 3410-POSITION-AT-ERROR.                                          25860099
258700                                                                  25870099
258800     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       25880099
258900                                                                  25890099
259000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 25900099
259100                    - PV-TOP-ITEM + 1.                            25910099
259200                                                                  25920099
259300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25930099
259400         CONTINUE                                                 25940099
259500     ELSE                                                         25950099
259600         MOVE -1                   TO MR-SELECTL (PV-SUB)         25960099
259700         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         25970099
259800         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         25980099
259900     END-IF.                                                      25990099
260000                                                                  26000099
260100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   26010099
260200                    - PV-TOP-ITEM + 1.                            26020099
260300                                                                  26030099
260400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      26040099
260500         CONTINUE                                                 26050099
260600     ELSE                                                         26060099
260700         MOVE -1                   TO MR-SELECTL (PV-SUB)         26070099
260800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         26080099
260900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         26090099
261000     END-IF.                                                      26100099
261100                                                                  26110099
261200/                                                                 26120099
261300*----------------------------------------------------------------*26130099
261400*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *26140099
261500*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *26150099
261600*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *26160099
261700*----------------------------------------------------------------*26170099
261800                                                                  26180099
261900 3500-MARK-RANGE-AS-SELECTED.                                     26190099
262000                                                                  26200099
262100     MOVE +1                       TO ASC-BLK-SUB.                26210099
262200                                                                  26220099
262300     PERFORM 3510-MARK-SELECTED-INDS                              26230099
262400         VARYING ASC-ITEM-SUB                                     26240099
262500         FROM 1 BY 1                                              26250099
262600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26260099
262700                                                                  26270099
262800     ADD +1                        TO ASC-BLK-SUB.                26280099
262900                                                                  26290099
263000     PERFORM 3510-MARK-SELECTED-INDS                              26300099
263100         VARYING ASC-ITEM-SUB                                     26310099
263200         FROM 1 BY 1                                              26320099
263300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26330099
263400                                                                  26340099
263500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               26350099
263600                                   TO PV-LIST-ITEM-NUMBER.        26360099
263700                                                                  26370099
263800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26380099
263900         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         26390099
264000               PC-ITEMS-PER-PANEL).                               26400099
264100                                                                  26410099
264200     MOVE ASC-START-OF-SELECTED-RANGE                             26420099
264300                                   TO PV-START-OF-SELECTED-RANGE. 26430099
264400                                                                  26440099
264500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            26450099
264600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  26460099
264700               PC-ITEMS-PER-PANEL).                               26470099
264800                                                                  26480099
264900     MOVE ASC-END-OF-SELECTED-RANGE                               26490099
265000                                   TO PV-END-OF-SELECTED-RANGE.   26500099
265100                                                                  26510099
265200     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             26520099
265300         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    26530099
265400               PC-ITEMS-PER-PANEL).                               26540099
265500                                                                  26550099
265600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             26560099
265700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             26570099
265800                                                                  26580099
265900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    26590099
266000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        26600099
266100         MOVE +1                   TO ASC-BLK-SUB                 26610099
266200         PERFORM 5100-WRITE-TEMP-STORAGE                          26620099
266300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26630099
266400             PV-FIRST-BLOCK-IN-ARRAY - 1                          26640099
266500                                                                  26650099
266600         PERFORM                                                  26660099
266700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      26670099
266800                   PV-PREV-BLOCK-IN-ARRAY                         26680099
266900             MOVE PV-FIRST-BLOCK-IN-RANGE                         26690099
267000                                   TO PV-BLOCK-NUMBER             26700099
267100             PERFORM 4410-READ-TEMP-STORAGE                       26710099
267200             PERFORM 3510-MARK-SELECTED-INDS                      26720099
267300                 VARYING ASC-ITEM-SUB                             26730099
267400                 FROM 1 BY 1                                      26740099
267500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26750099
267600             PERFORM 5100-WRITE-TEMP-STORAGE                      26760099
267700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     26770099
267800         END-PERFORM                                              26780099
267900                                                                  26790099
268000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         26800099
268100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     26810099
268200         PERFORM                                                  26820099
268300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       26830099
268400                   PV-LAST-BLOCK-IN-RANGE                         26840099
268500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          26850099
268600                                   TO PV-BLOCK-NUMBER             26860099
268700             PERFORM 4410-READ-TEMP-STORAGE                       26870099
268800             PERFORM 3510-MARK-SELECTED-INDS                      26880099
268900                 VARYING ASC-ITEM-SUB                             26890099
269000                 FROM 1 BY 1                                      26900099
269100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          26910099
269200             PERFORM 5100-WRITE-TEMP-STORAGE                      26920099
269300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      26930099
269400         END-PERFORM                                              26940099
269500                                                                  26950099
269600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             26960099
269700                                   TO PV-BLOCK-NUMBER             26970099
269800         PERFORM 4410-READ-TEMP-STORAGE                           26980099
269900     END-IF.                                                      26990099
270000                                                                  27000099
270100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 27010099
270200                                      ASC-END-OF-SELECTED-RANGE.  27020099
270300                                                                  27030099
270400/                                                                 27040099
270500*----------------------------------------------------------------*27050099
270600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *27060099
270700*----------------------------------------------------------------*27070099
270800                                                                  27080099
270900 3510-MARK-SELECTED-INDS.                                         27090099
271000                                                                  27100099
271100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) >         27110099
271200         ASC-START-OF-SELECTED-RANGE)                             27120099
271300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =         27130099
271400         ASC-START-OF-SELECTED-RANGE)                             27140099
271500                                                                  27150099
271600         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) <     27160099
271700             ASC-END-OF-SELECTED-RANGE)                           27170099
271800         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB) =     27180099
271900             ASC-END-OF-SELECTED-RANGE)                           27190099
272000                                                                  27200099
272100             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27210099
272200                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   27220099
272300                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   27230099
272400                                   TO TRUE                        27240099
272500                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              27250099
272600                                   TO TRUE                        27260099
272700                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS27270099
272800             END-IF                                               27280099
272900         END-IF                                                   27290099
273000     END-IF.                                                      27300099
273100                                                                  27310099
273200/                                                                 27320099
273201 3600-CHECK-WMS.                                                  27320199
273202     PERFORM 3601-CHECK-TKRPRPM-ASNDWN.                           27320299
273205     IF PS-ASNS-TO-WMS-YES                                        27320599
273206        PERFORM 3602-GET-TRIP                                     27320699
273207        PERFORM 3603-GET-SHPMT-XREF                               27320799
273210     ELSE                                                         27321099
273211        SET PS-RECEIVING-BEGUN-NO TO TRUE                         27321199
273212     END-IF.                                                      27321299
273213                                                                  27321399
273214 3601-CHECK-TKRPRPM-ASNDWN.                                       27321499
273215                                                                  27321599
273216     MOVE ASC-OPR-ID TO KRPRPM-LOC-ID.                            27321699
273217                                                                  27321799
273218     EXEC SQL                                                     27321899
273219          SELECT   FUNC_TXT                                       27321999
273220            INTO  :KRPRPM-FUNC-TXT                                27322099
273221            FROM                                                  27322199
273222                  TKRPRPM A                                       27322299
273223            WHERE                                                 27322399
273224                  LOC_ID            = :KRPRPM-LOC-ID              27322499
273225              AND SYS_PRC_FUNC_CDE  = 'ASNDWN'                    27322599
273226              AND FUNC_PRC_STAT_CDE = 'AC'                        27322699
273227              AND INTFC_SYS_CDE     = 'KHL'                       27322799
273228              AND FUNC_TXT          = 'Y'                         27322899
273229              AND FUNC_BEG_TMST    < CURRENT TIMESTAMP            27322999
273230     END-EXEC.                                                    27323099
273231     EVALUATE TRUE                                                27323199
273232         WHEN SQLCODE = ZERO                                      27323299
273233              SET PS-ASNS-TO-WMS-YES    TO TRUE                   27323399
273234         WHEN SQLCODE = +100                                      27323499
273235              SET PS-ASNS-TO-WMS-NO  TO TRUE                      27323599
273236         WHEN SQLWARN0 NOT = SPACES                               27323699
273237         WHEN SQLCODE  NOT = ZERO                                 27323799
273238             MOVE 'TKRPRPM     ' TO DP013-DB2-TABLE-NAME (1)      27323899
273239             SET DP013-DB2-ABEND                                  27323999
273240                                 TO TRUE                          27324099
273241             SET DP013-XCTL-DISPLAY-RESTART                       27324199
273242                                 TO TRUE                          27324299
273243             PERFORM DP013-0000-PROCESS-ABEND                     27324399
273244     END-EVALUATE.                                                27324499
273245                                                                  27324599
273246/                                                                 27324699
273247 3602-GET-TRIP.                                                   27324799
273248                                                                  27324899
273249     MOVE ASC-PO-NBR TO SHPTPO-PO-NBR.                            27324999
273250     MOVE ASC-REC-SEQ-NBR TO SHPTPO-REC-SEQ-NBR.                  27325099
273251                                                                  27325199
273252     EXEC SQL                                                     27325299
273253          SELECT  B.TRIP_ID, B.SHIPT_ID                           27325399
273254            INTO  :SHIPMT-TRIP-ID                                 27325499
273255                , :SHIPMT-SHIPT-ID                                27325599
273256            FROM  TSHPTPO A,                                      27325699
273257                  TSHIPMT B                                       27325799
273258            WHERE A.PO_NBR = :SHPTPO-PO-NBR AND                   27325899
273259                  A.REC_SEQ_NBR = :SHPTPO-REC-SEQ-NBR AND         27325999
273260                  A.SHIPT_ID = B.SHIPT_ID AND                     27326099
273261                  A.PRIM_SHIPT_IND = 'Y'                          27326199
273262     END-EXEC.                                                    27326299
273263         EVALUATE TRUE                                            27326399
273264             WHEN SQLCODE = +0                                    27326499
273265                 MOVE SHIPMT-TRIP-ID TO WST00001-INTR-TRIP-ID     27326599
273267             WHEN SQLCODE = +100                                  27326799
273268             WHEN SQLCODE = -811                                  27326899
273269             WHEN SQLCODE = -904                                  27326999
273270             WHEN SQLCODE = -913                                  27327099
273271                 CONTINUE                                         27327199
273272                                                                  27327299
273273             WHEN SQLWARN0 NOT = SPACE                            27327399
273274             WHEN SQLCODE < +0                                    27327499
273275             WHEN SQLCODE > +0                                    27327599
273276                 MOVE '2500-GET-SHIPMENT-INFO'                    27327699
273277                                 TO DP013-PARAGRAPH               27327799
273278                 MOVE 'SELECT SHIPMENT TABLE'                     27327899
273279                                 TO DP013-MESSAGE-TEXT (1)        27327999
273280                 MOVE SQLCA      TO DP013-SQLCA                   27328099
273281                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      27328199
273282                 MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (2)      27328299
273283                 SET DP013-DB2-ABEND                              27328399
273284                                 TO TRUE                          27328499
273285                 SET DP013-XCTL-DISPLAY-RESTART                   27328599
273286                                 TO TRUE                          27328699
273287                 PERFORM DP013-0000-PROCESS-ABEND                 27328799
273288         END-EVALUATE.                                            27328899
273289/                                                                 27328999
273290 3603-GET-SHPMT-XREF.                                             27329099
273293                                                                  27329399
273294         EXEC SQL                                                 27329499
273295            SELECT  A.RCPT_TMST                                   27329599
273296              INTO :WST00001-RCPT-TMST                            27329699
273297              FROM  WST_SHPMT_XREF_HDR A                          27329799
273298          WHERE A.INTR_TRIP_ID = :WST00001-INTR-TRIP-ID           27329899
273299            AND A.SOR_CDE      = 'RC'                             27329999
273300            AND A.RCPT_TMST  <> :PC-DEFAULT-TMST                  27330099
273301         END-EXEC                                                 27330199
273302                                                                  27330299
273303         EVALUATE TRUE                                            27330399
273304             WHEN SQLCODE = +0                                    27330499
273305             WHEN SQLCODE = -811                                  27330599
273306                 SET PS-RECEIVING-BEGUN-YES TO TRUE               27330699
273307             WHEN SQLCODE = +100                                  27330799
273308                 SET PS-RECEIVING-BEGUN-NO TO TRUE                27330899
273309             WHEN SQLCODE = -904                                  27330999
273310             WHEN SQLCODE = -913                                  27331099
273311                 CONTINUE                                         27331199
273312             WHEN SQLWARN0 NOT = SPACE                            27331299
273313             WHEN SQLCODE < +0                                    27331399
273314             WHEN SQLCODE > +0                                    27331499
273315                 MOVE '2600-SELECT-WST-XREF '                     27331599
273316                                 TO DP013-PARAGRAPH               27331699
273317                 MOVE 'SELECT SHIPMENT TABLE'                     27331799
273318                                 TO DP013-MESSAGE-TEXT (1)        27331899
273319                 MOVE SQLCA      TO DP013-SQLCA                   27331999
273320                 MOVE 'WST_SHPMT_XREF' TO DP013-DB2-TABLE-NAME (1)27332099
273321                 SET DP013-DB2-ABEND                              27332199
273322                                 TO TRUE                          27332299
273323                 SET DP013-XCTL-DISPLAY-RESTART                   27332399
273324                                 TO TRUE                          27332499
273325                 PERFORM DP013-0000-PROCESS-ABEND                 27332599
273326         END-EVALUATE.                                            27332699
273327/                                                                 27332799
273328*----------------------------------------------------------------*27332899
273329* LINK TO WMS VENDOR SHIPMENT CONTROL MODULE (WSKUT005) USING     27332999
273330*  COPYBOOK WSWS001.                                              27333099
273331*----------------------------------------------------------------*27333199
273332 3604-CALL-WMS-MODULE.                                            27333299
273333                                                                  27333399
273334     SET WS001-PKSLIP-INACTIVE TO TRUE.                           27333499
273335     MOVE SHIPMT-TRIP-ID TO WS001-TRIP-ID.                        27333599
273336     MOVE ASC-OPR-ID TO WS001-OPER-UNT-ID.                        27333699
273337     MOVE DP020-USERID TO WS001-USER-ID.                          27333799
273338     MOVE ASC-PO-NBR TO WS001-PO-NBR.                             27333899
273339     MOVE ASC-REC-SEQ-NBR TO WS001-RCVR-NBR.                      27333999
273340     MOVE DK-PACK-ID TO WS001-PREPK-ID.                           27334099
273341     MOVE ZEROS TO WS001-SKU-NBR.                                 27334199
273342     MOVE ZEROS TO WS001-KOHLS-SHIPT-ID.                          27334299
273343     MOVE 'RC' TO WS001-SHIPMENT-SOURCE.                          27334399
273344     MOVE SPACES TO WS001-DTL-ASN-LEVEL-IND.                      27334499
273345     MOVE DP020-SRC-TASK-NUMBER TO WS001-SRC-TASK-NUMBER.         27334599
273346     MOVE PC-CURRENT-PROGRAM-NAME TO WS001-CALLING-PROGRAM-NAME.  27334699
273347                                                                  27334799
273348     MOVE LENGTH OF WS001-FIELDS  TO  PV-COMMAREA-LENGTH.         27334899
273349                                                                  27334999
273350     EXEC CICS                                                    27335099
273351         LINK PROGRAM  (PC-WMS-CONTROL-MOD)                       27335199
273352              COMMAREA (WS001-FIELDS)                             27335299
273353              LENGTH   (PV-COMMAREA-LENGTH)                       27335399
273354     END-EXEC.                                                    27335499
273360     EVALUATE TRUE                                                27336099
273370         WHEN WS001-SUCCESSFUL                                    27337099
273380              CONTINUE                                            27338099
273390         WHEN WS001-DATABASE-BUSY OR                              27339099
273400              WS001-INVALID-SQL                                   27340099
273410                  MOVE PC-TSYMSG-03546  TO DP020-MSG-NUMBER       27341099
273420                  SET DP020-MSG-WARNING TO TRUE                   27342099
273421                  SET DP030-OVERRIDE-GO TO TRUE                   27342199
273422                  SET PS-ERROR          TO TRUE                   27342299
273423                                                                  27342399
273424                                                                  27342499
273425              INITIALIZE PV-CICS-MSG-AREA                         27342599
273426              STRING 'RCKCS800-'                                  27342699
273427                     '3603-CALL-WMS-MODULE - '                    27342799
273428                                           DELIMITED BY SIZE      27342899
273429                                      INTO PV-CICS-MSG-AREA       27342999
273430              PERFORM 9903-WRITE-CICS-LOG                         27343099
273431                                                                  27343199
273432              INITIALIZE PV-CICS-MSG-AREA                         27343299
273433              STRING 'RCKCS800-'                                  27343399
273434                     WS001-CRA-RET-MSG                            27343499
273435                                           DELIMITED BY SIZE      27343599
273436                                      INTO PV-CICS-MSG-AREA       27343699
273437              PERFORM 9903-WRITE-CICS-LOG                         27343799
273438                                                                  27343899
273439                                                                  27343999
273440         WHEN WS001-ERROR                                         27344099
273441                  MOVE PC-TSYMSG-03138  TO DP020-MSG-NUMBER       27344199
273442                  SET DP020-MSG-WARNING TO TRUE                   27344299
273443                  SET DP030-OVERRIDE-GO TO TRUE                   27344399
273444                  SET PS-ERROR          TO TRUE                   27344499
273445                                                                  27344599
273446              INITIALIZE PV-CICS-MSG-AREA                         27344699
273447              STRING 'RCKCS800-'                                  27344799
273448                     '3603-CALL-WMS-MODULE - '                    27344899
273449                                           DELIMITED BY SIZE      27344999
273450                                      INTO PV-CICS-MSG-AREA       27345099
273451              PERFORM 9903-WRITE-CICS-LOG                         27345199
273452                                                                  27345299
273453              INITIALIZE PV-CICS-MSG-AREA                         27345399
273454              STRING 'RCKCS800-'                                  27345499
273455                     WS001-CRA-RET-MSG                            27345599
273456                                           DELIMITED BY SIZE      27345699
273457                                      INTO PV-CICS-MSG-AREA       27345799
273458              PERFORM 9903-WRITE-CICS-LOG                         27345899
273459                                                                  27345999
273460         WHEN OTHER                                               27346099
273461                                                                  27346199
273462              INITIALIZE PV-CICS-MSG-AREA                         27346299
273463              STRING 'RCKCS800-'                                  27346399
273464                     '3603-CALL-WMS-MODULE - '                    27346499
273465                                           DELIMITED BY SIZE      27346599
273466                                      INTO PV-CICS-MSG-AREA       27346699
273467              PERFORM 9903-WRITE-CICS-LOG                         27346799
273468                                                                  27346899
273469              INITIALIZE PV-CICS-MSG-AREA                         27346999
273470              STRING 'RCKCS800-'                                  27347099
273471                     WS001-CRA-RET-MSG                            27347199
273472                                           DELIMITED BY SIZE      27347299
273473                                      INTO PV-CICS-MSG-AREA       27347399
273474              PERFORM 9903-WRITE-CICS-LOG                         27347499
273475                                                                  27347599
273476             MOVE '3603-CALL-WMS-MODULE' TO DP013-PARAGRAPH       27347699
273477             MOVE 'UNSUCCESSFUL CALL TO WMS  MOD'                 27347799
273478                                         TO DP013-MESSAGE-TEXT (1)27347899
273479             MOVE WS001-SUCCESS-IND      TO DP013-MESSAGE-TEXT (2)27347999
273480*            MOVE WS001-SQLCA            TO DP013-SQLCA           27348099
273481             SET DP013-DB2-ABEND                                  27348199
273482                 DP013-XCTL-DISPLAY-RESTART  TO TRUE              27348299
273483             SET PS-ERROR                    TO TRUE              27348399
273484             PERFORM DP013-0000-PROCESS-ABEND                     27348499
273485                                                                  27348599
273486     END-EVALUATE.                                                27348699
273487/                                                                 27348799
273488*----------------------------------------------------------------*27348899
273490*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *27349099
273500*    INITIALIZE ALL COUNTERS AND FLAGS.                          *27350099
273600*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *27360099
273700*    DISPLAY THE PANEL TO USER.                                  *27370099
273800*----------------------------------------------------------------*27380099
273900                                                                  27390099
274000 4000-BUILD-INITIAL-PANEL.                                        27400099
274100                                                                  27410099
274200     INITIALIZE ASC-BLOCK-ENTRIES (1)                             27420099
274300                ASC-BLOCK-ENTRIES (2).                            27430099
274400                                                                  27440099
274500     MOVE +1                       TO ASC-BLK-SUB.                27450099
274600                                                                  27460099
274700     SET ASC-ITEMS-LEFT-ON-DB                                     27470099
274800         ASC-REDISTRO-OK           TO TRUE.                       27480099
274900                                                                  27490099
275000     MOVE +0                       TO ASC-ITEM-SUB                27500099
275100                                      ASC-NUMBER-OF-ITEMS-READ    27510099
275200                                      ASC-NUMBER-OF-SELECTED-ITEMS27520099
275300                                      ASC-HIGHEST-BLOCK-WRITTEN   27530099
275400                                      ASC-START-OF-SELECTED-RANGE 27540099
275500                                      ASC-END-OF-SELECTED-RANGE   27550099
275600                                      ASC-ITEM-AT-TOP-OF-PANEL.   27560099
275700                                                                  27570099
275800     MOVE SPACES                   TO ASC-PACKAGE-TYPE-CDE.       27580099
275900                                                                  27590099
276000     PERFORM 4100-PREPARE-CURSOR.                                 27600099
276100     PERFORM 4355-GET-TRECEIV-INFO.                               27610099
276200     EVALUATE TRUE                                                27620099
276300         WHEN SQLCODE = +100                                      27630099
276400              MOVE PC-PKG-TYP-NOT-FOUND TO ASC-PACKAGE-TYPE-CDE   27640099
276500         WHEN SQLCODE = +0                                        27650099
276600              PERFORM 4360-GET-TPURCHS-INFO                       27660099
276700              EVALUATE TRUE                                       27670099
276800                  WHEN SQLCODE = +100                             27680099
276900                       MOVE PC-PKG-TYP-NOT-FOUND                  27690099
277000                                        TO ASC-PACKAGE-TYPE-CDE   27700099
277100                  WHEN SQLCODE = +0                               27710099
277200                       PERFORM 4200-TROUBLE-DESC                  27720099
277300                       PERFORM 4100-PREPARE-CURSOR                27730099
277400                       SET ASC-PO-PACK-MADE                       27740099
277500                                  TO TRUE                         27750099
277600                       PERFORM 4010-OPEN-CURSOR                   27760099
277700                       PERFORM 4300-READ-ITEMS-FROM-DB            27770099
277800                       PERFORM 4020-CLOSE-CURSOR                  27780099
277900                       PERFORM 4100-PREPARE-CURSOR                27790099
278000                       SET ASC-NINETY-NINE-CK                     27800099
278100                           ASC-ITEMS-LEFT-ON-DB                   27810099
278200                                  TO TRUE                         27820099
278300                       SET ASC-BLOCK-MODIFIED(1)                  27830099
278400                           ASC-BLOCK-MODIFIED(2)                  27840099
278500                                  TO TRUE                         27850099
278600                       PERFORM 4010-OPEN-CURSOR                   27860099
278700                       PERFORM 4300-READ-ITEMS-FROM-DB            27870099
278800                       PERFORM 4020-CLOSE-CURSOR                  27880099
278900                       PERFORM 4005-MOVE-DATA-TO-ASC              27890099
279000              END-EVALUATE                                        27900099
279100     END-EVALUATE.                                                27910099
279200                                                                  27920099
279300     MOVE +1                       TO PV-TOP-ITEM.                27930099
279400                                                                  27940099
279500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          27950099
279600         SET DP020-NEXT-ACT-APPL-ERROR                            27960099
279700                                   TO TRUE                        27970099
279800         SET DP020-MSG-FATAL       TO TRUE                        27980099
279900         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            27990099
280000     ELSE                                                         28000099
280100         MOVE -1                   TO MR-SELECTL (1)              28010099
280200         SET DP030-SET-CURSOR-APPL-1                              28020099
280300                                   TO TRUE                        28030099
280400         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     28040099
280500     END-IF.                                                      28050099
280600                                                                  28060099
280700                                                                  28070099
280800/                                                                 28080099
280900*----------------------------------------------------------------*28090099
281000* MOVES THE DATA RETRIEVED TO THE ASC FIELDS                     *28100099
281100*----------------------------------------------------------------*28110099
281200                                                                  28120099
281300 4005-MOVE-DATA-TO-ASC.                                           28130099
281400                                                                  28140099
281500     IF RECEIV-PKGNG-CDE > SPACES                                 28150099
281600         MOVE RECEIV-PKGNG-CDE     TO ASC-PACKAGE-TYPE-CDE        28160099
281700     ELSE                                                         28170099
281800         MOVE PURCHS-PKGNG-CDE     TO ASC-PACKAGE-TYPE-CDE        28180099
281900     END-IF.                                                      28190099
282000                                                                  28200099
282100     MOVE RECEIV-STATUS-CDE        TO ASC-STAT.                   28210099
282200     MOVE RECEIV-EXPTED-CART-CNT   TO ASC-TRECEIV-EXPTD-CART-QTY. 28220099
282300     MOVE RECEIV-ACTL-CART-CNT     TO ASC-TRECEIV-ACTL-CART-QTY.  28230099
282400     MOVE POPRPK-PREPK-DESC        TO ASC-PREPACK-DESC.           28240099
282500                                                                  28250099
282600/                                                                 28260099
282700*----------------------------------------------------------------*28270099
282800* OPEN THE PO ITEM  CURSOR                                       *28280099
282900*----------------------------------------------------------------*28290099
283000 4010-OPEN-CURSOR.                                                28300099
283100                                                                  28310099
283200         IF ASC-NINETY-NINE-CK                                    28320099
283300            EXEC SQL                                              28330099
283400                OPEN PK-NINETY-NINE-CSR                           28340099
283500            END-EXEC                                              28350099
283600         ELSE                                                     28360099
283700            EXEC SQL                                              28370099
283800                OPEN TPURITM-CSR                                  28380099
283900            END-EXEC                                              28390099
284000         END-IF                                                   28400099
284100                                                                  28410099
284200         EVALUATE TRUE                                            28420099
284300             WHEN SQLCODE = +0                                    28430099
284400                  CONTINUE                                        28440099
284500             WHEN SQLCODE = -904                                  28450099
284600             WHEN SQLCODE = -911                                  28460099
284700             WHEN SQLCODE = -913                                  28470099
284800                  PERFORM 9900-SOFT-ABORT                         28480099
284900             WHEN OTHER                                           28490099
285000                  MOVE '4010-OPEN-CURSOR'                         28500099
285100                                   TO DP013-PARAGRAPH             28510099
285200                  MOVE 'OPEN CURSOR'                              28520099
285300                                   TO DP013-MESSAGE-TEXT (1)      28530099
285400                  MOVE SQLCA       TO DP013-SQLCA                 28540099
285500                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)    28550099
285600                  PERFORM 9950-FORMAT-ERROR-MSG                   28560099
285700                  SET DP013-DB2-ABEND                             28570099
285800                                   TO TRUE                        28580099
285900                  PERFORM DP013-0000-PROCESS-ABEND                28590099
286000         END-EVALUATE.                                            28600099
286100/                                                                 28610099
286200*----------------------------------------------------------------*28620099
286300* CLOSE THE PO ITEM  CURSOR                                      *28630099
286400*----------------------------------------------------------------*28640099
286500 4020-CLOSE-CURSOR.                                               28650099
286600                                                                  28660099
286700     IF ASC-NINETY-NINE-CK                                        28670099
286800        EXEC SQL                                                  28680099
286900             CLOSE PK-NINETY-NINE-CSR                             28690099
287000        END-EXEC                                                  28700099
287100     ELSE                                                         28710099
287200        EXEC SQL                                                  28720099
287300             CLOSE TPURITM-CSR                                    28730099
287400        END-EXEC.                                                 28740099
287500                                                                  28750099
287600     EVALUATE TRUE                                                28760099
287700         WHEN SQLCODE = +0                                        28770099
287800              CONTINUE                                            28780099
287900         WHEN SQLCODE = -904                                      28790099
288000         WHEN SQLCODE = -911                                      28800099
288100         WHEN SQLCODE = -913                                      28810099
288200              PERFORM 9900-SOFT-ABORT                             28820099
288300         WHEN OTHER                                               28830099
288400              MOVE '4020-CLOSE-CURSOR'                            28840099
288500                                   TO DP013-PARAGRAPH             28850099
288600              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      28860099
288700              MOVE SQLCA           TO DP013-SQLCA                 28870099
288800              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    28880099
288900              PERFORM 9950-FORMAT-ERROR-MSG                       28890099
289000              SET DP013-DB2-ABEND  TO TRUE                        28900099
289100              PERFORM DP013-0000-PROCESS-ABEND                    28910099
289200     END-EVALUATE.                                                28920099
289300                                                                  28930099
289400/                                                                 28940099
289500*----------------------------------------------------------------*28950099
289600*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *28960099
289700*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *28970099
289800*----------------------------------------------------------------*28980099
289900 4100-PREPARE-CURSOR.                                             28990099
290000                                                                  29000099
290100     MOVE ASC-PO-NBR       TO DK-ORD-NBR                          29010099
290200     MOVE ASC-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR.                    29020099
290300     MOVE ASC-OPR-ID       TO DK-OPR-ID                           29030099
290400     MOVE ASC-FACT         TO DK-FACT.                            29040099
290500                                                                  29050099
290600/                                                                 29060099
290700***************************************************************   29070099
290800** RETRIEVE BOTH THE TROUBLE SHORT DESC AND THE LONG DESC.  THE   29080099
290900** SHORT DESC WILL BE DISPLAYED ON THIS SCREEN, THE LONG DESC     29090099
291000** WILL BE PASSED TO OTHER PROGRAMS FOR DISPLAY.                  29100099
291100**************************************************************    29110099
291200 4200-TROUBLE-DESC.                                               29120099
291300                                                                  29130099
291400     EXEC SQL                                                     29140099
291500         SELECT B.TRBL_SHT_DESC                                   29150099
291600               ,B.TRBL_LONG_DESC                                  29160099
291700         INTO :TRBRSN-TRBL-SHT-DESC                               29170099
291800             ,:TRBRSN-TRBL-LONG-DESC                              29180099
291900         FROM  TTRBNTF A                                          29190099
292000              ,TTRBRSN B                                          29200099
292100         WHERE A.OPER_UNT_ID          = :DK-OPR-ID                29210099
292200               AND A.FCLTY_ID         = :DK-FACT                  29220099
292300               AND A.PO_NBR           = :DK-ORD-NBR               29230099
292400               AND A.PO_LNE_NBR       = 0                         29240099
292500               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          29250099
292600               AND A.RESOLVED_IND    IN (:PC-N, :PC-I)            29260099
292700               AND A.TRBL_RSN_CDE     = B.TRBL_RSN_CDE            29270099
292800               AND A.PREPK_ID         = 0                         29280099
292900     END-EXEC                                                     29290099
293000                                                                  29300099
293100     EVALUATE TRUE                                                29310099
293200         WHEN SQLCODE = +0                                        29320099
293300             MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUB-STATUS        29330099
293400         WHEN SQLCODE = -811                                      29340099
293500             STRING TRBRSN-TRBL-SHT-DESC '*'                      29350099
293600                 DELIMITED BY SIZE                                29360099
293700                 INTO ASC-TROUB-STATUS                            29370099
293800         WHEN SQLCODE = +100                                      29380099
293900             MOVE SPACES                   TO ASC-TROUB-STATUS    29390099
294000         WHEN SQLCODE = -904                                      29400099
294100         WHEN SQLCODE = -911                                      29410099
294200         WHEN SQLCODE = -913                                      29420099
294300             PERFORM 9900-SOFT-ABORT                              29430099
294400                                                                  29440099
294500         WHEN OTHER                                               29450099
294600             MOVE '4200-TROUBLE-DESC'                             29460099
294700                             TO DP013-PARAGRAPH                   29470099
294800             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     29480099
294900                             TO DP013-MESSAGE-TEXT (1)            29490099
295000             MOVE SQLCA          TO DP013-SQLCA                   29500099
295100             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      29510099
295200             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      29520099
295300             PERFORM 9950-FORMAT-ERROR-MSG                        29530099
295400             SET DP013-DB2-ABEND                                  29540099
295500                             TO TRUE                              29550099
295600             SET DP013-XCTL-DISPLAY-RESTART                       29560099
295700                             TO TRUE                              29570099
295800             PERFORM DP013-0000-PROCESS-ABEND                     29580099
295900     END-EVALUATE.                                                29590099
296000                                                                  29600099
296100/                                                                 29610099
296200*----------------------------------------------------------------*29620099
296300*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29630099
296400*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29640099
296500*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29650099
296600*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29660099
296700*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29670099
296800*                                                                *29680099
296900*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29690099
297000*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29700099
297100*    UPON INITIALIZATION.                                        *29710099
297200*----------------------------------------------------------------*29720099
297300                                                                  29730099
297400 4300-READ-ITEMS-FROM-DB.                                         29740099
297500                                                                  29750099
297600     PERFORM                                                      29760099
297700         VARYING PV-READ-COUNT                                    29770099
297800         FROM 1 BY 1                                              29780099
297900         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29790099
298000            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29800099
298100                                                                  29810099
298200         PERFORM 4310-FETCH                                       29820099
298300         MOVE DK-PACK-ID            TO PV-CURR-PACK-ID            29830099
298400                                                                  29840099
298500         IF  ASC-ITEMS-LEFT-ON-DB                                 29850099
298600            IF PV-PREV-PACK-ID  = PV-CURR-PACK-ID                 29860099
298700               IF RECITM-STATUS-CDE = 'IP'                        29870099
298800                  MOVE 'Y'            TO PV-FOUND-LINE-STATUS-IP  29880099
298900               ELSE                                               29890099
299000                  IF RECITM-STATUS-CDE = 'CM'                     29900099
299100                     MOVE 'Y'         TO PV-FOUND-LINE-STATUS-CM  29910099
299200                  ELSE                                            29920099
299300                     IF RECITM-STATUS-CDE = 'VE'                  29930099
299400                        MOVE 'Y'      TO PV-FOUND-LINE-STATUS-VE  29940099
299500                     END-IF                                       29950099
299600                  END-IF                                          29960099
299700               END-IF                                             29970099
299800            ELSE                                                  29980099
299900               IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL              29990099
300000                   ADD +1            TO ASC-ITEM-SUB              30000099
300100               ELSE                                               30010099
300200                   ADD +1            TO ASC-BLK-SUB               30020099
300300                   MOVE +1           TO ASC-ITEM-SUB              30030099
300400                                                                  30040099
300500                   IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY       30050099
300600                       MOVE +1       TO ASC-BLK-SUB               30060099
300700                       SET ASC-BLOCK-MODIFIED (1)                 30070099
300800                                   TO TRUE                        30080099
300900                       PERFORM 5100-WRITE-TEMP-STORAGE            30090099
301000                       MOVE ASC-BLOCK-ENTRIES                     30100099
301100                               (PC-MAX-BLOCKS-IN-ARRAY)           30110099
301200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 30120099
301300                       ADD +1        TO ASC-BLK-SUB               30130099
301400                       INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB) 30140099
301500                       SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)    30150099
301600                                   TO TRUE                        30160099
301700                   END-IF                                         30170099
301800               END-IF                                             30180099
301900                                                                  30190099
302000               MOVE PV-CURR-PACK-ID  TO PV-PREV-PACK-ID           30200099
302100               MOVE 'N'              TO PV-FOUND-LINE-STATUS-IP   30210099
302200               MOVE 'N'              TO PV-FOUND-LINE-STATUS-CM   30220099
302300               MOVE 'N'              TO PV-FOUND-LINE-STATUS-VE   30230099
302400*      GET OPEN TO RECEIVE TOTALS                                 30240099
302500               PERFORM 4320-CALC-OPEN-TO-REC                      30250099
302600               MOVE DK-LINE-NBR           TO DP277-SEARCH-NBR     30260099
302700               PERFORM 4210-SEARCH-OTR                            30270099
302800               IF DP277-PK-OTR-OUT  > 0                           30280099
302900                  MOVE DP277-PK-OTR-OUT                           30290099
303000                                      TO ASC-OTR-PACK             30300099
303100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30310099
303200               ELSE                                               30320099
303300                  MOVE ZEROES         TO ASC-OTR-PACK             30330099
303400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30340099
303500               END-IF                                             30350099
303600               IF RECITM-STATUS-CDE = 'IP'                        30360099
303700                  MOVE 'Y'            TO PV-FOUND-LINE-STATUS-IP  30370099
303800               ELSE                                               30380099
303900                  IF RECITM-STATUS-CDE = 'CM'                     30390099
304000                     MOVE 'Y'         TO PV-FOUND-LINE-STATUS-CM  30400099
304100                  ELSE                                            30410099
304200                     IF RECITM-STATUS-CDE = 'VE'                  30420099
304300                        MOVE 'Y'      TO PV-FOUND-LINE-STATUS-VE  30430099
304400                     END-IF                                       30440099
304500                  END-IF                                          30450099
304600               END-IF                                             30460099
304700                                                                  30470099
304800             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    30480099
304900             MOVE ASC-NUMBER-OF-ITEMS-READ                        30490099
305000                                        TO ASC-LIST-ITEM-NUMBER   30500099
305100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30510099
305200             MOVE DK-PACK-ID            TO ASC-PACK-ID            30520099
305300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30530099
305400             MOVE PURITM-VEND-STYL-NAME TO                        30540099
305500                                       ASC-PURITM-VEND-STYL-NAME  30550099
305600*     SUM DETAIL PACK AND PKSL PACK QTY                           30560099
305700             PERFORM 7100-SUM-QUANTITIES                          30570099
305800                                                                  30580099
305900             MOVE PV-PACK-ODD-UNITS-QTY  TO ASC-ODD-UNITS         30590099
306000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30600099
306100                                                                  30610099
306200              MOVE PV-PACK-RATIO-QTY     TO ASC-TOT-RATIO-QTY     30620099
306300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30630099
306400              MOVE PV-PO-PACK-RATIO-QTY  TO ASC-TOT-PO-RATIO-QTY  30640099
306500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     30650099
306600                                                                  30660099
306700             IF PV-PACK-RATIO-QTY > 0                             30670099
306800                COMPUTE ASC-DETAIL-PACK                           30680099
306900                        (ASC-BLK-SUB ASC-ITEM-SUB) ROUNDED =      30690099
307000                      PV-PACK-DTL-CK-ITM-QTY / PV-PACK-RATIO-QTY  30700099
307100             ELSE                                                 30710099
307200                MOVE ZERO                 TO ASC-DETAIL-PACK      30720099
307300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30730099
307400             END-IF                                               30740099
307500                                                                  30750099
307600             IF PV-PO-PACK-RATIO-QTY > 0                          30760099
307700                COMPUTE ASC-PKSL-PACK                             30770099
307800                       (ASC-BLK-SUB ASC-ITEM-SUB) ROUNDED =       30780099
307900                      PV-PACK-PKSL-ITM-QTY / PV-PO-PACK-RATIO-QTY 30790099
308000             ELSE                                                 30800099
308100                MOVE ZERO                 TO ASC-PKSL-PACK        30810099
308200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30820099
308300             END-IF                                               30830099
308400                                                                  30840099
308500*            SUM THE AP VERIFY TOTAL                              30850099
308600             PERFORM 4330-GET-PACK-VERIFY-QTY                     30860099
308700                                                                  30870099
308800             IF RECITM-PREPK-RATO-QTY > 0                         30880099
308900                COMPUTE ASC-VERIFY-PACK                           30890099
309000                        (ASC-BLK-SUB ASC-ITEM-SUB) ROUNDED =      30900099
309100                    PV-AP-VERIFY-ITM-QTY / RECITM-PREPK-RATO-QTY  30910099
309200             ELSE                                                 30920099
309300                MOVE ZERO                 TO ASC-VERIFY-PACK      30930099
309400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 30940099
309500             END-IF                                               30950099
309600                                                                  30960099
309700            MOVE  '  '                  TO ASC-REC-STATUS         30970099
309800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  30980099
309900* THE PACK WOULD TAKE ON THE STATUS OF WHICHEVER LINE IS          30990099
310000* FURTHEREST BACK IN THE PROCESS.                                 31000099
310100                                                                  31010099
310200             IF PV-FOUND-LINE-STATUS-IP = 'Y'                     31020099
310300                MOVE 'IP'               TO ASC-REC-STATUS         31030099
310400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31040099
310500             ELSE                                                 31050099
310600                IF PV-FOUND-LINE-STATUS-CM = 'Y'                  31060099
310700                   MOVE  'CM'           TO ASC-REC-STATUS         31070099
310800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31080099
310900                ELSE                                              31090099
311000                  IF PV-FOUND-LINE-STATUS-VE = 'Y'                31100099
311100                     MOVE  'VE'         TO ASC-REC-STATUS         31110099
311200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31120099
311300                  END-IF                                          31130099
311400                END-IF                                            31140099
311500             END-IF                                               31150099
311600                                                                  31160099
311700             PERFORM 5214-RETRIEVE-DRIVER-LINE                    31170099
311800                                                                  31180099
311900             IF RECITM-MKING-APRON-TMST = PC-DEFAULT-TMST         31190099
312000                 MOVE '*****'           TO ASC-APRON-DTE          31200099
312100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31210099
312200             ELSE                                                 31220099
312300                 MOVE RECITM-MKING-APRON-TMST                     31230099
312400                                        TO PV-CRE-TMST            31240099
312500                 MOVE PV-CRE-YY         TO PV-CREATE-YY           31250099
312600                 MOVE PV-CRE-MM         TO PV-CREATE-MM           31260099
312700                 MOVE PV-CRE-DD         TO PV-CREATE-DD           31270099
312800                 MOVE PV-CREATE-DTE     TO ASC-APRON-DTE          31280099
312900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31290099
313000             END-IF                                               31300099
313100                                                                  31310099
313200             PERFORM 4340-GET-CRE-UID                             31320099
313300             MOVE PKITEM-CRE-UID        TO ASC-PKITEM-CRE-UID     31330099
313400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     31340099
313500                                                                  31350099
313600             IF ASC-STAT NOT = PC-VE                              31360099
313700                 PERFORM 4369-FIND-PACK-TROUBLE                   31370099
313800                 MOVE TRBRSN-TRBL-SHT-DESC                        31380099
313900                                   TO ASC-PACK-TROUBLE-SHORT      31390099
314000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31400099
314100                 MOVE TRBRSN-TRBL-LONG-DESC                       31410099
314200                                   TO ASC-PACK-TROUBLE-LONG       31420099
314300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31430099
314400                 EVALUATE TRUE                                    31440099
314500                     WHEN ASC-LINE-PACK-TRBL                      31450099
314600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 31460099
314700                         CONTINUE                                 31470099
314800                     WHEN PV-LN-UNRSLVD-TRBL-CNT > ZERO           31480099
314900                       OR PV-PK-UNRSLVD-TRBL-CNT > ZERO           31490099
315000                         SET ASC-LINE-IN-TROUBLE                  31500099
315100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31510099
315200                                   TO TRUE                        31520099
315300                     WHEN PV-LN-RSLVD-TRBL-CNT > ZERO             31530099
315400                       OR PV-PK-RSLVD-TRBL-CNT > ZERO             31540099
315500                         SET ASC-LINE-DISTRO-TRBL                 31550099
315600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31560099
315700                                   TO TRUE                        31570099
315800                 END-EVALUATE                                     31580099
315900             END-IF                                               31590099
316000         END-IF                                                   31600099
316100         END-IF                                                   31610099
316200     END-PERFORM.                                                 31620099
316300                                                                  31630099
316400                                                                  31640099
316500        IF  ASC-NINETY-NINE-CK                                    31650099
316600        IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                       31660099
316700            MOVE +1                   TO ASC-BLK-SUB              31670099
316800            PERFORM 5100-WRITE-TEMP-STORAGE                       31680099
316900            ADD +1                    TO ASC-BLK-SUB              31690099
317000            PERFORM 5100-WRITE-TEMP-STORAGE                       31700099
317100                                                                  31710099
317200               MOVE +1                   TO ASC-BLK-SUB           31720099
317300               IF PV-BLOCK-NUMBER = 0                             31730099
317400                  MOVE +1                TO PV-BLOCK-NUMBER       31740099
317500                  PERFORM 4410-READ-TEMP-STORAGE                  31750099
317600                  IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1    31760099
317700                      MOVE 2                TO ASC-BLK-SUB        31770099
317800                      ADD +1                TO PV-BLOCK-NUMBER    31780099
317900                      PERFORM 4410-READ-TEMP-STORAGE              31790099
318000                  END-IF                                          31800099
318100               END-IF                                             31810099
318200     END-IF.                                                      31820099
318300                                                                  31830099
318400/                                                                 31840099
318500*----------------------------------------------------------------*31850099
318600*    FETCH A PO ITEM ROW                                         *31860099
318700*----------------------------------------------------------------*31870099
318800 4310-FETCH.                                                      31880099
318900                                                                  31890099
319000     IF ASC-NINETY-NINE-CK                                        31900099
319100        EXEC SQL                                                  31910099
319200            FETCH PK-NINETY-NINE-CSR                              31920099
319300               INTO :PURITM-PO-NBR                                31930099
319400                   ,:PURITM-VER-NBR                               31940099
319500                   ,:PURITM-ITM-NBR                               31950099
319600                   ,:DK-LINE-NBR                                  31960099
319700                   ,:PURITM-VEND-STYL-NAME                        31970099
319800                   ,:PURITM-UNT-QTY                               31980099
319900                   ,:PURITM-UNT-RTL-PR-AMT                        31990099
320000                   ,:PURITM-GP-RTL-AMT                            32000099
320100                   ,:PURITM-GP-QTY                                32010099
320200                   ,:PURITM-PO-LNE-NBR                            32020099
320300                   ,:RECITM-PREPK-ID                              32030099
320400                   ,:RECITM-ORD-LNE-NBR                           32040099
320500                   ,:RECITM-CASE-PACK-QTY                         32050099
320600                   ,:RECITM-STATUS-CDE                            32060099
320700                   ,:RECITM-PREPK-ODD-UNT-QTY                     32070099
320800        END-EXEC                                                  32080099
320900     ELSE                                                         32090099
321000        EXEC SQL                                                  32100099
321100            FETCH TPURITM-CSR                                     32110099
321200               INTO :PURITM-PO-NBR                                32120099
321300                   ,:PURITM-VER-NBR                               32130099
321400                   ,:PURITM-ITM-NBR                               32140099
321500                   ,:DK-LINE-NBR                                  32150099
321600                   ,:PURITM-VEND-STYL-NAME                        32160099
321700                   ,:PURITM-UNT-QTY                               32170099
321800                   ,:PURITM-UNT-RTL-PR-AMT                        32180099
321900                   ,:PURITM-GP-RTL-AMT                            32190099
322000                   ,:PURITM-GP-QTY                                32200099
322100                   ,:PURITM-PO-LNE-NBR                            32210099
322200                   ,:RECITM-PREPK-ID                              32220099
322300                   ,:POPRPK-PREPK-DESC                            32230099
322400                   ,:RECITM-ORD-LNE-NBR                           32240099
322500                   ,:RECITM-CASE-PACK-QTY                         32250099
322600                   ,:RECITM-STATUS-CDE                            32260099
322700                   ,:RECITM-PREPK-ODD-UNT-QTY                     32270099
322800        END-EXEC.                                                 32280099
322900                                                                  32290099
323000     EVALUATE TRUE                                                32300099
323100         WHEN SQLCODE = +0                                        32310099
323200              MOVE RECITM-PREPK-ID TO DK-PACK-ID                  32320099
323300         WHEN SQLCODE = +100                                      32330099
323400              SET ASC-NO-ITEMS-LEFT-ON-DB                         32340099
323500                                   TO TRUE                        32350099
323600         WHEN SQLCODE = -904                                      32360099
323700         WHEN SQLCODE = -911                                      32370099
323800         WHEN SQLCODE = -913                                      32380099
323900              PERFORM 9900-SOFT-ABORT                             32390099
324000         WHEN OTHER                                               32400099
324100              MOVE '4310-FETCH'                                   32410099
324200                                   TO DP013-PARAGRAPH             32420099
324300              MOVE 'FETCH TPURITM CURSOR'                         32430099
324400                                   TO DP013-MESSAGE-TEXT (1)      32440099
324500              MOVE SQLCA           TO DP013-SQLCA                 32450099
324600              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    32460099
324700              PERFORM 9950-FORMAT-ERROR-MSG                       32470099
324800              SET DP013-DB2-ABEND  TO TRUE                        32480099
324900              PERFORM DP013-0000-PROCESS-ABEND                    32490099
325000     END-EVALUATE.                                                32500099
325100                                                                  32510099
325200                                                                  32520099
325300*                                                                 32530099
325400*----------------------------------------------------------------*32540099
325500*    GET THE PACK LEVEL OTR FOR THE PARTICULAR PACK              *32550099
325600*----------------------------------------------------------------*32560099
325700 4320-CALC-OPEN-TO-REC.                                           32570099
325800                                                                  32580099
325900     SET DP277-LINE-LEVEL-OTR                                     32590099
326000         DP277-RECEIVER-OTR      TO TRUE                          32600099
326100                                                                  32610099
326200     INITIALIZE DP277-KEYS                                        32620099
326300     MOVE DK-ORD-NBR             TO DP277-PO-NBR                  32630099
326400     MOVE DK-LINE-NBR            TO DP277-PO-LNE-NBR              32640099
326500     MOVE DK-RCVR-SEQ-NBR        TO DP277-REC-SEQ-NBR             32650099
326600     MOVE DK-OPR-ID              TO DP277-OPER-UNT-ID             32660099
326700     MOVE DK-FACT                TO DP277-FCLTY-ID                32670099
326800     MOVE DK-PACK-ID             TO DP277-PO-PREPK-ID             32680099
326900                                                                  32690099
327000     COPY DPPD277.                                                32700099
327100                                                                  32710099
327200/                                                                 32720099
327300*----------------------------------------------------------------*32730099
327400*    GET SKU, SKU DESC, AND VENDOR STYLE FROM TPURCHS/TPURITM    *32740099
327500*----------------------------------------------------------------*32750099
327600 4330-GET-PACK-VERIFY-QTY.                                        32760099
327700                                                                  32770099
327800         EXEC SQL                                                 32780099
327900              SELECT SUM(B.AP_VERIFY_ITM_QTY)                     32790099
328000                INTO :PV-AP-VERIFY-ITM-QTY                        32800099
328100                FROM TRECITM A                                    32810099
328200                    ,TRECDIS B                                    32820099
328300               WHERE                                              32830099
328400                     A.ORD_NBR         = :DK-ORD-NBR              32840099
328500                 AND A.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR         32850099
328600                 AND A.PREPK_ID        = :DK-PACK-ID              32860099
328700                 AND A.OPER_UNT_ID     = :DK-OPR-ID               32870099
328800                 AND A.FCLTY_ID        = :DK-FACT                 32880099
328900                 AND A.VER_STATUS_CDE  = 'A'                      32890099
329000                 AND A.PREPK_DRV_LNE_CDE = 'A'                    32900099
329100                 AND B.OPER_UNT_ID     = A.OPER_UNT_ID            32910099
329200                 AND B.FCLTY_ID        = A.FCLTY_ID               32920099
329300                 AND B.ORD_NBR         = A.ORD_NBR                32930099
329400                 AND B.REC_SEQ_NBR     = A.REC_SEQ_NBR            32940099
329500                 AND B.ORD_LNE_NBR     = A.ORD_LNE_NBR            32950099
329700         END-EXEC                                                 32970099
329800                                                                  32980099
329900         EVALUATE TRUE                                            32990099
330000             WHEN SQLCODE = ZERO                                  33000099
330100                  CONTINUE                                        33010099
330200             WHEN SQLCODE = -811                                  33020099
330300                  MOVE PC-CURRENT-PROGRAM-ERROR                   33030099
330400                                         TO DP020-MSG-TEXT        33040099
330500                  MOVE PC-TSYMSG-02229   TO DP020-MSG-NUMBER      33050099
330600                  SET PS-ERROR                                    33060099
330700                      DP020-MSG-FATAL                             33070099
330800                      PS-COMMAREA-NOT-VALID                       33080099
330900                      DP020-NEXT-ACT-APPL-ERROR                   33090099
331000                                         TO TRUE                  33100099
331100             WHEN SQLCODE = -904                                  33110099
331200             WHEN SQLCODE = -911                                  33120099
331300             WHEN SQLCODE = -913                                  33130099
331400                  PERFORM 9900-SOFT-ABORT                         33140099
331500             WHEN SQLCODE = +100                                  33150099
331600             WHEN SQLCODE = -305                                  33160099
331700                  MOVE +0  TO PV-AP-VERIFY-ITM-QTY                33170099
331800             WHEN OTHER                                           33180099
331900                  MOVE '4330-GET-PACK-VERIFY-QTY'                 33190099
332000                                   TO DP013-PARAGRAPH             33200099
332100                  MOVE 'SELECT TRECDIS'                           33210099
332200                                   TO DP013-MESSAGE-TEXT (1)      33220099
332300                  MOVE SQLCA       TO DP013-SQLCA                 33230099
332400                  PERFORM 9950-FORMAT-ERROR-MSG                   33240099
332500                  SET DP013-DB2-ABEND                             33250099
332600                                   TO TRUE                        33260099
332700                  PERFORM DP013-0000-PROCESS-ABEND                33270099
332800         END-EVALUATE.                                            33280099
332900                                                                  33290099
333000         EXEC SQL                                                 33300099
333100              SELECT PREPK_RATO_QTY                               33310099
333200                INTO :RECITM-PREPK-RATO-QTY                       33320099
333300                FROM TRECITM A                                    33330099
333400               WHERE                                              33340099
333500                     A.ORD_NBR         = :DK-ORD-NBR              33350099
333600                 AND A.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR         33360099
333700                 AND A.PREPK_ID        = :DK-PACK-ID              33370099
333800                 AND A.OPER_UNT_ID     = :DK-OPR-ID               33380099
333900                 AND A.FCLTY_ID        = :DK-FACT                 33390099
334000                 AND A.VER_STATUS_CDE  = 'A'                      33400099
334100                 AND A.PREPK_DRV_LNE_CDE = 'A'                    33410099
334200         END-EXEC                                                 33420099
334300                                                                  33430099
334400         EVALUATE TRUE                                            33440099
334500             WHEN SQLCODE = ZERO                                  33450099
334600                  CONTINUE                                        33460099
334700             WHEN SQLCODE = -811                                  33470099
334800                  MOVE PC-CURRENT-PROGRAM-ERROR                   33480099
334900                                         TO DP020-MSG-TEXT        33490099
335000                  MOVE PC-TSYMSG-02229   TO DP020-MSG-NUMBER      33500099
335100                  SET PS-ERROR                                    33510099
335200                      DP020-MSG-FATAL                             33520099
335300                      PS-COMMAREA-NOT-VALID                       33530099
335400                      DP020-NEXT-ACT-APPL-ERROR                   33540099
335500                                         TO TRUE                  33550099
335600             WHEN SQLCODE = -904                                  33560099
335700             WHEN SQLCODE = -911                                  33570099
335800             WHEN SQLCODE = -913                                  33580099
335900                  PERFORM 9900-SOFT-ABORT                         33590099
336000             WHEN SQLCODE = +100                                  33600099
336100             WHEN SQLCODE = -305                                  33610099
336200                  MOVE +0  TO PV-AP-VERIFY-ITM-QTY                33620099
336300             WHEN OTHER                                           33630099
336400                  MOVE '4330-GET-PACK-VERIFY-QTY'                 33640099
336500                                   TO DP013-PARAGRAPH             33650099
336600                  MOVE 'SELECT TRECITM'                           33660099
336700                                   TO DP013-MESSAGE-TEXT (1)      33670099
336800                  MOVE SQLCA       TO DP013-SQLCA                 33680099
336900                  PERFORM 9950-FORMAT-ERROR-MSG                   33690099
337000                  SET DP013-DB2-ABEND                             33700099
337100                                   TO TRUE                        33710099
337200                  PERFORM DP013-0000-PROCESS-ABEND                33720099
337300         END-EVALUATE.                                            33730099
337400                                                                  33740099
337500/                                                                 33750099
337600*----------------------------------------------------------------*33760099
337700*    GET CRE-UID FROM TPKITEM                                    *33770099
337800*----------------------------------------------------------------*33780099
337900 4340-GET-CRE-UID.                                                33790099
338000                                                                  33800099
338100         EXEC SQL                                                 33810099
338200              SELECT DISTINCT                                     33820099
338300                     A.CRE_UID                                    33830099
338400                INTO :PKITEM-CRE-UID                              33840099
338500                FROM TPKITEM A                                    33850099
338600                   , TPKSLIP B                                    33860099
338700               WHERE A.PO_NBR          = B.PO_NBR                 33870099
338800                 AND A.SEQ_NBR         = B.SEQ_NBR                33880099
338900                 AND A.PKSL_LNE_NBR    = :DK-LINE-NBR             33890099
339000                 AND A.VER_STAT_CDE    = 'A'                      33900099
339100                 AND B.PO_NBR          = :DK-ORD-NBR              33910099
339200                 AND B.REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR         33920099
339300                 AND B.VER_STAT_CDE    = 'A'                      33930099
339400         END-EXEC                                                 33940099
339500                                                                  33950099
339600         EVALUATE TRUE                                            33960099
339700             WHEN SQLCODE = ZERO                                  33970099
339800                  CONTINUE                                        33980099
339900             WHEN SQLCODE = -811                                  33990099
340000                  MOVE 'MULTIPLE' TO PKITEM-CRE-UID               34000099
340100             WHEN SQLCODE = -904                                  34010099
340200             WHEN SQLCODE = -911                                  34020099
340300             WHEN SQLCODE = -913                                  34030099
340400                  PERFORM 9900-SOFT-ABORT                         34040099
340500             WHEN SQLCODE = +100                                  34050099
340600             WHEN SQLCODE = -305                                  34060099
340700                  MOVE SPACES TO PKITEM-CRE-UID                   34070099
340800             WHEN OTHER                                           34080099
340900                  MOVE '4340-GET-CRE-UID'                         34090099
341000                                   TO DP013-PARAGRAPH             34100099
341100                  MOVE 'SELECT TPKITEM'                           34110099
341200                                   TO DP013-MESSAGE-TEXT (1)      34120099
341300                  MOVE SQLCA       TO DP013-SQLCA                 34130099
341400                  PERFORM 9950-FORMAT-ERROR-MSG                   34140099
341500                  SET DP013-DB2-ABEND                             34150099
341600                                   TO TRUE                        34160099
341700                  PERFORM DP013-0000-PROCESS-ABEND                34170099
341800         END-EVALUATE.                                            34180099
341900                                                                  34190099
342000                                                                  34200099
342100*----------------------------------------------------------------*34210099
342200* CHECK TO SEE IF PO/RCVR/LINE HAS BEEN PROCESSED THROUGH        *34220099
342300* CASEPACK SPLIT PROCESS                                         *34230099
342400*----------------------------------------------------------------*34240099
342500 4350-CK-CASEPACK-SPLIT-PROCESS.                                  34250099
342600         EXEC SQL                                                 34260099
342700              SELECT ORD_NBR                                      34270099
342800                    ,RCVR_SEQ_NBR                                 34280099
342900                    ,ORD_LNE_NBR                                  34290099
343000                    ,SYS_CRE_CDE                                  34300099
343100                    ,TOT_CART_CNT                                 34310099
343200              INTO   :DISTHD-ORD-NBR                              34320099
343300                    ,:DISTHD-RCVR-SEQ-NBR                         34330099
343400                    ,:DISTHD-ORD-LNE-NBR                          34340099
343500                    ,:DISTHD-SYS-CRE-CDE                          34350099
343600                    ,:DISTHD-TOT-CART-CNT                         34360099
343700                                                                  34370099
343800              FROM  TDISTHD                                       34380099
343900              WHERE ORD_NBR        = :DK-ORD-NBR                  34390099
344000                AND RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR             34400099
344100                AND ORD_LNE_NBR    = :DK-LINE-NBR                 34410099
344200*KBW            AND SYS_CRE_CDE    = 'F'                          34420099
344300                AND TOT_CART_CNT   > +0                           34430099
344400         END-EXEC                                                 34440099
344500                                                                  34450099
344600         EVALUATE TRUE                                            34460099
344700             WHEN SQLCODE = +0                                    34470099
344800                  SET ASC-CASEPACK-SPLIT-YES                      34480099
344900                                  TO TRUE                         34490099
345000             WHEN SQLCODE = +100                                  34500099
345100                  SET ASC-CASEPACK-SPLIT-NO                       34510099
345200                                  TO TRUE                         34520099
345300             WHEN SQLCODE = -904                                  34530099
345400             WHEN SQLCODE = -911                                  34540099
345500             WHEN SQLCODE = -913                                  34550099
345600                  PERFORM 9900-SOFT-ABORT                         34560099
345700                                                                  34570099
345800             WHEN OTHER                                           34580099
345900                  MOVE '4350-CK-CASEPACK-SPLIT-PROCESS'           34590099
346000                                  TO DP013-PARAGRAPH              34600099
346100                  MOVE 'UNSUCCESSFUL SELECT ON TDISTHD'           34610099
346200                                  TO DP013-MESSAGE-TEXT (1)       34620099
346300                  MOVE SQLCA      TO DP013-SQLCA                  34630099
346400                  MOVE 'TDISTHD ' TO DP013-DB2-TABLE-NAME (1)     34640099
346500                  PERFORM 9950-FORMAT-ERROR-MSG                   34650099
346600                  SET DP013-DB2-ABEND                             34660099
346700                      DP013-XCTL-DISPLAY-RESTART                  34670099
346800                                  TO TRUE                         34680099
346900                  PERFORM DP013-0000-PROCESS-ABEND                34690099
347000         END-EVALUATE.                                            34700099
347100                                                                  34710099
347200                                                                  34720099
347300*----------------------------------------------------------------*34730099
347400*    GET TRECEIV INFO FOR THE TOP OF THE SCREEN                  *34740099
347500*----------------------------------------------------------------*34750099
347600 4355-GET-TRECEIV-INFO.                                           34760099
347700                                                                  34770099
347800         EXEC SQL                                                 34780099
347900              SELECT ORD_NBR                                      34790099
348000                    ,REC_SEQ_NBR                                  34800099
348100                    ,STATUS_CDE                                   34810099
348200                    ,EXPTED_CART_CNT                              34820099
348300                    ,ACTL_CART_CNT                                34830099
348400                    ,PKGNG_CDE                                    34840099
348500              INTO   :RECEIV-ORD-NBR                              34850099
348600                    ,:RECEIV-REC-SEQ-NBR                          34860099
348700                    ,:RECEIV-STATUS-CDE                           34870099
348800                    ,:RECEIV-EXPTED-CART-CNT                      34880099
348900                    ,:RECEIV-ACTL-CART-CNT                        34890099
349000                    ,:RECEIV-PKGNG-CDE                            34900099
349100              FROM  TRECEIV                                       34910099
349200              WHERE ORD_NBR        = :DK-ORD-NBR                  34920099
349300                AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             34930099
349400                AND OPER_UNT_ID    = :DK-OPR-ID                   34940099
349500                AND FCLTY_ID       = :DK-FACT                     34950099
349600                AND VER_STATUS_CDE = 'A'                          34960099
349700         END-EXEC                                                 34970099
349800                                                                  34980099
349900         EVALUATE TRUE                                            34990099
350000             WHEN SQLCODE = +0                                    35000099
350100             WHEN SQLCODE = +100                                  35010099
350200                  CONTINUE                                        35020099
350300             WHEN SQLCODE = -904                                  35030099
350400             WHEN SQLCODE = -911                                  35040099
350500             WHEN SQLCODE = -913                                  35050099
350600                  PERFORM 9900-SOFT-ABORT                         35060099
350700                                                                  35070099
350800             WHEN OTHER                                           35080099
350900                  MOVE '4355-GET-TRECIEV-INFO'                    35090099
351000                                  TO DP013-PARAGRAPH              35100099
351100                  MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'           35110099
351200                                  TO DP013-MESSAGE-TEXT (1)       35120099
351300                  MOVE SQLCA      TO DP013-SQLCA                  35130099
351400                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     35140099
351500                  PERFORM 9950-FORMAT-ERROR-MSG                   35150099
351600                  SET DP013-DB2-ABEND                             35160099
351700                      DP013-XCTL-DISPLAY-RESTART                  35170099
351800                                  TO TRUE                         35180099
351900                  PERFORM DP013-0000-PROCESS-ABEND                35190099
352000         END-EVALUATE.                                            35200099
352100                                                                  35210099
352200/                                                                 35220099
352300*----------------------------------------------------------------*35230099
352400*    GET TPURCHS INFO FOR THE TOP OF THE SCREEN                  *35240099
352500*----------------------------------------------------------------*35250099
352600 4360-GET-TPURCHS-INFO.                                           35260099
352700                                                                  35270099
352800         EXEC SQL                                                 35280099
352900              SELECT PO_NBR                                       35290099
353000                    ,PKGNG_CDE                                    35300099
353100              INTO   :PURCHS-PO-NBR                               35310099
353200                    ,:PURCHS-PKGNG-CDE                            35320099
353300              FROM  TPURCHS                                       35330099
353400              WHERE PO_NBR         = :DK-ORD-NBR                  35340099
353500                AND VER_STATUS_CDE = 'A'                          35350099
353600         END-EXEC                                                 35360099
353700                                                                  35370099
353800         EVALUATE TRUE                                            35380099
353900             WHEN SQLCODE = +0                                    35390099
354000             WHEN SQLCODE = +100                                  35400099
354100                  CONTINUE                                        35410099
354200             WHEN SQLCODE = -904                                  35420099
354300             WHEN SQLCODE = -911                                  35430099
354400             WHEN SQLCODE = -913                                  35440099
354500                  PERFORM 9900-SOFT-ABORT                         35450099
354600                                                                  35460099
354700             WHEN OTHER                                           35470099
354800                  MOVE '4360-GET-TPURCHS-INFO'                    35480099
354900                                  TO DP013-PARAGRAPH              35490099
355000                  MOVE 'UNSUCCESSFUL SELECT ON TPURCHS'           35500099
355100                                  TO DP013-MESSAGE-TEXT (1)       35510099
355200                  MOVE SQLCA      TO DP013-SQLCA                  35520099
355300                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     35530099
355400                  PERFORM 9950-FORMAT-ERROR-MSG                   35540099
355500                  SET DP013-DB2-ABEND                             35550099
355600                      DP013-XCTL-DISPLAY-RESTART                  35560099
355700                                  TO TRUE                         35570099
355800                  PERFORM DP013-0000-PROCESS-ABEND                35580099
355900         END-EVALUATE.                                            35590099
356000                                                                  35600099
356100                                                                  35610099
356200                                                                  35620099
356300*----------------------------------------------------------------*35630099
356400*  FIRST DETERMINE IF THERE IS ANY PACK LEVEL TROUBLE, IF NOT    *35640099
356500*  THEN DETERMINE IF THERE IS ANY LINE LEVEL TROUBLE.            *35650099
356600*----------------------------------------------------------------*35660099
356700 4369-FIND-PACK-TROUBLE.                                          35670099
356800     EXEC SQL                                                     35680099
356900         SELECT                                                   35690099
357000              C.TRBL_SHT_DESC                                     35700099
357100             ,C.TRBL_LONG_DESC                                    35710099
357200         INTO                                                     35720099
357300              :TRBRSN-TRBL-SHT-DESC                               35730099
357400             ,:TRBRSN-TRBL-LONG-DESC                              35740099
357500         FROM TRECITM A                                           35750099
357600             ,TTRBNTF B                                           35760099
357700             ,TTRBRSN C                                           35770099
357800         WHERE A.ORD_NBR              = :DK-ORD-NBR               35780099
357900               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          35790099
358000               AND A.OPER_UNT_ID      = :DK-OPR-ID                35800099
358100               AND A.FCLTY_ID         = :DK-FACT                  35810099
358200               AND A.ORD_LNE_NBR      > 0                         35820099
358300               AND A.PREPK_ID         = :DK-PACK-ID               35830099
358400               AND B.OPER_UNT_ID      = A.OPER_UNT_ID             35840099
358500               AND B.FCLTY_ID         = A.FCLTY_ID                35850099
358600               AND B.PO_NBR           = A.ORD_NBR                 35860099
358700               AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR             35870099
358800               AND B.PO_LNE_NBR       = 0                         35880099
358900               AND B.PREPK_ID         = A.PREPK_ID                35890099
359000               AND B.RESOLVED_IND IN (:PC-N, :PC-I)               35900099
359100               AND B.TRBL_RSN_CDE     = C.TRBL_RSN_CDE            35910099
359200     END-EXEC                                                     35920099
359300                                                                  35930099
359400     EVALUATE TRUE                                                35940099
359500         WHEN SQLCODE = ZERO                                      35950099
359600         WHEN SQLCODE = -811                                      35960099
359700             SET ASC-LINE-PACK-TRBL   (ASC-BLK-SUB ASC-ITEM-SUB)  35970099
359800                         TO TRUE                                  35980099
359900         WHEN SQLCODE = +100                                      35990099
360000             MOVE SPACES TO TRBRSN-TRBL-SHT-DESC                  36000099
360100                            TRBRSN-TRBL-LONG-DESC                 36010099
360200             SET ASC-NO-LINE-TRBL     (ASC-BLK-SUB ASC-ITEM-SUB)  36020099
360300                         TO TRUE                                  36030099
360400         WHEN SQLCODE = -904                                      36040099
360500         WHEN SQLCODE = -911                                      36050099
360600         WHEN SQLCODE = -913                                      36060099
360700              PERFORM 9900-SOFT-ABORT                             36070099
360800                                                                  36080099
360900         WHEN OTHER                                               36090099
361000             MOVE '4369-FIND-PACK-TROUBLE'                        36100099
361100                             TO DP013-PARAGRAPH                   36110099
361200             MOVE 'SELECT ON TTRBNTF'                             36120099
361300                             TO DP013-MESSAGE-TEXT (1)            36130099
361400             MOVE SQLCA          TO DP013-SQLCA                   36140099
361500             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      36150099
361600             PERFORM 9950-FORMAT-ERROR-MSG                        36160099
361700             SET DP013-XCTL-DISPLAY-RESTART                       36170099
361800                 DP013-DB2-ABEND                                  36180099
361900                             TO TRUE                              36190099
362000             PERFORM DP013-0000-PROCESS-ABEND                     36200099
362100     END-EVALUATE.                                                36210099
362200                                                                  36220099
362300     MOVE ZERO                    TO PV-PK-UNRSLVD-TRBL-CNT       36230099
362400                                     PV-PK-RSLVD-TRBL-CNT.        36240099
362500     EXEC SQL                                                     36250099
362600         SELECT COUNT(*)                                          36260099
362700         INTO :PV-PK-UNRSLVD-TRBL-CNT                             36270099
362800         FROM TRECITM A                                           36280099
362900             ,TTRBNTF B                                           36290099
363000         WHERE     A.ORD_NBR          = :DK-ORD-NBR               36300099
363100               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          36310099
363200               AND A.OPER_UNT_ID      = :DK-OPR-ID                36320099
363300               AND A.FCLTY_ID         = :DK-FACT                  36330099
363400               AND A.PREPK_ID         = :DK-PACK-ID               36340099
363500               AND B.OPER_UNT_ID      = A.OPER_UNT_ID             36350099
363600               AND B.FCLTY_ID         = A.FCLTY_ID                36360099
363700               AND B.PO_NBR           = A.ORD_NBR                 36370099
363800               AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR             36380099
363900               AND B.PO_LNE_NBR       = A.ORD_LNE_NBR             36390099
364000               AND B.RESOLVED_IND IN (:PC-N, :PC-I)               36400099
364100     END-EXEC                                                     36410099
364200     EVALUATE TRUE                                                36420099
364300         WHEN SQLCODE = ZERO                                      36430099
364400         WHEN SQLCODE = +100                                      36440099
364500             CONTINUE                                             36450099
364600         WHEN SQLCODE = -904                                      36460099
364700         WHEN SQLCODE = -911                                      36470099
364800         WHEN SQLCODE = -913                                      36480099
364900              PERFORM 9900-SOFT-ABORT                             36490099
365000                                                                  36500099
365100         WHEN OTHER                                               36510099
365200             MOVE '4369-FIND-PACK-TROUBLE'                        36520099
365300                             TO DP013-PARAGRAPH                   36530099
365400             MOVE 'SELECT ON TTRBNTF'                             36540099
365500                             TO DP013-MESSAGE-TEXT (1)            36550099
365600             MOVE SQLCA          TO DP013-SQLCA                   36560099
365700             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      36570099
365800             PERFORM 9950-FORMAT-ERROR-MSG                        36580099
365900             SET DP013-XCTL-DISPLAY-RESTART                       36590099
366000                 DP013-DB2-ABEND                                  36600099
366100                             TO TRUE                              36610099
366200             PERFORM DP013-0000-PROCESS-ABEND                     36620099
366300     END-EVALUATE.                                                36630099
366400                                                                  36640099
366500     IF PV-PK-UNRSLVD-TRBL-CNT = ZERO AND SQLCODE = ZERO OR +100  36650099
366600         EXEC SQL                                                 36660099
366700             SELECT COUNT(*)                                      36670099
366800             INTO :PV-PK-RSLVD-TRBL-CNT                           36680099
366900             FROM TTRBNTF A                                       36690099
367000                , TTRBRSN B                                       36700099
367100             WHERE A.PO_NBR       = :DK-ORD-NBR                   36710099
367200               AND A.REC_SEQ_NBR  = :DK-RCVR-SEQ-NBR              36720099
367300               AND A.OPER_UNT_ID  = :DK-OPR-ID                    36730099
367400               AND A.FCLTY_ID     = :DK-FACT                      36740099
367500               AND A.PREPK_ID     = :DK-PACK-ID                   36750099
367600               AND A.RESOLVED_IND = :PC-R                         36760099
367700               AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE                36770099
367800               AND B.NOTIF_IND    = :PC-T                         36780099
367900         END-EXEC                                                 36790099
368000                                                                  36800099
368100         EVALUATE TRUE                                            36810099
368200             WHEN SQLCODE = ZERO                                  36820099
368300             WHEN SQLCODE = +100                                  36830099
368400                 CONTINUE                                         36840099
368500             WHEN SQLCODE = -904                                  36850099
368600             WHEN SQLCODE = -911                                  36860099
368700             WHEN SQLCODE = -913                                  36870099
368800                  PERFORM 9900-SOFT-ABORT                         36880099
368900                                                                  36890099
369000             WHEN OTHER                                           36900099
369100                 MOVE '4360-FIND-PACK-TROUBLE'                    36910099
369200                                 TO DP013-PARAGRAPH               36920099
369300                 MOVE 'SELECT ON TTRBNTF - TTRBRSN'               36930099
369400                                 TO DP013-MESSAGE-TEXT (1)        36940099
369500                 MOVE SQLCA      TO DP013-SQLCA                   36950099
369600                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      36960099
369700                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      36970099
369800                 PERFORM 9950-FORMAT-ERROR-MSG                    36980099
369900                 SET DP013-XCTL-DISPLAY-RESTART                   36990099
370000                     DP013-DB2-ABEND                              37000099
370100                                 TO TRUE                          37010099
370200                 PERFORM DP013-0000-PROCESS-ABEND                 37020099
370300         END-EVALUATE                                             37030099
370400     END-IF.                                                      37040099
370500                                                                  37050099
370600     IF TRBRSN-TRBL-SHT-DESC  = SPACES                            37060099
370700        PERFORM 4370-FIND-LINE-TROUBLE.                           37070099
370800                                                                  37080099
370900                                                                  37090099
371000*----------------------------------------------------------------*37100099
371100*  FIRST DETERMINE IF THERE IS ANY PACK LEVEL TROUBLE, IF NOT    *37110099
371200*  THEN DETERMINE IF THERE IS ANY LINE LEVEL TROUBLE.            *37120099
371300*----------------------------------------------------------------*37130099
371400 4370-FIND-LINE-TROUBLE.                                          37140099
371500                                                                  37150099
371600* CHECK FOR LINE LEVEL TROUBLE                                    37160099
371700     EXEC SQL                                                     37170099
371800         SELECT                                                   37180099
371900             C.TRBL_SHT_DESC                                      37190099
372000             ,C.TRBL_LONG_DESC                                    37200099
372100         INTO                                                     37210099
372200              :TRBRSN-TRBL-SHT-DESC                               37220099
372300             ,:TRBRSN-TRBL-LONG-DESC                              37230099
372400         FROM TRECITM A                                           37240099
372500             ,TTRBNTF B                                           37250099
372600             ,TTRBRSN C                                           37260099
372700         WHERE A.ORD_NBR           = :DK-ORD-NBR                  37270099
372800            AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR             37280099
372900            AND A.ORD_LNE_NBR      > 0                            37290099
373000            AND A.OPER_UNT_ID      = :DK-OPR-ID                   37300099
373100            AND A.FCLTY_ID         = :DK-FACT                     37310099
373200            AND A.PREPK_ID         = :DK-PACK-ID                  37320099
373300            AND B.PO_NBR           = A.ORD_NBR                    37330099
373400            AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                37340099
373500            AND B.OPER_UNT_ID      = A.OPER_UNT_ID                37350099
373600            AND B.FCLTY_ID         = A.FCLTY_ID                   37360099
373700            AND B.PO_LNE_NBR       = A.ORD_LNE_NBR                37370099
373800            AND B.RESOLVED_IND IN (:PC-N, :PC-I)                  37380099
373900            AND B.TRBL_RSN_CDE     = C.TRBL_RSN_CDE               37390099
374000      END-EXEC                                                    37400099
374100                                                                  37410099
374200     EVALUATE TRUE                                                37420099
374300         WHEN SQLCODE = ZERO                                      37430099
374400         WHEN SQLCODE = -811                                      37440099
374500             CONTINUE                                             37450099
374600         WHEN SQLCODE = +100                                      37460099
374700             MOVE SPACES TO TRBRSN-TRBL-SHT-DESC                  37470099
374800                            TRBRSN-TRBL-LONG-DESC                 37480099
374900         WHEN SQLCODE = -904                                      37490099
375000         WHEN SQLCODE = -911                                      37500099
375100         WHEN SQLCODE = -913                                      37510099
375200              PERFORM 9900-SOFT-ABORT                             37520099
375300                                                                  37530099
375400         WHEN OTHER                                               37540099
375500             MOVE '4370-FIND-LINE-TROUBLE'                        37550099
375600                             TO DP013-PARAGRAPH                   37560099
375700             MOVE 'SELECT ON TTRBNTF'                             37570099
375800                             TO DP013-MESSAGE-TEXT (1)            37580099
375900             MOVE SQLCA          TO DP013-SQLCA                   37590099
376000             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      37600099
376100             PERFORM 9950-FORMAT-ERROR-MSG                        37610099
376200             SET DP013-DB2-ABEND                                  37620099
376300                             TO TRUE                              37630099
376400             SET DP013-XCTL-DISPLAY-RESTART                       37640099
376500                             TO TRUE                              37650099
376600             PERFORM DP013-0000-PROCESS-ABEND                     37660099
376700     END-EVALUATE.                                                37670099
376800                                                                  37680099
376900                                                                  37690099
377000     MOVE ZERO                    TO PV-LN-UNRSLVD-TRBL-CNT       37700099
377100                                     PV-LN-RSLVD-TRBL-CNT.        37710099
377200     EXEC SQL                                                     37720099
377300         SELECT COUNT(*)                                          37730099
377400         INTO :PV-LN-UNRSLVD-TRBL-CNT                             37740099
377500         FROM TRECITM A                                           37750099
377600             ,TTRBNTF B                                           37760099
377700         WHERE     A.ORD_NBR          = :DK-ORD-NBR               37770099
377800               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          37780099
377900               AND A.OPER_UNT_ID      = :DK-OPR-ID                37790099
378000               AND A.FCLTY_ID         = :DK-FACT                  37800099
378100               AND A.ORD_LNE_NBR      > 0                         37810099
378200               AND A.PREPK_ID         = :DK-PACK-ID               37820099
378300               AND B.OPER_UNT_ID      = A.OPER_UNT_ID             37830099
378400               AND B.FCLTY_ID         = A.FCLTY_ID                37840099
378500               AND B.PO_NBR           = A.ORD_NBR                 37850099
378600               AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR             37860099
378700               AND B.PO_LNE_NBR       = A.ORD_LNE_NBR             37870099
378800               AND B.RESOLVED_IND IN (:PC-N, :PC-I)               37880099
378900     END-EXEC                                                     37890099
379000     EVALUATE TRUE                                                37900099
379100         WHEN SQLCODE = ZERO                                      37910099
379200         WHEN SQLCODE = +100                                      37920099
379300             CONTINUE                                             37930099
379400         WHEN SQLCODE = -904                                      37940099
379500         WHEN SQLCODE = -911                                      37950099
379600         WHEN SQLCODE = -913                                      37960099
379700              PERFORM 9900-SOFT-ABORT                             37970099
379800                                                                  37980099
379900         WHEN OTHER                                               37990099
380000             MOVE '4370-FIND-LINE-TROUBLE'                        38000099
380100                             TO DP013-PARAGRAPH                   38010099
380200             MOVE 'SELECT ON TTRBNTF'                             38020099
380300                             TO DP013-MESSAGE-TEXT (1)            38030099
380400             MOVE SQLCA          TO DP013-SQLCA                   38040099
380500             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      38050099
380600             PERFORM 9950-FORMAT-ERROR-MSG                        38060099
380700             SET DP013-XCTL-DISPLAY-RESTART                       38070099
380800                 DP013-DB2-ABEND                                  38080099
380900                             TO TRUE                              38090099
381000             PERFORM DP013-0000-PROCESS-ABEND                     38100099
381100     END-EVALUATE.                                                38110099
381200                                                                  38120099
381300     IF PV-LN-UNRSLVD-TRBL-CNT = ZERO AND SQLCODE = ZERO OR +100  38130099
381400         EXEC SQL                                                 38140099
381500             SELECT COUNT(*)                                      38150099
381600             INTO :PV-LN-RSLVD-TRBL-CNT                           38160099
381700         FROM TRECITM A                                           38170099
381800             ,TTRBNTF B                                           38180099
381900            , TTRBRSN C                                           38190099
382000         WHERE     A.ORD_NBR          = :DK-ORD-NBR               38200099
382100               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          38210099
382200               AND A.OPER_UNT_ID      = :DK-OPR-ID                38220099
382300               AND A.FCLTY_ID         = :DK-FACT                  38230099
382400               AND A.ORD_LNE_NBR      > 0                         38240099
382500               AND A.PREPK_ID         = :DK-PACK-ID               38250099
382600               AND B.OPER_UNT_ID      = A.OPER_UNT_ID             38260099
382700               AND B.FCLTY_ID         = A.FCLTY_ID                38270099
382800               AND B.PO_NBR           = A.ORD_NBR                 38280099
382900               AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR             38290099
383000               AND B.PO_LNE_NBR       = A.ORD_LNE_NBR             38300099
383100               AND B.RESOLVED_IND     = :PC-R                     38310099
383200               AND C.TRBL_RSN_CDE     = B.TRBL_RSN_CDE            38320099
383300               AND C.NOTIF_IND        = :PC-T                     38330099
383400     END-EXEC                                                     38340099
383500                                                                  38350099
383600         EVALUATE TRUE                                            38360099
383700             WHEN SQLCODE = ZERO                                  38370099
383800             WHEN SQLCODE = +100                                  38380099
383900                 CONTINUE                                         38390099
384000             WHEN SQLCODE = -904                                  38400099
384100             WHEN SQLCODE = -911                                  38410099
384200             WHEN SQLCODE = -913                                  38420099
384300                  PERFORM 9900-SOFT-ABORT                         38430099
384400                                                                  38440099
384500             WHEN OTHER                                           38450099
384600                 MOVE '4370-FIND-LINE-TROUBLE'                    38460099
384700                                 TO DP013-PARAGRAPH               38470099
384800                 MOVE 'SELECT ON TTRBNTF - TTRBRSN'               38480099
384900                                 TO DP013-MESSAGE-TEXT (1)        38490099
385000                 MOVE SQLCA      TO DP013-SQLCA                   38500099
385100                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      38510099
385200                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      38520099
385300                 PERFORM 9950-FORMAT-ERROR-MSG                    38530099
385400                 SET DP013-DB2-ABEND                              38540099
385500                                 TO TRUE                          38550099
385600                 SET DP013-XCTL-DISPLAY-RESTART                   38560099
385700                                 TO TRUE                          38570099
385800                 PERFORM DP013-0000-PROCESS-ABEND                 38580099
385900         END-EVALUATE                                             38590099
386000     END-IF.                                                      38600099
386100                                                                  38610099
386200                                                                  38620099
386300                                                                  38630099
386400*----------------------------------------------------------------*38640099
386500* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *38650099
386600*----------------------------------------------------------------*38660099
386700                                                                  38670099
386800 4400-MOVE-COMMAREA-TO-SCREEN.                                    38680099
386900                                                                  38690099
387000     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             38700099
387100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          38710099
387200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          38720099
387300             MOVE +1               TO ASC-BLK-SUB                 38730099
387400             PERFORM 5100-WRITE-TEMP-STORAGE                      38740099
387500             ADD +1                TO ASC-BLK-SUB                 38750099
387600             PERFORM 5100-WRITE-TEMP-STORAGE                      38760099
387700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             38770099
387800                 GIVING PV-BLOCK-NUMBER                           38780099
387900                 REMAINDER PV-REMAINDER                           38790099
388000             IF  PV-REMAINDER > ZERO                              38800099
388100                 ADD +1            TO PV-BLOCK-NUMBER             38810099
388200             END-IF                                               38820099
388300             MOVE +1               TO ASC-BLK-SUB                 38830099
388400             PERFORM 4410-READ-TEMP-STORAGE                       38840099
388500             ADD +1                TO ASC-BLK-SUB                 38850099
388600                                      PV-BLOCK-NUMBER             38860099
388700             PERFORM 4410-READ-TEMP-STORAGE                       38870099
388800     END-IF.                                                      38880099
388900                                                                  38890099
389000     MOVE +1                       TO ASC-BLK-SUB.                38900099
389100                                                                  38910099
389200     COMPUTE ASC-ITEM-SUB =                                       38920099
389300         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              38930099
389400         + PC-ITEMS-PER-PANEL).                                   38940099
389500                                                                  38950099
389600     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        38960099
389700         ADD +1                    TO ASC-BLK-SUB                 38970099
389800         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            38980099
389900     END-IF.                                                      38990099
390000                                                                  39000099
390100     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           39010099
390200         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                39020099
390300                                                                  39030099
390400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        39040099
390500     PERFORM 4420-FORMAT-LIST-LINES                               39050099
390600         VARYING PV-SUB                                           39060099
390700         FROM PC-ITEMS-PER-PANEL BY -1                            39070099
390800         UNTIL PV-SUB < +1.                                       39080099
390900                                                                  39090099
391000     COMPUTE ASC-ITEMS-DISPLAYED =                                39100099
391100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          39110099
391200                                                                  39120099
391300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    39130099
391400                                      ASTRTITO.                   39140099
391500                                                                  39150099
391600     MOVE ASC-PO-NBR                   TO APONBRO.                39160099
391700     MOVE ASC-REC-SEQ-NBR              TO ASEQNBRO.               39170099
391800     MOVE ASC-STAT                     TO ASTATO.                 39180099
391900                                                                  39190099
392000     MOVE SPACES                       TO APKGTYPO                39200099
392100     EVALUATE TRUE                                                39210099
392200         WHEN ASC-PACKAGE-TYPE-CDE = PC-MULTIPLE                  39220099
392300             MOVE PC-MULTI-SKU-PACK-DESC TO APKGTYPO              39230099
392400         WHEN ASC-PACKAGE-TYPE-CDE = PC-SINGLE                    39240099
392500             MOVE PC-SINGLE-SKU-PACK-DESC TO APKGTYPO             39250099
392600         WHEN ASC-PACKAGE-TYPE-CDE = PC-INNER                     39260099
392700             MOVE PC-INNER-PACK-DESC   TO APKGTYPO                39270099
392800         WHEN ASC-PACKAGE-TYPE-CDE = PC-BULK                      39280099
392900             MOVE PC-BULK-PACK-DESC    TO APKGTYPO                39290099
393000         WHEN ASC-PACKAGE-TYPE-CDE = PC-CASE                      39300099
393100             MOVE PC-CASE-PACK-DESC    TO APKGTYPO                39310099
393200         WHEN ASC-PACKAGE-TYPE-CDE = PC-PKG-TYP-NOT-FOUND         39320099
393300             MOVE PC-PKG-TYP-NOT-FOUND TO APKGTYPO                39330099
393400      END-EVALUATE.                                               39340099
393500                                                                  39350099
393600     MOVE ASC-TRECEIV-EXPTD-CART-QTY   TO AEXQTYO.                39360099
393700     MOVE ASC-TRECEIV-ACTL-CART-QTY    TO AACQTYO.                39370099
393800     MOVE ASC-TROUB-STATUS             TO ATRBLO.                 39380099
393900                                                                  39390099
394000                                                                  39400099
394100     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    39410099
394200     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    39420099
394300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            39430099
394400                                   TO ASELITO.                    39440099
394500                                                                  39450099
394600     IF  DP020-MSG-NUMBER-X = SPACE                               39460099
394700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  39470099
394800*            --- MORE ITEMS TO DISPLAY ----                       39480099
394900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            39490099
395000             SET DP020-MSG-INFORMATIONAL                          39500099
395100                                   TO TRUE                        39510099
395200         END-IF                                                   39520099
395300     END-IF.                                                      39530099
395400                                                                  39540099
395500*----------------------------------------------------------------*39550099
395600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *39560099
395700*----------------------------------------------------------------*39570099
395800 4410-READ-TEMP-STORAGE.                                          39580099
395900                                                                  39590099
396000     EXEC CICS                                                    39600099
396100         READQ TS                                                 39610099
396200             QUEUE (ASC-LIST-QUEUE-NAME)                          39620099
396300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               39630099
396400             ITEM  (PV-BLOCK-NUMBER)                              39640099
396500             RESP  (PV-CICS-RESP)                                 39650099
396600     END-EXEC.                                                    39660099
396700                                                                  39670099
396800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       39680099
396900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     39690099
397000         CONTINUE                                                 39700099
397100     ELSE                                                         39710099
397200         SET DP013-CICS-ABEND      TO TRUE                        39720099
397300         SET DP013-NO-ROLLBACK     TO TRUE                        39730099
397400         MOVE '4410-READ-TEMP-STORAGE'                            39740099
397500                                   TO DP013-PARAGRAPH             39750099
397600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      39760099
397700                                   TO DP013-MESSAGE-TEXT(1)       39770099
397800         PERFORM DP013-0000-PROCESS-ABEND                         39780099
397900     END-IF.                                                      39790099
398000                                                                  39800099
398100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      39810099
398200                                   TO TRUE.                       39820099
398300                                                                  39830099
398400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         39840099
398500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               39850099
398600     END-IF.                                                      39860099
398700                                                                  39870099
398800/                                                                 39880099
398900*----------------------------------------------------------------*39890099
399000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *39900099
399100*----------------------------------------------------------------*39910099
399200                                                                  39920099
399300 4420-FORMAT-LIST-LINES.                                          39930099
399400                                                                  39940099
399500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      39950099
399600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                39960099
399700         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         39970099
399800         MOVE SPACES               TO MR-SELECT  (PV-SUB)         39980099
399900         MOVE SPACES               TO MR-STATUS           (PV-SUB)39990099
400000                                      MR-APRON-DATE       (PV-SUB)40000099
400100                                      MR-OTR-PACK         (PV-SUB)40010099
400200                                      MR-ODD-UNITS        (PV-SUB)40020099
400300                                      MR-PACK-ID          (PV-SUB)40030099
400400                                      MR-PKSL-PACK        (PV-SUB)40040099
400500                                      MR-DETAIL-PACK      (PV-SUB)40050099
400600                                      MR-VERIFY-PACK      (PV-SUB)40060099
400700                                      MR-TROUBLE          (PV-SUB)40070099
400800                                      MR-PKITEM-CRE-UID           40080099
400900                                                          (PV-SUB)40090099
401000     ELSE                                                         40100099
401100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      40110099
401200                                                   > SPACE        40120099
401300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 40130099
401400                                   TO MR-SELECT (PV-SUB)          40140099
401500         ELSE                                                     40150099
401600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      40160099
401700                                   TO MR-SELECT (PV-SUB)          40170099
401800         END-IF                                                   40180099
401900                                                                  40190099
402000         IF  DP030-SET-CURSOR-TRAILER                             40200099
402100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)40210099
402200                 > SPACE)                                         40220099
402300               OR (PV-SUB = 1))                                   40230099
402400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               40240099
402500                MOVE -1            TO MR-SELECTL (PV-SUB)         40250099
402600             END-IF                                               40260099
402700         END-IF                                                   40270099
402800                                                                  40280099
402900         IF ASC-LINE-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)             40290099
403000            MOVE -1                TO MR-SELECTL (PV-SUB)         40300099
403100            MOVE DP015-RED         TO MR-SELECTC (PV-SUB)         40310099
403200            MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)         40320099
403300         ELSE                                                     40330099
403400            IF ASC-LINE-NOT-IN-ERROR (ASC-BLK-SUB ASC-ITEM-SUB)   40340099
403500               AND ASC-REDISTRO-FUNCTION                          40350099
403600               MOVE DP015-GREEN    TO MR-SELECTC (PV-SUB)         40360099
403700               MOVE DP015-UNDERLINE                               40370099
403800                                   TO MR-SELECTH (PV-SUB)         40380099
403900               MOVE SPACES         TO MR-SELECT  (PV-SUB)         40390099
404000            END-IF                                                40400099
404100         END-IF                                                   40410099
404200                                                                  40420099
404300         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           40430099
404400                                                                  40440099
404500             MOVE ASC-PACK-ID (ASC-BLK-SUB ASC-ITEM-SUB)          40450099
404600                                 TO MR-PACK-ID  (PV-SUB)          40460099
404700             MOVE ASC-REC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)       40470099
404800                                 TO MR-STATUS (PV-SUB)            40480099
404900                                                                  40490099
405000             IF ASC-REC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)         40500099
405100                                     NOT = PC-VE                  40510099
405200                MOVE ASC-PACK-ID (ASC-BLK-SUB ASC-ITEM-SUB)       40520099
405300                                 TO DK-PACK-ID                    40530099
405400                PERFORM 4369-FIND-PACK-TROUBLE                    40540099
405500                MOVE TRBRSN-TRBL-SHT-DESC                         40550099
405600                                 TO ASC-PACK-TROUBLE-SHORT        40560099
405700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   40570099
405800                MOVE TRBRSN-TRBL-LONG-DESC                        40580099
405900                                 TO ASC-PACK-TROUBLE-LONG         40590099
406000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     40600099
406100                EVALUATE TRUE                                     40610099
406200                   WHEN ASC-LINE-PACK-TRBL                        40620099
406300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     40630099
406400                      CONTINUE                                    40640099
406500                   WHEN PV-PK-UNRSLVD-TRBL-CNT > ZERO             40650099
406600                     OR PV-LN-UNRSLVD-TRBL-CNT > ZERO             40660099
406700                         SET ASC-LINE-IN-TROUBLE                  40670099
406800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  40680099
406900                                 TO TRUE                          40690099
407000                   WHEN PV-PK-RSLVD-TRBL-CNT > ZERO               40700099
407100                     OR PV-LN-RSLVD-TRBL-CNT > ZERO               40710099
407200                        SET ASC-LINE-DISTRO-TRBL                  40720099
407300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    40730099
407400                                 TO TRUE                          40740099
407500                   WHEN OTHER                                     40750099
407600                        SET ASC-NO-LINE-TRBL                      40760099
407700                                    (ASC-BLK-SUB ASC-ITEM-SUB)    40770099
407800                                 TO TRUE                          40780099
407900                END-EVALUATE                                      40790099
408000                                                                  40800099
408100                MOVE ASC-PACK-TROUBLE-SHORT                       40810099
408200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 40820099
408300                                 TO MR-TROUBLE (PV-SUB)           40830099
408400                EVALUATE TRUE                                     40840099
408500                   WHEN ASC-LINE-PACK-TRBL                        40850099
408600                               (ASC-BLK-SUB ASC-ITEM-SUB)         40860099
408700                      MOVE DP015-YELLOW                           40870099
408800                                 TO MR-STATUSC (PV-SUB)           40880099
408900                   WHEN ASC-LINE-IN-TROUBLE                       40890099
409000                               (ASC-BLK-SUB ASC-ITEM-SUB)         40900099
409100                       MOVE DP015-YELLOW                          40910099
409200                                 TO MR-STATUSC (PV-SUB)           40920099
409300                   WHEN ASC-LINE-DISTRO-TRBL                      40930099
409400                               (ASC-BLK-SUB ASC-ITEM-SUB)         40940099
409500                      MOVE DP015-PINK                             40950099
409600                                 TO MR-STATUSC (PV-SUB)           40960099
409700                   WHEN OTHER                                     40970099
409800                       MOVE DP015-BLUE                            40980099
409900                                 TO MR-STATUSC (PV-SUB)           40990099
410000               END-EVALUATE                                       41000099
410100             END-IF                                               41010099
410200                                                                  41020099
410300             MOVE ASC-OTR-PACK (ASC-BLK-SUB ASC-ITEM-SUB)         41030099
410400                                 TO MR-OTR-PACK (PV-SUB)          41040099
410500             MOVE ASC-ODD-UNITS(ASC-BLK-SUB ASC-ITEM-SUB)         41050099
410600                                 TO MR-ODD-UNITS(PV-SUB)          41060099
410700             MOVE ASC-PKSL-PACK (ASC-BLK-SUB ASC-ITEM-SUB)        41070099
410800                                 TO MR-PKSL-PACK (PV-SUB)         41080099
410900             MOVE ASC-DETAIL-PACK (ASC-BLK-SUB ASC-ITEM-SUB)      41090099
411000                                 TO MR-DETAIL-PACK (PV-SUB)       41100099
411100             MOVE ASC-VERIFY-PACK (ASC-BLK-SUB ASC-ITEM-SUB)      41110099
411200                                 TO MR-VERIFY-PACK (PV-SUB)       41120099
411300             MOVE ASC-APRON-DTE (ASC-BLK-SUB ASC-ITEM-SUB)        41130099
411400                                 TO MR-APRON-DATE (PV-SUB)        41140099
411500                                                                  41150099
411600             MOVE ASC-PKITEM-CRE-UID (ASC-BLK-SUB ASC-ITEM-SUB)   41160099
411700                                 TO MR-PKITEM-CRE-UID (PV-SUB)    41170099
411800         END-IF                                                   41180099
411900     END-IF.                                                      41190099
412000                                                                  41200099
412100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               41210099
412200                                                                  41220099
412300     IF  ASC-ITEM-SUB < + 1                                       41230099
412400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  41240099
412500         MOVE +1                 TO ASC-BLK-SUB                   41250099
412600     END-IF.                                                      41260099
412700                                                                  41270099
412800                                                                  41280099
412900*----------------------------------------------------------------*41290099
413000*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *41300099
413100*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *41310099
413200*  ISSUE A WARNING.                                              *41320099
413300*----------------------------------------------------------------*41330099
413400 4430-CHECK-FOR-BEGIN-AND-END.                                    41340099
413500                                                                  41350099
413600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       41360099
413700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     41370099
413800*            -- NO END-OF-RANGE SPECFIED ---                      41380099
413900             MOVE PC-TSYMSG-00051                                 41390099
414000                                 TO DP020-MSG-NUMBER              41400099
414100             SET DP020-MSG-WARNING                                41410099
414200                                 TO TRUE                          41420099
414300             PERFORM 4431-POSITION-AT-WARNING                     41430099
414400         END-IF                                                   41440099
414500     ELSE                                                         41450099
414600         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     41460099
414700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                41470099
414800             MOVE PC-TSYMSG-00053                                 41480099
414900                                 TO DP020-MSG-NUMBER              41490099
415000             SET DP020-MSG-WARNING                                41500099
415100                                 TO TRUE                          41510099
415200             PERFORM 4431-POSITION-AT-WARNING                     41520099
415300         END-IF                                                   41530099
415400     END-IF.                                                      41540099
415500                                                                  41550099
415600*----------------------------------------------------------------*41560099
415700*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *41570099
415800*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *41580099
415900*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *41590099
416000*  POSITION THE CURSOR THERE.                                    *41600099
416100*----------------------------------------------------------------*41610099
416200 4431-POSITION-AT-WARNING.                                        41620099
416300                                                                  41630099
416400     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 41640099
416500                    - PV-TOP-ITEM + 1.                            41650099
416600                                                                  41660099
416700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41670099
416800         CONTINUE                                                 41680099
416900     ELSE                                                         41690099
417000         SET DP030-SET-CURSOR-APPL-1                              41700099
417100                                   TO TRUE                        41710099
417200         MOVE -1                   TO MR-SELECTL (PV-SUB)         41720099
417300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41730099
417400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41740099
417500     END-IF.                                                      41750099
417600                                                                  41760099
417700     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   41770099
417800                    - PV-TOP-ITEM + 1.                            41780099
417900                                                                  41790099
418000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      41800099
418100         CONTINUE                                                 41810099
418200     ELSE                                                         41820099
418300         SET DP030-SET-CURSOR-APPL-1                              41830099
418400                                   TO TRUE                        41840099
418500         MOVE -1                   TO MR-SELECTL (PV-SUB)         41850099
418600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         41860099
418700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         41870099
418800     END-IF.                                                      41880099
418900                                                                  41890099
419000/                                                                 41900099
419100*----------------------------------------------------------------*41910099
419200* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *41920099
419300* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *41930099
419400* FOR THE SELECTED ITEMS QUEUE.                                  *41940099
419500*                                                                *41950099
419600* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *41960099
419700* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *41970099
419800* THE ARRAY IS FULL.                                             *41980099
419900*----------------------------------------------------------------*41990099
420000                                                                  42000099
420100 5000-PREPARE-SEL-QUEUE.                                          42010099
420200                                                                  42020099
420300     MOVE +1                       TO ASC-BLK-SUB.                42030099
420400     PERFORM 5100-WRITE-TEMP-STORAGE.                             42040099
420500     ADD +1                        TO ASC-BLK-SUB.                42050099
420600     PERFORM 5100-WRITE-TEMP-STORAGE.                             42060099
420700                                                                  42070099
420800     MOVE ASC-SEL-QUEUE-NAME-OUT   TO RC800-SEL-QUEUE-NAME.       42080099
420900     PERFORM 6010-DELETE-SEL-QUEUE.                               42090099
421000                                                                  42100099
421100     EVALUATE TRUE                                                42110099
421200* GOTO PACK APRON SCREEN OR TROUBLE LIST                          42120099
421300      WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)                 42130099
421400      WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)                 42140099
421500         MOVE ASC-SEL-QUEUE-NAME-OUT                              42150099
421600                                 TO PC000-SEL-QUEUE-NAME          42160099
421700         PERFORM 6010-DELETE-SEL-QUEUE                            42170099
421800         SET PC016-IDX           TO 1                             42180099
421900         MOVE ZERO               TO PC000-NUMBER-OF-TS-ITEMS      42190099
422000                                 PC000-NUMBER-OF-SELECTED-ITEMS   42200099
422100         INITIALIZE PC016-SELECTED-ITEM-ARRAY                     42210099
422200                                                                  42220099
422300          PERFORM 5210-FILL-SEL-QUEUE-RECORD                      42230099
422400                 VARYING PV-ITEM                                  42240099
422500             FROM 1 BY 1                                          42250099
422600             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN      42260099
422700         IF  PC016-IDX > 1                                        42270099
422800             PERFORM 5206-WRITE-SEL-QUEUE                         42280099
422900             ADD +1              TO PC000-NUMBER-OF-TS-ITEMS      42290099
423000         END-IF                                                   42300099
423100                                                                  42310099
423200     WHEN OTHER                                                   42320099
423300         MOVE ZERO               TO RC800-NUMBER-OF-TS-ITEMS      42330099
423400                              RC800-NUMBER-OF-SELECTED-ITEMS      42340099
423500         INITIALIZE RC801-SELECTED-ITEM-ARRAY                     42350099
423600                                                                  42360099
423700         IF DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                42370099
423800            SET ASC-UPDATE-TSQ3  TO TRUE                          42380099
423900         ELSE                                                     42390099
424000            SET ASC-UPDATE-TSQ   TO TRUE                          42400099
424100         END-IF                                                   42410099
424200                                                                  42420099
424300         SET RC801-IDX           TO 1                             42430099
424400                                                                  42440099
424500          MOVE ASC-SEL-QUEUE-NAME-OUT   TO RC800-SEL-QUEUE-NAME   42450099
424600          PERFORM 5200-FILL-SEL-QUEUE-RECORD                      42460099
424700                 VARYING PV-ITEM                                  42470099
424800             FROM 1 BY 1                                          42480099
424900             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN      42490099
425000                OR PS-EMPTY-PACK                                  42500099
425100         IF  RC801-IDX > 1 OR                                     42510099
425200             DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               42520099
425300             PERFORM 5205-WRITE-SEL-QUEUE                         42530099
425400             ADD +1              TO RC800-NUMBER-OF-TS-ITEMS      42540099
425500         END-IF                                                   42550099
425600     END-EVALUATE.                                                42560099
425700                                                                  42570099
425800                                                                  42580099
425900*----------------------------------------------------------------*42590099
426000*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *42600099
426100*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *42610099
426200*----------------------------------------------------------------*42620099
426300                                                                  42630099
426400 5100-WRITE-TEMP-STORAGE.                                         42640099
426500                                                                  42650099
426600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     42660099
426700                                   TO PV-LIST-ITEM-NUMBER.        42670099
426800     COMPUTE PV-BLOCK-NUMBER =                                    42680099
426900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    42690099
427000                                                                  42700099
427100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             42710099
427200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             42720099
427300         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      42730099
427400             PERFORM 5105-REWRITE-ASC-LISTQ                       42740099
427500         END-IF                                                   42750099
427600     ELSE                                                         42760099
427700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       42770099
427800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            42780099
427900         PERFORM 5110-WRITE-ASC-LISTQ                             42790099
428000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   42800099
428100     END-IF.                                                      42810099
428200                                                                  42820099
428300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      42830099
428400                                   TO TRUE.                       42840099
428500                                                                  42850099
428600/                                                                 42860099
428700*----------------------------------------------------------------*42870099
428800*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *42880099
428900*  SPECIFIC COMMAREA.                                            *42890099
429000*----------------------------------------------------------------*42900099
429100 5105-REWRITE-ASC-LISTQ.                                          42910099
429200                                                                  42920099
429300     EXEC CICS                                                    42930099
429400         WRITEQ TS                                                42940099
429500             QUEUE (ASC-LIST-QUEUE-NAME)                          42950099
429600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               42960099
429700             ITEM  (PV-BLOCK-NUMBER)                              42970099
429800             REWRITE                                              42980099
429900             RESP  (PV-CICS-RESP)                                 42990099
430000     END-EXEC.                                                    43000099
430100                                                                  43010099
430200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           43020099
430300         CONTINUE                                                 43030099
430400     ELSE                                                         43040099
430500         SET DP013-CICS-ABEND      TO TRUE                        43050099
430600         SET DP013-NO-ROLLBACK     TO TRUE                        43060099
430700         MOVE '5105-REWRITE-ASC-LISTQ'                            43070099
430800                                   TO DP013-PARAGRAPH             43080099
430900         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     43090099
431000                                   TO DP013-MESSAGE-TEXT(1)       43100099
431100         PERFORM DP013-0000-PROCESS-ABEND                         43110099
431200     END-IF.                                                      43120099
431300                                                                  43130099
431400/                                                                 43140099
431500*----------------------------------------------------------------*43150099
431600*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *43160099
431700*  SPECIFIC COMMAREA.                                            *43170099
431800*----------------------------------------------------------------*43180099
431900 5110-WRITE-ASC-LISTQ.                                            43190099
432000                                                                  43200099
432100     EXEC CICS                                                    43210099
432200         WRITEQ TS                                                43220099
432300             QUEUE (ASC-LIST-QUEUE-NAME)                          43230099
432400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               43240099
432500             ITEM  (PV-BLOCK-NUMBER)                              43250099
432600             RESP  (PV-CICS-RESP)                                 43260099
432700     END-EXEC.                                                    43270099
432800                                                                  43280099
432900     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      43290099
433000         SET DP013-CICS-ABEND      TO TRUE                        43300099
433100         SET DP013-NO-ROLLBACK     TO TRUE                        43310099
433200         MOVE '5110-WRITE-ASC-LISTQ'                              43320099
433300                                   TO DP013-PARAGRAPH             43330099
433400         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           43340099
433500                                   TO DP013-MESSAGE-TEXT(1)       43350099
433600         PERFORM DP013-0000-PROCESS-ABEND                         43360099
433700     END-IF.                                                      43370099
433800                                                                  43380099
433900/                                                                 43390099
434000*----------------------------------------------------------------*43400099
434100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *43410099
434200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *43420099
434300*----------------------------------------------------------------*43430099
434400                                                                  43440099
434500 5200-FILL-SEL-QUEUE-RECORD.                                      43450099
434600                                                                  43460099
434700     PERFORM 6112-READ-LIST-QUEUE.                                43470099
434800     SET PS-PACK-NOT-EMPTY    TO TRUE.                            43480099
434900                                                                  43490099
435000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       43500099
435100         PERFORM                                                  43510099
435200         VARYING LQW-IDX                                          43520099
435300         FROM 1 BY 1                                              43530099
435400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            43540099
435500           OR LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO           43550099
435600           OR PS-EMPTY-PACK                                       43560099
435700                                                                  43570099
435800             SET LQW-LINE-NOT-IN-ERROR (LQW-IDX)                  43580099
435900                                    TO TRUE                       43590099
436000                                                                  43600099
436100             IF LQW-SELECT (LQW-IDX) OR                           43610099
436200                DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)            43620099
436300                                                                  43630099
436400                 PERFORM 4100-PREPARE-CURSOR                      43640099
436500                 MOVE LQW-PACK-ID (LQW-IDX)                       43650099
436600                                    TO DK-PACK-ID                 43660099
436700                                                                  43670099
436800                 PERFORM 2160-DETERMINE-IF-PACK                   43680099
436900                 IF PV-PACK-LINE-COUNT = 0     AND                43690099
437000                   (DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  OR    43700099
437100                    DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)  OR    43710099
437200                    DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)  OR    43720099
437300                    DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID))       43730099
437400                    SET PS-EMPTY-PACK                             43740099
437500                                    TO TRUE                       43750099
437600                 ELSE                                             43760099
437700                   PERFORM 2165-DETERMINE-IF-PKSLIP-EXIST         43770099
437800                   IF PV-PACKSLIP-COUNT > 0 AND                   43780099
437900                     (DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID) OR   43790099
438000                      DP020-FK-CONFIRM (DP020-SRC-AID))           43800099
438100                      MOVE PC-TSYMSG-03244  TO DP020-MSG-NUMBER   43810099
438200                      SET PS-ERROR                                43820099
438300                          DP030-OVERRIDE-GO                       43830099
438400                          ASC-DELETE-NOT-PENDING                  43840099
438500                          DP020-MSG-FATAL   TO TRUE               43850099
438600                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       43860099
438700                   ELSE                                           43870099
438800                      MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)         43880099
438900                                         TO RC801-ITEM (RC801-IDX)43890099
439000                      MOVE SPACE         TO                       43900099
439100                                       RC801-ACTION-SW (RC801-IDX)43910099
439200                      ADD +1         TO                           43920099
439300                                   RC800-NUMBER-OF-SELECTED-ITEMS 43930099
439400                      MOVE LQW-PACK-ID (LQW-IDX)                  43940099
439500                                    TO RC801-PACK-ID  (RC801-IDX) 43950099
439600                      MOVE LQW-OTR-PACK  (LQW-IDX)                43960099
439700                                    TO RC801-PACK-OTR-QTY         43970099
439800                                                      (RC801-IDX) 43980099
439900                      MOVE LQW-PACK-TROUBLE-LONG (LQW-IDX)        43990099
440000                                    TO RC801-PK-TRBL-RSN-LONG     44000099
440100                                                      (RC801-IDX) 44010099
440200                      MOVE LQW-PKSL-PACK (LQW-IDX)                44020099
440300                                    TO RC801-PKSL-PACK-QTY        44030099
440400                                                      (RC801-IDX) 44040099
440500                      MOVE ASC-INNER-PACK-QTY                     44050099
440600                                    TO RC800-INNER-PACK-QTY       44060099
440700                      MOVE LQW-DETAIL-PACK (LQW-IDX)              44070099
440800                                    TO RC801-DTL-PACK-QTY         44080099
440900                                                      (RC801-IDX) 44090099
441000                      MOVE LQW-ODD-UNITS (LQW-IDX)                44100099
441100                                    TO RC801-ODD-UNITS-PACK-QTY   44110099
441200                                                      (RC801-IDX) 44120099
441300                      MOVE LQW-TOT-RATIO-QTY (LQW-IDX)            44130099
441400                                    TO RC801-REC-RATIO-TOTAL      44140099
441500                                                      (RC801-IDX) 44150099
441600                      MOVE LQW-TOT-PO-RATIO-QTY (LQW-IDX)         44160099
441700                                    TO RC801-PO-RATIO-TOTAL       44170099
441800                                                      (RC801-IDX) 44180099
441900*    IF GOING TO PACK BY STORE DISTRO OR PACK UPDATE OR CREATE    44190099
442000*    TROUBLE NEED TO FIND THE DRIVER LINE INFO                    44200099
442100                 IF DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID) OR     44210099
442200                    DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID) OR     44220099
442300                    DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)        44230099
442400                      PERFORM 4100-PREPARE-CURSOR                 44240099
442500                      MOVE LQW-PACK-ID (LQW-IDX)                  44250099
442600                                     TO DK-PACK-ID                44260099
442700                      PERFORM 5214-RETRIEVE-DRIVER-LINE           44270099
442800                      MOVE RECITM-CASE-PACK-QTY                   44280099
442900                                     TO RC800-INNER-PACK-QTY      44290099
443000                      MOVE RECITM-ORD-LNE-NBR                     44300099
443100                                     TO RC801-REC-LNE-NBR         44310099
443200                                                      (RC801-IDX) 44320099
443300                 ELSE                                             44330099
443400*    IF DOING A REDISTRO                                          44340099
443500                    IF DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)     44350099
443600                       PERFORM 6500-PROCESS-REDISTRO              44360099
443700                 ELSE                                             44370099
443800*    IF DOING A DELETE                                            44380099
443900                    IF DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID) OR  44390099
444000                       (ASC-DELETE-PENDING       AND              44400099
444100                        DP020-FK-CONFIRM (DP020-SRC-AID)) AND     44410099
444200                        PS-PACK-NOT-EMPTY                         44420099
444300                       PERFORM 5500-PROCESS-DELETE-PACK           44430099
444400                       IF SQLCODE = +0  AND                       44440099
444500                          (ASC-DELETE-PENDING       AND           44450099
444600                           DP020-FK-CONFIRM (DP020-SRC-AID))      44460099
444700                            SET LQW-DESELECT (LQW-IDX)            44470099
444800                                   TO TRUE                        44480099
444900                            MOVE LQW-SELECTED-SW (LQW-IDX)        44490099
445000                                   TO LQW-TEMP-SELECTED-SW        44500099
445100                                                      (LQW-IDX)   44510099
445200                       END-IF                                     44520099
445300                    END-IF                                        44530099
445400                  END-IF                                          44540099
445500                  END-IF                                          44550099
445600                 END-IF                                           44560099
445700                                                                  44570099
445800                 SET RC801-IDX UP BY 1                            44580099
445900                 IF  RC801-IDX > RC801-MAX-ITEMS                  44590099
446000                     PERFORM 5205-WRITE-SEL-QUEUE                 44600099
446100                     ADD +1        TO RC800-NUMBER-OF-TS-ITEMS    44610099
446200                     INITIALIZE RC801-SELECTED-ITEM-ARRAY         44620099
446300                     SET RC801-IDX TO 1                           44630099
446400                 END-IF                                           44640099
446500               END-IF                                             44650099
446600             END-IF                                               44660099
446700         END-PERFORM                                              44670099
446800     END-IF.                                                      44680099
446900                                                                  44690099
447000     MOVE PV-ITEM TO PV-SAVE-ITEM.                                44700099
447100     PERFORM 6111-WRITE-LIST-QUEUE.                               44710099
447200                                                                  44720099
447300*----------------------------------------------------------------*44730099
447400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *44740099
447500*----------------------------------------------------------------*44750099
447600                                                                  44760099
447700 5205-WRITE-SEL-QUEUE.                                            44770099
447800                                                                  44780099
447900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            44790099
448000                                   TO                             44800099
448100                                RC800-NUMBER-OF-SELECTED-ITEMS.   44810099
448200                                                                  44820099
448300     EXEC CICS                                                    44830099
448400          WRITEQ TS                                               44840099
448500              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      44850099
448600              FROM  (RC801-PREPACK-SELECT-RECORD)                 44860099
448700              ITEM  (PV-SEL-QUEUE-ITEM)                           44870099
448800              RESP  (PV-CICS-RESP)                                44880099
448900     END-EXEC.                                                    44890099
449000                                                                  44900099
449100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          44910099
449200         CONTINUE                                                 44920099
449300     ELSE                                                         44930099
449400         SET DP013-CICS-ABEND      TO TRUE                        44940099
449500         SET DP013-NO-ROLLBACK     TO TRUE                        44950099
449600         MOVE '5205-WRITE-SEL-QUEUE'                              44960099
449700                                   TO DP013-PARAGRAPH             44970099
449800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          44980099
449900                                   TO DP013-MESSAGE-TEXT(1)       44990099
450000         PERFORM DP013-0000-PROCESS-ABEND                         45000099
450100     END-IF.                                                      45010099
450200                                                                  45020099
450300*----------------------------------------------------------------*45030099
450400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *45040099
450500*----------------------------------------------------------------*45050099
450600                                                                  45060099
450700 5206-WRITE-SEL-QUEUE.                                            45070099
450800                                                                  45080099
450900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            45090099
451000                                   TO PC016-SELECTED-ITEMS.       45100099
451100     EXEC CICS                                                    45110099
451200          WRITEQ TS                                               45120099
451300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      45130099
451400              FROM  (PC016-TS-SEL-REC)                            45140099
451500              ITEM  (PV-SEL-QUEUE-ITEM)                           45150099
451600              RESP  (PV-CICS-RESP)                                45160099
451700     END-EXEC.                                                    45170099
451800                                                                  45180099
451900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          45190099
452000         CONTINUE                                                 45200099
452100     ELSE                                                         45210099
452200         SET DP013-CICS-ABEND      TO TRUE                        45220099
452300         SET DP013-NO-ROLLBACK     TO TRUE                        45230099
452400         MOVE '5205-WRITE-SEL-QUEUE'                              45240099
452500                                   TO DP013-PARAGRAPH             45250099
452600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          45260099
452700                                   TO DP013-MESSAGE-TEXT(1)       45270099
452800         PERFORM DP013-0000-PROCESS-ABEND                         45280099
452900     END-IF.                                                      45290099
453000                                                                  45300099
453100                                                                  45310099
453200*----------------------------------------------------------------*45320099
453300* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *45330099
453400* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD - RC013        *45340099
453500*----------------------------------------------------------------*45350099
453600                                                                  45360099
453700 5210-FILL-SEL-QUEUE-RECORD.                                      45370099
453800                                                                  45380099
453900     PERFORM 6112-READ-LIST-QUEUE.                                45390099
454000                                                                  45400099
454100     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       45410099
454200         PERFORM                                                  45420099
454300         VARYING LQW-IDX                                          45430099
454400         FROM 1 BY 1                                              45440099
454500         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            45450099
454600           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          45460099
454700                                                                  45470099
454800             IF  (LQW-SELECT (LQW-IDX))                           45480099
454900                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         45490099
455000                 PERFORM 4100-PREPARE-CURSOR                      45500099
455100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              45510099
455200                                    TO PC016-ITEM (PC016-IDX)     45520099
455300                 MOVE SPACE         TO PC016-ACTION-SW (PC016-IDX)45530099
455400                 MOVE ASC-OPR-ID    TO PC016-OPER-UNT-ID          45540099
455500                                                       (PC016-IDX)45550099
455600                 MOVE ASC-FACT      TO PC016-FCLTY-ID             45560099
455700                                                       (PC016-IDX)45570099
455800                 MOVE ASC-PO-NBR    TO PC016-PO-NBR-N  (PC016-IDX)45580099
455900                 MOVE ASC-REC-SEQ-NBR                             45590099
456000                                    TO PC016-REC-SEQ-NBR-N        45600099
456100                                                       (PC016-IDX)45610099
456200                                                                  45620099
456300* SINCE PC016-PACK-ID AND PC016-LINE-NBR ARE THE SAME FIELD JUST  45630099
456400* REDEFINED, IF GOING TO PACK APRON, FILL PACK ID ELSE FILL LINE  45640099
456500* NUMBER.                                                         45650099
456600                 IF DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)        45660099
456700                    IF LQW-PACK-ID (LQW-IDX) = 99                 45670099
456800                       SET PS-UNTIED-PACK                         45680099
456900                                    TO TRUE                       45690099
457000                    END-IF                                        45700099
457100                    MOVE LQW-PACK-ID (LQW-IDX)                    45710099
457200                                    TO PC016-PACK-ID  (PC016-IDX) 45720099
457300                                       DK-PACK-ID                 45730099
457400                    PERFORM 2160-DETERMINE-IF-PACK                45740099
457500                    IF PV-PACK-LINE-COUNT = 0                     45750099
457600                        SET PS-EMPTY-PACK                         45760099
457700                                    TO TRUE                       45770099
457800                    END-IF                                        45780099
457900                 ELSE                                             45790099
458000                    IF LQW-PACK-ID (LQW-IDX) = 99                 45800099
458100                       SET PS-UNTIED-PACK                         45810099
458200                                     TO TRUE                      45820099
458300                    END-IF                                        45830099
458400                    PERFORM 4100-PREPARE-CURSOR                   45840099
458500                    MOVE LQW-PACK-ID (LQW-IDX)                    45850099
458600                                     TO DK-PACK-ID                45860099
458700                    PERFORM 5214-RETRIEVE-DRIVER-LINE             45870099
458800                    MOVE RECITM-ORD-LNE-NBR                       45880099
458900                                    TO PC016-LINE-NBR-N(PC016-IDX)45890099
459000                 END-IF                                           45900099
459100                                                                  45910099
459200                 MOVE PC-Y          TO PC016-MRKG-APRON-REQ-IND   45920099
459300                                                       (PC016-IDX)45930099
459400                                                                  45940099
459500                 SET PC016-IDX UP BY 1                            45950099
459600                 IF  PC016-IDX > PC016-MAX-ITEMS                  45960099
459700                     PERFORM 5206-WRITE-SEL-QUEUE                 45970099
459800                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    45980099
459900                     INITIALIZE PC016-SELECTED-ITEM-ARRAY         45990099
460000                     SET PC016-IDX TO 1                           46000099
460100                 END-IF                                           46010099
460200             END-IF                                               46020099
460300         END-PERFORM                                              46030099
460400     END-IF.                                                      46040099
460500                                                                  46050099
460600     MOVE PV-ITEM TO PV-SAVE-ITEM.                                46060099
460700     PERFORM 6111-WRITE-LIST-QUEUE.                               46070099
460800                                                                  46080099
460900                                                                  46090099
461000*----------------------------------------------------------------*46100099
461100* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *46110099
461200* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD - RC013        *46120099
461300*----------------------------------------------------------------*46130099
461400                                                                  46140099
461500 5211-FILL-SEL-QUEUE-RECORD2.                                     46150099
461600                                                                  46160099
461700     PERFORM 6112-READ-LIST-QUEUE.                                46170099
461800                                                                  46180099
461900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       46190099
462000         PERFORM                                                  46200099
462100         VARYING LQW-IDX                                          46210099
462200         FROM 1 BY 1                                              46220099
462300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            46230099
462400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          46240099
462500                                                                  46250099
462600             IF  (LQW-SELECT (LQW-IDX))                           46260099
462700                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         46270099
462800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              46280099
462900                                    TO RC013-ITEM      (RC013-IDX)46290099
463000                 MOVE SPACE         TO RC013-ACTION-SW (RC013-IDX)46300099
463100                 MOVE ASC-OPR-ID    TO RC013-OPER-UNT-ID          46310099
463200                                                       (RC013-IDX)46320099
463300                 MOVE ASC-FACT      TO RC013-FCLTY-ID  (RC013-IDX)46330099
463400                 MOVE ASC-PO-NBR    TO RC013-PO-NBR    (RC013-IDX)46340099
463500                 MOVE ASC-REC-SEQ-NBR                             46350099
463600                                    TO RC013-REC-SEQ-NBR          46360099
463700                                                       (RC013-IDX)46370099
463800                 PERFORM 4100-PREPARE-CURSOR                      46380099
463900                 MOVE LQW-PACK-ID (LQW-IDX)                       46390099
464000                                     TO DK-PACK-ID                46400099
464100                 PERFORM 5214-RETRIEVE-DRIVER-LINE                46410099
464200                 MOVE RECITM-ORD-LNE-NBR                          46420099
464300                                    TO RC013-PKSL-LNE-NBR-N       46430099
464400                                                       (RC013-IDX)46440099
464500                 SET RC013-IDX UP BY 1                            46450099
464600                 IF  RC013-IDX > RC013-MAX-ITEMS                  46460099
464700                     PERFORM 5215-WRITE-SEL-QUEUE                 46470099
464800                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    46480099
464900                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         46490099
465000                     SET RC013-IDX TO 1                           46500099
465100                 END-IF                                           46510099
465200             END-IF                                               46520099
465300         END-PERFORM                                              46530099
465400     END-IF.                                                      46540099
465500                                                                  46550099
465600     MOVE PV-ITEM TO PV-SAVE-ITEM.                                46560099
465700     PERFORM 6111-WRITE-LIST-QUEUE.                               46570099
465800                                                                  46580099
465900                                                                  46590099
466000*----------------------------------------------------------------*46600099
466100*    RETRIEVE THE DRIVER LINE INFORMATION                        *46610099
466200*----------------------------------------------------------------*46620099
466300 5214-RETRIEVE-DRIVER-LINE.                                       46630099
466400                                                                  46640099
466500     EXEC SQL                                                     46650099
466600           SELECT DISTINCT                                        46660099
466700                  ORD_NBR                                         46670099
466800                , ORD_LNE_NBR                                     46680099
466900                , STATUS_CDE                                      46690099
467000                , MKING_APRON_TMST                                46700099
467100                , CASE_PACK_QTY                                   46710099
467200           INTO                                                   46720099
467300                 :RECITM-ORD-NBR                                  46730099
467400                ,:RECITM-ORD-LNE-NBR                              46740099
467500                ,:RECITM-STATUS-CDE                               46750099
467600                ,:RECITM-MKING-APRON-TMST                         46760099
467700                ,:RECITM-CASE-PACK-QTY                            46770099
467800           FROM                                                   46780099
467900                  TRECITM                                         46790099
468000           WHERE                                                  46800099
468100                  ORD_NBR           = :DK-ORD-NBR                 46810099
468200             AND  REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR            46820099
468300             AND  VER_STATUS_CDE    = 'A'                         46830099
468400             AND  OPER_UNT_ID       = :DK-OPR-ID                  46840099
468500             AND  FCLTY_ID          = :DK-FACT                    46850099
468600             AND  PREPK_ID          = :DK-PACK-ID                 46860099
468700             AND  PREPK_DRV_LNE_CDE = 'A'                         46870099
468800     END-EXEC.                                                    46880099
468900                                                                  46890099
469000     EVALUATE TRUE                                                46900099
469100         WHEN SQLCODE = +0                                        46910099
469200              CONTINUE                                            46920099
469300         WHEN SQLCODE = +100                                      46930099
469400              MOVE PC-DEFAULT-TMST                                46940099
469500                               TO RECITM-MKING-APRON-TMST         46950099
469600         WHEN SQLCODE = -811                                      46960099
469700              MOVE PC-CURRENT-PROGRAM-ERROR                       46970099
469800                                         TO DP020-MSG-TEXT        46980099
469900              MOVE PC-TSYMSG-02229       TO DP020-MSG-NUMBER      46990099
470000              SET PS-ERROR                                        47000099
470100                  DP020-MSG-FATAL                                 47010099
470200                  PS-COMMAREA-NOT-VALID                           47020099
470300                  DP020-NEXT-ACT-APPL-ERROR                       47030099
470400                                         TO TRUE                  47040099
470500              MOVE PC-DEFAULT-TMST                                47050099
470600                               TO RECITM-MKING-APRON-TMST         47060099
470700         WHEN SQLCODE = -904                                      47070099
470800         WHEN SQLCODE = -911                                      47080099
470900         WHEN SQLCODE = -913                                      47090099
471000              PERFORM 9900-SOFT-ABORT                             47100099
471100                                                                  47110099
471200         WHEN OTHER                                               47120099
471300              MOVE '5412-RETRIEVE-DRIVER-LINE'                    47130099
471400                               TO DP013-PARAGRAPH                 47140099
471500              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               47150099
471600                               TO DP013-MESSAGE-TEXT (1)          47160099
471700              MOVE SQLCA       TO DP013-SQLCA                     47170099
471800              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        47180099
471900              PERFORM 9950-FORMAT-ERROR-MSG                       47190099
472000              SET DP013-DB2-ABEND                                 47200099
472100                  DP013-XCTL-DISPLAY-RESTART                      47210099
472200                               TO TRUE                            47220099
472300              PERFORM DP013-0000-PROCESS-ABEND                    47230099
472400     END-EVALUATE.                                                47240099
472500                                                                  47250099
472600                                                                  47260099
472700                                                                  47270099
472800*----------------------------------------------------------------*47280099
472900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE - RC013.        *47290099
473000*----------------------------------------------------------------*47300099
473100                                                                  47310099
473200 5215-WRITE-SEL-QUEUE.                                            47320099
473300                                                                  47330099
473400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            47340099
473500                                   TO RC013-SELECTED-ITEMS.       47350099
473600                                                                  47360099
473700     EXEC CICS                                                    47370099
473800          WRITEQ TS                                               47380099
473900              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      47390099
474000              FROM  (RC013-DC-SELECT-RECORD)                      47400099
474100              ITEM  (PV-SEL-QUEUE-ITEM)                           47410099
474200              RESP  (PV-CICS-RESP)                                47420099
474300     END-EXEC.                                                    47430099
474400                                                                  47440099
474500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          47450099
474600         CONTINUE                                                 47460099
474700     ELSE                                                         47470099
474800         SET DP013-CICS-ABEND      TO TRUE                        47480099
474900         SET DP013-NO-ROLLBACK     TO TRUE                        47490099
475000         MOVE '5215-WRITE-SEL-QUEUE'                              47500099
475100                                   TO DP013-PARAGRAPH             47510099
475200         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          47520099
475300                                   TO DP013-MESSAGE-TEXT(1)       47530099
475400         PERFORM DP013-0000-PROCESS-ABEND                         47540099
475500     END-IF.                                                      47550099
475600                                                                  47560099
475700/                                                                 47570099
475800*----------------------------------------------------------------*47580099
475900*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE - RC801.        *47590099
476000*----------------------------------------------------------------*47600099
476100 5250-FILL-SEL-QUEUE-RECORD2.                                     47610099
476200                                                                  47620099
476300     PERFORM 6112-READ-LIST-QUEUE.                                47630099
476400                                                                  47640099
476500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       47650099
476600         PERFORM                                                  47660099
476700         VARYING LQW-IDX                                          47670099
476800         FROM 1 BY 1                                              47680099
476900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            47690099
477000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          47700099
477100                                                                  47710099
477200             IF  (LQW-SELECT (LQW-IDX))                           47720099
477300                 ADD +1 TO RC800-NUMBER-OF-SELECTED-ITEMS         47730099
477400                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              47740099
477500                                    TO RC801-ITEM (RC801-IDX)     47750099
477600                 MOVE SPACE         TO RC801-ACTION-SW (RC801-IDX)47760099
477700                 IF LQW-REC-STATUS (LQW-IDX) = 'VE'               47770099
477800                    SET PS-LINE-VERIFIED TO TRUE                  47780099
477900                 END-IF                                           47790099
478000             END-IF                                               47800099
478100         END-PERFORM                                              47810099
478200     END-IF.                                                      47820099
478300                                                                  47830099
478400     MOVE PV-ITEM TO PV-SAVE-ITEM.                                47840099
478500     PERFORM 6111-WRITE-LIST-QUEUE.                               47850099
478600                                                                  47860099
478700                                                                  47870099
478800/                                                                 47880099
478900*----------------------------------------------------------------*47890099
479000*    DELETES THE ENTIRE  PACK (LOGICALLY)                        *47900099
479100*----------------------------------------------------------------*47910099
479200 5500-PROCESS-DELETE-PACK.                                        47920099
479300                                                                  47930099
479400        PERFORM 6508-OPEN-CURSOR                                  47940099
479500        PERFORM 6510-FETCH-ALL-LINES                              47950099
479600        PERFORM 6509-CLOSE-CURSOR.                                47960099
479700                                                                  47970099
479800        IF ASC-DELETE-PENDING AND                                 47980099
479900           DP020-FK-CONFIRM (DP020-SRC-AID) AND                   47990099
480000           SQLCODE = +0                                           48000099
480010* JAK 06/2007 - ADD WMS SPECIFIC MESSAGE                          48001099
480011           IF PS-ASNS-TO-WMS-YES                                  48001199
480020               PERFORM 3604-CALL-WMS-MODULE                       48002099
480030               IF WS001-SUCCESSFUL                                48003099
480100                   MOVE PC-TSYMSG-03578   TO DP020-MSG-NUMBER     48010099
480101               ELSE                                               48010199
480102                   MOVE PC-TSYMSG-03546   TO DP020-MSG-NUMBER     48010299
480103               END-IF                                             48010399
480104           ELSE                                                   48010499
480110               MOVE PC-TSYMSG-00059       TO DP020-MSG-NUMBER     48011099
480120           END-IF                                                 48012099
480200           SET DP030-OVERRIDE-GO                                  48020099
480300               DP020-MSG-FATAL        TO TRUE.                    48030099
480400                                                                  48040099
480500                                                                  48050099
480600*----------------------------------------------------------------*48060099
480700*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *48070099
480800*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *48080099
480900*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *48090099
481000*  THE USER.                                                     *48100099
481100*----------------------------------------------------------------*48110099
481200                                                                  48120099
481300 6000-REFRESH-PANEL-FROM-TEMP.                                    48130099
481400                                                                  48140099
481500     IF (ASC-UPDATE-TSQ                                           48150099
481600     OR  ASC-UPDATE-TSQ2                                          48160099
481700     OR  ASC-UPDATE-TSQ4)                                         48170099
481800         MOVE ZERO                 TO PV-SAVE-ITEM                48180099
481900                                      PV-SEL-QUEUE-ITEM           48190099
482000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        48200099
482100                                   TO PV-HOLD-SELECTED-ITEMS      48210099
482200         IF  ASC-UPDATE-TSQ                                       48220099
482300             PERFORM 6100-UPDATE-TSQ                              48230099
482400                 UNTIL PV-ITEMS-PROCESSED >                       48240099
482500                                     ASC-NUMBER-OF-SELECTED-ITEMS 48250099
482600         ELSE                                                     48260099
482700            IF  ASC-UPDATE-TSQ2                                   48270099
482800                PERFORM 6101-UPDATE-TSQ2                          48280099
482900                    UNTIL PV-ITEMS-PROCESSED >                    48290099
483000                                     ASC-NUMBER-OF-SELECTED-ITEMS 48300099
483100            ELSE                                                  48310099
483200                PERFORM 6102-UPDATE-TSQ4                          48320099
483300                    UNTIL PV-ITEMS-PROCESSED >                    48330099
483400                                     ASC-NUMBER-OF-SELECTED-ITEMS 48340099
483500            END-IF                                                48350099
483600         END-IF                                                   48360099
483700                                                                  48370099
483800         PERFORM 6010-DELETE-SEL-QUEUE                            48380099
483900         SET ASC-NO-TSQ-UPDATE TO TRUE                            48390099
484000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         48400099
484100                    ASC-BLOCK-ENTRIES (2)                         48410099
484200                                                                  48420099
484300         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 48430099
484400                GIVING PV-BLOCK-NUMBER                            48440099
484500                REMAINDER PV-REMAINDER                            48450099
484600         IF  PV-REMAINDER > ZERO                                  48460099
484700             ADD +1     TO PV-BLOCK-NUMBER                        48470099
484800         END-IF                                                   48480099
484900         MOVE +1        TO ASC-BLK-SUB                            48490099
485000         PERFORM 4410-READ-TEMP-STORAGE                           48500099
485100         ADD +1         TO ASC-BLK-SUB                            48510099
485200                           PV-BLOCK-NUMBER                        48520099
485300         PERFORM 4410-READ-TEMP-STORAGE                           48530099
485400     ELSE IF ASC-UPDATE-TSQ3                                      48540099
485500          SET ASC-NO-TSQ-UPDATE TO TRUE                           48550099
485600          PERFORM 2050-DELETE-LIST-QUEUE                          48560099
485700          PERFORM 4000-BUILD-INITIAL-PANEL                        48570099
485800     END-IF.                                                      48580099
485900                                                                  48590099
486000/                                                                 48600099
486100*----------------------------------------------------------------*48610099
486200*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *48620099
486300*----------------------------------------------------------------*48630099
486400 6010-DELETE-SEL-QUEUE.                                           48640099
486500                                                                  48650099
486600     EXEC CICS                                                    48660099
486700         DELETEQ TS                                               48670099
486800             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       48680099
486900             RESP  (PV-CICS-RESP)                                 48690099
487000     END-EXEC.                                                    48700099
487100                                                                  48710099
487200     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      48720099
487300         (PV-CICS-RESP = DFHRESP(QIDERR)))                        48730099
487400         CONTINUE                                                 48740099
487500     ELSE                                                         48750099
487600         SET DP013-CICS-ABEND      TO TRUE                        48760099
487700         SET DP013-NO-ROLLBACK     TO TRUE                        48770099
487800         MOVE '6010-DELETE-SEL-QUEUE'                             48780099
487900                                   TO DP013-PARAGRAPH             48790099
488000         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         48800099
488100                                   TO DP013-MESSAGE-TEXT (1)      48810099
488200         PERFORM DP013-0000-PROCESS-ABEND                         48820099
488300     END-IF.                                                      48830099
488400/                                                                 48840099
488500*----------------------------------------------------------------*48850099
488600*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *48860099
488700*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *48870099
488800*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *48880099
488900*    THE TEMP QUEUE.                                             *48890099
489000*----------------------------------------------------------------*48900099
489100                                                                  48910099
489200 6100-UPDATE-TSQ.                                                 48920099
489300                                                                  48930099
489400     ADD 1                         TO PV-SEL-QUEUE-ITEM.          48940099
489500     PERFORM 6105-READ-SEL-QUEUE.                                 48950099
489600                                                                  48960099
489700     PERFORM                                                      48970099
489800         VARYING RC801-IDX                                        48980099
489900         FROM 1 BY 1                                              48990099
490000         UNTIL ((PV-ITEMS-PROCESSED >                             49000099
490100                              PV-HOLD-SELECTED-ITEMS)             49010099
490200         OR (RC801-IDX GREATER THAN RC801-MAX-ITEMS))             49020099
490300         IF  RC801-ACTION-SW (RC801-IDX) > SPACE                  49030099
490400             PERFORM 6110-PROCESS-ITEMS                           49040099
490500         END-IF                                                   49050099
490600         ADD +1                    TO PV-ITEMS-PROCESSED          49060099
490700     END-PERFORM.                                                 49070099
490800                                                                  49080099
490900     PERFORM 6111-WRITE-LIST-QUEUE.                               49090099
491000/                                                                 49100099
491100*----------------------------------------------------------------*49110099
491200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *49120099
491300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *49130099
491400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *49140099
491500*    THE TEMP QUEUE.                                             *49150099
491600*----------------------------------------------------------------*49160099
491700                                                                  49170099
491800 6101-UPDATE-TSQ2.                                                49180099
491900                                                                  49190099
492000     ADD 1                         TO PV-SEL-QUEUE-ITEM.          49200099
492100     PERFORM 6106-READ-SEL-QUEUE2.                                49210099
492200                                                                  49220099
492300     PERFORM                                                      49230099
492400         VARYING RC013-IDX                                        49240099
492500         FROM 1 BY 1                                              49250099
492600         UNTIL ((PV-ITEMS-PROCESSED >                             49260099
492700                              PV-HOLD-SELECTED-ITEMS)             49270099
492800         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             49280099
492900             IF  RC013-ACTION-SW (RC013-IDX) > SPACE AND          49290099
493000                 RC013-ACTION-SW (RC013-IDX) NOT NUMERIC          49300099
493100                 PERFORM 6108-PROCESS-ITEMS2                      49310099
493200             END-IF                                               49320099
493300         ADD +1                    TO PV-ITEMS-PROCESSED          49330099
493400     END-PERFORM.                                                 49340099
493500                                                                  49350099
493600     PERFORM 6111-WRITE-LIST-QUEUE.                               49360099
493700/                                                                 49370099
493800*----------------------------------------------------------------*49380099
493900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *49390099
494000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *49400099
494100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *49410099
494200*    THE TEMP QUEUE.                                             *49420099
494300*----------------------------------------------------------------*49430099
494400                                                                  49440099
494500 6102-UPDATE-TSQ4.                                                49450099
494600                                                                  49460099
494700     ADD 1                         TO PV-SEL-QUEUE-ITEM.          49470099
494800     PERFORM 6107-READ-SEL-QUEUE4.                                49480099
494900                                                                  49490099
495000     PERFORM                                                      49500099
495100         VARYING PC016-IDX                                        49510099
495200         FROM 1 BY 1                                              49520099
495300         UNTIL ((PV-ITEMS-PROCESSED >                             49530099
495400                              PV-HOLD-SELECTED-ITEMS)             49540099
495500         OR (PC016-IDX GREATER THAN PC016-MAX-ITEMS))             49550099
495600             IF  PC016-ACTION-SW (PC016-IDX) > SPACE AND          49560099
495700                 PC016-ACTION-SW (PC016-IDX) NOT NUMERIC          49570099
495800                 PERFORM 6109-PROCESS-ITEMS4                      49580099
495900             END-IF                                               49590099
496000         ADD +1                    TO PV-ITEMS-PROCESSED          49600099
496100     END-PERFORM.                                                 49610099
496200                                                                  49620099
496300     PERFORM 6111-WRITE-LIST-QUEUE.                               49630099
496400/                                                                 49640099
496500*----------------------------------------------------------------*49650099
496600*    READ THE LIST QUEUE RECORD.                                 *49660099
496700*----------------------------------------------------------------*49670099
496800                                                                  49680099
496900 6105-READ-SEL-QUEUE.                                             49690099
497000                                                                  49700099
497100     EXEC CICS                                                    49710099
497200          READQ TS                                                49720099
497300              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      49730099
497400              INTO  (RC801-PREPACK-SELECT-RECORD)                 49740099
497500              ITEM  (PV-SEL-QUEUE-ITEM)                           49750099
497600              RESP  (PV-CICS-RESP)                                49760099
497700     END-EXEC.                                                    49770099
497800                                                                  49780099
497900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          49790099
498000         CONTINUE                                                 49800099
498100     ELSE                                                         49810099
498200         SET DP013-CICS-ABEND      TO TRUE                        49820099
498300         SET DP013-NO-ROLLBACK     TO TRUE                        49830099
498400         MOVE '6105-READ-SEL-QUEUE'                               49840099
498500                                   TO DP013-PARAGRAPH             49850099
498600         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           49860099
498700                                   TO DP013-MESSAGE-TEXT(1)       49870099
498800         PERFORM DP013-0000-PROCESS-ABEND                         49880099
498900     END-IF.                                                      49890099
499000                                                                  49900099
499100/                                                                 49910099
499200*----------------------------------------------------------------*49920099
499300*    READ THE LIST QUEUE RECORD.                                 *49930099
499400*----------------------------------------------------------------*49940099
499500                                                                  49950099
499600 6106-READ-SEL-QUEUE2.                                            49960099
499700                                                                  49970099
499800     EXEC CICS                                                    49980099
499900          READQ TS                                                49990099
500000              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      50000099
500100              INTO  (RC013-DC-SELECT-RECORD)                      50010099
500200              ITEM  (PV-SEL-QUEUE-ITEM)                           50020099
500300              RESP  (PV-CICS-RESP)                                50030099
500400     END-EXEC.                                                    50040099
500500                                                                  50050099
500600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          50060099
500700         CONTINUE                                                 50070099
500800     ELSE                                                         50080099
500900         SET DP013-CICS-ABEND      TO TRUE                        50090099
501000         SET DP013-NO-ROLLBACK     TO TRUE                        50100099
501100         MOVE '6106-READ-SEL-QUEUE2'                              50110099
501200                                   TO DP013-PARAGRAPH             50120099
501300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           50130099
501400                                   TO DP013-MESSAGE-TEXT(1)       50140099
501500         PERFORM DP013-0000-PROCESS-ABEND                         50150099
501600     END-IF.                                                      50160099
501700/                                                                 50170099
501800*----------------------------------------------------------------*50180099
501900*    READ THE LIST QUEUE RECORD.                                 *50190099
502000*----------------------------------------------------------------*50200099
502100                                                                  50210099
502200 6107-READ-SEL-QUEUE4.                                            50220099
502300                                                                  50230099
502400     EXEC CICS                                                    50240099
502500          READQ TS                                                50250099
502600              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      50260099
502700              INTO  (PC016-TS-SEL-REC)                            50270099
502800              ITEM  (PV-SEL-QUEUE-ITEM)                           50280099
502900              RESP  (PV-CICS-RESP)                                50290099
503000     END-EXEC.                                                    50300099
503100                                                                  50310099
503200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          50320099
503300         CONTINUE                                                 50330099
503400     ELSE                                                         50340099
503500         SET DP013-CICS-ABEND      TO TRUE                        50350099
503600         SET DP013-NO-ROLLBACK     TO TRUE                        50360099
503700         MOVE '6107-READ-SEL-QUEUE4'                              50370099
503800                                   TO DP013-PARAGRAPH             50380099
503900         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           50390099
504000                                   TO DP013-MESSAGE-TEXT(1)       50400099
504100         PERFORM DP013-0000-PROCESS-ABEND                         50410099
504200     END-IF.                                                      50420099
504300/                                                                 50430099
504400*----------------------------------------------------------------*50440099
504500*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*50450099
504600*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*50460099
504700*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *50470099
504800*----------------------------------------------------------------*50480099
504900                                                                  50490099
505000 6108-PROCESS-ITEMS2.                                             50500099
505100                                                                  50510099
505200     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          50520099
505300                     / PC-ITEMS-PER-PANEL).                       50530099
505400                                                                  50540099
505500     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           50550099
505600         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          50560099
505700             PERFORM 6111-WRITE-LIST-QUEUE                        50570099
505800         END-IF                                                   50580099
505900         MOVE PV-ITEM              TO PV-SAVE-ITEM                50590099
506000                                                                  50600099
506100         PERFORM 6112-READ-LIST-QUEUE                             50610099
506200         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               50620099
506300             CONTINUE                                             50630099
506400         END-IF                                                   50640099
506500     END-IF.                                                      50650099
506600                                                                  50660099
506700     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     50670099
506800                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              50680099
506900                                                                  50690099
507000     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       50700099
507100     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        50710099
507200                                     (PV-SUB).                    50720099
507300     EVALUATE TRUE                                                50730099
507400         WHEN RC013-INQ (RC013-IDX)                               50740099
507500              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             50750099
507600                                                                  50760099
507700         WHEN RC013-UPD (RC013-IDX)                               50770099
507800              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             50780099
507900                                                                  50790099
508000         WHEN RC013-DEL (RC013-IDX)                               50800099
508100              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             50810099
508200                                                                  50820099
508300         WHEN RC013-ERR (RC013-IDX)                               50830099
508400              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             50840099
508500     END-EVALUATE.                                                50850099
508600                                                                  50860099
508700     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                50870099
508800/                                                                 50880099
508900*----------------------------------------------------------------*50890099
509000*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*50900099
509100*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*50910099
509200*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *50920099
509300*----------------------------------------------------------------*50930099
509400                                                                  50940099
509500 6109-PROCESS-ITEMS4.                                             50950099
509600                                                                  50960099
509700     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          50970099
509800                     / PC-ITEMS-PER-PANEL).                       50980099
509900                                                                  50990099
510000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           51000099
510100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          51010099
510200             PERFORM 6111-WRITE-LIST-QUEUE                        51020099
510300         END-IF                                                   51030099
510400         MOVE PV-ITEM              TO PV-SAVE-ITEM                51040099
510500                                                                  51050099
510600         PERFORM 6112-READ-LIST-QUEUE                             51060099
510700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               51070099
510800             CONTINUE                                             51080099
510900         END-IF                                                   51090099
511000     END-IF.                                                      51100099
511100                                                                  51110099
511200     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX)                     51120099
511300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              51130099
511400                                                                  51140099
511500     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       51150099
511600     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        51160099
511700                                     (PV-SUB).                    51170099
511800     EVALUATE TRUE                                                51180099
511900         WHEN PC016-INQ (RC013-IDX)                               51190099
512000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             51200099
512100                                                                  51210099
512200         WHEN PC016-UPD (RC013-IDX)                               51220099
512300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             51230099
512400                                                                  51240099
512500         WHEN PC016-DEL (RC013-IDX)                               51250099
512600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             51260099
512700                                                                  51270099
512800         WHEN PC016-ERR (RC013-IDX)                               51280099
512900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             51290099
513000     END-EVALUATE.                                                51300099
513100                                                                  51310099
513200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                51320099
513300/                                                                 51330099
513400/                                                                 51340099
513500*----------------------------------------------------------------*51350099
513600*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*51360099
513700*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*51370099
513800*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *51380099
513900*----------------------------------------------------------------*51390099
514000                                                                  51400099
514100 6110-PROCESS-ITEMS.                                              51410099
514200                                                                  51420099
514300     COMPUTE PV-ITEM = 1 + ((RC801-ITEM (RC801-IDX) - 1)          51430099
514400                     / PC-ITEMS-PER-PANEL).                       51440099
514500                                                                  51450099
514600     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           51460099
514700         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          51470099
514800             PERFORM 6111-WRITE-LIST-QUEUE                        51480099
514900         END-IF                                                   51490099
515000         MOVE PV-ITEM              TO PV-SAVE-ITEM                51500099
515100                                                                  51510099
515200         PERFORM 6112-READ-LIST-QUEUE                             51520099
515300         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               51530099
515400             CONTINUE                                             51540099
515500         END-IF                                                   51550099
515600     END-IF.                                                      51560099
515700                                                                  51570099
515800     COMPUTE PV-SUB = (RC801-ITEM (RC801-IDX)                     51580099
515900                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              51590099
516000                                                                  51600099
516100     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       51610099
516200     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        51620099
516300                                     (PV-SUB).                    51630099
516400     EVALUATE TRUE                                                51640099
516500         WHEN RC801-INQ (RC801-IDX)                               51650099
516600              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             51660099
516700                                                                  51670099
516800         WHEN RC801-UPD (RC801-IDX)                               51680099
516900              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             51690099
517000                                                                  51700099
517100         WHEN RC801-DEL (RC801-IDX)                               51710099
517200              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             51720099
517300                                                                  51730099
517400         WHEN RC801-ERR (RC801-IDX)                               51740099
517500              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             51750099
517600     END-EVALUATE.                                                51760099
517700                                                                  51770099
517800     IF RC801-UPD (RC801-IDX)                                     51780099
517900         MOVE RC801-PACK-OTR-QTY (RC801-IDX)                      51790099
518000                                   TO LQW-OTR-PACK-N (PV-SUB)     51800099
518100         MOVE RC801-DTL-PACK-QTY (RC801-IDX)                      51810099
518200                                   TO LQW-DETAIL-PACK-N (PV-SUB)  51820099
518300         MOVE RC801-ODD-UNITS-PACK-QTY (RC801-IDX)                51830099
518400                                   TO LQW-ODD-UNITS-N (PV-SUB)    51840099
518500         MOVE RC801-PKSL-PACK-QTY (RC801-IDX)                     51850099
518600                                   TO LQW-PKSL-PACK-N (PV-SUB)    51860099
518700         MOVE RC801-PK-TRBL-RSN-SHORT (RC801-IDX)                 51870099
518800                                   TO LQW-TROUBLE     (PV-SUB)    51880099
518900         MOVE RC800-INNER-PACK-QTY TO ASC-INNER-PACK-QTY.         51890099
519000                                                                  51900099
519100     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                51910099
519200                                                                  51920099
519300                                                                  51930099
519400/                                                                 51940099
519500*----------------------------------------------------------------*51950099
519600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *51960099
519700*----------------------------------------------------------------*51970099
519800                                                                  51980099
519900 6111-WRITE-LIST-QUEUE.                                           51990099
520000                                                                  52000099
520100     EXEC CICS                                                    52010099
520200         WRITEQ TS                                                52020099
520300             QUEUE (ASC-LIST-QUEUE-NAME)                          52030099
520400             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     52040099
520500             ITEM  (PV-SAVE-ITEM)                                 52050099
520600             REWRITE                                              52060099
520700             RESP  (PV-CICS-RESP)                                 52070099
520800     END-EXEC.                                                    52080099
520900                                                                  52090099
521000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          52100099
521100         CONTINUE                                                 52110099
521200     ELSE                                                         52120099
521300         SET DP013-CICS-ABEND      TO TRUE                        52130099
521400         SET DP013-NO-ROLLBACK     TO TRUE                        52140099
521500         MOVE '6111-WRITE-LIST-QUEUE'                             52150099
521600                                   TO DP013-PARAGRAPH             52160099
521700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  52170099
521800                                   TO DP013-MESSAGE-TEXT(1)       52180099
521900         PERFORM DP013-0000-PROCESS-ABEND                         52190099
522000     END-IF.                                                      52200099
522100                                                                  52210099
522200/                                                                 52220099
522300*----------------------------------------------------------------*52230099
522400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*52240099
522500*----------------------------------------------------------------*52250099
522600                                                                  52260099
522700 6112-READ-LIST-QUEUE.                                            52270099
522800                                                                  52280099
522900     EXEC CICS                                                    52290099
523000         READQ TS                                                 52300099
523100             QUEUE (ASC-LIST-QUEUE-NAME)                          52310099
523200             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     52320099
523300             ITEM  (PV-ITEM)                                      52330099
523400             RESP  (PV-CICS-RESP)                                 52340099
523500     END-EXEC.                                                    52350099
523600                                                                  52360099
523700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          52370099
523800         CONTINUE                                                 52380099
523900     ELSE                                                         52390099
524000         SET DP013-CICS-ABEND      TO TRUE                        52400099
524100         SET DP013-NO-ROLLBACK     TO TRUE                        52410099
524200         MOVE '6112-READ-LIST-QUEUE'                              52420099
524300                                   TO DP013-PARAGRAPH             52430099
524400         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    52440099
524500                                   TO DP013-MESSAGE-TEXT(1)       52450099
524600         PERFORM DP013-0000-PROCESS-ABEND                         52460099
524700     END-IF.                                                      52470099
524800                                                                  52480099
524900/                                                                 52490099
525000*----------------------------------------------------------------*52500099
525100*    RETREIVE INFORMATION FROM TPURITM                           *52510099
525200*----------------------------------------------------------------*52520099
525300 6150-GET-PURITM.                                                 52530099
525400                                                                  52540099
525500     MOVE ASC-PO-NBR               TO    PV-PO-NBR.               52550099
525600                                                                  52560099
525700     EXEC SQL                                                     52570099
525800          SELECT DISTINCT                                         52580099
525900                 A.ENT_ID                                         52590099
526000                ,B.PIC_ITM_IND                                    52600099
526100            INTO                                                  52610099
526200                 :PURCHS-ENT-ID                                   52620099
526300                ,:PURITM-PIC-ITM-IND                              52630099
526400            FROM TPURCHS A                                        52640099
526500                ,TPURITM B                                        52650099
526600                ,TRECITM C                                        52660099
526700           WHERE A.PO_NBR         = :PV-PO-NBR                    52670099
526800             AND A.VER_STATUS_CDE = 'A'                           52680099
526900             AND A.PO_NBR         = B.PO_NBR                      52690099
527000             AND A.PO_NBR         = C.ORD_NBR                     52700099
527100             AND B.APP_PO_LNE_NBR = :PV-PO-LNE-NBR                52710099
527200             AND C.OPER_UNT_ID    = :DK-OPR-ID                    52720099
527300             AND C.FCLTY_ID       = :DK-FACT                      52730099
527400             AND C.ORD_LNE_NBR    = :PV-PO-LNE-NBR                52740099
527500             AND C.VER_STATUS_CDE = 'A'                           52750099
527600             AND C.REC_SEQ_NBR    = :PV-REC-SEQ-NBR               52760099
527700             AND C.PO_VER_NBR     = B.VER_NBR                     52770099
527800     END-EXEC.                                                    52780099
527900                                                                  52790099
528000     EVALUATE TRUE                                                52800099
528100         WHEN SQLCODE = +0                                        52810099
528200         WHEN SQLCODE = +100                                      52820099
528300              CONTINUE                                            52830099
528400         WHEN SQLCODE = -904                                      52840099
528500         WHEN SQLCODE = -911                                      52850099
528600         WHEN SQLCODE = -913                                      52860099
528700              PERFORM 9900-SOFT-ABORT                             52870099
528800                                                                  52880099
528900         WHEN OTHER                                               52890099
529000              MOVE '6150-GET-PURITM'                              52900099
529100                               TO DP013-PARAGRAPH                 52910099
529200              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               52920099
529300                               TO DP013-MESSAGE-TEXT (1)          52930099
529400              MOVE SQLCA       TO DP013-SQLCA                     52940099
529500              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        52950099
529600              PERFORM 9950-FORMAT-ERROR-MSG                       52960099
529700              SET DP013-DB2-ABEND                                 52970099
529800                  DP013-XCTL-DISPLAY-RESTART                      52980099
529900                               TO TRUE                            52990099
530000              PERFORM DP013-0000-PROCESS-ABEND                    53000099
530100     END-EVALUATE.                                                53010099
530200                                                                  53020099
530300******************************************************************53030099
530400* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *53040099
530500******************************************************************53050099
530600 6200-DEL-LIST-QUEUE.                                             53060099
530700                                                                  53070099
530800     EXEC CICS                                                    53080099
530900         DELETEQ TS                                               53090099
531000             QUEUE (ASC-LIST-QUEUE-NAME)                          53100099
531100             RESP  (PV-CICS-RESP)                                 53110099
531200     END-EXEC.                                                    53120099
531300                                                                  53130099
531400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      53140099
531500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         53150099
531600         CONTINUE                                                 53160099
531700     ELSE                                                         53170099
531800        SET DP013-CICS-ABEND       TO TRUE                        53180099
531900        SET DP013-NO-ROLLBACK      TO TRUE                        53190099
532000        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             53200099
532100        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               53210099
532200                                   TO DP013-MESSAGE-TEXT (1)      53220099
532300        PERFORM DP013-0000-PROCESS-ABEND                          53230099
532400     END-IF.                                                      53240099
532500                                                                  53250099
532510 6260-CHECK-OUTBOUND.                                             53251099
532520                                                                  53252099
532530         EXEC SQL                                                 53253099
532540             SELECT A.SHIPT_UNT_ID                                53254099
532550             INTO   :SUT00028-SHIPT-UNT-ID                        53255099
532560             FROM  SUT_OTBND_UPC A                                53256099
532570                 , SUT_OTBND_CART B                               53257099
532580           WHERE A.TRN_NBR              = :DK-ORD-NBR             53258099
532590            AND  A.RCVR_SEQ_NBR         = :DK-RCVR-SEQ-NBR        53259099
532591            AND  A.TRN_LNE_NBR          = :DK-LINE-NBR            53259199
532592            AND  A.SHIPT_UNT_ID         =  B.SHIPT_UNT_ID         53259299
532593            AND  B.ACTV_IND             =  'Y'                    53259399
532594         END-EXEC.                                                53259499
532595                                                                  53259599
532596     EVALUATE TRUE                                                53259699
532597           WHEN SQLCODE = +0                                      53259799
532598           WHEN SQLCODE = -811                                    53259899
532599                SET ASC-CARTONS-FOUND TO TRUE                     53259999
532600           WHEN SQLCODE = +100                                    53260099
532601                SET ASC-CARTONS-NOT-FOUND TO TRUE                 53260199
532602           WHEN SQLWARN0 NOT = SPACES                             53260299
532603           WHEN SQLCODE  NOT = ZERO                               53260399
532604                MOVE '6260-CHECK-OUTBOUND'                        53260499
532605                               TO DP013-PARAGRAPH                 53260599
532606                MOVE 'UNSUCCESSFUL SELECT OF OUTBOUND TBL'        53260699
532607                               TO DP013-MESSAGE-TEXT (1)          53260799
532608                MOVE SQLCA     TO DP013-SQLCA                     53260899
532609                MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)       53260999
532610                MOVE 'SUT00028' TO DP013-DB2-TABLE-NAME (2)       53261099
532611                SET DP013-DB2-ABEND                               53261199
532612                      DP013-XCTL-DISPLAY-RESTART                  53261299
532613                                 TO TRUE                          53261399
532614                  PERFORM DP013-0000-PROCESS-ABEND                53261499
532615     END-EVALUATE.                                                53261599
532616                                                                  53261699
532617                                                                  53261799
532620                                                                  53262099
532700*----------------------------------------------------------------*53270099
532800* DETERMINE WHAT QUANITITY NEEDS TO BE REDISTROED AND PASS IT    *53280099
532900* FOR PROCESSING THRU THE TROUBLE AND REDISTRO ROUTINES.         *53290099
533000*----------------------------------------------------------------*53300099
533100 6500-PROCESS-REDISTRO.                                           53310099
533200                                                                  53320099
533300     PERFORM 4100-PREPARE-CURSOR                                  53330099
533400     PERFORM 5214-RETRIEVE-DRIVER-LINE.                           53340099
533500                                                                  53350099
533600        SET PS-DELETE-RECDIS            TO TRUE                   53360099
533700                                                                  53370099
533800* DELETE RECDIS ON ALL OF THE LINES WITHIN THE PACK BEFORE CALLING53380099
533900* REDISTRO                                                        53390099
534000     PERFORM 6508-OPEN-CURSOR                                     53400099
534100     PERFORM 6510-FETCH-ALL-LINES                                 53410099
534200     PERFORM 6509-CLOSE-CURSOR                                    53420099
534300                                                                  53430099
534400     IF ASC-NO-EDIT-ERROR                                         53440099
534500        SET PS-DONT-DELETE-LINES       TO TRUE                    53450099
534600                                                                  53460099
534700        INITIALIZE TM500-FIELDS                                   53470099
534800                                                                  53480099
534900        SET  TM500-CREATE-AUTO                                    53490099
535000             TM500-NO-DETAILS                                     53500099
535100             TM500-REDISTRO-YES                                   53510099
535200             TM500-PACK-LEVEL             TO TRUE                 53520099
535300                                                                  53530099
535400        PERFORM 6600-CHECK-FOR-TROUBLE                            53540099
535500                                                                  53550099
535600        IF PS-REDISTRO-OK                                         53560099
535700           SET LQW-DESELECT (LQW-IDX)     TO TRUE                 53570099
535800           MOVE LQW-SELECTED-SW (LQW-IDX) TO LQW-TEMP-SELECTED-SW 53580099
535900                                                      (LQW-IDX)   53590099
536000            PERFORM 6508-OPEN-CURSOR                              53600099
536100            PERFORM 6510-FETCH-ALL-LINES                          53610099
536200            PERFORM 6509-CLOSE-CURSOR                             53620099
536300            IF TM500-INVALID-PRORATION                            53630099
536400                SET DP020-MSG-WARNING        TO TRUE              53640099
536500                MOVE PC-TSYMSG-02452         TO DP020-MSG-NUMBER  53650099
536600            ELSE                                                  53660099
536700               IF TM500-IN-TROUBLE                                53670099
536710* JAK 05/2007 ADD ERROR MSGS FOR WMS                              53671099
536800*                  MOVE PC-TSYMSG-00941      TO DP020-MSG-NUMBER  53680099
536900*                  SET DP020-MSG-INFORMATIONAL                    53690099
537000*                                            TO TRUE              53700099
537010                   IF TM500-ASN-SENT-TO-WMS-YES                   53701099
537020*                      * REDISTRO SUCCESSFUL, ASN WILL BE         53702099
537030*                      * DOWNLOADED TO WMS BUT TROUBLE CREATED    53703099
537040                       MOVE PC-TSYMSG-03569  TO DP020-MSG-NUMBER  53704099
537050                       SET DP020-MSG-INFORMATIONAL                53705099
537060                                             TO TRUE              53706099
537070                   ELSE                                           53707099
537080*                      * REDISTRO SUCCESSFUL BUT TROUBLE CREATED  53708099
537091                       MOVE PC-TSYMSG-00941  TO DP020-MSG-NUMBER  53709199
537092                       SET DP020-MSG-INFORMATIONAL                53709299
537093                                             TO TRUE              53709399
537100                   END-IF                                         53710099
537110               ELSE                                               53711099
537200* REDISTRO SUCCESSFUL                                             53720099
537300*                  MOVE PC-TSYMSG-02165      TO DP020-MSG-NUMBER  53730099
537400*                  SET DP020-MSG-INFORMATIONAL                    53740099
537500*                                            TO TRUE              53750099
537510                   IF TM500-ASN-SENT-TO-WMS-YES                   53751099
537520*                      * REDISTRO SUCCESSFUL AND ASN WILL BE      53752099
537530*                      * DOWNLOADED TO WMS                        53753099
537540                       MOVE PC-TSYMSG-03568  TO DP020-MSG-NUMBER  53754099
537550                       SET DP020-MSG-INFORMATIONAL                53755099
537560                                             TO TRUE              53756099
537570                   ELSE                                           53757099
537580*                      * REDISTRO SUCCESSFUL                      53758099
537590                       MOVE PC-TSYMSG-02165  TO DP020-MSG-NUMBER  53759099
537591                       SET DP020-MSG-INFORMATIONAL                53759199
537592                                             TO TRUE              53759299
537593                   END-IF                                         53759399
537594* JAK 05/2007 END                                                 53759499
537600               END-IF                                             53760099
537700            END-IF                                                53770099
537800        ELSE                                                      53780099
537900           IF TM500-PREPACK-ERROR                                 53790099
538000*             MOVE PC-TSYMSG-01570         TO DP020-MSG-NUMBER    53800099
538100              MOVE PC-TSYMSG-02229         TO DP020-MSG-NUMBER    53810099
538200              SET DP020-MSG-FATAL          TO TRUE                53820099
538300        END-IF.                                                   53830099
538400                                                                  53840099
538500                                                                  53850099
538600/                                                                 53860099
538700*----------------------------------------------------------------*53870099
538800* OPEN THE PO ITEM  CURSOR                                       *53880099
538900*----------------------------------------------------------------*53890099
539000 6508-OPEN-CURSOR.                                                53900099
539100                                                                  53910099
539200         EXEC SQL                                                 53920099
539300             OPEN PACK-LINE-CSR                                   53930099
539400         END-EXEC                                                 53940099
539500                                                                  53950099
539600         EVALUATE TRUE                                            53960099
539700             WHEN SQLCODE = +0                                    53970099
539800                  CONTINUE                                        53980099
539900             WHEN SQLCODE = -904                                  53990099
540000             WHEN SQLCODE = -911                                  54000099
540100             WHEN SQLCODE = -913                                  54010099
540200                  PERFORM 9900-SOFT-ABORT                         54020099
540300             WHEN OTHER                                           54030099
540400                  MOVE '6508-OPEN-CURSOR'                         54040099
540500                                   TO DP013-PARAGRAPH             54050099
540600                  MOVE 'OPEN CURSOR'                              54060099
540700                                   TO DP013-MESSAGE-TEXT (1)      54070099
540800                  MOVE SQLCA       TO DP013-SQLCA                 54080099
540900                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)    54090099
541000                  PERFORM 9950-FORMAT-ERROR-MSG                   54100099
541100                  SET DP013-DB2-ABEND                             54110099
541200                                   TO TRUE                        54120099
541300                  PERFORM DP013-0000-PROCESS-ABEND                54130099
541400         END-EVALUATE.                                            54140099
541500/                                                                 54150099
541600*----------------------------------------------------------------*54160099
541700* CLOSE THE PO ITEM  CURSOR                                      *54170099
541800*----------------------------------------------------------------*54180099
541900 6509-CLOSE-CURSOR.                                               54190099
542000                                                                  54200099
542100     EXEC SQL                                                     54210099
542200          CLOSE PACK-LINE-CSR                                     54220099
542300     END-EXEC.                                                    54230099
542400                                                                  54240099
542500     EVALUATE TRUE                                                54250099
542600         WHEN SQLCODE = +0                                        54260099
542700              CONTINUE                                            54270099
542800         WHEN SQLCODE = -904                                      54280099
542900         WHEN SQLCODE = -911                                      54290099
543000         WHEN SQLCODE = -913                                      54300099
543100              PERFORM 9900-SOFT-ABORT                             54310099
543200         WHEN OTHER                                               54320099
543300              MOVE '6509-CLOSE-CURSOR'                            54330099
543400                                   TO DP013-PARAGRAPH             54340099
543500              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      54350099
543600              MOVE SQLCA           TO DP013-SQLCA                 54360099
543700              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    54370099
543800              PERFORM 9950-FORMAT-ERROR-MSG                       54380099
543900              SET DP013-DB2-ABEND  TO TRUE                        54390099
544000              PERFORM DP013-0000-PROCESS-ABEND                    54400099
544100     END-EVALUATE.                                                54410099
544200                                                                  54420099
544300/                                                                 54430099
544400******************************************************************54440099
544500* PERFORM FETCH TO RETRIEVE 6510-FETCH LINE NUMBERS.             *54450099
544600******************************************************************54460099
544700 6510-FETCH-ALL-LINES.                                            54470099
544800                                                                  54480099
544900     PERFORM 4100-PREPARE-CURSOR.                                 54490099
545000     SET ASC-ITEMS-LEFT-ON-DB    TO TRUE.                         54500099
545100                                                                  54510099
545200     PERFORM                                                      54520099
545300         VARYING PV-READ-COUNT                                    54530099
545400         FROM 1 BY 1                                              54540099
545500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    54550099
545600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         54560099
545700                                                                  54570099
545800         PERFORM 6511-FETCH-ALL-LINES                             54580099
545900                                                                  54590099
546000         IF ASC-ITEMS-LEFT-ON-DB                                  54600099
546100             IF PS-DELETE-RECDIS                                  54610099
546200                   PERFORM 6800-GENERAL-FKEY-EDITS                54620099
546300                   IF ASC-NO-EDIT-ERROR                           54630099
546400                      PERFORM 8000-CLEANUP-RECDIS                 54640099
546500                      PERFORM 8050-DELETE-ODD-UNIT                54650099
546600                   END-IF                                         54660099
546700             ELSE                                                 54670099
546800             IF PS-UPDATE-RECITM                                  54680099
546900                   PERFORM 6800-GENERAL-FKEY-EDITS                54690099
547000                   IF ASC-NO-EDIT-ERROR AND                       54700099
547100                      NOT DP020-FK-CONFIRM (DP020-SRC-AID) AND    54710099
547200                      ASC-DELETE-NOT-PENDING                      54720099
547300                          MOVE PC-TSYMSG-02180                    54730099
547400                                              TO DP020-MSG-NUMBER 54740099
547500                          SET DP030-OVERRIDE-GO                   54750099
547600                              DP020-MSG-INFORMATIONAL             54760099
547700                                              TO TRUE             54770099
547800                   ELSE                                           54780099
547900                      IF ASC-NO-EDIT-ERROR AND                    54790099
548000                         DP020-FK-CONFIRM (DP020-SRC-AID) AND     54800099
548100                         ASC-DELETE-PENDING                       54810099
548200                          PERFORM 8000-CLEANUP-RECDIS             54820099
548300                          PERFORM 8050-DELETE-ODD-UNIT            54830099
548400                          PERFORM 8100-DELETE-LINES               54840099
548500                          PERFORM 8130-DELETE-TRB-LINE            54850099
548600                          PERFORM 8140-DELETE-TRB-PACK            54860099
548700                      END-IF                                      54870099
548800                   END-IF                                         54880099
548900                ELSE                                              54890099
549000                   PERFORM 6550-UPDATE-TRSCP-RECITM               54900099
549100                END-IF                                            54910099
549200             END-IF                                               54920099
549300          END-IF                                                  54930099
549400     END-PERFORM.                                                 54940099
549500                                                                  54950099
549600/                                                                 54960099
549700*----------------------------------------------------------------*54970099
549800*    FETCH A PO ITEM ROW                                         *54980099
549900*----------------------------------------------------------------*54990099
550000 6511-FETCH-ALL-LINES.                                            55000099
550100                                                                  55010099
550200     EXEC SQL                                                     55020099
550300         FETCH PACK-LINE-CSR                                      55030099
550400            INTO :PURITM-PO-NBR                                   55040099
550500                ,:DK-LINE-NBR                                     55050099
550600                ,:PURITM-PO-LNE-NBR                               55060099
550700                ,:PURITM-PREPK-RATO-QTY                           55070099
550800                ,:RECITM-ORD-LNE-NBR                              55080099
550900                ,:RECITM-DTL-CK-ITM-QTY                           55090099
551000                ,:RECITM-PKSL-ITM-QTY                             55100099
551100                ,:RECITM-PREPK-RATO-QTY                           55110099
551200                ,:PV-CURRENT-TIMESTAMP                            55120099
551300     END-EXEC.                                                    55130099
551400                                                                  55140099
551500     EVALUATE TRUE                                                55150099
551600         WHEN SQLCODE = +0                                        55160099
551700              CONTINUE                                            55170099
551800         WHEN SQLCODE = +100                                      55180099
551900              SET ASC-NO-ITEMS-LEFT-ON-DB                         55190099
552000                                   TO TRUE                        55200099
552100         WHEN SQLCODE = -904                                      55210099
552200         WHEN SQLCODE = -911                                      55220099
552300         WHEN SQLCODE = -913                                      55230099
552400              PERFORM 9900-SOFT-ABORT                             55240099
552500                                                                  55250099
552600         WHEN OTHER                                               55260099
552700              MOVE '6511-FETCH-ALL-LINES'                         55270099
552800                                   TO DP013-PARAGRAPH             55280099
552900              MOVE 'FETCH PACK-LINE-CSR '                         55290099
553000                                   TO DP013-MESSAGE-TEXT (1)      55300099
553100              MOVE SQLCA           TO DP013-SQLCA                 55310099
553200              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    55320099
553300              PERFORM 9950-FORMAT-ERROR-MSG                       55330099
553400              SET DP013-DB2-ABEND  TO TRUE                        55340099
553500              PERFORM DP013-0000-PROCESS-ABEND                    55350099
553600     END-EVALUATE.                                                55360099
553700                                                                  55370099
553800                                                                  55380099
553900******************************************************************55390099
554000* UPDATE TRECITM WHEN REDISTRO IS SUCCESSFUL.                    *55400099
554100******************************************************************55410099
554200 6550-UPDATE-TRSCP-RECITM.                                        55420099
554300                                                                  55430099
554400     EXEC SQL                                                     55440099
554500           UPDATE TRECITM                                         55450099
554600              SET LAST_TRSCP_TMST   = CURRENT TIMESTAMP           55460099
554700                , LAST_TRSCP_USR_ID = :DP020-USERID               55470099
554800             WHERE ORD_NBR          = :DK-ORD-NBR                 55480099
554900               AND ORD_LNE_NBR      = :DK-LINE-NBR                55490099
555000               AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR            55500099
555100               AND OPER_UNT_ID      = :DK-OPR-ID                  55510099
555200               AND FCLTY_ID         = :DK-FACT                    55520099
555300               AND VER_STATUS_CDE   = 'A'                         55530099
555400               AND PREPK_ID         = :DK-PACK-ID                 55540099
555500     END-EXEC.                                                    55550099
555600                                                                  55560099
555700     EVALUATE TRUE                                                55570099
555800         WHEN SQLCODE = ZERO                                      55580099
555900              CONTINUE                                            55590099
556000         WHEN SQLCODE = -904                                      55600099
556100         WHEN SQLCODE = -911                                      55610099
556200         WHEN SQLCODE = -913                                      55620099
556300              PERFORM 9900-SOFT-ABORT                             55630099
556400                                                                  55640099
556500         WHEN OTHER                                               55650099
556600              MOVE '6550-UPDATE-TRSCP-RECITM'                     55660099
556700                               TO DP013-PARAGRAPH                 55670099
556800              MOVE 'UPDATE TRECITM'                               55680099
556900                               TO DP013-MESSAGE-TEXT (1)          55690099
557000              MOVE SQLCA       TO DP013-SQLCA                     55700099
557100              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        55710099
557200              PERFORM 9950-FORMAT-ERROR-MSG                       55720099
557300              SET DP013-DB2-ABEND                                 55730099
557400                               TO TRUE                            55740099
557500              PERFORM DP013-0000-PROCESS-ABEND                    55750099
557600     END-EVALUATE.                                                55760099
557700                                                                  55770099
557800                                                                  55780099
557900*----------------------------------------------------------------*55790099
558000*  THIS PARAGRAPH WILL CALL TROUBLE PROGRAM (TMKCS520) TO        *55800099
558100*  PERFORM REDISTRO                                              *55810099
558200*----------------------------------------------------------------*55820099
558300 6600-CHECK-FOR-TROUBLE.                                          55830099
558400                                                                  55840099
558500     MOVE ASC-OPR-ID               TO TM500-OPER-UNT-ID.          55850099
558600     MOVE ASC-FACT                 TO TM500-FCLTY-ID.             55860099
558700     MOVE ASC-PO-NBR               TO TM500-PO-NBR.               55870099
558800     MOVE ASC-REC-SEQ-NBR          TO TM500-REC-SEQ-NBR           55880099
558900                                                                  55890099
559000     PERFORM 4100-PREPARE-CURSOR                                  55900099
559100     PERFORM 5214-RETRIEVE-DRIVER-LINE.                           55910099
559200     MOVE RECITM-ORD-LNE-NBR       TO TM500-PO-LNE-NBR.           55920099
559300     MOVE DK-PACK-ID               TO TM500-PREPK-ID.             55930099
559400     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            55940099
559500     MOVE ASC-PACKAGE-TYPE-CDE     TO TM500-PKGNG-CDE.            55950099
559600                                                                  55960099
559700     PERFORM 6700-GET-PURITM.                                     55970099
559800                                                                  55980099
559900     IF PV-NBR-OF-PIC-AD > 0                                      55990099
560000        MOVE 'Y'                   TO TM500-AD-SW                 56000099
560100     ELSE                                                         56010099
560200        MOVE 'N'                   TO TM500-AD-SW.                56020099
560300                                                                  56030099
560400*  TM500-RTV-SW IS LOADED BY TMKCS505 ONLY                        56040099
560500*    MOVE ASC-RTV-IND              TO TM500-RTV-SW.               56050099
560600                                                                  56060099
560700     EXEC CICS                                                    56070099
560800         LINK PROGRAM  (PC-TROUBLE-RTN)                           56080099
560900              COMMAREA (TM500-FIELDS)                             56090099
561000              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    56100099
561100     END-EXEC.                                                    56110099
561200                                                                  56120099
561300     EVALUATE TRUE                                                56130099
561400         WHEN TM500-CALL-SUCCESSFUL                               56140099
561500         WHEN TM500-DUPLICATE-TROUBLE                             56150099
561600         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        56160099
561700         WHEN TM500-INVALID-PRORATION                             56170099
561800              SET PS-REDISTRO-OK    TO TRUE                       56180099
561900                                                                  56190099
562000         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       56200099
562100             IF TM500-PREPACK-EDIT-ONLY                           56210099
562200                SET  PS-REDISTRO-NOT-OK                           56220099
562300                     ASC-REDISTRO-NOT-OK   TO TRUE                56230099
562400             ELSE                                                 56240099
562500                SET DP020-MSG-INFORMATIONAL                       56250099
562600                    ASC-REDISTRO-NOT-OK                           56260099
562700                    PS-REDISTRO-NOT-OK     TO TRUE                56270099
562800                MOVE PC-TSYMSG-00937       TO DP020-MSG-NUMBER    56280099
562900             END-IF                                               56290099
563000                                                                  56300099
563100          WHEN TM500-PREPACK-DB2-TIMEOUT                          56310099
563200                PERFORM 9900-SOFT-ABORT                           56320099
563300                                                                  56330099
563400         WHEN OTHER                                               56340099
563500           EXEC CICS                                              56350099
563600               SYNCPOINT ROLLBACK                                 56360099
563700           END-EXEC                                               56370099
563800           STRING TM500-PREPACK-PGM-NBR '-'                       56380099
563900                  TM500-PREPACK-ERROR-NBR                         56390099
564000                  DELIMITED BY SIZE     INTO DP020-MSG-TEXT       56400099
564100           MOVE PC-TSYMSG-02229         TO DP020-MSG-NUMBER       56410099
564200           SET DP020-MSG-FATAL                                    56420099
564300               ASC-REDISTRO-NOT-OK                                56430099
564400               PS-REDISTRO-NOT-OK       TO TRUE                   56440099
564500                                                                  56450099
564600     END-EVALUATE.                                                56460099
564700                                                                  56470099
564800                                                                  56480099
564900*----------------------------------------------------------------*56490099
565000*                                                                *56500099
565100*----------------------------------------------------------------*56510099
565200 6700-GET-PURITM.                                                 56520099
565300                                                                  56530099
565400     EXEC SQL                                                     56540099
565500          SELECT DISTINCT                                         56550099
565600                 COUNT (*)                                        56560099
565700            INTO                                                  56570099
565800                 :PV-NBR-OF-PIC-AD                                56580099
565900            FROM TPURCHS A,                                       56590099
566000                 TPURITM B,                                       56600099
566100                 TRECITM C                                        56610099
566200           WHERE A.PO_NBR         = :DK-ORD-NBR                   56620099
566300             AND A.VER_STATUS_CDE = 'A'                           56630099
566400             AND A.PO_NBR         = B.PO_NBR                      56640099
566500             AND A.PO_NBR         = C.ORD_NBR                     56650099
566600             AND B.PO_PREPK_ID    = :DK-PACK-ID                   56660099
566700             AND B.PIC_ITM_IND    = 'Y'                           56670099
566800             AND C.OPER_UNT_ID    = :DK-OPR-ID                    56680099
566900             AND C.FCLTY_ID       = :DK-FACT                      56690099
567000             AND C.ORD_LNE_NBR    = B.APP_PO_LNE_NBR              56700099
567100             AND C.PREPK_ID       = B.PO_PREPK_ID                 56710099
567200             AND C.VER_STATUS_CDE = 'A'                           56720099
567300     END-EXEC.                                                    56730099
567400                                                                  56740099
567500     EVALUATE TRUE                                                56750099
567600         WHEN SQLCODE = +0                                        56760099
567700         WHEN SQLCODE = +100                                      56770099
567800              CONTINUE                                            56780099
567900         WHEN SQLCODE = -904                                      56790099
568000         WHEN SQLCODE = -911                                      56800099
568100         WHEN SQLCODE = -913                                      56810099
568200              PERFORM 9900-SOFT-ABORT                             56820099
568300                                                                  56830099
568400         WHEN OTHER                                               56840099
568500              MOVE '6700-GET-PURITM'                              56850099
568600                               TO DP013-PARAGRAPH                 56860099
568700              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               56870099
568800                               TO DP013-MESSAGE-TEXT (1)          56880099
568900              MOVE SQLCA       TO DP013-SQLCA                     56890099
569000              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        56900099
569100              PERFORM 9950-FORMAT-ERROR-MSG                       56910099
569200              SET DP013-DB2-ABEND                                 56920099
569300                  DP013-XCTL-DISPLAY-RESTART                      56930099
569400                               TO TRUE                            56940099
569500              PERFORM DP013-0000-PROCESS-ABEND                    56950099
569600     END-EVALUATE.                                                56960099
569700                                                                  56970099
569800                                                                  56980099
569900/                                                                 56990099
570000*----------------------------------------------------------------*57000099
570100*    THESE ARE GENERAL EDITS TO DETERMINE IF THE FKEY THAT THE   *57010099
570200*    USER HIT IS VALID BASED ON THE DATA DISPLAYED.              *57020099
570300*----------------------------------------------------------------*57030099
570400 6800-GENERAL-FKEY-EDITS.                                         57040099
570500                                                                  57050099
570600     PERFORM 4100-PREPARE-CURSOR.                                 57060099
570700                                                                  57070099
570800                                                                  57080099
570900     IF DK-PACK-ID = 99                                           57090099
571000        MOVE PC-TSYMSG-02195             TO DP020-MSG-NUMBER      57100099
571100        SET DP030-OVERRIDE-GO                                     57110099
571200            LQW-LINE-ERROR (LQW-IDX)                              57120099
571300            DP020-MSG-FATAL              TO TRUE.                 57130099
571400                                                                  57140099
571500                                                                  57150099
571600     IF LQW-LINE-NOT-IN-ERROR (LQW-IDX)                           57160099
571700        PERFORM 6810-DETERMINE-LINE-VE                            57170099
571800        IF PV-TOTAL-LINES-VERIFIED > 0                            57180099
571900           MOVE PC-TSYMSG-00929          TO DP020-MSG-NUMBER      57190099
572000           SET DP030-OVERRIDE-GO                                  57200099
572100               LQW-LINE-ERROR (LQW-IDX)                           57210099
572200               DP020-MSG-FATAL           TO TRUE.                 57220099
572300                                                                  57230099
572400     IF LQW-LINE-NOT-IN-ERROR (LQW-IDX)                           57240099
572500        PERFORM 4350-CK-CASEPACK-SPLIT-PROCESS                    57250099
572600        IF ASC-CASEPACK-SPLIT-YES                                 57260099
572700* IF REDISTRO                                                     57270099
572800           IF DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              57280099
572900              MOVE PC-TSYMSG-01793       TO DP020-MSG-NUMBER      57290099
573000           ELSE                                                   57300099
573100* IF REMOVE LINE                                                  57310099
573200             IF DP020-FK-LOCAL-FUNC-10 (DP020-SRC-AID)            57320099
573300                MOVE PC-TSYMSG-02174     TO DP020-MSG-NUMBER      57330099
573400             END-IF                                               57340099
573500            END-IF                                                57350099
573600            SET DP030-OVERRIDE-GO                                 57360099
573700                LQW-LINE-ERROR (LQW-IDX)                          57370099
573800                DP020-MSG-FATAL          TO TRUE.                 57380099
573900                                                                  57390099
573910     IF LQW-LINE-NOT-IN-ERROR (LQW-IDX)                           57391099
573920        PERFORM 6260-CHECK-OUTBOUND                               57392099
573930        IF ASC-CARTONS-FOUND                                      57393099
573940            MOVE PC-TSYMSG-03394       TO DP020-MSG-NUMBER        57394099
573950            SET DP030-OVERRIDE-GO                                 57395099
573960                LQW-LINE-ERROR (LQW-IDX)                          57396099
573970                DP020-MSG-FATAL          TO TRUE.                 57397099
573980                                                                  57398099
574000     IF LQW-LINE-ERROR (LQW-IDX)                                  57400099
574100        SET ASC-EDIT-ERROR                                        57410099
574200            ASC-DELETE-NOT-PENDING       TO TRUE.                 57420099
574300                                                                  57430099
574400                                                                  57440099
574500*----------------------------------------------------------------*57450099
574600*   DETERMINE IF ANY LINES ARE VERIFIED.                         *57460099
574700*----------------------------------------------------------------*57470099
574800 6810-DETERMINE-LINE-VE.                                          57480099
574900                                                                  57490099
575000       EXEC SQL                                                   57500099
575100            SELECT DISTINCT                                       57510099
575200                   COUNT(*)                                       57520099
575300              INTO                                                57530099
575400                   :PV-TOTAL-LINES-VERIFIED :PV-NULL-IND          57540099
575500              FROM TRECITM A                                      57550099
575600             WHERE A.ORD_NBR           = :DK-ORD-NBR              57560099
575700               AND A.REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR         57570099
575800               AND A.PREPK_ID          = :DK-PACK-ID              57580099
575900               AND A.OPER_UNT_ID       = :DK-OPR-ID               57590099
576000               AND A.FCLTY_ID          = :DK-FACT                 57600099
576100               AND A.VER_STATUS_CDE    = 'A'                      57610099
576200               AND A.STATUS_CDE        IN ('VE','CM')             57620099
576300       END-EXEC                                                   57630099
576400                                                                  57640099
576500       EVALUATE TRUE                                              57650099
576600           WHEN SQLCODE = ZERO                                    57660099
576700           WHEN SQLCODE = +100                                    57670099
576800           WHEN SQLCODE = -305                                    57680099
576900                CONTINUE                                          57690099
577000           WHEN SQLCODE = -904                                    57700099
577100           WHEN SQLCODE = -911                                    57710099
577200           WHEN SQLCODE = -913                                    57720099
577300                PERFORM 9900-SOFT-ABORT                           57730099
577400           WHEN OTHER                                             57740099
577500                MOVE '6810-DETERMINE-LINE-VE'                     57750099
577600                                 TO DP013-PARAGRAPH               57760099
577700                MOVE 'SELECT TRECITM'                             57770099
577800                                 TO DP013-MESSAGE-TEXT (1)        57780099
577900                MOVE SQLCA       TO DP013-SQLCA                   57790099
578000                PERFORM 9950-FORMAT-ERROR-MSG                     57800099
578100                SET DP013-DB2-ABEND                               57810099
578200                                 TO TRUE                          57820099
578300                PERFORM DP013-0000-PROCESS-ABEND                  57830099
578400       END-EVALUATE.                                              57840099
578500                                                                  57850099
578600/                                                                 57860099
578700*----------------------------------------------------------------*57870099
578800* FORMAT THE COMMAREA                                            *57880099
578900*----------------------------------------------------------------*57890099
579000 7000-FORMAT-COMMAREA.                                            57900099
579100                                                                  57910099
579200     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            57920099
579300        MOVE 1                   TO PV-BLOCK-NUMBER               57930099
579400     ELSE                                                         57940099
579500        MOVE 2                   TO PV-BLOCK-NUMBER               57950099
579600     END-IF.                                                      57960099
579700                                                                  57970099
579800     MOVE ASC-OPR-ID             TO RC800-OPER-UNIT-ID            57980099
579900     MOVE ASC-FACT               TO RC800-FACILITY-ID.            57990099
580000     MOVE ASC-PO-NBR             TO RC800-REC-NBR-N.              58000099
580100     MOVE ASC-REC-SEQ-NBR        TO RC800-REC-SEQ-NBR-N.          58010099
580200     MOVE ASC-PACKAGE-TYPE-CDE   TO RC800-PACK-TYPE.              58020099
580300     MOVE ASC-PREPACK-DESC       TO RC800-PREPACK-DESC.           58030099
580400     MOVE ASC-STAT               TO RC800-REC-STATUS.             58040099
580500     MOVE ASC-PACKAGE-TYPE-CDE   TO RC800-PACK-TYPE.              58050099
580600                                                                  58060099
580700     EVALUATE TRUE                                                58070099
580800         WHEN ASC-PACKAGE-TYPE-CDE = PC-MULTIPLE                  58080099
580900             MOVE PC-MULTI-SKU-PACK-DESC                          58090099
581000                                 TO RC800-PACK-TYPE-DESC          58100099
581100         WHEN ASC-PACKAGE-TYPE-CDE = PC-SINGLE                    58110099
581200             MOVE PC-SINGLE-SKU-PACK-DESC                         58120099
581300                                 TO RC800-PACK-TYPE-DESC          58130099
581400         WHEN ASC-PACKAGE-TYPE-CDE = PC-INNER                     58140099
581500             MOVE PC-INNER-PACK-DESC                              58150099
581600                                 TO RC800-PACK-TYPE-DESC          58160099
581700         WHEN ASC-PACKAGE-TYPE-CDE = PC-BULK                      58170099
581800             MOVE PC-BULK-PACK-DESC                               58180099
581900                                 TO RC800-PACK-TYPE-DESC          58190099
582000         WHEN ASC-PACKAGE-TYPE-CDE = PC-CASE                      58200099
582100             MOVE PC-CASE-PACK-DESC                               58210099
582200                                 TO RC800-PACK-TYPE-DESC          58220099
582300         WHEN ASC-PACKAGE-TYPE-CDE = PC-PKG-TYP-NOT-FOUND         58230099
582400             MOVE PC-PKG-TYP-NOT-FOUND                            58240099
582500                                 TO RC800-PACK-TYPE-DESC          58250099
582600      END-EVALUATE.                                               58260099
582700                                                                  58270099
582800                                                                  58280099
582900/                                                                 58290099
583000******************************************************************58300099
583100* SUM THE DETAIL CHECK ITEM QTY AND THE PACKSLIP ITEM QTY FOR    *58310099
583200* DISPLAY PURPOSES.                                              *58320099
583300******************************************************************58330099
583400 7100-SUM-QUANTITIES.                                             58340099
583500                                                                  58350099
583600     EXEC SQL                                                     58360099
583700           SELECT                                                 58370099
583800               SUM(A.PREPK_ODD_UNT_QTY)                           58380099
583900           INTO                                                   58390099
584000               :PV-PACK-ODD-UNITS-QTY  :PV-NULL-IND               58400099
584100           FROM  TRECITM A                                        58410099
584200                ,TPURITM B                                        58420099
584300           WHERE                                                  58430099
584400                 A.ORD_NBR        = :DK-ORD-NBR                   58440099
584500             AND A.ORD_LNE_NBR    > 0                             58450099
584600             AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR              58460099
584700             AND A.OPER_UNT_ID    = :DK-OPR-ID                    58470099
584800             AND A.FCLTY_ID       = :DK-FACT                      58480099
584900             AND A.VER_STATUS_CDE = 'A'                           58490099
585000             AND A.PREPK_ID       = :DK-PACK-ID                   58500099
585100             AND B.PO_NBR         = A.ORD_NBR                     58510099
585200             AND B.APP_PO_LNE_NBR = A.ORD_LNE_NBR                 58520099
585300             AND B.PO_PREPK_ID    = A.PREPK_ID                    58530099
585400             AND B.VER_STATUS_CDE = 'A'                           58540099
585500     END-EXEC.                                                    58550099
585600                                                                  58560099
585700     EVALUATE TRUE                                                58570099
585800         WHEN SQLCODE = ZERO                                      58580099
585900              CONTINUE                                            58590099
586000         WHEN SQLCODE = +100                                      58600099
586100              MOVE +0          TO PV-PACK-ODD-UNITS-QTY           58610099
586200         WHEN SQLCODE = -904                                      58620099
586300         WHEN SQLCODE = -911                                      58630099
586400         WHEN SQLCODE = -913                                      58640099
586500              PERFORM 9900-SOFT-ABORT                             58650099
586600                                                                  58660099
586700         WHEN OTHER                                               58670099
586800              MOVE '7100-SUM-QUANTITIES'                          58680099
586900                               TO DP013-PARAGRAPH                 58690099
587000              MOVE 'SELECT SUM TRECITM'                           58700099
587100                               TO DP013-MESSAGE-TEXT (1)          58710099
587200              MOVE SQLCA       TO DP013-SQLCA                     58720099
587300              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        58730099
587400              PERFORM 9950-FORMAT-ERROR-MSG                       58740099
587500              SET DP013-DB2-ABEND                                 58750099
587600                               TO TRUE                            58760099
587700              PERFORM DP013-0000-PROCESS-ABEND                    58770099
587800     END-EVALUATE.                                                58780099
587900                                                                  58790099
588000     EXEC SQL                                                     58800099
588100           SELECT                                                 58810099
588200               A.DTL_CK_ITM_QTY                                   58820099
588300             , A.PKSL_ITM_QTY                                     58830099
588400             , A.PREPK_RATO_QTY                                   58840099
588500             , B.PREPK_RATO_QTY                                   58850099
588600           INTO                                                   58860099
588700               :PV-PACK-DTL-CK-ITM-QTY :PV-NULL-IND               58870099
588800              ,:PV-PACK-PKSL-ITM-QTY   :PV-NULL-IND               58880099
588900              ,:PV-PACK-RATIO-QTY      :PV-NULL-IND               58890099
589000              ,:PV-PO-PACK-RATIO-QTY   :PV-NULL-IND               58900099
589100           FROM  TRECITM A                                        58910099
589200                ,TPURITM B                                        58920099
589300           WHERE                                                  58930099
589400                 A.ORD_NBR        = :DK-ORD-NBR                   58940099
589500             AND A.ORD_LNE_NBR    > 0                             58950099
589600             AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR              58960099
589700             AND A.OPER_UNT_ID    = :DK-OPR-ID                    58970099
589800             AND A.FCLTY_ID       = :DK-FACT                      58980099
589900             AND A.VER_STATUS_CDE = 'A'                           58990099
590000             AND A.PREPK_ID       = :DK-PACK-ID                   59000099
590100             AND A.PREPK_DRV_LNE_CDE = 'A'                        59010099
590200             AND B.PO_NBR         = A.ORD_NBR                     59020099
590300             AND B.APP_PO_LNE_NBR = A.ORD_LNE_NBR                 59030099
590400             AND B.PO_PREPK_ID    = A.PREPK_ID                    59040099
590500             AND B.VER_STATUS_CDE = 'A'                           59050099
590600     END-EXEC.                                                    59060099
590700                                                                  59070099
590800     EVALUATE TRUE                                                59080099
590900         WHEN SQLCODE = ZERO                                      59090099
591000              CONTINUE                                            59100099
591100         WHEN SQLCODE = +100                                      59110099
591200              MOVE +0          TO PV-PACK-DTL-CK-ITM-QTY          59120099
591300                                  PV-PACK-PKSL-ITM-QTY            59130099
591400                                  PV-PACK-RATIO-QTY               59140099
591500                                  PV-PO-PACK-RATIO-QTY            59150099
591600         WHEN SQLCODE = -811                                      59160099
591700              MOVE PC-CURRENT-PROGRAM-ERROR                       59170099
591800                                         TO DP020-MSG-TEXT        59180099
591900              MOVE PC-TSYMSG-02229       TO DP020-MSG-NUMBER      59190099
592000              SET PS-ERROR                                        59200099
592100                  DP020-MSG-FATAL                                 59210099
592200                  PS-COMMAREA-NOT-VALID                           59220099
592300                  DP020-NEXT-ACT-APPL-ERROR                       59230099
592400                                         TO TRUE                  59240099
592500         WHEN SQLCODE = -904                                      59250099
592600         WHEN SQLCODE = -911                                      59260099
592700         WHEN SQLCODE = -913                                      59270099
592800              PERFORM 9900-SOFT-ABORT                             59280099
592900                                                                  59290099
593000         WHEN OTHER                                               59300099
593100              MOVE '7100-SUM-QUANTITIES'                          59310099
593200                               TO DP013-PARAGRAPH                 59320099
593300              MOVE 'SELECT SUM TRECITM'                           59330099
593400                               TO DP013-MESSAGE-TEXT (1)          59340099
593500              MOVE SQLCA       TO DP013-SQLCA                     59350099
593600              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        59360099
593700              PERFORM 9950-FORMAT-ERROR-MSG                       59370099
593800              SET DP013-DB2-ABEND                                 59380099
593900                               TO TRUE                            59390099
594000              PERFORM DP013-0000-PROCESS-ABEND                    59400099
594100     END-EVALUATE.                                                59410099
594200                                                                  59420099
594300                                                                  59430099
594400*----------------------------------------------------------------*59440099
594500*    DELETE LINE LEVEL RECDIS.                                   *59450099
594600*----------------------------------------------------------------*59460099
594700 8000-CLEANUP-RECDIS.                                             59470099
594800                                                                  59480099
594900     EXEC SQL                                                     59490099
595000           DELETE                                                 59500099
595100             FROM TRECDIS                                         59510099
595200            WHERE OPER_UNT_ID      = :DK-OPR-ID                   59520099
595300              AND FCLTY_ID         = :DK-FACT                     59530099
595400              AND ORD_NBR          = :DK-ORD-NBR                  59540099
595500              AND ORD_LNE_NBR      = :DK-LINE-NBR                 59550099
595600              AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR             59560099
595700     END-EXEC                                                     59570099
595800                                                                  59580099
595900     EVALUATE TRUE                                                59590099
596000         WHEN SQLCODE = ZERO                                      59600099
596100         WHEN SQLCODE = +100                                      59610099
596200              CONTINUE                                            59620099
596300         WHEN SQLCODE = -904                                      59630099
596400         WHEN SQLCODE = -911                                      59640099
596500         WHEN SQLCODE = -913                                      59650099
596600              PERFORM 9900-SOFT-ABORT                             59660099
596700                                                                  59670099
596800         WHEN OTHER                                               59680099
596900              MOVE '8000-CLEANUP-RECDIS'                          59690099
597000                             TO DP013-PARAGRAPH                   59700099
597100              MOVE 'UNSUCCESSFUL DELETE OF RECDIS DATA'           59710099
597200                             TO DP013-MESSAGE-TEXT (1)            59720099
597300              MOVE SQLCA         TO DP013-SQLCA                   59730099
597400              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          59740099
597500              SET DP013-DB2-ABEND                                 59750099
597600                  DP013-XCTL-DISPLAY-RESTART                      59760099
597700                             TO TRUE                              59770099
597800              PERFORM 9950-FORMAT-ERROR-MSG                       59780099
597900                                                                  59790099
598000              PERFORM DP013-0000-PROCESS-ABEND                    59800099
598100     END-EVALUATE.                                                59810099
598200                                                                  59820099
598300 8050-DELETE-ODD-UNIT.                                            59830099
598400                                                                  59840099
598500     EXEC SQL                                                     59850099
598600          DELETE                                                  59860099
598700            FROM RCT_VRFD_ODD_UNT                                 59870099
598800            WHERE PO_NBR         = :DK-ORD-NBR                    59880099
598900              AND PO_LNE_NBR     = :DK-LINE-NBR                   59890099
599000              AND RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR               59900099
599100     END-EXEC.                                                    59910099
599200                                                                  59920099
599300     EVALUATE TRUE                                                59930099
599400         WHEN SQLCODE = ZERO                                      59940099
599500         WHEN SQLCODE = +100                                      59950099
599600              CONTINUE                                            59960099
599700         WHEN SQLCODE = -904                                      59970099
599800         WHEN SQLCODE = -911                                      59980099
599900         WHEN SQLCODE = -913                                      59990099
600000              PERFORM 9900-SOFT-ABORT                             60000099
600100                                                                  60010099
600200         WHEN SQLWARN0 NOT = SPACES                               60020099
600300         WHEN SQLCODE  NOT = ZERO                                 60030099
600400              MOVE '8050-DELETE-ODD-UNIT'                         60040099
600500                             TO DP013-PARAGRAPH                   60050099
600600              MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'      60060099
600700                             TO DP013-MESSAGE-TEXT (1)            60070099
600800              MOVE DK-ORD-NBR      TO PV-PO-NBR-PIC9              60080099
600900              MOVE DK-RCVR-SEQ-NBR TO PV-REC-SEQ-NBR-PIC9         60090099
601000              MOVE DK-LINE-NBR     TO PV-PO-LNE-NBR-PIC9          60100099
601100              STRING 'PO '                                        60110099
601200                     PV-PO-NBR-PIC9                               60120099
601300                     ' SEQ '                                      60130099
601400                     PV-REC-SEQ-NBR-PIC9                          60140099
601500                     ' LINE '                                     60150099
601600                     PV-PO-LNE-NBR-PIC9                           60160099
601700                     DELIMITED BY SIZE                            60170099
601800                     INTO DP013-MESSAGE-TEXT (2)                  60180099
601900              MOVE SQLCA     TO DP013-SQLCA                       60190099
602000              MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)         60200099
602100              SET DP013-DB2-ABEND                                 60210099
602200                  DP013-XCTL-DISPLAY-RESTART                      60220099
602300                             TO TRUE                              60230099
602400              PERFORM DP013-0000-PROCESS-ABEND                    60240099
602500     END-EVALUATE.                                                60250099
602600                                                                  60260099
602700                                                                  60270099
602800*----------------------------------------------------------------*60280099
602900*    UPDATE ALL LINES IN RECITM TO HAVE RATIO = 0 AND UNITS = 1. *60290099
603000*----------------------------------------------------------------*60300099
603100 8100-DELETE-LINES.                                               60310099
603200                                                                  60320099
603300                                                                  60330099
603400     IF ASC-NO-EDIT-ERROR AND                                     60340099
603500        DP020-FK-CONFIRM (DP020-SRC-AID) AND                      60350099
603600        ASC-DELETE-PENDING                                        60360099
603700                                                                  60370099
603800          PERFORM 8200-DELETE-TWRKORD                             60380099
603900          PERFORM 8210-DELETE-TWKORIN                             60390099
604000*         PERFORM 8220-DELETE-TWOSTAL                             60400099
604100                                                                  60410099
604200          PERFORM 8230-CLEANUP-TRECITM                            60420099
604300     END-IF.                                                      60430099
604400                                                                  60440099
604500*----------------------------------------------------------------*60450099
604600*    UPDATE ALL LINES IN RECITM TO HAVE RATIO = 0 AND UNITS = 1. *60460099
604700*----------------------------------------------------------------*60470099
604800 8110-UPDATE-RECITM.                                              60480099
604900     EXEC SQL                                                     60490099
605000         UPDATE TRECITM                                           60500099
605100         SET                                                      60510099
605200              DTL_CK_ITM_QTY      = :RECITM-DTL-CK-ITM-QTY        60520099
605300            , PREPK_RATO_QTY      = :RECITM-PREPK-RATO-QTY        60530099
605400            , PREPK_ODD_UNT_QTY   = :RECITM-PREPK-ODD-UNT-QTY     60540099
605500            , PREPK_DRV_LNE_CDE   = :RECITM-PREPK-DRV-LNE-CDE     60550099
605600           WHERE ORD_NBR          = :DK-ORD-NBR                   60560099
605700             AND ORD_LNE_NBR      = :DK-LINE-NBR                  60570099
605800             AND REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR              60580099
605900             AND OPER_UNT_ID      = :DK-OPR-ID                    60590099
606000             AND FCLTY_ID         = :DK-FACT                      60600099
606100             AND PREPK_ID         = :DK-PACK-ID                   60610099
606200             AND VER_STATUS_CDE   = 'A'                           60620099
606300      END-EXEC                                                    60630099
606400                                                                  60640099
606500      EVALUATE TRUE                                               60650099
606600          WHEN SQLCODE = ZERO                                     60660099
606700               CONTINUE                                           60670099
606800                                                                  60680099
606900         WHEN SQLCODE = -904                                      60690099
607000         WHEN SQLCODE = -911                                      60700099
607100         WHEN SQLCODE = -913                                      60710099
607200              PERFORM 9900-SOFT-ABORT                             60720099
607300                                                                  60730099
607400         WHEN OTHER                                               60740099
607500               MOVE '8100-UPDATE-RECITM'                          60750099
607600                                TO DP013-PARAGRAPH                60760099
607700               MOVE 'UNSUCCESSFUL UPDATE FOR TRECITM'             60770099
607800                                TO DP013-MESSAGE-TEXT (1)         60780099
607900               MOVE SQLCA       TO DP013-SQLCA                    60790099
608000               MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)       60800099
608100               PERFORM 9950-FORMAT-ERROR-MSG                      60810099
608200               SET DP013-DB2-ABEND                                60820099
608300                   DP013-XCTL-DISPLAY-RESTART                     60830099
608400                                TO TRUE                           60840099
608500               PERFORM DP013-0000-PROCESS-ABEND                   60850099
608600      END-EVALUATE.                                               60860099
608700                                                                  60870099
608800                                                                  60880099
608900******************************************************************60890099
609000*    THIS PARAGRAPH ADDS A RECDIS RECORD                          60900099
609100******************************************************************60910099
609200 8120-INSERT-TRECDIS.                                             60920099
609300                                                                  60930099
609400     EXEC SQL                                                     60940099
609500         INSERT INTO TRECDIS                                      60950099
609600             (ORD_NBR                                             60960099
609700           ,  ORD_LNE_NBR                                         60970099
609800           ,  REC_SEQ_NBR                                         60980099
609900           ,  OPER_UNT_ID                                         60990099
610000           ,  FCLTY_ID                                            61000099
610100           ,  CRE_TMST                                            61010099
610200           ,  CRE_UID                                             61020099
610300           ,  VER_STATUS_CDE                                      61030099
610400           ,  EXPTED_ITM_QTY                                      61040099
610500           ,  VERIFY_ITM_QTY                                      61050099
610600           ,  AP_VERIFY_ITM_QTY                                   61060099
610700           ,  STR_NBR                                             61070099
610800           ,  STR_FCLTY_ID                                        61080099
610900           ,  PLAN_ITM_QTY                                        61090099
611000           ,  AP_PRC_CDE                                          61100099
611100           ,  AP_PRC_DTE)                                         61110099
611200     VALUES (:RECDIS-ORD-NBR                                      61120099
611300           ,  :RECDIS-ORD-LNE-NBR                                 61130099
611400           ,  :RECDIS-REC-SEQ-NBR                                 61140099
611500           ,  :RECDIS-OPER-UNT-ID                                 61150099
611600           ,  :RECDIS-FCLTY-ID                                    61160099
611700           ,  CURRENT TIMESTAMP                                   61170099
611800           ,  :RECDIS-CRE-UID                                     61180099
611900           ,  :RECDIS-VER-STATUS-CDE                              61190099
612000           ,  :RECDIS-EXPTED-ITM-QTY                              61200099
612100           ,  :RECDIS-VERIFY-ITM-QTY                              61210099
612200           ,  :RECDIS-AP-VERIFY-ITM-QTY                           61220099
612300           ,  :RECDIS-STR-NBR                                     61230099
612400           ,  :RECDIS-STR-FCLTY-ID                                61240099
612500           ,  :RECDIS-PLAN-ITM-QTY                                61250099
612600           ,  :RECDIS-AP-PRC-CDE                                  61260099
612700           ,  :RECDIS-AP-PRC-DTE)                                 61270099
612800     END-EXEC                                                     61280099
612900                                                                  61290099
613000     EVALUATE TRUE                                                61300099
613100         WHEN SQLCODE = ZERO                                      61310099
613200             CONTINUE                                             61320099
613300                                                                  61330099
613400         WHEN SQLCODE = -904                                      61340099
613500         WHEN SQLCODE = -911                                      61350099
613600         WHEN SQLCODE = -913                                      61360099
613700              PERFORM 9900-SOFT-ABORT                             61370099
613800                                                                  61380099
613900         WHEN OTHER                                               61390099
614000               MOVE '8120-INSERT-TRECDIS'                         61400099
614100                                TO DP013-PARAGRAPH                61410099
614200               MOVE 'UNSUCCESSFUL INSERT FOR TRECDIS'             61420099
614300                                TO DP013-MESSAGE-TEXT (1)         61430099
614400               MOVE SQLCA       TO DP013-SQLCA                    61440099
614500               MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)       61450099
614600               SET DP013-DB2-ABEND                                61460099
614700                   DP013-XCTL-DISPLAY-RESTART                     61470099
614800                                TO TRUE                           61480099
614900               PERFORM 9950-FORMAT-ERROR-MSG                      61490099
615000               PERFORM DP013-0000-PROCESS-ABEND                   61500099
615100                                                                  61510099
615200     END-EVALUATE.                                                61520099
615300                                                                  61530099
615400                                                                  61540099
615500*----------------------------------------------------------------*61550099
615600*    DELETE LINE LEVEL TROUBLE.                                  *61560099
615700*----------------------------------------------------------------*61570099
615800 8130-DELETE-TRB-LINE.                                            61580099
615900                                                                  61590099
616000     EXEC SQL                                                     61600099
616100          DELETE                                                  61610099
616200            FROM TTRBNTF                                          61620099
616300           WHERE PO_NBR        = :DK-ORD-NBR                      61630099
616400             AND PO_LNE_NBR    = :DK-LINE-NBR                     61640099
616500             AND REC_SEQ_NBR   = :DK-RCVR-SEQ-NBR                 61650099
616600             AND OPER_UNT_ID   = :DK-OPR-ID                       61660099
616700             AND FCLTY_ID      = :DK-FACT                         61670099
616800     END-EXEC.                                                    61680099
616900                                                                  61690099
617000     EVALUATE TRUE                                                61700099
617100         WHEN SQLCODE = +0                                        61710099
617200         WHEN SQLCODE = +100                                      61720099
617300              CONTINUE                                            61730099
617400                                                                  61740099
617500         WHEN SQLCODE = -904                                      61750099
617600         WHEN SQLCODE = -911                                      61760099
617700         WHEN SQLCODE = -913                                      61770099
617800              PERFORM 9900-SOFT-ABORT                             61780099
617900                                                                  61790099
618000         WHEN OTHER                                               61800099
618100              MOVE '8130-DELETE-TRB-LINE'                         61810099
618200                               TO DP013-PARAGRAPH                 61820099
618300              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               61830099
618400                               TO DP013-MESSAGE-TEXT (1)          61840099
618500              MOVE SQLCA       TO DP013-SQLCA                     61850099
618600              PERFORM 9950-FORMAT-ERROR-MSG                       61860099
618700              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        61870099
618800              SET DP013-DB2-ABEND                                 61880099
618900                  DP013-XCTL-DISPLAY-RESTART                      61890099
619000                               TO TRUE                            61900099
619100              PERFORM DP013-0000-PROCESS-ABEND                    61910099
619200     END-EVALUATE.                                                61920099
619300                                                                  61930099
619400                                                                  61940099
619500                                                                  61950099
619600*----------------------------------------------------------------*61960099
619700*    DELETE ENTIRE ALL PACK LEVEL TROUBLE.                       *61970099
619800*----------------------------------------------------------------*61980099
619900 8140-DELETE-TRB-PACK.                                            61990099
620000                                                                  62000099
620100     EXEC SQL                                                     62010099
620200          DELETE                                                  62020099
620300            FROM TTRBNTF                                          62030099
620400           WHERE PO_NBR       = :DK-ORD-NBR                       62040099
620500             AND REC_SEQ_NBR  = :DK-RCVR-SEQ-NBR                  62050099
620600             AND PREPK_ID     = :DK-PACK-ID                       62060099
620700             AND OPER_UNT_ID  = :DK-OPR-ID                        62070099
620800             AND FCLTY_ID     = :DK-FACT                          62080099
620900     END-EXEC.                                                    62090099
621000                                                                  62100099
621100     EVALUATE TRUE                                                62110099
621200         WHEN SQLCODE = +0                                        62120099
621300         WHEN SQLCODE = +100                                      62130099
621400              CONTINUE                                            62140099
621500                                                                  62150099
621600         WHEN SQLCODE = -904                                      62160099
621700         WHEN SQLCODE = -911                                      62170099
621800         WHEN SQLCODE = -913                                      62180099
621900              PERFORM 9900-SOFT-ABORT                             62190099
622000                                                                  62200099
622100         WHEN OTHER                                               62210099
622200              MOVE '8140-DELETE-TRB-PACK'                         62220099
622300                               TO DP013-PARAGRAPH                 62230099
622400              MOVE 'UNSUCCESSFUL DELETE ON TTRBNTF'               62240099
622500                               TO DP013-MESSAGE-TEXT (1)          62250099
622600              MOVE SQLCA       TO DP013-SQLCA                     62260099
622700              MOVE 'TTRBNTF '  TO DP013-DB2-TABLE-NAME (1)        62270099
622800              PERFORM 9950-FORMAT-ERROR-MSG                       62280099
622900              SET DP013-DB2-ABEND                                 62290099
623000                  DP013-XCTL-DISPLAY-RESTART                      62300099
623100                               TO TRUE                            62310099
623200              PERFORM DP013-0000-PROCESS-ABEND                    62320099
623300     END-EVALUATE.                                                62330099
623400                                                                  62340099
623500                                                                  62350099
623600                                                                  62360099
623700/                                                                 62370099
623800******************************************************************62380099
623900* SINCE PKSL-ITM-QTY = 0 ON A DELETED LINE, DELETE TWRKORD       *62390099
624000******************************************************************62400099
624100                                                                  62410099
624200 8200-DELETE-TWRKORD.                                             62420099
624300                                                                  62430099
624400     EXEC SQL                                                     62440099
624500          UPDATE                                                  62450099
624600                TWRKORD                                           62460099
624700          SET   VER_STATUS_CDE     =  :PC-INACTIVE                62470099
624800              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    62480099
624900          WHERE                                                   62490099
625000                ORD_NBR            =  :DK-ORD-NBR                 62500099
625100          AND   ORD_LNE_NBR        =  :DK-LINE-NBR                62510099
625200          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            62520099
625300          AND   OPER_UNT_ID        =  :DK-OPR-ID                  62530099
625400          AND   FCLTY_ID           =  :DK-FACT                    62540099
625500          AND   VER_STATUS_CDE     =  :PC-A                       62550099
625600     END-EXEC.                                                    62560099
625700                                                                  62570099
625800     EVALUATE TRUE                                                62580099
625900         WHEN SQLCODE = ZERO                                      62590099
626000         WHEN SQLCODE = +100                                      62600099
626100              CONTINUE                                            62610099
626200         WHEN SQLCODE = -904                                      62620099
626300         WHEN SQLCODE = -911                                      62630099
626400         WHEN SQLCODE = -913                                      62640099
626500              PERFORM 9900-SOFT-ABORT                             62650099
626600         WHEN OTHER                                               62660099
626700              MOVE '8200-DELETE-TWRKORD'                          62670099
626800                               TO DP013-PARAGRAPH                 62680099
626900              MOVE 'UPDATE TWRKORD STATUS CODE, UID; TO INACTIVE' 62690099
627000                               TO DP013-MESSAGE-TEXT (1)          62700099
627100              MOVE SQLCA       TO DP013-SQLCA                     62710099
627200              PERFORM 9950-FORMAT-ERROR-MSG                       62720099
627300              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        62730099
627400              SET DP013-DB2-ABEND                                 62740099
627500                               TO TRUE                            62750099
627600              PERFORM DP013-0000-PROCESS-ABEND                    62760099
627700     END-EVALUATE.                                                62770099
627800/                                                                 62780099
627900*----------------------------------------------------------------*62790099
628000*    "DELETE" THE CURRENT TWKORIN ROW - MAKE INACTIVE.           *62800099
628100*----------------------------------------------------------------*62810099
628200                                                                  62820099
628300 8210-DELETE-TWKORIN.                                             62830099
628400                                                                  62840099
628500     EXEC SQL                                                     62850099
628600          UPDATE                                                  62860099
628700                TWKORIN                                           62870099
628800          SET   VER_STATUS_CDE     =  :PC-INACTIVE                62880099
628900              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    62890099
629000          WHERE                                                   62900099
629100                ORD_NBR            =  :DK-ORD-NBR                 62910099
629200          AND   ORD_LNE_NBR        =  :DK-LINE-NBR                62920099
629300          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            62930099
629400          AND   OPER_UNT_ID        =  :DK-OPR-ID                  62940099
629500          AND   FCLTY_ID           =  :DK-FACT                    62950099
629600          AND   VER_STATUS_CDE     =  :PC-A                       62960099
629700     END-EXEC.                                                    62970099
629800                                                                  62980099
629900     EVALUATE TRUE                                                62990099
630000         WHEN SQLCODE = ZERO                                      63000099
630100         WHEN SQLCODE = +100                                      63010099
630200              CONTINUE                                            63020099
630300         WHEN SQLCODE = -904                                      63030099
630400         WHEN SQLCODE = -911                                      63040099
630500         WHEN SQLCODE = -913                                      63050099
630600              PERFORM 9900-SOFT-ABORT                             63060099
630700                                                                  63070099
630800         WHEN OTHER                                               63080099
630900              MOVE '8210-DELETE-TWKORIN'                          63090099
631000                               TO DP013-PARAGRAPH                 63100099
631100              MOVE 'UPDATE TWKORIN STATUS CODE, UID; TO INACTIVE' 63110099
631200                               TO DP013-MESSAGE-TEXT (1)          63120099
631300              PERFORM 9950-FORMAT-ERROR-MSG                       63130099
631400              MOVE SQLCA       TO DP013-SQLCA                     63140099
631500              MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)        63150099
631600              SET DP013-DB2-ABEND                                 63160099
631700                               TO TRUE                            63170099
631800              PERFORM DP013-0000-PROCESS-ABEND                    63180099
631900     END-EVALUATE.                                                63190099
632000/                                                                 63200099
632100*----------------------------------------------------------------*63210099
632200*    "DELETE" THE CURRENT TWOSTAL ROW - MAKE INACTIVE.           *63220099
632300*----------------------------------------------------------------*63230099
632400*                                                                 63240099
632500*8220-DELETE-TWOSTAL.                                             63250099
632600*                                                                 63260099
632700*    EXEC SQL                                                     63270099
632800*         UPDATE                                                  63280099
632900*               TWOSTAL                                           63290099
633000*         SET   VER_STATUS_CDE     =  :PC-INACTIVE                63300099
633100*             , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    63310099
633200*         WHERE                                                   63320099
633300*               ORD_NBR            =  :DK-ORD-NBR                 63330099
633400*         AND   ORD_LNE_NBR        =  :DK-LINE-NBR                63340099
633500*         AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            63350099
633600*         AND   OPER_UNT_ID        =  :DK-OPR-ID                  63360099
633700*         AND   FCLTY_ID           =  :DK-FACT                    63370099
633800*         AND   VER_STATUS_CDE     =  :PC-A                       63380099
633900*    END-EXEC.                                                    63390099
634000*                                                                 63400099
634100*    EVALUATE TRUE                                                63410099
634200*        WHEN SQLCODE = ZERO                                      63420099
634300*        WHEN SQLCODE = +100                                      63430099
634400*             CONTINUE                                            63440099
634500*        WHEN SQLCODE = -904                                      63450099
634600*        WHEN SQLCODE = -911                                      63460099
634700*        WHEN SQLCODE = -913                                      63470099
634800*             PERFORM 9900-SOFT-ABORT                             63480099
634900*                                                                 63490099
635000*        WHEN OTHER                                               63500099
635100*             MOVE '8220-DELETE-TWOSTAL'                          63510099
635200*                              TO DP013-PARAGRAPH                 63520099
635300*             MOVE 'UPDATE TWOSTAL STATUS CODE, UID; TO INACTIVE' 63530099
635400*                              TO DP013-MESSAGE-TEXT (1)          63540099
635500*             MOVE SQLCA       TO DP013-SQLCA                     63550099
635600*             MOVE 'TWOSTAL'   TO DP013-DB2-TABLE-NAME (1)        63560099
635700*             PERFORM 9950-FORMAT-ERROR-MSG                       63570099
635800*             SET DP013-DB2-ABEND                                 63580099
635900*                              TO TRUE                            63590099
636000*             PERFORM DP013-0000-PROCESS-ABEND                    63600099
636100*    END-EVALUATE.                                                63610099
636200*                                                                 63620099
636300*                                                                 63630099
636400*                                                                 63640099
636500******************************************************************63650099
636600* CALL AUDIT TABLE AND PHYSICALLY DELETE RECITM FOR THOSE LINES  *63660099
636700* THAT HAVE PKSL-ITEM-QTY = 0.                                   *63670099
636800******************************************************************63680099
636900 8230-CLEANUP-TRECITM.                                            63690099
637000                                                                  63700099
637100* BEFORE IMAGE                                                    63710099
637200     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       63720099
637300     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          63730099
637400     MOVE 'D'                      TO RC031-AUD-FUNC-CDE.         63740099
637500                                                                  63750099
637600     PERFORM 8240-CALL-AUDIT-PROGRAM.                             63760099
637700                                                                  63770099
637800                                                                  63780099
637900*  AFTER IMAGE                                                    63790099
638000     MOVE 'I'                      TO RC031-TABLE-TO-AUDIT.       63800099
638100     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          63810099
638200     MOVE 'D'                      TO RC031-AUD-FUNC-CDE.         63820099
638300     MOVE 'DE'                     TO RC031-STATUS-CDE            63830099
638400     MOVE DP020-USERID             TO RC031-UPD-UID               63840099
638500     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST              63850099
638600                                                                  63860099
638700     PERFORM 8240-CALL-AUDIT-PROGRAM.                             63870099
638800                                                                  63880099
638900                                                                  63890099
639000* ACTUAL DELETION                                                 63900099
639100     EXEC SQL                                                     63910099
639200         DELETE                                                   63920099
639300         FROM                                                     63930099
639400             TRECITM                                              63940099
639500          WHERE                                                   63950099
639600                ORD_NBR            =  :DK-ORD-NBR                 63960099
639700            AND ORD_LNE_NBR        =  :DK-LINE-NBR                63970099
639800            AND REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR            63980099
639900            AND OPER_UNT_ID        =  :DK-OPR-ID                  63990099
640000            AND FCLTY_ID           =  :DK-FACT                    64000099
640100            AND PREPK_ID           =  :DK-PACK-ID                 64010099
640200     END-EXEC.                                                    64020099
640300                                                                  64030099
640400     EVALUATE TRUE                                                64040099
640500         WHEN SQLCODE = ZERO                                      64050099
640600         WHEN SQLCODE = +100                                      64060099
640700              CONTINUE                                            64070099
640800         WHEN SQLCODE = -904                                      64080099
640900         WHEN SQLCODE = -911                                      64090099
641000         WHEN SQLCODE = -913                                      64100099
641100              PERFORM 9900-SOFT-ABORT                             64110099
641200         WHEN OTHER                                               64120099
641300              MOVE '8230-CLEANUP-TRECITM'                         64130099
641400                               TO DP013-PARAGRAPH                 64140099
641500              MOVE 'DELETE TRECITM'                               64150099
641600                               TO DP013-MESSAGE-TEXT (1)          64160099
641700              MOVE SQLCA       TO DP013-SQLCA                     64170099
641800              MOVE 'TRECITM'   TO DP013-DB2-TABLE-NAME (1)        64180099
641900              SET DP013-DB2-ABEND                                 64190099
642000                               TO TRUE                            64200099
642100              PERFORM 9950-FORMAT-ERROR-MSG                       64210099
642200              PERFORM DP013-0000-PROCESS-ABEND                    64220099
642300     END-EVALUATE.                                                64230099
642400                                                                  64240099
642500                                                                  64250099
642600                                                                  64260099
642700/                                                                 64270099
642800*----------------------------------------------------------------*64280099
642900*    LINK TO AUDIT MODULE * RCKCS290                             *64290099
643000*----------------------------------------------------------------*64300099
643100                                                                  64310099
643200 8240-CALL-AUDIT-PROGRAM.                                         64320099
643300     MOVE DK-ORD-NBR          TO RC031-PO-NBR.                    64330099
643400     MOVE DK-LINE-NBR         TO RC031-PO-LNE-NBR.                64340099
643500     MOVE DK-RCVR-SEQ-NBR     TO RC031-REC-SEQ-NBR.               64350099
643600     MOVE DK-OPR-ID           TO RC031-OPER-UNT-ID.               64360099
643700     MOVE DK-FACT             TO RC031-FCLTY-ID.                  64370099
643800     MOVE PC-CURRENT-PROGRAM-NAME                                 64380099
643900                              TO RC031-UPD-PGM-ID.                64390099
644000                                                                  64400099
644100     EXEC CICS                                                    64410099
644200         LINK PROGRAM  (PC-AUDIT-RTN)                             64420099
644300              COMMAREA (RC031-FIELDS)                             64430099
644400              LENGTH   (PC-AUDIT-RTN-LENGTH)                      64440099
644500     END-EXEC.                                                    64450099
644600                                                                  64460099
644700     EVALUATE TRUE                                                64470099
644800         WHEN RC031-CALL-SUCCESSFUL                               64480099
644900             CONTINUE                                             64490099
645000                                                                  64500099
645100         WHEN OTHER                                               64510099
645200              MOVE '8240-CALL-AUDIT-PROGRAM'                      64520099
645300                                   TO DP013-PARAGRAPH             64530099
645400              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               64540099
645500                                   TO DP013-MESSAGE-TEXT (1)      64550099
645600              MOVE RC031-RETURN-DESC                              64560099
645700                                   TO DP013-MESSAGE-TEXT (2)      64570099
645800              MOVE RC031-SQLCA     TO DP013-SQLCA                 64580099
645900              PERFORM 9950-FORMAT-ERROR-MSG                       64590099
646000              SET DP013-DB2-ABEND                                 64600099
646100                  DP013-XCTL-DISPLAY-RESTART                      64610099
646200                                   TO TRUE                        64620099
646300              PERFORM DP013-0000-PROCESS-ABEND                    64630099
646400     END-EVALUATE.                                                64640099
646500                                                                  64650099
646600/                                                                 64660099
646700/                                                                 64670099
646800******************************************************************64680099
646900* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *64690099
647000******************************************************************64700099
647100 9100-READ-SEL-QUEUE.                                             64710099
647200     EXEC CICS                                                    64720099
647300         READQ TS                                                 64730099
647400             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        64740099
647500             INTO  (RC801-PREPACK-SELECT-RECORD)                  64750099
647600             ITEM  (ASC-SEL-ITEM)                                 64760099
647700             RESP  (PV-CICS-RESP)                                 64770099
647800     END-EXEC.                                                    64780099
647900                                                                  64790099
648000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        64800099
648100         CONTINUE                                                 64810099
648200     ELSE                                                         64820099
648300         SET DP013-LOGIC-ABEND                                    64830099
648400             DP013-NO-ROLLBACK     TO TRUE                        64840099
648500         MOVE '9100-READ-SEL-QUEUE'                               64850099
648600                                   TO DP013-PARAGRAPH             64860099
648700         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    64870099
648800                                   TO DP013-MESSAGE-TEXT (1)      64880099
648900         PERFORM DP013-0000-PROCESS-ABEND                         64890099
649000     END-IF.                                                      64900099
649100                                                                  64910099
649200*----------------------------------------------------------------*64920099
649300* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *64930099
649400*----------------------------------------------------------------*64940099
649500 9200-REWRITE-LIST-QUEUE.                                         64950099
649600     EXEC CICS                                                    64960099
649700          WRITEQ TS                                               64970099
649800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     64980099
649900              FROM    (RC801-PREPACK-SELECT-RECORD)               64990099
650000              ITEM    (ASC-SEL-ITEM)                              65000099
650100              RESP    (PV-CICS-RESP)                              65010099
650200              REWRITE                                             65020099
650300     END-EXEC.                                                    65030099
650400                                                                  65040099
650500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    65050099
650600         SET DP013-CICS-ABEND                                     65060099
650700             DP013-NO-ROLLBACK     TO TRUE                        65070099
650800         MOVE '9200-REWRITE-LIST-QUEUE'                           65080099
650900                                   TO DP013-PARAGRAPH             65090099
651000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   65100099
651100                                   TO DP013-MESSAGE-TEXT (1)      65110099
651200         PERFORM DP013-0000-PROCESS-ABEND                         65120099
651300     END-IF.                                                      65130099
651400                                                                  65140099
651500/                                                                 65150099
651600******************************************************************65160099
651700* READ AN ITEM FROM THE INPUT SELECTED PACK SLIP ITEMS           *65170099
651800* TEMP STORAGE QUEUE.                                            *65180099
651900******************************************************************65190099
652000 9300-READ-PKSL-SEL-QUEUE.                                        65200099
652100                                                                  65210099
652200     EXEC CICS                                                    65220099
652300         READQ TS                                                 65230099
652400             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        65240099
652500             INTO  (RC013-DC-SELECT-RECORD)                       65250099
652600             ITEM  (ASC-SEL-ITEM)                                 65260099
652700             RESP  (PV-CICS-RESP)                                 65270099
652800     END-EXEC.                                                    65280099
652900                                                                  65290099
653000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        65300099
653100         CONTINUE                                                 65310099
653200     ELSE                                                         65320099
653300         SET DP013-LOGIC-ABEND                                    65330099
653400             DP013-NO-ROLLBACK     TO TRUE                        65340099
653500         MOVE '9300-READ-PKSL-SEL-QUEUE'                          65350099
653600                                   TO DP013-PARAGRAPH             65360099
653700         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    65370099
653800                                   TO DP013-MESSAGE-TEXT (1)      65380099
653900         PERFORM DP013-0000-PROCESS-ABEND                         65390099
654000     END-IF.                                                      65400099
654100                                                                  65410099
654200/                                                                 65420099
654210 9903-WRITE-CICS-LOG.                                             65421099
654220                                                                  65422099
654230     EXEC CICS                                                    65423099
654240         WRITEQ TD                                                65424099
654250             QUEUE  ('CSSL')                                      65425099
654260             FROM   (PV-CICS-MSG-AREA)                            65426099
654270             RESP   (PV-CICS-RESP)                                65427099
654280     END-EXEC.                                                    65428099
654290     MOVE SPACES                  TO PV-CICS-MSG-AREA.            65429099
654291/                                                                 65429199
654300******************************************************************65430099
654400* UPDATE AN ITEM IN THE INPUT SELECTED PACK SLIP ITEMS           *65440099
654500* TEMP STORAGE QUEUE.                                            *65450099
654600******************************************************************65460099
654700 9400-REWRITE-PKSL-LIST-QUEUE.                                    65470099
654800                                                                  65480099
654900     EXEC CICS                                                    65490099
655000          WRITEQ TS                                               65500099
655100              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     65510099
655200              FROM    (RC013-DC-SELECT-RECORD)                    65520099
655300              ITEM    (ASC-SEL-ITEM)                              65530099
655400              RESP    (PV-CICS-RESP)                              65540099
655500              REWRITE                                             65550099
655600     END-EXEC.                                                    65560099
655700                                                                  65570099
655800     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    65580099
655900         SET DP013-CICS-ABEND                                     65590099
656000             DP013-NO-ROLLBACK     TO TRUE                        65600099
656100         MOVE '9400-REWRITE-PKSL-LIST-QUEUE'                      65610099
656200                                   TO DP013-PARAGRAPH             65620099
656300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   65630099
656400                                   TO DP013-MESSAGE-TEXT (1)      65640099
656500         PERFORM DP013-0000-PROCESS-ABEND                         65650099
656600     END-IF.                                                      65660099
656700                                                                  65670099
656800/                                                                 65680099
656900*----------------------------------------------------------------*65690099
657000*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *65700099
657100*    AND THE ERROR SWITCHES.                                     *65710099
657200*----------------------------------------------------------------*65720099
657300 9900-SOFT-ABORT.                                                 65730099
657400     SET PS-ERROR         TO TRUE.                                65740099
657500     SET DP020-MSG-FATAL  TO TRUE.                                65750099
657600     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    65760099
657700     SET  DP020-NEXT-ACT-APPL-ERROR TO TRUE.                      65770099
657800     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       65780099
657900     PERFORM 0001-CALL-CICS-ARCH-API.                             65790099
658000                                                                  65800099
658100*----------------------------------------------------------------*65810099
658200*  FORMAT A MESSAGE OUT TO CICS TO INCLUDE MORE INFO             *65820099
658300*----------------------------------------------------------------*65830099
658400                                                                  65840099
658500 9950-FORMAT-ERROR-MSG.                                           65850099
658600                                                                  65860099
658700     MOVE DK-ORD-NBR             TO PV-DISP-PO-NBR.               65870099
658800     MOVE DK-LINE-NBR            TO PV-DISP-PO-LNE-NBR.           65880099
658900     MOVE DK-RCVR-SEQ-NBR        TO PV-DISP-REC-SEQ-NBR.          65890099
659000     MOVE DK-OPR-ID              TO PV-DISP-OPER-UNT-ID.          65900099
659100     MOVE DK-FACT                TO PV-DISP-FCLTY-ID.             65910099
659200     MOVE DK-PACK-ID             TO PV-DISP-PACK-ID.              65920099
659300                                                                  65930099
659400     MOVE '  PO    REC  LNE OPER FCLTY PACK'                      65940099
659500                                 TO DP013-MESSAGE-TEXT (3).       65950099
659600                                                                  65960099
659700     STRING                                                       65970099
659800         PV-DISP-PO-NBR '-'                                       65980099
659900         PV-DISP-REC-SEQ-NBR '-'                                  65990099
660000         PV-DISP-PO-LNE-NBR '-'                                   66000099
660100         PV-DISP-OPER-UNT-ID '-'                                  66010099
660200         PV-DISP-FCLTY-ID '-'                                     66020099
660300         PV-DISP-PACK-ID                                          66030099
660400         DELIMITED BY SIZE INTO DP013-MESSAGE-TEXT (4).           66040099
660500                                                                  66050099
660600*----------------------------------------------------------------*66060099
660700*    ABEND PROCESSOR MODULE                                      *66070099
660800*----------------------------------------------------------------*66080099
660900                                                                  66090099
661000     COPY DPPD013.                                                66100099
