000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKCS290.                                         00020000
000300 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  01-25-97.                                         00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*    E290 - INSERT INTO AUDIT RECEIVING TABLES                    00080000
000900*                                                                 00090000
001000*    THIS IS A CALLED ROUTINE USED TO INSERT ROWS INTO            00100000
001100*    THE TAURECV, TAURECI AND TAURECD                             00110000
001200*                                                                 00120000
001300******************************************************************00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500 CONFIGURATION SECTION.                                           00150000
001600 SOURCE-COMPUTER.        IBM-3090.                                00160000
001700 OBJECT-COMPUTER.        IBM-3090.                                00170000
001800 DATA DIVISION.                                                   00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100 01  DK-DB2-KEYS.                                                 00210000
002200     15  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00220000
002300                                                    COMP.         00230000
002400     15  DK-FCLTY-ID                    PIC S9(04)  VALUE ZERO    00240000
002500                                                    COMP.         00250000
002600     15  DK-PO-NBR                      PIC S9(09)  VALUE +0      00260000
002700                                                    COMP.         00270000
002800     15  DK-PO-LNE-NBR                  PIC S9(09)  VALUE +0      00280000
002900                                                    COMP.         00290000
003000     15  DK-REC-SEQ-NBR                 PIC S9(04)  VALUE +0      00300000
003100                                                    COMP SYNC.    00310000
003200     15  DK-STR-NBR                     PIC S9(04)  VALUE +0      00320000
003300                                                    COMP SYNC.    00330000
003400 01  PC-PROGRAM-CONSTANTS.                                        00340000
003500     05  PC-A                         PIC X(01) VALUE 'A'.        00350000
003600                                                                  00360000
003700 01  PS-PROGRAM-SWITCHES.                                         00370000
003800     05  PS-DONE-SW                   PIC  X    VALUE 'N'.        00380000
003900         88  PS-NOT-DONE                        VALUE 'N'.        00390000
004000         88  PS-DONE                            VALUE 'Y'.        00400000
004100                                                                  00410000
004200 01  PV-PROGRAM-VARIABLES.                                        00420000
004300     05  PV-DB2-COUNT                 PIC S9(09)  VALUE ZERO      00430000
004400                                              COMP-3.             00440000
004500     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00450000
004600                                              COMP SYNC.          00460000
004700     05  PV-USER-ID                   PIC  X(08)  VALUE SPACE.    00470000
004800                                                                  00480000
004900 01  PRV-PROGRAM-RETURN-VARIABLES.                                00490000
005000     05  PRV-00                       PIC X(42) VALUE             00500000
005100         '00PROGRAM CALL WAS SUCCESSFUL             '.            00510000
005200     05  PRV-01                       PIC X(42) VALUE             00520000
005300         '01TABLE TO AUDIT CODE IS INVALID          '.            00530000
005400     05  PRV-02                       PIC X(42) VALUE             00540000
005500         '02AUDIT TYPE CODE IS INVALID              '.            00550000
005600     05  PRV-03                       PIC X(42) VALUE             00560000
005700         '03AUDIT FUNCTION CODE IS INVALID          '.            00570000
005800     05  PRV-04                       PIC X(42) VALUE             00580000
005900         '04STATUS CODE REQUIRED FOR DELETE         '.            00590000
006000     05  PRV-10                       PIC X(42) VALUE             00600000
006100         '10TRECEIV RECORD NOT FOUND                '.            00610000
006200     05  PRV-11                       PIC X(42) VALUE             00620000
006300         '11TRECITM RECORD NOT FOUND                '.            00630000
006400     05  PRV-12                       PIC X(42) VALUE             00640000
006500         '12TRECDIS RECORD NOT FOUND                '.            00650000
006600     05  PRV-20                       PIC X(42) VALUE             00660000
006700         '20TRECEIV SELECT ERROR                    '.            00670000
006800     05  PRV-21                       PIC X(42) VALUE             00680000
006900         '21TAURECV INSERT ERROR                    '.            00690000
007000     05  PRV-22                       PIC X(42) VALUE             00700000
007100         '22TRECITM SELECT ERROR                    '.            00710000
007200     05  PRV-23                       PIC X(42) VALUE             00720000
007300         '23TAURECI INSERT ERROR                    '.            00730000
007400     05  PRV-24                       PIC X(42) VALUE             00740000
007500         '24TRECDIS SELECT ERROR                    '.            00750000
007600     05  PRV-25                       PIC X(42) VALUE             00760000
007700         '25TAURECD INSERT ERROR                    '.            00770000
007800     05  PRV-31                       PIC X(42) VALUE             00780000
007900         '31PGM-ID UID AND TMST REQD -DELETE TRECEIV'.            00790000
008000     05  PRV-32                       PIC X(42) VALUE             00800000
008100         '32PGM-ID UID AND TMST REQD -DELETE TRECITM'.            00810000
008200     05  PRV-33                       PIC X(42) VALUE             00820000
008300         '33NOTIF-NBR AND ADJ-CYC-NBR REQD - TRECDIS'.            00830000
008400     05  PRV-34                       PIC X(42) VALUE             00840000
008500         '34PGM-ID UID AND TMST REQUIRED FOR TRECDIS'.            00850000
008600     05  PRV-99                       PIC X(42) VALUE             00860000
008700         '99INVALID RETURN CODE FROM CICS           '.            00870000
008800                                                                  00880000
008900******************************************************************00890000
009000*    COPYBOOK AREA                                                00900000
009100******************************************************************00910000
009200     COPY RCWS031.                                                00920000
009300                                                                  00930000
009400******************************************************************00940000
009500*    DB2 SQL COMMUNICATION AREA                                   00950000
009600******************************************************************00960000
009700     EXEC SQL                                                     00970000
009800          INCLUDE SQLCA                                           00980000
009900     END-EXEC.                                                    00990000
010000                                                                  01000000
010100******************************************************************01010000
010200*    DB2 DCLGEN FOR RECEIVER TABLE                                01020000
010300******************************************************************01030000
010400     EXEC SQL                                                     01040000
010500          INCLUDE TRECEIV                                         01050000
010600     END-EXEC.                                                    01060000
010700                                                                  01070000
010800******************************************************************01080000
010900*    DB2 DCLGEN FOR RECEIVER AUDIT TABLE                          01090000
011000******************************************************************01100000
011100     EXEC SQL                                                     01110000
011200          INCLUDE TAURECV                                         01120000
011300     END-EXEC.                                                    01130000
011400                                                                  01140000
011500******************************************************************01150000
011600*    DB2 DCLGEN FOR RECEIPT ITEM TABLE                            01160000
011700******************************************************************01170000
011800     EXEC SQL                                                     01180000
011900          INCLUDE TRECITM                                         01190000
012000     END-EXEC.                                                    01200000
012100                                                                  01210000
012200******************************************************************01220000
012300*    DB2 DCLGEN FOR RECEIPT ITEM AUDIT TABLE                      01230000
012400******************************************************************01240000
012500     EXEC SQL                                                     01250000
012600          INCLUDE TAURECI                                         01260000
012700     END-EXEC.                                                    01270000
012800                                                                  01280000
012900******************************************************************01290000
013000*    DB2 DCLGEN FOR RECEIPT DISTRO TABLE                          01300000
013100******************************************************************01310000
013200     EXEC SQL                                                     01320000
013300          INCLUDE TRECDIS                                         01330000
013400     END-EXEC.                                                    01340000
013500                                                                  01350000
013600******************************************************************01360000
013700*    DB2 DCLGEN FOR RECEIPT DISTRO AUDIT TABLE                    01370000
013800******************************************************************01380000
013900     EXEC SQL                                                     01390000
014000          INCLUDE TAURECD                                         01400000
014100     END-EXEC.                                                    01410000
014200                                                                  01420000
014300                                                                  01430000
014400 LINKAGE SECTION.                                                 01440000
014500                                                                  01450000
014600 01  DFHCOMMAREA.                                                 01460000
014700     05  FILLER                       OCCURS 1 TO 300  TIMES      01470000
014800                                      DEPENDING ON EIBCALEN.      01480000
014900         10  FILLER                   PIC X.                      01490000
015000                                                                  01500000
015100                                                                  01510000
015200 PROCEDURE DIVISION.                                              01520000
015300                                                                  01530000
015400 0000-MAIN-MODULE.                                                01540000
015500                                                                  01550000
015600     PERFORM 1000-INITIAL-PROCESS.                                01560000
015700                                                                  01570000
015800     IF PS-NOT-DONE                                               01580000
015900         PERFORM 2000-MAIN-PROCESS                                01590000
016000     END-IF.                                                      01600000
016100                                                                  01610000
016200     MOVE RC031-FIELDS TO DFHCOMMAREA.                            01620000
016300                                                                  01630000
016400     GOBACK.                                                      01640000
016500                                                                  01650000
016600                                                                  01660000
016700 1000-INITIAL-PROCESS.                                            01670000
016800                                                                  01680000
016900     INITIALIZE RC031-FIELDS.                                     01690000
017000                                                                  01700000
017100     IF EIBCALEN = 0                                              01710000
017200         SET PS-DONE      TO TRUE                                 01720000
017300     ELSE                                                         01730000
017400         MOVE DFHCOMMAREA TO RC031-FIELDS                         01740000
017500         MOVE PRV-00      TO RC031-RETURN-DATA                    01750000
017600         IF RC031-VALID-TABLES                                    01760000
017700             CONTINUE                                             01770000
017800         ELSE                                                     01780000
017900             MOVE PRV-01      TO RC031-RETURN-DATA                01790000
018000             SET PS-DONE      TO TRUE                             01800000
018100         END-IF                                                   01810000
018200         IF RC031-VALID-BEF-AFT OR                                01820000
018300            PS-DONE                                               01830000
018400             CONTINUE                                             01840000
018500         ELSE                                                     01850000
018600             MOVE PRV-02      TO RC031-RETURN-DATA                01860000
018700             SET PS-DONE      TO TRUE                             01870000
018800         END-IF                                                   01880000
018900         IF RC031-VALID-AUD-FUNC OR                               01890000
019000            PS-DONE                                               01900000
019100             CONTINUE                                             01910000
019200         ELSE                                                     01920000
019300             MOVE PRV-03      TO RC031-RETURN-DATA                01930000
019400             SET PS-DONE      TO TRUE                             01940000
019500         END-IF                                                   01950000
019600         IF (RC031-AUDIT-TRECEIV OR                               01960000
019700             RC031-AUDIT-TRECITM) AND                             01970000
019800             RC031-AFTER AND                                      01980000
019900             RC031-DELETE AND                                     01990000
020000             RC031-STATUS-CDE = SPACES                            02000000
020100             MOVE PRV-04      TO RC031-RETURN-DATA                02010000
020200             SET PS-DONE      TO TRUE                             02020000
020300         END-IF                                                   02030000
020400                                                                  02040000
020500     END-IF.                                                      02050000
020600                                                                  02060000
020700     EXEC CICS                                                    02070000
020800         ASSIGN USERID (PV-USER-ID)                               02080000
020900                RESP   (PV-CICS-RESPONSE)                         02090000
021000     END-EXEC.                                                    02100000
021100                                                                  02110000
021200     EVALUATE TRUE                                                02120000
021300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02130000
021400             CONTINUE                                             02140000
021500         WHEN OTHER                                               02150000
021600             MOVE PRV-99      TO RC031-RETURN-DATA                02160000
021700             SET PS-DONE      TO TRUE                             02170000
021800     END-EVALUATE.                                                02180000
021900                                                                  02190000
022000                                                                  02200000
022100 2000-MAIN-PROCESS.                                               02210000
022200                                                                  02220000
022300     EVALUATE TRUE                                                02230000
022400         WHEN RC031-AUDIT-TRECEIV                                 02240000
022500             IF RC031-AFTER AND                                   02250000
022600                RC031-DELETE AND                                  02260000
022700                (RC031-UPD-PGM-ID = SPACES OR                     02270000
022800                RC031-UPD-UID = SPACES OR                         02280000
022900                RC031-UPD-TMST = SPACES OR                        02290000
023000                RC031-STATUS-CDE = SPACES)                        02300000
023100                 SET  PS-DONE TO TRUE                             02310000
023200                 MOVE PRV-31  TO RC031-RETURN-DATA                02320000
023300             END-IF                                               02330000
023400             IF PS-NOT-DONE                                       02340000
023500                 PERFORM 3000-AUDIT-RECEIV                        02350000
023600             END-IF                                               02360000
023700                                                                  02370000
023800         WHEN RC031-AUDIT-TRECITM                                 02380000
023900             IF RC031-AFTER AND                                   02390000
024000                RC031-DELETE AND                                  02400000
024100                (RC031-UPD-PGM-ID = SPACES OR                     02410000
024200                RC031-UPD-UID = SPACES OR                         02420000
024300                RC031-UPD-TMST = SPACES OR                        02430000
024400                RC031-STATUS-CDE = SPACES)                        02440000
024500                 SET  PS-DONE TO TRUE                             02450000
024600                 MOVE PRV-32  TO RC031-RETURN-DATA                02460000
024700             END-IF                                               02470000
024800             IF PS-NOT-DONE                                       02480000
024900                 PERFORM 4000-AUDIT-RECITM                        02490000
025000             END-IF                                               02500000
025100                                                                  02510000
025200         WHEN RC031-AUDIT-TRECDIS                                 02520000
025300             IF RC031-AFTER AND                                   02530000
025400                RC031-UPDATE AND                                  02540000
025500                (RC031-NOTIF-NBR = 0 OR                           02550000
025600                RC031-ADJ-CYC-NBR = 0)                            02560000
025700                 SET  PS-DONE TO TRUE                             02570000
025800                 MOVE PRV-33  TO RC031-RETURN-DATA                02580000
025900             END-IF                                               02590000
026000             IF (RC031-UPD-PGM-ID = SPACES OR                     02600000
026100                RC031-UPD-UID = SPACES OR                         02610000
026200                RC031-UPD-TMST = SPACES)                          02620000
026300                 SET  PS-DONE TO TRUE                             02630000
026400                 MOVE PRV-34  TO RC031-RETURN-DATA                02640000
026500             END-IF                                               02650000
026600             IF PS-NOT-DONE                                       02660000
026700                 PERFORM 5000-AUDIT-RECDIS                        02670000
026800             END-IF                                               02680000
026900                                                                  02690000
027000         WHEN OTHER                                               02700000
027100              SET  PS-DONE TO TRUE                                02710000
027200              MOVE PRV-01  TO RC031-RETURN-DATA                   02720000
027300     END-EVALUATE.                                                02730000
027400                                                                  02740000
027500 3000-AUDIT-RECEIV.                                               02750000
027600******************************************************************02760000
027700     MOVE RC031-OPER-UNT-ID  TO DK-OPER-UNT-ID.                   02770000
027800     MOVE RC031-FCLTY-ID     TO DK-FCLTY-ID.                      02780000
027900     MOVE RC031-PO-NBR       TO DK-PO-NBR.                        02790000
028000     MOVE RC031-REC-SEQ-NBR  TO DK-REC-SEQ-NBR.                   02800000
028100                                                                  02810000
028200     PERFORM 3100-SELECT-RECEIV.                                  02820000
028300     IF SQLCODE = +100                                            02830000
028400         MOVE PRV-10      TO RC031-RETURN-DATA                    02840000
028500     ELSE                                                         02850000
028600         MOVE RC031-AUD-TYP-CDE  TO AURECV-AUD-TYP-CDE            02860000
028700         MOVE RC031-AUD-FUNC-CDE TO AURECV-AUD-FUNC-CDE           02870000
028800         MOVE ZERO               TO AURECV-NOTIF-NBR              02880000
028900         IF RC031-AFTER AND                                       02890000
029000            RC031-DELETE                                          02900000
029100             MOVE RC031-UPD-PGM-ID   TO RECEIV-UPD-PGM-ID         02910000
029200             MOVE RC031-UPD-UID      TO RECEIV-UPD-UID            02920000
029300             MOVE RC031-UPD-TMST     TO RECEIV-UPD-TMST           02930000
029400             MOVE RC031-STATUS-CDE   TO RECEIV-STATUS-CDE         02940000
029500         END-IF                                                   02950000
029600         PERFORM 3200-WRITE-AURECV                                02960000
029700     END-IF.                                                      02970000
029800                                                                  02980000
029900 3100-SELECT-RECEIV.                                              02990000
030000                                                                  03000000
030100     EXEC SQL                                                     03010000
030200        SELECT ORD_NBR                                            03020000
030300              ,REC_SEQ_NBR                                        03030000
030400              ,CRE_TMST                                           03040000
030500              ,CRE_UID                                            03050000
030600              ,PO_VER_NBR                                         03060000
030700              ,OPER_UNT_ID                                        03070000
030800              ,FCLTY_ID                                           03080000
030900              ,STATUS_CDE                                         03090000
031000              ,SYST_CRE_CDE                                       03100000
031100              ,REC_TYP_CDE                                        03110000
031200              ,VER_STATUS_CDE                                     03120000
031300              ,PACK_BY_ST_IND                                     03130000
031400              ,REC_TMST                                           03140000
031500              ,EXPTED_CART_CNT                                    03150000
031600              ,ACTL_CART_CNT                                      03160000
031700              ,EXPTED_ITM_QTY                                     03170000
031800              ,ACTL_ITM_QTY                                       03180000
031900              ,RCVR_NBR                                           03190000
032000              ,ML_POST_TMST                                       03200000
032100              ,FS_POST_TMST                                       03210000
032200              ,PRE_TKT_IND                                        03220000
032300              ,AD_INFO_DESC                                       03230000
032400              ,IN_TRBL_TMST                                       03240000
032500              ,IN_TRBL_MIN_CNT                                    03250000
032600              ,IN_TRBL_HOUR_CNT                                   03260000
032700              ,VERFYD_TMST                                        03270000
032800              ,RCVG_CLERK_INIT_ID                                 03280000
032900              ,REFER_BACK_SEQ_NBR                                 03290000
033000              ,AP_PRC_CDE                                         03300000
033100              ,AP_PRC_DTE                                         03310000
033200              ,MIS_DIRECT_IND                                     03320000
033300              ,IMPRT_IND                                          03330000
033400              ,CRE_OPER_UNT_ID                                    03340000
033500              ,CRE_FCLTY_ID                                       03350000
033600              ,CURR_OPER_UNT_ID                                   03360000
033700              ,CURR_FCLTY_ID                                      03370000
033800              ,UPD_TMST                                           03380000
033900              ,UPD_UID                                            03390000
034000              ,UPD_PGM_ID                                         03400000
034100              ,APRON_LOC_DESC                                     03410000
034200              ,MKNG_APRN_PRT_TMST                                 03420000
034300              ,GOH_IND                                            03430000
034400              ,VRFD_USR_ID                                        03440000
034500              ,AP_RVRSL_IND                                       03450000
034510              ,AP_RVRSL_DTE                                       03451000
034520              ,PKGNG_CDE                                          03452000
034530              ,FRE_ASTRA_IND                                      03453000
034600          INTO :RECEIV-ORD-NBR                                    03460000
034700              ,:RECEIV-REC-SEQ-NBR                                03470000
034800              ,:RECEIV-CRE-TMST                                   03480000
034900              ,:RECEIV-CRE-UID                                    03490000
035000              ,:RECEIV-PO-VER-NBR                                 03500000
035100              ,:RECEIV-OPER-UNT-ID                                03510000
035200              ,:RECEIV-FCLTY-ID                                   03520000
035300              ,:RECEIV-STATUS-CDE                                 03530000
035400              ,:RECEIV-SYST-CRE-CDE                               03540000
035500              ,:RECEIV-REC-TYP-CDE                                03550000
035600              ,:RECEIV-VER-STATUS-CDE                             03560000
035700              ,:RECEIV-PACK-BY-ST-IND                             03570000
035800              ,:RECEIV-REC-TMST                                   03580000
035900              ,:RECEIV-EXPTED-CART-CNT                            03590000
036000              ,:RECEIV-ACTL-CART-CNT                              03600000
036100              ,:RECEIV-EXPTED-ITM-QTY                             03610000
036200              ,:RECEIV-ACTL-ITM-QTY                               03620000
036300              ,:RECEIV-RCVR-NBR                                   03630000
036400              ,:RECEIV-ML-POST-TMST                               03640000
036500              ,:RECEIV-FS-POST-TMST                               03650000
036600              ,:RECEIV-PRE-TKT-IND                                03660000
036700              ,:RECEIV-AD-INFO-DESC                               03670000
036800              ,:RECEIV-IN-TRBL-TMST                               03680000
036900              ,:RECEIV-IN-TRBL-MIN-CNT                            03690000
037000              ,:RECEIV-IN-TRBL-HOUR-CNT                           03700000
037100              ,:RECEIV-VERFYD-TMST                                03710000
037200              ,:RECEIV-RCVG-CLERK-INIT-ID                         03720000
037300              ,:RECEIV-REFER-BACK-SEQ-NBR                         03730000
037400              ,:RECEIV-AP-PRC-CDE                                 03740000
037500              ,:RECEIV-AP-PRC-DTE                                 03750000
037600              ,:RECEIV-MIS-DIRECT-IND                             03760000
037700              ,:RECEIV-IMPRT-IND                                  03770000
037800              ,:RECEIV-CRE-OPER-UNT-ID                            03780000
037900              ,:RECEIV-CRE-FCLTY-ID                               03790000
038000              ,:RECEIV-CURR-OPER-UNT-ID                           03800000
038100              ,:RECEIV-CURR-FCLTY-ID                              03810000
038200              ,:RECEIV-UPD-TMST                                   03820000
038300              ,:RECEIV-UPD-UID                                    03830000
038400              ,:RECEIV-UPD-PGM-ID                                 03840000
038500              ,:RECEIV-APRON-LOC-DESC                             03850000
038600              ,:RECEIV-MKNG-APRN-PRT-TMST                         03860000
038700              ,:RECEIV-GOH-IND                                    03870000
038800              ,:RECEIV-VRFD-USR-ID                                03880000
038810              ,:RECEIV-AP-RVRSL-IND                               03881000
038820              ,:RECEIV-AP-RVRSL-DTE                               03882000
038830              ,:RECEIV-PKGNG-CDE                                  03883000
038840              ,:RECEIV-FRE-ASTRA-IND                              03884000
039000          FROM  TRECEIV                                           03900000
039100*        WHERE OPER_UNT_ID    = :DK-OPER-UNT-ID                   03910000
039200*          AND FCLTY_ID       = :DK-FCLTY-ID                      03920000
039300         WHERE ORD_NBR        = :DK-PO-NBR                        03930000
039400           AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                   03940000
039500           AND VER_STATUS_CDE = :PC-A                             03950000
039600     END-EXEC.                                                    03960000
039700                                                                  03970000
039800     EVALUATE TRUE                                                03980000
039900         WHEN SQLCODE = +0                                        03990000
040000             CONTINUE                                             04000000
040100                                                                  04010000
040200         WHEN SQLCODE = +100                                      04020000
040300             CONTINUE                                             04030000
040400                                                                  04040000
040500         WHEN SQLWARN0 NOT = SPACE                                04050000
040600         WHEN SQLCODE < +0                                        04060000
040700         WHEN SQLCODE > +0                                        04070000
040800             SET PS-DONE TO TRUE                                  04080000
040900             MOVE SQLCA TO RC031-SQLCA                            04090000
041000             MOVE SQLCODE TO RC031-SQLCODE                        04100000
041100             MOVE PRV-20 TO RC031-RETURN-DATA                     04110000
041200     END-EVALUATE.                                                04120000
041300                                                                  04130000
041400 3200-WRITE-AURECV.                                               04140000
041500                                                                  04150000
041600     EXEC SQL                                                     04160000
041700        INSERT INTO TAURECV                                       04170000
041800              (ORD_NBR                                            04180000
041900              ,REC_SEQ_NBR                                        04190000
042000              ,CRE_TMST                                           04200000
042100              ,CRE_UID                                            04210000
042200              ,PO_VER_NBR                                         04220000
042300              ,OPER_UNT_ID                                        04230000
042400              ,FCLTY_ID                                           04240000
042500              ,STATUS_CDE                                         04250000
042600              ,SYST_CRE_CDE                                       04260000
042700              ,REC_TYP_CDE                                        04270000
042800              ,VER_STATUS_CDE                                     04280000
042900              ,PACK_BY_ST_IND                                     04290000
043000              ,REC_TMST                                           04300000
043100              ,EXPTED_CART_CNT                                    04310000
043200              ,ACTL_CART_CNT                                      04320000
043300              ,EXPTED_ITM_QTY                                     04330000
043400              ,ACTL_ITM_QTY                                       04340000
043500              ,RCVR_NBR                                           04350000
043600              ,ML_POST_TMST                                       04360000
043700              ,FS_POST_TMST                                       04370000
043800              ,PRE_TKT_IND                                        04380000
043900              ,AD_INFO_DESC                                       04390000
044000              ,IN_TRBL_TMST                                       04400000
044100              ,IN_TRBL_MIN_CNT                                    04410000
044200              ,IN_TRBL_HOUR_CNT                                   04420000
044300              ,VERFYD_TMST                                        04430000
044400              ,RCVG_CLERK_INIT_ID                                 04440000
044500              ,REFER_BACK_SEQ_NBR                                 04450000
044600              ,AP_PRC_CDE                                         04460000
044700              ,AP_PRC_DTE                                         04470000
044800              ,MIS_DIRECT_IND                                     04480000
044900              ,IMPRT_IND                                          04490000
045000              ,CRE_OPER_UNT_ID                                    04500000
045100              ,CRE_FCLTY_ID                                       04510000
045200              ,CURR_OPER_UNT_ID                                   04520000
045300              ,CURR_FCLTY_ID                                      04530000
045400              ,UPD_TMST                                           04540000
045500              ,UPD_UID                                            04550000
045600              ,UPD_PGM_ID                                         04560000
045700              ,APRON_LOC_DESC                                     04570000
045800              ,MKNG_APRN_PRT_TMST                                 04580000
045900              ,GOH_IND                                            04590000
046000              ,AUD_TYP_CDE                                        04600000
046100              ,AUD_FUNC_CDE                                       04610000
046200              ,NOTIF_NBR                                          04620000
046300              ,VRFD_USR_ID                                        04630000
046310              ,AP_RVRSL_IND                                       04631000
046320              ,AP_RVRSL_DTE                                       04632000
046400              ,PKGNG_CDE                                          04640000
046410              ,FRE_ASTRA_IND)                                     04641000
046500             VALUES                                               04650000
046600              (:RECEIV-ORD-NBR                                    04660000
046700              ,:RECEIV-REC-SEQ-NBR                                04670000
046800              ,:RECEIV-CRE-TMST                                   04680000
046900              ,:RECEIV-CRE-UID                                    04690000
047000              ,:RECEIV-PO-VER-NBR                                 04700000
047100              ,:RECEIV-OPER-UNT-ID                                04710000
047200              ,:RECEIV-FCLTY-ID                                   04720000
047300              ,:RECEIV-STATUS-CDE                                 04730000
047400              ,:RECEIV-SYST-CRE-CDE                               04740000
047500              ,:RECEIV-REC-TYP-CDE                                04750000
047600              ,:RECEIV-VER-STATUS-CDE                             04760000
047700              ,:RECEIV-PACK-BY-ST-IND                             04770000
047800              ,:RECEIV-REC-TMST                                   04780000
047900              ,:RECEIV-EXPTED-CART-CNT                            04790000
048000              ,:RECEIV-ACTL-CART-CNT                              04800000
048100              ,:RECEIV-EXPTED-ITM-QTY                             04810000
048200              ,:RECEIV-ACTL-ITM-QTY                               04820000
048300              ,:RECEIV-RCVR-NBR                                   04830000
048400              ,:RECEIV-ML-POST-TMST                               04840000
048500              ,:RECEIV-FS-POST-TMST                               04850000
048600              ,:RECEIV-PRE-TKT-IND                                04860000
048700              ,:RECEIV-AD-INFO-DESC                               04870000
048800              ,:RECEIV-IN-TRBL-TMST                               04880000
048900              ,:RECEIV-IN-TRBL-MIN-CNT                            04890000
049000              ,:RECEIV-IN-TRBL-HOUR-CNT                           04900000
049100              ,:RECEIV-VERFYD-TMST                                04910000
049200              ,:RECEIV-RCVG-CLERK-INIT-ID                         04920000
049300              ,:RECEIV-REFER-BACK-SEQ-NBR                         04930000
049400              ,:RECEIV-AP-PRC-CDE                                 04940000
049500              ,:RECEIV-AP-PRC-DTE                                 04950000
049600              ,:RECEIV-MIS-DIRECT-IND                             04960000
049700              ,:RECEIV-IMPRT-IND                                  04970000
049800              ,:RECEIV-CRE-OPER-UNT-ID                            04980000
049900              ,:RECEIV-CRE-FCLTY-ID                               04990000
050000              ,:RECEIV-CURR-OPER-UNT-ID                           05000000
050100              ,:RECEIV-CURR-FCLTY-ID                              05010000
050200              ,:RECEIV-UPD-TMST                                   05020000
050300              ,:RECEIV-UPD-UID                                    05030000
050400              ,:RECEIV-UPD-PGM-ID                                 05040000
050500              ,:RECEIV-APRON-LOC-DESC                             05050000
050600              ,:RECEIV-MKNG-APRN-PRT-TMST                         05060000
050700              ,:RECEIV-GOH-IND                                    05070000
050800              ,:AURECV-AUD-TYP-CDE                                05080000
050900              ,:AURECV-AUD-FUNC-CDE                               05090000
051000              ,:AURECV-NOTIF-NBR                                  05100000
051100              ,:RECEIV-VRFD-USR-ID                                05110000
051110              ,:RECEIV-AP-RVRSL-IND                               05111000
051120              ,:RECEIV-AP-RVRSL-DTE                               05112000
051130              ,:RECEIV-PKGNG-CDE                                  05113000
051140              ,:RECEIV-FRE-ASTRA-IND)                             05114000
051300     END-EXEC.                                                    05130000
051400                                                                  05140000
051500     EVALUATE TRUE                                                05150000
051600         WHEN SQLCODE = +0                                        05160000
051700             CONTINUE                                             05170000
051800                                                                  05180000
051900         WHEN SQLWARN0 NOT = SPACE                                05190000
052000         WHEN SQLCODE < +0                                        05200000
052100         WHEN SQLCODE > +0                                        05210000
052200             SET PS-DONE TO TRUE                                  05220000
052300             MOVE SQLCA TO RC031-SQLCA                            05230000
052400             MOVE SQLCODE TO RC031-SQLCODE                        05240000
052500             MOVE PRV-21 TO RC031-RETURN-DATA                     05250000
052600     END-EVALUATE.                                                05260000
052700                                                                  05270000
052800                                                                  05280000
052900 4000-AUDIT-RECITM.                                               05290000
053000******************************************************************05300000
053100                                                                  05310000
053200     MOVE RC031-OPER-UNT-ID  TO DK-OPER-UNT-ID.                   05320000
053300     MOVE RC031-FCLTY-ID     TO DK-FCLTY-ID.                      05330000
053400     MOVE RC031-PO-NBR       TO DK-PO-NBR.                        05340000
053500     MOVE RC031-PO-LNE-NBR   TO DK-PO-LNE-NBR.                    05350000
053600     MOVE RC031-REC-SEQ-NBR  TO DK-REC-SEQ-NBR.                   05360000
053700                                                                  05370000
053800     PERFORM 4100-SELECT-RECITM.                                  05380000
053900     IF SQLCODE = +100                                            05390000
054000         MOVE PRV-11      TO RC031-RETURN-DATA                    05400000
054100     ELSE                                                         05410000
054200         MOVE RC031-AUD-TYP-CDE  TO AURECI-AUD-TYP-CDE            05420000
054300         MOVE RC031-AUD-FUNC-CDE TO AURECI-AUD-FUNC-CDE           05430000
054400         MOVE ZERO               TO AURECI-NOTIF-NBR              05440000
054500         IF RC031-AFTER AND                                       05450000
054600            RC031-DELETE                                          05460000
054700             MOVE RC031-UPD-PGM-ID   TO RECITM-UPD-PGM-ID         05470000
054800             MOVE RC031-UPD-UID      TO RECITM-UPD-UID            05480000
054900             MOVE RC031-UPD-TMST     TO RECITM-UPD-TMST           05490000
055000             MOVE RC031-STATUS-CDE   TO RECITM-STATUS-CDE         05500000
055100         END-IF                                                   05510000
055200         PERFORM 4200-WRITE-AURECI                                05520000
055300     END-IF.                                                      05530000
055400                                                                  05540000
055500                                                                  05550000
055600******************************************************************05560000
055700 4100-SELECT-RECITM.                                              05570000
055800                                                                  05580000
055900     EXEC SQL                                                     05590000
056000       SELECT ORD_NBR                                             05600000
056100             ,ORD_LNE_NBR                                         05610000
056200             ,REC_SEQ_NBR                                         05620000
056300             ,OPER_UNT_ID                                         05630000
056400             ,FCLTY_ID                                            05640000
056500             ,CRE_TMST                                            05650000
056600             ,CRE_UID                                             05660000
056700             ,PO_VER_NBR                                          05670000
056800             ,ITM_NBR                                             05680000
056900             ,PRE_TKT_IND                                         05690000
057000             ,TKT_FMT_ID                                          05700000
057100             ,RTV_IND                                             05710000
057200             ,STATUS_CDE                                          05720000
057300             ,VER_STATUS_CDE                                      05730000
057400             ,PKSL_ITM_QTY                                        05740000
057500             ,DTL_CK_ITM_QTY                                      05750000
057600             ,INNR_PACK_QTY                                       05760000
057700             ,CASE_PACK_QTY                                       05770000
057800             ,RTV_QTY                                             05780000
057900             ,EXPTED_CART_CNT                                     05790000
058000             ,ACTL_CART_CNT                                       05800000
058100             ,MKING_APRON_TMST                                    05810000
058200             ,UNT_COST_AMT                                        05820000
058300             ,COLOR_DESC                                          05830000
058400             ,SIZE_DESC                                           05840000
058500             ,VEND_STYL_NAME                                      05850000
058600             ,VEND_DESC                                           05860000
058700             ,VERFYD_TMST                                         05870000
058800             ,PKSL_NBR                                            05880000
058900             ,REC_INV_LNE_NBR                                     05890000
059000             ,DMG_ITM_QTY                                         05900000
059100             ,UPD_TMST                                            05910000
059200             ,UPD_UID                                             05920000
059300             ,UPD_PGM_ID                                          05930000
059400             ,RCPT_DISTR_UPD_CDE                                  05940000
059500             ,VRFD_USR_ID                                         05950000
059600             ,LAST_TRSCP_TMST                                     05960000
059700             ,LAST_TRSCP_USR_ID                                   05970000
059800             ,PREPK_ID                                            05980000
059900             ,PREPK_RATO_QTY                                      05990000
060000             ,PREPK_ODD_UNT_QTY                                   06000000
060100             ,PREPK_DRV_LNE_CDE                                   06010000
060110             ,UNT_RTL_AMT                                         06011000
060120             ,GP_RTL_AMT                                          06012000
060130             ,GP_QTY                                              06013000
060140             ,ORIG_PKSL_ITM_QTY                                   06014000
060200         INTO :RECITM-ORD-NBR                                     06020000
060300             ,:RECITM-ORD-LNE-NBR                                 06030000
060400             ,:RECITM-REC-SEQ-NBR                                 06040000
060500             ,:RECITM-OPER-UNT-ID                                 06050000
060600             ,:RECITM-FCLTY-ID                                    06060000
060700             ,:RECITM-CRE-TMST                                    06070000
060800             ,:RECITM-CRE-UID                                     06080000
060900             ,:RECITM-PO-VER-NBR                                  06090000
061000             ,:RECITM-ITM-NBR                                     06100000
061100             ,:RECITM-PRE-TKT-IND                                 06110000
061200             ,:RECITM-TKT-FMT-ID                                  06120000
061300             ,:RECITM-RTV-IND                                     06130000
061400             ,:RECITM-STATUS-CDE                                  06140000
061500             ,:RECITM-VER-STATUS-CDE                              06150000
061600             ,:RECITM-PKSL-ITM-QTY                                06160000
061700             ,:RECITM-DTL-CK-ITM-QTY                              06170000
061800             ,:RECITM-INNR-PACK-QTY                               06180000
061900             ,:RECITM-CASE-PACK-QTY                               06190000
062000             ,:RECITM-RTV-QTY                                     06200000
062100             ,:RECITM-EXPTED-CART-CNT                             06210000
062200             ,:RECITM-ACTL-CART-CNT                               06220000
062300             ,:RECITM-MKING-APRON-TMST                            06230000
062400             ,:RECITM-UNT-COST-AMT                                06240000
062500             ,:RECITM-COLOR-DESC                                  06250000
062600             ,:RECITM-SIZE-DESC                                   06260000
062700             ,:RECITM-VEND-STYL-NAME                              06270000
062800             ,:RECITM-VEND-DESC                                   06280000
062900             ,:RECITM-VERFYD-TMST                                 06290000
063000             ,:RECITM-PKSL-NBR                                    06300000
063100             ,:RECITM-REC-INV-LNE-NBR                             06310000
063200             ,:RECITM-DMG-ITM-QTY                                 06320000
063300             ,:RECITM-UPD-TMST                                    06330000
063400             ,:RECITM-UPD-UID                                     06340000
063500             ,:RECITM-UPD-PGM-ID                                  06350000
063600             ,:RECITM-RCPT-DISTR-UPD-CDE                          06360000
063700             ,:RECITM-VRFD-USR-ID                                 06370000
063800             ,:RECITM-LAST-TRSCP-TMST                             06380000
063900             ,:RECITM-LAST-TRSCP-USR-ID                           06390000
064000             ,:RECITM-PREPK-ID                                    06400000
064100             ,:RECITM-PREPK-RATO-QTY                              06410000
064200             ,:RECITM-PREPK-ODD-UNT-QTY                           06420000
064300             ,:RECITM-PREPK-DRV-LNE-CDE                           06430000
064310             ,:RECITM-UNT-RTL-AMT                                 06431000
064320             ,:RECITM-GP-RTL-AMT                                  06432000
064330             ,:RECITM-GP-QTY                                      06433000
064340             ,:RECITM-ORIG-PKSL-ITM-QTY                           06434000
064400         FROM  TRECITM                                            06440000
064500         WHERE ORD_NBR        = :DK-PO-NBR                        06450000
064600         AND   ORD_LNE_NBR    = :DK-PO-LNE-NBR                    06460000
064700         AND   REC_SEQ_NBR    = :DK-REC-SEQ-NBR                   06470000
064800*        AND   OPER_UNT_ID    = :DK-OPER-UNT-ID                   06480000
064900*        AND   FCLTY_ID       = :DK-FCLTY-ID                      06490000
065000*        AND   VER_STATUS_CDE = :PC-A                             06500000
065100     END-EXEC.                                                    06510000
065200                                                                  06520000
065300     EVALUATE TRUE                                                06530000
065400         WHEN SQLCODE = +0                                        06540000
065500             CONTINUE                                             06550000
065600                                                                  06560000
065700         WHEN SQLWARN0 NOT = SPACES                               06570000
065800         WHEN SQLCODE < +0                                        06580000
065900         WHEN SQLCODE > +0                                        06590000
066000             SET PS-DONE TO TRUE                                  06600000
066100             MOVE SQLCA TO RC031-SQLCA                            06610000
066200             MOVE SQLCODE TO RC031-SQLCODE                        06620000
066300             MOVE PRV-22 TO RC031-RETURN-DATA                     06630000
066400     END-EVALUATE.                                                06640000
066500                                                                  06650000
066600******************************************************************06660000
066700** THIS PARAGRAPH WILL INSERT A BEFORE SHAPSHOT OF TRECITM      **06670000
066800** TO TAURECI AUDIT TABLE.                                      **06680000
066900******************************************************************06690000
067000 4200-WRITE-AURECI.                                               06700000
067100                                                                  06710000
067200     EXEC SQL                                                     06720000
067300       INSERT                                                     06730000
067400         INTO TAURECI                                             06740000
067500           (ORD_NBR                                               06750000
067600           ,ORD_LNE_NBR                                           06760000
067700           ,REC_SEQ_NBR                                           06770000
067800           ,OPER_UNT_ID                                           06780000
067900           ,FCLTY_ID                                              06790000
068000           ,CRE_TMST                                              06800000
068100           ,CRE_UID                                               06810000
068200           ,PO_VER_NBR                                            06820000
068300           ,ITM_NBR                                               06830000
068400           ,PRE_TKT_IND                                           06840000
068500           ,TKT_FMT_ID                                            06850000
068600           ,RTV_IND                                               06860000
068700           ,STATUS_CDE                                            06870000
068800           ,VER_STATUS_CDE                                        06880000
068900           ,PKSL_ITM_QTY                                          06890000
069000           ,DTL_CK_ITM_QTY                                        06900000
069100           ,INNR_PACK_QTY                                         06910000
069200           ,CASE_PACK_QTY                                         06920000
069300           ,RTV_QTY                                               06930000
069400           ,EXPTED_CART_CNT                                       06940000
069500           ,ACTL_CART_CNT                                         06950000
069600           ,MKING_APRON_TMST                                      06960000
069700           ,UNT_COST_AMT                                          06970000
069800           ,COLOR_DESC                                            06980000
069900           ,SIZE_DESC                                             06990000
070000           ,VEND_STYL_NAME                                        07000000
070100           ,VEND_DESC                                             07010000
070200           ,VERFYD_TMST                                           07020000
070300           ,PKSL_NBR                                              07030000
070400           ,REC_INV_LNE_NBR                                       07040000
070500           ,DMG_ITM_QTY                                           07050000
070600           ,UPD_TMST                                              07060000
070700           ,UPD_UID                                               07070000
070800           ,UPD_PGM_ID                                            07080000
070900           ,RCPT_DISTR_UPD_CDE                                    07090000
071000           ,AUD_TYP_CDE                                           07100000
071100           ,AUD_FUNC_CDE                                          07110000
071200           ,NOTIF_NBR                                             07120000
071300           ,VRFD_USR_ID                                           07130000
071400           ,LAST_TRSCP_TMST                                       07140000
071500           ,LAST_TRSCP_USR_ID                                     07150000
071600           ,ROW_CRER_PGM_ID                                       07160000
071700           ,ROW_CRER_USR_ID                                       07170000
071800           ,ROW_CREN_TMST                                         07180000
071900           ,PREPK_ID                                              07190000
072000           ,PREPK_RATO_QTY                                        07200000
072100           ,PREPK_ODD_UNT_QTY                                     07210000
072200           ,PREPK_DRV_LNE_CDE                                     07220000
072210           ,UNT_RTL_AMT                                           07221000
072220           ,GP_RTL_AMT                                            07222000
072230           ,GP_QTY                                                07223000
072240           ,ORIG_PKSL_ITM_QTY)                                    07224000
072300      VALUES                                                      07230000
072400           (:RECITM-ORD-NBR                                       07240000
072500          , :RECITM-ORD-LNE-NBR                                   07250000
072600          , :RECITM-REC-SEQ-NBR                                   07260000
072700          , :RECITM-OPER-UNT-ID                                   07270000
072800          , :RECITM-FCLTY-ID                                      07280000
072900          , :RECITM-CRE-TMST                                      07290000
073000          , :RECITM-CRE-UID                                       07300000
073100          , :RECITM-PO-VER-NBR                                    07310000
073200          , :RECITM-ITM-NBR                                       07320000
073300          , :RECITM-PRE-TKT-IND                                   07330000
073400          , :RECITM-TKT-FMT-ID                                    07340000
073500          , :RECITM-RTV-IND                                       07350000
073600          , :RECITM-STATUS-CDE                                    07360000
073700          , :RECITM-VER-STATUS-CDE                                07370000
073800          , :RECITM-PKSL-ITM-QTY                                  07380000
073900          , :RECITM-DTL-CK-ITM-QTY                                07390000
074000          , :RECITM-INNR-PACK-QTY                                 07400000
074100          , :RECITM-CASE-PACK-QTY                                 07410000
074200          , :RECITM-RTV-QTY                                       07420000
074300          , :RECITM-EXPTED-CART-CNT                               07430000
074400          , :RECITM-ACTL-CART-CNT                                 07440000
074500          , :RECITM-MKING-APRON-TMST                              07450000
074600          , :RECITM-UNT-COST-AMT                                  07460000
074700          , :RECITM-COLOR-DESC                                    07470000
074800          , :RECITM-SIZE-DESC                                     07480000
074900          , :RECITM-VEND-STYL-NAME                                07490000
075000          , :RECITM-VEND-DESC                                     07500000
075100          , :RECITM-VERFYD-TMST                                   07510000
075200          , :RECITM-PKSL-NBR                                      07520000
075300          , :RECITM-REC-INV-LNE-NBR                               07530000
075400          , :RECITM-DMG-ITM-QTY                                   07540000
075500          , :RECITM-UPD-TMST                                      07550000
075600          , :RECITM-UPD-UID                                       07560000
075700          , :RECITM-UPD-PGM-ID                                    07570000
075800          , :RECITM-RCPT-DISTR-UPD-CDE                            07580000
075900          , :AURECI-AUD-TYP-CDE                                   07590000
076000          , :AURECI-AUD-FUNC-CDE                                  07600000
076100          , :AURECI-NOTIF-NBR                                     07610000
076200          , :RECITM-VRFD-USR-ID                                   07620000
076300          , :RECITM-LAST-TRSCP-TMST                               07630000
076400          , :RECITM-LAST-TRSCP-USR-ID                             07640000
076500          , :RC031-UPD-PGM-ID                                     07650000
076600          , :PV-USER-ID                                           07660000
076700          ,  CURRENT TIMESTAMP                                    07670000
076800          , :RECITM-PREPK-ID                                      07680000
076900          , :RECITM-PREPK-RATO-QTY                                07690000
077000          , :RECITM-PREPK-ODD-UNT-QTY                             07700000
077100          , :RECITM-PREPK-DRV-LNE-CDE                             07710000
077110          , :RECITM-UNT-RTL-AMT                                   07711000
077120          , :RECITM-GP-RTL-AMT                                    07712000
077130          , :RECITM-GP-QTY                                        07713000
077140          , :RECITM-ORIG-PKSL-ITM-QTY)                            07714000
077200                                                                  07720000
077300     END-EXEC.                                                    07730000
077400                                                                  07740000
077500     EVALUATE TRUE                                                07750000
077600         WHEN SQLCODE = +0                                        07760000
077700             CONTINUE                                             07770000
077800                                                                  07780000
077900         WHEN SQLWARN0 NOT = SPACES                               07790000
078000         WHEN SQLCODE < +0                                        07800000
078100         WHEN SQLCODE > +0                                        07810000
078200             SET PS-DONE TO TRUE                                  07820000
078300             MOVE SQLCA TO RC031-SQLCA                            07830000
078400             MOVE SQLCODE TO RC031-SQLCODE                        07840000
078500             MOVE PRV-23 TO RC031-RETURN-DATA                     07850000
078600     END-EVALUATE.                                                07860000
078700                                                                  07870000
078800 5000-AUDIT-RECDIS.                                               07880000
078900******************************************************************07890000
079000                                                                  07900000
079100     MOVE RC031-OPER-UNT-ID  TO DK-OPER-UNT-ID.                   07910000
079200     MOVE RC031-FCLTY-ID     TO DK-FCLTY-ID.                      07920000
079300     MOVE RC031-PO-NBR       TO DK-PO-NBR.                        07930000
079400     MOVE RC031-PO-LNE-NBR   TO DK-PO-LNE-NBR.                    07940000
079500     MOVE RC031-REC-SEQ-NBR  TO DK-REC-SEQ-NBR.                   07950000
079600     MOVE RC031-STR-NBR      TO DK-STR-NBR.                       07960000
079700                                                                  07970000
079800     PERFORM 5100-SELECT-RECDIS.                                  07980000
079900     IF SQLCODE = +100                                            07990000
080000         MOVE PRV-12      TO RC031-RETURN-DATA                    08000000
080100     ELSE                                                         08010000
080200         MOVE RC031-AUD-TYP-CDE  TO AURECD-AUD-TYP-CDE            08020000
080300         MOVE RC031-AUD-FUNC-CDE TO AURECD-AUD-FUNC-CDE           08030000
080400         MOVE RC031-NOTIF-NBR    TO AURECD-NOTIF-NBR              08040000
080500         MOVE RC031-ADJ-CYC-NBR  TO AURECD-ADJ-CYC-NBR            08050000
080600         MOVE RC031-UPD-PGM-ID   TO AURECD-UPD-PGM-ID             08060000
080700         MOVE RC031-UPD-UID      TO AURECD-UPD-UID                08070000
080800         MOVE RC031-UPD-TMST     TO AURECD-UPD-TMST               08080000
080900         PERFORM 5200-WRITE-AURECD                                08090000
081000     END-IF.                                                      08100000
081100                                                                  08110000
081200                                                                  08120000
081300 5100-SELECT-RECDIS.                                              08130000
081400                                                                  08140000
081500     EXEC SQL                                                     08150000
081600         SELECT ORD_NBR,                                          08160000
081700                ORD_LNE_NBR,                                      08170000
081800                REC_SEQ_NBR,                                      08180000
081900                OPER_UNT_ID,                                      08190000
082000                FCLTY_ID,                                         08200000
082100                CRE_TMST,                                         08210000
082200                CRE_UID,                                          08220000
082300                VER_STATUS_CDE,                                   08230000
082400                EXPTED_ITM_QTY,                                   08240000
082500                VERIFY_ITM_QTY,                                   08250000
082600                AP_VERIFY_ITM_QTY,                                08260000
082700                STR_NBR,                                          08270000
082800                STR_FCLTY_ID,                                     08280000
082900                PLAN_ITM_QTY,                                     08290000
083000                AP_PRC_CDE,                                       08300000
083100                AP_PRC_DTE                                        08310000
083200          INTO  :RECDIS-ORD-NBR,                                  08320000
083300                :RECDIS-ORD-LNE-NBR,                              08330000
083400                :RECDIS-REC-SEQ-NBR,                              08340000
083500                :RECDIS-OPER-UNT-ID,                              08350000
083600                :RECDIS-FCLTY-ID,                                 08360000
083700                :RECDIS-CRE-TMST,                                 08370000
083800                :RECDIS-CRE-UID,                                  08380000
083900                :RECDIS-VER-STATUS-CDE,                           08390000
084000                :RECDIS-EXPTED-ITM-QTY,                           08400000
084100                :RECDIS-VERIFY-ITM-QTY,                           08410000
084200                :RECDIS-AP-VERIFY-ITM-QTY,                        08420000
084300                :RECDIS-STR-NBR,                                  08430000
084400                :RECDIS-STR-FCLTY-ID,                             08440000
084500                :RECDIS-PLAN-ITM-QTY,                             08450000
084600                :RECDIS-AP-PRC-CDE,                               08460000
084700                :RECDIS-AP-PRC-DTE                                08470000
084800           FROM TRECDIS                                           08480000
084900          WHERE ORD_NBR            = :DK-PO-NBR                   08490000
085000            AND ORD_LNE_NBR        = :DK-PO-LNE-NBR               08500000
085100            AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR              08510000
085200            AND OPER_UNT_ID        = :DK-OPER-UNT-ID              08520000
085300            AND FCLTY_ID           = :DK-FCLTY-ID                 08530000
085400            AND STR_NBR            = :DK-STR-NBR                  08540000
085500            AND STR_FCLTY_ID       = 1                            08550000
085700     END-EXEC                                                     08570000
085800                                                                  08580000
085900     EVALUATE TRUE                                                08590000
086000         WHEN SQLCODE = ZERO                                      08600000
086100             CONTINUE                                             08610000
086200         WHEN SQLCODE = +100                                      08620000
086300             CONTINUE                                             08630000
086400         WHEN SQLWARN0 NOT = SPACES                               08640000
086500         WHEN SQLCODE      NOT = ZERO                             08650000
086600             SET PS-DONE TO TRUE                                  08660000
086700             MOVE SQLCA TO RC031-SQLCA                            08670000
086800             MOVE SQLCODE TO RC031-SQLCODE                        08680000
086900             MOVE PRV-24 TO RC031-RETURN-DATA                     08690000
087000     END-EVALUATE.                                                08700000
087100                                                                  08710000
087200 5200-WRITE-AURECD.                                               08720000
087300                                                                  08730000
087400     EXEC SQL                                                     08740000
087500          INSERT                                                  08750000
087600          INTO   TAURECD                                          08760000
087700           ( ORD_NBR                                              08770000
087800            ,ORD_LNE_NBR                                          08780000
087900            ,REC_SEQ_NBR                                          08790000
088000            ,OPER_UNT_ID                                          08800000
088100            ,FCLTY_ID                                             08810000
088200            ,CRE_TMST                                             08820000
088300            ,CRE_UID                                              08830000
088400            ,VER_STATUS_CDE                                       08840000
088500            ,EXPTED_ITM_QTY                                       08850000
088600            ,VERIFY_ITM_QTY                                       08860000
088700            ,AP_VERIFY_ITM_QTY                                    08870000
088800            ,STR_NBR                                              08880000
088900            ,STR_FCLTY_ID                                         08890000
089000            ,PLAN_ITM_QTY                                         08900000
089100            ,AP_PRC_CDE                                           08910000
089200            ,AP_PRC_DTE                                           08920000
089300            ,UPD_TMST                                             08930000
089400            ,UPD_UID                                              08940000
089500            ,UPD_PGM_ID                                           08950000
089600            ,AUD_TYP_CDE                                          08960000
089700            ,AUD_FUNC_CDE                                         08970000
089800            ,NOTIF_NBR                                            08980000
089900            ,ADJ_CYC_NBR)                                         08990000
090000      VALUES                                                      09000000
090100            (:RECDIS-ORD-NBR                                      09010000
090200           , :RECDIS-ORD-LNE-NBR                                  09020000
090300           , :RECDIS-REC-SEQ-NBR                                  09030000
090400           , :RECDIS-OPER-UNT-ID                                  09040000
090500           , :RECDIS-FCLTY-ID                                     09050000
090600           , :RECDIS-CRE-TMST                                     09060000
090700           , :RECDIS-CRE-UID                                      09070000
090800           , :RECDIS-VER-STATUS-CDE                               09080000
090900           , :RECDIS-EXPTED-ITM-QTY                               09090000
091000           , :RECDIS-VERIFY-ITM-QTY                               09100000
091100           , :RECDIS-AP-VERIFY-ITM-QTY                            09110000
091200           , :RECDIS-STR-NBR                                      09120000
091300           , :RECDIS-STR-FCLTY-ID                                 09130000
091400           , :RECDIS-PLAN-ITM-QTY                                 09140000
091500           , :RECDIS-AP-PRC-CDE                                   09150000
091600           , :RECDIS-AP-PRC-DTE                                   09160000
091700           , :AURECD-UPD-TMST                                     09170000
091800           , :AURECD-UPD-UID                                      09180000
091900           , :AURECD-UPD-PGM-ID                                   09190000
092000           , :AURECD-AUD-TYP-CDE                                  09200000
092100           , :AURECD-AUD-FUNC-CDE                                 09210000
092200           , :AURECD-NOTIF-NBR                                    09220000
092300           , :AURECD-ADJ-CYC-NBR)                                 09230000
092400     END-EXEC.                                                    09240000
092500                                                                  09250000
092600     EVALUATE TRUE                                                09260000
092700         WHEN SQLCODE = ZERO                                      09270000
092800             CONTINUE                                             09280000
092900         WHEN SQLWARN0 NOT = SPACE                                09290000
093000         WHEN SQLCODE NOT = ZERO                                  09300000
093100             SET PS-DONE TO TRUE                                  09310000
093200             MOVE SQLCA TO RC031-SQLCA                            09320000
093300             MOVE SQLCODE TO RC031-SQLCODE                        09330000
093400             MOVE PRV-25 TO RC031-RETURN-DATA                     09340000
093500     END-EVALUATE.                                                09350000
093600/                                                                 09360000
