000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             PCKRF881.                                00040000
000500 AUTHOR.                 DEANNA BRANTNER.                         00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            MAY, 2001.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000******************************************************************00100000
001100* THIS PROGRAM DISPLAYS A CARTON'S LAST ACTIVITY ON THE           00110000
001200* LRT (LASER RADIO TERMINAL) AND ACCEPTS AN F-KEY.                00120000
001300******************************************************************00130000
001400******************************************************************00140087
001500*  CHANGED 04/23/13 BY C. PARMLEY          PR#5148B              *00150084
001600*  SET RFID INDICATOR IN 6000- PARA                              *00160084
001700*  TAGGED BY PR5148B - CLP - 04/23/2013                          *00170084
001800*                                          CRQ#0055296           *00180084
001900*                                                                *00190084
002000*  CHANGED 07/23/13 BY SHOBHIT BAIJAL      PR#5148B              *00200084
002100*  ADDED CHECK IN 6000- TO INCLUDE PC140-RF-CRTN-LBL             *00210084
002200*                                          CRQ#0058309           *00220084
002300*                                                                *00230084
002400*  CHANGED 12/17/13 BY C. PARMLEY          PR#5148D              *00240084
002500*  CHECK FOR RFID AUD STATUS IN 6305-CHECK-RFID-AUDIT-STAT       *00250084
002600*  SO IF RFID AUDIT FAILED STILL GET THE CORRECT CASI CODE ON    *00260084
002700*  THE LABEL.                                                    *00270084
002800*                                          CRQ#:0068598          *00280084
002900*  CHANGED 07/12/17 BY J. ARENDT      CHG0176459                 *00290086
003000*  ADDED CODE TO PROGRAM FOR THE "RFID TAG YOUR STORE / SHORT    *00300086
003100*  -TERM SOLUTION" PROJECT.                                      *00310086
003200******************************************************************00320084
003300* ****************************************************************00330000
003400 ENVIRONMENT DIVISION.                                            00340000
003500 DATA DIVISION.                                                   00350000
003600                                                                  00360000
003700 WORKING-STORAGE SECTION.                                         00370000
003800******************************************************************00380000
003900 01  CA-COMMAREA.                                                 00390000
004000     COPY PCWS038.                                                00400000
004100     COPY PCWS233.                                                00410000
004200   02  CA-COMMAREA-SW           PIC X(1).                         00420000
004300       88  CA-USE-PCWS233-COMMAREA    VALUE 'A'.                  00430000
004400       88  CA-USE-PCWS038-COMMAREA    VALUE 'B'.                  00440000
004500   02  CA-LAST-PROGRAM          PIC X(8).                         00450000
004600       88  CA-LAST-PROG-PCKRF868      VALUE 'PCKRF868'.           00460000
004700       88  CA-LAST-PROG-PCKRF884      VALUE 'PCKRF884'.           00470000
004800                                                                  00480000
004900******************************************************************00490000
005000* COMMAREA FOR PCKRF888                                           00500000
005100******************************************************************00510000
005200     COPY PCWS039.                                                00520000
005300                                                                  00530000
005400******************************************************************00540000
005500* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    00550087
005600******************************************************************00560000
005700     COPY PCWS046.                                                00570000
005800                                                                  00580000
005900******************************************************************00590000
006000 01  DK-DB2-KEYS.                                                 00600000
006100     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00610000
006200     05  DK-OPER-UNT-ID           PIC S9(4)   COMP.               00620000
006300     05  DK-DIVERT-NBR            PIC S9(9)   COMP.               00630000
006400     05  DK-DIVERT-LOC            PIC  X(4).                      00640000
006500     05  DK-CARTON-ID             PIC S9(18)V COMP-3.             00650000
006600     05  DK-CARTON-ID2            PIC  9(18).                     00660000
006700     05  DK-CARTON-ID3.                                           00670000
006800         10  DK-FIRST-CARTON      PIC 9(2).                       00680000
006900         10  DK-CARTON-ID4        PIC 9(18).                      00690000
007000         10  DK-LAST-CARTON       PIC 9(2).                       00700000
007100     05  DK-CARTON-ID-DB2.                                        00710000
007200         10  DK-FIRST-PART        PIC 9(7).                       00720000
007300         10  DK-REST-OF           PIC 9(11).                      00730000
007400     05  DK-START.                                                00740000
007500         10  DK-FIRST-START       PIC 9(7).                       00750000
007600         10  DK-REST-OF-START     PIC 9(11) VALUE ZEROES.         00760000
007700     05  DK-END.                                                  00770000
007800         10  DK-FIRST-END         PIC 9(7).                       00780000
007900         10  DK-REST-OF-END       PIC 9(11) VALUE 99999999999.    00790000
008000     05  DK-START2                PIC  9(18)V.                    00800000
008100     05  DK-END2                  PIC  9(18)V.                    00810000
008200     05  DK-START-DB2             PIC S9(18)V COMP-3.             00820000
008300     05  DK-END-DB2               PIC S9(18)V COMP-3.             00830000
008400     05  DK-STR-NBR               PIC 9(4) VALUE ZEROES.          00840000
008500                                                                  00850000
008600 01  PC-PROGRAM-CONSTANTS.                                        00860000
008700     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00870000
008800                                                     COMP SYNC.   00880000
008900     05  PC-CALLED-FROM-PG               PIC  X(08)  VALUE SPACES.00890000
009000     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00900000
009100         'PCKRF881'.                                              00910000
009200     05  PC-PREVIOUS-PGM                 PIC  X(08)  VALUE        00920000
009300         'PCKRF880'.                                              00930000
009400     05  PC-NEXT-PGM                     PIC  X(08)  VALUE        00940000
009500         'PCKRF882'.                                              00950000
009600     05  PC-PRTR-VALIDATION-PGM      PIC  X(08)  VALUE 'DPKCS060'.00960000
009700     05  PC-REPORT-PGM               PIC  X(08)  VALUE 'PCKRF881'.00970000
009800     05  PC-DC-RF-APPL-PGM               PIC  X(08)  VALUE        00980000
009900         'MPKCS027'.                                              00990000
010000     05  PC-DUPLICATE                    PIC  X(04)  VALUE 'E881'.01000000
010100     05  PC-LABEL-INFO-PGM               PIC  X(08)  VALUE        01010000
010200         'PCKRF888'.                                              01020000
010300     05  PC-LOCATION-MODULE          PIC  X(08)  VALUE 'XLKUT071'.01030000
010400     05  PC-A                       PIC X(01)   VALUE 'A'.        01040000
010500     05  PC-E                       PIC X(01)   VALUE 'E'.        01050000
010600     05  PC-I                       PIC X(01)   VALUE 'I'.        01060000
010700     05  PC-N                       PIC X(01)   VALUE 'N'.        01070000
010800     05  PC-S                       PIC X(01)   VALUE 'S'.        01080000
010900     05  PC-Y                       PIC X(01)   VALUE 'Y'.        01090000
011000     05  PC-01                      PIC X(02)   VALUE '01'.       01100000
011100     05  PC-02                      PIC X(02)   VALUE '02'.       01110000
011200     05  PC-03                      PIC X(02)   VALUE '03'.       01120000
011300     05  PC-05                      PIC X(02)   VALUE '05'.       01130000
011400     05  PC-90                      PIC  X(02)  VALUE  '90'.      01140000
011500     05  PC-MGMX                    PIC X(04)   VALUE 'MGMX'.     01150000
011600     05  PC-SHOF                    PIC X(04)   VALUE 'SHOF'.     01160000
011700     05  PC-SHON                    PIC X(04)   VALUE 'SHON'.     01170000
011800     05  PC-VENDOR-ASN              PIC X(10) VALUE 'VENDOR ASN'. 01180000
011900     05  PC-CHECK-IN                PIC X(10) VALUE 'CHECK IN  '. 01190000
012000     05  PC-CSEPK-SPLT              PIC X(10) VALUE 'CSEPK SPLT'. 01200000
012100     05  PC-MANUAL                  PIC X(10) VALUE 'MANUAL    '. 01210000
012200     05  PC-PCK-2-LIT               PIC X(10) VALUE 'PCK-2-LITE'. 01220000
012300     05  PC-RECEIVING               PIC X(10) VALUE 'RECEIVING '. 01230000
012400     05  PC-RDM                     PIC X(10) VALUE 'RDM       '. 01240000
012500     05  PC-SMOOTHING               PIC X(10) VALUE 'SMOOTHING '. 01250000
012600     05  PC-FAST-XFER               PIC X(10) VALUE 'FAST XFER '. 01260000
012700     05  PC-MSTR-CNTR               PIC X(10) VALUE 'MSTR CONTR'. 01270000
012800     05  PC-CRTN-BULD               PIC X(10) VALUE 'CRTN BUILD'. 01280000
012900     05  PC-JEWELRY                 PIC X(10) VALUE 'P2L-JEWLRY'. 01290000
013000     05  PC-DAMAGED                 PIC X(10) VALUE 'DAMAGED   '. 01300000
013010     05  PC-3WD-PRTY-WHSE           PIC X(10) VALUE '3PRTY WHSE'. 01301088
013100     05  PC-UNKNOWN                 PIC X(10) VALUE 'UNKNOWN   '. 01310000
013200     05  PC-ASN                     PIC X(03) VALUE 'ASN'.        01320000
013300     05  PC-CKN                     PIC X(03) VALUE 'CKN'.        01330000
013400     05  PC-CPS                     PIC X(03) VALUE 'CPS'.        01340000
013500     05  PC-MAN                     PIC X(03) VALUE 'MAN'.        01350000
013600     05  PC-P2L                     PIC X(03) VALUE 'P2L'.        01360000
013700     05  PC-RCV                     PIC X(03) VALUE 'RCV'.        01370000
013800     05  PC-RDM2                    PIC X(03) VALUE 'RDM'.        01380000
013900     05  PC-SMO                     PIC X(03) VALUE 'SMO'.        01390000
014000     05  PC-FXR                     PIC X(03) VALUE 'FXR'.        01400000
014100     05  PC-MST                     PIC X(03) VALUE 'MST'.        01410000
014200     05  PC-MSC                     PIC X(03) VALUE 'MSC'.        01420000
014300     05  PC-JWL                     PIC X(03) VALUE 'JWL'.        01430000
014400     05  PC-DMG                     PIC X(03) VALUE 'DMG'.        01440000
014410     05  PC-3WD                     PIC X(03) VALUE '3WD'.        01441088
014500     05  PC-SPACES                  PIC X(03) VALUE '   '.        01450000
014600                                                                  01460000
014700 01  PM-PROGRAM-MESSAGES.                                         01470000
014800     05  PM-INVALID-PRTR-ID              PIC  X(19)  VALUE        01480000
014900         'INVALID PRINTER ID '.                                   01490000
015000     05  PM-NEED-PRTR-ID                 PIC  X(19)  VALUE        01500000
015100         'NEED PRINTER ID    '.                                   01510000
015200     05  PM-SOCKET-COMM-ERROR            PIC  X(19)  VALUE        01520000
015300         'SOCKET COMM ERROR  '.                                   01530000
015400     05  PM-INVALID-PRT-FMT              PIC  X(19)  VALUE        01540000
015500         'INVALID PRINT FORMT'.                                   01550000
015600     05  PM-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        01560000
015700         'UNRECOGNIZED PF KEY'.                                   01570000
015800     05  PM-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01580000
015900         'TRANS NOT AVAILABLE'.                                   01590000
016000     05  PM-CICS-ABEND-MSG               PIC  X(19)  VALUE        01600000
016100         'CICS ABEND -CALL DP'.                                   01610000
016200     05  PM-CARTON-STATUS-ERROR          PIC  X(19)  VALUE        01620000
016300         'CARTON STATUS ERROR'.                                   01630000
016400     05  PM-NO-LABEL-AVAILABLE           PIC  X(19)  VALUE        01640000
016500         'NO LABEL AVAILABLE '.                                   01650000
016600     05  PM-INNPK-USE-KOHLS-SML           PIC  X(19)  VALUE       01660000
016700         'INRPK-USE KOHLS SML'.                                   01670000
016800     05  PM-LBL-PRINT-MSG                PIC  X(19)  VALUE        01680000
016900         'LABEL PRT REQUESTED'.                                   01690000
017000     05  PM-DATABASE-ERROR               PIC  X(19)  VALUE        01700000
017100         'DATABASE ER-CALL DP'.                                   01710000
017200     05  PM-DATABASE-BUSY                PIC  X(19)  VALUE        01720000
017300         'DB BUSY - TRY AGAIN'.                                   01730000
017400     05  PM-FKEY-MSG1                    PIC  X(19)  VALUE        01740000
017500         'PRESS ENTER TO CONT'.                                   01750000
017600     05  PM-FKEY-MSG2                    PIC  X(19)  VALUE        01760000
017700         'LBL REQ  F3 TO CONT'.                                   01770000
017800                                                                  01780000
017900 01  PS-PROGRAM-SWITCHES.                                         01790000
018000     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   01800000
018100         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   01810000
018200         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   01820000
018300     05  PS-PRINTER-FOUND-SW             PIC  X(01)  VALUE 'N'.   01830000
018400         88  PS-NO-PRINTER-FOUND                     VALUE 'N'.   01840000
018500         88  PS-PRINTER-FOUND                        VALUE 'Y'.   01850000
018600     05  PS-PRINTER-INVALID-SW           PIC  X(01)  VALUE 'N'.   01860000
018700         88  PS-PRINTER-VALID                        VALUE 'N'.   01870000
018800         88  PS-PRINTER-INVALID                      VALUE 'Y'.   01880000
018900     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01890000
019000         88  PS-ERROR-NO                             VALUE 'N'.   01900000
019100         88  PS-ERROR-YES                            VALUE 'Y'.   01910000
019200                                                                  01920000
019300 01  PV-PROGRAM-VARIABLES.                                        01930000
019400     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01940000
019500     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01950000
019600                                                     COMP SYNC.   01960000
019700     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01970000
019800     05  PV-DUPLICATE-IND                PIC  X(01)  VALUE SPACE. 01980000
019900         88 PV-VALID-DUP-IND             VALUE 'Y', 'N'.          01990000
020000     05  PV-LABEL-IND                    PIC  X(01)  VALUE SPACE. 02000000
020100         88 PV-VALID-LBL-IND             VALUE 'Y', 'N'.          02010000
020200     05  PV-START-TIMESTAMP              PIC  X(26).              02020000
020300     05  PV-END-TIMESTAMP                PIC  X(26).              02030000
020400     05  PV-DB2-TIMESTAMP                PIC  X(26).              02040000
020500     05  PV-DB2-TIMESTAMP-R REDEFINES PV-DB2-TIMESTAMP.           02050000
020600         10  PV-DB2-TMST-DATE            PIC  X(10).              02060000
020700         10  FILLER                      PIC X(16).               02070000
020800     05  PV-DB2-REFORMAT-DATE.                                    02080000
020900         10  PV-DB2-DATE-YY              PIC  X(02).              02090000
021000         10  FILLER                      PIC  X(01).              02100000
021100         10  PV-DB2-DATE-MM              PIC  X(02).              02110000
021200         10  FILLER                      PIC  X(01).              02120000
021300         10  PV-DB2-DATE-DD              PIC  X(02).              02130000
021400     05  PV-DISPLAY-DATE.                                         02140000
021500         10  PV-DISPLAY-DATE-MM          PIC  X(02).              02150000
021600         10  FILLER                      PIC  X(01)  VALUE '/'.   02160000
021700         10  PV-DISPLAY-DATE-DD          PIC  X(02).              02170000
021800         10  FILLER                      PIC  X(01)  VALUE '/'.   02180000
021900         10  PV-DISPLAY-DATE-YY          PIC  X(02).              02190000
022000     05  PV-SU-BC-DIVERT-CODE.                                    02200000
022100         10  FILLER                      PIC X(01).               02210083
022200         10  PV-SU-BC-DIVERT-CD          PIC Z(04).               02220083
022300     05  PV-IP-ADDRESS                   PIC X(15).               02230000
022400     05 PV-DC-5-CHAR-ABBR                PIC X(05) VALUE SPACES.  02240000
022500     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          02250000
022600         10 FILLER                       PIC  X(03).              02260000
022700         10 PV-2-DIGIT-DC-ABBR           PIC  X(02).              02270000
022800*                                                                 02280000
022900     05  PV-CICS-MSG-AREA2               PIC  X(128) VALUE SPACE. 02290000
023000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0.    02300000
023100     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  02310000
023200                                                     COMP SYNC.   02320000
023300                                                                  02330000
023400     05  PV-DISPLAY-CARTON-ID            PIC  9(18).              02340000
023500     05  PV-DISPLAY-OPER-UNT             PIC  9(04).              02350000
023600     05  PV-DISPLAY-DIVERT-NBR           PIC  9(09).              02360000
023700     05  PV-DISPLAY-DIVERT-LOC           PIC  X(04).              02370000
023800     05  PV-DISPLAY-SQLCODE              PIC -9(05) VALUE ZEROES. 02380000
023900                                                                  02390000
024000     05  PV-LAST5-SHIPT-UNT-ID         PIC  9(18)  VALUE ZEROES.  02400000
024100     05  PV-LAST5-SHIPT-UNT-ID-R REDEFINES PV-LAST5-SHIPT-UNT-ID. 02410000
024200         10  FILLER                    PIC  9(13).                02420000
024300         10  PV-LAST5-VNDR-BC          PIC  9(05).                02430000
024400                                                                  02440000
024500     05  PV-CARTON-MSG.                                           02450000
024600         10  FILLER                   PIC X(01) VALUE SPACE.      02460000
024700         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 02470000
024800         10  FILLER                   PIC X(01) VALUE '-'.        02480000
024900         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     02490000
025000         10  FILLER                   PIC X(05) VALUE ' REC='.    02500000
025100         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     02510000
025200         10  FILLER                   PIC X(10)                   02520000
025300                             VALUE ' CTN STAT='.                  02530000
025400         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     02540000
025500         10  FILLER                   PIC X(01) VALUE '/'.        02550000
025600         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     02560000
025700         10  FILLER                   PIC X(05) VALUE ' SER='.    02570000
025800         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     02580000
025900         10  FILLER                   PIC X(06) VALUE ' TRIP='.   02590000
026000         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     02600000
026100         10  FILLER                   PIC X(06) VALUE ' STAT='.   02610000
026200         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     02620000
026300         10  FILLER                   PIC X(06) VALUE ' USER='.   02630000
026400         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     02640000
026500                                                                  02650000
026600******************************************************************02660000
026700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02670000
026800******************************************************************02680000
026900     COPY DPWS013.                                                02690000
027000                                                                  02700000
027100******************************************************************02710000
027200*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        02720000
027300******************************************************************02730000
027400     COPY DPWS008.                                                02740000
027500                                                                  02750000
027600******************************************************************02760000
027700*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02770000
027800******************************************************************02780000
027900     COPY DPWS010I.                                               02790000
028000                                                                  02800000
028100******************************************************************02810000
028200*  GENERATED DSECT FOR THE PCKM881 MAPSET                         02820000
028300******************************************************************02830000
028400     COPY PCKM881.                                                02840000
028500                                                                  02850000
028600******************************************************************02860000
028700*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02870000
028800******************************************************************02880000
028900     COPY DPWS015.                                                02890000
029000                                                                  02900000
029100******************************************************************02910000
029200*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02920000
029300******************************************************************02930000
029400     COPY DFHAID.                                                 02940000
029500                                                                  02950000
029600******************************************************************02960000
029700*  COMPILE INFORMATION FOR HELP SCREEN                            02970000
029800******************************************************************02980000
029900     COPY PCWS188.                                                02990000
030000                                                                  03000000
030100******************************************************************03010000
030200*  COMMUNICATION AREA FOR HELP SCREEN PROGRAM                     03020000
030300******************************************************************03030000
030400     COPY PCWS192.                                                03040000
030500                                                                  03050000
030600******************************************************************03060000
030700*  PRINTER VALIDATION ROUTINE COPYBOOK                            03070000
030800******************************************************************03080000
030900     COPY DPWS072.                                                03090000
031000                                                                  03100000
031100******************************************************************03110000
031200*  LABEL PRINT MODULE COMMUNICATION AREA                          03120000
031300******************************************************************03130000
031400     COPY PCWS140.                                                03140000
031500                                                                  03150000
031600******************************************************************03160000
031700** THE COPY BOOK FOR XLKCS202 - LOCATION HIERARCHY "BLACK BOX"  **03170000
031800******************************************************************03180000
031900     COPY XLWS071.                                                03190000
032000                                                                  03200000
032100*-----------------------------------------------------------------03210000
032200*  CARTON AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)                    03220000
032300*-----------------------------------------------------------------03230000
032400     EXEC SQL                                                     03240000
032500         INCLUDE SUT00015                                         03250000
032600     END-EXEC.                                                    03260000
032700                                                                  03270000
032800*-----------------------------------------------------------------03280000
032900*  OUTBOUND CARTON TABLE (SUT_OTBND_CART)                         03290000
033000*-----------------------------------------------------------------03300000
033100     EXEC SQL                                                     03310000
033200         INCLUDE SUT00024                                         03320000
033300     END-EXEC.                                                    03330000
033400                                                                  03340000
033500*-----------------------------------------------------------------03350000
033600*  COMMUNICATIONS AREA FOR DB2                                    03360000
033700*-----------------------------------------------------------------03370000
033800     EXEC SQL                                                     03380000
033900         INCLUDE SQLCA                                            03390000
034000     END-EXEC.                                                    03400000
034100                                                                  03410000
034200******************************************************************03420000
034300 LINKAGE SECTION.                                                 03430000
034400******************************************************************03440000
034500 01  DFHCOMMAREA.                                                 03450000
034600     05  FILLER                       OCCURS 1 TO 4072 TIMES      03460000
034700                                      DEPENDING ON EIBCALEN.      03470000
034800         10  FILLER                   PIC X.                      03480000
034900                                                                  03490000
035000******************************************************************03500000
035100 PROCEDURE DIVISION.                                              03510000
035200******************************************************************03520000
035300 0000-PROGRAM-MAINLINE.                                           03530000
035400                                                                  03540000
035500     MOVE DFHCOMMAREA            TO PC039-COMMAREA-REC.           03550000
035600                                                                  03560000
035700                                                                  03570000
035800     IF PC039-CALLED-FROM-STAT-ACT                                03580000
035900         PERFORM 0500-BEGIN-PROCESS                               03590000
036000     ELSE                                                         03600000
036100*        INITIALIZE  CA-COMMAREA                                  03610000
036200         MOVE DFHCOMMAREA                TO CA-COMMAREA           03620000
036300         MOVE LOW-VALUES                 TO PC881AI               03630000
036400         MOVE PC038-CALLED-PGM-NME       TO PC-CALLED-FROM-PG     03640000
036500         PERFORM 0500-BEGIN-PROCESS                               03650000
036600     END-IF.                                                      03660000
036700                                                                  03670000
036800******************************************************************03680000
036900 0500-BEGIN-PROCESS.                                              03690000
037000******************************************************************03700000
037100                                                                  03710000
037200     EVALUATE TRUE                                                03720000
037300         WHEN EIBTRNID = 'Z278'                                   03730000
037400             MOVE DFHCOMMAREA             TO PC192-COMMAREA       03740000
037500             MOVE PC192-HOST-SAVE-AREA    TO CA-COMMAREA          03750000
037600             SET PC038-PROCESS-SCREEN     TO TRUE                 03760000
037700             MOVE PC192-HOST-SAVE-MAP     TO PC881AO              03770000
037800             MOVE -1                      TO APRINTIDL            03780000
037900             PERFORM 1050-INITIALIZE-RETURN                       03790000
038000             PERFORM 8000-SEND-MAP                                03800000
038100             PERFORM 8200-RETURN-TRANID                           03810000
038200                                                                  03820000
038300         WHEN EIBCALEN = ZERO                                     03830000
038400         WHEN EIBAID = DFHCLEAR                                   03840000
038500         WHEN PC038-INITIALIZE-SCREEN                             03850000
038600             SET PC038-PROCESS-SCREEN     TO TRUE                 03860000
038700             MOVE -1                      TO APRINTIDL            03870000
038800             PERFORM 1000-INITIALIZE                              03880000
038900             MOVE PC-CURRENT-PROGRAM-NAME TO PC038-LAST-PROGRAM   03890000
039000             PERFORM 8000-SEND-MAP                                03900000
039100             PERFORM 8200-RETURN-TRANID                           03910000
039200                                                                  03920000
039300         WHEN EIBAID = DFHPF3                                     03930000
039400             MOVE PC-N               TO PV-DUPLICATE-IND          03940000
039500             MOVE PC038-CALLED-PGM-NME TO PC-CALLED-FROM-PG       03950000
039600             INITIALIZE PC038-COMMON-DATA                         03960000
039700             MOVE PC-CALLED-FROM-PG  TO PC038-CALLED-PGM-NME      03970000
039800             MOVE PC-PREVIOUS-PGM    TO PV-TRANSFER-PROGRAM       03980000
039900             PERFORM 8300-XCTL-TO-SELECTED-PROGRAM                03990000
040000                                                                  04000000
040100*---------------------------------------------------------------- 04010000
040200***** THE SAME F4 FUNCTIONALITY EXISTS IN PROGRAM PCKRF882.  ANY  04020000
040300***** CHANGES MADE HERE SHOULD PROBABLY BE MADE THERE ALSO.       04030000
040400*---------------------------------------------------------------- 04040000
040500         WHEN EIBAID = DFHPF4                                     04050000
040600             IF ((PC038-SRC-ASN AND                               04060000
040700                  PC038-SULBXF-BARCODE NOT > SPACE) OR            04070000
040800                  PC038-INACTIVATED OR PC038-SRC-DMG)             04080000
040900                 MOVE PM-NO-LABEL-AVAILABLE     TO AFKMSGO        04090000
041000                 MOVE SPACES                    TO APRINTIDO      04100000
041100                 MOVE -1                        TO APRINTIDL      04110000
041200                 PERFORM 8100-SEND-DATA-ONLY                      04120000
041300                 PERFORM 8200-RETURN-TRANID                       04130000
041400             ELSE                                                 04140000
041500             IF PC038-SRC-ASN AND PC038-SHPUNT-CART-TYP-CDE = 'I' 04150000
041600                 MOVE PM-INNPK-USE-KOHLS-SML    TO AFKMSGO        04160000
041700                 MOVE SPACES                    TO APRINTIDO      04170000
041800                 MOVE -1                        TO APRINTIDL      04180000
041900                 PERFORM 8100-SEND-DATA-ONLY                      04190000
042000                 PERFORM 8200-RETURN-TRANID                       04200000
042100             ELSE                                                 04210000
042200                 PERFORM 8400-RECEIVE-MAP                         04220000
042300                 MOVE PC-N               TO PV-DUPLICATE-IND      04230000
042400*                                                                 04240000
042500                 INITIALIZE PC039-COMMAREA-REC                    04250000
042600                 PERFORM 5000-CHECK-4-PRINTER-ID                  04260000
042700                 SET PC039-CALLED-FROM-STAT-ACT TO TRUE           04270000
042800                 MOVE PC038-CALLED-PGM-NME TO PC039-CALLED-PGM-NME04280000
042900                 MOVE PC038-USER-ID        TO PC039-CRA-REQ-ID    04290000
043000                 MOVE PC038-PRINTER-ID-1-3 TO PC039-PRINTER-ID    04300000
043100                 MOVE PC038-SULBXF-BARCODE TO                     04310000
043200                                           PC039-KOHLS-BARCODE    04320000
043300                 MOVE PC038-CARTON-ID-ENTERED TO                  04330000
043400                                       PC039-CARTON-ID-ENTERED    04340000
043500                 MOVE PC038-CARTON-ON-TABLE   TO                  04350000
043600                                         PC039-CARTON-ON-TABLE    04360000
043700                 MOVE PC038-SOURCE-ID      TO PC039-SOURCE-ID     04370000
043800                 MOVE PC038-LABEL-CREATED  TO PC039-LBL-TYPE      04380000
043900                 MOVE PC038-SHPUNT-SHIPT-UNT-ID TO                04390000
044000                                           DK-SHIPT-UNT-ID        04400000
044100                 MOVE PC038-SHPUNT-DEST-OPER TO PC039-STR-NBR     04410000
044200                 IF  PC038-SRC-ASN                                04420000
044300                     MOVE PC038-SHPUNT-DEST-OPER TO PC039-STR-NBR 04430000
044400                 END-IF                                           04440000
044500* DMH 12/23/02 - BEGIN                                            04450000
044600                 IF  PC038-SHPUNT-CART-TYP-CDE  >  SPACES         04460000
044700                     MOVE PC038-SHPUNT-CART-TYP-CDE TO            04470000
044800                                                  PC039-LBL-FORMAT04480000
044900                 ELSE                                             04490000
045000                     MOVE PC038-SULBXF-CART-TYP-CDE TO            04500000
045100                                                  PC039-LBL-FORMAT04510000
045200                 END-IF                                           04520000
045300* DMH 12/23/02 - END                                              04530000
045400                 MOVE PC038-CURR-OPER-UNT TO PC039-CURR-OPER-UNT  04540000
045500                 MOVE PC-LABEL-INFO-PGM  TO PV-TRANSFER-PROGRAM   04550000
045600                 PERFORM 6400-SELECT-VENDOR-BARCODE               04560000
045700                 MOVE DK-SHIPT-UNT-ID  TO  PC039-SHIPT-UNT-ID     04570000
045800*                                                                 04580000
045900                 PERFORM 8350-LINK-TO-888-PROGRAM                 04590000
046000*                                                                 04600000
046100                 IF  PS-PRINTER-FOUND                             04610000
046200                     MOVE SPACES            TO  EIBAID            04620000
046300                     MOVE -1                        TO APRINTIDL  04630000
046400                     IF  PS-ERROR-NO                              04640000
046500                         MOVE PM-LBL-PRINT-MSG      TO AFKMSGO    04650000
046600                     END-IF                                       04660000
046700                     MOVE PC039-CALLED-PGM-NME  TO                04670000
046800                                            PC038-CALLED-PGM-NME  04680000
046900                     PERFORM 8100-SEND-DATA-ONLY                  04690000
047000                     PERFORM 8200-RETURN-TRANID                   04700000
047100                 ELSE                                             04710000
047200                     MOVE PM-NEED-PRTR-ID           TO AFKMSGO    04720000
047300                     MOVE -1                        TO APRINTIDL  04730000
047400                     MOVE PC039-CALLED-PGM-NME  TO                04740000
047500                                            PC038-CALLED-PGM-NME  04750000
047600                     PERFORM 8100-SEND-DATA-ONLY                  04760000
047700                     PERFORM 8200-RETURN-TRANID                   04770000
047800                 END-IF                                           04780000
047900             END-IF                                               04790000
048000             END-IF                                               04800000
048100                                                                  04810000
048200         WHEN EIBAID = DFHENTER                                   04820000
048300             MOVE PC-NEXT-PGM TO PV-TRANSFER-PROGRAM              04830000
048400             PERFORM 8300-XCTL-TO-SELECTED-PROGRAM                04840000
048500                                                                  04850000
048600         WHEN EIBAID = DFHPF1                                     04860000
048700             PERFORM 8400-RECEIVE-MAP                             04870000
048800             MOVE CA-COMMAREA  TO PC192-HOST-SAVE-AREA            04880000
048900             MOVE PC881AO  TO PC192-HOST-SAVE-MAP                 04890000
049000             PERFORM 1200-HELP-SCREEN                             04900000
049100             PERFORM 8200-RETURN-TRANID                           04910000
049200                                                                  04920000
049300         WHEN OTHER                                               04930000
049400              MOVE PM-UNRECOGNIZED-PF-KEY-MSG TO AFKMSGO          04940000
049500              MOVE -1        TO APRINTIDL                         04950000
049600              PERFORM 8100-SEND-DATA-ONLY                         04960000
049700              PERFORM 8200-RETURN-TRANID                          04970000
049800     END-EVALUATE.                                                04980000
049900                                                                  04990000
050000                                                                  05000000
050100*-----------------------------------------------------------------05010000
050200 1000-INITIALIZE.                                                 05020000
050300*-----------------------------------------------------------------05030000
050400                                                                  05040000
050500     MOVE PC038-CARTON-ID-ENTERED TO ACARTNIDO.                   05050000
050600     EVALUATE TRUE                                                05060000
050700         WHEN PC038-SRC-ASN                                       05070000
050800              MOVE PC-VENDOR-ASN TO ACREATEO                      05080000
050900         WHEN PC038-SRC-CHECK-IN                                  05090000
051000              MOVE PC-CHECK-IN   TO ACREATEO                      05100000
051100         WHEN PC038-SRC-CSEPK-SPLT                                05110000
051200              MOVE PC-CSEPK-SPLT TO ACREATEO                      05120000
051300         WHEN PC038-SRC-MANUAL                                    05130000
051400              MOVE PC-MANUAL     TO ACREATEO                      05140000
051500         WHEN PC038-SRC-P2L                                       05150000
051600              MOVE PC-PCK-2-LIT  TO ACREATEO                      05160000
051700         WHEN PC038-SRC-RECEIVING                                 05170000
051800              MOVE PC-RECEIVING  TO ACREATEO                      05180000
051900         WHEN PC038-SRC-RDM                                       05190000
052000              MOVE PC-RDM        TO ACREATEO                      05200000
052100         WHEN PC038-SRC-SMOOTHING                                 05210000
052200              MOVE PC-SMOOTHING  TO ACREATEO                      05220000
052300         WHEN PC038-SRC-FAST-XFER                                 05230000
052400              MOVE PC-FAST-XFER  TO ACREATEO                      05240000
052500         WHEN PC038-SRC-MSTR-CNTR                                 05250000
052600              MOVE PC-MSTR-CNTR  TO ACREATEO                      05260000
052700         WHEN PC038-SRC-CRTN-BULD                                 05270000
052800              MOVE PC-CRTN-BULD  TO ACREATEO                      05280000
052900         WHEN PC038-SRC-JWL                                       05290000
053000              MOVE PC-JEWELRY    TO ACREATEO                      05300000
053100         WHEN PC038-SRC-DMG                                       05310000
053200              MOVE PC-DAMAGED    TO ACREATEO                      05320000
053210         WHEN PC038-SRC-3WD                                       05321089
053220              MOVE PC-3WD-PRTY-WHSE TO  ACREATEO                  05322090
053300         WHEN OTHER                                               05330000
053400              MOVE PC-UNKNOWN    TO ACREATEO                      05340000
053500     END-EVALUATE.                                                05350000
053600                                                                  05360000
053700     MOVE PC038-SHPUNT-CRE-YYMMDD TO PV-DB2-REFORMAT-DATE.        05370000
053800     MOVE PV-DB2-DATE-YY          TO PV-DISPLAY-DATE-YY.          05380000
053900     MOVE PV-DB2-DATE-MM          TO PV-DISPLAY-DATE-MM.          05390000
054000     MOVE PV-DB2-DATE-DD          TO PV-DISPLAY-DATE-DD.          05400000
054100     MOVE PV-DISPLAY-DATE         TO AONO.                        05410000
054200     MOVE PC038-SHPUNT-CRE-HHMM   TO ATIMEO.                      05420000
054300     PERFORM 2000-DETERMINE-DC.                                   05430000
054400     MOVE PC038-SHPUNT-SHIPT-UNT-ID TO DK-CARTON-ID.              05440000
054500     PERFORM 3000-DETERMINE-LAST-ACTIVITY.                        05450000
054600     IF  PS-ERROR-NO                                              05460000
054700         MOVE PM-FKEY-MSG1          TO AFKMSGO                    05470000
054800     END-IF.                                                      05480000
054900                                                                  05490000
055000                                                                  05500000
055100*-----------------------------------------------------------------05510000
055200 1050-INITIALIZE-RETURN.                                          05520000
055300*-----------------------------------------------------------------05530000
055400                                                                  05540000
055500     MOVE PC038-CARTON-ID-ENTERED TO ACARTNIDO.                   05550000
055600     EVALUATE TRUE                                                05560000
055700         WHEN PC038-SRC-ASN                                       05570000
055800              MOVE PC-VENDOR-ASN TO ACREATEO                      05580000
055900         WHEN PC038-SRC-CHECK-IN                                  05590000
056000              MOVE PC-CHECK-IN   TO ACREATEO                      05600000
056100         WHEN PC038-SRC-CSEPK-SPLT                                05610000
056200              MOVE PC-CSEPK-SPLT TO ACREATEO                      05620000
056300         WHEN PC038-SRC-MANUAL                                    05630000
056400              MOVE PC-MANUAL     TO ACREATEO                      05640000
056500         WHEN PC038-SRC-P2L                                       05650000
056600              MOVE PC-PCK-2-LIT  TO ACREATEO                      05660000
056700         WHEN PC038-SRC-RECEIVING                                 05670000
056800              MOVE PC-RECEIVING  TO ACREATEO                      05680000
056900         WHEN PC038-SRC-RDM                                       05690000
057000              MOVE PC-RDM        TO ACREATEO                      05700000
057100         WHEN PC038-SRC-SMOOTHING                                 05710000
057200              MOVE PC-SMOOTHING  TO ACREATEO                      05720000
057300         WHEN PC038-SRC-FAST-XFER                                 05730000
057400              MOVE PC-FAST-XFER  TO ACREATEO                      05740000
057500         WHEN PC038-SRC-MSTR-CNTR                                 05750000
057600              MOVE PC-MSTR-CNTR  TO ACREATEO                      05760000
057700         WHEN PC038-SRC-CRTN-BULD                                 05770000
057800              MOVE PC-CRTN-BULD  TO ACREATEO                      05780000
057900         WHEN PC038-SRC-JWL                                       05790000
058000              MOVE PC-JEWELRY    TO ACREATEO                      05800000
058100         WHEN PC038-SRC-DMG                                       05810000
058200              MOVE PC-DAMAGED    TO ACREATEO                      05820000
058210         WHEN PC038-SRC-3WD                                       05821088
058220              MOVE PC-3WD-PRTY-WHSE TO ACREATEO                   05822088
058300         WHEN OTHER                                               05830000
058400              MOVE PC-UNKNOWN    TO ACREATEO                      05840000
058500     END-EVALUATE.                                                05850000
058600                                                                  05860000
058700     MOVE PC038-SHPUNT-CRE-YYMMDD TO PV-DB2-REFORMAT-DATE.        05870000
058800     MOVE PV-DB2-DATE-YY          TO PV-DISPLAY-DATE-YY.          05880000
058900     MOVE PV-DB2-DATE-MM          TO PV-DISPLAY-DATE-MM.          05890000
059000     MOVE PV-DB2-DATE-DD          TO PV-DISPLAY-DATE-DD.          05900000
059100     MOVE PV-DISPLAY-DATE         TO AONO.                        05910000
059200     MOVE PC038-SHPUNT-CRE-HHMM   TO ATIMEO.                      05920000
059300     PERFORM 2000-DETERMINE-DC.                                   05930000
059400     MOVE PC038-SHPUNT-SHIPT-UNT-ID TO DK-CARTON-ID.              05940000
059500     IF PC038-SOURCE-ID = 'FXR' AND                               05950000
059600        PC038-STATUS    = '02'                                    05960000
059700         MOVE 'INACTVD-UNUSED LBL '     TO ALSTACTO               05970000
059800     ELSE                                                         05980000
059900         MOVE PC046-CRTN-STAT-DESC      TO ALSTACTO               05990000
060000     END-IF.                                                      06000000
060100     MOVE PM-FKEY-MSG1 TO AFKMSGO.                                06010000
060200                                                                  06020000
060300*-----------------------------------------------------------------06030000
060400 1200-HELP-SCREEN.                                                06040000
060500*-----------------------------------------------------------------06050000
060600                                                                  06060000
060700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      06070000
060800     MOVE 'PCKRF881'                  TO PC192-PROGRAM-NAME       06080000
060900     COPY PCPD188.                                                06090000
061000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      06100000
061100     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     06110000
061200     PERFORM 8220-XCTL-TO-HELP.                                   06120000
061300                                                                  06130000
061400*-----------------------------------------------------------------06140000
061500 2000-DETERMINE-DC.                                               06150000
061600*-----------------------------------------------------------------06160000
061700                                                                  06170000
061800     EVALUATE PC038-SOURCE-ID                                     06180000
061900     WHEN PC-ASN                                                  06190000
062000         MOVE PC038-SHPUNT-ORGN-OPER     TO ABYO                  06200000
062100         MOVE PC038-SHPUNT-DEST-OPER     TO DK-STR-NBR            06210000
062200         MOVE DK-STR-NBR                 TO AFORO                 06220000
062300     WHEN PC-P2L                                                  06230000
062400     WHEN PC-MAN                                                  06240000
062500     WHEN PC-CPS                                                  06250000
062600     WHEN PC-SMO                                                  06260000
062700     WHEN PC-FXR                                                  06270000
062800     WHEN PC-MST                                                  06280000
062900     WHEN PC-MSC                                                  06290000
063000     WHEN PC-JWL                                                  06300000
063100     WHEN PC-DMG                                                  06310000
063110     WHEN PC-3WD                                                  06311088
063200         MOVE PC038-SU-BC-DC-ORIGIN   TO ABYO                     06320000
063300         MOVE PC038-SU-BC-DIVERT-CD   TO PV-SU-BC-DIVERT-CODE     06330000
063400         MOVE PV-SU-BC-DIVERT-CD      TO AFORO                    06340000
063500                                                                  06350000
063600     WHEN PC-RDM2                                                 06360000
063700     WHEN PC-CKN                                                  06370000
063800     WHEN PC-RCV                                                  06380000
063900     WHEN SPACES                                                  06390000
064000         MOVE PC038-SHPUNT-ORGN-OPER TO ABYO                      06400000
064100         MOVE PC038-SHPUNT-DEST-OPER TO DK-STR-NBR                06410000
064200         MOVE DK-STR-NBR             TO AFORO                     06420000
064300     END-EVALUATE.                                                06430000
064400                                                                  06440000
064500*-----------------------------------------------------------------06450000
064600* DETERMINE LAST ACTIVITY FOR CARTON (CHECK IN REVERSE ORDER)     06460000
064700*-----------------------------------------------------------------06470000
064800 3000-DETERMINE-LAST-ACTIVITY.                                    06480000
064900                                                                  06490000
065000                                                                  06500000
065100     INITIALIZE  PC046-COMMAREA-REC.                              06510000
065200     SET   PC046-FROM-CRTN-STAT  TO  TRUE.                        06520000
065300     MOVE  DK-CARTON-ID          TO  PC046-CARTON-ID.             06530000
065400                                                                  06540000
065500                                                                  06550000
065600     CALL PC046-CARTON-STATUS-MODULE                              06560000
065700             USING DFHEIBLK                                       06570000
065800             PC046-COMMAREA                                       06580000
065900             PC046-COMMAREA-REC                                   06590000
066000     END-CALL                                                     06600000
066100                                                                  06610000
066200     PERFORM 3100-VALIDATE-STATUS-CALL.                           06620000
066300                                                                  06630000
066400*----------------------------------------------------------------*06640000
066500* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*06650000
066600*----------------------------------------------------------------*06660000
066700 3100-VALIDATE-STATUS-CALL.                                       06670000
066800                                                                  06680000
066900                                                                  06690000
067000     IF  PC046-ERROR                                              06700000
067100         SET  PS-ERROR-YES           TO  TRUE                     06710000
067200         MOVE PM-CICS-ABEND-MSG      TO  AFKMSGO                  06720000
067300         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06730000
067400                                                                  06740000
067500     ELSE                                                         06750000
067600     IF  PC046-INVALID-SQL                                        06760000
067700         SET  PS-ERROR-YES           TO  TRUE                     06770000
067800         MOVE PM-DATABASE-ERROR      TO  AFKMSGO                  06780000
067900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06790000
068000                                                                  06800000
068100     ELSE                                                         06810000
068200     IF  PC046-DATABASE-BUSY                                      06820000
068300         SET  PS-ERROR-YES           TO  TRUE                     06830000
068400         MOVE PM-DATABASE-BUSY       TO  AFKMSGO                  06840000
068500         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06850000
068600                                                                  06860000
068700     ELSE                                                         06870000
068800     IF  PC046-CRTN-STAT-ERROR                                    06880000
068900         SET  PS-ERROR-YES           TO  TRUE                     06890000
069000         MOVE PM-CARTON-STATUS-ERROR TO  AFKMSGO                  06900000
069100         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       06910000
069200                                                                  06920000
069300     ELSE                                                         06930000
069400     IF  PC046-SUCCESSFUL                                         06940000
069500         MOVE  PC046-CRTN-STATUS     TO  PC038-STATUS             06950000
069600         MOVE  PC046-CRTN-STAT-TMST  TO  PV-DB2-TIMESTAMP         06960000
069700         MOVE  PV-DB2-TMST-DATE      TO  PC038-STATUS-DATE        06970000
069800         MOVE  PC046-STATUS-USERID   TO  PC038-STATUS-USERID      06980000
069900         MOVE  PC046-OTBD-TRIP-ID    TO  PC038-OTBND-TRIP         06990000
070000         MOVE  PC046-CRTN-STAT-DESC  TO  PC038-CRTN-STAT-DESC     07000000
070100                                         ALSTACTO                 07010000
070200                                                                  07020000
070300     ELSE                                                         07030000
070400         SET  PS-ERROR-YES           TO  TRUE                     07040000
070500         MOVE  PM-CICS-ABEND-MSG     TO  AFKMSGO                  07050000
070600                                                                  07060000
070700     END-IF                                                       07070000
070800     END-IF                                                       07080000
070900     END-IF                                                       07090000
071000     END-IF                                                       07100000
071100     END-IF.                                                      07110000
071200                                                                  07120000
071300     IF PC038-SOURCE-ID = 'FXR' AND                               07130000
071400        PC038-STATUS    = '02'                                    07140000
071500         MOVE 'INACTVD-UNUSED LBL '     TO ALSTACTO               07150000
071600     END-IF.                                                      07160000
071700                                                                  07170000
071800*-----------------------------------------------------------------07180000
071900* CHECK FOR PRINTER ID.                                           07190000
072000*-----------------------------------------------------------------07200000
072100 5000-CHECK-4-PRINTER-ID.                                         07210000
072200                                                                  07220000
072300     IF  APRINTIDL > ZERO                                         07230000
072400         MOVE APRINTIDI       TO PC038-PRINTER-ID                 07240000
072500         SET PS-PRINTER-FOUND TO TRUE                             07250000
072600     ELSE                                                         07260000
072700         IF APRINTIDA = DP015-ERASE-EOF                           07270000
072800             MOVE SPACES             TO PC038-PRINTER-ID          07280000
072900             SET PS-NO-PRINTER-FOUND TO TRUE                      07290000
073000         END-IF                                                   07300000
073100     END-IF.                                                      07310000
073200                                                                  07320000
073300*-----------------------------------------------------------------07330000
073400* VALIDATE PRINTER ID.                                            07340000
073500*-----------------------------------------------------------------07350000
073600 5100-VALIDATE-PRINTER.                                           07360000
073700                                                                  07370000
073800     MOVE PC-REPORT-PGM          TO  DP072-RPT-PGM-NME.           07380000
073900     MOVE PC039-CURR-OPER-UNT    TO  DP072-ORIGIN-OPER-UNT-ID     07390000
074000                                     DP072-OPER-UNT-ID            07400084
074100                                     DP072-PRTR-OPER-UNT-ID.      07410084
074200     MOVE 1                      TO  DP072-ORIGIN-FCLTY-ID        07420000
074300                                     DP072-FCLTY-ID.              07430000
074400     MOVE PC038-PRINTER-ID-1-3   TO  DP072-PRINTER-ID.            07440000
074500     SET DP072-VALIDATE          TO  TRUE.                        07450000
074600     IF PC039-4-BY-4-LBL                                          07460000
074700         MOVE PC-01              TO  DP072-RPT-PGM-TYP-ID         07470000
074800     ELSE                                                         07480000
074900         MOVE PC-02              TO  DP072-RPT-PGM-TYP-ID         07490000
075000     END-IF.                                                      07500000
075100                                                                  07510000
075200     EXEC CICS                                                    07520000
075300          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  07530000
075400               COMMAREA (DP072-COMM-AREA)                         07540000
075500               RESP     (PV-CICS-RESPONSE)                        07550000
075600     END-EXEC                                                     07560000
075700                                                                  07570000
075800     EVALUATE TRUE                                                07580000
075900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07590000
076000              IF PC039-4-BY-4-LBL                                 07600000
076100                  PERFORM 5200-VALIDATE-PRINTER-SML               07610000
076200              ELSE                                                07620000
076300                  IF PC039-PGYBK-LBL                              07630000
076400                      PERFORM 5300-VALIDATE-PIGGY-BACK            07640000
076500                  ELSE                                            07650000
076600                      SET PS-PRINTER-INVALID    TO  TRUE          07660000
076700                                                                  07670000
076800* DMH DISPLAYS - 5/12/03 BEGIN                                    07680000
076900             INITIALIZE PV-CICS-MSG-AREA2                         07690000
077000             MOVE PC039-CURR-OPER-UNT TO PV-DISPLAY-OPER-UNT      07700000
077100             STRING ' PCKRF881-5100-A-  OPER='                    07710000
077200                      PV-DISPLAY-OPER-UNT                         07720000
077300                    ' PRTR=' PC038-PRINTER-ID-1-3                 07730000
077400                    ' TYPE=' PC039-LBL-TYPE                       07740000
077500                             DELIMITED BY SIZE                    07750000
077600                        INTO PV-CICS-MSG-AREA2                    07760000
077700             PERFORM 9901-WRITE-CSSL                              07770000
077800             STRING ' PCKRF881-5100- '                            07780000
077900                    ' PC038-SHPUNT-CART-TYP-CDE='                 07790000
078000                      PC038-SHPUNT-CART-TYP-CDE                   07800000
078100                             DELIMITED BY SIZE                    07810000
078200                        INTO PV-CICS-MSG-AREA2                    07820000
078300             PERFORM 9901-WRITE-CSSL                              07830000
078400                                                                  07840000
078500             STRING ' PCKRF881-5100- '                            07850000
078600                    ' PC038-SULBXF-CART-TYP-CDE='                 07860000
078700                      PC038-SULBXF-CART-TYP-CDE                   07870000
078800                             DELIMITED BY SIZE                    07880000
078900                        INTO PV-CICS-MSG-AREA2                    07890000
079000             PERFORM 9901-WRITE-CSSL                              07900000
079100* DMH DISPLAYS - 5/12/03 BEGIN                                    07910000
079200                                                                  07920000
079300                 END-IF                                           07930000
079400             END-IF                                               07940000
079500         WHEN OTHER                                               07950000
079600             SET PS-PRINTER-INVALID                               07960000
079700                 PS-ERROR-YES          TO  TRUE                   07970000
079800                                                                  07980000
079900* DMH DISPLAYS - 5/12/03 BEGIN                                    07990000
080000             INITIALIZE  PV-CICS-MSG-AREA2                        08000000
080100             MOVE PC039-CURR-OPER-UNT TO PV-DISPLAY-OPER-UNT      08010000
080200             STRING ' PCKRF881-5100-B-  OPER='                    08020000
080300                      PV-DISPLAY-OPER-UNT                         08030000
080400                    ' PRTR=' PC038-PRINTER-ID-1-3                 08040000
080500                    ' TYPE=' PC039-LBL-TYPE                       08050000
080600                             DELIMITED BY SIZE                    08060000
080700                        INTO PV-CICS-MSG-AREA2                    08070000
080800             PERFORM 9901-WRITE-CSSL                              08080000
080900* DMH DISPLAYS - 5/12/03 BEGIN                                    08090000
081000                                                                  08100000
081100     END-EVALUATE.                                                08110000
081200                                                                  08120000
081300*-----------------------------------------------------------------08130000
081400* CHECK PRINTER ID TO MAKE SURE THAT IT CAN PRINT SML LABELS      08140000
081500*-----------------------------------------------------------------08150000
081600 5200-VALIDATE-PRINTER-SML.                                       08160000
081700                                                                  08170000
081800     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               08180000
081900         SET  PS-PRINTER-INVALID   TO TRUE                        08190000
082000     END-IF.                                                      08200000
082100                                                                  08210000
082200     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  08220000
082300         SET  PS-PRINTER-VALID        TO TRUE                     08230000
082400         MOVE  DP072-PRTR-IP-ADDRESS  TO  PV-IP-ADDRESS           08240000
082500     ELSE                                                         08250000
082600         SET  PS-PRINTER-INVALID                                  08260000
082700              PS-ERROR-YES          TO  TRUE                      08270000
082800                                                                  08280000
082900* DMH DISPLAYS - 5/12/03 BEGIN                                    08290000
083000         INITIALIZE  PV-CICS-MSG-AREA2                            08300000
083100         MOVE PC039-CURR-OPER-UNT TO PV-DISPLAY-OPER-UNT          08310000
083200         STRING ' PCKRF881-5200- OPER='                           08320000
083300                  PV-DISPLAY-OPER-UNT                             08330000
083400                ' PRTR=' PC038-PRINTER-ID-1-3                     08340000
083500                ' TYPE=' PC039-LBL-TYPE                           08350000
083600                ' MGMX=' DP072-PRTR-CLUSTER-OS-RLSE-CDE           08360000
083700                ' STAT=' DP072-PRTR-PRTR-TRK-STAT-CDE             08370000
083800                         DELIMITED BY SIZE                        08380000
083900                    INTO PV-CICS-MSG-AREA2                        08390000
084000         EXEC CICS                                                08400000
084100              WRITEQ TD                                           08410000
084200               QUEUE  ('CSSL')                                    08420000
084300                FROM   (PV-CICS-MSG-AREA2)                        08430000
084400                RESP   (PV-CICS-RESPONSE)                         08440000
084500         END-EXEC                                                 08450000
084600* DMH DISPLAYS - 5/12/03 BEGIN                                    08460000
084700                                                                  08470000
084800     END-IF.                                                      08480000
084900                                                                  08490000
085000*-----------------------------------------------------------------08500000
085100* CHECK PRINTER ID TO MAKE SURE THAT IT CAN PRINT PIGGYBACK LABEL 08510000
085200*-----------------------------------------------------------------08520000
085300 5300-VALIDATE-PIGGY-BACK.                                        08530000
085400                                                                  08540000
085500     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  08550000
085600         SET  PS-PRINTER-VALID        TO TRUE                     08560000
085700         MOVE  DP072-PRTR-IP-ADDRESS  TO  PV-IP-ADDRESS           08570000
085800     ELSE                                                         08580000
085900         SET  PS-PRINTER-INVALID                                  08590000
086000              PS-ERROR-YES          TO  TRUE                      08600000
086100     END-IF.                                                      08610000
086200                                                                  08620000
086300*---------------------------------------------------------------- 08630000
086400 6000-FILL-PC140.                                                 08640000
086500*---------------------------------------------------------------- 08650000
086600                                                                  08660000
086700     INITIALIZE PC140-RF-CRTN-STAT-APPL-LBL.                      08670000
086800     SET PC140-RF-CRTN-STAT-APPL   TO TRUE                        08680000
086900     PERFORM 6200-GET-DC-LOCATION.                                08690000
087000                                                                  08700000
087100     MOVE PC039-LBL-FORMAT         TO PC140-RF-LBL-FORMAT.        08710000
087200                                                                  08720000
087300     IF PC140-RF-CHECKIN-SML  OR                                  08730000
087400        PC140-RF-DEST-LBL     OR                                  08740000
087500        PC140-RF-CRTN-LBL                                         08750000
087600        PERFORM 6300-CHECK-AUDIT-STAT                             08760000
087700*CLP 12/17/13                                                     08770080
087800        IF PC140-RF-AUDIT-STATUS > SPACE                          08780082
087900            CONTINUE                                              08790082
088000        ELSE                                                      08800082
088100            PERFORM 6305-CHECK-RFID-AUDIT-STAT                    08810082
088200        END-IF                                                    08820082
088300     END-IF                                                       08830000
088400                                                                  08840000
088500     MOVE PC039-LBL-TYPE           TO PC140-RF-LBL-TYPE.          08850000
088600     MOVE PC039-PACK-TYPE          TO PC140-RF-PACK-TYPE.         08860000
088700     MOVE PC039-CASE-TYPE          TO PC140-RF-CASE-TYPE.         08870000
088800     MOVE PC038-PRINTER-ID-1-3     TO PC140-RF-PRTR-ID.           08880000
088900     MOVE PC039-CALLED-PGM-NME     TO PC140-CRA-REQ-ID.           08890000
089000     MOVE PC039-CRA-REQ-ID         TO PC140-RF-USERID.            08900000
089100     MOVE PC039-STR-NBR            TO PC140-RF-STR-NBR.           08910000
089200     MOVE PC039-STR-NAME           TO PC140-RF-STR-NAME.          08920000
089300     MOVE PC039-PO-NBR             TO PC140-RF-PO-NBR.            08930000
089400     MOVE PC039-PO-RCVR            TO PC140-RF-PO-RCVR.           08940000
089500     MOVE PC039-LNE-NBR            TO PC140-RF-LNE-NBR.           08950000
089600     MOVE PC039-PREPK-ID           TO PC140-RF-PREPK-ID.          08960000
089700     MOVE PC039-DEPT               TO PC140-RF-DEPT.              08970000
089800     MOVE PC039-CLASS              TO PC140-RF-CLASS.             08980000
089900     MOVE PC039-SKU                TO PC140-RF-SKU.               08990000
090000     MOVE PC039-STYLE              TO PC140-RF-STYLE.             09000000
090100     MOVE PC039-OTPK-UNITS         TO PC140-RF-OTPK-UNITS.        09010000
090200     MOVE PC039-INPK-UNITS         TO PC140-RF-INPK-UNITS.        09020000
090300     MOVE PC039-DEPT-NAME          TO PC140-RF-DEPT-NAME.         09030000
090400     MOVE PC039-MAJOR-CLASS        TO PC140-RF-MAJOR-CLASS.       09040000
090500     MOVE PC039-SEASONAL-SET       TO PC140-RF-SEASONAL-SET.      09050000
090600     MOVE PC039-FIXTURE            TO PC140-RF-FIXTURE.           09060000
090700     MOVE PC039-ZONE               TO PC140-RF-ZONE.              09070000
090800*                                                                 09080000
090900***  DMH - 10/6/10 - BEGIN                                        09090000
091000*                                                                 09100000
091100     MOVE PC039-TRIP-ARRIVE-DATE   TO PC140-TRIP-ARRIVE-DATE.     09110000
091200*                                                                 09120000
091300***  DMH - 10/6/10 - END                                          09130000
091400*                                                                 09140000
091500                                                                  09150000
091600     IF PC039-GENERIC-SML                                         09160000
091700        MOVE PC039-RF-ZNE-LINE-1      TO PC140-RF-ZNE-LINE-1      09170000
091800        MOVE PC039-RF-ZNE-LINE-2      TO PC140-RF-ZNE-LINE-2      09180000
091900        MOVE PC039-RF-ZNE-LINE-3      TO PC140-RF-ZNE-LINE-3      09190000
092000     END-IF                                                       09200000
092100                                                                  09210000
092200     MOVE PC039-PREPK-UNT-QTY      TO PC140-RF-UNTS-IN-PCK.       09220000
092300     MOVE PC039-PACKS-IN-CRTN      TO PC140-RF-PACKS-IN-CRTN.     09230000
092400     MOVE PC039-PREPK-RATIO        TO PC140-RF-PREPK-RATIO.       09240000
092500     MOVE PC039-KOHLS-BARCODE      TO PC140-RF-KOHLS-BARCODE.     09250000
092600                                                                  09260000
092700* DMH 12/24/02 - BEGIN                                            09270000
092800     IF  PC038-ORIG-SHIPT-UNT-ID  >  0                            09280000
092900         MOVE PC038-ORIG-SHIPT-UNT-ID  TO PV-LAST5-SHIPT-UNT-ID   09290000
093000     ELSE                                                         09300000
093100         MOVE PC039-SHIPT-UNT-ID       TO PV-LAST5-SHIPT-UNT-ID   09310000
093200     END-IF.                                                      09320000
093300* DMH 12/24/02 - END                                              09330000
093400                                                                  09340000
093500     MOVE PV-LAST5-VNDR-BC         TO PC140-RF-VNDR-BC-LAST-5.    09350000
093600     MOVE PV-IP-ADDRESS            TO PC140-RF-IP-ADDRESS.        09360000
093700*                                                                 09370000
093800*PR5148B - CLP - 04/23/2013 - BEGIN                               09380000
093900     MOVE PC039-RFID-IND TO PC140-RFID-IND.                       09390000
094000*PR5148B - CLP - 04/23/2013 - END                                 09400000
094100     MOVE PC039-LABEL-PRINT-IND TO PC140-LABEL-PRINT-IND.         09410086
094200     PERFORM 7000-LINK-TO-PCKCS707.                               09420000
094300                                                                  09430000
094400*---------------------------------------------------------------- 09440000
094500 6200-GET-DC-LOCATION.                                            09450000
094600*---------------------------------------------------------------- 09460000
094700                                                                  09470000
094800     INITIALIZE XL071-COMMAREA-REC.                               09480000
094900     MOVE DP072-PRTR-OPER-UNT-ID TO XL071-LOCATION-NUMBER.        09490000
095000                                                                  09500000
095100     CALL PC-LOCATION-MODULE  USING                               09510000
095200                                    DFHEIBLK                      09520000
095300                                    XL071-COMMAREA                09530000
095400                                    XL071-COMMAREA-REC.           09540000
095500     EVALUATE TRUE                                                09550000
095600         WHEN XL071-NO-ERRORS                                     09560000
095700              MOVE  XL071-LOC-5-ABBR-NM TO  PV-DC-5-CHAR-ABBR     09570000
095800              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       09580000
095900              MOVE  XL071-LOCATION-NUMBER                         09590000
096000                                        TO  PC140-CRA-OPER-UNT-ID 09600000
096100         WHEN XL071-LOC-NOT-FOUND                                 09610000
096200              MOVE  PC-90   TO  PC140-CRA-DC-ID                   09620000
096300                                PC140-CRA-OPER-UNT-ID             09630000
096400         WHEN XL071-BAD-DB2-RETURN                                09640000
096500             MOVE '6200-GET-DC-LOCATION' TO DP013-PARAGRAPH       09650000
096600             MOVE XL071-SQLCA TO SQLCA                            09660000
096700             MOVE SQLCA      TO DP013-SQLCA                       09670000
096800             MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME(1)           09680000
096900             SET DP013-DB2-ABEND                                  09690000
097000                 DP013-ROLLBACK                                   09700000
097100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               09710000
097200             PERFORM DP014-0000-PROCESS-ABEND                     09720000
097300     END-EVALUATE.                                                09730000
097400                                                                  09740000
097500*---------------------------------------------------------------- 09750000
097600 6300-CHECK-AUDIT-STAT.                                           09760000
097700*---------------------------------------------------------------- 09770000
097800                                                                  09780000
097900     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            09790000
098000     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      09800000
098100     MOVE PC039-LNE-NBR            TO SUT00015-PO-LNE-NBR.        09810000
098200     MOVE PC039-PREPK-ID           TO SUT00015-PO-PREPK-ID.       09820000
098300                                                                  09830000
098400     IF  PC039-PREPK-ID  >  0                                     09840000
098500         MOVE  ZEROES  TO  SUT00015-PO-LNE-NBR                    09850000
098600     END-IF.                                                      09860000
098700                                                                  09870000
098800     EXEC SQL                                                     09880000
098900          SELECT AUD_STAT_CDE                                     09890000
099000          INTO  :SUT00015-AUD-STAT-CDE                            09900000
099100          FROM   SUT_PO_AUD_REQ                                   09910000
099200          WHERE  PO_NBR       = :SUT00015-PO-NBR                  09920000
099300          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            09930000
099400          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              09940000
099500          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             09950000
099600     END-EXEC.                                                    09960000
099700                                                                  09970000
099800     EVALUATE TRUE                                                09980000
099900         WHEN SQLCODE = ZERO                                      09990000
100000            MOVE SUT00015-AUD-STAT-CDE                            10000000
100100                                  TO  PC140-RF-AUDIT-STATUS       10010000
100200         WHEN SQLCODE = +100                                      10020000
100300              IF  SUT00015-PO-LNE-NBR  =  ZEROES                  10030000
100400                  MOVE  SPACES  TO  PC140-RF-AUDIT-STATUS         10040000
100500              ELSE                                                10050000
100600                  PERFORM 6310-CHECK-AUDIT-STAT-0LINE             10060000
100700              END-IF                                              10070000
100800         WHEN SQLWARN0 NOT = SPACES                               10080000
100900         WHEN SQLCODE NOT EQUAL ZERO                              10090000
101000             MOVE '6300-CHECK-AUDIT-STAT' TO DP013-PARAGRAPH      10100000
101100             MOVE SQLCA      TO DP013-SQLCA                       10110000
101200             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME(1)    10120000
101300             SET DP013-DB2-ABEND                                  10130000
101400                 DP013-ROLLBACK                                   10140000
101500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10150000
101600             PERFORM DP014-0000-PROCESS-ABEND                     10160000
101700     END-EVALUATE.                                                10170000
101800                                                                  10180000
101900*---------------------------------------------------------------- 10190079
102000 6305-CHECK-RFID-AUDIT-STAT.                                      10200079
102100*---------------------------------------------------------------- 10210079
102200                                                                  10220079
102300     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            10230079
102400     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      10240079
102500     MOVE 0                        TO SUT00015-PO-LNE-NBR.        10250079
102600     MOVE -9999                    TO SUT00015-PO-PREPK-ID.       10260079
102700                                                                  10270079
102800                                                                  10280079
102900     EXEC SQL                                                     10290079
103000          SELECT AUD_STAT_CDE                                     10300079
103100          INTO  :SUT00015-AUD-STAT-CDE                            10310079
103200          FROM   SUT_PO_AUD_REQ                                   10320079
103300          WHERE  PO_NBR       = :SUT00015-PO-NBR                  10330079
103400          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            10340079
103500          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              10350079
103600          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             10360079
103700     END-EXEC.                                                    10370079
103800                                                                  10380079
103900     EVALUATE TRUE                                                10390079
104000         WHEN SQLCODE = ZERO                                      10400079
104100            MOVE SUT00015-AUD-STAT-CDE                            10410079
104200                          TO  PC140-RF-AUDIT-STATUS               10420079
104300         WHEN SQLCODE = +100                                      10430079
104400            CONTINUE                                              10440082
104500         WHEN SQLWARN0 NOT = SPACES                               10450079
104600         WHEN SQLCODE NOT EQUAL ZERO                              10460079
104700             MOVE '6305-CHECK-RFID-AUDIT-STAT' TO DP013-PARAGRAPH 10470079
104800             MOVE SQLCA      TO DP013-SQLCA                       10480079
104900             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME(1)    10490079
105000             SET DP013-DB2-ABEND                                  10500079
105100                 DP013-ROLLBACK                                   10510079
105200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10520079
105300             PERFORM DP014-0000-PROCESS-ABEND                     10530079
105400     END-EVALUATE.                                                10540079
105500                                                                  10550000
105600*--------------------------------------------------------------   10560000
105700* CHECK FOR 0 LINE FOR PACK-BY-STORE                          -   10570000
105800*--------------------------------------------------------------   10580000
105900 6310-CHECK-AUDIT-STAT-0LINE.                                     10590000
106000     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            10600000
106100     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      10610000
106200     MOVE ZEROES                   TO SUT00015-PO-LNE-NBR.        10620000
106300     MOVE PC039-PREPK-ID           TO SUT00015-PO-PREPK-ID.       10630000
106400                                                                  10640000
106500     EXEC SQL                                                     10650000
106600          SELECT AUD_STAT_CDE                                     10660000
106700          INTO  :SUT00015-AUD-STAT-CDE                            10670000
106800          FROM   SUT_PO_AUD_REQ                                   10680000
106900          WHERE  PO_NBR       = :SUT00015-PO-NBR                  10690000
107000          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            10700000
107100          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              10710000
107200          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             10720000
107300     END-EXEC.                                                    10730000
107400                                                                  10740000
107500     EVALUATE TRUE                                                10750000
107600         WHEN SQLCODE = ZERO                                      10760000
107700              MOVE SUT00015-AUD-STAT-CDE                          10770000
107800                                  TO  PC140-RF-AUDIT-STATUS       10780000
107900              MOVE  ZEROES  TO  PC039-LNE-NBR                     10790000
108000         WHEN SQLCODE = +100                                      10800000
108100              MOVE  SPACES  TO  PC140-RF-AUDIT-STATUS             10810000
108200         WHEN SQLCODE = -811                                      10820000
108300              PERFORM 6320-CHECK-AUDIT-STAT-ORG-OPER              10830000
108400         WHEN SQLWARN0 NOT = SPACES                               10840000
108500         WHEN SQLCODE NOT EQUAL ZERO                              10850000
108600             MOVE '6310-CHECK-AUDIT-STAT-0LINE'                   10860000
108700                                          TO DP013-PARAGRAPH      10870000
108800             MOVE SQLCA      TO DP013-SQLCA                       10880000
108900             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME(1)    10890000
109000             SET DP013-DB2-ABEND                                  10900000
109100                 DP013-ROLLBACK                                   10910000
109200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10920000
109300             PERFORM DP014-0000-PROCESS-ABEND                     10930000
109400     END-EVALUATE.                                                10940000
109500                                                                  10950000
109600                                                                  10960000
109700*--------------------------------------------------------------   10970000
109800* CHECK FOR 0 LINE FOR PACK-BY-STORE.  NEED TO SPECIFY THE    -   10980000
109900* OPER UNT ID OF THE FACILITY THAT ORIGINALLY CREATED THE     -   10990000
110000* AUDIT.                                                      -   11000000
110100*--------------------------------------------------------------   11010000
110200 6320-CHECK-AUDIT-STAT-ORG-OPER.                                  11020000
110300     MOVE PC039-PO-NBR             TO SUT00015-PO-NBR.            11030000
110400     MOVE PC039-PO-RCVR            TO SUT00015-RCVR-SEQ-NBR.      11040000
110500     MOVE ZEROES                   TO SUT00015-PO-LNE-NBR.        11050000
110600     MOVE PC039-PREPK-ID           TO SUT00015-PO-PREPK-ID.       11060000
110700     MOVE PC038-SHPUNT-ORGN-OPER   TO SUT00015-OPER-UNT-ID.       11070000
110800                                                                  11080000
110900     EXEC SQL                                                     11090000
111000          SELECT AUD_STAT_CDE                                     11100000
111100          INTO  :SUT00015-AUD-STAT-CDE                            11110000
111200          FROM   SUT_PO_AUD_REQ                                   11120000
111300          WHERE  PO_NBR       = :SUT00015-PO-NBR                  11130000
111400          AND    RCVR_SEQ_NBR = :SUT00015-RCVR-SEQ-NBR            11140000
111500          AND    PO_LNE_NBR   = :SUT00015-PO-LNE-NBR              11150000
111600          AND    PO_PREPK_ID  = :SUT00015-PO-PREPK-ID             11160000
111700          AND    OPER_UNT_ID  = :SUT00015-OPER-UNT-ID             11170000
111800     END-EXEC.                                                    11180000
111900                                                                  11190000
112000     EVALUATE TRUE                                                11200000
112100         WHEN SQLCODE = ZERO                                      11210000
112200              MOVE SUT00015-AUD-STAT-CDE                          11220000
112300                                  TO  PC140-RF-AUDIT-STATUS       11230000
112400              MOVE  ZEROES  TO  PC039-LNE-NBR                     11240000
112500         WHEN SQLCODE = +100                                      11250000
112600              MOVE  SPACES  TO  PC140-RF-AUDIT-STATUS             11260000
112700         WHEN SQLWARN0 NOT = SPACES                               11270000
112800         WHEN SQLCODE NOT EQUAL ZERO                              11280000
112900             MOVE '6320-CHECK-AUDIT-STAT-ORG-OPER'                11290000
113000                                          TO DP013-PARAGRAPH      11300000
113100             MOVE SQLCA      TO DP013-SQLCA                       11310000
113200             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME(1)    11320000
113300             SET DP013-DB2-ABEND                                  11330000
113400                 DP013-ROLLBACK                                   11340000
113500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11350000
113600             PERFORM DP014-0000-PROCESS-ABEND                     11360000
113700     END-EVALUATE.                                                11370000
113800                                                                  11380000
113900*-----------------------------------------------------------------11390000
114000 6400-SELECT-VENDOR-BARCODE.                                      11400000
114100*-----------------------------------------------------------------11410000
114200*   THIS PARA WILL REPLACE THE DK-SHIPT-UNT-ID WITH THE           11420000
114300*   SUT024-SHIPT-UNT-ID FIELD WHEN THE DK-SHIPT-UNT-ID CONTAINS   11430000
114400*   A VENDOR BAR CODE                                             11440000
114500                                                                  11450000
114600     EXEC SQL                                                     11460000
114700         SELECT SHIPT_UNT_ID                                      11470000
114800         INTO   :SUT00024-SHIPT-UNT-ID                            11480000
114900         FROM   SUT_OTBND_CART                                    11490000
115000         WHERE  ORIG_CART_ID = :DK-SHIPT-UNT-ID                   11500000
115100           AND  ACTV_IND     = 'Y'                                11510000
115200     END-EXEC.                                                    11520000
115300                                                                  11530000
115400     EVALUATE TRUE                                                11540000
115500         WHEN SQLCODE = +0                                        11550000
115600             MOVE SUT00024-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID       11560000
115700         WHEN SQLCODE = +100                                      11570000
115800             CONTINUE                                             11580000
115900         WHEN SQLCODE NOT EQUAL +0                                11590000
116000               MOVE '6400-SELECT-VENDOR-BARCODE'                  11600000
116100                                               TO DP013-PARAGRAPH 11610000
116200               MOVE 'ERROR SELECTING SUT_OTBND_CART'              11620000
116300                                        TO DP013-MESSAGE-TEXT (1) 11630000
116400               MOVE SQLCA        TO DP013-SQLCA                   11640000
116500               MOVE 'SUT00024'   TO DP013-DB2-TABLE-NAME (1)      11650000
116600               SET DP013-DB2-ABEND                                11660000
116700                   DP013-ROLLBACK   TO TRUE                       11670000
116800               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             11680000
116900     END-EVALUATE.                                                11690000
117000                                                                  11700000
117100*----------------------------------------------------------------*11710000
117200* LINK TO THE LABEL PRINTING PROGRAM - PCKCS707                   11720000
117300*----------------------------------------------------------------*11730000
117400 7000-LINK-TO-PCKCS707.                                           11740000
117500                                                                  11750000
117600                                                                  11760000
117700     MOVE 400  TO  PC-COMMAREA-LENGTH.                            11770000
117800                                                                  11780000
117900     EXEC CICS                                                    11790000
118000          LINK PROGRAM  ('PCKCS707')                              11800000
118100               COMMAREA (PC140-LABELMST)                          11810000
118200               LENGTH   (PC-COMMAREA-LENGTH)                      11820000
118300               RESP     (PV-CICS-RESPONSE)                        11830000
118400     END-EXEC.                                                    11840000
118500                                                                  11850000
118600     EVALUATE TRUE                                                11860000
118700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11870000
118800              CONTINUE                                            11880000
118900         WHEN OTHER                                               11890000
119000              PERFORM DP014-0000-PROCESS-ABEND                    11900000
119100     END-EVALUATE.                                                11910000
119200     IF PC140-CRA-SOCKET-COMM-ERROR                               11920000
119300         MOVE PM-SOCKET-COMM-ERROR   TO AFKMSGO                   11930000
119400         SET  PS-ERROR-YES           TO TRUE                      11940000
119500     ELSE                                                         11950000
119600         IF PC140-CRA-INVALID-PRT-FMT                             11960000
119700             MOVE PM-INVALID-PRT-FMT     TO AFKMSGO               11970000
119800             SET  PS-ERROR-YES           TO TRUE                  11980000
119900         ELSE                                                     11990000
120000             MOVE -1                     TO APRINTIDL             12000000
120100         END-IF                                                   12010000
120200     END-IF.                                                      12020000
120300                                                                  12030000
120400*---------------------------------------------------------------- 12040000
120500 8000-SEND-MAP.                                                   12050000
120600*-----------------------------------------------------------------12060000
120700                                                                  12070000
120800     EXEC CICS                                                    12080000
120900         SEND MAP       ('PC881A')                                12090000
121000              MAPSET    ('PCKM881')                               12100000
121100              ERASE                                               12110000
121200              CURSOR                                              12120000
121300              RESP      (PV-CICS-RESPONSE)                        12130000
121400     END-EXEC.                                                    12140000
121500                                                                  12150000
121600     EVALUATE TRUE                                                12160000
121700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12170000
121800              CONTINUE                                            12180000
121900         WHEN OTHER                                               12190000
122000              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           12200000
122100              MOVE 'UNABLE TO SEND MAP'                           12210000
122200                                     TO DP013-MESSAGE-TEXT (1)    12220000
122300              SET DP013-CICS-ABEND   TO TRUE                      12230000
122400              SET DP013-ROLLBACK     TO TRUE                      12240000
122500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12250000
122600     END-EVALUATE.                                                12260000
122700                                                                  12270000
122800*-----------------------------------------------------------------12280000
122900 8100-SEND-DATA-ONLY.                                             12290000
123000*-----------------------------------------------------------------12300000
123100                                                                  12310000
123200     EXEC CICS                                                    12320000
123300         SEND MAP       ('PC881A')                                12330000
123400              MAPSET    ('PCKM881')                               12340000
123500              CURSOR                                              12350000
123600              DATAONLY                                            12360000
123700              RESP      (PV-CICS-RESPONSE)                        12370000
123800     END-EXEC.                                                    12380000
123900                                                                  12390000
124000     EVALUATE TRUE                                                12400000
124100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12410000
124200              CONTINUE                                            12420000
124300         WHEN OTHER                                               12430000
124400              MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH       12440000
124500              MOVE 'UNABLE TO SEND DATA'                          12450000
124600                                     TO DP013-MESSAGE-TEXT (1)    12460000
124700              SET DP013-CICS-ABEND   TO TRUE                      12470000
124800              SET DP013-ROLLBACK     TO TRUE                      12480000
124900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12490000
125000     END-EVALUATE.                                                12500000
125100                                                                  12510000
125200*-----------------------------------------------------------------12520000
125300 8200-RETURN-TRANID.                                              12530000
125400*-----------------------------------------------------------------12540000
125500                                                                  12550000
125600     MOVE LENGTH OF CA-COMMAREA   TO PC-COMMAREA-LENGTH           12560000
125700     EXEC CICS                                                    12570000
125800         RETURN TRANSID   (PC-DUPLICATE)                          12580000
125900                COMMAREA  (CA-COMMAREA)                           12590000
126000                LENGTH    (PC-COMMAREA-LENGTH)                    12600000
126100                RESP      (PV-CICS-RESPONSE)                      12610000
126200     END-EXEC.                                                    12620000
126300                                                                  12630000
126400     EVALUATE TRUE                                                12640000
126500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12650000
126600              CONTINUE                                            12660000
126700         WHEN OTHER                                               12670000
126800              MOVE '8200-RETURN-TRANID' TO DP013-PARAGRAPH        12680000
126900              MOVE 'UNABLE TO RETURN TO TRANID'                   12690000
127000                                     TO DP013-MESSAGE-TEXT (1)    12700000
127100              SET DP013-CICS-ABEND   TO TRUE                      12710000
127200              SET DP013-ROLLBACK     TO TRUE                      12720000
127300              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12730000
127400     END-EVALUATE.                                                12740000
127500                                                                  12750000
127600*-----------------------------------------------------------------12760000
127700 8220-XCTL-TO-HELP.                                               12770000
127800*-----------------------------------------------------------------12780000
127900                                                                  12790000
128000     MOVE LENGTH OF PC192-COMMAREA    TO PC-COMMAREA-LENGTH       12800000
128100                                                                  12810000
128200     EXEC CICS                                                    12820000
128300         XCTL                                                     12830000
128400             PROGRAM   (PV-TRANSFER-PROGRAM)                      12840000
128500             COMMAREA  (PC192-COMMAREA)                           12850000
128600             LENGTH    (PC-COMMAREA-LENGTH)                       12860000
128700             RESP      (PV-CICS-RESPONSE)                         12870000
128800     END-EXEC.                                                    12880000
128900                                                                  12890000
129000     EVALUATE TRUE                                                12900000
129100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12910000
129200              CONTINUE                                            12920000
129300         WHEN OTHER                                               12930000
129400             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          12940000
129500             MOVE 'PCKRF881 - UNABLE TO XCTL TO PROGRAM: '        12950000
129600                                      TO DP013-MESSAGE-TEXT (1)   12960000
129700             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   12970000
129800             SET DP013-CICS-ABEND                                 12980000
129900                 DP013-ROLLBACK       TO TRUE                     12990000
130000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13000000
130100             MOVE PM-TRANS-UNAVAILABLE-MSG TO AFKMSGO             13010000
130200             SET PC038-PROCESS-SCREEN TO TRUE                     13020000
130300             MOVE -1                  TO AFKMSGL                  13030000
130400             PERFORM 8000-SEND-MAP                                13040000
130500             PERFORM 8200-RETURN-TRANID                           13050000
130600     END-EVALUATE.                                                13060000
130700                                                                  13070000
130800*-----------------------------------------------------------------13080000
130900 8300-XCTL-TO-SELECTED-PROGRAM.                                   13090000
131000*-----------------------------------------------------------------13100000
131100                                                                  13110000
131200     SET PC038-INITIALIZE-SCREEN     TO TRUE.                     13120000
131300     MOVE PC-CURRENT-PROGRAM-NAME    TO PC038-LAST-PROGRAM.       13130000
131400                                                                  13140000
131500     MOVE LENGTH OF CA-COMMAREA   TO PC-COMMAREA-LENGTH           13150000
131600     EXEC CICS                                                    13160000
131700         XCTL                                                     13170000
131800             PROGRAM   (PV-TRANSFER-PROGRAM)                      13180000
131900             COMMAREA  (CA-COMMAREA)                              13190000
132000             LENGTH    (PC-COMMAREA-LENGTH)                       13200000
132100             RESP      (PV-CICS-RESPONSE)                         13210000
132200     END-EXEC.                                                    13220000
132300                                                                  13230000
132400     EVALUATE TRUE                                                13240000
132500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13250000
132600              CONTINUE                                            13260000
132700         WHEN OTHER                                               13270000
132800              MOVE '8300-XCTL-TO-SELECTED-PROGRAM'                13280000
132900                                               TO DP013-PARAGRAPH 13290000
133000              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       13300000
133100                                        TO DP013-MESSAGE-TEXT (1) 13310000
133200              MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)  13320000
133300              SET DP013-CICS-ABEND   TO TRUE                      13330000
133400              SET DP013-ROLLBACK     TO TRUE                      13340000
133500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13350000
133600              MOVE PM-TRANS-UNAVAILABLE-MSG TO AFKMSGO            13360000
133700              SET PC038-PROCESS-SCREEN TO TRUE                    13370000
133800              PERFORM 8100-SEND-DATA-ONLY                         13380000
133900              PERFORM 8200-RETURN-TRANID                          13390000
134000     END-EVALUATE.                                                13400000
134100                                                                  13410000
134200*-----------------------------------------------------------------13420000
134300 8350-LINK-TO-888-PROGRAM.                                        13430000
134400*-----------------------------------------------------------------13440000
134500                                                                  13450000
134600     MOVE LENGTH OF PC039-COMMAREA-REC   TO PC-COMMAREA-LENGTH    13460000
134700                                                                  13470000
134800     EXEC CICS                                                    13480000
134900         LINK                                                     13490000
135000             PROGRAM   (PV-TRANSFER-PROGRAM)                      13500000
135100             COMMAREA  (PC039-COMMAREA-REC)                       13510000
135200             LENGTH    (PC-COMMAREA-LENGTH)                       13520000
135300             RESP      (PV-CICS-RESPONSE)                         13530000
135400     END-EXEC.                                                    13540000
135500                                                                  13550000
135600                                                                  13560000
135700     EVALUATE TRUE                                                13570000
135800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13580000
135900              EVALUATE TRUE                                       13590000
136000                  WHEN PC039-SUCCESSFUL                           13600000
136100                       MOVE PC039-PRINTER-ID                      13610000
136200                                          TO PC038-PRINTER-ID-1-3 13620000
136300                       PERFORM 5100-VALIDATE-PRINTER              13630000
136400                       IF  PS-PRINTER-VALID                       13640000
136500                           PERFORM 6000-FILL-PC140                13650000
136600                           IF  PC140-CRA-SUCCESSFUL               13660000
136700                               MOVE PM-FKEY-MSG2      TO AFKMSGO  13670000
136800                           END-IF                                 13680000
136900                       ELSE                                       13690000
137000                           MOVE PM-INVALID-PRTR-ID    TO AFKMSGO  13700000
137100                           SET  PS-ERROR-YES          TO TRUE     13710000
137200                       END-IF                                     13720000
137300                                                                  13730000
137400                 WHEN PC039-ERROR                                 13740000
137500                 WHEN PC039-INVALID-SQL                           13750000
137600                      MOVE PM-CICS-ABEND-MSG      TO AFKMSGO      13760000
137700                      SET  PS-ERROR-YES           TO TRUE         13770000
137800              END-EVALUATE                                        13780000
137900                                                                  13790000
138000         WHEN OTHER                                               13800000
138100              MOVE '8350-LINK-TO-888-PROGRAM'  TO DP013-PARAGRAPH 13810000
138200              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       13820000
138300                                        TO DP013-MESSAGE-TEXT (1) 13830000
138400              MOVE 'PCKRF888'           TO DP013-MESSAGE-TEXT (2) 13840000
138500              SET DP013-CICS-ABEND   TO TRUE                      13850000
138600              SET DP013-ROLLBACK     TO TRUE                      13860000
138700              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13870000
138800              MOVE PM-TRANS-UNAVAILABLE-MSG TO AFKMSGO            13880000
138900              SET PC038-PROCESS-SCREEN TO TRUE                    13890000
139000              PERFORM 8100-SEND-DATA-ONLY                         13900000
139100              PERFORM 8200-RETURN-TRANID                          13910000
139200     END-EVALUATE.                                                13920000
139300                                                                  13930000
139400*-----------------------------------------------------------------13940000
139500 8400-RECEIVE-MAP.                                                13950000
139600*-----------------------------------------------------------------13960000
139700                                                                  13970000
139800     EXEC CICS                                                    13980000
139900         RECEIVE MAP    ('PC881A')                                13990000
140000                 MAPSET ('PCKM881')                               14000000
140100                 RESP   (PV-CICS-RESPONSE)                        14010000
140200     END-EXEC.                                                    14020000
140300                                                                  14030000
140400     EVALUATE TRUE                                                14040000
140500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14050000
140600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                14060000
140700              CONTINUE                                            14070000
140800         WHEN OTHER                                               14080000
140900              MOVE '8400-RECEIVE-MAP' TO DP013-PARAGRAPH          14090000
141000              MOVE 'UNABLE TO RECEIVE MAP'                        14100000
141100                                     TO DP013-MESSAGE-TEXT (1)    14110000
141200              SET DP013-LOGIC-ABEND  TO TRUE                      14120000
141300              SET DP013-ROLLBACK     TO TRUE                      14130000
141400              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              14140000
141500     END-EVALUATE.                                                14150000
141600                                                                  14160000
141700 9901-WRITE-CSSL.                                                 14170000
141800     EXEC CICS                                                    14180000
141900         WRITEQ TD                                                14190000
142000             QUEUE  ('CSSL')                                      14200000
142100             FROM  (PV-CICS-MSG-AREA2)                            14210000
142200             RESP  (PV-CICS-RESPONSE)                             14220000
142300     END-EXEC                                                     14230000
142400                                                                  14240000
142500     INITIALIZE PV-CICS-MSG-AREA2.                                14250000
142600                                                                  14260000
142700 9904-WRITE-CRTN-MODULE-MSG.                                      14270000
142800                                                                  14280000
142900                                                                  14290000
143000     MOVE '3100'                      TO  PV-CTN-PARA             14300000
143100     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          14310000
143200     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           14320000
143300     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        14330000
143400     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      14340000
143500     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             14350000
143600     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        14360000
143700     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      14370000
143800                                                                  14380000
143900     INITIALIZE PV-CICS-MSG-AREA2                                 14390000
144000     MOVE PV-CARTON-MSG               TO PV-CICS-MSG-AREA2        14400000
144100     PERFORM 9901-WRITE-CSSL                                      14410000
144200                                                                  14420000
144300                                                                  14430000
144400     EXEC CICS                                                    14440000
144500         WRITEQ TD                                                14450000
144600             QUEUE  ('CSSL')                                      14460000
144700             FROM   (PC046-CRA-RET-MSG)                           14470000
144800             RESP   (PV-CICS-RESPONSE)                            14480000
144900     END-EXEC.                                                    14490000
145000                                                                  14500000
145100                                                                  14510000
145200*-----------------------------------------------------------------14520000
145300 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  14530000
145400*-----------------------------------------------------------------14540000
145500                                                                  14550000
145600     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            14560000
145700     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           14570000
145800     INITIALIZE DP013-SRC-TASK-NUMBER                             14580000
145900                DP013-STACK.                                      14590000
146000     SET DP013-LINK-RETURN           TO TRUE.                     14600000
146100                                                                  14610000
146200     EXEC CICS                                                    14620000
146300         LINK                                                     14630000
146400             PROGRAM   (DP013-NAME)                               14640000
146500             COMMAREA  (DP013-PARAMETERS)                         14650000
146600             LENGTH    (DP013-LENGTH)                             14660000
146700     END-EXEC.                                                    14670000
146800                                                                  14680000
146900*----------------------------------------------------------------*14690000
147000*    ABEND PROCESSOR MODULE                                      *14700000
147100*----------------------------------------------------------------*14710000
147200     COPY DPPD014.                                                14720000
