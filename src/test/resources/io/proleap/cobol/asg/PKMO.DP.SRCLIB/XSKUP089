       IDENTIFICATION DIVISION.                                         00010001
       PROGRAM-ID.      XSKUP089.                                       00020001
       AUTHOR.          KOHLS DEPARTMENT STORES.                        00030001
       INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040001
       DATE-WRITTEN.    10/01/2004.                                     00050001
       DATE-COMPILED.                                                   00060001
      ******************************************************************00070001
      **XS DOMAIN TABLE LOAD - INITIAL LOAD/RECOVERY FOR TABLE          00080001
      **                       XST_PRCHG_MDSE                           00090001
      ******************************************************************00100001
      **THIS PROGRAM USES THE NEW PERM SYSTEM EXTRACT TO LOAD THE       00110001
      **XS DOMAIN TABLE.                                                00120001
      ******************************************************************00130001
      *DATE:10/01/2004   MADE BY:NANCY MARTIN  INITIAL PROGRAM WRITE    00140001
      ******************************************************************00150001
       ENVIRONMENT DIVISION.                                            00160001
       CONFIGURATION SECTION.                                           00170001
       SOURCE-COMPUTER.        IBM-3090.                                00180001
       OBJECT-COMPUTER.        IBM-3090.                                00190001
       INPUT-OUTPUT SECTION.                                            00200001
       FILE-CONTROL.                                                    00210001
                                                                        00220001
           SELECT CONTROL-CARD                                          00230001
                  ASSIGN TO INP00.                                      00240001
                                                                        00250001
           SELECT INPUT-FILE                                            00251001
                  ASSIGN TO INP01.                                      00252001
                                                                        00253001
           SELECT OUTPUT-FILE                                           00254001
                  ASSIGN TO OUT01.                                      00255001
                                                                        00256001
       DATA DIVISION.                                                   00257001
       FILE SECTION.                                                    00258001
                                                                        00259001
       FD  CONTROL-CARD                                                 00260001
           RECORDING MODE F                                             00270001
           BLOCK CONTAINS 0 RECORDS                                     00280001
           LABEL RECORDS ARE OMITTED                                    00281001
           DATA RECORD IS CONTROL-RECORD.                               00282001
       01  CONTROL-RECORD                  PIC X(080).                  00283001
                                                                        00284001
       FD  INPUT-FILE                                                   00285001
           RECORDING MODE F                                             00286001
           BLOCK CONTAINS 0 RECORDS                                     00287001
           LABEL RECORDS ARE OMITTED                                    00288001
           DATA RECORD IS INPUT-RECORD.                                 00289001
       01  INPUT-RECORD                    PIC X(200).                  00290001
                                                                        00300001
       FD  OUTPUT-FILE                                                  00310001
           RECORDING MODE F                                             00320001
           BLOCK CONTAINS 0 RECORDS                                     00330001
           LABEL RECORDS ARE OMITTED                                    00340001
           DATA RECORD IS OUTPUT-RECORD.                                00350001
       01  OUTPUT-RECORD                   PIC X(200).                  00351001
                                                                        00352001
       WORKING-STORAGE SECTION.                                         00353001
      ******************************************************************00354001
      **SWITCHES                                                        00355001
      ******************************************************************00356001
       01  PS-PROGRAM-SWITCHES.                                         00357001
           05  PS-END-OF-INPUT-FILE-SW         PIC X(01)   VALUE 'N'.   00358001
               88  PS-END-OF-INPUT-FILE                    VALUE 'Y'.   00359001
               88  PS-MORE-INPUT-FILE                      VALUE 'N'.   00360001
           05  PS-END-OF-CNTL-CRD-SW           PIC X(01)   VALUE 'N'.   00370001
               88  PS-END-OF-CNTL-CRD-FILE                 VALUE 'Y'.   00380001
               88  PS-NOT-END-OF-CNTL-CRD-FILE             VALUE 'N'.   00381001
      ******************************************************************00382001
      **TIMESTAMP AND DATE VARIABLES                                    00383001
      ******************************************************************00384001
       01  SD-TIMESTAMP                        PIC  X(26)  VALUE SPACES.00385001
       01  FILLER REDEFINES SD-TIMESTAMP.                               00386001
           05  SD-CURR-DTE                     PIC  X(10).              00387001
           05  FILLER                          PIC  X(01).              00388001
           05  SD-HOUR                         PIC  X(02).              00389001
           05  FILLER                          PIC  X(01).              00390001
           05  SD-MINUTE                       PIC  X(02).              00400001
           05  FILLER                          PIC  X(01).              00410001
           05  SD-SECOND                       PIC  X(02).              00420001
           05  FILLER                          PIC  X(01).              00430001
           05  SD-MICROSEC                     PIC  X(06).              00440001
NEMDEL*01  PV-DATE.                                                     00450001
NEMDEL*    05  PV-DT-CC                        PIC  XX.                 00460001
NEMDEL*    05  PV-DT-YY                        PIC  XX.                 00470001
NEMDEL*    05  FILLER                          PIC  X(01) VALUE '-'.    00480001
NEMDEL*    05  PV-DT-MM                        PIC  X(02).              00481001
NEMDEL*    05  FILLER                          PIC  X(01) VALUE '-'.    00482001
NEMDEL*    05  PV-DT-DD                        PIC  X(02).              00483001
      ******************************************************************00484001
      **PROGRAM CONSTANTS                                               00485001
      ******************************************************************00486001
       01  PC-PROGRAM-CONSTANTS.                                        00487001
           05  PC-PROGRAM-NAME     PIC X(08)   VALUE 'XSKUP089'.        00488001
      ******************************************************************00489001
      **COPYBOOKS                                                       00490001
      ******************************************************************00500001
      *** CONTROL CARD LAYOUT - ERROR LIMIT                             00510001
           COPY XSWS108.                                                00520001
                                                                        00530001
      ***INPUT FILE LAYOUT - NEW PERM EXTRACT                           00540001
           COPY PERD105.                                                00550001
                                                                        00560001
      ***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        00570001
           COPY DPWS004.                                                00580001
      ***DB2 ABEND COPYBOOK                                             00590001
           COPY DPWS900.                                                00600001
      ***DB2 MESSAGE AREA                                               00610001
           COPY SQLCA2.                                                 00620001
      ******************************************************************00630001
      **TABLE INCLUSIONS                                                00640001
      ******************************************************************00650001
                                                                        00660001
      ***DB2 COMMUNICATIONS AREA                                        00670001
           EXEC SQL                                                     00680001
                INCLUDE SQLCA                                           00690001
           END-EXEC.                                                    00700001
                                                                        00710001
      ***TABLE XST_PRCHG_MDSE                                           00720001
           EXEC SQL                                                     00730001
                INCLUDE XST00065                                        00740001
           END-EXEC.                                                    00750001
                                                                        00760001
      * PC- PROGRAM CONSTANTS                                           00770001
                                                                        00780001
      *----------------------------------------------------------       00790001
      * PV- PROGRAM VARIABLES                                           00800001
      *----------------------------------------------------------       00810001
       01  PV-DB2-FIELDS.                                               00820001
           05  PV-DB2-PRCHG-ID              PIC S9(11) COMP   VALUE 0.  00830001
           05  PV-DB2-MDSE-ID               PIC S9(11) COMP   VALUE 0.  00831001
           05  PV-DB2-GP-PRIC-ID            PIC S9(11) COMP   VALUE 0.  00832003
      ******************************************************************00840001
      **NULL INDICATORS                                                 00850001
      ******************************************************************00860001
       01  PV-NULL-INDICATORS.                                          00870001
           05  PV-DEPT-NBR-IND                 PIC S9(4) COMP.          00880001
           05  PV-MAJ-CL-IND                   PIC S9(4) COMP.          00881001
           05  PV-SUB-CL-IND                   PIC S9(4) COMP.          00882001
           05  PV-STYL-IND                     PIC S9(4) COMP.          00882101
           05  PV-SKU-IND                      PIC S9(4) COMP.          00882203
           05  PV-SKU-NBR-IND                  PIC S9(4) COMP.          00883001
           05  PV-GP-PRIC-ID-IND               PIC S9(4) COMP.          00890001
           05  PV-GP-AMT-IND                   PIC S9(4) COMP.          00891003
           05  PV-GP-QTY-IND                   PIC S9(4) COMP.          00892001
      ******************************************************************00900001
      **PROGRAM COUNTERS                                                00910001
      ******************************************************************00920001
       01  PV-PROGRAM-COUNTER.                                          00930001
           05  PV-INPUT-RECORDS-READ      PIC 9(09)   VALUE ZEROS.      00940001
           05  PV-PRCHG-CNT               PIC 9(09)   VALUE ZEROS.      00950001
           05  PV-REDO-CNT                PIC 9(09)   VALUE ZEROS.      00960001
           05  PV-COMMIT-COUNTER          PIC 9(09)   VALUE ZEROS.      00970001
           05  PV-ERROR-COUNTER           PIC 9(09)   VALUE ZEROS.      00971001
      ******************************************************************00972001
      **ERROR HANDLING                                                  00973001
      ******************************************************************00974001
       01  PV-MISC-ABEND-FIELDS.                                        00975001
           05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      00976001
           05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      00977001
           05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      00978001
           05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      00979001
       01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 00980001
           88  ABEND-4001-WRITE-ERROR            VALUE +4001.           00990001
           88  ABEND-4002-READ-ERROR             VALUE +4002.           01000001
           88  ABEND-4003-CTRL-CARD-ERROR        VALUE +4003.           01010001
           88  ABEND-4004-TABLE-ERROR            VALUE +4004.           01020001
           88  ABEND-4005-OPEN-ERROR             VALUE +4005.           01030001
           88  ABEND-4006-CLOSE-ERROR            VALUE +4006.           01040001
           88  ABEND-4007-SEQUENCE-ERROR         VALUE +4007.           01050001
           88  ABEND-4008-DATA-ERROR             VALUE +4008.           01060001
           88  ABEND-4009-KEY-DATA-ERROR         VALUE +4009.           01070001
           88  ABEND-4013-DB2-ERROR              VALUE +4013.           01080001
           88  ABEND-4019-CAL-SUB-ERROR          VALUE +4019.           01090001
           88  ABEND-4444-FORCED-ABEND           VALUE +4444.           01100001
                                                                        01110001
       PROCEDURE DIVISION.                                              01120001
      ***************************************************************** 01130001
                                                                        01140001
           PERFORM 1000-INITIALIZATION.                                 01150001
                                                                        01160001
           PERFORM 2000-PROCESS-RECORDS                                 01170001
                   UNTIL PS-END-OF-INPUT-FILE.                          01180001
                                                                        01190001
           PERFORM 9999-WRAPUP.                                         01200001
           GOBACK.                                                      01210001
                                                                        01220001
       EJECT.                                                           01230001
      ******************************************************************01240001
      **INITIALIZATION AREA                                             01250001
      ******************************************************************01260001
       1000-INITIALIZATION.                                             01270001
                                                                        01280001
           MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01290001
                                                                        01300001
           OPEN INPUT CONTROL-CARD                                      01310001
                      INPUT-FILE                                        01320001
           OPEN OUTPUT OUTPUT-FILE                                      01321001
                                                                        01322001
           PERFORM 1100-SELECT-DB2-TIME.                                01323001
           DISPLAY ' XSKUP089 START CURRENT TMST-', SD-TIMESTAMP.       01324001
                                                                        01325001
      *    * READ CONTROL CARD FOR ERROR THRESHOLD NUMBER               01326001
           PERFORM 1200-READ-CONTROL-CARD.                              01327001
                                                                        01328001
      *    * READ FIRST EXTRACT RECORD *                                01329001
           PERFORM 7000-READ-INPUT-FILE.                                01330001
                                                                        01340001
       EJECT.                                                           01350001
      ******************************************************************01360001
      **RETRIEVE TIME FROM DB2                                          01370001
NEMNTE** ??? MAY NOT BE NEEDED                                          01380001
      ******************************************************************01390001
       1100-SELECT-DB2-TIME.                                            01400001
                                                                        01410001
           MOVE '1100-SELECT-DB2-TIME' TO PV-PARAGRAPH-NAME.            01420001
                                                                        01430001
           EXEC SQL                                                     01440001
                SELECT CURRENT TIMESTAMP                                01450001
                INTO  :SD-TIMESTAMP                                     01460001
                FROM   SYSIBM.SYSDUMMY1                                 01470001
           END-EXEC.                                                    01480001
                                                                        01490001
           IF  SQLCODE NOT EQUAL ZERO                                   01500001
               PERFORM 9999-SQL-ABEND-ROUTINE                           01510001
           END-IF.                                                      01520001
                                                                        01530001
       EJECT.                                                           01540001
064800*--------------------------------------------------------------*  01550001
064900* 1200-READ-CONTROL-CARD.                                         01560001
065000*     READ CONTROL CARD XSCC108. THIS CONTROL CARD CONTAINS       01570001
065100*     THE NUMBER OF ACCEPTABLE ERRORS (PROCESSING CONTINUES).     01580001
065200*--------------------------------------------------------------*  01590001
065300 1200-READ-CONTROL-CARD.                                          01591001
065400                                                                  01592001
065500     READ CONTROL-CARD INTO CC-XSCC108-CONTROL-CARD               01593001
065600       AT END                                                     01594001
065700          SET PS-END-OF-CNTL-CRD-FILE TO TRUE.                    01595001
065800                                                                  01596001
065900     IF PS-END-OF-CNTL-CRD-FILE                                   01597001
066000       DISPLAY ' '                                                01598001
066100       DISPLAY '** ABEND     **'                                  01599001
066200       DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME              01599101
066300       DISPLAY '** PARAGRAPH **  = 1200-READ-CONTROL-CARD'        01599201
066400       DISPLAY '** MISSING ERROR LIMIT CONTROL CARD - 108'        01599301
066500       DISPLAY ' '                                                01599401
066600       MOVE +4002 TO ABEND-CODE                                   01599501
066700       CALL 'ILBOABN0' USING ABEND-CODE                           01599601
066800     ELSE                                                         01599701
066900       DISPLAY '** ERROR THRESHOLD CONTROL CARD  = '              01599801
067000                CC-XSCC108-CONTROL-CARD,  ' **'                   01599901
067100       DISPLAY '** XSCC108 CARD LABEL NAME = '                    01600001
067200                CC-XSCC108-CONTROL-NM, ' **'                      01600101
067300       DISPLAY '** XSCC108 MAX ERRORS = '                         01600201
067400                CC-XSCC108-MAX-ERRORS, ' **'                      01600301
067500       DISPLAY ' '                                                01600401
067600     END-IF.                                                      01600501
067700                                                                  01600601
067800*1200-EXIT.                                                       01600701
067900                                                                  01600801
      ******************************************************************01600901
      **PROCESSES INPUT FILE                                            01601001
      ******************************************************************01602001
       2000-PROCESS-RECORDS.                                            01603001
                                                                        01604001
           MOVE '2000-PROCESS-RECORDS' TO PV-PARAGRAPH-NAME.            01605001
           INITIALIZE PV-NULL-INDICATORS.                               01606001
                                                                        01607001
           INITIALIZE DCLXST00065                                       01608001
           MOVE PE105-STR-GP-TYP-CDE   TO XST00065-STR-GP-TYP-CDE       01609001
           MOVE PE105-STR-GP-ID        TO XST00065-STR-GP-ID            01610001
           MOVE PE105-PRCHG-ID         TO PV-DB2-PRCHG-ID               01620001
           MOVE PV-DB2-PRCHG-ID        TO XST00065-PRCHG-ID             01630001
           MOVE PE105-PRCHG-MDSE-ID    TO PV-DB2-MDSE-ID                01630101
           MOVE PV-DB2-MDSE-ID         TO XST00065-PRCHG-MDSE-ID        01631001
                                                                        01640001
           MOVE PE105-MDSE-HIER-CDE    TO XST00065-MDSE-HIER-CDE        01641003
           MOVE PE105-DEPT-NBR         TO XST00065-DEPT-NBR             01650001
           MOVE PE105-DEPT-NBR-NI      TO PV-DEPT-NBR-IND               01660001
           MOVE PE105-MAJ-CL-NBR       TO XST00065-MAJ-CL-NBR           01660101
           MOVE PE105-MAJ-CL-NBR-NI    TO PV-MAJ-CL-IND                 01660201
           MOVE PE105-SUB-CL-NBR       TO XST00065-SUB-CL-NBR           01661001
           MOVE PE105-SUB-CL-NBR-NI    TO PV-SUB-CL-IND                 01662001
           MOVE PE105-STYL-ID          TO XST00065-STYL-ID              01663001
           MOVE PE105-STYL-ID-NI       TO PV-STYL-IND                   01664001
           MOVE PE105-SKU-NBR          TO XST00065-SKU-NBR              01665001
           MOVE PE105-SKU-NBR-NI       TO PV-SKU-NBR-IND                01666001
           MOVE PE105-MDSE-PRIC-AMT    TO XST00065-UNT-RTL-AMT          01670003
           MOVE PE105-GP-PRIC-ID       TO PV-DB2-GP-PRIC-ID             01680003
           MOVE PV-DB2-GP-PRIC-ID      TO XST00065-GP-PRIC-ID           01680103
           MOVE PE105-GP-PRIC-ID-NI    TO PV-GP-PRIC-ID-IND             01681001
           MOVE PE105-GP-PRIC-AMT      TO XST00065-GP-RTL-AMT           01681101
           MOVE PE105-GP-PRIC-AMT-NI   TO PV-GP-AMT-IND                 01681203
           MOVE PE105-GP-QTY           TO XST00065-GP-RTL-QTY           01682002
           MOVE PE105-GP-QTY-NI        TO PV-GP-QTY-IND                 01683001
                                                                        01710001
           MOVE PE105-SOR-LAST-UPD-TMST TO XST00065-SOR-LAST-UPD-TMST   01720001
                                                                        01730001
           PERFORM 2100-INSERT-ROW                                      01740001
                                                                        01750001
           IF  PV-ERROR-COUNTER >= CC-XSCC108-MAX-ERRORS                01760001
               DISPLAY '***** XSKUP089 LOAD OF XST_STR_GP_PRCHG '       01770001
                       ' ENCOUNTERED MORE ERRORS THAN ALLOWED - '       01780001
                        CC-XSCC108-MAX-ERRORS, '** TERMINATING **'      01790001
               PERFORM 9999-DISPLAY-STATISTICS                          01800001
               PERFORM 9999-SQL-ABEND-ROUTINE                           01810001
           END-IF.                                                      01820001
                                                                        01830001
           IF  PV-COMMIT-COUNTER >= 3000                                01840001
               PERFORM 9999-COMMIT-DATA                                 01850001
               INITIALIZE PV-COMMIT-COUNTER                             01860001
           END-IF.                                                      01870001
                                                                        01880001
           PERFORM 7000-READ-INPUT-FILE.                                01890001
                                                                        01900001
       EJECT.                                                           01910001
      ***************************************************************** 01920001
      **INSERT ROW INTO TABLE XST_PRCHG_MDSE                            01930001
      ***************************************************************** 01940001
       2100-INSERT-ROW.                                                 01950001
                                                                        01960001
           MOVE '2100-INSERT-ROW' TO PV-PARAGRAPH-NAME.                 01970001
                                                                        01980001
           EXEC SQL                                                     01990001
           INSERT INTO XST_PRCHG_MDSE                                   02000001
                        (  STR_GP_TYP_CDE                               02010001
                         , STR_GP_ID                                    02020001
                         , PRCHG_ID                                     02030001
                         , PRCHG_MDSE_ID                                02031001
                         , MDSE_HIER_CDE                                02032003
                         , DEPT_NBR                                     02040001
                         , MAJ_CL_NBR                                   02041001
                         , SUB_CL_NBR                                   02042001
                         , STYL_ID                                      02043001
                         , SKU_NBR                                      02044001
                         , UNT_RTL_AMT                                  02050001
                         , GP_PRIC_ID                                   02051001
                         , GP_RTL_AMT                                   02052003
                         , GP_RTL_QTY                                   02053003
                         , SOR_LAST_UPD_TMST                            02060001
                         , LAST_UPD_TMST                                02070001
                         , LAST_ACTN_CDE)                               02080001
           VALUES        ( :XST00065-STR-GP-TYP-CDE                     02090001
                         , :XST00065-STR-GP-ID                          02100001
                         , :XST00065-PRCHG-ID                           02110001
                         , :XST00065-PRCHG-MDSE-ID                      02111001
                         , :XST00065-MDSE-HIER-CDE                      02112003
                         , :XST00065-DEPT-NBR:PV-DEPT-NBR-IND           02120001
                         , :XST00065-MAJ-CL-NBR:PV-MAJ-CL-IND           02121001
                         , :XST00065-SUB-CL-NBR:PV-SUB-CL-IND           02122001
                         , :XST00065-STYL-ID:PV-STYL-IND                02122102
                         , :XST00065-SKU-NBR:PV-SKU-NBR-IND             02122201
                         , :XST00065-UNT-RTL-AMT                        02122301
                         , :XST00065-GP-PRIC-ID:PV-GP-PRIC-ID-IND       02130003
                         , :XST00065-GP-RTL-AMT:PV-GP-AMT-IND           02131003
                         , :XST00065-GP-RTL-QTY:PV-GP-QTY-IND           02132002
                         , :XST00065-SOR-LAST-UPD-TMST                  02140001
                         , CURRENT TIMESTAMP                            02150001
                         , 'A')                                         02160001
           END-EXEC.                                                    02170001
                                                                        02180001
           EVALUATE TRUE                                                02190001
              WHEN SQLCODE = ZERO                                       02200001
                   ADD +1                       TO PV-PRCHG-CNT         02210001
                   ADD +1                       TO PV-COMMIT-COUNTER    02220001
              WHEN SQLCODE = -530                                       02230001
                 DISPLAY '** INVALID FOREIGN KEY ON INSERT OF --'       02231005
                 DISPLAY 'PRICE STR GP TYP: '                           02232005
                                 XST00065-STR-GP-TYP-CDE                02233005
                         'PRICE STR GP ID:  '                           02234006
                                 XST00065-STR-GP-ID                     02235005
                 DISPLAY 'PRICE CHANGE ID:  '                           02236005
                                 XST00065-PRCHG-ID                      02237005
                         'PRICE CHG MDSE ID:'                           02238006
                                 XST00065-PRCHG-MDSE-ID                 02239005
                 DISPLAY 'HIER CODE:       '                            02239105
                                 XST00065-MDSE-HIER-CDE                 02239205
                 DISPLAY 'DEPT NUMBER:     '                            02239305
                                 XST00065-DEPT-NBR                      02239405
                         'DEPT NULL IND: ' PV-DEPT-NBR-IND              02239506
                 DISPLAY 'MAJOR CLASS:     '                            02239605
                                 XST00065-MAJ-CL-NBR                    02239705
                         'MAJ NULL IND:  ' PV-MAJ-CL-IND                02239806
                 DISPLAY 'SUB CLASS:       '                            02239905
                                 XST00065-SUB-CL-NBR                    02240005
                         'SUB NULL IND:  ' PV-SUB-CL-IND                02240106
                 DISPLAY 'STYLE NUMBER:    '                            02240205
                                 XST00065-STYL-ID                       02240305
                         'STYLE NULL IND:' PV-STYL-IND                  02240406
                 DISPLAY 'SKU NUMBER:      '                            02240505
                                 XST00065-SKU-NBR                       02240605
                         'SKU NULL IND : ' PV-SKU-IND                   02240706
                 DISPLAY 'UNIT RTL AMT:    '                            02240805
                                 XST00065-UNT-RTL-AMT                   02240905
                 DISPLAY 'GROUP PRICE ID:  '                            02241005
                                 XST00065-GP-PRIC-ID                    02241105
                         'GP PR IN NULL: ' PV-GP-PRIC-ID-IND            02241206
                 DISPLAY 'GROUP PRICE AMT: '                            02241305
                                 XST00065-GP-RTL-AMT                    02241405
                         'GP AMT NULL:     ' PV-GP-AMT-IND              02241506
                 DISPLAY 'GROUP PRICE QTY: '                            02241605
                                 XST00065-GP-RTL-QTY                    02241705
                         'GP QTY NULL:' PV-GP-QTY-IND                   02241806
                 DISPLAY 'SOR LAST MSG TMST:'                           02241905
                                 XST00065-SOR-LAST-UPD-TMST             02242005
                 DISPLAY 'LAST UPD TMST:    '                           02242105
                                 XST00065-LAST-UPD-TMST                 02242205
                                 '--- DB2 TMST VALUE'                   02242305
                         'LAST ACTION CODE: ', 'A',                     02242406
                                 '--- HARD CODED VALUE'                 02242505
                   ADD +1                       TO PV-ERROR-COUNTER     02243001
                   PERFORM 8000-WRITE-REDO-RECORD                       02250001
              WHEN OTHER                                                02260001
                 DISPLAY '** NON ZERO SQL CODE ON INSERT FOR ---'       02270001
                 DISPLAY 'PRICE STR GP TYP: '                           02280001
                                 XST00065-STR-GP-TYP-CDE                02290001
                 DISPLAY 'PRICE STR GP ID:  '                           02300001
                                 XST00065-STR-GP-ID                     02310001
                 DISPLAY 'PRICE CHANGE ID:  '                           02320001
                                 XST00065-PRCHG-ID                      02330001
                 DISPLAY 'PRICE CHG MDSE ID:'                           02331001
                                 XST00065-PRCHG-MDSE-ID                 02332001
                 DISPLAY 'HIER CODE:       '                            02332103
                                 XST00065-MDSE-HIER-CDE                 02332203
                 DISPLAY 'DEPT NUMBER:     '                            02332303
                                 XST00065-DEPT-NBR                      02332403
                 DISPLAY 'DEPT NBR IND:  ' PV-DEPT-NBR-IND              02332503
                 DISPLAY 'MAJOR CLASS:     '                            02332603
                                 XST00065-MAJ-CL-NBR                    02332703
                 DISPLAY 'MAJOR CL IND:  ' PV-MAJ-CL-IND                02332803
                 DISPLAY 'SUB CLASS:       '                            02332903
                                 XST00065-SUB-CL-NBR                    02333003
                 DISPLAY 'SUB CL IND:    ' PV-SUB-CL-IND                02333103
                 DISPLAY 'STYLE NUMBER:    '                            02333203
                                 XST00065-STYL-ID                       02333303
                 DISPLAY 'STYLE ID IND:  ' PV-STYL-IND                  02333403
                 DISPLAY 'SKU NUMBER:      '                            02333503
                                 XST00065-SKU-NBR                       02333603
                 DISPLAY 'SKU NUMBER IND:' PV-SKU-IND                   02333703
                 DISPLAY 'UNIT RTL AMT:    '                            02333803
                                 XST00065-UNT-RTL-AMT                   02333903
                 DISPLAY 'GROUP PRICE ID:  '                            02334003
                                 XST00065-GP-PRIC-ID                    02334101
                 DISPLAY 'GP PRIC ID IND:' PV-GP-PRIC-ID-IND            02335001
                 DISPLAY 'GROUP PRICE AMT: '                            02340001
                                 XST00065-GP-RTL-AMT                    02350003
                 DISPLAY 'GP AMT IND:' PV-GP-AMT-IND                    02350201
                 DISPLAY 'GROUP PRICE QTY: '                            02351001
                                 XST00065-GP-RTL-QTY                    02352002
                 DISPLAY 'GP QTY IND:' PV-GP-QTY-IND                    02354001
                 DISPLAY 'SOR LAST MSG TMST:'                           02380001
                                 XST00065-SOR-LAST-UPD-TMST             02390001
                 DISPLAY 'LAST UPD TMST:    '                           02400001
                                 XST00065-LAST-UPD-TMST                 02410001
                                 '--- DB2 TMST VALUE'                   02420001
                 DISPLAY 'LAST ACTION CODE: ', 'A',                     02430001
                                 '--- HARD CODED VALUE'                 02440001
                 PERFORM 9999-DISPLAY-STATISTICS                        02450001
                 PERFORM 9999-SQL-ABEND-ROUTINE                         02460001
           END-EVALUATE.                                                02470001
                                                                        02480001
       EJECT.                                                           02490001
      ***************************************************************** 02500001
      **READ INPUT FILE                                                 02510001
      ***************************************************************** 02520001
       7000-READ-INPUT-FILE.                                            02530001
                                                                        02540001
           READ INPUT-FILE INTO PE105-RECORD                            02550001
                AT END                                                  02560001
                   SET PS-END-OF-INPUT-FILE TO TRUE                     02570001
           END-READ.                                                    02580001
                                                                        02590001
           IF PS-MORE-INPUT-FILE                                        02600001
              ADD +1 TO PV-INPUT-RECORDS-READ                           02610001
           END-IF.                                                      02620001
                                                                        02630001
       EJECT.                                                           02640001
      *--------------------------------------------------------------*  02650001
      * 8000-WRITE-REDO-RECORD.                                         02660001
      *--------------------------------------------------------------*  02670001
       8000-WRITE-REDO-RECORD.                                          02680001
                                                                        02690001
           MOVE '8500-WRITE-REDO-RECORD' TO PV-PARAGRAPH-NAME.          02700001
                                                                        02710001
           WRITE OUTPUT-RECORD FROM PE105-RECORD.                       02720001
      *NEM DISPLAY '*** WRITING REDO-', PE105-FPLU-RECORD.              02730001
                                                                        02740001
           ADD 1           TO PV-REDO-CNT.                              02750001
                                                                        02760001
      *8000-EXIT.                                                       02770001
                                                                        02780001
      ****************************************************************  02790001
      *END OF PROGRAM ROUTINE                                           02800001
      ****************************************************************  02810001
       9999-WRAPUP.                                                     02820001
                                                                        02830001
           PERFORM 9999-COMMIT-DATA.                                    02840001
                                                                        02850001
           CLOSE INPUT-FILE.                                            02860001
                                                                        02870001
           PERFORM 9999-DISPLAY-STATISTICS.                             02880001
                                                                        02890001
       EJECT.                                                           02900001
      ****************************************************************  02910001
      *COMMIT DATA TO DB                                                02920001
      ****************************************************************  02930001
       9999-COMMIT-DATA.                                                02940001
                                                                        02950001
           EXEC SQL                                                     02960001
                COMMIT                                                  02970001
           END-EXEC.                                                    02980001
                                                                        02990001
103002     EVALUATE TRUE                                                03000001
103002        WHEN SQLCODE = ZERO                                       03010001
103002             CONTINUE                                             03020001
103002        WHEN OTHER                                                03030001
103002             PERFORM 9999-DISPLAY-STATISTICS                      03040001
103002             PERFORM 9999-SQL-ABEND-ROUTINE                       03050001
103002     END-EVALUATE.                                                03060001
                                                                        03070001
       EJECT.                                                           03080001
      ****************************************************************  03090001
      *DISPLAY PROGRAM STATISTICS                                       03100001
      ****************************************************************  03110001
       9999-DISPLAY-STATISTICS.                                         03120001
                                                                        03130001
           DISPLAY '*************************************************'. 03140001
           DISPLAY '* PROGRAM...............: ' PC-PROGRAM-NAME.        03150001
           DISPLAY '* DATE/TIMESTAMP........: ' SD-TIMESTAMP.           03160001
           DISPLAY '* TOTAL RECORDS READ....: ' PV-INPUT-RECORDS-READ.  03170001
           DISPLAY '* PRCHG MDSE INSERTS....: ' PV-PRCHG-CNT.           03180004
           DISPLAY '* RECORDS TO REDO.......: ' PV-REDO-CNT.            03190001
           DISPLAY '* ERROR COUNTER ........: ' PV-ERROR-COUNTER.       03200001
           DISPLAY '*************************************************'. 03210001
                                                                        03220001
       EJECT.                                                           03230001
                                                                        03240001
      *----------------------------------------------------------       03250001
      * 9999-ABEND-ROUTINE.                                             03260001
      *     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  03270001
      *----------------------------------------------------------       03280001
       9999-ABEND-ROUTINE.                                              03290001
                                                                        03300001
           DISPLAY '** ABEND           **'.                             03310001
           DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03320001
           DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03330001
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       03340001
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       03350001
           CALL 'ILBOABN0' USING ABEND-CODE.                            03360001
                                                                        03370001
      *9999-EXIT.                                                       03380001
       EJECT.                                                           03390001
                                                                        03400001
      ******************************************************************03410001
      **SQL ABEND ROUTINE                                               03420001
      ******************************************************************03430001
       9999-SQL-ABEND-ROUTINE.                                          03440001
                                                                        03450001
           DISPLAY '** ABEND     **'.                                   03460001
           DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                03470001
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              03480001
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               03490001
      ******************************************************************03500001
      * COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     03510001
      * TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      03520001
      ******************************************************************03530001
           COPY DPPD004.                                                03540001
           SET ABEND-4013-DB2-ERROR TO TRUE.                            03550001
           CALL 'ILBOABN0' USING ABEND-CODE.                            03560001
                                                                        03570001
       EJECT.                                                           03580001
