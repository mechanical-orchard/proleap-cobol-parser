000100* ------------------------------------------------------------- * 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300* ------------------------------------------------------------- * 00030000
000400 PROGRAM-ID.    TXKUP001.                                         00040000
000500 AUTHOR.        BRAD GROCHOWSKI.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  01-10-2000.                                       00070000
000800                                                                  00080000
000900***************************************************************** 00090000
001000* SALES TAX PARAMETER PROGRAM. WILL CREATE THE                  * 00100000
001100* SALES TAX PARAMETER FILE THAT CONTAINS THE SALES TAX RATES    * 00110000
001200* FOR ALL STORES, AND WILL UPDATE THE TAX TABLE TTXRTLO WITH    * 00120000
001300* THE PLU ASSIGNED TAX ID NUMBER.                               * 00130000
001400***************************************************************** 00140000
001500*---------------------------------------------------------------- 00150000
001600* CHANGES:                                                        00160000
001700* 2/8/2000 BRAD GROCHOWSKI                                        00170000
001800*     WRITE OUT UPDATE MESSAGE WHEN POS TAX ID IS UPDATED.        00180000
001900*---------------------------------------------------------------- 00190000
002000* 2/14/2000 BRAD GROCHOWSKI                                       00200000
002100*     THRESHOLD TAX RATES THAT USE FULL TAX WILL NOW HAVE         00210000
002200*     AN 'F' IN THE FULL TAX INDICATOR, AND NO TAX RATE.          00220000
002300*     THE FULL TAX RATE HAS TO BE SAVED AND WRITTEN OUT TO        00230000
002400*     THE PARAMETER FOR THESE.                                    00240000
002500*---------------------------------------------------------------- 00250000
002600* 7/26/2001 JACK WICZEK                                           00260000
002700*     INCLUDE TAX RATE INFORMATION FOR CLOSED/RELOCATED STORES    00270000
002800      ON THE SALES TAX PARAMETER FILE SENT TO EXISTING STORES.    00280000
002900*---------------------------------------------------------------- 00290000
002600* 5/03/2010 JILL ZIMBAL                                           00291065
002700*     ADDING TAX GROUP ID OF 5 TO THE PROGRAM                S    00292065
002900*---------------------------------------------------------------- 00294065
003000**********************************************************        00300000
003100 ENVIRONMENT DIVISION.                                            00310000
003200**********************************************************        00320000
003300                                                                  00330000
003400 CONFIGURATION SECTION.                                           00340000
003500                                                                  00350000
003600 SOURCE-COMPUTER. IBM-3090.                                       00360000
003700 OBJECT-COMPUTER. IBM-3090.                                       00370000
003800                                                                  00380000
003900 INPUT-OUTPUT SECTION.                                            00390000
004000                                                                  00400000
004100  FILE-CONTROL.                                                   00410000
004200      SELECT DATE-CONTROL-FILE                                    00420000
004300          ASSIGN TO INP01.                                        00430000
004400                                                                  00440000
004500      SELECT PARAMETER-FILE                                       00450000
004600             ASSIGN TO OUT01.                                     00460000
004700                                                                  00470000
004800      SELECT UPDATE-FILE                                          00480000
004900             ASSIGN TO OUT02.                                     00490000
005000                                                                  00500000
005100*********************************************************         00510000
005200 DATA DIVISION.                                                   00520000
005300*********************************************************         00530000
005400 FILE SECTION.                                                    00540000
005500*----------------------------------------------------------       00550000
005600* DATE CONTROL FILE INP01                                         00560000
005700*----------------------------------------------------------       00570000
005800 FD  DATE-CONTROL-FILE                                            00580000
005900     RECORDING MODE IS F                                          00590000
006000     BLOCK CONTAINS 0 CHARACTERS                                  00600000
006100     LABEL RECORDS ARE STANDARD.                                  00610000
006200                                                                  00620000
006300 01 DATE-CONTROL-REC                  PIC  X(80).                 00630000
006400                                                                  00640000
006500*----------------------------------------------------------       00650000
006600* PARAMETER FILE OUT01                                            00660000
006700*----------------------------------------------------------       00670000
006800 FD  PARAMETER-FILE                                               00680000
006900     RECORDING MODE IS F                                          00690000
007000     LABEL RECORDS ARE STANDARD                                   00700000
007100     BLOCK CONTAINS 0 RECORDS                                     00710000
007200     RECORD CONTAINS 200 CHARACTERS                               00720000
007300     DATA RECORD IS PARAMETER-RECORD.                             00730000
007400                                                                  00740000
007500 01  PARAMETER-RECORD            PIC X(200).                      00750000
007600                                                                  00760000
007700 FD  UPDATE-FILE                                                  00770000
007800     RECORDING MODE IS F                                          00780000
007900     LABEL RECORDS ARE STANDARD                                   00790000
008000     BLOCK CONTAINS 0 RECORDS                                     00800000
008100     RECORD CONTAINS 80 CHARACTERS                                00810000
008200     DATA RECORD IS UPDATE-RECORD.                                00820000
008300                                                                  00830000
008400 01  UPDATE-RECORD               PIC X(80).                       00840000
008500                                                                  00850000
008700**********************************************************        00870000
008800 WORKING-STORAGE SECTION.                                         00880000
008900**********************************************************        00890000
009000 01  PC-PROGRAM-CONSTANTS.                                        00900000
009100     05  PC-PROGRAM-NAME         PIC X(08)    VALUE 'TXKUP001'.   00910000
013060     05  PC-MAX-NEW-TAX-RATES    PIC 9(01)    VALUE 9.            00912017
013150     05  PC-MAX-NEW-STORES       PIC 9(03)    VALUE 500.          00913064
009200                                                                  00920000
009300 01  PV-PROGRAM-VARIABLES.                                        00930000
009400     05  PV-FULL-TAX-RATE        PIC S9(1)V9(5) COMP-3 VALUE ZERO.00940009
009500     05  PV-TEMP-TX-RT-PCT       PIC S9(1)V9(5) COMP-3 VALUE ZERO.00950009
009800     05  PV-SAVE-STORE-NBR       PIC S9(4)    COMP VALUE ZERO.    00980000
009900     05  PV-NEXT-TAX-CD-CHAR     PIC X(1)     VALUE SPACES.       00990000
010000     05  PV-NEXT-TAX-CD          PIC 9(1)     VALUE 1.            01000000
010100     05  PV-TEMP-THRS-DNUM       PIC 9(7)     VALUE ZERO.         01010000
010200     05  PV-TEMP-THRS-DCHAR      PIC X(7)     VALUE '0000000'.    01020000
010300     05  PV-TEMP-RATE-ABOVE-T    PIC X(5)     VALUE ZERO.         01030000
010400     05  PV-TEMP-RATE-BELOW-T    PIC X(5)     VALUE ZERO.         01040000
010500     05  PV-TEMP-RATE-NUM        PIC 9(6)     VALUE ZERO.         01050000
010600     05  PV-TEMP-RATE-CHAR       PIC X(6)     VALUE SPACES.       01060000
010700     05  PV-PARAGRAPH-NAME       PIC X(30)    VALUE SPACES.       01070000
010800     05  PV-DB2-OPERATION        PIC X(40)    VALUE SPACES.       01080058
012300     05  PV-OPERATION-MSG-1      PIC  X(45)   VALUE SPACE.        01081036
010900     05  PV-COMMIT-TIMESTAMP     PIC X(26)    VALUE SPACES.       01090000
011000     05  PV-CURRENT-TIMESTAMP    PIC X(26)    VALUE SPACES.       01100000
011100     05  PV-INPUT-DATE           PIC X(10)    VALUE SPACES.       01110000
011200     05  PV-INDATE-MINUS-ONE     PIC X(10)    VALUE SPACES.       01120000
011300     05  PV-UPDATE-MESSAGE       PIC X(40)    VALUE SPACES.       01130000
011400        88 PV-UPDATE-REQUIRED                 VALUE               01140000
011500           'UPDATES WERE MADE IN PARAMETER FILE: '.               01150000
011600        88 PV-NO-UPDATE-REQUIRED              VALUE               01160000
011700           'NO UPDATES WERE MADE IN PARAMETER FILE:'.             01170000
013050     05  PV-WORKING-GROUP-NBR    PIC 9(01)    VALUE ZERO.         01171026
013050     05  PV-MAX-TAX-GROUP-NBR    PIC 9(01)    VALUE ZERO.         01172040
011800                                                                  01180000
011900*--------------------------------------------------------         01190000
012000* TAX PARAMETER VARIABLES                                         01200000
012100*--------------------------------------------------------         01210000
012200     05  PV-PTAX-STORE-NBR       PIC 9(4)     VALUE ZERO.         01220002
012300     05  PV-PTAX-ROUNDING-MTHD   PIC X(1)     VALUE '1'.          01230000
012400     05  PV-PTAX-CODE-INDICATOR  PIC X(1)     VALUE '1'.          01240000
012500     05  PV-PTAX-RATE            PIC X(5)     VALUE '00000'.      01250000
012600     05  PV-PTAX-THRS-DOLLAR     PIC X(6)     VALUE '000000'.     01260000
012700     05  PV-PTAX-ALT-POINTER     PIC X(1)     VALUE SPACES.       01270000
012800     05  PV-PTAX-DISCOUNT-IND    PIC X(1)     VALUE '2'.          01280000
012900     05  PV-PARAM-TO-WRITE       PIC X(200)   VALUE SPACES.       01290000
013000     05  PV-TEMP-PARAMETER       PIC X(200)   VALUE SPACES.       01300000
013100                                                                  01310000
013200*--------------------------------------------------------         01320000
013300* END OF FILE CHARACTER HEX '3F' = CTRL-Z IN ASCII                01330000
013400*--------------------------------------------------------         01340000
013500     05  PV-EOF-HEX-3F           PIC X(1)     VALUE ''.          01350000
013600                                                                  01360000
013700                                                                  01370000
013800 01  NULL-IND-VARIABLES.                                          01380000
013900     05  IND-LAST-UPD-TMST       PIC S9(4) COMP.                  01390000
014100*----------------------------------------------------------       01410000
014200* CONTROL CARD DATE - SCHEDULED DATE                              01420000
014300*----------------------------------------------------------       01430000
014400 01 CD-CONTROL-DATE.                                              01440000
014500    05 CD-DATE.                                                   01450000
014600       10 CD-SCHED-CC                 PIC  X(02) VALUE SPACES.    01460000
014700       10 CD-SCHED-DATE.                                          01470000
014800          15 CD-SCHED-YY              PIC  X(02) VALUE SPACES.    01480000
014900          15 CD-SCHED-MM              PIC  X(02) VALUE SPACES.    01490000
015000          15 CD-SCHED-DD              PIC  X(02) VALUE SPACES.    01500000
015100    05 FILLER                         PIC  X(70) VALUE SPACES.    01510000
015200                                                                  01520000
015300                                                                  01530000
015400*---------------------------------------------------------        01540000
015500* TAX CODE RATE LOOKUP TABLE                                      01550000
015600*---------------------------------------------------------        01560000
015700 01  PT-TAX-RATE-TABLE.                                           01570000
015800     05  PT-TAX-RATES              OCCURS 9 TIMES                 01580000
015900                                   INDEXED BY TR-INDEX.           01590000
016000         10  PT-TAX-CODE-NBR       PIC X(01)      VALUE SPACES.   01600000
016100         10  PT-TAX-RATE           PIC X(05)      VALUE SPACES.   01610000
016110                                                                  01611017
016120*---------------------------------------------------------------* 01612017
016130* TABLE TO STORE TAX RATE INFO TO BE WRITTEN TO THE TAXRATE FILE* 01613017
016140*---------------------------------------------------------------* 01614017
016150 01  TAX-RATE-INFO-TABLE.                                         01615017
016160     05  TAX-RATE-INFO            OCCURS 9 TIMES                  01615117
016170                                  INDEXED BY TAX-INDEX.           01615218
012400         10  TX-PTAX-CODE-INDICATOR   PIC 9(01)    VALUE ZERO.    01615320
012410         10  FILLER REDEFINES TX-PTAX-CODE-INDICATOR.             01615420
012420             15 TX-PTAX-CODE-IND-CHAR PIC X(01).                  01615520
012500         10  TX-PTAX-RATE             PIC X(05)    VALUE '00000'. 01615620
012800                                                                  01615717
012900 01  NEW-STORE-TABLE.                                             01615853
013000     05  NEW-STORE-INFO           OCCURS 500 TIMES                01615964
013100                                  INDEXED BY STORE-INDEX.         01616054
013200         10  STORE-NUMBER             PIC 9(04)    VALUE ZERO.    01617053
013250         10  STORE-OCPNC-DTE          PIC X(10)    VALUE SPACE.   01617159
013300                                                                  01618053
016200*---------------------------------------------------------        01620000
016300* PROGRAM SWITCHES                                                01630000
016400*---------------------------------------------------------        01640000
016500 01  PS-PROGRAM-SWITCHES.                                         01650000
016600     05  PS-EOF-TAX-RATE-CURSOR-SW    PIC X(01)  VALUE SPACES.    01660000
016700         88  PS-EOF-TAX-RATE-CURSOR              VALUE 'Y'.       01671048
016600     05  PS-EOF-NEW-STORE-CURSOR-SW   PIC X(01)  VALUE 'N'.       01672048
016700         88  PS-EOF-NEW-STORE-CURSOR             VALUE 'Y'.       01673048
016800     05  PS-RATE-MATCH-SW             PIC X(01)  VALUE SPACES.    01680000
016900         88  PS-RATE-MATCH-FOUND                 VALUE 'Y'.       01690000
017000         88  PS-RATE-NOT-FOUND                   VALUE 'N'.       01700000
017100     05  PS-END-OF-NEW-TAX-RATES-SW   PIC X(01)  VALUE SPACES.    01710031
017200         88  PS-END-OF-NEW-TAX-RATES             VALUE 'Y'.       01720031
017300*---------------------------------------------------------        01730000
017400* ABEND CODE                                                      01740000
017500*---------------------------------------------------------        01750000
017600 01  ABEND-CODE                       PIC S9(04) VALUE +0.        01760000
009000     88  AC-DATE-ERROR                           VALUE +4003.     01761037
009300     88  AC-TABLE-OVERFLOW-ERROR                 VALUE +4004.     01761159
009200     88  AC-DB2-ERROR                            VALUE +4013.     01761259
009100     88  AC-ALT-POINTER-ERROR                    VALUE +4014.     01762040
017700                                                                  01770000
017800*---------------------------------------------------------        01780005
017900*  PROGRAM ACCUMULATORS.                                          01790005
018000*---------------------------------------------------------        01800005
018100 01  PA-PROGRAM-ACCUMULATORS.                                     01810005
018200     05  PA-TX-RTE-CNT         PIC S9(4) COMP VALUE ZERO.         01820006
018300     05  PA-RECS-WRITTEN       PIC S9(4) COMP VALUE ZERO.         01830006
018400                                                                  01840005
018500*---------------------------------------------------------        01850000
018600*  DB2 TABLE DB2PDBA.TTXRTLO - TAX RATES FOR STORE TAX GROUPS     01860000
018700*---------------------------------------------------------        01870000
018800     EXEC SQL                                                     01880000
018900           INCLUDE TTXRTLO                                        01890000
019000     END-EXEC.                                                    01900000
018500*---------------------------------------------------------        01901016
018600*  DB2 TABLE DB2PDBA.TTXGP - TAX GROUPINGS FOR STORE TAX          01902016
018700*---------------------------------------------------------        01903016
018800     EXEC SQL                                                     01904016
018900           INCLUDE TTXGP                                          01905016
019000     END-EXEC.                                                    01906016
019100*---------------------------------------------------------        01910000
019200*  DB2 TABLE DB2PDBA.XST_LOC - STORE TABLE                        01920001
019300*---------------------------------------------------------        01930000
019400     EXEC SQL                                                     01940000
019500           INCLUDE XST00001                                       01950001
019600     END-EXEC.                                                    01960000
019700*---------------------------------------------------------        01970000
019800*  DB2 TABLE DB2PDBA.TSTATE - STATE TAX RATE TABLE                01980000
019900*---------------------------------------------------------        01990000
020000     EXEC SQL                                                     02000000
020100           INCLUDE TSTATE                                         02010000
020200     END-EXEC.                                                    02020000
020400*---------------------------------------------------------        02040000
020500*  CURSOR USED TO GET ALL CURRENT TAX RATES FOR ALL STORES.       02050000
020600*---------------------------------------------------------        02060000
020700     EXEC SQL                                                     02070000
020800       DECLARE TAX-RATE-CURSOR CURSOR WITH HOLD FOR               02080000
020900         SELECT A.LOC_NBR                                         02090001
021000               ,A.OPN_DTE                                         02100001
021100               ,T.TX_GP_ITM_ID                                    02110000
021200               ,T.TX_TYP_CDE                                      02120000
021300               ,T.EFF_BEG_DTE                                     02130000
021500               ,T.TX_RT_PCT                                       02150000
021600               ,T.ABV_THRS_FTX_IND                                02160000
021700               ,T.THRS_DOL_AMT                                    02170000
021800               ,T.BLW_THRS_TX_RT_PCT                              02180000
021900               ,T.BLW_THRS_FTX_IND                                02190000
022000               ,T.POS_ASG_TX_ID                                   02200000
022100               ,T.LAST_UPD_TMST                                   02210000
022200               ,S.ST_TX_RND_MTHD_CDE                              02220000
022300          FROM XST_LOC A,                                         02230014
022400               TTXRTLO T,                                         02240014
022600               TSTATE S                                           02241014
022500         WHERE A.LOC_NBR = T.STR_NBR                              02250014
022700           AND S.STATE_CODE = A.ST_CDE                            02270014
023100           AND A.LOC_TYP_CDE = 'DS'                               02271014
022800           AND T.EFF_BEG_DTE = (SELECT MAX(R.EFF_BEG_DTE)         02280014
022900                                  FROM TTXRTLO R                  02290014
023000                                 WHERE R.STR_NBR = T.STR_NBR      02300014
023100                                   AND R.TX_GP_ITM_ID =           02310014
023110                                               T.TX_GP_ITM_ID     02311014
023120                                   AND R.EFF_BEG_DTE <=           02312014
023130                                               :PV-INPUT-DATE)    02313014
023200         ORDER BY A.LOC_NBR, T.TX_GP_ITM_ID                       02320031
023250          WITH UR                                                 02321031
023300     END-EXEC.                                                    02330000
023400                                                                  02340000
023410*--------------------------------------------------------*        02341048
023420* CURSOR USED TO EXTRACT NEW STORES                      *        02342048
023430*--------------------------------------------------------*        02343048
023440     EXEC SQL                                                     02344048
023450       DECLARE NEW-STORE-CURSOR CURSOR FOR                        02345048
023460         SELECT LOC_NBR,                                          02346059
023462                OCPNC_DTE                                         02346159
023465           FROM XST_LOC                                           02347048
023472          WHERE OCPNC_DTE < '9999-09-09'                          02347259
023474            AND LOC_TYP_CDE = 'DS'                                02347351
023475            AND LOC_NBR NOT IN (SELECT STR_NBR                    02348048
023480                                  FROM TTXRTLO)                   02349048
023485          ORDER BY LOC_NBR                                        02349148
023490           WITH UR                                                02349248
023495     END-EXEC.                                                    02349348
023497                                                                  02349448
023500*---------------------------------------------------------        02350000
023600* STANDARD LAYOUT FOR THE SQL COMMUNCATIONS AREA                  02360000
023700*---------------------------------------------------------        02370000
023800     EXEC SQL                                                     02380000
023900         INCLUDE SQLCA                                            02390000
024000     END-EXEC.                                                    02400000
024100                                                                  02410000
024200*----------------------------------------------------------------*02420000
024300*    STANDARD DB/2 DCLGEN FOR THE CHECKPOINT RESTART TABLE       *02430000
024400*----------------------------------------------------------------*02440000
024500     EXEC SQL                                                     02450000
024600         INCLUDE TCKRSTCN                                         02460000
024700     END-EXEC.                                                    02470000
024800                                                                  02480000
024900*---------------------------------------------------------        02490000
025000* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         02500000
025100*---------------------------------------------------------        02510000
025200     COPY DPWS004.                                                02520000
025300                                                                  02530000
025400*----------------------------------------------------------       02540000
025500* WORKING STORAGE FOR DPKUT500 INTERFACE                          02550000
025600*----------------------------------------------------------       02560000
025700     COPY DPWS500.                                                02570000
025800                                                                  02580000
025900**********************************************************        02590000
026000 PROCEDURE DIVISION.                                              02600000
026100**********************************************************        02610000
026200***********************************************************       02620000
026300 0000-MAINLINE.                                                   02630000
026400***********************************************************       02640000
026500     PERFORM 1000-INITIALIZE.                                     02650000
026600                                                                  02660000
026700     PERFORM 2000-PROCESS-TAX-RATE                                02670000
026800       UNTIL PS-EOF-TAX-RATE-CURSOR.                              02680000
026900                                                                  02690000
027000     PERFORM 6000-WRITE-UPDATE-FILE.                              02700000
027100                                                                  02710000
027200     PERFORM 9000-FINISH.                                         02720000
027300                                                                  02730000
027400     GOBACK.                                                      02740006
027500                                                                  02750000
027600*000-EXIT.                                                        02760000
027700                                                                  02770000
027800***********************************************************       02780000
027900 1000-INITIALIZE.                                                 02790000
028000***********************************************************       02800000
028100     DISPLAY '******* MESSAGES FOR '                              02810006
028200              PC-PROGRAM-NAME ' *******'                          02820006
028300                                                                  02830006
028400     OPEN INPUT  DATE-CONTROL-FILE                                02840006
028500          OUTPUT PARAMETER-FILE                                   02850006
028600                 UPDATE-FILE.                                     02860006
028700                                                                  02870000
028800     SET PV-NO-UPDATE-REQUIRED TO TRUE.                           02880000
028900                                                                  02890000
029000     PERFORM 8600-GET-COMMIT-TIMESTAMP.                           02900000
029100                                                                  02910006
029200     READ DATE-CONTROL-FILE                                       02920000
029300       AT END                                                     02930000
029400         DISPLAY ' '                                              02940000
029500         DISPLAY '** ABEND     **'                                02950000
029600         DISPLAY '** PROGRAM   **  = ' PC-PROGRAM-NAME            02960000
029700         DISPLAY '** PARAGRAPH **'                                02970000
029800          '= 1000-INITIALIZE'                                     02980000
029900         DISPLAY '** DATE CONTROL RECORD IS MISSING'              02990000
030000         SET AC-DATE-ERROR TO TRUE                                03000037
030100         CALL 'ILBOABN0' USING ABEND-CODE                         03010000
030200     END-READ.                                                    03020000
030300                                                                  03030000
030400     MOVE DATE-CONTROL-REC TO CD-CONTROL-DATE.                    03040000
030500     PERFORM 1100-VERIFY-DATE.                                    03050000
030600     DISPLAY PC-PROGRAM-NAME ' DATE CONTROL DATE: '               03060000
030700      CD-DATE.                                                    03070000
030800                                                                  03080000
030900     MOVE DPG55-DB2-ISO-DATE-FMT TO PV-INPUT-DATE.                03090013
031000     DISPLAY  ' *** INPUT DATE: ' PV-INPUT-DATE.                  03100000
031100                                                                  03110000
031200     PERFORM 1200-SUBTRACT-ONE-FROM-DATE.                         03120000
031210                                                                  03120148
031250     PERFORM 1500-PROCESS-NEW-STORE-ENTRY.                        03121048
031260                                                                  03122048
031300     PERFORM 1300-OPEN-TAX-RATE-CSR.                              03130006
031400     PERFORM 2100-FETCH-TAX-RATE.                                 03140005
031500     PERFORM 1400-GET-MAX-TAX-GROUP.                              03141019
031560                                                                  03157016
031600*1000-EXIT                                                        03160000
031700                                                                  03170000
031800*----------------------------------------------------------       03180000
031900* 1100-VERIFY-DATE.                                               03190000
032000*----------------------------------------------------------       03200000
032100 1100-VERIFY-DATE.                                                03210000
032200                                                                  03220000
032300     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         03230000
032400     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03240000
032500     SET DPG52-LK-DTE-ISO            TO TRUE.                     03250000
032600     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     03260000
032700                                                                  03270000
032800     MOVE CD-DATE TO DPG52-DB2-ISO-DATE.                          03280000
032900                                                                  03290000
033000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            03300000
033100          USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03310000
033200                                                                  03320000
033300     EVALUATE TRUE                                                03330000
033400         WHEN DPG54-NO-ERROR                                      03340000
033500             CONTINUE                                             03350000
033600         WHEN OTHER                                               03360000
033700             DISPLAY '** ABEND **'                                03370000
033800             DISPLAY PC-PROGRAM-NAME          ' - INVALID     '   03380000
033900                       'CONTROL CARD DATE'                        03390040
034000             DISPLAY ' DATE CONTROL DATE: '                       03400000
034100             CD-DATE                                              03410000
034200             SET AC-DATE-ERROR TO TRUE                            03420037
034300             CALL 'ILBOABN0' USING ABEND-CODE                     03430000
034400     END-EVALUATE.                                                03440000
034500                                                                  03450000
034600*1100-EXIT.                                                       03460000
034700*----------------------------------------------------------       03470000
034800* 1200-SUBTRACT-ONE-FROM-DATE.                                    03480000
034900*----------------------------------------------------------       03490000
035000 1200-SUBTRACT-ONE-FROM-DATE.                                     03500000
035100                                                                  03510000
035200     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         03520000
035300     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     03530000
035400     SET DPG52-LK-DTE-ISO            TO TRUE.                     03540000
035500     SET DPG51-DECREMENT-DATE        TO TRUE.                     03550000
035600     MOVE 1 TO DPG51-INCR-DECR-DAYS-9.                            03560000
035700                                                                  03570000
035800     MOVE CD-DATE TO DPG52-DB2-ISO-DATE.                          03580000
035900                                                                  03590000
036000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            03600000
036100          USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03610000
036200                                                                  03620000
036300     EVALUATE TRUE                                                03630000
036400         WHEN DPG54-NO-ERROR                                      03640000
036500             MOVE DPG55-DB2-ISO-DATE-FMT TO PV-INDATE-MINUS-ONE   03650013
036600             DISPLAY "INPUT DATE MINUS ONE="                      03660000
036700                 PV-INDATE-MINUS-ONE                              03670000
036800         WHEN OTHER                                               03680000
036900             DISPLAY '** ABEND **'                                03690000
037000             DISPLAY PC-PROGRAM-NAME          ' - INVALID     '   03700000
037100                       'CONTROL CARD DATE'                        03710040
037200             DISPLAY ' DATE CONTROL DATE: '                       03720000
037300             CD-DATE                                              03730000
037400             SET AC-DATE-ERROR TO TRUE                            03740037
037500             CALL 'ILBOABN0' USING ABEND-CODE                     03750000
037600     END-EVALUATE.                                                03760000
037700                                                                  03770000
037800*1200-EXIT.                                                       03780000
037900                                                                  03790006
038000***********************************************************       03800006
038100 1300-OPEN-TAX-RATE-CSR.                                          03810006
038200***********************************************************       03820006
038300                                                                  03830006
038400     EXEC SQL                                                     03840006
038500         OPEN TAX-RATE-CURSOR                                     03850006
038600     END-EXEC.                                                    03860006
038700                                                                  03870006
038800     EVALUATE SQLCODE                                             03880006
038900         WHEN ZERO                                                03890006
039000             CONTINUE                                             03900006
039100         WHEN OTHER                                               03910006
039200             MOVE '1000-INITIALIZE'     TO PV-PARAGRAPH-NAME      03920006
039300             MOVE 'OPEN TAX-RATE-CURSOR CURSOR'                   03930006
039400                                        TO PV-DB2-OPERATION       03940006
039500             PERFORM 9900-SQL-ABEND                               03950013
039600     END-EVALUATE.                                                03960006
039700                                                                  03970006
039710*--------------------------------------------------------------*  03971019
039720* GET THE MAXIMUM TAX GROUP NUMBER FROM THE TTXGP TABLE        *  03972019
039730*--------------------------------------------------------------*  03973019
039740 1400-GET-MAX-TAX-GROUP.                                          03974019
039910                                                                  03975021
031510     EXEC SQL                                                     03976021
031520         SELECT MAX(TX_GP_ITM_ID)                                 03977021
031530           INTO :TXGP-TX-GP-ITM-ID                                03978021
031540           FROM TTXGP                                             03979021
031545           WITH UR                                                03979121
031550     END-EXEC.                                                    03979221
031560                                                                  03979321
031570     EVALUATE SQLCODE                                             03979421
031580         WHEN ZERO                                                03979521
031590             MOVE TXGP-TX-GP-ITM-ID TO PV-MAX-TAX-GROUP-NBR       03979640
100700         WHEN OTHER                                               03979821
100900             MOVE '1000-INITIALIZE' TO PV-PARAGRAPH-NAME          03979921
101100             MOVE 'ERROR ON GETTING MAX TAX GROUP NBR'            03980021
101200                                   TO PV-DB2-OPERATION            03980121
101300             PERFORM 9900-SQL-ABEND                               03980221
101400     END-EVALUATE.                                                03980321
101500                                                                  03980421
101510***********************************************************       03980548
101520* 1500-PROCESS-NEW-STORE-ENTRY                            *       03980648
101525* INSERT A DEFAULT TAX RATE OF 5 PERCENT TO BE USED TO SET*       03980748
101527* UP THE REGISTER FOR NEW STORES. A RATE WILL ONLY BE     *       03980848
101528* ADDDED WHEN THERE IS NO ENTRY FOR THE STORE IN THE      *       03980948
101529* TTXRTLO TABLE.                                          *       03981048
101530***********************************************************       03981148
101540 1500-PROCESS-NEW-STORE-ENTRY.                                    03981248
101600                                                                  03981348
101700     PERFORM 1600-OPEN-NEW-STORE-CURSOR.                          03981448
101710                                                                  03981554
101720     SET STORE-INDEX TO +1.                                       03981654
101730                                                                  03981754
101800     PERFORM 1800-FETCH-NEW-STORE-CURSOR.                         03981859
101801     PERFORM 1850-SAVE-NEW-STORES                                 03981959
101810       UNTIL PS-EOF-NEW-STORE-CURSOR.                             03982053
102050                                                                  03982156
102100     PERFORM 1900-CLOSE-NEW-STORE-CURSOR.                         03982256
101850                                                                  03982348
101900     PERFORM 1700-PROCESS-NEW-STORE                               03982448
101910     VARYING STORE-INDEX FROM 1 BY 1                              03982553
102000       UNTIL STORE-NUMBER(STORE-INDEX) = ZEROES                   03982659
102100          OR STORE-INDEX > PC-MAX-NEW-STORES.                     03982759
102200                                                                  03982848
038000***********************************************************       03982948
038100*1600-OPEN-NEW-STORE-CURSOR.                              *       03983048
038200***********************************************************       03983148
038250 1600-OPEN-NEW-STORE-CURSOR.                                      03983248
038300                                                                  03983348
038400     EXEC SQL                                                     03983448
038500         OPEN NEW-STORE-CURSOR                                    03983548
038600     END-EXEC.                                                    03983648
038700                                                                  03983748
038800     EVALUATE SQLCODE                                             03983848
038900         WHEN ZERO                                                03983948
039000             CONTINUE                                             03984048
039100         WHEN OTHER                                               03984148
039200             MOVE '1600-OPEN-NEW-STORE-CURSOR' TO                 03984249
039210                                             PV-PARAGRAPH-NAME    03984349
039300             MOVE 'OPEN NEW-STORE-CURSOR' TO PV-DB2-OPERATION     03984448
039500             PERFORM 9900-SQL-ABEND                               03984548
039600     END-EVALUATE.                                                03984648
039700                                                                  03984748
039710***********************************************************       03984848
039720* 1700-PROCESS-NEW-STORE                                  *       03984948
039730***********************************************************       03985048
039735 1700-PROCESS-NEW-STORE.                                          03985148
039737                                                                  03985248
039740     MOVE STORE-NUMBER(STORE-INDEX) TO TXRTLO-STR-NBR.            03985354
039745     MOVE 'FT'                      TO TXRTLO-TX-TYP-CDE.         03985454
039746     IF STORE-OCPNC-DTE(STORE-INDEX) > PV-INPUT-DATE              03985559
039747         MOVE STORE-OCPNC-DTE(STORE-INDEX) TO TXRTLO-EFF-BEG-DTE  03985659
039748     ELSE                                                         03985759
039750         MOVE PV-INPUT-DATE                TO TXRTLO-EFF-BEG-DTE  03985859
039751     END-IF.                                                      03985959
039755     MOVE 1                         TO TXRTLO-TX-GP-ITM-ID.       03986054
039760     MOVE 0.05000                   TO TXRTLO-TX-RT-PCT.          03986154
039765     MOVE SPACES                    TO TXRTLO-ABV-THRS-FTX-IND.   03986254
039770     MOVE 0                         TO TXRTLO-THRS-DOL-AMT.       03986354
039775     MOVE SPACES                    TO TXRTLO-BLW-THRS-FTX-IND.   03986454
039780     MOVE '1'                       TO TXRTLO-POS-ASG-TX-ID.      03986554
039785     MOVE PV-COMMIT-TIMESTAMP       TO TXRTLO-LAST-UPD-TMST.      03986657
039790     MOVE PC-PROGRAM-NAME           TO TXRTLO-LAST-UPD-BY-USR-ID. 03986754
039795     MOVE 'F'                       TO TXRTLO-THRS-TX-CDE.        03986854
039796     MOVE 'N'                       TO TXRTLO-TX-HOL-IND.         03986954
039800                                                                  03987048
039900     PERFORM 7000-INSERT-NEW-STORE-INFO.                          03987148
040000                                                                  03988048
023500     MOVE 'TH' TO TXRTLO-TX-TYP-CDE.                              03988158
023600     MOVE 2    TO TXRTLO-TX-GP-ITM-ID.                            03988258
023700     MOVE 'F'  TO TXRTLO-ABV-THRS-FTX-IND.                        03988358
023800     MOVE '2'  TO TXRTLO-POS-ASG-TX-ID.                           03988458
023900                                                                  03988548
023910     PERFORM 7000-INSERT-NEW-STORE-INFO.                          03988658
023920                                                                  03988748
023950     MOVE 3   TO TXRTLO-TX-GP-ITM-ID.                             03989058
023960     MOVE '3' TO TXRTLO-POS-ASG-TX-ID.                            03989158
023970                                                                  03989248
023980     PERFORM 7000-INSERT-NEW-STORE-INFO.                          03989358
023990                                                                  03989448
024020     MOVE 4   TO TXRTLO-TX-GP-ITM-ID.                             03989758
024030     MOVE '4' TO TXRTLO-POS-ASG-TX-ID.                            03989858
024040                                                                  03989948
024050     PERFORM 7000-INSERT-NEW-STORE-INFO.                          03990058
024060                                                                  03990148
024020     MOVE 5   TO TXRTLO-TX-GP-ITM-ID.                             03990265
024030     MOVE '5' TO TXRTLO-POS-ASG-TX-ID.                            03990365
024040                                                                  03990465
024050     PERFORM 7000-INSERT-NEW-STORE-INFO.                          03990565
024060                                                                  03990665
024070     PERFORM 8620-COMMIT.                                         03990765
024400                                                                  03991948
024700***********************************************************       03992248
024800* 1800-FETCH-NEW-STORE-CURSOR                             *       03992348
024900***********************************************************       03992448
025000 1800-FETCH-NEW-STORE-CURSOR.                                     03992548
025100                                                                  03992648
045200     EXEC SQL                                                     03992748
045300       FETCH NEW-STORE-CURSOR                                     03992848
045400         INTO :XST00001-LOC-NBR                                   03992948
045500             ,:XST00001-OCPNC-DTE                                 03993059
046800     END-EXEC.                                                    03993848
046900                                                                  03993948
047000     EVALUATE SQLCODE                                             03994048
047100       WHEN ZERO                                                  03994148
047200           DISPLAY 'NEW STORE SELECTED: ' XST00001-LOC-NBR        03994348
047300       WHEN +100                                                  03994448
047400           SET PS-EOF-NEW-STORE-CURSOR TO TRUE                    03994548
047900       WHEN OTHER                                                 03994948
048000         MOVE '1800-FETCH-NEW-STORE-CURSOR'                       03995048
048100           TO PV-PARAGRAPH-NAME                                   03995148
048200         MOVE 'FETCH NEW-STORE-CURSOR RECORD'                     03995252
048300           TO PV-DB2-OPERATION                                    03995348
048400         PERFORM 9900-SQL-ABEND                                   03995448
048500     END-EVALUATE.                                                03995548
048600                                                                  03995648
048601                                                                  03995759
048602***************************************************************** 03995859
048603* 1850-SAVE-NEW-STORES                                          * 03995959
048603***************************************************************** 03996059
048604 1850-SAVE-NEW-STORES.                                            03996159
068605                                                                  03996259
130000     IF STORE-INDEX > PC-MAX-NEW-STORES                           03996359
130100         MOVE '1850-SAVE-NEW-STORES ' TO PV-PARAGRAPH-NAME        03996459
130200         MOVE 'NEW STORE TABLE EXCEED MAXIMUM ENTRIES '           03996559
130300                                         TO PV-OPERATION-MSG-1    03996659
130400         SET AC-TABLE-OVERFLOW-ERROR     TO TRUE                  03996759
130500         PERFORM 9999-ABEND                                       03996859
130600     END-IF.                                                      03996959
047150     MOVE XST00001-LOC-NBR   TO STORE-NUMBER(STORE-INDEX).        03997059
047150     MOVE XST00001-OCPNC-DTE TO STORE-OCPNC-DTE(STORE-INDEX).     03997159
068606                                                                  03997259
048610     SET STORE-INDEX UP BY +1.                                    03997359
048620                                                                  03997459
048630     PERFORM 1800-FETCH-NEW-STORE-CURSOR.                         03997559
048640                                                                  03997659
048700***********************************************************       03997759
048800* 1900-CLOSE-NEW-STORE-CURSOR                             *       03997859
048900***********************************************************       03997959
049000 1900-CLOSE-NEW-STORE-CURSOR.                                     03998059
049100                                                                  03998159
081000     EXEC SQL                                                     03998259
081100         CLOSE NEW-STORE-CURSOR                                   03998359
081200     END-EXEC.                                                    03998459
081300                                                                  03998559
081400     EVALUATE TRUE                                                03998659
081500       WHEN SQLCODE NOT = +0                                      03998759
081600         MOVE '1900-CLOSE-NEW-STORE-CURSOR' TO PV-PARAGRAPH-NAME  03998859
081800         MOVE 'CLOSE NEW-STORE CURSOR'      TO PV-DB2-OPERATION   03998959
082000         PERFORM 9900-SQL-ABEND                                   03999059
082100     END-EVALUATE.                                                03999159
082200                                                                  03999259
039800***********************************************************       03999359
039900 2000-PROCESS-TAX-RATE.                                           03999459
040000***********************************************************       04000000
040100                                                                  04010000
040200***** IF TAX RATES CHANGED OR BECAME EFFECTIVE,                   04020000
040300***** SET UPDATE FLAG TO TRUE                                     04030000
040400                                                                  04040000
040500     IF ((TXRTLO-LAST-UPD-TMST(1:10) = PV-INDATE-MINUS-ONE)       04050005
040600        OR (TXRTLO-LAST-UPD-TMST(1:10) = PV-INPUT-DATE)           04060005
040700        OR (XST00001-OPN-DTE = PV-INPUT-DATE)                     04070005
040800        OR (TXRTLO-EFF-BEG-DTE = PV-INPUT-DATE))                  04080005
040900          SET PV-UPDATE-REQUIRED TO TRUE                          04090005
041000     END-IF                                                       04100005
041100                                                                  04110000
041200****** SAVE FULL TAX RATE *********                               04120000
041300     IF TXRTLO-TX-TYP-CDE = "FT"                                  04130005
041400          MOVE TXRTLO-TX-RT-PCT TO PV-FULL-TAX-RATE               04140000
041500     END-IF                                                       04150038
041600                                                                  04160000
041700******** WHEN A NEW STORE NUMBER HAS BEEN READ,                   04170000
041800******** WRITE OUT THE PARAMETER FOR THE PREVIOUS STORE AND       04180000
041900******** RE-INIT THE TAX RATE ARRAY                               04190000
042000                                                                  04200000
042100     IF PV-SAVE-STORE-NBR < XST00001-LOC-NBR                      04210038
042200         IF PV-SAVE-STORE-NBR > ZERO                              04220038
042210             PERFORM 4300-CHECK-NEW-TAXRATES                      04221038
042220             VARYING TAX-INDEX FROM 1 BY 1                        04222038
042230               UNTIL TAX-INDEX > PC-MAX-NEW-TAX-RATES             04223017
042235                  OR PS-END-OF-NEW-TAX-RATES                      04223131
042300             MOVE SPACES TO PARAMETER-RECORD                      04230038
042400             MOVE PV-PARAM-TO-WRITE TO PARAMETER-RECORD           04240038
042500             WRITE PARAMETER-RECORD                               04250038
042600             MOVE SPACES TO PV-PARAM-TO-WRITE                     04260038
042700             ADD +1 TO PA-RECS-WRITTEN                            04270038
042800         END-IF                                                   04280038
042900         PERFORM 2200-INIT-TX-RTE-ARRAY                           04290038
043000     END-IF                                                       04300038
043100                                                                  04310000
043200     PERFORM 4000-CREATE-PARAMETER                                04320038
044000                                                                  04400005
044100     PERFORM 2100-FETCH-TAX-RATE.                                 04410005
044200                                                                  04420005
044300*2000-EXIT.                                                       04430000
044400                                                                  04440000
044500 2100-FETCH-TAX-RATE.                                             04450005
044600                                                                  04460005
044700     MOVE ZERO TO IND-LAST-UPD-TMST.                              04470015
044900     MOVE SPACES TO TXRTLO-LAST-UPD-TMST.                         04490015
045100                                                                  04510005
045200     EXEC SQL                                                     04520005
045300       FETCH TAX-RATE-CURSOR                                      04530005
045400         INTO :XST00001-LOC-NBR                                   04540005
045500             ,:XST00001-OPN-DTE                                   04550005
045600             ,:TXRTLO-TX-GP-ITM-ID                                04560005
045700             ,:TXRTLO-TX-TYP-CDE                                  04570005
045800             ,:TXRTLO-EFF-BEG-DTE                                 04580005
046000             ,:TXRTLO-TX-RT-PCT                                   04600005
046100             ,:TXRTLO-ABV-THRS-FTX-IND                            04610005
046200             ,:TXRTLO-THRS-DOL-AMT                                04620005
046300             ,:TXRTLO-BLW-THRS-TX-RT-PCT                          04630005
046400             ,:TXRTLO-BLW-THRS-FTX-IND                            04640005
046500             ,:TXRTLO-POS-ASG-TX-ID                               04650005
046600             ,:TXRTLO-LAST-UPD-TMST:IND-LAST-UPD-TMST             04660005
046700             ,:TSTATE-ST-TX-RND-MTHD-CDE                          04670005
046800     END-EXEC.                                                    04680005
046900                                                                  04690005
047000     EVALUATE SQLCODE                                             04700005
047100       WHEN ZERO                                                  04710005
047200           ADD +1 TO PA-TX-RTE-CNT                                04720005
047300       WHEN +100                                                  04730007
047400           MOVE 'Y' TO PS-EOF-TAX-RATE-CURSOR-SW                  04740005
047500                                                                  04750005
047600*-------------------------------------------------------------*   04760005
047700* PROCESS SQL READ ERROR                                      *   04770005
047800*-------------------------------------------------------------*   04780005
047900       WHEN OTHER                                                 04790005
048000         MOVE '2100-FETCH-TAX-RATE'                               04800005
048100           TO PV-PARAGRAPH-NAME                                   04810005
048200         MOVE 'FETCH A TAX-RATE-CURSOR RECORD'                    04820005
048300           TO PV-DB2-OPERATION                                    04830005
048400         PERFORM 9900-SQL-ABEND                                   04840013
048500     END-EVALUATE.                                                04850005
048600                                                                  04860005
048700 2200-INIT-TX-RTE-ARRAY.                                          04870005
048800                                                                  04880005
048900     MOVE XST00001-LOC-NBR  TO PV-SAVE-STORE-NBR                  04890013
049000                               PV-PTAX-STORE-NBR.                 04900013
049020     MOVE PV-MAX-TAX-GROUP-NBR TO PV-WORKING-GROUP-NBR.           04902040
049030                                                                  04903016
049100******************************************************************04910005
049200** ROUNDING METHOD IS DIFFERENT ON DATABASE FROM ON PARAMETER.    04920005
049300** ON DATABASE:  5 = ROUND UP WHEN DECIMAL IS GREATER THAN 5.     04930005
049400**               1 = ALWAYS ROUND UP.                             04940005
049500** ON PARAMETER: 1 = ROUND UP WHEN DECIMAL IS GREATHER THAN 5.    04950005
049600**               2 = ALWAYS ROUND UP.                             04960005
049700******************************************************************04970005
049800     EVALUATE TSTATE-ST-TX-RND-MTHD-CDE                           04980005
049900         WHEN '5'                                                 04990005
050000             MOVE '1' TO PV-PTAX-ROUNDING-MTHD                    05000005
050100         WHEN '1'                                                 05010005
050200             MOVE '2' TO PV-PTAX-ROUNDING-MTHD                    05020005
050300         WHEN OTHER                                               05030005
050400             MOVE '1' TO PV-PTAX-ROUNDING-MTHD                    05040005
050500     END-EVALUATE.                                                05050005
050600                                                                  05060005
050700      STRING                                                      05070005
050800          PV-PTAX-STORE-NBR DELIMITED BY SIZE                     05080005
050900          ';' DELIMITED BY SIZE                                   05090005
051000          PV-PTAX-ROUNDING-MTHD DELIMITED BY SIZE                 05100005
051100          ';' DELIMITED BY SIZE                                   05110005
051200          INTO PV-PARAM-TO-WRITE                                  05120005
051300      END-STRING.                                                 05130005
051400                                                                  05140005
051500     INITIALIZE PT-TAX-RATE-TABLE                                 05150031
042240                TAX-RATE-INFO-TABLE                               05151031
042250                PS-END-OF-NEW-TAX-RATES-SW.                       05152031
049025     SET TAX-INDEX TO 1.                                          05153031
051600     MOVE 1 TO PV-NEXT-TAX-CD.                                    05160031
053100     MOVE '2'                 TO PV-PTAX-DISCOUNT-IND.            05170031
051700                                                                  05171016
051800***********************************************************       05180000
051900 4000-CREATE-PARAMETER.                                           05190000
052000***********************************************************       05200000
052100                                                                  05210000
052200*-------------------------------------------------------------*   05220000
052300* UPDATE POS_ASG_TX_ID WITH NEXT ARRAY POSITION               *   05230000
052400*-------------------------------------------------------------*   05240000
052500     MOVE PV-NEXT-TAX-CD       TO PV-NEXT-TAX-CD-CHAR.            05250023
053000     MOVE PV-NEXT-TAX-CD-CHAR  TO PV-PTAX-CODE-INDICATOR.         05300031
053200                                                                  05320000
053300     PERFORM 4100-FORMAT-TAX-RATES.                               05330000
053400                                                                  05340000
053500*-------------------------------------------------------------*   05350000
053600* PROCESS TAX RATE FOR NON-THRESHOLD TAX                      *   05360000
053700*-------------------------------------------------------------*   05370000
                                                                        05373066
053800     IF TXRTLO-TX-TYP-CDE NOT = 'TH'                              05380000
053810        IF TXRTLO-THRS-DOL-AMT > 0                                05381032
053820            MOVE PV-TEMP-RATE-BELOW-T TO PV-PTAX-RATE             05382032
053830            PERFORM 4150-SAVE-ABOVE-THRS-INFO                     05383032
053835            PERFORM 5000-LOAD-PARAMETER                           05383135
053840        ELSE                                                      05384032
053900            MOVE PV-TEMP-RATE-ABOVE-T TO PV-PTAX-RATE             05390032
054000            MOVE SPACES TO PV-PTAX-THRS-DOLLAR                    05400032
054100            MOVE SPACES TO PV-PTAX-ALT-POINTER                    05410032
054200            MOVE PV-PTAX-RATE TO PT-TAX-RATE(PV-NEXT-TAX-CD)      05420032
054400            MOVE PV-NEXT-TAX-CD-CHAR                              05440032
054500                  TO PT-TAX-CODE-NBR(PV-NEXT-TAX-CD)              05450032
054600                                                                  05460000
054700            PERFORM 5000-LOAD-PARAMETER                           05470032
054800                                                                  05480000
054810        END-IF                                                    05481032
054900*-------------------------------------------------------------*   05490000
055000* PROCESS TAX RATE FOR THRESHOLD TAX                          *   05500000
055100*-------------------------------------------------------------*   05510000
055200     ELSE                                                         05520000
055400        MOVE PV-TEMP-RATE-BELOW-T TO PV-PTAX-RATE                 05540000
056400***************************************************************** 05640000
056500*** SEARCH TAX RATE TABLE FOR THRESHOLD RATE ABOVE THRESHOLD **** 05650000
056600***************************************************************** 05660000
056700        SET TR-INDEX TO 1                                         05670000
056800        SEARCH PT-TAX-RATES                                       05680000
056900           AT END MOVE 'N' TO PS-RATE-MATCH-SW                    05690000
057000           WHEN PT-TAX-RATE (TR-INDEX) = PV-TEMP-RATE-ABOVE-T     05700000
057100              MOVE 'Y' TO PS-RATE-MATCH-SW                        05710000
057200        END-SEARCH                                                05720000
057300                                                                  05730000
057400*** IF A PREVIOUS RATE MATCHES THE ABOVE THRESHOLD RATE,          05740000
057500*** FILL ALT-RATE-POINTER AND LOAD DATA INTO PARAMETER.           05750000
057600*** OTHERWISE A NEW RATE MUST BE CREATED.                         05760000
057700                                                                  05770000
057800        IF PS-RATE-MATCH-FOUND                                    05780000
057900           MOVE PT-TAX-CODE-NBR (TR-INDEX) TO                     05790000
058000              PV-PTAX-ALT-POINTER                                 05800000
058100        ELSE                                                      05810000
058200           PERFORM 4150-SAVE-ABOVE-THRS-INFO                      05820033
059100        END-IF                                                    05910000
059200                                                                  05920000
059300        PERFORM 5000-LOAD-PARAMETER                               05930000
059400                                                                  05940000
061100     END-IF.                                                      06110000
061110                                                                  06110131
052600     IF TXRTLO-POS-ASG-TX-ID NOT = PV-NEXT-TAX-CD-CHAR            06111044
052700         PERFORM 4200-UPDATE-POS-TAX-ID                           06112044
052800     END-IF.                                                      06113044
052900                                                                  06114031
061200*4000-EXIT.                                                       06120000
061300                                                                  06130000
061400***********************************************************       06140000
061500 4100-FORMAT-TAX-RATES.                                           06150000
061600***********************************************************       06160000
061700***********************************************************       06170000
061800***  FORMAT TAX RATE ABOVE THRESHOLD AND SINGLE, FULL RATES       06180000
061900***********************************************************       06190000
062000     MOVE ZERO TO PV-TEMP-TX-RT-PCT.                              06200000
062100     MOVE ZERO TO PV-TEMP-RATE-NUM.                               06210000
062200     MOVE SPACES TO PV-TEMP-RATE-CHAR.                            06220000
062300     IF (TXRTLO-TX-TYP-CDE = 'TH'                                 06230000
062400        AND TXRTLO-ABV-THRS-FTX-IND = 'F')                        06240000
062500        MOVE PV-FULL-TAX-RATE TO PV-TEMP-TX-RT-PCT                06250000
062600     ELSE                                                         06260000
062700        MOVE TXRTLO-TX-RT-PCT TO PV-TEMP-TX-RT-PCT                06270000
062800     END-IF.                                                      06280000
062900*** HAVE TO MULTIPLY TAX RATE BY 100000 FIRST, BECAUSE YOU CAN'T  06290000
063000*** MOVE A NUMERIC WITH DECIMAL INTO A CHARACTER DEFINED FIELD.   06300000
063100     MULTIPLY PV-TEMP-TX-RT-PCT BY 100000                         06310000
063200         GIVING PV-TEMP-RATE-NUM.                                 06320000
063300     MOVE PV-TEMP-RATE-NUM TO PV-TEMP-RATE-CHAR.                  06330000
063400     MOVE PV-TEMP-RATE-CHAR (2:5) TO PV-TEMP-RATE-ABOVE-T.        06340000
063500                                                                  06350000
063600****************************************************************  06360000
063700*** ALSO FORMAT TAX RATE BELOW THRESHOLD FOR THRESHOLD TAX TYPES  06370000
063800****************************************************************  06380000
063900     IF TXRTLO-TX-TYP-CDE = 'TH' OR TXRTLO-THRS-DOL-AMT > 0       06390032
064000        MOVE ZERO TO PV-TEMP-TX-RT-PCT                            06400000
064100        MOVE ZERO TO PV-TEMP-RATE-NUM                             06410000
064200        MOVE SPACES TO PV-TEMP-RATE-CHAR                          06420000
064300        IF (TXRTLO-BLW-THRS-FTX-IND = 'F')                        06430000
064400           MOVE PV-FULL-TAX-RATE TO PV-TEMP-TX-RT-PCT             06440000
064500        ELSE                                                      06450000
064600           MOVE TXRTLO-BLW-THRS-TX-RT-PCT TO                      06460000
064700                PV-TEMP-TX-RT-PCT                                 06470000
064800        END-IF                                                    06480000
064900*** HAVE TO MULTIPLY TAX RATE BY 100000 FIRST, BECAUSE YOU CAN'T  06490000
065000*** MOVE A NUMERIC WITH DECIMAL INTO A CHARACTER DEFINED FIELD.   06500000
065100        MULTIPLY PV-TEMP-TX-RT-PCT BY 100000                      06510000
065200           GIVING PV-TEMP-RATE-NUM                                06520000
065300        MOVE PV-TEMP-RATE-NUM TO PV-TEMP-RATE-CHAR                06530000
065400        MOVE PV-TEMP-RATE-CHAR (2:5) TO PV-TEMP-RATE-BELOW-T      06540000
055500                                                                  06541032
055600*** HAVE TO MULTIPLY THRESHOLD DOLLAR BY 100 FIRST, IN ORDER TO   06542032
055700*** MOVE A NUMERIC WITH DECIMAL INTO A CHARACTER DEFINED FIELD    06543032
055800        MOVE ZERO TO PV-TEMP-THRS-DNUM                            06544032
055900        MOVE '0000000' TO PV-TEMP-THRS-DCHAR                      06545032
056000        MULTIPLY TXRTLO-THRS-DOL-AMT BY 100                       06546032
056100                     GIVING PV-TEMP-THRS-DNUM                     06547032
056200        MOVE PV-TEMP-THRS-DNUM TO PV-TEMP-THRS-DCHAR              06548032
056300        MOVE PV-TEMP-THRS-DCHAR (2:6) TO PV-PTAX-THRS-DOLLAR      06549032
065500     END-IF.                                                      06550000
065600*EXIT-4100                                                        06560000
065700                                                                  06570000
065710 4150-SAVE-ABOVE-THRS-INFO.                                       06570132
065720                                                                  06570232
                                                                        06570567
065730     IF PV-WORKING-GROUP-NBR < PC-MAX-NEW-TAX-RATES               06570636
058200         ADD 1 TO PV-WORKING-GROUP-NBR                            06571036
058210     ELSE                                                         06571136
058212         MOVE '4150-SAVE-ABOVE-THRS-INFO' TO PV-PARAGRAPH-NAME    06571236
058214         MOVE 'TAX POINTER EXCEEDED NINE' TO PV-OPERATION-MSG-1   06571336
058216         SET AC-ALT-POINTER-ERROR         TO TRUE                 06571437
058220         PERFORM 9999-ABEND                                       06571536
058230     END-IF.                                                      06571636
058240                                                                  06571736
058300     MOVE PV-WORKING-GROUP-NBR TO PV-PTAX-ALT-POINTER             06572032
058600                                  PV-NEXT-TAX-CD-CHAR.            06573032
058400     MOVE PV-TEMP-RATE-ABOVE-T TO                                 06574032
058500                           PT-TAX-RATE (PV-WORKING-GROUP-NBR).    06575032
058700     MOVE PV-NEXT-TAX-CD-CHAR TO                                  06576032
058800                           PT-TAX-CODE-NBR (PV-WORKING-GROUP-NBR).06577032
058900     MOVE PV-TEMP-RATE-ABOVE-T TO TX-PTAX-RATE (TAX-INDEX).       06578032
059000     MOVE PV-WORKING-GROUP-NBR TO                                 06579032
059000                           TX-PTAX-CODE-INDICATOR (TAX-INDEX).    06579132
058210     SET TAX-INDEX UP BY 1.                                       06579232
058220                                                                  06579332
065800*---------------------------------------------------------*       06580030
065810* UPDATE THE TTXRTLO TABLE WITH THE CORRECT POS_ASG_ID    *       06590030
066000*---------------------------------------------------------*       06600030
065900 4200-UPDATE-POS-TAX-ID.                                          06601044
066100                                                                  06610030
066400     EXEC SQL                                                     06640044
066500         UPDATE TTXRTLO                                           06650044
066600            SET POS_ASG_TX_ID = :PV-NEXT-TAX-CD-CHAR              06660044
066700               ,LAST_UPD_TMST = CURRENT TIMESTAMP                 06670044
066800            WHERE (STR_NBR = :XST00001-LOC-NBR                    06680044
066900                   AND TX_GP_ITM_ID = :TXRTLO-TX-GP-ITM-ID        06690044
067000                   AND TX_TYP_CDE = :TXRTLO-TX-TYP-CDE            06700044
067100                   AND EFF_BEG_DTE = :TXRTLO-EFF-BEG-DTE)         06710044
067200     END-EXEC.                                                    06720044
067300     EVALUATE TRUE                                                06730030
067400            WHEN SQLCODE NOT = +0                                 06740030
067500              MOVE '4200-UPDATE-POS-TAX-ID'                       06750030
067600                TO PV-PARAGRAPH-NAME                              06760030
067700              MOVE 'UPDATE TTXRTLO WITH POS_ASG_TX_ID'            06770030
067800                TO PV-DB2-OPERATION                               06780030
067900              PERFORM 9900-SQL-ABEND                              06790030
068000     END-EVALUATE.                                                06800030
068100                                                                  06810000
068200     PERFORM 8610-CHECK-FOR-COMMIT.                               06820030
068300                                                                  06830000
068310     IF SQLCODE = ZERO                                            06830150
075500         IF PV-CURRENT-TIMESTAMP > PV-COMMIT-TIMESTAMP            06830250
075700             PERFORM 8620-COMMIT                                  06830450
075800             PERFORM 8600-GET-COMMIT-TIMESTAMP                    06830550
075900         END-IF                                                   06830650
075910     END-IF.                                                      06830750
068310*--------------------------------------------------------------*  06830817
059500*    FILL THE PARAMETER DATA FOR THE NEW ABOVE THRESHOLD RATE  *  06831017
059510*--------------------------------------------------------------*  06831117
059520 4300-CHECK-NEW-TAXRATES.                                         06831217
059600                                                                  06832017
059610     IF TX-PTAX-CODE-INDICATOR (TAX-INDEX) > 0                    06832117
059900           MOVE TX-PTAX-CODE-IND-CHAR (TAX-INDEX) TO              06835022
059900                                  PV-PTAX-CODE-INDICATOR          06835122
060000           MOVE TX-PTAX-RATE (TAX-INDEX) TO PV-PTAX-RATE          06836022
060100           MOVE SPACES TO PV-PTAX-THRS-DOLLAR                     06837017
060200           MOVE SPACES TO PV-PTAX-ALT-POINTER                     06838017
060300           MOVE SPACES TO PV-PTAX-DISCOUNT-IND                    06839017
060400                                                                  06839117
060800           PERFORM 5000-LOAD-PARAMETER                            06839517
060900                                                                  06839617
060910     ELSE                                                         06839731
060920           SET PS-END-OF-NEW-TAX-RATES TO TRUE                    06839831
061000     END-IF.                                                      06839917
061100                                                                  06840017
068400***********************************************************       06841000
068500 5000-LOAD-PARAMETER.                                             06850000
068600***********************************************************       06860000
068700     STRING                                                       06870000
068800        PV-PARAM-TO-WRITE DELIMITED BY ' '                        06880000
068900        PV-PTAX-CODE-INDICATOR DELIMITED BY SIZE                  06890000
069000        ';' DELIMITED BY SIZE                                     06900000
069100        PV-PTAX-RATE DELIMITED BY SIZE                            06910000
069200        ';' DELIMITED BY SIZE                                     06920000
069300        PV-PTAX-THRS-DOLLAR DELIMITED BY ' '                      06930000
069400        ';' DELIMITED BY SIZE                                     06940000
069500        PV-PTAX-ALT-POINTER DELIMITED BY ' '                      06950000
069600        ';' DELIMITED BY SIZE                                     06960000
069700        PV-PTAX-DISCOUNT-IND DELIMITED BY ' '                     06970000
069800        ';' DELIMITED BY SIZE                                     06980000
069900        INTO PV-TEMP-PARAMETER                                    06990000
070000     END-STRING.                                                  07000000
070100     MOVE SPACES TO PV-PARAM-TO-WRITE.                            07010000
070200     MOVE PV-TEMP-PARAMETER TO PV-PARAM-TO-WRITE.                 07020000
070300     MOVE SPACES TO PV-TEMP-PARAMETER.                            07030000
070500     ADD 1 TO PV-NEXT-TAX-CD.                                     07050031
070500                                                                  07060031
070700*5000-EXIT.                                                       07070000
070800***********************************************************       07080000
070900 6000-WRITE-UPDATE-FILE.                                          07090000
071000***********************************************************       07100000
071100     MOVE SPACES TO UPDATE-RECORD.                                07110000
071200     STRING                                                       07120000
071300        PV-UPDATE-MESSAGE DELIMITED BY SIZE                       07130000
071400        PV-INPUT-DATE DELIMITED BY SIZE                           07140000
071500        INTO UPDATE-RECORD                                        07150000
071600     END-STRING.                                                  07160000
071700     WRITE UPDATE-RECORD.                                         07170000
071800                                                                  07180048
071810***************************************************************** 07181048
071820* 7000-INSERT-NEW-STORE-INFO.                                   * 07182048
071830* THIS RATE IS TO BE USED TO SET UP THE STORE REGISTER BEFORE   * 07183048
071840* STORE OPEN DATE. THE ACTUAL RATE FOR THE STORE WILL BE ADDED  * 07184048
071850* BY THE TAX DEPARTMENT WHEN THE TAX RATE IS KNOWN.             * 07185048
071860***************************************************************** 07186048
071870 7000-INSERT-NEW-STORE-INFO.                                      07187048
039742                                                                  07188048
039744     EXEC SQL                                                     07189048
039746         INSERT                                                   07189148
039748           INTO TTXRTLO                                           07189248
039750                (STR_NBR                                          07189348
039752                ,TX_TYP_CDE                                       07189448
039754                ,EFF_BEG_DTE                                      07189548
039756                ,TX_GP_ITM_ID                                     07189648
039758                ,TX_RT_PCT                                        07189748
039760                ,ABV_THRS_FTX_IND                                 07189848
039726                ,THRS_DOL_AMT                                     07189948
039728                ,BLW_THRS_FTX_IND                                 07190048
039730                ,POS_ASG_TX_ID                                    07190148
039732                ,LAST_UPD_TMST                                    07190248
039734                ,LAST_UPD_BY_USR_ID                               07190348
039736                ,THRS_TX_CDE                                      07190448
039738                ,TX_HOL_IND)                                      07190548
039740         VALUES (:TXRTLO-STR-NBR                                  07190648
039742                ,:TXRTLO-TX-TYP-CDE                               07190748
039744                ,:TXRTLO-EFF-BEG-DTE                              07190848
039746                ,:TXRTLO-TX-GP-ITM-ID                             07190948
039748                ,:TXRTLO-TX-RT-PCT                                07191048
039750                ,:TXRTLO-ABV-THRS-FTX-IND                         07191148
039752                ,:TXRTLO-THRS-DOL-AMT                             07191248
039754                ,:TXRTLO-BLW-THRS-FTX-IND                         07191348
039756                ,:TXRTLO-POS-ASG-TX-ID                            07191448
039758                ,:TXRTLO-LAST-UPD-TMST                            07191548
039760                ,:TXRTLO-LAST-UPD-BY-USR-ID                       07191648
039762                ,:TXRTLO-THRS-TX-CDE                              07191748
039764                ,:TXRTLO-TX-HOL-IND)                              07191848
039766     END-EXEC.                                                    07191948
039768                                                                  07192048
039770     EVALUATE SQLCODE                                             07192158
039772         WHEN ZERO                                                07192258
039774             CONTINUE                                             07192358
039776         WHEN OTHER                                               07192458
039777             DISPLAY 'ABEND STORE: ' TXRTLO-STR-NBR               07192562
039778             MOVE '7000-INSERT-NEW-STORE-INFO' TO                 07192658
039780                                          PV-PARAGRAPH-NAME       07192758
039782             MOVE 'INSERT NEW STORE RATE INTO TTXRTLO' TO         07192858
039784                                          PV-DB2-OPERATION        07192958
039786             PERFORM 9900-SQL-ABEND                               07193058
039788     END-EVALUATE.                                                07193158
039790                                                                  07193258
071900******************************************************************07195000
072000*  GET THE TIMESTAMP THAT WILL BE USED TO DETERMINE COMMIT       *07200000
072100*  PROCESSING                                                    *07210000
072200******************************************************************07220000
072300 8600-GET-COMMIT-TIMESTAMP.                                       07230000
072400                                                                  07240000
072500     EXEC SQL                                                     07250000
072600          SELECT (CURRENT TIMESTAMP + CKPT_FRQNCY_QTY SECONDS)    07260000
072700         INTO :PV-COMMIT-TIMESTAMP                                07270000
072800          FROM TCKRSTCNTL                                         07280000
072900         WHERE PLAN_NAME           = :PC-PROGRAM-NAME             07290000
073000      END-EXEC.                                                   07300000
073100                                                                  07310000
073200      EVALUATE TRUE                                               07320000
073300         WHEN SQLCODE = ZERO                                      07330000
073400              CONTINUE                                            07340000
073500         WHEN SQLWARN0 NOT EQUAL SPACE                            07350000
073600         WHEN SQLCODE NOT = +0                                    07360000
073700           MOVE '8600-GET-COMMIT-TIMESTAMP'                       07370000
073800             TO PV-PARAGRAPH-NAME                                 07380000
073900           MOVE 'GET COMMIT TIMESTAMP'                            07390000
074000             TO PV-DB2-OPERATION                                  07400000
074100           PERFORM 9900-SQL-ABEND                                 07410013
074200      END-EVALUATE.                                               07420000
074300                                                                  07430000
074400******************************************************************07440000
074500* CHECK TO SEE IF A COMMIT NEEDS TO BE TAKEN                     *07450000
074600******************************************************************07460000
074700 8610-CHECK-FOR-COMMIT.                                           07470000
074800                                                                  07480000
074900     EXEC SQL                                                     07490000
075000         SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP            07500000
075100     END-EXEC.                                                    07510000
075200                                                                  07520000
075300     EVALUATE TRUE                                                07530000
075400         WHEN SQLCODE = ZERO                                      07540000
075900             CONTINUE                                             07590050
076000         WHEN SQLWARN0 NOT EQUAL SPACE                            07600000
076100         WHEN SQLCODE NOT = +0                                    07610000
076200           MOVE '8610-CHECK-FOR-COMMIT'                           07620000
076300             TO PV-PARAGRAPH-NAME                                 07630000
076400           MOVE 'CHECK FOR COMMIT FOR TTXRTLO UPDATE'             07640000
076500             TO PV-DB2-OPERATION                                  07650000
076600           PERFORM 9900-SQL-ABEND                                 07660013
076700     END-EVALUATE.                                                07670000
076800                                                                  07680000
076900***************************************************************** 07690000
077000* COMMIT DB2 CHANGES                                            * 07700000
077100***************************************************************** 07710000
077200 8620-COMMIT.                                                     07720000
077300                                                                  07730000
077400     EXEC SQL                                                     07740000
077500         COMMIT                                                   07750000
077600     END-EXEC.                                                    07760000
077700                                                                  07770000
077800     EVALUATE TRUE                                                07780000
077900         WHEN SQLCODE = ZERO                                      07790000
078000             CONTINUE                                             07800000
078100         WHEN SQLWARN0 NOT EQUAL SPACE                            07810000
078200         WHEN SQLCODE NOT = +0                                    07820000
078300           MOVE '8620-COMMIT'                                     07830000
078400             TO PV-PARAGRAPH-NAME                                 07840000
078500           MOVE 'COMMIT TTXRTLO UPDATE'                           07850000
078600             TO PV-DB2-OPERATION                                  07860000
078700           PERFORM 9900-SQL-ABEND                                 07870013
078800     END-EVALUATE.                                                07880000
078900                                                                  07890000
079000***********************************************************       07900000
079100 9000-FINISH.                                                     07910000
079200***********************************************************       07920000
079300                                                                  07930005
079400     IF PA-TX-RTE-CNT > 0                                         07940005
042210          PERFORM 4300-CHECK-NEW-TAXRATES                         07941047
042220          VARYING TAX-INDEX FROM 1 BY 1                           07942047
042230            UNTIL TAX-INDEX > PC-MAX-NEW-TAX-RATES                07943047
042235               OR PS-END-OF-NEW-TAX-RATES                         07944047
079500          MOVE SPACES TO PARAMETER-RECORD                         07950005
079600          MOVE PV-PARAM-TO-WRITE TO PARAMETER-RECORD              07960005
079700          WRITE PARAMETER-RECORD                                  07970005
079800          MOVE SPACES TO PARAMETER-RECORD                         07980005
079900***  WRITE OUT END OF FILE CONTROL-Z CHARACTER (HEX 3F) ******    07990005
080000          MOVE PV-EOF-HEX-3F TO PARAMETER-RECORD                  08000005
080100          WRITE PARAMETER-RECORD                                  08010005
080200          MOVE SPACES TO PV-PARAM-TO-WRITE                        08020005
080300          ADD +1 TO PA-RECS-WRITTEN                               08030007
080400     END-IF.                                                      08040005
080500                                                                  08050005
080600     CLOSE PARAMETER-FILE                                         08060000
080700           DATE-CONTROL-FILE                                      08070000
080800           UPDATE-FILE.                                           08080000
080900                                                                  08090005
081000     EXEC SQL                                                     08100000
081100         CLOSE TAX-RATE-CURSOR                                    08110000
081200     END-EXEC.                                                    08120000
081300                                                                  08130000
081400     EVALUATE TRUE                                                08140000
081500       WHEN SQLCODE NOT = +0                                      08150000
081600         MOVE '9000-FINISH'                                       08160000
081700           TO PV-PARAGRAPH-NAME                                   08170000
081800         MOVE 'CLOSE TAX-RATE CURSOR'                             08180000
081900           TO PV-DB2-OPERATION                                    08190000
082000         PERFORM 9900-SQL-ABEND                                   08200013
082100     END-EVALUATE.                                                08210000
082200                                                                  08220007
082300     DISPLAY '**** TAX RATES SELECTED: ' PA-TX-RTE-CNT.           08230007
082400     DISPLAY '**** RECORDS WRITTEN:    ' PA-RECS-WRITTEN.         08240007
082500                                                                  08250007
082600*9000-EXIT.                                                       08260000
082700***********************************************************       08270000
082800 9900-SQL-ABEND.                                                  08280013
082900***********************************************************       08290000
083000     DISPLAY ' '.                                                 08300000
083100     DISPLAY '9900-SQL-ABEND'.                                    08310013
083200     DISPLAY '**  ABEND     **'.                                  08320000
083300     DISPLAY '**  PROGRAM   ** = ' PC-PROGRAM-NAME.               08330000
083400     DISPLAY '**  PARAGRAPH ** = ' PV-PARAGRAPH-NAME.             08340000
083500     DISPLAY '**  OPERATION ** = ' PV-DB2-OPERATION.              08350000
083600***********************************************************       08360000
083700* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION   *       08370000
083800* STATEMENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND   *       08380000
083900* MODULE 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO *       08390000
084000* A READABLE FORMAT.                                      *       08400000
084100***********************************************************       08410000
084200     COPY DPPD004.                                                08420000
084300                                                                  08430000
084400     SET AC-DB2-ERROR TO TRUE.                                    08440037
084500     CALL 'ILBOABN0' USING ABEND-CODE.                            08450000
084600                                                                  08460000
055400******************************************************************08461036
055500* 9999-ABEND                                                      08462036
055600*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  08463036
055700******************************************************************08464036
055800 9999-ABEND.                                                      08465036
055900     DISPLAY '** ABEND           **'.                             08466036
056000     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          08467036
056100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        08468036
056300     DISPLAY '** ERROR           ** = ' PV-OPERATION-MSG-1.       08469136
056400     CALL 'ILBOABN0' USING ABEND-CODE.                            08469237
084700******************** END OF SOURCE CODE *******************       08470000
