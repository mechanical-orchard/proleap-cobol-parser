000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRF519.                                00050000
000600 AUTHOR.                 MARY SARDINA.                            00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997                          00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM DISPLAYS A SCREEN ON THE LRT (LASER RADIO TERMINAL)00120000
001300* WHICH IS USED TO VERIFY DATA   INFORMATION ON A BAR CODED       00130000
001400* TICKET.  SKU INFORMATION, RELATED TO A CODE IS DISPLAYED UPON   00140000
001500* SCANNING A BAR CODE AND PRESSING ENTER.  DATA DISPLAYED IS FROM 00150000
001600* THE SKU TABLE AND IS USED TO VERIFY THAT INFORMATION PRINTED ON 00160000
001700* THE TICKET MATCHES THE INFORMATION RELATED TO THAT SKU ON THE   00170000
001800* SKU TABLE.                                                      00180000
001900******************************************************************00190000
263968*---------------------------------------------------------------* 00191001
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00192001
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00193001
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00194001
263968*---------------------------------------------------------------* 00195001
263968* CHANGED 02/14/2023    BY JEAN KURK       WR: CHG0281369         00196002
263968* CHANGE CALL OF UPC CHECK DIGIT ROUTINE TO BE DYNAMIC            00197003
263968*---------------------------------------------------------------* 00199002
002000                                                                  00200000
002100******************************************************************00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300******************************************************************00230000
002400                                                                  00240000
002500******************************************************************00250000
002600 DATA DIVISION.                                                   00260000
002700******************************************************************00270000
002800                                                                  00280000
002900******************************************************************00290000
003000 WORKING-STORAGE SECTION.                                         00300000
003100******************************************************************00310000
003200*                                                                 00320000
003300 01  CA-COMMAREA.                                                 00330000
003400     COPY SUWS006.                                                00340000
003500     05  CA-PROGRAM-DATA.                                         00350000
003600         10  CA-UPC-NMBR-X               PIC  X(13)  VALUE SPACE. 00360000
003700         10  CA-UPC-NMBR  REDEFINES  CA-UPC-NMBR-X                00370000
003800                                         PIC  9(13).              00380000
003900         10  CA-UPC-FIRST-12  REDEFINES  CA-UPC-NMBR-X.           00390000
004000             15  CA-FIRST-TWELVE-BYTES-OF-UPC                     00400000
004100                                         PIC  9(12).              00410000
004200             15  CA-CHECK-DIGIT          PIC  X(01).              00420000
004300         10  CA-UPC-LAST-12  REDEFINES  CA-UPC-NMBR-X.            00430000
004400             15  CA-FIRST-DIGIT-COUNTRY-CODE                      00440000
004500                                         PIC  X(01).              00450000
004600             15  CA-LAST-TWELVE-BYTES-OF-UPC                      00460000
004700                                         PIC  9(12).              00470000
004800         10  CA-SKU                      PIC  X(10)  VALUE SPACE. 00480000
004900         10  CA-UNIT-RETAIL-AMOUNT-X     PIC X(08).               00490000
005000         10  CA-UNIT-RETAIL-AMOUNT  REDEFINES                     00500000
005100             CA-UNIT-RETAIL-AMOUNT-X     PIC ZZZZ9.99.            00510000
005200                                                                  00520000
005300         10  CA-SKU-NUMBER-X.                                     00530000
005400             15  CA-DEPT-NUMBER-X  PIC X(3).                      00540000
005500             15  CA-DEPT-NUMBER-9  REDEFINES CA-DEPT-NUMBER-X     00550000
005600                                   PIC 9(3).                      00560000
005700                                                                  00570000
005800             15  CA-CLASS-NUMBER-X PIC X(2).                      00580000
005900             15  CA-CLASS-NMBR-RDF REDEFINES                      00590000
006000                 CA-CLASS-NUMBER-X.                               00600000
006100                 20 CA-MAJOR-CLASS PIC X(1).                      00610000
006200                 20 CA-MINOR-CLASS PIC X(1).                      00620000
006300             15  CA-CLASS-NUMBER-9 REDEFINES                      00630000
006400                 CA-CLASS-NUMBER-X PIC 9(2).                      00640000
006500                                                                  00650000
006600             15  CA-SEQ-NUMBER-X   PIC X(3).                      00660000
006700             15  CA-SEQ-NUMBER-9   REDEFINES CA-SEQ-NUMBER-X      00670000
006800                                 PIC 9(3).                        00680000
006900         10  CA-SKU-NUMBER-9     REDEFINES CA-SKU-NUMBER-X        00690000
007000                                             PIC 9(8).            00700000
007100         10  CA-FORMATTED-GROUP-PRICING  PIC  X(10)  VALUE SPACE. 00710000
007200         10  CA-VENDOR-STYLE-CODE        PIC  X(20)  VALUE SPACE. 00720000
007300         10  CA-SKU-DESCRIPTION          PIC  X(19)  VALUE SPACE. 00730000
007400         10  CA-IN-HOUSE-VENDOR-NAME     PIC  X(19)  VALUE SPACE. 00740000
007500         10  CA-SIZE-DESCRIPTION         PIC  X(10)  VALUE SPACE. 00750000
007600         10  CA-COLOR-DESCRIPTION        PIC  X(10)  VALUE SPACE. 00760000
007700         10  CA-CURRENT-UNIT-RETAIL-AMOUNT                        00770000
007800                                         PIC  9(05)V9(02).        00780000
007900         10  CA-RETAIL-X                                          00790000
008000                                 PIC X(08).                       00800000
008100         10  CA-RETAIL-N                                          00810000
008200                                 PIC 9(5)V99.                     00820000
008300                                                                  00830000
008400*                                                                 00840000
008500 01  DS-DATABASE-SEGMENT-KEYS.                                    00850000
008600     05  DS-CONCATENATED-CDM200DS-KEY.                            00860000
008700         10  FILLER                      PIC  9(02)  VALUE 03.    00870000
008800         10  DS-CDM100DS-DEPT            PIC  9(03)  VALUE ZERO.  00880000
008900         10  DS-CDM200DS-IN-HSE-VENDOR   PIC  9(03)  VALUE ZERO.  00890000
009000*                                                                 00900000
009100 01  PC-PROGRAM-CONSTANTS.                                        00910000
009200     05  PC-TRANID                       PIC  X(04)  VALUE 'S519'.00920000
009300     05  PC-SLASH                        PIC  X(01)  VALUE '/'.   00930000
009400     05  PC-N                            PIC  X(01)  VALUE 'N'.   00940000
009500     05  PC-ONE                          PIC  9(01)  VALUE 1.     00950000
009600     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00960000
009700                                                     COMP SYNC.   00970000
009800     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   00980000
009900                                                     COMP SYNC.   00990000
010000     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +110   01000000
010100                                                     COMP SYNC.   01010000
010200     05  PC-TRANSFER-UP-LENGTH           PIC S9(04)  VALUE +9     01020000
010300                                                     COMP SYNC.   01030000
010400     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01040000
010500         'SUKRF519'.                                              01050000
010600     05  PC-UPC-SCAN-PGM                 PIC  X(08)  VALUE        01060000
010700         'SUKRF518'.                                              01070000
010800     05  PC-SKU-ENTER-PGM                PIC  X(08)  VALUE        01080000
010900         'SUKCS521'.                                              01090000
011000     05  PC-PROGRAM-FUNCTION-KEYS        PIC  X(19)  VALUE        01100000
011100         'F3 =END            '.                                   01110000
011400     05  PC-DB2-DATABASE-ERROR-MSG       PIC  X(19)  VALUE        01140000
011500         'DB2 ACCESS ERROR   '.                                   01150000
011600     05  PC-RTL-NOT-NUMERIC-MSG          PIC  X(19)  VALUE        01160000
011700         'RETAIL NOT NUMERIC '.                                   01170000
011800     05  PC-DPT-NOT-NUMERIC-MSG          PIC  X(19)  VALUE        01180000
011900         'DEPT NOT NUMERIC   '.                                   01190000
012000     05  PC-CL-NOT-NUMERIC-MSG           PIC  X(19)  VALUE        01200000
012100         'CLASS NOT NUMERIC  '.                                   01210000
012200     05  PC-UPC-NOT-NUMERIC-MSG          PIC  X(19)  VALUE        01220000
012300         'UPC NOT NUMERIC    '.                                   01230000
012400     05  PC-UPC-NOT-FOUND-MSG            PIC  X(19)  VALUE        01240000
012500         'UPC NOT FOUND      '.                                   01250000
012600     05  PC-UPC-NOT-VALID-MSG            PIC  X(19)  VALUE        01260000
012700         'UPC NOT VALID      '.                                   01270000
012800     05  PC-UPC-NOT-ASOC-TO-SKU-MSG      PIC  X(19)  VALUE        01280000
012900         'UPC NOT ASOC TO SKU'.                                   01290000
013000     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        01300000
013100         'UNRECOGNIZED PF KEY'.                                   01310000
013200     05  PC-NO-VENDOR-NAME-MSG           PIC  X(19)  VALUE        01320000
013300         'NO VNDR NAME FOUND '.                                   01330000
013400     05  PC-ENTER-THROUGH-MENU-MSG       PIC  X(19)  VALUE        01340000
013500         'ENTER THROUGH MENU '.                                   01350000
013600     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01360000
013700         'TRANS NOT AVAILABLE'.                                   01370000
013800     05  PC-ENTER-DATA-MSG               PIC  X(19)  VALUE        01380000
013900         'PLEASE ENTER DATA  '.                                   01390000
014000     05  PC-FKEY-MSG                     PIC  X(19)  VALUE        01400000
014100         'F2-ADD F4-DG F3-END'.                                   01410000
014200     05  PC-ADD-MSG                      PIC  X(19)  VALUE        01420000
014300         'ADDED  F4-DG F3-END'.                                   01430000
014400     05  PC-F2KEY-MSG                    PIC  X(19)  VALUE        01440000
014500         'F2-CONTINUE        '.                                   01450000
014600     05  PC-PRIMARY-NAME         PIC X(2)     VALUE '01'.         01460000
014700*                                                                 01470000
014800 01  PS-PROGRAM-SWITCHES.                                         01480000
014900     05  PS-VENDOR-NAME-FOUND-IND        PIC  X(01)  VALUE 'N'.   01490000
015000         88  PS-VENDOR-NAME-NOT-FOUND                VALUE 'N'.   01500000
015100         88  PS-VENDOR-NAME-FOUND                    VALUE 'Y'.   01510000
015200     05  PS-EDIT-FAILED-IND              PIC  X(01)  VALUE 'N'.   01520000
015300         88  PS-NO-EDIT-ERROR                        VALUE 'N'.   01530000
015400         88  PS-EDIT-FAILED                          VALUE 'Y'.   01540000
015500     05  PS-ERROR-EXCP-IND               PIC  X(01)  VALUE 'N'.   01550000
015600         88  PS-NO-EXCP-ERROR                        VALUE 'N'.   01560000
015700         88  PS-EXCP-ERROR                           VALUE 'Y'.   01570000
015800*                                                                 01580000
015900 01  PV-PROGRAM-VARIABLES.                                        01590000
016000     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE ZERO   01600000
016100                                                     COMP SYNC.   01610000
016200     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01620000
016300     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01630000
016400                                                     COMP SYNC.   01640000
016500     05  PV-UPC-CHECK-DIGIT-MSG.                                  01650000
016600         10  FILLER                      PIC  X(17)  VALUE        01660000
016700             'CORRECT CKDGT IS '.                                 01670000
016800         10  PV-COMPUTED-UPC-CHECK-DIGIT                          01680000
016900                                         PIC  9(01)  VALUE ZERO.  01690000
017000         10  FILLER                      PIC  X(02)  VALUE SPACE. 01700000
017100     05  PV-UPC-NMBR                     PIC S9(15)  VALUE ZEROS  01710000
017200                                                     COMP-3.      01720000
017300     05  PV-FORMATTED-SKU.                                        01730000
017400         10  PV-DEPT-NMBR                PIC  X(03)  VALUE SPACE. 01740000
017500         10  FILLER                      PIC  X(01)  VALUE '-'.   01750000
017600         10  PV-CLASS-NMBR               PIC  X(02)  VALUE SPACE. 01760000
017700         10  FILLER                      PIC  X(01)  VALUE '-'.   01770000
017800         10  PV-SEQ-NMBR                 PIC  X(03)  VALUE SPACE. 01780000
017900     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE +0     01790000
018000                                                     COMP SYNC.   01800000
018100     05  PV-DEPT-NUMBER                  PIC  X(03)  VALUE ZEROES.01810000
018200     05  PV-INHOUSE-NUMBER               PIC  9(03)  VALUE ZEROES.01820000
018300     05  PV-KEY-FEEDBACK-AREA            PIC  X(11)  VALUE SPACES.01830000
018400     05  PV-FORMATTED-GROUP-PRICING.                              01840000
018500         10  PV-FORMATTED-GROUP-QUANTITY.                         01850000
018600             15  PV-GROUP-QUANTITY-X     PIC  X(01)  VALUE SPACE. 01860000
018700             15  PV-GROUP-QUANTITY  REDEFINES                     01870000
018800                     PV-GROUP-QUANTITY-X PIC  9(01).              01880000
018900             15  PV-GROUP-QUANTITY-SLASH PIC  X(01)  VALUE SPACE. 01890000
019000         10  PV-FORMATTED-GROUP-PRICE    PIC  X(08)  VALUE SPACE. 01900000
019100     05  PV-GROUP-PRICE-NUMERIC-EDIT     PIC ZZ,ZZZ.ZZ.           01910000
019200     05  PV-GROUP-PRICE-NUMERIC-EDIT-X  REDEFINES                 01920000
019300             PV-GROUP-PRICE-NUMERIC-EDIT PIC  X(09).              01930000
019400     05  PV-UNSTRING-SPACE-DELIMITER     PIC  X(01)  VALUE SPACE. 01940000
019500     05  PV-MAX-GROUP-PRICE-DIGITS       PIC  9(04)V9(02)         01950000
019600                                                     VALUE ZEROS. 01960000
019700     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01970000
019800     05  PV-DB2-COUNT                    PIC S9(09)  VALUE +0     01980000
019900                                                     COMP-3.      01990000
020000     05  PV-CURRENT-TIMESTAMP           PIC X(26)   VALUE         02000000
020100                                                       SPACES.    02010000
020200     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE ZERO.  02020000
020300     05  PV-NEW-RTL                      PIC S9(05)V9(02)         02030000
020400                                                     VALUE ZEROS  02040000
020401                                                     COMP-3.      02040100
020402     05  PV-DECIMAL-COUNT                PIC S9(04)  VALUE ZERO   02040200
020403                                                     COMP.        02040300
020404                                                                  02040400
020405*                                                                 02040500
020406*  GENEREATED DSECT FOR THE FSKM026 MAPSET                        02040600
020407*                                                                 02040700
020408     COPY SUKM519.                                                02040800
020409                                                                  02040900
020410*                                                                 02041000
020420*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               02042000
020430*                                                                 02043000
020440     COPY DPWS013.                                                02044000
020450                                                                  02045000
020460*                                                                 02046000
020470*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02047000
020480*                                                                 02048000
020490     COPY DPWS015.                                                02049000
020500                                                                  02050000
020510                                                                  02051000
020520*----------------------------------------------------------------*02052000
020530* HELP SCREEN COMMAREA                                            02053000
020540     COPY PCWS192.                                                02054000
020550*----------------------------------------------------------------*02055000
020560* HELP SCREEN WORK AREA                                           02056000
020570     COPY PCWS188.                                                02057000
020600                                                                  02060000
020700*                                                                 02070000
020800*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02080000
020900*                                                                 02090000
021000     COPY DPWS010I.                                               02100000
021100                                                                  02110000
021200******************************************************************02120000
021300*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      02130000
021400*  TO BE DISPLAYED ON THE LRT                                     02140000
021500******************************************************************02150000
021600     COPY SUWS005.                                                02160000
021700                                                                  02170000
021800*                                                                 02180000
021900*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02190000
022000*                                                                 02200000
022100     COPY DFHAID.                                                 02210000
022200                                                                  02220000
022900                                                                  02290000
023000*                                                                 02300000
023100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02310000
023200*  CONTENT AUDIT TABLE.                                           02320000
023300*                                                                 02330000
023400     EXEC SQL                                                     02340000
023500         INCLUDE TSUAUPC                                          02350000
023600     END-EXEC.                                                    02360000
023700*                                                                 02370000
023800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02380000
023900*  AUDIT TRANSACTIONS.                                            02390000
024000*                                                                 02400000
024100     EXEC SQL                                                     02410000
024200         INCLUDE TSUATRN                                          02420000
024300     END-EXEC.                                                    02430000
024400                                                                  02440000
024500*                                                                 02450000
024600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02460000
024700*  AUDIT EXCEPTION TABLE                                          02470000
024800*                                                                 02480000
024900     EXEC SQL                                                     02490000
025000         INCLUDE TSUEXCP                                          02500000
025100     END-EXEC.                                                    02510000
025200                                                                  02520000
025300                                                                  02530000
025400*                                                                 02540000
025500*  COMMUNICATIONS AREA FOR DB2                                    02550000
025600*                                                                 02560000
025700     EXEC SQL                                                     02570000
025800         INCLUDE SQLCA                                            02580000
025900     END-EXEC.                                                    02590000
026000                                                                  02600000
026100*                                                                 02610000
026200*  UPC PARAMETER LIST FOR CALLING THE UPC CHECK DIGIT ROUTINE.    02620000
026300*                                                                 02630000
026400     COPY DPWS040I.                                               02640000
026500                                                                  02650000
026600******************************************************************02660000
026700 LINKAGE SECTION.                                                 02670000
026800******************************************************************02680000
026900 01  DFHCOMMAREA.                                                 02690000
027000     05  FILLER                         OCCURS  1 TO 4072 TIMES   02700000
027100                                        DEPENDING ON EIBCALEN.    02710000
027200         10  FILLER                     PIC X.                    02720000
027300                                                                  02730000
027400                                                                  02740000
027500******************************************************************02750000
027600 PROCEDURE DIVISION.                                              02760000
027700******************************************************************02770000
027800 0000-PROGRAM-MAINLINE.                                           02780000
027900     MOVE DFHCOMMAREA TO CA-COMMAREA.                             02790000
028000                                                                  02800000
028100     EVALUATE TRUE                                                02810000
028200         WHEN EIBCALEN = ZERO                                     02820000
028300             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    02830000
028400             PERFORM 8300-RETURN                                  02840000
028410****************************************************************  02841000
028420* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        02842000
028430****************************************************************  02843000
028440         WHEN EIBTRNID = 'Z278'                                   02844000
028450             MOVE DFHCOMMAREA          TO PC192-COMMAREA          02845000
028460             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             02846000
028470             SET SU006-PROCESS-SCREEN  TO TRUE                    02847000
028480             PERFORM 1000-INITIALIZE                              02848000
028490             PERFORM 8000-SEND-MAP                                02849000
028491             PERFORM 8200-RETURN-TRANID                           02849100
028492                                                                  02849200
028500         WHEN SU006-INITIALIZE-SCREEN                             02850000
028600             PERFORM 1000-INITIALIZE                              02860000
028700             MOVE -1       TO ADESCL                              02870000
028800             PERFORM 8000-SEND-MAP                                02880000
028900             PERFORM 8200-RETURN-TRANID                           02890000
029000         WHEN EIBAID = DFHENTER                                   02900000
029100             PERFORM 2000-PROCESS-SCREEN-FIELDS                   02910000
029200             PERFORM 8100-SEND-DATA-ONLY                          02920000
029300             PERFORM 8200-RETURN-TRANID                           02930000
029400         WHEN EIBAID = DFHPF2                                     02940000
029500             PERFORM 2000-PROCESS-SCREEN-FIELDS                   02950000
029600             IF SU006-UPC-ADDED                                   02960000
029700                 MOVE PM-ALREADY-ADD-MSG TO AMSGLNO               02970000
029800             ELSE                                                 02980000
029900                 PERFORM 5100-MOVE-TSUAUPC-FIELDS                 02990000
030000                 PERFORM 7100-INSERT-TSUAUPC                      03000000
030100                 MOVE PC-ADD-MSG   TO AMSGLNO                     03010000
030200             END-IF                                               03020000
030300             PERFORM 5000-MOVE-TSUEXCP-FIELDS                     03030000
030400             PERFORM 8000-SEND-MAP                                03040000
030500             PERFORM 8200-RETURN-TRANID                           03050000
030600         WHEN EIBAID = DFHPF4                                     03060000
030700             PERFORM 2000-PROCESS-SCREEN-FIELDS                   03070000
030800             IF SU006-UPC-ADDED                                   03080000
030900                 CONTINUE                                         03090000
031000             ELSE                                                 03100000
031100                 PERFORM 5100-MOVE-TSUAUPC-FIELDS                 03110000
031200                 PERFORM 7100-INSERT-TSUAUPC                      03120000
031300             END-IF                                               03130000
031400             PERFORM 5000-MOVE-TSUEXCP-FIELDS                     03140000
031500             PERFORM 5001-MOVE-TSUEXCP-FIELDS                     03150000
031600             PERFORM 7000-INSERT-TSUEXCP                          03160000
031700             SET SU006-UPC-NOT-ADDED TO TRUE                      03170000
031800             MOVE PC-UPC-SCAN-PGM TO PV-TRANSFER-PROGRAM          03180000
031900             PERFORM 4000-XCTL-LRT-MENU                           03190000
032000         WHEN EIBAID = DFHPF3                                     03200000
032100             SET SU006-UPC-NOT-ADDED TO TRUE                      03210000
032200             MOVE PC-UPC-SCAN-PGM TO PV-TRANSFER-PROGRAM          03220000
032300             PERFORM 4000-XCTL-LRT-MENU                           03230000
032400         WHEN EIBAID = DFHCLEAR                                   03240000
032500             MOVE SPACES TO AMSGLNO                               03250000
032600             INITIALIZE CA-PROGRAM-DATA                           03260000
032700             PERFORM 8000-SEND-MAP                                03270000
032800             PERFORM 8200-RETURN-TRANID                           03280000
032810         WHEN EIBAID = DFHPF1                                     03281000
032820              PERFORM 1400-HELP-SCREEN                            03282000
032830                                                                  03283000
032900         WHEN OTHER                                               03290000
033000             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           03300000
033100             PERFORM 8100-SEND-DATA-ONLY                          03310000
033200             PERFORM 8200-RETURN-TRANID                           03320000
033300     END-EVALUATE.                                                03330000
033400                                                                  03340000
033500     GOBACK.                                                      03350000
033600*                                                                 03360000
033700 1000-INITIALIZE.                                                 03370000
033800     MOVE LOW-VALUES               TO SU519AI.                    03380000
033900     SET SU006-PROCESS-SCREEN      TO TRUE.                       03390000
034000     MOVE PC-FKEY-MSG              TO AMSGLNO.                    03400000
034100     PERFORM 1500-MOVE-COMMAREA-TO-SCREEN.                        03410000
034200     INITIALIZE CA-PROGRAM-DATA.                                  03420000
034300*                                                                 03430000
034301 1400-HELP-SCREEN.                                                03430100
034302     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03430200
034303     MOVE 'SUKRF519'                  TO PC192-PROGRAM-NAME       03430300
034304     COPY PCPD188.                                                03430400
034305     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03430500
034306     PERFORM 4200-XCTL-TO-HELP.                                   03430600
034307                                                                  03430700
034310*                                                                 03431000
034400 2000-PROCESS-SCREEN-FIELDS.                                      03440000
034500     MOVE LOW-VALUES      TO SU519AI.                             03450000
034600     SET PS-NO-EDIT-ERROR TO TRUE.                                03460000
034700                                                                  03470000
034800     PERFORM 2100-RECEIVE-MAP.                                    03480000
034900     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      03490000
035000          PERFORM 3200-EDIT-RETAIL-COST                           03500000
035100     END-IF.                                                      03510000
035200     PERFORM 1500-MOVE-COMMAREA-TO-SCREEN.                        03520000
035300     MOVE PC-FKEY-MSG  TO AMSGLNO.                                03530000
035400                                                                  03540000
035500 2100-RECEIVE-MAP.                                                03550000
035600     EXEC CICS                                                    03560000
035700         RECEIVE MAP    ('SU519A')                                03570000
035800                 MAPSET ('SUKM519')                               03580000
035900                 RESP   (PV-CICS-RESPONSE)                        03590000
036000     END-EXEC.                                                    03600000
036100                                                                  03610000
036200     EVALUATE TRUE                                                03620000
036300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03630000
036400             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   03640000
036500         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                03650000
036600             CONTINUE                                             03660000
036700         WHEN OTHER                                               03670000
036800            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       03680000
036900            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)03690000
037000            SET DP013-LOGIC-ABEND        TO TRUE                  03700000
037100            SET DP013-NO-ROLLBACK        TO TRUE                  03710000
037200            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                03720000
037300     END-EVALUATE.                                                03730000
037400 1500-MOVE-COMMAREA-TO-SCREEN.                                    03740000
037500     IF SU006-UPC-X = SPACES                                      03750000
037600         MOVE ZEROES TO AUPCO                                     03760000
037700     ELSE                                                         03770000
037800         MOVE SU006-UPC TO AUPCO                                  03780000
037900     END-IF.                                                      03790000
038600      MOVE SU006-NUMERIC-SKU    TO ASKUO.                         03860000
038610      MOVE SU006-SKU-DPT        TO ADEPTO.                        03861000
038700      MOVE SU006-SKU-MAJ-CLASS  TO AMJCLSO.                       03870000
038800      MOVE SU006-SKU-SUB-CLASS  TO ASBCLSO.                       03880000
039000                                                                  03900000
039100      MOVE CA-SKU-DESCRIPTION  TO ADESCO.                         03910000
039200      MOVE CA-UNIT-RETAIL-AMOUNT TO ARETAILO.                     03920000
039300      MOVE CA-VENDOR-STYLE-CODE TO ASTYLEO.                       03930000
039400      MOVE CA-SIZE-DESCRIPTION TO ASIZEO.                         03940000
039500      MOVE CA-COLOR-DESCRIPTION TO ACOLORO.                       03950000
039600                                                                  03960000
039700 1501-MOVE-COMMAREA-TO-SCREEN.                                    03970000
039800     IF  SU006-UPC > ZERO                                         03980000
039900         MOVE SU006-UPC TO AUPCO                                  03990000
040000         MOVE DP015-PRO-NOR-OFF    TO AUPCA                       04000000
040100     ELSE                                                         04010000
040200         MOVE ZEROES TO AUPCO                                     04020000
040300     END-IF.                                                      04030000
040400                                                                  04040000
040500     IF SU006-NUMERIC-SKU > ZERO                                  04050000
040600         MOVE SU006-NUMERIC-SKU TO ASKUO                          04060000
040700         MOVE DP015-PRO-NOR-OFF        TO ASKUA                   04070000
040800     ELSE                                                         04080000
040900         MOVE ZEROES TO ASKUO                                     04090000
041000     END-IF.                                                      04100000
041010                                                                  04101000
041020     IF SU006-SKU-DPT > ZERO                                      04102000
041030         MOVE SU006-SKU-DPT TO ADEPTO                             04103000
041040         MOVE DP015-PRO-NOR-OFF        TO ADEPTA                  04104000
041050     ELSE                                                         04105000
041060         MOVE ZEROES TO ADEPTO                                    04106000
041070     END-IF.                                                      04107000
041100                                                                  04110000
041200     IF SU006-SKU-MAJ-CLASS > 0                                   04120000
041300         MOVE SU006-SKU-MAJ-CLASS TO AMJCLSO                      04130000
041400         MOVE DP015-PRO-NOR-OFF        TO AMJCLSA                 04140000
041500     ELSE                                                         04150000
041600         MOVE ZEROES TO AMJCLSO                                   04160000
041700     END-IF.                                                      04170000
041800                                                                  04180000
041900     IF SU006-SKU-SUB-CLASS > 0                                   04190000
042000         MOVE SU006-SKU-SUB-CLASS TO ASBCLSO                      04200000
042100         MOVE DP015-PRO-NOR-OFF        TO ASBCLSA                 04210000
042200     ELSE                                                         04220000
042300         MOVE ZEROES TO ASBCLSO                                   04230000
042400     END-IF.                                                      04240000
042500                                                                  04250000
042600                                                                  04260000
042700 2110-RECEIVE-SCREEN-FIELDS.                                      04270000
042800                                                                  04280000
042900     IF ASKUL > ZERO                                              04290000
043000         MOVE ASKUI TO SU006-NUMERIC-SKU                          04300000
043100     ELSE                                                         04310000
043200         IF ASKUA = DP015-ERASE-EOF                               04320000
043300             MOVE ZEROES TO SU006-NUMERIC-SKU                     04330000
043400         END-IF                                                   04340000
043500     END-IF.                                                      04350000
043600                                                                  04360000
043610     IF ADEPTL > ZERO                                             04361000
043620         MOVE ADEPTI TO SU006-SKU-DPT                             04362000
043630     ELSE                                                         04363000
043640         IF ADEPTA = DP015-ERASE-EOF                              04364000
043650             MOVE ZEROES TO SU006-SKU-DPT                         04365000
043660         END-IF                                                   04366000
043670     END-IF.                                                      04367000
043680                                                                  04368000
043700     IF AMJCLSL > ZERO                                            04370000
043800         MOVE AMJCLSI TO SU006-SKU-MAJ-CLASS                      04380000
043900     ELSE                                                         04390000
044000         IF AMJCLSA = DP015-ERASE-EOF                             04400000
044100             MOVE ZEROES TO SU006-SKU-MAJ-CLASS                   04410000
044200     END-IF.                                                      04420000
044300                                                                  04430000
044310     IF ASBCLSL > ZERO                                            04431000
044320         MOVE ASBCLSI TO SU006-SKU-SUB-CLASS                      04432000
044330     ELSE                                                         04433000
044340         IF ASBCLSA = DP015-ERASE-EOF                             04434000
044350             MOVE ZEROES TO SU006-SKU-SUB-CLASS                   04435000
044360     END-IF.                                                      04436000
044370                                                                  04437000
044400     IF  ADESCL   > ZERO                                          04440000
044500         MOVE ADESCI   TO CA-SKU-DESCRIPTION                      04450000
044600     ELSE                                                         04460000
044700         IF ADESCA   = DP015-ERASE-EOF                            04470000
044800             MOVE SPACES TO CA-SKU-DESCRIPTION                    04480000
044900         END-IF                                                   04490000
045000     END-IF.                                                      04500000
045100                                                                  04510000
045200     IF  ARETAILL > ZERO                                          04520000
045300         MOVE ARETAILI TO CA-UNIT-RETAIL-AMOUNT-X                 04530000
045400     ELSE                                                         04540000
045500         IF ARETAILA = DP015-ERASE-EOF                            04550000
045600             MOVE SPACES TO CA-UNIT-RETAIL-AMOUNT-X               04560000
045700         END-IF                                                   04570000
045800     END-IF.                                                      04580000
045900     IF  ASTYLEL  > ZERO                                          04590000
046000         MOVE ASTYLEI  TO CA-VENDOR-STYLE-CODE                    04600000
046100     ELSE                                                         04610000
046200         IF ASTYLEA  = DP015-ERASE-EOF                            04620000
046300             MOVE SPACES TO CA-VENDOR-STYLE-CODE                  04630000
046400         END-IF                                                   04640000
046500     END-IF.                                                      04650000
046600     IF  ASIZEL   > ZERO                                          04660000
046700         MOVE ASIZEI   TO CA-SIZE-DESCRIPTION                     04670000
046800     ELSE                                                         04680000
046900         IF ASIZEA   = DP015-ERASE-EOF                            04690000
047000             MOVE SPACES TO CA-SIZE-DESCRIPTION                   04700000
047100         END-IF                                                   04710000
047200     END-IF.                                                      04720000
047300     IF  ACOLORL  > ZERO                                          04730000
047400         MOVE ACOLORI  TO CA-COLOR-DESCRIPTION                    04740000
047500     ELSE                                                         04750000
047600         IF ACOLORA  = DP015-ERASE-EOF                            04760000
047700             MOVE SPACES TO CA-COLOR-DESCRIPTION                  04770000
047800         END-IF                                                   04780000
047900     END-IF.                                                      04790000
048000*                                                                 04800000
048100 2200-SET-ATTRIBUTES-TO-DEFAULT.                                  04810000
048200*    MOVE DP015-UNP-ALP-NOR-OFF    TO AUPCA.                      04820000
048400     MOVE SPACES                   TO ADEPTO                      04840000
048500                                      ASKUO                       04850000
048501                                      AMJCLSO                     04850100
048510                                      ASBCLSO                     04851000
048600                                      ADESCO                      04860000
048700                                      ASTYLEO                     04870000
048800                                      ASIZEO                      04880000
048900                                      ACOLORO                     04890000
049000                                      AMSGLNO.                    04900000
049100     MOVE ZEROS                    TO ARETAILO.                   04910000
049200                                                                  04920000
049300 3000-EDIT-UPC.                                                   04930000
049400     IF CA-FIRST-DIGIT-COUNTRY-CODE = SPACES                      04940000
049500         IF CA-LAST-TWELVE-BYTES-OF-UPC NUMERIC                   04950000
049600             MOVE CA-LAST-TWELVE-BYTES-OF-UPC                     04960000
049700                 TO PV-UPC-NMBR                                   04970000
049800         ELSE                                                     04980000
049900             MOVE DP015-UNP-NUM-BRT-MDT  TO AUPCA                 04990000
050000             MOVE PC-UPC-NOT-NUMERIC-MSG TO AMSGLNO               05000000
050100             SET PS-EDIT-FAILED          TO TRUE                  05010000
050200         END-IF                                                   05020000
050300     ELSE                                                         05030000
050400         IF CA-CHECK-DIGIT = SPACES                               05040000
050500             IF CA-FIRST-TWELVE-BYTES-OF-UPC NUMERIC              05050000
050600                 MOVE CA-FIRST-TWELVE-BYTES-OF-UPC                05060000
050700                     TO PV-UPC-NMBR                               05070000
050800             ELSE                                                 05080000
050900                 MOVE DP015-UNP-NUM-BRT-MDT  TO AUPCA             05090000
051000                 MOVE PC-UPC-NOT-NUMERIC-MSG TO AMSGLNO           05100000
051100                 SET PS-EDIT-FAILED          TO TRUE              05110000
051200             END-IF                                               05120000
051300         ELSE                                                     05130000
051400             IF SU006-UPC   NOT NUMERIC                           05140000
051500                 MOVE DP015-UNP-NUM-BRT-MDT  TO AUPCA             05150000
051600                 MOVE PC-UPC-NOT-NUMERIC-MSG TO AMSGLNO           05160000
051700                 SET PS-EDIT-FAILED          TO TRUE              05170000
051800             ELSE                                                 05180000
051900                 MOVE SU006-UPC   TO PV-UPC-NMBR                  05190000
052000             END-IF                                               05200000
052100         END-IF                                                   05210000
052200     END-IF.                                                      05220000
052300                                                                  05230000
052400     IF PS-EDIT-FAILED                                            05240000
052500         PERFORM 8100-SEND-DATA-ONLY                              05250000
052600         PERFORM 8200-RETURN-TRANID                               05260000
052700     END-IF.                                                      05270000
052800*                                                                 05280000
052900 3100-VALIDATE-CHECK-DIGIT.                                       05290000
053000     INITIALIZE DP040I-UPC-CHECK-DIGIT-PARMS.                     05300000
053100     SET DP040I-COMP-CHECK-DIGIT-OPTION TO TRUE.                  05310000
053200                                                                  05320000
053300     IF SU006-UPC   = ZEROS                                       05330000
053400         MOVE DP015-UNP-NUM-BRT-MDT TO AUPCA                      05340000
053500         MOVE PC-UPC-NOT-VALID-MSG  TO AMSGLNO                    05350000
053600         PERFORM 8100-SEND-DATA-ONLY                              05360000
053700         PERFORM 8200-RETURN-TRANID                               05370000
053800     ELSE                                                         05380000
053900         MOVE PV-UPC-NMBR TO DP040I-UPC-CODE                      05390000
054000     END-IF.                                                      05400000
054100                                                                  05410000
054200     CALL DP040I-UPC-CHECK-DIGIT-WO-IUPC                          05420002
054200                     USING DP040I-UPC-CHECK-DIGIT-PARMS.          05421002
054300                                                                  05430000
054400     IF DP040I-COMPUTED-UPC-CHK-DIGIT = DP040I-UPC-CHECK-DIGIT    05440000
054500         CONTINUE                                                 05450000
054600     ELSE                                                         05460000
054700         MOVE DP015-UNP-NUM-BRT-MDT  TO AUPCA                     05470000
054800         MOVE DP040I-COMPUTED-UPC-CHK-DIGIT                       05480000
054900             TO PV-COMPUTED-UPC-CHECK-DIGIT                       05490000
055000         MOVE PV-UPC-CHECK-DIGIT-MSG TO AMSGLNO                   05500000
055100         PERFORM 8100-SEND-DATA-ONLY                              05510000
055200         PERFORM 8200-RETURN-TRANID                               05520000
055300     END-IF.                                                      05530000
055400*                                                                 05540000
055500 3200-EDIT-RETAIL-COST.                                           05550000
055610     IF  SU006-NUMERIC-SKU NOT = ZEROES                           05561000
055710         MOVE SU006-NUMERIC-SKU TO DP010I-UNEDITED-FIELD          05571000
055800         MOVE +8                                                  05580000
055900                           TO DP010I-MAXIMUM-DIGITS               05590000
056000         SET DP010I-NEGATIVE-NOT-ALLOWED                          05600000
056100                           TO TRUE                                05610000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05621001
263968              USING DP010I-NUMERIC-EDIT-AREA                      05622001
056300                                                                  05630000
056400         IF  DP010I-ERROR-DETECTED                                05640000
056500             SET PS-EDIT-FAILED TO TRUE                           05650000
056600             MOVE PC-DPT-NOT-NUMERIC-MSG  TO AMSGLNO              05660000
056700             MOVE DP015-UNP-NUM-BRT-OFF                           05670000
056800                           TO ASKUA                               05680000
056900             MOVE -1       TO ASKUL                               05690000
057000         ELSE                                                     05700000
057100             MOVE DP010I-NUMERIC-FIELD                            05710000
057200                           TO SU006-NUMERIC-SKU                   05720000
057300         END-IF                                                   05730000
057400     END-IF.                                                      05740000
057500                                                                  05750000
057510     IF  SU006-SKU-DPT NOT = ZEROES                               05751000
057520         MOVE SU006-SKU-DPT TO DP010I-UNEDITED-FIELD              05752000
057530         MOVE +3                                                  05753000
057540                           TO DP010I-MAXIMUM-DIGITS               05754000
057550         SET DP010I-NEGATIVE-NOT-ALLOWED                          05755000
057560                           TO TRUE                                05756000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05757101
263968              USING DP010I-NUMERIC-EDIT-AREA                      05757201
057580                                                                  05758000
057590         IF  DP010I-ERROR-DETECTED                                05759000
057591             SET PS-EDIT-FAILED TO TRUE                           05759100
057592             MOVE PC-DPT-NOT-NUMERIC-MSG  TO AMSGLNO              05759200
057593             MOVE DP015-UNP-NUM-BRT-OFF                           05759300
057594                           TO ADEPTA                              05759400
057595             MOVE -1       TO ADEPTL                              05759500
057596         ELSE                                                     05759600
057597             MOVE DP010I-NUMERIC-FIELD                            05759700
057598                           TO SU006-SKU-DPT                       05759800
057599         END-IF                                                   05759900
057600     END-IF.                                                      05760000
057601                                                                  05760100
057610     IF  SU006-SKU-MAJ-CLASS NOT = ZEROES                         05761000
057700         MOVE SU006-SKU-MAJ-CLASS TO DP010I-UNEDITED-FIELD        05770000
057800         MOVE +2                                                  05780000
057900                           TO DP010I-MAXIMUM-DIGITS               05790000
058000         SET DP010I-NEGATIVE-NOT-ALLOWED                          05800000
058100                           TO TRUE                                05810000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05821001
263968              USING DP010I-NUMERIC-EDIT-AREA                      05822001
058300                                                                  05830000
058400         IF  DP010I-ERROR-DETECTED                                05840000
058500             SET PS-EDIT-FAILED TO TRUE                           05850000
058600             MOVE PC-CL-NOT-NUMERIC-MSG  TO AMSGLNO               05860000
058700             MOVE DP015-UNP-NUM-BRT-OFF                           05870000
058800                           TO AMJCLSA                             05880000
058900             MOVE -1       TO AMJCLSL                             05890000
059000         ELSE                                                     05900000
059100             MOVE DP010I-NUMERIC-FIELD                            05910000
059200                           TO SU006-SKU-MAJ-CLASS                 05920000
059300         END-IF                                                   05930000
059400     END-IF.                                                      05940000
059401                                                                  05940100
059402     IF  SU006-SKU-SUB-CLASS NOT = ZEROES                         05940200
059403         MOVE SU006-SKU-SUB-CLASS TO DP010I-UNEDITED-FIELD        05940300
059404         MOVE +2                                                  05940400
059405                           TO DP010I-MAXIMUM-DIGITS               05940500
059406         SET DP010I-NEGATIVE-NOT-ALLOWED                          05940600
059407                           TO TRUE                                05940700
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         05940901
263968              USING DP010I-NUMERIC-EDIT-AREA                      05941001
059409                                                                  05941100
059410         IF  DP010I-ERROR-DETECTED                                05941200
059411             SET PS-EDIT-FAILED TO TRUE                           05941300
059412             MOVE PC-CL-NOT-NUMERIC-MSG  TO AMSGLNO               05941400
059413             MOVE DP015-UNP-NUM-BRT-OFF                           05941500
059414                           TO ASBCLSA                             05941600
059415             MOVE -1       TO ASBCLSL                             05941700
059416         ELSE                                                     05941800
059417             MOVE DP010I-NUMERIC-FIELD                            05941900
059418                           TO SU006-SKU-SUB-CLASS                 05942000
059419         END-IF                                                   05942100
059420     END-IF.                                                      05942200
059421                                                                  05942300
059422                                                                  05942400
059423*    DETERMINE IF THERE IS A DECIMAL POINT OR NOT, AND VALIDATE   05942500
059424*    NUMERIC ACCORDINGLY                                          05942600
059425     MOVE +0                      TO PV-DECIMAL-COUNT.            05942700
059426     INSPECT CA-UNIT-RETAIL-AMOUNT-X TALLYING                     05942800
059427            PV-DECIMAL-COUNT FOR ALL '.'.                         05942900
059428                                                                  05943000
059429*    CHECK TO MAKE SURE THE RETAIL IS NUMERIC                     05943100
059430     INITIALIZE DP010I-NUMERIC-EDIT-AREA.                         05943200
059431     MOVE CA-UNIT-RETAIL-AMOUNT-X TO DP010I-UNEDITED-FIELD.       05943300
059432                                                                  05943400
059433*    IF THERE IS A DECIMAL POINT, VALIDATE FOR 2 DECIMALS         05943500
059434     IF PV-DECIMAL-COUNT > 0                                      05943600
059435         MOVE 5                   TO DP010I-MAXIMUM-DIGITS        05943700
059436         MOVE 2                   TO DP010I-MAXIMUM-DECIMALS      05943800
059437     ELSE                                                         05943900
059438         MOVE 7                   TO DP010I-MAXIMUM-DIGITS        05944000
059439         MOVE 0                   TO DP010I-MAXIMUM-DECIMALS      05944100
059440     END-IF.                                                      05944200
059441                                                                  05944300
059442     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     05944400
059443                                                                  05944500
059444     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05944600
059445                     USING DP010I-NUMERIC-EDIT-AREA.              05944700
059446                                                                  05944800
059447     IF  DP010I-ERROR-DETECTED                                    05944900
059448         MOVE PM-NUMERIC-VALUE-REQUIRED-MSG                       05945000
059449                                  TO AMSGLNO                      05945100
059450         MOVE -1                  TO ARETAILL                     05945200
059451         PERFORM 8100-SEND-DATA-ONLY                              05945300
059452         PERFORM 8200-RETURN-TRANID                               05945400
059453     ELSE                                                         05945500
059454         IF PV-DECIMAL-COUNT > 0                                  05945600
059455             MOVE DP010I-NUMERIC-FIELD                            05945700
059456                                 TO CA-UNIT-RETAIL-AMOUNT         05945800
059457         ELSE                                                     05945900
059458*            COMPUTE DECIMAL POSITION IF IT ISN'T ALREADY THERE   05946000
059459             COMPUTE CA-UNIT-RETAIL-AMOUNT                        05946100
059460                    = DP010I-NUMERIC-FIELD / 100                  05946200
059461         END-IF                                                   05946300
059462         MOVE CA-UNIT-RETAIL-AMOUNT  TO ARETAILO                  05946400
059463     END-IF.                                                      05946500
059464 3300-FILL-MAP-AND-COMMAREA.                                      05946600
059465*    MOVE SPACES                 TO  AMSGLNO.                     05946700
059466*                                                                 05946800
059467******************************************************************05946900
059468* THIS MODULE FORMATS GROUP PRICING ON THE SCREEN WHEN BOTH       05947000
059469* OPTIONAL UNITS AND OPTIONAL RETAIL EXIST, I.E. 3/16.00.         05947100
059470******************************************************************05947200
059471*                                                                 05947300
059472 4000-XCTL-LRT-MENU.                                              05947400
059480     SET SU006-INITIALIZE-SCREEN  TO TRUE.                        05948000
059490     MOVE LENGTH OF CA-COMMAREA    TO  PV-COMMAREA-LENGTH.        05949000
059500     MOVE PC-CURRENT-PROGRAM-NAME TO SU006-LAST-PROGRAM.          05950000
059600                                                                  05960000
059700     EXEC CICS                                                    05970000
059800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    05980000
059900               COMMAREA  (CA-COMMAREA)                            05990000
060000               LENGTH    (PV-COMMAREA-LENGTH)                     06000000
060100               RESP      (PV-CICS-RESPONSE)                       06010000
060200     END-EXEC.                                                    06020000
060300                                                                  06030000
060400     EVALUATE TRUE                                                06040000
060500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06050000
060600             CONTINUE                                             06060000
060700         WHEN OTHER                                               06070000
060800             MOVE '4000-XCTL-TO-LRT-MENU'                         06080000
060900                 TO DP013-PARAGRAPH                               06090000
061000             MOVE 'UNABLE TO XCTL TO THE LRT MENU PROGRAM: '      06100000
061100                 TO DP013-MESSAGE-TEXT (1)                        06110000
061200             MOVE PV-TRANSFER-PROGRAM                             06120000
061300                 TO DP013-MESSAGE-TEXT (2)                        06130000
061400             SET DP013-CICS-ABEND  TO TRUE                        06140000
061500             SET DP013-NO-ROLLBACK TO TRUE                        06150000
061600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06160000
061700             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             06170000
061800             SET SU006-PROCESS-SCREEN TO TRUE                     06180000
061900             INITIALIZE CA-PROGRAM-DATA                           06190000
062000             PERFORM 8000-SEND-MAP                                06200000
062100             PERFORM 8200-RETURN-TRANID                           06210000
062200     END-EVALUATE.                                                06220000
062300*                                                                 06230000
062301*                                                                 06230100
062302 4200-XCTL-TO-HELP.                                               06230200
062303                                                                  06230300
062304     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      06230400
062305     SET  SU006-INITIALIZE-SCREEN     TO TRUE.                    06230500
062306     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    06230600
062307                                                                  06230700
062308     EXEC CICS                                                    06230800
062309         XCTL                                                     06230900
062310             PROGRAM   (PV-TRANSFER-PROGRAM)                      06231000
062311             COMMAREA  (PC192-COMMAREA)                           06231100
062312             LENGTH    (PV-COMMAREA-LENGTH)                       06231200
062313             RESP      (PV-CICS-RESPONSE)                         06231300
062314     END-EXEC.                                                    06231400
062315                                                                  06231500
062316     EVALUATE TRUE                                                06231600
062317         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06231700
062318              CONTINUE                                            06231800
062319         WHEN OTHER                                               06231900
062320             MOVE '4200-XCTL-TO-HELP '                            06232000
062321                 TO DP013-PARAGRAPH                               06232100
062322             MOVE 'SUKRF519 - UNABLE TO XCTL TO PROGRAM: '        06232200
062323                 TO DP013-MESSAGE-TEXT (1)                        06232300
062324             MOVE PV-TRANSFER-PROGRAM                             06232400
062325                 TO DP013-MESSAGE-TEXT (2)                        06232500
062326             SET DP013-CICS-ABEND  TO TRUE                        06232600
062327             SET DP013-ROLLBACK TO TRUE                           06232700
062328             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               06232800
062329             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             06232900
062330             SET SU006-PROCESS-SCREEN TO TRUE                     06233000
062331             PERFORM 8000-SEND-MAP                                06233100
062332             PERFORM 8200-RETURN-TRANID                           06233200
062333     END-EVALUATE.                                                06233300
062340*                                                                 06234000
062400                                                                  06240000
062500 5000-MOVE-TSUEXCP-FIELDS.                                        06250000
062600     INITIALIZE DCLTSUEXCP.                                       06260000
062700     MOVE SU006-AUDIT-CNTL-NBR TO SUEXCP-AUD-CNTL-NBR.            06270000
062800     MOVE SU006-SHIP-UNIT-NBR TO SUEXCP-SHIPT-UNT-ID.             06280000
062900     MOVE SU006-UPC          TO SUEXCP-UPC-NBR.                   06290000
063000     MOVE SU006-SCN-TMST     TO SUEXCP-SCN-TMST.                  06300000
063100     MOVE 'VA'               TO SUEXCP-VILN-GP-CDE.               06310000
063200     MOVE SPACES             TO SUEXCP-OVRRID-SYS-DAT-TXT.        06320000
063300     PERFORM 5050-CHECK-INDICATORS.                               06330000
063400                                                                  06340000
063500 5001-MOVE-TSUEXCP-FIELDS.                                        06350000
063600     INITIALIZE DCLTSUEXCP.                                       06360000
063700     MOVE SU006-AUDIT-CNTL-NBR TO SUEXCP-AUD-CNTL-NBR.            06370000
063800     MOVE SU006-SHIP-UNIT-NBR TO SUEXCP-SHIPT-UNT-ID.             06380000
063900     MOVE SU006-UPC          TO SUEXCP-UPC-NBR.                   06390000
064000     MOVE SU006-SCN-TMST     TO SUEXCP-SCN-TMST.                  06400000
064100     MOVE 'VA'               TO SUEXCP-VILN-GP-CDE.               06410000
064200     MOVE SPACES             TO SUEXCP-OVRRID-SYS-DAT-TXT.        06420000
064300     MOVE '20'               TO SUEXCP-VILN-GP-SEQ-NBR.           06430000
064400     IF SU006-NO-AUD-ERR                                          06440000
064500         SET SU006-AUD-ERR TO TRUE                                06450000
064600         PERFORM 7200-UPDATE-SHIP-UNIT-INFO                       06460000
064700     ELSE                                                         06470000
064800         CONTINUE                                                 06480000
064900     END-IF.                                                      06490000
065000                                                                  06500000
065100 5050-CHECK-INDICATORS.                                           06510000
065200     IF SU006-NO-BARCODE-LOOKUP-ERROR                             06520000
065300          CONTINUE                                                06530000
065400     ELSE                                                         06540000
065500          MOVE SU006-BARCODE-LOOKUP-IND TO SUEXCP-VILN-GP-SEQ-NBR 06550000
065600          SET SU006-NO-BARCODE-LOOKUP-ERROR TO TRUE               06560000
065700          SET PS-EXCP-ERROR TO TRUE                               06570000
065800          PERFORM 7000-INSERT-TSUEXCP                             06580000
065900     END-IF.                                                      06590000
066000                                                                  06600000
066100     IF SU006-NO-UPC-LOOKUP-ERROR                                 06610000
066200          CONTINUE                                                06620000
066300     ELSE                                                         06630000
066400          MOVE SU006-UPC-LOOKUP-IND  TO SUEXCP-VILN-GP-SEQ-NBR    06640000
066500          SET SU006-NO-UPC-LOOKUP-ERROR TO TRUE                   06650000
066600          SET PS-EXCP-ERROR TO TRUE                               06660000
066700          PERFORM 7000-INSERT-TSUEXCP                             06670000
066800     END-IF.                                                      06680000
066900                                                                  06690000
067000     IF SU006-NO-SKU-LOOKUP-ERROR                                 06700000
067100          CONTINUE                                                06710000
067200     ELSE                                                         06720000
067300          MOVE SU006-SKU-LOOKUP-IND  TO SUEXCP-VILN-GP-SEQ-NBR    06730000
067400          SET SU006-NO-SKU-LOOKUP-ERROR TO TRUE                   06740000
067500          SET PS-EXCP-ERROR TO TRUE                               06750000
067600          PERFORM 7000-INSERT-TSUEXCP                             06760000
067700     END-IF.                                                      06770000
067800                                                                  06780000
067900     IF SU006-NO-PO-ALLOC-ERROR                                   06790000
068000          CONTINUE                                                06800000
068100     ELSE                                                         06810000
068200          MOVE SU006-PO-ALLOC-IND    TO SUEXCP-VILN-GP-SEQ-NBR    06820000
068300          SET SU006-NO-PO-ALLOC-ERROR TO TRUE                     06830000
068400          SET PS-EXCP-ERROR TO TRUE                               06840000
068500          PERFORM 7000-INSERT-TSUEXCP                             06850000
068600     END-IF.                                                      06860000
068700                                                                  06870000
068800     IF SU006-NO-UPC-CARTON-ERROR                                 06880000
068900          CONTINUE                                                06890000
069000     ELSE                                                         06900000
069100          MOVE SU006-UPC-CARTON-IND  TO SUEXCP-VILN-GP-SEQ-NBR    06910000
069200          SET SU006-NO-UPC-CARTON-ERROR TO TRUE                   06920000
069300          SET PS-EXCP-ERROR TO TRUE                               06930000
069400          PERFORM 7000-INSERT-TSUEXCP                             06940000
069500     END-IF.                                                      06950000
069600     IF PS-EXCP-ERROR                                             06960000
069700          IF SU006-NO-AUD-ERR                                     06970000
069800              SET SU006-AUD-ERR TO TRUE                           06980000
069900              PERFORM 7200-UPDATE-SHIP-UNIT-INFO                  06990000
070000          ELSE                                                    07000000
070100              CONTINUE                                            07010000
070200          END-IF                                                  07020000
070300     END-IF.                                                      07030000
070400                                                                  07040000
070500 5100-MOVE-TSUAUPC-FIELDS.                                        07050000
070600     INITIALIZE DCLTSUAUPC                                        07060000
070700     MOVE SU006-AUDIT-CNTL-NBR     TO SUAUPC-AUD-CNTL-NBR.        07070000
070800     MOVE SU006-SHIP-UNIT-NBR      TO SUAUPC-SHIPT-UNT-ID.        07080000
070900     MOVE SU006-UPC                TO SUAUPC-UPC-NBR.             07090000
071000     MOVE SU006-USERID             TO SUAUPC-AUD-USR-ID.          07100000
071100     MOVE SU006-NUMERIC-SKU        TO SUAUPC-SKU-NBR.             07110000
071400     MOVE CA-SKU-DESCRIPTION       TO SUAUPC-ITM-DESC.            07140000
071500     MOVE CA-VENDOR-STYLE-CODE  TO SUAUPC-VND-STYL-DESC.          07150000
071600     MOVE CA-COLOR-DESCRIPTION  TO SUAUPC-UPC-CLOR-DESC.          07160000
071700     MOVE CA-SIZE-DESCRIPTION   TO SUAUPC-UPC-SIZE-DESC.          07170000
071702     IF CA-UNIT-RETAIL-AMOUNT-X = SPACES                          07170200
071710         MOVE 0                     TO PV-NEW-RTL                 07171000
071711     ELSE                                                         07171100
071720         MOVE CA-UNIT-RETAIL-AMOUNT TO PV-NEW-RTL                 07172000
071730     END-IF.                                                      07173000
071800     MOVE PV-NEW-RTL               TO SUAUPC-UPC-RTL-AMT.         07180000
071900     MOVE PC-N                     TO SUAUPC-UPC-CERTD-IND.       07190000
071911     MOVE SU006-SKU-DPT            TO SUAUPC-DEPT-NBR.            07191100
071920     MOVE SU006-SKU-MAJ-CLASS      TO SUAUPC-MAJ-CL-NBR.          07192000
071930     MOVE SU006-SKU-SUB-CLASS      TO SUAUPC-SUB-CL-NBR.          07193000
072000                                                                  07200000
072100                                                                  07210000
072200 7000-INSERT-TSUEXCP.                                             07220000
072300                                                                  07230000
072400     EXEC SQL                                                     07240000
072500         INSERT INTO TSUEXCP                                      07250000
072600               (AUD_CNTL_NBR,                                     07260000
072700                SHIPT_UNT_ID,                                     07270000
072800                UPC_NBR,                                          07280000
072900                SCN_TMST,                                         07290000
073000                VILN_GP_CDE,                                      07300000
073100                VILN_GP_SEQ_NBR,                                  07310000
073200                OVRRID_SYS_DAT_TXT)                               07320000
073300         VALUES                                                   07330000
073400               (:SUEXCP-AUD-CNTL-NBR                              07340000
073500              , :SUEXCP-SHIPT-UNT-ID                              07350000
073600              , :SUEXCP-UPC-NBR                                   07360000
073700              , :SUEXCP-SCN-TMST                                  07370000
073800              , :SUEXCP-VILN-GP-CDE                               07380000
073900              , :SUEXCP-VILN-GP-SEQ-NBR                           07390000
074000              , :SUEXCP-OVRRID-SYS-DAT-TXT)                       07400000
074100     END-EXEC.                                                    07410000
074200                                                                  07420000
074300     EVALUATE TRUE                                                07430000
074400         WHEN SQLCODE = ZERO                                      07440000
074500             CONTINUE                                             07450000
074600         WHEN SQLWARN0 NOT = SPACES                               07460000
074700         WHEN SQLCODE NOT EQUAL ZERO                              07470000
074800             MOVE '7000-INSERT-TSUEXCP'                           07480000
074900                             TO DP013-PARAGRAPH                   07490000
075000             MOVE 'INSERT TSUEXCP      '                          07500000
075100                             TO DP013-MESSAGE-TEXT(1)             07510000
075200             MOVE SUEXCP-SHIPT-UNT-ID                             07520000
075300                             TO DP013-MESSAGE-TEXT(2)             07530000
075400             MOVE SQLCA      TO DP013-SQLCA                       07540000
075500             MOVE 'TSUEXCP'  TO DP013-DB2-TABLE-NAME(1)           07550000
075600             SET DP013-DB2-ABEND                                  07560000
075700                             TO TRUE                              07570000
075800             SET DP013-NO-ROLLBACK                                07580000
075900                             TO TRUE                              07590000
076000             SET DP013-XCTL-DISPLAY-RESTART                       07600000
076100                             TO TRUE                              07610000
076200             PERFORM DP014-0000-PROCESS-ABEND                     07620000
076300     END-EVALUATE.                                                07630000
076400                                                                  07640000
076500*                                                                 07650000
076600                                                                  07660000
076700 7100-INSERT-TSUAUPC.                                             07670000
076800                                                                  07680000
076900*   CONTINUE TO TRY INSERTING UNTIL SUCCESSFUL...IF -803 SQLCODE, 07690000
077000*    RETRY WITH THE NEW TIMESTAMP (PART OF THE KEY)               07700000
077100     PERFORM                                                      07710000
077200         WITH TEST AFTER                                          07720000
077300         VARYING PV-RETRY-COUNTER                                 07730000
077400         FROM 1 BY 1                                              07740000
077500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               07750000
077600                   OR (SQLCODE = ZERO))                           07760000
077700                                                                  07770000
077800         EXEC SQL                                                 07780000
077900             SET :SUAUPC-SCN-TMST = CURRENT TIMESTAMP             07790000
078000         END-EXEC                                                 07800000
078100                                                                  07810000
078200         EXEC SQL                                                 07820000
078300             INSERT INTO TSUAUPC                                  07830000
078400                   (AUD_CNTL_NBR,                                 07840000
078500                    SHIPT_UNT_ID,                                 07850000
078600                    UPC_NBR,                                      07860000
078700                    SCN_TMST,                                     07870000
078800                    AUD_USR_ID,                                   07880000
078930                    DEPT_NBR,                                     07893000
078940                    MAJ_CL_NBR,                                   07894000
078950                    SUB_CL_NBR,                                   07895000
079000                    SKU_NBR,                                      07900000
079200                    ITM_DESC,                                     07920000
079300                    VND_STYL_DESC,                                07930000
079400                    UPC_CLOR_DESC,                                07940000
079500                    UPC_SIZE_DESC,                                07950000
079600                    UPC_RTL_AMT,                                  07960000
079700                    UPC_CERTD_IND)                                07970000
079800             VALUES                                               07980000
079900                   (:SUAUPC-AUD-CNTL-NBR                          07990000
080000                   ,:SUAUPC-SHIPT-UNT-ID                          08000000
080100                   ,:SUAUPC-UPC-NBR                               08010000
080200                   ,:SUAUPC-SCN-TMST                              08020000
080300                   ,:SUAUPC-AUD-USR-ID                            08030000
080430                   ,:SUAUPC-DEPT-NBR                              08043000
080440                   ,:SUAUPC-MAJ-CL-NBR                            08044000
080450                   ,:SUAUPC-SUB-CL-NBR                            08045000
080500                   ,:SUAUPC-SKU-NBR                               08050000
080700                   ,:SUAUPC-ITM-DESC                              08070000
080800                   ,:SUAUPC-VND-STYL-DESC                         08080000
080900                   ,:SUAUPC-UPC-CLOR-DESC                         08090000
081000                   ,:SUAUPC-UPC-SIZE-DESC                         08100000
081100                   ,:SUAUPC-UPC-RTL-AMT                           08110000
081200                   ,:SUAUPC-UPC-CERTD-IND)                        08120000
081300         END-EXEC                                                 08130000
081400                                                                  08140000
081500         EVALUATE TRUE                                            08150000
081600             WHEN SQLCODE = ZERO                                  08160000
081700                 SET SU006-UPC-ADDED TO TRUE                      08170000
081800                 MOVE SUAUPC-SCN-TMST TO SU006-SCN-TMST           08180000
081900             WHEN SQLCODE = -803                                  08190000
082000                 CONTINUE                                         08200000
082100             WHEN SQLWARN0 NOT = SPACES                           08210000
082200             WHEN SQLCODE NOT EQUAL ZERO                          08220000
082300                 MOVE '7100-INSERT-TSUEXCP'                       08230000
082400                                 TO DP013-PARAGRAPH               08240000
082500                 MOVE 'INSERT TSUAUPC      '                      08250000
082600                                 TO DP013-MESSAGE-TEXT(1)         08260000
082700                 MOVE SUAUPC-SHIPT-UNT-ID                         08270000
082800                                 TO DP013-MESSAGE-TEXT(2)         08280000
082900                 MOVE SQLCA      TO DP013-SQLCA                   08290000
083000                 MOVE 'TSUAUPC'  TO DP013-DB2-TABLE-NAME(1)       08300000
083100                 SET DP013-DB2-ABEND                              08310000
083200                                 TO TRUE                          08320000
083300                 SET DP013-NO-ROLLBACK                            08330000
083400                                 TO TRUE                          08340000
083500                 SET DP013-XCTL-DISPLAY-RESTART                   08350000
083600                                 TO TRUE                          08360000
083700                 PERFORM DP014-0000-PROCESS-ABEND                 08370000
083800         END-EVALUATE                                             08380000
083900     END-PERFORM.                                                 08390000
084000*                                                                 08400000
084100******************************************************************08410000
084200*  7200-UPDATE-SHIP-UNIT-INFO.                                   *08420000
084300*  UPDATE ALL UNT-AUD-ERR-IND                                    *08430000
084400******************************************************************08440000
084500 7200-UPDATE-SHIP-UNIT-INFO.                                      08450000
084600                                                                  08460000
084700     EXEC SQL                                                     08470000
084800         UPDATE TSUATRN                                           08480000
084900            SET  UNT_AUD_ERR_IND     = 'Y'                        08490000
085000                                                                  08500000
085100         WHERE  AUD_CNTL_NBR   =   :SUAUPC-AUD-CNTL-NBR           08510000
085200           AND  SHIPT_UNT_ID   =   :SUAUPC-SHIPT-UNT-ID           08520000
085300     END-EXEC.                                                    08530000
085400                                                                  08540000
085500     EVALUATE TRUE                                                08550000
085600         WHEN SQLCODE = ZERO                                      08560000
085700             CONTINUE                                             08570000
085800                                                                  08580000
085900         WHEN SQLWARN0 NOT = SPACES                               08590000
086000         WHEN SQLCODE < ZERO                                      08600000
086100         WHEN SQLCODE > ZERO                                      08610000
086200             MOVE '7200-UPDATE-SHIP-UNIT-INFO'                    08620000
086300                 TO DP013-PARAGRAPH                               08630000
086400             MOVE 'UPDATE TSUATRN      '                          08640000
086500                                 TO DP013-MESSAGE-TEXT(1)         08650000
086600             MOVE SUATRN-SHIPT-UNT-ID                             08660000
086700                                 TO DP013-MESSAGE-TEXT(2)         08670000
086800             MOVE SQLCA      TO DP013-SQLCA                       08680000
086900             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           08690000
087000             SET DP013-DB2-ABEND   TO TRUE                        08700000
087100             SET DP013-NO-ROLLBACK TO TRUE                        08710000
087200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08720000
087300             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               08730000
087400             PERFORM 8200-RETURN-TRANID                           08740000
087500     END-EVALUATE.                                                08750000
087600                                                                  08760000
087700                                                                  08770000
087800*                                                                 08780000
087900 8000-SEND-MAP.                                                   08790000
088000     EXEC CICS                                                    08800000
088100         SEND MAP       ('SU519A')                                08810000
088200              MAPSET    ('SUKM519')                               08820000
088300              ERASE                                               08830000
088400              RESP      (PV-CICS-RESPONSE)                        08840000
088500     END-EXEC.                                                    08850000
088600                                                                  08860000
088700     EVALUATE TRUE                                                08870000
088800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08880000
088900             CONTINUE                                             08890000
089000         WHEN OTHER                                               08900000
089100             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         08910000
089200             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  08920000
089300             SET DP013-CICS-ABEND      TO TRUE                    08930000
089400             SET DP013-NO-ROLLBACK     TO TRUE                    08940000
089500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08950000
089600     END-EVALUATE.                                                08960000
089700*                                                                 08970000
089800 8100-SEND-DATA-ONLY.                                             08980000
089900     MOVE -1 TO ADESCL.                                           08990000
090000                                                                  09000000
090100     EXEC CICS                                                    09010000
090200         SEND MAP       ('SU519A')                                09020000
090300              MAPSET    ('SUKM519')                               09030000
090400              CURSOR                                              09040000
090500              DATAONLY                                            09050000
090600              RESP      (PV-CICS-RESPONSE)                        09060000
090700     END-EXEC.                                                    09070000
090800                                                                  09080000
090900     EVALUATE TRUE                                                09090000
091000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09100000
091100             CONTINUE                                             09110000
091200         WHEN OTHER                                               09120000
091300             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        09130000
091400             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 09140000
091500             SET DP013-CICS-ABEND       TO TRUE                   09150000
091600             SET DP013-NO-ROLLBACK      TO TRUE                   09160000
091700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09170000
091800     END-EVALUATE.                                                09180000
091900*                                                                 09190000
092000 8200-RETURN-TRANID.                                              09200000
092100     MOVE LENGTH OF CA-COMMAREA  TO  PV-COMMAREA-LENGTH.          09210000
092200     EXEC CICS                                                    09220000
092300         RETURN TRANSID  (PC-TRANID)                              09230000
092400                COMMAREA (CA-COMMAREA)                            09240000
092500                LENGTH   (PV-COMMAREA-LENGTH)                     09250000
092600                RESP     (PV-CICS-RESPONSE)                       09260000
092700     END-EXEC.                                                    09270000
092800                                                                  09280000
092900     EVALUATE TRUE                                                09290000
093000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09300000
093100             CONTINUE                                             09310000
093200         WHEN OTHER                                               09320000
093300             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        09330000
093400             MOVE 'UNABLE TO RETURN TO TRANID'                    09340000
093500                 TO DP013-MESSAGE-TEXT (1)                        09350000
093600             SET DP013-CICS-ABEND       TO TRUE                   09360000
093700             SET DP013-NO-ROLLBACK      TO TRUE                   09370000
093800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09380000
093900     END-EVALUATE.                                                09390000
094000*                                                                 09400000
094100 8300-RETURN.                                                     09410000
094200     EXEC CICS                                                    09420000
094300         SEND FROM (PV-MESSAGE-AREA)                              09430000
094400              LENGTH (19)                                         09440000
094500              ERASE                                               09450000
094600     END-EXEC.                                                    09460000
094700                                                                  09470000
094800     EXEC CICS                                                    09480000
094900         RETURN                                                   09490000
095000     END-EXEC.                                                    09500000
095100*                                                                 09510000
095200 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  09520000
095300     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              09530000
095400     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             09540000
095500     INITIALIZE DP013-SRC-TASK-NUMBER                             09550000
095600                DP013-STACK.                                      09560000
095700     SET DP013-LINK-RETURN TO TRUE.                               09570000
095800                                                                  09580000
095900     EXEC CICS                                                    09590000
096000         LINK                                                     09600000
096100             PROGRAM   (DP013-NAME)                               09610000
096200             COMMAREA  (DP013-PARAMETERS)                         09620000
096300             LENGTH    (DP013-LENGTH)                             09630000
096400     END-EXEC.                                                    09640000
096500*----------------------------------------------------------------*09650000
096600*    ABEND PROCESSOR MODULE                                      *09660000
096700*----------------------------------------------------------------*09670000
096800                                                                  09680000
096900     COPY DPPD014.                                                09690000
097000*                                                                 09700000
