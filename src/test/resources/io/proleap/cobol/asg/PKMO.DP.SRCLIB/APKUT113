000100*-----------------------*                                         00010013
000200 IDENTIFICATION DIVISION.                                         00020013
000300*-----------------------*                                         00030013
000400 PROGRAM-ID.    APKUT113.                                         00040013
000500 AUTHOR.        MARILYN WILKINSON.                                00050013
000600 DATE-WRITTEN.  AUGUST    1996.                                   00060013
000700                                                                  00070013
000800*---------------------------------------------------------------* 00080013
000900*                                                               * 00090013
001000*    COBOL II WITH SQL                                          * 00100013
001100*                                                               * 00110013
001200*    --- MONTHLY UNJOURNALIZED RECEIPT EXTRACT ---              * 00120013
001300*                                                               * 00130013
001400* DB2 TABLES:                                                   * 00140013
001500*  1. PURCHASE ORDER                   (TPURCHS)                * 00150013
001600*  2. RECEIVER                         (TRECEIV)                * 00160013
001700*  3. PURCHASE ORDER ITEM              (TPURITM)                * 00170013
001800*  4. RECEIPT DISTRIBUTION             (TRECDIS)                * 00180013
001900*  5. RECEIPT ITEM                     (TRECITM)                * 00190013
002000*  6. EXTERNAL ENTERPRISE NAME         (TENTNME)                * 00200013
002100*  7. EXTERNAL ENTERPRISE              (TEXTENT)                * 00210013
002200*  8. NON-INVOICED RECEIPT             (TNINREC)                * 00220013
002300*                                                               * 00230013
002400* INPUT:                                                        * 00240013
002500*  1. UNJRNLZD-RECEIPT-PO-FILE         (APRD106)                * 00250013
002600*  2. UNJRNLZD-RECEIPT-DATE-FILE       (APRD108)                * 00260013
002700*                                                               * 00270013
002800* OUTPUT:                                                       * 00280013
002900*  1. UNJRNLZD-MNTHLY-RCPT-FILE        (APRD113)                * 00290013
003000*                                                               * 00300013
003100*---------------------------------------------------------------* 00310013
003200 EJECT                                                            00320013
003300*---------------------------------------------------------------* 00330013
003400*                                                               * 00340013
003500*    THIS PROGRAM CREATES THE MONTHLY UNJOURNALIZED RECEIPT DATA* 00350013
003600*    EXTRACT FILE WHICH WILL CONTAIN ALL INFORMATION NEEDED TO  * 00360013
003700*    CREATE THE MONTHLY UNJOUNALIZED RECEIPT ANALYSIS REPORT.   * 00370013
003800*                                                               * 00380013
003900*    OUTPUT FILE REPORT DATA IS OBTAINED FROM DB2 TABLES.       * 00390013
004000*---------------------------------------------------------------* 00400013
004100***************************************************************** 00410013
004200*   CHANGES:                                                    * 00420013
004300*                                                               * 00430013
004400*   11/15/02 ADDED OTB_PER_NBR TO THE SELECT FROM TPURCHS IN    * 00440013
004500*            R200-GET-PO-DATA. THIS WILL BE MOVED TO THE APRD113* 00450013
004600*            OUTPUT RECORD.                                     * 00460013
004700*   BY: MIKE BESKE                                      WR 24091* 00470013
004800*                                                               * 00480013
004900* 02/07/2003                                                    * 00490013
005000*    CHANGE MADE: ARKPO PHASE3 PROJECT.                         * 00500013
005100*    UPDATED PGM TITLE TO MATCH THE SPEC TITLE.                 * 00510013
005200*    UPDATED PGM COMMENT BLOCK WITH THE FILENAMES.              * 00520013
005300*    CHANGED -PURCHASE-ORDER TO -PO-NBR FOR THE COPYBOOKS       * 00530013
005400*    FIELD NAME.                                                * 00540013
005500* MADE BY:  MIKE BESKE                          WR#: 23500      * 00550013
005510*                                                               * 00560013
005520* 02/04/2008                                                    * 00570017
005530*    CHANGE MADE: WHEN PO IS DOMESTIC USE FIRST UNIT COST       * 00580013
005540*                 WHEN PO IS IMPORT USE UNIT COST               * 00590013
005550*    MADE BY:  CHRISTINE TWIEHAUS                  WR#: 32664   * 00600013
P46749*                                                               * 00610021
P46749* DATE  08/19/2014                                              * 00620021
P46749*     CHANGE MADE: CHANGE MADE FOR SQL TUNING TO THE CURSOR     * 00630021
P46749*     RECEIV_CSR.                                               * 00640021
P46749*     MADE BY: COGNIZANT (JAVED)       WR/IR #: CHG0089792      * 00650023
005570***************************************************************** 00660013
005580                                                                  00670013
005590 ENVIRONMENT DIVISION.                                            00680013
005600 CONFIGURATION SECTION.                                           00690013
005700 SOURCE-COMPUTER. IBM-3090.                                       00700013
005800 OBJECT-COMPUTER. IBM-3090.                                       00710013
005900                                                                  00720013
006000*                                                                 00730013
006100 INPUT-OUTPUT SECTION.                                            00740013
006200 FILE-CONTROL.                                                    00750013
006300*                                                                 00760013
006400     SELECT UNJRNLZD-RECEIPT-PO-FILE    ASSIGN TO UT-S-INP01.     00770013
006500     SELECT UNJRNLZD-RECEIPT-DATE-FILE  ASSIGN TO UT-S-INP02.     00780013
006600     SELECT UNJRNLZD-MNTHLY-RCPT-FILE   ASSIGN TO UT-S-OUT01.     00790013
006700*                                                                 00800013
006800 DATA DIVISION.                                                   00810013
006900 FILE SECTION.                                                    00820013
007000*                                                                 00830013
007100*                                                                 00840013
007200 FD  UNJRNLZD-RECEIPT-PO-FILE                                     00850013
007300     RECORDING MODE IS F                                          00860013
007400     BLOCK CONTAINS 0 CHARACTERS                                  00870013
007500     LABEL RECORDS ARE STANDARD                                   00880013
007600     DATA RECORD IS UNJRNLZD-RECEIPT-PO-RECORD.                   00890013
007700*                                                                 00900013
007800 01  UNJRNLZD-RECEIPT-PO-RECORD PIC X(20).                        00910013
007900*                                                                 00920013
008000 FD  UNJRNLZD-RECEIPT-DATE-FILE                                   00930013
008100     RECORDING MODE IS F                                          00940013
008200     LABEL RECORDS ARE STANDARD                                   00950013
008300     BLOCK CONTAINS 0 RECORDS                                     00960013
008400     DATA RECORD IS UNJRNLZD-RECEIPT-DATE-RECORD.                 00970013
008500 01  UNJRNLZD-RECEIPT-DATE-RECORD PIC X(41).                      00980013
008600                                                                  00990013
008700*                                                                 01000013
008800 FD  UNJRNLZD-MNTHLY-RCPT-FILE                                    01010013
008900     RECORDING MODE IS F                                          01020013
009000     BLOCK CONTAINS 0 CHARACTERS                                  01030013
009100     LABEL RECORDS ARE STANDARD                                   01040013
009200     DATA RECORD IS UNJRNLZD-MNTHLY-RCPT-RECORD.                  01050013
009300*                                                                 01060013
009400 01  UNJRNLZD-MNTHLY-RCPT-RECORD PIC X(99).                       01070013
009500*                                                                 01080013
009600 EJECT                                                            01090013
009700 WORKING-STORAGE SECTION.                                         01100013
009800                                                                  01110013
009900 01  PV-PROGRAM-VARIABLES.                                        01120013
010000     05  FILLER                  PIC  X(30)  VALUE                01130013
010100         '** BEGINING OF APKUT113 W/S **'.                        01140013
010200     05  PV-CURRENT-PARAGRAPH    PIC  X(35)  VALUE SPACES.        01150013
010300     05  PV-PO-NBR               PIC S9(9)   VALUE ZEROS          01160013
010400                                             COMP.                01170013
010500     05  PV-TOTAL-COST           PIC S9(09)V9(3)                  01180013
010600                                             VALUE ZEROS          01190013
010700                                             COMP-3.              01200013
010800     05  PV-TOTAL-FIRST-COST     PIC S9(09)V9(3)                  01210014
010900                                             VALUE ZEROS          01220013
011000                                             COMP-3.              01230013
011100     05  PV-UNJRNLZD-REC-COST    PIC S9(09)V9(2)                  01240013
011200                                             VALUE ZEROS          01250013
011300                                             COMP-3.              01260013
011400     05  PV-VERIFIED-COST        PIC S9(09)V9(2)                  01270013
011500                                             VALUE ZEROS          01280013
011600                                             COMP-3.              01290013
011700     05  PV-RETRY-COUNT          PIC S9(04)   VALUE ZEROS         01300013
011800                                              COMP.               01310013
011900                                                                  01320013
012000 01  PS-PROGRAM-SWITCHES.                                         01330013
012100     05  PS-OUT-OF-POS-SW        PIC  X(01)  VALUE ' '.           01340013
012200         88  OUT-OF-POS                      VALUE 'Y'.           01350013
012300         88  MORE-POS                        VALUE ' '.           01360013
012400     05  PS-OUT-OF-RECEIPTS-SW   PIC  X(01)  VALUE ' '.           01370013
012500         88  OUT-OF-RECEIPTS                 VALUE 'Y'.           01380013
012600         88  MORE-RECEIPTS                   VALUE ' '.           01390013
012700     05  PS-FIRST-UNJOURNALIZED-SW PIC X(01) VALUE 'Y'.           01400013
012800         88  FIRST-UNJOURNALIZED             VALUE 'Y'.           01410013
012900         88  NOT-FIRST-UNJOURNALIZED         VALUE ' '.           01420013
013030                                                                  01430013
013040 01  PC-PROGRAM-CONSTANTS.                                        01440013
013050     05  PC-RETRY-MAX            PIC S9(04)  VALUE +3             01450013
013060                                             COMP.                01460013
013070     05  PC-SPACE                PIC  X(01)  VALUE SPACE.         01470013
013080     05  PC-MATCH                PIC  X(01)  VALUE 'M'.           01480013
013090 EJECT                                                            01490013
013100*                                                                 01500013
013200*    UNJOURNALIZED RECEIPT PO FILE                                01510013
013300*                                                                 01520013
013400     COPY APRD106.                                                01530013
013500                                                                  01540013
013600 EJECT                                                            01550013
013700*  UNJOURNALIZED RECEIPT DATE FILE                                01560013
013800     COPY APRD108.                                                01570013
013900                                                                  01580013
014000 EJECT                                                            01590013
014100*                                                                 01600013
014200*    UNJOURNALIZED RECEIPT DATA FILE  (MONTHLY)                   01610013
014300*                                                                 01620013
014400     COPY APRD113.                                                01630013
014500 EJECT                                                            01640013
014600*----------------------------------------------------------------*01650013
014700*  PURCHASE TABLE                                                *01660013
014800*----------------------------------------------------------------*01670013
014900     EXEC SQL                                                     01680013
015000          INCLUDE TPURCHS                                         01690013
015100     END-EXEC.                                                    01700013
015200 EJECT                                                            01710013
015300*----------------------------------------------------------------*01720013
015400*  RECEIVER TABLE                                                *01730013
015500*----------------------------------------------------------------*01740013
015600     EXEC SQL                                                     01750013
015700         INCLUDE TRECEIV                                          01760013
015800     END-EXEC.                                                    01770013
015900 EJECT                                                            01780013
016000*----------------------------------------------------------------*01790013
016100*  PURCHASE ORDER ITEMS TABLE                                    *01800013
016200*----------------------------------------------------------------*01810013
016300     EXEC SQL                                                     01820013
016400          INCLUDE TPURITM                                         01830013
016500     END-EXEC.                                                    01840013
016600 EJECT                                                            01850013
016700*----------------------------------------------------------------*01860013
016800*  RECEIPT DISTRIBUTION TABLE                                    *01870013
016900*----------------------------------------------------------------*01880013
017000     EXEC SQL                                                     01890013
017100          INCLUDE TRECDIS                                         01900013
017200     END-EXEC.                                                    01910013
017300 EJECT                                                            01920013
017400*----------------------------------------------------------------*01930013
017500*  RECEIPT ITEMS TABLE                                           *01940013
017600*----------------------------------------------------------------*01950013
017700     EXEC SQL                                                     01960013
017800          INCLUDE TRECITM                                         01970013
017900     END-EXEC.                                                    01980013
018000*----------------------------------------------------------------*01990013
018100*  EXTERNAL ENTERPRISE NAME TABLE                                *02000013
018200*----------------------------------------------------------------*02010013
018300     EXEC SQL                                                     02020013
018400          INCLUDE TENTNME                                         02030013
018500     END-EXEC.                                                    02040013
018600 EJECT                                                            02050013
018700*----------------------------------------------------------------*02060013
018800*  EXTERNAL ENTERPRISE TABLE                                     *02070013
018900*----------------------------------------------------------------*02080013
019000     EXEC SQL                                                     02090013
019100          INCLUDE TEXTENT                                         02100013
019200     END-EXEC.                                                    02110013
019300 EJECT                                                            02120013
019400*----------------------------------------------------------------*02130013
019500*  NON-INVOICED RECEIPTS TABLE                                   *02140013
019600*----------------------------------------------------------------*02150013
019700     EXEC SQL                                                     02160013
019800          INCLUDE TNINREC                                         02170013
019900     END-EXEC.                                                    02180013
020000/                                                                 02190013
020100*                                                                 02200013
020200*    SQL COMMUNICATIONS AREA DCLGEN                               02210013
020300*                                                                 02220013
020400     EXEC SQL                                                     02230013
020500         INCLUDE SQLCA                                            02240013
020600     END-EXEC.                                                    02250013
020700/                                                                 02260013
020800*----------------------------------------------------------------*02270013
020900*    CURSOR DECLARATIONS                                          02280013
021000*----------------------------------------------------------------*02290013
021100*----------------------------------------------------------------*02300013
021200* RECEIV_CSR RETURNS THE RECEIVER COSTS FOR PO'S TO BE PROCESSED. 02310013
021300*      THIS CURSOR DOES NOT CONTAIN A DATE RANGE BECAUSE WE WANT  02320013
021400*      TO RETRIEVE THE ENTIRE VERIFIED COST REGARDLESS OF DATE.   02330013
021500*----------------------------------------------------------------*02340013
021600     EXEC SQL                                                     02350013
021700       DECLARE RECEIV_CSR CURSOR FOR                              02360013
021800         SELECT                                                   02370013
021900              RV.VERFYD_TMST                                      02380013
022000            , RD.AP_PRC_CDE                                       02390013
022100            , SUM(RD.AP_VERIFY_ITM_QTY * PI.UNT_COST_AMT)         02400013
022200            , SUM(RD.AP_VERIFY_ITM_QTY * PI.PRD_1ST_COST_AMT)     02410013
022300         FROM                                                     02420013
022400             TRECEIV RV                                           02430013
022500            ,TPURITM PI                                           02440013
022600            ,TRECDIS RD                                           02450013
022700            ,TRECITM RI                                           02460013
022800         WHERE RV.ORD_NBR        = :PV-PO-NBR                     02470013
022900           AND RV.STATUS_CDE     = 'VE'                           02480013
023000           AND RV.FS_POST_TMST  ^= '9999-09-09-09.09.09.999999'   02490013
023100                                                                  02500013
023200           AND RV.ORD_NBR        = RI.ORD_NBR                     02510013
023300           AND RV.ORD_NBR        = RD.ORD_NBR                     02520013
023400           AND RV.ORD_NBR        = PI.PO_NBR                      02530013
023500                                                                  02540013
023600           AND RV.VER_STATUS_CDE = 'A'                            02550013
023700           AND RI.VER_STATUS_CDE = 'A'                            02560013
023800           AND RD.VER_STATUS_CDE = 'A'                            02570013
023900                                                                  02580013
024000           AND RV.REC_SEQ_NBR    = RI.REC_SEQ_NBR                 02590013
024100           AND RV.REC_SEQ_NBR    = RD.REC_SEQ_NBR                 02600013
024200                                                                  02610013
024300           AND RI.OPER_UNT_ID    = RD.OPER_UNT_ID                 02620013
024400           AND RI.FCLTY_ID       = RD.FCLTY_ID                    02630013
024500                                                                  02640013
024600           AND RI.ORD_LNE_NBR    = RD.ORD_LNE_NBR                 02650013
024700           AND RI.ORD_LNE_NBR    = PI.APP_PO_LNE_NBR              02660013
024800                                                                  02670013
024900           AND RI.PO_VER_NBR     = PI.VER_NBR                     02680013
P46749           AND PI.PO_NBR         = PI.PO_NBR                      02690021
P46749           AND PI.VER_NBR        = PI.VER_NBR                     02700021
P46749           AND PI.PO_LNE_NBR     = PI.PO_LNE_NBR                  02710021
025000         GROUP BY                                                 02720013
025100               RV.VERFYD_TMST                                     02730013
025200             , RD.AP_PRC_CDE                                      02740013
025300         ORDER BY                                                 02750013
025400               RV.VERFYD_TMST  DESC                               02760013
025500             , RD.AP_PRC_CDE                                      02770013
025600     END-EXEC.                                                    02780013
025700/                                                                 02790013
025800*----------------------------------------------------------------*02800013
025900*  ABEND DATA AREAS                                              *02810013
026000*----------------------------------------------------------------*02820013
026100 01  ABEND-CODE                  PIC S9(04)  VALUE ZEROS          02830013
026200                                             COMP SYNC.           02840013
026300     88  AC-MULT-NINREC-RECS                 VALUE +4001.         02850013
026400     88  AC-DB2-ERROR                        VALUE +4013.         02860013
026500                                                                  02870013
026600                                                                  02880013
026700 01  ABEND-AREAS.                                                 02890013
026800     05  AA-ABEND-LIT            PIC  X(40)  VALUE                02900013
026900             '*****       ABEND'.                                 02910013
027000     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                02920013
027100             '*****   PROGRAM: APKUT113'.                         02930013
027200     05  AA-PARAGRAPH-LIT.                                        02940013
027300         10  FILLER              PIC  X(17)  VALUE                02950013
027400             '***** PARAGRAPH: '.                                 02960013
027500         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        02970013
027600     05  AA-MESSAGE-LINE.                                         02980013
027700         10  FILLER              PIC  X(06)  VALUE '*****'.       02990013
027800         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        03000013
027900     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                03010013
028000             '*****    DB2 ERROR'.                                03020013
028100     05  AA-DB2-OPERATION-LIT.                                    03030013
028200         10  FILLER              PIC  X(17)  VALUE                03040013
028300             '***** OPERATION: '.                                 03050013
028400         10  AA-DB2-OPERATION.                                    03060013
028500             15  AA-DB2-OP-1     PIC  X(50)  VALUE SPACES.        03070013
028600             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        03080013
028700     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        03090013
028800     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        03100013
028900     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        03110013
029000     05  AA-DB2-TABLE-4          PIC  X(08)  VALUE SPACES.        03120013
029100     05  AA-DB2-TABLE-5          PIC  X(08)  VALUE SPACES.        03130013
029200                                                                  03140013
029300     COPY DPWS004.                                                03150013
029400                                                                  03160013
029500 01  FILLER                      PIC  X(25)  VALUE                03170013
029600     '** END OF APKUT113 W/S **'.                                 03180013
029700 EJECT                                                            03190013
029800 PROCEDURE DIVISION.                                              03200013
029900 A100-MAIN.                                                       03210013
030000                                                                  03220013
030100     MOVE 'A100-MAIN' TO PV-CURRENT-PARAGRAPH.                    03230013
030200                                                                  03240013
030300     PERFORM B100-INITIALIZE.                                     03250013
030400                                                                  03260013
030500     PERFORM R100-READ-PO-RECORD.                                 03270013
030600     PERFORM B200-PROCESS-PO-REC                                  03280013
030700       UNTIL OUT-OF-POS.                                          03290013
030800                                                                  03300013
030900     PERFORM B300-END-PROGRAM.                                    03310013
031000                                                                  03320013
031100     GOBACK.                                                      03330013
031200                                                                  03340013
031300 EJECT                                                            03350013
031400*----------------------------------------------------------------*03360013
031500*    INITIALIZATION PROCESSING                                   *03370013
031600*    CALLED FROM A100-MAIN                                       *03380013
031700*----------------------------------------------------------------*03390013
031800 B100-INITIALIZE.                                                 03400013
031900                                                                  03410013
032000     MOVE 'B100-INITIALIZE' TO PV-CURRENT-PARAGRAPH.              03420013
032100                                                                  03430013
032200     OPEN INPUT  UNJRNLZD-RECEIPT-PO-FILE                         03440013
032300          INPUT  UNJRNLZD-RECEIPT-DATE-FILE                       03450013
032400          OUTPUT UNJRNLZD-MNTHLY-RCPT-FILE.                       03460013
032500                                                                  03470013
032600     MOVE SPACES TO AP106-RECORD                                  03480013
032700                    AP113-RECORD.                                 03490013
032800     INITIALIZE DCLTPURCHS                                        03500013
032900                DCLTRECEIV                                        03510013
033000                DCLTPURITM                                        03520013
033100                DCLTRECDIS                                        03530013
033200                DCLTRECITM                                        03540013
033300                DCLTENTNME                                        03550013
033400                DCLTEXTENT                                        03560013
033500                AP106-RECORD                                      03570013
033600                AP113-RECORD.                                     03580013
033700                                                                  03590013
033800     PERFORM R500-READ-RECEIPT-DATE-FILE.                         03600013
033900                                                                  03610013
034000 EJECT                                                            03620013
034100*----------------------------------------------------------------*03630013
034200*    PROCESSES EACH JOURNALIZED RECEIPT PO FILE RECORD TO        *03640013
034300*    DETERMINE IF A REPORT DATA RECORD SHOULD BE CREATED.        *03650013
034400*    CALLED FROM A100-MAIN                                       *03660013
034500*----------------------------------------------------------------*03670013
034600 B200-PROCESS-PO-REC.                                             03680013
034700                                                                  03690013
034800     MOVE 'B200-PROCESS-PO-REC'     TO PV-CURRENT-PARAGRAPH.      03700013
034900                                                                  03710013
035000     IF AP106-PO-NBR NOT = PV-PO-NBR                              03720013
035100         MOVE AP106-PO-NBR          TO PV-PO-NBR                  03730013
035200         PERFORM C100-GET-DATA-REC-INFO                           03740013
035300     ELSE                                                         03750013
035400         IF AP106-NON-INVC-RECEIPT                                03760013
035500             DISPLAY 'PO IN PROCESS: ' PV-PO-NBR                  03770013
035600             MOVE PV-CURRENT-PARAGRAPH   TO AA-PARAGRAPH-NAME     03780013
035700             MOVE 'MULTIPLE NON INVC RECEIPT RECORDS'             03790013
035800                                         TO AA-MESSAGE            03800013
035900             SET AC-MULT-NINREC-RECS     TO TRUE                  03810013
036000             PERFORM Z999-ABEND                                   03820013
036100         END-IF                                                   03830013
036200     END-IF.                                                      03840013
036300                                                                  03850013
036400     PERFORM R100-READ-PO-RECORD.                                 03860013
036500                                                                  03870013
036600*----------------------------------------------------------------*03880013
036700*    ENDING PROCESSING: DISPLAYS COUNT OF POS AND CLOSES FILES.  *03890013
036800*    CALLED FROM A100-MAIN                                       *03900013
036900*----------------------------------------------------------------*03910013
037000 B300-END-PROGRAM.                                                03920013
037100                                                                  03930013
037200     MOVE 'B300-END-PROGRAM' TO PV-CURRENT-PARAGRAPH.             03940013
037300                                                                  03950013
037400     CLOSE UNJRNLZD-RECEIPT-PO-FILE                               03960013
037500           UNJRNLZD-RECEIPT-DATE-FILE                             03970013
037600           UNJRNLZD-MNTHLY-RCPT-FILE.                             03980013
037700                                                                  03990013
037800 EJECT                                                            04000013
037900*----------------------------------------------------------------*04010013
038000*    GETS DB2 TABLE INFORMATION WHICH WILL BE USED TO CREATE     *04020013
038100*    UNJOURNALIZED RECEIPT DATA FILE RECORDS.                    *04030013
038200*    CALLED FROM B200-PROCESS-PO-REC                             *04040013
038300*----------------------------------------------------------------*04050013
038400 C100-GET-DATA-REC-INFO.                                          04060013
038500                                                                  04070013
038600     MOVE 'C100-GET-DATA-REC-INFO'  TO PV-CURRENT-PARAGRAPH.      04080013
038700                                                                  04090013
038800     PERFORM R200-GET-PO-DATA.                                    04100013
038900     PERFORM R300-GET-VENDOR.                                     04110013
039000                                                                  04120013
039100     INITIALIZE PV-UNJRNLZD-REC-COST                              04130013
039200                PV-VERIFIED-COST                                  04140013
039300                PS-OUT-OF-RECEIPTS-SW.                            04150013
039400     SET FIRST-UNJOURNALIZED TO TRUE.                             04160013
039500                                                                  04170013
039600     PERFORM Y100-OPEN-RECEIV-CSR.                                04180013
039700     PERFORM R400-FETCH-RECEIV.                                   04190013
039800                                                                  04200013
039900     PERFORM WITH TEST BEFORE                                     04210013
040000       UNTIL OUT-OF-RECEIPTS                                      04220013
040010          IF  PURCHS-PO-TYP-CDE = 'IM' OR 'IE' OR 'IF' OR 'CD'    04230014
040020              ADD PV-TOTAL-COST TO PV-VERIFIED-COST ROUNDED       04240014
040400          ELSE                                                    04250014
040410              ADD PV-TOTAL-FIRST-COST TO PV-VERIFIED-COST ROUNDED 04260014
040600         END-IF                                                   04270013
040700         IF (RECDIS-AP-PRC-CDE     = PC-SPACE OR PC-MATCH)        04280013
040710             IF  PURCHS-PO-TYP-CDE = 'IM' OR 'IE' OR 'IF' OR 'CD' 04290014
040720                 ADD PV-TOTAL-COST TO PV-VERIFIED-COST ROUNDED    04300014
040730             ELSE                                                 04310014
040740                 ADD PV-TOTAL-FIRST-COST TO PV-VERIFIED-COST      04320014
040750                                            ROUNDED               04330014
041030             END-IF                                               04340013
041040             IF FIRST-UNJOURNALIZED                               04350013
041050                MOVE RECEIV-VERFYD-TMST(1:4) TO  AP113-CCYY       04360013
041060                MOVE RECEIV-VERFYD-TMST(6:2) TO  AP113-MM         04370013
041070                SET NOT-FIRST-UNJOURNALIZED TO TRUE               04380013
041080             END-IF                                               04390013
041090         END-IF                                                   04400013
041100         PERFORM R400-FETCH-RECEIV                                04410013
041200     END-PERFORM.                                                 04420013
041300                                                                  04430013
041400     PERFORM Y150-CLOSE-RECEIV-CSR.                               04440013
041500                                                                  04450013
041600     IF AP106-NON-INVC-RECEIPT                                    04460013
041700        PERFORM S100-SELECT-NINREC                                04470013
041800        IF NINREC-REC-TMST(1:4) > AP113-CCYY  OR                  04480013
041900          (NINREC-REC-TMST(1:4) = AP113-CCYY  AND                 04490013
042000           NINREC-REC-TMST(6:2) > AP113-MM)                       04500013
042100           MOVE NINREC-REC-TMST(1:4) TO AP113-CCYY                04510013
042200           MOVE NINREC-REC-TMST(6:2) TO AP113-MM                  04520013
042300        END-IF                                                    04530013
042400     END-IF.                                                      04540013
042500                                                                  04550013
042600     PERFORM W100-WRITE-UNJRNLZD-DATA-REC.                        04560013
042700 EJECT                                                            04570013
042800*----------------------------------------------------------------*04580013
042900*    READS AN UNJOURNALIZED RECEIPT PO FILE RECORD.              *04590013
043000*    CALLED FROM A100-MAIN                                       *04600013
043100*                B200-PROCESS-PO-REC                             *04610013
043200*----------------------------------------------------------------*04620013
043300 R100-READ-PO-RECORD.                                             04630013
043400                                                                  04640013
043500     MOVE 'R100-READ-PO-RECORD' TO PV-CURRENT-PARAGRAPH.          04650013
043600                                                                  04660013
043700     READ UNJRNLZD-RECEIPT-PO-FILE INTO AP106-RECORD              04670013
043800        AT END SET OUT-OF-POS TO TRUE.                            04680013
043900                                                                  04690013
044000 EJECT                                                            04700013
044100*----------------------------------------------------------------*04710013
044200*    RETRIEVES INFO FROM TPURCHS.                                *04720013
044300*    CALLED FROM B200-PROCESS-PO-REC                             *04730013
044400*----------------------------------------------------------------*04740013
044500 R200-GET-PO-DATA.                                                04750013
044600                                                                  04760013
044700     MOVE 'R200-GET-PO-DATA    ' TO PV-CURRENT-PARAGRAPH.         04770013
044800                                                                  04780013
045700     EXEC SQL                                                     04790014
045800         SELECT DEPT_NBR                                          04800014
046000              , TOT_VAL_COST_AMT                                  04810014
046100              , OTB_PER_NBR                                       04820014
046200              , PO_TYP_CDE                                        04830014
046300           INTO :PURCHS-DEPT-NBR                                  04840014
046500              , :PURCHS-TOT-VAL-COST-AMT                          04850014
046600              , :PURCHS-OTB-PER-NBR                               04860014
046700              , :PURCHS-PO-TYP-CDE                                04870014
046800           FROM TPURCHS                                           04880014
047000          WHERE PO_NBR         = :PV-PO-NBR                       04890014
047100            AND VER_STATUS_CDE = 'A'                              04900014
047200     END-EXEC.                                                    04910014
047300                                                                  04920013
047400     EVALUATE TRUE                                                04930014
047500         WHEN SQLCODE = ZERO                                      04940014
047510              CONTINUE                                            04950014
047740         WHEN SQLCODE = +100                                      04960014
047750              MOVE '999'    TO PURCHS-DEPT-NBR                    04970014
047760              MOVE SPACES   TO PURCHS-PO-TYP-CDE                  04980014
047780                                                                  04990014
047790         WHEN SQLWARN0 NOT = SPACES                               05000014
047800         WHEN SQLCODE  NOT = ZERO                                 05010014
047900             MOVE PV-CURRENT-PARAGRAPH  TO AA-PARAGRAPH-NAME      05020014
048100             MOVE 'UNSUCCESSFUL SELECT' TO AA-DB2-OPERATION       05030014
048300             MOVE 'TPURCHS'             TO AA-DB2-TABLE-1         05040014
048800             PERFORM Z998-DB2-ABEND                               05050014
048900     END-EVALUATE.                                                05060016
049100                                                                  05070013
052200 EJECT                                                            05080013
052300*----------------------------------------------------------------*05090013
052400*    RETRIEVES THE VENDOR NAME AND NUMBER.                       *05100013
052500*    NOTE:  A NOT FOUND CONDITION IN THIS INSTANCE WILL RESULT   *05110013
052600*           IN DEFAULT VALUES BEING PLACED IN THE REQUESTED      *05120013
052700*           FIELDS.                                              *05130013
052800*    CALLED FROM B200-PROCESS-PO-REC                             *05140013
052900*----------------------------------------------------------------*05150013
053000 R300-GET-VENDOR.                                                 05160013
053100                                                                  05170013
053200     MOVE 'R300-GET-VENDOR'      TO PV-CURRENT-PARAGRAPH.         05180013
053300                                                                  05190013
054000     EXEC SQL                                                     05200014
054100         SELECT EN.ENT_NAME_DESC                                  05210014
054300              , EE.DUN_NBR                                        05220014
054400           INTO :ENTNME-ENT-NAME-DESC                             05230014
054600              , :EXTENT-DUN-NBR                                   05240014
054700           FROM TENTNME EN                                        05250014
054800              , TEXTENT EE                                        05260014
054900              , TPURCHS PU                                        05270014
055000          WHERE PU.PO_NBR         = :PV-PO-NBR                    05280014
055100            AND PU.VER_STATUS_CDE = 'A'                           05290014
055200            AND PU.ENT_ID         = EE.ENT_ID                     05300014
055300            AND PU.ENT_ID         = EN.ENT_ID                     05310014
055400            AND EN.TYPE_CDE       = '01'                          05320014
055500     END-EXEC.                                                    05330014
055600                                                                  05340013
055700                                                                  05350013
055800     EVALUATE TRUE                                                05360014
055900         WHEN SQLCODE = ZERO                                      05370014
055910              CONTINUE                                            05380014
056000         WHEN SQLCODE = +100                                      05390014
056100              MOVE 'NO VENDOR FOUND' TO ENTNME-ENT-NAME-DESC      05400014
056200              MOVE '999999999'       TO EXTENT-DUN-NBR            05410014
056500         WHEN SQLWARN0 NOT = SPACES                               05420014
056600         WHEN SQLCODE  NOT = ZERO                                 05430014
056700             MOVE PV-CURRENT-PARAGRAPH  TO AA-PARAGRAPH-NAME      05440014
056900             MOVE 'UNSUCCESSFUL SELECT' TO AA-DB2-OPERATION       05450014
057100             MOVE 'TENTNME'             TO AA-DB2-TABLE-1         05460014
057200             MOVE 'TEXTENT'             TO AA-DB2-TABLE-2         05470014
057300             MOVE 'TPURCHS'             TO AA-DB2-TABLE-3         05480014
057600             PERFORM Z998-DB2-ABEND                               05490014
057700     END-EVALUATE.                                                05500014
059200                                                                  05510013
061100 EJECT                                                            05520013
061200*----------------------------------------------------------------*05530013
061300*    RETRIEVES RECEIPT COST INFORMATION.                          05540013
061400*----------------------------------------------------------------*05550013
061500 R400-FETCH-RECEIV.                                               05560013
061600                                                                  05570013
061700     MOVE ' R400-FETCH-RECEIV' TO PV-CURRENT-PARAGRAPH.           05580014
061800                                                                  05590013
061900     EXEC SQL                                                     05600013
062000         FETCH RECEIV_CSR                                         05610013
062100         INTO :RECEIV-VERFYD-TMST                                 05620013
062200            , :RECDIS-AP-PRC-CDE                                  05630013
062300            , :PV-TOTAL-COST                                      05640013
062400            , :PV-TOTAL-FIRST-COST                                05650015
062500     END-EXEC                                                     05660013
062600                                                                  05670013
062700     EVALUATE TRUE                                                05680013
062800         WHEN SQLCODE = +100                                      05690013
062900              SET OUT-OF-RECEIPTS TO TRUE                         05700013
063000         WHEN SQLCODE = ZERO                                      05710013
063100              CONTINUE                                            05720013
063200                                                                  05730013
063300         WHEN SQLWARN0 NOT = SPACES                               05740013
063400         WHEN SQLCODE  NOT = ZERO                                 05750013
063500             MOVE PV-CURRENT-PARAGRAPH                            05760013
063600                              TO AA-PARAGRAPH-NAME                05770013
063700             MOVE 'UNSUCCESSFUL FETCH WITH RECEIV CSR'            05780013
063800                              TO AA-DB2-OP-1                      05790013
063900             MOVE 'TRECEIV'   TO AA-DB2-TABLE-1                   05800013
064000             MOVE SPACES      TO AA-DB2-TABLE-2                   05810013
064100                                 AA-DB2-TABLE-3                   05820013
064200                                 AA-DB2-TABLE-4                   05830013
064300                                 AA-DB2-TABLE-5                   05840013
064400             PERFORM Z998-DB2-ABEND                               05850013
064500     END-EVALUATE.                                                05860013
064600                                                                  05870013
064700 EJECT                                                            05880013
064800***************************************************************** 05890013
064900*  THIS ROUTINE READS THE REPORT DATE FILE FROM APKUT106          05900013
065000*                                                                 05910013
065100***************************************************************** 05920013
065200 R500-READ-RECEIPT-DATE-FILE.                                     05930013
065300                                                                  05940013
065400     MOVE 'R500-READ-RECEIPT-DATE-FILE'                           05950013
065500                                 TO   PV-CURRENT-PARAGRAPH.       05960013
065600                                                                  05970013
065700     READ UNJRNLZD-RECEIPT-DATE-FILE INTO AP108-RECORD            05980013
065800         AT END                                                   05990013
065900             MOVE 'EMPTY UNJOURNALIZED RECEIPT DATES FILE'        06000013
066000                                         TO AA-MESSAGE            06010013
066100             PERFORM Z999-ABEND.                                  06020013
066200                                                                  06030013
066300 EJECT                                                            06040013
066400 S100-SELECT-NINREC.                                              06050013
066500                                                                  06060013
066600     MOVE ' S100-SELECT-NINREC    ' TO PV-CURRENT-PARAGRAPH.      06070013
066700                                                                  06080013
066800     EXEC SQL                                                     06090013
066900         SELECT                                                   06100013
067000               MAX(REC_TMST)                                      06110013
067100         INTO                                                     06120013
067200              :NINREC-REC-TMST                                    06130013
067300         FROM                                                     06140013
067400               TNINREC                                            06150013
067500         WHERE                                                    06160013
067600               PO_NBR                = :PV-PO-NBR                 06170013
067700           AND STATUS_CDE            = '  '                       06180013
067800           AND DATE(REC_TMST)  BETWEEN :AP108-START-DATE AND      06190013
067900                                       :AP108-END-DATE            06200013
068000     END-EXEC                                                     06210013
068100                                                                  06220013
068200     EVALUATE TRUE                                                06230013
068300         WHEN SQLCODE = +100                                      06240013
068400         WHEN SQLCODE = -305                                      06250013
068500              MOVE '0001-01-01' TO RECEIV-REC-TMST                06260013
068600         WHEN SQLCODE = ZERO                                      06270013
068700              CONTINUE                                            06280013
068800                                                                  06290013
068900         WHEN SQLWARN0 NOT = SPACES                               06300013
069000         WHEN SQLCODE  NOT = ZERO                                 06310013
069100             DISPLAY 'PO NUMBER = ' PV-PO-NBR                     06320013
069200             MOVE PV-CURRENT-PARAGRAPH                            06330013
069300                              TO AA-PARAGRAPH-NAME                06340013
069400             MOVE 'UNSUCCESSFUL SELECT FOR MAX(REC_TMST) TNINREC' 06350013
069500                              TO AA-DB2-OP-1                      06360013
069600             MOVE 'TNINREC'   TO AA-DB2-TABLE-1                   06370013
069700             MOVE SPACES      TO AA-DB2-TABLE-2                   06380013
069800                                 AA-DB2-TABLE-3                   06390013
069900                                 AA-DB2-TABLE-4                   06400013
070000                                 AA-DB2-TABLE-5                   06410013
070100             PERFORM Z998-DB2-ABEND                               06420013
070200     END-EVALUATE.                                                06430013
070300                                                                  06440013
070400 EJECT                                                            06450013
070500*----------------------------------------------------------------*06460013
070600*    WRITES THE UNJOURNALIZED RECEIPT PO FILE RECORDS.           *06470013
070700*----------------------------------------------------------------*06480013
070800 W100-WRITE-UNJRNLZD-DATA-REC.                                    06490013
070900                                                                  06500013
071000     MOVE 'W100-WRITE-UNJRNLZD-DATA-REC' TO PV-CURRENT-PARAGRAPH. 06510013
071100                                                                  06520013
071200     MOVE ENTNME-ENT-NAME-DESC     TO AP113-VENDOR-NAME.          06530013
071300     MOVE PV-PO-NBR                TO AP113-PO-NBR.               06540013
071400     MOVE EXTENT-DUN-NBR           TO AP113-VENDOR-NUMBER.        06550013
071500     MOVE PURCHS-DEPT-NBR          TO AP113-DEPT.                 06560013
071600     MOVE PURCHS-TOT-VAL-COST-AMT  TO AP113-PO-COST.              06570013
071700     MOVE PURCHS-OTB-PER-NBR       TO AP113-OTB-PER-NBR.          06580013
071800     MOVE PV-VERIFIED-COST         TO AP113-VERIFIED-COST.        06590013
071900     SUBTRACT AP113-VERIFIED-COST FROM AP113-PO-COST              06600013
072000           GIVING AP113-VER-EXCEPTION-AMT.                        06610013
072100     IF AP106-NON-INVC-RECEIPT                                    06620013
072200         MOVE AP106-NR-TOTAL-COST  TO AP113-UNJRNLZD-NIR          06630013
072300     ELSE                                                         06640013
072400         MOVE ZERO                 TO AP113-UNJRNLZD-NIR.         06650013
072500     MOVE PV-UNJRNLZD-REC-COST     TO AP113-UNJRNLZD-RECEIVER.    06660013
072600                                                                  06670013
072700     WRITE UNJRNLZD-MNTHLY-RCPT-RECORD FROM AP113-RECORD.         06680013
072800                                                                  06690013
072900 EJECT                                                            06700013
073000*----------------------------------------------------------------*06710013
073100*    OPENS THE RECEIVE CURSOR.                                   *06720013
073200*----------------------------------------------------------------*06730013
073300 Y100-OPEN-RECEIV-CSR.                                            06740013
073400                                                                  06750013
073500     MOVE 'Y100-OPEN-RECEIV-CSR' TO PV-CURRENT-PARAGRAPH.         06760013
073600                                                                  06770013
073700     PERFORM WITH TEST AFTER                                      06780013
073800             VARYING PV-RETRY-COUNT FROM 1 BY 1                   06790013
073900             UNTIL   PV-RETRY-COUNT > PC-RETRY-MAX OR             06800013
074000                     SQLCODE = ZERO                               06810013
074100                                                                  06820013
074200             EXEC SQL                                             06830013
074300                 OPEN RECEIV_CSR                                  06840013
074400             END-EXEC                                             06850013
074500                                                                  06860013
074600             EVALUATE TRUE                                        06870013
074700                 WHEN SQLCODE = ZERO                              06880013
074800                 WHEN SQLCODE = -904                              06890013
074900                 WHEN SQLCODE = -911                              06900013
075000                 WHEN SQLCODE = -913                              06910013
075100                      CONTINUE                                    06920013
075200                                                                  06930013
075300                 WHEN SQLWARN0 NOT = SPACES                       06940013
075400                 WHEN SQLCODE  NOT = ZERO                         06950013
075500                     MOVE PV-CURRENT-PARAGRAPH                    06960013
075600                                         TO AA-PARAGRAPH-NAME     06970013
075700                     MOVE 'UNSUCCESSFUL OPEN ON RECEIV_CSR'       06980013
075800                                         TO AA-DB2-OPERATION      06990013
075900                     MOVE 'TRECEIV'      TO AA-DB2-TABLE-1        07000013
076000                     MOVE 'TPURITM'      TO AA-DB2-TABLE-2        07010013
076100                     MOVE 'TRECDIS'      TO AA-DB2-TABLE-3        07020013
076200                     MOVE 'TRECITM'      TO AA-DB2-TABLE-4        07030013
076300                     MOVE SPACES         TO AA-DB2-TABLE-5        07040013
076400                     PERFORM Z998-DB2-ABEND                       07050013
076500             END-EVALUATE                                         07060013
076600     END-PERFORM.                                                 07070013
076700                                                                  07080013
076800     IF PV-RETRY-COUNT > PC-RETRY-MAX                             07090013
076900         MOVE PV-CURRENT-PARAGRAPH                                07100013
077000                             TO AA-PARAGRAPH-NAME                 07110013
077100         MOVE 'MAX RETRIES EXCEEDED ON OPEN FOR RECEIV_CSR'       07120013
077200                             TO AA-DB2-OPERATION                  07130013
077300         MOVE 'TRECEIV'      TO AA-DB2-TABLE-1                    07140013
077400         MOVE 'TPURITM'      TO AA-DB2-TABLE-2                    07150013
077500         MOVE 'TRECDIS'      TO AA-DB2-TABLE-3                    07160013
077600         MOVE 'TRECITM'      TO AA-DB2-TABLE-4                    07170013
077700         MOVE SPACES         TO AA-DB2-TABLE-5                    07180013
077800         PERFORM Z998-DB2-ABEND                                   07190013
077900     END-IF.                                                      07200013
078000                                                                  07210013
078100 EJECT                                                            07220013
078200*----------------------------------------------------------------*07230013
078300*    CLOSES THE RECEIV CURSOR                                    *07240013
078400*----------------------------------------------------------------*07250013
078500 Y150-CLOSE-RECEIV-CSR.                                           07260013
078600                                                                  07270013
078700     MOVE 'Y150-CLOSE-RECEIV-CSR' TO PV-CURRENT-PARAGRAPH.        07280013
078800                                                                  07290013
078900     PERFORM WITH TEST AFTER                                      07300013
079000             VARYING PV-RETRY-COUNT FROM 1 BY 1                   07310013
079100             UNTIL   PV-RETRY-COUNT > PC-RETRY-MAX OR             07320013
079200                     SQLCODE = ZERO                               07330013
079300                                                                  07340013
079400             EXEC SQL                                             07350013
079500                 CLOSE RECEIV_CSR                                 07360013
079600             END-EXEC                                             07370013
079700                                                                  07380013
079800             EVALUATE TRUE                                        07390013
079900                 WHEN SQLCODE = ZERO                              07400013
080000                 WHEN SQLCODE = -904                              07410013
080100                 WHEN SQLCODE = -911                              07420013
080200                 WHEN SQLCODE = -913                              07430013
080300                      CONTINUE                                    07440013
080400                                                                  07450013
080500                 WHEN SQLWARN0 NOT = SPACES                       07460013
080600                 WHEN SQLCODE  NOT = ZERO                         07470013
080700                     MOVE PV-CURRENT-PARAGRAPH                    07480013
080800                                         TO AA-PARAGRAPH-NAME     07490013
080900                     MOVE 'UNSUCCESSFUL CLOSE ON RECEIV_CSR'      07500013
081000                                         TO AA-DB2-OPERATION      07510013
081100                     MOVE 'TRECEIV'      TO AA-DB2-TABLE-1        07520013
081200                     MOVE 'TPURITM'      TO AA-DB2-TABLE-2        07530013
081300                     MOVE 'TRECDIS'      TO AA-DB2-TABLE-3        07540013
081400                     MOVE 'TRECITM'      TO AA-DB2-TABLE-4        07550013
081500                     MOVE SPACES         TO AA-DB2-TABLE-5        07560013
081600                     PERFORM Z998-DB2-ABEND                       07570013
081700             END-EVALUATE                                         07580013
081800     END-PERFORM.                                                 07590013
081900                                                                  07600013
082000     IF PV-RETRY-COUNT > PC-RETRY-MAX                             07610013
082100         MOVE PV-CURRENT-PARAGRAPH                                07620013
082200                             TO AA-PARAGRAPH-NAME                 07630013
082300         MOVE 'MAX RETRIES EXCEEDED ON CLOSE FOR RECEIV_CSR'      07640013
082400                             TO AA-DB2-OPERATION                  07650013
082500         MOVE 'TRECEIV'      TO AA-DB2-TABLE-1                    07660013
082600         MOVE 'TPURITM'      TO AA-DB2-TABLE-2                    07670013
082700         MOVE 'TRECDIS'      TO AA-DB2-TABLE-3                    07680013
082800         MOVE 'TRECITM'      TO AA-DB2-TABLE-4                    07690013
082900         MOVE SPACES         TO AA-DB2-TABLE-5                    07700013
083000         PERFORM Z998-DB2-ABEND                                   07710013
083100     END-IF.                                                      07720013
083200 EJECT                                                            07730013
083300*----------------------------------------------------------------*07740013
083400*    ABEND ROUTINE FOR DB2 ERRORS                                *07750013
083500*----------------------------------------------------------------*07760013
083600 Z998-DB2-ABEND.                                                  07770013
083700                                                                  07780013
083800     DISPLAY AA-ABEND-LIT.                                        07790013
083900     DISPLAY AA-DB2-ERROR-LIT.                                    07800013
084000     DISPLAY AA-PROGRAM-LIT.                                      07810013
084100     DISPLAY AA-PARAGRAPH-LIT.                                    07820013
084200     DISPLAY AA-DB2-OPERATION-LIT.                                07830013
084300     DISPLAY AA-DB2-TABLE-1.                                      07840013
084400     DISPLAY AA-DB2-TABLE-2.                                      07850013
084500     DISPLAY AA-DB2-TABLE-3.                                      07860013
084600     DISPLAY AA-DB2-TABLE-4.                                      07870013
084700     SET AC-DB2-ERROR TO TRUE.                                    07880013
084800                                                                  07890013
084900     COPY DPPD004.                                                07900013
085000                                                                  07910013
085100     CALL 'ILBOABN0' USING ABEND-CODE.                            07920013
085200 EJECT                                                            07930013
085300*----------------------------------------------------------------*07940013
085400*    ABEND ROUTINE                                               *07950013
085500*----------------------------------------------------------------*07960013
085600 Z999-ABEND.                                                      07970013
085700                                                                  07980013
085800     DISPLAY AA-ABEND-LIT.                                        07990013
085900     DISPLAY AA-PROGRAM-LIT.                                      08000013
086000     DISPLAY AA-PARAGRAPH-LIT.                                    08010013
086100     DISPLAY AA-MESSAGE-LINE.                                     08020013
086200     CALL 'ILBOABN0' USING ABEND-CODE.                            08030013
