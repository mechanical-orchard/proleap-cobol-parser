000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS113.                                         00040000
000500 AUTHOR.        ANNE YEKO.                                        00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  03-09-93.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*----------------------------------------------------------------*00100000
001100*    E113 - CARTON LABEL REQUEST                                 *00110000
001200*                                                                *00120000
001300*    THIS PROGRAM ALLOWS THE USER TO ENTER CRITERIA ABOUT A      *00130000
001400*    CARTON LABEL.  WHEN THE "ADD" PF KEY IS DEPRESSED, THE      *00140000
001500*    PROGRAM WILL DETERMINE WHETHER THE TRANSACTION WAS STARTED  *00150000
001600*    FROM THE MENU OR FROM THE HEADER LABEL PROGRAM.  IF IT      *00160000
001700*    CAME FROM THE HEADER LABEL PROGRAM, THE HEADER LABELS WILL  *00170000
001800*    BE PRINTED BEFORE THE CARTON LABELS.                        *00180000
001900*                                                                *00190000
002000*    02/18/94 ST  CONVERT FROM IMS TO DB2                        *00200000
002100*             DH                                                 *00210000
002200*----------------------------------------------------------------*00220000
002300*  CHANGED 10/13/2014    BY COGNIZANT       WR: CHG0094517        00230019
002400*                                                                 00240019
002500* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00250019
002501*-----------------------------------------------------------------00250119
002502* DATE  11/04/2021                                                00250221
002503*            - CHANGE CALL OF 'DPKUT100' TO                     * 00250321
002504*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00250421
002505*              MAKING THE CALL DYNAMIC VS STATIC                * 00250521
002506*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00250622
1122RM*---------------------------------------------------------------- 00250723
1122RM* DATE  11/07/2022                                              * 00250823
1122RM*            - ADD COPYBOOK DPWS930                             * 00250923
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00251023
1122RM*              DYNAMIC.                                         * 00251123
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00251223
002507*-----------------------------------------------------------------00251321
002508                                                                  00251400
002509 ENVIRONMENT DIVISION.                                            00251500
002510                                                                  00252000
002600 DATA DIVISION.                                                   00260000
002700                                                                  00270000
002800 WORKING-STORAGE SECTION.                                         00280000
002900                                                                  00290000
003000 01  PC-PROGRAM-CONSTANTS.                                        00300000
003100     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'PC113A  '.  00310000
003200     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'PCKM113 '.  00320000
003300     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'PCKCS113'.  00330000
003400     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00340000
003500                                              COMP.               00350000
003600     05  PC-ENROUTE               PIC  X(07)  VALUE  'ENROUTE'.   00360000
003700     05  PC-LABEL-FORMAT          PIC  9(03)  VALUE  2.           00370000
003800     05  PC-PROCESS-AREA          PIC  X(02)  VALUE  'P '.        00380000
003900     05  PC-ENTRY-FROM-PCAHDR     PIC  X(01)  VALUE  '1'.         00390000
004000     05  PC-STARTING-CNT          PIC  X(04)  VALUE  '1   '.      00400000
004100     05  PC-PRE-TICKETED          PIC  X(15)  VALUE               00410000
004200         'PRE TICKETED   '.                                       00420000
004300     05  PC-ON-HANGER             PIC  X(09)  VALUE               00430000
004400         'ON HANGER'.                                             00440000
004500     05  PC-MULTIPLE-SHIPMENTS    PIC  X(18)  VALUE               00450000
004600         'MULTIPLE SHIPMENTS'.                                    00460000
004700     05  PC-DETAIL-CHECK          PIC  X(12)  VALUE               00470000
004800         'DETAIL CHECK'.                                          00480000
004900     05  PC-Y                     PIC  X(01)  VALUE  'Y'.         00490000
005000     05  PC-N                     PIC  X(01)  VALUE  'N'.         00500000
005100     05  PC-A                     PIC  X(01)  VALUE  'A'.         00510000
005110     05  PC-90                    PIC  X(02)  VALUE '90'.         00511000
005200     05  PC-01                    PIC  X(02)  VALUE  '01'.        00520000
005300     05  PC-PRTR-VALIDATION-PGM   PIC  X(08)  VALUE  'DPKCS060'.  00530000
005400                                                                  00540000
005500     05  PC-TSYMSG-NUMBERS.                                       00550000
005600         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00560000
005700*            INVALID VALUE                                        00570000
005800         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00580000
005900*            REQUIRED ENTRY                                       00590000
006000         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00600000
006100*            MUST BE NUMERIC                                      00610000
006200         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       00620000
006300*            INVALID DATE                                         00630000
006400         10  PC-TSYMSG-00083      PIC  9(05)  VALUE  00083.       00640000
006500*            PO NOT FOUND                                         00650000
006510         10  PC-TSYMSG-00098      PIC  9(05)  VALUE  00098.       00651000
006520*            PRINT SUCCESSFUL                                     00652000
006600         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00660000
006700*            INVALID PRINTER DESTINATION                          00670000
006701         10  PC-TSYMSG-00984      PIC  9(05)  VALUE  00984.       00670119
006702*            DATABASE IS BUSY - TRY AGAIN IN A FEW MINUTES        00670200
006710         10  PC-TSYMSG-02122      PIC  9(05)  VALUE  02122.       00671000
006720*            SOCKET ERROR                                         00672000
006800     05  PC-OPER-UNT-ID               PIC S9(04) VALUE +0         00680000
006900                                                 COMP.            00690000
007000     05  PC-FCLTY-ID                  PIC S9(04) VALUE +0         00700000
007100                                                 COMP.            00710000
007200                                                                  00720000
007300 01  PM-PROGRAM-MESSAGES.                                         00730000
007400     05  PM-PROGRAM-MESSAGE-1.                                    00740000
007500         10  FILLER               PIC  X(54)  VALUE               00750000
007600         'ERROR TRYING TO SCHEDULE PSB - PCKCS113-RETURN CODE = '.00760000
007700         10  PM-IMS-CODE-1        PIC X(02)   VALUE SPACES.       00770000
007800         10  FILLER               PIC X(20)   VALUE SPACES.       00780000
007900     05  PM-PROGRAM-MESSAGE-2.                                    00790000
008000         10  FILLER               PIC  X(54)  VALUE               00800000
008100         'ERROR TRYING TO TERMINATE PSB- PCKCS113-RETURN CODE = '.00810000
008200         10  PM-IMS-CODE-2        PIC X(02)   VALUE SPACES.       00820000
008300         10  FILLER               PIC X(20)   VALUE SPACES.       00830000
008400     05  PM-PROGRAM-MESSAGE-3.                                    00840000
008500         10  FILLER               PIC  X(54)  VALUE               00850000
008600         'ERROR DURING GU OF CRC100DS - PCKCS113  RETURN CODE = '.00860000
008700         10  PM-IMS-CODE-3        PIC X(02)   VALUE SPACES.       00870000
008800         10  FILLER               PIC X(20)   VALUE SPACES.       00880000
008900     05  PM-PROGRAM-MESSAGE-4.                                    00890000
009000         10  FILLER               PIC  X(54)  VALUE               00900000
009100         'ERROR DURING GU OF CPO100DS - PCKCS113  RETURN CODE = '.00910000
009200         10  PM-IMS-CODE-4        PIC X(02)   VALUE SPACES.       00920000
009300         10  FILLER               PIC X(20)   VALUE SPACES.       00930000
009400     05  PM-PROGRAM-MESSAGE-5.                                    00940000
009500         10  FILLER               PIC  X(54)  VALUE               00950000
009600         'ERROR DURING GNP OF CRC320DS -PCKCS113- RETURN CODE = '.00960000
009700         10  PM-IMS-CODE-5        PIC X(02)   VALUE SPACES.       00970000
009800         10  FILLER               PIC X(20)   VALUE SPACES.       00980000
009900     05  PM-PROGRAM-MESSAGE-6.                                    00990000
010000         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       01000000
010100         10  FILLER               PIC  X(01)  VALUE '-'.          01010000
010200         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       01020000
010300         10  FILLER               PIC  X(48)  VALUE SPACES.       01030000
010400                                                                  01040000
010500 01  PS-PROGRAM-SWITCHES.                                         01050000
010600     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01060000
010700         88  PS-ERROR                         VALUE  'Y'.         01070000
010800         88  PS-NO-ERROR                      VALUE  'N'.         01080000
010900     05  PS-PO-FOUND-SW           PIC  X(01)  VALUE  'Y'.         01090000
011000         88  PS-PO-FOUND                      VALUE  'Y'.         01100000
011100         88  PS-PO-NOT-FOUND                  VALUE  'N'.         01110000
011200     05  PS-PO-LNE-FOUND-SW       PIC  X(01)  VALUE  'Y'.         01120000
011300         88  PS-PO-LNE-FOUND                  VALUE  'Y'.         01130000
011400         88  PS-PO-LNE-NOT-FOUND              VALUE  'N'.         01140000
011500     05  PS-VALID-RECEIVER-SW     PIC  X(01)  VALUE  'N'.         01150000
011600         88  PS-VALID-RECEIVER                VALUE  'Y'.         01160000
011700         88  PS-NOT-VALID-RECEIVER            VALUE  'N'.         01170000
011800     05  PS-VALID-PO-SW           PIC  X(01)  VALUE  'N'.         01180000
011900         88  PS-VALID-PO                      VALUE  'Y'.         01190000
012000         88  PS-NOT-VALID-PO                  VALUE  'N'.         01200000
012100     05  PS-VALID-RCVR-PO-SW      PIC  X(01)  VALUE  'N'.         01210000
012200         88  PS-VALID-RCVR-PO                 VALUE  'Y'.         01220000
012300         88  PS-NOT-VALID-RCVR-PO             VALUE  'N'.         01230000
012400     05  PS-NEW-RCVR-SW           PIC  X(01)  VALUE  'N'.         01240000
012500         88  PS-NEW-RCVR                      VALUE  'Y'.         01250000
012600         88  PS-NOT-NEW-RCVR                  VALUE  'N'.         01260000
012700     05  FACILITY-EDIT-SW         PIC  X(01)  VALUE  ' '.         01270000
012800         88  ERROR-ON-FACILITY-EDIT           VALUE  ' '.         01280000
012900         88  NO-ERROR-ON-FACILITY-EDIT        VALUE  'X'.         01290000
013000     05  OP-UNIT-EDIT-SW          PIC  X(01)  VALUE  ' '.         01300000
013100         88  ERROR-ON-OP-UNIT-EDIT            VALUE  ' '.         01310000
013200         88  NO-ERROR-ON-OP-UNIT-EDIT         VALUE  'X'.         01320000
013300     05  PRINTER-EDIT-SW          PIC  X(01)  VALUE  ' '.         01330000
013400         88  ERROR-ON-PRINTER-EDIT            VALUE  ' '.         01340000
013500         88  NO-ERROR-ON-PRINTER-EDIT         VALUE  'X'.         01350000
013600                                                                  01360000
013700 01  PV-PROGRAM-VARIABLES.                                        01370000
013800     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01380000
013900                                              COMP SYNC.          01390000
014000     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01400000
014100                                              COMP SYNC.          01410000
014200     05  PV-OPER-UNT-ID           PIC S9(04)  VALUE +0            01420000
014300                                              COMP.               01430000
014400     05  PV-PRINTER-ID            PIC S9(03)  VALUE +0            01440000
014500                                              COMP.               01450000
014600     05  PV-FCLTY-ID              PIC S9(04)  VALUE +0            01460000
014700                                              COMP.               01470000
014800     05  PV-QUOTIENT              PIC 9(02)   VALUE ZERO          01480000
014900                                              COMP.               01490000
015000     05  PV-REMAIN                PIC 9(02)   VALUE ZERO          01500000
015100                                              COMP.               01510000
015200     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            01520000
015300                                              COMP.               01530000
015400     05  PV-RCVR-SEQ-NBR          PIC S9(3)   VALUE +0            01540000
015500                                              COMP.               01550000
015600     05  PV-APP-PO-LNE-NBR        PIC S9(4)   VALUE +0            01560000
015700                                              COMP.               01570000
015800     05  PV-PO-NBR                PIC S9(8)   VALUE +0            01580000
015900                                              COMP.               01590000
016000     05  PV-DISPLAY-ORD-NBR       PIC 9(08)   VALUE ZEROS.        01600000
016100     05  PV-DISPLAY-PO-LNE-NBR    PIC 9(04)   VALUE ZEROS.        01610000
016200     05  PV-COUNT                 PIC S9(04)  VALUE +0            01620000
016300                                              COMP.               01630000
017000     05  PV-FORMAT-DATE.                                          01700000
017100         10  PV-MM                PIC X(02)   VALUE SPACES.       01710000
017200         10  FILLER               PIC X(01)   VALUE '-'.          01720000
017300         10  PV-DD                PIC X(02)   VALUE SPACES.       01730000
017400         10  FILLER               PIC X(01)   VALUE '-'.          01740000
017500         10  PV-YY                PIC X(02)   VALUE SPACES.       01750000
017600     05  PV-MMDDYY                PIC 9(07)   VALUE ZEROS.        01760000
017700     05  FILLER  REDEFINES  PV-MMDDYY.                            01770000
017800         10  FILLER               PIC X(01).                      01780000
017900         10  PV-MMDDYY-MM         PIC X(02).                      01790000
018000         10  PV-MMDDYY-DD         PIC X(02).                      01800000
018100         10  PV-MMDDYY-YY         PIC X(02).                      01810000
018200     05  PV-ECA-POINTER           PIC S9(08)  VALUE ZEROS         01820000
018300                                              COMP.               01830000
018400     05  PV-PICX-FOUR             PIC X(04)   VALUE SPACES.       01840000
018500     05  PV-PIC9-FOUR REDEFINES                                   01850000
018600         PV-PICX-FOUR             PIC 9(04).                      01860000
018700     05  PV-SUPPRESS-FOUR         PIC ZZZ9.                       01870000
018701     05 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.      01870100
018702     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          01870200
018703         10 FILLER                   PIC  X(03).                  01870300
018704         10 PV-2-DIGIT-DC-ABBR       PIC  X(02).                  01870400
018710                                                                  01871000
018800 EJECT                                                            01880000
018900*----------------------------------------------------------------*01890000
019000*  SENDING/RECEIVING AREA FOR THE                                *01900000
019100*  PRINTER VALIDATION ROUTING (DPKCS060)                         *01910000
019200*----------------------------------------------------------------*01920000
019300     COPY DPWS072.                                                01930000
019400                                                                  01940000
019500 EJECT                                                            01950000
019600*----------------------------------------------------------------*01960000
019700*    CALLING PARMS USED TO COMMUNICATE TO ARCH PROGRAM DPKCS030  *01970000
019800*----------------------------------------------------------------*01980000
019900     COPY DPWS030.                                                01990000
1122RM     COPY DPWS930.                                                01991023
020000                                                                  02000000
020100 EJECT                                                            02010000
020200*----------------------------------------------------------------*02020000
020300*    NUMERIC EDIT COPYBOOK                                       *02030000
020400*----------------------------------------------------------------*02040000
020500     COPY DPWS010I.                                               02050000
020600                                                                  02060000
020700 EJECT                                                            02070000
020800*----------------------------------------------------------------*02080000
020900*    DATE VALIDATION COPYBOOK FOR THE DATE ROUTINE DPKUT500      *02090000
021000*----------------------------------------------------------------*02100000
021100     COPY DPWS500.                                                02110000
021200                                                                  02120000
021300 EJECT                                                            02130000
021400*----------------------------------------------------------------*02140000
021500*    CURRENT DATE AND TIME COPYBOOK                              *02150000
021600*----------------------------------------------------------------*02160000
021700     COPY DPWS017.                                                02170000
021800                                                                  02180000
021900 EJECT                                                            02190000
022000*----------------------------------------------------------------*02200000
022100*    STANDARD COMMAREA.                                          *02210000
022200*----------------------------------------------------------------*02220000
022300                                                                  02230000
022400     COPY DPWS020.                                                02240000
022500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02250000
022600                                                                  02260000
022700*----------------------------------------------------------------*02270000
022800*    INTER-APPLICATION COMMAREA.                                 *02280000
022900*----------------------------------------------------------------*02290000
023000                                                                  02300000
023100         10  INTER-APPL-COMM-AREA PIC X(200).                     02310000
023200     COPY PCWS014.                                                02320000
023300*----------------------------------------------------------------*02330000
023400*    SPECIFIC COMMMAREA FOR PCKCS113.                            *02340000
023500*----------------------------------------------------------------*02350000
023600         10  ASC-SPECIFIC-COMMAREA.                               02360000
023700             15  ASC-ADD-COMPLETE-SW         PIC  X(01).          02370000
023800                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.02380000
023900                 88  ASC-ADD-PENDING                    VALUE 'N'.02390000
024000             15  ASC-PRTR-ID                 PIC X(03).           02400000
024100             15  ASC-PRTR-ID-N REDEFINES                          02410000
024200                 ASC-PRTR-ID                 PIC  9(03).          02420000
024300             15  ASC-PRTR-DESC               PIC  X(25).          02430000
024400             15  FILLER                      PIC  X(08).          02440000
024500             15  ASC-PRC-AREA                PIC  X(06).          02450000
024600             15  ASC-PRC-AREA-CDE            PIC  X(03).          02460000
024700             15  ASC-PO-NBR                  PIC  X(08).          02470000
024800             15  ASC-PO-NBR-N  REDEFINES                          02480000
024900                 ASC-PO-NBR                  PIC  9(08).          02490000
025000             15  ASC-RCVR-SEQ-NBR.                                02500000
025100                 20  ASC-RCVR-SEQ-NBR-N      PIC  9(03).          02510000
025200             15  ASC-PO-NBR-OLD              PIC  X(08).          02520000
025300             15  ASC-RCVR-SEQ-NBR-OLD        PIC  X(03).          02530000
025400             15  ASC-PO-LNE-NBR              PIC  X(04).          02540000
025500             15  ASC-PO-LNE-NBR-N  REDEFINES                      02550000
025600                 ASC-PO-LNE-NBR              PIC  9(04).          02560000
025700             15  ASC-PO-LNE-NBR-OLD          PIC  X(04).          02570000
025800             15  ASC-RCVD-DATE.                                   02580000
025900                 20  ASC-RCVD-MM             PIC  X(02).          02590000
026000                 20  ASC-RCVD-MM-N  REDEFINES                     02600000
026100                     ASC-RCVD-MM             PIC  9(02).          02610000
026200                 20  ASC-RCVD-DD             PIC  X(02).          02620000
026300                 20  ASC-RCVD-DD-N  REDEFINES                     02630000
026400                     ASC-RCVD-DD             PIC  9(02).          02640000
026500                 20  ASC-RCVD-YY             PIC  X(02).          02650000
026600                 20  ASC-RCVD-YY-N  REDEFINES                     02660000
026700                     ASC-RCVD-YY             PIC  9(02).          02670000
026800             15  ASC-RCVD-DESC               PIC  X(07).          02680000
026900             15  ASC-STRT-VALUE.                                  02690000
027000                 20  ASC-STRT-VALUE-N        PIC  9(04).          02700000
027100             15  ASC-OF-TOTAL-NO.                                 02710000
027200                 20  ASC-OF-TOTAL-NO-N       PIC  9(04).          02720000
027300             15  ASC-TOTAL-LABELS.                                02730000
027400                 20  ASC-TOTAL-LABELS-N      PIC  9(04).          02740000
027500             15  ASC-HDR-LBL-FIELDS.                              02750000
027600                 20  ASC-HL-LBL-FMT          PIC  9(03).          02760000
027700                     88  ASC-HL-HDR-LBL           VALUE 1.        02770000
027800                 20  ASC-HL-PRTR-ID          PIC  9(03).          02780000
027900                 20  ASC-HL-PRTR-DESC        PIC  X(25).          02790000
028000                 20  FILLER                  PIC  X(08).          02800000
028100                 20  ASC-HL-PRC-AREA         PIC  X(06).          02810000
028200                 20  ASC-HL-PRC-AREA-CDE     PIC  X(04).          02820000
028300                 20  ASC-HL-CART-CT          PIC  X(04).          02830000
028400                 20  ASC-HL-PO-NBR           PIC  X(08).          02840000
028500                 20  ASC-HL-RCVR-NBR         PIC  X(11).          02850000
028600                 20  ASC-HL-RCVR-SEQ-NBR-TX  PIC  X(03).          02860000
028700                 20  ASC-HL-RCVD-DATE.                            02870000
028800                     25  ASC-HL-RCVD-MM      PIC  X(02).          02880000
028900                     25  FILLER              PIC  X(01).          02890000
029000                     25  ASC-HL-RCVD-DD      PIC  X(02).          02900000
029100                     25  FILLER              PIC  X(01).          02910000
029200                     25  ASC-HL-RCVD-YY      PIC  X(02).          02920000
029300                 20  ASC-HL-VEND-NAME        PIC  X(25).          02930000
029400                 20  ASC-HL-AD-DATE          PIC  X(08).          02940000
029500                 20  ASC-HL-PIC-INFO         PIC  X(08).          02950000
029600                 20  ASC-HL-SPECIAL-INST     PIC  X(25).          02960000
029700                 20  ASC-HL-MULT-SHIPMENTS   PIC  X(01).          02970000
029800                 20  ASC-HL-PRE-TKT          PIC  X(01).          02980000
029900                 20  ASC-HL-PACKED-BY-STR    PIC  X(15).          02990000
030000                 20  ASC-HL-TICKET-TYPE      PIC  X(06).          03000000
030100                 20  ASC-HL-DETAIL-CHECK     PIC  X(01).          03010000
030200                 20  ASC-HL-GARMENT-ON-HANGER                     03020000
030300                                             PIC  X(01).          03030000
030400                 20  ASC-HL-DEPT             PIC  X(03).          03040000
030500                 20  ASC-HL-CLASS            PIC  X(02).          03050000
030510                 20  ASC-HL-TRIP-ID          PIC  X(09).          03051000
030600             15  ASC-OPER-UNT-ID             PIC X(04).           03060000
030700             15  ASC-OPER-UNT-ID-N REDEFINES                      03070000
030800                 ASC-OPER-UNT-ID             PIC 9(04).           03080000
030900             15  ASC-FCLTY-ID                PIC X(04).           03090000
031000             15  ASC-FCLTY-ID-N       REDEFINES                   03100000
031100                 ASC-FCLTY-ID                PIC 9(04).           03110000
031200             15  ASC-DIVERT-CDE              PIC X(04).           03120000
031300             15  ASC-OP-UNIT-NAME            PIC X(24).           03130000
031400     EJECT                                                        03140000
032001*----------------------------------------------------------------*03200100
032002*    CARTON LABEL COPYBOOK  (SOCKETS)                            *03200200
032003*----------------------------------------------------------------*03200300
032010     COPY PCWS140.                                                03201000
032011/                                                                 03201119
032020*   DOMAIN ITEM MODULE                                            03202000
032021     COPY XLWS001.                                                03202119
032022/                                                                 03202200
032100*----------------------------------------------------------------*03210000
032200*    ABEND PROCESSING COPYBOOK.                                  *03220000
032300*----------------------------------------------------------------*03230000
032400                                                                  03240000
032500     COPY DPWS013.                                                03250000
032600                                                                  03260000
032700     EJECT                                                        03270000
032800*----------------------------------------------------------------*03280000
032900*    ATTRIBUTE SETTINGS COPYBOOK.                                *03290000
033000*----------------------------------------------------------------*03300000
033100                                                                  03310000
033200     COPY DPWS015.                                                03320000
033300                                                                  03330000
033400*----------------------------------------------------------------*03340000
033500*    FUNCTION KEYS COPYBOOK                                      *03350000
033600*----------------------------------------------------------------*03360000
033700                                                                  03370000
033800     COPY DPWS016.                                                03380000
033900                                                                  03390000
034000*----------------------------------------------------------------*03400000
034100*    MAP LAYOUT                                                  *03410000
034200*----------------------------------------------------------------*03420000
034300                                                                  03430000
034400     COPY PCKM113.                                                03440000
034500                                                                  03450000
034600 EJECT                                                            03460000
034700                                                                  03470000
034800*    DB2 AREA FOR TSTATCD  (STATUS CODE)                          03480000
034900                                                                  03490000
035000     EXEC SQL                                                     03500000
035100          INCLUDE TSTATCD                                         03510000
035200     END-EXEC.                                                    03520000
035300                                                                  03530000
035400*    DB2 AREA FOR TRECEIV  (RECEIVER TABLE)                       03540000
035500                                                                  03550000
035600     EXEC SQL                                                     03560000
035700          INCLUDE TRECEIV                                         03570000
035800     END-EXEC.                                                    03580000
035900                                                                  03590000
036000                                                                  03600000
036100*----------------------------------------------------------------*03610000
036900*    DB2 AREA FOR TPURCHS  (PURCHASE ORDER HEADER TABLE)          03690000
036910*----------------------------------------------------------------*03691019
037000                                                                  03700000
037100     EXEC SQL                                                     03710000
037200          INCLUDE TPURCHS                                         03720000
037300     END-EXEC.                                                    03730000
037400                                                                  03740000
037410*----------------------------------------------------------------*03741019
037500*    DB2 AREA FOR TPURITM  (PURCHASE ORDER ITEM TABLE)            03750000
037510*----------------------------------------------------------------*03751019
037600                                                                  03760000
037700     EXEC SQL                                                     03770000
037800          INCLUDE TPURITM                                         03780000
037900     END-EXEC.                                                    03790000
038000                                                                  03800000
038010*----------------------------------------------------------------*03801019
038100*    DB2 AREA FOR TWKORIN  (WORK ORDER INSTRUCTION TABLE)         03810000
038110*----------------------------------------------------------------*03811019
038200                                                                  03820000
038300     EXEC SQL                                                     03830000
038400          INCLUDE TWKORIN                                         03840000
038500     END-EXEC.                                                    03850000
038600                                                                  03860000
038700                                                                  03870000
038710*----------------------------------------------------------------*03871019
038800*    DB2 AREA FOR TPCLABL  (MISC FIELDS FOR LABEL VALIDATION)     03880000
038810*----------------------------------------------------------------*03881019
038900                                                                  03890000
039000     EXEC SQL                                                     03900000
039100          INCLUDE TPCLABL                                         03910000
039200     END-EXEC.                                                    03920000
039201                                                                  03920100
039202*----------------------------------------------------------------*03920219
039203*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       03920319
039204*  LOCATION MASTER TABLE (XLT_LOC)                                03920419
039205*----------------------------------------------------------------*03920519
039206     EXEC SQL                                                     03920619
039207          INCLUDE XLT00010                                        03920719
039208     END-EXEC.                                                    03920819
039209                                                                  03920919
039210*----------------------------------------------------------------*03921019
039400*    DB2 AREA FOR COMMUNICATIONS                                  03940000
039410*----------------------------------------------------------------*03941019
039500                                                                  03950000
039600     EXEC SQL                                                     03960000
039700          INCLUDE SQLCA                                           03970000
039800     END-EXEC.                                                    03980000
039900                                                                  03990000
040000     EXEC SQL                                                     04000000
040100         DECLARE PROCESS_AREA_CSR CURSOR FOR                      04010000
040200         SELECT  PRC_FCLTY_AREA_ID                                04020000
040300                ,ORD_LNE_NBR                                      04030000
040400                ,WO_INSTR_SEQ_NBR                                 04040000
040500           FROM  TWKORIN                                          04050000
040600          WHERE  ORD_NBR       =  :PV-PO-NBR                      04060000
040700            AND  RCVR_SEQ_NBR  =  :PV-RCVR-SEQ-NBR                04070000
040800            AND  VER_STATUS_CDE = 'A'                             04080000
040900       ORDER BY  ORD_LNE_NBR,                                     04090000
041000                 WO_INSTR_SEQ_NBR                                 04100000
041100     END-EXEC                                                     04110000
041200                                                                  04120000
041300 EJECT                                                            04130000
041400 LINKAGE SECTION.                                                 04140000
041500                                                                  04150000
041600 01  DFHCOMMAREA.                                                 04160000
041700     05  FILLER                         OCCURS  1 TO 4072 TIMES   04170000
041800                                        DEPENDING ON EIBCALEN.    04180000
041900         10  FILLER                     PIC X.                    04190000
042000                                                                  04200000
042100                                                                  04210000
042200 PROCEDURE DIVISION.                                              04220000
042300*----------------------------------------------------------------*04230000
042400*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *04240000
042500*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *04250000
042600*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *04260000
042700*                                                                *04270000
042800*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *04280000
042900*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *04290000
043000*----------------------------------------------------------------*04300000
043100 0000-MAIN-MODULE.                                                04310000
043200                                                                  04320000
043300     INITIALIZE DP030-CICS-API-FIELDS.                            04330000
043400                                                                  04340000
043500     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         04350000
043600     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            04360000
043700     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           04370000
043800                                                                  04380000
043900     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         04390000
044000                                                                  04400000
044100     MOVE LENGTH OF PC113AI      TO DP030-MAP-LENGTH (1).         04410000
044200     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       04420000
044300                                                                  04430000
044400     PERFORM 0001-CALL-CICS-ARCH-API.                             04440000
044500                                                                  04450000
044600     PERFORM 1000-CONTROL-PROCESSING.                             04460000
044700                                                                  04470000
044800     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       04480000
044900                                                                  04490000
045000     PERFORM 0001-CALL-CICS-ARCH-API.                             04500000
045100                                                                  04510000
045200                                                                  04520000
045300 0001-CALL-CICS-ARCH-API.                                         04530000
045400                                                                  04540000
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               04550023
1122RM     CALL DP930-CICS-ARCH-API                                     04551023
1122RM                     USING DFHEIBLK                               04552023
045600                           DFHCOMMAREA                            04560000
045700                           DP030-CICS-API-FIELDS                  04570000
045800                           DP020-STANDARD-COMMAREA                04580000
045900                           PC113AI.                               04590000
046000                                                                  04600000
046100     IF  DP030-RC-CALL-SUCCESSFUL                                 04610000
046200         CONTINUE                                                 04620000
046300     ELSE                                                         04630000
046400         SET DP013-NO-ROLLBACK   TO TRUE                          04640000
046500         SET DP013-XCTL-DISPLAY-RESTART                           04650000
046600                                 TO TRUE                          04660000
046700         SET DP013-CICS-ABEND    TO TRUE                          04670000
046800         MOVE 'BEFORE 0000-MAIN-MODULE'                           04680000
046900                                 TO DP013-PARAGRAPH               04690000
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04700023
1122RM*             'T LINE'           TO DP013-MESSAGE-TEXT (2)        04710023
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04711023
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04712023
047200         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        04720000
047300         PERFORM DP013-0000-PROCESS-ABEND                         04730000
047400     END-IF.                                                      04740000
047500 EJECT                                                            04750000
047600*----------------------------------------------------------------*04760000
047700*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04770000
047800*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04780000
047900*                                                                *04790000
048000*    PERFORMED BY 0000-MAIN-MODULE.                              *04800000
048100*----------------------------------------------------------------*04810000
048200                                                                  04820000
048300 1000-CONTROL-PROCESSING.                                         04830000
048400                                                                  04840000
048500     EVALUATE TRUE                                                04850000
048600         WHEN DP020-NEXT-ACT-INITIAL                              04860000
048700             INITIALIZE ASC-SPECIFIC-COMMAREA                     04870000
048800             MOVE SPACES          TO AENDO                        04880000
048900                                     ALBLSO                       04890000
049000             PERFORM 1100-GET-INTER-APPL-DATA                     04900000
049100             INITIALIZE DP020-MSG-NUMBER                          04910000
049200             PERFORM 3000-BUILD-INITIAL-PANEL                     04920000
049300                                                                  04930000
049400         WHEN DP020-NEXT-ACT-READ-MAP                             04940000
049500             PERFORM 2000-FKEY-PROCESSING                         04950000
049600                                                                  04960000
049700         WHEN DP020-NEXT-ACT-RETURN                               04970000
049800             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 04980000
049900             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   04990000
050000             PERFORM 3200-DISPLAY-PANEL                           05000000
050100                                                                  05010000
050200         WHEN OTHER                                               05020000
050300             SET DP013-LOGIC-ABEND                                05030000
050400                                 TO TRUE                          05040000
050500             SET DP013-NO-ROLLBACK                                05050000
050600                                 TO TRUE                          05060000
050700             MOVE '1000-CONTROL-PROCESSING'                       05070000
050800                                 TO DP013-PARAGRAPH               05080000
050900             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05090000
051000                                 TO DP013-MESSAGE-TEXT(1)         05100000
051100             MOVE DP020-NEXT-APPL-ACTIVITY                        05110000
051200                                 TO DP013-MESSAGE-TEXT(2)         05120000
051300             PERFORM DP013-0000-PROCESS-ABEND                     05130000
051400     END-EVALUATE.                                                05140000
051500                                                                  05150000
051600 EJECT                                                            05160000
051700*----------------------------------------------------------------*05170000
051800*    IF THE PROGRAM WAS STARTED FROM THE HEADER LABEL PROGRAM,   *05180000
051900*    MOVE THE INTER APPLICATION COMMAREA FIELDS TO THE SPECIFIC  *05190000
052000*    COMMAREA FIELDS.                                            *05200000
052100*                                                                *05210000
052200*    PERFORMED BY 0000-MAIN-MODULE.                              *05220000
052300*----------------------------------------------------------------*05230000
052400                                                                  05240000
052500 1100-GET-INTER-APPL-DATA.                                        05250000
052600                                                                  05260000
052700     IF DP020-INT-APPL-FORMAT-IND = PC-ENTRY-FROM-PCAHDR          05270000
052800         MOVE PC014-LBL-FMT      TO ASC-HL-LBL-FMT                05280000
052900         MOVE PC014-PRTR-ID      TO ASC-HL-PRTR-ID                05290000
053000                                    ASC-PRTR-ID-N                 05300000
053100         MOVE PC014-PRTR-DESC    TO ASC-HL-PRTR-DESC              05310000
053200                                    ASC-PRTR-DESC                 05320000
053300         MOVE PC014-OPER-UNT-ID  TO ASC-OPER-UNT-ID               05330000
053400         MOVE PC014-FCLTY-ID     TO ASC-FCLTY-ID                  05340000
053500         MOVE PC014-PRC-AREA     TO ASC-HL-PRC-AREA               05350000
053600                                    ASC-PRC-AREA                  05360000
053700         MOVE PC014-PRC-AREA-CDE TO ASC-HL-PRC-AREA-CDE           05370000
053800                                    ASC-PRC-AREA-CDE              05380000
053900         MOVE PC014-CART-CT      TO ASC-HL-CART-CT                05390000
054000                                    ASC-OF-TOTAL-NO               05400000
054100                                    ASC-TOTAL-LABELS              05410000
054200         MOVE PC014-PO-NBR       TO ASC-HL-PO-NBR                 05420000
054300                                    ASC-PO-NBR                    05430000
054400         MOVE PC014-RCVR-SEQ-NBR TO ASC-HL-RCVR-NBR               05440000
054500                                    ASC-RCVR-SEQ-NBR              05450000
054600         MOVE PC014-PO-NBR-OLD   TO ASC-PO-NBR-OLD                05460000
054700         MOVE PC014-RCVR-SEQ-NBR-OLD                              05470000
054800                                 TO ASC-RCVR-SEQ-NBR-OLD          05480000
054900         MOVE PC014-RCVR-SEQ-NBR-TX                               05490000
055000                                 TO ASC-HL-RCVR-SEQ-NBR-TX        05500000
055100                                                                  05510000
055200         IF PC014-RCVD-ENROUTE                                    05520000
055300             MOVE SPACES         TO ASC-HL-RCVD-DATE              05530000
055400             MOVE PC-ENROUTE     TO ASC-RCVD-DESC                 05540000
055500         ELSE                                                     05550000
055600             MOVE PC014-RCVD-DATE                                 05560000
055700                                 TO ASC-HL-RCVD-DATE              05570000
055800             MOVE SPACES         TO ASC-RCVD-DESC                 05580000
055900         END-IF                                                   05590000
056000                                                                  05600000
056100         MOVE ASC-HL-RCVD-MM     TO ASC-RCVD-MM                   05610000
056200         MOVE ASC-HL-RCVD-DD     TO ASC-RCVD-DD                   05620000
056300         MOVE ASC-HL-RCVD-YY     TO ASC-RCVD-YY                   05630000
056400         MOVE PC014-VEND-NAME    TO ASC-HL-VEND-NAME              05640000
056500         MOVE PC014-AD-DATE      TO ASC-HL-AD-DATE                05650000
056600         MOVE PC014-PIC-INFO     TO ASC-HL-PIC-INFO               05660000
056700         MOVE PC014-SPECIAL-INST TO ASC-HL-SPECIAL-INST           05670000
056800         MOVE PC014-MULT-SHIPMENTS                                05680000
056900                                 TO ASC-HL-MULT-SHIPMENTS         05690000
057000         MOVE PC014-PRE-TKT      TO ASC-HL-PRE-TKT                05700000
057100         MOVE PC014-PACKED-BY-STR                                 05710000
057200                                 TO ASC-HL-PACKED-BY-STR          05720000
057300         MOVE PC014-TICKET-TYPE  TO ASC-HL-TICKET-TYPE            05730000
057400         MOVE PC014-DETAIL-CHECK TO ASC-HL-DETAIL-CHECK           05740000
057500         MOVE PC014-GARMENT-ON-HANGER                             05750000
057600                                 TO ASC-HL-GARMENT-ON-HANGER      05760000
057700         MOVE PC014-DEPT         TO ASC-HL-DEPT                   05770000
057800         MOVE PC014-CLASS        TO ASC-HL-CLASS                  05780000
057810         MOVE PC014-TRIP-ID      TO ASC-HL-TRIP-ID                05781000
057900     END-IF.                                                      05790000
058000                                                                  05800000
058100*----------------------------------------------------------------*05810000
058200*   DETERMINE THE PROCESSING PATH HERE.                          *05820000
058300*                                                                *05830000
058400*   PERFORMED BY 1000-CONTROL-PROCESSING.                        *05840000
058500*----------------------------------------------------------------*05850000
058600                                                                  05860000
058700 2000-FKEY-PROCESSING.                                            05870000
058800                                                                  05880000
058900     EVALUATE TRUE                                                05890000
059000         WHEN DP020-SRC-AID = DP016-CLEAR                         05900000
059100             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 05910000
059200             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   05920000
059300             PERFORM 3200-DISPLAY-PANEL                           05930000
059400                                                                  05940000
059500         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05950000
059600             MOVE ASC-PRTR-ID-N  TO PV-PRINTER-ID                 05960000
059700             INITIALIZE ASC-SPECIFIC-COMMAREA                     05970000
059800             MOVE PV-PRINTER-ID  TO ASC-PRTR-ID-N                 05980000
059900             MOVE SPACES         TO ASEQO                         05990000
060000                                    AENDO                         06000000
060100                                    ALBLSO                        06010000
060200             PERFORM 3000-BUILD-INITIAL-PANEL                     06020000
060300             PERFORM 2210-RESET-ATTRIBUTES                        06030000
060400             PERFORM 3200-DISPLAY-PANEL                           06040000
060500                                                                  06050000
060600         WHEN DP020-SRC-AID = DP016-ENTER                         06060000
060700             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 06070000
060800             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   06080000
060900             PERFORM 3200-DISPLAY-PANEL                           06090000
061000                                                                  06100000
061100         WHEN DP020-FK-LOCAL-GOTO    (DP020-SRC-AID)              06110000
061200         WHEN DP020-FK-LOCAL-RETURN  (DP020-SRC-AID)              06120000
061300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06130000
061400             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 06140000
061500             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   06150000
061600             IF  PS-ERROR                                         06160000
061700                 SET DP030-OVERRIDE-GO                            06170000
061800                                 TO TRUE                          06180000
061900                 PERFORM 3200-DISPLAY-PANEL                       06190000
062000             ELSE                                                 06200000
062100                 SET DP030-CONTINUE-GO                            06210000
062200                                 TO TRUE                          06220000
062300                 PERFORM 4000-SETUP-LABELS                        06230000
062410                 IF PC140-CRA-SUCCESSFUL AND PS-NO-ERROR          06241001
062500                     SET ASC-ADD-COMPLETE                         06250000
062600                                 TO TRUE                          06260000
062700                     SET DP020-MSG-INFORMATIONAL                  06270000
062800                                 TO TRUE                          06280000
062900                     IF DP020-INT-APPL-FORMAT-IND NOT =           06290000
063000                        PC-ENTRY-FROM-PCAHDR                      06300000
063100                         MOVE ASC-PRTR-ID-N  TO PV-PRINTER-ID     06310000
063200                         INITIALIZE ASC-SPECIFIC-COMMAREA         06320000
063300                         MOVE SPACES         TO ASEQO             06330000
063400                                                AENDO             06340000
063500                                                ALBLSO            06350000
063600                         MOVE PV-PRINTER-ID                       06360000
063700                                 TO ASC-PRTR-ID                   06370000
063800                     END-IF                                       06380000
063900                     PERFORM 2300-MOVE-COMMAREA-TO-SCREEN         06390000
064000                     PERFORM 3000-BUILD-INITIAL-PANEL             06400000
064100                 END-IF                                           06410000
064200             END-IF                                               06420000
064300                                                                  06430000
064400         WHEN OTHER                                               06440000
064500             SET DP013-NO-ROLLBACK                                06450000
064600                                 TO TRUE                          06460000
064700             SET DP013-XCTL-DISPLAY-RESTART                       06470000
064800                                 TO TRUE                          06480000
064900             SET DP013-CICS-ABEND                                 06490000
065000                                 TO TRUE                          06500000
065100             MOVE '2000-FKEY-PROCESSING'                          06510000
065200                                 TO DP013-PARAGRAPH               06520000
065300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06530000
065400                                 TO DP013-MESSAGE-TEXT (1)        06540000
065500             PERFORM DP013-0000-PROCESS-ABEND                     06550000
065600     END-EVALUATE.                                                06560000
065700                                                                  06570000
065800 EJECT                                                            06580000
065900*----------------------------------------------------------------*06590000
066000*    HERE WE SIMPLY MOVE DATA ENTERED ON THE SCREEN TO THE COMM  *06600000
066100*    AREA.                                                       *06610000
066200*                                                                *06620000
066300*    PERFORMED BY 2000-FKEY-PROCESSING.                          *06630000
066400*----------------------------------------------------------------*06640000
066500                                                                  06650000
066600 2100-MOVE-SCREEN-TO-COMMAREA.                                    06660000
066700                                                                  06670000
066800     IF AOPUNITL > ZERO                                           06680000
066900         MOVE AOPUNITI           TO ASC-OPER-UNT-ID               06690000
067000     ELSE                                                         06700000
067100         IF AOPUNITF = DP015-ERASE-EOF                            06710000
067200             MOVE SPACE          TO ASC-OPER-UNT-ID               06720000
067300         END-IF                                                   06730000
067400     END-IF.                                                      06740000
067500                                                                  06750000
067600     IF AFACILL  > ZERO                                           06760000
067700         MOVE AFACILI            TO ASC-FCLTY-ID                  06770000
067800     ELSE                                                         06780000
067900         IF AFACILF  = DP015-ERASE-EOF                            06790000
068000             MOVE SPACE          TO ASC-FCLTY-ID                  06800000
068100         END-IF                                                   06810000
068200     END-IF.                                                      06820000
068300                                                                  06830000
068400                                                                  06840000
068500     IF  APRTRL > ZERO                                            06850000
068600         MOVE APRTRI             TO ASC-PRTR-ID                   06860000
068700     ELSE                                                         06870000
068800         IF  APRTRF = DP015-ERASE-EOF                             06880000
068900             MOVE SPACE          TO ASC-PRTR-ID                   06890000
069000         END-IF                                                   06900000
069100     END-IF.                                                      06910000
069200                                                                  06920000
069300     IF  AAREAL > ZERO                                            06930000
069400         MOVE AAREAI             TO ASC-PRC-AREA                  06940000
069500     ELSE                                                         06950000
069600         IF  AAREAF = DP015-ERASE-EOF                             06960000
069700             MOVE SPACE          TO ASC-PRC-AREA                  06970000
069800         END-IF                                                   06980000
069900     END-IF.                                                      06990000
070000                                                                  07000000
070100     IF  APOL > ZERO                                              07010000
070200         MOVE APOI               TO ASC-PO-NBR                    07020000
070300     ELSE                                                         07030000
070400         IF  APOF = DP015-ERASE-EOF                               07040000
070500             MOVE SPACE          TO ASC-PO-NBR                    07050000
070600         END-IF                                                   07060000
070700     END-IF.                                                      07070000
070800                                                                  07080000
070900     IF  ASEQL > ZERO                                             07090000
071000         MOVE ASEQI              TO ASC-RCVR-SEQ-NBR              07100000
071100         SET PS-NEW-RCVR         TO TRUE                          07110000
071200     ELSE                                                         07120000
071300         IF  ASEQF = DP015-ERASE-EOF                              07130000
071400             MOVE SPACE          TO ASC-RCVR-SEQ-NBR              07140000
071500         END-IF                                                   07150000
071600     END-IF.                                                      07160000
071700                                                                  07170000
071800     IF  APOLNEL > ZERO                                           07180000
071900         MOVE APOLNEI            TO ASC-PO-LNE-NBR                07190000
072000     ELSE                                                         07200000
072100         IF  APOLNEF = DP015-ERASE-EOF                            07210000
072200             MOVE SPACE          TO ASC-PO-LNE-NBR                07220000
072300         END-IF                                                   07230000
072400     END-IF.                                                      07240000
072500                                                                  07250000
072600     IF  ARCVDMML > ZERO                                          07260000
072700         MOVE ARCVDMMI           TO ASC-RCVD-MM                   07270000
072800     ELSE                                                         07280000
072900         IF  ARCVDMMF = DP015-ERASE-EOF                           07290000
073000             MOVE SPACE          TO ASC-RCVD-MM                   07300000
073100         END-IF                                                   07310000
073200     END-IF.                                                      07320000
073300                                                                  07330000
073400     IF  ARCVDDDL > ZERO                                          07340000
073500         MOVE ARCVDDDI           TO ASC-RCVD-DD                   07350000
073600     ELSE                                                         07360000
073700         IF  ARCVDDDF = DP015-ERASE-EOF                           07370000
073800             MOVE SPACE          TO ASC-RCVD-DD                   07380000
073900         END-IF                                                   07390000
074000     END-IF.                                                      07400000
074100                                                                  07410000
074200     IF  ARCVDYYL > ZERO                                          07420000
074300         MOVE ARCVDYYI           TO ASC-RCVD-YY                   07430000
074400     ELSE                                                         07440000
074500         IF  ARCVDYYF = DP015-ERASE-EOF                           07450000
074600             MOVE SPACE          TO ASC-RCVD-YY                   07460000
074700         END-IF                                                   07470000
074800     END-IF.                                                      07480000
074900                                                                  07490000
075000     IF  ASTRTL > ZERO                                            07500000
075100         MOVE ASTRTI             TO ASC-STRT-VALUE                07510000
075200     ELSE                                                         07520000
075300         IF  ASTRTF = DP015-ERASE-EOF                             07530000
075400             MOVE SPACE          TO ASC-STRT-VALUE                07540000
075500         END-IF                                                   07550000
075600     END-IF.                                                      07560000
075700                                                                  07570000
075800     IF  AENDL > ZERO                                             07580000
075900         MOVE AENDI              TO ASC-OF-TOTAL-NO               07590000
076000     ELSE                                                         07600000
076100         IF  AENDF = DP015-ERASE-EOF                              07610000
076200             MOVE SPACE          TO ASC-OF-TOTAL-NO               07620000
076300         END-IF                                                   07630000
076400     END-IF.                                                      07640000
076500                                                                  07650000
076600     IF  ALBLSL > ZERO                                            07660000
076700         MOVE ALBLSI             TO ASC-TOTAL-LABELS              07670000
076800     ELSE                                                         07680000
076900         IF  ALBLSF = DP015-ERASE-EOF                             07690000
077000             MOVE SPACE          TO ASC-TOTAL-LABELS              07700000
077100         END-IF                                                   07710000
077200     END-IF.                                                      07720000
077300                                                                  07730000
077400                                                                  07740000
077500*----------------------------------------------------------------*07750000
077600*    HERE WE SIMPLY ENSURE THE DATA IS CORRECT.  IF NOT, ISSUE   *07760000
077700*    APPROPRIATE ERRORS.                                         *07770000
077800*                                                                *07780000
077900*    PERFORMED BY 2000-FKEY-PROCESSING.                          *07790000
078000*----------------------------------------------------------------*07800000
078100                                                                  07810000
078200 2200-EDIT-DATA-IN-COMMAREA.                                      07820000
078300                                                                  07830000
078400     PERFORM 2210-RESET-ATTRIBUTES.                               07840000
078500                                                                  07850000
078600     IF  ASC-PO-NBR = SPACES OR ZEROS                             07860000
078700         SET PS-ERROR            TO TRUE                          07870000
078800         SET DP020-MSG-FATAL     TO TRUE                          07880000
078900         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              07890000
079000         MOVE DP015-UNP-ALP-BRT-OFF                               07900000
079100                                 TO APOA                          07910000
079200         MOVE DP015-RED          TO APOC                          07920000
079300         MOVE DP015-REVERSE      TO APOH                          07930000
079400         MOVE -1                 TO APOL                          07940000
079500         SET DP030-SET-CURSOR-APPL-1                              07950000
079600                                 TO TRUE                          07960000
079700     ELSE                                                         07970000
079800         PERFORM 2235-EDIT-PO-NBR                                 07980000
079900     END-IF.                                                      07990000
080000                                                                  08000000
080100     IF  ASC-RCVR-SEQ-NBR = SPACES OR ZEROS                       08010000
080200         SET PS-ERROR            TO TRUE                          08020000
080300         SET DP020-MSG-FATAL     TO TRUE                          08030000
080400         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              08040000
080500         MOVE DP015-UNP-ALP-BRT-OFF                               08050000
080600                                 TO ASEQA                         08060000
080700         MOVE DP015-RED          TO ASEQC                         08070000
080800         MOVE DP015-REVERSE      TO ASEQH                         08080000
080900         MOVE -1                 TO ASEQL                         08090000
081000         SET DP030-SET-CURSOR-APPL-1                              08100000
081100                                 TO TRUE                          08110000
081200     ELSE                                                         08120000
081300         PERFORM 2230-EDIT-RCVR-SEQ-NBR                           08130000
081400     END-IF.                                                      08140000
081500                                                                  08150000
081600     IF  ASC-PO-LNE-NBR = SPACES OR ZEROS                         08160000
081700         SET PS-ERROR            TO TRUE                          08170000
081800         SET DP020-MSG-FATAL     TO TRUE                          08180000
081900         MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER              08190000
082000         MOVE DP015-UNP-ALP-BRT-OFF                               08200000
082100                                 TO APOLNEA                       08210000
082200         MOVE DP015-RED          TO APOLNEC                       08220000
082300         MOVE DP015-REVERSE      TO APOLNEH                       08230000
082400         MOVE -1                 TO APOLNEL                       08240000
082500         SET DP030-SET-CURSOR-APPL-1                              08250000
082600                                 TO TRUE                          08260000
082700     ELSE                                                         08270000
082800         PERFORM 2225-EDIT-PO-LNE-NBR                             08280000
082900     END-IF.                                                      08290000
083000                                                                  08300000
083100     IF PS-NO-ERROR          AND                                  08310000
083200      ((ASC-RCVR-SEQ-NBR NOT = ASC-RCVR-SEQ-NBR-OLD) OR           08320000
083300       (ASC-PO-NBR NOT = ASC-PO-NBR-OLD)             OR           08330000
083400       (ASC-PO-LNE-NBR NOT = ASC-PO-LNE-NBR-OLD))                 08340000
083500         PERFORM 2298-GET-ALL-INFO                                08350000
083600         MOVE ASC-RCVR-SEQ-NBR   TO ASC-RCVR-SEQ-NBR-OLD          08360000
083700         MOVE ASC-PO-NBR         TO ASC-PO-NBR-OLD                08370000
083800         MOVE ASC-PO-LNE-NBR     TO ASC-PO-LNE-NBR-OLD            08380000
083900     END-IF.                                                      08390000
084000                                                                  08400000
084100     IF  ASC-STRT-VALUE = SPACES OR ZEROS                         08410000
084200         SET PS-ERROR            TO TRUE                          08420000
084300         SET DP020-MSG-FATAL     TO TRUE                          08430000
084400         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              08440000
084500         MOVE DP015-UNP-NUM-BRT-OFF                               08450000
084600                                 TO ASTRTA                        08460000
084700         MOVE DP015-RED          TO ASTRTC                        08470000
084800         MOVE DP015-REVERSE      TO ASTRTH                        08480000
084900         MOVE -1                 TO ASTRTL                        08490000
085000         SET DP030-SET-CURSOR-APPL-1                              08500000
085100                                 TO TRUE                          08510000
085200     ELSE                                                         08520000
085300         PERFORM 2245-EDIT-STARTING-CNT                           08530000
085400     END-IF.                                                      08540000
085500                                                                  08550000
085600     IF  ASC-OF-TOTAL-NO = SPACES OR ZEROS                        08560000
085700         SET PS-ERROR            TO TRUE                          08570000
085800         SET DP020-MSG-FATAL     TO TRUE                          08580000
085900         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              08590000
086000         MOVE DP015-UNP-NUM-BRT-OFF                               08600000
086100                                 TO AENDA                         08610000
086200         MOVE DP015-RED          TO AENDC                         08620000
086300         MOVE DP015-REVERSE      TO AENDH                         08630000
086400         MOVE -1                 TO AENDL                         08640000
086500         SET DP030-SET-CURSOR-APPL-1                              08650000
086600                                 TO TRUE                          08660000
086700     ELSE                                                         08670000
086800         PERFORM 2250-EDIT-ENDING-CNT                             08680000
086900     END-IF.                                                      08690000
087000                                                                  08700000
087100     IF  ASC-TOTAL-LABELS = SPACES OR ZEROS                       08710000
087200         MOVE ASC-OF-TOTAL-NO    TO ASC-TOTAL-LABELS              08720000
087300     END-IF.                                                      08730000
087400                                                                  08740000
087500     IF  ASC-TOTAL-LABELS = SPACES OR ZEROS                       08750000
087600         SET PS-ERROR            TO TRUE                          08760000
087700         SET DP020-MSG-FATAL     TO TRUE                          08770000
087800         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              08780000
087900         MOVE DP015-UNP-NUM-BRT-OFF                               08790000
088000                                 TO ALBLSA                        08800000
088100         MOVE DP015-RED          TO ALBLSC                        08810000
088200         MOVE DP015-REVERSE      TO ALBLSH                        08820000
088300         MOVE -1                 TO ALBLSL                        08830000
088400         SET DP030-SET-CURSOR-APPL-1                              08840000
088500                                 TO TRUE                          08850000
088600     ELSE                                                         08860000
088700         PERFORM 2255-EDIT-TOTAL-LABELS                           08870000
088800     END-IF.                                                      08880000
088900                                                                  08890000
089000     IF  ASC-RCVD-DATE = SPACES OR ZEROS                          08900000
089100         CONTINUE                                                 08910000
089200     ELSE                                                         08920000
089300         PERFORM 2220-EDIT-RCVD-DATE                              08930000
089400     END-IF.                                                      08940000
089500                                                                  08950000
089600     IF  ASC-PRC-AREA = SPACE                                     08960000
089700         MOVE DP015-UNP-ALP-BRT-OFF                               08970000
089800                                 TO AAREAA                        08980000
089900         MOVE DP015-RED          TO AAREAC                        08990000
090000         MOVE DP015-REVERSE      TO AAREAH                        09000000
090100         IF PS-ERROR                                              09010000
090200             CONTINUE                                             09020000
090300         ELSE                                                     09030000
090400             SET PS-ERROR        TO TRUE                          09040000
090500             SET DP020-MSG-FATAL TO TRUE                          09050000
090600             MOVE PC-TSYMSG-00007                                 09060000
090700                                 TO DP020-MSG-NUMBER              09070000
090800             MOVE -1             TO AAREAL                        09080000
090900             SET DP030-SET-CURSOR-APPL-1                          09090000
091000                                 TO TRUE                          09100000
091100         END-IF                                                   09110000
091200     ELSE                                                         09120000
091300         PERFORM 2280-VALIDATE-PROCESSING-AREA                    09130000
091400         IF SQLCODE = +100                                        09140000
091500             MOVE DP015-UNP-ALP-BRT-OFF                           09150000
091600                                 TO AAREAA                        09160000
091700             MOVE DP015-RED      TO AAREAC                        09170000
091800             MOVE DP015-REVERSE  TO AAREAH                        09180000
091900             IF PS-ERROR                                          09190000
092000                 CONTINUE                                         09200000
092100             ELSE                                                 09210000
092200                 SET PS-ERROR    TO TRUE                          09220000
092300                 SET DP020-MSG-FATAL                              09230000
092400                                 TO TRUE                          09240000
092500                 MOVE PC-TSYMSG-00005                             09250000
092600                                 TO DP020-MSG-NUMBER              09260000
092700                 MOVE -1         TO AAREAL                        09270000
092800                 SET DP030-SET-CURSOR-APPL-1                      09280000
092900                                 TO TRUE                          09290000
093000             END-IF                                               09300000
093100         END-IF                                                   09310000
093200     END-IF.                                                      09320000
093300                                                                  09330000
093400     SET ERROR-ON-FACILITY-EDIT TO TRUE                           09340000
093500     PERFORM 2215-EDIT-FACILITY.                                  09350000
093600                                                                  09360000
093700     SET ERROR-ON-OP-UNIT-EDIT TO TRUE                            09370000
093800     PERFORM 2213-EDIT-OPERATING-UNIT.                            09380000
093900                                                                  09390000
094000     SET ERROR-ON-PRINTER-EDIT TO TRUE                            09400000
094100     PERFORM 2240-EDIT-PRINTER-ID                                 09410000
094200                                                                  09420000
094300     IF NO-ERROR-ON-FACILITY-EDIT AND                             09430000
094400        NO-ERROR-ON-OP-UNIT-EDIT  AND                             09440000
094500        NO-ERROR-ON-PRINTER-EDIT                                  09450000
094600         PERFORM 2270-VALIDATE-PRINTER                            09460000
094700            IF PS-NO-ERROR                                        09470000
094800                PERFORM 2275-VALIDATE-PRINTER-ID                  09480000
094900                MOVE DP072-PRTR-LOC-DESC TO ASC-PRTR-DESC         09490000
095000                                            APRDESCO              09500000
095100            END-IF                                                09510000
095200     END-IF                                                       09520000
095300                                                                  09530000
095400                                                                  09540000
095500     IF  PS-NO-ERROR                                              09550000
095600         SET DP030-SET-CURSOR-APPL-1                              09560000
095700                                 TO TRUE                          09570000
095800         IF ASC-HL-HDR-LBL                                        09580000
095900             MOVE -1             TO ASTRTL                        09590000
096000         ELSE                                                     09600000
096100             MOVE -1             TO APRTRL                        09610000
096200         END-IF                                                   09620000
096300     ELSE                                                         09630000
096400         SET DP030-OVERRIDE-GO   TO TRUE                          09640000
096500     END-IF.                                                      09650000
096600                                                                  09660000
096700                                                                  09670000
096800 2210-RESET-ATTRIBUTES.                                           09680000
096900                                                                  09690000
097000     IF ASC-HL-HDR-LBL                                            09700000
097100         MOVE DP015-UNP-NUM-NOR-OFF                               09710000
097200                                 TO ASTRTA                        09720000
097300                                    ALBLSA                        09730000
097400         MOVE DP015-GREEN        TO ASTRTC                        09740000
097500                                    ALBLSC                        09750000
097600         MOVE DP015-UNDERLINE    TO ASTRTH                        09760000
097700                                    ALBLSH                        09770000
097800     ELSE                                                         09780000
097900         MOVE DP015-UNP-NUM-NOR-OFF                               09790000
098000                                 TO APRTRA                        09800000
098100                                    APOA                          09810000
098200                                    ASEQA                         09820000
098300                                    ARCVDMMA                      09830000
098400                                    ARCVDDDA                      09840000
098500                                    ARCVDYYA                      09850000
098600                                    ASTRTA                        09860000
098700                                    AENDA                         09870000
098800                                    ALBLSA                        09880000
098900                                    AOPUNITA                      09890000
099000                                    AFACILA                       09900000
099100                                    APOLNEA                       09910000
099200         MOVE DP015-UNP-ALP-NOR-OFF                               09920000
099300                                 TO AAREAA                        09930000
099400         MOVE DP015-GREEN        TO APRTRC                        09940000
099500                                    AAREAC                        09950000
099600                                    APOC                          09960000
099700                                    ASEQC                         09970000
099800                                    ARCVDMMC                      09980000
099900                                    ARCVDDDC                      09990000
100000                                    ARCVDYYC                      10000000
100100                                    ASTRTC                        10010000
100200                                    AENDC                         10020000
100300                                    ALBLSC                        10030000
100400                                    AOPUNITC                      10040000
100500                                    AFACILC                       10050000
100600                                    APOLNEC                       10060000
100700         MOVE DP015-UNDERLINE    TO APRTRH                        10070000
100800                                    AAREAH                        10080000
100900                                    APOH                          10090000
101000                                    ASEQH                         10100000
101100                                    ARCVDMMH                      10110000
101200                                    ARCVDDDH                      10120000
101300                                    ARCVDYYH                      10130000
101400                                    ASTRTH                        10140000
101500                                    AENDH                         10150000
101600                                    ALBLSH                        10160000
101700                                    AOPUNITH                      10170000
101800                                    AFACILH                       10180000
101900                                    APOLNEH                       10190000
102000     END-IF.                                                      10200000
102100                                                                  10210000
102200                                                                  10220000
102300*----------------------------------------------------------------*10230000
102400*    EDIT THE OPERATING UNIT                                     *10240000
102500*----------------------------------------------------------------*10250000
102600                                                                  10260000
102700 2213-EDIT-OPERATING-UNIT.                                        10270000
102800                                                                  10280000
102900     IF ASC-OPER-UNT-ID NOT > SPACES                              10290000
103000         SET PS-ERROR            TO TRUE                          10300000
103100         SET DP020-MSG-FATAL     TO TRUE                          10310000
103200         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              10320000
103300         MOVE DP015-UNP-NUM-BRT-OFF                               10330000
103400                                 TO AOPUNITA                      10340000
103500         MOVE DP015-RED          TO AOPUNITC                      10350000
103600         MOVE DP015-REVERSE      TO AOPUNITH                      10360000
103700         MOVE -1                 TO AOPUNITL                      10370000
103800         SET DP030-SET-CURSOR-APPL-1                              10380000
103900                                 TO TRUE                          10390000
104000                                                                  10400000
104100     ELSE                                                         10410000
104200                                                                  10420000
104300         MOVE ASC-OPER-UNT-ID-N      TO DP010I-UNEDITED-FIELD     10430000
104400         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     10440000
104500         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   10450000
104600                                                                  10460000
104700         SET DP010I-NEGATIVE-NOT-ALLOWED                          10470000
104800                                     TO TRUE                      10480000
104900                                                                  10490000
105010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10501020
105020                         USING DP010I-NUMERIC-EDIT-AREA           10502020
105100                                                                  10510000
105200         IF DP010I-NO-ERROR-DETECTED                              10520000
105300             MOVE DP010I-NUMERIC-FIELD                            10530000
105400                                     TO ASC-OPER-UNT-ID-N         10540000
105500                                        PV-SUPPRESS-FOUR          10550000
105600             MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                  10560000
105700             EXEC CICS                                            10570000
105800                  SYNCPOINT                                       10580000
105900             END-EXEC                                             10590000
106000             PERFORM 2214-GET-OP-UNIT-NAME                        10600000
106100             SET NO-ERROR-ON-OP-UNIT-EDIT TO TRUE                 10610000
106200         ELSE                                                     10620000
106300             SET PS-ERROR            TO TRUE                      10630000
106400             SET DP020-MSG-FATAL     TO TRUE                      10640000
106500             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          10650000
106600             MOVE DP015-UNP-NUM-BRT-OFF                           10660000
106700                                     TO AOPUNITA                  10670000
106800             MOVE DP015-RED          TO AOPUNITC                  10680000
106900             MOVE DP015-REVERSE      TO AOPUNITH                  10690000
107000             MOVE -1                 TO AOPUNITL                  10700000
107100             SET DP030-SET-CURSOR-APPL-1                          10710000
107200                                     TO TRUE                      10720000
107300         END-IF                                                   10730000
107400     END-IF.                                                      10740000
107500                                                                  10750000
107600/                                                                 10760000
107700 2214-GET-OP-UNIT-NAME.                                           10770000
107800                                                                  10780000
107900     MOVE SPACES            TO ASC-OP-UNIT-NAME                   10790000
108000     MOVE ASC-OPER-UNT-ID-N TO PC-OPER-UNT-ID                     10800000
108100     MOVE ASC-FCLTY-ID-N    TO PC-FCLTY-ID                        10810000
108110     MOVE ASC-FCLTY-ID-N    TO PC140-CRA-FACLTY-ID                10811000
108200                                                                  10820000
108300     PERFORM                                                      10830000
108400         WITH TEST AFTER                                          10840000
108500         VARYING PV-RETRY-COUNTER                                 10850000
108600         FROM 1 BY 1                                              10860000
108700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10870000
108800                   OR (SQLCODE = +0)                              10880000
108900                   OR (SQLCODE = +100))                           10890000
109000                                                                  10900000
109100         EXEC SQL                                                 10910000
109200            SELECT  LOC_NM                                        10920000
109300              INTO :XLT00010-LOC-NM                               10930000
109400              FROM  XLT_LOC                                       10940000
109500             WHERE  LOC_NBR  = :PC-OPER-UNT-ID                    10950019
109700         END-EXEC                                                 10970000
109800                                                                  10980000
109900         EVALUATE TRUE                                            10990000
110000             WHEN SQLCODE = +0                                    11000000
110100                 MOVE XLT00010-LOC-NM  TO ASC-OP-UNIT-NAME        11010000
110200                                          AOPDESCO                11020000
110300             WHEN SQLCODE = +100                                  11030000
110400                 MOVE SPACES           TO ASC-OP-UNIT-NAME        11040000
110500                                          AOPDESCO                11050000
110600             WHEN SQLCODE = -811                                  11060000
110700             WHEN SQLCODE = -904                                  11070000
110800             WHEN SQLCODE = -913                                  11080000
110900                 CONTINUE                                         11090000
111000             WHEN SQLWARN0 NOT = SPACES                           11100000
111100             WHEN SQLCODE < +0                                    11110000
111200             WHEN SQLCODE > +0                                    11120000
111300                 MOVE '2214-GET-OP-UNIT-NAME'                     11130000
111400                                 TO DP013-PARAGRAPH               11140000
111500                 MOVE 'SELECT STORE NUMBER'                       11150000
111600                                 TO DP013-MESSAGE-TEXT (1)        11160000
111700                 MOVE SQLCA      TO DP013-SQLCA                   11170000
111800                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      11180000
111900                 SET DP013-DB2-ABEND                              11190000
112000                                 TO TRUE                          11200000
112100                 SET DP013-XCTL-DISPLAY-RESTART                   11210000
112200                                 TO TRUE                          11220000
112300                 PERFORM DP013-0000-PROCESS-ABEND                 11230000
112400         END-EVALUATE                                             11240000
112500     END-PERFORM.                                                 11250000
112600                                                                  11260000
112700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11270000
112800         MOVE '2214-GET-OP-UNIT-NAME'                             11280000
112900                                 TO DP013-PARAGRAPH               11290000
113000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11300000
113100                                 TO DP013-MESSAGE-TEXT (1)        11310000
113200         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        11320000
113300         MOVE SQLCA              TO DP013-SQLCA                   11330000
113400         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      11340000
113500         SET DP013-DB2-ABEND     TO TRUE                          11350000
113600         SET DP013-XCTL-DISPLAY-RESTART                           11360000
113700                                 TO TRUE                          11370000
113800         PERFORM DP013-0000-PROCESS-ABEND                         11380000
113900     END-IF.                                                      11390000
114000                                                                  11400000
114100*----------------------------------------------------------------*11410000
114200*    EDIT THE FACILITY                                           *11420000
114300*----------------------------------------------------------------*11430000
114400 2215-EDIT-FACILITY.                                              11440000
114500                                                                  11450000
114600     IF ASC-FCLTY-ID    NOT > SPACES                              11460000
114700         SET PS-ERROR            TO TRUE                          11470000
114800         SET DP020-MSG-FATAL     TO TRUE                          11480000
114900         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              11490000
115000         MOVE DP015-UNP-NUM-BRT-OFF                               11500000
115100                                 TO AFACILA                       11510000
115200         MOVE DP015-RED          TO AFACILC                       11520000
115300         MOVE DP015-REVERSE      TO AFACILH                       11530000
115400         MOVE -1                 TO AFACILL                       11540000
115500         SET DP030-SET-CURSOR-APPL-1                              11550000
115600                                 TO TRUE                          11560000
115700                                                                  11570000
115800     ELSE                                                         11580000
115900         MOVE ASC-FCLTY-ID-N         TO DP010I-UNEDITED-FIELD     11590000
116000         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     11600000
116100         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   11610000
116200                                                                  11620000
116300         SET DP010I-NEGATIVE-NOT-ALLOWED                          11630000
116400                                     TO TRUE                      11640000
116500                                                                  11650000
116610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11661020
116620                         USING DP010I-NUMERIC-EDIT-AREA           11662020
116700                                                                  11670000
116800         IF DP010I-NO-ERROR-DETECTED                              11680000
116900             MOVE DP010I-NUMERIC-FIELD                            11690000
117000                                     TO ASC-FCLTY-ID-N            11700000
117100                                        PV-SUPPRESS-FOUR          11710000
117200             MOVE PV-SUPPRESS-FOUR   TO AFACILO                   11720000
117300             SET NO-ERROR-ON-FACILITY-EDIT TO TRUE                11730000
117400         ELSE                                                     11740000
117500             SET PS-ERROR            TO TRUE                      11750000
117600             SET DP020-MSG-FATAL     TO TRUE                      11760000
117700             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          11770000
117800             MOVE DP015-UNP-NUM-BRT-OFF                           11780000
117900                                     TO AFACILA                   11790000
118000             MOVE DP015-RED          TO AFACILC                   11800000
118100             MOVE DP015-REVERSE      TO AFACILH                   11810000
118200             MOVE -1                 TO AFACILL                   11820000
118300             SET DP030-SET-CURSOR-APPL-1                          11830000
118400                                     TO TRUE                      11840000
118500         END-IF                                                   11850000
118600     END-IF.                                                      11860000
118700                                                                  11870000
118800*----------------------------------------------------------------*11880000
118900*    CHECK THE RECEIVED DATE FOR NUMERIC                         *11890000
119000*----------------------------------------------------------------*11900000
119100                                                                  11910000
119200 2220-EDIT-RCVD-DATE.                                             11920000
119300                                                                  11930000
119400     MOVE ASC-RCVD-MM            TO DP010I-UNEDITED-FIELD.        11940000
119500     MOVE +2                     TO DP010I-MAXIMUM-DIGITS.        11950000
119600     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      11960000
119700                                                                  11970000
119800     SET DP010I-NEGATIVE-NOT-ALLOWED                              11980000
119900                                 TO TRUE.                         11990000
120000                                                                  12000000
120110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12011020
120120                         USING DP010I-NUMERIC-EDIT-AREA           12012020
120200                                                                  12020000
120300     IF DP010I-NO-ERROR-DETECTED                                  12030000
120400         MOVE DP010I-NUMERIC-FIELD                                12040000
120500                                 TO ASC-RCVD-MM-N                 12050000
120600         MOVE ASC-RCVD-MM        TO ARCVDMMO                      12060000
120700         MOVE ASC-RCVD-DD        TO DP010I-UNEDITED-FIELD         12070000
120810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12081020
120820                         USING DP010I-NUMERIC-EDIT-AREA           12082020
120900         IF DP010I-NO-ERROR-DETECTED                              12090000
121000             MOVE DP010I-NUMERIC-FIELD                            12100000
121100                                 TO ASC-RCVD-DD-N                 12110000
121200             MOVE ASC-RCVD-DD    TO ARCVDDDO                      12120000
121300             MOVE ASC-RCVD-YY    TO DP010I-UNEDITED-FIELD         12130000
121410             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12141020
121420                         USING DP010I-NUMERIC-EDIT-AREA           12142020
121500             IF DP010I-NO-ERROR-DETECTED                          12150000
121600                 MOVE DP010I-NUMERIC-FIELD                        12160000
121700                                 TO ASC-RCVD-YY-N                 12170000
121800                 MOVE ASC-RCVD-YY                                 12180000
121900                                 TO ARCVDYYO                      12190000
122000             END-IF                                               12200000
122100         END-IF                                                   12210000
122200     END-IF.                                                      12220000
122300                                                                  12230000
122400     IF DP010I-NO-ERROR-DETECTED                                  12240000
122500         PERFORM 2260-VALIDATE-RCVD-DATE                          12250000
122600     END-IF.                                                      12260000
122700                                                                  12270000
122800     IF (DPG54-DATE-INVALID)  OR                                  12280000
122900        (DPG54-SEVERE-ERROR)  OR                                  12290000
123000        (DP010I-ERROR-DETECTED)                                   12300000
123100         SET PS-ERROR            TO TRUE                          12310000
123200         SET DP020-MSG-FATAL     TO TRUE                          12320000
123300         MOVE PC-TSYMSG-00009    TO DP020-MSG-NUMBER              12330000
123400         MOVE DP015-UNP-NUM-BRT-OFF                               12340000
123500                                 TO ARCVDMMA                      12350000
123600                                    ARCVDDDA                      12360000
123700                                    ARCVDYYA                      12370000
123800         MOVE DP015-RED          TO ARCVDMMC                      12380000
123900                                    ARCVDDDC                      12390000
124000                                    ARCVDYYC                      12400000
124100         MOVE DP015-REVERSE      TO ARCVDMMH                      12410000
124200                                    ARCVDDDH                      12420000
124300                                    ARCVDYYH                      12430000
124400         MOVE -1                 TO ARCVDMML                      12440000
124500         SET DP030-SET-CURSOR-APPL-1                              12450000
124600                                 TO TRUE                          12460000
124700     END-IF.                                                      12470000
124800                                                                  12480000
124900*----------------------------------------------------------------*12490000
125000*    CHECK THE RECEIVER NUMBER FOR NUMERIC                       *12500000
125100*----------------------------------------------------------------*12510000
125200 2225-EDIT-PO-LNE-NBR.                                            12520000
125300     MOVE ASC-PO-LNE-NBR         TO DP010I-UNEDITED-FIELD.        12530000
125400     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        12540000
125500     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      12550000
125600                                                                  12560000
125700     SET DP010I-NEGATIVE-NOT-ALLOWED                              12570000
125800                                 TO TRUE.                         12580000
125900                                                                  12590000
126010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12601020
126020                         USING DP010I-NUMERIC-EDIT-AREA           12602020
126100                                                                  12610000
126200     IF DP010I-ERROR-DETECTED                                     12620000
126300         SET PS-ERROR            TO TRUE                          12630000
126400         SET DP020-MSG-FATAL     TO TRUE                          12640000
126500         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              12650000
126600         MOVE DP015-UNP-NUM-BRT-OFF                               12660000
126700                                 TO APOLNEA                       12670000
126800         MOVE DP015-RED          TO APOLNEC                       12680000
126900         MOVE DP015-REVERSE      TO APOLNEH                       12690000
127000         MOVE -1                 TO APOLNEL                       12700000
127100         SET DP030-SET-CURSOR-APPL-1                              12710000
127200                                 TO TRUE                          12720000
127300     ELSE                                                         12730000
127400         MOVE DP010I-NUMERIC-FIELD                                12740000
127500                                 TO ASC-PO-LNE-NBR-N              12750000
127600         MOVE ASC-PO-LNE-NBR     TO APOLNEO                       12760000
127700                                    PV-APP-PO-LNE-NBR             12770000
127800                                                                  12780000
127900         PERFORM 2295-VALIDATE-PO-LNE-NBR                         12790000
128000     END-IF.                                                      12800000
128100                                                                  12810000
128200*----------------------------------------------------------------*12820000
128300*    CHECK THE RECEIVER NUMBER FOR NUMERIC                       *12830000
128400*----------------------------------------------------------------*12840000
128500 2230-EDIT-RCVR-SEQ-NBR.                                          12850000
128600                                                                  12860000
128700     MOVE ASC-RCVR-SEQ-NBR       TO DP010I-UNEDITED-FIELD.        12870000
128800     MOVE +3                     TO DP010I-MAXIMUM-DIGITS.        12880000
128900     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      12890000
129000                                                                  12900000
129100     SET DP010I-NEGATIVE-NOT-ALLOWED                              12910000
129200                                 TO TRUE.                         12920000
129300                                                                  12930000
129410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             12941020
129420                         USING DP010I-NUMERIC-EDIT-AREA           12942020
129500                                                                  12950000
129600     IF DP010I-ERROR-DETECTED                                     12960000
129700         SET PS-ERROR            TO TRUE                          12970000
129800         SET DP020-MSG-FATAL     TO TRUE                          12980000
129900         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              12990000
130000         MOVE DP015-UNP-NUM-BRT-OFF                               13000000
130100                                 TO ASEQA                         13010000
130200         MOVE DP015-RED          TO ASEQC                         13020000
130300         MOVE DP015-REVERSE      TO ASEQH                         13030000
130400         MOVE -1                 TO ASEQL                         13040000
130500         SET DP030-SET-CURSOR-APPL-1                              13050000
130600                                 TO TRUE                          13060000
130700     ELSE                                                         13070000
130800         MOVE DP010I-NUMERIC-FIELD                                13080000
130900                                 TO ASC-RCVR-SEQ-NBR-N            13090000
131000         MOVE ASC-RCVR-SEQ-NBR   TO ASEQO                         13100000
131100                                    PV-RCVR-SEQ-NBR               13110000
131200         PERFORM 2285-GET-RECEIVER-NBR                            13120000
131300     END-IF.                                                      13130000
131400                                                                  13140000
131500                                                                  13150000
131600*----------------------------------------------------------------*13160000
131700*    CHECK THE PURCHASE ORDER NUMBER FOR NUMERIC                 *13170000
131800*----------------------------------------------------------------*13180000
131900                                                                  13190000
132000 2235-EDIT-PO-NBR.                                                13200000
132100                                                                  13210000
132200     MOVE ASC-PO-NBR             TO DP010I-UNEDITED-FIELD.        13220000
132300     MOVE +8                     TO DP010I-MAXIMUM-DIGITS.        13230000
132400     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      13240000
132500                                                                  13250000
132600     SET DP010I-NEGATIVE-NOT-ALLOWED                              13260000
132700                                 TO TRUE.                         13270000
132800                                                                  13280000
132910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             13291020
132920                         USING DP010I-NUMERIC-EDIT-AREA           13292020
133000                                                                  13300000
133100     IF DP010I-ERROR-DETECTED                                     13310000
133200         SET PS-ERROR            TO TRUE                          13320000
133300         SET DP020-MSG-FATAL     TO TRUE                          13330000
133400         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              13340000
133500         MOVE DP015-UNP-NUM-BRT-OFF                               13350000
133600                                 TO APOA                          13360000
133700         MOVE DP015-RED          TO APOC                          13370000
133800         MOVE DP015-REVERSE      TO APOH                          13380000
133900         MOVE -1                 TO APOL                          13390000
134000         SET DP030-SET-CURSOR-APPL-1                              13400000
134100                                 TO TRUE                          13410000
134200     ELSE                                                         13420000
134300         MOVE DP010I-NUMERIC-FIELD                                13430000
134400                                 TO ASC-PO-NBR-N                  13440000
134500         MOVE ASC-PO-NBR         TO APOO                          13450000
134600         PERFORM 2290-VALIDATE-PO                                 13460000
134700     END-IF.                                                      13470000
134800                                                                  13480000
134900                                                                  13490000
135000*----------------------------------------------------------------*13500000
135100*    CHECK THE PRINTER NUMBER FOR NUMERIC                        *13510000
135200*----------------------------------------------------------------*13520000
135300                                                                  13530000
135400 2240-EDIT-PRINTER-ID.                                            13540000
135500                                                                  13550000
135600     IF ASC-PRTR-ID     NOT > SPACES                              13560000
135700         SET PS-ERROR            TO TRUE                          13570000
135800         SET DP020-MSG-FATAL     TO TRUE                          13580000
135900         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              13590000
136000         MOVE DP015-UNP-NUM-BRT-OFF                               13600000
136100                                 TO APRTRA                        13610000
136200         MOVE DP015-RED          TO APRTRC                        13620000
136300         MOVE DP015-REVERSE      TO APRTRH                        13630000
136400         MOVE -1                 TO APRTRL                        13640000
136500         SET DP030-SET-CURSOR-APPL-1                              13650000
136600                                 TO TRUE                          13660000
136700                                                                  13670000
136800     ELSE                                                         13680000
136900         MOVE ASC-PRTR-ID            TO DP010I-UNEDITED-FIELD     13690000
137000         MOVE +3                     TO DP010I-MAXIMUM-DIGITS     13700000
137100         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   13710000
137200                                                                  13720000
137300         SET DP010I-NEGATIVE-NOT-ALLOWED                          13730000
137400                                     TO TRUE                      13740000
137500                                                                  13750000
137610         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13761020
137620                         USING DP010I-NUMERIC-EDIT-AREA           13762020
137700                                                                  13770000
137800         IF DP010I-ERROR-DETECTED                                 13780000
137900             SET PS-ERROR            TO TRUE                      13790000
138000             SET DP020-MSG-FATAL     TO TRUE                      13800000
138100             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          13810000
138200             MOVE DP015-UNP-NUM-BRT-OFF                           13820000
138300                                     TO APRTRA                    13830000
138400             MOVE DP015-RED          TO APRTRC                    13840000
138500             MOVE DP015-REVERSE      TO APRTRH                    13850000
138600             MOVE -1                 TO APRTRL                    13860000
138700             SET DP030-SET-CURSOR-APPL-1                          13870000
138800                                     TO TRUE                      13880000
138900         ELSE                                                     13890000
139000             MOVE DP010I-NUMERIC-FIELD                            13900000
139100                                     TO ASC-PRTR-ID-N             13910000
139200             MOVE ASC-PRTR-ID        TO APRTRO                    13920000
139300             SET NO-ERROR-ON-PRINTER-EDIT TO TRUE                 13930000
139400         END-IF                                                   13940000
139500     END-IF.                                                      13950000
139600                                                                  13960000
139700                                                                  13970000
139800*----------------------------------------------------------------*13980000
139900*    CHECK THE STARTING COUNT FOR NUMERIC                        *13990000
140000*----------------------------------------------------------------*14000000
140100                                                                  14010000
140200 2245-EDIT-STARTING-CNT.                                          14020000
140300                                                                  14030000
140400     MOVE ASC-STRT-VALUE         TO DP010I-UNEDITED-FIELD.        14040000
140500     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        14050000
140600     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      14060000
140700                                                                  14070000
140800     SET DP010I-NEGATIVE-NOT-ALLOWED                              14080000
140900                                 TO TRUE.                         14090000
141000                                                                  14100000
141110     CALL DP010I-NUMERIC-EDIT-ROUTINE                             14111020
141120                         USING DP010I-NUMERIC-EDIT-AREA           14112020
141200                                                                  14120000
141300     IF DP010I-ERROR-DETECTED                                     14130000
141400         SET PS-ERROR            TO TRUE                          14140000
141500         SET DP020-MSG-FATAL     TO TRUE                          14150000
141600         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              14160000
141700         MOVE DP015-UNP-NUM-BRT-OFF                               14170000
141800                                 TO ASTRTA                        14180000
141900         MOVE DP015-RED          TO ASTRTC                        14190000
142000         MOVE DP015-REVERSE      TO ASTRTH                        14200000
142100         MOVE -1                 TO ASTRTL                        14210000
142200         SET DP030-SET-CURSOR-APPL-1                              14220000
142300                                 TO TRUE                          14230000
142400     ELSE                                                         14240000
142500         MOVE DP010I-NUMERIC-FIELD                                14250000
142600                                 TO ASC-STRT-VALUE-N              14260000
142700         MOVE ASC-STRT-VALUE     TO ASTRTO                        14270000
142800         IF  ASC-STRT-VALUE-N NOT > 0                             14280000
142900             SET PS-ERROR        TO TRUE                          14290000
143000             SET DP020-MSG-FATAL TO TRUE                          14300000
143100             MOVE PC-TSYMSG-00005                                 14310000
143200                                 TO DP020-MSG-NUMBER              14320000
143300             MOVE DP015-UNP-NUM-BRT-OFF                           14330000
143400                                 TO ASTRTA                        14340000
143500             MOVE DP015-RED      TO ASTRTC                        14350000
143600             MOVE DP015-REVERSE                                   14360000
143700                                 TO ASTRTH                        14370000
143800             MOVE -1             TO ASTRTL                        14380000
143900             SET DP030-SET-CURSOR-APPL-1                          14390000
144000                                 TO TRUE                          14400000
144100         END-IF                                                   14410000
144200     END-IF.                                                      14420000
144300                                                                  14430000
144400                                                                  14440000
144500*----------------------------------------------------------------*14450000
144600*    CHECK THE ENDING COUNT FOR NUMERIC                          *14460000
144700*----------------------------------------------------------------*14470000
144800                                                                  14480000
144900 2250-EDIT-ENDING-CNT.                                            14490000
145000                                                                  14500000
145100     MOVE ASC-OF-TOTAL-NO        TO DP010I-UNEDITED-FIELD.        14510000
145200     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        14520000
145300     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      14530000
145400                                                                  14540000
145500     SET DP010I-NEGATIVE-NOT-ALLOWED                              14550000
145600                                 TO TRUE.                         14560000
145700                                                                  14570000
145810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             14581020
145820                         USING DP010I-NUMERIC-EDIT-AREA           14582020
145900                                                                  14590000
146000     IF DP010I-ERROR-DETECTED                                     14600000
146100         SET PS-ERROR            TO TRUE                          14610000
146200         SET DP020-MSG-FATAL     TO TRUE                          14620000
146300         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              14630000
146400         MOVE DP015-UNP-NUM-BRT-OFF                               14640000
146500                                 TO AENDA                         14650000
146600         MOVE DP015-RED          TO AENDC                         14660000
146700         MOVE DP015-REVERSE      TO AENDH                         14670000
146800         MOVE -1                 TO AENDL                         14680000
146900         SET DP030-SET-CURSOR-APPL-1                              14690000
147000                                 TO TRUE                          14700000
147100     ELSE                                                         14710000
147200         MOVE DP010I-NUMERIC-FIELD                                14720000
147300                                 TO ASC-OF-TOTAL-NO-N             14730000
147400         MOVE ASC-OF-TOTAL-NO    TO AENDO                         14740000
147500         IF  ASC-OF-TOTAL-NO-N NOT > 0                            14750000
147600             SET PS-ERROR        TO TRUE                          14760000
147700             SET DP020-MSG-FATAL TO TRUE                          14770000
147800             MOVE PC-TSYMSG-00005                                 14780000
147900                                 TO DP020-MSG-NUMBER              14790000
148000             MOVE DP015-UNP-NUM-BRT-OFF                           14800000
148100                                 TO AENDA                         14810000
148200             MOVE DP015-RED      TO AENDC                         14820000
148300             MOVE DP015-REVERSE  TO AENDH                         14830000
148400             MOVE -1             TO AENDL                         14840000
148500             SET DP030-SET-CURSOR-APPL-1                          14850000
148600                                 TO TRUE                          14860000
148700         END-IF                                                   14870000
148800     END-IF.                                                      14880000
148900                                                                  14890000
149000                                                                  14900000
149100*----------------------------------------------------------------*14910000
149200*    CHECK THE TOTAL LABEL COUNT FOR NUMERIC                     *14920000
149300*----------------------------------------------------------------*14930000
149400                                                                  14940000
149500 2255-EDIT-TOTAL-LABELS.                                          14950000
149600                                                                  14960000
149700     MOVE ASC-TOTAL-LABELS       TO DP010I-UNEDITED-FIELD.        14970000
149800     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        14980000
149900     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      14990000
150000                                                                  15000000
150100     SET DP010I-NEGATIVE-NOT-ALLOWED                              15010000
150200                                 TO TRUE.                         15020000
150300                                                                  15030000
150410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             15041020
150420                         USING DP010I-NUMERIC-EDIT-AREA           15042020
150500                                                                  15050000
150600     IF DP010I-ERROR-DETECTED                                     15060000
150700         SET PS-ERROR            TO TRUE                          15070000
150800         SET DP020-MSG-FATAL     TO TRUE                          15080000
150900         MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER              15090000
151000         MOVE DP015-UNP-NUM-BRT-OFF                               15100000
151100                                 TO ALBLSA                        15110000
151200         MOVE DP015-RED          TO ALBLSC                        15120000
151300         MOVE DP015-REVERSE      TO ALBLSH                        15130000
151400         MOVE -1                 TO ALBLSL                        15140000
151500         SET DP030-SET-CURSOR-APPL-1                              15150000
151600                                 TO TRUE                          15160000
151700     ELSE                                                         15170000
151800         MOVE DP010I-NUMERIC-FIELD                                15180000
151900                                 TO ASC-TOTAL-LABELS-N            15190000
152000         MOVE ASC-TOTAL-LABELS   TO ALBLSO                        15200000
152100         IF  ASC-TOTAL-LABELS-N NOT > 0                           15210000
152200             SET PS-ERROR        TO TRUE                          15220000
152300             SET DP020-MSG-FATAL TO TRUE                          15230000
152400             MOVE PC-TSYMSG-00005                                 15240000
152500                                 TO DP020-MSG-NUMBER              15250000
152600             MOVE DP015-UNP-NUM-BRT-OFF                           15260000
152700                                 TO ALBLSA                        15270000
152800             MOVE DP015-RED      TO ALBLSC                        15280000
152900             MOVE DP015-REVERSE  TO ALBLSH                        15290000
153000             MOVE -1             TO ALBLSL                        15300000
153100             SET DP030-SET-CURSOR-APPL-1                          15310000
153200                                 TO TRUE                          15320000
153300         END-IF                                                   15330000
153400     END-IF.                                                      15340000
153500                                                                  15350000
153600                                                                  15360000
153700*----------------------------------------------------------------*15370000
153800*    CALL THE DATE ROUTINE TO VERIFY PROPER MMDDYY FORMAT        *15380000
153900*----------------------------------------------------------------*15390000
154000                                                                  15400000
154100 2260-VALIDATE-RCVD-DATE.                                         15410000
154200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              15420000
154300     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     15430000
154400     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     15440000
154500     SET DPG52-LK-DTE-GREG           TO TRUE.                     15450000
154600                                                                  15460000
154700     MOVE ASC-RCVD-MM-N              TO DPG52-GREG-DATE-MO.       15470000
154800     MOVE ASC-RCVD-DD-N              TO DPG52-GREG-DATE-DY.       15480000
154900     MOVE ASC-RCVD-YY-N              TO DPG52-GREG-DATE-YR.       15490000
155000                                                                  15500000
155100     CALL DP500-KOHLS-CALENDAR-ROUTINE                            15510000
155200                     USING DPG51                                  15520000
155300                           DPG52                                  15530000
155400                           DPG53                                  15540000
155500                           DPG54                                  15550000
155600                           DPG55                                  15560000
155700                           DPG56.                                 15570000
155800                                                                  15580000
155900*----------------------------------------------------------------*15590000
156000*   2270-VALIDATE-PRINTER                                        *15600000
156100* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *15610000
156200*----------------------------------------------------------------*15620000
156300 2270-VALIDATE-PRINTER.                                           15630000
156400                                                                  15640000
156500     MOVE ASC-PRTR-ID-N           TO DP072-PRINTER-ID.            15650000
156600     MOVE PC-CURRENT-PROGRAM-NAME TO DP072-RPT-PGM-NME.           15660000
156700     MOVE PC-01                   TO DP072-RPT-PGM-TYP-ID.        15670000
156800     MOVE ASC-OPER-UNT-ID-N       TO DP072-ORIGIN-OPER-UNT-ID     15680000
156900                                     DP072-OPER-UNT-ID.           15690000
157000     MOVE ASC-FCLTY-ID-N          TO DP072-ORIGIN-FCLTY-ID        15700000
157100                                     DP072-FCLTY-ID.              15710000
157200                                                                  15720000
157300     SET DP072-VALIDATE           TO TRUE.                        15730000
157400                                                                  15740000
157500     EXEC CICS                                                    15750000
157600          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  15760000
157700               COMMAREA (DP072-COMM-AREA)                         15770000
157800               RESP     (PV-CICS-RESPONSE)                        15780000
157900     END-EXEC.                                                    15790000
158000                                                                  15800000
158100     EVALUATE TRUE                                                15810000
158200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15820000
158300              CONTINUE                                            15830000
158400         WHEN OTHER                                               15840000
158500              SET PS-ERROR                TO TRUE                 15850000
158600              SET DP020-MSG-FATAL         TO TRUE                 15860000
158700              MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER     15870000
158800              MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA               15880000
158900              MOVE DP015-RED              TO APRTRC               15890000
159000              MOVE DP015-REVERSE          TO APRTRH               15900000
159100              MOVE -1                     TO APRTRL               15910000
159200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 15920000
159300              PERFORM DP013-0000-PROCESS-ABEND                    15930000
159400     END-EVALUATE.                                                15940000
159500                                                                  15950000
159600                                                                  15960000
159700 EJECT                                                            15970000
159800*----------------------------------------------------------------*15980000
159900*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *15990000
160000*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS     *16000000
160100*  CAN BE PRINTED ON THIS PRINTER.                               *16010000
160200*----------------------------------------------------------------*16020000
160300 2275-VALIDATE-PRINTER-ID.                                        16030000
160400                                                                  16040000
160500     IF  DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                     16050000
160600         CONTINUE                                                 16060000
160700     ELSE                                                         16070000
160800         SET  PS-ERROR                TO TRUE                     16080000
160900         SET  DP020-MSG-FATAL         TO TRUE                     16090000
161000         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         16100000
161100         MOVE DP015-UNP-NUM-BRT-OFF   TO APRTRA                   16110000
161200         MOVE DP015-RED               TO APRTRC                   16120000
161300         MOVE DP015-REVERSE           TO APRTRH                   16130000
161400         MOVE -1                      TO APRTRL                   16140000
161500         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     16150000
161600     END-IF.                                                      16160000
161700                                                                  16170000
161800                                                                  16180000
161900 EJECT                                                            16190000
162000*----------------------------------------------------------------*16200000
162100*    CHECK TPCLABL TO SEE IF A VALID PROCESSING AREA WAS ENTERED *16210000
162200*----------------------------------------------------------------*16220000
162300                                                                  16230000
162400 2280-VALIDATE-PROCESSING-AREA.                                   16240000
162500                                                                  16250000
162600     MOVE ASC-PRC-AREA           TO PCLABL-CNTL-DESC.             16260000
162700                                                                  16270000
162800     PERFORM                                                      16280000
162900         WITH TEST AFTER                                          16290000
163000         VARYING PV-RETRY-COUNTER                                 16300000
163100         FROM 1 BY 1                                              16310000
163200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16320000
163300                   OR (SQLCODE = ZERO)                            16330000
163400                   OR (SQLCODE = +100))                           16340000
163500                                                                  16350000
163600         EXEC SQL                                                 16360000
163700            SELECT  CNTL_CDE,                                     16370000
163800                    CNTL_DESC,                                    16380000
163900                    DIVERT_CDE                                    16390000
164000              INTO :PCLABL-CNTL-CDE,                              16400000
164100                   :PCLABL-CNTL-DESC,                             16410000
164200                   :PCLABL-DIVERT-CDE                             16420000
164300              FROM  TPCLABL                                       16430000
164400             WHERE  LBL_TYP_CDE  = :PC-PROCESS-AREA               16440000
164500               AND  CNTL_DESC    = :PCLABL-CNTL-DESC              16450000
164600         END-EXEC                                                 16460000
164700                                                                  16470000
164800         EVALUATE TRUE                                            16480000
164900             WHEN SQLCODE = ZERO                                  16490000
165000                 MOVE PCLABL-CNTL-CDE                             16500000
165100                                 TO ASC-PRC-AREA-CDE              16510000
165200                 MOVE PCLABL-DIVERT-CDE                           16520000
165300                                 TO ASC-DIVERT-CDE                16530000
165400             WHEN SQLCODE = +100                                  16540000
165500             WHEN SQLCODE = -904                                  16550000
165600             WHEN SQLCODE = -913                                  16560000
165700                 CONTINUE                                         16570000
165800                                                                  16580000
165900             WHEN SQLWARN0 NOT = SPACES                           16590000
166000             WHEN SQLCODE < ZERO                                  16600000
166100             WHEN SQLCODE > ZERO                                  16610000
166200                 MOVE '2280-VALIDATE-PROCESSING-AREA'             16620000
166300                                 TO DP013-PARAGRAPH               16630000
166400                 MOVE 'SELECT PROCESSING AREA'                    16640000
166500                                 TO DP013-MESSAGE-TEXT (1)        16650000
166600                 MOVE SQLCA      TO DP013-SQLCA                   16660000
166700                 MOVE 'TPCLABL'  TO DP013-DB2-TABLE-NAME (1)      16670000
166800                 SET DP013-DB2-ABEND                              16680000
166900                                 TO TRUE                          16690000
167000                 SET DP013-XCTL-DISPLAY-RESTART                   16700000
167100                                 TO TRUE                          16710000
167200                 PERFORM DP013-0000-PROCESS-ABEND                 16720000
167300         END-EVALUATE                                             16730000
167400     END-PERFORM.                                                 16740000
167500                                                                  16750000
167600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16760000
167700         MOVE '2280-VALIDATE-PROCESSING-AREA'                     16770000
167800                                 TO DP013-PARAGRAPH               16780000
167900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     16790000
168000                                 TO DP013-MESSAGE-TEXT (1)        16800000
168100         MOVE 'PROCESSING AREA'  TO DP013-MESSAGE-TEXT (2)        16810000
168200         MOVE SQLCA              TO DP013-SQLCA                   16820000
168300         MOVE 'TPCLABL'          TO DP013-DB2-TABLE-NAME (1)      16830000
168400         SET DP013-DB2-ABEND     TO TRUE                          16840000
168500         SET DP013-XCTL-DISPLAY-RESTART                           16850000
168600                                 TO TRUE                          16860000
168700         PERFORM DP013-0000-PROCESS-ABEND                         16870000
168800     END-IF.                                                      16880000
168900                                                                  16890000
169000                                                                  16900000
169100*----------------------------------------------------------------*16910000
169200*    READ THE DB2 RECEIVER DATABASE TO VERIFY RECEIVER NUMBER    *16920000
169300*----------------------------------------------------------------*16930000
169400                                                                  16940000
169500 2285-GET-RECEIVER-NBR.                                           16950000
169600                                                                  16960000
169700     INITIALIZE  DCLTRECEIV.                                      16970000
169800                                                                  16980000
169900     MOVE ASC-PO-NBR-N                 TO PV-PO-NBR.              16990000
170000     MOVE ASC-RCVR-SEQ-NBR-N           TO PV-RCVR-SEQ-NBR.        17000000
170100                                                                  17010000
170200     EXEC SQL                                                     17020000
170300          SELECT                                                  17030000
170400                 OPER_UNT_ID                                      17040000
170500                ,FCLTY_ID                                         17050000
170600                ,STATUS_CDE                                       17060000
170700                ,PACK_BY_ST_IND                                   17070000
170800                ,REC_TMST                                         17080000
170900                ,EXPTED_CART_CNT                                  17090000
171000                ,ACTL_CART_CNT                                    17100000
171100                ,EXPTED_ITM_QTY                                   17110000
171200                ,ACTL_ITM_QTY                                     17120000
171300                ,PRE_TKT_IND                                      17130000
171400                ,AD_INFO_DESC                                     17140000
171500                ,VERFYD_TMST                                      17150000
171600            INTO                                                  17160000
171700                 :RECEIV-OPER-UNT-ID                              17170000
171800                ,:RECEIV-FCLTY-ID                                 17180000
171900                ,:RECEIV-STATUS-CDE                               17190000
172000                ,:RECEIV-PACK-BY-ST-IND                           17200000
172100                ,:RECEIV-REC-TMST                                 17210000
172200                ,:RECEIV-EXPTED-CART-CNT                          17220000
172300                ,:RECEIV-ACTL-CART-CNT                            17230000
172400                ,:RECEIV-EXPTED-ITM-QTY                           17240000
172500                ,:RECEIV-ACTL-ITM-QTY                             17250000
172600                ,:RECEIV-PRE-TKT-IND                              17260000
172700                ,:RECEIV-AD-INFO-DESC                             17270000
172800                ,:RECEIV-VERFYD-TMST                              17280000
173000            FROM TRECEIV                                          17300000
173100           WHERE ORD_NBR     = :PV-PO-NBR                         17310000
173200             AND REC_SEQ_NBR = :PV-RCVR-SEQ-NBR                   17320000
173300             AND VER_STATUS_CDE = 'A'                             17330000
173400     END-EXEC                                                     17340000
173500                                                                  17350000
173600     EVALUATE TRUE                                                17360000
173700         WHEN SQLCODE = +0                                        17370000
173800              CONTINUE                                            17380000
173900                                                                  17390000
174000         WHEN SQLCODE = +100                                      17400000
174100             SET PS-ERROR        TO TRUE                          17410000
174200             SET DP020-MSG-FATAL TO TRUE                          17420000
174300             MOVE PC-TSYMSG-00005                                 17430000
174400                                 TO DP020-MSG-NUMBER              17440000
174500             MOVE DP015-UNP-NUM-BRT-OFF                           17450000
174600                                 TO ASEQA                         17460000
174700             MOVE DP015-RED      TO ASEQC                         17470000
174800             MOVE DP015-REVERSE  TO ASEQH                         17480000
174900             MOVE -1             TO ASEQL                         17490000
175000             SET DP030-SET-CURSOR-APPL-1                          17500000
175100                                 TO TRUE                          17510000
175200                                                                  17520000
175300         WHEN SQLCODE = -904                                      17530000
175400         WHEN SQLCODE = -913                                      17540000
175500             CONTINUE                                             17550000
175600         WHEN SQLWARN0 NOT = SPACES                               17560000
175700         WHEN SQLCODE < +0                                        17570000
175800         WHEN SQLCODE > +0                                        17580000
175900              MOVE '2285-GET-RECEIVER-NBR'                        17590000
176000                              TO DP013-PARAGRAPH                  17600000
176100              MOVE 'UNSUCCESSFUL SELECT ON TRECEIV  '             17610000
176200                              TO DP013-MESSAGE-TEXT (1)           17620000
176300              MOVE SQLCA      TO DP013-SQLCA                      17630000
176400              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)         17640000
176500              SET DP013-DB2-ABEND                                 17650000
176600                  DP013-XCTL-DISPLAY-RESTART                      17660000
176700                              TO TRUE                             17670000
176800              PERFORM DP013-0000-PROCESS-ABEND                    17680000
176900     END-EVALUATE.                                                17690000
177000                                                                  17700000
177100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17710000
177200         MOVE '4050-SELECT-TRECEIV'                               17720000
177300                                  TO DP013-PARAGRAPH              17730000
177400         MOVE 'MAX RETRIES EXCEEDED ON SELECT ON TRECEIV  '       17740000
177500                                  TO DP013-MESSAGE-TEXT (1)       17750000
177600         MOVE SQLCA               TO DP013-SQLCA                  17760000
177700         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     17770000
177800         SET DP013-DB2-ABEND                                      17780000
177900             DP013-XCTL-DISPLAY-RESTART                           17790000
178000                                  TO TRUE                         17800000
178100         PERFORM DP013-0000-PROCESS-ABEND                         17810000
178200     END-IF.                                                      17820000
178300                                                                  17830000
178400                                                                  17840000
178500 EJECT                                                            17850000
178600*----------------------------------------------------------------*17860000
178700*    DO A COUNT FOR A SPECIFIC PURCHASE ORDER NUMBER.            *17870000
178800*                                                                *17880000
178900*----------------------------------------------------------------*17890000
179000 2290-VALIDATE-PO.                                                17900000
179100                                                                  17910000
179200     MOVE ASC-PO-NBR-N           TO PV-PO-NBR.                    17920000
179300                                                                  17930000
179400     PERFORM                                                      17940000
179500         WITH TEST AFTER                                          17950000
179600         VARYING PV-RETRY-COUNTER                                 17960000
179700         FROM 1 BY 1                                              17970000
179800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17980000
179900             OR (SQLCODE = +0)                                    17990000
180000             OR (SQLCODE = +100))                                 18000000
180100                                                                  18010000
180200         EXEC SQL                                                 18020000
180300              SELECT COUNT(*)                                     18030000
180400                INTO :PV-COUNT                                    18040000
180500                FROM TPURCHS                                      18050000
180600               WHERE PO_NBR         = :PV-PO-NBR                  18060000
180700                 AND VER_STATUS_CDE = 'A'                         18070000
180800         END-EXEC                                                 18080000
180900                                                                  18090000
181000         EVALUATE TRUE                                            18100000
181100             WHEN SQLCODE = +0                                    18110000
181200                 IF PV-COUNT > ZERO                               18120000
181300                     NEXT SENTENCE                                18130000
181400                 ELSE                                             18140000
181500*                    SET PS-ERROR        TO TRUE                  18150000
181600                     SET PS-PO-NOT-FOUND TO TRUE                  18160000
181700                     SET DP020-MSG-WARNING                        18170000
181800                                         TO TRUE                  18180000
181900                     MOVE PC-TSYMSG-00083                         18190000
182000                                         TO DP020-MSG-NUMBER      18200000
182100*                    SET DP020-MSG-FATAL TO TRUE                  18210000
182200*                    MOVE PC-TSYMSG-00005                         18220000
182300*                                        TO DP020-MSG-NUMBER      18230000
182400                     MOVE DP015-UNP-NUM-BRT-OFF                   18240000
182500                                         TO APOA                  18250000
182600*                    MOVE DP015-RED      TO APOC                  18260000
182700*                    MOVE DP015-REVERSE  TO APOH                  18270000
182800                     MOVE -1             TO APOL                  18280000
182900                     SET DP030-SET-CURSOR-APPL-1                  18290000
183000                                         TO TRUE                  18300000
183100                 END-IF                                           18310000
183200                                                                  18320000
183300             WHEN SQLCODE = +100                                  18330000
183400*                SET PS-ERROR        TO TRUE                      18340000
183500*                SET DP020-MSG-FATAL TO TRUE                      18350000
183600*                MOVE PC-TSYMSG-00005                             18360000
183700*                                    TO DP020-MSG-NUMBER          18370000
183800                 SET PS-PO-NOT-FOUND TO TRUE                      18380000
183900                 SET DP020-MSG-WARNING                            18390000
184000                                     TO TRUE                      18400000
184100                 MOVE PC-TSYMSG-00083                             18410000
184200                                     TO DP020-MSG-NUMBER          18420000
184300                 MOVE DP015-UNP-NUM-BRT-OFF                       18430000
184400                                     TO APOA                      18440000
184500*                MOVE DP015-RED      TO APOC                      18450000
184600*                MOVE DP015-REVERSE  TO APOH                      18460000
184700                 MOVE -1             TO APOL                      18470000
184800                 SET DP030-SET-CURSOR-APPL-1                      18480000
184900                                     TO TRUE                      18490000
185000                                                                  18500000
185100             WHEN SQLCODE = -904                                  18510000
185200             WHEN SQLCODE = -913                                  18520000
185300                  CONTINUE                                        18530000
185400                                                                  18540000
185500             WHEN SQLWARN0 NOT = SPACES                           18550000
185600             WHEN SQLCODE < +0                                    18560000
185700             WHEN SQLCODE > +0                                    18570000
185800                 MOVE '2290-VALIDATE-PO'                          18580000
185900                                  TO DP013-PARAGRAPH              18590000
186000                  MOVE 'UNSUCCESSFUL SELECT FOR P.O.       '      18600000
186100                                  TO DP013-MESSAGE-TEXT (1)       18610000
186200                  MOVE SQLCA      TO DP013-SQLCA                  18620000
186300                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     18630000
186400                  SET DP013-DB2-ABEND                             18640000
186500                      DP013-XCTL-DISPLAY-RESTART                  18650000
186600                                  TO TRUE                         18660000
186700                  PERFORM DP013-0000-PROCESS-ABEND                18670000
186800         END-EVALUATE                                             18680000
186900     END-PERFORM.                                                 18690000
187000                                                                  18700000
187100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18710000
187200         MOVE '2280-VALIDATE-PO'                                  18720000
187300                                  TO DP013-PARAGRAPH              18730000
187400         MOVE 'MAX RETRIES EXCEEDED ON SELECT FOR DEPT NBR'       18740000
187500                                  TO DP013-MESSAGE-TEXT (1)       18750000
187600         MOVE SQLCA               TO DP013-SQLCA                  18760000
187700         MOVE 'TPURCHS '          TO DP013-DB2-TABLE-NAME (1)     18770000
187800         SET DP013-DB2-ABEND                                      18780000
187900             DP013-XCTL-DISPLAY-RESTART                           18790000
188000                                  TO TRUE                         18800000
188100         PERFORM DP013-0000-PROCESS-ABEND                         18810000
188200     END-IF.                                                      18820000
188300                                                                  18830000
188400/                                                                 18840000
188500*----------------------------------------------------------------*18850000
188600*    VALIDATE THE PURCHASE ORDER LINE NUMBER ENTERED             *18860000
188700*----------------------------------------------------------------*18870000
188800 2295-VALIDATE-PO-LNE-NBR.                                        18880000
188900     MOVE ASC-PO-LNE-NBR-N       TO PV-APP-PO-LNE-NBR.            18890000
189000                                                                  18900000
189100     PERFORM                                                      18910000
189200         WITH TEST AFTER                                          18920000
189300         VARYING PV-RETRY-COUNTER                                 18930000
189400         FROM 1 BY 1                                              18940000
189500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               18950000
189600                   OR (SQLCODE = ZERO)                            18960000
189700                   OR (SQLCODE = +100))                           18970000
189800                                                                  18980000
189900         EXEC SQL                                                 18990000
190000              SELECT  COUNT(*)                                    19000000
190100                INTO  :PV-COUNT                                   19010000
190200                FROM  TPURITM A,                                  19020000
190300                      TSTATCD B                                   19030000
190400               WHERE  (PO_NBR            =  :PV-PO-NBR            19040000
190500                 AND   APP_PO_LNE_NBR    =  :PV-APP-PO-LNE-NBR    19050000
190600                 AND   VER_STATUS_CDE    =  'A'                   19060000
190700                 AND   B.STATUS_TYP_CDE  =  'P'                   19070000
190800                 AND   B.STATUS_CLS      =  'ACT'                 19080000
190900                 AND   B.STATUS_CDE      =  A.STATUS_CDE)         19090000
191000         END-EXEC                                                 19100000
191100                                                                  19110000
191200         EVALUATE TRUE                                            19120000
191300             WHEN SQLCODE = +0                                    19130000
191400                 IF PV-COUNT > ZERO                               19140000
191500                     NEXT SENTENCE                                19150000
191600                 ELSE                                             19160000
191700                     SET PS-PO-LNE-NOT-FOUND                      19170000
191800                                         TO TRUE                  19180000
191900                     SET DP020-MSG-WARNING                        19190000
192000                                         TO TRUE                  19200000
192100                     MOVE PC-TSYMSG-00083                         19210000
192200                                         TO DP020-MSG-NUMBER      19220000
192300                     MOVE DP015-UNP-NUM-BRT-OFF                   19230000
192400                                         TO APOLNEA               19240000
192500                     MOVE -1             TO APOLNEL               19250000
192600                     SET DP030-SET-CURSOR-APPL-1                  19260000
192700                                         TO TRUE                  19270000
192800                 END-IF                                           19280000
192900             WHEN SQLCODE = +100                                  19290000
193000                 SET PS-PO-LNE-NOT-FOUND                          19300000
193100                                     TO TRUE                      19310000
193200                 SET DP020-MSG-WARNING                            19320000
193300                                     TO TRUE                      19330000
193400                 MOVE PC-TSYMSG-00083                             19340000
193500                                     TO DP020-MSG-NUMBER          19350000
193600                 MOVE DP015-UNP-NUM-BRT-OFF                       19360000
193700                                     TO APOLNEA                   19370000
193800                 MOVE -1             TO APOLNEL                   19380000
193900                 SET DP030-SET-CURSOR-APPL-1                      19390000
194000                                     TO TRUE                      19400000
194100             WHEN SQLCODE = -904                                  19410000
194200             WHEN SQLCODE = -913                                  19420000
194300                  CONTINUE                                        19430000
194400             WHEN SQLWARN0 NOT = SPACES                           19440000
194500             WHEN SQLCODE < +0                                    19450000
194600             WHEN SQLCODE > +0                                    19460000
194700                 MOVE '2295-VALIDATE-PO-LNE-NBR'                  19470000
194800                                 TO DP013-PARAGRAPH               19480000
194900                 MOVE 'UNSUCCESSFUL SELECT FOR P.O./LINE  '       19490000
195000                                 TO DP013-MESSAGE-TEXT (1)        19500000
195100                 MOVE PV-PO-NBR  TO PV-DISPLAY-ORD-NBR            19510000
195200                 MOVE PV-DISPLAY-ORD-NBR                          19520000
195300                                 TO DP013-MESSAGE-TEXT (2)        19530000
195400                 MOVE PV-APP-PO-LNE-NBR                           19540000
195500                                 TO PV-DISPLAY-PO-LNE-NBR         19550000
195600                 MOVE PV-DISPLAY-PO-LNE-NBR                       19560000
195700                                 TO DP013-MESSAGE-TEXT (3)        19570000
195800                 MOVE SQLCA      TO DP013-SQLCA                   19580000
195900                 MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (1)      19590000
196000                 MOVE 'TSTATCD ' TO DP013-DB2-TABLE-NAME (2)      19600000
196100                 SET DP013-DB2-ABEND                              19610000
196200                     DP013-XCTL-DISPLAY-RESTART                   19620000
196300                                 TO TRUE                          19630000
196400                 PERFORM DP013-0000-PROCESS-ABEND                 19640000
196500         END-EVALUATE                                             19650000
196600     END-PERFORM.                                                 19660000
196700                                                                  19670000
196800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19680000
196900         MOVE '2295-VALIDATE-PO-LNE-NBR'                          19690000
197000                                  TO DP013-PARAGRAPH              19700000
197100         MOVE 'MAX RETRIES EXCEEDED ON SELECT FOR P.O./LINE'      19710000
197200                                  TO DP013-MESSAGE-TEXT (1)       19720000
197300         MOVE PV-PO-NBR           TO PV-DISPLAY-ORD-NBR           19730000
197400         MOVE PV-DISPLAY-ORD-NBR  TO DP013-MESSAGE-TEXT (2)       19740000
197500         MOVE PV-APP-PO-LNE-NBR   TO PV-DISPLAY-PO-LNE-NBR        19750000
197600         MOVE PV-DISPLAY-PO-LNE-NBR                               19760000
197700                                  TO DP013-MESSAGE-TEXT (3)       19770000
197800         MOVE SQLCA               TO DP013-SQLCA                  19780000
197900         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     19790000
198000         MOVE 'TSTATCD '          TO DP013-DB2-TABLE-NAME (2)     19800000
198100         SET DP013-DB2-ABEND                                      19810000
198200             DP013-XCTL-DISPLAY-RESTART                           19820000
198300                                  TO TRUE                         19830000
198400         PERFORM DP013-0000-PROCESS-ABEND                         19840000
198500     END-IF.                                                      19850000
198600/                                                                 19860000
198700*----------------------------------------------------------------*19870000
198800*    GET ALL THE PERTINENT INFO                                  *19880000
198900*----------------------------------------------------------------*19890000
199000                                                                  19900000
199100 2298-GET-ALL-INFO.                                               19910000
199200                                                                  19920000
199300     PERFORM 2285-GET-RECEIVER-NBR.                               19930000
199400     PERFORM 2410-MOVE-RCVR-DATA.                                 19940000
199500                                                                  19950000
199600     PERFORM 2400-GET-PROCESS-AREA.                               19960000
199700                                                                  19970000
199800/                                                                 19980000
199900*----------------------------------------------------------------*19990000
200000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *20000000
200100*----------------------------------------------------------------*20010000
200200                                                                  20020000
200300 2300-MOVE-COMMAREA-TO-SCREEN.                                    20030000
200400                                                                  20040000
200500                                                                  20050000
200600     MOVE ASC-OPER-UNT-ID-N      TO PV-SUPPRESS-FOUR              20060000
200700     MOVE PV-SUPPRESS-FOUR       TO AOPUNITO                      20070000
200800     MOVE ASC-OP-UNIT-NAME       TO AOPDESCO                      20080000
200900     MOVE ASC-FCLTY-ID-N         TO PV-SUPPRESS-FOUR              20090000
201000     MOVE PV-SUPPRESS-FOUR       TO AFACILO                       20100000
201100     MOVE ASC-PRTR-ID            TO APRTRO.                       20110000
201200     MOVE ASC-PRTR-DESC          TO APRDESCO.                     20120000
201300     MOVE ASC-PRC-AREA           TO AAREAO.                       20130000
201400     MOVE ASC-PO-NBR             TO APOO.                         20140000
201500     MOVE ASC-PO-LNE-NBR         TO APOLNEO.                      20150000
201600     MOVE ASC-RCVR-SEQ-NBR       TO ASEQO.                        20160000
201700     MOVE ASC-RCVD-MM            TO ARCVDMMO.                     20170000
201800     MOVE ASC-RCVD-DD            TO ARCVDDDO.                     20180000
201900     MOVE ASC-RCVD-YY            TO ARCVDYYO.                     20190000
202000     MOVE ASC-RCVD-DESC          TO ARCVDESO.                     20200000
202100     MOVE ASC-STRT-VALUE         TO ASTRTO.                       20210000
202200     MOVE ASC-OF-TOTAL-NO        TO AENDO.                        20220000
202300     MOVE ASC-TOTAL-LABELS       TO ALBLSO.                       20230000
202400                                                                  20240000
202500 EJECT                                                            20250000
202600*----------------------------------------------------------------*20260000
202700*  CHECK THE TROUBLE INDICATOR AND MOVE THE PROCESSING AREA      *20270000
202800*----------------------------------------------------------------*20280000
202900 2400-GET-PROCESS-AREA.                                           20290000
203000                                                                  20300000
203100     INITIALIZE DCLTWKORIN.                                       20310000
203200                                                                  20320000
203300     MOVE ASC-PO-NBR-N           TO PV-PO-NBR.                    20330000
203400     MOVE ASC-RCVR-SEQ-NBR-N     TO PV-RCVR-SEQ-NBR.              20340000
203500                                                                  20350000
203600     EXEC SQL                                                     20360000
203700         OPEN PROCESS_AREA_CSR                                    20370000
203800     END-EXEC.                                                    20380000
203900                                                                  20390000
204000     PERFORM                                                      20400000
204100         WITH TEST AFTER                                          20410000
204200         VARYING PV-RETRY-COUNTER                                 20420000
204300         FROM 1 BY 1                                              20430000
204400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20440000
204500            OR  (SQLCODE = ZERO)                                  20450000
204600            OR  (SQLCODE = +100)                                  20460000
204700            OR  (SQLCODE = -811))                                 20470000
204800                                                                  20480000
204900         EXEC SQL                                                 20490000
205000              FETCH  PROCESS_AREA_CSR                             20500000
205100               INTO  :WKORIN-PRC-FCLTY-AREA-ID                    20510000
205200                    ,:WKORIN-ORD-LNE-NBR                          20520000
205300                    ,:WKORIN-WO-INSTR-SEQ-NBR                     20530000
205400         END-EXEC                                                 20540000
205500                                                                  20550000
205600         EVALUATE TRUE                                            20560000
205700             WHEN SQLCODE = ZERO                                  20570000
205800                 MOVE WKORIN-PRC-FCLTY-AREA-ID                    20580000
205900                                         TO AAREAO                20590000
206000                                            ASC-PRC-AREA          20600000
206100                 IF WKORIN-ORD-LNE-NBR NOT = ZERO                 20610000
206200                     MOVE 817        TO DP020-MSG-NUMBER          20620000
206300                     SET DP020-MSG-WARNING TO TRUE                20630000
206400                 END-IF                                           20640000
206500             WHEN SQLCODE = +100                                  20650000
206600                 MOVE SPACES              TO AAREAO               20660000
206700                                             ASC-PRC-AREA         20670000
206800                 MOVE 817            TO DP020-MSG-NUMBER          20680000
206900                 SET DP020-MSG-WARNING    TO TRUE                 20690000
207000             WHEN SQLCODE = -904                                  20700000
207100             WHEN SQLCODE = -913                                  20710000
207200                 CONTINUE                                         20720000
207300             WHEN SQLWARN0 NOT = SPACES                           20730000
207400             WHEN SQLCODE < ZERO                                  20740000
207500             WHEN SQLCODE > ZERO                                  20750000
207600                  MOVE '2400-GET-PROCESS-AREA'                    20760000
207700                                     TO DP013-PARAGRAPH           20770000
207800                  MOVE 'SELECT SPECIAL INSTRUCTIONS  KEYS = '     20780000
207900                                     TO DP013-MESSAGE-TEXT (1)    20790000
208000                  MOVE PV-PO-NBR TO PV-DISPLAY-ORD-NBR            20800000
208100                  MOVE PV-DISPLAY-ORD-NBR                         20810000
208200                                     TO DP013-MESSAGE-TEXT (2)    20820000
208300                  MOVE SQLCA         TO DP013-SQLCA               20830000
208400                  MOVE 'TPOINST'     TO DP013-DB2-TABLE-NAME (1)  20840000
208500                  MOVE 'TINSTCD'     TO DP013-DB2-TABLE-NAME (2)  20850000
208600                  SET DP013-DB2-ABEND                             20860000
208700                                     TO TRUE                      20870000
208800                  SET DP013-NO-ROLLBACK                           20880000
208900                                     TO TRUE                      20890000
209000                  PERFORM DP013-0000-PROCESS-ABEND                20900000
209100         END-EVALUATE                                             20910000
209200     END-PERFORM.                                                 20920000
209300                                                                  20930000
209400     IF  PV-RETRY-COUNTER  > PC-MAX-RETRIES                       20940000
209500         MOVE '2400-GET-PROCESS-AREA'                             20950000
209600                                     TO DP013-PARAGRAPH           20960000
209700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     20970000
209800                                     TO DP013-MESSAGE-TEXT (1)    20980000
209900         MOVE 'THE PROCESS AREA.          KEYS = '                20990000
210000                                     TO DP013-MESSAGE-TEXT (2)    21000000
210100         MOVE PV-PO-NBR              TO PV-DISPLAY-ORD-NBR        21010000
210200         MOVE PV-DISPLAY-ORD-NBR     TO DP013-MESSAGE-TEXT (3)    21020000
210300         MOVE SQLCA                  TO DP013-SQLCA               21030000
210400         MOVE 'TWKORIN'              TO DP013-DB2-TABLE-NAME (1)  21040000
210500         SET DP013-DB2-ABEND         TO TRUE                      21050000
210600         SET DP013-NO-ROLLBACK       TO TRUE                      21060000
210700         PERFORM DP013-0000-PROCESS-ABEND                         21070000
210800     END-IF.                                                      21080000
210900                                                                  21090000
211000     EXEC SQL                                                     21100000
211100         CLOSE PROCESS_AREA_CSR                                   21110000
211200     END-EXEC.                                                    21120000
211300                                                                  21130000
211400/                                                                 21140000
211500                                                                  21150000
211600*----------------------------------------------------------------*21160000
211700*  MOVE FIELDS FROM THE RECEIVER TABLE                           *21170000
211800*----------------------------------------------------------------*21180000
211900 2410-MOVE-RCVR-DATA.                                             21190000
212000                                                                  21200000
212100     IF RECEIV-EXPTED-CART-CNT > 0                                21210000
212200         MOVE RECEIV-EXPTED-CART-CNT                              21220000
212300                                 TO ASC-OF-TOTAL-NO-N             21230000
212400                                    ASC-TOTAL-LABELS-N            21240000
212500         MOVE ASC-OF-TOTAL-NO    TO AENDO                         21250000
212600         MOVE ASC-TOTAL-LABELS   TO ALBLSO                        21260000
212700     END-IF.                                                      21270000
212800 EJECT                                                            21280000
212900                                                                  21290000
213000*----------------------------------------------------------------*21300000
213100*    NO INFORMATION IS DEFAULTED TO, DISPLAY BLANK MAP.          *21310000
213200*----------------------------------------------------------------*21320000
213300                                                                  21330000
213400 3000-BUILD-INITIAL-PANEL.                                        21340000
213500                                                                  21350000
213600     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         21360000
213700     SET PC014-PRIOR-SCREEN-CARTON                                21370000
213800                                 TO TRUE.                         21380000
213900                                                                  21390000
214000     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       21400000
214100                                                                  21410000
214200     MOVE PC-STARTING-CNT        TO ASTRTO                        21420000
214300                                    ASC-STRT-VALUE.               21430000
214400     MOVE SPACES                 TO ASEQO                         21440000
214500                                    AENDO                         21450000
214600                                    ALBLSO.                       21460000
214700                                                                  21470000
214800     IF DP020-INT-APPL-FORMAT-IND = PC-ENTRY-FROM-PCAHDR          21480000
214900         PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                     21490000
215000         PERFORM 3100-PROTECT-FIELDS                              21500000
215100         MOVE -1                 TO APOLNEL                       21510000
215200     ELSE                                                         21520000
215300         MOVE -1                 TO APRTRL                        21530000
215400         MOVE DP017-CURRENT-YMD-MONTH                             21540000
215500                                 TO ARCVDMMO                      21550000
215600                                    ASC-RCVD-MM                   21560000
215700         MOVE DP017-CURRENT-YMD-DAY                               21570000
215800                                 TO ARCVDDDO                      21580000
215900                                    ASC-RCVD-DD                   21590000
216000         MOVE DP017-CURRENT-YMD-YEAR                              21600000
216100                                 TO ARCVDYYO                      21610000
216200                                    ASC-RCVD-YY                   21620000
216300                                                                  21630000
216400*    * DEFAULT OPERATING UNIT AND FACILITY                        21640000
216500     PERFORM 3300-FORMAT-OP-UNIT                                  21650000
216600                                                                  21660000
216700     PERFORM 3400-FORMAT-FCLTY-ID                                 21670000
216800     END-IF.                                                      21680000
216900                                                                  21690000
217000     PERFORM 3200-DISPLAY-PANEL.                                  21700000
217100                                                                  21710000
217200                                                                  21720000
217300*----------------------------------------------------------------*21730000
217400*    PROTECT THE FIELDS THAT ARE BROUGHT ACROSS TO THIS PROGRAM  *21740000
217500*    FROM THE PRIOR SCREEN.                                      *21750000
217600*----------------------------------------------------------------*21760000
217700 3100-PROTECT-FIELDS.                                             21770000
217800                                                                  21780000
217900     MOVE DP015-PRO-NOR-OFF      TO APRTRA                        21790000
218000                                    AAREAA                        21800000
218100                                    APOA                          21810000
218200****                                APOLNEA                       21820000
218300                                    ASEQA                         21830000
218400                                    ARCVDMMA                      21840000
218500                                    ARCVDDDA                      21850000
218600                                    ARCVDYYA                      21860000
218700                                    AENDA.                        21870000
218800                                                                  21880000
218900     MOVE DP015-BLUE             TO APRTRC                        21890000
219000                                    AAREAC                        21900000
219100                                    APOC                          21910000
219200****                                APOLNEC                       21920000
219300                                    ASEQC                         21930000
219400                                    ARCVDMMC                      21940000
219500                                    ARCVDDDC                      21950000
219600                                    ARCVDYYC                      21960000
219700                                    AENDC.                        21970000
219800                                                                  21980000
219900     MOVE DP015-HL-OFF           TO APRTRH                        21990000
220000                                    AAREAH                        22000000
220100                                    APOH                          22010000
220200****                                APOLNEC                       22020000
220300                                    ASEQH                         22030000
220400                                    ARCVDMMH                      22040000
220500                                    ARCVDDDH                      22050000
220600                                    ARCVDYYH                      22060000
220700                                    AENDH.                        22070000
220800                                                                  22080000
220900                                                                  22090000
221000*----------------------------------------------------------------*22100000
221100*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *22110000
221200*                                                                *22120000
221300*    PERFORMED BY 1000-CONTROL-PROCESSING.                       *22130000
221400*    PERFORMED BY 3000-PROCESS-PANEL.                            *22140000
221500*----------------------------------------------------------------*22150000
221600                                                                  22160000
221700 3200-DISPLAY-PANEL.                                              22170000
221800                                                                  22180000
221900     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            22190000
222000     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           22200000
222100                                                                  22210000
222200/                                                                 22220000
222300 3300-FORMAT-OP-UNIT.                                             22230000
222400                                                                  22240000
222500     MOVE DP020-LOCATION-NBR     TO DP010I-UNEDITED-FIELD         22250000
222600     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         22260000
222700     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       22270000
222800                                                                  22280000
222900     SET DP010I-NEGATIVE-NOT-ALLOWED                              22290000
223000                                 TO TRUE                          22300000
223100                                                                  22310000
223210     CALL DP010I-NUMERIC-EDIT-ROUTINE                             22321020
223220                         USING DP010I-NUMERIC-EDIT-AREA           22322020
223300                                                                  22330000
223400     IF DP010I-NO-ERROR-DETECTED                                  22340000
223500         MOVE DP010I-NUMERIC-FIELD                                22350000
223600                                 TO PV-PIC9-FOUR                  22360000
223700         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              22370000
223800         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      22380000
223900                                    ASC-OPER-UNT-ID               22390000
224000     ELSE                                                         22400000
224100         MOVE DP020-LOCATION-NBR TO PV-PICX-FOUR                  22410000
224200         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              22420000
224300         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      22430000
224400                                    ASC-OPER-UNT-ID               22440000
224500                                                                  22450000
224600     .                                                            22460000
224700/                                                                 22470000
224800 3400-FORMAT-FCLTY-ID.                                            22480000
224900                                                                  22490000
225000     MOVE DP020-FCLTY-ID         TO DP010I-UNEDITED-FIELD         22500000
225100     MOVE +4                     TO DP010I-MAXIMUM-DIGITS         22510000
225200     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS       22520000
225300                                                                  22530000
225400     SET DP010I-NEGATIVE-NOT-ALLOWED                              22540000
225500                                 TO TRUE                          22550000
225600                                                                  22560000
225710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             22571020
225720                         USING DP010I-NUMERIC-EDIT-AREA           22572020
225800                                                                  22580000
225900     IF DP010I-NO-ERROR-DETECTED                                  22590000
226000         MOVE DP010I-NUMERIC-FIELD                                22600000
226100                                 TO PV-PIC9-FOUR                  22610000
226200         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              22620000
226300         MOVE PV-SUPPRESS-FOUR   TO AFACILO                       22630000
226400                                    ASC-FCLTY-ID-N                22640000
226500     ELSE                                                         22650000
226600         MOVE DP020-FCLTY-ID     TO AFACILO                       22660000
226700                                    ASC-FCLTY-ID                  22670000
226800         SET PS-ERROR            TO TRUE                          22680000
226900         SET DP020-MSG-FATAL     TO TRUE                          22690000
227000         MOVE PC-TSYMSG-00005                                     22700000
227100                                 TO DP020-MSG-NUMBER              22710000
227200         MOVE DP015-UNP-ALP-BRT-OFF                               22720000
227300                                 TO AFACILA                       22730000
227400         MOVE DP015-RED          TO AFACILC                       22740000
227500         MOVE DP015-REVERSE      TO AFACILH                       22750000
227600         MOVE -1                 TO AFACILL                       22760000
227700         SET DP030-SET-CURSOR-APPL-1                              22770000
227800                                 TO TRUE                          22780000
227900     .                                                            22790000
228000 EJECT                                                            22800000
228001*----------------------------------------------------------------*22800100
228002*                                                                *22800200
228003*----------------------------------------------------------------*22800300
228004 3500-GET-DC-LOCATION.                                            22800400
228005     EXEC SQL                                                     22800500
228006          SELECT LOC_5_ABBR_NM                                    22800600
228007          INTO  :PV-DC-5-CHAR-ABBR                                22800700
228008          FROM   XLT_LOC                                          22800800
228009          WHERE  LOC_TYP_CDE = 'DC'                               22800919
228010          AND    LOC_NBR     = :PC-OPER-UNT-ID                    22801019
228011     END-EXEC.                                                    22801100
228012                                                                  22801200
228013     EVALUATE TRUE                                                22801300
228014         WHEN SQLCODE = ZERO                                      22801400
228015              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       22801500
228016              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 22801600
228017                                                                  22801700
228018         WHEN SQLCODE = +100                                      22801800
228019              MOVE  PC-90   TO  PC140-CRA-DC-ID                   22801900
228020                                PC140-CRA-OPER-UNT-ID             22802000
228021                                                                  22802100
228022         WHEN SQLWARN0 NOT = SPACES                               22802200
228023         WHEN SQLCODE NOT EQUAL ZERO                              22802300
228024             MOVE '3500-GET-DC-LOCATION'                          22802400
228025                             TO DP013-PARAGRAPH                   22802500
228026             MOVE 'PCKCS113 - GET DC LOCATION CODE'               22802600
228027                             TO DP013-MESSAGE-TEXT(1)             22802700
228028             MOVE PC140-CRA-DC-ID                                 22802800
228029                             TO DP013-MESSAGE-TEXT(2)             22802900
228030             MOVE SQLCA      TO DP013-SQLCA                       22803000
228031             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           22803100
228032             SET DP013-DB2-ABEND                                  22803200
228033                             TO TRUE                              22803300
228034             SET DP013-NO-ROLLBACK                                22803400
228035                             TO TRUE                              22803500
228036             SET DP013-XCTL-DISPLAY-RESTART                       22803600
228037                             TO TRUE                              22803700
228038             PERFORM DP013-0000-PROCESS-ABEND                     22803800
228039     END-EVALUATE.                                                22803900
228040                                                                  22804000
228100 4000-SETUP-LABELS.                                               22810000
228200                                                                  22820000
228300     IF ASC-HL-HDR-LBL                                            22830000
228400         PERFORM 4100-SETUP-HEADER-LABELS                         22840000
228500     END-IF.                                                      22850000
228600                                                                  22860000
228710     INITIALIZE PC140-LABELMST.                                   22871000
228800                                                                  22880000
235211     SET PC140-COMMON-CART-LBL-NBR TO TRUE.                       23521100
235221     MOVE ASC-PRTR-ID        TO PC140-CL-PRTR-ID.                 23522101
235231     MOVE ASC-PRC-AREA       TO PC140-CL-PRC-AREA.                23523101
235241     MOVE ASC-PO-NBR         TO PC140-CL-PO-NBR.                  23524101
235251     MOVE ASC-PO-LNE-NBR     TO PC140-CL-PO-LINE-NBR.             23525101
235261     MOVE ASC-RCVR-SEQ-NBR   TO PC140-CL-RCVR-SEQ-NBR.            23526101
235262                                                                  23526200
235270     IF ASC-RCVD-DATE = SPACES                                    23527000
235280     AND ASC-RCVD-DESC = PC-ENROUTE                               23528000
235291         MOVE PC-ENROUTE     TO PC140-CL-RCVD-MM-DD-YY            23529101
235292     ELSE                                                         23529200
235293         MOVE ASC-RCVD-MM    TO PV-MM                             23529300
235294         MOVE ASC-RCVD-DD    TO PV-DD                             23529400
235295         MOVE ASC-RCVD-YY    TO PV-YY                             23529500
235297         MOVE PV-FORMAT-DATE TO PC140-CL-RCVD-MM-DD-YY            23529701
235298     END-IF.                                                      23529800
235299                                                                  23529900
235301     MOVE ASC-STRT-VALUE     TO PC140-CL-STRT-VALUE.              23530101
235303     MOVE ASC-OF-TOTAL-NO    TO PC140-CL-OF-TOT-LBLS.             23530301
235305     MOVE ASC-TOTAL-LABELS   TO PC140-CL-TOT-LBLS.                23530501
235307     MOVE ASC-DIVERT-CDE     TO PC140-CL-DIVERT-CDE.              23530701
235308                                                                  23530819
235309     PERFORM 4010-GET-SKU-NBR.                                    23530900
235310                                                                  23531000
235311     IF ASC-HL-DEPT = SPACES                                      23531100
235312         MOVE PURCHS-DEPT-NBR    TO PC140-CL-DEPT                 23531200
235313         MOVE PURITM-CL-NBR      TO PC140-CL-CLASS                23531300
235314     ELSE                                                         23531400
235315         MOVE ASC-HL-DEPT        TO PC140-CL-DEPT                 23531500
235316         MOVE ASC-HL-CLASS       TO PC140-CL-CLASS                23531600
235317     END-IF.                                                      23531700
235318                                                                  23531800
235319     EVALUATE PURITM-SKU-SEQ-NBR                                  23531900
235320     WHEN ZERO                                                    23532019
235330         MOVE ZERO                    TO PC140-CL-SKU             23533019
235340     WHEN '999'                                                   23534019
235350         MOVE ALL '9'                 TO PC140-CL-SKU             23535019
235360     WHEN OTHER                                                   23536019
235370         IF (ASC-PO-LNE-NBR = 9999 OR                             23537019
235380             ASC-PO-LNE-NBR = 0999)                               23538019
235390            CONTINUE                                              23539019
235400         ELSE                                                     23540019
235500            PERFORM 4020-GET-NEW-SKU                              23550019
235600         END-IF                                                   23560019
235700     END-EVALUATE.                                                23570019
235800                                                                  23580019
235801     IF PS-NO-ERROR                                               23580119
235802         MOVE DP072-PRTR-IP-ADDRESS                               23580200
235803                             TO PC140-CL-IP-ADDRESS               23580301
235804         MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                      23580400
235805                             TO PC140-CL-OS-RLSE-CDE              23580501
235806         MOVE DP072-PRTR-DATA-XFER-MODE-ID                        23580600
235807                             TO PC140-CL-XFER-MODE-ID             23580701
235808         MOVE DP072-XMIT-INTFC-CDE                                23580800
235809                             TO PC140-XMIT-INTFC-CDE              23580900
235810         MOVE DP072-PRTR-OPER-UNT-ID TO PC-OPER-UNT-ID            23581000
235811                                                                  23581100
235812         PERFORM 3500-GET-DC-LOCATION                             23581200
235813                                                                  23581301
235814         PERFORM 4300-LINK-SOCKET-PRINT-ROUTINE                   23581401
235815     END-IF.                                                      23581519
235816                                                                  23581600
235817*----------------------------------------------------------------*23581700
235818*    READ THE PO AND THE PO ITEM DATABASE TO RETRIEVE SKU        *23581800
235819*----------------------------------------------------------------*23581900
235820 4010-GET-SKU-NBR.                                                23582000
235900     MOVE ASC-PO-NBR-N       TO  PV-PO-NBR.                       23590000
236000     MOVE ASC-PO-LNE-NBR-N   TO  PV-APP-PO-LNE-NBR.               23600000
236100                                                                  23610000
236200     EXEC SQL                                                     23620000
236300         SELECT  A.DEPT_NBR,                                      23630000
236400                 B.CL_NBR,                                        23640000
236500                 B.SKU_SEQ_NBR                                    23650000
236510             ,   B.ITM_NBR                                        23651019
236600           INTO  :PURCHS-DEPT-NBR,                                23660000
236700                 :PURITM-CL-NBR,                                  23670000
236800                 :PURITM-SKU-SEQ-NBR                              23680000
236900             ,   :PURITM-ITM-NBR                                  23690019
237000           FROM  TPURCHS A,                                       23700019
237100                 TPURITM B                                        23710019
237200          WHERE  (A.PO_NBR          =  :PV-PO-NBR                 23720019
237300            AND   A.PO_NBR          =  B.PO_NBR                   23730019
237400            AND   A.VER_NBR         =  B.VER_NBR                  23740019
237500            AND   A.VER_STATUS_CDE  =  'A'                        23750019
237600            AND   B.VER_STATUS_CDE  =  'A'                        23760019
237610            AND   B.APP_PO_LNE_NBR  =  :PV-APP-PO-LNE-NBR)        23761019
237700     END-EXEC.                                                    23770000
237800                                                                  23780000
237900     EVALUATE TRUE                                                23790000
238000         WHEN SQLCODE = +0                                        23800000
238200             CONTINUE                                             23820000
238300         WHEN SQLCODE = +100                                      23830019
238400             MOVE ZEROES TO PURITM-ITM-NBR                        23840019
238500                            PURCHS-DEPT-NBR                       23850019
238600                            PURITM-CL-NBR                         23860019
238601                            PURITM-SKU-SEQ-NBR                    23860119
238602         WHEN SQLWARN0 NOT = SPACES                               23860200
238603         WHEN SQLCODE < +0                                        23860300
238604         WHEN SQLCODE > +0                                        23860400
238605             MOVE '4010-GET-SKU-NBR'                              23860500
238700                              TO DP013-PARAGRAPH                  23870000
238800             MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'                23880000
238900                              TO DP013-MESSAGE-TEXT (1)           23890000
239000             MOVE SQLCA       TO DP013-SQLCA                      23900000
239100             MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)         23910000
239110             MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (2)         23911019
239200             SET DP013-DB2-ABEND                                  23920000
239300                 DP013-XCTL-DISPLAY-RESTART                       23930000
239400                              TO TRUE                             23940000
239500             PERFORM DP013-0000-PROCESS-ABEND                     23950000
239600     END-EVALUATE.                                                23960000
239700                                                                  23970000
239800 4020-GET-NEW-SKU.                                                23980019
239900                                                                  23990019
240000     INITIALIZE XL001-ITEM-COMMAREA                               24000019
240100     SET XL001-SELECT-SKU                                         24010019
240200         XL001-BY-ITEM                TO TRUE                     24020019
240300                                                                  24030019
240400     MOVE PURITM-ITM-NBR              TO XL001-KEY-ITM-NBR        24040019
240500                                                                  24050019
240600     PERFORM 8600-CALL-XLKUT001.                                  24060019
240700     IF PS-NO-ERROR                                               24070019
240800         EVALUATE TRUE                                            24080019
240900             WHEN XL001-SUCCESSFUL                                24090019
241000                 MOVE XL001-SKU-NBR       TO PC140-CL-SKU         24100019
241100             WHEN XL001-SKU-NOT-FOUND                             24110019
241200                 MOVE ZEROES              TO PC140-CL-SKU         24120019
241300         END-EVALUATE                                             24130019
241400     END-IF.                                                      24140019
241401/                                                                 24140119
241402*----------------------------------------------------------------*24140200
241403*    IF THIS PROGRAM WAS STARTED VIA THE HEADER LABEL PROGRAM,   *24140300
241404*    WRITE OUT THE HEADER LABELS BEFORE THE CARTON LABELS.       *24140400
241405*                                                                *24140500
241406*    PERFORMED BY 4000-SETUP-LABELS.                             *24140600
241407*----------------------------------------------------------------*24140700
241408                                                                  24140800
241409 4100-SETUP-HEADER-LABELS.                                        24140900
241410                                                                  24141000
241411     SET PC140-COMMON-HDR-LBL-NBR TO TRUE.                        24141100
241412                                                                  24141200
241413     MOVE PC-LABEL-FORMAT        TO PC014-LBL-FMT.                24141300
241414     MOVE ASC-OPER-UNT-ID        TO PC014-OPER-UNT-ID.            24141400
241415     MOVE ASC-FCLTY-ID           TO PC014-FCLTY-ID.               24141500
241416     MOVE ASC-FCLTY-ID           TO PC140-CRA-FACLTY-ID.          24141600
241417     MOVE ASC-HL-PRTR-ID         TO PC140-HL-PRTR-ID              24141701
241418                                    PC014-PRTR-ID.                24141800
241419     MOVE ASC-HL-PRTR-DESC       TO PC014-PRTR-DESC.              24141900
241510     MOVE ASC-HL-PRC-AREA        TO PC140-HL-PRC-AREA-TX          24151000
241600                                    PC014-PRC-AREA.               24160000
241710     MOVE ASC-HL-PRC-AREA-CDE    TO PC140-HL-PRC-AREA-CD          24171000
241800                                    PC014-PRC-AREA-CDE.           24180000
241910     MOVE ASC-HL-CART-CT         TO PC140-HL-CART-CT              24191000
242000                                    PC014-CART-CT.                24200000
242100     IF ASC-HL-RCVD-DATE = SPACES                                 24210000
242200     AND ASC-RCVD-DESC = PC-ENROUTE                               24220000
242310         MOVE PC-ENROUTE         TO PC140-HL-RCVD-MM-DD-YY        24231000
242400                                    PC014-RCVD-DATE               24240000
242500     ELSE                                                         24250000
242600         MOVE ASC-HL-RCVD-MM     TO PV-MM                         24260000
242700         MOVE ASC-HL-RCVD-DD     TO PV-DD                         24270000
242800         MOVE ASC-HL-RCVD-YY     TO PV-YY                         24280000
242910         MOVE PV-FORMAT-DATE     TO PC140-HL-RCVD-MM-DD-YY        24291000
243000                                    PC014-RCVD-DATE               24300000
243100     END-IF.                                                      24310000
243210     MOVE ASC-HL-PO-NBR          TO PC140-HL-PO-NBR               24321000
243300                                    PC014-PO-NBR.                 24330000
243410     MOVE ASC-HL-VEND-NAME       TO PC140-HL-VEND-NAME            24341000
243500                                    PC014-VEND-NAME.              24350000
243600     MOVE ASC-HL-RCVR-NBR        TO PC140-HL-RCVR-NBR.            24360001
243710     MOVE ASC-HL-RCVR-SEQ-NBR-TX TO PC140-HL-RCVR-SEQ-NBR-TX      24371000
243800                                    PC014-RCVR-SEQ-NBR-TX         24380000
243900                                    PC014-RCVR-SEQ-NBR.           24390000
244010     MOVE ASC-HL-AD-DATE         TO PC140-HL-AD-MM-DD-YY          24401000
244100                                    PC014-AD-DATE.                24410000
244210     MOVE ASC-HL-PIC-INFO        TO PC140-HL-PIC-TX               24421000
244300                                    PC014-PIC-INFO.               24430000
244400                                                                  24440000
244500     IF ASC-HL-MULT-SHIPMENTS = PC-Y                              24450000
244600         MOVE PC-MULTIPLE-SHIPMENTS                               24460000
244710                                 TO PC140-HL-MULT-SHIPMENTS-TX    24471000
244800         MOVE PC-Y               TO PC014-MULT-SHIPMENTS          24480000
244900     ELSE                                                         24490000
245010         MOVE SPACES             TO PC140-HL-MULT-SHIPMENTS-TX    24501000
245100         MOVE PC-N               TO PC014-MULT-SHIPMENTS          24510000
245200     END-IF.                                                      24520000
245300                                                                  24530000
245302     IF ASC-HL-SPECIAL-INST = SPACES                              24530200
245303        CONTINUE                                                  24530300
245304     ELSE                                                         24530400
245305        SET PC140-CRA-SPC-INSTR    TO TRUE                        24530500
245310     END-IF.                                                      24531000
245320                                                                  24532000
245410     MOVE ASC-HL-SPECIAL-INST    TO PC140-HL-SPECIAL-TX           24541000
245500                                    PC014-SPECIAL-INST.           24550000
245610     MOVE ASC-HL-PACKED-BY-STR   TO PC140-HL-PACKED-BY-TX         24561000
245700                                    PC014-PACKED-BY-STR.          24570000
245810     MOVE ASC-HL-TICKET-TYPE     TO PC140-HL-TICKET-TYPE          24581000
245900                                    PC014-TICKET-TYPE.            24590000
246000                                                                  24600000
246100     IF ASC-HL-PRE-TKT = PC-Y                                     24610000
246210         MOVE PC-PRE-TICKETED    TO PC140-HL-PRE-TKT-TX           24621000
246300         MOVE PC-Y               TO PC014-PRE-TKT                 24630000
246400     ELSE                                                         24640000
246510         MOVE SPACES             TO PC140-HL-PRE-TKT-TX           24651000
246600         MOVE PC-N               TO PC014-PRE-TKT                 24660000
246700     END-IF.                                                      24670000
246800                                                                  24680000
246900     IF ASC-HL-DETAIL-CHECK = PC-Y                                24690000
247010         MOVE PC-DETAIL-CHECK    TO PC140-HL-DETAIL-CHECK         24701000
247100         MOVE PC-Y               TO PC014-DETAIL-CHECK            24710000
247200     ELSE                                                         24720000
247310         MOVE SPACES             TO PC140-HL-DETAIL-CHECK         24731000
247400         MOVE PC-N               TO PC014-DETAIL-CHECK            24740000
247500     END-IF.                                                      24750000
247600                                                                  24760000
247700     IF ASC-HL-GARMENT-ON-HANGER = PC-Y                           24770000
247810         MOVE PC-ON-HANGER       TO PC140-HL-ON-HANGER-TX         24781000
247900         MOVE PC-Y               TO PC014-GARMENT-ON-HANGER       24790000
248000     ELSE                                                         24800000
248110         MOVE SPACES             TO PC140-HL-ON-HANGER-TX         24811000
248200         MOVE PC-N               TO PC014-GARMENT-ON-HANGER       24820000
248300     END-IF.                                                      24830000
248400                                                                  24840000
248510     MOVE ASC-HL-DEPT            TO PC140-HL-DEPT                 24851000
248600                                    PC014-DEPT.                   24860000
248710     MOVE ASC-HL-CLASS           TO PC140-HL-CLASS                24871000
248800                                    PC014-CLASS.                  24880000
248820     MOVE ASC-HL-TRIP-ID         TO PC140-HL-TRIP-ID              24882000
248830                                    PC014-TRIP-ID.                24883000
248910     MOVE DP072-PRTR-IP-ADDRESS  TO PC140-HL-IP-ADDRESS.          24891000
249000     MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                          24900000
249110                                 TO PC140-HL-OS-RLSE-CDE.         24911000
249200     MOVE DP072-PRTR-DATA-XFER-MODE-ID                            24920000
249310                                 TO PC140-HL-XFER-MODE-ID.        24931000
249320     MOVE DP072-XMIT-INTFC-CDE                                    24932000
249330                             TO PC140-XMIT-INTFC-CDE.             24933000
249340     MOVE DP072-PRTR-OPER-UNT-ID TO PC-OPER-UNT-ID.               24934000
249350                                                                  24935000
249360     PERFORM 3500-GET-DC-LOCATION.                                24936000
249370                                                                  24937001
249380     PERFORM 4300-LINK-SOCKET-PRINT-ROUTINE.                      24938001
251900                                                                  25190000
252001 4300-LINK-SOCKET-PRINT-ROUTINE.                                  25200100
252002                                                                  25200200
252003     MOVE DP020-USERID           TO PC140-CRA-USERID.             25200300
252004     MOVE LENGTH OF PC140-LABELMST TO PV-COMMAREA-LENGTH.         25200401
252005                                                                  25200500
252006     EXEC CICS                                                    25200600
252007          LINK PROGRAM  ('PCKCS707')                              25200700
252008               COMMAREA (PC140-LABELMST)                          25200800
252009               LENGTH   (PV-COMMAREA-LENGTH)                      25200900
252010               RESP     (PV-CICS-RESPONSE)                        25201000
252011     END-EXEC.                                                    25201100
252012                                                                  25201200
252013     EVALUATE TRUE                                                25201300
252014         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 25201400
252015              CONTINUE                                            25201500
252016         WHEN OTHER                                               25201600
252017              PERFORM DP013-0000-PROCESS-ABEND                    25201700
252018     END-EVALUATE.                                                25201800
252019     IF PC140-CRA-SOCKET-COMM-ERROR                               25201900
252020         SET PS-ERROR            TO TRUE                          25202000
252021         SET DP020-MSG-FATAL     TO TRUE                          25202100
252022         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              25202200
252023         MOVE DP015-UNP-NUM-BRT-OFF                               25202300
252024                                 TO APRTRA                        25202400
252025         MOVE DP015-RED          TO APRTRC                        25202500
252026         MOVE DP015-REVERSE      TO APRTRH                        25202600
252027         MOVE -1                 TO APRTRL                        25202700
252028         SET DP030-SET-CURSOR-APPL-1                              25202800
252029                                 TO TRUE                          25202900
252030     ELSE                                                         25203000
252031     IF PC140-CRA-INVALID-PRT-FMT                                 25203100
252032         SET PS-ERROR            TO TRUE                          25203200
252033         SET DP020-MSG-FATAL     TO TRUE                          25203300
252034         MOVE DP015-UNP-NUM-BRT-OFF                               25203400
252035                                 TO APRTRA                        25203500
252036         MOVE DP015-RED          TO APRTRC                        25203600
252037         MOVE DP015-REVERSE      TO APRTRH                        25203700
252038         MOVE -1                 TO APRTRL                        25203800
252039         SET DP030-SET-CURSOR-APPL-1                              25203900
252040                                 TO TRUE                          25204000
252041         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                25204100
252042         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                25204200
252043         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            25204300
252044     ELSE                                                         25204400
252045         SET DP020-MSG-INFORMATIONAL TO TRUE                      25204500
252046         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              25204600
252047         MOVE -1                 TO APRTRL                        25204700
252048         SET DP030-SET-CURSOR-APPL-1                              25204800
252049                                 TO TRUE                          25204900
252050     END-IF.                                                      25205000
252060/                                                                 25206019
252070 8600-CALL-XLKUT001.                                              25207019
252080                                                                  25208019
252090     CALL XL001-VSM-PGM  USING DFHEIBLK                           25209019
252100                              XL001-COMMAREA                      25210019
252200                              XL001-ITEM-COMMAREA.                25220019
252300                                                                  25230019
252400     EVALUATE TRUE                                                25240019
252500         WHEN XL001-SUCCESSFUL                                    25250019
252600         WHEN XL001-SKU-NOT-FOUND                                 25260019
252700             CONTINUE                                             25270019
252701         WHEN XL001-SKU-CONTENTION                                25270119
252702             PERFORM 9000-SOFT-ABORT                              25270200
252703         WHEN XL001-SQL-ERROR                                     25270319
252704         WHEN XL001-INVALID-ACCESS                                25270419
252705             MOVE XL001-SQLCA          TO DP013-SQLCA             25270500
252706             MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH         25270600
252707             MOVE 'PCKCS113 - DB2 ERROR IN PROGRAM: '             25270700
252708                                       TO DP013-MESSAGE-TEXT (1)  25270800
252709             MOVE 'XLKUT001'           TO DP013-MESSAGE-TEXT (2)  25270900
252710             SET DP013-DB2-ABEND                                  25271000
252711                 DP013-XCTL-DISPLAY-RESTART                       25271100
252712                                       TO TRUE                    25271200
252713             PERFORM DP013-0000-PROCESS-ABEND                     25271300
252714         WHEN OTHER                                               25271419
252715             MOVE XL001-SQLCA TO DP013-SQLCA                      25271500
252716             MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH         25271600
252717             MOVE 'PCKCS113 - UNDETERMINED ERROR IN PGM: '        25271700
252718                                       TO DP013-MESSAGE-TEXT (1)  25271800
252719             MOVE 'XLKUT001'           TO DP013-MESSAGE-TEXT (2)  25271900
252720             SET DP013-DB2-ABEND                                  25272000
252721                 DP013-XCTL-DISPLAY-RESTART                       25272100
252722                                       TO TRUE                    25272200
252723             PERFORM DP013-0000-PROCESS-ABEND                     25272300
252724     END-EVALUATE.                                                25272419
252725/                                                                 25272500
252726 9000-SOFT-ABORT.                                                 25272600
252727                                                                  25272700
252728     EXEC CICS                                                    25272800
252729         SYNCPOINT ROLLBACK                                       25272900
252730     END-EXEC                                                     25273000
252731     SET PS-ERROR                                                 25273100
252732         DP030-SET-CURSOR-APPL-1                                  25273200
252733         DP020-MSG-FATAL         TO TRUE                          25273300
252734     MOVE -1                     TO AOPUNITL                      25273419
252735     MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER.             25273500
252736/                                                                 25273600
252737*----------------------------------------------------------------*25273700
252738*    RETRY DELAY LOGIC.                                    S.T.  *25273800
252739*     -- THIS LOGIC INSTITUTES A ONE SECOND DELAY.               *25273900
252740*----------------------------------------------------------------*25274000
252741 Z100-DELAY-RETRY.                                                25274100
252742                                                                  25274200
252743     EXEC CICS                                                    25274300
252800         POST INTERVAL(1) SET(PV-ECA-POINTER)                     25280000
252900     END-EXEC.                                                    25290000
253000                                                                  25300000
253100     EXEC CICS                                                    25310000
253200         WAIT EVENT ECADDR(PV-ECA-POINTER)                        25320000
253300     END-EXEC.                                                    25330000
253400                                                                  25340000
253500** DEFINE PV-ECA-POINTER AS PIC S9(08) COMP.                      25350000
253600                                                                  25360000
253700/                                                                 25370000
253800*----------------------------------------------------------------*25380000
253900*    ABEND PROCESSOR MODULE                                      *25390000
254000*----------------------------------------------------------------*25400000
254100                                                                  25410000
254200     COPY DPPD013.                                                25420000
254300                                                                  25430000
254400 EJECT                                                            25440000
254500*----------------------------------------------------------------*25450000
254600*    UPDATE TIME AND DATE MODULE                                 *25460000
254700*----------------------------------------------------------------*25470000
254800                                                                  25480000
254900     COPY DPPD017.                                                25490000
